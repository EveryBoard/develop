(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{2052:(Hu,B0,Po)=>{"use strict";function yn(r){return"function"==typeof r}function To(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const a3=To(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function c3(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class Mn{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(yn(n))try{n()}catch(s){e=s instanceof a3?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{u3(s)}catch(o){e=e??[],o instanceof a3?e=[...e,...o.errors]:e.push(o)}}if(e)throw new a3(e)}}add(e){var t;if(e&&e!==this)if(this.closed)u3(e);else{if(e instanceof Mn){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&c3(t,e)}remove(e){const{_finalizers:t}=this;t&&c3(t,e),e instanceof Mn&&e._removeParent(this)}}Mn.EMPTY=(()=>{const r=new Mn;return r.closed=!0,r})();const ql=Mn.EMPTY;function l3(r){return r instanceof Mn||r&&"closed"in r&&yn(r.remove)&&yn(r.add)&&yn(r.unsubscribe)}function u3(r){yn(r)?r():r.unsubscribe()}const ec={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},T4={setTimeout(r,e,...t){const{delegate:n}=T4;return n?.setTimeout?n.setTimeout(r,e,...t):setTimeout(r,e,...t)},clearTimeout(r){const{delegate:e}=T4;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function jl(r){T4.setTimeout(()=>{const{onUnhandledError:e}=ec;if(!e)throw r;e(r)})}function Ss(){}const Oo=Zl("C",void 0,void 0);function Zl(r,e,t){return{kind:r,value:e,error:t}}let fa=null;function dt(r){if(ec.useDeprecatedSynchronousErrorHandling){const e=!fa;if(e&&(fa={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=fa;if(fa=null,t)throw n}}else r()}class zt extends Mn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,l3(e)&&e.add(this)):this.destination=$u}static create(e,t,n){return new Ei(e,t,n)}next(e){this.isStopped?Fu(function Vu(r){return Zl("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Fu(function U0(r){return Zl("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Fu(Oo,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ln=Function.prototype.bind;function Lr(r,e){return Ln.call(r,e)}class f3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){K2(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){K2(n)}else K2(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){K2(t)}}}class Ei extends zt{constructor(e,t,n){let i;if(super(),yn(e)||!e)i={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&ec.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Lr(e.next,s),error:e.error&&Lr(e.error,s),complete:e.complete&&Lr(e.complete,s)}):i=e}this.destination=new f3(i)}}function K2(r){ec.useDeprecatedSynchronousErrorHandling?function it(r){ec.useDeprecatedSynchronousErrorHandling&&fa&&(fa.errorThrown=!0,fa.error=r)}(r):jl(r)}function Fu(r,e){const{onStoppedNotification:t}=ec;t&&T4.setTimeout(()=>t(r,e))}const $u={closed:!0,next:Ss,error:function Yl(r){throw r},complete:Ss},Gu="function"==typeof Symbol&&Symbol.observable||"@@observable";function tc(r){return r}function sh(r){return 0===r.length?tc:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}let b1=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const s=function ny(r){return r&&r instanceof zt||function ty(r){return r&&yn(r.next)&&yn(r.error)&&yn(r.complete)}(r)&&l3(r)}(t)?t:new Ei(t,n,i);return dt(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=oh(n))((i,s)=>{const o=new Ei({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Gu](){return this}pipe(...t){return sh(t)(this)}toPromise(t){return new(t=oh(t))((n,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>n(s))})}}return r.create=e=>new r(e),r})();function oh(r){var e;return null!==(e=r??ec.Promise)&&void 0!==e?e:Promise}const ry=To(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ps=(()=>{class r extends b1{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new ah(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new ry}next(t){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){dt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:s}=this;return n||i?ql:(this.currentObservers=null,s.push(t),new Mn(()=>{this.currentObservers=null,c3(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:s}=this;n?t.error(i):s&&t.complete()}asObservable(){const t=new b1;return t.source=this,t}}return r.create=(e,t)=>new ah(e,t),r})();class ah extends Ps{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:ql}}class Qi extends Ps{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function ch(r){return yn(r?.lift)}function Kr(r){return e=>{if(ch(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Cr(r,e,t,n,i){return new iy(r,e,t,n,i)}class iy extends zt{constructor(e,t,n,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function qn(r,e){return Kr((t,n)=>{let i=0;t.subscribe(Cr(n,s=>{n.next(r.call(e,s,i++))}))})}function Uu(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]])}return t}function Zs(r){return this instanceof Zs?(this.v=r,this):new Zs(r)}function Xl(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function n1(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(o){return new Promise(function(a,c){!function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=r[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const wR=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function NR(r){return yn(r?.then)}function AR(r){return yn(r[Gu])}function IR(r){return Symbol.asyncIterator&&yn(r?.[Symbol.asyncIterator])}function kR(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const xR=function w4e(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function LR(r){return yn(r?.[xR])}function RR(r){return function q0(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(m){n[m]&&(i[m]=function(E){return new Promise(function(w,R){s.push([m,E,w,R])>1||a(m,E)})})}function a(m,E){try{!function c(m){m.value instanceof Zs?Promise.resolve(m.value.v).then(l,f):d(s[0][2],m)}(n[m](E))}catch(w){d(s[0][3],w)}}function l(m){a("next",m)}function f(m){a("throw",m)}function d(m,E){m(E),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield Zs(t.read());if(i)return yield Zs(void 0);yield yield Zs(n)}}finally{t.releaseLock()}})}function zR(r){return yn(r?.getReader)}function Ks(r){if(r instanceof b1)return r;if(null!=r){if(AR(r))return function N4e(r){return new b1(e=>{const t=r[Gu]();if(yn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(wR(r))return function A4e(r){return new b1(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(NR(r))return function I4e(r){return new b1(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,jl)})}(r);if(IR(r))return DR(r);if(LR(r))return function k4e(r){return new b1(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(zR(r))return function x4e(r){return DR(RR(r))}(r)}throw kR(r)}function DR(r){return new b1(e=>{(function L4e(r,e){var t,n,i,s;return function Se(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Xl(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function d3(r,e,t,n=0,i=!1){const s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function X2(r,e,t=1/0){return yn(e)?X2((n,i)=>qn((s,o)=>e(n,s,i,o))(Ks(r(n,i))),t):("number"==typeof e&&(t=e),Kr((n,i)=>function R4e(r,e,t,n,i,s,o,a){const c=[];let l=0,f=0,d=!1;const m=()=>{d&&!c.length&&!l&&e.complete()},E=R=>l<n?w(R):c.push(R),w=R=>{s&&e.next(R),l++;let z=!1;Ks(t(R,f++)).subscribe(Cr(e,$=>{i?.($),s?E($):e.next($)},()=>{z=!0},void 0,()=>{if(z)try{for(l--;c.length&&l<n;){const $=c.shift();o?d3(e,o,()=>w($)):w($)}m()}catch($){e.error($)}}))};return r.subscribe(Cr(e,E,()=>{d=!0,m()})),()=>{a?.()}}(n,i,r,t)))}function j0(r=1/0){return X2(tc,r)}const nc=new b1(r=>r.complete());function uy(r){return r[r.length-1]}function HR(r){return yn(uy(r))?r.pop():void 0}function qu(r){return function D4e(r){return r&&yn(r.schedule)}(uy(r))?r.pop():void 0}function uh(r,e=0){return Kr((t,n)=>{t.subscribe(Cr(n,i=>d3(n,r,()=>n.next(i),e),()=>d3(n,r,()=>n.complete(),e),i=>d3(n,r,()=>n.error(i),e)))})}function fh(r,e=0){return Kr((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function VR(r,e){if(!r)throw new Error("Iterable cannot be null");return new b1(t=>{d3(t,e,()=>{const n=r[Symbol.asyncIterator]();d3(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function a2(r,e){return e?function U4e(r,e){if(null!=r){if(AR(r))return function V4e(r,e){return Ks(r).pipe(fh(e),uh(e))}(r,e);if(wR(r))return function $4e(r,e){return new b1(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(NR(r))return function F4e(r,e){return Ks(r).pipe(fh(e),uh(e))}(r,e);if(IR(r))return VR(r,e);if(LR(r))return function G4e(r,e){return new b1(t=>{let n;return d3(t,e,()=>{n=r[xR](),d3(t,e,()=>{let i,s;try{({value:i,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>yn(n?.return)&&n.return()})}(r,e);if(zR(r))return function B4e(r,e){return VR(RR(r),e)}(r,e)}throw kR(r)}(r,e):Ks(r)}function Dt(...r){return a2(r,qu(r))}function FR(r={}){const{connector:e=(()=>new Ps),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:i=!0}=r;return s=>{let o,a,c,l=0,f=!1,d=!1;const m=()=>{a?.unsubscribe(),a=void 0},E=()=>{m(),o=c=void 0,f=d=!1},w=()=>{const R=o;E(),R?.unsubscribe()};return Kr((R,z)=>{l++,!d&&!f&&m();const $=c=c??e();z.add(()=>{l--,0===l&&!d&&!f&&(a=fy(w,i))}),$.subscribe(z),!o&&l>0&&(o=new Ei({next:G=>$.next(G),error:G=>{d=!0,m(),a=fy(E,t,G),$.error(G)},complete:()=>{f=!0,m(),a=fy(E,n),$.complete()}}),Ks(R).subscribe(o))})(s)}}function fy(r,e,...t){if(!0===e)return void r();if(!1===e)return;const n=new Ei({next:()=>{n.unsubscribe(),r()}});return Ks(e(...t)).subscribe(n)}function da(r,e){return Kr((t,n)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&n.complete();t.subscribe(Cr(n,c=>{i?.unsubscribe();let l=0;const f=s++;Ks(r(c,f)).subscribe(i=Cr(n,d=>n.next(e?e(c,d,f,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function j4e(r,e){return r===e}function c1(r){for(let e in r)if(r[e]===c1)return e;throw Error("Could not find renamed property on target object.")}function dh(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function c2(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(c2).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function dy(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const Z4e=c1({__forward_ref__:c1});function w1(r){return r.__forward_ref__=w1,r.toString=function(){return c2(this())},r}function $t(r){return hy(r)?r():r}function hy(r){return"function"==typeof r&&r.hasOwnProperty(Z4e)&&r.__forward_ref__===w1}function py(r){return r&&!!r.\u0275providers}const $R="https://g.co/ng/security#xss";class ge extends Error{constructor(e,t){super(function hh(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function jt(r){return"string"==typeof r?r:null==r?"":String(r)}function gy(r,e){throw new ge(-201,!1)}function Ht(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function De(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Q2(r){return{providers:r.providers||[],imports:r.imports||[]}}function ph(r){return GR(r,mh)||GR(r,BR)}function GR(r,e){return r.hasOwnProperty(e)?r[e]:null}function gh(r){return r&&(r.hasOwnProperty(my)||r.hasOwnProperty(nle))?r[my]:null}const mh=c1({\u0275prov:c1}),my=c1({\u0275inj:c1}),BR=c1({ngInjectableDef:c1}),nle=c1({ngInjectorDef:c1});var cn=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(cn||{});let _y;function Ts(r){const e=_y;return _y=r,e}function WR(r,e,t){const n=ph(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&cn.Optional?null:void 0!==e?e:void gy(c2(r))}const C1=globalThis,ju={},Ey="__NG_DI_FLAG__",_h="ngTempTokenPath",sle=/\n/gm,jR="__source";let Z0;function b4(r){const e=Z0;return Z0=r,e}function cle(r,e=cn.Default){if(void 0===Z0)throw new ge(-203,!1);return null===Z0?WR(r,void 0,e):Z0.get(r,e&cn.Optional?null:void 0,e)}function Pe(r,e=cn.Default){return(function UR(){return _y}()||cle)($t(r),e)}function nt(r,e=cn.Default){return Pe(r,vh(e))}function vh(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function Sy(r){const e=[];for(let t=0;t<r.length;t++){const n=$t(r[t]);if(Array.isArray(n)){if(0===n.length)throw new ge(900,!1);let i,s=cn.Default;for(let o=0;o<n.length;o++){const a=n[o],c=lle(a);"number"==typeof c?-1===c?i=a.token:s|=c:i=a}e.push(Pe(i,s))}else e.push(Pe(n))}return e}function Zu(r,e){return r[Ey]=e,r.prototype[Ey]=e,r}function lle(r){return r[Ey]}function h3(r){return{toString:r}.toString()}var Ch=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(Ch||{}),wo=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(wo||{});const rc={},jn=[],yh=c1({\u0275cmp:c1}),Py=c1({\u0275dir:c1}),Ty=c1({\u0275pipe:c1}),YR=c1({\u0275mod:c1}),p3=c1({\u0275fac:c1}),Yu=c1({__NG_ELEMENT_ID__:c1}),KR=c1({__NG_ENV_ID__:c1});function XR(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const s=e.length;if(i+s===n||r.charCodeAt(i+s)<=32)return i}t=i+1}}function Oy(r,e,t){let n=0;for(;n<t.length;){const i=t[n];if("number"==typeof i){if(0!==i)break;n++;const s=t[n++],o=t[n++],a=t[n++];r.setAttribute(e,o,a,s)}else{const s=i,o=t[++n];JR(s)?r.setProperty(e,s,o):r.setAttribute(e,s,o),n++}}return n}function QR(r){return 3===r||4===r||6===r}function JR(r){return 64===r.charCodeAt(0)}function Ku(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||ez(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function ez(r,e,t,n,i){let s=0,o=r.length;if(-1===e)o=-1;else for(;s<r.length;){const a=r[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<r.length;){const a=r[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[s+1]=i));if(n===r[s+1])return void(r[s+2]=i)}s++,null!==n&&s++,null!==i&&s++}-1!==o&&(r.splice(o,0,e),s=o+1),r.splice(s++,0,t),null!==n&&r.splice(s++,0,n),null!==i&&r.splice(s++,0,i)}const tz="ng-template";function dle(r,e,t){let n=0,i=!0;for(;n<r.length;){let s=r[n++];if("string"==typeof s&&i){const o=r[n++];if(t&&"class"===s&&-1!==XR(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;n<r.length&&"string"==typeof(s=r[n++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function nz(r){return 4===r.type&&r.value!==tz}function hle(r,e,t){return e===(4!==r.type||t?r.value:tz)}function ple(r,e,t){let n=4;const i=r.attrs||[],s=function _le(r){for(let e=0;e<r.length;e++)if(QR(r[e]))return e;return r.length}(i);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&n){if(n=2|1&n,""!==c&&!hle(r,c,t)||""===c&&1===e.length){if(ha(n))return!1;o=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==r.attrs){if(!dle(r.attrs,l,t)){if(ha(n))return!1;o=!0}continue}const d=gle(8&n?"class":c,i,nz(r),t);if(-1===d){if(ha(n))return!1;o=!0;continue}if(""!==l){let m;m=d>s?"":i[d+1].toLowerCase();const E=8&n?m:null;if(E&&-1!==XR(E,l,0)||2&n&&l!==m){if(ha(n))return!1;o=!0}}}}else{if(!o&&!ha(n)&&!ha(c))return!1;if(o&&ha(c))continue;o=!1,n=c|1&n}}return ha(n)||o}function ha(r){return 0==(1&r)}function gle(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===r)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function vle(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function rz(r,e,t=!1){for(let n=0;n<e.length;n++)if(ple(r,e[n],t))return!0;return!1}function Cle(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function iz(r,e){return r?":not("+e.trim()+")":e}function yle(r){let e=r[0],t=1,n=2,i="",s=!1;for(;t<r.length;){let o=r[t];if("string"==typeof o)if(2&n){const a=r[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+o:4&n&&(i+=" "+o);else""!==i&&!ha(o)&&(e+=iz(s,i),i=""),n=o,s=s||!ha(n);t++}return""!==i&&(e+=iz(s,i)),e}function We(r){return h3(()=>{const e=oz(r),t={...e,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===Ch.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||wo.Emulated,styles:r.styles||jn,_:null,schemas:r.schemas||null,tView:null,id:""};az(t);const n=r.dependencies;return t.directiveDefs=Mh(n,!1),t.pipeDefs=Mh(n,!0),t.id=function ble(r){let e=0;const t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function by(r,e,t){const n=r.\u0275cmp;n.directiveDefs=Mh(e,!1),n.pipeDefs=Mh(t,!0)}function Sle(r){return Rn(r)||J2(r)}function Ple(r){return null!==r}function Si(r){return h3(()=>({type:r.type,bootstrap:r.bootstrap||jn,declarations:r.declarations||jn,imports:r.imports||jn,exports:r.exports||jn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function sz(r,e){if(null==r)return rc;const t={};for(const n in r)if(r.hasOwnProperty(n)){let i=r[n],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=n,e&&(e[i]=s)}return t}function Lt(r){return h3(()=>{const e=oz(r);return az(e),e})}function Pi(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Rn(r){return r[yh]||null}function J2(r){return r[Py]||null}function Ji(r){return r[Ty]||null}function Qs(r,e){const t=r[YR]||null;if(!t&&!0===e)throw new Error(`Type ${c2(r)} does not have '\u0275mod' property.`);return t}function oz(r){const e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||rc,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||jn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:sz(r.inputs,e),outputs:sz(r.outputs)}}function az(r){r.features?.forEach(e=>e(r))}function Mh(r,e){if(!r)return null;const t=e?Ji:Sle;return()=>("function"==typeof r?r():r).map(n=>t(n)).filter(Ple)}const Rr=0,Je=1,Kt=2,Q1=3,pa=4,Xu=5,Ti=6,K0=7,zr=8,w4=9,X0=10,Zt=11,Qu=12,cz=13,Q0=14,Dr=15,Ju=16,J0=17,ic=18,e7=19,lz=20,N4=21,g3=22,Eh=23,Sh=24,gn=25,wy=1,uz=2,sc=7,e8=9,ei=11;function Os(r){return Array.isArray(r)&&"object"==typeof r[wy]}function bs(r){return Array.isArray(r)&&!0===r[wy]}function Ny(r){return 0!=(4&r.flags)}function e6(r){return r.componentOffset>-1}function Th(r){return 1==(1&r.flags)}function ga(r){return!!r.template}function Ay(r){return 0!=(512&r[Kt])}function t6(r,e){return r.hasOwnProperty(p3)?r[p3]:null}let xle=C1.WeakRef??class kle{constructor(e){this.ref=e}deref(){return this.ref}},Rle=0,oc=null,Oh=!1;function O2(r){const e=oc;return oc=r,e}class gz{constructor(){this.id=Rle++,this.ref=function Lle(r){return new xle(r)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const n=t.producerNode.deref();if(null!=n&&t.atTrackingVersion===this.trackingVersion){if(n.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),n?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Oh;Oh=!0;try{for(const[t,n]of this.consumers){const i=n.consumerNode.deref();null!=i&&i.trackingVersion===n.atTrackingVersion?i.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),i?.producers.delete(this.id))}}finally{Oh=e}}producerAccessed(){if(Oh)throw new Error("");if(null===oc)return;let e=oc.producers.get(this.id);void 0===e?(e={consumerNode:oc.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:oc.trackingVersion},oc.producers.set(this.id,e),this.consumers.set(oc.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=oc.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==oc?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let mz=null;const vz=()=>{};class Vle extends gz{constructor(e,t,n){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=vz,this.registerOnCleanup=i=>{this.cleanupFn=i},this.consumerAllowSignalWrites=n}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=O2(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=vz,this.watch(this.registerOnCleanup)}finally{O2(e)}}cleanup(){this.cleanupFn()}}class Fle{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function es(){return Cz}function Cz(r){return r.type.prototype.ngOnChanges&&(r.setInput=Gle),$le}function $le(){const r=Mz(this),e=r?.current;if(e){const t=r.previous;if(t===rc)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function Gle(r,e,t,n){const i=this.declaredInputs[t],s=Mz(r)||function Ble(r,e){return r[yz]=e}(r,{previous:rc,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[i];o[i]=new Fle(c&&c.currentValue,e,a===rc),r[n]=e}es.ngInherit=!0;const yz="__ngSimpleChanges__";function Mz(r){return r[yz]||null}const ac=function(r,e,t){},Ez="svg";function N1(r){for(;Array.isArray(r);)r=r[Rr];return r}function Nh(r,e){return N1(e[r])}function ws(r,e){return N1(e[r.index])}function Pz(r,e){return r.data[e]}function t8(r,e){return r[e]}function Js(r,e){const t=e[r];return Os(t)?t:t[Rr]}function A4(r,e){return null==e?null:r[e]}function Tz(r){r[J0]=0}function Kle(r){1024&r[Kt]||(r[Kt]|=1024,bz(r,1))}function Oz(r){1024&r[Kt]&&(r[Kt]&=-1025,bz(r,-1))}function bz(r,e){let t=r[Q1];if(null===t)return;t[Xu]+=e;let n=t;for(t=t[Q1];null!==t&&(1===e&&1===n[Xu]||-1===e&&0===n[Xu]);)t[Xu]+=e,n=t,t=t[Q1]}const Vt={lFrame:Hz(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Az(){return Vt.bindingsEnabled}function n8(){return null!==Vt.skipHydrationRootTNode}function Ee(){return Vt.lFrame.lView}function zn(){return Vt.lFrame.tView}function te(r){return Vt.lFrame.contextLView=r,r[zr]}function ne(r){return Vt.lFrame.contextLView=null,r}function ti(){let r=Iz();for(;null!==r&&64===r.type;)r=r.parent;return r}function Iz(){return Vt.lFrame.currentTNode}function n7(){const r=Vt.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function cc(r,e){const t=Vt.lFrame;t.currentTNode=r,t.isParent=e}function zy(){return Vt.lFrame.isParent}function Dy(){Vt.lFrame.isParent=!1}function ts(){const r=Vt.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function m3(){return Vt.lFrame.bindingIndex}function r8(){return Vt.lFrame.bindingIndex++}function _3(r){const e=Vt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}function Lz(r){Vt.lFrame.inI18n=r}function c6e(r,e){const t=Vt.lFrame;t.bindingIndex=t.bindingRootIndex=r,Hy(e)}function Hy(r){Vt.lFrame.currentDirectiveIndex=r}function Rz(){return Vt.lFrame.currentQueryIndex}function Fy(r){Vt.lFrame.currentQueryIndex=r}function u6e(r){const e=r[Je];return 2===e.type?e.declTNode:1===e.type?r[Ti]:null}function zz(r,e,t){if(t&cn.SkipSelf){let i=e,s=r;for(;!(i=i.parent,null!==i||t&cn.Host||(i=u6e(s),null===i||(s=s[Q0],10&i.type))););if(null===i)return!1;e=i,r=s}const n=Vt.lFrame=Dz();return n.currentTNode=e,n.lView=r,!0}function $y(r){const e=Dz(),t=r[Je];Vt.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Dz(){const r=Vt.lFrame,e=null===r?null:r.child;return null===e?Hz(r):e}function Hz(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function Vz(){const r=Vt.lFrame;return Vt.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Fz=Vz;function Gy(){const r=Vz();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function ns(){return Vt.lFrame.selectedIndex}function n6(r){Vt.lFrame.selectedIndex=r}function or(){const r=Vt.lFrame;return Pz(r.tView,r.selectedIndex)}function A(){Vt.lFrame.currentNamespace=Ez}let Gz=!0;function Ah(){return Gz}function I4(r){Gz=r}function Ih(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=r.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:f}=s;o&&(r.contentHooks??=[]).push(-t,o),a&&((r.contentHooks??=[]).push(t,a),(r.contentCheckHooks??=[]).push(t,a)),c&&(r.viewHooks??=[]).push(-t,c),l&&((r.viewHooks??=[]).push(t,l),(r.viewCheckHooks??=[]).push(t,l)),null!=f&&(r.destroyHooks??=[]).push(t,f)}}function kh(r,e,t){Bz(r,e,3,t)}function xh(r,e,t,n){(3&r[Kt])===t&&Bz(r,e,t,n)}function By(r,e){let t=r[Kt];(3&t)===e&&(t&=8191,t+=1,r[Kt]=t)}function Bz(r,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let c=void 0!==n?65535&r[J0]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(r[J0]+=65536),(a<s||-1==s)&&(_6e(r,t,e,c),r[J0]=(4294901760&r[J0])+c+2),c++}function Uz(r,e){ac(4,r,e);const t=O2(null);try{e.call(r)}finally{O2(t),ac(5,r,e)}}function _6e(r,e,t,n){const i=t[n]<0,s=t[n+1],a=r[i?-t[n]:t[n]];i?r[Kt]>>13<r[J0]>>16&&(3&r[Kt])===e&&(r[Kt]+=8192,Uz(a,s)):Uz(a,s)}const i8=-1;class r7{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function Wy(r){return r!==i8}function i7(r){return 32767&r}function s7(r,e){let t=function M6e(r){return r>>16}(r),n=e;for(;t>0;)n=n[Q0],t--;return n}let qy=!0;function Lh(r){const e=qy;return qy=r,e}const Wz=255,qz=5;let E6e=0;const lc={};function Rh(r,e){const t=jz(r,e);if(-1!==t)return t;const n=e[Je];n.firstCreatePass&&(r.injectorIndex=e.length,jy(n.data,r),jy(e,null),jy(n.blueprint,null));const i=zh(r,e),s=r.injectorIndex;if(Wy(i)){const o=i7(i),a=s7(i,e),c=a[Je].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function jy(r,e){r.push(0,0,0,0,0,0,0,0,e)}function jz(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function zh(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){if(n=eD(i),null===n)return i8;if(t++,i=i[Q0],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return i8}function Zy(r,e,t){!function S6e(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Yu)&&(n=t[Yu]),null==n&&(n=t[Yu]=E6e++);const i=n&Wz;e.data[r+(i>>qz)]|=1<<i}(r,e,t)}function Zz(r,e,t){if(t&cn.Optional||void 0!==r)return r;gy()}function Yz(r,e,t,n){if(t&cn.Optional&&void 0===n&&(n=null),!(t&(cn.Self|cn.Host))){const i=r[w4],s=Ts(void 0);try{return i?i.get(e,n,t&cn.Optional):WR(e,n,t&cn.Optional)}finally{Ts(s)}}return Zz(n,0,t)}function Kz(r,e,t,n=cn.Default,i){if(null!==r){if(2048&e[Kt]&&!(n&cn.Self)){const o=function N6e(r,e,t,n,i){let s=r,o=e;for(;null!==s&&null!==o&&2048&o[Kt]&&!(512&o[Kt]);){const a=Xz(s,o,t,n|cn.Self,lc);if(a!==lc)return a;let c=s.parent;if(!c){const l=o[lz];if(l){const f=l.get(t,lc,n);if(f!==lc)return f}c=eD(o),o=o[Q0]}s=c}return i}(r,e,t,n,lc);if(o!==lc)return o}const s=Xz(r,e,t,n,lc);if(s!==lc)return s}return Yz(e,t,n,i)}function Xz(r,e,t,n,i){const s=function O6e(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(Yu)?r[Yu]:void 0;return"number"==typeof e?e>=0?e&Wz:w6e:e}(t);if("function"==typeof s){if(!zz(e,r,n))return n&cn.Host?Zz(i,0,n):Yz(e,t,n,i);try{let o;if(o=s(n),null!=o||n&cn.Optional)return o;gy()}finally{Fz()}}else if("number"==typeof s){let o=null,a=jz(r,e),c=i8,l=n&cn.Host?e[Dr][Ti]:null;for((-1===a||n&cn.SkipSelf)&&(c=-1===a?zh(r,e):e[a+8],c!==i8&&Jz(n,!1)?(o=e[Je],a=i7(c),e=s7(c,e)):a=-1);-1!==a;){const f=e[Je];if(Qz(s,a,f.data)){const d=T6e(a,e,t,o,n,l);if(d!==lc)return d}c=e[a+8],c!==i8&&Jz(n,e[Je].data[a+8]===l)&&Qz(s,a,e)?(o=f,a=i7(c),e=s7(c,e)):a=-1}}return i}function T6e(r,e,t,n,i,s){const o=e[Je],a=o.data[r+8],f=Dh(a,o,t,null==n?e6(a)&&qy:n!=o&&0!=(3&a.type),i&cn.Host&&s===a);return null!==f?r6(e,o,f,a):lc}function Dh(r,e,t,n,i){const s=r.providerIndexes,o=e.data,a=1048575&s,c=r.directiveStart,f=s>>20,m=i?a+f:r.directiveEnd;for(let E=n?a:a+f;E<m;E++){const w=o[E];if(E<c&&t===w||E>=c&&w.type===t)return E}if(i){const E=o[c];if(E&&ga(E)&&E.type===t)return c}return null}function r6(r,e,t,n){let i=r[t];const s=e.data;if(function v6e(r){return r instanceof r7}(i)){const o=i;o.resolving&&function Y4e(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new ge(-200,`Circular dependency in DI detected for ${r}${t}`)}(function i1(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():jt(r)}(s[t]));const a=Lh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ts(o.injectImpl):null;zz(r,n,cn.Default);try{i=r[t]=o.factory(void 0,s,r,n),e.firstCreatePass&&t>=n.directiveStart&&function m6e(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(n){const o=Cz(e);(t.preOrderHooks??=[]).push(r,o),(t.preOrderCheckHooks??=[]).push(r,o)}i&&(t.preOrderHooks??=[]).push(0-r,i),s&&((t.preOrderHooks??=[]).push(r,s),(t.preOrderCheckHooks??=[]).push(r,s))}(t,s[t],e)}finally{null!==l&&Ts(l),Lh(a),o.resolving=!1,Fz()}}return i}function Qz(r,e,t){return!!(t[e+(r>>qz)]&1<<r)}function Jz(r,e){return!(r&cn.Self||r&cn.Host&&e)}class rs{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return Kz(this._tNode,this._lView,e,vh(n),t)}}function w6e(){return new rs(ti(),Ee())}function ar(r){return h3(()=>{const e=r.prototype.constructor,t=e[p3]||Yy(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const s=i[p3]||Yy(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Yy(r){return hy(r)?()=>{const e=Yy($t(r));return e&&e()}:t6(r)}function eD(r){const e=r[Je],t=e.type;return 2===t?e.declTNode:1===t?r[Ti]:null}const o8="__parameters__";function c8(r,e,t){return h3(()=>{const n=function Ky(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...s){if(this instanceof i)return n.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(c,l,f){const d=c.hasOwnProperty(o8)?c[o8]:Object.defineProperty(c,o8,{value:[]})[o8];for(;d.length<=f;)d.push(null);return(d[f]=d[f]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}function u8(r,e){r.forEach(t=>Array.isArray(t)?u8(t,e):e(t))}function nD(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function Vh(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function c7(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}function eo(r,e,t){let n=f8(r,e);return n>=0?r[1|n]=t:(n=~n,function z6e(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function Xy(r,e){const t=f8(r,e);if(t>=0)return r[1|t]}function f8(r,e){return function rD(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const s=n+(i-n>>1),o=r[s<<t];if(e===o)return s<<t;o>e?i=s:n=s+1}return~(i<<t)}(r,e,1)}const is=Zu(c8("Optional"),8),$h=Zu(c8("SkipSelf"),4);function qh(r){return 128==(128&r.flags)}var k4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(k4||{});const r0e=/^>|^->|<!--|-->|--!>|<!-$/g,i0e=/(<|>)/,s0e="\u200b$1\u200b";const nM=new Map;let o0e=0;const iM="__ngContext__";function Oi(r,e){Os(e)?(r[iM]=e[e7],function c0e(r){nM.set(r[e7],r)}(e)):r[iM]=e}let sM;function oM(r,e){return sM(r,e)}function f7(r){const e=r[Q1];return bs(e)?e[Q1]:e}function SD(r){return TD(r[Qu])}function PD(r){return TD(r[pa])}function TD(r){for(;null!==r&&!bs(r);)r=r[pa];return r}function p8(r,e,t,n,i){if(null!=n){let s,o=!1;bs(n)?s=n:Os(n)&&(o=!0,n=n[Rr]);const a=N1(n);0===r&&null!==t?null==i?ND(e,t,a):i6(e,t,a,i||null,!0):1===r&&null!==t?i6(e,t,a,i||null,!0):2===r?Jh(e,a,o):3===r&&e.destroyNode(a),null!=s&&function A0e(r,e,t,n,i){const s=t[sc];s!==N1(t)&&p8(e,r,n,s,i);for(let a=ei;a<t.length;a++){const c=t[a];h7(c[Je],c,r,e,n,s)}}(e,r,s,t,i)}}function Zh(r,e){return r.createText(e)}function OD(r,e,t){r.setValue(e,t)}function aM(r,e){return r.createComment(function gD(r){return r.replace(r0e,e=>e.replace(i0e,s0e))}(e))}function Yh(r,e,t){return r.createElement(e,t)}function bD(r,e){const t=r[e8],n=t.indexOf(e);Oz(e),t.splice(n,1)}function Kh(r,e){if(r.length<=ei)return;const t=ei+e,n=r[t];if(n){const i=n[Ju];null!==i&&i!==r&&bD(i,n),e>0&&(r[t-1][pa]=n[pa]);const s=Vh(r,ei+e);!function C0e(r,e){h7(r,e,e[Zt],2,null,null),e[Rr]=null,e[Ti]=null}(n[Je],n);const o=s[ic];null!==o&&o.detachView(s[Je]),n[Q1]=null,n[pa]=null,n[Kt]&=-129}return n}function cM(r,e){if(!(256&e[Kt])){const t=e[Zt];e[Eh]?.destroy(),e[Sh]?.destroy(),t.destroyNode&&h7(r,e,t,3,null,null),function E0e(r){let e=r[Qu];if(!e)return lM(r[Je],r);for(;e;){let t=null;if(Os(e))t=e[Qu];else{const n=e[ei];n&&(t=n)}if(!t){for(;e&&!e[pa]&&e!==r;)Os(e)&&lM(e[Je],e),e=e[Q1];null===e&&(e=r),Os(e)&&lM(e[Je],e),t=e&&e[pa]}e=t}}(e)}}function lM(r,e){if(!(256&e[Kt])){e[Kt]&=-129,e[Kt]|=256,function O0e(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof r7)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],c=s[o+1];ac(4,a,c);try{c.call(a)}finally{ac(5,a,c)}}else{ac(4,i,s);try{s.call(i)}finally{ac(5,i,s)}}}}}(r,e),function T0e(r,e){const t=r.cleanup,n=e[K0];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else t[s].call(n[t[s+1]]);null!==n&&(e[K0]=null);const i=e[N4];if(null!==i){e[N4]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(r,e),1===e[Je].type&&e[Zt].destroy();const t=e[Ju];if(null!==t&&bs(e[Q1])){t!==e[Q1]&&bD(t,e);const n=e[ic];null!==n&&n.detachView(r)}!function l0e(r){nM.delete(r[e7])}(e)}}function uM(r,e,t){return wD(r,e.parent,t)}function wD(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[Rr];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:s}=r.data[n.directiveStart+i];if(s===wo.None||s===wo.Emulated)return null}return ws(n,t)}}function i6(r,e,t,n,i){r.insertBefore(e,t,n,i)}function ND(r,e,t){r.appendChild(e,t)}function AD(r,e,t,n,i){null!==n?i6(r,e,t,n,i):ND(r,e,t)}function Xh(r,e){return r.parentNode(e)}function ID(r,e,t){return xD(r,e,t)}function kD(r,e,t){return 40&r.type?ws(r,t):null}let fM,ep,gM,tp,xD=kD;function LD(r,e){xD=r,fM=e}function Qh(r,e,t,n){const i=uM(r,n,e),s=e[Zt],a=ID(n.parent||e[Ti],n,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)AD(s,i,t[c],a,!1);else AD(s,i,t,a,!1);void 0!==fM&&fM(s,n,e,t,i)}function d7(r,e){if(null!==e){const t=e.type;if(3&t)return ws(e,r);if(4&t)return dM(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return d7(r,n);{const i=r[e.index];return bs(i)?dM(-1,i):N1(i)}}if(32&t)return oM(e,r)()||N1(r[e.index]);{const n=RD(r,e);return null!==n?Array.isArray(n)?n[0]:d7(f7(r[Dr]),n):d7(r,e.next)}}return null}function RD(r,e){return null!==e?r[Dr][Ti].projection[e.projection]:null}function dM(r,e){const t=ei+r+1;if(t<e.length){const n=e[t],i=n[Je].firstChild;if(null!==i)return d7(n,i)}return e[sc]}function Jh(r,e,t){const n=Xh(r,e);n&&function b0e(r,e,t,n){r.removeChild(e,t,n)}(r,n,e,t)}function hM(r,e,t,n,i,s,o){for(;null!=t;){const a=n[t.index],c=t.type;if(o&&0===e&&(a&&Oi(N1(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)hM(r,e,t.child,n,i,s,!1),p8(e,r,i,a,s);else if(32&c){const l=oM(t,n);let f;for(;f=l();)p8(e,r,i,f,s);p8(e,r,i,a,s)}else 16&c?DD(r,e,n,t,i,s):p8(e,r,i,a,s);t=o?t.projectionNext:t.next}}function h7(r,e,t,n,i,s){hM(t,n,r.firstChild,e,i,s,!1)}function DD(r,e,t,n,i,s){const o=t[Dr],c=o[Ti].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)p8(e,r,i,c[l],s);else{let l=c;const f=o[Q1];qh(n)&&(l.flags|=128),hM(r,e,l,f,i,s,!0)}}function HD(r,e,t){""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t)}function VD(r,e,t){const{mergedAttrs:n,classes:i,styles:s}=t;null!==n&&Oy(r,e,n),null!==i&&HD(r,e,i),null!==s&&function k0e(r,e,t){r.setAttribute(e,"style",t)}(r,e,s)}function g8(r){return function pM(){if(void 0===ep&&(ep=null,C1.trustedTypes))try{ep=C1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return ep}()?.createHTML(r)||r}function m8(){if(void 0!==gM)return gM;if(typeof document<"u")return document;throw new ge(210,!1)}function mM(){if(void 0===tp&&(tp=null,C1.trustedTypes))try{tp=C1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return tp}function FD(r){return mM()?.createHTML(r)||r}function GD(r){return mM()?.createScriptURL(r)||r}class s6{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${$R})`}}class D0e extends s6{getTypeName(){return"HTML"}}class H0e extends s6{getTypeName(){return"Style"}}class V0e extends s6{getTypeName(){return"Script"}}class F0e extends s6{getTypeName(){return"URL"}}class $0e extends s6{getTypeName(){return"ResourceURL"}}function to(r){return r instanceof s6?r.changingThisBreaksApplicationSecurity:r}function uc(r,e){const t=function G0e(r){return r instanceof s6&&r.getTypeName()||null}(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${$R})`)}return t===e}function BD(r){const e=new Y0e(r);return function K0e(){try{return!!(new window.DOMParser).parseFromString(g8(""),"text/html")}catch{return!1}}()?new Z0e(e):e}class Z0e{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(g8(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class Y0e{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=g8(e),t}}const X0e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function np(r){return(r=String(r)).match(X0e)?r:"unsafe:"+r}function v3(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function p7(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const UD=v3("area,br,col,hr,img,wbr"),WD=v3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),qD=v3("rp,rt"),_M=p7(UD,p7(WD,v3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),p7(qD,v3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),p7(qD,WD)),vM=v3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),jD=p7(vM,v3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),v3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Q0e=v3("script,style,template");class J0e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!_M.hasOwnProperty(t))return this.sanitizedSomething=!0,!Q0e.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const s=n.item(i),o=s.name,a=o.toLowerCase();if(!jD.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;vM[a]&&(c=np(c)),this.buf.push(" ",o,'="',ZD(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();_M.hasOwnProperty(t)&&!UD.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(ZD(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const e8e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,t8e=/([^\#-~ |!])/g;function ZD(r){return r.replace(/&/g,"&amp;").replace(e8e,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(t8e,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let rp;function YD(r,e){let t=null;try{rp=rp||BD(r);let n=e?String(e):"";t=rp.getInertBodyElement(n);let i=5,s=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=s,s=t.innerHTML,t=rp.getInertBodyElement(n)}while(n!==s);return g8((new J0e).sanitizeChildren(CM(t)||t))}finally{if(t){const n=CM(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function CM(r){return"content"in r&&function n8e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Ao=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(Ao||{});function g7(r){const e=m7();return e?FD(e.sanitize(Ao.HTML,r)||""):uc(r,"HTML")?FD(to(r)):YD(m8(),jt(r))}function ip(r){const e=m7();return e?e.sanitize(Ao.URL,r)||"":uc(r,"URL")?to(r):np(jt(r))}function KD(r){const e=m7();if(e)return GD(e.sanitize(Ao.RESOURCE_URL,r)||"");if(uc(r,"ResourceURL"))return GD(to(r));throw new ge(904,!1)}function m7(){const r=Ee();return r&&r[X0].sanitizer}class et{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=De({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const _7=new et("ENVIRONMENT_INITIALIZER"),QD=new et("INJECTOR",-1),JD=new et("INJECTOR_DEF_TYPES");class yM{get(e,t=ju){if(t===ju){const n=new Error(`NullInjectorError: No provider for ${c2(e)}!`);throw n.name="NullInjectorError",n}return t}}function c8e(...r){return{\u0275providers:eH(0,r),\u0275fromNgModule:!0}}function eH(r,...e){const t=[],n=new Set;let i;const s=o=>{t.push(o)};return u8(e,o=>{const a=o;sp(a,s,[],n)&&(i||=[],i.push(a))}),void 0!==i&&tH(i,s),t}function tH(r,e){for(let t=0;t<r.length;t++){const{ngModule:n,providers:i}=r[t];EM(i,s=>{e(s,n)})}}function sp(r,e,t,n){if(!(r=$t(r)))return!1;let i=null,s=gh(r);const o=!s&&Rn(r);if(s||o){if(o&&!o.standalone)return!1;i=r}else{const c=r.ngModule;if(s=gh(c),!s)return!1;i=c}const a=n.has(i);if(o){if(a)return!1;if(n.add(i),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)sp(l,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;n.add(i);try{u8(s.imports,f=>{sp(f,e,t,n)&&(l||=[],l.push(f))})}finally{}void 0!==l&&tH(l,e)}if(!a){const l=t6(i)||(()=>new i);e({provide:i,useFactory:l,deps:jn},i),e({provide:JD,useValue:i,multi:!0},i),e({provide:_7,useValue:()=>Pe(i),multi:!0},i)}const c=s.providers;if(null!=c&&!a){const l=r;EM(c,f=>{e(f,l)})}}}return i!==r&&void 0!==r.providers}function EM(r,e){for(let t of r)py(t)&&(t=t.\u0275providers),Array.isArray(t)?EM(t,e):e(t)}const l8e=c1({provide:String,useValue:c1});function SM(r){return null!==r&&"object"==typeof r&&l8e in r}function o6(r){return"function"==typeof r}const PM=new et("Set Injector scope."),op={},f8e={};let TM;function ap(){return void 0===TM&&(TM=new yM),TM}class no{}class cp extends no{get destroyed(){return this._destroyed}constructor(e,t,n,i){super(),this.parent=t,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,bM(e,o=>this.processProvider(o)),this.records.set(QD,_8(void 0,this)),i.has("environment")&&this.records.set(no,_8(void 0,this));const s=this.records.get(PM);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(JD.multi,jn,cn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=b4(this),n=Ts(void 0);try{return e()}finally{b4(t),Ts(n)}}get(e,t=ju,n=cn.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(KR))return e[KR](this);n=vh(n);const s=b4(this),o=Ts(void 0);try{if(!(n&cn.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function m8e(r){return"function"==typeof r||"object"==typeof r&&r instanceof et}(e)&&ph(e);c=l&&this.injectableDefInScope(l)?_8(OM(e),op):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(n&cn.Self?ap():this.parent).get(e,t=n&cn.Optional&&t===ju?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[_h]=a[_h]||[]).unshift(c2(e)),s)throw a;return function ule(r,e,t,n){const i=r[_h];throw e[jR]&&i.unshift(e[jR]),r.message=function fle(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=c2(e);if(Array.isArray(e))i=e.map(c2).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):c2(a)))}i=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(sle,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[_h]=null,r}(a,e,"R3InjectorError",this.source)}throw a}finally{Ts(o),b4(s)}}resolveInjectorInitializers(){const e=b4(this),t=Ts(void 0);try{const i=this.get(_7.multi,jn,cn.Self);for(const s of i)s()}finally{b4(e),Ts(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(c2(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(e){let t=o6(e=$t(e))?e:$t(e&&e.provide);const n=function h8e(r){return SM(r)?_8(void 0,r.useValue):_8(iH(r),op)}(e);if(o6(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=_8(void 0,op,!0),i.factory=()=>Sy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===op&&(t.value=f8e,t.value=t.factory()),"object"==typeof t.value&&t.value&&function g8e(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=$t(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function OM(r){const e=ph(r),t=null!==e?e.factory:t6(r);if(null!==t)return t;if(r instanceof et)throw new ge(204,!1);if(r instanceof Function)return function d8e(r){const e=r.length;if(e>0)throw c7(e,"?"),new ge(204,!1);const t=function tle(r){return r&&(r[mh]||r[BR])||null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new ge(204,!1)}function iH(r,e,t){let n;if(o6(r)){const i=$t(r);return t6(i)||OM(i)}if(SM(r))n=()=>$t(r.useValue);else if(function rH(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...Sy(r.deps||[]));else if(function nH(r){return!(!r||!r.useExisting)}(r))n=()=>Pe($t(r.useExisting));else{const i=$t(r&&(r.useClass||r.provide));if(!function p8e(r){return!!r.deps}(r))return t6(i)||OM(i);n=()=>new i(...Sy(r.deps))}return n}function _8(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function bM(r,e){for(const t of r)Array.isArray(t)?bM(t,e):t&&py(t)?bM(t.\u0275providers,e):e(t)}const lp=new et("AppId",{providedIn:"root",factory:()=>_8e}),_8e="ng",sH=new et("Platform Initializer"),C3=new et("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),oH=new et("AnimationModuleType"),aH=new et("CSP nonce",{providedIn:"root",factory:()=>m8().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let lH=(r,e,t)=>null;function LM(r,e,t=!1){return lH(r,e,t)}class b8e{}class dH{}class N8e{resolveComponentFactory(e){throw function w8e(r){const e=Error(`No component factory found for ${c2(r)}.`);return e.ngComponent=r,e}(e)}}let gp=(()=>{class e{}return e.NULL=new N8e,e})();function A8e(){return C8(ti(),Ee())}function C8(r,e){return new bi(ws(r,e))}let bi=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=A8e,e})();function I8e(r){return r instanceof bi?r.nativeElement:r}class M7{}let fc=(()=>{class e{constructor(){this.destroyNode=null}}return e.__NG_ELEMENT_ID__=()=>function k8e(){const r=Ee(),t=Js(ti().index,r);return(Os(t)?t:r)[Zt]}(),e})(),x8e=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>null}),e})();class y8{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const pH=new y8("16.2.0"),DM={};function vH(r,e=null,t=null,n){const i=CH(r,e,t,n);return i.resolveInjectorInitializers(),i}function CH(r,e=null,t=null,n,i=new Set){const s=[t||jn,c8e(r)];return n=n||("object"==typeof r?void 0:c2(r)),new cp(s,e||ap(),n||null,i)}let ni=(()=>{var r;class e{static create(n,i){if(Array.isArray(n))return vH({name:""},i,n,"");{const s=n.name??"";return vH({name:s},n.parent,n.providers,s)}}}return(r=e).THROW_IF_NOT_FOUND=ju,r.NULL=new yM,r.\u0275prov=De({token:r,providedIn:"any",factory:()=>Pe(QD)}),r.__NG_ELEMENT_ID__=-1,e})();function y3(r){return r instanceof Function?r():r}let FM=(()=>{var r;class e{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new ge(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const n of this.callbacks)n.invoke()}finally{this.runningCallbacks=!1;for(const n of this.deferredCallbacks)this.callbacks.add(n);this.deferredCallbacks.clear()}}register(n){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(n)}unregister(n){this.callbacks.delete(n),this.deferredCallbacks.delete(n)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function E7(r){for(;r;){r[Kt]|=64;const e=f7(r);if(Ay(r)&&!e)return r;r=e}return null}function $M(r){return r.ngOriginalError}class a6{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&$M(e);for(;t&&$M(t);)t=$M(t);return t||null}}const PH=new et("",{providedIn:"root",factory:()=>!1});class wH extends gz{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){E7(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,n){const i=O2(this);this.trackingVersion++;try{e(t,n)}finally{O2(i)}}destroy(){this.trackingVersion++}}let _p=null;function NH(){return _p??=new wH,_p}function AH(r,e){return r[e]??NH()}function IH(r,e){const t=NH();t.hasReadASignal&&(r[e]=_p,t.lView=r,_p=new wH)}const Xt={};function _(r){kH(zn(),Ee(),ns()+r,!1)}function kH(r,e,t,n){if(!n)if(3==(3&e[Kt])){const s=r.preOrderCheckHooks;null!==s&&kh(e,s,t)}else{const s=r.preOrderHooks;null!==s&&xh(e,s,0,t)}n6(t)}function B(r,e=cn.Default){const t=Ee();return null===t?Pe(r,e):Kz(ti(),t,$t(r),e)}function vp(r,e,t,n,i,s,o,a,c,l,f){const d=e.blueprint.slice();return d[Rr]=i,d[Kt]=140|n,(null!==l||r&&2048&r[Kt])&&(d[Kt]|=2048),Tz(d),d[Q1]=d[Q0]=r,d[zr]=t,d[X0]=o||r&&r[X0],d[Zt]=a||r&&r[Zt],d[w4]=c||r&&r[w4]||null,d[Ti]=s,d[e7]=function a0e(){return o0e++}(),d[g3]=f,d[lz]=l,d[Dr]=2==e.type?r[Dr]:d,d}function S8(r,e,t,n,i){let s=r.data[e];if(null===s)s=GM(r,e,t,n,i),function a6e(){return Vt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=i;const o=n7();s.injectorIndex=null===o?-1:o.injectorIndex}return cc(s,!0),s}function GM(r,e,t,n,i){const s=Iz(),o=zy(),c=r.data[e]=function n5e(r,e,t,n,i,s){let o=e?e.injectorIndex:-1,a=0;return n8()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}function S7(r,e,t,n){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function LH(r,e,t,n,i){const s=AH(e,Eh),o=ns(),a=2&n;try{if(n6(-1),a&&e.length>gn&&kH(r,e,gn,!1),ac(a?2:0,i),a)s.runInContext(t,n,i);else{const l=O2(null);try{t(n,i)}finally{O2(l)}}}finally{a&&null===e[Eh]&&IH(e,Eh),n6(o),ac(a?3:1,i)}}function BM(r,e,t){if(Ny(e)){const n=O2(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=r.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{O2(n)}}}function UM(r,e,t){Az()&&(function l5e(r,e,t,n){const i=t.directiveStart,s=t.directiveEnd;e6(t)&&function m5e(r,e,t){const n=ws(e,r),i=RH(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=Cp(r,vp(r,i,null,o,n,e,null,r[X0].rendererFactory.createRenderer(n,t),null,null,null));r[e.index]=a}(e,t,r.data[i+t.componentOffset]),r.firstCreatePass||Rh(t,e),Oi(n,e);const o=t.initialInputs;for(let a=i;a<s;a++){const c=r.data[a],l=r6(e,r,a,t);Oi(l,e),null!==o&&_5e(0,a-i,l,c,0,o),ga(c)&&(Js(t.index,e)[zr]=r6(e,r,a,t))}}(r,e,t,ws(t,e)),64==(64&t.flags)&&FH(r,e,t))}function WM(r,e,t=ws){const n=e.localNames;if(null!==n){let i=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,r):r[o];r[i++]=a}}}function RH(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=qM(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function qM(r,e,t,n,i,s,o,a,c,l,f){const d=gn+n,m=d+i,E=function K8e(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:Xt);return t}(d,m),w="function"==typeof l?l():l;return E[Je]={type:r,blueprint:E,template:t,queries:null,viewQuery:a,declTNode:e,data:E.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:f}}let zH=r=>null;function DH(r,e,t,n){for(let i in r)if(r.hasOwnProperty(i)){t=null===t?{}:t;const s=r[i];null===n?HH(t,e,i,s):n.hasOwnProperty(i)&&HH(t,e,n[i],s)}return t}function HH(r,e,t,n){r.hasOwnProperty(t)?r[t].push(e,n):r[t]=[e,n]}function ro(r,e,t,n,i,s,o,a){const c=ws(e,t);let f,l=e.inputs;!a&&null!=l&&(f=l[n])?(XM(r,t,f,n,i),e6(e)&&function s5e(r,e){const t=Js(e,r);16&t[Kt]||(t[Kt]|=64)}(t,e.index)):3&e.type&&(n=function i5e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=o?o(i,e.value||"",n):i,s.setProperty(c,n,i))}function jM(r,e,t,n){if(Az()){const i=null===n?null:{"":-1},s=function f5e(r,e){const t=r.directiveRegistry;let n=null,i=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(rz(e,o.selectors,!1))if(n||(n=[]),ga(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),n.unshift(...a,o),ZM(r,e,a.length)}else n.unshift(o),ZM(r,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,n,i),n.push(o)}return null===n?null:[n,i]}(r,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&VH(r,e,t,o,i,a),i&&function d5e(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new ge(-301,!1);n.push(e[i],s)}}}(t,n,i)}t.mergedAttrs=Ku(t.mergedAttrs,t.attrs)}function VH(r,e,t,n,i,s){for(let l=0;l<n.length;l++)Zy(Rh(t,e),r,n[l].type);!function p5e(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}(t,r.data.length,n.length);for(let l=0;l<n.length;l++){const f=n[l];f.providersResolver&&f.providersResolver(f)}let o=!1,a=!1,c=S7(r,e,n.length,null);for(let l=0;l<n.length;l++){const f=n[l];t.mergedAttrs=Ku(t.mergedAttrs,f.hostAttrs),g5e(r,t,e,c,f),h5e(c,f,i),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const d=f.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((r.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function r5e(r,e,t){const i=e.directiveEnd,s=r.data,o=e.attrs,a=[];let c=null,l=null;for(let f=e.directiveStart;f<i;f++){const d=s[f],m=t?t.get(d):null,w=m?m.outputs:null;c=DH(d.inputs,f,c,m?m.inputs:null),l=DH(d.outputs,f,l,w);const R=null===c||null===o||nz(e)?null:v5e(c,f,o);a.push(R)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(r,t,s)}function FH(r,e,t){const n=t.directiveStart,i=t.directiveEnd,s=t.index,o=function l6e(){return Vt.lFrame.currentDirectiveIndex}();try{n6(s);for(let a=n;a<i;a++){const c=r.data[a],l=e[a];Hy(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&u5e(c,l)}}finally{n6(-1),Hy(o)}}function u5e(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function ZM(r,e,t){e.componentOffset=t,(r.components??=[]).push(e.index)}function h5e(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;ga(e)&&(t[""]=r)}}function g5e(r,e,t,n,i){r.data[n]=i;const s=i.factory||(i.factory=t6(i.type)),o=new r7(s,ga(i),B);r.blueprint[n]=o,t[n]=o,function a5e(r,e,t,n,i){const s=i.hostBindings;if(s){let o=r.hostBindingOpCodes;null===o&&(o=r.hostBindingOpCodes=[]);const a=~e.index;(function c5e(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(r,e,n,S7(r,t,i.hostVars,Xt),i)}function dc(r,e,t,n,i,s){const o=ws(r,e);YM(e[Zt],o,s,r.value,t,n,i)}function YM(r,e,t,n,i,s,o){if(null==s)r.removeAttribute(e,i,t);else{const a=null==o?jt(s):o(s,n||"",i);r.setAttribute(e,i,a,t)}}function _5e(r,e,t,n,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)$H(n,t,o[a++],o[a++],o[a++])}function $H(r,e,t,n,i){const s=O2(null);try{const o=r.inputTransforms;null!==o&&o.hasOwnProperty(n)&&(i=o[n].call(e,i)),null!==r.setInput?r.setInput(e,i,t,n):e[n]=i}finally{O2(s)}}function v5e(r,e,t){let n=null,i=0;for(;i<t.length;){const s=t[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(r.hasOwnProperty(s)){null===n&&(n=[]);const o=r[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function GH(r,e,t,n){return[r,!0,!1,e,null,0,n,t,null,null,null]}function BH(r,e){const t=r.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const s=t[n+1];if(-1!==s){const o=r.data[s];Fy(t[n]),o.contentQueries(2,e[s],s)}}}function Cp(r,e){return r[Qu]?r[cz][pa]=e:r[Qu]=e,r[cz]=e,e}function KM(r,e,t){Fy(0);const n=O2(null);try{e(r,t)}finally{O2(n)}}function UH(r){return r[K0]||(r[K0]=[])}function WH(r){return r.cleanup||(r.cleanup=[])}function jH(r,e){const t=r[w4],n=t?t.get(a6,null):null;n&&n.handleError(e)}function XM(r,e,t,n,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];$H(r.data[o],e[o],n,a,i)}}function M3(r,e,t){const n=Nh(e,r);OD(r[Zt],n,t)}function C5e(r,e){const t=Js(e,r),n=t[Je];!function y5e(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])}(n,t);const i=t[Rr];null!==i&&null===t[g3]&&(t[g3]=LM(i,t[w4])),QM(n,t,t[zr])}function QM(r,e,t){$y(e);try{const n=r.viewQuery;null!==n&&KM(1,n,t);const i=r.template;null!==i&&LH(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&BH(r,e),r.staticViewQueries&&KM(2,r.viewQuery,t);const s=r.components;null!==s&&function M5e(r,e){for(let t=0;t<e.length;t++)C5e(r,e[t])}(e,s)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[Kt]&=-5,Gy()}}let ZH=(()=>{var r;class e{constructor(){this.all=new Set,this.queue=new Map}create(n,i,s){const o=typeof Zone>"u"?null:Zone.current,a=new Vle(n,f=>{this.all.has(f)&&this.queue.set(f,o)},s);let c;this.all.add(a),a.notify();const l=()=>{a.cleanup(),c?.(),this.all.delete(a),this.queue.delete(a)};return c=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[n,i]of this.queue)this.queue.delete(n),i?i.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function yp(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=dy(i,a):2==s&&(n=dy(n,a+": "+e[++o]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}function P7(r,e,t,n,i=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(N1(s)),bs(s)){for(let a=ei;a<s.length;a++){const c=s[a],l=c[Je].firstChild;null!==l&&P7(c[Je],c,l,n)}s[sc]!==s[Rr]&&n.push(s[sc])}const o=t.type;if(8&o)P7(r,e,t.child,n);else if(32&o){const a=oM(t,e);let c;for(;c=a();)n.push(c)}else if(16&o){const a=RD(e,t);if(Array.isArray(a))n.push(...a);else{const c=f7(e[Dr]);P7(c[Je],c,a,n,!0)}}t=i?t.projectionNext:t.next}return n}function Mp(r,e,t,n=!0){const i=e[X0],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{YH(r,e,r.template,t)}catch(c){throw n&&jH(e,c),c}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function YH(r,e,t,n){const i=e[Kt];if(256!=(256&i)){e[X0].effectManager?.flush(),$y(e);try{Tz(e),function xz(r){return Vt.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&LH(r,e,t,2,n);const o=3==(3&i);if(o){const l=r.preOrderCheckHooks;null!==l&&kh(e,l,null)}else{const l=r.preOrderHooks;null!==l&&xh(e,l,0,null),By(e,0)}if(function P5e(r){for(let e=SD(r);null!==e;e=PD(e)){if(!e[uz])continue;const t=e[e8];for(let n=0;n<t.length;n++){Kle(t[n])}}}(e),KH(e,2),null!==r.contentQueries&&BH(r,e),o){const l=r.contentCheckHooks;null!==l&&kh(e,l)}else{const l=r.contentHooks;null!==l&&xh(e,l,1),By(e,1)}!function Y8e(r,e){const t=r.hostBindingOpCodes;if(null===t)return;const n=AH(e,Sh);try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)n6(~s);else{const o=s,a=t[++i],c=t[++i];c6e(a,o),n.runInContext(c,2,e[o])}}}finally{null===e[Sh]&&IH(e,Sh),n6(-1)}}(r,e);const a=r.components;null!==a&&QH(e,a,0);const c=r.viewQuery;if(null!==c&&KM(2,c,n),o){const l=r.viewCheckHooks;null!==l&&kh(e,l)}else{const l=r.viewHooks;null!==l&&xh(e,l,2),By(e,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),e[Kt]&=-73,Oz(e)}finally{Gy()}}}function KH(r,e){for(let t=SD(r);null!==t;t=PD(t))for(let n=ei;n<t.length;n++)XH(t[n],e)}function T5e(r,e,t){XH(Js(e,r),t)}function XH(r,e){if(!function Zle(r){return 128==(128&r[Kt])}(r))return;const t=r[Je];if(80&r[Kt]&&0===e||1024&r[Kt]||2===e)YH(t,r,t.template,r[zr]);else if(r[Xu]>0){KH(r,1);const i=r[Je].components;null!==i&&QH(r,i,1)}}function QH(r,e,t){for(let n=0;n<e.length;n++)T5e(r,e[n],t)}class T7{get rootNodes(){const e=this._lView,t=e[Je];return P7(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[zr]}set context(e){this._lView[zr]=e}get destroyed(){return 256==(256&this._lView[Kt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Q1];if(bs(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Kh(e,n),Vh(t,n))}this._attachedToViewContainer=!1}cM(this._lView[Je],this._lView)}onDestroy(e){!function wz(r,e){if(256==(256&r[Kt]))throw new ge(911,!1);null===r[N4]&&(r[N4]=[]),r[N4].push(e)}(this._lView,e)}markForCheck(){E7(this._cdRefInjectingView||this._lView)}detach(){this._lView[Kt]&=-129}reattach(){this._lView[Kt]|=128}detectChanges(){Mp(this._lView[Je],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function M0e(r,e){h7(r,e,e[Zt],2,null,null)}(this._lView[Je],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=e}}class O5e extends T7{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Mp(e[Je],e,e[zr],!1)}checkNoChanges(){}get context(){return null}}class JH extends gp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Rn(e);return new O7(t,this.ngModule)}}function eV(r){const e=[];for(let t in r)r.hasOwnProperty(t)&&e.push({propName:r[t],templateName:t});return e}class w5e{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=vh(n);const i=this.injector.get(e,DM,n);return i!==DM||t===DM?i:this.parentInjector.get(e,t,n)}}class O7 extends dH{get inputs(){const e=this.componentDef,t=e.inputTransforms,n=eV(e.inputs);if(null!==t)for(const i of n)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return n}get outputs(){return eV(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Mle(r){return r.map(yle).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,i){let s=(i=i||this.ngModule)instanceof no?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new w5e(e,s):e,a=o.get(M7,null);if(null===a)throw new ge(407,!1);const d={rendererFactory:a,sanitizer:o.get(x8e,null),effectManager:o.get(ZH,null),afterRenderEventManager:o.get(FM,null)},m=a.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",w=n?function X8e(r,e,t,n){const s=n.get(PH,!1)||t===wo.ShadowDom,o=r.selectRootElement(e,s);return function Q8e(r){zH(r)}(o),o}(m,n,this.componentDef.encapsulation,o):Yh(m,E,function b5e(r){const e=r.toLowerCase();return"svg"===e?Ez:"math"===e?"math":null}(E)),$=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let G=null;null!==w&&(G=LM(w,o,!0));const de=qM(0,null,null,1,0,null,null,null,null,null,null),ve=vp(null,de,null,$,null,null,d,m,o,null,G);let xe,tt;$y(ve);try{const pt=this.componentDef;let Cn,Mt=null;pt.findHostDirectiveDefs?(Cn=[],Mt=new Map,pt.findHostDirectiveDefs(pt,Cn,Mt),Cn.push(pt)):Cn=[pt];const Y2=function A5e(r,e){const t=r[Je],n=gn;return r[n]=e,S8(t,n,2,"#host",null)}(ve,w),$0=function I5e(r,e,t,n,i,s,o){const a=i[Je];!function k5e(r,e,t,n){for(const i of r)e.mergedAttrs=Ku(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(yp(e,e.mergedAttrs,!0),null!==t&&VD(n,t,e))}(n,r,e,o);let c=null;null!==e&&(c=LM(e,i[w4]));const l=s.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const d=vp(i,RH(t),null,f,i[r.index],r,s,l,null,null,c);return a.firstCreatePass&&ZM(a,r,n.length-1),Cp(i,d),i[r.index]=d}(Y2,w,pt,Cn,ve,d,m);tt=Pz(de,gn),w&&function L5e(r,e,t,n){if(n)Oy(r,t,["ng-version",pH.full]);else{const{attrs:i,classes:s}=function Ele(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let s=r[n];if("string"==typeof s)2===i?""!==s&&e.push(s,r[++n]):8===i&&t.push(s);else{if(!ha(i))break;i=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);i&&Oy(r,t,i),s&&s.length>0&&HD(r,t,s.join(" "))}}(m,pt,w,n),void 0!==t&&function R5e(r,e,t){const n=r.projection=[];for(let i=0;i<e.length;i++){const s=t[i];n.push(null!=s?Array.from(s):null)}}(tt,this.ngContentSelectors,t),xe=function x5e(r,e,t,n,i,s){const o=ti(),a=i[Je],c=ws(o,i);VH(a,i,o,t,null,n);for(let f=0;f<t.length;f++)Oi(r6(i,a,o.directiveStart+f,o),i);FH(a,i,o),c&&Oi(c,i);const l=r6(i,a,o.directiveStart+o.componentOffset,o);if(r[zr]=i[zr]=l,null!==s)for(const f of s)f(l,e);return BM(a,o,r),l}($0,pt,Cn,Mt,ve,[z5e]),QM(de,ve,null)}finally{Gy()}return new N5e(this.componentType,xe,C8(tt,ve),ve,tt)}}class N5e extends b8e{constructor(e,t,n,i,s){super(),this.location=n,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new O5e(i),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;XM(s[Je],s,i,e,t),this.previousInputValues.set(e,t),E7(Js(this._tNode.index,s))}}get injector(){return new rs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function z5e(){const r=ti();Ih(Ee()[Je],r)}function Xe(r){let e=function tV(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(ga(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ge(903,!1);i=e.\u0275dir}if(i){if(t){n.push(i);const o=r;o.inputs=Ep(r.inputs),o.inputTransforms=Ep(r.inputTransforms),o.declaredInputs=Ep(r.declaredInputs),o.outputs=Ep(r.outputs);const a=i.hostBindings;a&&F5e(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&H5e(r,c),l&&V5e(r,l),dh(r.inputs,i.inputs),dh(r.declaredInputs,i.declaredInputs),dh(r.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),dh(o.inputTransforms,i.inputTransforms)),ga(i)&&i.data.animation){const f=r.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(r),a===Xe&&(t=!1)}}e=Object.getPrototypeOf(e)}!function D5e(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=Ku(i.hostAttrs,t=Ku(t,i.hostAttrs))}}(n)}function Ep(r){return r===rc?{}:r===jn?[]:r}function H5e(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function V5e(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,s)=>{e(n,i,s),t(n,i,s)}:e}function F5e(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}function sV(r){const e=r.inputConfig,t={};for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];Array.isArray(i)&&i[2]&&(t[n]=i[2])}r.inputTransforms=t}function Sp(r){return!!JM(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function JM(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function hc(r,e,t){return r[e]=t}function wi(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function c6(r,e,t,n){const i=wi(r,e,t);return wi(r,e+1,n)||i}function I(r,e,t,n){const i=Ee();return wi(i,r8(),e)&&(zn(),dc(or(),i,r,e,t,n)),I}function T8(r,e,t,n){return wi(r,r8(),t)?e+jt(t)+n:Xt}function O8(r,e,t,n,i,s){const a=c6(r,m3(),t,i);return _3(2),a?e+jt(t)+n+jt(i)+s:Xt}function b8(r,e,t,n,i,s,o,a){const l=function Pp(r,e,t,n,i){const s=c6(r,e,t,n);return wi(r,e+2,i)||s}(r,m3(),t,i,o);return _3(3),l?e+jt(t)+n+jt(i)+s+jt(o)+a:Xt}function l6(r,e,t,n,i,s){const o=Ee(),a=T8(o,e,t,n);return a!==Xt&&dc(or(),o,r,a,i,s),l6}function T(r,e,t,n,i,s,o,a){const c=Ee(),l=zn(),f=r+gn,d=l.firstCreatePass?function fue(r,e,t,n,i,s,o,a,c){const l=e.consts,f=S8(e,r,4,o||null,A4(l,a));jM(e,t,f,A4(l,c)),Ih(e,f);const d=f.tView=qM(2,f,n,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,f),d.queries=e.queries.embeddedTView(f)),f}(f,l,c,e,t,n,i,s,o):l.data[f];cc(d,!1);const m=_V(l,c,d,r);Ah()&&Qh(l,c,m,d),Oi(m,c),Cp(c,c[f]=GH(m,c,m,d)),Th(d)&&UM(l,c,d),null!=o&&WM(c,d,a)}let _V=function vV(r,e,t,n){return I4(!0),e[Zt].createComment("")};function ln(r){return t8(function o6e(){return Vt.lFrame.contextLView}(),gn+r)}function y(r,e,t){const n=Ee();return wi(n,r8(),e)&&ro(zn(),or(),n,r,e,n[Zt],t,!1),y}function sE(r,e,t,n,i){const o=i?"class":"style";XM(r,t,e.inputs[o],o,n)}function S(r,e,t,n){const i=Ee(),s=zn(),o=gn+r,a=i[Zt],c=s.firstCreatePass?function gue(r,e,t,n,i,s){const o=e.consts,c=S8(e,r,2,n,A4(o,i));return jM(e,t,c,A4(o,s)),null!==c.attrs&&yp(c,c.attrs,!1),null!==c.mergedAttrs&&yp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,i,e,t,n):s.data[o],l=CV(s,i,c,a,e,r);i[o]=l;const f=Th(c);return cc(c,!0),VD(a,l,c),32!=(32&c.flags)&&Ah()&&Qh(s,i,l,c),0===function Qle(){return Vt.lFrame.elementDepthCount}()&&Oi(l,i),function Jle(){Vt.lFrame.elementDepthCount++}(),f&&(UM(s,i,c),BM(s,c,i)),null!==n&&WM(i,c),S}function P(){let r=ti();zy()?Dy():(r=r.parent,cc(r,!1));const e=r;(function t6e(r){return Vt.skipHydrationRootTNode===r})(e)&&function s6e(){Vt.skipHydrationRootTNode=null}(),function e6e(){Vt.lFrame.elementDepthCount--}();const t=zn();return t.firstCreatePass&&(Ih(t,r),Ny(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function C6e(r){return 0!=(8&r.flags)}(e)&&sE(t,e,Ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function y6e(r){return 0!=(16&r.flags)}(e)&&sE(t,e,Ee(),e.stylesWithoutHost,!1),P}function F(r,e,t,n){return S(r,e,t,n),P(),F}let CV=(r,e,t,n,i,s)=>(I4(!0),Yh(n,i,function $z(){return Vt.lFrame.currentNamespace}()));function Gt(r,e,t){const n=Ee(),i=zn(),s=r+gn,o=i.firstCreatePass?function vue(r,e,t,n,i){const s=e.consts,o=A4(s,n),a=S8(e,r,8,"ng-container",o);return null!==o&&yp(a,o,!0),jM(e,t,a,A4(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,n,e,t):i.data[s];cc(o,!0);const a=MV(i,n,o,r);return n[s]=a,Ah()&&Qh(i,n,a,o),Oi(a,n),Th(o)&&(UM(i,n,o),BM(i,o,n)),null!=t&&WM(n,o),Gt}function Bt(){let r=ti();const e=zn();return zy()?Dy():(r=r.parent,cc(r,!1)),e.firstCreatePass&&(Ih(e,r),Ny(r)&&e.queries.elementEnd(r)),Bt}let MV=(r,e,t,n)=>(I4(!0),aM(e[Zt],""));function pe(){return Ee()}function I7(r){return!!r&&"function"==typeof r.then}function EV(r){return!!r&&"function"==typeof r.subscribe}function W(r,e,t,n){const i=Ee(),s=zn(),o=ti();return function PV(r,e,t,n,i,s,o){const a=Th(n),l=r.firstCreatePass&&WH(r),f=e[zr],d=UH(e);let m=!0;if(3&n.type||o){const R=ws(n,e),z=o?o(R):R,$=d.length,G=o?ve=>o(N1(ve[n.index])):n.index;let de=null;if(!o&&a&&(de=function Mue(r,e,t,n){const i=r.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===n){const a=e[K0],c=i[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(r,e,i,n.index)),null!==de)(de.__ngLastListenerFn__||de).__ngNextListenerFn__=s,de.__ngLastListenerFn__=s,m=!1;else{s=OV(n,e,f,s,!1);const ve=t.listen(z,i,s);d.push(s,ve),l&&l.push(i,G,$,$+1)}}else s=OV(n,e,f,s,!1);const E=n.outputs;let w;if(m&&null!==E&&(w=E[i])){const R=w.length;if(R)for(let z=0;z<R;z+=2){const xe=e[w[z]][w[z+1]].subscribe(s),tt=d.length;d.push(s,xe),l&&l.push(i,n.index,tt,-(tt+1))}}}(s,i,i[Zt],o,r,e,n),W}function TV(r,e,t,n){try{return ac(6,e,t),!1!==t(n)}catch(i){return jH(r,i),!1}finally{ac(7,e,t)}}function OV(r,e,t,n,i){return function s(o){if(o===Function)return n;E7(r.componentOffset>-1?Js(r.index,e):e);let c=TV(e,t,n,o),l=s.__ngNextListenerFn__;for(;l;)c=TV(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&o.preventDefault(),c}}function p(r=1){return function f6e(r){return(Vt.lFrame.contextLView=function d6e(r,e){for(;r>0;)e=e[Q0],r--;return e}(r,Vt.lFrame.contextLView))[zr]}(r)}function Eue(r,e){let t=null;const n=function mle(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===n?rz(r,s,!0):Cle(n,s))return i}else t=i}return t}function Dn(r,e,t,n,i){const s=Ee(),o=T8(s,e,t,n);return o!==Xt&&ro(zn(),or(),s,r,o,s[Zt],i,!1),Dn}function Ce(r,e,t,n,i,s,o){const a=Ee(),c=O8(a,e,t,n,i,s);return c!==Xt&&ro(zn(),or(),a,r,c,a[Zt],o,!1),Ce}function Ni(r,e,t,n,i,s,o,a,c){const l=Ee(),f=b8(l,e,t,n,i,s,o,a);return f!==Xt&&ro(zn(),or(),l,r,f,l[Zt],c,!1),Ni}function wp(r,e){return r<<17|e<<2}function x4(r){return r>>17&32767}function oE(r){return 2|r}function u6(r){return(131068&r)>>2}function aE(r,e){return-131069&r|e<<2}function cE(r){return 1|r}function zV(r,e,t,n,i){const s=r[t+1],o=null===e;let a=n?x4(s):u6(s),c=!1;for(;0!==a&&(!1===c||o);){const f=r[a+1];wue(r[a],e)&&(c=!0,r[a+1]=n?cE(f):oE(f)),a=n?x4(f):u6(f)}c&&(r[t+1]=n?oE(s):cE(s))}function wue(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&f8(r,e)>=0}const u2={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function DV(r){return r.substring(u2.key,u2.keyEnd)}function Nue(r){return r.substring(u2.value,u2.valueEnd)}function VV(r,e){const t=u2.textEnd;let n=u2.key=x8(r,e,t);return t===n?-1:(n=u2.keyEnd=function xue(r,e,t){let n;for(;e<t&&(45===(n=r.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(r,n,t),n=$V(r,n,t),n=u2.value=x8(r,n,t),n=u2.valueEnd=function Lue(r,e,t){let n=-1,i=-1,s=-1,o=e,a=o;for(;o<t;){const c=r.charCodeAt(o++);if(59===c)return a;34===c||39===c?a=o=GV(r,c,o,t):e===o-4&&85===s&&82===i&&76===n&&40===c?a=o=GV(r,41,o,t):c>32&&(a=o),s=i,i=n,n=-33&c}return a}(r,n,t),$V(r,n,t))}function x8(r,e,t){for(;e<t&&r.charCodeAt(e)<=32;)e++;return e}function $V(r,e,t,n){return(e=x8(r,e,t))<t&&e++,e}function GV(r,e,t,n){let i=-1,s=t;for(;s<n;){const o=r.charCodeAt(s++);if(o==e&&92!==i)return s;i=92==o&&92===i?0:o}throw new Error}function Np(r,e){return function ma(r,e,t,n){const i=Ee(),s=zn(),o=_3(2);s.firstUpdatePass&&WV(s,r,o,n),e!==Xt&&wi(i,o,e)&&jV(s,s.data[ns()],i,i[Zt],r,i[o+1]=function Uue(r,e){return null==r||""===r||("string"==typeof e?r+=e:"object"==typeof r&&(r=c2(to(r)))),r}(e,t),n,o)}(r,e,null,!0),Np}function ri(r){!function _a(r,e,t,n){const i=zn(),s=_3(2);i.firstUpdatePass&&WV(i,null,s,n);const o=Ee();if(t!==Xt&&wi(o,s,t)){const a=i.data[ns()];if(YV(a,n)&&!UV(i,s)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=dy(c,t||"")),sE(i,a,o,t,n)}else!function Bue(r,e,t,n,i,s,o,a){i===Xt&&(i=jn);let c=0,l=0,f=0<i.length?i[0]:null,d=0<s.length?s[0]:null;for(;null!==f||null!==d;){const m=c<i.length?i[c+1]:void 0,E=l<s.length?s[l+1]:void 0;let R,w=null;f===d?(c+=2,l+=2,m!==E&&(w=d,R=E)):null===d||null!==f&&f<d?(c+=2,w=f):(l+=2,w=d,R=E),null!==w&&jV(r,e,t,n,w,R,o,a),f=c<i.length?i[c]:null,d=l<s.length?s[l]:null}}(i,a,o,o[Zt],o[s+1],o[s+1]=function $ue(r,e,t){if(null==t||""===t)return jn;const n=[],i=to(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)r(n,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&r(n,s,i[s]);else"string"==typeof i&&e(n,i);return n}(r,e,t),n,s)}}(qV,Rue,r,!1)}function Rue(r,e){for(let t=function Iue(r){return function FV(r){u2.key=0,u2.keyEnd=0,u2.value=0,u2.valueEnd=0,u2.textEnd=r.length}(r),VV(r,x8(r,0,u2.textEnd))}(e);t>=0;t=VV(e,t))qV(r,DV(e),Nue(e))}function UV(r,e){return e>=r.expandoStartIndex}function WV(r,e,t,n){const i=r.data;if(null===i[t+1]){const s=i[ns()],o=UV(r,t);YV(s,n)&&null===e&&!o&&(e=!1),e=function Due(r,e,t,n){const i=function Vy(r){const e=Vt.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}(r);let s=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=k7(t=lE(null,r,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||r[o]!==i)if(t=lE(i,r,e,t,n),null===s){let c=function Hue(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==u6(n))return r[x4(n)]}(r,e,n);void 0!==c&&Array.isArray(c)&&(c=lE(null,r,e,c[1],n),c=k7(c,e.attrs,n),function Vue(r,e,t,n){r[x4(t?e.classBindings:e.styleBindings)]=n}(r,e,n,c))}else s=function Fue(r,e,t){let n;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)n=k7(n,r[s].hostAttrs,t);return k7(n,e.attrs,t)}(r,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,n),function Oue(r,e,t,n,i,s){let o=s?e.classBindings:e.styleBindings,a=x4(o),c=u6(o);r[n]=t;let f,l=!1;if(Array.isArray(t)?(f=t[1],(null===f||f8(t,f)>0)&&(l=!0)):f=t,i)if(0!==c){const m=x4(r[a+1]);r[n+1]=wp(m,a),0!==m&&(r[m+1]=aE(r[m+1],n)),r[a+1]=function Pue(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=wp(a,0),0!==a&&(r[a+1]=aE(r[a+1],n)),a=n;else r[n+1]=wp(c,0),0===a?a=n:r[c+1]=aE(r[c+1],n),c=n;l&&(r[n+1]=oE(r[n+1])),zV(r,f,n,!0),zV(r,f,n,!1),function bue(r,e,t,n,i){const s=i?r.residualClasses:r.residualStyles;null!=s&&"string"==typeof e&&f8(s,e)>=0&&(t[n+1]=cE(t[n+1]))}(e,f,r,n,s),o=wp(a,c),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,n)}}function lE(r,e,t,n,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=k7(n,s.hostAttrs,i),s!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function k7(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),eo(r,o,!!t||e[++s]))}return void 0===r?null:r}function qV(r,e,t){eo(r,e,to(t))}function jV(r,e,t,n,i,s,o,a){if(!(3&e.type))return;const c=r.data,l=c[a+1],f=function Tue(r){return 1==(1&r)}(l)?ZV(c,e,t,i,u6(l),o):void 0;Ap(f)||(Ap(s)||function Sue(r){return 2==(2&r)}(l)&&(s=ZV(c,null,t,i,a,o)),function I0e(r,e,t,n,i){if(e)i?r.addClass(t,n):r.removeClass(t,n);else{let s=-1===n.indexOf("-")?void 0:k4.DashCase;null==i?r.removeStyle(t,n,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=k4.Important),r.setStyle(t,n,i,s))}}(n,o,Nh(ns(),t),i,s))}function ZV(r,e,t,n,i,s){const o=null===e;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),f=l?c[1]:c,d=null===f;let m=t[i+1];m===Xt&&(m=d?jn:void 0);let E=d?Xy(m,n):f===n?m:void 0;if(l&&!Ap(E)&&(E=Xy(c,n)),Ap(E)&&(a=E,o))return a;const w=r[i+1];i=o?x4(w):u6(w)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=Xy(c,n))}return a}function Ap(r){return void 0!==r}function YV(r,e){return 0!=(r.flags&(e?8:16))}function ct(r,e=""){const t=Ee(),n=zn(),i=r+gn,s=n.firstCreatePass?S8(n,i,1,e,null):n.data[i],o=KV(n,t,s,e,r);t[i]=o,Ah()&&Qh(n,t,o,s),cc(s,!1)}let KV=(r,e,t,n,i)=>(I4(!0),Zh(e[Zt],n));function An(r){return b2("",r,""),An}function b2(r,e,t){const n=Ee(),i=T8(n,r,e,t);return i!==Xt&&M3(n,ns(),i),b2}function uE(r,e,t,n,i){const s=Ee(),o=O8(s,r,e,t,n,i);return o!==Xt&&M3(s,ns(),o),uE}function fE(r,e,t,n,i,s,o){const a=Ee(),c=b8(a,r,e,t,n,i,s,o);return c!==Xt&&M3(a,ns(),c),fE}function dE(r,e,t){const n=Ee();return wi(n,r8(),e)&&ro(zn(),or(),n,r,e,n[Zt],t,!0),dE}const f6=void 0;var d7e=["en",[["a","p"],["AM","PM"],f6],[["AM","PM"],f6,f6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],f6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],f6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",f6,"{1} 'at' {0}",f6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function f7e(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let L8={};function ss(r){const e=function p7e(r){return r.toLowerCase().replace(/_/g,"-")}(r);let t=pF(e);if(t)return t;const n=e.split("-")[0];if(t=pF(n),t)return t;if("en"===n)return d7e;throw new ge(701,!1)}function pF(r){return r in L8||(L8[r]=C1.ng&&C1.ng.common&&C1.ng.common.locales&&C1.ng.common.locales[r]),L8[r]}var A1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(A1||{});const g7e=["zero","one","two","few","many"],R8="en-US",Ip={marker:"element"},kp={marker:"ICU"};var As=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(As||{});let gF=R8;function mF(r){(function bo(r,e){null==r&&Ht(e,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(gF=r.toLowerCase().replace(/_/g,"-"))}function _F(r,e,t){const n=e.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?kD(r,0,t):N1(t[i])}function vF(r,e,t,n,i){const s=e.insertBeforeIndex;if(Array.isArray(s)){let o=n,a=null;if(3&e.type||(a=o,o=i),null!==o&&-1===e.componentOffset)for(let c=1;c<s.length;c++)i6(r,o,t[s[c]],a,!1)}}function CF(r,e){if(r.push(e),r.length>1)for(let t=r.length-2;t>=0;t--){const n=r[t];yF(n)||C7e(n,e)&&null===y7e(n)&&M7e(n,e.index)}}function yF(r){return!(64&r.type)}function C7e(r,e){return yF(e)||r.index>e.index}function y7e(r){const e=r.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function M7e(r,e){const t=r.insertBeforeIndex;Array.isArray(t)?t[0]=e:(LD(_F,vF),r.insertBeforeIndex=e)}function x7(r,e){const t=r.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function P7e(r,e,t){const n=GM(r,t,64,null,null);return CF(e,n),n}function xp(r,e){const t=e[r.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function MF(r){return r>>>17}function EF(r){return(131070&r)>>>1}let L7=0,R7=0;function PF(r,e,t,n){const i=t[Zt];let o,s=null;for(let a=0;a<e.length;a++){const c=e[a];if("string"==typeof c){const l=e[++a];null===t[l]&&(t[l]=Zh(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=MF(c);let f,d;if(null===s&&(s=l,o=Xh(i,n)),l===s?(f=n,d=o):(f=null,d=N1(t[l])),null!==d){const R=EF(c);i6(i,d,t[R],f,!1);const $=x7(r,R);if(null!==$&&"object"==typeof $){const G=xp($,t);null!==G&&PF(r,$.create[G],t,t[$.anchorIdx])}}break;case 1:const E=e[++a],w=e[++a];YM(i,Nh(c>>>1,t),null,null,E,w,null)}else switch(c){case kp:const l=e[++a],f=e[++a];null===t[f]&&Oi(t[f]=aM(i,l),t);break;case Ip:const d=e[++a],m=e[++a];null===t[m]&&Oi(t[m]=Yh(i,d,null),t)}}}function TF(r,e,t,n,i){for(let s=0;s<t.length;s++){const o=t[s],a=t[++s];if(o&i){let c="";for(let l=s+1;l<=s+a;l++){const f=t[l];if("string"==typeof f)c+=f;else if("number"==typeof f)if(f<0)c+=jt(e[n-f]);else{const d=f>>>2;switch(3&f){case 1:const m=t[++l],E=t[++l],w=r.data[d];"string"==typeof w?YM(e[Zt],e[d],null,w,m,c,E):ro(r,w,e,m,c,e[Zt],E,!1);break;case 0:const R=e[d];null!==R&&OD(e[Zt],R,c);break;case 2:N7e(r,x7(r,d),e,c);break;case 3:OF(r,x7(r,d),n,e)}}}}else{const c=t[s+1];if(c>0&&3==(3&c)){const f=x7(r,c>>>2);e[f.currentCaseLViewIndex]<0&&OF(r,f,n,e)}}s+=a}}function OF(r,e,t,n){let i=n[e.currentCaseLViewIndex];if(null!==i){let s=L7;i<0&&(i=n[e.currentCaseLViewIndex]=~i,s=-1),TF(r,n,e.update[i],t,s)}}function N7e(r,e,t,n){const i=function A7e(r,e){let t=r.cases.indexOf(e);if(-1===t)switch(r.type){case 1:{const n=function m7e(r,e){const t=function hF(r){return ss(r)[A1.PluralCase]}(e)(parseInt(r,10)),n=g7e[t];return void 0!==n?n:"other"}(e,function v7e(){return gF}());t=r.cases.indexOf(n),-1===t&&"other"!==n&&(t=r.cases.indexOf("other"));break}case 0:t=r.cases.indexOf("other")}return-1===t?null:t}(e,n);if(xp(e,t)!==i&&(bF(r,e,t),t[e.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const o=t[e.anchorIdx];o&&PF(r,e.create[i],t,o)}}function bF(r,e,t){let n=xp(e,t);if(null!==n){const i=e.remove[n];for(let s=0;s<i.length;s++){const o=i[s];if(o>0){const a=Nh(o,t);null!==a&&Jh(t[Zt],a)}else bF(r,x7(r,~o),t)}}}function I7e(){const r=[];let t,n,e=-1;function s(a,c){e=0;const l=xp(a,c);n=null!==l?a.remove[l]:jn}function o(){if(e<n.length){const a=n[e++];return a>0?t[a]:(r.push(e,n),s(t[Je].data[~a],t),o())}return 0===r.length?null:(n=r.pop(),e=r.pop(),o())}return function i(a,c){for(t=c;r.length;)r.pop();return s(a.value,c),o}}const Lp=/\ufffd(\d+):?\d*\ufffd/gi,x7e=/\ufffd(\d+)\ufffd/,NF=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,z7="\ufffd",L7e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,R7e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,z7e=/\uE500/g;function AF(r,e,t,n,i,s,o){const a=S7(r,n,1,null);let c=a<<As.SHIFT,l=n7();e===l&&(l=null),null===l&&(c|=As.APPEND_EAGERLY),o&&(c|=As.COMMENT,function m0e(r){void 0===sM&&(sM=r())}(I7e)),i.push(c,null===s?"":s);const f=GM(r,a,o?32:1,null===s?"":s,null);CF(t,f);const d=f.index;return cc(f,!1),null!==l&&e!==l&&function S7e(r,e){let t=r.insertBeforeIndex;null===t?(LD(_F,vF),t=r.insertBeforeIndex=[null,e]):(function Jl(r,e,t){r!=e&&Ht(t,r,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(l,d),f}function V7e(r,e,t,n,i,s,o){const a=o.match(Lp),c=AF(r,e,t,s,n,a?null:o,!1);a&&D7(i,o,c.index,null,0,null)}function D7(r,e,t,n,i,s){const o=r.length,a=o+1;r.push(null,null);const c=o+2,l=e.split(Lp);let f=0;for(let d=0;d<l.length;d++){const m=l[d];if(1&d){const E=i+parseInt(m,10);r.push(-1-E),f|=IF(E)}else""!==m&&r.push(m)}return r.push(t<<2|(n?1:0)),n&&r.push(n,s),r[o]=f,r[a]=r.length-c,f}function IF(r){return 1<<Math.min(r,31)}function kF(r){let e,s,t="",n=0,i=!1;for(;null!==(e=L7e.exec(r));)i?e[0]===`${z7}/*${s}${z7}`&&(n=e.index,i=!1):(t+=r.substring(n,e.index+e[0].length),s=e[1],i=!0);return t+=r.slice(n),t}function xF(r,e,t,n,i,s){let o=0;const a={type:i.type,currentCaseLViewIndex:S7(r,e,1,null),anchorIdx:s,cases:[],create:[],remove:[],update:[]};(function j7e(r,e,t){r.push(IF(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,i,s),function E7e(r,e,t){const n=r.data[e];null===n?r.data[e]=t:n.value=t}(r,s,a);const c=i.values;for(let l=0;l<c.length;l++){const f=c[l],d=[];for(let m=0;m<f.length;m++){const E=f[m];if("string"!=typeof E){const w=d.push(E)-1;f[m]=`\x3c!--\ufffd${w}\ufffd--\x3e`}}o=W7e(r,a,e,t,n,i.cases[l],f.join(""),d)|o}o&&function Z7e(r,e,t){r.push(e,1,t<<2|3)}(t,o,s)}function U7e(r){const e=[],t=[];let n=1,i=0;const s=hE(r=r.replace(NF,function(o,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let o=0;o<s.length;){let a=s[o++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);const c=hE(s[o++]);e.length>t.length&&t.push(c)}return{type:n,mainBinding:i,cases:e,values:t}}function hE(r){if(!r)return[];let e=0;const t=[],n=[],i=/[{}]/g;let s;for(i.lastIndex=0;s=i.exec(r);){const a=s.index;if("}"==s[0]){if(t.pop(),0==t.length){const c=r.substring(e,a);NF.test(c)?n.push(U7e(c)):n.push(c),e=a+1}}else{if(0==t.length){const c=r.substring(e,a);n.push(c),e=a+1}t.push("{")}}const o=r.substring(e);return n.push(o),n}function W7e(r,e,t,n,i,s,o,a){const c=[],l=[],f=[];e.cases.push(s),e.create.push(c),e.remove.push(l),e.update.push(f);const m=BD(m8()).getInertBodyElement(o),E=CM(m)||m;return E?LF(r,e,t,n,c,l,f,E,i,a,0):0}function LF(r,e,t,n,i,s,o,a,c,l,f){let d=0,m=a.firstChild;for(;m;){const E=S7(r,t,1,null);switch(m.nodeType){case Node.ELEMENT_NODE:const w=m,R=w.tagName.toLowerCase();if(_M.hasOwnProperty(R)){pE(i,Ip,R,c,E),r.data[E]=R;const de=w.attributes;for(let ve=0;ve<de.length;ve++){const xe=de.item(ve),tt=xe.name.toLowerCase();xe.value.match(Lp)?jD.hasOwnProperty(tt)&&D7(o,xe.value,E,xe.name,0,vM[tt]?np:null):Y7e(i,E,xe)}d=LF(r,e,t,n,i,s,o,m,E,l,f+1)|d,RF(s,E,f)}break;case Node.TEXT_NODE:const z=m.textContent||"",$=z.match(Lp);pE(i,null,$?"":z,c,E),RF(s,E,f),$&&(d=D7(o,z,E,null,0,null)|d);break;case Node.COMMENT_NODE:const G=x7e.exec(m.textContent||"");if(G){const ve=l[parseInt(G[1],10)];pE(i,kp,"",c,E),xF(r,t,n,c,ve,E),q7e(s,E,f)}}m=m.nextSibling}return d}function RF(r,e,t){0===t&&r.push(e)}function q7e(r,e,t){0===t&&(r.push(~e),r.push(e))}function pE(r,e,t,n,i){null!==e&&r.push(e),r.push(t,i,function T7e(r,e,t){return r|e<<17|t<<1}(0,n,i))}function Y7e(r,e,t){r.push(e<<1|1,t.name,t.value)}function Is(r,e,t=-1){const n=zn(),i=Ee(),s=gn+r,o=A4(n.consts,e),a=n7();n.firstCreatePass&&function H7e(r,e,t,n,i,s){const o=n7(),a=[],c=[],l=[[]];i=function B7e(r,e){if(function G7e(r){return-1===r}(e))return kF(r);{const t=r.indexOf(`:${e}${z7}`)+2+e.toString().length,n=r.search(new RegExp(`${z7}\\/\\*\\d+:${e}${z7}`));return kF(r.substring(t,n))}}(i,s);const f=function D7e(r){return r.replace(z7e," ")}(i).split(R7e);for(let d=0;d<f.length;d++){let m=f[d];if(1&d){const E=47===m.charCodeAt(0),R=(m.charCodeAt(E?1:0),gn+Number.parseInt(m.substring(E?2:1)));if(E)l.shift(),cc(n7(),!1);else{const z=P7e(r,l[0],R);l.unshift([]),cc(z,!0)}}else{const E=hE(m);for(let w=0;w<E.length;w++){let R=E[w];if(1&w){const z=R;if("object"!=typeof z)throw new Error(`Unable to parse ICU expression in "${i}" message.`);xF(r,t,c,e,z,AF(r,o,l[0],t,a,"",!0).index)}else""!==R&&V7e(r,o,l[0],a,c,t,R)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,s,o,t),2===n.type?i[Dr][Kt]|=32:i[Kt]|=32;const c=n.data[s],f=wD(n,a===i[Ti]?null:a,i);(function w7e(r,e,t,n){const i=r[Zt];for(let s=0;s<e.length;s++){const o=e[s++],a=e[s],l=(o&As.APPEND_EAGERLY)===As.APPEND_EAGERLY,f=o>>>As.SHIFT;let d=r[f];null===d&&(d=r[f]=(o&As.COMMENT)===As.COMMENT?i.createComment(a):Zh(i,a)),l&&null!==t&&i6(i,t,d,n,!1)}})(i,c.create,f,a&&8&a.type?i[a.index]:null),Lz(!0)}function ks(){Lz(!1)}function oe(r,e,t){Is(r,e,t),ks()}function Gn(r){return function O7e(r){r&&(L7|=1<<Math.min(R7,31)),R7++}(wi(Ee(),r8(),r)),Gn}function Zn(r){!function b7e(r,e,t){if(R7>0){const n=r.data[t];TF(r,e,Array.isArray(n)?n:n.update,m3()-R7-1,L7)}L7=0,R7=0}(zn(),Ee(),r+gn)}function gE(r,e,t,n,i){if(r=$t(r),Array.isArray(r))for(let s=0;s<r.length;s++)gE(r[s],e,t,n,i);else{const s=zn(),o=Ee(),a=ti();let c=o6(r)?r:$t(r.provide);const l=iH(r),f=1048575&a.providerIndexes,d=a.directiveStart,m=a.providerIndexes>>20;if(o6(r)||!r.multi){const E=new r7(l,i,B),w=_E(c,e,i?f:f+m,d);-1===w?(Zy(Rh(a,o),s,c),mE(s,r,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(E),o.push(E)):(t[w]=E,o[w]=E)}else{const E=_E(c,e,f+m,d),w=_E(c,e,f,f+m),z=w>=0&&t[w];if(i&&!z||!i&&!(E>=0&&t[E])){Zy(Rh(a,o),s,c);const $=function ufe(r,e,t,n,i){const s=new r7(r,t,B);return s.multi=[],s.index=e,s.componentProviders=0,DF(s,i,n&&!t),s}(i?lfe:cfe,t.length,i,n,l);!i&&z&&(t[w].providerFactory=$),mE(s,r,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push($),o.push($)}else mE(s,r,E>-1?E:w,DF(t[i?w:E],l,!i&&n));!i&&n&&z&&t[w].componentProviders++}}}function mE(r,e,t,n){const i=o6(e),s=function u8e(r){return!!r.useClass}(e);if(i||s){const c=(s?$t(e.useClass):e).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const f=l.indexOf(t);-1===f?l.push(t,[n,c]):l[f+1].push(n,c)}else l.push(t,c)}}}function DF(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function _E(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function cfe(r,e,t,n){return vE(this.multi,[])}function lfe(r,e,t,n){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=r6(t,t[Je],this.providerFactory.index,n);s=a.slice(0,o),vE(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],vE(i,s);return s}function vE(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function J1(r,e=[]){return t=>{t.providersResolver=(n,i)=>function afe(r,e,t){const n=zn();if(n.firstCreatePass){const i=ga(r);gE(t,n.data,n.blueprint,i,!0),gE(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class d6{}class HF{}class CE extends d6{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new JH(this);const i=Qs(e);this._bootstrapComponents=y3(i.bootstrap),this._r3Injector=CH(e,t,[{provide:d6,useValue:this},{provide:gp,useValue:this.componentFactoryResolver},...n],c2(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class yE extends HF{constructor(e){super(),this.moduleType=e}create(e){return new CE(this.moduleType,e,[])}}class VF extends d6{constructor(e){super(),this.componentFactoryResolver=new JH(this),this.instance=null;const t=new cp([...e.providers,{provide:d6,useValue:this},{provide:gp,useValue:this.componentFactoryResolver}],e.parent||ap(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function ME(r,e,t=null){return new VF({providers:r,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let hfe=(()=>{var r;class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=eH(0,n.type),s=i.length>0?ME([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return(r=e).\u0275prov=De({token:r,providedIn:"environment",factory:()=>new r(Pe(no))}),e})();function FF(r){r.getStandaloneInjector=e=>e.get(hfe).getOrCreateStandaloneInjector(r)}function H1(r,e,t){const n=ts()+r,i=Ee();return i[n]===Xt?hc(i,n,t?e.call(t):e()):function b7(r,e){return r[e]}(i,n)}function va(r,e,t,n){return jF(Ee(),ts(),r,e,t,n)}function H7(r,e){const t=r[e];return t===Xt?void 0:t}function jF(r,e,t,n,i,s){const o=e+t;return wi(r,o,i)?hc(r,o+1,s?n.call(s,i):n(i)):H7(r,o+1)}function Ca(r,e){const t=zn();let n;const i=r+gn;t.firstCreatePass?(n=function Afe(r,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(r===n.name)return n}}(e,t.pipeRegistry),t.data[i]=n,n.onDestroy&&(t.destroyHooks??=[]).push(i,n.onDestroy)):n=t.data[i];const s=n.factory||(n.factory=t6(n.type)),a=Ts(B);try{const c=Lh(!1),l=s();return Lh(c),function pue(r,e,t,n){t>=r.data.length&&(r.data[t]=null,r.blueprint[t]=null),e[t]=n}(t,Ee(),i,l),l}finally{Ts(a)}}function gc(r,e,t){const n=r+gn,i=Ee(),s=t8(i,n);return V7(i,n)?jF(i,ts(),e,s.transform,t,s):s.transform(t)}function QF(r,e,t,n){const i=r+gn,s=Ee(),o=t8(s,i);return V7(s,i)?function ZF(r,e,t,n,i,s,o){const a=e+t;return c6(r,a,i,s)?hc(r,a+2,o?n.call(o,i,s):n(i,s)):H7(r,a+2)}(s,ts(),e,o.transform,t,n,o):o.transform(t,n)}function V7(r,e){return r[Je].data[e].pure}function SE(r){return e=>{setTimeout(r,void 0,e)}}const I1=class Lfe extends Ps{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=SE(s),i&&(i=SE(i)),o&&(o=SE(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof Mn&&e.add(a),a}};function Rfe(){return this._results[Symbol.iterator]()}class PE{get changes(){return this._changes||(this._changes=new I1)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=PE.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=Rfe)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const i=function No(r){return r.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function L6e(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],s=e[n];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}(n._results,i,t))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function Dfe(r,e,t,n=!0){const i=e[Je];if(function S0e(r,e,t,n){const i=ei+n,s=t.length;n>0&&(t[i-1][pa]=e),n<s-ei?(e[pa]=t[i],nD(t,ei+n,e)):(t.push(e),e[pa]=null),e[Q1]=t;const o=e[Ju];null!==o&&t!==o&&function P0e(r,e){const t=r[e8];e[Dr]!==e[Q1][Q1][Dr]&&(r[uz]=!0),null===t?r[e8]=[e]:t.push(e)}(o,e);const a=e[ic];null!==a&&a.insertView(r),e[Kt]|=128}(i,e,r,t),n){const s=dM(t,r),o=e[Zt],a=Xh(o,r[sc]);null!==a&&function y0e(r,e,t,n,i,s){n[Rr]=i,n[Ti]=e,h7(r,n,t,1,i,s)}(i,r[Ti],o,e,a,s)}}let E3=(()=>{class e{}return e.__NG_ELEMENT_ID__=Ffe,e})();const Hfe=E3,Vfe=class extends Hfe{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){const i=function zfe(r,e,t,n){const i=e.tView,a=vp(r,i,t,4096&r[Kt]?4096:16,null,e,null,null,null,n?.injector??null,n?.hydrationInfo??null);a[Ju]=r[e.index];const l=r[ic];return null!==l&&(a[ic]=l.createEmbeddedView(i)),QM(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:n});return new T7(i)}};function Ffe(){return Rp(ti(),Ee())}function Rp(r,e){return 4&r.type?new Vfe(e,r,C8(r,e)):null}let io=(()=>{class e{}return e.__NG_ELEMENT_ID__=qfe,e})();function qfe(){return s$(ti(),Ee())}const jfe=io,r$=class extends jfe{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return C8(this._hostTNode,this._hostLView)}get injector(){return new rs(this._hostTNode,this._hostLView)}get parentInjector(){const e=zh(this._hostTNode,this._hostLView);if(Wy(e)){const t=s7(e,this._hostLView),n=i7(e);return new rs(t[Je].data[n+8],t)}return new rs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=i$(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-ei}createEmbeddedView(e,t,n){let i,s;"number"==typeof n?i=n:null!=n&&(i=n.index,s=n.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,t,n,i,s){const o=e&&!function a7(r){return"function"==typeof r}(e);let a;if(o)a=t;else{const R=t||{};a=R.index,n=R.injector,i=R.projectableNodes,s=R.environmentInjector||R.ngModuleRef}const c=o?e:new O7(Rn(e)),l=n||this.parentInjector;if(!s&&null==c.ngModule){const z=(o?l:this.parentInjector).get(no,null);z&&(s=z)}Rn(c.componentType??{});const E=c.create(l,i,null,s);return this.insertImpl(E.hostView,a,false),E}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,n){const i=e._lView;if(function Yle(r){return bs(r[Q1])}(i)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=i[Q1],f=new r$(l,l[Ti],l[Q1]);f.detach(f.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return Dfe(a,i,o,!n),e.attachToViewContainerRef(),nD(TE(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=i$(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=Kh(this._lContainer,t);n&&(Vh(TE(this._lContainer),t),cM(n[Je],n))}detach(e){const t=this._adjustIndex(e,-1),n=Kh(this._lContainer,t);return n&&null!=Vh(TE(this._lContainer),t)?new T7(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function i$(r){return r[8]}function TE(r){return r[8]||(r[8]=[])}function s$(r,e){let t;const n=e[r.index];return bs(n)?t=n:(t=GH(n,e,null,r),e[r.index]=t,Cp(e,t)),o$(t,e,r,n),new r$(t,r,e)}let o$=function a$(r,e,t,n){if(r[sc])return;let i;i=8&t.type?N1(n):function Zfe(r,e){const t=r[Zt],n=t.createComment(""),i=ws(e,r);return i6(t,Xh(t,i),n,function w0e(r,e){return r.nextSibling(e)}(t,i),!1),n}(e,t),r[sc]=i};class OE{constructor(e){this.queryList=e,this.matches=null}clone(){return new OE(this.queryList)}setDirty(){this.queryList.setDirty()}}class bE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new bE(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==h$(e,t).matches&&this.queries[t].setDirty()}}class c${constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class wE{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,i);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new wE(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class NE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new NE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const s=n[i];this.matchTNodeWithReadOption(e,t,Xfe(t,s)),this.matchTNodeWithReadOption(e,t,Dh(t,e,s,!1,!1))}else n===E3?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Dh(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===bi||i===io||i===E3&&4&t.type)this.addMatch(t.index,-2);else{const s=Dh(t,e,i,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function Xfe(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function Jfe(r,e,t,n){return-1===t?function Qfe(r,e){return 11&r.type?C8(r,e):4&r.type?Rp(r,e):null}(e,r):-2===t?function e9e(r,e,t){return t===bi?C8(e,r):t===E3?Rp(e,r):t===io?s$(e,r):void 0}(r,e,n):r6(r,r[Je],t,e)}function l$(r,e,t,n){const i=e[ic].queries[n];if(null===i.matches){const s=r.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:Jfe(e,s[l],o[c+1],t.metadata.read))}i.matches=a}return i.matches}function AE(r,e,t,n){const i=r.queries.getByIndex(t),s=i.matches;if(null!==s){const o=l$(r,e,i,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)n.push(o[a/2]);else{const l=s[a+1],f=e[-c];for(let d=ei;d<f.length;d++){const m=f[d];m[Ju]===m[Q1]&&AE(m[Je],m,l,n)}if(null!==f[e8]){const d=f[e8];for(let m=0;m<d.length;m++){const E=d[m];AE(E[Je],E,l,n)}}}}}return n}function S3(r){const e=Ee(),t=zn(),n=Rz();Fy(n+1);const i=h$(t,n);if(r.dirty&&function jle(r){return 4==(4&r[Kt])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const s=i.crossesNgTemplate?AE(t,e,n,[]):l$(t,e,i,n);r.reset(s,I8e),r.notifyOnChanges()}return!0}return!1}function L4(r,e,t){const n=zn();n.firstCreatePass&&(function d$(r,e,t){null===r.queries&&(r.queries=new wE),r.queries.track(new NE(e,t))}(n,new c$(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function f$(r,e,t){const n=new PE(4==(4&t));(function t5e(r,e,t,n){const i=UH(e);i.push(t),r.firstCreatePass&&WH(r).push(n,i.length-1)})(r,e,n,n.destroy),null===e[ic]&&(e[ic]=new bE),e[ic].queries.push(new OE(n))}(n,Ee(),e)}function P3(){return function t9e(r,e){return r[ic].queries[e].queryList}(Ee(),Rz())}function h$(r,e){return r.queries.getByIndex(e)}function fn(r,e){return Rp(r,e)}const zE=new et("Application Initializer");let DE=(()=>{var r;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=nt(zE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const s of this.appInits){const o=s();if(I7(o))n.push(o);else if(EV(o)){const a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});n.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(s=>{this.reject(s)}),0===n.length&&i(),this.initialized=!0}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),A$=(()=>{var r;class e{log(n){console.log(n)}warn(n){console.warn(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();const mc=new et("LocaleId",{providedIn:"root",factory:()=>nt(mc,cn.Optional|cn.SkipSelf)||function S9e(){return typeof $localize<"u"&&$localize.locale||R8}()});let Hp=(()=>{var r;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Qi(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class O9e{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let I$=(()=>{var r;class e{compileModuleSync(n){return new yE(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),o=y3(Qs(n).declarations).reduce((a,c)=>{const l=Rn(c);return l&&a.push(new O7(l)),a},[]);return new O9e(i,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function R$(...r){}class l1{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new I1(!1),this.onMicrotaskEmpty=new I1(!1),this.onStable=new I1(!1),this.onError=new I1(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function q9e(){const r="function"==typeof C1.requestAnimationFrame;let e=C1[r?"requestAnimationFrame":"setTimeout"],t=C1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function Y9e(r){const e=()=>{!function Z9e(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(C1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,$E(r),r.isCheckStableRunning=!0,FE(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),$E(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,s,o,a)=>{try{return z$(r),t.invokeTask(i,s,o,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||r.shouldCoalesceRunChangeDetection)&&e(),D$(r)}},onInvoke:(t,n,i,s,o,a,c)=>{try{return z$(r),t.invoke(i,s,o,a,c)}finally{r.shouldCoalesceRunChangeDetection&&e(),D$(r)}},onHasTask:(t,n,i,s)=>{t.hasTask(i,s),n===i&&("microTask"==s.change?(r._hasPendingMicrotasks=s.microTask,$E(r),FE(r)):"macroTask"==s.change&&(r.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,i,s)=>(t.handleError(i,s),r.runOutsideAngular(()=>r.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!l1.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(l1.isInAngularZone())throw new ge(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,j9e,R$,R$);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const j9e={};function FE(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function $E(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function z$(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function D$(r){r._nesting--,FE(r)}class K9e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new I1,this.onMicrotaskEmpty=new I1,this.onStable=new I1,this.onError=new I1}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}const H$=new et("",{providedIn:"root",factory:V$});function V$(){const r=nt(l1);let e=!0;return function W4e(...r){const e=qu(r),t=function H4e(r,e){return"number"==typeof uy(r)?r.pop():e}(r,1/0),n=r;return n.length?1===n.length?Ks(n[0]):j0(t)(a2(n,e)):nc}(new b1(i=>{e=r.isStable&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks,r.runOutsideAngular(()=>{i.next(e),i.complete()})}),new b1(i=>{let s;r.runOutsideAngular(()=>{s=r.onStable.subscribe(()=>{l1.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=r.onUnstable.subscribe(()=>{l1.assertInAngularZone(),e&&(e=!1,r.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(FR()))}const F$=new et(""),Fp=new et("");let UE,GE=(()=>{var r;class e{constructor(n,i,s){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,UE||(function X9e(r){UE=r}(s),s.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{l1.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:s})}whenStable(n,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,s){return[]}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(l1),Pe(BE),Pe(Fp))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),BE=(()=>{var r;class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return UE?.findTestabilityInTree(this,n,i)??null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})(),R4=null;const $$=new et("AllowMultipleToken"),WE=new et("PlatformDestroyListeners"),qE=new et("appBootstrapListener");class B${constructor(e,t){this.name=e,this.token=t}}function W$(r,e,t=[]){const n=`Platform: ${e}`,i=new et(n);return(s=[])=>{let o=jE();if(!o||o.injector.get($$,!1)){const a=[...t,...s,{provide:i,useValue:!0}];r?r(a):function ede(r){if(R4&&!R4.get($$,!1))throw new ge(400,!1);(function G$(){!function Dle(r){mz=r}(()=>{throw new ge(600,!1)})})(),R4=r;const e=r.get(j$);(function U$(r){r.get(sH,null)?.forEach(t=>t())})(r)}(function q$(r=[],e){return ni.create({name:e,providers:[{provide:PM,useValue:"platform"},{provide:WE,useValue:new Set([()=>R4=null])},...r]})}(a,n))}return function nde(r){const e=jE();if(!e)throw new ge(401,!1);return e}()}}function jE(){return R4?.get(j$)??null}let j$=(()=>{var r;class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const s=function rde(r="zone.js",e){return"noop"===r?new K9e:"zone.js"===r?new l1(e):r}(i?.ngZone,function Z$(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{const o=function dfe(r,e,t){return new CE(r,e,t)}(n.moduleType,this.injector,function J$(r){return[{provide:l1,useFactory:r},{provide:_7,multi:!0,useFactory:()=>{const e=nt(sde,{optional:!0});return()=>e.initialize()}},{provide:Q$,useFactory:ide},{provide:H$,useFactory:V$}]}(()=>s)),a=o.injector.get(a6,null);return s.runOutsideAngular(()=>{const c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{$p(this._modules,o),c.unsubscribe()})}),function Y$(r,e,t){try{const n=t();return I7(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(a,s,()=>{const c=o.injector.get(DE);return c.runInitializers(),c.donePromise.then(()=>(mF(o.injector.get(mc,R8)||R8),this._moduleDoBootstrap(o),o))})})}bootstrapModule(n,i=[]){const s=K$({},i);return function Q9e(r,e,t){const n=new yE(t);return Promise.resolve(n)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(n){const i=n.injector.get(h6);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!n.instance.ngDoBootstrap)throw new ge(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(WE,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(ni))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();function K$(r,e){return Array.isArray(e)?e.reduce(K$,r):{...r,...e}}let h6=(()=>{var r;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=nt(Q$),this.zoneIsStable=nt(H$),this.componentTypes=[],this.components=[],this.isStable=nt(Hp).hasPendingTasks.pipe(da(n=>n?Dt(!1):this.zoneIsStable),function q4e(r,e=tc){return r=r??j4e,Kr((t,n)=>{let i,s=!0;t.subscribe(Cr(n,o=>{const a=e(o);(s||!r(i,a))&&(s=!1,i=a,n.next(o))}))})}(),FR()),this._injector=nt(no)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const s=n instanceof dH;if(!this._injector.get(DE).done)throw!s&&function Y0(r){const e=Rn(r)||J2(r)||Ji(r);return null!==e&&e.standalone}(n),new ge(405,!1);let a;a=s?n:this._injector.get(gp).resolveComponentFactory(n),this.componentTypes.push(a.componentType);const c=function J9e(r){return r.isBoundToModule}(a)?void 0:this._injector.get(d6),f=a.create(ni.NULL,[],i||a.selector,c),d=f.location.nativeElement,m=f.injector.get(F$,null);return m?.registerApplication(d),f.onDestroy(()=>{this.detachView(f.hostView),$p(this.components,f),m?.unregisterApplication(d)}),this._loadComponent(f),f}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;$p(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(qE,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>$p(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new ge(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function $p(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const Q$=new et("",{providedIn:"root",factory:()=>nt(a6).handleError.bind(void 0)});function ide(){const r=nt(l1),e=nt(a6);return t=>r.runOutsideAngular(()=>e.handleError(t))}let sde=(()=>{var r;class e{constructor(){this.zone=nt(l1),this.applicationRef=nt(h6)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();let T3=(()=>{class e{}return e.__NG_ELEMENT_ID__=ade,e})();function ade(r){return function cde(r,e,t){if(e6(r)&&!t){const n=Js(r.index,e);return new T7(n,n)}return 47&r.type?new T7(e[Dr],e):null}(ti(),Ee(),16==(16&r))}class rG{constructor(){}supports(e){return Sp(e)}create(e){return new pde(e)}}const hde=(r,e)=>e;class pde{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||hde}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<sG(n,i,s)?t:n,a=sG(o,i,s),c=o.currentIndex;if(o===n)i--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const l=a-i,f=c-i;if(l!=f){for(let m=0;m<l;m++){const E=m<s.length?s[m]:s[m]=0,w=E+m;f<=w&&w<l&&(s[m]=E+1)}s[o.previousIndex]=f-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Sp(e))throw new ge(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else i=0,function j5e(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new gde(t,n),s,i),e}_verifyReinsertion(e,t,n,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new iG),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new iG),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class gde{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class mde{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class iG{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new mde,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function sG(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}class oG{constructor(){}supports(e){return e instanceof Map||JM(e)}create(){return new _de}}class _de{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||JM(e)))throw new ge(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(i,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const n=new vde(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class vde{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function aG(){return new Up([new rG])}let Up=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||aG()),deps:[[e,new $h,new is]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(null!=i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:aG}),e})();function cG(){return new G7([new oG])}let G7=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||cG()),deps:[[e,new $h,new is]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:cG}),e})();const Mde=W$(null,"core",[]);let Ede=(()=>{var r;class e{constructor(n){}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(h6))},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({}),e})();function H8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let JE=null;function z4(){return JE}class zde{}const w2=new et("DocumentToken");let eS=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(Hde)},providedIn:"platform"}),e})();const Dde=new et("Location Initialized");let Hde=(()=>{var r;class e extends eS{constructor(){super(),this._doc=nt(w2),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return z4().getBaseHref(this._doc)}onPopState(n){const i=z4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=z4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,s){this._history.pushState(n,i,s)}replaceState(n,i,s){this._history.replaceState(n,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new r},providedIn:"platform"}),e})();function tS(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function mG(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function O3(r){return r&&"?"!==r[0]?"?"+r:r}let g6=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(vG)},providedIn:"root"}),e})();const _G=new et("appBaseHref");let vG=(()=>{var r;class e extends g6{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??nt(w2).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return tS(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+O3(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${i}${s}`:i}pushState(n,i,s,o){const a=this.prepareExternalUrl(s+O3(o));this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){const a=this.prepareExternalUrl(s+O3(o));this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(eS),Pe(_G,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Vde=(()=>{var r;class e extends g6{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=tS(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,s,o){let a=this.prepareExternalUrl(s+O3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){let a=this.prepareExternalUrl(s+O3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(eS),Pe(_G,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),nS=(()=>{var r;class e{constructor(n){this._subject=new I1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function Gde(r){if(new RegExp("^(https?:)?//").test(r)){const[,t]=r.split(/\/\/[^\/]+/);return t}return r}(mG(CG(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+O3(i))}normalize(n){return e.stripTrailingSlash(function $de(r,e){if(!r||!e.startsWith(r))return e;const t=e.substring(r.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,CG(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",s=null){this._locationStrategy.pushState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+O3(i)),s)}replaceState(n,i="",s=null){this._locationStrategy.replaceState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+O3(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(s=>s(n,i))}subscribe(n,i,s){return this._subject.subscribe({next:n,error:i,complete:s})}}return(r=e).normalizeQueryParams=O3,r.joinWithSlash=tS,r.stripTrailingSlash=mG,r.\u0275fac=function(n){return new(n||r)(Pe(g6))},r.\u0275prov=De({token:r,factory:function(){return function Fde(){return new nS(Pe(g6))}()},providedIn:"root"}),e})();function CG(r){return r.replace(/\/index.html$/,"")}var qp=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(qp||{}),as=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(as||{}),y1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(y1||{}),so=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(so||{}),Hr=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Hr||{});function jp(r,e){return xo(ss(r)[A1.DateFormat],e)}function Zp(r,e){return xo(ss(r)[A1.TimeFormat],e)}function Yp(r,e){return xo(ss(r)[A1.DateTimeFormat],e)}function ko(r,e){const t=ss(r),n=t[A1.NumberSymbols][e];if(typeof n>"u"){if(e===Hr.CurrencyDecimal)return t[A1.NumberSymbols][Hr.Decimal];if(e===Hr.CurrencyGroup)return t[A1.NumberSymbols][Hr.Group]}return n}function MG(r){if(!r[A1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[A1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function xo(r,e){for(let t=e;t>-1;t--)if(typeof r[t]<"u")return r[t];throw new Error("Locale data API: locale data undefined")}function iS(r){const[e,t]=r.split(":");return{hours:+e,minutes:+t}}const nhe=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,B7={},rhe=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var b3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(b3||{}),Qn=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(Qn||{}),Jn=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(Jn||{});function EG(r,e,t,n){let i=function dhe(r){if(TG(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,s=1,o=1]=r.split("-").map(a=>+a);return Kp(i,s-1,o)}const t=parseFloat(r);if(!isNaN(r-t))return new Date(t);let n;if(n=r.match(nhe))return function hhe(r){const e=new Date(0);let t=0,n=0;const i=r[8]?e.setUTCFullYear:e.setFullYear,s=r[8]?e.setUTCHours:e.setHours;r[9]&&(t=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(e,Number(r[1]),Number(r[2])-1,Number(r[3]));const o=Number(r[4]||0)-t,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return s.call(e,o,a,c,l),e}(n)}const e=new Date(r);if(!TG(e))throw new Error(`Unable to convert "${r}" into a date`);return e}(r);e=w3(t,e)||e;let a,o=[];for(;e;){if(a=rhe.exec(e),!a){o.push(e);break}{o=o.concat(a.slice(1));const f=o.pop();if(!f)break;e=f}}let c=i.getTimezoneOffset();n&&(c=PG(n,c),i=function fhe(r,e,t){const n=t?-1:1,i=r.getTimezoneOffset();return function uhe(r,e){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+e),r}(r,n*(PG(e,i)-i))}(i,n,!0));let l="";return o.forEach(f=>{const d=function lhe(r){if(oS[r])return oS[r];let e;switch(r){case"G":case"GG":case"GGG":e=k1(Jn.Eras,y1.Abbreviated);break;case"GGGG":e=k1(Jn.Eras,y1.Wide);break;case"GGGGG":e=k1(Jn.Eras,y1.Narrow);break;case"y":e=Qr(Qn.FullYear,1,0,!1,!0);break;case"yy":e=Qr(Qn.FullYear,2,0,!0,!0);break;case"yyy":e=Qr(Qn.FullYear,3,0,!1,!0);break;case"yyyy":e=Qr(Qn.FullYear,4,0,!1,!0);break;case"Y":e=eg(1);break;case"YY":e=eg(2,!0);break;case"YYY":e=eg(3);break;case"YYYY":e=eg(4);break;case"M":case"L":e=Qr(Qn.Month,1,1);break;case"MM":case"LL":e=Qr(Qn.Month,2,1);break;case"MMM":e=k1(Jn.Months,y1.Abbreviated);break;case"MMMM":e=k1(Jn.Months,y1.Wide);break;case"MMMMM":e=k1(Jn.Months,y1.Narrow);break;case"LLL":e=k1(Jn.Months,y1.Abbreviated,as.Standalone);break;case"LLLL":e=k1(Jn.Months,y1.Wide,as.Standalone);break;case"LLLLL":e=k1(Jn.Months,y1.Narrow,as.Standalone);break;case"w":e=sS(1);break;case"ww":e=sS(2);break;case"W":e=sS(1,!0);break;case"d":e=Qr(Qn.Date,1);break;case"dd":e=Qr(Qn.Date,2);break;case"c":case"cc":e=Qr(Qn.Day,1);break;case"ccc":e=k1(Jn.Days,y1.Abbreviated,as.Standalone);break;case"cccc":e=k1(Jn.Days,y1.Wide,as.Standalone);break;case"ccccc":e=k1(Jn.Days,y1.Narrow,as.Standalone);break;case"cccccc":e=k1(Jn.Days,y1.Short,as.Standalone);break;case"E":case"EE":case"EEE":e=k1(Jn.Days,y1.Abbreviated);break;case"EEEE":e=k1(Jn.Days,y1.Wide);break;case"EEEEE":e=k1(Jn.Days,y1.Narrow);break;case"EEEEEE":e=k1(Jn.Days,y1.Short);break;case"a":case"aa":case"aaa":e=k1(Jn.DayPeriods,y1.Abbreviated);break;case"aaaa":e=k1(Jn.DayPeriods,y1.Wide);break;case"aaaaa":e=k1(Jn.DayPeriods,y1.Narrow);break;case"b":case"bb":case"bbb":e=k1(Jn.DayPeriods,y1.Abbreviated,as.Standalone,!0);break;case"bbbb":e=k1(Jn.DayPeriods,y1.Wide,as.Standalone,!0);break;case"bbbbb":e=k1(Jn.DayPeriods,y1.Narrow,as.Standalone,!0);break;case"B":case"BB":case"BBB":e=k1(Jn.DayPeriods,y1.Abbreviated,as.Format,!0);break;case"BBBB":e=k1(Jn.DayPeriods,y1.Wide,as.Format,!0);break;case"BBBBB":e=k1(Jn.DayPeriods,y1.Narrow,as.Format,!0);break;case"h":e=Qr(Qn.Hours,1,-12);break;case"hh":e=Qr(Qn.Hours,2,-12);break;case"H":e=Qr(Qn.Hours,1);break;case"HH":e=Qr(Qn.Hours,2);break;case"m":e=Qr(Qn.Minutes,1);break;case"mm":e=Qr(Qn.Minutes,2);break;case"s":e=Qr(Qn.Seconds,1);break;case"ss":e=Qr(Qn.Seconds,2);break;case"S":e=Qr(Qn.FractionalSeconds,1);break;case"SS":e=Qr(Qn.FractionalSeconds,2);break;case"SSS":e=Qr(Qn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Qp(b3.Short);break;case"ZZZZZ":e=Qp(b3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Qp(b3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Qp(b3.Long);break;default:return null}return oS[r]=e,e}(f);l+=d?d(i,t,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Kp(r,e,t){const n=new Date(0);return n.setFullYear(r,e,t),n.setHours(0,0,0),n}function w3(r,e){const t=function Ude(r){return ss(r)[A1.LocaleId]}(r);if(B7[t]=B7[t]||{},B7[t][e])return B7[t][e];let n="";switch(e){case"shortDate":n=jp(r,so.Short);break;case"mediumDate":n=jp(r,so.Medium);break;case"longDate":n=jp(r,so.Long);break;case"fullDate":n=jp(r,so.Full);break;case"shortTime":n=Zp(r,so.Short);break;case"mediumTime":n=Zp(r,so.Medium);break;case"longTime":n=Zp(r,so.Long);break;case"fullTime":n=Zp(r,so.Full);break;case"short":const i=w3(r,"shortTime"),s=w3(r,"shortDate");n=Xp(Yp(r,so.Short),[i,s]);break;case"medium":const o=w3(r,"mediumTime"),a=w3(r,"mediumDate");n=Xp(Yp(r,so.Medium),[o,a]);break;case"long":const c=w3(r,"longTime"),l=w3(r,"longDate");n=Xp(Yp(r,so.Long),[c,l]);break;case"full":const f=w3(r,"fullTime"),d=w3(r,"fullDate");n=Xp(Yp(r,so.Full),[f,d])}return n&&(B7[t][e]=n),n}function Xp(r,e){return e&&(r=r.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),r}function ya(r,e,t="-",n,i){let s="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,s=t));let o=String(r);for(;o.length<e;)o="0"+o;return n&&(o=o.slice(o.length-e)),s+o}function Qr(r,e,t=0,n=!1,i=!1){return function(s,o){let a=function she(r,e){switch(r){case Qn.FullYear:return e.getFullYear();case Qn.Month:return e.getMonth();case Qn.Date:return e.getDate();case Qn.Hours:return e.getHours();case Qn.Minutes:return e.getMinutes();case Qn.Seconds:return e.getSeconds();case Qn.FractionalSeconds:return e.getMilliseconds();case Qn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,s);if((t>0||a>-t)&&(a+=t),r===Qn.Hours)0===a&&-12===t&&(a=12);else if(r===Qn.FractionalSeconds)return function ihe(r,e){return ya(r,3).substring(0,e)}(a,e);const c=ko(o,Hr.MinusSign);return ya(a,e,c,n,i)}}function k1(r,e,t=as.Format,n=!1){return function(i,s){return function ohe(r,e,t,n,i,s){switch(t){case Jn.Months:return function jde(r,e,t){const n=ss(r),s=xo([n[A1.MonthsFormat],n[A1.MonthsStandalone]],e);return xo(s,t)}(e,i,n)[r.getMonth()];case Jn.Days:return function qde(r,e,t){const n=ss(r),s=xo([n[A1.DaysFormat],n[A1.DaysStandalone]],e);return xo(s,t)}(e,i,n)[r.getDay()];case Jn.DayPeriods:const o=r.getHours(),a=r.getMinutes();if(s){const l=function Xde(r){const e=ss(r);return MG(e),(e[A1.ExtraData][2]||[]).map(n=>"string"==typeof n?iS(n):[iS(n[0]),iS(n[1])])}(e),f=function Qde(r,e,t){const n=ss(r);MG(n);const s=xo([n[A1.ExtraData][0],n[A1.ExtraData][1]],e)||[];return xo(s,t)||[]}(e,i,n),d=l.findIndex(m=>{if(Array.isArray(m)){const[E,w]=m,R=o>=E.hours&&a>=E.minutes,z=o<w.hours||o===w.hours&&a<w.minutes;if(E.hours<w.hours){if(R&&z)return!0}else if(R||z)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(-1!==d)return f[d]}return function Wde(r,e,t){const n=ss(r),s=xo([n[A1.DayPeriodsFormat],n[A1.DayPeriodsStandalone]],e);return xo(s,t)}(e,i,n)[o<12?0:1];case Jn.Eras:return function Zde(r,e){return xo(ss(r)[A1.Eras],e)}(e,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(i,s,r,e,t,n)}}function Qp(r){return function(e,t,n){const i=-1*n,s=ko(t,Hr.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case b3.Short:return(i>=0?"+":"")+ya(o,2,s)+ya(Math.abs(i%60),2,s);case b3.ShortGMT:return"GMT"+(i>=0?"+":"")+ya(o,1,s);case b3.Long:return"GMT"+(i>=0?"+":"")+ya(o,2,s)+":"+ya(Math.abs(i%60),2,s);case b3.Extended:return 0===n?"Z":(i>=0?"+":"")+ya(o,2,s)+":"+ya(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${r}"`)}}}const ahe=0,Jp=4;function SG(r){return Kp(r.getFullYear(),r.getMonth(),r.getDate()+(Jp-r.getDay()))}function sS(r,e=!1){return function(t,n){let i;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{const s=SG(t),o=function che(r){const e=Kp(r,ahe,1).getDay();return Kp(r,0,1+(e<=Jp?Jp:Jp+7)-e)}(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return ya(i,r,ko(n,Hr.MinusSign))}}function eg(r,e=!1){return function(t,n){return ya(SG(t).getFullYear(),r,ko(n,Hr.MinusSign),e)}}const oS={};function PG(r,e){r=r.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(t)?e:t}function TG(r){return r instanceof Date&&!isNaN(r.valueOf())}const phe=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function uS(r){const e=parseInt(r);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+r);return e}function NG(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}const dS=/\s+/,AG=[];let Ft=(()=>{var r;class e{constructor(n,i,s,o){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=s,this._renderer=o,this.initialClasses=AG,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(dS):AG}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(dS):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const s=this.stateMap.get(n);void 0!==s?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],s=n[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(dS).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Up),B(G7),B(bi),B(fc))},r.\u0275dir=Lt({type:r,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class bhe{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Wt=(()=>{var r;class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,s){this._viewContainer=n,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((s,o,a)=>{if(null==s.previousIndex)i.createEmbeddedView(this._template,new bhe(s.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===o?void 0:o);else if(null!==o){const c=i.get(o);i.move(c,a),kG(c,s)}});for(let s=0,o=i.length;s<o;s++){const c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}n.forEachIdentityChange(s=>{kG(i.get(s.currentIndex),s)})}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(B(io),B(E3),B(Up))},r.\u0275dir=Lt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function kG(r,e){r.context.$implicit=e.item}let wt=(()=>{var r;class e{constructor(n,i){this._viewContainer=n,this._context=new whe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){xG("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){xG("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(B(io),B(E3))},r.\u0275dir=Lt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class whe{constructor(){this.$implicit=null,this.ngIf=null}}function xG(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${c2(e)}'.`)}let zG=(()=>{var r;class e{constructor(n){this._locale=n}transform(n,i,s){if(!function gS(r){return!(null==r||""===r||r!=r)}(n))return null;s=s||this._locale;try{return function yhe(r,e,t){return function cS(r,e,t,n,i,s,o=!1){let a="",c=!1;if(isFinite(r)){let l=function Ehe(r){let n,i,s,o,a,e=Math.abs(r)+"",t=0;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;"0"===e.charAt(s);s++);if(s===(a=e.length))n=[0],i=1;else{for(a--;"0"===e.charAt(a);)a--;for(i-=s,n=[],o=0;s<=a;s++,o++)n[o]=Number(e.charAt(s))}return i>22&&(n=n.splice(0,21),t=i-1,i=1),{digits:n,exponent:t,integerLen:i}}(r);o&&(l=function Mhe(r){if(0===r.digits[0])return r;const e=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===e?r.digits.push(0,0):1===e&&r.digits.push(0),r.integerLen+=2),r}(l));let f=e.minInt,d=e.minFrac,m=e.maxFrac;if(s){const G=s.match(phe);if(null===G)throw new Error(`${s} is not a valid digit info`);const de=G[1],ve=G[3],xe=G[5];null!=de&&(f=uS(de)),null!=ve&&(d=uS(ve)),null!=xe?m=uS(xe):null!=ve&&d>m&&(m=d)}!function She(r,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let n=r.digits,i=n.length-r.integerLen;const s=Math.min(Math.max(e,i),t);let o=s+r.integerLen,a=n[o];if(o>0){n.splice(Math.max(r.integerLen,o));for(let d=o;d<n.length;d++)n[d]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,o=s+1),n[0]=0;for(let d=1;d<o;d++)n[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[o-1]++;for(;i<Math.max(0,s);i++)n.push(0);let c=0!==s;const l=e+r.integerLen,f=n.reduceRight(function(d,m,E,w){return w[E]=(m+=d)<10?m:m-10,c&&(0===w[E]&&E>=l?w.pop():c=!1),m>=10?1:0},0);f&&(n.unshift(f),r.integerLen++)}(l,d,m);let E=l.digits,w=l.integerLen;const R=l.exponent;let z=[];for(c=E.every(G=>!G);w<f;w++)E.unshift(0);for(;w<0;w++)E.unshift(0);w>0?z=E.splice(w,E.length):(z=E,E=[0]);const $=[];for(E.length>=e.lgSize&&$.unshift(E.splice(-e.lgSize,E.length).join(""));E.length>e.gSize;)$.unshift(E.splice(-e.gSize,E.length).join(""));E.length&&$.unshift(E.join("")),a=$.join(ko(t,n)),z.length&&(a+=ko(t,i)+z.join("")),R&&(a+=ko(t,Hr.Exponential)+"+"+R)}else a=ko(t,Hr.Infinity);return a=r<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(r,function lS(r,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],s=n[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=o[0],c=o[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let f=0;f<c.length;f++){const d=c.charAt(f);"0"===d?t.minFrac=t.maxFrac=f+1:"#"===d?t.maxFrac=f+1:t.posSuf+=d}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,s){const f=i.length-t.posPre.length-t.posSuf.length,d=s.indexOf("#");t.negPre=s.substring(0,d).replace(/'/g,""),t.negSuf=s.slice(d+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function rS(r,e){return ss(r)[A1.NumberFormats][e]}(e,qp.Decimal),ko(e,Hr.MinusSign)),e,Hr.Group,Hr.Decimal,t)}(function mS(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(n),s,i)}catch(o){throw function Ma(r,e){return new ge(2100,!1)}()}}}return(r=e).\u0275fac=function(n){return new(n||r)(B(mc,16))},r.\u0275pipe=Pi({name:"number",type:r,pure:!0,standalone:!0}),e})();let Qhe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({}),e})();function HG(r){return"server"===r}let npe=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new rpe(Pe(w2),window)}),e})();class rpe{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function ipe(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class VG{}class bpe extends zde{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class CS extends bpe{static makeCurrent(){!function Rde(r){JE||(JE=r)}(new CS)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function wpe(){return q7=q7||document.querySelector("base"),q7?q7.getAttribute("href"):null}();return null==t?null:function Npe(r){ig=ig||document.createElement("a"),ig.setAttribute("href",r);const e=ig.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){q7=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return NG(document.cookie,e)}}let ig,q7=null,Ipe=(()=>{var r;class e{build(){return new XMLHttpRequest}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const yS=new et("EventManagerPlugins");let UG=(()=>{var r;class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(o=>o.supports(n)),!i)throw new ge(5101,!1);return this._eventNameToPlugin.set(n,i),i}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(yS),Pe(l1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class WG{constructor(e){this._doc=e}}const MS="ng-app-id";let qG=(()=>{var r;class e{constructor(n,i,s,o={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=HG(o),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${MS}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(s=>{null!=s.textContent&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){const s=this.styleRef;if(s.has(n)){const o=s.get(n);return o.usage+=i,o.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===n)return s.delete(i),o.removeAttribute(MS),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(MS,this.appId),a}}addStyleToHost(n,i){const s=this.getStyleElement(n,i);n.appendChild(s);const o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(w2),Pe(lp),Pe(aH,8),Pe(C3))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const ES={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},SS=/%COMP%/g,Rpe=new et("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function ZG(r,e){return e.map(t=>t.replace(SS,r))}let PS=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=HG(c),this.defaultRenderer=new TS(n,a,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===wo.ShadowDom&&(i={...i,encapsulation:wo.Emulated});const s=this.getOrCreateRenderer(n,i);return s instanceof KG?s.applyToHost(n):s instanceof OS&&s.applyStyles(),s}getOrCreateRenderer(n,i){const s=this.rendererByCompId;let o=s.get(i.id);if(!o){const a=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case wo.Emulated:o=new KG(l,f,i,this.appId,d,a,c,m);break;case wo.ShadowDom:return new Vpe(l,f,n,i,a,c,this.nonce,m);default:o=new OS(l,f,i,d,a,c,m)}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(UG),Pe(qG),Pe(lp),Pe(Rpe),Pe(w2),Pe(C3),Pe(l1),Pe(aH))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class TS{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(ES[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(YG(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(YG(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?this.doc.querySelector(e):e;if(!n)throw new ge(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const s=ES[i];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=ES[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(k4.DashCase|k4.Important)?e.style.setProperty(t,n,i&k4.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&k4.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){if("string"==typeof e&&!(e=z4().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function YG(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class Vpe extends TS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=ZG(i.id,i.styles);for(const f of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=f,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class OS extends TS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?ZG(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class KG extends OS{constructor(e,t,n,i,s,o,a,c){const l=i+"-"+n.id;super(e,t,n,s,o,a,c,l),this.contentAttr=function zpe(r){return"_ngcontent-%COMP%".replace(SS,r)}(l),this.hostAttr=function Dpe(r){return"_nghost-%COMP%".replace(SS,r)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let Fpe=(()=>{var r;class e extends WG{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(w2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const XG=["alt","control","meta","shift"],$pe={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Gpe={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let Bpe=(()=>{var r;class e extends WG{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,s){const o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>z4().onAndCancel(n,o.domEventName,a))}static parseEventName(n){const i=n.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const o=e._normalizeKey(i.pop());let a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),XG.forEach(f=>{const d=i.indexOf(f);d>-1&&(i.splice(d,1),a+=f+".")}),a+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(n,i){let s=$pe[n.key]||n.key,o="";return i.indexOf("code.")>-1&&(s=n.code,o="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),XG.forEach(a=>{a!==s&&(0,Gpe[a])(n)&&(o+=a+".")}),o+=s,o===i)}static eventCallback(n,i,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>i(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(w2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const JG=[{provide:C3,useValue:"browser"},{provide:sH,useValue:function Upe(){CS.makeCurrent()},multi:!0},{provide:w2,useFactory:function qpe(){return function z0e(r){gM=r}(document),document},deps:[]}],jpe=W$(Mde,"browser",JG),Zpe=new et(""),eB=[{provide:Fp,useClass:class Ape{addToWindow(e){C1.getAngularTestability=(n,i=!0)=>{const s=e.findTestabilityInTree(n,i);if(null==s)throw new ge(5103,!1);return s},C1.getAllAngularTestabilities=()=>e.getAllTestabilities(),C1.getAllAngularRootElements=()=>e.getAllRootElements(),C1.frameworkStabilizers||(C1.frameworkStabilizers=[]),C1.frameworkStabilizers.push(n=>{const i=C1.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(c){o=o||c,s--,0==s&&n(o)};i.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?z4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:F$,useClass:GE,deps:[l1,BE,Fp]},{provide:GE,useClass:GE,deps:[l1,BE,Fp]}],tB=[{provide:PM,useValue:"root"},{provide:a6,useFactory:function Wpe(){return new a6},deps:[]},{provide:yS,useClass:Fpe,multi:!0,deps:[w2,l1,C3]},{provide:yS,useClass:Bpe,multi:!0,deps:[w2]},PS,qG,UG,{provide:M7,useExisting:PS},{provide:VG,useClass:Ipe,deps:[]},[]];let nB=(()=>{var r;class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:lp,useValue:n.appId}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(Zpe,12))},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({providers:[...tB,...eB],imports:[Qhe,Ede]}),e})(),rB=(()=>{var r;class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(w2))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function Kpe(){return new rB(Pe(w2))}(),i},providedIn:"root"}),e})();typeof window<"u"&&window;let oB=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new(n||r):Pe(aB),i},providedIn:"root"}),e})(),aB=(()=>{var r;class e extends oB{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case Ao.NONE:return i;case Ao.HTML:return uc(i,"HTML")?to(i):YD(this._doc,String(i)).toString();case Ao.STYLE:return uc(i,"Style")?to(i):i;case Ao.SCRIPT:if(uc(i,"Script"))return to(i);throw new ge(5200,!1);case Ao.URL:return uc(i,"URL")?to(i):np(String(i));case Ao.RESOURCE_URL:if(uc(i,"ResourceURL"))return to(i);throw new ge(5201,!1);default:throw new ge(5202,!1)}}bypassSecurityTrustHtml(n){return function B0e(r){return new D0e(r)}(n)}bypassSecurityTrustStyle(n){return function U0e(r){return new H0e(r)}(n)}bypassSecurityTrustScript(n){return function W0e(r){return new V0e(r)}(n)}bypassSecurityTrustUrl(n){return function q0e(r){return new F0e(r)}(n)}bypassSecurityTrustResourceUrl(n){return function j0e(r){return new $0e(r)}(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(w2))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function ege(r){return new aB(r.get(w2))}(Pe(ni)),i},providedIn:"root"}),e})();function j7(r){return(j7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function u(r,e,t){return(e=function nge(r){var e=function tge(r,e){if("object"!==j7(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!==j7(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"===j7(e)?e:String(e)}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const{isArray:rge}=Array,{getPrototypeOf:ige,prototype:sge,keys:oge}=Object;function lB(r){if(1===r.length){const e=r[0];if(rge(e))return{args:e,keys:null};if(function age(r){return r&&"object"==typeof r&&ige(r)===sge}(e)){const t=oge(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}const{isArray:cge}=Array;function uB(r){return qn(e=>function lge(r,e){return cge(e)?r(...e):r(e)}(r,e))}function fB(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}let dB=(()=>{var r;class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(fc),B(bi))},r.\u0275dir=Lt({type:r}),e})(),m6=(()=>{var r;class e extends dB{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Lt({type:r,features:[Xe]}),e})();const _c=new et("NgValueAccessor"),fge={provide:_c,useExisting:w1(()=>wS),multi:!0};let wS=(()=>{var r;class e extends m6{writeValue(n){this.setProperty("checked",n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Lt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[J1([fge]),Xe]}),e})();const dge={provide:_c,useExisting:w1(()=>vc),multi:!0},pge=new et("CompositionEventMode");let vc=(()=>{var r;class e extends dB{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function hge(){const r=z4()?z4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(fc),B(bi),B(pge,8))},r.\u0275dir=Lt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&W("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[J1([dge]),Xe]}),e})();function H4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function hB(r){return null!=r&&"number"==typeof r.length}const Ai=new et("NgValidators"),V4=new et("NgAsyncValidators"),gge=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Z7{static min(e){return function pB(r){return e=>{if(H4(e.value)||H4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}(e)}static max(e){return function gB(r){return e=>{if(H4(e.value)||H4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}(e)}static required(e){return mB(e)}static requiredTrue(e){return function _B(r){return!0===r.value?null:{required:!0}}(e)}static email(e){return function vB(r){return H4(r.value)||gge.test(r.value)?null:{email:!0}}(e)}static minLength(e){return function CB(r){return e=>H4(e.value)||!hB(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}(e)}static maxLength(e){return yB(e)}static pattern(e){return function MB(r){if(!r)return sg;let e,t;return"string"==typeof r?(t="","^"!==r.charAt(0)&&(t+="^"),t+=r,"$"!==r.charAt(r.length-1)&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(H4(n.value))return null;const i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return bB(e)}static composeAsync(e){return wB(e)}}function mB(r){return H4(r.value)?{required:!0}:null}function yB(r){return e=>hB(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function sg(r){return null}function EB(r){return null!=r}function SB(r){return I7(r)?a2(r):r}function PB(r){let e={};return r.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function TB(r,e){return e.map(t=>t(r))}function OB(r){return r.map(e=>function mge(r){return!r.validate}(e)?e:t=>e.validate(t))}function bB(r){if(!r)return null;const e=r.filter(EB);return 0==e.length?null:function(t){return PB(TB(t,e))}}function NS(r){return null!=r?bB(OB(r)):null}function wB(r){if(!r)return null;const e=r.filter(EB);return 0==e.length?null:function(t){return function uge(...r){const e=HR(r),{args:t,keys:n}=lB(r),i=new b1(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let f=0;f<o;f++){let d=!1;Ks(t[f]).subscribe(Cr(s,m=>{d||(d=!0,l--),a[f]=m},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(n?fB(n,a):a),s.complete())}))}});return e?i.pipe(uB(e)):i}(TB(t,e).map(SB)).pipe(qn(PB))}}function AS(r){return null!=r?wB(OB(r)):null}function NB(r,e){return null===r?[e]:Array.isArray(r)?[...r,e]:[r,e]}function AB(r){return r._rawValidators}function IB(r){return r._rawAsyncValidators}function IS(r){return r?Array.isArray(r)?r:[r]:[]}function og(r,e){return Array.isArray(r)?r.includes(e):r===e}function kB(r,e){const t=IS(e);return IS(r).forEach(i=>{og(t,i)||t.push(i)}),t}function xB(r,e){return IS(e).filter(t=>!og(r,t))}class LB{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=NS(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=AS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class cs extends LB{get formDirective(){return null}get path(){return null}}class F4 extends LB{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class RB{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let N3=(()=>{var r;class e extends RB{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(F4,2))},r.\u0275dir=Lt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&Np("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Xe]}),e})(),_6=(()=>{var r;class e extends RB{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(B(cs,10))},r.\u0275dir=Lt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&Np("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Xe]}),e})();const Y7="VALID",cg="INVALID",F8="PENDING",K7="DISABLED";function LS(r){return(lg(r)?r.validators:r)||null}function RS(r,e){return(lg(e)?e.asyncValidators:r)||null}function lg(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function DB(r,e,t){const n=r.controls;if(!(e?Object.keys(n):n).length)throw new ge(1e3,"");if(!n[t])throw new ge(1001,"")}function HB(r,e,t){r._forEachChild((n,i)=>{if(void 0===t[i])throw new ge(1002,"")})}class ug{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Y7}get invalid(){return this.status===cg}get pending(){return this.status==F8}get disabled(){return this.status===K7}get enabled(){return this.status!==K7}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(kB(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(kB(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(xB(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(xB(e,this._rawAsyncValidators))}hasValidator(e){return og(this._rawValidators,e)}hasAsyncValidator(e){return og(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=F8,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=K7,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=Y7,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Y7||this.status===F8)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?K7:Y7}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=F8,this._hasOwnPendingAsyncValidator=!0;const t=SB(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new I1,this.statusChanges=new I1}_calculateStatus(){return this._allControlsDisabled()?K7:this.errors?cg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(F8)?F8:this._anyControlsHaveStatus(cg)?cg:Y7}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){lg(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function yge(r){return Array.isArray(r)?NS(r):r||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Mge(r){return Array.isArray(r)?AS(r):r||null}(this._rawAsyncValidators)}}class $4 extends ug{constructor(e,t,n){super(LS(t),RS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){HB(this,0,e),Object.keys(e).forEach(n=>{DB(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,s)=>{n=t(n,i,s)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class VB extends $4{}const v6=new et("CallSetDisabledState",{providedIn:"root",factory:()=>X7}),X7="always";function fg(r,e){return[...e.path,r]}function Q7(r,e,t=X7){zS(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(r.disabled),function Sge(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&FB(r,e)})}(r,e),function Tge(r,e){const t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}(r,e),function Pge(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&FB(r,e),"submit"!==r.updateOn&&r.markAsTouched()})}(r,e),function Ege(r,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}(r,e)}function dg(r,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),pg(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function hg(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function zS(r,e){const t=AB(r);null!==e.validator?r.setValidators(NB(t,e.validator)):"function"==typeof t&&r.setValidators([t]);const n=IB(r);null!==e.asyncValidator?r.setAsyncValidators(NB(n,e.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();hg(e._rawValidators,i),hg(e._rawAsyncValidators,i)}function pg(r,e){let t=!1;if(null!==r){if(null!==e.validator){const i=AB(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,r.setValidators(s))}}if(null!==e.asyncValidator){const i=IB(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,r.setAsyncValidators(s))}}}const n=()=>{};return hg(e._rawValidators,n),hg(e._rawAsyncValidators,n),t}function FB(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function $B(r,e){zS(r,e)}function HS(r,e){if(!r.hasOwnProperty("model"))return!1;const t=r.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function GB(r,e){r._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function VS(r,e){if(!e)return null;let t,n,i;return Array.isArray(e),e.forEach(s=>{s.constructor===vc?t=s:function wge(r){return Object.getPrototypeOf(r.constructor)===m6}(s)?n=s:i=s}),i||n||t||null}const Age={provide:cs,useExisting:w1(()=>ef)},J7=(()=>Promise.resolve())();let ef=(()=>{var r;class e extends cs{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new I1,this.form=new $4({},NS(n),AS(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){J7.then(()=>{const i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),Q7(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){J7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){J7.then(()=>{const i=this._findContainer(n.path),s=new $4({});$B(s,n),i.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){J7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){J7.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,GB(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Ai,10),B(V4,10),B(v6,8))},r.\u0275dir=Lt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&W("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[J1([Age]),Xe]}),e})();function BB(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}function UB(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const oo=class extends ug{constructor(e=null,t,n){super(LS(t),RS(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),lg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=UB(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){BB(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){BB(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){UB(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},xge={provide:F4,useExisting:w1(()=>tf)},jB=(()=>Promise.resolve())();let tf=(()=>{var r;class e extends F4{constructor(n,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new oo,this._registered=!1,this.name="",this.update=new I1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=VS(0,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),HS(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Q7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){jB.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,s=0!==i&&H8(i);jB.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?fg(n,this._parent):[n]}}return(r=e).\u0275fac=function(n){return new(n||r)(B(cs,9),B(Ai,10),B(V4,10),B(_c,10),B(T3,8),B(v6,8))},r.\u0275dir=Lt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[J1([xge]),Xe,es]}),e})(),C6=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Lt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),YB=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({}),e})();const Dge={provide:_c,useExisting:w1(()=>gg),multi:!0};let gg=(()=>{var r;class e extends m6{writeValue(n){this.setProperty("value",parseFloat(n))}registerOnChange(n){this.onChange=i=>{n(""==i?null:parseFloat(i))}}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Lt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[J1([Dge]),Xe]}),e})();const FS=new et("NgModelWithFormControlWarning"),Hge={provide:F4,useExisting:w1(()=>$S)};let $S=(()=>{var r;class e extends F4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=a,this.update=new I1,this._ngModelWarningSent=!1,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=VS(0,s)}ngOnChanges(n){if(this._isControlChanged(n)){const i=n.form.previousValue;i&&dg(i,this,!1),Q7(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}HS(n,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&dg(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_isControlChanged(n){return n.hasOwnProperty("form")}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(B(Ai,10),B(V4,10),B(_c,10),B(FS,8),B(v6,8))},r.\u0275dir=Lt({type:r,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[J1([Hge]),Xe,es]}),e})();const Vge={provide:cs,useExisting:w1(()=>y6)};let y6=(()=>{var r;class e extends cs{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new I1,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(pg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const i=this.form.get(n.path);return Q7(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){dg(n.control||null,n,!1),function Nge(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,GB(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const i=n.control,s=this.form.get(n.path);i!==s&&(dg(i||null,n),(r=>r instanceof oo)(s)&&(Q7(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const i=this.form.get(n.path);$B(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const i=this.form.get(n.path);i&&function Oge(r,e){return pg(r,e)}(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){zS(this.form,this),this._oldForm&&pg(this._oldForm,this)}_checkFormPresent(){}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Ai,10),B(V4,10),B(v6,8))},r.\u0275dir=Lt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&W("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[J1([Vge]),Xe,es]}),e})();const Gge={provide:F4,useExisting:w1(()=>$8)};let $8=(()=>{var r;class e extends F4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new I1,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=VS(0,o)}ngOnChanges(n){this._added||this._setUpControl(),HS(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return fg(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(B(cs,13),B(Ai,10),B(V4,10),B(_c,10),B(FS,8))},r.\u0275dir=Lt({type:r,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[J1([Gge]),Xe,es]}),e})();const Bge={provide:_c,useExisting:w1(()=>mg),multi:!0};function QB(r,e){return null==r?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let mg=(()=>{var r;class e extends m6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const s=QB(this._getOptionId(n),n);this.setProperty("value",s)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function Uge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Lt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[J1([Bge]),Xe]}),e})(),nf=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(QB(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(bi),B(fc),B(mg,9))},r.\u0275dir=Lt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Wge={provide:_c,useExisting:w1(()=>US),multi:!0};function JB(r,e){return null==r?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let US=(()=>{var r;class e extends m6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const s=n.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const s=[],o=i.selectedOptions;if(void 0!==o){const a=o;for(let c=0;c<a.length;c++){const f=this._getOptionValue(a[c].value);s.push(f)}}else{const a=i.options;for(let c=0;c<a.length;c++){const l=a[c];if(l.selected){const f=this._getOptionValue(l.value);s.push(f)}}}this.value=s,n(s)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function qge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Lt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&W("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[J1([Wge]),Xe]}),e})(),rf=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(JB(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(JB(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(bi),B(fc),B(US,9))},r.\u0275dir=Lt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();let M6=(()=>{var r;class e{constructor(){this._validator=sg}ngOnChanges(n){if(this.inputName in n){const i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):sg,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Lt({type:r,features:[es]}),e})();const Yge={provide:Ai,useExisting:w1(()=>E6),multi:!0};let E6=(()=>{var r;class e extends M6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=H8,this.createValidator=n=>mB}enabled(n){return n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Lt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&I("required",i._enabled?"":null)},inputs:{required:"required"},features:[J1([Yge]),Xe]}),e})();const Jge={provide:Ai,useExisting:w1(()=>WS),multi:!0};let WS=(()=>{var r;class e extends M6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=n=>function eU(r){return"number"==typeof r?r:parseInt(r,10)}(n),this.createValidator=n=>yB(n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275dir=Lt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&I("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[J1([Jge]),Xe]}),e})(),cU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({imports:[YB]}),e})();class lU extends ug{constructor(e,t,n){super(LS(t),RS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){HB(this,0,e),e.forEach((n,i)=>{DB(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function uU(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let tme=(()=>{var r;class e{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,i=null){const s=this._reduceControls(n);let o={};return uU(i)?o=i:null!==i&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new $4(s,o)}record(n,i=null){const s=this._reduceControls(n);return new VB(s,i)}control(n,i,s){let o={};return this.useNonNullable?(uU(i)?o=i:(o.validators=i,o.asyncValidators=s),new oo(n,{...o,nonNullable:!0})):new oo(n,i,s)}array(n,i,s){const o=n.map(a=>this._createControl(a));return new lU(o,i,s)}_reduceControls(n){const i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){return n instanceof oo||n instanceof ug?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),nme=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:v6,useValue:n.callSetDisabledState??X7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({imports:[cU]}),e})(),rme=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:FS,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:v6,useValue:n.callSetDisabledState??X7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({imports:[cU]}),e})();function G8(r,e){return yn(e)?X2(r,e,1):X2(r,1)}function A3(r,e){return Kr((t,n)=>{let i=0;t.subscribe(Cr(n,s=>r.call(e,s,i++)&&n.next(s)))})}function sf(r){return Kr((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}class _g{}class vg{}class Cc{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),s=i.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Cc?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Cc;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Cc?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class ime{encodeKey(e){return fU(e)}encodeValue(e){return fU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const ome=/%(\d[a-f0-9])/gi,ame={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function fU(r){return encodeURIComponent(r).replace(ome,(e,t)=>ame[t]??e)}function Cg(r){return`${r}`}class G4{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new ime,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function sme(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],i=Array.isArray(n)?n.map(Cg):[Cg(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new G4({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Cg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(Cg(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class cme{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function dU(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function hU(r){return typeof Blob<"u"&&r instanceof Blob}function pU(r){return typeof FormData<"u"&&r instanceof FormData}class af{constructor(e,t,n,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function lme(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Cc),this.context||(this.context=new cme),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new G4,this.urlWithParams=t}serializeBody(){return null===this.body?null:dU(this.body)||hU(this.body)||pU(this.body)||function ume(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof G4?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||pU(this.body)?null:hU(this.body)?this.body.type||null:dU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof G4?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),l)),new af(t,n,s,{params:l,headers:c,context:f,reportProgress:a,responseType:i,withCredentials:o})}}var B8=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(B8||{});class qS{constructor(e,t=200,n="OK"){this.headers=e.headers||new Cc,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class jS extends qS{constructor(e={}){super(e),this.type=B8.ResponseHeader}clone(e={}){return new jS({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class U8 extends qS{constructor(e={}){super(e),this.type=B8.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new U8({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class gU extends qS{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function ZS(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials}}let fme=(()=>{var r;class e{constructor(n){this.handler=n}request(n,i,s={}){let o;if(n instanceof af)o=n;else{let l,f;l=s.headers instanceof Cc?s.headers:new Cc(s.headers),s.params&&(f=s.params instanceof G4?s.params:new G4({fromObject:s.params})),o=new af(n,i,void 0!==s.body?s.body:null,{headers:l,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const a=Dt(o).pipe(G8(l=>this.handler.handle(l)));if(n instanceof af||"events"===s.observe)return a;const c=a.pipe(A3(l=>l instanceof U8));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(qn(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(qn(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(qn(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return c.pipe(qn(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new G4).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,ZS(s,i))}post(n,i,s={}){return this.request("POST",n,ZS(s,i))}put(n,i,s={}){return this.request("PUT",n,ZS(s,i))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(_g))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function vU(r,e){return e(r)}function hme(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}const gme=new et(""),cf=new et(""),CU=new et("");function mme(){let r=null;return(e,t)=>{null===r&&(r=(nt(gme,{optional:!0})??[]).reduceRight(hme,vU));const n=nt(Hp),i=n.add();return r(e,t).pipe(sf(()=>n.remove(i)))}}let yU=(()=>{var r;class e extends _g{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=nt(Hp)}handle(n){if(null===this.chain){const s=Array.from(new Set([...this.injector.get(cf),...this.injector.get(CU,[])]));this.chain=s.reduceRight((o,a)=>function pme(r,e,t){return(n,i)=>t.runInContext(()=>e(n,s=>r(s,i)))}(o,a,this.injector),vU)}const i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(sf(()=>this.pendingTasks.remove(i)))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(vg),Pe(no))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const yme=/^\)\]\}',?\n/;let EU=(()=>{var r;class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new ge(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?a2(i.\u0275loadImpl()):Dt(null)).pipe(da(()=>new b1(o=>{const a=i.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((z,$)=>a.setRequestHeader(z,$.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const z=n.detectContentTypeHeader();null!==z&&a.setRequestHeader("Content-Type",z)}if(n.responseType){const z=n.responseType.toLowerCase();a.responseType="json"!==z?z:"text"}const c=n.serializeBody();let l=null;const f=()=>{if(null!==l)return l;const z=a.statusText||"OK",$=new Cc(a.getAllResponseHeaders()),G=function Mme(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(a)||n.url;return l=new jS({headers:$,status:a.status,statusText:z,url:G}),l},d=()=>{let{headers:z,status:$,statusText:G,url:de}=f(),ve=null;204!==$&&(ve=typeof a.response>"u"?a.responseText:a.response),0===$&&($=ve?200:0);let xe=$>=200&&$<300;if("json"===n.responseType&&"string"==typeof ve){const tt=ve;ve=ve.replace(yme,"");try{ve=""!==ve?JSON.parse(ve):null}catch(pt){ve=tt,xe&&(xe=!1,ve={error:pt,text:ve})}}xe?(o.next(new U8({body:ve,headers:z,status:$,statusText:G,url:de||void 0})),o.complete()):o.error(new gU({error:ve,headers:z,status:$,statusText:G,url:de||void 0}))},m=z=>{const{url:$}=f(),G=new gU({error:z,status:a.status||0,statusText:a.statusText||"Unknown Error",url:$||void 0});o.error(G)};let E=!1;const w=z=>{E||(o.next(f()),E=!0);let $={type:B8.DownloadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),"text"===n.responseType&&a.responseText&&($.partialText=a.responseText),o.next($)},R=z=>{let $={type:B8.UploadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),o.next($)};return a.addEventListener("load",d),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),n.reportProgress&&(a.addEventListener("progress",w),null!==c&&a.upload&&a.upload.addEventListener("progress",R)),a.send(c),o.next({type:B8.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",d),a.removeEventListener("timeout",m),n.reportProgress&&(a.removeEventListener("progress",w),null!==c&&a.upload&&a.upload.removeEventListener("progress",R)),a.readyState!==a.DONE&&a.abort()}})))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(VG))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const YS=new et("XSRF_ENABLED"),SU=new et("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),PU=new et("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class TU{}let Pme=(()=>{var r;class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=NG(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(w2),Pe(C3),Pe(SU))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function Tme(r,e){const t=r.url.toLowerCase();if(!nt(YS)||"GET"===r.method||"HEAD"===r.method||t.startsWith("http://")||t.startsWith("https://"))return e(r);const n=nt(TU).getToken(),i=nt(PU);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var B4=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(B4||{});function S6(r,e){return{\u0275kind:r,\u0275providers:e}}function Ome(...r){const e=[fme,EU,yU,{provide:_g,useExisting:yU},{provide:vg,useExisting:EU},{provide:cf,useValue:Tme,multi:!0},{provide:YS,useValue:!0},{provide:TU,useClass:Pme}];for(const t of r)e.push(...t.\u0275providers);return function MM(r){return{\u0275providers:r}}(e)}const OU=new et("LEGACY_INTERCEPTOR_FN");let wme=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({providers:[Ome(S6(B4.LegacyInterceptors,[{provide:OU,useFactory:mme},{provide:cf,useExisting:OU,multi:!0}]))]}),e})();function KS(...r){const e=qu(r),t=HR(r),{args:n,keys:i}=lB(r);if(0===n.length)return a2([],e);const s=new b1(function Rme(r,e,t=tc){return n=>{bU(e,()=>{const{length:i}=r,s=new Array(i);let o=i,a=i;for(let c=0;c<i;c++)bU(e,()=>{const l=a2(r[c],e);let f=!1;l.subscribe(Cr(n,d=>{s[c]=d,f||(f=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,i?o=>fB(i,o):tc));return t?s.pipe(uB(t)):s}function bU(r,e,t){r?d3(t,r,e):e()}const Mg=To(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function XS(...r){return function zme(){return j0(1)}()(a2(r,qu(r)))}function wU(r){return new b1(e=>{Ks(r()).subscribe(e)})}function lf(r,e){const t=yn(r)?r:()=>r,n=i=>i.error(t());return new b1(e?i=>e.schedule(n,0,i):n)}function QS(){return Kr((r,e)=>{let t=null;r._refCount++;const n=Cr(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class NU extends b1{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ch(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Mn;const t=this.getSubject();e.add(this.source.subscribe(Cr(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Mn.EMPTY)}return e}refCount(){return QS()(this)}}function W8(r){return r<=0?()=>nc:Kr((e,t)=>{let n=0;e.subscribe(Cr(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function Eg(r){return Kr((e,t)=>{let n=!1;e.subscribe(Cr(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function AU(r=Hme){return Kr((e,t)=>{let n=!1;e.subscribe(Cr(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function Hme(){return new Mg}function P6(r,e){const t=arguments.length>=2;return n=>n.pipe(r?A3((i,s)=>r(i,s,n)):tc,W8(1),t?Eg(e):AU(()=>new Mg))}function Ii(r,e,t){const n=yn(r)||e||t?{next:r,error:e,complete:t}:r;return n?Kr((i,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;i.subscribe(Cr(s,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),s.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),s.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),s.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):tc}function T6(r){return Kr((e,t)=>{let s,n=null,i=!1;n=e.subscribe(Cr(t,void 0,void 0,o=>{s=Ks(r(o,T6(r)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,s.subscribe(t))})}function JS(r){return r<=0?()=>nc:Kr((e,t)=>{let n=[];e.subscribe(Cr(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}const nn="primary",uf=Symbol("RouteTitle");class Bme{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function q8(r){return new Bme(r)}function Ume(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let s=0;s<n.length;s++){const o=n[s],a=r[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function yc(r,e){const t=r?Object.keys(r):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!IU(r[i],e[i]))return!1;return!0}function IU(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,s)=>n[s]===i)}return r===e}function kU(r){return r.length>0?r[r.length-1]:null}function U4(r){return function Lme(r){return!!r&&(r instanceof b1||yn(r.lift)&&yn(r.subscribe))}(r)?r:I7(r)?a2(Promise.resolve(r)):Dt(r)}const qme={exact:function RU(r,e,t){if(!O6(r.segments,e.segments)||!Sg(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!RU(r.children[n],e.children[n],t))return!1;return!0},subset:zU},xU={exact:function jme(r,e){return yc(r,e)},subset:function Zme(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>IU(r[t],e[t]))},ignored:()=>!0};function LU(r,e,t){return qme[t.paths](r.root,e.root,t.matrixParams)&&xU[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function zU(r,e,t){return DU(r,e,e.segments,t)}function DU(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!O6(i,t)||e.hasChildren()||!Sg(i,t,n))}if(r.segments.length===t.length){if(!O6(r.segments,t)||!Sg(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!zU(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),s=t.slice(r.segments.length);return!!(O6(r.segments,i)&&Sg(r.segments,i,n)&&r.children[nn])&&DU(r.children[nn],e,s,n)}}function Sg(r,e,t){return e.every((n,i)=>xU[t](r[i].parameters,n.parameters))}class j8{constructor(e=new u1([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=q8(this.queryParams)),this._queryParamMap}toString(){return Xme.serialize(this)}}class u1{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pg(this)}}class ff{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=q8(this.parameters)),this._parameterMap}toString(){return FU(this)}}function O6(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}let df=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new eP},providedIn:"root"}),e})();class eP{parse(e){const t=new c_e(e);return new j8(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${hf(e.root,!0)}`,n=function e_e(r){const e=Object.keys(r).map(t=>{const n=r[t];return Array.isArray(n)?n.map(i=>`${Tg(t)}=${Tg(i)}`).join("&"):`${Tg(t)}=${Tg(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function Qme(r){return encodeURI(r)}(e.fragment)}`:""}`}}const Xme=new eP;function Pg(r){return r.segments.map(e=>FU(e)).join("/")}function hf(r,e){if(!r.hasChildren())return Pg(r);if(e){const t=r.children[nn]?hf(r.children[nn],!1):"",n=[];return Object.entries(r.children).forEach(([i,s])=>{i!==nn&&n.push(`${i}:${hf(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function Kme(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===nn&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==nn&&(t=t.concat(e(i,n)))}),t}(r,(n,i)=>i===nn?[hf(r.children[nn],!1)]:[`${i}:${hf(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[nn]?`${Pg(r)}/${t[0]}`:`${Pg(r)}/(${t.join("//")})`}}function HU(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Tg(r){return HU(r).replace(/%3B/gi,";")}function tP(r){return HU(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Og(r){return decodeURIComponent(r)}function VU(r){return Og(r.replace(/\+/g,"%20"))}function FU(r){return`${tP(r.path)}${function Jme(r){return Object.keys(r).map(e=>`;${tP(e)}=${tP(r[e])}`).join("")}(r.parameters)}`}const t_e=/^[^\/()?;#]+/;function nP(r){const e=r.match(t_e);return e?e[0]:""}const n_e=/^[^\/()?;=#]+/,i_e=/^[^=?&#]+/,o_e=/^[^&#]+/;class c_e{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new u1([],{}):new u1([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[nn]=new u1(e,t)),n}parseSegment(){const e=nP(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(e),new ff(Og(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function r_e(r){const e=r.match(n_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=nP(this.remaining);i&&(n=i,this.capture(n))}e[Og(t)]=Og(n)}parseQueryParam(e){const t=function s_e(r){const e=r.match(i_e);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function a_e(r){const e=r.match(o_e);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const i=VU(t),s=VU(n);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=nP(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new ge(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=nn);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[nn]:new u1([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ge(4011,!1)}}function $U(r){return r.segments.length>0?new u1([],{[nn]:r}):r}function GU(r){const e={};for(const n of Object.keys(r.children)){const s=GU(r.children[n]);if(n===nn&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function l_e(r){if(1===r.numberOfChildren&&r.children[nn]){const e=r.children[nn];return new u1(r.segments.concat(e.segments),e.children)}return r}(new u1(r.segments,e))}function b6(r){return r instanceof j8}function BU(r){let e;const i=$U(function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new u1(s.url,o);return s===r&&(e=a),a}(r.root));return e??i}function UU(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(0===e.length)return rP(i,i,i,t,n);const s=function f_e(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new qU(!0,0,r);let e=0,t=!1;const n=r.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new qU(t,e,n)}(e);if(s.toRoot())return rP(i,i,new u1([],{}),t,n);const o=function d_e(r,e,t){if(r.isAbsolute)return new wg(e,!0,0);if(!t)return new wg(e,!1,NaN);if(null===t.parent)return new wg(t,!0,0);const n=bg(r.commands[0])?0:1;return function h_e(r,e,t){let n=r,i=e,s=t;for(;s>i;){if(s-=i,n=n.parent,!n)throw new ge(4005,!1);i=n.segments.length}return new wg(n,!1,i-s)}(t,t.segments.length-1+n,r.numberOfDoubleDots)}(s,i,r),a=o.processChildren?gf(o.segmentGroup,o.index,s.commands):jU(o.segmentGroup,o.index,s.commands);return rP(i,o.segmentGroup,a,t,n)}function bg(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function pf(r){return"object"==typeof r&&null!=r&&r.outlets}function rP(r,e,t,n,i){let o,s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),o=r===e?t:WU(r,e,t);const a=$U(GU(o));return new j8(a,s,i)}function WU(r,e,t){const n={};return Object.entries(r.children).forEach(([i,s])=>{n[i]=s===e?t:WU(s,e,t)}),new u1(r.segments,n)}class qU{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&bg(n[0]))throw new ge(4003,!1);const i=n.find(pf);if(i&&i!==kU(n))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class wg{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function jU(r,e,t){if(r||(r=new u1([],{})),0===r.segments.length&&r.hasChildren())return gf(r,e,t);const n=function g_e(r,e,t){let n=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return s;const o=r.segments[i],a=t[n];if(pf(a))break;const c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!YU(c,l,o))return s;n+=2}else{if(!YU(c,{},o))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const s=new u1(r.segments.slice(0,n.pathIndex),{});return s.children[nn]=new u1(r.segments.slice(n.pathIndex),r.children),gf(s,0,i)}return n.match&&0===i.length?new u1(r.segments,{}):n.match&&!r.hasChildren()?iP(r,e,t):n.match?gf(r,0,i):iP(r,e,t)}function gf(r,e,t){if(0===t.length)return new u1(r.segments,{});{const n=function p_e(r){return pf(r[0])?r[0].outlets:{[nn]:r}}(t),i={};if(!n[nn]&&r.children[nn]&&1===r.numberOfChildren&&0===r.children[nn].segments.length){const s=gf(r.children[nn],e,t);return new u1(r.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=jU(r.children[s],e,o))}),Object.entries(r.children).forEach(([s,o])=>{void 0===n[s]&&(i[s]=o)}),new u1(r.segments,i)}}function iP(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(pf(s)){const c=m_e(s.outlets);return new u1(n,c)}if(0===i&&bg(t[0])){n.push(new ff(r.segments[e].path,ZU(t[0]))),i++;continue}const o=pf(s)?s.outlets[nn]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&bg(a)?(n.push(new ff(o,ZU(a))),i+=2):(n.push(new ff(o,{})),i++)}return new u1(n,{})}function m_e(r){const e={};return Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(e[t]=iP(new u1([],{}),0,n))}),e}function ZU(r){const e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function YU(r,e,t){return r==t.path&&yc(e,t.parameters)}const mf="imperative";class Mc{constructor(e,t){this.id=e,this.url=t}}class sP extends Mc{constructor(e,t,n="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class W4 extends Mc{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Ng extends Mc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class _f extends Mc{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=16}}class oP extends Mc{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class __e extends Mc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class v_e extends Mc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class C_e extends Mc{constructor(e,t,n,i,s){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class y_e extends Mc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class M_e extends Mc{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class E_e{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class S_e{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class P_e{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class T_e{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class O_e{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class b_e{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class KU{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class w_e{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new vf,this.attachRef=null}}let vf=(()=>{var r;class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new w_e,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class XU{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=aP(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=aP(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=cP(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return cP(e,this._root).map(t=>t.value)}}function aP(r,e){if(r===e.value)return e;for(const t of e.children){const n=aP(r,t);if(n)return n}return null}function cP(r,e){if(r===e.value)return[e];for(const t of e.children){const n=cP(r,t);if(n.length)return n.unshift(e),n}return[]}class I3{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Z8(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class QU extends XU{constructor(e,t){super(e),this.snapshot=t,lP(this,e)}toString(){return this.snapshot.toString()}}function JU(r,e){const t=function N_e(r,e){const o=new Ag([],{},{},"",{},nn,e,null,{});return new tW("",new I3(o,[]))}(0,e),n=new Qi([new ff("",{})]),i=new Qi({}),s=new Qi({}),o=new Qi({}),a=new Qi(""),c=new Ls(n,i,o,a,s,nn,e,t.root);return c.snapshot=t.root,new QU(new I3(c,[]),t)}class Ls{constructor(e,t,n,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(qn(l=>l[uf]))??Dt(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(qn(e=>q8(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(qn(e=>q8(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function eW(r,e="emptyOnly"){const t=r.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const i=t[n],s=t[n-1];if(i.routeConfig&&""===i.routeConfig.path)n--;else{if(s.component)break;n--}}return function A_e(r){return r.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class Ag{get title(){return this.data?.[uf]}constructor(e,t,n,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=q8(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=q8(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class tW extends XU{constructor(e,t){super(t),this.url=e,lP(this,t)}toString(){return nW(this._root)}}function lP(r,e){e.value._routerState=r,e.children.forEach(t=>lP(r,t))}function nW(r){const e=r.children.length>0?` { ${r.children.map(nW).join(", ")} } `:"";return`${r.value}${e}`}function uP(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,yc(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),yc(e.params,t.params)||r.paramsSubject.next(t.params),function Wme(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!yc(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.urlSubject.next(t.url),yc(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function fP(r,e){const t=yc(r.params,e.params)&&function Yme(r,e){return O6(r,e)&&r.every((t,n)=>yc(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||fP(r.parent,e.parent))}let dP=(()=>{var r;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=nn,this.activateEvents=new I1,this.deactivateEvents=new I1,this.attachEvents=new I1,this.detachEvents=new I1,this.parentContexts=nt(vf),this.location=nt(io),this.changeDetector=nt(T3),this.environmentInjector=nt(no),this.inputBinder=nt(Ig,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=n;const s=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new I_e(n,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Lt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[es]}),e})();class I_e{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Ls?this.route:e===vf?this.childContexts:this.parent.get(e,t)}}const Ig=new et("");let rW=(()=>{var r;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,s=KS([i.queryParams,i.params,i.data]).pipe(da(([o,a,c],l)=>(c={...o,...a,...c},0===l?Dt(c):Promise.resolve(c)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const a=function Lde(r){const e=Rn(r);if(!e)return null;const t=new O7(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(a)for(const{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,s)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function Cf(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function x_e(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return Cf(r,n,i);return Cf(r,n)})}(r,e,t);return new I3(n,i)}{if(r.shouldAttach(e.value)){const s=r.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Cf(r,a)),o}}const n=function L_e(r){return new Ls(new Qi(r.url),new Qi(r.params),new Qi(r.queryParams),new Qi(r.fragment),new Qi(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(s=>Cf(r,s));return new I3(n,i)}}const hP="ngNavigationCancelingError";function iW(r,e){const{redirectTo:t,navigationBehaviorOptions:n}=b6(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=sW(!1,0,e);return i.url=t,i.navigationBehaviorOptions=n,i}function sW(r,e,t){const n=new Error("NavigationCancelingError: "+(r||""));return n[hP]=!0,n.cancellationCode=e,t&&(n.url=t),n}function oW(r){return aW(r)&&b6(r.url)}function aW(r){return r&&r[hP]}let cW=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275cmp=We({type:r,selectors:[["ng-component"]],standalone:!0,features:[FF],decls:1,vars:0,template:function(n,i){1&n&&F(0,"router-outlet")},dependencies:[dP],encapsulation:2}),e})();function pP(r){const e=r.children&&r.children.map(pP),t=e?{...r,children:e}:{...r};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==nn&&(t.component=cW),t}function Ea(r){return r.outlet||nn}function yf(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class $_e{constructor(e,t,n,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),uP(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=Z8(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],n),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=n.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=Z8(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=Z8(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){const i=Z8(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new b_e(s.value.snapshot))}),e.children.length&&this.forwardEvent(new T_e(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(uP(i),i===s)if(i.component){const o=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),uP(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=yf(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class lW{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class kg{constructor(e,t){this.component=e,this.route=t}}function G_e(r,e,t){const n=r._root;return Mf(n,e?e._root:null,t,[n.value])}function Y8(r,e){const t=Symbol(),n=e.get(r,t);return n===t?"function"!=typeof r||function ele(r){return null!==ph(r)}(r)?e.get(r):r:n}function Mf(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Z8(e);return r.children.forEach(o=>{(function U_e(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=r.value,o=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function W_e(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!O6(r.url,e.url);case"pathParamsOrQueryParamsChange":return!O6(r.url,e.url)||!yc(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!fP(r,e)||!yc(r.queryParams,e.queryParams);default:return!fP(r,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new lW(n)):(s.data=o.data,s._resolvedData=o._resolvedData),Mf(r,e,s.component?a?a.children:null:t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new kg(a.outlet.component,o))}else o&&Ef(e,a,i),i.canActivateChecks.push(new lW(n)),Mf(r,null,s.component?a?a.children:null:t,n,i)})(o,s[o.value.outlet],t,n.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Ef(a,t.getContext(o),i)),i}function Ef(r,e,t){const n=Z8(r),i=r.value;Object.entries(n).forEach(([s,o])=>{Ef(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new kg(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Sf(r){return"function"==typeof r}function uW(r){return r instanceof Mg||"EmptyError"===r?.name}const xg=Symbol("INITIAL_VALUE");function K8(){return da(r=>KS(r.map(e=>e.pipe(W8(1),function Dme(...r){const e=qu(r);return Kr((t,n)=>{(e?XS(r,t,e):XS(r,t)).subscribe(n)})}(xg)))).pipe(qn(e=>{for(const t of e)if(!0!==t){if(t===xg)return xg;if(!1===t||t instanceof j8)return t}return!0}),A3(e=>e!==xg),W8(1)))}function fW(r){return function ih(...r){return sh(r)}(Ii(e=>{if(b6(e))throw iW(0,e)}),qn(e=>!0===e))}class Lg{constructor(e){this.segmentGroup=e||null}}class dW{constructor(e){this.urlTree=e}}function X8(r){return lf(new Lg(r))}function hW(r){return lf(new dW(r))}class fve{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ge(4002,!1)}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Dt(n);if(i.numberOfChildren>1||!i.children[nn])return lf(new ge(4e3,!1));i=i.children[nn]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,i){const s=this.createSegmentGroup(e,t.root,n,i);return new j8(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);n[i]=t[a]}else n[i]=s}),n}createSegmentGroup(e,t,n,i){const s=this.createSegments(e,t.segments,n,i);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,n,i)}),new u1(s,o)}createSegments(e,t,n,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new ge(4001,!1);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}const gP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function dve(r,e,t,n,i){const s=mP(r,e,t);return s.matched?(n=function R_e(r,e){return r.providers&&!r._injector&&(r._injector=ME(r.providers,e,`Route: ${r.path}`)),r._injector??e}(e,n),function cve(r,e,t,n){const i=e.canMatch;return i&&0!==i.length?Dt(i.map(o=>{const a=Y8(o,r);return U4(function X_e(r){return r&&Sf(r.canMatch)}(a)?a.canMatch(e,t):r.runInContext(()=>a(e,t)))})).pipe(K8(),fW()):Dt(!0)}(n,e,t).pipe(qn(o=>!0===o?s:{...gP}))):Dt(s)}function mP(r,e,t){if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?{...gP}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||Ume)(t,r,e);if(!i)return{...gP};const s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function pW(r,e,t,n){return t.length>0&&function gve(r,e,t){return t.some(n=>Rg(r,e,n)&&Ea(n)!==nn)}(r,t,n)?{segmentGroup:new u1(e,pve(n,new u1(t,r.children))),slicedSegments:[]}:0===t.length&&function mve(r,e,t){return t.some(n=>Rg(r,e,n))}(r,t,n)?{segmentGroup:new u1(r.segments,hve(r,0,t,n,r.children)),slicedSegments:t}:{segmentGroup:new u1(r.segments,r.children),slicedSegments:t}}function hve(r,e,t,n,i){const s={};for(const o of n)if(Rg(r,t,o)&&!i[Ea(o)]){const a=new u1([],{});s[Ea(o)]=a}return{...i,...s}}function pve(r,e){const t={};t[nn]=e;for(const n of r)if(""===n.path&&Ea(n)!==nn){const i=new u1([],{});t[Ea(n)]=i}return t}function Rg(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class yve{constructor(e,t,n,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new fve(this.urlSerializer,this.urlTree)}noMatchError(e){return new ge(4002,!1)}recognize(){const e=pW(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,nn).pipe(T6(t=>{if(t instanceof dW)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Lg?this.noMatchError(t):t}),qn(t=>{const n=new Ag([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},nn,this.rootComponentType,null,{}),i=new I3(n,t),s=new tW("",i),o=function u_e(r,e,t=null,n=null){return UU(BU(r),e,t,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,nn).pipe(T6(n=>{throw n instanceof Lg?this.noMatchError(n):n}))}inheritParamsAndData(e){const t=e.value,n=eW(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0)}processChildren(e,t,n){const i=[];for(const s of Object.keys(n.children))"primary"===s?i.unshift(s):i.push(s);return a2(i).pipe(G8(s=>{const o=n.children[s],a=function V_e(r,e){const t=r.filter(n=>Ea(n)===e);return t.push(...r.filter(n=>Ea(n)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function Fme(r,e){return Kr(function Vme(r,e,t,n,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(Cr(o,f=>{const d=l++;c=a?r(c,f,d):(a=!0,f),n&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}(r,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),Eg(null),function $me(r,e){const t=arguments.length>=2;return n=>n.pipe(r?A3((i,s)=>r(i,s,n)):tc,JS(1),t?Eg(e):AU(()=>new Mg))}(),X2(s=>{if(null===s)return X8(n);const o=gW(s);return function Mve(r){r.sort((e,t)=>e.value.outlet===nn?-1:t.value.outlet===nn?1:e.value.outlet.localeCompare(t.value.outlet))}(o),Dt(o)}))}processSegment(e,t,n,i,s,o){return a2(t).pipe(G8(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,i,s,o).pipe(T6(c=>{if(c instanceof Lg)return Dt(null);throw c}))),P6(a=>!!a),T6(a=>{if(uW(a))return function vve(r,e,t){return 0===e.length&&!r.children[t]}(n,i,s)?Dt([]):X8(n);throw a}))}processSegmentAgainstRoute(e,t,n,i,s,o,a){return function _ve(r,e,t,n){return!!(Ea(r)===n||n!==nn&&Rg(e,t,r))&&("**"===r.path||mP(e,r,t).matched)}(n,i,s,o)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,i,n,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,s,o):X8(i):X8(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,i){const s=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?hW(s):this.applyRedirects.lineralizeSegments(n,s).pipe(X2(o=>{const a=new u1(o,{});return this.processSegment(e,t,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:f}=mP(t,i,s);if(!a)return X8(t);const d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,f);return i.redirectTo.startsWith("/")?hW(d):this.applyRedirects.lineralizeSegments(i,d).pipe(X2(m=>this.processSegment(e,n,t,m.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,n,i,s,o){let a;if("**"===n.path){const c=i.length>0?kU(i).parameters:{};a=Dt({snapshot:new Ag(i,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,mW(n),Ea(n),n.component??n._loadedComponent??null,n,_W(n)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=dve(t,n,i,e).pipe(qn(({matched:c,consumedSegments:l,remainingSegments:f,parameters:d})=>c?{snapshot:new Ag(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,mW(n),Ea(n),n.component??n._loadedComponent??null,n,_W(n)),consumedSegments:l,remainingSegments:f}:null));return a.pipe(da(c=>null===c?X8(t):this.getChildConfig(e=n._injector??e,n,i).pipe(da(({routes:l})=>{const f=n._loadedInjector??e,{snapshot:d,consumedSegments:m,remainingSegments:E}=c,{segmentGroup:w,slicedSegments:R}=pW(t,m,E,l);if(0===R.length&&w.hasChildren())return this.processChildren(f,l,w).pipe(qn($=>null===$?null:[new I3(d,$)]));if(0===l.length&&0===R.length)return Dt([new I3(d,[])]);const z=Ea(n)===s;return this.processSegment(f,l,w,R,z?nn:s,!0).pipe(qn($=>[new I3(d,$)]))}))))}getChildConfig(e,t,n){return t.children?Dt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Dt({routes:t._loadedRoutes,injector:t._loadedInjector}):function ave(r,e,t,n){const i=e.canLoad;return void 0===i||0===i.length?Dt(!0):Dt(i.map(o=>{const a=Y8(o,r);return U4(function j_e(r){return r&&Sf(r.canLoad)}(a)?a.canLoad(e,t):r.runInContext(()=>a(e,t)))})).pipe(K8(),fW())}(e,t,n).pipe(X2(i=>i?this.configLoader.loadChildren(e,t).pipe(Ii(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function uve(r){return lf(sW(!1,3))}())):Dt({routes:[],injector:e})}}function Eve(r){const e=r.value.routeConfig;return e&&""===e.path}function gW(r){const e=[],t=new Set;for(const n of r){if(!Eve(n)){e.push(n);continue}const i=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=gW(n.children);e.push(new I3(n.value,i))}return e.filter(n=>!t.has(n))}function mW(r){return r.data||{}}function _W(r){return r.resolve||{}}function vW(r){return"string"==typeof r.title||null===r.title}function _P(r){return da(e=>{const t=r(e);return t?a2(t).pipe(qn(()=>e)):Dt(e)})}const Q8=new et("ROUTES");let vP=(()=>{var r;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=nt(I$)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Dt(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=U4(n.loadComponent()).pipe(qn(CW),Ii(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),sf(()=>{this.componentLoaders.delete(n)})),s=new NU(i,()=>new Ps).pipe(QS());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Dt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(qn(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,f;return Array.isArray(c)?f=c:(l=c.create(n).injector,f=l.get(Q8,[],cn.Self|cn.Optional).flat()),{routes:f.map(pP),injector:l}}),sf(()=>{this.childrenLoaders.delete(i)})),a=new NU(o,()=>new Ps).pipe(QS());return this.childrenLoaders.set(i,a),a}loadModuleFactoryOrRoutes(n){return U4(n()).pipe(qn(CW),X2(i=>i instanceof HF||Array.isArray(i)?Dt(i):a2(this.compiler.compileModuleAsync(i))))}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function CW(r){return function Nve(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let zg=(()=>{var r;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ps,this.configLoader=nt(vP),this.environmentInjector=nt(no),this.urlSerializer=nt(df),this.rootContexts=nt(vf),this.inputBindingEnabled=null!==nt(Ig,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Dt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new S_e(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new E_e(s))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n){return this.transitions=new Qi({id:0,currentUrlTree:n.currentUrlTree,currentRawUrl:n.currentUrlTree,extractedUrl:n.urlHandlingStrategy.extract(n.currentUrlTree),urlAfterRedirects:n.urlHandlingStrategy.extract(n.currentUrlTree),rawUrl:n.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:mf,restoredState:null,currentSnapshot:n.routerState.snapshot,targetSnapshot:null,currentRouterState:n.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(A3(i=>0!==i.id),qn(i=>({...i,extractedUrl:n.urlHandlingStrategy.extract(i.rawUrl)})),da(i=>{let s=!1,o=!1;return Dt(i).pipe(Ii(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),da(a=>{const c=n.browserUrlTree.toString(),l=!n.navigated||a.extractedUrl.toString()!==c||c!==n.currentUrlTree.toString();if(!l&&"reload"!==(a.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const d="";return this.events.next(new _f(a.id,n.serializeUrl(i.rawUrl),d,0)),n.rawUrlTree=a.rawUrl,a.resolve(null),nc}if(n.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return yW(a.source)&&(n.browserUrlTree=a.extractedUrl),Dt(a).pipe(da(d=>{const m=this.transitions?.getValue();return this.events.next(new sP(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?nc:Promise.resolve(d)}),function Sve(r,e,t,n,i,s){return X2(o=>function Cve(r,e,t,n,i,s,o="emptyOnly"){return new yve(r,e,t,n,i,o,s).recognize()}(r,e,t,n,o.extractedUrl,i,s).pipe(qn(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),Ii(d=>{if(i.targetSnapshot=d.targetSnapshot,i.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},"eager"===n.urlUpdateStrategy){if(!d.extras.skipLocationChange){const E=n.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);n.setBrowserUrl(E,d)}n.browserUrlTree=d.urlAfterRedirects}const m=new __e(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(l&&n.urlHandlingStrategy.shouldProcessUrl(n.rawUrlTree)){const{id:d,extractedUrl:m,source:E,restoredState:w,extras:R}=a,z=new sP(d,this.urlSerializer.serialize(m),E,w);this.events.next(z);const $=JU(0,this.rootComponentType).snapshot;return Dt(i={...a,targetSnapshot:$,urlAfterRedirects:m,extras:{...R,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new _f(a.id,n.serializeUrl(i.extractedUrl),d,1)),n.rawUrlTree=a.rawUrl,a.resolve(null),nc}}),Ii(a=>{const c=new v_e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),qn(a=>i={...a,guards:G_e(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function J_e(r,e){return X2(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Dt({...t,guardsResult:!0}):function eve(r,e,t,n){return a2(r).pipe(X2(i=>function ove(r,e,t,n,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Dt(s.map(a=>{const c=yf(e)??i,l=Y8(a,c);return U4(function K_e(r){return r&&Sf(r.canDeactivate)}(l)?l.canDeactivate(r,e,t,n):c.runInContext(()=>l(r,e,t,n))).pipe(P6())})).pipe(K8()):Dt(!0)}(i.component,i.route,t,e,n)),P6(i=>!0!==i,!0))}(o,n,i,r).pipe(X2(a=>a&&function q_e(r){return"boolean"==typeof r}(a)?function tve(r,e,t,n){return a2(e).pipe(G8(i=>XS(function rve(r,e){return null!==r&&e&&e(new P_e(r)),Dt(!0)}(i.route.parent,n),function nve(r,e){return null!==r&&e&&e(new O_e(r)),Dt(!0)}(i.route,n),function sve(r,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function B_e(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(o)).filter(o=>null!==o).map(o=>wU(()=>Dt(o.guards.map(c=>{const l=yf(o.node)??t,f=Y8(c,l);return U4(function Y_e(r){return r&&Sf(r.canActivateChild)}(f)?f.canActivateChild(n,r):l.runInContext(()=>f(n,r))).pipe(P6())})).pipe(K8())));return Dt(s).pipe(K8())}(r,i.path,t),function ive(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Dt(!0);const i=n.map(s=>wU(()=>{const o=yf(e)??t,a=Y8(s,o);return U4(function Z_e(r){return r&&Sf(r.canActivate)}(a)?a.canActivate(e,r):o.runInContext(()=>a(e,r))).pipe(P6())}));return Dt(i).pipe(K8())}(r,i.route,t))),P6(i=>!0!==i,!0))}(n,s,r,e):Dt(a)),qn(a=>({...t,guardsResult:a})))})}(this.environmentInjector,a=>this.events.next(a)),Ii(a=>{if(i.guardsResult=a.guardsResult,b6(a.guardsResult))throw iW(0,a.guardsResult);const c=new C_e(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(c)}),A3(a=>!!a.guardsResult||(n.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),_P(a=>{if(a.guards.canActivateChecks.length)return Dt(a).pipe(Ii(c=>{const l=new y_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),da(c=>{let l=!1;return Dt(c).pipe(function Pve(r,e){return X2(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Dt(t);let s=0;return a2(i).pipe(G8(o=>function Tve(r,e,t,n){const i=r.routeConfig,s=r._resolve;return void 0!==i?.title&&!vW(i)&&(s[uf]=i.title),function Ove(r,e,t,n){const i=function bve(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}(r);if(0===i.length)return Dt({});const s={};return a2(i).pipe(X2(o=>function wve(r,e,t,n){const i=yf(e)??n,s=Y8(r,i);return U4(s.resolve?s.resolve(e,t):i.runInContext(()=>s(e,t)))}(r[o],e,t,n).pipe(P6(),Ii(a=>{s[o]=a}))),JS(1),function Gme(r){return qn(()=>r)}(s),T6(o=>uW(o)?nc:lf(o)))}(s,r,e,n).pipe(qn(o=>(r._resolvedData=o,r.data=eW(r,t).resolve,i&&vW(i)&&(r.data[uf]=i.title),null)))}(o.route,n,r,e)),Ii(()=>s++),JS(1),X2(o=>s===i.length?Dt(t):nc))})}(n.paramsInheritanceStrategy,this.environmentInjector),Ii({next:()=>l=!0,complete:()=>{l||(n.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),Ii(c=>{const l=new M_e(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}))}),_P(a=>{const c=l=>{const f=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(l.routeConfig).pipe(Ii(d=>{l.component=d}),qn(()=>{})));for(const d of l.children)f.push(...c(d));return f};return KS(c(a.targetSnapshot.root)).pipe(Eg(),W8(1))}),_P(()=>this.afterPreactivation()),qn(a=>{const c=function k_e(r,e,t){const n=Cf(r,e._root,t?t._root:void 0);return new QU(n,e)}(n.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return i={...a,targetRouterState:c}}),Ii(a=>{n.currentUrlTree=a.urlAfterRedirects,n.rawUrlTree=n.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),n.routerState=a.targetRouterState,"deferred"===n.urlUpdateStrategy&&(a.extras.skipLocationChange||n.setBrowserUrl(n.rawUrlTree,a),n.browserUrlTree=a.urlAfterRedirects)}),((r,e,t,n)=>qn(i=>(new $_e(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)))(this.rootContexts,n.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),W8(1),Ii({next:a=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,n.navigated=!0,this.events.next(new W4(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(n.currentUrlTree))),n.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{s=!0}}),sf(()=>{s||o||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),T6(a=>{if(o=!0,aW(a)){oW(a)||(n.navigated=!0,n.restoreHistory(i,!0));const c=new Ng(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode);if(this.events.next(c),oW(a)){const l=n.urlHandlingStrategy.merge(a.url,n.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===n.urlUpdateStrategy||yW(i.source)};n.scheduleNavigation(l,mf,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{n.restoreHistory(i,!0);const c=new oP(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);this.events.next(c);try{i.resolve(n.errorHandler(a))}catch(l){i.reject(l)}}return nc}))}))}cancelNavigationTransition(n,i,s){const o=new Ng(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(o),n.resolve(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function yW(r){return r!==mf}let MW=(()=>{var r;class e{buildTitle(n){let i,s=n.root;for(;void 0!==s;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===nn);return i}getResolvedTitleForRoute(n){return n.data[uf]}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(Ave)},providedIn:"root"}),e})(),Ave=(()=>{var r;class e extends MW{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(rB))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Ive=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(xve)},providedIn:"root"}),e})();class kve{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let xve=(()=>{var r;class e extends kve{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}(),r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const Dg=new et("",{providedIn:"root",factory:()=>({})});let Lve=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return nt(Rve)},providedIn:"root"}),e})(),Rve=(()=>{var r;class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();var Pf=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Pf||{});function EW(r,e){r.events.pipe(A3(t=>t instanceof W4||t instanceof Ng||t instanceof oP||t instanceof _f),qn(t=>t instanceof W4||t instanceof _f?Pf.COMPLETE:t instanceof Ng&&(0===t.code||1===t.code)?Pf.REDIRECTING:Pf.FAILED),A3(t=>t!==Pf.REDIRECTING),W8(1)).subscribe(()=>{e()})}function zve(r){throw r}function Dve(r,e,t){return e.parse("/")}const Hve={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Vve={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Bn=(()=>{var r;class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=nt(A$),this.isNgZoneEnabled=!1,this.options=nt(Dg,{optional:!0})||{},this.pendingTasks=nt(Hp),this.errorHandler=this.options.errorHandler||zve,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Dve,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=nt(Lve),this.routeReuseStrategy=nt(Ive),this.titleStrategy=nt(MW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=nt(Q8,{optional:!0})?.flat()??[],this.navigationTransitions=nt(zg),this.urlSerializer=nt(df),this.location=nt(nS),this.componentInputBindingEnabled=!!nt(Ig,{optional:!0}),this.isNgZoneEnabled=nt(l1)instanceof l1&&l1.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new j8,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=JU(0,null),this.navigationTransitions.setupNavigations(this).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId??0},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),mf,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,i,n.state)},0)}))}navigateToSyncWithBrowser(n,i,s){const o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const c=this.parseUrl(n);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(pP),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:a;let m,d=null;switch(c){case"merge":d={...this.currentUrlTree.queryParams,...o};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}null!==d&&(d=this.removeEmptyProps(d));try{m=BU(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return UU(m,n,d,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){const s=b6(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,mf,null,i)}navigate(n,i={skipLocationChange:!1}){return function Fve(r){for(let e=0;e<r.length;e++)if(null==r[e])throw new ge(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,n)}return i}isActive(n,i){let s;if(s=!0===i?{...Hve}:!1===i?{...Vve}:i,b6(n))return LU(this.currentUrlTree,n,s);const o=this.parseUrl(n);return LU(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.keys(n).reduce((i,s)=>{const o=n[s];return null!=o&&(i[s]=o),i},{})}scheduleNavigation(n,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,f;a?(c=a.resolve,l=a.reject,f=a.promise):f=new Promise((m,E)=>{c=m,l=E});const d=this.pendingTasks.add();return EW(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}setBrowserUrl(n,i){const s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(s,"",a)}else{const o={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(s,"",o)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-(this.browserPageId??this.currentPageId);0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Ec=(()=>{var r;class e{constructor(n,i,s,o,a,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Ps,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof W4&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,o,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||i||s||o||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function XD(r,e,t){return function a8e(r,e){return"src"===e&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===e&&("base"===r||"link"===r)?KD:ip}(e,t)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,i){const s=this.renderer,o=this.el.nativeElement;null!==i?s.setAttribute(o,n,i):s.removeAttribute(o,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(r=e).\u0275fac=function(n){return new(n||r)(B(Bn),B(Ls),function Hh(r){return function P6e(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const s=t[i];if(QR(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(s===e)return t[i+1];i+=2}}}return null}(ti(),r)}("tabindex"),B(fc),B(bi),B(g6))},r.\u0275dir=Lt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&W("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&n&&I("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",H8],skipLocationChange:["skipLocationChange","skipLocationChange",H8],replaceUrl:["replaceUrl","replaceUrl",H8],routerLink:"routerLink"},standalone:!0,features:[sV,es]}),e})();class SW{}let Bve=(()=>{var r;class e{constructor(n,i,s,o,a){this.router=n,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(A3(n=>n instanceof W4),G8(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const s=[];for(const o of i){o.providers&&!o._injector&&(o._injector=ME(o.providers,n,`Route: ${o.path}`));const a=o._injector??n,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return a2(s).pipe(j0())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let s;s=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):Dt(null);const o=s.pipe(X2(a=>null===a?Dt(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??n,a.routes))));return i.loadComponent&&!i._loadedComponent?a2([o,this.loader.loadComponent(i)]).pipe(j0()):o})}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(Bn),Pe(I$),Pe(no),Pe(SW),Pe(vP))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const CP=new et("");let PW=(()=>{var r;class e{constructor(n,i,s,o,a={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof sP?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof W4?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof _f&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof KU&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new KU(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){!function xH(){throw new Error("invalid")}()},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function k3(r,e){return{\u0275kind:r,\u0275providers:e}}function OW(){const r=nt(ni);return e=>{const t=r.get(h6);if(e!==t.components[0])return;const n=r.get(Bn),i=r.get(bW);1===r.get(yP)&&n.initialNavigation(),r.get(wW,null,cn.Optional)?.setUpPreloading(),r.get(CP,null,cn.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const bW=new et("",{factory:()=>new Ps}),yP=new et("",{providedIn:"root",factory:()=>1}),wW=new et("");function jve(r){return k3(0,[{provide:wW,useExisting:Bve},{provide:SW,useExisting:r}])}const NW=new et("ROUTER_FORROOT_GUARD"),Yve=[nS,{provide:df,useClass:eP},Bn,vf,{provide:Ls,useFactory:function TW(r){return r.routerState.root},deps:[Bn]},vP,[]];function Kve(){return new B$("Router",Bn)}let Xve=(()=>{var r;class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[Yve,[],{provide:Q8,multi:!0,useValue:n},{provide:NW,useFactory:tCe,deps:[[Bn,new is,new $h]]},{provide:Dg,useValue:i||{}},i?.useHash?{provide:g6,useClass:Vde}:{provide:g6,useClass:vG},{provide:CP,useFactory:()=>{const r=nt(npe),e=nt(l1),t=nt(Dg),n=nt(zg),i=nt(df);return t.scrollOffset&&r.setOffset(t.scrollOffset),new PW(i,n,r,e,t)}},i?.preloadingStrategy?jve(i.preloadingStrategy).\u0275providers:[],{provide:B$,multi:!0,useFactory:Kve},i?.initialNavigation?nCe(i):[],i?.bindToComponentInputs?k3(8,[rW,{provide:Ig,useExisting:rW}]).\u0275providers:[],[{provide:AW,useFactory:OW},{provide:qE,multi:!0,useExisting:AW}]]}}static forChild(n){return{ngModule:e,providers:[{provide:Q8,multi:!0,useValue:n}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(NW,8))},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({}),e})();function tCe(r){return"guarded"}function nCe(r){return["disabled"===r.initialNavigation?k3(3,[{provide:zE,multi:!0,useFactory:()=>{const e=nt(Bn);return()=>{e.setUpLocationChangeListener()}}},{provide:yP,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?k3(2,[{provide:yP,useValue:0},{provide:zE,multi:!0,deps:[ni],useFactory:e=>{const t=e.get(Dde,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const i=e.get(Bn),s=e.get(bW);EW(i,()=>{n(!0)}),e.get(zg).afterPreactivation=()=>(n(!0),s.closed?Dt(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const AW=new et("");class IW{}class iCe{}const x3="*";function kW(r,e=null){return{type:2,steps:r,options:e}}function xW(r){return{type:6,styles:r,offset:null}}class Tf{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class LW{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function RW(r){return new ge(3e3,!1)}function q4(r){switch(r.length){case 0:return new Tf;case 1:return r[0];default:return new LW(r)}}function zW(r,e,t=new Map,n=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),f=l==o,d=f&&a||new Map;c.forEach((m,E)=>{let w=E,R=m;if("offset"!==E)switch(w=r.normalizePropertyName(w,i),R){case"!":R=t.get(E);break;case x3:R=n.get(E);break;default:R=r.normalizeStyleValue(E,w,R,i)}d.set(w,R)}),f||s.push(d),a=d,o=l}),i.length)throw function bCe(r){return new ge(3502,!1)}();return s}function EP(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&SP(t,"start",r)));break;case"done":r.onDone(()=>n(t&&SP(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&SP(t,"destroy",r)))}}function SP(r,e,t){const s=PP(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,t.totalTime??r.totalTime,!!t.disabled),o=r._data;return null!=o&&(s._data=o),s}function PP(r,e,t,n,i="",s=0,o){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:s,disabled:!!o}}function ao(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function DW(r){const e=r.indexOf(":");return[r.substring(1,e),r.slice(e+1)]}const VCe=(()=>typeof document>"u"?null:document.documentElement)();function TP(r){const e=r.parentNode||r.host||null;return e===VCe?null:e}let w6=null,HW=!1;function VW(r,e){for(;e;){if(e===r)return!0;e=TP(e)}return!1}function FW(r,e,t){if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]}let $W=(()=>{var r;class e{validateStyleProperty(n){return function $Ce(r){w6||(w6=function GCe(){return typeof document<"u"?document.body:null}()||{},HW=!!w6.style&&"WebkitAppearance"in w6.style);let e=!0;return w6.style&&!function FCe(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in w6.style,!e&&HW&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in w6.style)),e}(n)}matchesElement(n,i){return!1}containsElement(n,i){return VW(n,i)}getParentElement(n){return TP(n)}query(n,i,s){return FW(n,i,s)}computeStyle(n,i,s){return s||""}animate(n,i,s,o,a,c=[],l){return new Tf(s,o)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),OP=(()=>{class e{}return e.NOOP=new $W,e})();const BCe=1e3,bP="ng-enter",Hg="ng-leave",Vg="ng-trigger",Fg=".ng-trigger",BW="ng-animating",wP=".ng-animating";function L3(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:NP(parseFloat(e[1]),e[2])}function NP(r,e){return"s"===e?r*BCe:r}function $g(r,e,t){return r.hasOwnProperty("duration")?r:function WCe(r,e,t){let i,s=0,o="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(RW()),{duration:0,delay:0,easing:""};i=NP(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(s=NP(parseFloat(c),a[4]));const l=a[5];l&&(o=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(function sCe(){return new ge(3100,!1)}()),a=!0),s<0&&(e.push(function oCe(){return new ge(3101,!1)}()),a=!0),a&&e.splice(c,0,RW())}return{duration:i,delay:s,easing:o}}(r,e,t)}function Of(r,e={}){return Object.keys(r).forEach(t=>{e[t]=r[t]}),e}function UW(r){const e=new Map;return Object.keys(r).forEach(t=>{e.set(t,r[t])}),e}function j4(r,e=new Map,t){if(t)for(let[n,i]of t)e.set(n,i);for(let[n,i]of r)e.set(n,i);return e}function Sc(r,e,t){e.forEach((n,i)=>{const s=IP(i);t&&!t.has(i)&&t.set(i,r.style[s]),r.style[s]=n})}function N6(r,e){e.forEach((t,n)=>{const i=IP(n);r.style[i]=""})}function bf(r){return Array.isArray(r)?1==r.length?r[0]:kW(r):r}const AP=new RegExp("{{\\s*(.+?)\\s*}}","g");function qW(r){let e=[];if("string"==typeof r){let t;for(;t=AP.exec(r);)e.push(t[1]);AP.lastIndex=0}return e}function wf(r,e,t){const n=r.toString(),i=n.replace(AP,(s,o)=>{let a=e[o];return null==a&&(t.push(function cCe(r){return new ge(3003,!1)}()),a=""),a.toString()});return i==n?r:i}function Gg(r){const e=[];let t=r.next();for(;!t.done;)e.push(t.value),t=r.next();return e}const ZCe=/-+([a-z0-9])/g;function IP(r){return r.replace(ZCe,(...e)=>e[1].toUpperCase())}function co(r,e,t){switch(e.type){case 7:return r.visitTrigger(e,t);case 0:return r.visitState(e,t);case 1:return r.visitTransition(e,t);case 2:return r.visitSequence(e,t);case 3:return r.visitGroup(e,t);case 4:return r.visitAnimate(e,t);case 5:return r.visitKeyframes(e,t);case 6:return r.visitStyle(e,t);case 8:return r.visitReference(e,t);case 9:return r.visitAnimateChild(e,t);case 10:return r.visitAnimateRef(e,t);case 11:return r.visitQuery(e,t);case 12:return r.visitStagger(e,t);default:throw function lCe(r){return new ge(3004,!1)}()}}function jW(r,e){return window.getComputedStyle(r)[e]}const Bg="*";function XCe(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function QCe(r,e,t){if(":"==r[0]){const c=function JCe(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function SCe(r){return new ge(3016,!1)}()),"* => *"}}(r,t);if("function"==typeof c)return void e.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function ECe(r){return new ge(3015,!1)}()),e;const i=n[1],s=n[2],o=n[3];e.push(ZW(i,o));"<"==s[0]&&!(i==Bg&&o==Bg)&&e.push(ZW(o,i))}(n,t,e)):t.push(r),t}const Ug=new Set(["true","1"]),Wg=new Set(["false","0"]);function ZW(r,e){const t=Ug.has(r)||Wg.has(r),n=Ug.has(e)||Wg.has(e);return(i,s)=>{let o=r==Bg||r==i,a=e==Bg||e==s;return!o&&t&&"boolean"==typeof i&&(o=i?Ug.has(r):Wg.has(r)),!a&&n&&"boolean"==typeof s&&(a=s?Ug.has(e):Wg.has(e)),o&&a}}const eye=new RegExp("s*:selfs*,?","g");function kP(r,e,t,n){return new tye(r).build(e,t,n)}class tye{constructor(e){this._driver=e}build(e,t,n){const i=new iye(t);return this._resetContextStyleTimingState(i),co(this,bf(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function fCe(){return new ge(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,s.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push(function dCe(){return new ge(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{qW(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(Gg(s.values()),t.errors.push(function hCe(r,e){return new ge(3008,!1)}()))}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=co(this,bf(e.animation),t);return{type:1,matchers:XCe(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:A6(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>co(this,n,t)),options:A6(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const s=e.steps.map(o=>{t.currentTime=n;const a=co(this,o,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:s,options:A6(e.options)}}visitAnimate(e,t){const n=function oye(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return xP($g(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=xP(0,0,"");return s.dynamic=!0,s.strValue=t,s}const i=$g(t,e);return xP(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,s=e.styles?e.styles:xW({});if(5==s.type)i=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};n.easing&&(l.easing=n.easing),o=xW(l)}t.currentTime+=n.duration+n.delay;const c=this.visitStyle(o,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===x3?n.push(a):t.errors.push(new ge(3002,!1)):n.push(UW(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let c of a.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),f=l.get(c);let d=!0;f&&(s!=i&&s>=f.startTime&&i<=f.endTime&&(t.errors.push(function gCe(r,e,t,n,i){return new ge(3010,!1)}()),d=!1),s=f.startTime),d&&l.set(c,{startTime:s,endTime:i}),t.options&&function jCe(r,e,t){const n=e.params||{},i=qW(r);i.length&&i.forEach(s=>{n.hasOwnProperty(s)||t.push(function aCe(r){return new ge(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function mCe(){return new ge(3011,!1)}()),n;let s=0;const o=[];let a=!1,c=!1,l=0;const f=e.steps.map($=>{const G=this._makeStyleAst($,t);let de=null!=G.offset?G.offset:function sye(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(G.styles),ve=0;return null!=de&&(s++,ve=G.offset=de),c=c||ve<0||ve>1,a=a||ve<l,l=ve,o.push(ve),G});c&&t.errors.push(function _Ce(){return new ge(3012,!1)}()),a&&t.errors.push(function vCe(){return new ge(3200,!1)}());const d=e.steps.length;let m=0;s>0&&s<d?t.errors.push(function CCe(){return new ge(3202,!1)}()):0==s&&(m=1/(d-1));const E=d-1,w=t.currentTime,R=t.currentAnimateTimings,z=R.duration;return f.forEach(($,G)=>{const de=m>0?G==E?1:m*G:o[G],ve=de*z;t.currentTime=w+R.delay+ve,R.duration=ve,this._validateStyleAst($,t),$.offset=de,n.styles.push($)}),n}visitReference(e,t){return{type:8,animation:co(this,bf(e.animation),t),options:A6(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:A6(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:A6(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function nye(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(eye,"")),r=r.replace(/@\*/g,Fg).replace(/@\w+/g,t=>Fg+"-"+t.slice(1)).replace(/:animating/g,wP),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,ao(t.collectedStyles,t.currentQuerySelector,new Map);const a=co(this,bf(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:A6(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function yCe(){return new ge(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:$g(e.timings,t.errors,!0);return{type:12,animation:co(this,bf(e.animation),t),timings:n,options:null}}}class iye{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function A6(r){return r?(r=Of(r)).params&&(r.params=function rye(r){return r?Of(r):null}(r.params)):r={},r}function xP(r,e,t){return{duration:r,delay:e,easing:t}}function LP(r,e,t,n,i,s,o=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class qg{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const lye=new RegExp(":enter","g"),fye=new RegExp(":leave","g");function RP(r,e,t,n,i,s=new Map,o=new Map,a,c,l=[]){return(new dye).buildKeyframes(r,e,t,n,i,s,o,a,c,l)}class dye{buildKeyframes(e,t,n,i,s,o,a,c,l,f=[]){l=l||new qg;const d=new zP(e,t,l,i,s,f,[]);d.options=c;const m=c.delay?L3(c.delay):0;d.currentTimeline.delayNextStep(m),d.currentTimeline.setStyles([o],null,d.errors,c),co(this,n,d);const E=d.timelines.filter(w=>w.containsAnimation());if(E.length&&a.size){let w;for(let R=E.length-1;R>=0;R--){const z=E[R];if(z.element===t){w=z;break}}w&&!w.allowOnlyTimelineStyles()&&w.setStyles([a],null,d.errors,c)}return E.length?E.map(w=>w.buildKeyframes()):[LP(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,i,i.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:L3(wf(s,i?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?L3(n.duration):null,a=null!=n.delay?L3(n.delay):null;return 0!==o&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),co(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const s=e.options;if(s&&(s.params||s.delay)&&(i=t.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=jg);const o=L3(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>co(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?L3(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),co(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return $g(t.params?wf(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*s),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},s=i.delay?L3(i.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=jg);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,f)=>{t.currentQueryIndex=f;const d=t.createSubContext(e.options,l);s&&d.delayNextStep(s),l===t.element&&(c=d.currentTimeline),co(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let c=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const f=t.currentTimeline;c&&f.delayNextStep(c);const d=f.currentTime;co(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-d+(i.startTime-n.currentTimeline.startTime)}}const jg={};class zP{constructor(e,t,n,i,s,o,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=jg,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Zg(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=L3(n.duration)),null!=n.delay&&(i.delay=L3(n.delay));const s=n.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=wf(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,s=new zP(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=jg,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new hye(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(lye,"."+this._enterClassName)).replace(fye,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!s&&0==a.length&&o.push(function MCe(r){return new ge(3014,!1)}()),a}}class Zg{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Zg(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||x3),this._currentKeyframe.set(t,x3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);const s=i&&i.params||{},o=function pye(r,e){const t=new Map;let n;return r.forEach(i=>{if("*"===i){n=n||e.keys();for(let s of n)t.set(s,x3)}else j4(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of o){const l=wf(c,s,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??x3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=j4(a,new Map,this._backFill);l.forEach((f,d)=>{"!"===f?e.add(d):f===x3&&t.add(d)}),n||l.set("offset",c/this.duration),i.push(l)});const s=e.size?Gg(e.values()):[],o=t.size?Gg(t.values()):[];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return LP(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class hye extends Zg{constructor(e,t,n,i,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,c=j4(e[0]);c.set("offset",0),s.push(c);const l=j4(e[0]);l.set("offset",XW(a)),s.push(l);const f=e.length-1;for(let d=1;d<=f;d++){let m=j4(e[d]);const E=m.get("offset");m.set("offset",XW((t+E*n)/o)),s.push(m)}n=o,t=0,i="",e=s}return LP(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function XW(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}class DP{}const gye=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class mye extends DP{normalizePropertyName(e,t){return IP(e)}normalizeStyleValue(e,t,n,i){let s="";const o=n.toString().trim();if(gye.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function uCe(r,e){return new ge(3005,!1)}())}return o+s}}function QW(r,e,t,n,i,s,o,a,c,l,f,d,m){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:f,totalTime:d,errors:m}}const HP={};class JW{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function _ye(r,e,t,n,i){return r.some(s=>s(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,s,o,a,c,l,f){const d=[],m=this.ast.options&&this.ast.options.params||HP,w=this.buildStyles(n,a&&a.params||HP,d),R=c&&c.params||HP,z=this.buildStyles(i,R,d),$=new Set,G=new Map,de=new Map,ve="void"===i,xe={params:vye(R,m),delay:this.ast.options?.delay},tt=f?[]:RP(e,t,this.ast.animation,s,o,w,z,xe,l,d);let pt=0;if(tt.forEach(Mt=>{pt=Math.max(Mt.duration+Mt.delay,pt)}),d.length)return QW(t,this._triggerName,n,i,ve,w,z,[],[],G,de,pt,d);tt.forEach(Mt=>{const Y2=Mt.element,$0=ao(G,Y2,new Set);Mt.preStyleProps.forEach(s3=>$0.add(s3));const Ul=ao(de,Y2,new Set);Mt.postStyleProps.forEach(s3=>Ul.add(s3)),Y2!==t&&$.add(Y2)});const Cn=Gg($.values());return QW(t,this._triggerName,n,i,ve,w,z,tt,Cn,G,de,pt)}}function vye(r,e){const t=Of(e);for(const n in r)r.hasOwnProperty(n)&&null!=r[n]&&(t[n]=r[n]);return t}class Cye{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,i=Of(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=wf(o,i,t));const c=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,c,o,t),n.set(a,o)})}),n}}class Mye{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new Cye(i.style,i.options&&i.options.params||{},n))}),eq(this.states,"true","1"),eq(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new JW(e,i,this.states))}),this.fallbackTransition=function Eye(r,e,t){return new JW(r,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(o=>o.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function eq(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}const Sye=new qg;class Pye{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=kP(this._driver,t,n,[]);if(n.length)throw function wCe(r){return new ge(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const i=e.element,s=zW(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=RP(this._driver,t,s,bP,Hg,new Map,new Map,n,Sye,i),o.forEach(f=>{const d=ao(a,f.element,new Map);f.postStyleProps.forEach(m=>d.set(m,null))})):(i.push(function NCe(){return new ge(3300,!1)}()),o=[]),i.length)throw function ACe(r){return new ge(3504,!1)}();a.forEach((f,d)=>{f.forEach((m,E)=>{f.set(E,this._driver.computeStyle(d,E,x3))})});const l=q4(o.map(f=>{const d=a.get(f.element);return this._buildPlayer(f,new Map,d)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function ICe(r){return new ge(3301,!1)}();return t}listen(e,t,n,i){const s=PP(t,"","","");return EP(this._getPlayer(e),n,s,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const tq="ng-animate-queued",VP="ng-animate-disabled",Nye=[],nq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Aye={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Sa="__ng_removed";class FP{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function Lye(r){return r??null}(n?e.value:e),n){const s=Of(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const Nf="void",$P=new FP(Nf);class Iye{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Lo(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw function kCe(r,e){return new ge(3302,!1)}();if(null==n||0==n.length)throw function xCe(r){return new ge(3303,!1)}();if(!function Rye(r){return"start"==r||"done"==r}(n))throw function LCe(r,e){return new ge(3400,!1)}();const s=ao(this._elementListeners,e,[]),o={name:t,phase:n,callback:i};s.push(o);const a=ao(this._engine.statesByElement,e,new Map);return a.has(t)||(Lo(e,Vg),Lo(e,Vg+"-"+t),a.set(t,$P)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function RCe(r){return new ge(3401,!1)}();return t}trigger(e,t,n,i=!0){const s=this._getTrigger(t),o=new GP(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(Lo(e,Vg),Lo(e,Vg+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new FP(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=$P),l.value!==Nf&&c.value===l.value){if(!function Hye(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const s=t[i];if(!e.hasOwnProperty(s)||r[s]!==e[s])return!1}return!0}(c.params,l.params)){const R=[],z=s.matchStyles(c.value,c.params,R),$=s.matchStyles(l.value,l.params,R);R.length?this._engine.reportError(R):this._engine.afterFlush(()=>{N6(e,z),Sc(e,$)})}return}const m=ao(this._engine.playersByElement,e,[]);m.forEach(R=>{R.namespaceId==this.id&&R.triggerName==t&&R.queued&&R.destroy()});let E=s.matchTransition(c.value,l.value,e,l.params),w=!1;if(!E){if(!i)return;E=s.fallbackTransition,w=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:c,toState:l,player:o,isFallbackTransition:w}),w||(Lo(e,tq),o.onStart(()=>{J8(e,tq)})),o.onDone(()=>{let R=this.players.indexOf(o);R>=0&&this.players.splice(R,1);const z=this._engine.playersByElement.get(e);if(z){let $=z.indexOf(o);$>=0&&z.splice($,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Fg,!0);n.forEach(i=>{if(i[Sa])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){const f=this.trigger(e,l,Nf,i);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&q4(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const c=this._triggers.get(o).fallbackTransition,l=n.get(o)||$P,f=new FP(Nf),d=new GP(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:f,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[Sa];(!s||s===nq)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Lo(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const c=PP(s,n.triggerName,n.fromState.value,n.toState.value);c._data=e,EP(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const s=n.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class kye{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new Iye(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let i of n.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,i){if(Yg(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!Yg(t))return;const s=t[Sa];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Lo(e,VP)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),J8(e,VP))}removeNode(e,t,n){if(Yg(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,s){this.collectedLeaveElements.push(t),t[Sa]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,i,s){return Yg(t)?this._fetchNamespace(e).listen(t,n,i,s):()=>{}}_buildInstruction(e,t,n,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Fg,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,wP,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return q4(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Sa];if(t&&t.setForRemoval){if(e[Sa]=nq,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(VP)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Lo(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?q4(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function zCe(r){return new ge(3402,!1)}()}_flushAnimations(e,t){const n=new qg,i=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,f=new Set;this.disabledNodes.forEach(ut=>{f.add(ut);const Tt=this.driver.query(ut,".ng-animate-queued",!0);for(let kt=0;kt<Tt.length;kt++)f.add(Tt[kt])});const d=this.bodyNode,m=Array.from(this.statesByElement.keys()),E=sq(m,this.collectedEnterElements),w=new Map;let R=0;E.forEach((ut,Tt)=>{const kt=bP+R++;w.set(Tt,kt),ut.forEach(Nn=>Lo(Nn,kt))});const z=[],$=new Set,G=new Set;for(let ut=0;ut<this.collectedLeaveElements.length;ut++){const Tt=this.collectedLeaveElements[ut],kt=Tt[Sa];kt&&kt.setForRemoval&&(z.push(Tt),$.add(Tt),kt.hasAnimation?this.driver.query(Tt,".ng-star-inserted",!0).forEach(Nn=>$.add(Nn)):G.add(Tt))}const de=new Map,ve=sq(m,Array.from($));ve.forEach((ut,Tt)=>{const kt=Hg+R++;de.set(Tt,kt),ut.forEach(Nn=>Lo(Nn,kt))}),e.push(()=>{E.forEach((ut,Tt)=>{const kt=w.get(Tt);ut.forEach(Nn=>J8(Nn,kt))}),ve.forEach((ut,Tt)=>{const kt=de.get(Tt);ut.forEach(Nn=>J8(Nn,kt))}),z.forEach(ut=>{this.processLeaveNode(ut)})});const xe=[],tt=[];for(let ut=this._namespaceList.length-1;ut>=0;ut--)this._namespaceList[ut].drainQueuedTransitions(t).forEach(kt=>{const Nn=kt.player,bt=kt.element;if(xe.push(Nn),this.collectedEnterElements.length){const Xi=bt[Sa];if(Xi&&Xi.setForMove){if(Xi.previousTriggersValues&&Xi.previousTriggersValues.has(kt.triggerName)){const G0=Xi.previousTriggersValues.get(kt.triggerName),ua=this.statesByElement.get(kt.element);if(ua&&ua.has(kt.triggerName)){const ey=ua.get(kt.triggerName);ey.value=G0,ua.set(kt.triggerName,ey)}}return void Nn.destroy()}}const o3=!d||!this.driver.containsElement(d,bt),So=de.get(bt),Wl=w.get(bt),vr=this._buildInstruction(kt,n,Wl,So,o3);if(vr.errors&&vr.errors.length)return void tt.push(vr);if(o3)return Nn.onStart(()=>N6(bt,vr.fromStyles)),Nn.onDestroy(()=>Sc(bt,vr.toStyles)),void i.push(Nn);if(kt.isFallbackTransition)return Nn.onStart(()=>N6(bt,vr.fromStyles)),Nn.onDestroy(()=>Sc(bt,vr.toStyles)),void i.push(Nn);const E4e=[];vr.timelines.forEach(Xi=>{Xi.stretchStartingKeyframe=!0,this.disabledNodes.has(Xi.element)||E4e.push(Xi)}),vr.timelines=E4e,n.append(bt,vr.timelines),o.push({instruction:vr,player:Nn,element:bt}),vr.queriedElements.forEach(Xi=>ao(a,Xi,[]).push(Nn)),vr.preStyleProps.forEach((Xi,G0)=>{if(Xi.size){let ua=c.get(G0);ua||c.set(G0,ua=new Set),Xi.forEach((ey,OR)=>ua.add(OR))}}),vr.postStyleProps.forEach((Xi,G0)=>{let ua=l.get(G0);ua||l.set(G0,ua=new Set),Xi.forEach((ey,OR)=>ua.add(OR))})});if(tt.length){const ut=[];tt.forEach(Tt=>{ut.push(function DCe(r,e){return new ge(3505,!1)}())}),xe.forEach(Tt=>Tt.destroy()),this.reportError(ut)}const pt=new Map,Cn=new Map;o.forEach(ut=>{const Tt=ut.element;n.has(Tt)&&(Cn.set(Tt,Tt),this._beforeAnimationBuild(ut.player.namespaceId,ut.instruction,pt))}),i.forEach(ut=>{const Tt=ut.element;this._getPreviousPlayers(Tt,!1,ut.namespaceId,ut.triggerName,null).forEach(Nn=>{ao(pt,Tt,[]).push(Nn),Nn.destroy()})});const Mt=z.filter(ut=>aq(ut,c,l)),Y2=new Map;iq(Y2,this.driver,G,l,x3).forEach(ut=>{aq(ut,c,l)&&Mt.push(ut)});const Ul=new Map;E.forEach((ut,Tt)=>{iq(Ul,this.driver,new Set(ut),c,"!")}),Mt.forEach(ut=>{const Tt=Y2.get(ut),kt=Ul.get(ut);Y2.set(ut,new Map([...Tt?.entries()??[],...kt?.entries()??[]]))});const s3=[],nh=[],rh={};o.forEach(ut=>{const{element:Tt,player:kt,instruction:Nn}=ut;if(n.has(Tt)){if(f.has(Tt))return kt.onDestroy(()=>Sc(Tt,Nn.toStyles)),kt.disabled=!0,kt.overrideTotalTime(Nn.totalTime),void i.push(kt);let bt=rh;if(Cn.size>1){let So=Tt;const Wl=[];for(;So=So.parentNode;){const vr=Cn.get(So);if(vr){bt=vr;break}Wl.push(So)}Wl.forEach(vr=>Cn.set(vr,bt))}const o3=this._buildAnimation(kt.namespaceId,Nn,pt,s,Ul,Y2);if(kt.setRealPlayer(o3),bt===rh)s3.push(kt);else{const So=this.playersByElement.get(bt);So&&So.length&&(kt.parentPlayer=q4(So)),i.push(kt)}}else N6(Tt,Nn.fromStyles),kt.onDestroy(()=>Sc(Tt,Nn.toStyles)),nh.push(kt),f.has(Tt)&&i.push(kt)}),nh.forEach(ut=>{const Tt=s.get(ut.element);if(Tt&&Tt.length){const kt=q4(Tt);ut.setRealPlayer(kt)}}),i.forEach(ut=>{ut.parentPlayer?ut.syncPlayerEvents(ut.parentPlayer):ut.destroy()});for(let ut=0;ut<z.length;ut++){const Tt=z[ut],kt=Tt[Sa];if(J8(Tt,Hg),kt&&kt.hasAnimation)continue;let Nn=[];if(a.size){let o3=a.get(Tt);o3&&o3.length&&Nn.push(...o3);let So=this.driver.query(Tt,wP,!0);for(let Wl=0;Wl<So.length;Wl++){let vr=a.get(So[Wl]);vr&&vr.length&&Nn.push(...vr)}}const bt=Nn.filter(o3=>!o3.destroyed);bt.length?zye(this,Tt,bt):this.processLeaveNode(Tt)}return z.length=0,s3.forEach(ut=>{this.players.push(ut),ut.onDone(()=>{ut.destroy();const Tt=this.players.indexOf(ut);this.players.splice(Tt,1)}),ut.play()}),s3}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const c=!s||s==Nf;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||o.push(l)})}}return(n||i)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,f=l!==s,d=ao(n,l,[]);this._getPreviousPlayers(l,f,o,a,t.toState).forEach(E=>{const w=E.getRealPlayer();w.beforeDestroy&&w.beforeDestroy(),E.destroy(),d.push(E)})}N6(s,t.fromStyles)}_buildAnimation(e,t,n,i,s,o){const a=t.triggerName,c=t.element,l=[],f=new Set,d=new Set,m=t.timelines.map(w=>{const R=w.element;f.add(R);const z=R[Sa];if(z&&z.removedBeforeQueried)return new Tf(w.duration,w.delay);const $=R!==c,G=function Dye(r){const e=[];return oq(r,e),e}((n.get(R)||Nye).map(pt=>pt.getRealPlayer())).filter(pt=>!!pt.element&&pt.element===R),de=s.get(R),ve=o.get(R),xe=zW(this._normalizer,w.keyframes,de,ve),tt=this._buildPlayer(w,xe,G);if(w.subTimeline&&i&&d.add(R),$){const pt=new GP(e,a,R);pt.setRealPlayer(tt),l.push(pt)}return tt});l.forEach(w=>{ao(this.playersByQueriedElement,w.element,[]).push(w),w.onDone(()=>function xye(r,e,t){let n=r.get(e);if(n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}return n}(this.playersByQueriedElement,w.element,w))}),f.forEach(w=>Lo(w,BW));const E=q4(m);return E.onDestroy(()=>{f.forEach(w=>J8(w,BW)),Sc(c,t.toStyles)}),d.forEach(w=>{ao(i,w,[]).push(E)}),E}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new Tf(e.duration,e.delay)}}class GP{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new Tf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>EP(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ao(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Yg(r){return r&&1===r.nodeType}function rq(r,e){const t=r.style.display;return r.style.display=e??"none",t}function iq(r,e,t,n,i){const s=[];t.forEach(c=>s.push(rq(c)));const o=[];n.forEach((c,l)=>{const f=new Map;c.forEach(d=>{const m=e.computeStyle(l,d,i);f.set(d,m),(!m||0==m.length)&&(l[Sa]=Aye,o.push(l))}),r.set(l,f)});let a=0;return t.forEach(c=>rq(c,s[a++])),o}function sq(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let c=s.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:i.has(l)?1:o(l),s.set(a,c),c}return e.forEach(a=>{const c=o(a);1!==c&&t.get(c).push(a)}),t}function Lo(r,e){r.classList?.add(e)}function J8(r,e){r.classList?.remove(e)}function zye(r,e,t){q4(t).onDone(()=>r.processLeaveNode(e))}function oq(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof LW?oq(n.players,e):e.push(n)}}function aq(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(s=>i.add(s)):e.set(r,n),t.delete(r),!0}class Kg{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new kye(e,t,n),this._timelineEngine=new Pye(e,t,n),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,t,n,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const c=[],f=kP(this._driver,s,c,[]);if(c.length)throw function OCe(r,e){return new ge(3404,!1)}();a=function yye(r,e,t){return new Mye(r,e,t)}(i,f,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[s,o]=DW(n);this._timelineEngine.command(s,t,o,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,s){if("@"==n.charAt(0)){const[o,a]=DW(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let Fye=(()=>{class e{constructor(n,i,s){this._element=n,this._startStyles=i,this._endStyles=s,this._state=0;let o=e.initialStylesByElement.get(n);o||e.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Sc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Sc(this._element,this._initialStyles),this._endStyles&&(Sc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(N6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(N6(this._element,this._endStyles),this._endStyles=null),Sc(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function BP(r){let e=null;return r.forEach((t,n)=>{(function $ye(r){return"display"===r||"position"===r})(n)&&(e=e||new Map,e.set(n,t))}),e}class cq{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&e.set(i,this._finished?n:jW(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class Gye{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return VW(e,t)}getParentElement(e){return TP(e)}query(e,t,n){return FW(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,i,s,o=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};s&&(c.easing=s);const l=new Map,f=o.filter(E=>E instanceof cq);(function YCe(r,e){return 0===r||0===e})(n,i)&&f.forEach(E=>{E.currentSnapshot.forEach((w,R)=>l.set(R,w))});let d=function qCe(r){return r.length?r[0]instanceof Map?r:r.map(e=>UW(e)):[]}(t).map(E=>j4(E));d=function KCe(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((s,o)=>{n.has(o)||i.push(o),n.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,jW(r,a)))}}return e}(e,d,l);const m=function Vye(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=BP(e[0]),e.length>1&&(n=BP(e[e.length-1]))):e instanceof Map&&(t=BP(e)),t||n?new Fye(r,t,n):null}(e,d);return new cq(e,d,c,m)}}let Bye=(()=>{var r;class e extends IW{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:wo.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(n)?kW(n):n;return lq(this._renderer,null,i,"register",[s]),new Uye(i,this._renderer)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(M7),Pe(w2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class Uye extends iCe{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Wye(this._id,e,t||{},this._renderer)}}class Wye{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return lq(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function lq(r,e,t,n,i){return r.setProperty(e,`@@${t}:${n}`,i)}const uq="@.disabled";let qye=(()=>{var r;class e{constructor(n,i,s){this.delegate=n,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(o,a)=>{const c=a?.parentNode(o);c&&a.removeChild(c,o)}}createRenderer(n,i){const o=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(o);return d||(d=new fq("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,d)),d}const a=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,n);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(a,c,n,d.name,d)};return i.data.animation.forEach(l),new jye(this,c,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,s){n>=0&&n<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[a,c]=o;a(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(M7),Pe(Kg),Pe(l1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class fq{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==uq?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class jye extends fq{constructor(e,t,n,i,s){super(t,n,i,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==uq?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function Zye(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Yye(r){const e=r.indexOf(".");return[r.substring(0,e),r.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let Kye=(()=>{var r;class e extends Kg{constructor(n,i,s,o){super(n.body,i,s)}ngOnDestroy(){this.flush()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(w2),Pe(OP),Pe(DP),Pe(h6))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const dq=[{provide:IW,useClass:Bye},{provide:DP,useFactory:function Xye(){return new mye}},{provide:Kg,useClass:Kye},{provide:M7,useFactory:function Qye(r,e,t){return new qye(r,e,t)},deps:[PS,Kg,l1]}],UP=[{provide:OP,useFactory:()=>new Gye},{provide:oH,useValue:"BrowserAnimations"},...dq],hq=[{provide:OP,useClass:$W},{provide:oH,useValue:"NoopAnimations"},...dq];let Jye=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?hq:UP}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({providers:UP,imports:[nB]}),e})();const Vr=void 0,tMe=["fr",[["AM","PM"],Vr,Vr],Vr,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Vr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Vr,[["av. J.-C.","ap. J.-C."],Vr,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Vr],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Vr,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Vr,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Vr,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Vr,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Vr,"\xa5"],KMF:[Vr,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Vr,"$C"],NZD:["$NZ","$"],PHP:[Vr,"\u20b1"],RHD:["$RH"],RON:[Vr,"L"],RWF:[Vr,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Vr,"$T"],TTD:["$TT","$"],TWD:[Vr,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Vr,"$"],XPF:["FCFP"],ZMW:[Vr,"Kw"]},"ltr",function eMe(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===i&&0!==t&&t%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function pq(r,e,t,n,i,s,o){try{var a=r[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,i)}function M(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function o(c){pq(s,n,i,o,a,"next",c)}function a(c){pq(s,n,i,o,a,"throw",c)}o(void 0)})}}const gq=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},qP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,a=o?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let m=(15&a)<<2|l>>6,E=63&l;c||(E=64,o||(m=64)),n.push(t[s>>2],t[(3&s)<<4|a>>4],t[m],t[E])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(gq(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(1023&c))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],a=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const d=i<r.length?t[r.charAt(i)]:64;if(++i,null==s||null==a||null==l||null==d)throw new sMe;n.push(s<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==d&&n.push(l<<6&192|d))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class sMe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Qg=function(r){return function(r){const e=gq(r);return qP.encodeByteArray(e,!0)}(r).replace(/\./g,"")},Jg=function(r){try{return qP.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},em=()=>{try{return function cMe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&Jg(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},_q=r=>{var e,t;return null===(t=null===(e=em())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[r]},vq=()=>{var r;return null===(r=em())||void 0===r?void 0:r.config},Cq=r=>{var e;return null===(e=em())||void 0===e?void 0:e[`_${r}`]};class tm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function N2(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function jP(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function I6(){try{return"object"==typeof indexedDB}catch{return!1}}function Af(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e((null===(s=i.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}function ZP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class Ro extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ro.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Pc.prototype.create)}}class Pc{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?function CMe(r,e){return r.replace(yMe,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(s,n):"Error";return new Ro(i,`${this.serviceName}: ${o} (${i}).`,n)}}const yMe=/\{\$([^}]+)}/g;function rm(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(Mq(s)&&Mq(o)){if(!rm(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Mq(r){return null!==r&&"object"==typeof r}function If(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function kf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function xf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}class SMe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function PMe(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=YP),void 0===i.error&&(i.error=YP),void 0===i.complete&&(i.complete=YP);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function YP(){}const TMe=1e3,OMe=2,bMe=144e5,wMe=.5;function XP(r,e=TMe,t=OMe){const n=e*Math.pow(t,r),i=Math.round(wMe*n*(Math.random()-.5)*2);return Math.min(bMe,n+i)}function Mr(r){return r&&r._delegate?r._delegate:r}class ki{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const k6="[DEFAULT]";class AMe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new tm;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function kMe(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:k6})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=k6){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return M(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=k6){return this.instances.has(e)}getOptions(e=k6){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(s)&&o.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===k6?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=k6){return this.component?this.component.multipleInstances?e:k6:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class xMe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new AMe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const QP=[];var Un=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(Un||{});const Eq={debug:Un.DEBUG,verbose:Un.VERBOSE,info:Un.INFO,warn:Un.WARN,error:Un.ERROR,silent:Un.SILENT},LMe=Un.INFO,RMe={[Un.DEBUG]:"log",[Un.VERBOSE]:"log",[Un.INFO]:"info",[Un.WARN]:"warn",[Un.ERROR]:"error"},zMe=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=RMe[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class e5{constructor(e){this.name=e,this._logLevel=LMe,this._logHandler=zMe,this._userLogHandler=null,QP.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Un))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Eq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Un.DEBUG,...e),this._logHandler(this,Un.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Un.VERBOSE,...e),this._logHandler(this,Un.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Un.INFO,...e),this._logHandler(this,Un.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Un.WARN,...e),this._logHandler(this,Un.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Un.ERROR,...e),this._logHandler(this,Un.ERROR,...e)}}const DMe=(r,e)=>e.some(t=>r instanceof t);let Sq,Pq;const Tq=new WeakMap,JP=new WeakMap,Oq=new WeakMap,eT=new WeakMap,tT=new WeakMap;let nT={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return JP.get(r);if("objectStoreNames"===e)return r.objectStoreNames||Oq.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Z4(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function UMe(r){return"function"==typeof r?function BMe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function VMe(){return Pq||(Pq=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(rT(this),e),Z4(Tq.get(this))}:function(...e){return Z4(r.apply(rT(this),e))}:function(e,...t){const n=r.call(rT(this),e,...t);return Oq.set(n,e.sort?e.sort():[e]),Z4(n)}}(r):(r instanceof IDBTransaction&&function $Me(r){if(JP.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});JP.set(r,e)}(r),DMe(r,function HMe(){return Sq||(Sq=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,nT):r)}function Z4(r){if(r instanceof IDBRequest)return function FMe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(Z4(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Tq.set(t,r)}).catch(()=>{}),tT.set(e,r),e}(r);if(eT.has(r))return eT.get(r);const e=UMe(r);return e!==r&&(eT.set(r,e),tT.set(e,r)),e}const rT=r=>tT.get(r),qMe=["get","getKey","getAll","getAllKeys","count"],jMe=["put","add","delete","clear"],iT=new Map;function bq(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(iT.get(e))return iT.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=jMe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!qMe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return iT.set(e,s),s}!function GMe(r){nT=r(nT)}(r=>({...r,get:(e,t,n)=>bq(e,t)||r.get(e,t,n),has:(e,t)=>!!bq(e,t)||r.has(e,t)}));class ZMe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function YMe(r){const e=r.getComponent();return"VERSION"===e?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const sT="@firebase/app",x6=new e5("@firebase/app"),im="[DEFAULT]",MEe={[sT]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},L6=new Map,sm=new Map;function EEe(r,e){try{r.container.addComponent(e)}catch(t){x6.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ls(r){const e=r.name;if(sm.has(e))return x6.debug(`There were multiple attempts to register component ${e}.`),!1;sm.set(e,r);for(const t of L6.values())EEe(t,r);return!0}function t5(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}const R3=new Pc("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class PEe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ki("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw R3.create("app-deleted",{appName:this._name})}}const R6="9.23.0";function Nq(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n=Object.assign({name:im,automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw R3.create("bad-app-name",{appName:String(i)});if(t||(t=vq()),!t)throw R3.create("no-options");const s=L6.get(i);if(s){if(rm(t,s.options)&&rm(n,s.config))return s;throw R3.create("duplicate-app",{appName:i})}const o=new xMe(i);for(const c of sm.values())o.addComponent(c);const a=new PEe(t,n,o);return L6.set(i,a),a}function oT(r=im){const e=L6.get(r);if(!e&&r===im&&vq())return Nq();if(!e)throw R3.create("no-app",{appName:r});return e}function Aq(){return Array.from(L6.values())}function Er(r,e,t){var n;let i=null!==(n=MEe[r])&&void 0!==n?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];return s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void x6.warn(a.join(" "))}ls(new ki(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const TEe="firebase-heartbeat-database",OEe=1,Lf="firebase-heartbeat-store";let cT=null;function Iq(){return cT||(cT=function WMe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=Z4(o);return n&&o.addEventListener("upgradeneeded",c=>{n(Z4(o.result),c.oldVersion,c.newVersion,Z4(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(TEe,OEe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(Lf)}}).catch(r=>{throw R3.create("idb-open",{originalErrorMessage:r.message})})),cT}function lT(){return(lT=M(function*(r){try{return yield(yield Iq()).transaction(Lf).objectStore(Lf).get(xq(r))}catch(e){if(e instanceof Ro)x6.warn(e.message);else{const t=R3.create("idb-get",{originalErrorMessage:e?.message});x6.warn(t.message)}}})).apply(this,arguments)}function kq(r,e){return uT.apply(this,arguments)}function uT(){return(uT=M(function*(r,e){try{const n=(yield Iq()).transaction(Lf,"readwrite");yield n.objectStore(Lf).put(e,xq(r)),yield n.done}catch(t){if(t instanceof Ro)x6.warn(t.message);else{const n=R3.create("idb-set",{originalErrorMessage:t?.message});x6.warn(n.message)}}})).apply(this,arguments)}function xq(r){return`${r.name}!${r.options.appId}`}class AEe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new kEe(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return M(function*(){const n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Lq();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==i&&!e._heartbeatsCache.heartbeats.some(s=>s.date===i))return e._heartbeatsCache.heartbeats.push({date:i,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return M(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=Lq(),{heartbeatsToSend:n,unsentEntries:i}=function IEe(r,e=1024){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Rq(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Rq(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),s=Qg(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function Lq(){return(new Date).toISOString().substring(0,10)}class kEe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return M(function*(){return!!I6()&&Af().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return M(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function bEe(r){return lT.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return kq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return M(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return kq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function Rq(r){return Qg(JSON.stringify({version:2,heartbeats:r})).length}!function xEe(r){ls(new ki("platform-logger",e=>new ZMe(e),"PRIVATE")),ls(new ki("heartbeat",e=>new AEe(e),"PRIVATE")),Er(sT,"0.9.13",r),Er(sT,"0.9.13","esm2017"),Er("fire-js","")}("");var Qe,LEe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pa={},fT=fT||{},Yt=LEe||self;function om(r){var e=typeof r;return"array"==(e="object"!=e?e:r?Array.isArray(r)?"array":e:"null")||"object"==e&&"number"==typeof r.length}function Rf(r){var e=typeof r;return"object"==e&&null!=r||"function"==e}var dT="closure_uid_"+(1e9*Math.random()>>>0),zEe=0;function DEe(r,e,t){return r.call.apply(r.bind,arguments)}function HEe(r,e,t){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(e,i)}}return function(){return r.apply(e,arguments)}}function xi(r,e,t){return(xi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?DEe:HEe).apply(null,arguments)}function am(r,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function A2(r,e){function t(){}t.prototype=e.prototype,r.$=e.prototype,r.prototype=new t,r.prototype.constructor=r,r.ac=function(n,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(n,o)}}function Y4(){this.s=this.s,this.o=this.o}Y4.prototype.s=!1,Y4.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function REe(r){Object.prototype.hasOwnProperty.call(r,dT)&&r[dT]||(r[dT]=++zEe)}(this)},Y4.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const zq=Array.prototype.indexOf?function(r,e){return Array.prototype.indexOf.call(r,e,void 0)}:function(r,e){if("string"==typeof r)return"string"!=typeof e||1!=e.length?-1:r.indexOf(e,0);for(let t=0;t<r.length;t++)if(t in r&&r[t]===e)return t;return-1};function hT(r){const e=r.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=r[n];return t}return[]}function Dq(r,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(om(n)){const i=r.length||0,s=n.length||0;r.length=i+s;for(let o=0;o<s;o++)r[i+o]=n[o]}else r.push(n)}}function Li(r,e){this.type=r,this.g=this.target=e,this.defaultPrevented=!1}Li.prototype.h=function(){this.defaultPrevented=!0};var FEe=function(){if(!Yt.addEventListener||!Object.defineProperty)return!1;var r=!1,e=Object.defineProperty({},"passive",{get:function(){r=!0}});try{Yt.addEventListener("test",()=>{},e),Yt.removeEventListener("test",()=>{},e)}catch{}return r}();function zf(r){return/^[\s\xa0]*$/.test(r)}function cm(){var r=Yt.navigator;return r&&(r=r.userAgent)?r:""}function Tc(r){return-1!=cm().indexOf(r)}function pT(r){return pT[" "](r),r}pT[" "]=function(){};var mT,r,GEe=Tc("Opera"),n5=Tc("Trident")||Tc("MSIE"),Hq=Tc("Edge"),gT=Hq||n5,Vq=Tc("Gecko")&&!(-1!=cm().toLowerCase().indexOf("webkit")&&!Tc("Edge"))&&!(Tc("Trident")||Tc("MSIE"))&&!Tc("Edge"),BEe=-1!=cm().toLowerCase().indexOf("webkit")&&!Tc("Edge");function Fq(){var r=Yt.document;return r?r.documentMode:void 0}e:{var _T="",vT=(r=cm(),Vq?/rv:([^\);]+)(\)|;)/.exec(r):Hq?/Edge\/([\d\.]+)/.exec(r):n5?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):BEe?/WebKit\/(\S+)/.exec(r):GEe?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(vT&&(_T=vT?vT[1]:""),n5){var CT=Fq();if(null!=CT&&CT>parseFloat(_T)){mT=String(CT);break e}}mT=_T}var UEe=Yt.document&&n5&&(Fq()||parseInt(mT,10))||void 0;function Df(r,e){if(Li.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var t=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=e,e=r.relatedTarget){if(Vq){e:{try{pT(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=r.fromElement:"mouseout"==t&&(e=r.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:WEe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Df.$.h.call(this)}}A2(Df,Li);var WEe={2:"touch",3:"pen",4:"mouse"};Df.prototype.h=function(){Df.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Hf="closure_listenable_"+(1e6*Math.random()|0),qEe=0;function jEe(r,e,t,n,i){this.listener=r,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=i,this.key=++qEe,this.fa=this.ia=!1}function lm(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function MT(r,e,t){for(const n in r)e.call(t,r[n],n,r)}function Gq(r){const e={};for(const t in r)e[t]=r[t];return e}const Bq="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Uq(r,e){let t,n;for(let i=1;i<arguments.length;i++){for(t in n=arguments[i],n)r[t]=n[t];for(let s=0;s<Bq.length;s++)t=Bq[s],Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}}function um(r){this.src=r,this.g={},this.h=0}function ET(r,e){var t=e.type;if(t in r.g){var s,n=r.g[t],i=zq(n,e);(s=0<=i)&&Array.prototype.splice.call(n,i,1),s&&(lm(e),0==r.g[t].length&&(delete r.g[t],r.h--))}}function ST(r,e,t,n){for(var i=0;i<r.length;++i){var s=r[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==n)return i}return-1}um.prototype.add=function(r,e,t,n,i){var s=r.toString();(r=this.g[s])||(r=this.g[s]=[],this.h++);var o=ST(r,e,n,i);return-1<o?(e=r[o],t||(e.ia=!1)):((e=new jEe(e,this.src,s,!!n,i)).ia=t,r.push(e)),e};var PT="closure_lm_"+(1e6*Math.random()|0),TT={};function Wq(r,e,t,n,i){if(n&&n.once)return jq(r,e,t,n,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Wq(r,e[s],t,n,i);return null}return t=NT(t),r&&r[Hf]?r.O(e,t,Rf(n)?!!n.capture:!!n,i):qq(r,e,t,!1,n,i)}function qq(r,e,t,n,i,s){if(!e)throw Error("Invalid event type");var o=Rf(i)?!!i.capture:!!i,a=bT(r);if(a||(r[PT]=a=new um(r)),(t=a.add(e,t,n,o,s)).proxy)return t;if(n=function YEe(){const e=KEe;return function r(t){return e.call(r.src,r.listener,t)}}(),t.proxy=n,n.src=r,n.listener=t,r.addEventListener)FEe||(i=o),void 0===i&&(i=!1),r.addEventListener(e.toString(),n,i);else if(r.attachEvent)r.attachEvent(Yq(e.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return t}function jq(r,e,t,n,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)jq(r,e[s],t,n,i);return null}return t=NT(t),r&&r[Hf]?r.P(e,t,Rf(n)?!!n.capture:!!n,i):qq(r,e,t,!0,n,i)}function Zq(r,e,t,n,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Zq(r,e[s],t,n,i);else n=Rf(n)?!!n.capture:!!n,t=NT(t),r&&r[Hf]?(r=r.i,(e=String(e).toString())in r.g&&-1<(t=ST(s=r.g[e],t,n,i))&&(lm(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete r.g[e],r.h--))):r&&(r=bT(r))&&(e=r.g[e.toString()],r=-1,e&&(r=ST(e,t,n,i)),(t=-1<r?e[r]:null)&&OT(t))}function OT(r){if("number"!=typeof r&&r&&!r.fa){var e=r.src;if(e&&e[Hf])ET(e.i,r);else{var t=r.type,n=r.proxy;e.removeEventListener?e.removeEventListener(t,n,r.capture):e.detachEvent?e.detachEvent(Yq(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=bT(e))?(ET(t,r),0==t.h&&(t.src=null,e[PT]=null)):lm(r)}}}function Yq(r){return r in TT?TT[r]:TT[r]="on"+r}function KEe(r,e){if(r.fa)r=!0;else{e=new Df(e,this);var t=r.listener,n=r.la||r.src;r.ia&&OT(r),r=t.call(n,e)}return r}function bT(r){return(r=r[PT])instanceof um?r:null}var wT="__closure_events_fn_"+(1e9*Math.random()>>>0);function NT(r){return"function"==typeof r?r:(r[wT]||(r[wT]=function(e){return r.handleEvent(e)}),r[wT])}function I2(){Y4.call(this),this.i=new um(this),this.S=this,this.J=null}function ii(r,e){var t,n=r.J;if(n)for(t=[];n;n=n.J)t.push(n);if(r=r.S,n=e.type||e,"string"==typeof e)e=new Li(e,r);else if(e instanceof Li)e.target=e.target||r;else{var i=e;Uq(e=new Li(n,r),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=fm(o,n,!0,e)&&i}if(i=fm(o=e.g=r,n,!0,e)&&i,i=fm(o,n,!1,e)&&i,t)for(s=0;s<t.length;s++)i=fm(o=e.g=t[s],n,!1,e)&&i}function fm(r,e,t,n){if(!(e=r.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&ET(r.i,o),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}A2(I2,Y4),I2.prototype[Hf]=!0,I2.prototype.removeEventListener=function(r,e,t,n){Zq(this,r,e,t,n)},I2.prototype.N=function(){if(I2.$.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var t=r.g[e],n=0;n<t.length;n++)lm(t[n]);delete r.g[e],r.h--}}this.J=null},I2.prototype.O=function(r,e,t,n){return this.i.add(String(r),e,!1,t,n)},I2.prototype.P=function(r,e,t,n){return this.i.add(String(r),e,!0,t,n)};var AT=Yt.JSON.stringify;function QEe(){var r=IT;let e=null;return r.g&&(e=r.g,r.g=r.g.next,r.g||(r.h=null),e.next=null),e}var Kq=new class XEe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new eSe,r=>r.reset());class eSe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function tSe(r){var e=1;r=r.split(":");const t=[];for(;0<e&&r.length;)t.push(r.shift()),e--;return r.length&&t.push(r.join(":")),t}function nSe(r){Yt.setTimeout(()=>{throw r},0)}let Vf,Ff=!1,IT=new class JEe{constructor(){this.h=this.g=null}add(e,t){const n=Kq.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Xq=()=>{const r=Yt.Promise.resolve(void 0);Vf=()=>{r.then(rSe)}};var rSe=()=>{for(var r;r=QEe();){try{r.h.call(r.g)}catch(t){nSe(t)}var e=Kq;e.j(r),100>e.h&&(e.h++,r.next=e.g,e.g=r)}Ff=!1};function dm(r,e){I2.call(this),this.h=r||1,this.g=e||Yt,this.j=xi(this.qb,this),this.l=Date.now()}function kT(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function xT(r,e,t){if("function"==typeof r)t&&(r=xi(r,t));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=xi(r.handleEvent,r)}return 2147483647<Number(e)?-1:Yt.setTimeout(r,e||0)}function Qq(r){r.g=xT(()=>{r.g=null,r.i&&(r.i=!1,Qq(r))},r.j);const e=r.h;r.h=null,r.m.apply(null,e)}A2(dm,I2),(Qe=dm.prototype).ga=!1,Qe.T=null,Qe.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ii(this,"tick"),this.ga&&(kT(this),this.start()))}},Qe.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Qe.N=function(){dm.$.N.call(this),kT(this),delete this.g};class iSe extends Y4{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Qq(this)}N(){super.N(),this.g&&(Yt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $f(r){Y4.call(this),this.h=r,this.g={}}A2($f,Y4);var Jq=[];function ej(r,e,t,n){Array.isArray(t)||(t&&(Jq[0]=t.toString()),t=Jq);for(var i=0;i<t.length;i++){var s=Wq(e,t[i],n||r.handleEvent,!1,r.h||r);if(!s)break;r.g[s.key]=s}}function tj(r){MT(r.g,function(e,t){this.g.hasOwnProperty(t)&&OT(e)},r),r.g={}}function hm(){this.g=!0}function r5(r,e,t,n){r.info(function(){return"XMLHTTP TEXT ("+e+"): "+function cSe(r,e){if(!r.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(r=0;r<t.length;r++)if(Array.isArray(t[r])){var n=t[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return AT(t)}catch{return e}}(r,t)+(n?" "+n:"")})}$f.prototype.N=function(){$f.$.N.call(this),tj(this)},$f.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},hm.prototype.Ea=function(){this.g=!1},hm.prototype.info=function(){};var z6={},nj=null;function pm(){return nj=nj||new I2}function rj(r){Li.call(this,z6.Ta,r)}function Gf(r){const e=pm();ii(e,new rj(e))}function ij(r,e){Li.call(this,z6.STAT_EVENT,r),this.stat=e}function us(r){const e=pm();ii(e,new ij(e,r))}function sj(r,e){Li.call(this,z6.Ua,r),this.size=e}function Bf(r,e){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return Yt.setTimeout(function(){r()},e)}z6.Ta="serverreachability",A2(rj,Li),z6.STAT_EVENT="statevent",A2(ij,Li),z6.Ua="timingevent",A2(sj,Li);var gm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},oj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function LT(){}function cj(){}LT.prototype.h=null;var DT,Uf={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function RT(){Li.call(this,"d")}function zT(){Li.call(this,"c")}function mm(){}function Wf(r,e,t,n){this.l=r,this.j=e,this.m=t,this.W=n||1,this.U=new $f(this),this.P=lSe,this.V=new dm(r=gT?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new lj}function lj(){this.i=null,this.g="",this.h=!1}A2(RT,Li),A2(zT,Li),A2(mm,LT),mm.prototype.g=function(){return new XMLHttpRequest},mm.prototype.i=function(){return{}},DT=new mm;var lSe=45e3,HT={},_m={};function VT(r,e,t){r.L=1,r.v=Mm(z3(e)),r.s=t,r.S=!0,uj(r,null)}function uj(r,e){r.G=Date.now(),qf(r),r.A=z3(r.v);var t=r.A,n=r.W;Array.isArray(n)||(n=[String(n)]),yj(t.i,"t",n),r.C=0,t=r.l.J,r.h=new lj,r.g=Uj(r.l,t?e:null,!r.s),0<r.O&&(r.M=new iSe(xi(r.Pa,r,r.g),r.O)),ej(r.U,r.g,"readystatechange",r.nb),e=r.I?Gq(r.I):{},r.s?(r.u||(r.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.A,r.u,r.s,e)):(r.u="GET",r.g.ha(r.A,r.u,null,e)),Gf(),function sSe(r,e,t,n,i,s){r.info(function(){if(r.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var f=l[0];l=l[1];var d=f.split("_");o=2<=d.length&&"type"==d[1]?o+(f+"=")+l+"&":o+(f+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+t+"\n"+o})}(r.j,r.u,r.A,r.m,r.W,r.s)}function fj(r){return!!r.g&&"GET"==r.u&&2!=r.L&&r.l.Ha}function dj(r,e,t){let i,n=!0;for(;!r.J&&r.C<t.length;){if(i=uSe(r,t),i==_m){4==e&&(r.o=4,us(14),n=!1),r5(r.j,r.m,null,"[Incomplete Response]");break}if(i==HT){r.o=4,us(15),r5(r.j,r.m,t,"[Invalid Chunk]"),n=!1;break}r5(r.j,r.m,i,null),FT(r,i)}fj(r)&&i!=_m&&i!=HT&&(r.h.g="",r.C=0),4!=e||0!=t.length||r.h.h||(r.o=1,us(16),n=!1),r.i=r.i&&n,n?0<t.length&&!r.ba&&(r.ba=!0,(e=r.l).g==r&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),jT(e),e.M=!0,us(11))):(r5(r.j,r.m,t,"[Invalid Chunked Response]"),D6(r),jf(r))}function uSe(r,e){var t=r.C,n=e.indexOf("\n",t);return-1==n?_m:(t=Number(e.substring(t,n)),isNaN(t)?HT:(n+=1)+t>e.length?_m:(e=e.slice(n,n+t),r.C=n+t,e))}function qf(r){r.Y=Date.now()+r.P,hj(r,r.P)}function hj(r,e){if(null!=r.B)throw Error("WatchDog timer not null");r.B=Bf(xi(r.lb,r),e)}function vm(r){r.B&&(Yt.clearTimeout(r.B),r.B=null)}function jf(r){0==r.l.H||r.J||Fj(r.l,r)}function D6(r){vm(r);var e=r.M;e&&"function"==typeof e.sa&&e.sa(),r.M=null,kT(r.V),tj(r.U),r.g&&(e=r.g,r.g=null,e.abort(),e.sa())}function FT(r,e){try{var t=r.l;if(0!=t.H&&(t.g==r||$T(t.i,r)))if(!r.K&&$T(t.i,r)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<r.G))break e;bm(t),Tm(t)}qT(t),us(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=Bf(xi(t.ib,t),6e3));if(1>=Sj(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else V6(t,11)}else if((r.K||t.g==r)&&bm(t),!zf(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const f=l[3];null!=f&&(t.ra=f,t.l.info("VER="+t.ra));const d=l[4];null!=d&&(t.Ga=d,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=n=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const E=r.g;if(E){const w=E.g?E.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var s=n.i;s.g||-1==w.indexOf("spdy")&&-1==w.indexOf("quic")&&-1==w.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(GT(s,s.h),s.h=null))}if(n.F){const R=E.g?E.g.getResponseHeader("X-HTTP-Session-Id"):null;R&&(n.Da=R,V1(n.I,n.F,R))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-r.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=r;if((n=t).wa=Bj(n,n.J?n.pa:null,n.Y),o.K){Pj(n.i,o);var a=o,c=n.L;c&&a.setTimeout(c),a.B&&(vm(a),qf(a)),n.g=o}else Hj(n);0<t.j.length&&Om(t)}else"stop"!=l[0]&&"close"!=l[0]||V6(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?V6(t,7):WT(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}Gf()}catch{}}function pj(r,e){if(r.forEach&&"function"==typeof r.forEach)r.forEach(e,void 0);else if(om(r)||"string"==typeof r)Array.prototype.forEach.call(r,e,void 0);else for(var t=function dSe(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(om(r)||"string"==typeof r){var e=[];r=r.length;for(var t=0;t<r;t++)e.push(t);return e}e=[],t=0;for(const n in r)e[t++]=n;return e}}}(r),n=function fSe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(om(r)){for(var e=[],t=r.length,n=0;n<t;n++)e.push(r[n]);return e}for(n in e=[],t=0,r)e[t++]=r[n];return e}(r),i=n.length,s=0;s<i;s++)e.call(void 0,n[s],t&&t[s],r)}(Qe=Wf.prototype).setTimeout=function(r){this.P=r},Qe.nb=function(r){r=r.target;const e=this.M;e&&3==Oc(r)?e.l():this.Pa(r)},Qe.Pa=function(r){try{if(r==this.g)e:{const f=Oc(this.g);var e=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||gT||this.g&&(this.h.h||this.g.ja()||kj(this.g)))){this.J||4!=f||7==e||Gf(),vm(this);var t=this.g.da();this.ca=t;t:if(fj(this)){var n=kj(this.g);r="";var i=n.length,s=4==Oc(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){D6(this),jf(this);var o="";break t}this.h.i=new Yt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,r+=this.h.i.decode(n[e],{stream:s&&e==i-1});n.splice(0,i),this.h.g+=r,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function oSe(r,e,t,n,i,s,o){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,f,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!zf(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,us(12),D6(this),jf(this);break e}r5(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,FT(this,t)}this.S?(dj(this,f,o),gT&&this.i&&3==f&&(ej(this.U,this.V,"tick",this.mb),this.V.start())):(r5(this.j,this.m,o,null),FT(this,o)),4==f&&D6(this),this.i&&!this.J&&(4==f?Fj(this.l,this):(this.i=!1,qf(this)))}else(function ASe(r){const e={};r=(r.g&&2<=Oc(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if(zf(r[n]))continue;var t=tSe(r[n]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function ZEe(r,e){for(const t in r)e.call(void 0,r[t],t,r)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,us(12)):(this.o=0,us(13)),D6(this),jf(this)}}}catch{}},Qe.mb=function(){if(this.g){var r=Oc(this.g),e=this.g.ja();this.C<e.length&&(vm(this),dj(this,r,e),this.i&&4!=r&&qf(this))}},Qe.cancel=function(){this.J=!0,D6(this)},Qe.lb=function(){this.B=null;const r=Date.now();0<=r-this.Y?(function aSe(r,e){r.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Gf(),us(17)),D6(this),this.o=2,jf(this)):hj(this,this.Y-r)};var gj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function H6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof H6){this.h=r.h,Cm(this,r.j),this.s=r.s,this.g=r.g,ym(this,r.m),this.l=r.l;var e=r.i,t=new Kf;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),mj(this,t),this.o=r.o}else r&&(e=String(r).match(gj))?(this.h=!1,Cm(this,e[1]||"",!0),this.s=Zf(e[2]||""),this.g=Zf(e[3]||"",!0),ym(this,e[4]),this.l=Zf(e[5]||"",!0),mj(this,e[6]||"",!0),this.o=Zf(e[7]||"")):(this.h=!1,this.i=new Kf(null,this.h))}function z3(r){return new H6(r)}function Cm(r,e,t){r.j=t?Zf(e,!0):e,r.j&&(r.j=r.j.replace(/:$/,""))}function ym(r,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);r.m=e}else r.m=null}function mj(r,e,t){e instanceof Kf?(r.i=e,function CSe(r,e){e&&!r.j&&(K4(r),r.i=null,r.g.forEach(function(t,n){var i=n.toLowerCase();n!=i&&(vj(this,n),yj(this,i,t))},r)),r.j=e}(r.i,r.h)):(t||(e=Yf(e,_Se)),r.i=new Kf(e,r.h))}function V1(r,e,t){r.i.set(e,t)}function Mm(r){return V1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function Zf(r,e){return r?e?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function Yf(r,e,t){return"string"==typeof r?(r=encodeURI(r).replace(e,pSe),t&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function pSe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}H6.prototype.toString=function(){var r=[],e=this.j;e&&r.push(Yf(e,_j,!0),":");var t=this.g;return(t||"file"==e)&&(r.push("//"),(e=this.s)&&r.push(Yf(e,_j,!0),"@"),r.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&r.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&r.push("/"),r.push(Yf(t,"/"==t.charAt(0)?mSe:gSe,!0))),(t=this.i.toString())&&r.push("?",t),(t=this.o)&&r.push("#",Yf(t,vSe)),r.join("")};var _j=/[#\/\?@]/g,gSe=/[#\?:]/g,mSe=/[#\?]/g,_Se=/[#\?@]/g,vSe=/#/g;function Kf(r,e){this.h=this.g=null,this.i=r||null,this.j=!!e}function K4(r){r.g||(r.g=new Map,r.h=0,r.i&&function hSe(r,e){if(r){r=r.split("&");for(var t=0;t<r.length;t++){var n=r[t].indexOf("="),i=null;if(0<=n){var s=r[t].substring(0,n);i=r[t].substring(n+1)}else s=r[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function vj(r,e){K4(r),e=i5(r,e),r.g.has(e)&&(r.i=null,r.h-=r.g.get(e).length,r.g.delete(e))}function Cj(r,e){return K4(r),e=i5(r,e),r.g.has(e)}function yj(r,e,t){vj(r,e),0<t.length&&(r.i=null,r.g.set(i5(r,e),hT(t)),r.h+=t.length)}function i5(r,e){return e=String(e),r.j&&(e=e.toLowerCase()),e}function Mj(r){this.l=r||MSe,r=Yt.PerformanceNavigationTiming?0<(r=Yt.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(Yt.g&&Yt.g.Ka&&Yt.g.Ka()&&Yt.g.Ka().ec),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Qe=Kf.prototype).add=function(r,e){K4(this),this.i=null,r=i5(this,r);var t=this.g.get(r);return t||this.g.set(r,t=[]),t.push(e),this.h+=1,this},Qe.forEach=function(r,e){K4(this),this.g.forEach(function(t,n){t.forEach(function(i){r.call(e,i,n,this)},this)},this)},Qe.ta=function(){K4(this);const r=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const i=r[n];for(let s=0;s<i.length;s++)t.push(e[n])}return t},Qe.Z=function(r){K4(this);let e=[];if("string"==typeof r)Cj(this,r)&&(e=e.concat(this.g.get(i5(this,r))));else{r=Array.from(this.g.values());for(let t=0;t<r.length;t++)e=e.concat(r[t])}return e},Qe.set=function(r,e){return K4(this),this.i=null,Cj(this,r=i5(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[e]),this.h+=1,this},Qe.get=function(r,e){return r&&0<(r=this.Z(r)).length?String(r[0]):e},Qe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var i=s;""!==o[n]&&(i+="="+encodeURIComponent(String(o[n]))),r.push(i)}}return this.i=r.join("&")};var MSe=10;function Ej(r){return!!r.h||!!r.g&&r.g.size>=r.j}function Sj(r){return r.h?1:r.g?r.g.size:0}function $T(r,e){return r.h?r.h==e:!!r.g&&r.g.has(e)}function GT(r,e){r.g?r.g.add(e):r.h=e}function Pj(r,e){r.h&&r.h==e?r.h=null:r.g&&r.g.has(e)&&r.g.delete(e)}function Tj(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let e=r.i;for(const t of r.g.values())e=e.concat(t.F);return e}return hT(r.i)}Mj.prototype.cancel=function(){if(this.i=Tj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var ESe=class{stringify(r){return Yt.JSON.stringify(r,void 0)}parse(r){return Yt.JSON.parse(r,void 0)}};function SSe(){this.g=new ESe}function PSe(r,e,t){const n=t||"";try{pj(r,function(i,s){let o=i;Rf(i)&&(o=AT(i)),e.push(n+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function Em(r,e,t,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch{}}function Xf(r){this.l=r.fc||null,this.j=r.ob||!1}function Sm(r,e){I2.call(this),this.F=r,this.u=e,this.m=void 0,this.readyState=BT,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}A2(Xf,LT),Xf.prototype.g=function(){return new Sm(this.l,this.j)},Xf.prototype.i=function(r){return function(){return r}}({}),A2(Sm,I2);var BT=0;function Oj(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function Qf(r){r.readyState=4,r.l=null,r.j=null,r.A=null,Jf(r)}function Jf(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(Qe=Sm.prototype).open=function(r,e){if(this.readyState!=BT)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=e,this.readyState=1,Jf(this)},Qe.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(e.body=r),(this.F||Yt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Qe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Qf(this)),this.readyState=BT},Qe.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,Jf(this)),this.g&&(this.readyState=3,Jf(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Yt.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Oj(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},Qe.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var e=r.value?r.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!r.done}))&&(this.response=this.responseText+=e)}r.done?Qf(this):Jf(this),3==this.readyState&&Oj(this)}},Qe.Za=function(r){this.g&&(this.response=this.responseText=r,Qf(this))},Qe.Ya=function(r){this.g&&(this.response=r,Qf(this))},Qe.ka=function(){this.g&&Qf(this)},Qe.setRequestHeader=function(r,e){this.v.append(r,e)},Qe.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},Qe.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],e=this.h.entries();for(var t=e.next();!t.done;)r.push((t=t.value)[0]+": "+t[1]),t=e.next();return r.join("\r\n")},Object.defineProperty(Sm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var OSe=Yt.JSON.parse;function Sr(r){I2.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=bj,this.L=this.M=!1}A2(Sr,I2);var bj="",bSe=/^https?$/i,wSe=["POST","PUT"];function wj(r,e){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=e,r.m=5,Nj(r),Pm(r)}function Nj(r){r.F||(r.F=!0,ii(r,"complete"),ii(r,"error"))}function Aj(r){if(r.h&&typeof fT<"u"&&(!r.C[1]||4!=Oc(r)||2!=r.da()))if(r.v&&4==Oc(r))xT(r.La,0,r);else if(ii(r,"readystatechange"),4==Oc(r)){r.h=!1;try{const o=r.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===o){var i=String(r.I).match(gj)[1]||null;!i&&Yt.self&&Yt.self.location&&(i=Yt.self.location.protocol.slice(0,-1)),n=!bSe.test(i?i.toLowerCase():"")}t=n}if(t)ii(r,"complete"),ii(r,"success");else{r.m=6;try{var s=2<Oc(r)?r.g.statusText:""}catch{s=""}r.j=s+" ["+r.da()+"]",Nj(r)}}finally{Pm(r)}}}function Pm(r,e){if(r.g){Ij(r);const t=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,e||ii(r,"ready");try{t.onreadystatechange=n}catch{}}}function Ij(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(Yt.clearTimeout(r.A),r.A=null)}function Oc(r){return r.g?r.g.readyState:0}function kj(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case bj:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function xj(r){let e="";return MT(r,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function UT(r,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=xj(t),"string"==typeof r?null!=t&&encodeURIComponent(String(t)):V1(r,e,t))}function e9(r,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[r]||e}function Lj(r){this.Ga=0,this.j=[],this.l=new hm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=e9("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=e9("baseRetryDelayMs",5e3,r),this.hb=e9("retryDelaySeedMs",1e4,r),this.eb=e9("forwardChannelMaxRetries",2,r),this.xa=e9("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.dc||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new Mj(r&&r.concurrentRequestLimit),this.Ja=new SSe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function WT(r){if(Rj(r),3==r.H){var e=r.W++,t=z3(r.I);if(V1(t,"SID",r.K),V1(t,"RID",e),V1(t,"TYPE","terminate"),t9(r,t),(e=new Wf(r,r.l,e)).L=2,e.v=Mm(z3(t)),t=!1,Yt.navigator&&Yt.navigator.sendBeacon)try{t=Yt.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Yt.Image&&((new Image).src=e.v,t=!0),t||(e.g=Uj(e.l,null),e.g.ha(e.v)),e.G=Date.now(),qf(e)}Gj(r)}function Tm(r){r.g&&(jT(r),r.g.cancel(),r.g=null)}function Rj(r){Tm(r),r.u&&(Yt.clearTimeout(r.u),r.u=null),bm(r),r.i.cancel(),r.m&&("number"==typeof r.m&&Yt.clearTimeout(r.m),r.m=null)}function Om(r){if(!Ej(r.i)&&!r.m){r.m=!0;var e=r.Na;Vf||Xq(),Ff||(Vf(),Ff=!0),IT.add(e,r),r.C=0}}function zj(r,e){var t;t=e?e.m:r.W++;const n=z3(r.I);V1(n,"SID",r.K),V1(n,"RID",t),V1(n,"AID",r.V),t9(r,n),r.o&&r.s&&UT(n,r.o,r.s),t=new Wf(r,r.l,t,r.C+1),null===r.o&&(t.I=r.s),e&&(r.j=e.F.concat(r.j)),e=Dj(r,t,1e3),t.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),GT(r.i,t),VT(t,n,e)}function t9(r,e){r.na&&MT(r.na,function(t,n){V1(e,n,t)}),r.h&&pj({},function(t,n){V1(e,n,t)})}function Dj(r,e,t){t=Math.min(r.j.length,t);var n=r.h?xi(r.h.Va,r.h,r):null;e:{var i=r.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let l=i[c].g;const f=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{PSe(f,o,"req"+l+"_")}catch{n&&n(f)}}if(a){n=o.join("&");break e}}}return r=r.j.splice(0,t),e.F=r,n}function Hj(r){if(!r.g&&!r.u){r.ba=1;var e=r.Ma;Vf||Xq(),Ff||(Vf(),Ff=!0),IT.add(e,r),r.A=0}}function qT(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=Bf(xi(r.Ma,r),$j(r,r.A)),r.A++,0))}function jT(r){null!=r.B&&(Yt.clearTimeout(r.B),r.B=null)}function Vj(r){r.g=new Wf(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var e=z3(r.wa);V1(e,"RID","rpc"),V1(e,"SID",r.K),V1(e,"AID",r.V),V1(e,"CI",r.G?"0":"1"),!r.G&&r.qa&&V1(e,"TO",r.qa),V1(e,"TYPE","xmlhttp"),t9(r,e),r.o&&r.s&&UT(e,r.o,r.s),r.L&&r.g.setTimeout(r.L);var t=r.g;r=r.pa,t.L=1,t.v=Mm(z3(e)),t.s=null,t.S=!0,uj(t,r)}function bm(r){null!=r.v&&(Yt.clearTimeout(r.v),r.v=null)}function Fj(r,e){var t=null;if(r.g==e){bm(r),jT(r),r.g=null;var n=2}else{if(!$T(r.i,e))return;t=e.F,Pj(r.i,e),n=1}if(0!=r.H)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=r.C;ii(n=pm(),new sj(n,t)),Om(r)}else Hj(r);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==n&&function ISe(r,e){return!(Sj(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=e.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=Bf(xi(r.Na,r,e),$j(r,r.C)),r.C++,0)))}(r,e)||2==n&&qT(r)))switch(t&&0<t.length&&(e=r.i,e.i=e.i.concat(t)),i){case 1:V6(r,5);break;case 4:V6(r,10);break;case 3:V6(r,6);break;default:V6(r,2)}}function $j(r,e){let t=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(t*=2),t*e}function V6(r,e){if(r.l.info("Error code "+e),2==e){var t=null;r.h&&(t=null);var n=xi(r.pb,r);t||(t=new H6("//www.google.com/images/cleardot.gif"),Yt.location&&"http"==Yt.location.protocol||Cm(t,"https"),Mm(t)),function TSe(r,e){const t=new hm;if(Yt.Image){const n=new Image;n.onload=am(Em,t,n,"TestLoadImage: loaded",!0,e),n.onerror=am(Em,t,n,"TestLoadImage: error",!1,e),n.onabort=am(Em,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=am(Em,t,n,"TestLoadImage: timeout",!1,e),Yt.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else e(!1)}(t.toString(),n)}else us(2);r.H=0,r.h&&r.h.za(e),Gj(r),Rj(r)}function Gj(r){if(r.H=0,r.ma=[],r.h){const e=Tj(r.i);(0!=e.length||0!=r.j.length)&&(Dq(r.ma,e),Dq(r.ma,r.j),r.i.i.length=0,hT(r.j),r.j.length=0),r.h.ya()}}function Bj(r,e,t){var n=t instanceof H6?z3(t):new H6(t);if(""!=n.g)e&&(n.g=e+"."+n.g),ym(n,n.m);else{var i=Yt.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new H6(null);n&&Cm(s,n),e&&(s.g=e),i&&ym(s,i),t&&(s.l=t),n=s}return e=r.Da,(t=r.F)&&e&&V1(n,t,e),V1(n,"VER",r.ra),t9(r,n),n}function Uj(r,e,t){if(e&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Sr(t&&r.Ha&&!r.va?new Xf({ob:!0}):r.va)).Oa(r.J),e}function Wj(){}function wm(){if(n5&&!(10<=Number(UEe)))throw Error("Environmental error: no available transport.")}function lo(r,e){I2.call(this),this.g=new Lj(e),this.l=r,this.h=e&&e.messageUrlParams||null,r=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(r?r["X-WebChannel-Content-Type"]=e.messageContentType:r={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(r?r["X-WebChannel-Client-Profile"]=e.Ca:r={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=r,(r=e&&e.cc)&&!zf(r)&&(this.g.o=r),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!zf(e)&&(this.g.F=e,null!==(r=this.h)&&e in r&&e in(r=this.h)&&delete r[e]),this.j=new s5(this)}function qj(r){RT.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var e=r.__sm__;if(e){e:{for(const t in e){r=t;break e}r=void 0}(this.i=r)&&(r=this.i,e=null!==e&&r in e?e[r]:void 0),this.data=e}else this.data=r}function jj(){zT.call(this),this.status=1}function s5(r){this.g=r}function Ta(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ZT(r,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)n[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=r.g[3],o=(e=r.g[0])+(s^(t=r.g[1])&((i=r.g[2])^s))+n[0]+3614090360&4294967295;o=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(t^i))+n[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^i^s)+n[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(t|~s))+n[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(i^(t|~s))+n[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~t))+n[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+e&4294967295,r.g[1]=r.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+s&4294967295}function f1(r,e){this.h=e;for(var t=[],n=!0,i=r.length-1;0<=i;i--){var s=0|r[i];n&&s==e||(t[i]=s,n=!1)}this.g=t}(Qe=Sr.prototype).Oa=function(r){this.M=r},Qe.ha=function(r,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);e=e?e.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():DT.g(),this.C=function aj(r){return r.h||(r.h=r.i())}(this.u?this.u:DT),this.g.onreadystatechange=xi(this.La,this);try{this.G=!0,this.g.open(e,String(r),!0),this.G=!1}catch(s){return void wj(this,s)}if(r=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)t.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const s of n.keys())t.set(s,n.get(s))}n=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=Yt.FormData&&r instanceof Yt.FormData,!(0<=zq(wSe,e))||n||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ij(this),0<this.B&&((this.L=function NSe(r){return n5&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=xi(this.ua,this)):this.A=xT(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(s){wj(this,s)}},Qe.ua=function(){typeof fT<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ii(this,"timeout"),this.abort(8))},Qe.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,ii(this,"complete"),ii(this,"abort"),Pm(this))},Qe.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pm(this,!0)),Sr.$.N.call(this)},Qe.La=function(){this.s||(this.G||this.v||this.l?Aj(this):this.kb())},Qe.kb=function(){Aj(this)},Qe.isActive=function(){return!!this.g},Qe.da=function(){try{return 2<Oc(this)?this.g.status:-1}catch{return-1}},Qe.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Qe.Wa=function(r){if(this.g){var e=this.g.responseText;return r&&0==e.indexOf(r)&&(e=e.substring(r.length)),OSe(e)}},Qe.Ia=function(){return this.m},Qe.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Qe=Lj.prototype).ra=8,Qe.H=1,Qe.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new Wf(this,this.l,r);let s=this.s;if(this.U&&(s?(s=Gq(s),Uq(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Dj(this,i,e),V1(t=z3(this.I),"RID",r),V1(t,"CVER",22),this.F&&V1(t,"X-HTTP-Session-Id",this.F),t9(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(xj(s)))+"&"+e:this.o&&UT(t,this.o,s)),GT(this.i,i),this.bb&&V1(t,"TYPE","init"),this.P?(V1(t,"$req",e),V1(t,"SID","null"),i.aa=!0,VT(i,t,null)):VT(i,t,e),this.H=2}}else 3==this.H&&(r?zj(this,r):0==this.j.length||Ej(this.i)||zj(this))},Qe.Ma=function(){if(this.u=null,Vj(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=Bf(xi(this.jb,this),r)}},Qe.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,us(10),Tm(this),Vj(this))},Qe.ib=function(){null!=this.v&&(this.v=null,Tm(this),qT(this),us(19))},Qe.pb=function(r){r?(this.l.info("Successfully pinged google.com"),us(2)):(this.l.info("Failed to ping google.com"),us(1))},Qe.isActive=function(){return!!this.h&&this.h.isActive(this)},(Qe=Wj.prototype).Ba=function(){},Qe.Aa=function(){},Qe.za=function(){},Qe.ya=function(){},Qe.isActive=function(){return!0},Qe.Va=function(){},wm.prototype.g=function(r,e){return new lo(r,e)},A2(lo,I2),lo.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,e=this.l,t=this.h||void 0;us(0),r.Y=e,r.na=t||{},r.G=r.aa,r.I=Bj(r,null,r.Y),Om(r)},lo.prototype.close=function(){WT(this.g)},lo.prototype.u=function(r){var e=this.g;if("string"==typeof r){var t={};t.__data__=r,r=t}else this.v&&((t={}).__data__=AT(r),r=t);e.j.push(new class{constructor(r,e){this.g=r,this.map=e}}(e.fb++,r)),3==e.H&&Om(e)},lo.prototype.N=function(){this.g.h=null,delete this.j,WT(this.g),delete this.g,lo.$.N.call(this)},A2(qj,RT),A2(jj,zT),A2(s5,Wj),s5.prototype.Ba=function(){ii(this.g,"a")},s5.prototype.Aa=function(r){ii(this.g,new qj(r))},s5.prototype.za=function(r){ii(this.g,new jj)},s5.prototype.ya=function(){ii(this.g,"b")},A2(Ta,function kSe(){this.blockSize=-1}),Ta.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ta.prototype.j=function(r,e){void 0===e&&(e=r.length);for(var t=e-this.blockSize,n=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)ZT(this,r,s),s+=this.blockSize;if("string"==typeof r){for(;s<e;)if(n[i++]=r.charCodeAt(s++),i==this.blockSize){ZT(this,n),i=0;break}}else for(;s<e;)if(n[i++]=r[s++],i==this.blockSize){ZT(this,n),i=0;break}}this.h=i,this.i+=e},Ta.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var e=1;e<r.length-8;++e)r[e]=0;var t=8*this.i;for(e=r.length-8;e<r.length;++e)r[e]=255&t,t/=256;for(this.j(r),r=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)r[t++]=this.g[e]>>>n&255;return r};var xSe={};function YT(r){return-128<=r&&128>r?function $Ee(r,e){var t=xSe;return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=e(r)}(r,function(e){return new f1([0|e],0>e?-1:0)}):new f1([0|r],0>r?-1:0)}function bc(r){if(isNaN(r)||!isFinite(r))return o5;if(0>r)return si(bc(-r));for(var e=[],t=1,n=0;r>=t;n++)e[n]=r/t|0,t*=KT;return new f1(e,0)}var KT=4294967296,o5=YT(0),XT=YT(1),Yj=YT(16777216);function D3(r){if(0!=r.h)return!1;for(var e=0;e<r.g.length;e++)if(0!=r.g[e])return!1;return!0}function zo(r){return-1==r.h}function si(r){for(var e=r.g.length,t=[],n=0;n<e;n++)t[n]=~r.g[n];return new f1(t,~r.h).add(XT)}function Nm(r,e){return r.add(si(e))}function Am(r,e){for(;(65535&r[e])!=r[e];)r[e+1]+=r[e]>>>16,r[e]&=65535,e++}function n9(r,e){this.g=r,this.h=e}function Im(r,e){if(D3(e))throw Error("division by zero");if(D3(r))return new n9(o5,o5);if(zo(r))return e=Im(si(r),e),new n9(si(e.g),si(e.h));if(zo(e))return e=Im(r,si(e)),new n9(si(e.g),e.h);if(30<r.g.length){if(zo(r)||zo(e))throw Error("slowDivide_ only works with positive integers.");for(var t=XT,n=e;0>=n.X(r);)t=Kj(t),n=Kj(n);var i=a5(t,1),s=a5(n,1);for(n=a5(n,2),t=a5(t,2);!D3(n);){var o=s.add(n);0>=o.X(r)&&(i=i.add(t),s=o),n=a5(n,1),t=a5(t,1)}return e=Nm(r,i.R(e)),new n9(i,e)}for(i=o5;0<=r.X(e);){for(t=Math.max(1,Math.floor(r.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),o=(s=bc(t)).R(e);zo(o)||0<o.X(r);)o=(s=bc(t-=n)).R(e);D3(s)&&(s=XT),i=i.add(s),r=Nm(r,o)}return new n9(i,r)}function Kj(r){for(var e=r.g.length+1,t=[],n=0;n<e;n++)t[n]=r.D(n)<<1|r.D(n-1)>>>31;return new f1(t,r.h)}function a5(r,e){var t=e>>5;e%=32;for(var n=r.g.length-t,i=[],s=0;s<n;s++)i[s]=0<e?r.D(s+t)>>>e|r.D(s+t+1)<<32-e:r.D(s+t);return new f1(i,r.h)}(Qe=f1.prototype).ea=function(){if(zo(this))return-si(this).ea();for(var r=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);r+=(0<=n?n:KT+n)*e,e*=KT}return r},Qe.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if(D3(this))return"0";if(zo(this))return"-"+si(this).toString(r);for(var e=bc(Math.pow(r,6)),t=this,n="";;){var i=Im(t,e).g,s=((0<(t=Nm(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(r);if(D3(t=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},Qe.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},Qe.X=function(r){return zo(r=Nm(this,r))?-1:D3(r)?0:1},Qe.abs=function(){return zo(this)?si(this):this},Qe.add=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0,i=0;i<=e;i++){var s=n+(65535&this.D(i))+(65535&r.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=o>>>16,t[i]=(o&=65535)<<16|(s&=65535)}return new f1(t,-2147483648&t[t.length-1]?-1:0)},Qe.R=function(r){if(D3(this)||D3(r))return o5;if(zo(this))return zo(r)?si(this).R(si(r)):si(si(this).R(r));if(zo(r))return si(this.R(si(r)));if(0>this.X(Yj)&&0>r.X(Yj))return bc(this.ea()*r.ea());for(var e=this.g.length+r.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var s=this.D(n)>>>16,o=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);t[2*n+2*i]+=o*c,Am(t,2*n+2*i),t[2*n+2*i+1]+=s*c,Am(t,2*n+2*i+1),t[2*n+2*i+1]+=o*a,Am(t,2*n+2*i+1),t[2*n+2*i+2]+=s*a,Am(t,2*n+2*i+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new f1(t,0)},Qe.gb=function(r){return Im(this,r).h},Qe.and=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&r.D(n);return new f1(t,this.h&r.h)},Qe.or=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|r.D(n);return new f1(t,this.h|r.h)},Qe.xor=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^r.D(n);return new f1(t,this.h^r.h)},wm.prototype.createWebChannel=wm.prototype.g,lo.prototype.send=lo.prototype.u,lo.prototype.open=lo.prototype.m,lo.prototype.close=lo.prototype.close,gm.NO_ERROR=0,gm.TIMEOUT=8,gm.HTTP_ERROR=6,oj.COMPLETE="complete",cj.EventType=Uf,Uf.OPEN="a",Uf.CLOSE="b",Uf.ERROR="c",Uf.MESSAGE="d",I2.prototype.listen=I2.prototype.O,Sr.prototype.listenOnce=Sr.prototype.P,Sr.prototype.getLastError=Sr.prototype.Sa,Sr.prototype.getLastErrorCode=Sr.prototype.Ia,Sr.prototype.getStatus=Sr.prototype.da,Sr.prototype.getResponseJson=Sr.prototype.Wa,Sr.prototype.getResponseText=Sr.prototype.ja,Sr.prototype.send=Sr.prototype.ha,Sr.prototype.setWithCredentials=Sr.prototype.Oa,Ta.prototype.digest=Ta.prototype.l,Ta.prototype.reset=Ta.prototype.reset,Ta.prototype.update=Ta.prototype.j,f1.prototype.add=f1.prototype.add,f1.prototype.multiply=f1.prototype.R,f1.prototype.modulo=f1.prototype.gb,f1.prototype.compare=f1.prototype.X,f1.prototype.toNumber=f1.prototype.ea,f1.prototype.toString=f1.prototype.toString,f1.prototype.getBits=f1.prototype.D,f1.fromNumber=bc,f1.fromString=function Zj(r,e){if(0==r.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==r.charAt(0))return si(Zj(r.substring(1),e));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=bc(Math.pow(e,8)),n=o5,i=0;i<r.length;i+=8){var s=Math.min(8,r.length-i),o=parseInt(r.substring(i,i+s),e);8>s?(s=bc(Math.pow(e,s)),n=n.R(s).add(bc(o))):n=(n=n.R(t)).add(bc(o))}return n};var LSe=Pa.createWebChannelTransport=function(){return new wm},RSe=Pa.getStatEventTarget=function(){return pm()},QT=Pa.ErrorCode=gm,zSe=Pa.EventType=oj,DSe=Pa.Event=z6,Xj=Pa.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},HSe=Pa.FetchXmlHttpFactory=Xf,km=Pa.WebChannel=cj,VSe=Pa.XhrIo=Sr,FSe=Pa.Md5=Ta,c5=Pa.Integer=f1;const Qj="@firebase/firestore";class k2{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}k2.UNAUTHENTICATED=new k2(null),k2.GOOGLE_CREDENTIALS=new k2("google-credentials-uid"),k2.FIRST_PARTY=new k2("first-party-uid"),k2.MOCK_USER=new k2("mock-user");let l5="9.23.0";const X4=new e5("@firebase/firestore");function JT(){return X4.logLevel}function Oe(r,...e){if(X4.logLevel<=Un.DEBUG){const t=e.map(eO);X4.debug(`Firestore (${l5}): ${r}`,...t)}}function Fr(r,...e){if(X4.logLevel<=Un.ERROR){const t=e.map(eO);X4.error(`Firestore (${l5}): ${r}`,...t)}}function Oa(r,...e){if(X4.logLevel<=Un.WARN){const t=e.map(eO);X4.warn(`Firestore (${l5}): ${r}`,...t)}}function eO(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function ot(r="Unexpected state"){const e=`FIRESTORE (${l5}) INTERNAL ASSERTION FAILED: `+r;throw Fr(e),new Error(e)}function gt(r,e){r||ot()}function qe(r,e){return r}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Ro{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class f2{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Jj{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $Se{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(k2.UNAUTHENTICATED))}shutdown(){}}class GSe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class BSe{constructor(e){this.t=e,this.currentUser=k2.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let o=new f2;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new f2,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable(M(function*(){yield l.promise,yield s(n.currentUser)}))},c=l=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new f2)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(gt("string"==typeof n.accessToken),new Jj(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return gt(null===e||"string"==typeof e),new k2(e)}}class USe{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=k2.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class WSe{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new USe(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(k2.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class eZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qSe{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=s=>{null!=s.error&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,Oe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(gt("string"==typeof t.token),this.T=t.token,new eZ(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function jSe(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class tZ{static A(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=jSe(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return n}}function qt(r,e){return r<e?-1:r>e?1:0}function u5(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}class cr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return cr.fromMillis(Date.now())}static fromDate(e){return cr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new cr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?qt(this.nanoseconds,e.nanoseconds):qt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class vt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new vt(e)}static min(){return new vt(new cr(0,0))}static max(){return new vt(new cr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class r9{constructor(e,t,n){void 0===t?t=0:t>e.length&&ot(),void 0===n?n=e.length-t:n>e.length-t&&ot(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===r9.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof r9?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Hn extends r9{construct(e,t,n){return new Hn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Hn(t)}static emptyPath(){return new Hn([])}}const ZSe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $r extends r9{construct(e,t,n){return new $r(e,t,n)}static isValidIdentifier(e){return ZSe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new $r(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Te(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Te(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(n+=a,i++):(s(),i++)}if(s(),o)throw new Te(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $r(t)}static emptyPath(){return new $r([])}}class Ge{constructor(e){this.path=e}static fromPath(e){return new Ge(Hn.fromString(e))}static fromName(e){return new Ge(Hn.fromString(e).popFirst(5))}static empty(){return new Ge(Hn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Hn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Hn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ge(new Hn(e.slice()))}}function iZ(r){return new uo(r.readTime,r.key,-1)}class uo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new uo(vt.min(),Ge.empty(),-1)}static max(){return new uo(vt.max(),Ge.empty(),-1)}}function nO(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ge.comparator(r.documentKey,e.documentKey),0!==t?t:qt(r.largestBatchId,e.largestBatchId))}const sZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XSe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Q4(r){return rO.apply(this,arguments)}function rO(){return rO=M(function*(r){if(r.code!==fe.FAILED_PRECONDITION||r.message!==sZ)throw r;Oe("LocalStore","Unexpectedly lost primary lease")}),rO.apply(this,arguments)}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ot(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>n(c))}),o=!0,s===i&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(i=>i?ce.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const l=c;t(e[l]).next(f=>{o[l]=f,++a,a===s&&n(o)},f=>i(f))}})}static doWhile(e,t){return new ce((n,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):n()};s()})}}function J4(r){return"IndexedDbTransactionError"===r.name}let fo=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>n.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return r.ct=-1,r})();function o9(r){return null==r}function a9(r){return 0===r&&1/r==-1/0}function pZ(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function el(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function gZ(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class x1{constructor(e,t){this.comparator=e,this.root=t||oi.EMPTY}insert(e,t){return new x1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,oi.BLACK,null,null))}remove(e){return new x1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,oi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dm(this.root,e,this.comparator,!0)}}class Dm{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class oi{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??oi.RED,this.left=i??oi.EMPTY,this.right=s??oi.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new oi(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return oi.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return oi.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,oi.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,oi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ot();const e=this.left.check();if(e!==this.right.check())throw ot();return e+(this.isRed()?0:1)}}oi.EMPTY=null,oi.RED=!0,oi.BLACK=!1,oi.EMPTY=new class{constructor(){this.size=0}get key(){throw ot()}get value(){throw ot()}get color(){throw ot()}get left(){throw ot()}get right(){throw ot()}copy(r,e,t,n,i){return this}insert(r,e,t){return new oi(r,e)}remove(r,e){return this}isEmpty(){return!0}inorderTraversal(r){return!1}reverseTraversal(r){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class F1{constructor(e){this.comparator=e,this.data=new x1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new mZ(this.data.getIterator())}getIteratorFrom(e){return new mZ(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof F1)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new F1(this.comparator);return t.data=e,t}}class mZ{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Rs{constructor(e){this.fields=e,e.sort($r.comparator)}static empty(){return new Rs([])}unionWith(e){let t=new F1($r.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Rs(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return u5(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class _Z extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class d2{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new _Z("Invalid base64 string: "+i):i}}(e);return new d2(t)}static fromUint8Array(e){const t=function(n){let i="";for(let s=0;s<n.length;++s)i+=String.fromCharCode(n[s]);return i}(e);return new d2(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return qt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}d2.EMPTY_BYTE_STRING=new d2("");const yPe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function tl(r){if(gt(!!r),"string"==typeof r){let e=0;const t=yPe.exec(r);if(gt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Pr(r.seconds),nanos:Pr(r.nanos)}}function Pr(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function H3(r){return"string"==typeof r?d2.fromBase64String(r):d2.fromUint8Array(r)}function Hm(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Vm(r){const e=r.mapValue.fields.__previous_value__;return Hm(e)?Vm(e):e}function c9(r){const e=tl(r.mapValue.fields.__local_write_time__.timestampValue);return new cr(e.seconds,e.nanos)}class MPe{constructor(e,t,n,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class G6{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new G6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof G6&&e.projectId===this.projectId&&e.database===this.database}}const nl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function rl(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Hm(r)?4:MZ(r)?9007199254740991:10:ot()}function Nc(r,e){if(r===e)return!0;const t=rl(r);if(t!==rl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return c9(r).isEqual(c9(e));case 3:return function(n,i){if("string"==typeof n.timestampValue&&"string"==typeof i.timestampValue&&n.timestampValue.length===i.timestampValue.length)return n.timestampValue===i.timestampValue;const s=tl(n.timestampValue),o=tl(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return i=e,H3(r.bytesValue).isEqual(H3(i.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(n,i){return Pr(n.geoPointValue.latitude)===Pr(i.geoPointValue.latitude)&&Pr(n.geoPointValue.longitude)===Pr(i.geoPointValue.longitude)}(r,e);case 2:return function(n,i){if("integerValue"in n&&"integerValue"in i)return Pr(n.integerValue)===Pr(i.integerValue);if("doubleValue"in n&&"doubleValue"in i){const s=Pr(n.doubleValue),o=Pr(i.doubleValue);return s===o?a9(s)===a9(o):isNaN(s)&&isNaN(o)}return!1}(r,e);case 9:return u5(r.arrayValue.values||[],e.arrayValue.values||[],Nc);case 10:return function(n,i){const s=n.mapValue.fields||{},o=i.mapValue.fields||{};if(pZ(s)!==pZ(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(void 0===o[a]||!Nc(s[a],o[a])))return!1;return!0}(r,e);default:return ot()}var i}function l9(r,e){return void 0!==(r.values||[]).find(t=>Nc(t,e))}function il(r,e){if(r===e)return 0;const t=rl(r),n=rl(e);if(t!==n)return qt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return qt(r.booleanValue,e.booleanValue);case 2:return function(i,s){const o=Pr(i.integerValue||i.doubleValue),a=Pr(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(r,e);case 3:return vZ(r.timestampValue,e.timestampValue);case 4:return vZ(c9(r),c9(e));case 5:return qt(r.stringValue,e.stringValue);case 6:return function(i,s){const o=H3(i),a=H3(s);return o.compareTo(a)}(r.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=qt(o[c],a[c]);if(0!==l)return l}return qt(o.length,a.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,s){const o=qt(Pr(i.latitude),Pr(s.latitude));return 0!==o?o:qt(Pr(i.longitude),Pr(s.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=il(o[c],a[c]);if(l)return l}return qt(o.length,a.length)}(r.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===nl.mapValue&&s===nl.mapValue)return 0;if(i===nl.mapValue)return 1;if(s===nl.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),c=s.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let f=0;f<a.length&&f<l.length;++f){const d=qt(a[f],l[f]);if(0!==d)return d;const m=il(o[a[f]],c[l[f]]);if(0!==m)return m}return qt(a.length,l.length)}(r.mapValue,e.mapValue);default:throw ot()}}function vZ(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return qt(r,e);const t=tl(r),n=tl(e),i=qt(t.seconds,n.seconds);return 0!==i?i:qt(t.nanos,n.nanos)}function d5(r){return oO(r)}function oO(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(n){const i=tl(n);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?H3(r.bytesValue).toBase64():"referenceValue"in r?Ge.fromName(r.referenceValue).toString():"geoPointValue"in r?`geo(${(e=r.geoPointValue).latitude},${e.longitude})`:"arrayValue"in r?function(n){let i="[",s=!0;for(const o of n.values||[])s?s=!1:i+=",",i+=oO(o);return i+"]"}(r.arrayValue):"mapValue"in r?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${oO(n.fields[a])}`;return s+"}"}(r.mapValue):ot();var e}function B6(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function aO(r){return!!r&&"integerValue"in r}function u9(r){return!!r&&"arrayValue"in r}function CZ(r){return!!r&&"nullValue"in r}function yZ(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Gm(r){return!!r&&"mapValue"in r}function f9(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return el(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=f9(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=f9(r.arrayValue.values[t]);return e}return Object.assign({},r)}function MZ(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class ai{constructor(e){this.value=e}static empty(){return new ai({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Gm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=f9(t)}setAll(e){let t=$r.emptyPath(),n={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=a.popLast()}o?n[a.lastSegment()]=f9(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());Gm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Gm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){el(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new ai(f9(this.value))}}function PZ(r){const e=[];return el(r.fields,(t,n)=>{const i=new $r([t]);if(Gm(n)){const s=PZ(n.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Rs(e)}class $1{constructor(e,t,n,i,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new $1(e,0,vt.min(),vt.min(),vt.min(),ai.empty(),0)}static newFoundDocument(e,t,n,i){return new $1(e,1,t,vt.min(),n,i,0)}static newNoDocument(e,t){return new $1(e,2,t,vt.min(),vt.min(),ai.empty(),0)}static newUnknownDocument(e,t){return new $1(e,3,t,vt.min(),vt.min(),ai.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(vt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ai.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ai.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof $1&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $1(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class sl{constructor(e,t){this.position=e,this.inclusive=t}}function TZ(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(n=s.field.isKeyField()?Ge.comparator(Ge.fromName(o.referenceValue),t.key):il(o,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function OZ(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Nc(r.position[t],e.position[t]))return!1;return!0}class h5{constructor(e,t="asc"){this.field=e,this.dir=t}}function PPe(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class bZ{}class En extends bZ{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new TPe(e,t,n):"array-contains"===t?new wPe(e,n):"in"===t?new xZ(e,n):"not-in"===t?new NPe(e,n):"array-contains-any"===t?new APe(e,n):new En(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new OPe(e,n):new bPe(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(il(t,this.value)):null!==t&&rl(this.value)===rl(t)&&this.matchesComparison(il(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ot()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class d1 extends bZ{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new d1(e,t)}matches(e){return p5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function p5(r){return"and"===r.op}function lO(r){return function wZ(r){for(const e of r.filters)if(e instanceof d1)return!1;return!0}(r)&&p5(r)}function uO(r){if(r instanceof En)return r.field.canonicalString()+r.op.toString()+d5(r.value);if(lO(r))return r.filters.map(e=>uO(e)).join(",");{const e=r.filters.map(t=>uO(t)).join(",");return`${r.op}(${e})`}}function NZ(r,e){return r instanceof En?(t=r,(n=e)instanceof En&&t.op===n.op&&t.field.isEqual(n.field)&&Nc(t.value,n.value)):r instanceof d1?function(t,n){return n instanceof d1&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((i,s,o)=>i&&NZ(s,n.filters[o]),!0)}(r,e):void ot();var t,n}function IZ(r){return r instanceof En?`${(e=r).field.canonicalString()} ${e.op} ${d5(e.value)}`:r instanceof d1?function(e){return e.op.toString()+" {"+e.getFilters().map(IZ).join(" ,")+"}"}(r):"Filter";var e}class TPe extends En{constructor(e,t,n){super(e,t,n),this.key=Ge.fromName(n.referenceValue)}matches(e){const t=Ge.comparator(e.key,this.key);return this.matchesComparison(t)}}class OPe extends En{constructor(e,t){super(e,"in",t),this.keys=kZ(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class bPe extends En{constructor(e,t){super(e,"not-in",t),this.keys=kZ(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function kZ(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Ge.fromName(n.referenceValue))}class wPe extends En{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return u9(t)&&l9(t.arrayValue,this.value)}}class xZ extends En{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&l9(this.value.arrayValue,t)}}class NPe extends En{constructor(e,t){super(e,"not-in",t)}matches(e){if(l9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!l9(this.value.arrayValue,t)}}class APe extends En{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!u9(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>l9(this.value.arrayValue,n))}}class IPe{constructor(e,t=null,n=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}}function fO(r,e=null,t=[],n=[],i=null,s=null,o=null){return new IPe(r,e,t,n,i,s,o)}function U6(r){const e=qe(r);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>uO(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(i=n).field.canonicalString()+i.dir;var i}).join(","),o9(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>d5(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>d5(n)).join(",")),e.dt=t}return e.dt}function d9(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!PPe(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!NZ(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!OZ(r.startAt,e.startAt)&&OZ(r.endAt,e.endAt)}function Bm(r){return Ge.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class V3{constructor(e,t=null,n=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this._t=null}}function g5(r){return new V3(r)}function DZ(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function dO(r){return r.explicitOrderBy.length>0?r.explicitOrderBy[0].field:null}function Wm(r){for(const e of r.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function hO(r){return null!==r.collectionGroup}function W6(r){const e=qe(r);if(null===e.wt){e.wt=[];const t=Wm(e),n=dO(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new h5(t)),e.wt.push(new h5($r.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new h5($r.keyField(),s))}}}return e.wt}function fs(r){const e=qe(r);if(!e._t)if("F"===e.limitType)e._t=fO(e.path,e.collectionGroup,W6(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of W6(e))t.push(new h5(s.field,"desc"===s.dir?"asc":"desc"));const n=e.endAt?new sl(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new sl(e.startAt.position,e.startAt.inclusive):null;e._t=fO(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function pO(r,e){e.getFirstInequalityField(),Wm(r);const t=r.filters.concat([e]);return new V3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function qm(r,e,t){return new V3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function h9(r,e){return d9(fs(r),fs(e))&&r.limitType===e.limitType}function HZ(r){return`${U6(fs(r))}|lt:${r.limitType}`}function gO(r){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>IZ(n)).join(", ")}]`),o9(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>{return`${(i=n).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>d5(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>d5(n)).join(",")),`Target(${t})`}(fs(r))}; limitType=${r.limitType})`}function p9(r,e){return e.isFoundDocument()&&function(t,n){const i=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ge.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(r,e)&&function(t,n){for(const i of W6(t))if(!i.field.isKeyField()&&null===n.data.field(i.field))return!1;return!0}(r,e)&&function(t,n){for(const i of t.filters)if(!i.matches(n))return!1;return!0}(r,e)&&(n=e,!((t=r).startAt&&!function(i,s,o){const a=TZ(i,s,o);return i.inclusive?a<=0:a<0}(t.startAt,W6(t),n)||t.endAt&&!function(i,s,o){const a=TZ(i,s,o);return i.inclusive?a>=0:a>0}(t.endAt,W6(t),n)));var t,n}function FZ(r){return(e,t)=>{let n=!1;for(const i of W6(r)){const s=kPe(i,e,t);if(0!==s)return s;n=n||i.field.isKeyField()}return 0}}function kPe(r,e,t){const n=r.field.isKeyField()?Ge.comparator(e.key,t.key):function(i,s,o){const a=s.data.field(i),c=o.data.field(i);return null!==a&&null!==c?il(a,c):ot()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return ot()}}class F3{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){el(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return gZ(this.inner)}size(){return this.innerSize}}const xPe=new x1(Ge.comparator);function zs(){return xPe}const $Z=new x1(Ge.comparator);function g9(...r){let e=$Z;for(const t of r)e=e.insert(t.key,t);return e}function GZ(r){let e=$Z;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Ac(){return m9()}function BZ(){return m9()}function m9(){return new F3(r=>r.toString(),(r,e)=>r.isEqual(e))}const LPe=new x1(Ge.comparator),RPe=new F1(Ge.comparator);function rn(...r){let e=RPe;for(const t of r)e=e.add(t);return e}const zPe=new F1(qt);function UZ(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:a9(e)?"-0":e}}function WZ(r){return{integerValue:""+r}}function qZ(r,e){return function aZ(r){return"number"==typeof r&&Number.isInteger(r)&&!a9(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?WZ(e):UZ(r,e)}class jm{constructor(){this._=void 0}}function DPe(r,e,t){return r instanceof m5?function(n,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return i&&Hm(i)&&(i=Vm(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):r instanceof q6?ZZ(r,e):r instanceof j6?YZ(r,e):function(n,i){const s=jZ(n,i),o=KZ(s)+KZ(n.gt);return aO(s)&&aO(n.gt)?WZ(o):UZ(n.serializer,o)}(r,e)}function HPe(r,e,t){return r instanceof q6?ZZ(r,e):r instanceof j6?YZ(r,e):t}function jZ(r,e){return r instanceof _5?aO(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class m5 extends jm{}class q6 extends jm{constructor(e){super(),this.elements=e}}function ZZ(r,e){const t=XZ(e);for(const n of r.elements)t.some(i=>Nc(i,n))||t.push(n);return{arrayValue:{values:t}}}class j6 extends jm{constructor(e){super(),this.elements=e}}function YZ(r,e){let t=XZ(e);for(const n of r.elements)t=t.filter(i=>!Nc(i,n));return{arrayValue:{values:t}}}class _5 extends jm{constructor(e,t){super(),this.serializer=e,this.gt=t}}function KZ(r){return Pr(r.integerValue||r.doubleValue)}function XZ(r){return u9(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class _9{constructor(e,t){this.field=e,this.transform=t}}class FPe{constructor(e,t){this.version=e,this.transformResults=t}}class er{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new er}static exists(e){return new er(void 0,e)}static updateTime(e){return new er(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zm(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class Ym{}function QZ(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new C5(r.key,er.none()):new v5(r.key,r.data,er.none());{const t=r.data,n=ai.empty();let i=new F1($r.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?n.delete(s):n.set(s,o),i=i.add(s)}return new $3(r.key,n,new Rs(i.toArray()),er.none())}}function $Pe(r,e,t){r instanceof v5?function(n,i,s){const o=n.value.clone(),a=tY(n.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(r,e,t):r instanceof $3?function(n,i,s){if(!Zm(n.precondition,i))return void i.convertToUnknownDocument(s.version);const o=tY(n.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(eY(n)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function v9(r,e,t,n){return r instanceof v5?function(i,s,o,a){if(!Zm(i.precondition,s))return o;const c=i.value.clone(),l=nY(i.fieldTransforms,a,s);return c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof $3?function(i,s,o,a){if(!Zm(i.precondition,s))return o;const c=nY(i.fieldTransforms,a,s),l=s.data;return l.setAll(eY(i)),l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null===o?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(r,e,t,n):(o=t,Zm(r.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o);var s,o}function GPe(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=jZ(n.transform,i||null);null!=s&&(null===t&&(t=ai.empty()),t.set(n.field,s))}return t||null}function JZ(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=r.fieldTransforms)&&void 0===n||t&&n&&u5(t,n,(i,s)=>function VPe(r,e){return r.field.isEqual(e.field)&&(n=e.transform,(t=r.transform)instanceof q6&&n instanceof q6||t instanceof j6&&n instanceof j6?u5(t.elements,n.elements,Nc):t instanceof _5&&n instanceof _5?Nc(t.gt,n.gt):t instanceof m5&&n instanceof m5);var t,n}(i,s))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var t,n}class v5 extends Ym{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class $3 extends Ym{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function eY(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function tY(r,e,t){const n=new Map;gt(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,a=e.data.field(s.field);n.set(s.field,HPe(o,a,t[i]))}return n}function nY(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,DPe(s,o,e))}return n}class C5 extends Ym{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _O extends Ym{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vO{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&$Pe(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=v9(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=v9(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=BZ();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const c=QZ(o,a);null!==c&&n.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(vt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),rn())}isEqual(e){return this.batchId===e.batchId&&u5(this.mutations,e.mutations,(t,n)=>JZ(t,n))&&u5(this.baseMutations,e.baseMutations,(t,n)=>JZ(t,n))}}class CO{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){gt(e.mutations.length===n.length);let i=LPe;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new CO(e,t,n,i)}}class yO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class UPe{constructor(e,t){this.count=e,this.unchangedNames=t}}var Jr,Vn;function iY(r){if(void 0===r)return Fr("GRPC error has no .code"),fe.UNKNOWN;switch(r){case Jr.OK:return fe.OK;case Jr.CANCELLED:return fe.CANCELLED;case Jr.UNKNOWN:return fe.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return fe.INTERNAL;case Jr.UNAVAILABLE:return fe.UNAVAILABLE;case Jr.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case Jr.NOT_FOUND:return fe.NOT_FOUND;case Jr.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case Jr.ABORTED:return fe.ABORTED;case Jr.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case Jr.DATA_LOSS:return fe.DATA_LOSS;default:return ot()}}(Vn=Jr||(Jr={}))[Vn.OK=0]="OK",Vn[Vn.CANCELLED=1]="CANCELLED",Vn[Vn.UNKNOWN=2]="UNKNOWN",Vn[Vn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vn[Vn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vn[Vn.NOT_FOUND=5]="NOT_FOUND",Vn[Vn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vn[Vn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vn[Vn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vn[Vn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vn[Vn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vn[Vn.ABORTED=10]="ABORTED",Vn[Vn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vn[Vn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vn[Vn.INTERNAL=13]="INTERNAL",Vn[Vn.UNAVAILABLE=14]="UNAVAILABLE",Vn[Vn.DATA_LOSS=15]="DATA_LOSS";class MO{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Km}static getOrCreateInstance(){return null===Km&&(Km=new MO),Km}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let Km=null;const WPe=new c5([4294967295,4294967295],0);function oY(r){const e=function sY(){return new TextEncoder}().encode(r),t=new FSe;return t.update(e),new Uint8Array(t.digest())}function aY(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new c5([t,n],0),new c5([i,s],0)]}class EO{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new C9(`Invalid padding: ${t}`);if(n<0)throw new C9(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new C9(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new C9(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=c5.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(c5.fromNumber(n)));return 1===i.compare(WPe)&&(i=new c5([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=oY(e),[n,i]=aY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);if(!this.At(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new EO(s,i,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(0===this.It)return;const t=oY(e),[n,i]=aY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);this.Rt(o)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class C9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class y9{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,M9.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new y9(vt.min(),i,new x1(qt),zs(),rn())}}class M9{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new M9(n,t,rn(),rn(),rn())}}class Xm{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class cY{constructor(e,t){this.targetId=e,this.Vt=t}}class lY{constructor(e,t,n=d2.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class uY{constructor(){this.St=0,this.Dt=dY(),this.Ct=d2.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=rn(),t=rn(),n=rn();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:ot()}}),new M9(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=dY()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class qPe{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=zs(),this.zt=fY(),this.Wt=new x1(qt)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:ot()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((n,i)=>{this.te(i)&&t(i)})}ne(e){var t;const n=e.targetId,i=e.Vt.count,s=this.se(n);if(s){const o=s.target;if(Bm(o))if(0===i){const a=new Ge(o.path);this.Yt(n,a,$1.newNoDocument(a,vt.min()))}else gt(1===i);else{const a=this.ie(n);if(a!==i){const c=this.re(e,a);0!==c&&(this.ee(n),this.Wt=this.Wt.insert(n,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=MO.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(l,f,d){var m,E,w,R,z,$;const G={localCacheCount:f,existenceFilterCount:d.count},de=d.unchangedNames;return de&&(G.bloomFilter={applied:0===l,hashCount:null!==(m=de?.hashCount)&&void 0!==m?m:0,bitmapLength:null!==(R=null===(w=null===(E=de?.bits)||void 0===E?void 0:E.bitmap)||void 0===w?void 0:w.length)&&void 0!==R?R:0,padding:null!==($=null===(z=de?.bits)||void 0===z?void 0:z.padding)&&void 0!==$?$:0}),G}(c,a,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=n;let c,l;try{c=H3(s).toUint8Array()}catch(f){if(f instanceof _Z)return Oa("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw f}try{l=new EO(c,o,a)}catch(f){return Oa(f instanceof C9?"BloomFilter error: ":"Applying bloom filter failed: ",f),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach(s=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.vt(a)||(this.Yt(e,s,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((s,o)=>{const a=this.se(o);if(a){if(s.current&&Bm(a.target)){const c=new Ge(a.target.path);null!==this.jt.get(c)||this.ae(o,c)||this.Yt(o,c,$1.newNoDocument(c,e))}s.Mt&&(t.set(o,s.Ot()),s.Ft())}});let n=rn();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.se(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const i=new y9(e,t,this.Wt,this.jt,n);return this.jt=zs(),this.zt=fY(),this.Wt=new x1(qt),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new uY,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new F1(qt),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new uY),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function fY(){return new x1(Ge.comparator)}function dY(){return new x1(Ge.comparator)}const jPe={asc:"ASCENDING",desc:"DESCENDING"},ZPe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},YPe={and:"AND",or:"OR"};class KPe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function SO(r,e){return r.useProto3Json||o9(e)?e:{value:e}}function y5(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hY(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function XPe(r,e){return y5(r,e.toTimestamp())}function Gr(r){return gt(!!r),vt.fromTimestamp(function(e){const t=tl(e);return new cr(t.seconds,t.nanos)}(r))}function PO(r,e){return(t=r,new Hn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function pY(r){const e=Hn.fromString(r);return gt(SY(e)),e}function E9(r,e){return PO(r.databaseId,e.path)}function Ic(r,e){const t=pY(e);if(t.get(1)!==r.databaseId.projectId)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ge(mY(t))}function TO(r,e){return PO(r.databaseId,e)}function S9(r){return new Hn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function mY(r){return gt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function _Y(r,e,t){return{name:E9(r,e),fields:t.value.mapValue.fields}}function CY(r,e){return{documents:[TO(r,e.path)]}}function bO(r,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=TO(r,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=TO(r,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(0!==c.length)return EY(d1.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(c){if(0!==c.length)return c.map(l=>{return{field:ol((f=l).field),direction:nTe(f.dir)};var f})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=SO(r,e.limit);var a,c;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(c=e.endAt).inclusive,values:c.position}),t}function yY(r){let e=function gY(r){const e=pY(r);return 4===e.length?Hn.emptyPath():mY(e)}(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){gt(1===n);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(f){const d=MY(f);return d instanceof d1&&lO(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(f=>{return new h5(M5((d=f).field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction));var d}));let a=null;t.limit&&(a=function(f){let d;return d="object"==typeof f?f.value:f,o9(d)?null:d}(t.limit));let c=null;var f;t.startAt&&(c=new sl((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new sl(f.values||[],!f.before)}(t.endAt)),function zZ(r,e,t,n,i,s,o,a){return new V3(r,e,t,n,i,s,o,a)}(e,i,o,s,a,"F",c,l)}function MY(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=M5(e.unaryFilter.field);return En.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=M5(e.unaryFilter.field);return En.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=M5(e.unaryFilter.field);return En.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=M5(e.unaryFilter.field);return En.create(s,"!=",{nullValue:"NULL_VALUE"});default:return ot()}}(r):void 0!==r.fieldFilter?En.create(M5((e=r).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ot()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==r.compositeFilter?function(e){return d1.create(e.compositeFilter.filters.map(t=>MY(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return ot()}}(e.compositeFilter.op))}(r):ot();var e}function nTe(r){return jPe[r]}function rTe(r){return ZPe[r]}function iTe(r){return YPe[r]}function ol(r){return{fieldPath:r.canonicalString()}}function M5(r){return $r.fromServerFormat(r.fieldPath)}function EY(r){return r instanceof En?function(e){if("=="===e.op){if(yZ(e.value))return{unaryFilter:{field:ol(e.field),op:"IS_NAN"}};if(CZ(e.value))return{unaryFilter:{field:ol(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(yZ(e.value))return{unaryFilter:{field:ol(e.field),op:"IS_NOT_NAN"}};if(CZ(e.value))return{unaryFilter:{field:ol(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ol(e.field),op:rTe(e.op),value:e.value}}}(r):r instanceof d1?function(e){const t=e.getFilters().map(n=>EY(n));return 1===t.length?t[0]:{compositeFilter:{op:iTe(e.op),filters:t}}}(r):ot()}function sTe(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function SY(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class G3{constructor(e,t,n,i,s=vt.min(),o=vt.min(),a=d2.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new G3(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new G3(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new G3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new G3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class PY{constructor(e){this.fe=e}}function wO(r){const e=yY({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?qm(e,e.limit,"L"):e}class X6{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Pr(e.integerValue));else if("doubleValue"in e){const n=Pr(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),a9(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(H3(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?MZ(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):ot()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const i of Object.keys(n))this.Te(i,t),this.me(n[i],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const i of n)this.me(i,t)}ve(e,t){this.ye(t,37),Ge.fromName(e).path.forEach(n=>{this.ye(t,60),this.be(n,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}X6.Ve=new X6;class pTe{constructor(){this.rn=new LO}addToCollectionParentIndex(e,t){return this.rn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(uo.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(uo.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class LO{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new F1(Hn.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new F1(Hn.comparator)).toArray()}}new Uint8Array(0);class zi{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new zi(e,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}zi.DEFAULT_COLLECTION_PERCENTILE=10,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zi.DEFAULT=new zi(41943040,zi.DEFAULT_COLLECTION_PERCENTILE,zi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zi.DISABLED=new zi(-1,0,0);class J6{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new J6(0)}static Mn(){return new J6(-1)}}class yTe{constructor(){this.changes=new F3(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$1.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class STe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class KY{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&v9(n.mutation,i,Rs.empty(),cr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,rn()).next(()=>n))}getLocalViewOfDocuments(e,t,n=rn()){const i=Ac();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=g9();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Ac();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,rn()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,i){let s=zs();const o=m9(),a=m9();return t.forEach((c,l)=>{const f=n.get(l.key);i.has(l.key)&&(void 0===f||f.mutation instanceof $3)?s=s.insert(l.key,l):void 0!==f?(o.set(l.key,f.mutation.getFieldMask()),v9(f.mutation,l,f.mutation.getFieldMask(),cr.now())):o.set(l.key,Rs.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>o.set(l,f)),t.forEach((l,f)=>{var d;return a.set(l,new STe(f,null!==(d=o.get(l))&&void 0!==d?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=m9();let i=new x1((o,a)=>o-a),s=rn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=t.get(c);if(null===l)return;let f=n.get(c)||Rs.empty();f=a.applyToLocalView(l,f),n.set(c,f);const d=(i.get(a.batchId)||rn()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,f=c.value,d=BZ();f.forEach(m=>{if(!s.has(m)){const E=QZ(t.get(m),n.get(m));null!==E&&d.set(m,E),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return Ge.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):hO(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var i}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ce.resolve(Ac());let a=-1,c=s;return o.next(l=>ce.forEach(l,(f,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(f)?ce.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,rn())).next(f=>({batchId:a,changes:GZ(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ge(t)).next(n=>{let i=g9();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let s=g9();return this.indexManager.getCollectionParents(e,i).next(o=>ce.forEach(o,a=>{const c=(l=t,f=a.child(i),new V3(f,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,f;return this.getDocumentsMatchingCollectionQuery(e,c,n).next(l=>{l.forEach((f,d)=>{s=s.insert(f,d)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i))).next(s=>{i.forEach((a,c)=>{const l=c.getKey();null===s.get(l)&&(s=s.insert(l,$1.newInvalidDocument(l)))});let o=g9();return s.forEach((a,c)=>{const l=i.get(a);void 0!==l&&v9(l.mutation,c,Rs.empty(),cr.now()),p9(t,c)&&(o=o.insert(a,c))}),o})}}class PTe{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ce.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Gr(n.createTime)}),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:wO(n.bundledQuery),readTime:Gr(n.readTime)}),ce.resolve();var n}}class TTe{constructor(){this.overlays=new x1(Ge.comparator),this.ls=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ac();return ce.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.we(e,t,s)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=Ac(),s=t.length+1,o=new Ge(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new x1((l,f)=>l-f);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=s.get(l.largestBatchId);null===f&&(f=Ac(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const a=Ac(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>a.set(l,f)),!(a.size()>=i)););return ce.resolve(a)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const o=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new yO(t,n));let s=this.ls.get(t);void 0===s&&(s=rn(),this.ls.set(t,s)),this.ls.set(t,s.add(n.key))}}class RO{constructor(){this.fs=new F1(L2.ds),this.ws=new F1(L2._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new L2(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.ys(new L2(e,t))}ps(e,t){e.forEach(n=>this.removeReference(n,t))}Is(e){const t=new Ge(new Hn([])),n=new L2(t,e),i=new L2(t,e+1),s=[];return this.ws.forEachInRange([n,i],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Ge(new Hn([])),n=new L2(t,e),i=new L2(t,e+1);let s=rn();return this.ws.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new L2(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class L2{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Ge.comparator(e.key,t.key)||qt(e.As,t.As)}static _s(e,t){return qt(e.As,t.As)||Ge.comparator(e.key,t.key)}}class OTe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new F1(L2.ds)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.vs;this.vs++;const o=new vO(s,t,n,i);this.mutationQueue.push(o);for(const a of i)this.Rs=this.Rs.add(new L2(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),s=i<0?0:i;return ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new L2(t,0),i=new L2(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,i],o=>{const a=this.Ps(o.As);s.push(a)}),ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new F1(qt);return t.forEach(i=>{const s=new L2(i,0),o=new L2(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{n=n.add(a.As)})}),ce.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;Ge.isDocumentKey(s)||(s=s.child(""));const o=new L2(new Ge(s),0);let a=new F1(qt);return this.Rs.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.As)),!0)},o),ce.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(n=>{const i=this.Ps(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){gt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ce.forEach(t.mutations,i=>{const s=new L2(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new L2(t,0),i=this.Rs.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ce.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class bTe{constructor(e){this.Ds=e,this.docs=new x1(Ge.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():$1.newInvalidDocument(t))}getEntries(e,t){let n=zs();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():$1.newInvalidDocument(i))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=zs();const o=t.path,a=new Ge(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||nO(iZ(f),n)<=0||(i.has(f.key)||p9(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ce.resolve(s)}getAllFromCollectionGroup(e,t,n,i){ot()}Cs(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new wTe(this)}getSize(e){return ce.resolve(this.size)}}class wTe extends yTe{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class NTe{constructor(e){this.persistence=e,this.xs=new F3(t=>U6(t),d9),this.lastRemoteSnapshotVersion=vt.min(),this.highestTargetId=0,this.Ns=0,this.ks=new RO,this.targetCount=0,this.Ms=J6.kn()}forEachTarget(e,t){return this.xs.forEach((n,i)=>t(i)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ce.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new J6(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Fn(t),ce.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ce.waitFor(s).next(()=>i)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ce.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this.ks.containsKey(t))}}class zO{constructor(e,t){this.$s={},this.overlays={},this.Os=new fo(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new NTe(this),this.indexManager=new pTe,this.remoteDocumentCache=new bTe(n=>this.referenceDelegate.Ls(n)),this.serializer=new PY(t),this.qs=new PTe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new TTe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new OTe(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Oe("MemoryPersistence","Starting transaction:",e);const i=new ATe(this.Os.next());return this.referenceDelegate.Us(),n(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,t){return ce.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class ATe extends XSe{constructor(e){super(),this.currentSequenceNumber=e}}class o_{constructor(e){this.persistence=e,this.Qs=new RO,this.js=null}static zs(e){return new o_(e)}get Ws(){if(this.js)return this.js;throw ot()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Ws,n=>{const i=Ge.fromPath(n);return this.Hs(e,i).next(s=>{s||t.removeEntry(i,vt.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(n=>{n?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ce.or([()=>ce.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class FO{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=rn(),i=rn();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new FO(e,t.fromCache,n,i)}}class QY{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next(s=>s||this.Gi(e,t,i,n)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(DZ(t))return ce.resolve(null);let n=fs(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=qm(t,null,"F"),n=fs(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=rn(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ji(t,a);return this.zi(t,l,o,c.readTime)?this.Ki(e,qm(t,null,"F")):this.Wi(e,l,t,c)}))})))}Gi(e,t,n,i){return DZ(t)||i.isEqual(vt.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(s=>{const o=this.ji(t,s);return this.zi(t,o,n,i)?this.Qi(e,t):(JT()<=Un.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),gO(t)),this.Wi(e,o,t,function rZ(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=vt.fromTimestamp(1e9===n?new cr(t+1,0):new cr(t,n));return new uo(i,Ge.empty(),e)}(i,-1)))})}ji(e,t){let n=new F1(FZ(e));return t.forEach((i,s)=>{p9(e,s)&&(n=n.add(s))}),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,t){return JT()<=Un.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",gO(t)),this.Ui.getDocumentsMatchingQuery(e,t,uo.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class kTe{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new x1(qt),this.Yi=new F3(s=>U6(s),d9),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new KY(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function eK(r,e){return $O.apply(this,arguments)}function $O(){return $O=M(function*(r,e){const t=qe(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.tr(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let c=rn();for(const l of i){o.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of s){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({er:l,removedBatchIds:o,addedBatchIds:a}))})})}),$O.apply(this,arguments)}function tK(r){const e=qe(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function RTe(r,e){const t=qe(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function T5(r,e,t){return GO.apply(this,arguments)}function GO(){return GO=M(function*(r,e,t){const n=qe(r),i=n.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!J4(o))throw o;Oe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(i.target)}),GO.apply(this,arguments)}function l_(r,e,t){const n=qe(r);let i=vt.min(),s=rn();return n.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const f=qe(a),d=f.Yi.get(l);return void 0!==d?ce.resolve(f.Ji.get(d)):f.Bs.getTargetData(c,l)}(n,o,fs(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>n.Hi.getDocumentsMatchingQuery(o,e,t?i:vt.min(),t?s:rn())).next(a=>(function sK(r,e,t){let n=r.Xi.get(e)||vt.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Xi.set(e,n)}(n,function VZ(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(e),a),{documents:a,ir:s})))}class jO{constructor(){this.activeTargetIds=function mO(){return zPe}()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cK{constructor(){this.Hr=new jO,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new jO,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class HTe{Yr(e){}shutdown(){}}class lK{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Oe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Oe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let d_=null;function YO(){return null===d_?d_=268435456+Math.round(2147483648*Math.random()):d_++,"0x"+d_.toString(16)}const VTe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class FTe{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const Di="WebChannelConnection";class $Te extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,s){const o=YO(),a=this.To(e,t);Oe("RestConnection",`Sending RPC '${e}' ${o}:`,a,n);const c={};return this.Eo(c,i,s),this.Ao(e,a,c,n).then(l=>(Oe("RestConnection",`Received RPC '${e}' ${o}: `,l),l),l=>{throw Oa("RestConnection",`RPC '${e}' ${o} failed with error: `,l,"url: ",a,"request:",n),l})}vo(e,t,n,i,s,o){return this.Io(e,t,n,i,s)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+l5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}To(e,t){return`${this.mo}/v1/${t}:${VTe[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const s=YO();return new Promise((o,a)=>{const c=new VSe;c.setWithCredentials(!0),c.listenOnce(zSe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case QT.NO_ERROR:const f=c.getResponseJson();Oe(Di,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case QT.TIMEOUT:Oe(Di,`RPC '${e}' ${s} timed out`),a(new Te(fe.DEADLINE_EXCEEDED,"Request time out"));break;case QT.HTTP_ERROR:const d=c.getStatus();if(Oe(Di,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const E=m?.error;if(E&&E.status&&E.message){const w=function(R){const z=R.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(z)>=0?z:fe.UNKNOWN}(E.status);a(new Te(w,E.message))}else a(new Te(fe.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Te(fe.UNAVAILABLE,"Connection failed."));break;default:ot()}}finally{Oe(Di,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);Oe(Di,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Ro(e,t,n){const i=YO(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=LSe(),a=RSe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new HSe({})),this.Eo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const f=s.join("");Oe(Di,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=o.createWebChannel(f,c);let m=!1,E=!1;const w=new FTe({ro:z=>{E?Oe(Di,`Not sending because RPC '${e}' stream ${i} is closed:`,z):(m||(Oe(Di,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),Oe(Di,`RPC '${e}' stream ${i} sending:`,z),d.send(z))},oo:()=>d.close()}),R=(z,$,G)=>{z.listen($,de=>{try{G(de)}catch(ve){setTimeout(()=>{throw ve},0)}})};return R(d,km.EventType.OPEN,()=>{E||Oe(Di,`RPC '${e}' stream ${i} transport opened.`)}),R(d,km.EventType.CLOSE,()=>{E||(E=!0,Oe(Di,`RPC '${e}' stream ${i} transport closed`),w.wo())}),R(d,km.EventType.ERROR,z=>{E||(E=!0,Oa(Di,`RPC '${e}' stream ${i} transport errored:`,z),w.wo(new Te(fe.UNAVAILABLE,"The operation could not be completed")))}),R(d,km.EventType.MESSAGE,z=>{var $;if(!E){const G=z.data[0];gt(!!G);const ve=G.error||(null===($=G[0])||void 0===$?void 0:$.error);if(ve){Oe(Di,`RPC '${e}' stream ${i} received error:`,ve);const xe=ve.status;let tt=function(Cn){const Mt=Jr[Cn];if(void 0!==Mt)return iY(Mt)}(xe),pt=ve.message;void 0===tt&&(tt=fe.INTERNAL,pt="Unknown error status: "+xe+" with message "+ve.message),E=!0,w.wo(new Te(tt,pt)),d.close()}else Oe(Di,`RPC '${e}' stream ${i} received:`,G),w._o(G)}}),R(a,DSe.STAT_EVENT,z=>{z.stat===Xj.PROXY?Oe(Di,`RPC '${e}' stream ${i} detected buffering proxy`):z.stat===Xj.NOPROXY&&Oe(Di,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}}function h_(){return typeof document<"u"?document:null}function x9(r){return new KPe(r,!0)}class KO{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&Oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class fK{constructor(e,t,n,i,s,o,a,c){this.ii=e,this.$o=n,this.Oo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new KO(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return M(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return M(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var n=this;return M(function*(){n.Ho(),n.Jo(),n.qo.cancel(),n.Fo++,4!==e?n.qo.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(Fr(t.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),n.qo.xo()):t&&t.code===fe.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Yo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Fo===t&&this.Zo(n,i)},n=>{e(()=>{const i=new Te(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(i)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{n(()=>this.tu(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No(M(function*(){e.state=0,e.start()}))}tu(e){return Oe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Oe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class GTe extends fK{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function JPe(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:ot(),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(gt(void 0===l||"string"==typeof l),d2.fromBase64String(l||"")):(gt(void 0===l||l instanceof Uint8Array),d2.fromUint8Array(l||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=void 0===c.code?fe.UNKNOWN:iY(c.code);return new Te(l,c.message||"")}(o);t=new lY(n,i,s,a||null)}else if("documentChange"in e){const n=e.documentChange,i=Ic(r,n.document.name),s=Gr(n.document.updateTime),o=n.document.createTime?Gr(n.document.createTime):vt.min(),a=new ai({mapValue:{fields:n.document.fields}}),c=$1.newFoundDocument(i,s,o,a);t=new Xm(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,i=Ic(r,n.document),s=n.readTime?Gr(n.readTime):vt.min(),o=$1.newNoDocument(i,s);t=new Xm([],n.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const n=e.documentRemove,i=Ic(r,n.document);t=new Xm([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ot();{const n=e.filter,{count:i=0,unchangedNames:s}=n,o=new UPe(i,s);t=new cY(n.targetId,o)}}var c;return t}(this.serializer,e),n=function(i){if(!("targetChange"in i))return vt.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?vt.min():s.readTime?Gr(s.readTime):vt.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=S9(this.serializer),t.addTarget=function(i,s){let o;const a=s.target;if(o=Bm(a)?{documents:CY(i,a)}:{query:bO(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=hY(i,s.resumeToken);const c=SO(i,s.expectedCount);null!==c&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(vt.min())>0){o.readTime=y5(i,s.snapshotVersion.toTimestamp());const c=SO(i,s.expectedCount);null!==c&&(o.expectedCount=c)}return o}(this.serializer,e);const n=function tTe(r,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ot()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=S9(this.serializer),t.removeTarget=e,this.Wo(t)}}class BTe extends fK{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(gt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function eTe(r,e){return r&&r.length>0?(gt(void 0!==e),r.map(t=>function(n,i){let s=Gr(n.updateTime?n.updateTime:i);return s.isEqual(vt.min())&&(s=Gr(i)),new FPe(s,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Gr(e.commitTime);return this.listener.cu(n,t)}return gt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=S9(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function P9(r,e){let t;if(e instanceof v5)t={update:_Y(r,e.key,e.value)};else if(e instanceof C5)t={delete:E9(r,e.key)};else if(e instanceof $3)t={update:_Y(r,e.key,e.data),updateMask:sTe(e.fieldMask)};else{if(!(e instanceof _O))return ot();t={verify:E9(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,s){const o=s.transform;if(o instanceof m5)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof q6)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof j6)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof _5)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw ot()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:XPe(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ot()),t;var i}(this.serializer,n))};this.Wo(t)}}class UTe extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,t,n,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(fe.UNKNOWN,i.toString())})}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,t,n,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(fe.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class qTe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Fr(t),this.mu=!1):Oe("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class jTe{constructor(e,t,n,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(a=>{n.enqueueAndForget(M(function*(){var c;ul(o)&&(Oe("RemoteStore","Restarting streams for network reachability change."),yield(c=M(function*(l){const f=qe(l);f.vu.add(4),yield O5(f),f.bu.set("Unknown"),f.vu.delete(4),yield L9(f)}),function(l){return c.apply(this,arguments)})(o))}))}),this.bu=new qTe(n,i)}}function L9(r){return QO.apply(this,arguments)}function QO(){return QO=M(function*(r){if(ul(r))for(const e of r.Ru)yield e(!0)}),QO.apply(this,arguments)}function O5(r){return JO.apply(this,arguments)}function JO(){return JO=M(function*(r){for(const e of r.Ru)yield e(!1)}),JO.apply(this,arguments)}function p_(r,e){const t=qe(r);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),nb(t)?tb(t):w5(t).Ko()&&eb(t,e))}function R9(r,e){const t=qe(r),n=w5(t);t.Au.delete(e),n.Ko()&&dK(t,e),0===t.Au.size&&(n.Ko()?n.jo():ul(t)&&t.bu.set("Unknown"))}function eb(r,e){if(r.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(vt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}w5(r).su(e)}function dK(r,e){r.Vu.qt(e),w5(r).iu(e)}function tb(r){r.Vu=new qPe({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),le:e=>r.Au.get(e)||null,ue:()=>r.datastore.serializer.databaseId}),w5(r).start(),r.bu.gu()}function nb(r){return ul(r)&&!w5(r).Uo()&&r.Au.size>0}function ul(r){return 0===qe(r).vu.size}function hK(r){r.Vu=void 0}function ZTe(r){return rb.apply(this,arguments)}function rb(){return rb=M(function*(r){r.Au.forEach((e,t)=>{eb(r,e)})}),rb.apply(this,arguments)}function YTe(r,e){return ib.apply(this,arguments)}function ib(){return ib=M(function*(r,e){hK(r),nb(r)?(r.bu.Iu(e),tb(r)):r.bu.set("Unknown")}),ib.apply(this,arguments)}function KTe(r,e,t){return sb.apply(this,arguments)}function sb(){return sb=M(function*(r,e,t){if(r.bu.set("Online"),e instanceof lY&&2===e.state&&e.cause)try{yield(n=M(function*(i,s){const o=s.cause;for(const a of s.targetIds)i.Au.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.Au.delete(a),i.Vu.removeTarget(a))}),function(i,s){return n.apply(this,arguments)})(r,e)}catch(n){Oe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield g_(r,n)}else if(e instanceof Xm?r.Vu.Ht(e):e instanceof cY?r.Vu.ne(e):r.Vu.Xt(e),!t.isEqual(vt.min()))try{const n=yield tK(r.localStore);t.compareTo(n)>=0&&(yield function(i,s){const o=i.Vu.ce(s);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=i.Au.get(c);l&&i.Au.set(c,l.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,c)=>{const l=i.Au.get(a);if(!l)return;i.Au.set(a,l.withResumeToken(d2.EMPTY_BYTE_STRING,l.snapshotVersion)),dK(i,a);const f=new G3(l.target,a,c,l.sequenceNumber);eb(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(r,t))}catch(n){Oe("RemoteStore","Failed to raise snapshot:",n),yield g_(r,n)}var n}),sb.apply(this,arguments)}function g_(r,e,t){return ob.apply(this,arguments)}function ob(){return ob=M(function*(r,e,t){if(!J4(e))throw e;r.vu.add(1),yield O5(r),r.bu.set("Offline"),t||(t=()=>tK(r.localStore)),r.asyncQueue.enqueueRetryable(M(function*(){Oe("RemoteStore","Retrying IndexedDB access"),yield t(),r.vu.delete(1),yield L9(r)}))}),ob.apply(this,arguments)}function pK(r,e){return e().catch(t=>g_(r,t,e))}function b5(r){return ab.apply(this,arguments)}function ab(){return ab=M(function*(r){const e=qe(r),t=fl(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;XTe(e);)try{const i=yield RTe(e.localStore,n);if(null===i){0===e.Eu.length&&t.jo();break}n=i.batchId,QTe(e,i)}catch(i){yield g_(e,i)}gK(e)&&mK(e)}),ab.apply(this,arguments)}function XTe(r){return ul(r)&&r.Eu.length<10}function QTe(r,e){r.Eu.push(e);const t=fl(r);t.Ko()&&t.ou&&t.uu(e.mutations)}function gK(r){return ul(r)&&!fl(r).Uo()&&r.Eu.length>0}function mK(r){fl(r).start()}function JTe(r){return cb.apply(this,arguments)}function cb(){return cb=M(function*(r){fl(r).hu()}),cb.apply(this,arguments)}function eOe(r){return lb.apply(this,arguments)}function lb(){return lb=M(function*(r){const e=fl(r);for(const t of r.Eu)e.uu(t.mutations)}),lb.apply(this,arguments)}function tOe(r,e,t){return ub.apply(this,arguments)}function ub(){return ub=M(function*(r,e,t){const n=r.Eu.shift(),i=CO.from(n,e,t);yield pK(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield b5(r)}),ub.apply(this,arguments)}function nOe(r,e){return fb.apply(this,arguments)}function fb(){return fb=M(function*(r,e){var t;e&&fl(r).ou&&(yield(t=M(function*(n,i){if(function rY(r){switch(r){default:return ot();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}(s=i.code)&&s!==fe.ABORTED){const o=n.Eu.shift();fl(n).Qo(),yield pK(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield b5(n)}var s}),function(n,i){return t.apply(this,arguments)})(r,e)),gK(r)&&mK(r)}),fb.apply(this,arguments)}function _K(r,e){return db.apply(this,arguments)}function db(){return db=M(function*(r,e){const t=qe(r);t.asyncQueue.verifyOperationInProgress(),Oe("RemoteStore","RemoteStore received new credentials");const n=ul(t);t.vu.add(3),yield O5(t),n&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield L9(t)}),db.apply(this,arguments)}function pb(){return pb=M(function*(r,e){const t=qe(r);e?(t.vu.delete(2),yield L9(t)):e||(t.vu.add(2),yield O5(t),t.bu.set("Unknown"))}),pb.apply(this,arguments)}function w5(r){return r.Su||(r.Su=function(e,t,n){const i=qe(e);return i.fu(),new GTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:ZTe.bind(null,r),ao:YTe.bind(null,r),nu:KTe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Su.Qo(),nb(r)?tb(r):r.bu.set("Unknown")):(yield r.Su.stop(),hK(r))});return function(t){return e.apply(this,arguments)}}())),r.Su}function fl(r){return r.Du||(r.Du=function(e,t,n){const i=qe(e);return i.fu(),new BTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:JTe.bind(null,r),ao:nOe.bind(null,r),au:eOe.bind(null,r),cu:tOe.bind(null,r)}),r.Ru.push(function(){var e=M(function*(t){t?(r.Du.Qo(),yield b5(r)):(yield r.Du.stop(),r.Eu.length>0&&(Oe("RemoteStore",`Stopping write stream with ${r.Eu.length} pending writes`),r.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),r.Du}class gb{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new f2,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,a=new gb(e,t,o,i,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Te(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N5(r,e){if(Fr("AsyncQueue",`${e}: ${r}`),J4(r))return new Te(fe.UNAVAILABLE,`${e}: ${r}`);throw r}class A5{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ge.comparator(t.key,n.key):(t,n)=>Ge.comparator(t.key,n.key),this.keyedMap=g9(),this.sortedSet=new x1(this.comparator)}static emptySet(e){return new A5(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof A5)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new A5;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class vK{constructor(){this.Cu=new x1(Ge.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):ot():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class I5{constructor(e,t,n,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new I5(e,t,A5.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&h9(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class rOe{constructor(){this.Nu=void 0,this.listeners=[]}}class iOe{constructor(){this.queries=new F3(e=>HZ(e),h9),this.onlineState="Unknown",this.ku=new Set}}function mb(r,e){return _b.apply(this,arguments)}function _b(){return _b=M(function*(r,e){const t=qe(r),n=e.query;let i=!1,s=t.queries.get(n);if(s||(i=!0,s=new rOe),i)try{s.Nu=yield t.onListen(n)}catch(o){const a=N5(o,`Initialization of query '${gO(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&yb(t)}),_b.apply(this,arguments)}function vb(r,e){return Cb.apply(this,arguments)}function Cb(){return Cb=M(function*(r,e){const t=qe(r),n=e.query;let i=!1;const s=t.queries.get(n);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return t.queries.delete(n),t.onUnlisten(n)}),Cb.apply(this,arguments)}function sOe(r,e){const t=qe(r);let n=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.listeners)a.$u(i)&&(n=!0);o.Nu=i}}n&&yb(t)}function oOe(r,e,t){const n=qe(r),i=n.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);n.queries.delete(e)}function yb(r){r.ku.forEach(e=>{e.next()})}class Mb{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new I5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=I5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class MK{constructor(e){this.key=e}}class EK{constructor(e){this.key=e}}class SK{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=rn(),this.mutatedKeys=rn(),this.tc=FZ(e),this.ec=new A5(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new vK,i=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const m=i.get(f),E=p9(this.query,d)?d:null,w=!!m&&this.mutatedKeys.has(m.key),R=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let z=!1;m&&E?m.data.isEqual(E.data)?w!==R&&(n.track({type:3,doc:E}),z=!0):this.rc(m,E)||(n.track({type:2,doc:E}),z=!0,(c&&this.tc(E,c)>0||l&&this.tc(E,l)<0)&&(a=!0)):!m&&E?(n.track({type:0,doc:E}),z=!0):m&&!E&&(n.track({type:1,doc:m}),z=!0,(c||l)&&(a=!0)),z&&(E?(o=o.add(E),s=R?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{ec:o,ic:n,zi:a,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((l,f)=>function(d,m){const E=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot()}};return E(d)-E(m)}(l.type,f.type)||this.tc(l.doc,f.doc)),this.oc(n);const o=t?this.uc():[],a=0===this.Zu.size&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,0!==s.length||c?{snapshot:new I5(this.query,e.ec,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new vK,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=rn(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const t=[];return e.forEach(n=>{this.Zu.has(n)||t.push(new EK(n))}),this.Zu.forEach(n=>{e.has(n)||t.push(new MK(n))}),t}hc(e){this.Yu=e.ir,this.Zu=rn();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return I5.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class lOe{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class uOe{constructor(e){this.key=e,this.fc=!1}}class fOe{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new F3(a=>HZ(a),h9),this._c=new Map,this.mc=new Set,this.gc=new x1(Ge.comparator),this.yc=new Map,this.Ic=new RO,this.Tc={},this.Ec=new Map,this.Ac=J6.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function dOe(r,e){return Eb.apply(this,arguments)}function Eb(){return Eb=M(function*(r,e){const t=function Wb(r){const e=qe(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=PK.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=MOe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gOe.bind(null,e),e.dc.nu=sOe.bind(null,e.eventManager),e.dc.Pc=oOe.bind(null,e.eventManager),e}(r);let n,i;const s=t.wc.get(e);if(s)n=s.targetId,t.sharedClientState.addLocalQueryTarget(n),i=s.view.lc();else{const o=yield function P5(r,e){const t=qe(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Bs.getTargetData(n,e).next(s=>s?(i=s,ce.resolve(i)):t.Bs.allocateTargetId(n).next(o=>(i=new G3(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Bs.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ji.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(n.targetId,n),t.Yi.set(e,n.targetId)),n})}(t.localStore,fs(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,i=yield function Sb(r,e,t,n,i){return Pb.apply(this,arguments)}(t,e,n,"current"===a,o.resumeToken),t.isPrimaryClient&&p_(t.remoteStore,o)}return i}),Eb.apply(this,arguments)}function Pb(){return Pb=M(function*(r,e,t,n,i){r.Rc=(d,m,E)=>{return(w=M(function*(R,z,$,G){let de=z.view.sc($);de.zi&&(de=yield l_(R.localStore,z.query,!1).then(({documents:tt})=>z.view.sc(tt,de)));const ve=G&&G.targetChanges.get(z.targetId),xe=z.view.applyChanges(de,R.isPrimaryClient,ve);return Lb(R,z.targetId,xe.cc),xe.snapshot}),function(R,z,$,G){return w.apply(this,arguments)})(r,d,m,E);var w};const s=yield l_(r.localStore,e,!0),o=new SK(e,s.ir),a=o.sc(s.documents),c=M9.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),l=o.applyChanges(a,r.isPrimaryClient,c);Lb(r,t,l.cc);const f=new lOe(e,t,o);return r.wc.set(e,f),r._c.has(t)?r._c.get(t).push(e):r._c.set(t,[e]),l.snapshot}),Pb.apply(this,arguments)}function hOe(r,e){return Tb.apply(this,arguments)}function Tb(){return Tb=M(function*(r,e){const t=qe(r),n=t.wc.get(e),i=t._c.get(n.targetId);if(i.length>1)return t._c.set(n.targetId,i.filter(s=>!h9(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield T5(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),R9(t.remoteStore,n.targetId),k5(t,n.targetId)}).catch(Q4))):(k5(t,n.targetId),yield T5(t.localStore,n.targetId,!0))}),Tb.apply(this,arguments)}function Ob(){return Ob=M(function*(r,e,t){const n=function qb(r){const e=qe(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mOe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_Oe.bind(null,e),e}(r);try{const i=yield function(s,o){const a=qe(s),c=cr.now(),l=o.reduce((m,E)=>m.add(E.key),rn());let f,d;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=zs(),w=rn();return a.Zi.getEntries(m,l).next(R=>{E=R,E.forEach((z,$)=>{$.isValidDocument()||(w=w.add(z))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,E)).next(R=>{f=R;const z=[];for(const $ of o){const G=GPe($,f.get($.key).overlayedDocument);null!=G&&z.push(new $3($.key,G,PZ(G.value.mapValue),er.exists(!0)))}return a.mutationQueue.addMutationBatch(m,c,z,o)}).next(R=>{d=R;const z=R.applyToLocalDocumentSet(f,w);return a.documentOverlayCache.saveOverlays(m,R.batchId,z)})}).then(()=>({batchId:d.batchId,changes:GZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let c=s.Tc[s.currentUser.toKey()];c||(c=new x1(qt)),c=c.insert(o,a),s.Tc[s.currentUser.toKey()]=c}(n,i.batchId,t),yield B3(n,i.changes),yield b5(n.remoteStore)}catch(i){const s=N5(i,"Failed to persist write");t.reject(s)}}),Ob.apply(this,arguments)}function PK(r,e){return bb.apply(this,arguments)}function bb(){return bb=M(function*(r,e){const t=qe(r);try{const n=yield function LTe(r,e){const t=qe(r),n=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const a=[];e.targetChanges.forEach((f,d)=>{const m=i.get(d);if(!m)return;a.push(t.Bs.removeMatchingKeys(s,f.removedDocuments,d).next(()=>t.Bs.addMatchingKeys(s,f.addedDocuments,d)));let E=m.withSequenceNumber(s.currentSequenceNumber);var w,R,z;null!==e.targetMismatches.get(d)?E=E.withResumeToken(d2.EMPTY_BYTE_STRING,vt.min()).withLastLimboFreeSnapshotVersion(vt.min()):f.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(f.resumeToken,n)),i=i.insert(d,E),R=E,z=f,(0===(w=m).resumeToken.approximateByteSize()||R.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8||z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0)&&a.push(t.Bs.updateTargetData(s,E))});let c=zs(),l=rn();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(function nK(r,e,t){let n=rn(),i=rn();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=zs();return t.forEach((a,c)=>{const l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(vt.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):Oe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{nr:o,sr:i}})}(s,o,e.documentUpdates).next(f=>{c=f.nr,l=f.sr})),!n.isEqual(vt.min())){const f=t.Bs.getLastRemoteSnapshotVersion(s).next(d=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(f)}return ce.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Ji=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.yc.get(s);o&&(gt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.fc=!0:i.modifiedDocuments.size>0?gt(o.fc):i.removedDocuments.size>0&&(gt(o.fc),o.fc=!1))}),yield B3(t,n,e)}catch(n){yield Q4(n)}}),bb.apply(this,arguments)}function TK(r,e,t){const n=qe(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.wc.forEach((s,o)=>{const a=o.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=qe(s);a.onlineState=o;let c=!1;a.queries.forEach((l,f)=>{for(const d of f.listeners)d.Mu(o)&&(c=!0)}),c&&yb(a)}(n.eventManager,e),i.length&&n.dc.nu(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function gOe(r,e,t){return wb.apply(this,arguments)}function wb(){return wb=M(function*(r,e,t){const n=qe(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.yc.get(e),s=i&&i.key;if(s){let o=new x1(Ge.comparator);o=o.insert(s,$1.newNoDocument(s,vt.min()));const a=rn().add(s),c=new y9(vt.min(),new Map,new x1(qt),o,a);yield PK(n,c),n.gc=n.gc.remove(s),n.yc.delete(e),Rb(n)}else yield T5(n.localStore,e,!1).then(()=>k5(n,e,t)).catch(Q4)}),wb.apply(this,arguments)}function mOe(r,e){return Nb.apply(this,arguments)}function Nb(){return Nb=M(function*(r,e){const t=qe(r),n=e.batch.batchId;try{const i=yield function xTe(r,e){const t=qe(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const f=c.batch,d=f.keys();let m=ce.resolve();return d.forEach(E=>{m=m.next(()=>l.getEntry(a,E)).next(w=>{const R=c.docVersions.get(E);gt(null!==R),w.version.compareTo(R)<0&&(f.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),l.addEntry(w)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(a,f))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let a=rn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);xb(t,n,null),kb(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield B3(t,i)}catch(i){yield Q4(i)}}),Nb.apply(this,arguments)}function _Oe(r,e,t){return Ab.apply(this,arguments)}function Ab(){return Ab=M(function*(r,e,t){const n=qe(r);try{const i=yield function(s,o){const a=qe(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(f=>(gt(null!==f),l=f.keys(),a.mutationQueue.removeMutationBatch(c,f))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(n.localStore,e);xb(n,e,t),kb(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield B3(n,i)}catch(i){yield Q4(i)}}),Ab.apply(this,arguments)}function kb(r,e){(r.Ec.get(e)||[]).forEach(t=>{t.resolve()}),r.Ec.delete(e)}function xb(r,e,t){const n=qe(r);let i=n.Tc[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Tc[n.currentUser.toKey()]=i}}function k5(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r._c.get(e))r.wc.delete(n),t&&r.dc.Pc(n,t);r._c.delete(e),r.isPrimaryClient&&r.Ic.Is(e).forEach(n=>{r.Ic.containsKey(n)||OK(r,n)})}function OK(r,e){r.mc.delete(e.path.canonicalString());const t=r.gc.get(e);null!==t&&(R9(r.remoteStore,t),r.gc=r.gc.remove(e),r.yc.delete(t),Rb(r))}function Lb(r,e,t){for(const n of t)n instanceof MK?(r.Ic.addReference(n.key,e),COe(r,n)):n instanceof EK?(Oe("SyncEngine","Document no longer in limbo: "+n.key),r.Ic.removeReference(n.key,e),r.Ic.containsKey(n.key)||OK(r,n.key)):ot()}function COe(r,e){const t=e.key,n=t.path.canonicalString();r.gc.get(t)||r.mc.has(n)||(Oe("SyncEngine","New document in limbo: "+t),r.mc.add(n),Rb(r))}function Rb(r){for(;r.mc.size>0&&r.gc.size<r.maxConcurrentLimboResolutions;){const e=r.mc.values().next().value;r.mc.delete(e);const t=new Ge(Hn.fromString(e)),n=r.Ac.next();r.yc.set(n,new uOe(t)),r.gc=r.gc.insert(t,n),p_(r.remoteStore,new G3(fs(g5(t.path)),n,"TargetPurposeLimboResolution",fo.ct))}}function B3(r,e,t){return zb.apply(this,arguments)}function zb(){return zb=M(function*(r,e,t){const n=qe(r),i=[],s=[],o=[];var a;n.wc.isEmpty()||(n.wc.forEach((a,c)=>{o.push(n.Rc(c,e,t).then(l=>{if((l||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const f=FO.Li(c.targetId,l);s.push(f)}}))}),yield Promise.all(o),n.dc.nu(i),yield(a=M(function*(c,l){const f=qe(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ce.forEach(l,m=>ce.forEach(m.Fi,E=>f.persistence.referenceDelegate.addReference(d,m.targetId,E)).next(()=>ce.forEach(m.Bi,E=>f.persistence.referenceDelegate.removeReference(d,m.targetId,E)))))}catch(d){if(!J4(d))throw d;Oe("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const E=f.Ji.get(m),R=E.withLastLimboFreeSnapshotVersion(E.snapshotVersion);f.Ji=f.Ji.insert(m,R)}}}),function(c,l){return a.apply(this,arguments)})(n.localStore,s))}),zb.apply(this,arguments)}function yOe(r,e){return Db.apply(this,arguments)}function Db(){return Db=M(function*(r,e){const t=qe(r);if(!t.currentUser.isEqual(e)){Oe("SyncEngine","User change. New user:",e.toKey());const n=yield eK(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(o=>{o.forEach(a=>{a.reject(new Te(fe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield B3(t,n.er)}var i}),Db.apply(this,arguments)}function MOe(r,e){const t=qe(r),n=t.yc.get(e);if(n&&n.fc)return rn().add(n.key);{let i=rn();const s=t._c.get(e);if(!s)return i;for(const o of s){const a=t.wc.get(o);i=i.unionWith(a.view.nc)}return i}}class m_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return M(function*(){t.serializer=x9(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function JY(r,e,t,n){return new kTe(r,e,t,n)}(this.persistence,new QY,e.initialUser,this.serializer)}createPersistence(e){return new zO(o_.zs,this.serializer)}createSharedClientState(e){return new cK}terminate(){var e=this;return M(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class x5{initialize(e,t){var n=this;return M(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>TK(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=yOe.bind(null,n.syncEngine),yield function hb(r,e){return pb.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new iOe}createDatastore(e){const t=x9(e.databaseInfo.databaseId),n=new $Te(e.databaseInfo);return new UTe(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,s=a=>TK(this.syncEngine,a,0),o=lK.D()?new lK:new HTe,new jTe(t,n,i,s,o);var t,n,i,s,o}createSyncEngine(e,t){return function(n,i,s,o,a,c,l){const f=new fOe(n,i,s,o,a,c);return l&&(f.vc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=M(function*(t){const n=qe(t);Oe("RemoteStore","RemoteStore shutting down."),n.vu.add(5),yield O5(n),n.Pu.shutdown(),n.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class __{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Fr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class LOe{constructor(e,t,n,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=k2.UNAUTHENTICATED,this.clientId=tZ.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var o=M(function*(a){Oe("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(n,o=>(Oe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return M(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new f2;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(M(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=N5(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function v_(r,e){return jb.apply(this,arguments)}function jb(){return jb=M(function*(r,e){r.asyncQueue.verifyOperationInProgress(),Oe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield r.getConfiguration();yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=M(function*(s){n.isEqual(s)||(yield eK(e.localStore,s),n=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),jb.apply(this,arguments)}function Zb(r,e){return Yb.apply(this,arguments)}function Yb(){return Yb=M(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function Kb(r){return Xb.apply(this,arguments)}(r);Oe("FirestoreClient","Initializing OnlineComponentProvider");const n=yield r.getConfiguration();yield e.initialize(t,n),r.setCredentialChangeListener(i=>_K(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,s)=>_K(e.remoteStore,s)),r._onlineComponents=e}),Yb.apply(this,arguments)}function Xb(){return Xb=M(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Oe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield v_(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function kK(r){return"FirebaseError"===r.name?r.code===fe.FAILED_PRECONDITION||r.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(t))throw t;Oa("Error using user provided cache. Falling back to memory cache: "+t),yield v_(r,new m_)}}else Oe("FirestoreClient","Using default OfflineComponentProvider"),yield v_(r,new m_);return r._offlineComponents}),Xb.apply(this,arguments)}function C_(r){return Qb.apply(this,arguments)}function Qb(){return Qb=M(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Oe("FirestoreClient","Using user provided OnlineComponentProvider"),yield Zb(r,r._uninitializedComponentsProvider._online)):(Oe("FirestoreClient","Using default OnlineComponentProvider"),yield Zb(r,new x5))),r._onlineComponents}),Qb.apply(this,arguments)}function L5(r){return ew.apply(this,arguments)}function ew(){return ew=M(function*(r){const e=yield C_(r),t=e.eventManager;return t.onListen=dOe.bind(null,e.syncEngine),t.onUnlisten=hOe.bind(null,e.syncEngine),t}),ew.apply(this,arguments)}function HK(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const VK=new Map;function tw(r,e,t){if(!t)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function FK(r){if(!Ge.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function $K(r){if(Ge.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function M_(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(t=r).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof r?"a function":ot()}function In(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Te(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=M_(r);throw new Te(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}class BK{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Te(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Te(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function BOe(r,e,t,n){if(!0===e&&!0===n)throw new Te(fe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=HK(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class z9{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BK({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Te(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BK(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new $Se;switch(t.type){case"firstParty":return new WSe(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Te(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=VK.get(e);t&&(Oe("ComponentProvider","Removing Datastore"),VK.delete(e),t.terminate())}(this),Promise.resolve()}}function UK(r,e,t,n={}){var i;const s=(r=In(r,z9))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&Oa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=k2.MOCK_USER;else{a=function hMe(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Qg(JSON.stringify({alg:"none",type:"JWT"})),Qg(JSON.stringify(o)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new k2(l)}r._authCredentials=new GSe(new Jj(a,c))}}class Br{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new kc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Br(this.firestore,e,this._key)}}class ci{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ci(this.firestore,e,this._query)}}class kc extends ci{constructor(e,t,n){super(e,t,g5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Br(this.firestore,null,new Ge(e))}withConverter(e){return new kc(this.firestore,e,this._path)}}function UOe(r,e,...t){if(r=Mr(r),tw("collection","path",e),r instanceof z9){const n=Hn.fromString(e,...t);return $K(n),new kc(r,null,n)}{if(!(r instanceof Br||r instanceof kc))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Hn.fromString(e,...t));return $K(n),new kc(r.firestore,null,n)}}function WK(r,e,...t){if(r=Mr(r),1===arguments.length&&(e=tZ.A()),tw("doc","path",e),r instanceof z9){const n=Hn.fromString(e,...t);return FK(n),new Br(r,null,new Ge(n))}{if(!(r instanceof Br||r instanceof kc))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Hn.fromString(e,...t));return FK(n),new Br(r.firestore,r instanceof kc?r.converter:null,new Ge(n))}}class WOe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new KO(this,"async_queue_retry"),this.Xc=()=>{const t=h_();t&&Oe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=h_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=h_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new f2;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return M(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!J4(t))throw t;Oe("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{throw this.Wc=n,this.Hc=!1,Fr("INTERNAL UNHANDLED ERROR: ",function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(n)),n}).then(n=>(this.Hc=!1,n))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=gb.createAndSchedule(this,e,t,n,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&ot()}verifyOperationInProgress(){}sa(){var e=this;return M(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function nw(r){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(r)}class G1 extends z9{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new WOe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||jK(this),this._firestoreClient.terminate()}}function jOe(r,e){const n="string"==typeof r?r:e||"(default)",i=t5("object"==typeof r?r:oT(),"firestore").getImmediate({identifier:n});if(!i._initialized){const s=(r=>{const e=_q("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();s&&UK(i,...s)}return i}function e2(r){return r._firestoreClient||jK(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function jK(r){var e,t,n;const i=r._freezeSettings(),s=(a=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new MPe(r._databaseId,a,r._persistenceKey,(l=i).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,HK(l.experimentalLongPollingOptions),l.useFetchStreams));var a,l;r._firestoreClient=new LOe(r._authCredentials,r._appCheckCredentials,r._queue,s),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.cache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class t0{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t0(d2.fromBase64String(e))}catch(t){throw new Te(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new t0(d2.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class R5{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Te(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $r(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class E_{constructor(e){this._methodName=e}}class rw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return qt(this._lat,e._lat)||qt(this._long,e._long)}}const YOe=/^__.*__$/;class KOe{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new $3(e,this.data,this.fieldMask,t,this.fieldTransforms):new v5(e,this.data,t,this.fieldTransforms)}}class KK{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new $3(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function XK(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ot()}}class S_{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new S_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return T_(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(XK(this.ca)&&YOe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class XOe{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||x9(e)}ya(e,t,n,i=!1){return new S_({ca:e,methodName:t,ga:n,path:$r.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function z5(r){const e=r._freezeSettings(),t=x9(r._databaseId);return new XOe(r._databaseId,!!e.ignoreUndefinedProperties,t)}function iw(r,e,t,n,i,s={}){const o=r.ya(s.merge||s.mergeFields?2:0,e,t,i);ow("Data must be an object, but it was:",o,n);const a=nX(n,o);let c,l;if(s.merge)c=new Rs(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const d of s.mergeFields){const m=V9(e,d,t);if(!o.contains(m))throw new Te(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);iX(f,m)||f.push(m)}c=new Rs(f),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new KOe(new ai(a),c,l)}class H9 extends E_{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof H9}}class sw extends E_{_toFieldTransform(e){return new _9(e.path,new m5)}isEqual(e){return e instanceof sw}}function n0(r,e){if(rX(r=Mr(r)))return ow("Unsupported field value:",e,r),nX(r,e);if(r instanceof E_)return function(t,n){if(!XK(n.ca))throw n._a(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(n);i&&n.fieldTransforms.push(i)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,n){const i=[];let s=0;for(const o of t){let a=n0(o,n.wa(s));null==a&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(r,e)}return function(t,n){if(null===(t=Mr(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return qZ(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=cr.fromDate(t);return{timestampValue:y5(n.serializer,i)}}if(t instanceof cr){const i=new cr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:y5(n.serializer,i)}}if(t instanceof rw)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof t0)return{bytesValue:hY(n.serializer,t._byteString)};if(t instanceof Br){const i=n.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw n._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:PO(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n._a(`Unsupported field value: ${M_(t)}`)}(r,e)}function nX(r,e){const t={};return gZ(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):el(r,(n,i)=>{const s=n0(i,e.ha(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function rX(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof cr||r instanceof rw||r instanceof t0||r instanceof Br||r instanceof E_)}function ow(r,e,t){if(!rX(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=M_(t);throw e._a("an object"===n?r+" a custom object":r+" "+n)}var n}function V9(r,e,t){if((e=Mr(e))instanceof R5)return e._internalPath;if("string"==typeof e)return P_(r,e);throw T_("Field path arguments must be of type string or ",r,!1,void 0,t)}const tbe=new RegExp("[~\\*/\\[\\]]");function P_(r,e,t){if(e.search(tbe)>=0)throw T_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new R5(...e.split("."))._internalPath}catch{throw T_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function T_(r,e,t,n,i){const s=n&&!n.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${i}`),c+=")"),new Te(fe.INVALID_ARGUMENT,a+r+c)}function iX(r,e){return r.some(t=>t.isEqual(e))}class aw{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Br(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new nbe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(O_("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class nbe extends aw{data(){return super.data()}}function O_(r,e){return"string"==typeof e?P_(r,e):e instanceof R5?e._internalPath:e._delegate._internalPath}function sX(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Te(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cw{}class lw extends cw{}function rbe(r,e,...t){let n=[];e instanceof cw&&n.push(e),n=n.concat(t),function(i){const s=i.filter(a=>a instanceof D5).length,o=i.filter(a=>a instanceof F9).length;if(s>1||s>0&&o>0)throw new Te(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class F9 extends lw{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new F9(e,t,n)}_apply(e){const t=this._parse(e);return lX(e._query,t),new ci(e.firestore,e.converter,pO(e._query,t))}_parse(e){const t=z5(e.firestore);return function(i,s,o,a,c,l,f){let d;if(c.isKeyField()){if("array-contains"===l||"array-contains-any"===l)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if("in"===l||"not-in"===l){cX(f,l);const m=[];for(const E of f)m.push(aX(a,i,E));d={arrayValue:{values:m}}}else d=aX(a,i,f)}else"in"!==l&&"not-in"!==l&&"array-contains-any"!==l||cX(f,l),d=function tX(r,e,t,n=!1){return n0(t,r.ya(n?4:3,e))}(o,"where",f,"in"===l||"not-in"===l);return En.create(c,l,d)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function ibe(r,e,t){const n=e,i=O_("where",r);return F9._create(i,n,t)}class D5 extends cw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new D5(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:d1.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(n,i){let s=n;const o=i.getFlattenedFilters();for(const a of o)lX(s,a),s=pO(s,a)}(e._query,t),new ci(e.firestore,e.converter,pO(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class uw extends lw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new uw(e,t)}_apply(e){const t=function(n,i,s){if(null!==n.startAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new h5(i,s);return function(a,c){if(null===dO(a)){const l=Wm(a);null!==l&&uX(0,l,c.field)}}(n,o),o}(e._query,this._field,this._direction);return new ci(e.firestore,e.converter,function(n,i){const s=n.explicitOrderBy.concat([i]);return new V3(n.path,n.collectionGroup,s,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}function sbe(r,e="asc"){const t=e,n=O_("orderBy",r);return uw._create(n,t)}class b_ extends lw{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new b_(e,t,n)}_apply(e){return new ci(e.firestore,e.converter,qm(e._query,this._limit,this._limitType))}}function obe(r){return function GK(r,e){if(e<=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}("limit",r),b_._create("limit",r,"F")}function aX(r,e,t){if("string"==typeof(t=Mr(t))){if(""===t)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hO(e)&&-1!==t.indexOf("/"))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Hn.fromString(t));if(!Ge.isDocumentKey(n))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return B6(r,new Ge(n))}if(t instanceof Br)return B6(r,t._key);throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${M_(t)}.`)}function cX(r,e){if(!Array.isArray(r)||0===r.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lX(r,e){if(e.isInequality()){const n=Wm(r),i=e.field;if(null!==n&&!n.isEqual(i))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const s=dO(r);null!==s&&uX(0,i,s)}const t=function(n,i){for(const s of n)for(const o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Te(fe.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function uX(r,e,t){if(!t.isEqual(e))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class abe{convertValue(e,t="none"){switch(rl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(H3(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ot()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return el(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new rw(Pr(e.latitude),Pr(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Vm(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(c9(e));default:return null}}convertTimestamp(e){const t=tl(e);return new cr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Hn.fromString(e);gt(SY(n));const i=new G6(n.get(1),n.get(3)),s=new Ge(n.popFirst(5));return i.isEqual(t)||Fr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function fw(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class r0{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class H5 extends aw{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new A_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(O_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class A_ extends H5{data(e={}){return super.data(e)}}class V5{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new r0(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new A_(this._firestore,this._userDataWriter,n.key,n,new r0(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,i){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(o=>({type:"added",doc:new A_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new r0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:s++}))}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>i||3!==o.type).map(o=>{const a=new A_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new r0(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,l=-1;return 0!==o.type&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),l=s.indexOf(o.doc.key)),{type:lbe(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function lbe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot()}}function ube(r){r=In(r,Br);const e=In(r.firestore,G1);return function zK(r,e,t={}){const n=new f2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,s,o,a,c){const l=new __({next:d=>{s.enqueueAndForget(()=>vb(i,f));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new Te(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&a&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Mb(g5(o.path),l,{includeMetadataChanges:!0,Ku:!0});return mb(i,f)}(yield L5(r),r.asyncQueue,e,t,n)})),n.promise}(e2(e),r._key).then(t=>dw(e,r,t))}class dl extends abe{constructor(e){super(),this.firestore=e}convertBytes(e){return new t0(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Br(this.firestore,null,t)}}function fbe(r){r=In(r,ci);const e=In(r.firestore,G1),t=e2(e),n=new dl(e);return sX(r._query),function DK(r,e,t={}){const n=new f2;return r.asyncQueue.enqueueAndForget(M(function*(){return function(i,s,o,a,c){const l=new __({next:d=>{s.enqueueAndForget(()=>vb(i,f)),d.fromCache&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new Mb(o,l,{includeMetadataChanges:!0,Ku:!0});return mb(i,f)}(yield L5(r),r.asyncQueue,e,t,n)})),n.promise}(t,r._query).then(i=>new V5(e,n,r,i))}function dbe(r,e,t){r=In(r,Br);const n=In(r.firestore,G1),i=fw(r.converter,e,t);return $9(n,[iw(z5(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,er.none())])}function hbe(r,e,t,...n){r=In(r,Br);const i=In(r.firestore,G1),s=z5(i);let o;return o="string"==typeof(e=Mr(e))||e instanceof R5?function eX(r,e,t,n,i,s){const o=r.ya(1,e,t),a=[V9(e,n,t)],c=[i];if(s.length%2!=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(V9(e,s[m])),c.push(s[m+1]);const l=[],f=ai.empty();for(let m=a.length-1;m>=0;--m)if(!iX(l,a[m])){const E=a[m];let w=c[m];w=Mr(w);const R=o.da(E);if(w instanceof H9)l.push(E);else{const z=n0(w,R);null!=z&&(l.push(E),f.set(E,z))}}const d=new Rs(l);return new KK(f,d,o.fieldTransforms)}(s,"updateDoc",r._key,e,t,n):function JK(r,e,t,n){const i=r.ya(1,e,t);ow("Data must be an object, but it was:",i,n);const s=[],o=ai.empty();el(n,(c,l)=>{const f=P_(e,c,t);l=Mr(l);const d=i.da(f);if(l instanceof H9)s.push(f);else{const m=n0(l,d);null!=m&&(s.push(f),o.set(f,m))}});const a=new Rs(s);return new KK(o,a,i.fieldTransforms)}(s,"updateDoc",r._key,e),$9(i,[o.toMutation(r._key,er.exists(!0))])}function pbe(r){return $9(In(r.firestore,G1),[new C5(r._key,er.none())])}function gbe(r,e){const t=In(r.firestore,G1),n=WK(r),i=fw(r.converter,e);return $9(t,[iw(z5(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,er.exists(!1))]).then(()=>n)}function mbe(r,...e){var t,n,i;r=Mr(r);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||nw(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(nw(e[o])){const d=e[o];e[o]=null===(t=d.next)||void 0===t?void 0:t.bind(d),e[o+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),e[o+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}let c,l,f;if(r instanceof Br)l=In(r.firestore,G1),f=g5(r._key.path),c={next:d=>{e[o]&&e[o](dw(l,r,d))},error:e[o+1],complete:e[o+2]};else{const d=In(r,ci);l=In(d.firestore,G1),f=d._query;const m=new dl(l);c={next:E=>{e[o]&&e[o](new V5(l,m,d,E))},error:e[o+1],complete:e[o+2]},sX(r._query)}return function(d,m,E,w){const R=new __(w),z=new Mb(m,R,E);return d.asyncQueue.enqueueAndForget(M(function*(){return mb(yield L5(d),z)})),()=>{R.Dc(),d.asyncQueue.enqueueAndForget(M(function*(){return vb(yield L5(d),z)}))}}(e2(l),f,a,c)}function $9(r,e){return function(t,n){const i=new f2;return t.asyncQueue.enqueueAndForget(M(function*(){return function pOe(r,e,t){return Ob.apply(this,arguments)}(yield function Jb(r){return C_(r).then(e=>e.syncEngine)}(t),n,i)})),i.promise}(e2(r),e)}function dw(r,e,t){const n=t.docs.get(e._key),i=new dl(r);return new H5(r,i,e._key,n,new r0(t.hasPendingWrites,t.fromCache),e.converter)}function xc(){return new sw("serverTimestamp")}function hX(r,e){if(null!=r&&null!=e&&"object"==typeof r){if(null!=r.equals)return r.equals(e);{const t=r,n=e;for(const i of Object.keys(t)){if(!(i in n))return!1;if(!1===hX(t[i],n[i]))return!1}return!0}}return r===e}function hw(r){return null==r||function wbe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function hRe(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function Nbe(r){if("object"==typeof r){for(const e in r)if(null!=r[e]&&!1===hw(r[e]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function Do(r,e){if(hw(r)&&hw(e))return hX(r,e);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${e.constructor.name}`)}!function(r,e=!0){l5=R6,ls(new ki("firestore",(t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),o=new G1(new BSe(t.getProvider("auth-internal")),new qSe(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Te(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new G6(a.options.projectId,c)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Er(Qj,"3.13.0",r),Er(Qj,"3.13.0","esm2017")}();class we{static fromFunctions(e,t){return new class extends we{encode(n){return e(n)}decode(n){return t(n)}}}static identity(){function e(t){return t}return we.fromFunctions(e,e)}static constant(e,t){return new class extends we{encode(n){return e}decode(n){return t}}}static tuple(e,t,n){return new class extends we{encode(i){const s=t(i),o={};return Object.keys(s).forEach(a=>{o[a]=e[a].encode(s[a])}),o}decode(i){const s={};return Object.keys(e).reverse().forEach(o=>{s[o]=e[o].decode(i[o])}),n(Object.values(s))}}}static disjunction(e,t){return U.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends we{encode(n){let i=0;for(const s of e){if(!0===s(n))return{type:i,encoded:t[i].encode(n)};i++}}decode(n){const i=U.getNonNullable(n).type,s=U.getNonNullable(n).encoded;return t[i].decode(s)}}}static list(e){return new class extends we{encode(t){return t.map(n=>{const i=e.encode(n);return U.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(t){return t.map(e.decode)}}}}class g{static of(e){return new g(e)}static ofNullable(e){return null==e?g.empty():g.of(e)}static empty(){return new g(null)}static getEncoder(e){return new class extends we{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?g.empty():g.of(e.decode(t))}}}constructor(e){u(this,"value",void 0),this.value=e}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&Do(this.value,e.value)}equalsValue(e){return this.equals(g.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?g.of(e(this.get())):g.empty()}}class re{static success(e){return new Abe(e)}static failure(e){return new Ibe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&Do(this.get(),e.get())}}class Abe extends re{constructor(e){super(),u(this,"value",void 0),u(this,"__nominal",void 0),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return g.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class Ibe extends re{constructor(e){super(),u(this,"reason",void 0),u(this,"__nominal",void 0),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return g.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return re.failure(this.reason)}}var b;!function(r){r.SUCCESS=re.success(void 0),r.ofFallible=function e(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function t(n){return re.failure(n)}}(b||(b={})),Er("firebase","9.23.0","app");const Lbe=(r,e)=>e.some(t=>r instanceof t);let pX,gX;const mX=new WeakMap,pw=new WeakMap,_X=new WeakMap,gw=new WeakMap,mw=new WeakMap;let _w={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return pw.get(r);if("objectStoreNames"===e)return r.objectStoreNames||_X.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return hl(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function $be(r){return"function"==typeof r?function Fbe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function zbe(){return gX||(gX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(vw(this),e),hl(mX.get(this))}:function(...e){return hl(r.apply(vw(this),e))}:function(e,...t){const n=r.call(vw(this),e,...t);return _X.set(n,e.sort?e.sort():[e]),hl(n)}}(r):(r instanceof IDBTransaction&&function Hbe(r){if(pw.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});pw.set(r,e)}(r),Lbe(r,function Rbe(){return pX||(pX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,_w):r)}function hl(r){if(r instanceof IDBRequest)return function Dbe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(hl(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&mX.set(t,r)}).catch(()=>{}),mw.set(e,r),e}(r);if(gw.has(r))return gw.get(r);const e=$be(r);return e!==r&&(gw.set(r,e),mw.set(e,r)),e}const vw=r=>mw.get(r),Bbe=["get","getKey","getAll","getAllKeys","count"],Ube=["put","add","delete","clear"],Cw=new Map;function vX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(Cw.get(e))return Cw.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Ube.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!Bbe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return Cw.set(e,s),s}!function Vbe(r){_w=r(_w)}(r=>({...r,get:(e,t,n)=>vX(e,t)||r.get(e,t,n),has:(e,t)=>!!vX(e,t)||r.has(e,t)}));const CX="@firebase/installations",yw="0.6.4",yX=1e4,MX=`w:${yw}`,EX="FIS_v2",Wbe="https://firebaseinstallations.googleapis.com/v1",qbe=36e5,U3=new Pc("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function SX(r){return r instanceof Ro&&r.code.includes("request-failed")}function Mw({projectId:r}){return`${Wbe}/projects/${r}/installations`}function PX(r){return{token:r.token,requestStatus:2,expiresIn:Kbe(r.expiresIn),creationTime:Date.now()}}function Ew(r,e){return Sw.apply(this,arguments)}function Sw(){return Sw=M(function*(r,e){const n=(yield e.json()).error;return U3.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}),Sw.apply(this,arguments)}function TX({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Pw(r){return Tw.apply(this,arguments)}function Tw(){return Tw=M(function*(r){const e=yield r();return e.status>=500&&e.status<600?r():e}),Tw.apply(this,arguments)}function Kbe(r){return Number(r.replace("s","000"))}function Ow(){return Ow=M(function*({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=Mw(r),i=TX(r),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({fid:t,authVersion:EX,appId:r.appId,sdkVersion:MX})},c=yield Pw(()=>fetch(n,a));if(c.ok){const l=yield c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:PX(l.authToken)}}throw yield Ew("Create Installation",c)}),Ow.apply(this,arguments)}function bX(r){return new Promise(e=>{setTimeout(e,r)})}const ewe=/^[cdef][\w-]{21}$/,bw="";function twe(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=function nwe(r){return function Jbe(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}(r).substr(0,22)}(r);return ewe.test(t)?t:bw}catch{return bw}}function F5(r){return`${r.appName}!${r.appId}`}const $5=new Map;function wX(r,e){const t=F5(r);NX(t,e),function swe(r,e){const t=function AX(){return!s0&&"BroadcastChannel"in self&&(s0=new BroadcastChannel("[Firebase] FID Change"),s0.onmessage=r=>{NX(r.data.key,r.data.fid)}),s0}();t&&t.postMessage({key:r,fid:e}),function IX(){0===$5.size&&s0&&(s0.close(),s0=null)}()}(t,e)}function NX(r,e){const t=$5.get(r);if(t)for(const n of t)n(e)}let s0=null;const owe="firebase-installations-database",awe=1,o0="firebase-installations-store";let ww=null;function Nw(){return ww||(ww=function Gbe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=hl(o);return n&&o.addEventListener("upgradeneeded",c=>{n(hl(o.result),c.oldVersion,c.newVersion,hl(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}(owe,awe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(o0)}})),ww}function k_(r,e){return Aw.apply(this,arguments)}function Aw(){return Aw=M(function*(r,e){const t=F5(r),i=(yield Nw()).transaction(o0,"readwrite"),s=i.objectStore(o0),o=yield s.get(t);return yield s.put(e,t),yield i.done,(!o||o.fid!==e.fid)&&wX(r,e.fid),e}),Aw.apply(this,arguments)}function Iw(r){return kw.apply(this,arguments)}function kw(){return kw=M(function*(r){const e=F5(r),n=(yield Nw()).transaction(o0,"readwrite");yield n.objectStore(o0).delete(e),yield n.done}),kw.apply(this,arguments)}function G9(r,e){return xw.apply(this,arguments)}function xw(){return xw=M(function*(r,e){const t=F5(r),i=(yield Nw()).transaction(o0,"readwrite"),s=i.objectStore(o0),o=yield s.get(t),a=e(o);return void 0===a?yield s.delete(t):yield s.put(a,t),yield i.done,a&&(!o||o.fid!==a.fid)&&wX(r,a.fid),a}),xw.apply(this,arguments)}function Lw(r){return Rw.apply(this,arguments)}function Rw(){return Rw=M(function*(r){let e;const t=yield G9(r.appConfig,n=>{const i=function cwe(r){return xX(r||{fid:twe(),registrationStatus:0})}(n),s=function lwe(r,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(U3.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=function uwe(r,e){return zw.apply(this,arguments)}(r,t);return{installationEntry:t,registrationPromise:n}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:fwe(r)}:{installationEntry:e}}(r,i);return e=s.registrationPromise,s.installationEntry});return t.fid===bw?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),Rw.apply(this,arguments)}function zw(){return zw=M(function*(r,e){try{const t=yield function Qbe(r,e){return Ow.apply(this,arguments)}(r,e);return k_(r.appConfig,t)}catch(t){throw SX(t)&&409===t.customData.serverCode?yield Iw(r.appConfig):yield k_(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}),zw.apply(this,arguments)}function fwe(r){return Dw.apply(this,arguments)}function Dw(){return Dw=M(function*(r){let e=yield kX(r.appConfig);for(;1===e.registrationStatus;)yield bX(100),e=yield kX(r.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield Lw(r);return n||t}return e}),Dw.apply(this,arguments)}function kX(r){return G9(r,e=>{if(!e)throw U3.create("installation-not-found");return xX(e)})}function xX(r){return function dwe(r){return 1===r.registrationStatus&&r.registrationTime+yX<Date.now()}(r)?{fid:r.fid,registrationStatus:0}:r}function Hw(){return Hw=M(function*({appConfig:r,heartbeatServiceProvider:e},t){const n=function pwe(r,{fid:e}){return`${Mw(r)}/${e}/authTokens:generate`}(r,t),i=function OX(r,{refreshToken:e}){const t=TX(r);return t.append("Authorization",function Xbe(r){return`${EX} ${r}`}(e)),t}(r,t),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:MX,appId:r.appId}})},c=yield Pw(()=>fetch(n,a));if(c.ok)return PX(yield c.json());throw yield Ew("Generate Auth Token",c)}),Hw.apply(this,arguments)}function Vw(r){return Fw.apply(this,arguments)}function Fw(){return Fw=M(function*(r,e=!1){let t;const n=yield G9(r.appConfig,s=>{if(!RX(s))throw U3.create("not-registered");const o=s.authToken;if(!e&&function _we(r){return 2===r.requestStatus&&!function vwe(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+qbe}(r)}(o))return s;if(1===o.requestStatus)return t=function gwe(r,e){return $w.apply(this,arguments)}(r,e),s;{if(!navigator.onLine)throw U3.create("app-offline");const a=function Cwe(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}(s);return t=function mwe(r,e){return Gw.apply(this,arguments)}(r,a),a}});return t?yield t:n.authToken}),Fw.apply(this,arguments)}function $w(){return $w=M(function*(r,e){let t=yield LX(r.appConfig);for(;1===t.authToken.requestStatus;)yield bX(100),t=yield LX(r.appConfig);const n=t.authToken;return 0===n.requestStatus?Vw(r,e):n}),$w.apply(this,arguments)}function LX(r){return G9(r,e=>{if(!RX(e))throw U3.create("not-registered");return function ywe(r){return 1===r.requestStatus&&r.requestTime+yX<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function Gw(){return Gw=M(function*(r,e){try{const t=yield function hwe(r,e){return Hw.apply(this,arguments)}(r,e),n=Object.assign(Object.assign({},e),{authToken:t});return yield k_(r.appConfig,n),t}catch(t){if(!SX(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield k_(r.appConfig,n)}else yield Iw(r.appConfig);throw t}}),Gw.apply(this,arguments)}function RX(r){return void 0!==r&&2===r.registrationStatus}function Bw(){return Bw=M(function*(r){const e=r,{installationEntry:t,registrationPromise:n}=yield Lw(e);return n?n.catch(console.error):Vw(e).catch(console.error),t.fid}),Bw.apply(this,arguments)}function Uw(){return Uw=M(function*(r,e=!1){const t=r;return yield function Swe(r){return Ww.apply(this,arguments)}(t),(yield Vw(t,e)).token}),Uw.apply(this,arguments)}function Ww(){return Ww=M(function*(r){const{registrationPromise:e}=yield Lw(r);e&&(yield e)}),Ww.apply(this,arguments)}function Zw(r){return U3.create("missing-app-config-values",{valueName:r})}const zX="installations",wwe=r=>{const e=r.getProvider("app").getImmediate(),t=function Owe(r){if(!r||!r.options)throw Zw("App Configuration");if(!r.name)throw Zw("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw Zw(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:t5(e,"heartbeat"),_delete:()=>Promise.resolve()}},Nwe=r=>{const t=t5(r.getProvider("app").getImmediate(),zX).getImmediate();return{getId:()=>function Mwe(r){return Bw.apply(this,arguments)}(t),getToken:i=>function Ewe(r){return Uw.apply(this,arguments)}(t,i)}};(function Awe(){ls(new ki(zX,wwe,"PUBLIC")),ls(new ki("installations-internal",Nwe,"PRIVATE"))})(),Er(CX,yw),Er(CX,yw,"esm2017");const Yw="@firebase/remote-config",Ds=new Pc("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class $we{constructor(e,t,n,i){this.client=e,this.storage=t,this.storageCache=n,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,i=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(i&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return i;e.eTag=i&&i.eTag;const s=yield t.client.fetch(e),o=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&o.push(t.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(o),s})()}}function Gwe(r=navigator){return r.languages&&r.languages[0]||r.language}class Bwe{constructor(e,t,n,i,s,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=i,this.apiKey=s,this.appId=o}fetch(e){var t=this;return M(function*(){const[n,i]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:t.appId,language_code:Gwe()},l={method:"POST",headers:a,body:JSON.stringify(c)},f=fetch(o,l),d=new Promise(($,G)=>{e.signal.addEventListener(()=>{const de=new Error("The operation was aborted.");de.name="AbortError",G(de)})});let m;try{yield Promise.race([f,d]),m=yield f}catch($){let G="fetch-client-network";throw"AbortError"===$?.name&&(G="fetch-timeout"),Ds.create(G,{originalErrorMessage:$?.message})}let E=m.status;const w=m.headers.get("ETag")||void 0;let R,z;if(200===m.status){let $;try{$=yield m.json()}catch(G){throw Ds.create("fetch-client-parse",{originalErrorMessage:G?.message})}R=$.entries,z=$.state}if("INSTANCE_STATE_UNSPECIFIED"===z?E=500:"NO_CHANGE"===z?E=304:("NO_TEMPLATE"===z||"EMPTY_CONFIG"===z)&&(R={}),304!==E&&200!==E)throw Ds.create("fetch-status",{httpStatus:E});return{status:E,eTag:w,config:R}})()}}class qwe{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return M(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var i=this;return M(function*(){yield function Uwe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(Ds.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const s=yield i.client.fetch(e);return yield i.storage.deleteThrottleMetadata(),s}catch(s){if(!function Wwe(r){if(!(r instanceof Ro&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s))throw s;const o={throttleEndTimeMillis:Date.now()+XP(n),backoffCount:n+1};return yield i.storage.setThrottleMetadata(o),i.attemptFetch(e,o)}})()}}class Ywe{constructor(e,t,n,i,s){this.app=e,this._client=t,this._storageCache=n,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function L_(r,e){const t=r.target.error||void 0;return Ds.create(e,{originalErrorMessage:t&&t?.message})}const a0="app_namespace_store";class Jwe{constructor(e,t,n,i=function Qwe(){return new Promise((r,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=n=>{e(L_(n,"storage-open"))},t.onsuccess=n=>{r(n.target.result)},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(a0,{keyPath:"compositeKey"})}}catch(t){e(Ds.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([a0],"readonly").objectStore(a0),c=t.createCompositeKey(e);try{const l=a.get(c);l.onerror=f=>{s(L_(f,"storage-get"))},l.onsuccess=f=>{const d=f.target.result;i(d?d.value:void 0)}}catch(l){s(Ds.create("storage-get",{originalErrorMessage:l?.message}))}})})()}set(e,t){var n=this;return M(function*(){const i=yield n.openDbPromise;return new Promise((s,o)=>{const c=i.transaction([a0],"readwrite").objectStore(a0),l=n.createCompositeKey(e);try{const f=c.put({compositeKey:l,value:t});f.onerror=d=>{o(L_(d,"storage-set"))},f.onsuccess=()=>{s()}}catch(f){o(Ds.create("storage-set",{originalErrorMessage:f?.message}))}})})()}delete(e){var t=this;return M(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([a0],"readwrite").objectStore(a0),c=t.createCompositeKey(e);try{const l=a.delete(c);l.onerror=f=>{s(L_(f,"storage-delete"))},l.onsuccess=()=>{i()}}catch(l){s(Ds.create("storage-delete",{originalErrorMessage:l?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class eNe{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return M(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),s=yield t;s&&(e.lastFetchStatus=s);const o=yield n;o&&(e.lastSuccessfulFetchTimestampMillis=o);const a=yield i;a&&(e.activeConfig=a)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function nNe(){return eN.apply(this,arguments)}function eN(){return(eN=M(function*(){if(!I6())return!1;try{return yield Af()}catch{return!1}})).apply(this,arguments)}!function tNe(){ls(new ki("remote-config",function r(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Ds.create("registration-window");if(!I6())throw Ds.create("indexed-db-unavailable");const{projectId:s,apiKey:o,appId:a}=n.options;if(!s)throw Ds.create("registration-project-id");if(!o)throw Ds.create("registration-api-key");if(!a)throw Ds.create("registration-app-id");const c=new Jwe(a,n.name,t=t||"firebase"),l=new eNe(c),f=new e5(Yw);f.logLevel=Un.ERROR;const d=new Bwe(i,R6,t,s,o,a),m=new qwe(d,c),E=new $we(m,c,l,f),w=new Ywe(n,E,l,c,f);return function Hwe(r){const e=Mr(r);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(w),w},"PUBLIC").setMultipleInstances(!0)),Er(Yw,"0.4.4"),Er(Yw,"0.4.4","esm2017")}();const rNe=(r,e)=>e.some(t=>r instanceof t);let FX,$X;const GX=new WeakMap,tN=new WeakMap,BX=new WeakMap,nN=new WeakMap,rN=new WeakMap;let iN={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return tN.get(r);if("objectStoreNames"===e)return r.objectStoreNames||BX.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return W3(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function uNe(r){return"function"==typeof r?function lNe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function sNe(){return $X||($X=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(sN(this),e),W3(GX.get(this))}:function(...e){return W3(r.apply(sN(this),e))}:function(e,...t){const n=r.call(sN(this),e,...t);return BX.set(n,e.sort?e.sort():[e]),W3(n)}}(r):(r instanceof IDBTransaction&&function aNe(r){if(tN.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});tN.set(r,e)}(r),rNe(r,function iNe(){return FX||(FX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,iN):r)}function W3(r){if(r instanceof IDBRequest)return function oNe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(W3(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&GX.set(t,r)}).catch(()=>{}),rN.set(e,r),e}(r);if(nN.has(r))return nN.get(r);const e=uNe(r);return e!==r&&(nN.set(r,e),rN.set(e,r)),e}const sN=r=>rN.get(r);function UX(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=W3(o);return n&&o.addEventListener("upgradeneeded",c=>{n(W3(o.result),c.oldVersion,c.newVersion,W3(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function oN(r,{blocked:e}={}){const t=indexedDB.deleteDatabase(r);return e&&t.addEventListener("blocked",()=>e()),W3(t).then(()=>{})}const fNe=["get","getKey","getAll","getAllKeys","count"],dNe=["put","add","delete","clear"],aN=new Map;function WX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(aN.get(e))return aN.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=dNe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!fNe.includes(t))return;const s=function(){var o=M(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return aN.set(e,s),s}!function cNe(r){iN=r(iN)}(r=>({...r,get:(e,t,n)=>WX(e,t)||r.get(e,t,n),has:(e,t)=>!!WX(e,t)||r.has(e,t)}));const hNe="/firebase-messaging-sw.js",pNe="/firebase-cloud-messaging-push-scope",qX="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",gNe="https://fcmregistrations.googleapis.com/v1",jX="google.c.a.c_id",mNe="google.c.a.c_l",_Ne="google.c.a.ts";var R_=function(r){return r.PUSH_RECEIVED="push-received",r.NOTIFICATION_CLICKED="notification-clicked",r}(R_||{});function q3(r){const e=new Uint8Array(r);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function yNe(r){const t=(r+"=".repeat((4-r.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),i=new Uint8Array(n.length);for(let s=0;s<n.length;++s)i[s]=n.charCodeAt(s);return i}const cN="fcm_token_details_db",MNe=5,ZX="fcm_token_object_Store";function lN(){return lN=M(function*(r){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(cN))return null;let e=null;return(yield UX(cN,MNe,{upgrade:(n=M(function*(i,s,o,a){var c;if(s<2||!i.objectStoreNames.contains(ZX))return;const l=a.objectStore(ZX),f=yield l.index("fcmSenderId").get(r);if(yield l.clear(),f)if(2===s){const d=f;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:null!==(c=d.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:"string"==typeof d.vapidKey?d.vapidKey:q3(d.vapidKey)}}}else if(3===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:q3(d.auth),p256dh:q3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:q3(d.vapidKey)}}}else if(4===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:q3(d.auth),p256dh:q3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:q3(d.vapidKey)}}}}),function(s,o,a,c){return n.apply(this,arguments)})})).close(),yield oN(cN),yield oN("fcm_vapid_details_db"),yield oN("undefined"),function SNe(r){if(!r||!r.subscriptionOptions)return!1;const{subscriptionOptions:e}=r;return"number"==typeof r.createTime&&r.createTime>0&&"string"==typeof r.token&&r.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var n}),lN.apply(this,arguments)}const PNe="firebase-messaging-database",TNe=1,c0="firebase-messaging-store";let uN=null;function fN(){return uN||(uN=UX(PNe,TNe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(c0)}})),uN}function YX(r){return dN.apply(this,arguments)}function dN(){return dN=M(function*(r){const e=mN(r),n=yield(yield fN()).transaction(c0).objectStore(c0).get(e);if(n)return n;{const i=yield function ENe(r){return lN.apply(this,arguments)}(r.appConfig.senderId);if(i)return yield hN(r,i),i}}),dN.apply(this,arguments)}function hN(r,e){return pN.apply(this,arguments)}function pN(){return pN=M(function*(r,e){const t=mN(r),i=(yield fN()).transaction(c0,"readwrite");return yield i.objectStore(c0).put(e,t),yield i.done,e}),pN.apply(this,arguments)}function gN(){return gN=M(function*(r){const e=mN(r),n=(yield fN()).transaction(c0,"readwrite");yield n.objectStore(c0).delete(e),yield n.done}),gN.apply(this,arguments)}function mN({appConfig:r}){return r.appId}const li=new Pc("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function wNe(r,e){return _N.apply(this,arguments)}function _N(){return _N=M(function*(r,e){const t=yield MN(r),n=XX(e),i={method:"POST",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(yN(r.appConfig),i)).json()}catch(o){throw li.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error)throw li.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw li.create("token-subscribe-no-token");return s.token}),_N.apply(this,arguments)}function vN(){return vN=M(function*(r,e){const t=yield MN(r),n=XX(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(`${yN(r.appConfig)}/${e.token}`,i)).json()}catch(o){throw li.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error)throw li.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw li.create("token-update-no-token");return s.token}),vN.apply(this,arguments)}function KX(r,e){return CN.apply(this,arguments)}function CN(){return CN=M(function*(r,e){const n={method:"DELETE",headers:yield MN(r)};try{const s=yield(yield fetch(`${yN(r.appConfig)}/${e}`,n)).json();if(s.error)throw li.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(i){throw li.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}}),CN.apply(this,arguments)}function yN({projectId:r}){return`${gNe}/projects/${r}/registrations`}function MN(r){return EN.apply(this,arguments)}function EN(){return EN=M(function*({appConfig:r,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),EN.apply(this,arguments)}function XX({p256dh:r,auth:e,endpoint:t,vapidKey:n}){const i={web:{endpoint:t,auth:e,p256dh:r}};return n!==qX&&(i.web.applicationPubKey=n),i}const ANe=6048e5;function SN(){return SN=M(function*(r){const e=yield function xNe(r,e){return bN.apply(this,arguments)}(r.swRegistration,r.vapidKey),t={vapidKey:r.vapidKey,swScope:r.swRegistration.scope,endpoint:e.endpoint,auth:q3(e.getKey("auth")),p256dh:q3(e.getKey("p256dh"))},n=yield YX(r.firebaseDependencies);if(n){if(function LNe(r,e){return e.vapidKey===r.vapidKey&&e.endpoint===r.endpoint&&e.auth===r.auth&&e.p256dh===r.p256dh}(n.subscriptionOptions,t))return Date.now()>=n.createTime+ANe?function kNe(r,e){return TN.apply(this,arguments)}(r,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{yield KX(r.firebaseDependencies,n.token)}catch(i){console.warn(i)}return JX(r.firebaseDependencies,t)}return JX(r.firebaseDependencies,t)}),SN.apply(this,arguments)}function PN(){return PN=M(function*(r){const e=yield YX(r.firebaseDependencies);e&&(yield KX(r.firebaseDependencies,e.token),yield function ONe(r){return gN.apply(this,arguments)}(r.firebaseDependencies));const t=yield r.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),PN.apply(this,arguments)}function TN(){return TN=M(function*(r,e){try{const t=yield function NNe(r,e){return vN.apply(this,arguments)}(r.firebaseDependencies,e),n=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield hN(r.firebaseDependencies,n),t}catch(t){throw yield function QX(r){return PN.apply(this,arguments)}(r),t}}),TN.apply(this,arguments)}function JX(r,e){return ON.apply(this,arguments)}function ON(){return ON=M(function*(r,e){const n={token:yield wNe(r,e),createTime:Date.now(),subscriptionOptions:e};return yield hN(r,n),n.token}),ON.apply(this,arguments)}function bN(){return bN=M(function*(r,e){return(yield r.pushManager.getSubscription())||r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:yNe(e)})}),bN.apply(this,arguments)}function eQ(r){const e={from:r.from,collapseKey:r.collapse_key,messageId:r.fcmMessageId};return function RNe(r,e){if(!e.notification)return;r.notification={};const t=e.notification.title;t&&(r.notification.title=t);const n=e.notification.body;n&&(r.notification.body=n);const i=e.notification.image;i&&(r.notification.image=i);const s=e.notification.icon;s&&(r.notification.icon=s)}(e,r),function zNe(r,e){e.data&&(r.data=e.data)}(e,r),function DNe(r,e){var t,n,i,s,o;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;r.fcmOptions={};const a=null!==(i=null===(n=e.fcmOptions)||void 0===n?void 0:n.link)&&void 0!==i?i:null===(s=e.notification)||void 0===s?void 0:s.click_action;a&&(r.fcmOptions.link=a);const c=null===(o=e.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(r.fcmOptions.analyticsLabel=c)}(e,r),e}function tQ(r,e){const t=[];for(let n=0;n<r.length;n++)t.push(r.charAt(n)),n<e.length&&t.push(e.charAt(n));return t.join("")}function wN(r){return li.create("missing-app-config-values",{valueName:r})}tQ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),tQ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class FNe{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function VNe(r){if(!r||!r.options)throw wN("App Configuration Object");if(!r.name)throw wN("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=r;for(const n of e)if(!t[n])throw wN(n);return{appName:r.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function NN(){return NN=M(function*(r){try{r.swRegistration=yield navigator.serviceWorker.register(hNe,{scope:pNe}),r.swRegistration.update().catch(()=>{})}catch(e){throw li.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}),NN.apply(this,arguments)}function AN(){return AN=M(function*(r,e){if(!e&&!r.swRegistration&&(yield function nQ(r){return NN.apply(this,arguments)}(r)),e||!r.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw li.create("invalid-sw-registration");r.swRegistration=e}}),AN.apply(this,arguments)}function IN(){return IN=M(function*(r,e){e?r.vapidKey=e:r.vapidKey||(r.vapidKey=qX)}),IN.apply(this,arguments)}function kN(){return kN=M(function*(r,e){if(!navigator)throw li.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw li.create("permission-blocked");return yield function GNe(r,e){return IN.apply(this,arguments)}(r,e?.vapidKey),yield function $Ne(r,e){return AN.apply(this,arguments)}(r,e?.serviceWorkerRegistration),function INe(r){return SN.apply(this,arguments)}(r)}),kN.apply(this,arguments)}function xN(){return xN=M(function*(r,e,t){const n=function UNe(r){switch(r){case R_.NOTIFICATION_CLICKED:return"notification_open";case R_.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield r.firebaseDependencies.analyticsProvider.get()).logEvent(n,{message_id:t[jX],message_name:t[mNe],message_time:t[_Ne],message_device_time:Math.floor(Date.now()/1e3)})}),xN.apply(this,arguments)}function LN(){return LN=M(function*(r,e){const t=e.data;if(!t.isFirebaseMessaging)return;r.onMessageHandler&&t.messageType===R_.PUSH_RECEIVED&&("function"==typeof r.onMessageHandler?r.onMessageHandler(eQ(t)):r.onMessageHandler.next(eQ(t)));const n=t.data;(function HNe(r){return"object"==typeof r&&!!r&&jX in r})(n)&&"1"===n["google.c.a.e"]&&(yield function BNe(r,e,t){return xN.apply(this,arguments)}(r,t.messageType,n))}),LN.apply(this,arguments)}const iQ="@firebase/messaging",qNe=r=>{const e=new FNe(r.getProvider("app").getImmediate(),r.getProvider("installations-internal").getImmediate(),r.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function WNe(r,e){return LN.apply(this,arguments)}(e,t)),e},jNe=r=>{const e=r.getProvider("messaging").getImmediate();return{getToken:n=>function rQ(r,e){return kN.apply(this,arguments)}(e,n)}};function oQ(){return RN.apply(this,arguments)}function RN(){return(RN=M(function*(){try{yield Af()}catch{return!1}return typeof window<"u"&&I6()&&ZP()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function ZNe(){ls(new ki("messaging",qNe,"PUBLIC")),ls(new ki("messaging-internal",jNe,"PRIVATE")),Er(iQ,"0.12.4"),Er(iQ,"0.12.4","esm2017")}();const z_="analytics",XNe="firebase_id",QNe="origin",JNe=6e4,eAe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",HN="https://www.googletagmanager.com/gtag/js",R2=new e5("@firebase/analytics"),ds=new Pc("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function nAe(r){if(!r.startsWith(HN)){const e=ds.create("invalid-gtag-resource",{gtagURL:r});return R2.warn(e.message),""}return r}function aQ(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function VN(){return VN=M(function*(r,e,t,n,i,s){const o=n[i];try{if(o)yield e[o];else{const c=(yield aQ(t)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){R2.error(a)}r("config",i,s)}),VN.apply(this,arguments)}function FN(){return FN=M(function*(r,e,t,n,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=yield aQ(t);for(const c of o){const l=a.find(d=>d.measurementId===c),f=l&&e[l.appId];if(!f){s=[];break}s.push(f)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),r("event",n,i||{})}catch(s){R2.error(s)}}),FN.apply(this,arguments)}const fAe=30,cQ=new class hAe{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function pAe(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}function $N(){return $N=M(function*(r){var e;const{appId:t,apiKey:n}=r,i={method:"GET",headers:pAe(n)},s=eAe.replace("{app-id}",t),o=yield fetch(s,i);if(200!==o.status&&304!==o.status){let a="";try{const c=yield o.json();null!==(e=c.error)&&void 0!==e&&e.message&&(a=c.error.message)}catch{}throw ds.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}),$N.apply(this,arguments)}function GN(){return GN=M(function*(r,e=cQ,t){const{appId:n,apiKey:i,measurementId:s}=r.options;if(!n)throw ds.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw ds.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new CAe;return setTimeout(M(function*(){a.abort()}),void 0!==t?t:JNe),lQ({appId:n,apiKey:i,measurementId:s},o,a,e)}),GN.apply(this,arguments)}function lQ(r,e,t){return BN.apply(this,arguments)}function BN(){return BN=M(function*(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=cQ){var s;const{appId:o,measurementId:a}=r;try{yield function _Ae(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(ds.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(n,e)}catch(c){if(a)return R2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:o,measurementId:a};throw c}try{const c=yield function gAe(r){return $N.apply(this,arguments)}(r);return i.deleteThrottleMetadata(o),c}catch(c){const l=c;if(!function vAe(r){if(!(r instanceof Ro&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(i.deleteThrottleMetadata(o),a)return R2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:o,measurementId:a};throw c}const f=503===Number(null===(s=l?.customData)||void 0===s?void 0:s.httpStatus)?XP(t,i.intervalMillis,fAe):XP(t,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return i.setThrottleMetadata(o,d),R2.debug(`Calling attemptFetch again in ${f} millis`),lQ(r,d,n,i)}}),BN.apply(this,arguments)}class CAe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let UN,XN;function WN(){return WN=M(function*(r,e,t,n,i){if(i&&i.global)r("event",t,n);else{const s=yield e;r("event",t,Object.assign(Object.assign({},n),{send_to:s}))}}),WN.apply(this,arguments)}function QN(){return QN=M(function*(){if(!I6())return R2.warn(ds.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Af()}catch(r){return R2.warn(ds.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}return!0}),QN.apply(this,arguments)}function JN(){return JN=M(function*(r,e,t,n,i,s,o){var a;const c=function mAe(r){return GN.apply(this,arguments)}(r);c.then(E=>{t[E.measurementId]=E.appId,r.options.measurementId&&E.measurementId!==r.options.measurementId&&R2.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>R2.error(E)),e.push(c);const l=function OAe(){return QN.apply(this,arguments)}().then(E=>{if(E)return n.getId()}),[f,d]=yield Promise.all([c,l]);(function uAe(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(HN)&&t.src.includes(r))return t;return null})(s)||function iAe(r,e){const t=function rAe(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}("firebase-js-sdk-policy",{createScriptURL:nAe}),n=document.createElement("script"),i=`${HN}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}(s,f.measurementId),XN&&(i("consent","default",XN),function uQ(r){XN=r}(void 0)),i("js",new Date);const m=null!==(a=o?.config)&&void 0!==a?a:{};return m[QNe]="firebase",m.update=!0,null!=d&&(m[XNe]=d),i("config",f.measurementId,m),UN&&(i("set",UN),function fQ(r){UN=r}(void 0)),f.measurementId}),JN.apply(this,arguments)}class wAe{constructor(e){this.app=e}_delete(){return delete Lc[this.app.options.appId],Promise.resolve()}}let Lc={},dQ=[];const hQ={};let gQ,Rc,D_="dataLayer",eA=!1;function AAe(r,e,t){!function NAe(){const r=[];if(jP()&&r.push("This is a browser extension environment."),ZP()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=ds.create("invalid-analytics-context",{errorInfo:e});R2.warn(t.message)}}();const n=r.options.appId;if(!n)throw ds.create("no-app-id");if(!r.options.apiKey){if(!r.options.measurementId)throw ds.create("no-api-key");R2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Lc[n])throw ds.create("already-exists",{id:n});if(!eA){!function sAe(r){let e=[];Array.isArray(window[r])?e=window[r]:window[r]=e}(D_);const{wrappedGtag:s,gtagCore:o}=function lAe(r,e,t,n,i){let s=function(...o){window[n].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function cAe(r,e,t,n){function s(){return s=M(function*(o,...a){try{if("event"===o){const[c,l]=a;yield function aAe(r,e,t,n,i){return FN.apply(this,arguments)}(r,e,t,c,l)}else if("config"===o){const[c,l]=a;yield function oAe(r,e,t,n,i,s){return VN.apply(this,arguments)}(r,e,t,n,c,l)}else if("consent"===o){const[c]=a;r("consent","update",c)}else if("get"===o){const[c,l,f]=a;r("get",c,l,f)}else if("set"===o){const[c]=a;r("set",c)}else r(o,...a)}catch(c){R2.error(c)}}),s.apply(this,arguments)}return function i(o){return s.apply(this,arguments)}}(s,r,e,t),{gtagCore:s,wrappedGtag:window[i]}}(Lc,dQ,hQ,D_,"gtag");Rc=s,gQ=o,eA=!0}return Lc[n]=function bAe(r,e,t,n,i,s,o){return JN.apply(this,arguments)}(r,dQ,hQ,e,gQ,D_,t),new wAe(r)}function kAe(){return tA.apply(this,arguments)}function tA(){return(tA=M(function*(){if(jP()||!ZP()||!I6())return!1;try{return yield Af()}catch{return!1}})).apply(this,arguments)}const mQ="@firebase/analytics";!function LAe(){ls(new ki(z_,(e,{options:t})=>AAe(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),ls(new ki("analytics-internal",function r(e){try{const t=e.getProvider(z_).getImmediate();return{logEvent:(n,i,s)=>function xAe(r,e,t,n){r=Mr(r),function yAe(r,e,t,n,i){return WN.apply(this,arguments)}(Rc,Lc[r.app.options.appId],e,t,n).catch(i=>R2.error(i))}(t,n,i,s)}}catch(t){throw ds.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Er(mQ,"0.10.0"),Er(mQ,"0.10.0","esm2017")}();class RAe extends Mn{constructor(e,t){super()}schedule(e,t=0){return this}}const H_={setInterval(r,e,...t){const{delegate:n}=H_;return n?.setInterval?n.setInterval(r,e,...t):setInterval(r,e,...t)},clearInterval(r){const{delegate:e}=H_;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};class vQ extends RAe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return H_.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&H_.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(s){n=!0,i=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,c3(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const rA={now:()=>(rA.delegate||Date).now(),delegate:void 0};class B9{constructor(e,t=B9.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}B9.now=rA.now;class CQ extends B9{constructor(e,t=B9.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const HAe=new class DAe extends CQ{}(class zAe extends vQ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}}),VAe=new CQ(vQ),V_=new y8("7.6.1"),iA="__angularfire_symbol__analyticsIsSupportedValue",sA="__angularfire_symbol__analyticsIsSupported",oA="__angularfire_symbol__remoteConfigIsSupportedValue",aA="__angularfire_symbol__remoteConfigIsSupported",cA="__angularfire_symbol__messagingIsSupportedValue",lA="__angularfire_symbol__messagingIsSupported";function fA(r,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(o=>o.app===t);if(1===s.length)return s[0]}return t.container.getProvider(r).getImmediate({optional:!0})}globalThis[sA]||(globalThis[sA]=kAe().then(r=>globalThis[iA]=r).catch(()=>globalThis[iA]=!1)),globalThis[lA]||(globalThis[lA]=oQ().then(r=>globalThis[cA]=r).catch(()=>globalThis[cA]=!1)),globalThis[aA]||(globalThis[aA]=nNe().then(r=>globalThis[oA]=r).catch(()=>globalThis[oA]=!1));const dA=(r,e)=>{const t=e?[e]:Aq(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n};function G5(){}class yQ{constructor(e,t=HAe){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},t,n)}}class FAe{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",G5,{},G5,G5)),t.pipe(Ii({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let hA=(()=>{class r{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new yQ(Zone.current)),this.insideAngular=t.run(()=>new yQ(Zone.current,VAe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return r.\u0275fac=function(t){return new(t||r)(Pe(l1))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function l0(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}function u0(r){return l0().ngZone.run(()=>r())}function GAe(r){return l0(),function BAe(r){return function(t){return(t=t.lift(new FAe(r.ngZone))).pipe(fh(r.outsideAngular),uh(r.insideAngular))}}(l0())(r)}const UAe=(r,e)=>function(){const n=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),u0(()=>r.apply(void 0,n))},B1=(r,e)=>function(){let t;const n=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof n[s]&&(e&&(t||(t=u0(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",G5,{},G5,G5)))),n[s]=UAe(n[s],t));const i=function $Ae(r){return l0().ngZone.runOutsideAngular(()=>r())}(()=>r.apply(this,n));if(!e){if(i instanceof b1){const s=l0();return i.pipe(fh(s.outsideAngular),uh(s.insideAngular))}return u0(()=>i)}return i instanceof b1?i.pipe(GAe):i instanceof Promise?u0(()=>new Promise((s,o)=>i.then(a=>u0(()=>s(a)),a=>u0(()=>o(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:u0(()=>i)};class B5{constructor(e){return e}}class pA{constructor(){return Aq()}}const gA=new et("angularfire2._apps"),qAe={provide:B5,useFactory:function WAe(r){return r&&1===r.length?r[0]:new B5(oT())},deps:[[new is,gA]]},jAe={provide:pA,deps:[[new is,gA]]};function ZAe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new B5(n)}}let YAe=(()=>{class r{constructor(t){Er("angularfire",V_.full,"core"),Er("angularfire",V_.full,"app"),Er("angular",pH.full,t.toString())}}return r.\u0275fac=function(t){return new(t||r)(Pe(C3))},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({providers:[qAe,jAe]}),r})();const XAe=B1(Nq,!0),mA=new Map,MQ={activated:!1,tokenObservers:[]},QAe={initialized:!1,enabled:!1};function Tr(r){return mA.get(r)||Object.assign({},MQ)}function F_(){return QAe}const _A="https://content-firebaseappcheck.googleapis.com/v1",nIe="exchangeDebugToken",EQ={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class iIe{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return M(function*(){t.stop();try{t.pending=new tm,yield function sIe(r){return new Promise(e=>{setTimeout(e,r)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new tm,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const ui=new Pc("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function vA(r){if(!Tr(r).activated)throw ui.create("use-before-activation",{appName:r.name})}function B_(r,e){return yA.apply(this,arguments)}function yA(){return yA=M(function*({url:r,body:e},t){const n={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&(n["X-Firebase-Client"]=d)}const s={method:"POST",body:JSON.stringify(e),headers:n};let o,a;try{o=yield fetch(r,s)}catch(d){throw ui.create("fetch-network-error",{originalErrorMessage:d?.message})}if(200!==o.status)throw ui.create("fetch-status-error",{httpStatus:o.status});try{a=yield o.json()}catch(d){throw ui.create("fetch-parse-error",{originalErrorMessage:d?.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw ui.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const l=1e3*Number(c[1]),f=Date.now();return{token:a.token,expireTimeMillis:f+l,issuedAtTimeMillis:f}}),yA.apply(this,arguments)}function SQ(r,e){const{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${_A}/projects/${t}/apps/${n}:${nIe}?key=${i}`,body:{debug_token:e}}}const lIe="firebase-app-check-database",uIe=1,U9="firebase-app-check-store";let U_=null;function MA(){return MA=M(function*(r,e){const n=(yield function TQ(){return U_||(U_=new Promise((r,e)=>{try{const t=indexedDB.open(lIe,uIe);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(ui.create("storage-open",{originalErrorMessage:null===(i=n.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(U9,{keyPath:"compositeKey"})}}catch(t){e(ui.create("storage-open",{originalErrorMessage:t?.message}))}}),U_)}()).transaction(U9,"readwrite"),s=n.objectStore(U9).put({compositeKey:r,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},n.onerror=c=>{var l;a(ui.create("storage-set",{originalErrorMessage:null===(l=c.target.error)||void 0===l?void 0:l.message}))}})}),MA.apply(this,arguments)}const W9=new e5("@firebase/app-check");function PA(r,e){return I6()?function dIe(r,e){return function OQ(r,e){return MA.apply(this,arguments)}(function wQ(r){return`${r.options.appId}-${r.name}`}(r),e)}(r,e).catch(t=>{W9.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function OA(){return F_().enabled}function bA(){return wA.apply(this,arguments)}function wA(){return wA=M(function*(){const r=F_();if(r.enabled&&r.token)return r.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),wA.apply(this,arguments)}const vIe={error:"UNKNOWN_ERROR"};function CIe(r){return qP.encodeString(JSON.stringify(r),!1)}function W_(r){return NA.apply(this,arguments)}function NA(){return NA=M(function*(r,e=!1){const t=r.app;vA(t);const n=Tr(t);let s,i=n.token;if(i&&!U5(i)&&(n.token=void 0,i=void 0),!i){const c=yield n.cachedTokenPromise;c&&(U5(c)?i=c:yield PA(t,void 0))}if(!e&&i&&U5(i))return{token:i.token};let a,o=!1;if(OA()){n.exchangeTokenPromise||(n.exchangeTokenPromise=B_(SQ(t,yield bA()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);const c=yield n.exchangeTokenPromise;return yield PA(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),i=yield Tr(t).exchangeTokenPromise}catch(c){"appCheck/throttled"===c.code?W9.warn(c.message):W9.error(c),s=c}return i?s?a=U5(i)?{token:i.token,internalError:s}:kQ(s):(a={token:i.token},n.token=i,yield PA(t,i)):a=kQ(s),o&&function IQ(r,e){const t=Tr(r).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}(t,a),a}),NA.apply(this,arguments)}function AA(){return AA=M(function*(r){const e=r.app;vA(e);const{provider:t}=Tr(e);if(OA()){const n=yield bA(),{token:i}=yield B_(SQ(e,n),r.heartbeatServiceProvider);return{token:i}}{const{token:n}=yield t.getToken();return{token:n}}}),AA.apply(this,arguments)}function kA(r,e){const t=Tr(r),n=t.tokenObservers.filter(i=>i.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function AQ(r){const{app:e}=r,t=Tr(e);let n=t.tokenRefresher;n||(n=function yIe(r){const{app:e}=r;return new iIe(M(function*(){let n;if(n=Tr(e).token?yield W_(r,!0):yield W_(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=Tr(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},EQ.RETRIAL_MIN_WAIT,EQ.RETRIAL_MAX_WAIT)}(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function U5(r){return r.expireTimeMillis-Date.now()>0}function kQ(r){return{token:CIe(vIe),error:r}}class MIe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Tr(this.app);for(const t of e)kA(this.app,t.next);return Promise.resolve()}}const FQ="app-check-internal";!function RIe(){ls(new ki("app-check",r=>function EIe(r,e){return new MIe(r,e)}(r.getProvider("app").getImmediate(),r.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(FQ).initialize()})),ls(new ki(FQ,r=>function SIe(r){return{getToken:e=>W_(r,e),getLimitedUseToken:()=>function NQ(r){return AA.apply(this,arguments)}(r),addTokenListener:e=>function IA(r,e,t,n){const{app:i}=r,s=Tr(i);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:n,type:e}],s.token&&U5(s.token)){const a=s.token;Promise.resolve().then(()=>{t({token:a.token}),AQ(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>AQ(r))}(r,"INTERNAL",e),removeTokenListener:e=>kA(r.app,e)}}(r.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),Er("@firebase/app-check","0.8.0")}();class zA{constructor(){return dA("app-check")}}typeof window<"u"&&window;const FIe=function GQ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},BQ=new Pc("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),j_=new e5("@firebase/auth");function Z_(r,...e){j_.logLevel<=Un.ERROR&&j_.error(`Auth (${R6}): ${r}`,...e)}function Hs(r,...e){throw HA(r,...e)}function ho(r,...e){return HA(r,...e)}function UQ(r,e,t){const n=Object.assign(Object.assign({},FIe()),{[e]:t});return new Pc("auth","Firebase",n).create(e,{appName:r.name})}function HA(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return BQ.create(r,...e)}function He(r,e,...t){if(!r)throw HA(e,...t)}function zc(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Z_(e),new Error(e)}function j3(r,e){r||zc(e)}function q9(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function WQ(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}class j9{constructor(e,t){this.shortDelay=e,this.longDelay=t,j3(t>e,"Short delay should be less than long delay!"),this.isMobile=function pMe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(N2())}()||function mMe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function GIe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function VA(){return"http:"===WQ()||"https:"===WQ()}()||jP()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function FA(r,e){j3(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class qQ{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void zc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void zc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void zc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const UIe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},WIe=new j9(3e4,6e4);function lr(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}function Or(r,e,t,n){return $A.apply(this,arguments)}function $A(){return $A=M(function*(r,e,t,n,i={}){return jQ(r,i,M(function*(){let s={},o={};n&&("GET"===e?o=n:s={body:JSON.stringify(n)});const a=If(Object.assign({key:r.config.apiKey},o)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),qQ.fetch()(ZQ(r,r.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))}))}),$A.apply(this,arguments)}function jQ(r,e,t){return GA.apply(this,arguments)}function GA(){return GA=M(function*(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},UIe),e);try{const i=new qIe(r),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=yield s.json();if("needConfirmation"in o)throw Z9(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw Z9(r,"credential-already-in-use",o);if("EMAIL_EXISTS"===c)throw Z9(r,"email-already-in-use",o);if("USER_DISABLED"===c)throw Z9(r,"user-disabled",o);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw UQ(r,f,l);Hs(r,f)}}catch(i){if(i instanceof Ro)throw i;Hs(r,"network-request-failed",{message:String(i)})}}),GA.apply(this,arguments)}function Z3(r,e,t,n){return BA.apply(this,arguments)}function BA(){return BA=M(function*(r,e,t,n,i={}){const s=yield Or(r,e,t,n,i);return"mfaPendingCredential"in s&&Hs(r,"multi-factor-auth-required",{_serverResponse:s}),s}),BA.apply(this,arguments)}function ZQ(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?FA(r.config,i):`${r.config.apiScheme}://${i}`}class qIe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(ho(this.auth,"network-request-failed")),WIe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Z9(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=ho(r,e,n);return i.customData._tokenResponse=t,i}function UA(){return UA=M(function*(r,e){return Or(r,"POST","/v1/accounts:delete",e)}),UA.apply(this,arguments)}function qA(){return qA=M(function*(r,e){return Or(r,"POST","/v1/accounts:lookup",e)}),qA.apply(this,arguments)}function Y9(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function jA(){return jA=M(function*(r,e=!1){const t=Mr(r),n=yield t.getIdToken(e),i=Y_(n);He(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:n,authTime:Y9(ZA(i.auth_time)),issuedAtTime:Y9(ZA(i.iat)),expirationTime:Y9(ZA(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}),jA.apply(this,arguments)}function ZA(r){return 1e3*Number(r)}function Y_(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return Z_("JWT malformed, contained fewer than 3 sections"),null;try{const i=Jg(t);return i?JSON.parse(i):(Z_("Failed to decode base64 JWT payload"),null)}catch(i){return Z_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Y3(r,e){return YA.apply(this,arguments)}function YA(){return YA=M(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof Ro&&function QIe({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}}),YA.apply(this,arguments)}class JIe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(M(function*(){yield t.iteration()}),n)}iteration(){var e=this;return M(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class YQ{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Y9(this.lastLoginAt),this.creationTime=Y9(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function K9(r){return KA.apply(this,arguments)}function KA(){return KA=M(function*(r){var e;const t=r.auth,n=yield r.getIdToken(),i=yield Y3(r,function YIe(r,e){return qA.apply(this,arguments)}(t,{idToken:n}));He(i?.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const o=null!==(e=s.providerUserInfo)&&void 0!==e&&e.length?function nke(r){return r.map(e=>{var{providerId:t}=e,n=Uu(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(s.providerUserInfo):[],a=function tke(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,o),f=!!r.isAnonymous&&!(r.email&&s.passwordHash||a?.length),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new YQ(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(r,d)}),KA.apply(this,arguments)}function XA(){return XA=M(function*(r){const e=Mr(r);yield K9(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}),XA.apply(this,arguments)}function QA(){return QA=M(function*(r,e){const t=yield jQ(r,{},M(function*(){const n=If({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=ZQ(r,i,"/v1/token",`key=${s}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",qQ.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}),QA.apply(this,arguments)}class X9{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){He(e.idToken,"internal-error"),He(typeof e.idToken<"u","internal-error"),He(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function XIe(r){const e=Y_(r);return He(e,"internal-error"),He(typeof e.exp<"u","internal-error"),He(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return M(function*(){return He(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return M(function*(){const{accessToken:i,refreshToken:s,expiresIn:o}=yield function rke(r,e){return QA.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,s,Number(o))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new X9;return n&&(He("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),i&&(He("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),s&&(He("number"==typeof s,"internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new X9,this.toJSON())}_performRefresh(){return zc("not implemented")}}function pl(r,e){He("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class f0{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=Uu(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new JIe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new YQ(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){var t=this;return M(function*(){const n=yield Y3(t,t.stsTokenManager.getToken(t.auth,e));return He(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function KIe(r){return jA.apply(this,arguments)}(this,e)}reload(){return function eke(r){return XA.apply(this,arguments)}(this)}_assign(e){this!==e&&(He(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new f0(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){He(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return M(function*(){let i=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield K9(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return M(function*(){const t=yield e.getIdToken();return yield Y3(e,function jIe(r,e){return UA.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,o,a,c,l,f;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,m=null!==(i=t.email)&&void 0!==i?i:void 0,E=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,w=null!==(o=t.photoURL)&&void 0!==o?o:void 0,R=null!==(a=t.tenantId)&&void 0!==a?a:void 0,z=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,$=null!==(l=t.createdAt)&&void 0!==l?l:void 0,G=null!==(f=t.lastLoginAt)&&void 0!==f?f:void 0,{uid:de,emailVerified:ve,isAnonymous:xe,providerData:tt,stsTokenManager:pt}=t;He(de&&pt,e,"internal-error");const Cn=X9.fromJSON(this.name,pt);He("string"==typeof de,e,"internal-error"),pl(d,e.name),pl(m,e.name),He("boolean"==typeof ve,e,"internal-error"),He("boolean"==typeof xe,e,"internal-error"),pl(E,e.name),pl(w,e.name),pl(R,e.name),pl(z,e.name),pl($,e.name),pl(G,e.name);const Mt=new f0({uid:de,auth:e,email:m,emailVerified:ve,displayName:d,isAnonymous:xe,photoURL:w,phoneNumber:E,tenantId:R,stsTokenManager:Cn,createdAt:$,lastLoginAt:G});return tt&&Array.isArray(tt)&&(Mt.providerData=tt.map(Y2=>Object.assign({},Y2))),z&&(Mt._redirectEventId=z),Mt}static _fromIdTokenResponse(e,t,n=!1){return M(function*(){const i=new X9;i.updateFromServerResponse(t);const s=new f0({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield K9(s),s})()}}const KQ=new Map;function K3(r){j3(r instanceof Function,"Expected a class definition");let e=KQ.get(r);return e?(j3(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,KQ.set(r,e),e)}const XQ=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return M(function*(){return!0})()}_set(t,n){var i=this;return M(function*(){i.storage[t]=n})()}_get(t){var n=this;return M(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return M(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function K_(r,e,t){return`firebase:${r}:${e}:${t}`}class q5{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=K_(this.userKey,i.apiKey,s),this.fullPersistenceKey=K_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return M(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?f0._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return M(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return M(function*(){if(!t.length)return new q5(K3(XQ),e,n);const i=(yield Promise.all(t.map(function(){var l=M(function*(f){if(yield f._isAvailable())return f});return function(f){return l.apply(this,arguments)}}()))).filter(l=>l);let s=i[0]||K3(XQ);const o=K_(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const f=yield l._get(o);if(f){const d=f0._fromJSON(e,f);l!==s&&(a=d),s=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return s._shouldAllowMigration&&c.length?(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(function(){var l=M(function*(f){if(f!==s)try{yield f._remove(o)}catch{}});return function(f){return l.apply(this,arguments)}}())),new q5(s,e,n)):new q5(s,e,n)})()}}function QQ(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(JQ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rJ(e))return"Blackberry";if(iJ(e))return"Webos";if(JA(e))return"Safari";if((e.includes("chrome/")||eJ(e))&&!e.includes("edge/"))return"Chrome";if(nJ(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function JQ(r=N2()){return/firefox\//i.test(r)}function JA(r=N2()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eJ(r=N2()){return/crios\//i.test(r)}function tJ(r=N2()){return/iemobile/i.test(r)}function nJ(r=N2()){return/android/i.test(r)}function rJ(r=N2()){return/blackberry/i.test(r)}function iJ(r=N2()){return/webos/i.test(r)}function X_(r=N2()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function sJ(r=N2()){return X_(r)||nJ(r)||iJ(r)||rJ(r)||/windows phone/i.test(r)||tJ(r)}function oJ(r,e=[]){let t;switch(r){case"Browser":t=QQ(N2());break;case"Worker":t=`${QQ(N2())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${R6}/${n}`}function aJ(r,e){return tI.apply(this,arguments)}function tI(){return tI=M(function*(r,e){return Or(r,"GET","/v2/recaptchaConfig",lr(r,e))}),tI.apply(this,arguments)}function lJ(r){return void 0!==r&&void 0!==r.enterprise}class uJ{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState)}}function nI(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=ho("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",function cke(){var r,e;return null!==(e=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==e?e:document}().appendChild(n)})}function fJ(r){return`__${r}${Math.floor(1e6*Math.random())}`}class dJ{constructor(e){this.type="recaptcha-enterprise",this.auth=z2(e)}verify(e="verify",t=!1){var n=this;return M(function*(){function s(){return s=M(function*(a){if(!t){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=M(function*(l,f){aJ(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0!==d.recaptchaKey){const m=new uJ(d);return null==a.tenantId?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}f(new Error("recaptcha Enterprise site key undefined"))}).catch(d=>{f(d)})});return function(l,f){return c.apply(this,arguments)}}())}),s.apply(this,arguments)}function o(a,c,l){const f=window.grecaptcha;lJ(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(d=>{c(d)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return s.apply(this,arguments)})(n.auth).then(l=>{if(!t&&lJ(window.grecaptcha))o(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));nI("https://www.google.com/recaptcha/enterprise.js?render="+l).then(()=>{o(l,a,c)}).catch(f=>{c(f)})}}).catch(l=>{c(l)})})})()}}function gl(r,e,t){return rI.apply(this,arguments)}function rI(){return rI=M(function*(r,e,t,n=!1){const i=new dJ(r);let s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}const o=Object.assign({},e);return Object.assign(o,n?{captchaResp:s}:{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}),rI.apply(this,arguments)}class dke{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,a)=>{try{o(e(s))}catch(c){a(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return M(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const s of n)try{s()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}class hke{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hJ(this),this.idTokenSubscription=new hJ(this),this.beforeStateQueue=new dke(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=BQ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=K3(t)),this._initializationPromise=this.queue(M(function*(){var i,s;if(!n._deleted&&(n.persistenceManager=yield q5.create(n,e),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(s=n.currentUser)||void 0===s?void 0:s.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return M(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return M(function*(){var n;const i=yield t.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const a=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,c=s?._redirectEventId,l=yield t.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(s=l.user,o=!0)}if(!s)return t.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{yield t.beforeStateQueue.runMiddleware(s)}catch(a){s=i,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(a))}return s?t.reloadAndSetCurrentUserOrClear(s):t.directlySetCurrentUser(null)}return He(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===s._redirectEventId?t.directlySetCurrentUser(s):t.reloadAndSetCurrentUserOrClear(s)})()}tryRedirectSignIn(e){var t=this;return M(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return M(function*(){try{yield K9(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function BIe(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return M(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return M(function*(){const n=e?Mr(e):null;return n&&He(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return M(function*(){if(!n._deleted)return e&&He(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(M(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return M(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(M(function*(){yield t.assertedPersistence.setPersistence(K3(e))}))}initializeRecaptchaConfig(){var e=this;return M(function*(){const t=yield aJ(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new uJ(t);null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.emailPasswordEnabled&&new dJ(e).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pc("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return M(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return M(function*(){if(!t.redirectPersistenceManager){const n=e&&K3(e)||t._popupRedirectResolver;He(n,t,"argument-error"),t.redirectPersistenceManager=yield q5.create(t,[K3(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return M(function*(){var n,i;return t._isInitialized&&(yield t.queue(M(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return M(function*(){if(e===t.currentUser)return t.queue(M(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return He(o,this,"internal-error"),o.then(()=>s(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return M(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return He(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return M(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const i=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const s=yield e._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n})()}_getAppCheckToken(){var e=this;return M(function*(){var t;const n=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return n?.error&&function $Ie(r,...e){j_.logLevel<=Un.WARN&&j_.warn(`Auth (${R6}): ${r}`,...e)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function z2(r){return Mr(r)}class hJ{constructor(e){this.auth=e,this.observer=null,this.addObserver=function EMe(r,e){const t=new SMe(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return He(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function pJ(r,e,t){const n=z2(r);He(n._canInitEmulator,n,"emulator-config-failed"),He(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,s=gJ(e),{host:o,port:a}=function mke(r){const e=gJ(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:mJ(n.substr(s.length+1))}}{const[s,o]=n.split(":");return{host:s,port:mJ(o)}}}(e);n.config.emulator={url:`${s}//${o}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function _ke(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function gJ(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function mJ(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class iI{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return zc("not implemented")}_getIdTokenResponse(e){return zc("not implemented")}_linkToIdToken(e,t){return zc("not implemented")}_getReauthenticationResolver(e){return zc("not implemented")}}function oI(){return oI=M(function*(r,e){return Or(r,"POST","/v1/accounts:update",e)}),oI.apply(this,arguments)}function cI(r,e){return lI.apply(this,arguments)}function lI(){return lI=M(function*(r,e){return Z3(r,"POST","/v1/accounts:signInWithPassword",lr(r,e))}),lI.apply(this,arguments)}function Q_(r,e){return uI.apply(this,arguments)}function uI(){return uI=M(function*(r,e){return Or(r,"POST","/v1/accounts:sendOobCode",lr(r,e))}),uI.apply(this,arguments)}function fI(){return fI=M(function*(r,e){return Q_(r,e)}),fI.apply(this,arguments)}function dI(r,e){return hI.apply(this,arguments)}function hI(){return hI=M(function*(r,e){return Q_(r,e)}),hI.apply(this,arguments)}function _I(){return _I=M(function*(r,e){return Z3(r,"POST","/v1/accounts:signInWithEmailLink",lr(r,e))}),_I.apply(this,arguments)}function vI(){return vI=M(function*(r,e){return Z3(r,"POST","/v1/accounts:signInWithEmailLink",lr(r,e))}),vI.apply(this,arguments)}class Q9 extends iI{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Q9(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Q9(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return M(function*(){var n;switch(t.signInMethod){case"password":const i={returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=e._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const s=yield gl(e,i,"signInWithPassword");return cI(e,s)}return cI(e,i).catch(function(){var s=M(function*(o){if("auth/missing-recaptcha-token"===o.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const a=yield gl(e,i,"signInWithPassword");return cI(e,a)}return Promise.reject(o)});return function(o){return s.apply(this,arguments)}}());case"emailLink":return function Mke(r,e){return _I.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Hs(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return M(function*(){switch(n.signInMethod){case"password":return function vJ(r,e){return oI.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function Eke(r,e){return vI.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:Hs(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function X3(r,e){return CI.apply(this,arguments)}function CI(){return CI=M(function*(r,e){return Z3(r,"POST","/v1/accounts:signInWithIdp",lr(r,e))}),CI.apply(this,arguments)}class j5 extends iI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new j5(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Hs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=Uu(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new j5(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return X3(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,X3(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,X3(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=If(t)}return e}}class ed{constructor(e){var t,n,i,s,o,a;const c=kf(xf(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,f=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function Nke(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);He(l&&f&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=f,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function Ake(r){const e=kf(xf(r)).link,t=e?kf(xf(e)).deep_link_id:null,n=kf(xf(r)).deep_link_id;return(n?kf(xf(n)).link:null)||n||t||e||r}(e);try{return new ed(t)}catch{return null}}}let CJ=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(t,n){return Q9._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=ed.parseLink(n);return He(i,"argument-error"),Q9._fromEmailAndCode(t,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class ml{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class yJ extends ml{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let Ike=(()=>{class r extends yJ{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return j5._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function ev(r,e){return TI.apply(this,arguments)}function TI(){return TI=M(function*(r,e){return Z3(r,"POST","/v1/accounts:signUp",lr(r,e))}),TI.apply(this,arguments)}class Ho{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return M(function*(){const s=yield f0._fromIdTokenResponse(e,n,i),o=MJ(n);return new Ho({user:s,providerId:o,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return M(function*(){yield e._updateTokensIfNecessary(n,!0);const i=MJ(n);return new Ho({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function MJ(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class tv extends Ro{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,tv.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new tv(e,t,n,i)}}function EJ(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw"auth/multi-factor-auth-required"===s.code?tv._fromErrorAndOperation(r,s,e,n):s})}function NI(){return NI=M(function*(r,e,t=!1){const n=yield Y3(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return Ho._forOperation(r,"link",n)}),NI.apply(this,arguments)}function II(){return II=M(function*(r,e,t=!1){const{auth:n}=r,i="reauthenticate";try{const s=yield Y3(r,EJ(n,i,e,r),t);He(s.idToken,n,"internal-error");const o=Y_(s.idToken);He(o,n,"internal-error");const{sub:a}=o;return He(r.uid===a,n,"user-mismatch"),Ho._forOperation(r,i,s)}catch(s){throw"auth/user-not-found"===s?.code&&Hs(n,"user-mismatch"),s}}),II.apply(this,arguments)}function TJ(r,e){return kI.apply(this,arguments)}function kI(){return kI=M(function*(r,e,t=!1){const n="signIn",i=yield EJ(r,n,e),s=yield Ho._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(s.user)),s}),kI.apply(this,arguments)}function LI(){return LI=M(function*(r,e){return TJ(z2(r),e)}),LI.apply(this,arguments)}function Z5(r,e,t){var n;He((null===(n=t.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),He(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(He(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(He(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function Dke(r,e,t){return GI.apply(this,arguments)}function GI(){return GI=M(function*(r,e,t){var n;const i=z2(r),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const o=yield gl(i,s,"getOobCode",!0);t&&Z5(i,o,t),yield dI(i,o)}else t&&Z5(i,s,t),yield dI(i,s).catch(function(){var o=M(function*(a){if("auth/missing-recaptcha-token"!==a.code)return Promise.reject(a);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const c=yield gl(i,s,"getOobCode",!0);t&&Z5(i,c,t),yield dI(i,c)}});return function(a){return o.apply(this,arguments)}}())}),GI.apply(this,arguments)}function Vke(r,e,t){return jI.apply(this,arguments)}function jI(){return jI=M(function*(r,e,t){var n;const i=z2(r),s={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"};let o;if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const l=yield gl(i,s,"signUpPassword");o=ev(i,l)}else o=ev(i,s).catch(function(){var l=M(function*(f){if("auth/missing-recaptcha-token"===f.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const d=yield gl(i,s,"signUpPassword");return ev(i,d)}return Promise.reject(f)});return function(f){return l.apply(this,arguments)}}());const a=yield o.catch(l=>Promise.reject(l)),c=yield Ho._fromIdTokenResponse(i,"signIn",a);return yield i._updateCurrentUser(c.user),c}),jI.apply(this,arguments)}function Fke(r,e,t){return function xI(r,e){return LI.apply(this,arguments)}(Mr(r),CJ.credential(e,t))}function Gke(r,e){return QI.apply(this,arguments)}function QI(){return QI=M(function*(r,e){const t=Mr(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};e&&Z5(t.auth,i,e);const{email:s}=yield function Cke(r,e){return fI.apply(this,arguments)}(t.auth,i);s!==r.email&&(yield r.reload())}),QI.apply(this,arguments)}function ek(){return ek=M(function*(r,e){return Or(r,"POST","/v1/accounts:update",e)}),ek.apply(this,arguments)}function Uke(r,e){return tk.apply(this,arguments)}function tk(){return tk=M(function*(r,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const n=Mr(r),s={idToken:yield n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=yield Y3(n,function Bke(r,e){return ek.apply(this,arguments)}(n.auth,s));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(o)}),tk.apply(this,arguments)}function Qke(r,e,t,n){return Mr(r).onAuthStateChanged(e,t,n)}const rv="__sak";class bJ{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(rv,"1"),this.storage.removeItem(rv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const oxe=(()=>{class r extends bJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function rxe(){const r=N2();return JA(r)||X_(r)}()&&function oke(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=sJ(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),s=this.localCache[n];i!==s&&t(n,s,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=t.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)null!==t.newValue?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!n)return}const s=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);!function ske(){return function _Me(){const r=N2();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===t.newValue||t.newValue===t.oldValue?s():setTimeout(s,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,s=this;return M(function*(){yield i().call(s,t,n),s.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return M(function*(){const s=yield n().call(i,t);return i.localCache[t]=JSON.stringify(s),s})()}_remove(t){var n=()=>super._remove,i=this;return M(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),wJ=(()=>{class r extends bJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let cxe=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(s=>s.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return M(function*(){const i=t,{eventId:s,eventType:o,data:a}=i.data,c=n.handlersMap[o];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const l=Array.from(c).map(function(){var d=M(function*(m){return m(i.origin,a)});return function(m){return d.apply(this,arguments)}}()),f=yield function axe(r){return Promise.all(r.map(function(){var e=M(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:f})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function iv(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class lxe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var i=this;return M(function*(){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((c,l)=>{const f=iv("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(m){const E=m;if(E.data.eventId===f)switch(E.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(E.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"))}}},i.handlers.add(a),s.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function t2(){return window}function ck(){return typeof t2().WorkerGlobalScope<"u"&&"function"==typeof t2().importScripts}function lk(){return(lk=M(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const NJ="firebaseLocalStorageDb",sv="firebaseLocalStorage",AJ="fbase_key";class nd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ov(r,e){return r.transaction([sv],e?"readwrite":"readonly").objectStore(sv)}function uk(){const r=indexedDB.open(NJ,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(sv,{keyPath:AJ})}catch(i){t(i)}}),r.addEventListener("success",M(function*(){const n=r.result;n.objectStoreNames.contains(sv)?e(n):(n.close(),yield function gxe(){const r=indexedDB.deleteDatabase(NJ);return new nd(r).toPromise()}(),e(yield uk()))}))})}function IJ(r,e,t){return fk.apply(this,arguments)}function fk(){return fk=M(function*(r,e,t){const n=ov(r,!0).put({[AJ]:e,value:t});return new nd(n).toPromise()}),fk.apply(this,arguments)}function dk(){return dk=M(function*(r,e){const t=ov(r,!1).get(e),n=yield new nd(t).toPromise();return void 0===n?null:n.value}),dk.apply(this,arguments)}function kJ(r,e){const t=ov(r,!0).delete(e);return new nd(t).toPromise()}const Cxe=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return M(function*(){return t.db||(t.db=yield uk()),t.db})()}_withRetries(t){var n=this;return M(function*(){let i=0;for(;;)try{const s=yield n._openDb();return yield t(s)}catch(s){if(i++>3)throw s;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return M(function*(){return ck()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return M(function*(){t.receiver=cxe._getInstance(function hxe(){return ck()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=M(function*(i,s){return{keyProcessed:(yield t._poll()).includes(s.key)}});return function(i,s){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=M(function*(i,s){return["keyChanged"]});return function(i,s){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return M(function*(){var n,i;if(t.activeServiceWorker=yield function fxe(){return lk.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new lxe(t.activeServiceWorker);const s=yield t.sender._send("ping",{},800);s&&null!==(n=s[0])&&void 0!==n&&n.fulfilled&&null!==(i=s[0])&&void 0!==i&&i.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return M(function*(){if(n.sender&&n.activeServiceWorker&&function dxe(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return M(function*(){try{if(!indexedDB)return!1;const t=yield uk();return yield IJ(t,rv,"1"),yield kJ(t,rv),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return M(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return M(function*(){return i._withPendingWrite(M(function*(){return yield i._withRetries(s=>IJ(s,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return M(function*(){const i=yield n._withRetries(s=>function mxe(r,e){return dk.apply(this,arguments)}(s,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return M(function*(){return n._withPendingWrite(M(function*(){return yield n._withRetries(i=>kJ(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return M(function*(){const n=yield t._withRetries(o=>{const a=ov(o,!1).getAll();return new nd(a).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],s=new Set;for(const{fbase_key:o,value:a}of n)s.add(o),JSON.stringify(t.localCache[o])!==JSON.stringify(a)&&(t.notifyListeners(o,a),i.push(o));for(const o of Object.keys(t.localCache))t.localCache[o]&&!s.has(o)&&(t.notifyListeners(o,null),i.push(o));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(M(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function h0(r,e){return e?K3(e):(He(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}fJ("rcb"),new j9(3e4,6e4);class Mk extends iI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return X3(e,this._buildIdpRequest())}_linkToIdToken(e,t){return X3(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return X3(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Rxe(r){return TJ(r.auth,new Mk(r),r.bypassAuthState)}function zxe(r){const{auth:e,user:t}=r;return He(t,e,"internal-error"),function PJ(r,e){return II.apply(this,arguments)}(t,new Mk(r),r.bypassAuthState)}function Dxe(r){return Ek.apply(this,arguments)}function Ek(){return Ek=M(function*(r){const{auth:e,user:t}=r;return He(t,e,"internal-error"),function wI(r,e){return NI.apply(this,arguments)}(t,new Mk(r),r.bypassAuthState)}),Ek.apply(this,arguments)}class LJ{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=M(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(s){e.reject(s)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return M(function*(){const{urlResponse:n,sessionId:i,postBody:s,tenantId:o,error:a,type:c}=e;if(a)return void t.reject(a);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(c)(l))}catch(f){t.reject(f)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Rxe;case"linkViaPopup":case"linkViaRedirect":return Dxe;case"reauthViaPopup":case"reauthViaRedirect":return zxe;default:Hs(this.auth,"internal-error")}}resolve(e){j3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){j3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Hxe=new j9(2e3,1e4);function Vxe(r,e,t){return Sk.apply(this,arguments)}function Sk(){return Sk=M(function*(r,e,t){const n=z2(r);!function W5(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Hs(r,"argument-error"),UQ(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,ml);const i=h0(n,t);return new Ok(n,"signInViaPopup",e,i).executeNotNull()}),Sk.apply(this,arguments)}let Ok=(()=>{class r extends LJ{constructor(t,n,i,s,o){super(t,n,s,o),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return M(function*(){const n=yield t.execute();return He(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return M(function*(){j3(1===t.filter.length,"Popup operations only handle one event");const n=iv();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject(ho(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(ho(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(ho(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,Hxe.get())};t()}}return r.currentPopupAction=null,r})();const Fxe="pendingRedirect",rd=new Map;class $xe extends LJ{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return M(function*(){let n=rd.get(t.auth._key());if(!n){try{const s=(yield function Gxe(r,e){return bk.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(s)}catch(i){n=()=>Promise.reject(i)}rd.set(t.auth._key(),n)}return t.bypassAuthState||rd.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return M(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return M(function*(){})()}cleanUp(){}}function bk(){return bk=M(function*(r,e){const t=function zJ(r){return K_(Fxe,r.config.apiKey,r.name)}(e),n=function RJ(r){return K3(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i}),bk.apply(this,arguments)}function Bxe(r,e){rd.set(r._key(),e)}function DJ(r,e){return Lk.apply(this,arguments)}function Lk(){return Lk=M(function*(r,e,t=!1){const n=z2(r),i=h0(n,e),o=yield new $xe(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield n._persistUserIfCurrent(o.user),yield n._setRedirectUser(null,e)),o}),Lk.apply(this,arguments)}class Zxe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function Yxe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return FJ(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!FJ(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ho(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(VJ(e))}saveEventToCache(e){this.cachedEventUids.add(VJ(e)),this.lastProcessedEventTime=Date.now()}}function VJ(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function FJ({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function zk(){return zk=M(function*(r,e={}){return Or(r,"GET","/v1/projects",e)}),zk.apply(this,arguments)}const Xxe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qxe=/^https?/;function Dk(){return Dk=M(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function Kxe(r){return zk.apply(this,arguments)}(r);for(const t of e)try{if(eLe(t))return}catch{}Hs(r,"unauthorized-domain")}),Dk.apply(this,arguments)}function eLe(r){const e=q9(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return""===o.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&o.hostname===n}if(!Qxe.test(t))return!1;if(Xxe.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const tLe=new j9(3e4,6e4);function $J(){const r=t2().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}let cv=null;const iLe=new j9(5e3,15e3),sLe="__/auth/iframe",oLe="emulator/auth/iframe",aLe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cLe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lLe(r){const e=r.config;He(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?FA(e,oLe):`https://${r.config.authDomain}/${sLe}`,n={apiKey:e.apiKey,appName:r.name,v:R6},i=cLe.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${If(n).slice(1)}`}function Hk(){return Hk=M(function*(r){const e=yield function rLe(r){return cv=cv||function nLe(r){return new Promise((e,t)=>{var n,i,s;function o(){$J(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{$J(),t(ho(r,"network-request-failed"))},timeout:tLe.get()})}if(null!==(i=null===(n=t2().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)e(gapi.iframes.getContext());else{if(null===(s=t2().gapi)||void 0===s||!s.load){const a=fJ("iframefcb");return t2()[a]=()=>{gapi.load?o():t(ho(r,"network-request-failed"))},nI(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}o()}}).catch(e=>{throw cv=null,e})}(r),cv}(r),t=t2().gapi;return He(t,r,"internal-error"),e.open({where:document.body,url:lLe(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:aLe,dontclear:!0},n=>new Promise(function(){var i=M(function*(s,o){yield n.restyle({setHideOnLeave:!1});const a=ho(r,"network-request-failed"),c=t2().setTimeout(()=>{o(a)},iLe.get());function l(){t2().clearTimeout(c),s(n)}n.ping(l).then(l,()=>{o(a)})});return function(s,o){return i.apply(this,arguments)}}()))}),Hk.apply(this,arguments)}const fLe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class GJ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const vLe="__/auth/handler",CLe="emulator/auth/handler",yLe=encodeURIComponent("fac");function BJ(r,e,t,n,i,s){return Vk.apply(this,arguments)}function Vk(){return Vk=M(function*(r,e,t,n,i,s){He(r.config.authDomain,r,"auth-domain-config-required"),He(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:R6,eventId:i};if(e instanceof ml){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",function MMe(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries(s||{}))o[f]=d}if(e instanceof yJ){const f=e.getScopes().filter(d=>""!==d);f.length>0&&(o.scopes=f.join(","))}r.tenantId&&(o.tid=r.tenantId);const a=o;for(const f of Object.keys(a))void 0===a[f]&&delete a[f];const c=yield r._getAppCheckToken(),l=c?`#${yLe}=${encodeURIComponent(c)}`:"";return`${function MLe({config:r}){return r.emulator?FA(r,CLe):`https://${r.authDomain}/${vLe}`}(r)}?${If(a).slice(1)}${l}`}),Vk.apply(this,arguments)}const Fk="webStorageSupport",SLe=class ELe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wJ,this._completeRedirectFn=DJ,this._overrideRedirectResult=Bxe}_openPopup(e,t,n,i){var s=this;return M(function*(){var o;j3(null===(o=s.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const a=yield BJ(e,t,n,q9(),i);return function mLe(r,e,t,n=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},fLe),{width:n.toString(),height:i.toString(),top:s,left:o}),l=N2().toLowerCase();t&&(a=eJ(l)?"_blank":t),JQ(l)&&(e=e||"http://localhost",c.scrollbars="yes");const f=Object.entries(c).reduce((m,[E,w])=>`${m}${E}=${w},`,"");if(function ike(r=N2()){var e;return X_(r)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(l)&&"_self"!==a)return function _Le(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",a),new GJ(null);const d=window.open(e||"",a,f);He(d,r,"popup-blocked");try{d.focus()}catch{}return new GJ(d)}(e,a,iv())})()}_openRedirect(e,t,n,i){var s=this;return M(function*(){return yield s._originValidation(e),function uxe(r){t2().location.href=r}(yield BJ(e,t,n,q9(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(j3(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return M(function*(){const n=yield function uLe(r){return Hk.apply(this,arguments)}(e),i=new Zxe(e);return n.register("authEvent",s=>(He(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fk,{type:Fk},i=>{var s;const o=null===(s=i?.[0])||void 0===s?void 0:s[Fk];void 0!==o&&t(!!o),Hs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function Jxe(r){return Dk.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return sJ()||JA()||X_()}};var qJ="@firebase/auth";class PLe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return M(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){He(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const wLe=Cq("authIdTokenMaxAge")||300;let ZJ=null;const NLe=r=>function(){var e=M(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>wLe)return;const s=n?.token;ZJ!==s&&(ZJ=s,yield fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function ALe(r=oT()){const e=t5(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function pke(r,e){const t=t5(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(rm(t.getOptions(),e??{}))return i;Hs(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:SLe,persistence:[Cxe,oxe,wJ]}),n=Cq("authTokenSyncURL");if(n){const s=NLe(n);(function Xke(r,e,t){Mr(r).beforeAuthStateChanged(e,t)})(t,s,()=>s(t.currentUser)),function Kke(r,e,t,n){Mr(r).onIdTokenChanged(e,t,n)}(t,o=>s(o))}const i=_q("auth");return i&&pJ(t,`http://${i}`),t}!function OLe(r){ls(new ki("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;He(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oJ(r)},l=new hke(n,i,s,c);return function gke(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(K3);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ls(new ki("auth-internal",e=>{const t=z2(e.getProvider("auth").getImmediate());return new PLe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Er(qJ,"0.23.2",function TLe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),Er(qJ,"0.23.2","esm2017")}("Browser");class uv{constructor(e){return e}}class KJ{constructor(){return dA("auth")}}const Gk=new et("angularfire2.auth-instances");function kLe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new uv(n)}}const xLe={provide:KJ,deps:[[new is,Gk]]},LLe={provide:uv,useFactory:function ILe(r,e){const t=fA("auth",r,e);return t&&new uv(t)},deps:[[new is,Gk],B5]};let RLe=(()=>{class r{constructor(){Er("angularfire",V_.full,"auth")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({providers:[LLe,xLe]}),r})();const HLe=B1(Vke,!0),VLe=B1(ALe,!0),FLe=B1(Qke,!0),$Le=B1(Gke,!0),GLe=B1(Dke,!0),BLe=B1(Fke,!0),ULe=B1(Vxe,!0),WLe=B1(Uke,!0);class _l{constructor(e){return e}}const XJ="firestore",Bk=new et("angularfire2.firestore-instances");function ZLe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new _l(n)}}const YLe={provide:class qLe{constructor(){return dA(XJ)}},deps:[[new is,Bk]]},KLe={provide:_l,useFactory:function jLe(r,e){const t=fA(XJ,r,e);return t&&new _l(t)},deps:[[new is,Bk],B5]};let XLe=(()=>{class r{constructor(){Er("angularfire",V_.full,"fst")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({providers:[KLe,YLe]}),r})();const JLe=B1(gbe,!0),eRe=B1(UOe,!0),nRe=B1(pbe,!0),id=B1(WK,!0),rRe=B1(ube,!0),iRe=B1(fbe,!0),sRe=B1(jOe,!0),oRe=B1(obe,!0),QJ=B1(mbe,!0),aRe=B1(sbe,!0),fv=B1(rbe,!0),cRe=B1(dbe,!0),lRe=B1(hbe,!0),uRe=B1(ibe,!0);class p0{constructor(e,t){u(this,"collectionName",void 0),u(this,"firestore",void 0),u(this,"collection",void 0),u(this,"subDAOs",{}),this.collectionName=e,this.firestore=t;this.collection=eRe(t,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var t=this;return M(function*(){return(yield JLe(t.collection,e)).id})()}read(e){var t=this;return M(function*(){const n=yield rRe(id(t.collection,e));return n.exists()?g.of(U.getNonNullable(n.data())):g.empty()})()}exists(e){var t=this;return M(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return M(function*(){return lRe(id(n.collection,e),t)})()}delete(e){return nRe(id(this.collection,e))}set(e,t){return cRe(id(this.collection,e),t)}subscribeToChanges(e,t){return new Mn(QJ(id(this.collection,e),n=>{t(g.ofNullable(n.data()))}))}findWhere(e,t,n){var i=this;return M(function*(){const s=i.constructQuery(e,t,n);return(yield iRe(s)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(e,t,n){const i=this.constructQuery(e,n);return new Mn(QJ(i,s=>{const o=[],a=[],c=[];s.docChanges().forEach(l=>{const f={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":o.push(f);break;case"modified":a.push(f);break;case"removed":c.push(f)}}),o.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+o.length+" NEW "+this.collectionName),t.onDocumentCreated(o)),a.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),t.onDocumentModified(a)),c.length>0&&(Ne.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),t.onDocumentDeleted(c))}))}constructQuery(e,t,n){let i=fv(this.collection);null!=t&&(i=fv(i,aRe(t))),null!=n&&(i=fv(i,oRe(n)));for(const s of e)i=fv(i,uRe(s[0],s[1],s[2]));return i}subCollectionDAO(e,t){const n=`${this.collection.path}/${e}/${t}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends p0{constructor(s){super(n,s)}}(this.firestore);return this.subDAOs[n]=i,i}}}let fRe=(()=>{var r;class e extends p0{constructor(n){super("errors",n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(_l))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var dRe=Po(1);let Ut=(()=>{var r;class e{infoMessage(n){this.message(n,"is-info")}gameMessage(n){this.message(n,"is-warning")}criticalMessage(n){this.message(n,"is-danger")}message(n,i){const s=this.getDuration(n);this.toast(n,i,s)}toast(n,i,s){(0,dRe.toast)({message:n,duration:s,type:i,position:"top-center",closeOnClick:!0,dismissible:!0})}getDuration(n){const i=n.split(" ").length;return Math.max(60*i*1e3/150,3e3)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var dv,g0;class h2{static setSingletonInstance(e){h2.singleton=g.of(e)}static logErrorAndFail(e,t,n){throw h2.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),b.failure(e+": "+t)}constructor(e,t,n){u(this,"errorDAO",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),this.errorDAO=e,this.router=t,this.messageDisplayer=n,h2.setSingletonInstance(this)}findErrors(e,t,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",i]])}logError(e,t,n){var i=this;return M(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const s=i.router.url,o=yield i.findErrors(e,s,t,n);if(0===o.length){const a={component:e,route:s,message:t,firstEncounter:xc(),lastEncounter:xc(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=o[0].id,c=o[0].data;yield i.errorDAO.update(a,{lastEncounter:xc(),occurences:c.occurences+1})}})()}}dv=h2,u(h2,"singleton",g.empty()),u(h2,"\u0275fac",function(e){return new(e||dv)(Pe(fRe),Pe(Bn),Pe(Ut))}),u(h2,"\u0275prov",De({token:dv,factory:dv.\u0275fac,providedIn:"root"}));class Ne{static enableLog(e,t,n){const i=localStorage.getItem("verbosity");let s={};null!=i&&(s=JSON.parse(i)),n?s[t+"."+n]=e:s[t]=e,localStorage.setItem("verbosity",JSON.stringify(s))}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];const n=JSON.parse(t);return null==n[e]?[!1,!1]:(U.assert(Array.isArray(n[e]),`malformed verbosity levels: ${n[e]}`),n[e])}static isMethodVerboseEntry(e,t){return Ne.isVerbose(e)[0]||Ne.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return Ne.isVerbose(e)[1]||Ne.isVerbose(e+"."+t)[1]}static display(e,t,n){Ne.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${n}`)}static log(e){const t=e.name;for(const n of Object.getOwnPropertyNames(e.prototype)){const i=Object.getOwnPropertyDescriptor(e.prototype,n),s=U.getNonNullable(i);U.assert(s.value instanceof Function,"cannot add logging to properties that are not methods!");const a=s.value;s.value=function(...c){if(Ne.isMethodVerboseEntry(t,n)){const f=Array.from(c).map(d=>JSON.stringify(d)).join(", ");console.log(`> ${t}.${n}(${f})`)}const l=a.apply(this,c);return Ne.isMethodVerboseExit(t,n)&&console.log(`< ${t}.${n} -> ${JSON.stringify(l)}`),l},Object.defineProperty(e.prototype,n,s)}}}window.enableLog=Ne.enableLog;class U{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const i of t)if(e===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw h2.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let Uk=(u(g0=class extends p0{constructor(e){super("chats",e)}},"\u0275fac",function(e){return new(e||g0)(Pe(_l))}),u(g0,"\u0275prov",De({token:g0,factory:g0.\u0275fac,providedIn:"root"})),g0);var m0;Uk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Uk);let JJ=(()=>{class r{}return u(r,"CANNOT_SEND_MESSAGE",()=>$localize`You're not allowed to send a message here.`),u(r,"FORBIDDEN_MESSAGE",()=>$localize`This message is forbidden.`),r})(),Y5=(m0=class{constructor(e){u(this,"chatDAO",void 0),this.chatDAO=e}addMessage(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return M(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return M(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return M(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,i){var s=this;return M(function*(){if(!1===s.userCanSendMessage(t.name,e))return b.failure(JJ.CANNOT_SEND_MESSAGE());if(s.isForbiddenMessage(n))return b.failure(JJ.FORBIDDEN_MESSAGE());const o={content:n,sender:t,postedTime:xc(),currentTurn:i};return yield s.addMessage(e,o),b.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}},u(m0,"\u0275fac",function(e){return new(e||m0)(Pe(Uk))}),u(m0,"\u0275prov",De({token:m0,factory:m0.\u0275fac,providedIn:"root"})),m0);function je(r,e,t){if(!1===r)throw void 0!==t&&console.log(t),h2.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var Q3,Wk;Y5=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Y5);let sd=(Wk=Q3=class extends p0{constructor(e){super(Wk.COLLECTION_NAME,e)}},u(Q3,"COLLECTION_NAME","users"),u(Q3,"\u0275fac",function(e){return new(e||Q3)(Pe(_l))}),u(Q3,"\u0275prov",De({token:Q3,factory:Q3.\u0275fac,providedIn:"root"})),Q3);sd=Wk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],sd);let K5=(()=>{var r;class e{constructor(n){u(this,"userDAO",void 0),this.userDAO=n}usernameIsAvailable(n){var i=this;return M(function*(){return 0===(yield i.userDAO.findWhere([["username","==",n]])).length})()}setUsername(n,i){var s=this;return M(function*(){yield s.userDAO.update(n,{username:i})})()}markAsVerified(n){var i=this;return M(function*(){yield i.userDAO.update(n,{verified:!0})})()}observeUserOnServer(n,i){return this.userDAO.subscribeToChanges(n,s=>{s.isPresent()&&null===s.get().lastUpdateTime||i(s)})}getUserLastUpdateTime(n){var i=this;return M(function*(){const s=yield i.userDAO.read(n);if(s.isAbsent())return g.empty();{const o=s.get().lastUpdateTime;return je(null!=o,"should not receive a lastUpdateTime equal to null"),g.of(o)}})()}updatePresenceToken(n){return this.userDAO.update(n,{lastUpdateTime:xc()})}getServerTime(n){var i=this;return M(function*(){return new Promise(s=>{let o=!1;const c=i.userDAO.subscribeToChanges(n,l=>{null==l.get().lastUpdateTime?o=!0:o&&(c.unsubscribe(),s(l.get().lastUpdateTime))});i.updatePresenceToken(n)})})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(sd))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();class eee extends Ps{constructor(e=1/0,t=1/0,n=rA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!i&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!i){const o=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=o;c+=2)a=c;a&&n.splice(0,a+1)}}}var _0;let od=(()=>{class r{}return u(r,"YOU_ARE_ALREADY_PLAYING",()=>$localize`You are already playing in another game.`),u(r,"YOU_ARE_ALREADY_CREATING",()=>$localize`You are already the creator of another game.`),u(r,"YOU_ARE_ALREADY_CHOSEN_OPPONENT",()=>$localize`You are already the chosen opponent in another game.`),u(r,"YOU_ARE_ALREADY_CANDIDATE",()=>$localize`You are already candidate in another game.`),u(r,"YOU_ARE_ALREADY_OBSERVING",()=>$localize`You are already observing another game.`),r})();class vl{static createUserWithEmailAndPassword(e,t,n){return HLe(e,t,n)}static sendEmailVerification(e){return $Le(e)}static sendPasswordResetEmail(e,t){return GLe(e,t)}static signInWithEmailAndPassword(e,t,n){return M(function*(){return(yield BLe(e,t,n)).user})()}static signInWithPopup(e,t){return M(function*(){return(yield ULe(e,t)).user})()}static updateProfile(e,t){return WLe(e,t)}}class v0{constructor(e,t,n,i){u(this,"id",void 0),u(this,"email",void 0),u(this,"username",void 0),u(this,"verified",void 0),this.id=e,this.email=t,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}u(v0,"NOT_CONNECTED",new v0("",g.empty(),g.empty(),!1));let ur=(_0=class{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"auth",void 0),u(this,"authSubscription",void 0),u(this,"user",g.empty()),u(this,"userRS",void 0),u(this,"userObs",void 0),u(this,"userSubscription",new Mn),this.userDAO=e,this.userService=t,this.auth=n,this.userRS=new eee(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new Mn(FLe(this.auth,function(){var s=M(function*(o){null==o?(Ne.display("ConnectedUserService","subscription","User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(v0.NOT_CONNECTED),i.user=g.empty()):(je(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(o.uid,a=>{if(a.isPresent()){const c=a.get(),l=c.username;Ne.display("ConnectedUserService","subscription",`User ${l} is connected, and the verified status is ${i.emailVerified(o)}`);const f=!0===i.emailVerified(o)&&null!=l;if(!0===f&&!1===c.verified)return i.userService.markAsVerified(o.uid);const d=new v0(o.uid,g.ofNullable(o.email),g.ofNullable(l),f);!1===i.user.equalsValue(d)&&(i.user=g.of(d),i.userRS.next(d))}}))});return function(o){return s.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return M(function*(){try{return yield vl.sendPasswordResetEmail(t.auth,e),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}doRegister(e,t,n){var i=this;return M(function*(){return(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,t,n):re.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var i=this;return M(function*(){try{const s=yield vl.createUserWithEmailAndPassword(i.auth,t,n);yield vl.signInWithEmailAndPassword(i.auth,t,n);const o=U.getNonNullable(s.user);return yield i.createUser(o.uid,e),re.success(o)}catch(s){return re.failure(i.mapFirebaseError(s))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return h2.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return M(function*(){const t=g.ofNullable(e.auth.currentUser);if(!t.isPresent())return h2.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return h2.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield vl.sendEmailVerification(t.get()),b.SUCCESS}catch(n){return b.failure(e.mapFirebaseError(n))}})()}doEmailLogin(e,t){var n=this;return M(function*(){try{return yield vl.signInWithEmailAndPassword(n.auth,e,t),b.SUCCESS}catch(i){return b.failure(n.mapFirebaseError(i))}})()}createUser(e,t){var n=this;return M(function*(){null==t?yield n.userDAO.set(e,{verified:!1,currentGame:null}):yield n.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return M(function*(){return b.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return M(function*(){try{const t=new Ike;t.addScope("profile"),t.addScope("email");const n=yield vl.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),re.success(n)}catch(t){return re.failure(e.mapFirebaseError(t))}})()}disconnect(){var e=this;return M(function*(){return g.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),b.SUCCESS):b.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return M(function*(){if(""===e)return b.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return b.failure($localize`This username is already in use, please select a different one.`);const i=U.getNonNullable(t.auth.currentUser);return yield vl.updateProfile(i,{displayName:e}),yield t.userService.setUsername(i.uid,e),yield t.userService.markAsVerified(i.uid),yield t.reloadUser(),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}setPicture(e){var t=this;return M(function*(){try{const n=U.getNonNullable(t.auth.currentUser);return yield vl.updateProfile(n,{photoURL:e}),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}reloadUser(){var e=this;return M(function*(){const t=U.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return je(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}},u(_0,"\u0275fac",function(e){return new(e||_0)(Pe(sd),Pe(K5),Pe(uv))}),u(_0,"\u0275prov",De({token:_0,factory:_0.\u0275fac,providedIn:"root"})),_0);var J3,pv,gv,ad,X5,Y,C0;ur=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],ur);class L1{constructor(e){u(this,"value",void 0),this.value=e}}u(L1,"HARD_DRAW",new(J3=L1)(0)),u(L1,"RESIGN",new J3(1)),u(L1,"ESCAPE",new J3(2)),u(L1,"VICTORY",new J3(3)),u(L1,"TIMEOUT",new J3(4)),u(L1,"UNACHIEVED",new J3(5)),u(L1,"AGREED_DRAW_BY_ZERO",new J3(6)),u(L1,"AGREED_DRAW_BY_ONE",new J3(7));class hv{constructor(e,t){u(this,"id",void 0),u(this,"data",void 0),this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===L1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===L1.AGREED_DRAW_BY_ZERO.value||this.data.result===L1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===L1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(je(this.data.result===L1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),U.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===L1.VICTORY.value}isTimeout(){return this.data.result===L1.TIMEOUT.value}isResign(){return this.data.result===L1.RESIGN.value}getWinner(){return g.ofNullable(this.data.winner)}getLoser(){return g.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new hv(this.id,{...this.data,winner:e,loser:t})}}class D2{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"CREATOR":return D2.CREATOR;case"RANDOM":return D2.RANDOM;default:return je("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),D2.CHOSEN_PLAYER}}}u(D2,"CREATOR",new(pv=D2)("CREATOR")),u(D2,"RANDOM",new pv("RANDOM")),u(D2,"CHOSEN_PLAYER",new pv("CHOSEN_PLAYER"));class fr{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"STANDARD":return fr.STANDARD;case"BLITZ":return fr.BLITZ;case"CUSTOM":return fr.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}u(fr,"STANDARD",new(gv=fr)("STANDARD")),u(fr,"BLITZ",new gv("BLITZ")),u(fr,"CUSTOM",new gv("CUSTOM")),u(fr,"NORMAL_MOVE_DURATION",120),u(fr,"NORMAL_PART_DURATION",1800),u(fr,"BLITZ_MOVE_DURATION",30),u(fr,"BLITZ_PART_DURATION",900);class fi{constructor(e){u(this,"value",void 0),this.value=e}}u(fi,"PART_CREATED",new(ad=fi)(0)),u(fi,"CONFIG_PROPOSED",new ad(2)),u(fi,"PART_STARTED",new ad(3)),u(fi,"PART_FINISHED",new ad(4));class qk{constructor(){u(this,"value",2)}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}u(qk,"NONE",new qk);class k{static of(e){return 0===e?k.ZERO:(U.expectToBe(e,1),k.ONE)}static ofTurn(e){return e%2==0?k.ZERO:k.ONE}constructor(e){u(this,"value",void 0),this.value=e}isPlayer(){return!0}toString(){return this===k.ZERO?"PLAYER_ZERO":(U.expectToBe(this,k.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getVictoryValue(){return this===k.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===k.ZERO?k.ONE:(U.expectToBe(this,k.ONE),k.ZERO)}}X5=k,u(k,"encoder",we.tuple([we.identity()],r=>[r.value],r=>X5.of(r[0]))),u(k,"ZERO",new X5(0)),u(k,"ONE",new X5(1)),u(k,"PLAYERS",[X5.ZERO,X5.ONE]),function(r){r.ZERO=k.ZERO,r.ONE=k.ONE,r.NONE=qk.NONE,r.encoder=new class extends we{encode(e){return e.value}decode(e){return 2===e?r.NONE:(U.assert(0===e||1===e,"Invalid encoded player: "+e),k.of(e))}}}(Y||(Y={}));let cd=(u(C0=class extends p0{constructor(e){super("parts",e)}},"\u0275fac",function(e){return new(e||C0)(Pe(_l))}),u(C0,"\u0275prov",De({token:C0,factory:C0.\u0275fac,providedIn:"root"})),C0);cd=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],cd);class mv{constructor(e,t,n){u(this,"onDocumentCreated",void 0),u(this,"onDocumentModified",void 0),u(this,"onDocumentDeleted",void 0),this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let jk=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}eventsCollection(n){return this.partDAO.subCollectionDAO(n,"events")}addEvent(n,i){return this.eventsCollection(n).create(i)}addMove(n,i,s){return this.addEvent(n,{eventType:"Move",time:xc(),player:i.value,move:s})}addRequest(n,i,s){return this.addEvent(n,{eventType:"Request",time:xc(),player:i.value,requestType:s})}addReply(n,i,s,o,a=null){return this.addEvent(n,{eventType:"Reply",time:xc(),player:i.value,reply:s,requestType:o,data:a})}startGame(n,i){return this.addAction(n,i,"StartGame")}addAction(n,i,s){return this.addEvent(n,{eventType:"Action",time:xc(),player:i.value,action:s})}subscribeToEvents(n,i){const s=new mv(o=>{const a=o.map(c=>c.data).filter(c=>null!=c.time);a.length>0&&i(a)},o=>{i(o.map(a=>a.data))},()=>{});return this.eventsCollection(n).observingWhere([],s,"time")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(cd))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var y0;let Zk=(u(y0=class extends p0{constructor(e){super("config-room",e)}},"\u0275fac",function(e){return new(e||y0)(Pe(_l))}),u(y0,"\u0275prov",De({token:y0,factory:y0.\u0275fac,providedIn:"root"})),y0);var e4,Yk;Zk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Zk);let ld=(e4=class{constructor(e,t){u(this,"configRoomDAO",void 0),u(this,"connectedUserService",void 0),this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const i=new mv(o=>{for(const a of o)n.push(a.data);t(n)},o=>{for(const a of o)n=n.map(c=>c.id===a.data.id?a.data:c);t(n)},o=>{for(const a of o)n=n.filter(c=>c.id!==a.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser();return t.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:D2.RANDOM.value,partType:fr.STANDARD.value,partStatus:fi.PART_CREATED.value,maximalMoveDuration:fr.NORMAL_MOVE_DURATION,totalPartDuration:fr.NORMAL_PART_DURATION,creator:n})})()}joinGame(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);return i.isAbsent()?b.failure(Yk.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield t.addCandidate(e,n)),b.SUCCESS)})()}cancelJoining(e){var t=this;return M(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);if(!i.isAbsent()){const s=i.get(),o=[t.removeCandidate(e,n)];s.chosenOpponent?.id===n.id&&o.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:fi.PART_CREATED.value})),yield Promise.all(o)}})()}deleteConfigRoom(e,t){var n=this;return M(function*(){yield Promise.all(t.map(i=>n.removeCandidate(e,i))),yield n.configRoomDAO.delete(e)})()}proposeConfig(e,t,n,i,s,o){var a=this;return M(function*(){return a.configRoomDAO.update(e,{partStatus:fi.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:s.value})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:fi.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return M(function*(){return t.configRoomDAO.update(e,{partStatus:fi.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:fi.PART_STARTED.value})}createConfigRoom(e,t){var n=this;return M(function*(){return n.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return M(function*(){return(yield t.configRoomDAO.read(e)).get()})()}},Yk=e4,u(e4,"GAME_DOES_NOT_EXIST",()=>$localize`Game does not exist`),u(e4,"\u0275fac",function(e){return new(e||e4)(Pe(Zk),Pe(ur))}),u(e4,"\u0275prov",De({token:e4,factory:e4.\u0275fac,providedIn:"root"})),e4);var M0;ld=Yk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],ld);let Q5=(M0=class{constructor(e,t,n,i,s){u(this,"partDAO",void 0),u(this,"gameEventService",void 0),u(this,"connectedUserService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),this.partDAO=e,this.gameEventService=t,this.connectedUserService=n,this.configRoomService=i,this.chatService=s}update(e,t){var n=this;return M(function*(){return n.partDAO.update(e,t)})()}getPartValidity(e,t){var n=this;return M(function*(){const i=yield n.partDAO.read(e);return i.isAbsent()?b.failure("NONEXISTENT_PART"):i.get().typeGame===t?b.SUCCESS:b.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){const t=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:L1.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return M(function*(){const n=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(n),yield t.createChat(n),n})()}getStartingConfig(e){let n,i,t=D2.of(e.firstPlayer);return t===D2.RANDOM&&(t=Math.random()<.5?D2.CREATOR:D2.CHOSEN_PLAYER),t===D2.CREATOR?(n=e.creator,i=U.getNonNullable(e.chosenOpponent)):(n=U.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:n,playerOne:i,turn:0,beginning:xc()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var n=this;return M(function*(){yield n.configRoomService.acceptConfig(e);const i=n.getStartingConfig(t);let s;s=i.playerZero===t.creator?k.ONE:k.ZERO,yield n.partDAO.update(e,i),yield n.gameEventService.startGame(e,s)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,i){var s=this;return M(function*(){const o={winner:n,loser:i,result:L1.RESIGN.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}notifyTimeout(e,t,n,i){var s=this;return M(function*(){const o={winner:n,loser:i,result:L1.TIMEOUT.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}proposeDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Draw")})()}acceptDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Accept","Draw");const s={result:(t===k.ZERO?L1.AGREED_DRAW_BY_ZERO:L1.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(e,s),yield n.gameEventService.addAction(e,t,"EndGame")})()}refuseDraw(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Draw")})()}proposeRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"Rematch")})()}rejectRematch(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","Rematch")})()}acceptRematch(e,t){var n=this;return M(function*(){const i=U.getNonNullable(e.data),s=yield n.configRoomService.readConfigRoomById(e.id);let o;const a=n.connectedUserService.user.get().toMinimalUser();let c;i.playerZero.id===a.id?(c=U.getNonNullable(i.playerOne),o=D2.CHOSEN_PLAYER):(c=i.playerZero,o=D2.CREATOR);const l={...s,firstPlayer:o.value,creator:a,chosenOpponent:c,partStatus:fi.PART_STARTED.value},f=n.getStartingConfig(l),d={typeGame:i.typeGame,result:L1.UNACHIEVED.value,...f},m=yield n.partDAO.create(d);yield n.configRoomService.createConfigRoom(m,l),yield n.createChat(m),yield n.gameEventService.addReply(e.id,t,"Accept","Rematch",m),yield n.gameEventService.startGame(m,t.getOpponent())})()}askTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addRequest(e,t,"TakeBack")})()}acceptTakeBack(e,t,n){var i=this;return M(function*(){let s=t-1;s%2===n.value&&s--;const o={turn:s};return yield i.gameEventService.addReply(e,n,"Accept","TakeBack"),yield i.partDAO.update(e,o)})()}refuseTakeBack(e,t){var n=this;return M(function*(){yield n.gameEventService.addReply(e,t,"Reject","TakeBack")})()}addGlobalTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddGlobalTime")})()}addTurnTime(e,t){var n=this;return M(function*(){yield n.gameEventService.addAction(e,t,"AddTurnTime")})()}preparePartUpdate(e,t){var n=this;return M(function*(){let o={turn:(yield n.partDAO.read(e)).get().turn+1};return o=n.updateScore(o,t),o})()}updatePart(e,t){var n=this;return M(function*(){const i=yield n.preparePartUpdate(e,t);yield n.update(e,i)})()}drawPart(e,t,n){var i=this;return M(function*(){let s=yield i.preparePartUpdate(e,n);s={...s,result:L1.HARD_DRAW.value},yield i.update(e,s),yield i.gameEventService.addAction(e,t,"EndGame")})()}endPartWithVictory(e,t,n,i,s){var o=this;return M(function*(){let a=yield o.preparePartUpdate(e,s);a={...a,winner:n,loser:i,result:L1.VICTORY.value},yield o.update(e,a),yield o.gameEventService.addAction(e,t,"EndGame")})()}addMove(e,t,n){var i=this;return M(function*(){yield i.gameEventService.addMove(e,t,n)})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get()[0],scorePlayerOne:t.get()[1]}:e}},u(M0,"\u0275fac",function(e){return new(e||M0)(Pe(cd),Pe(jk),Pe(ur),Pe(ld),Pe(Y5))}),u(M0,"\u0275prov",De({token:M0,factory:M0.\u0275fac,providedIn:"root"})),M0);Q5=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Q5);var Oee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},kee={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},xee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class ud{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??ud.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let Hee=(()=>{var r;class e{changeTheme(n){localStorage.setItem("theme",n)}getTheme(){return g.ofNullable(localStorage.getItem("theme"))}changeLanguage(n){localStorage.setItem("locale",n.toLowerCase())}getLanguage(){return ud.getLocale()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),_v=(()=>{var r;class e{constructor(n,i){u(this,"document",void 0),u(this,"userSettingsService",void 0),u(this,"theme",void 0),u(this,"availableThemes",["dark","light"]),this.document=n,this.userSettingsService=i;const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const n=this.userSettingsService.getTheme();if(n.isPresent()){const i=n.get();if(this.availableThemes.some(s=>s===i))return g.of(i)}return g.empty()}loadTheme(n){this.loadStyle(n+".css"),this.theme=n}loadStyle(n){const i=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=n;else{const o=this.document.createElement("link");o.id="theme",o.rel="stylesheet",o.href=`${n}`,i.appendChild(o)}}getTheme(){return this.theme}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(w2),Pe(Hee))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Vee(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function at(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Vee(Object(t),!0).forEach(function(n){p2(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Vee(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function vv(r){return(vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function Fee(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function p2(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Xk(r,e){return function uUe(r){if(Array.isArray(r))return r}(r)||function dUe(r,e){var t=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var o,a,n=[],i=!0,s=!1;try{for(t=t.call(r);!(i=(o=t.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(c){s=!0,a=c}finally{try{!i&&null!=t.return&&t.return()}finally{if(s)throw a}}return n}}(r,e)||$ee(r,e)||function pUe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dd(r){return function lUe(r){if(Array.isArray(r))return Qk(r)}(r)||function fUe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||$ee(r)||function hUe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $ee(r,e){if(r){if("string"==typeof r)return Qk(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if("Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Qk(r,e)}}function Qk(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var Gee=function(){},Jk={},Bee={},Uee=null,Wee={mark:Gee,measure:Gee};try{typeof window<"u"&&(Jk=window),typeof document<"u"&&(Bee=document),typeof MutationObserver<"u"&&(Uee=MutationObserver),typeof performance<"u"&&(Wee=performance)}catch{}var Mv,Ev,Sv,Pv,Tv,qee=(Jk.navigator||{}).userAgent,jee=void 0===qee?"":qee,Cl=Jk,U1=Bee,Zee=Uee,yv=Wee,t4=!!U1.documentElement&&!!U1.head&&"function"==typeof U1.addEventListener&&"function"==typeof U1.createElement,Yee=~jee.indexOf("MSIE")||~jee.indexOf("Trident/"),n4="___FONT_AWESOME___",Kee="fa",Xee="svg-inline--fa",E0="data-fa-i2svg",tx="data-fa-pseudo-element",mUe="data-fa-pseudo-element-pending",nx="data-prefix",rx="data-icon",Qee="fontawesome-i2svg",_Ue="async",vUe=["HTML","HEAD","STYLE","SCRIPT"],Jee=function(){try{return!0}catch{return!1}}(),W1="classic",br="sharp",ix=[W1,br];function hd(r){return new Proxy(r,{get:function(t,n){return n in t?t[n]:t[W1]}})}var pd=hd((p2(Mv={},W1,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),p2(Mv,br,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),Mv)),gd=hd((p2(Ev={},W1,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),p2(Ev,br,{solid:"fass",regular:"fasr",light:"fasl"}),Ev)),md=hd((p2(Sv={},W1,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),p2(Sv,br,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),Sv)),CUe=hd((p2(Pv={},W1,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),p2(Pv,br,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),Pv)),yUe=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,ete="fa-layers-text",MUe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,EUe=hd((p2(Tv={},W1,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),p2(Tv,br,{900:"fass",400:"fasr",300:"fasl"}),Tv)),tte=[1,2,3,4,5,6,7,8,9,10],SUe=tte.concat([11,12,13,14,15,16,17,18,19,20]),PUe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],S0={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},_d=new Set;Object.keys(gd[W1]).map(_d.add.bind(_d)),Object.keys(gd[br]).map(_d.add.bind(_d));var TUe=[].concat(ix,dd(_d),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",S0.GROUP,S0.SWAP_OPACITY,S0.PRIMARY,S0.SECONDARY]).concat(tte.map(function(r){return"".concat(r,"x")})).concat(SUe.map(function(r){return"w-".concat(r)})),vd=Cl.FontAwesomeConfig||{};U1&&"function"==typeof U1.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var e=Xk(r,2),n=e[1],i=function bUe(r){return""===r||"false"!==r&&("true"===r||r)}(function OUe(r){var e=U1.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}(e[0]));null!=i&&(vd[n]=i)});var nte={styleDefault:"solid",familyDefault:"classic",cssPrefix:Kee,replacementClass:Xee,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};vd.familyPrefix&&(vd.cssPrefix=vd.familyPrefix);var J5=at(at({},nte),vd);J5.autoReplaceSvg||(J5.observeMutations=!1);var mt={};Object.keys(nte).forEach(function(r){Object.defineProperty(mt,r,{enumerable:!0,set:function(t){J5[r]=t,Cd.forEach(function(n){return n(mt)})},get:function(){return J5[r]}})}),Object.defineProperty(mt,"familyPrefix",{enumerable:!0,set:function(e){J5.cssPrefix=e,Cd.forEach(function(t){return t(mt)})},get:function(){return J5.cssPrefix}}),Cl.FontAwesomeConfig=mt;var Cd=[],Dc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},IUe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function yd(){for(var r=12,e="";r-- >0;)e+=IUe[62*Math.random()|0];return e}function eu(r){for(var e=[],t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function sx(r){return r.classList?eu(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(e){return e})}function rte(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ov(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t].trim(),";")},"")}function ox(r){return r.size!==Dc.size||r.x!==Dc.x||r.y!==Dc.y||r.rotate!==Dc.rotate||r.flipX||r.flipY}var RUe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function ite(){var r=Kee,e=Xee,t=mt.cssPrefix,n=mt.replacementClass,i=RUe;if(t!==r||n!==e){var s=new RegExp("\\.".concat(r,"\\-"),"g"),o=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(s,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(n))}return i}var ste=!1;function ax(){mt.autoAddCss&&!ste&&(function AUe(r){if(r&&t4){var e=U1.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;for(var t=U1.head.childNodes,n=null,i=t.length-1;i>-1;i--){var s=t[i],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(n=s)}U1.head.insertBefore(e,n)}}(ite()),ste=!0)}var zUe={mixout:function(){return{dom:{css:ite,insertCss:ax}}},hooks:function(){return{beforeDOMElementCreation:function(){ax()},beforeI2svg:function(){ax()}}}},r4=Cl||{};r4[n4]||(r4[n4]={}),r4[n4].styles||(r4[n4].styles={}),r4[n4].hooks||(r4[n4].hooks={}),r4[n4].shims||(r4[n4].shims=[]);var wa=r4[n4],ote=[],bv=!1;function Md(r){var e=r.tag,t=r.attributes,n=void 0===t?{}:t,i=r.children,s=void 0===i?[]:i;return"string"==typeof r?rte(r):"<".concat(e," ").concat(function kUe(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(rte(r[t]),'" ')},"").trim()}(n),">").concat(s.map(Md).join(""),"</").concat(e,">")}function ate(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}t4&&((bv=(U1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(U1.readyState))||U1.addEventListener("DOMContentLoaded",function r(){U1.removeEventListener("DOMContentLoaded",r),bv=1,ote.map(function(e){return e()})}));var cx=function(e,t,n,i){var c,l,f,s=Object.keys(e),o=s.length,a=void 0!==i?function(e,t){return function(n,i,s,o){return e.call(t,n,i,s,o)}}(t,i):t;for(void 0===n?(c=1,f=e[s[0]]):(c=0,f=n);c<o;c++)f=a(f,e[l=s[c]],l,e);return f};function lx(r){var e=function FUe(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var s=r.charCodeAt(t++);56320==(64512&s)?e.push(((1023&i)<<10)+(1023&s)+65536):(e.push(i),t--)}else e.push(i)}return e}(r);return 1===e.length?e[0].toString(16):null}function cte(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return n.icon?e[n.iconName]=n.icon:e[t]=n,e},{})}function ux(r,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,s=cte(e);"function"!=typeof wa.hooks.addPack||i?wa.styles[r]=at(at({},wa.styles[r]||{}),s):wa.hooks.addPack(r,cte(e)),"fas"===r&&ux("fa",e)}var wv,Nv,Av,tu=wa.styles,GUe=wa.shims,BUe=(p2(wv={},W1,Object.values(md[W1])),p2(wv,br,Object.values(md[br])),wv),fx=null,lte={},ute={},fte={},dte={},hte={},UUe=(p2(Nv={},W1,Object.keys(pd[W1])),p2(Nv,br,Object.keys(pd[br])),Nv);var pte=function(){var e=function(s){return cx(tu,function(o,a,c){return o[c]=cx(a,s,{}),o},{})};lte=e(function(i,s,o){return s[3]&&(i[s[3]]=o),s[2]&&s[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=o}),i}),ute=e(function(i,s,o){return i[o]=o,s[2]&&s[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=o}),i}),hte=e(function(i,s,o){var a=s[2];return i[o]=o,a.forEach(function(c){i[c]=o}),i});var t="far"in tu||mt.autoFetchSvg,n=cx(GUe,function(i,s){var o=s[0],a=s[1],c=s[2];return"far"===a&&!t&&(a="fas"),"string"==typeof o&&(i.names[o]={prefix:a,iconName:c}),"number"==typeof o&&(i.unicodes[o.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});fte=n.names,dte=n.unicodes,fx=Iv(mt.styleDefault,{family:mt.familyDefault})};function dx(r,e){return(lte[r]||{})[e]}function P0(r,e){return(hte[r]||{})[e]}function gte(r){return fte[r]||{prefix:null,iconName:null}}function Ml(){return fx}(function NUe(r){Cd.push(r)})(function(r){fx=Iv(r.styleDefault,{family:mt.familyDefault})}),pte();var hx=function(){return{prefix:null,iconName:null,rest:[]}};function Iv(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===t?W1:t;return gd[n][r]||gd[n][pd[n][r]]||(r in wa.styles?r:null)||null}var mte=(p2(Av={},W1,Object.keys(md[W1])),p2(Av,br,Object.keys(md[br])),Av);function kv(r){var e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,s=(p2(e={},W1,"".concat(mt.cssPrefix,"-").concat(W1)),p2(e,br,"".concat(mt.cssPrefix,"-").concat(br)),e),o=null,a=W1;(r.includes(s[W1])||r.some(function(l){return mte[W1].includes(l)}))&&(a=W1),(r.includes(s[br])||r.some(function(l){return mte[br].includes(l)}))&&(a=br);var c=r.reduce(function(l,f){var d=function qUe(r,e){var t=e.split("-"),n=t[0],i=t.slice(1).join("-");return n!==r||""===i||function WUe(r){return~TUe.indexOf(r)}(i)?null:i}(mt.cssPrefix,f);if(tu[f]?(f=BUe[a].includes(f)?CUe[a][f]:f,o=f,l.prefix=f):UUe[a].indexOf(f)>-1?(o=f,l.prefix=Iv(f,{family:a})):d?l.iconName=d:f!==mt.replacementClass&&f!==s[W1]&&f!==s[br]&&l.rest.push(f),!i&&l.prefix&&l.iconName){var m="fa"===o?gte(l.iconName):{},E=P0(l.prefix,l.iconName);m.prefix&&(o=null),l.iconName=m.iconName||E||l.iconName,l.prefix=m.prefix||l.prefix,"far"===l.prefix&&!tu.far&&tu.fas&&!mt.autoFetchSvg&&(l.prefix="fas")}return l},hx());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===br&&(tu.fass||mt.autoFetchSvg)&&(c.prefix="fass",c.iconName=P0(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===o)&&(c.prefix=Ml()||"fas"),c}var YUe=function(){function r(){(function oUe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function aUe(r,e,t){e&&Fee(r.prototype,e),t&&Fee(r,t),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var t=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var o=i.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){t.definitions[a]=at(at({},t.definitions[a]||{}),o[a]),ux(a,o[a]);var c=md[W1][a];c&&ux(c,o[a]),pte()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(s){var o=i[s],a=o.prefix,c=o.iconName,l=o.icon,f=l[2];t[a]||(t[a]={}),f.length>0&&f.forEach(function(d){"string"==typeof d&&(t[a][d]=l)}),t[a][c]=l}),t}}]),r}(),_te=[],nu={},ru={},KUe=Object.keys(ru);function px(r,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return(nu[r]||[]).forEach(function(o){e=o.apply(null,[e].concat(n))}),e}function T0(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];(nu[r]||[]).forEach(function(s){s.apply(null,t)})}function i4(){var r=arguments[0],e=Array.prototype.slice.call(arguments,1);return ru[r]?ru[r].apply(null,e):void 0}function gx(r){"fa"===r.prefix&&(r.prefix="fas");var e=r.iconName,t=r.prefix||Ml();if(e)return e=P0(t,e)||e,ate(vte.definitions,t,e)||ate(wa.styles,t,e)}var vte=new YUe,JUe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t4?(T0("beforeI2svg",e),i4("pseudoElements2svg",e),i4("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===mt.autoReplaceSvg&&(mt.autoReplaceSvg=!0),mt.observeMutations=!0,function HUe(r){t4&&(bv?setTimeout(r,0):ote.push(r))}(function(){tWe({autoReplaceSvgRoot:t}),T0("watch",e)})}},po={noAuto:function(){mt.autoReplaceSvg=!1,mt.observeMutations=!1,T0("noAuto")},config:mt,dom:JUe,parse:{icon:function(e){if(null===e)return null;if("object"===vv(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:P0(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=Iv(e[0]);return{prefix:n,iconName:P0(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(mt.cssPrefix,"-"))>-1||e.match(yUe))){var i=kv(e.split(" "),{skipLookups:!0});return{prefix:i.prefix||Ml(),iconName:P0(i.prefix,i.iconName)||i.iconName}}if("string"==typeof e){var s=Ml();return{prefix:s,iconName:P0(s,e)||e}}}},library:vte,findIconDefinition:gx,toHtml:Md},tWe=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===t?U1:t;(Object.keys(wa.styles).length>0||mt.autoFetchSvg)&&t4&&mt.autoReplaceSvg&&po.dom.i2svg({node:n})};function xv(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return Md(n)})}}),Object.defineProperty(r,"node",{get:function(){if(t4){var n=U1.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function mx(r){var e=r.icons,t=e.main,n=e.mask,i=r.prefix,s=r.iconName,o=r.transform,a=r.symbol,c=r.title,l=r.maskId,f=r.titleId,d=r.extra,m=r.watchable,E=void 0!==m&&m,w=n.found?n:t,R=w.width,z=w.height,$="fak"===i,G=[mt.replacementClass,s?"".concat(mt.cssPrefix,"-").concat(s):""].filter(function(Mt){return-1===d.classes.indexOf(Mt)}).filter(function(Mt){return""!==Mt||!!Mt}).concat(d.classes).join(" "),de={children:[],attributes:at(at({},d.attributes),{},{"data-prefix":i,"data-icon":s,class:G,role:d.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(R," ").concat(z)})},ve=$&&!~d.classes.indexOf("fa-fw")?{width:"".concat(R/z*16*.0625,"em")}:{};E&&(de.attributes[E0]=""),c&&(de.children.push({tag:"title",attributes:{id:de.attributes["aria-labelledby"]||"title-".concat(f||yd())},children:[c]}),delete de.attributes.title);var xe=at(at({},de),{},{prefix:i,iconName:s,main:t,mask:n,maskId:l,transform:o,symbol:a,styles:at(at({},ve),d.styles)}),tt=n.found&&t.found?i4("generateAbstractMask",xe)||{children:[],attributes:{}}:i4("generateAbstractIcon",xe)||{children:[],attributes:{}},Cn=tt.attributes;return xe.children=tt.children,xe.attributes=Cn,a?function rWe(r){var t=r.iconName,n=r.children,i=r.attributes,s=r.symbol,o=!0===s?"".concat(r.prefix,"-").concat(mt.cssPrefix,"-").concat(t):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:at(at({},i),{},{id:o}),children:n}]}]}(xe):function nWe(r){var e=r.children,t=r.main,n=r.mask,i=r.attributes,s=r.styles,o=r.transform;if(ox(o)&&t.found&&!n.found){var l={x:t.width/t.height/2,y:.5};i.style=Ov(at(at({},s),{},{"transform-origin":"".concat(l.x+o.x/16,"em ").concat(l.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(xe)}function Cte(r){var e=r.content,t=r.width,n=r.height,i=r.transform,s=r.title,o=r.extra,a=r.watchable,c=void 0!==a&&a,l=at(at(at({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});c&&(l[E0]="");var f=at({},o.styles);ox(i)&&(f.transform=function LUe(r){var e=r.transform,t=r.width,i=r.height,s=void 0===i?16:i,o=r.startCentered,a=void 0!==o&&o,c="";return c+=a&&Yee?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-s/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(c+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:i,startCentered:!0,width:t,height:n}),f["-webkit-transform"]=f.transform);var d=Ov(f);d.length>0&&(l.style=d);var m=[];return m.push({tag:"span",attributes:l,children:[e]}),s&&m.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),m}var _x=wa.styles;function vx(r){var e=r[0],t=r[1],s=Xk(r.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(s)?{tag:"g",attributes:{class:"".concat(mt.cssPrefix,"-").concat(S0.GROUP)},children:[{tag:"path",attributes:{class:"".concat(mt.cssPrefix,"-").concat(S0.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(mt.cssPrefix,"-").concat(S0.PRIMARY),fill:"currentColor",d:s[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:s}}}}var sWe={found:!1,width:512,height:512};function Cx(r,e){var t=e;return"fa"===e&&null!==mt.styleDefault&&(e=Ml()),new Promise(function(n,i){if(i4("missingIconAbstract"),"fa"===t){var o=gte(r)||{};r=o.iconName||r,e=o.prefix||e}if(r&&e&&_x[e]&&_x[e][r])return n(vx(_x[e][r]));(function oWe(r,e){!Jee&&!mt.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))})(r,e),n(at(at({},sWe),{},{icon:mt.showMissingIcons&&r&&i4("missingIconAbstract")||{}}))})}var yte=function(){},yx=mt.measurePerformance&&yv&&yv.mark&&yv.measure?yv:{mark:yte,measure:yte},Ed='FA "6.4.2"',Mte=function(e){yx.mark("".concat(Ed," ").concat(e," ends")),yx.measure("".concat(Ed," ").concat(e),"".concat(Ed," ").concat(e," begins"),"".concat(Ed," ").concat(e," ends"))},Mx={begin:function(e){return yx.mark("".concat(Ed," ").concat(e," begins")),function(){return Mte(e)}},end:Mte},Lv=function(){};function Ete(r){return"string"==typeof(r.getAttribute?r.getAttribute(E0):null)}function fWe(r){return U1.createElementNS("http://www.w3.org/2000/svg",r)}function dWe(r){return U1.createElement(r)}function Ste(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===t?"svg"===r.tag?fWe:dWe:t;if("string"==typeof r)return U1.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(o){i.setAttribute(o,r.attributes[o])}),(r.children||[]).forEach(function(o){i.appendChild(Ste(o,{ceFn:n}))}),i}var Rv={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(i){t.parentNode.insertBefore(Ste(i),t)}),null===t.getAttribute(E0)&&mt.keepOriginalSource){var n=U1.createComment(function hWe(r){var e=" ".concat(r.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~sx(t).indexOf(mt.replacementClass))return Rv.replace(e);var i=new RegExp("".concat(mt.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var s=n[0].attributes.class.split(" ").reduce(function(a,c){return c===mt.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=s.toSvg.join(" "),0===s.toNode.length?t.removeAttribute("class"):t.setAttribute("class",s.toNode.join(" "))}var o=n.map(function(a){return Md(a)}).join("\n");t.setAttribute(E0,""),t.innerHTML=o}};function Pte(r){r()}function Tte(r,e){var t="function"==typeof e?e:Lv;if(0===r.length)t();else{var n=Pte;mt.mutateApproach===_Ue&&(n=Cl.requestAnimationFrame||Pte),n(function(){var i=function uWe(){return!0===mt.autoReplaceSvg?Rv.replace:Rv[mt.autoReplaceSvg]||Rv.replace}(),s=Mx.begin("mutate");r.map(i),s(),t()})}}var Ex=!1;function Ote(){Ex=!0}function Sx(){Ex=!1}var zv=null;function bte(r){if(Zee&&mt.observeMutations){var e=r.treeCallback,t=void 0===e?Lv:e,n=r.nodeCallback,i=void 0===n?Lv:n,s=r.pseudoElementsCallback,o=void 0===s?Lv:s,a=r.observeMutationsRoot,c=void 0===a?U1:a;zv=new Zee(function(l){if(!Ex){var f=Ml();eu(l).forEach(function(d){if("childList"===d.type&&d.addedNodes.length>0&&!Ete(d.addedNodes[0])&&(mt.searchPseudoElements&&o(d.target),t(d.target)),"attributes"===d.type&&d.target.parentNode&&mt.searchPseudoElements&&o(d.target.parentNode),"attributes"===d.type&&Ete(d.target)&&~PUe.indexOf(d.attributeName))if("class"===d.attributeName&&function cWe(r){var e=r.getAttribute?r.getAttribute(nx):null,t=r.getAttribute?r.getAttribute(rx):null;return e&&t}(d.target)){var m=kv(sx(d.target)),w=m.iconName;d.target.setAttribute(nx,m.prefix||f),w&&d.target.setAttribute(rx,w)}else(function lWe(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(mt.replacementClass)})(d.target)&&i(d.target)})}}),t4&&zv.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function wte(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function mWe(r){var e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=kv(sx(r));return i.prefix||(i.prefix=Ml()),e&&t&&(i.prefix=e,i.iconName=t),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function jUe(r,e){return(ute[r]||{})[e]}(i.prefix,r.innerText)||dx(i.prefix,lx(r.innerText))),!i.iconName&&mt.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=t.iconName,i=t.prefix,s=t.rest,o=function _We(r){var e=eu(r.attributes).reduce(function(i,s){return"class"!==i.name&&"style"!==i.name&&(i[s.name]=s.value),i},{}),t=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return mt.autoA11y&&(t?e["aria-labelledby"]="".concat(mt.replacementClass,"-title-").concat(n||yd()):(e["aria-hidden"]="true",e.focusable="false")),e}(r),a=px("parseNodeAttributes",{},r),c=e.styleParser?function gWe(r){var e=r.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(n,i){var s=i.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(n[o]=a.join(":").trim()),n},{})),t}(r):[];return at({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:Dc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:s,styles:c,attributes:o}},a)}var CWe=wa.styles;function Nte(r){var e="nest"===mt.autoReplaceSvg?wte(r,{styleParser:!1}):wte(r);return~e.extra.classes.indexOf(ete)?i4("generateLayersText",r,e):i4("generateSvgReplacementMutation",r,e)}var El=new Set;function Ate(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t4)return Promise.resolve();var t=U1.documentElement.classList,n=function(d){return t.add("".concat(Qee,"-").concat(d))},i=function(d){return t.remove("".concat(Qee,"-").concat(d))},s=mt.autoFetchSvg?El:ix.map(function(f){return"fa-".concat(f)}).concat(Object.keys(CWe));s.includes("fa")||s.push("fa");var o=[".".concat(ete,":not([").concat(E0,"])")].concat(s.map(function(f){return".".concat(f,":not([").concat(E0,"])")})).join(", ");if(0===o.length)return Promise.resolve();var a=[];try{a=eu(r.querySelectorAll(o))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=Mx.begin("onTree"),l=a.reduce(function(f,d){try{var m=Nte(d);m&&f.push(m)}catch(E){Jee||"MissingIcon"===E.name&&console.error(E)}return f},[]);return new Promise(function(f,d){Promise.all(l).then(function(m){Tte(m,function(){n("active"),n("complete"),i("pending"),"function"==typeof e&&e(),c(),f()})}).catch(function(m){c(),d(m)})})}function yWe(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Nte(r).then(function(t){t&&Tte([t],e)})}function MWe(r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:gx(e||{}),i=t.mask;return i&&(i=(i||{}).icon?i:gx(i||{})),r(n,at(at({},t),{},{mask:i}))}}ix.map(function(r){El.add("fa-".concat(r))}),Object.keys(pd[W1]).map(El.add.bind(El)),Object.keys(pd[br]).map(El.add.bind(El)),El=dd(El);var EWe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,i=void 0===n?Dc:n,s=t.symbol,o=void 0!==s&&s,a=t.mask,c=void 0===a?null:a,l=t.maskId,f=void 0===l?null:l,d=t.title,m=void 0===d?null:d,E=t.titleId,w=void 0===E?null:E,R=t.classes,z=void 0===R?[]:R,$=t.attributes,G=void 0===$?{}:$,de=t.styles,ve=void 0===de?{}:de;if(e){var xe=e.prefix,tt=e.iconName,pt=e.icon;return xv(at({type:"icon"},e),function(){return T0("beforeDOMElementCreation",{iconDefinition:e,params:t}),mt.autoA11y&&(m?G["aria-labelledby"]="".concat(mt.replacementClass,"-title-").concat(w||yd()):(G["aria-hidden"]="true",G.focusable="false")),mx({icons:{main:vx(pt),mask:c?vx(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:xe,iconName:tt,transform:at(at({},Dc),i),symbol:o,title:m,maskId:f,titleId:w,extra:{attributes:G,styles:ve,classes:z}})})}},SWe={mixout:function(){return{icon:MWe(EWe)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=Ate,t.nodeCallback=yWe,t}}},provides:function(e){e.i2svg=function(t){var n=t.node,s=t.callback;return Ate(void 0===n?U1:n,void 0===s?function(){}:s)},e.generateSvgReplacementMutation=function(t,n){var i=n.iconName,s=n.title,o=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,f=n.mask,d=n.maskId,m=n.extra;return new Promise(function(E,w){Promise.all([Cx(i,a),f.iconName?Cx(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(R){var z=Xk(R,2);E([t,mx({icons:{main:z[0],mask:z[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:d,title:s,titleId:o,extra:m,watchable:!0})])}).catch(w)})},e.generateAbstractIcon=function(t){var l,n=t.children,i=t.attributes,s=t.main,o=t.transform,c=Ov(t.styles);return c.length>0&&(i.style=c),ox(o)&&(l=i4("generateAbstractTransformGrouping",{main:s,transform:o,containerWidth:s.width,iconWidth:s.width})),n.push(l||s.icon),{children:n,attributes:i}}}},PWe={mixout:function(){return{layer:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,s=void 0===i?[]:i;return xv({type:"layer"},function(){T0("beforeDOMElementCreation",{assembler:t,params:n});var o=[];return t(function(a){Array.isArray(a)?a.map(function(c){o=o.concat(c.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(mt.cssPrefix,"-layers")].concat(dd(s)).join(" ")},children:o}]})}}}},TWe={mixout:function(){return{counter:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,s=void 0===i?null:i,o=n.classes,a=void 0===o?[]:o,c=n.attributes,l=void 0===c?{}:c,f=n.styles,d=void 0===f?{}:f;return xv({type:"counter",content:t},function(){return T0("beforeDOMElementCreation",{content:t,params:n}),function iWe(r){var e=r.content,t=r.title,n=r.extra,i=at(at(at({},n.attributes),t?{title:t}:{}),{},{class:n.classes.join(" ")}),s=Ov(n.styles);s.length>0&&(i.style=s);var o=[];return o.push({tag:"span",attributes:i,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}({content:t.toString(),title:s,extra:{attributes:l,styles:d,classes:["".concat(mt.cssPrefix,"-layers-counter")].concat(dd(a))}})})}}}},OWe={mixout:function(){return{text:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,s=void 0===i?Dc:i,o=n.title,a=void 0===o?null:o,c=n.classes,l=void 0===c?[]:c,f=n.attributes,d=void 0===f?{}:f,m=n.styles,E=void 0===m?{}:m;return xv({type:"text",content:t},function(){return T0("beforeDOMElementCreation",{content:t,params:n}),Cte({content:t,transform:at(at({},Dc),s),title:a,extra:{attributes:d,styles:E,classes:["".concat(mt.cssPrefix,"-layers-text")].concat(dd(l))}})})}}},provides:function(e){e.generateLayersText=function(t,n){var i=n.title,s=n.transform,o=n.extra,a=null,c=null;if(Yee){var l=parseInt(getComputedStyle(t).fontSize,10),f=t.getBoundingClientRect();a=f.width/l,c=f.height/l}return mt.autoA11y&&!i&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,Cte({content:t.innerHTML,width:a,height:c,transform:s,title:i,extra:o,watchable:!0})])}}},bWe=new RegExp('"',"ug"),Ite=[1105920,1112319];function kte(r,e){var t="".concat(mUe).concat(e.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(t))return n();var o=eu(r.children).filter(function(pt){return pt.getAttribute(tx)===e})[0],a=Cl.getComputedStyle(r,e),c=a.getPropertyValue("font-family").match(MUe),l=a.getPropertyValue("font-weight"),f=a.getPropertyValue("content");if(o&&!c)return r.removeChild(o),n();if(c&&"none"!==f&&""!==f){var d=a.getPropertyValue("content"),m=~["Sharp"].indexOf(c[2])?br:W1,E=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?gd[m][c[2].toLowerCase()]:EUe[m][l],w=function wWe(r){var e=r.replace(bWe,""),t=function $Ue(r,e){var i,t=r.length,n=r.charCodeAt(e);return n>=55296&&n<=56319&&t>e+1&&(i=r.charCodeAt(e+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(e,0),n=t>=Ite[0]&&t<=Ite[1],i=2===e.length&&e[0]===e[1];return{value:lx(i?e[0]:e),isSecondary:n||i}}(d),R=w.value,z=w.isSecondary,$=c[0].startsWith("FontAwesome"),G=dx(E,R),de=G;if($){var ve=function ZUe(r){var e=dte[r],t=dx("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(R);ve.iconName&&ve.prefix&&(G=ve.iconName,E=ve.prefix)}if(!G||z||o&&o.getAttribute(nx)===E&&o.getAttribute(rx)===de)n();else{r.setAttribute(t,de),o&&r.removeChild(o);var xe=function vWe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:Dc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),tt=xe.extra;tt.attributes[tx]=e,Cx(G,E).then(function(pt){var Cn=mx(at(at({},xe),{},{icons:{main:pt,mask:hx()},prefix:E,iconName:de,extra:tt,watchable:!0})),Mt=U1.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?r.insertBefore(Mt,r.firstChild):r.appendChild(Mt),Mt.outerHTML=Cn.map(function(Y2){return Md(Y2)}).join("\n"),r.removeAttribute(t),n()}).catch(i)}}else n()})}function NWe(r){return Promise.all([kte(r,"::before"),kte(r,"::after")])}function AWe(r){return!(r.parentNode===document.head||~vUe.indexOf(r.tagName.toUpperCase())||r.getAttribute(tx)||r.parentNode&&"svg"===r.parentNode.tagName)}function xte(r){if(t4)return new Promise(function(e,t){var n=eu(r.querySelectorAll("*")).filter(AWe).map(NWe),i=Mx.begin("searchPseudoElements");Ote(),Promise.all(n).then(function(){i(),Sx(),e()}).catch(function(){i(),Sx(),t()})})}var Lte=!1,Rte=function(e){return e.toLowerCase().split(" ").reduce(function(n,i){var s=i.toLowerCase().split("-"),o=s[0],a=s.slice(1).join("-");if(o&&"h"===a)return n.flipX=!0,n;if(o&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(o){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Px={x:0,y:0,width:"100%",height:"100%"};function zte(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function LWe(r){return"g"===r.tag?r.children:[r]}var RWe={hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-mask"),s=i?kv(i.split(" ").map(function(o){return o.trim()})):hx();return s.prefix||(s.prefix=Ml()),t.mask=s,t.maskId=n.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var n=t.children,i=t.attributes,s=t.main,o=t.mask,a=t.maskId,f=s.icon,m=o.icon,E=function xUe(r){var e=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},s="translate(".concat(32*e.x,", ").concat(32*e.y,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(s," ").concat(o," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:t.transform,containerWidth:o.width,iconWidth:s.width}),w={tag:"rect",attributes:at(at({},Px),{},{fill:"white"})},R=f.children?{children:f.children.map(zte)}:{},z={tag:"g",attributes:at({},E.inner),children:[zte(at({tag:f.tag,attributes:at(at({},f.attributes),E.path)},R))]},$={tag:"g",attributes:at({},E.outer),children:[z]},G="mask-".concat(a||yd()),de="clip-".concat(a||yd()),ve={tag:"mask",attributes:at(at({},Px),{},{id:G,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[w,$]},xe={tag:"defs",children:[{tag:"clipPath",attributes:{id:de},children:LWe(m)},ve]};return n.push(xe,{tag:"rect",attributes:at({fill:"currentColor","clip-path":"url(#".concat(de,")"),mask:"url(#".concat(G,")")},Px)}),{children:n,attributes:i}}}};!function XUe(r,e){var t=e.mixoutsTo;_te=r,nu={},Object.keys(ru).forEach(function(n){-1===KUe.indexOf(n)&&delete ru[n]}),_te.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(o){"function"==typeof i[o]&&(t[o]=i[o]),"object"===vv(i[o])&&Object.keys(i[o]).forEach(function(a){t[o]||(t[o]={}),t[o][a]=i[o][a]})}),n.hooks){var s=n.hooks();Object.keys(s).forEach(function(o){nu[o]||(nu[o]=[]),nu[o].push(s[o])})}n.provides&&n.provides(ru)})}([zUe,SWe,PWe,TWe,OWe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=xte,t}}},provides:function(e){e.pseudoElements2svg=function(t){var n=t.node;mt.searchPseudoElements&&xte(void 0===n?U1:n)}}},{mixout:function(){return{dom:{unwatch:function(){Ote(),Lte=!0}}}},hooks:function(){return{bootstrap:function(){bte(px("mutationObserverCallbacks",{}))},noAuto:function(){!function pWe(){zv&&zv.disconnect()}()},watch:function(t){var n=t.observeMutationsRoot;Lte?Sx():bte(px("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(t){return Rte(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-transform");return i&&(t.transform=Rte(i)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var n=t.main,i=t.transform,o=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),f="rotate(".concat(i.rotate," 0 0)"),E={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(f)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:at({},E.outer),children:[{tag:"g",attributes:at({},E.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:at(at({},n.icon.attributes),E.path)}]}]}}}},RWe,{provides:function(e){var t=!1;Cl.matchMedia&&(t=Cl.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},s={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:at(at({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=at(at({},s),{},{attributeName:"opacity"}),a={tag:"circle",attributes:at(at({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:at(at({},s),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:at(at({},o),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:at(at({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:at(at({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||n.push({tag:"path",attributes:at(at({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:at(at({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-symbol");return t.symbol=null!==i&&(""===i||i),t}}}}],{mixoutsTo:po});var VWe=po.parse,FWe=po.icon;const $We=["*"],UWe=r=>{const e={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let jWe=(()=>{var r;class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),ZWe=(()=>{var r;class e{constructor(){this.definitions={}}addIcons(...n){for(const i of n){i.prefix in this.definitions||(this.definitions[i.prefix]={}),this.definitions[i.prefix][i.iconName]=i;for(const s of i.icon[2])"string"==typeof s&&(this.definitions[i.prefix][s]=i)}}addIconPacks(...n){for(const i of n){const s=Object.keys(i).map(o=>i[o]);this.addIcons(...s)}}getIconDefinition(n,i){return n in this.definitions&&i in this.definitions[n]?this.definitions[n][i]:null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),YWe=(()=>{var r;class e{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Lt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[es]}),e})(),KWe=(()=>{var r;class e{constructor(n,i){this.renderer=n,this.elementRef=i}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(fc),B(bi))},r.\u0275cmp=We({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},features:[es],ngContentSelectors:$We,decls:1,vars:0,template:function(n,i){1&n&&(function bV(r){const e=Ee()[Dr][Ti];if(!e.projection){const n=e.projection=c7(r?r.length:1,null),i=n.slice();let s=e.child;for(;null!==s;){const o=r?Eue(s,r):0;null!==o&&(i[o]?i[o].projectionNext=s:n[o]=s,i[o]=s),s=s.next}}}(),function wV(r,e=0,t){const n=Ee(),i=zn(),s=S8(i,gn+r,16,null,t||null);null===s.projection&&(s.projection=e),Dy(),(!n[g3]||n8())&&32!=(32&s.flags)&&function N0e(r,e,t){DD(e[Zt],0,e,t,uM(r,t,e),ID(t.parent||e[Ti],t,e))}(i,n,s)}(0))},encapsulation:2}),e})(),O0=(()=>{var r;class e{set spin(n){this.animation=n?"spin":void 0}set pulse(n){this.animation=n?"spin-pulse":void 0}constructor(n,i,s,o,a){this.sanitizer=n,this.config=i,this.iconLibrary=s,this.stackItem=o,this.classes=[],null!=a&&null==o&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null!=this.icon||null!=this.config.fallbackIcon){if(n){const s=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=s){const o=this.buildParams();this.renderIcon(s,o)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(n){const i=((r,e)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:e,iconName:r}:{prefix:r[0],iconName:r[1]})(n,this.config.defaultPrefix);return"icon"in i?i:this.iconLibrary.getIconDefinition(i.prefix,i.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(i),null)}buildParams(){const n={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},i="string"==typeof this.transform?VWe.transform(this.transform):this.transform;return{title:this.title,transform:i,classes:[...UWe(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,i){const s=FWe(n,i);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return(r=e).\u0275fac=function(n){return new(n||r)(B(oB),B(jWe),B(ZWe),B(YWe,8),B(KWe,8))},r.\u0275cmp=We({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(dE("innerHTML",i.renderedIconHTML,g7),I("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[es],decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})(),XWe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Si({type:r}),r.\u0275inj=Q2({}),e})();var wx={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Vne={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},y1e={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},Bx={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},Oie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},Xx={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},zie={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},noe={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},hL={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Hoe={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class dae{static toComparableObjectSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>i.equals(n))&&t.push(n)}),t}static toComparableSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>Do(i,n))&&t.push(n)}),t}}let hae;hae=Symbol.iterator;class ft{constructor(e){u(this,"values",void 0),this.values=void 0===e?[]:dae.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(Do(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new ft(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(Do(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?g.of(this.values[0]):g.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const n of this.values)t.push(e(n));return new ft(t)}flatMap(e){const t=new ft;for(const n of this)t.addAll(e(n));return t}filter(e){const t=new ft;for(const n of this)e(n)&&t.add(n);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return g.of(t);return g.empty()}intersection(e){const t=new ft;for(const n of e)this.contains(n)&&t.add(n);return t}[hae](){return this.values.values()}}class Sn{static from(e){const t=Object.keys(e),n=new Sn;for(const i of t)n.set(i,e[i]);return n}constructor(e=[],t=!1){u(this,"map",void 0),u(this,"isImmutable",void 0),this.map=e,this.isImmutable=t}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(Do(t.key,e))return g.of(t.value);return g.empty()}getAnyPair(){return this.size()>0?g.of(this.map[0]):g.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(Do(n.key,e)){const i=n.value;return n.value=t,g.of(i)}return this.map.push({key:e,value:t}),g.empty()}containsKey(e){return this.map.some(t=>Do(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}listValues(){return this.map.map(e=>e.value)}getKeySet(){return new ft(this.listKeys())}filter(e){const t=new Sn;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(Do(this.map[t].key,e)){const i=this.map[t].value,s=this.map.slice(0,t),o=this.map.slice(t+1);return this.map=s.concat(o),i}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const i of t){const s=this.get(i).get(),o=e.get(i);if(je(o.isPresent(),"value is absent in a map even though its key is present!"),!1===Do(s,o.get()))return!1}return!0}}class iu extends Sn{reverse(){const e=new iu;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const i=new ft;i.add(t),e.set(n,i)}}return e}}var Jv;class hs{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"connectedUserService",void 0),u(this,"authSubscription",void 0),u(this,"userSubscription",new Mn),u(this,"currentGame",g.empty()),u(this,"currentGameRS",void 0),u(this,"currentGameObs",void 0),this.userDAO=e,this.userService=t,this.connectedUserService=n,this.currentGameRS=new eee(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var s=M(function*(o){yield i.onUserUpdate(o)});return function(o){return s.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return M(function*(){if(e===v0.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=g.empty(),t.currentGameRS.next(g.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,i=>{je(i.isPresent(),"Observing part service expected user to already have a document!");const s=i.get();t.onCurrentGameUpdate(s.currentGame)});const n=yield t.userDAO.read(e.id);t.currentGame=g.ofNullable(n.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,n=null==e&&t.isAbsent(),i=null!=e&&t.equalsValue(e);!1===n&&!1===i&&(this.currentGame=g.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(je(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)je(null!=e[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return je(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return b.SUCCESS;{const e=hs.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return b.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return b.SUCCESS;{const n=hs.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(n)}}getCurrentGame(){return new Promise(e=>{let t=new Mn;t=this.currentGameObs.subscribe(n=>{e(n),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function v7t(r,e){if(1&r&&(Gt(0),oe(1,31),Bt()),2&r){const t=p(2);_(1),Gn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Zn(1)}}function C7t(r,e){if(1&r&&(Gt(0),oe(1,33),Bt()),2&r){const t=p(3);_(1),Gn(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),Zn(1)}}function y7t(r,e){if(1&r&&(Gt(0),oe(1,34),Bt()),2&r){const t=p(3);_(1),Gn(t.currentGame.get().typeGame),Zn(1)}}function M7t(r,e){if(1&r&&(T(0,C7t,2,2,"ng-container",27),T(1,y7t,2,1,"ng-template",null,32,fn)),2&r){const t=ln(2);y("ngIf",p(2).currentGame.get().opponent)("ngIfElse",t)}}function E7t(r,e){if(1&r){const t=pe();S(0,"a",29),W("click",function(){return te(t),ne(p().navigateToPart())}),T(1,v7t,2,2,"ng-container",27),T(2,M7t,3,2,"ng-template",null,30,fn),P()}if(2&r){const t=ln(3),n=p();_(1),y("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",t)}}function S7t(r,e){if(1&r&&(Gt(0),F(1,"fa-icon",35),Bt()),2&r){const t=p();_(1),y("icon",t.faSpinner)}}function P7t(r,e){if(1&r){const t=pe();Gt(0),S(1,"div",10)(2,"a",37),ct(3),P(),S(4,"div",13)(5,"a",38),oe(6,39),P(),S(7,"a",40),W("click",function(){return te(t),ne(p(2).logout())}),oe(8,41),P()()(),Bt()}if(2&r){const t=p(2);_(3),An(t.username.get())}}Jv=hs,u(hs,"roleToMessage",new Sn([{key:"Candidate",value:od.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:od.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:od.YOU_ARE_ALREADY_CREATING},{key:"Player",value:od.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:od.YOU_ARE_ALREADY_OBSERVING}])),u(hs,"\u0275fac",function(e){return new(e||Jv)(Pe(sd),Pe(K5),Pe(ur))}),u(hs,"\u0275prov",De({token:Jv,factory:Jv.\u0275fac,providedIn:"root"}));const T7t=function(){return["/register"]},O7t=function(){return["/login"]};function b7t(r,e){1&r&&(S(0,"div",42)(1,"a",43)(2,"strong"),oe(3,44),P()(),S(4,"a",45),oe(5,46),P()()),2&r&&(_(1),y("routerLink",H1(2,T7t)),_(3),y("routerLink",H1(3,O7t)))}function w7t(r,e){if(1&r&&(T(0,P7t,9,1,"ng-container",27),T(1,b7t,6,4,"ng-template",null,36,fn)),2&r){const t=ln(2);y("ngIf",p().username.isPresent())("ngIfElse",t)}}const pae=function(){return["/"]},N7t=function(){return["/play"]},A7t=function(){return["/lobby"]},I7t=function(){return["/local"]},k7t=function(){return["/tutorial"]},x7t=function(){return["/settings"]};let L7t=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"loading",!0),u(this,"username",g.empty()),u(this,"faCog",Oie),u(this,"faSpinner",noe),u(this,"userSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"showMenu",!1),u(this,"currentGame",g.empty()),this.router=n,this.connectedUserService=i,this.currentGameService=s,this.userService=o}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(n=>{this.loading=!1,this.username=n.username.isPresent()?n.username:n.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(n=>{this.currentGame=n})}logout(){var n=this;return M(function*(){yield n.connectedUserService.disconnect(),yield n.router.navigate(["/"])})()}navigateToPart(){var n=this;return M(function*(){return n.router.navigate(["/play",n.currentGame.get().typeGame,n.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Bn),B(ur),B(hs),B(K5))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R,z;return t=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,s=$localize`Join a game`,o=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,E=$localize`Account`,w=$localize`Log out`,R=$localize`Register`,z=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,s,["id","playOffline",1,"navbar-link"],o,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],f,["waitingForOpponent",""],d,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],E,["id","logout",1,"navbar-item",3,"click"],w,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],R,["id","login",1,"button","is-light",3,"routerLink"],z]},template:function(n,i){if(1&n&&(S(0,"nav",0)(1,"div",1)(2,"a",2),F(3,"img",3),P(),S(4,"a",4),W("click",function(){return i.showMenu=!i.showMenu}),F(5,"span",5)(6,"span",5)(7,"span",5),P()(),S(8,"div",6),W("click",function(){return i.showMenu=!i.showMenu}),S(9,"div",7)(10,"a",8),oe(11,9),P(),S(12,"div",10)(13,"a",11),oe(14,12),P(),S(15,"div",13)(16,"a",2),oe(17,14),P(),S(18,"a",2),oe(19,15),P()()(),S(20,"div",10)(21,"a",16),oe(22,17),P(),S(23,"div",13)(24,"a",18),oe(25,19),P(),S(26,"a",20),oe(27,21),P()()()(),S(28,"div",22),T(29,E7t,4,2,"a",23),S(30,"a",24),F(31,"fa-icon",25),P(),S(32,"div",26),T(33,S7t,2,1,"ng-container",27),T(34,w7t,3,2,"ng-template",null,28,fn),P()()()()),2&n){const s=ln(35);_(2),y("routerLink",H1(13,pae)),_(2),y("ngClass",i.showMenu?"is-active":""),_(4),y("ngClass",i.showMenu?"is-active":""),_(2),y("routerLink",H1(14,pae)),_(6),y("routerLink",H1(15,N7t)),_(2),y("routerLink",H1(16,A7t)),_(6),y("routerLink",H1(17,I7t)),_(2),y("routerLink",H1(18,k7t)),_(3),y("ngIf",i.currentGame.isPresent()),_(1),y("routerLink",H1(19,x7t)),_(1),y("icon",i.faCog),_(2),y("ngIf",i.loading)("ngIfElse",s)}},dependencies:[Ft,wt,Ec,O0],encapsulation:2})),e})(),R7t=(()=>{var r;class e{constructor(n,i){u(this,"_themeService",void 0),u(this,"_errorLoggerService",void 0),u(this,"faTwitter",xee),u(this,"faFacebook",Oee),u(this,"faGithub",kee),this._themeService=n,this._errorLoggerService=i}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(_v),B(h2))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(F(0,"app-header"),S(1,"main",0),F(2,"router-outlet"),P(),S(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),Is(7,3),F(8,"strong"),ks(),P(),ct(9," \xa0 "),S(10,"a",4),F(11,"fa-icon",5),P(),ct(12,"\xa0 "),S(13,"a",6),F(14,"fa-icon",5),P(),ct(15,"\xa0 "),S(16,"a",7),F(17,"fa-icon",5),P()()()()),2&n&&(_(11),y("icon",i.faGithub),_(3),y("icon",i.faTwitter),_(3),y("icon",i.faFacebook))},dependencies:[dP,O0,L7t],encapsulation:2})),e})();class Hi{constructor(){u(this,"__nominal",void 0)}}var su;class Jt{static of(e){switch(e){case 0:return Jt.ZERO;case 1:return Jt.ONE;case 2:return Jt.TWO;default:return je(3===e,"Invalid Apagos Coord "+e),Jt.THREE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return this.x===e.x}}su=Jt,u(Jt,"encoder",we.tuple([we.identity()],r=>[r.x],r=>su.of(r[0]))),u(Jt,"ZERO",new su(0)),u(Jt,"ONE",new su(1)),u(Jt,"TWO",new su(2)),u(Jt,"THREE",new su(3));let ou=(()=>{class r{}return u(r,"PIECE_SHOULD_MOVE_DOWNWARD",()=>$localize`Pieces should only move downward!`),u(r,"CANNOT_LAND_ON_A_FULL_SQUARE",()=>$localize`That square is already full, you cannot put a piece in it!`),u(r,"NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE",()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`),u(r,"NO_PIECE_REMAINING_TO_DROP",()=>$localize`There are no remaining pieces of that color to drop!`),u(r,"NO_POSSIBLE_TRANSFER_REMAINS",()=>$localize`There is no possible transfer from that square!`),r})();var Vi;class go extends Hi{static drop(e,t){return U.getNonNullable(go.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equalsValue(t)&&i.starting.equals(g.empty())))}static transfer(e,t){if(e.x<=t.x)return re.failure(ou.PIECE_SHOULD_MOVE_DOWNWARD());const n=U.getNonNullable(go.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equals(g.empty())&&i.starting.equals(g.of(e))));return re.success(n)}constructor(e,t,n){super(),u(this,"landing",void 0),u(this,"piece",void 0),u(this,"starting",void 0),this.landing=e,this.piece=t,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}u(go,"ALL_MOVES",[new(Vi=go)(Jt.ZERO,g.of(k.ZERO),g.empty()),new Vi(Jt.ONE,g.of(k.ZERO),g.empty()),new Vi(Jt.TWO,g.of(k.ZERO),g.empty()),new Vi(Jt.THREE,g.of(k.ZERO),g.empty()),new Vi(Jt.ZERO,g.of(k.ONE),g.empty()),new Vi(Jt.ONE,g.of(k.ONE),g.empty()),new Vi(Jt.TWO,g.of(k.ONE),g.empty()),new Vi(Jt.THREE,g.of(k.ONE),g.empty()),new Vi(Jt.TWO,g.empty(),g.of(Jt.THREE)),new Vi(Jt.ONE,g.empty(),g.of(Jt.THREE)),new Vi(Jt.ZERO,g.empty(),g.of(Jt.THREE)),new Vi(Jt.ONE,g.empty(),g.of(Jt.TWO)),new Vi(Jt.ZERO,g.empty(),g.of(Jt.TWO)),new Vi(Jt.ZERO,g.empty(),g.of(Jt.ONE))]),u(go,"encoder",we.tuple([Jt.encoder,g.getEncoder(k.encoder),g.getEncoder(Jt.encoder)],r=>[r.landing,r.piece,r.starting],r=>new Vi(r[0],r[1],r[2])));class eC{constructor(e){u(this,"turn",void 0),this.turn=e}getCurrentPlayer(){return k.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?k.ZERO:k.ONE}}let gae;class en{static create(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}static copy(e){return e.map(t=>t)}static sortByDescending(e,t){e.sort((n,i)=>{const s=t(n),o=t(i);return s<o?1:s>o?-1:0})}static compare(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===Do(e[n],t[n]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&en.compare(e,t.slice(0,e.length))}static range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}static smallerFirst(e,t){return e-t}static getRandomElement(e){return U.assert(e.length>0,"ArrayUtils.getRandomElement must be called on an array containing elements"),e[Math.floor(Math.random()*e.length)]}static maximumsBy(e,t){const n=[];let i=Number.MIN_SAFE_INTEGER;for(let s=0;s<e.length;s++){const o=t(e[s]);o>i&&(i=o,n.push(e[s]))}return n}}class Rt{static create(e,t,n){const i=[];for(let s=0;s<t;s++)i.push(en.create(e,n));return i}static map(e,t){return e.map(n=>n.map(t))}static copy(e){return Rt.map(e,t=>t)}static compare(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===en.compare(e[n],t[n]))return!1;return!0}}gae=Symbol.iterator;class mae{constructor(){u(this,"content",new Sn)}get(e){const t=this.content.get(e.y);return t.isAbsent()?g.empty():t.get().get(e.x)}set(e,t){const n=this.content.get(e.y);let i;n.isPresent()?i=n.get():(i=new Sn,this.content.set(e.y,i)),i.set(e.x,t)}[gae](){const e=[],t=this.content.getKeySet().toList();t.sort(en.smallerFirst);for(const n of t){const i=this.content.get(n).get(),s=i.getKeySet().toList();s.sort(en.smallerFirst);for(const o of s){const a=i.get(o).get();e.push({x:o,y:n,content:a})}}return e.values()}}class z7t{static create(e,t,n,i){const s=[];for(let o=0;o<e;o++)s.push(Rt.create(t,n,i));return s}}class wd{static from(e,t,n){if(e+t>n)return re.failure("invalid starting space");const i=new Sn([{key:k.ZERO,value:e},{key:k.ONE,value:t},{key:Y.NONE,value:n}]);i.makeImmutable();const s=new wd(i);return re.success(s)}constructor(e){u(this,"containing",void 0),this.containing=e}isFull(){return this.count(k.ZERO)+this.count(k.ONE)>=this.count(Y.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(Y.NONE);return e===k.ZERO?t++:n++,wd.from(t,n,i).get()}substractPiece(e){let t=this.count(k.ZERO),n=this.count(k.ONE);const i=this.count(Y.NONE);return e===k.ZERO?t--:n--,wd.from(t,n,i).get()}getDominatingPlayer(){const e=this.count(k.ZERO),t=this.count(k.ONE);return e>t?k.ZERO:t>e?k.ONE:Y.NONE}equals(e){return this.containing.equals(e.containing)}}let Sl=(()=>{class r extends eC{static getInitialState(){return r.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,n,i,s){const o=[];for(let c=0;c<4;c++){const m=wd.from(n[0][c],n[1][c],n[2][c]).get();o.push(m)}const a=new Sn;return a.set(k.ZERO,i),a.set(k.ONE,s),new r(t,o,a)}constructor(t,n,i){super(t),u(this,"board",void 0),u(this,"remaining",void 0),this.board=n,this.remaining=i,this.remaining.makeImmutable()}getPieceAt(t){return this.board[t.x]}updateAt(t,n){const i=[];for(let o=0;o<4;o++)i.push(t.x===o?n:this.board[o]);const s=this.getRemainingCopy();return new r(this.turn,i,s)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(t){return this.remaining.get(t).get()}equals(t){return this.turn===t.turn&&en.compare(t.board,this.board)&&this.remaining.equals(t.remaining)}}return u(r,"PIECES_PER_PLAYER",10),r})();class q{static fromMove(e,t,n,i,s,o){return new D7t(e,t,n,i,s,o)}static forClick(e,t,n,i,s,o){return new V7t(e,t,n,i,s,o)}static anyMove(e,t,n,i,s){return new H7t(e,t,n,i,s)}static fromPredicate(e,t,n,i,s,o){return new F7t(e,t,n,i,s,o)}static informational(e,t,n){return new $7t(e,t,n)}constructor(e,t,n){u(this,"title",void 0),u(this,"instruction",void 0),u(this,"state",void 0),u(this,"previousMove",g.empty()),this.title=e,this.instruction=t,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=g.of(e),this}}class tC extends q{constructor(e,t,n,i){super(e,t,n),u(this,"successMessage",void 0),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class D7t extends tC{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedMoves",void 0),u(this,"failureMessage",void 0),this.acceptedMoves=i,this.failureMessage=o,je(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class H7t extends tC{constructor(e,t,n,i,s){super(e,t,n,s),u(this,"solutionMove",void 0),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class V7t extends tC{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedClicks",void 0),u(this,"failureMessage",void 0),this.acceptedClicks=i,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class F7t extends tC{constructor(e,t,n,i,s,o){super(e,t,n,o),u(this,"solutionMove",void 0),u(this,"predicate",void 0),this.solutionMove=i,this.predicate=s}getSolution(){return this.solutionMove}isPredicate(){return!0}}class $7t extends q{isInformation(){return!0}}class Yn{}class _ae extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Sl.getInitialState()),q.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,Sl.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),go.drop(Jt.ZERO,k.ZERO),$localize`Congratulations!`),q.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,Sl.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),go.transfer(Jt.TWO,Jt.ZERO).get(),(t,n,i)=>t.isDrop()?b.failure($localize`This move is a drop, please do a transfer!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,Sl.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),go.drop(Jt.TWO,k.ONE),(t,n,i)=>t.isDrop()?t.piece.equalsValue(k.ONE)?b.SUCCESS:b.failure($localize`You actively made your opponent win!`):b.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)])}}class e1{static isVictory(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER}static isPreVictory(e){return e===Number.MAX_SAFE_INTEGER-1||e===Number.MIN_SAFE_INTEGER+1}static of(e,t){return e*=k.ZERO.getScoreModifier(),t*=k.ONE.getScoreModifier(),new e1(e+t)}constructor(e){u(this,"value",void 0),this.value=e}}var Nd,nC,ML;u(e1,"VICTORIES",[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]);class _e{static getVictory(e){return e===k.ZERO?_e.ZERO_WON:_e.ONE_WON}static getDefeat(e){return e===k.ZERO?_e.ONE_WON:_e.ZERO_WON}constructor(e,t){u(this,"isEndGame",void 0),u(this,"winner",void 0),this.isEndGame=e,this.winner=t}toBoardValue(){return this.winner.isPlayer()?new e1(this.winner.getVictoryValue()):new e1(0)}}u(_e,"ZERO_WON",new(Nd=_e)(!0,k.ZERO)),u(_e,"ONE_WON",new Nd(!0,k.ONE)),u(_e,"DRAW",new Nd(!0,Y.NONE)),u(_e,"ONGOING",new Nd(!1,Y.NONE));let vae=(()=>{class r{}return u(r,"createdNodes",0),r})(),Vo=(nC=class{constructor(e,t=g.empty(),n=g.empty()){u(this,"gameState",void 0),u(this,"parent",void 0),u(this,"previousMove",void 0),u(this,"id",void 0),u(this,"children",new Sn),u(this,"cache",new Sn),this.gameState=e,this.parent=t,this.previousMove=n,this.id=ML.ID++,vae.createdNodes++}getChild(e){return this.children.get(e)}hasChildren(){return this.getChildren().length>0}getChildren(){return this.children.listValues()}addChild(e){U.assert(e.previousMove.isPresent(),"GameNode: addChild expects a node with a previous move"),this.children.set(e.previousMove.get(),e)}printDot(e,t,n,i=0,s=0){0===i&&console.log("digraph G {");const o=e.getGameStatus(this);let a="white";if(o.isEndGame)switch(o.winner){case k.ZERO:a="#994d00";break;case k.ONE:a="#ffc34d";break;default:a="grey"}let c=`#${this.gameState.turn}: ${this.id}`;t&&(c+=` - ${t(this)}`),console.log(`    node_${s} [label="${c}", style=filled, fillcolor="${a}"];`);let l=s+1;if(void 0===n||i<n)for(const f of this.children.listValues())console.log(`    node_${s} -> node_${l} [label="${f.previousMove.get()}"];`),l=f.printDot(e,t,n,i+1,l);return 0===i&&console.log("}"),l}getCache(e){return this.cache.get(e)}setCache(e,t){this.cache.containsKey(e)?this.cache.replace(e,t):this.cache.set(e,t)}},ML=nC,u(nC,"ID",0),nC);Vo=ML=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Vo);class Kn{constructor(e){u(this,"stateType",void 0),this.stateType=e}choose(e,t){Ne.display("Rules","choose",t.toString()+" was proposed");const n=this.isLegal(t,e.gameState);if(n.isFailure())return Ne.display("Rules","choose","Move is illegal: "+n.getReason()),re.failure(n.getReason());const i=e.getChild(t);if(i.isPresent())return U.assert(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),Ne.display("Rules","choose","and this proposed move is found in the list, so it is legal"),re.success(i.get());const s=this.applyLegalMove(t,e.gameState,n.get()),o=new Vo(s,g.of(e),g.of(t));return re.success(o)}getInitialNode(){const e=this.stateType.getInitialState();return new Vo(e)}}class s4 extends Kn{static get(){return s4.singleton.isAbsent()&&(s4.singleton=g.of(new s4)),s4.singleton.get()}constructor(){super(Sl)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),i=n.get(e.piece.get()).get();n.put(e.piece.get(),i-1);const s=new Sl(t.turn+1,t.board,n),o=e.piece.get(),a=s.getPieceAt(e.landing).addPiece(o);if(e.landing===Jt.THREE)return s.updateAt(e.landing,a);{const c=Jt.of(e.landing.x+1),l=s.getPieceAt(c);return s.updateAt(e.landing,l).updateAt(c,a)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),i=e.starting.get(),s=t.getPieceAt(i).substractPiece(n),o=t.getPieceAt(e.landing).addPiece(n);let a=t.updateAt(i,s);return a=a.updateAt(e.landing,o),new Sl(a.turn+1,a.board,a.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?b.failure(ou.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?b.failure(ou.NO_PIECE_REMAINING_TO_DROP()):b.SUCCESS}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?b.failure(ou.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;for(let i=0;i<4;i++)if(!1===t.getPieceAt(Jt.of(i)).isFull())return _e.ONGOING;const n=t.getPieceAt(Jt.THREE).getDominatingPlayer();return je(n.isPlayer(),"winner can only be a player if the game is finished"),_e.getVictory(n)}}u(s4,"singleton",g.empty());class EL{static gcd(e,t){return 0===t?Math.abs(e):EL.gcd(t,e%t)}}class Et{constructor(e,t){u(this,"x",void 0),u(this,"y",void 0),this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=EL.gcd(this.x,this.y);return new Et(this.x/e,this.y/e)}combine(e,t=1){return new Et(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}var M1,ps;class SL extends Et{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class PL{from(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return re.success(n);return re.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?re.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):re.failure(B7t.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return re.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return re.failure(`Invalid int direction: ${e}`)}}}class Me extends SL{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Me.factory.from(-this.x,-this.y).get()}}u(Me,"UP",new(M1=Me)(0,-1)),u(Me,"UP_RIGHT",new M1(1,-1)),u(Me,"RIGHT",new M1(1,0)),u(Me,"DOWN_RIGHT",new M1(1,1)),u(Me,"DOWN",new M1(0,1)),u(Me,"DOWN_LEFT",new M1(-1,1)),u(Me,"LEFT",new M1(-1,0)),u(Me,"UP_LEFT",new M1(-1,-1)),u(Me,"factory",new class extends PL{constructor(...r){super(...r),u(this,"all",[M1.UP,M1.UP_RIGHT,M1.RIGHT,M1.DOWN_RIGHT,M1.DOWN,M1.DOWN_LEFT,M1.LEFT,M1.UP_LEFT])}}),u(Me,"DIRECTIONS",M1.factory.all),u(Me,"DIAGONALS",[M1.UP_RIGHT,M1.DOWN_RIGHT,M1.DOWN_LEFT,M1.UP_LEFT]),u(Me,"ORTHOGONALS",[M1.UP,M1.RIGHT,M1.DOWN,M1.LEFT]),u(Me,"encoder",we.fromFunctions(r=>r.toString(),r=>(je("string"==typeof r,"Invalid encoded direction"),M1.factory.fromString(r).get())));class Re extends SL{constructor(e,t){super(e,t)}getOpposite(){return Re.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Re.factory.from(-this.y,this.x).get()}}u(Re,"UP",new(ps=Re)(0,-1)),u(Re,"RIGHT",new ps(1,0)),u(Re,"DOWN",new ps(0,1)),u(Re,"LEFT",new ps(-1,0)),u(Re,"factory",new class extends PL{constructor(...r){super(...r),u(this,"all",[ps.UP,ps.RIGHT,ps.DOWN,ps.LEFT])}from(r,e){return 0===r&&-1===e?re.success(ps.UP):1===r&&0===e?re.success(ps.RIGHT):0===r&&1===e?re.success(ps.DOWN):-1===r&&0===e?re.success(ps.LEFT):re.failure("Invalid orthogonal from x and y")}}),u(Re,"ORTHOGONALS",ps.factory.all),u(Re,"encoder",we.fromFunctions(r=>r.toString(),r=>(je("string"==typeof r,"Invalid encoded orthogonal"),ps.factory.fromString(r).get())));let B7t=(()=>{class r{}return u(r,"DIRECTION_MUST_BE_LINEAR",()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`),r})();var TL;let au=(()=>{class r{}return u(r,"OUT_OF_RANGE",e=>`The coordinate ${e.toString()} is not on the board`),r})();class C extends Et{static getEncoder(e){return we.tuple([we.identity(),we.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}constructor(e,t){super(e,t)}getNext(e,t){const n=this.combine(e,t);return new C(n.x,n.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new C(this.x+e.y,this.y+-e.x)}getRight(e){return new C(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return Me.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!1===e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}getVectorToward(e){return new Et(e.x-this.x,e.y-this.y)}toVector(){return new Et(this.x,this.y)}getCoordsToward(e){if(e.equals(this))return[];if(!1===e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const i=[];for(;!1===n.equals(e);)i.push(n),n=n.getNext(t,1);return i}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let i=this.getNext(n);for(;!1===i.equals(e);)t.push(i),i=i.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}}var cu;u(C,"encoder",(TL=C).getEncoder((r,e)=>new TL(r,e)));class Cae{constructor(){u(this,"ArrayUtils",en)}getPlayerClass(e){switch(e){case k.ZERO:return"player0-fill";case k.ONE:return"player1-fill";default:return U.expectToBe(e,Y.NONE),""}}}let Hc=(cu=class extends Cae{constructor(e){super(),u(this,"messageDisplayer",void 0),u(this,"encoder",void 0),u(this,"Player",k),u(this,"SPACE_SIZE",100),u(this,"STROKE_WIDTH",8),u(this,"SMALL_STROKE_WIDTH",2),u(this,"rules",void 0),u(this,"node",void 0),u(this,"availableAIs",void 0),u(this,"canPass",!1),u(this,"scores",g.empty()),u(this,"imagesLocation","assets/images/"),u(this,"hasAsymmetricBoard",!1),u(this,"rotation",""),u(this,"tutorial",void 0),u(this,"isPlayerTurn",void 0),u(this,"chooseMove",void 0),u(this,"canUserPlay",void 0),u(this,"cancelMoveOnWrapper",void 0),u(this,"pointOfView",k.ZERO),u(this,"isInteractive",!1),this.messageDisplayer=e}getPointOfView(){return this.pointOfView}setPointOfView(e){this.pointOfView=e,this.hasAsymmetricBoard&&(this.rotation="rotate("+180*e.value+")")}setInteractive(e){this.isInteractive=e}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.cancelMoveOnWrapper(e),t.node.previousMove.isPresent()&&(yield t.showLastMove(t.node.previousMove.get())),null==e?b.SUCCESS:(t.messageDisplayer.gameMessage(e),b.failure(e))})()}cancelMoveAttempt(){}pass(){var e=this;return M(function*(){return h2.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getCurrentOpponent(){return this.node.gameState.getCurrentOpponent()}getState(){return this.node.gameState}getPreviousState(){return this.node.parent.get().gameState}showLastMove(e){return M(function*(){})()}hideLastMove(){}},u(cu,"\u0275fac",function(e){return new(e||cu)(B(Ut))}),u(cu,"\u0275cmp",We({type:cu,selectors:[["ng-component"]],features:[Xe],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),cu);Hc=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Hc);let lu=(()=>{var r;class e extends Hc{constructor(...n){super(...n),u(this,"hexaLayout",void 0),u(this,"hexaBoard",void 0)}getHexaPointsAtXY(n,i){const s=new C(n,i);return this.getHexaPointsAt(s)}getHexaPointsAt(n){return this.hexaLayout.getHexaPointsAt(n)}getCenterAtXY(n,i){const s=new C(n,i);return this.getCenterAt(s)}getCenterAt(n){return this.hexaLayout.getCenterAt(n)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",We({type:r,selectors:[["ng-component"]],features:[Xe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();var Ad,g2;class ye{static of(e){switch(e){case ye.ZERO.value:return ye.ZERO;case ye.ONE.value:return ye.ONE;case ye.EMPTY.value:return ye.EMPTY;case ye.UNREACHABLE.value:return ye.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===k.ZERO?ye.ZERO:(U.expectToBe(e,k.ONE),ye.ONE)}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===ye.ZERO||this===ye.ONE}}u(ye,"ZERO",new(Ad=ye)(k.ZERO.value)),u(ye,"ONE",new Ad(k.ONE.value)),u(ye,"EMPTY",new Ad(Y.NONE.value)),u(ye,"UNREACHABLE",new Ad(3));class be extends SL{static getAngle(e){switch(e){case be.UP:return 0;case be.UP_RIGHT:return 60;case be.RIGHT:return 120;case be.DOWN:return 180;case be.DOWN_LEFT:return 240;default:return U.expectToBe(e,be.LEFT),300}}constructor(e,t){super(e,t)}getOpposite(){return be.factory.from(-this.x,-this.y).get()}}u(be,"UP",new(g2=be)(0,-1)),u(be,"LEFT",new g2(-1,0)),u(be,"UP_RIGHT",new g2(1,-1)),u(be,"DOWN_LEFT",new g2(-1,1)),u(be,"RIGHT",new g2(1,0)),u(be,"DOWN",new g2(0,1)),u(be,"factory",new class extends PL{constructor(...r){super(...r),u(this,"all",[g2.UP,g2.UP_RIGHT,g2.RIGHT,g2.DOWN,g2.DOWN_LEFT,g2.LEFT])}}),u(be,"encoder",we.fromFunctions(r=>{switch(r){case g2.UP:return 0;case g2.UP_RIGHT:return 1;case g2.RIGHT:return 2;case g2.DOWN:return 3;case g2.DOWN_LEFT:return 4;default:return 5}},r=>(U.assert(0<=r&&r<=5,"Invalid encoded number for HexaDirection "+r),g2.factory.all[r])));class Eae{constructor(){u(this,"startAngle",void 0),u(this,"conversionMatrix",void 0),u(this,"inverseConversionMatrix",void 0)}}class rC extends Eae{constructor(){super(),u(this,"startAngle",.5),u(this,"conversionMatrix",[Math.sqrt(3),Math.sqrt(3)/2,0,1.5]),u(this,"inverseConversionMatrix",[Math.sqrt(3)/3,-1/3,0,2/3])}}u(rC,"INSTANCE",new rC);class Ur extends Eae{constructor(){super(),u(this,"startAngle",0),u(this,"conversionMatrix",[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)]),u(this,"inverseConversionMatrix",[2/3,0,-1/3,Math.sqrt(3)/3])}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,i)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}u(Ur,"INSTANCE",new Ur);class uu{constructor(e,t,n){u(this,"size",void 0),u(this,"origin",void 0),u(this,"orientation",void 0),this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new C(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new C(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsListAt(e){const t=this.getCenterAt(e),n=[];for(let i=0;i<6;i+=1){const s=this.getCornerOffset(i);n.push(new C(t.x+s.x,t.y+s.y))}return n}getHexaPointsAt(e){return this.getHexaPointsListAt(e).map(n=>n.toSVGPoint()).join(" ")}getIsoPoints(e,t){U.assert(this.orientation===Ur.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(e),i=this.getCornerOffset(0),s=this.getCornerOffset(1),o=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+o.x,n.y+o.y)],[new C(n.x+i.x,n.y+i.y),new C(n.x+i.x,n.y+i.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+o.x,n.y+o.y),new C(n.x+s.x,n.y+s.y)],[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+i.x,n.y+i.y+t),new C(n.x+i.x,n.y+i.y),new C(n.x+s.x,n.y+s.y),new C(n.x+o.x,n.y+o.y)]]}}let Sae,Le=(()=>{class r{}return u(r,"CANNOT_CHOOSE_OPPONENT_PIECE",()=>$localize`You cannot pick a piece of the opponent.`),u(r,"MUST_CLICK_ON_EMPTY_SPACE",()=>$localize`You must click on an empty space.`),u(r,"MUST_CLICK_ON_EMPTY_SQUARE",()=>$localize`You must click on an empty square.`),u(r,"SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE",()=>$localize`Your landing space should be empty or contain a piece of the opponent.`),u(r,"CANNOT_SELF_CAPTURE",()=>$localize`You cannot capture your own pieces.`),u(r,"MUST_CHOOSE_PLAYER_PIECE",()=>$localize`You must pick one of your pieces.`),u(r,"CANNOT_PASS",()=>$localize`You cannot pass your turn.`),u(r,"MUST_LAND_ON_EMPTY_SPACE",()=>$localize`You must drop your piece on an empty space.`),u(r,"MUST_PASS",()=>$localize`You must pass your turn.`),u(r,"MUST_CHOOSE_OWN_PIECE_NOT_EMPTY",()=>$localize`You have selected an empty space, you must select one of your own pieces.`),u(r,"MOVE_CANNOT_BE_STATIC",()=>$localize`You must choose different starting and ending coordinates.`),u(r,"SOMETHING_IN_THE_WAY",()=>$localize`There is a piece between the piece you chose and its landing space.`),r})(),Pl=(()=>{class r{}return u(r,"CANNOT_MOVE_MORE_THAN_THREE_PIECES",()=>$localize`You cannot move more than 3 of your pieces!`),u(r,"NOT_ENOUGH_PIECE_TO_PUSH",()=>$localize`You don't have enough pieces to push that group!`),u(r,"CANNOT_PUSH_YOUR_OWN_PIECES",()=>$localize`You cannot push this piece because it is blocked by one of yours!`),u(r,"MUST_ONLY_TRANSLATE_YOUR_PIECES",()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`),u(r,"TRANSLATION_IMPOSSIBLE",()=>$localize`This move is impossible, some landing spaces are occupied.`),u(r,"LINE_AND_COORD_NOT_ALIGNED",()=>$localize`This space is not aligned with the current line.`),r})();Sae=Symbol.iterator;class q1 extends eC{constructor(e,t){super(t),u(this,"board",void 0),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?g.of(this.board[e.y][e.x]):g.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new C(e,t))}forEachCoord(e){for(const{coord:t,content:n}of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isOnBoard(i)&&e.push({coord:i,content:this.getPieceAt(i)})}return e}getCopiedBoard(){return Rt.copy(this.board)}toMap(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t);e.push({key:i,value:this.getPieceAt(i)})}return e}[Sae](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class Fi extends q1{static getInitialState(){const e=ye.EMPTY,t=ye.UNREACHABLE,n=ye.ZERO,i=ye.ONE;return new Fi([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}static isOnBoard(e){return e.isInRange(9,9)&&Fi.getInitialState().getPieceAt(e)!==ye.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===ye.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===ye.ONE&&(e[0]=e[0]-1);return e}}class wr extends Hi{static getFallibleEncoder(e){return we.tuple([C.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return we.tuple([C.encoder],t=>[t.coord],t=>e(t[0]))}constructor(e,t){super(),u(this,"coord",void 0),this.coord=new C(e,t)}equals(e){return this===e||this.coord.equals(e.coord)}}var Pae;class H2 extends wr{static fromSingleCoord(e,t){try{return re.success(new H2(e,t,g.empty()))}catch(n){return re.failure(n.message)}}static fromDoubleCoord(e,t,n){const i=[e,t];en.sortByDescending(i,H2.sortCoord);const s=i[1].getDirectionToward(i[0]).get(),o=be.factory.fromDelta(s.x,s.y);if(o.isFailure())return re.failure("Invalid direction");const a=o.get();return i[1].getDistance(i[0])>2?re.failure("Distance between first coord and last coord is too big"):a.equals(n)?H2.fromSingleCoord(i[1],n):a.getOpposite().equals(n)?H2.fromSingleCoord(i[0],n):re.success(new H2(i[1],n,g.of(i[0])))}static sortCoord(e){return 9*e.y+e.x}constructor(e,t,n){if(super(e.x,e.y),u(this,"dir",void 0),u(this,"lastPiece",void 0),this.dir=t,this.lastPiece=n,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}Pae=H2,u(H2,"encoder",we.tuple([C.encoder,be.encoder,g.getEncoder(C.encoder)],r=>[r.coord,r.dir,r.lastPiece],r=>new Pae(r[0],r[1],r[2])));class Fo extends Kn{static get(){return Fo.singleton.isAbsent()&&(Fo.singleton=g.of(new Fo)),Fo.singleton.get()}constructor(){super(Fi)}static isLegalRealPush(e,t,n,i,s){let o=0;const a=ye.ofPlayer(n.getCurrentOpponent()),c=ye.ofPlayer(n.getCurrentPlayer());for(;o<i&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)o++,e=e.getNext(t.dir);return o>=i?re.failure(Pl.NOT_ENOUGH_PIECE_TO_PUSH()):Fi.isOnBoard(e)&&(n.getPieceAt(e)===ye.EMPTY&&(s[e.y][e.x]=a),n.getPieceAt(e)===c)?re.failure(Pl.CANNOT_PUSH_YOUR_OWN_PIECES()):re.success(s)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?_e.ZERO_WON:t[1]>5?_e.ONE_WON:_e.ONGOING}applyLegalMove(e,t,n){return new Fi(n,t.turn+1)}isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toOtherFallible():e.isSingleCoord()?this.isLegalPush(e,t):this.isLegalSideStep(e,t)}getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===ye.ofPlayer(t.getCurrentOpponent())?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}isLegalPush(e,t){let n=1,i=e.coord.getNext(e.dir);const s=ye.ofPlayer(t.getCurrentPlayer()),o=ye.EMPTY,a=t.getCopiedBoard();for(a[e.coord.y][e.coord.x]=o;n<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===s;)n++,i=i.getNext(e.dir);return n>3?re.failure(Pl.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===Fi.isOnBoard(i)||(a[i.y][i.x]=s,t.getPieceAt(i)===o)?re.success(a):Fo.isLegalRealPush(i,e,t,n,a)}isLegalSideStep(e,t){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let s=e.coord;const o=ye.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();for(;!1===s.equals(n)&&Fi.isOnBoard(s);){if(t.getPieceAt(s)!==o)return re.failure(Pl.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=s.getNext(e.dir);if(a[s.y][s.x]=ye.EMPTY,Fi.isOnBoard(c)){if(t.isPiece(c))return re.failure(Pl.TRANSLATION_IMPOSSIBLE());t.getPieceAt(c)===ye.EMPTY&&(a[c.y][c.x]=o)}s=s.getNext(i)}return re.success(a)}getGameStatus(e){return Fo.getGameStatus(e)}}u(Fo,"singleton",g.empty());const tn=ye.EMPTY,n2=ye.UNREACHABLE,$o=ye.ZERO,fu=ye.ONE;class Tae extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,Fi.getInitialState()),q.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,Fi.getInitialState(),H2.fromSingleCoord(new C(2,6),be.UP).get(),$localize`Congratulations!`),q.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Fi([[n2,n2,n2,n2,tn,$o,$o,fu,fu],[n2,n2,n2,tn,tn,tn,tn,tn,tn],[n2,n2,tn,$o,$o,$o,fu,$o,tn],[n2,tn,tn,tn,tn,tn,tn,tn,tn],[tn,tn,tn,tn,$o,$o,$o,fu,fu],[tn,tn,tn,tn,tn,tn,tn,tn,n2],[tn,tn,tn,tn,$o,fu,tn,n2,n2],[tn,tn,tn,$o,tn,tn,n2,n2,n2],[tn,tn,$o,tn,tn,n2,n2,n2,n2]],0),[H2.fromSingleCoord(new C(4,4),be.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)])}}class Xn{constructor(e,t,n){u(this,"name",void 0),u(this,"moveGenerator",void 0),u(this,"rules",void 0),u(this,"explorationParameter",Math.sqrt(2)),u(this,"maxGameLength",8),u(this,"availableOptions",[]),this.name=e,this.moveGenerator=t,this.rules=n;for(let i=1;i<10;i++)this.availableOptions.push({name:i*i+" seconds",maxSeconds:i*i})}chooseNextMove(e,t){U.assert(!1===this.rules.getGameStatus(e).isEndGame,"cannot search from a finished game");const n=e.gameState.getCurrentPlayer(),i=Date.now(),s=Date.now()+1e3*t.maxSeconds;let o=0;for(;Date.now()<s;){const f=this.expand(this.select({node:e,path:[e]})),d=this.simulate(f.node,s);this.backpropagate(f.path,this.winScore(d,n)),o++}Ne.display("MCTS","chooseNextMove","root winRatio: "+this.winRatio(e)),Ne.display("MCTS","chooseNextMove","children winRatio: "+e.getChildren().map(f=>f.id+": "+this.winRatio(f)));const a=en.maximumsBy(e.getChildren(),f=>this.winRatio(f)),c=en.getRandomElement(a),l=(Date.now()-i)/1e3;return Ne.display("MCTS","chooseNextMove",`Computed ${o} in ${l} (rate: ${o/l} it/s)`),Ne.display("MCTS","chooseNextMove","Best child has a win ratio of: "+this.winRatio(c)),c.previousMove.get()}winScore(e,t){switch(e){case _e.DRAW:case _e.ONGOING:return.5;default:return e.winner===t?1:0}}ucb(e,t){const n=this.simulations(e);return 0===t||0===n?Number.MAX_SAFE_INTEGER:this.wins(e)/n+this.explorationParameter*Math.sqrt(Math.log(t)/n)}winRatio(e){const t=this.simulations(e);return 0===this.simulations(e)?1:this.wins(e)/t}wins(e){return this.getCounterFromCache(e,"wins")}simulations(e){return this.getCounterFromCache(e,"simulations")}getCounterFromCache(e,t){const n=e.getCache(t);return n.isPresent()?n.get():(e.setCache(t,0),0)}select(e){const t=e.node;if(Ne.display("MCTS","select","Exploring node: "+t.id),t.hasChildren()){const n=this.simulations(t);Ne.display("MCTS","select","UCB values: "+t.getChildren().map(o=>o.id+": "+this.ucb(t,n)));const i=en.maximumsBy(t.getChildren(),o=>this.ucb(o,n)),s=en.getRandomElement(i);return Ne.display("MCTS","select","selecting children "+s.id),this.select({node:s,path:e.path.concat([s])})}return Ne.display("MCTS","select","this is a leaf node, we select it"),e}expand(e){if(this.rules.getGameStatus(e.node).isEndGame)return e;const t=e.node,n=this.moveGenerator.getListMoves(t);U.assert(n.length>0,`${this.name}: move generator did not return any move on a non-finished game: ${this.moveGenerator.constructor.name}`);for(const s of n)t.addChild(this.play(t,s));const i=en.getRandomElement(t.getChildren());return{node:i,path:e.path.concat([i])}}simulate(e,t){Ne.display("MCTS","simulate","simulate from node which has a last move of "+e.previousMove.get().toString());let n=e,i=0;for(;i<this.maxGameLength&&Date.now()<t;){const s=this.rules.getGameStatus(n);if(s.isEndGame)return Ne.display("MCTS","simulate",`end game in ${i} steps, winner is ${s.winner}`),s;i++,n=this.playRandomStep(n)}return _e.ONGOING}playRandomStep(e){const t=en.getRandomElement(this.moveGenerator.getListMoves(e));return this.play(e,t)}play(e,t){const n=this.rules.isLegal(t,e.gameState);U.assert(n.isSuccess(),"heuristic returned illegal move");const i=this.rules.applyLegalMove(t,e.gameState,n.get());return new Vo(i,g.of(e),g.of(t))}backpropagate(e,t){for(const n of e)this.addSimulationResult(n,t),Ne.display("MCTS","backpropagate","backpropagate to node which now has "+this.wins(n)/this.simulations(n))}addSimulationResult(e,t){const n=this.simulations(e)+1,i=this.wins(e)+t;e.setCache("wins",i),e.setCache("simulations",n)}getInfo(e){return`wins/simulations=${this.getCounterFromCache(e,"wins")}/${this.getCounterFromCache(e,"simulations")}`}}class Na{}class dr extends Na{getBoardValue(e){const t=this.getMetrics(e);return e1.of(t[0],t[1])}}class OL extends dr{getMetrics(e){return[0,0]}}class an{constructor(e,t,n,i){u(this,"name",void 0),u(this,"rules",void 0),u(this,"heuristic",void 0),u(this,"moveGenerator",void 0),u(this,"random",!1),u(this,"prune",!0),u(this,"availableOptions",[]),this.name=e,this.rules=t,this.heuristic=n,this.moveGenerator=i;for(let s=1;s<10;s++)this.availableOptions.push({name:`Level ${s}`,maxDepth:s})}toString(){return this.name}chooseNextMove(e,t){U.assert(!1===this.rules.getGameStatus(e).isEndGame,"Minimax has been asked to choose a move from a finished game");let n=this.alphaBeta(e,t.maxDepth,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);for(;n.gameState.turn>e.gameState.turn+1;)n=n.parent.get();return n.previousMove.get()}alphaBeta(e,t,n,i){if(t<1)return e;if(this.rules.getGameStatus(e).isEndGame)return e;const s=this.getPossibleMoves(e);U.assert(s.size()>0,"Minimax "+this.name+" should give move, received none!");const o=this.getBestChildren(e,s,t,n,i),a=this.getBestChildAmong(o),c=this.getScore(a);return this.setScore(e,c),a}getPossibleMoves(e){const t=this.getMoves(e);if(t.isAbsent()){const n=this.moveGenerator.getListMoves(e);return this.setMoves(e,new ft(n)),new ft(n)}return t.get()}getBestChildren(e,t,n,i,s){let o=[];const a=e.gameState.getCurrentPlayer();let c=a===k.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const l=a===k.ZERO?(f,d)=>f<d:(f,d)=>d<f;for(const f of t){const d=this.getOrCreateChild(e,f),m=this.alphaBeta(d,n-1,i,s),E=this.getScore(m).value;if(l(E,c)||0===o.length?(c=E,o=[m]):E===c&&o.push(m),this.prune&&l(c,a===k.ZERO?i:s))break;a===k.ZERO?s=Math.min(c,s):i=Math.max(c,i)}return o}getBestChildAmong(e){return this.random?en.getRandomElement(e):e[0]}getOrCreateChild(e,t){const n=e.getChild(t);if(n.isAbsent()){const i=this.rules.isLegal(t,e.gameState),s=t.toString();U.assert(i.isSuccess(),'The minimax "'+this.name+'" has proposed an illegal move ('+s+"), refusal reason: "+i.getReasonOr("")+" this should not happen.");const o=this.rules.applyLegalMove(t,e.gameState,i.get()),a=new Vo(o,g.of(e),g.of(t));return e.addChild(a),this.setScore(a,this.computeBoardValue(a)),a}return n.get()}setScore(e,t){e.setCache(this.name+"-score",t)}getScore(e){const t=e.getCache(this.name+"-score");if(t.isPresent())return t.get();{const n=this.computeBoardValue(e);return this.setScore(e,n),n}}computeBoardValue(e){const t=this.rules.getGameStatus(e);return t.isEndGame?t.toBoardValue():this.heuristic.getBoardValue(e)}setMoves(e,t){e.setCache(this.name+"-moves",t)}getMoves(e){return e.getCache(this.name+"-moves")}getInfo(e){return"BoardValue="+this.heuristic.getBoardValue(e).value}}class W7t extends dr{getMetrics(e){return e.gameState.getScores()}}class Wn{}let q7t=(()=>{class r{}return u(r,"aiTime",0),r})();class Oae extends Wn{getListMoves(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(let s=0;s<9;s++)for(let o=0;o<9;o++){const a=new C(o,s);if(!1!==n.getPieceAt(a).is(i))for(const c of be.factory.all){const l=H2.fromSingleCoord(a,c).get();if(this.isAcceptablePush(l,n)){t.push(l);for(const f of be.factory.all)for(let d=1;d<=2&&!f.equals(c);d++){const m=a.getNext(f,d);if(!Fi.isOnBoard(m))break;{const E=H2.fromDoubleCoord(a,m,c).get();Fo.get().isLegal(E,n).isSuccess()&&t.push(E)}}}}}return new ft(t).toList()}isAcceptablePush(e,t){const n=t.getScores(),i=Fo.get().isLegal(e,t);if(i.isSuccess()){const s=t.getCurrentOpponent().value;return!(new Fi(i.get(),t.turn+1).getScores()[s]>n[s])}return!1}}function j7t(r,e){if(1&r){const t=pe();A(),S(0,"circle",6),W("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onPieceClick(i,s))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("cx",i.getCenterAtXY(t,n).x)("cy",i.getCenterAtXY(t,n).y)("r",.5*i.SPACE_SIZE)}}function Z7t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",4),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onSpaceClick(i,s))}),P(),T(2,j7t,1,6,"circle",5),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();_(1),Ce("id","space_",n,"_",s,""),y("ngClass",o.getSquareClasses(n,s)),I("points",o.getHexaPointsAtXY(n,s)),_(1),y("ngIf",o.isPiece(i))}}function Y7t(r,e){if(1&r&&(A(),S(0,"g"),T(1,Z7t,3,5,"g",3),P()),2&r){const t=e.$implicit,n=p(2);_(1),y("ngIf",n.isBoard(t))}}function K7t(r,e){if(1&r&&(A(),S(0,"g"),T(1,Y7t,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function X7t(r,e){1&r&&(A(),S(0,"marker",7),F(1,"polygon",8),P()),2&r&&Dn("id","arrowhead_",e.$implicit.dir.toString(),"")}function Q7t(r,e){if(1&r){const t=pe();A(),S(0,"g"),F(1,"line",9),S(2,"line",10),W("click",function(){const s=te(t).$implicit;return ne(p().chooseDirection(s.dir))}),P(),S(3,"polygon",11),W("click",function(){const s=te(t).$implicit;return ne(p().chooseDirection(s.dir))}),P()()}if(2&r){const t=e.$implicit;_(1),Dn("id","line_start_",t.dir.toString(),""),I("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.middle.x)("y2",t.middle.y),_(1),Dn("id","line_end_",t.dir.toString(),""),I("x1",t.middle.x)("y1",t.middle.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),_(1),Dn("id","direction_",t.dir.toString(),""),I("transform",t.transformation)}}class J7t{constructor(e,t,n,i,s,o){u(this,"startCenter",void 0),u(this,"middle",void 0),u(this,"landingCenter",void 0),u(this,"landing",void 0),u(this,"dir",void 0),u(this,"transformation",void 0),this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=i,this.dir=s,this.transformation=o}}let eft=(()=>{var r;class e extends lu{constructor(n){super(n),u(this,"moveds",[]),u(this,"directions",[]),u(this,"selecteds",[]),this.rules=Fo.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Score`,this.rules,new W7t,new Oae),new Xn($localize`MCTS`,new Oae,this.rules)],this.encoder=H2.encoder,this.tutorial=(new Tae).tutorial,this.scores=g.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new uu(this.SPACE_SIZE,new C(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),rC.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.hexaBoard=i.getState().getCopiedBoard(),i.scores=g.of(i.getState().getScores())})()}hideLastMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(n){var i=this;return M(function*(){n.isSingleCoord()?i.showPushingMove(n):i.showSideStepMove(n)})()}showPushingMove(n){const i=this.getPreviousState();let s=n.coord;for(this.moveds=[s],s=s.getNext(n.dir);Fi.isOnBoard(s)&&i.isPiece(s);)this.moveds.push(s),s=s.getNext(n.dir);Fi.isOnBoard(s)&&this.moveds.push(s)}showSideStepMove(n){let i=n.lastPiece.get();const s=n.coord.getDirectionToward(i).get();i=i.getNext(s);let o=n.coord;for(;!1===o.equals(i);)this.moveds.push(o),this.moveds.push(o.getNext(n.dir)),o=o.getNext(s)}onPieceClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#piece_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentOpponent();return s.hexaBoard[i][n].is(a)?s.opponentClick(n,i):0===s.selecteds.length?s.firstClick(n,i):1===s.selecteds.length?s.secondClick(n,i):s.thirdClick(n,i)})()}opponentClick(n,i){var s=this;return M(function*(){return(yield s.tryChoosingDirection(n,i)).isSuccess()?b.SUCCESS:s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(n,i){var s=this;return M(function*(){return s.selecteds=[new C(n,i)],s.showPossibleDirections(),b.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(n){const i=this.getState(),s=ye.ofPlayer(i.getCurrentPlayer()),o=this.selecteds[0],a=this.selecteds[this.selecteds.length-1];for(const c of be.factory.all){let f,l=o.getNext(c,1);if(i.isOnBoard(l)&&i.getPieceAt(l)===s){if(n)continue;if(l=a.getNext(c,1),i.isOnBoard(l)&&i.getPieceAt(l)===s)continue}if(f=n?H2.fromSingleCoord(o,c).get():H2.fromDoubleCoord(o,a,c).get(),this.rules.isLegal(f,i).isSuccess()){const m=this.getCenterAt(o),E=this.getCenterAt(l),w=this.getMiddleOfArrow(c,l,E),R=E.x+" "+E.y,$="rotate("+(be.getAngle(c)+150)+" "+R+")",ve=new J7t(m,w,E,l,c,$+" translate("+R+")");this.directions.push(ve)}}}getMiddleOfArrow(n,i,s){const o=i.getPrevious(n),a=this.getCenterAt(o);return new C(a.x+(s.x-a.x)/2,a.y+(s.y-a.y)/2)}isBoard(n){return n!==ye.UNREACHABLE}isPiece(n){return n!==ye.EMPTY}secondClick(n,i){var s=this;return M(function*(){const o=s.selecteds[0],a=new C(n,i);if(a.equals(o))return s.cancelMoveAttempt(),b.SUCCESS;if(!1===a.isHexagonallyAlignedWith(o))return s.cancelMoveAttempt(),s.firstClick(n,i);const c=a.getDistance(o);if(c>2)return s.cancelMove(Pl.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const l=o.getDirectionToward(a).get();s.selecteds=[o];for(let f=0;f<c;f++)s.selecteds.push(o.getNext(l,f+1));if(3===s.selecteds.length){const f=s.selecteds[1],d=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[f.y][f.x].is(d))return s.cancelMoveAttempt(),s.firstClick(n,i)}return s.showPossibleDirections(),b.SUCCESS})()}thirdClick(n,i){var s=this;return M(function*(){const o=new C(n,i),a=s.selecteds[0];if(o.equals(a))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return o.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&o.equals(s.selecteds[1])?(s.cancelMoveAttempt(),b.SUCCESS):s.tryExtension(o,a,c)})()}tryExtension(n,i,s){var o=this;return M(function*(){const a=Me.factory.fromMove(i,n);if(a.isSuccess()){const l=Me.factory.fromMove(s,n);if(a.equals(l)){const f=i.getDistance(n),d=s.getDistance(n);return 2===Math.max(f,d)?(o.selecteds.push(n),en.sortByDescending(o.selecteds,H2.sortCoord),o.showPossibleDirections(),b.SUCCESS):o.cancelMove(Pl.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=yield o.cancelMove(Pl.LINE_AND_COORD_NOT_ALIGNED());return yield o.firstClick(n.x,n.y),c})()}deselectExtremity(n){var i=this;return M(function*(){return i.selecteds=i.selecteds.slice(n?1:0,n?void 0:-1),i.showPossibleDirections(),b.SUCCESS})()}chooseDirection(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#direction_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):i._chooseDirection(n)})()}_chooseDirection(n){var i=this;return M(function*(){const s=i.selecteds[0];if(1===i.selecteds.length){const o=H2.fromSingleCoord(s,n).get();return i.chooseMove(o)}{const a=H2.fromDoubleCoord(s,i.selecteds[i.selecteds.length-1],n).get();return i.chooseMove(a)}})()}onSpaceClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#space_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.tryChoosingDirection(n,i)})()}tryChoosingDirection(n,i){var s=this;return M(function*(){const o=new C(n,i);for(const a of s.directions)if(a.landing.equals(o))return s._chooseDirection(a.dir);return b.failure("not a direction")})()}getSquareClasses(n,i){const s=new C(n,i),o=[];return this.moveds.some(a=>a.equals(s))&&o.push("moved-fill"),o}getPieceClasses(n,i){const s=new C(n,i),o=k.of(this.hexaBoard[i][n].value),a=[this.getPlayerClass(o)];return this.selecteds.some(c=>c.equals(s))&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-abalone"]],features:[Xe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,K7t,2,1,"g",1),S(2,"defs"),T(3,X7t,2,1,"marker",2),P(),T(4,Q7t,4,12,"g",1),P()),2&n&&(_(1),y("ngForOf",i.hexaBoard),_(2),y("ngForOf",i.directions),_(1),y("ngForOf",i.directions))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class tft extends dr{getMetrics(e){const t=e.gameState.board[3].getDominatingPlayer(),n=[0,0];return t.isPlayer()&&(n[t.value]=1),n}}class bae extends Wn{getListMoves(e){const t=e.gameState;return go.ALL_MOVES.filter(function n(i){return s4.get().isLegal(i,t).isSuccess()})}}function nft(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=e.$implicit,n=p();I("cx",n.getRemainingPieceCx(t))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function rft(r,e){if(1&r&&(A(),F(0,"circle",6)),2&r){const t=e.$implicit,n=p();I("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(t))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function ift(r,e){if(1&r){const t=pe();A(),S(0,"polygon",9),W("click",function(){te(t);const i=p().index,s=p();return ne(s.onArrowClick(i,s.PlayerOrNone.ZERO))}),P()}if(2&r){const t=p().index,n=p();Dn("id","dropArrow_zero_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ZERO)),I("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function sft(r,e){if(1&r){const t=pe();A(),S(0,"polygon",9),W("click",function(){te(t);const i=p().index,s=p();return ne(s.onArrowClick(i,s.PlayerOrNone.ONE))}),P()}if(2&r){const t=p().index,n=p();Dn("id","dropArrow_one_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ONE)),I("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function oft(r,e){if(1&r){const t=pe();A(),Gt(0),S(1,"circle",10),W("click",function(){te(t);const i=p().index;return ne(p().onSquareClick(i))}),P(),Bt()}if(2&r){const t=e.$implicit,n=p(),i=n.index,s=n.$implicit,o=p();_(1),Ni("id","square_",i,"_piece_",t,"_out_of_",s.count(o.PlayerOrNone.NONE),""),y("ngClass",o.getPieceClasses(i,t,s)),I("cx",o.getCircleCenter(i,t,s).x)("cy",o.getCircleCenter(i,t,s).y)}}function aft(r,e){if(1&r){const t=pe();A(),S(0,"g"),T(1,ift,1,4,"polygon",7),T(2,sft,1,4,"polygon",7),S(3,"rect",8),W("click",function(){const s=te(t).index;return ne(p().onSquareClick(s))}),P(),T(4,oft,2,6,"ng-container",4),P()}if(2&r){const t=e.$implicit,n=e.index,i=p();I("transform",i.getBlockTransform(n)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),_(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),_(1),Dn("id","square_",n,""),y("ngClass",i.getSquareClasses(n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngForOf",i.ArrayUtils.range(t.count(i.PlayerOrNone.NONE)))}}let wae,cft=(()=>{var r;class e extends Hc{static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(n){super(n),u(this,"PlayerOrNone",Y),u(this,"BOARD_WIDTH",4*this.SPACE_SIZE),u(this,"BOARD_HEIGHT",4.5*this.SPACE_SIZE),u(this,"board",void 0),u(this,"remainingZero",void 0),u(this,"remainingOne",void 0),u(this,"ARROW_COORD",e.getArrowCoord()),u(this,"PIECES_PER_PLAYER",Sl.PIECES_PER_PLAYER),u(this,"PIECE_RADIUS",void 0),u(this,"movedSquare",void 0),u(this,"selectedPiece",g.empty()),u(this,"leftPiece",g.empty()),u(this,"droppedPiece",g.empty()),u(this,"displayableArrow",[]),this.rules=s4.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableAIs=[new an($localize`Minimax`,this.rules,new tft,new bae),new Xn($localize`MCTS`,new bae,this.rules)],this.encoder=go.encoder,this.tutorial=(new _ae).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5)}cancelMoveAttempt(){this.selectedPiece=g.empty(),this.showPossibleDrops()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.board,i.remainingZero=s.remaining.get(k.ZERO).get(),i.remainingOne=s.remaining.get(k.ONE).get(),i.hideLastMove(),i.showPossibleDrops()})()}hideLastMove(){this.movedSquare=[],this.droppedPiece=g.empty(),this.leftPiece=g.empty(),this.selectedPiece=g.empty()}showLastMove(n){var i=this;return M(function*(){n.isDrop()?i.showLastDrop(n):i.showLastTransfer(n)})()}showLastDrop(n){const i=n.piece.get();let s=n.landing.x;this.movedSquare=[s],3!==n.landing.x&&(s+=1,this.movedSquare.push(s));const a=this.getLowestPlayerPiece(this.board[s],i);this.droppedPiece=g.of({square:s,piece:a})}getLowestPlayerPiece(n,i){const s=n.count(i);return i===k.ZERO?s-1:n.count(Y.NONE)-s}showLastTransfer(n){const i=this.getPreviousState(),s=i.getCurrentPlayer(),o=n.starting.get().x,c=this.getLowestPlayerPiece(i.board[o],s);this.leftPiece=g.of({square:o,piece:c});const l=n.landing.x,d=this.getLowestPlayerPiece(this.board[l],s);this.droppedPiece=g.of({square:l,piece:d})}showPossibleDrops(){this.displayableArrow=[];const n=this.getState();for(let i=0;i<4;i++)!1===n.board[i].isFull()&&(n.remaining.get(k.ZERO).get()>0&&this.displayableArrow.push({x:i,player:k.ZERO}),n.remaining.get(k.ONE).get()>0&&this.displayableArrow.push({x:i,player:k.ONE}))}getCircleCenter(n,i,s){const o=this.SPACE_SIZE/2,a=this.SPACE_SIZE/2;if(1===s.count(Y.NONE))return new C(o,a);const c=s.count(Y.NONE),l=2*i*Math.PI/c-Math.PI/2,f=.3*this.SPACE_SIZE,d=f*Math.cos(l),m=f*Math.sin(l);return new C(o+d,a+m)}canDisplayArrow(n,i){return this.displayableArrow.some(s=>s.x===n&&s.player.equals(i))}getArrowClasses(n,i){return[this.getPlayerClass(i)]}getBlockTransform(n){return"translate("+n*this.SPACE_SIZE+", "+((3-n)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(n){const i=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===n?i.push("selected-stroke"):this.movedSquare.includes(n)&&i.push("last-move-stroke"),i}onArrowClick(n,i){var s=this;return M(function*(){const o=i===k.ZERO?"zero":"one",a=yield s.canUserPlay("#dropArrow_"+o+"_"+n);if(a.isFailure())return s.cancelMove(a.getReason());const c=Jt.of(n);if(s.selectedPiece.isPresent()){const l=s.selectedPiece.get().square,f=go.transfer(Jt.of(l),c).get();return s.chooseMove(f)}{const l=go.drop(c,i);return s.chooseMove(l)}})()}getPieceClasses(n,i,s){const o={square:n,piece:i},a=[];let c=s.count(k.ZERO),l=s.count(k.ONE);if(this.selectedPiece.equalsValue(o))a.push("selected-stroke");else if(this.droppedPiece.equalsValue(o))a.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===n){if(this.leftPiece.get().piece===i)return a.push("captured-stroke"),a;this.getState().getCurrentOpponent()===k.ZERO?c++:l++}const f=s.count(Y.NONE)-(l+c),d=this.getPieceColor(i,c,f);return""!==d&&a.push(d),a}getPieceColor(n,i,s){return n<i?"player0-fill":n>=i+s?"player1-fill":""}onSquareClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#square_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.selectedPiece.isPresent()&&i.selectedPiece.get().square===n)return i.cancelMoveAttempt(),b.SUCCESS;const o=i.getState().getCurrentPlayer(),a=i.board[n];return a.count(o)<=0?i.cancelMove(ou.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(i.selectedPiece=g.of({square:n,piece:i.getLowestPlayerPiece(a,o)}),0===i.showAndGetPossibleTranfers().length?i.cancelMove(ou.NO_POSSIBLE_TRANSFER_REMAINS()):b.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let n=this.selectedPiece.get().square-1;const i=this.getState().getCurrentPlayer();for(;0<=n;)!1===this.board[n].isFull()&&this.displayableArrow.push({x:n,player:i}),n--;return this.displayableArrow}getRemainingPieceCx(n){return(n+.5)*this.PIECE_RADIUS*1.5}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-apagos"]],features:[Xe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),T(2,nft,1,3,"circle",1),T(3,rft,1,3,"circle",2),P(),S(4,"g",3),T(5,aft,5,8,"g",4),P()()),2&n&&(I("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),_(1),I("transform","rotate("+180*i.getPointOfView().value+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingOne)),_(1),y("ngForOf",i.ArrayUtils.range(i.remainingZero)),_(2),y("ngForOf",i.board))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Pn=(()=>{class r extends q1{static getInitialState(){const t=Rt.create(r.WIDTH,2,4);return new r(t,0,[0,0])}constructor(t,n,i){super(t,n),u(this,"scores",void 0),this.scores=i}getScoresCopy(){return[this.scores[0],this.scores[1]]}equals(t){return!1!==Rt.compare(this.board,t.board)&&!1!==en.compare(this.scores,t.scores)&&this.turn===t.turn}getCurrentPlayerY(){return this.getCurrentOpponent().value}getOpponentY(){return this.getCurrentPlayer().value}}return u(r,"WIDTH",6),r})(),du=(()=>{class r{}return u(r,"MUST_DISTRIBUTE_YOUR_OWN_HOUSES",()=>$localize`You must distribute one of your houses.`),u(r,"MUST_CHOOSE_NON_EMPTY_HOUSE",()=>$localize`You should choose a non-empty house to distribute.`),u(r,"SHOULD_DISTRIBUTE",()=>$localize`You should feed but you do not.`),r})();class gs extends Kn{static isStarving(e,t){let n=0;const i=e.getOpponent().value;for(;n<Pn.WIDTH;)if(t[i][n++]>0)return!1;return!0}constructor(e){super(Pn),u(this,"config",void 0),this.config=e}mustMansoon(e){const t=e.getCopiedBoard(),n=e.getCurrentOpponent(),i=e.getCurrentPlayer();if(this.config.mustFeed){if(gs.isStarving(i,t)&&!1===this.canDistribute(n,t))return n}else{if(gs.isStarving(n,t))return i;if(gs.isStarving(i,t))return n}return Y.NONE}getGameStatus(e){const t=e.gameState;return t.scores[0]>24?_e.ZERO_WON:t.scores[1]>24?_e.ONE_WON:24===t.scores[0]&&24===t.scores[1]?_e.DRAW:_e.ONGOING}applyLegalMove(e,t,n){const i=this.distributeMove(e,t),s=this.applyCapture(i);let o=s.resultingState;const a=this.mustMansoon(o);return a!==Y.NONE&&(o=this.monsoon(a,s).resultingState),new Pn(o.board,o.turn+1,o.scores)}distributeHouse(e,t,n){let i=new C(e,t);const s=n.getCopiedBoard(),o=n.getCurrentPlayer(),a=new C(e,t);let c=s[t][e];const l=[];s[t][e]=0;let f=0,d=!1,m=!1;for(;c>0;){d=m,m=!1;const E=this.getNextCoord(i,o,d);m=E.isAbsent(),m?(f++,c--,l.push(gs.FAKE_STORE_COORD.get(o).get())):(i=E.get(),(!1===a.equals(i)||this.config.feedOriginalHouse)&&(s[i.y][i.x]+=1,l.push(i),c--))}return{filledCoords:l,passedByKalahNTimes:f,endsUpInKalah:m,resultingState:new Pn(s,n.turn,n.getScoresCopy())}}getNextCoord(e,t,n){return 0===e.y?e.x===Pn.WIDTH-1?this.config.passByPlayerStore&&t===k.ONE&&!1===n?g.empty():g.of(new C(e.x,1)):g.of(new C(e.x+1,e.y)):0===e.x?this.config.passByPlayerStore&&t===k.ZERO&&!1===n?g.empty():g.of(new C(e.x,0)):g.of(new C(e.x-1,e.y))}doesDistribute(e,t,n){return 0===t?n[t][e]>Pn.WIDTH-1-e:n[t][e]>e}canDistribute(e,t){for(let n=0;n<Pn.WIDTH;n++)if(this.doesDistribute(n,e.getOpponent().value,t))return!0;return!1}monsoon(e,t){const n=t.resultingState,i=n.getCopiedBoard(),s=n.getScoresCopy();let o=0;const a=Rt.copy(t.captureMap);let c=0;const l=e.getOpponent().value;for(;c<Pn.WIDTH;)o+=i[l][c],a[l][c]+=i[l][c],i[l][c]=0,c++;return s[e.value]+=o,{capturedSum:o,captureMap:a,resultingState:new Pn(i,n.turn,s)}}}u(gs,"FAKE_STORE_COORD",new iu([{key:k.ZERO,value:new C(-1,-1)},{key:k.ONE,value:new C(2,2)}]));class o4 extends gs{static get(){return o4.singleton.isAbsent()&&(o4.singleton=g.of(new o4)),o4.singleton.get()}constructor(){super({passByPlayerStore:!1,mustFeed:!0,feedOriginalHouse:!1})}distributeMove(e,t){const n=t.getCurrentPlayerY();return this.distributeHouse(e.x,n,t)}applyCapture(e){const t=e.filledCoords,n=t[t.length-1];return this.captureIfLegal(n.x,n.y,e.resultingState)}isLegal(e,t){const n=t.getCurrentOpponent(),i=t.getCurrentPlayerY(),s=e.x;if(0===t.getPieceAtXY(s,i))return b.failure(du.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=gs.isStarving(n,t.board),a=!1===this.doesDistribute(s,i,t.board);return o&&a?b.failure(du.SHOULD_DISTRIBUTE()):b.SUCCESS}capture(e,t,n){const i=n.getCurrentPlayerY();U.assert(t!==i,"AwaleRules.capture cannot capture the players house");const s=n.getCopiedBoard();let o=s[t][e],a=0;const c=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(o<2||o>3)return{capturedSum:0,captureMap:c,resultingState:n};let l=-1,f=-1;n.getCurrentPlayer()===k.ONE&&(l=1,f=Pn.WIDTH);do{c[t][e]=o,a+=o,s[t][e]=0,o=s[t][e+=l]}while(e!==f&&(2===o||3===o));const d=n.getScoresCopy();return d[n.getCurrentPlayer().value]+=a,{capturedSum:a,captureMap:c,resultingState:new Pn(s,n.turn,d)}}captureIfLegal(e,t,n){const i=n.getCurrentPlayer(),s={capturedSum:0,resultingState:n,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]};if(t===i.getOpponent().value)return s;{const o=this.capture(e,t,n),a=gs.isStarving(i.getOpponent(),o.resultingState.board);return o.capturedSum>0&&a?s:o}}}var Tl,Ol;u(o4,"singleton",g.empty());class h1{static of(e){switch(e){case 0:return h1.ZERO;case 1:return h1.ONE;case 2:return h1.TWO;case 3:return h1.THREE;case 4:return h1.FOUR;default:return U.expectToBe(e,5,"Invalid x for AwaleMove: "+e),h1.FIVE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}}Tl=h1,u(h1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>Tl.of(r[0]))),u(h1,"ZERO",new Tl(0)),u(h1,"ONE",new Tl(1)),u(h1,"TWO",new Tl(2)),u(h1,"THREE",new Tl(3)),u(h1,"FOUR",new Tl(4)),u(h1,"FIVE",new Tl(5)),wae=Symbol.iterator;class Nae extends Hi{constructor(e){super(),u(this,"distributions",void 0),this.distributions=e}[wae](){return this.distributions.values()}}class m1 extends Nae{static of(e){switch(e){case 0:return m1.ZERO;case 1:return m1.ONE;case 2:return m1.TWO;case 3:return m1.THREE;case 4:return m1.FOUR;default:return U.expectToBe(e,5,"Invalid x for AwaleMove: "+e),m1.FIVE}}constructor(e){super([h1.of(e)]),u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}u(m1,"ZERO",new(Ol=m1)(0)),u(m1,"ONE",new Ol(1)),u(m1,"TWO",new Ol(2)),u(m1,"THREE",new Ol(3)),u(m1,"FOUR",new Ol(4)),u(m1,"FIVE",new Ol(5)),u(m1,"encoder",we.tuple([we.identity()],r=>[r.x],r=>Ol.of(r[0])));let Aae=(()=>{class r{}return u(r,"SOWING",e=>q.fromMove($localize`Sowing`,$localize`The main move in Mancala games is sowing, let's see how seeds are sown. As you are playing Dark, the 6 houses on the bottom are yours.<br/><br>Click on the rightmost bottom house to sow the seeds it contains: they will be sown clockwise, one seed per house.<br/><br/>Click on the rightmost house!`,Pn.getInitialState(),[e],$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds. This is how seeds are sown: one by one from the house next to the one they come from, clockwise.`,$localize`Failed. Choose the rightmost house on the bottom.`)),r})();class Iae extends Yn{constructor(...e){super(...e),u(this,"gameName",$localize`Awal`),u(this,"tutorial",[q.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,Pn.getInitialState()),q.informational($localize`Awal`,$localize`Bonus fact: Awal is the most common of all Mancalas.`,Pn.getInitialState()),Aae.SOWING(m1.FIVE),q.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new Pn([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),m1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),q.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new Pn([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),q.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which now contains 2 seeds, so this will be a capture. But now, the house right before it contains 3 seeds, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new Pn([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),q.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new Pn([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),q.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new Pn([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[m1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),q.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>You're playing Dark. Try it.`,new Pn([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[m1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),q.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new Pn([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),m1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),q.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new Pn([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[23,10]),m1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side. Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)])}}let $i=(()=>{var r;class e extends Hc{constructor(...n){super(...n),u(this,"board",void 0)}getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",We({type:r,selectors:[["ng-component"]],features:[Xe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();function kae(r){return 1e3*r.seconds+r.nanoseconds/1e6}function xae(r,e){return kae(e)-kae(r)}class bL{static sleep(e){return M(function*(){return new Promise(t=>{window.setTimeout(t,e)})})()}}class lft extends dr{getMetrics(e){const t=e.gameState.getScoresCopy();return[t[0],t[1]]}}class uft extends an{constructor(e,t){super($localize`Score`,e,new lft,t)}}let Lae=(()=>{class r extends $i{constructor(t,n){super(t),u(this,"cdr",void 0),u(this,"MGPOptional",g),u(this,"lastDistributedHouses",[]),u(this,"currentMove",g.empty()),u(this,"clickOngoing",!1),u(this,"captured",[[0,0,0,0,0,0],[0,0,0,0,0,0]]),u(this,"droppedInStore",[0,0]),u(this,"filledCoords",[]),u(this,"constructedState",void 0),u(this,"opponentMoveIsBeingAnimated",!1),this.cdr=n,this.hasAsymmetricBoard=!0,this.scores=g.of([0,0])}showLastMove(t){var n=this;return M(function*(){n.droppedInStore=[0,0];const i=n.getPreviousState(),s=n.rules.distributeMove(t,i);n.filledCoords=s.filledCoords;let o=n.rules.applyCapture(s);n.captured=o.captureMap;const a=i.getCurrentPlayerY();n.lastDistributedHouses=t.distributions.map(l=>new C(l.x,a));const c=n.rules.mustMansoon(o.resultingState);c!==Y.NONE&&(o=n.rules.monsoon(c,o),n.captured=o.captureMap),n.changeVisibleState(n.getState())})()}updateBoard(t){var n=this;return M(function*(){const i=n.getState();if(t){n.opponentMoveIsBeingAnimated=!0,U.assert(n.node.parent.isPresent(),"triggerAnimation in store should be false at first turn"),n.changeVisibleState(n.node.parent.get().gameState);let s=0;const o=n.node.previousMove.get();for(const a of o)yield n.showSimpleDistribution(a),s+1<o.distributions.length&&(yield bL.sleep(r.TIMEOUT_BETWEEN_DISTRIBUTION)),s++;n.opponentMoveIsBeingAnimated=!1}n.scores=g.of(i.getScoresCopy()),n.changeVisibleState(i)})()}onClick(t,n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+t+"_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(!0===i.clickOngoing)return b.SUCCESS;if(!0===i.opponentMoveIsBeingAnimated)return b.SUCCESS;{i.clickOngoing=!0;const o=yield i.onLegalClick(t,n);return i.clickOngoing=!1,o}})()}onLegalClick(t,n){var i=this;return M(function*(){return n===i.getState().getCurrentPlayer().value?i.cancelMove(du.MUST_DISTRIBUTE_YOUR_OWN_HOUSES()):(i.updateOrCreateCurrentMove(t),0===i.constructedState.getPieceAtXY(t,n)?i.cancelMove(du.MUST_CHOOSE_NON_EMPTY_HOUSE()):i.continueMoveConstruction(t))})()}continueMoveConstruction(t){var n=this;return M(function*(){const i=yield n.showSimpleDistribution(h1.of(t));if(i.endsUpInKalah){const s=n.constructedState.getCurrentPlayer();return gs.isStarving(s,i.resultingState.board)?n.chooseMove(n.currentMove.get()):b.SUCCESS}return n.chooseMove(n.currentMove.get())})()}showSimpleDistribution(t){var n=this;return M(function*(){const i=n.constructedState,s=i.getCurrentPlayerY(),o=new C(t.x,s);return n.lastDistributedHouses.push(o),yield n.showSeedBySeed(o,i),n.rules.distributeHouse(t.x,s,i)})()}showSeedBySeed(t,n){var i=this;return M(function*(){const s=n.getCopiedBoard(),o=n.getCurrentPlayer(),a=t;let c=s[t.y][t.x],l=!1;const f=n.getScoresCopy();for(s[t.y][t.x]=0,i.changeVisibleState(new Pn(s,n.turn,f)),yield bL.sleep(r.TIMEOUT_BETWEEN_SEED);c>0;){const d=i.rules.getNextCoord(t,o,l);l=d.isAbsent(),l?(c--,i.filledCoords.push(gs.FAKE_STORE_COORD.get(o).get()),i.droppedInStore[o.value]+=1,f[o.value]+=1):(t=d.get(),(!1===a.equals(t)||i.rules.config.feedOriginalHouse)&&(s[t.y][t.x]+=1,i.filledCoords.push(t),c--)),i.changeVisibleState(new Pn(s,n.turn,f)),yield bL.sleep(r.TIMEOUT_BETWEEN_SEED)}})()}hideLastMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}cancelMoveAttempt(){this.currentMove=g.empty(),this.droppedInStore=[0,0],this.filledCoords=[],this.lastDistributedHouses=[],this.changeVisibleState(this.getState())}getSpaceClasses(t,n){const i=new C(t,n),s=this.getSpaceOwner(i),o=this.getPlayerClass(s);return this.getStoreOwner(i).isAbsent()&&this.captured[n][t]>0?["captured-fill","moved-stroke"]:this.lastDistributedHouses.some(a=>a.equals(i))?["last-move-stroke",o]:this.filledCoords.some(a=>a.equals(i))?["moved-stroke",o]:[o]}getStoreOwner(t){return gs.FAKE_STORE_COORD.reverse().get(t)}getSpaceOwner(t){const n=this.getStoreOwner(t);return n.isPresent()?n.get().getAnyElement().get():k.of((t.y+1)%2)}getPieceCx(t){return 80+100*(t+1)}getPieceCy(t){return 60+120*t}getPieceTransform(t,n){return"translate("+this.getPieceCx(t)+", "+this.getPieceCy(n)+")"}getPieceRotation(){return"rotate("+180*this.getPointOfView().value+")"}getHouseSecondaryContent(t,n){const i=this.getPreviousStableState().getPieceAtXY(t,n),o=this.constructedState.getPieceAtXY(t,n)-i;return this.captured[n][t]>0?g.of("-"+this.captured[n][t]):o>0?g.of("+"+o):o<0?g.of(""+o):g.empty()}getStoreContent(t){return this.scores.get()[t.value]+this.droppedInStore[t.value]}getStoreSecondaryContent(t){const n=this.getPreviousStableState().scores[t.value],s=this.constructedState.scores[t.value]-n;return s>0?g.of("+"+s):g.empty()}getPreviousStableState(){return this.opponentMoveIsBeingAnimated?(U.assert(this.getTurn()>0,"Kalah: Should not animate move at turn 0"),this.node.parent.get().gameState):!0===this.constructedState.equals(this.getState())&&this.node.parent.isPresent()?this.node.parent.get().gameState:this.getState()}onStoreClick(t){var n=this;return M(function*(){const i=yield n.canUserPlay("#store_player_"+t.value);return i.isFailure()?n.cancelMove(i.getReason()):n.cancelMove(du.MUST_DISTRIBUTE_YOUR_OWN_HOUSES())})()}changeVisibleState(t){this.constructedState=t,this.board=this.constructedState.board,this.cdr.detectChanges()}createAIs(t){return[new uft(this.rules,t),new Xn($localize`MCTS`,t,this.rules)]}}return u(r,"TIMEOUT_BETWEEN_SEED",200),u(r,"TIMEOUT_BETWEEN_DISTRIBUTION",1e3),r})();class fft extends Lae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){this.currentMove=g.of(this.generateMove(e))}}class dft extends Wn{getListMoves(e){const t=[],n=e.gameState,s=(n.turn+1)%2;let o,a=0;for(;a<Pn.WIDTH;)0!==n.getPieceAtXY(a,s)&&(o=m1.of(a),o4.get().isLegal(o,n).isSuccess()&&(o=m1.of(a),t.push(o))),a++;return t}}const hft=["app-numbered-circle",""];function pft(r,e){if(1&r&&(A(),S(0,"text",3),ct(1),P()),2&r){const t=p();Ce("id","secondary_message_",t.x,"_",t.y,""),I("x",15)("y",31)("transform",t.rotation),_(1),b2(" ",t.secondaryContent.get()," ")}}let Rae=(()=>{var r;class e{constructor(){u(this,"x",void 0),u(this,"y",void 0),u(this,"spaceClasses",void 0),u(this,"content",void 0),u(this,"secondaryContent",void 0),u(this,"rotation",void 0)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",We({type:r,selectors:[["","app-numbered-circle",""]],inputs:{x:"x",y:"y",spaceClasses:"spaceClasses",content:"content",secondaryContent:"secondaryContent",rotation:"rotation"},attrs:hft,decls:4,vars:10,consts:[["r","45",1,"base",3,"id","ngClass"],[1,"text-big","text-center",3,"id"],["class","text-20 text-center",3,"id",4,"ngIf"],[1,"text-20","text-center",3,"id"]],template:function(n,i){1&n&&(A(),F(0,"circle",0),S(1,"text",1),ct(2),P(),T(3,pft,2,6,"text",2)),2&n&&(Ce("id","circle_",i.x,"_",i.y,""),y("ngClass",i.spaceClasses),_(1),Ce("id","number_",i.x,"_",i.y,""),I("x",0)("y",16)("transform",i.rotation),_(1),b2(" ",i.content," "),_(1),y("ngIf",i.secondaryContent.isPresent()))},dependencies:[Ft,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function gft(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",s.getSpaceClasses(n,i))("rotation",s.getPieceRotation())("secondaryContent",s.getHouseSecondaryContent(n,i)),I("transform",s.getPieceTransform(n,i))}}function mft(r,e){if(1&r&&(A(),S(0,"g"),T(1,gft,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let _ft=(()=>{var r;class e extends fft{constructor(n,i){super(n,i),this.rules=o4.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(new dft),this.encoder=m1.encoder,this.tutorial=(new Iae).tutorial}generateMove(n){return m1.of(n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut),B(T3))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-awale-component"]],features:[Xe],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,mft,2,1,"g",2),F(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(I("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,Rae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Vs extends Hi{static getFallibleEncoder(e){return we.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return we.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}constructor(e,t){super(),u(this,"first",void 0),u(this,"second",void 0),this.first=e,this.second=t}getFirst(){return this.first}getSecond(){return this.second}}class Go extends Vs{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Le.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return Me.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}let iC=(()=>{class r{}return u(r,"LANDING_ON_OCCUPIED_SQUARE",()=>$localize`You cannot land on an occupied square.`),u(r,"THRONE_IS_LEFT_FOR_GOOD",()=>$localize`Once you left the central throne, you cannot return to it.`),u(r,"SOLDIERS_CANNOT_SIT_ON_THRONE",()=>$localize`Soldiers cannot sit on the throne.`),u(r,"MOVE_MUST_BE_ORTHOGONAL",()=>$localize`Tafl moves must be orthogonal.`),r})();class wL extends Go{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const n=e.getDirectionToward(t);if(n.isFailure()||n.get().isDiagonal())throw new Error(iC.MOVE_MUST_BE_ORTHOGONAL())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class ms extends wL{static of(e,t){return new ms(e,t)}static from(e,t){try{const n=new ms(e,t);return re.success(n)}catch(n){return re.failure(n.message)}}getMaximalDistance(){return 7}}u(ms,"encoder",Vs.getFallibleEncoder(ms.from));const vft={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:k.ZERO};var Id,sC;class sn{constructor(e,t){u(this,"owner",void 0),u(this,"king",void 0),this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}u(sn,"UNOCCUPIED",new(Id=sn)(Y.NONE,!1)),u(sn,"PLAYER_ONE_KING",new Id(Y.ONE,!0)),u(sn,"INVADERS",new Id(Y.ZERO,!1)),u(sn,"DEFENDERS",new Id(Y.ONE,!1));class E1{constructor(e){u(this,"value",void 0),this.value=e}}u(E1,"NONE",new(sC=E1)("NONE")),u(E1,"OPPONENT",new sC("OPPONENT")),u(E1,"PLAYER",new sC("PLAYER"));class NL extends q1{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new C(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let i;return i=n===Y.NONE?E1.NONE:e===n?E1.PLAYER:E1.OPPONENT,i}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class Aa extends NL{static getInitialState(){const e=sn.UNOCCUPIED,t=sn.INVADERS,n=sn.DEFENDERS;return new Aa([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,sn.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}of(e,t){return new Aa(e,t)}}class AL extends Kn{constructor(e,t,n){super(e),u(this,"config",void 0),u(this,"generateMove",void 0),this.config=t,this.generateMove=n}isLegal(e,t){const n=t.getCurrentPlayer(),i=this.getMoveValidity(n,e,t);return i.isFailure()?b.failure(i.getReason()):b.SUCCESS}getMoveValidity(e,t,n){const i=n.getRelativeOwner(e,t.getStart());if(i===E1.NONE)return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(i===E1.OPPONENT)return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.getEnd())!==E1.NONE)return b.failure(iC.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.getEnd())){if(!n.getPieceAt(t.getStart()).isKing())return b.failure(iC.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return b.failure(iC.THRONE_IS_LEFT_FOR_GOOD())}const o=t.getStart().getDirectionToward(t.getEnd()).get(),a=t.getStart().getOrthogonalDistance(t.getEnd());let c=t.getStart().getNext(o);for(let l=1;l<a;l++){if(n.getPieceAt(c)!==sn.UNOCCUPIED)return b.failure(Le.SOMETHING_IN_THE_WAY());c=c.getNext(o)}return b.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,i){const s=t.getNext(n);return s.isNotInRange(this.config.WIDTH,this.config.WIDTH)||i.getRelativeOwner(e,s)!==E1.OPPONENT?g.empty():i.getPieceAt(s).isKing()?this.captureKing(e,t,n,i):this.capturePawn(e,t,n,i)}captureKing(e,t,n,i){const s=t.getNext(n),{backCoord:o,back:a,backInRange:c,left:l,leftCoord:f,right:d,rightCoord:m}=this.getSurroundings(s,n,e,i);return!1===c?this.captureKingAgainstTheWall(l,d,s):a===E1.NONE&&this.isThrone(i,o)?this.captureKingAgainstThrone(o,s,l,d):a===E1.PLAYER?this.captureKingWithAtLeastASandwich(i,s,l,f,d,m):g.empty()}getSurroundings(e,t,n,i){const s=e.getNext(t),o=s.isInRange(this.config.WIDTH,this.config.WIDTH),a=o?i.getRelativeOwner(n,s):E1.NONE,c=e.getLeft(t),f=c.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,c):E1.NONE,d=e.getRight(t),E=d.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,d):E1.NONE;return{backCoord:s,back:a,backInRange:o,leftCoord:c,left:f,rightCoord:d,right:E}}captureKingAgainstTheWall(e,t,n){let i=e===E1.PLAYER?1:0;return i+=t===E1.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?g.of(n):g.empty()}captureKingAgainstThrone(e,t,n,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t)}else if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&(n===E1.PLAYER||i===E1.PLAYER))return g.of(t);return g.empty()}capturePawn(e,t,n,i){const s=t.getNext(n),o=s.getNext(n);let a=E1.NONE;return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&(a=i.getRelativeOwner(e,o)),a===E1.NONE?!1===this.isThrone(i,o)?(Ne.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")cannot capture a pawn without an ally behind"),g.empty()):(Ne.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):a===E1.PLAYER?(Ne.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):(Ne.display("TaflRules","capturePawn","no captures; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.empty())}captureKingWithAtLeastASandwich(e,t,n,i,s,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,c=this.isThrone(e,i),l=n===E1.PLAYER||c&&a,f=this.isThrone(e,o);return l&&(s===E1.PLAYER||f&&a)?g.of(t):g.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(e,t,n){const i=t.turn,s=t.getCopiedBoard(),o=t.getCurrentPlayer(),a=e.getStart(),c=e.getEnd();s[c.y][c.x]=s[a.y][a.x],s[a.y][a.x]=sn.UNOCCUPIED;for(const l of Re.ORTHOGONALS){const f=this.tryCapture(o,e.getEnd(),l,t);f.isPresent()&&(s[f.get().y][f.get().x]=sn.UNOCCUPIED)}return t.of(s,i+1)}getGameStatus(e){const n=this.getWinner(e.gameState);return n.isPresent()?_e.getVictory(n.get()):_e.ONGOING}getWinner(e){const t=this.getKingCoord(e);if(t.isAbsent())return Ne.display("TaflRules","getWinner","The king is dead, victory to invader"),g.of(this.getInvader());const n=t.get();return this.isExternalThrone(n)?(Ne.display("TaflRules","getWinner","The king escape, victory to defender"),g.of(this.getDefender())):this.isPlayerImmobilized(k.ZERO,e)?(Ne.display("TaflRules","getWinner","Zero has no move, victory to one"),g.of(k.ONE)):this.isPlayerImmobilized(k.ONE,e)?(Ne.display("TaflRules","getWinner","One has no move, victory to zero"),g.of(k.ZERO)):(Ne.display("TaflRules","getWinner","no victory"),g.empty())}getKingCoord(e){for(let t=0;t<this.config.WIDTH;t++)for(let n=0;n<this.config.WIDTH;n++)if(e.getPieceAtXY(n,t).isKing())return g.of(new C(n,t));return g.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(e,t){const n=[],i=this.getPlayerListPawns(e,t);for(const s of i){const o=this.getPossibleDestinations(s,t);for(const a of o){const c=this.generateMove(s,a).get();n.push(c)}}return n}getPlayerListPawns(e,t){const n=[];for(let i=0;i<this.config.WIDTH;i++)for(let s=0;s<this.config.WIDTH;s++){const o=new C(s,i);t.getAbsoluteOwner(o)===e&&n.push(o)}return n}getPossibleDestinations(e,t){const n=[];let i;for(const s of Re.ORTHOGONALS){i=e.getNext(s,1);let o=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===o;)t.getAbsoluteOwner(i)===Y.NONE?this.isExternalThrone(i)?t.getPieceAt(e).isKing()&&n.push(i):t.isCentralThrone(i)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(i):n.push(i):o=!0,i=i.getNext(s,1)}return n}}class bl extends AL{static get(){return bl.singleton.isAbsent()&&(bl.singleton=g.of(new bl)),bl.singleton.get()}constructor(){super(Aa,vft,ms.from)}}u(bl,"singleton",g.empty());let Hae,b0=class extends Wn{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=this.rules.getPlayerListMoves(n,t);return this.orderMoves(t,i)}orderMoves(e,t){const n=this.rules.getKingCoord(e).get();return e.getCurrentPlayer()===this.rules.config.INVADER?en.sortByDescending(t,i=>-i.getEnd().getOrthogonalDistance(n)):en.sortByDescending(t,i=>i.getStart().equals(n)?this.rules.isExternalThrone(i.getEnd())?2:1:0),t}};b0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],b0);class oC{constructor(e,t){u(this,"directThreats",void 0),u(this,"mover",void 0),this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class Dae extends oC{constructor(e,t){super(new ft([e]),t),u(this,"directThreat",void 0),this.directThreat=e}}Hae=Symbol.iterator;class yft extends ft{constructor(e){if(super(),u(this,"valueMap",void 0),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0])void 0===n[s]&&(n[s]=[]),n=n[s];const i=t[1];return void 0===n[i]&&(n[i]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0]){if(void 0===n[s])return!1;n=n[s]}return void 0!==n[t[1]]}[Hae](){return this.values.values()}}class j1 extends yft{toFields(e){return[[e.y],e.x]}}class Vae extends dr{constructor(e){super(),u(this,"rules",void 0),this.rules=e}getMetrics(e){const t=e.gameState,n=this.rules.getPlayerListPawns(k.ZERO,t).length,i=this.rules.getPlayerListPawns(k.ONE,t).length;return[n*[1,2][this.rules.config.INVADER.value],i*[2,1][this.rules.config.INVADER.value]]}}class Fae extends Vae{constructor(e){super(e),u(this,"width",void 0),u(this,"maxInfluence",void 0),u(this,"scoreByThreatenedPiece",void 0),u(this,"scoreBySafePiece",void 0),this.width=this.rules.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.rules.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,i=sn.UNOCCUPIED;let s=0;const o=this.getPiecesMap(n),a=this.getThreatMap(n,o),c=this.filterThreatMap(a,n);for(const l of k.PLAYERS)for(const f of o.get(l).get())if(c.get(f).isPresent())s+=l.getScoreModifier()*this.scoreByThreatenedPiece;else{s+=l.getScoreModifier()*this.scoreBySafePiece;let d=0;for(const m of Re.ORTHOGONALS){let E=f.getNext(m,1);for(;E.isInRange(this.width,this.width)&&n.getPieceAt(E)===i;)d++,E=E.getNext(m,1)}s+=d*l.getScoreModifier()}return new e1(s)}getPiecesMap(e){const t=sn.UNOCCUPIED,n=[],i=[];for(let o=0;o<this.width;o++)for(let a=0;a<this.width;a++){const c=new C(a,o);e.getPieceAt(c)!==t&&(e.getAbsoluteOwner(c)===k.ZERO?n.push(c):i.push(c))}return new Sn([{key:k.ZERO,value:new j1(n)},{key:k.ONE,value:new j1(i)}])}getThreatMap(e,t){const n=new Sn;for(const i of k.PLAYERS)for(const s of t.get(i).get()){const o=this.getThreats(s,e);this.isThreatReal(s,e,o)&&n.set(s,new ft(o))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);je(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),s=[];for(const o of Re.ORTHOGONALS){const a=e.getPrevious(o,1);if(this.isAThreat(a,t,i)){const c=[];for(const l of Re.ORTHOGONALS){if(l===o.getOpposite())continue;let f=e.getNext(o,1);for(;f.isInRange(this.width,this.width)&&t.getPieceAt(f)===sn.UNOCCUPIED;)f=f.getNext(l);f.isInRange(this.width,this.width)&&t.getAbsoluteOwner(f)===i&&!1===e.getNext(o,1).equals(f)&&c.push(f)}s.push(new Dae(a,new j1(c)))}}return s}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.rules.isThrone(t,e)||n!==k.ONE&&t.getPieceAt(e)!==sn.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new Sn,i=e.listKeys(),s=i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentPlayer()),o=new j1(i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentOpponent()));for(const a of s){const c=e.get(a).get(),l=[];for(const f of c)if(!1===o.contains(f.directThreat)){const d=[];for(const m of f.mover)!1===o.contains(m)&&d.push(m);d.length>0&&l.push(new Dae(f.directThreat,new j1(d)))}l.length>0&&n.set(a,new ft(l))}for(const a of o){const c=e.get(a).get();n.set(a,c)}return n}}class Mft extends an{constructor(e){super($localize`Pieces > Influence`,e,new Fae(e),new b0(e))}}class Eft extends an{constructor(e){super($localize`Pieces`,e,new Vae(e),new b0(e))}}class $ae extends Fae{getBoardValue(e){const t=e.gameState,n=this.getControlScoreAndPieceScores(t);let i=n.controlScore;i+=n.safeScore*this.getScoreBySafePiece(t);const s=this.getScoreByThreatenedPiece(t);return i+=n.threatenedScore*s,je(n.controlScore<=s,"Control Score should be below "+s+", got "+n.controlScore),je(n.threatenedScore<=16,"Threatened Score should be below 16, got "+n.threatenedScore),je(n.safeScore<=16,"Safe Score should be below 16, got "+n.threatenedScore),new e1(i)}getControlScoreAndPieceScores(e){const t=this.getPiecesMap(e),n=this.getThreatMap(e,t),i=this.filterThreatMap(n,e),s={safeScore:0,threatenedScore:0,controlScore:0};for(const o of k.PLAYERS){const a=new j1;for(const c of t.get(o).get())if(i.get(c).isPresent())s.threatenedScore+=o.getScoreModifier();else{s.safeScore+=o.getScoreModifier();for(const l of Re.ORTHOGONALS){let f=c.getNext(l,1);for(;f.isInRange(this.width,this.width)&&e.getPieceAt(f)===sn.UNOCCUPIED;)a.add(f),f=f.getNext(l,1)}}for(const c of a){const l=this.getControlledPieceValue(c.x,c.y,this.width);s.controlScore+=o.getScoreModifier()*l}}return s}getControlledPieceValue(e,t,n){let i=1;return(0===e||e===n-1)&&(i*=n),(0===t||t===n-1)&&(i*=n),i}getScoreByThreatenedPiece(e){const t=e.board.length,n=t-2;return 4*t*t+4*n*t+n*n}getScoreBySafePiece(e){return 16*this.getScoreByThreatenedPiece(e)+1}}class Sft extends an{constructor(e){super($localize`Pieces > Control`,e,new $ae(e),new b0(e))}}class Pft extends $ae{getBoardValue(e){const t=e.gameState,n=this.getControlScoreAndPieceScores(t),i=t.getPieceAt(this.rules.getKingCoord(t).get()).getOwner(),s=this.getStepForEscape(t)*i.getScoreModifier();if(-1===s)return new e1(i.getOpponent().getPreVictory());const o=this.getScoreByThreatenedPiece(t);return U.assert(n.controlScore<=o,"Control Score should be below "+o+", got "+n.controlScore),U.assert(n.threatenedScore<=16,"Threatened Score should be below 16, got "+n.threatenedScore),U.assert(n.safeScore<=16,"Safe Score should be below 16, got "+n.threatenedScore),new e1(-1*s*(o+1)*17*17+n.safeScore*(o+1)*17+n.threatenedScore*(o+1)+n.controlScore)}getStepForEscape(e){const t=this.rules.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,n,i){const s=this.getNextGen(e,n,i);return 0===s.length?g.empty():s.some(o=>this.rules.isExternalThrone(o))?g.of(t):(t++,i.push(...s),this._getStepForEscape(e,t,s,i))}getNextGen(e,t,n){const i=[];for(const s of t)for(const o of Re.ORTHOGONALS){let a=s.getNext(o,1);for(;a.isInRange(this.width,this.width)&&e.getPieceAt(a)===sn.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(o,1)}return i}}class Tft extends an{constructor(e){super($localize`Escape > Pieces > Control`,e,new Pft(e),new b0(e))}}class IL extends $i{constructor(e,t){super(e),u(this,"generateMove",void 0),u(this,"viewInfo",{pieceClasses:[]}),u(this,"EMPTY",sn.UNOCCUPIED),u(this,"capturedCoords",[]),u(this,"chosen",g.empty()),this.generateMove=t}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(e){var t=this;return M(function*(){t.board=t.getState().getCopiedBoard(),t.capturedCoords=[],t.updateViewInfo()})()}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState(),i=t.getState().getCurrentOpponent();for(const s of Re.ORTHOGONALS){const o=e.getEnd().getNext(s,1);if(o.isInRange(t.rules.config.WIDTH,t.rules.config.WIDTH)){const c=n.getRelativeOwner(i,o)===E1.OPPONENT,f=t.getState().getPieceAt(o)===sn.UNOCCUPIED;c&&f&&t.capturedCoords.push(o)}}})()}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.board.length;t++){const n=[];for(let i=0;i<this.board[0].length;i++){let s=[];s=this.board[t][i].getOwner()===Y.NONE?[""]:this.getPieceClasses(i,t),n.push(s)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);return n.chosen.equalsValue(s)?(n.cancelMoveAttempt(),b.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(s)?n.choosePiece(s):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return M(function*(){const i=n.chosen.get(),s=new C(e,t),o=n.generateMove(i,s);return o.isSuccess()?yield n.chooseMove(o.get()):n.cancelMove(o.getReason())})()}choosePiece(e){var t=this;return M(function*(){return t.board[e.y][e.x]===sn.UNOCCUPIED?t.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):!1===t.pieceBelongToCurrentPlayer(e)?t.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.chosen=g.of(e),t.updateViewInfo(),b.SUCCESS)})()}pieceBelongToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===E1.PLAYER}cancelMoveAttempt(){this.chosen=g.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new C(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new C(e,t))}getPieceClasses(e,t){const n=[],i=new C(e,t),s=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(s)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],i=new C(e,t);if(this.capturedCoords.some(s=>s.equals(i)))n.push("captured-fill");else if(this.node.previousMove.isPresent()){const s=this.node.previousMove.get().getStart(),o=this.node.previousMove.get().getEnd();(i.equals(s)||i.equals(o))&&n.push("moved-fill")}return n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isClickable(i)&&e.push(i)}return e}isClickable(e){return this.isInteractive&&this.pieceBelongToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===sn.INVADERS}isKing(e,t){return this.board[t][e].isKing()}createAIs(){const e=new b0(this.rules);return[new Eft(this.rules),new Mft(this.rules),new Sft(this.rules),new Tft(this.rules),new Xn($localize`MCTS`,e,this.rules)]}}const j=sn.UNOCCUPIED,p1=sn.INVADERS,Fs=sn.DEFENDERS,kd=sn.PLAYER_ONE_KING;class Gae extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Aa.getInitialState()),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Aa.getInitialState(),ms.of(new C(3,1),new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Aa([[j,j,j,p1,j,j,j],[j,j,j,p1,j,j,j],[p1,j,j,Fs,j,j,j],[j,j,Fs,kd,Fs,p1,p1],[j,j,p1,j,j,j,j],[j,j,j,Fs,j,p1,j],[j,j,j,p1,j,j,j]],1),[ms.of(new C(3,5),new C(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Aa([[j,j,j,p1,j,j,j],[j,j,p1,j,j,j,j],[j,j,j,Fs,j,j,j],[p1,Fs,j,j,Fs,p1,p1],[j,Fs,j,j,j,j,j],[j,p1,j,kd,j,p1,j],[j,j,j,p1,j,j,j]],12),[ms.of(new C(2,1),new C(3,1)),ms.of(new C(3,0),new C(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new Aa([[j,j,j,j,j,j,j],[j,j,j,Fs,j,j,j],[j,j,j,p1,j,j,j],[j,p1,j,kd,p1,j,j],[j,j,j,p1,j,j,j],[j,Fs,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[ms.of(new C(1,3),new C(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new Aa([[j,j,p1,j,j,j,j],[j,j,j,p1,j,j,j],[j,j,j,kd,p1,j,j],[j,p1,Fs,j,Fs,j,j],[j,j,j,p1,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j]],72),[ms.of(new C(2,0),new C(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),q.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new Aa([[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,p1,j,p1,j,j,j],[p1,j,j,j,Fs,j,j],[j,j,j,Fs,j,j,j],[j,j,j,j,j,j,j],[j,kd,j,p1,j,j,j]],72),[ms.of(new C(3,6),new C(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function Oft(r,e){1&r&&(A(),F(0,"polygon",8))}function bft(r,e){1&r&&(A(),F(0,"rect",9))}function wft(r,e){if(1&r&&(A(),S(0,"g"),T(1,Oft,1,0,"polygon",6),T(2,bft,1,0,"ng-template",null,7,fn),P()),2&r){const t=ln(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function Nft(r,e){if(1&r&&(A(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Aft(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function Ift(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function kft(r,e){if(1&r&&(A(),T(0,Aft,1,1,"polyline",14),T(1,Ift,4,20,"ng-template",null,15,fn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function xft(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",10),T(2,Nft,6,25,"g",11),T(3,kft,3,2,"ng-template",null,12,fn),P()),2&r){const t=ln(4),n=p().index,i=p().index,s=p();_(1),Ce("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function Lft(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,wft,4,2,"g",5),T(3,xft,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Rft(r,e){if(1&r&&(A(),S(0,"g"),T(1,Lft,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function zft(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Dft=(()=>{var r;class e extends IL{constructor(n){super(n,ms.from),this.rules=bl.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=ms.encoder,this.tutorial=(new Gae).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-brandhub"]],features:[Xe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Rft,2,1,"g",1),T(2,zft,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),di=(()=>{class r extends q1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}static getInitialState(){const t=Rt.create(r.WIDTH,r.HEIGHT,Y.NONE);return new r(t,0)}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();var kL;class Ia extends wr{static of(e){return U.assert(di.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),new Ia(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}u(Ia,"encoder",wr.getEncoder(Ia.of));class ka extends Vs{static of(e,t){return U.assert(di.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),U.assert(di.isOnBoard(t),"SECOND_COORD_IS_OUT_OF_RANGE"),U.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new ka(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),n=e.getFirst(),i=this.getSecond(),s=e.getSecond();return!(!t.equals(n)||!i.equals(s))||!(!t.equals(s)||!i.equals(n))}}u(ka,"encoder",Vs.getEncoder(ka.of)),function(r){r.isFirstMove=function e(n){return n instanceof Ia},r.isDrop=function t(n){return n instanceof ka},r.encoder=we.disjunction([r.isFirstMove,r.isDrop],[Ia.encoder,ka.encoder])}(kL||(kL={}));class hu{constructor(e,t,n){u(this,"isInRange",void 0),u(this,"getOwner",void 0),u(this,"N",void 0),this.isInRange=e,this.getOwner=t,this.N=n}getBoardValue(e){let t=0;for(const n of e.getCoordsAndContents()){const s=n.coord;if(this.getOwner(n.content,e).isPlayer()){const o=this.getSquareScore(e,s);if(e1.VICTORIES.some(a=>a===o))return new e1(o);t+=o}}return new e1(t)}getSquareScore(e,t){const n=e.getPieceAt(t),i=this.getOwner(n,e);je(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const s=new Sn,o=new Sn;for(const c of Me.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(e,t,c,i);s.set(c,l[0]),o.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,s)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let n=0;for(const i of[Me.UP,Me.UP_RIGHT,Me.RIGHT,Me.DOWN_RIGHT]){const s=e.get(i).get(),o=e.get(i.getOpposite()).get();if(this.N<=s+o+1)return Number.MAX_SAFE_INTEGER;const f=t.get(i).get()+t.get(i.getOpposite()).get();this.N<=f+1&&(n+=2+f-this.N)}return n}getNumberOfFreeSpacesAndAllies(e,t,n,i){let s=0,o=0,a=!0,c=new C(t.x+n.x,t.y+n.y),l=1;const f=i.getOpponent();for(;this.isInRange(c)&&l<this.N;){const d=e.getPieceAt(c);if(this.getOwner(d,e)===f)return[s,o];this.getOwner(d,e)===i&&a?o++:a=!1,d!==f&&d!==i&&s++,c=c.getNext(n),l++}return[s,o]}getVictoriousCoord(e){const t=[];for(const n of e.getCoordsAndContents())if(this.getOwner(n.content,e).isPlayer()){const i=n.coord,s=this.getSquareScore(e,i);e1.isVictory(s)&&(s===k.ZERO.getVictoryValue()||s===k.ONE.getVictoryValue())&&t.push(i)}return t}}class $s extends Kn{static get(){return $s.singleton.isAbsent()&&($s.singleton=g.of(new $s)),$s.singleton.get()}static getVictoriousCoords(e){return $s.CONNECT_SIX_HELPER.getVictoriousCoord(e)}constructor(){super(di)}applyLegalMove(e,t,n){return e instanceof ka?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const n=t.getCurrentPlayer(),i=e.getFirst(),s=e.getSecond(),o=t.getCopiedBoard();return o[i.y][i.x]=n,o[s.y][s.x]=n,new di(o,t.turn+1)}applyLegalFirstMove(e,t){const n=t.getCurrentPlayer(),i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=n,new di(i,t.turn+1)}isLegal(e,t){return 0===t.turn?(U.assert(e instanceof Ia,"First move should be instance of ConnectSixFirstMove"),b.SUCCESS):(U.assert(e instanceof ka,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return $s.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):181===t.turn?_e.DRAW:_e.ONGOING}}u($s,"singleton",g.empty()),u($s,"CONNECT_SIX_HELPER",new hu(di.isOnBoard,U.identity,6));const L=Y.NONE,hi=Y.ZERO,V2=Y.ONE;class Wae extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,di.getInitialState()),q.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,di.getInitialState(),Ia.of(new C(9,9)),$localize`Congratulations!`),q.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new di([[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,V2,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,hi,L,V2,hi,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,hi,hi,L,L,V2,L,L,L,L,L,L],[L,L,L,L,L,L,L,V2,hi,hi,hi,hi,V2,L,L,L,L,L,L],[L,L,L,L,L,L,V2,hi,hi,hi,hi,V2,L,L,L,L,L,L,L],[L,L,L,L,L,L,V2,L,V2,hi,V2,V2,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,hi,V2,hi,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,V2,L,V2,L,hi,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,V2,V2,L,V2,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,V2,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,hi,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L],[L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L,L]],20),ka.of(new C(4,11),new C(5,10)),$localize`Congratulations!`)])}}let xL=(()=>{var r;class e extends $i{constructor(...n){super(...n),u(this,"hoshis",[])}createHoshis(){const n=this.board.length,i=Math.floor(n/2),s=n<12?2:3,o=n-(s+1);18<n&&this.hoshis.push(new C(s,i),new C(i,s),new C(i,o),new C(o,i)),this.hoshis.push(new C(i,i),new C(s,s),new C(s,o),new C(o,s),new C(o,o))}isHoshi(n,i){return this.hoshis.some(s=>s.x===n&&s.y===i)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",We({type:r,selectors:[["ng-component"]],features:[Xe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();class qae extends Wn{getListMoves(e){return 0===e.gameState.turn?this.getFirstMove():this.getListDrops(e)}getFirstMove(){const t=di.HEIGHT,n=Math.floor(di.WIDTH/2),i=Math.floor(t/2);return[Ia.of(new C(n,i))]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),n=[];for(const i of t){const s=e.gameState.getCopiedBoard();s[i.y][i.x]=e.gameState.getCurrentPlayer();const o=new di(s,e.gameState.turn),a=this.getAvailableCoords(o);for(const c of a){const l=ka.of(i,c);n.push(l)}}return new ft(n).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),n=[];for(const i of e.getCoordsAndContents()){const s=i.coord;!0===t[s.y][s.x]&&!1===i.content.isPlayer()&&n.push(s)}return n}getUsefulCoordsMap(e){const t=Rt.create(di.WIDTH,di.HEIGHT,!1);for(const n of e.getCoordsAndContents())n.content.isPlayer()&&this.addNeighboringCoord(t,n.coord);return t}addNeighboringCoord(e,t){const i=Math.max(0,t.x-1),s=Math.max(0,t.y-1),o=Math.min(di.WIDTH-1,t.x+1),a=Math.min(di.HEIGHT-1,t.y+1);for(let c=s;c<=a;c++)for(let l=i;l<=o;l++)e[c][l]=!0}}class Hft extends Na{getBoardValue(e){const t=e.gameState;let n=0;for(const i of t.getCoordsAndContents())i.content.isPlayer()&&(n+=$s.CONNECT_SIX_HELPER.getSquareScore(t,i.coord));return new e1(n)}}class Vft extends an{constructor(){super($localize`Alignment`,$s.get(),new Hft,new qae)}}function Fft(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function $ft(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();Ce("id","hoshi_",t,"_",n,""),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function Gft(r,e){if(1&r&&(A(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,$ft,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function Bft(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,Fft,1,6,"circle",6),T(2,Gft,4,13,"ng-template",null,7,fn),P()}if(2&r){const t=e.$implicit,n=e.index,i=ln(3);Ce("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function Uft(r,e){if(1&r&&(A(),S(0,"g"),T(1,Bft,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Wft(r,e){if(1&r){const t=pe();A(),S(0,"circle",13),W("click",function(){te(t);const i=p();return ne(i.onClick(i.droppedCoord.get().x,i.droppedCoord.get().y))}),P()}if(2&r){const t=p();y("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),I("cx",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().y)("r",.22*t.SPACE_SIZE)}}let qft=(()=>{var r;class e extends xL{constructor(n){super(n),u(this,"droppedCoord",g.empty()),u(this,"lastMoved",[]),u(this,"victoryCoords",[]),this.rules=$s.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Vft,new Xn($localize`MCTS`,new qae,this.rules)],this.encoder=kL.encoder,this.tutorial=(new Wae).tutorial}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.victoryCoords=$s.getVictoriousCoords(s),i.createHoshis()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=n instanceof Ia?[n.coord]:[n.getFirst(),n.getSecond()]})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(0===s.getState().turn){const c=Ia.of(a);return s.chooseMove(c)}if(s.getState().getPieceAt(a).isPlayer())return s.cancelMove(Le.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(a))return s.droppedCoord=g.empty(),b.SUCCESS;{const c=ka.of(s.droppedCoord.get(),a);return s.chooseMove(c)}}return s.droppedCoord=g.of(a),b.SUCCESS})()}getSpaceClass(n,i){const s=new C(n,i),o=this.getState().getPieceAt(s),a=[];return this.droppedCoord.equalsValue(s)?(a.push(this.getPlayerClass(this.getState().getCurrentPlayer())),a.push("highlighted-stroke")):(a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&a.push("last-move-stroke")),a}cancelMoveAttempt(){this.droppedCoord=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-connect-six"]],features:[Xe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,Uft,2,1,"g",2),T(3,Wft,1,4,"circle",3),P()),2&n&&(I("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),I("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.droppedCoord.isPresent()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),a4=(()=>{class r{}return u(r,"SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP",()=>$localize`Your piece should land on a neighboring square.`),u(r,"CANNOT_DROP_AFTER_TURN_40",()=>$localize`You cannot drop a piece during the moving phase.`),u(r,"CANNOT_MOVE_BEFORE_TURN_40",()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`),u(r,"MUST_JUMP_OVER_PIECES",()=>$localize`A jump must be made over a piece, not over an empty square.`),u(r,"MUST_DROP_IN_CENTRAL_ZONE",()=>$localize`A drop must occur in the central zone of the board.`),u(r,"INVALID_JUMP",()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`),u(r,"SAME_LOCATION_VISITED_IN_JUMP",()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`),r})();var aC,Yae,m2;class xt extends q1{static isOnBoard(e){return e.isInRange(xt.WIDTH,xt.HEIGHT)}static getInitialState(){const e=Rt.create(xt.WIDTH,xt.HEIGHT,Y.NONE);return new xt(e,0)}isShelter(e){return 0===e.x||e.x===xt.WIDTH-1?xt.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===xt.HEIGHT-1)&&xt.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=xt.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=xt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=xt.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=xt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}aC=xt,u(xt,"WIDTH",17),u(xt,"HEIGHT",17),u(xt,"CENTRAL_ZONE_TOP_LEFT",new C(4,6)),u(xt,"CENTRAL_ZONE_BOTTOM_RIGHT",new C(12,10)),u(xt,"SHELTERS_INDICES",[0,1,3,5,7,8,9,11,13,15,16]),u(xt,"ALL_SHELTERS",new ft(aC.SHELTERS_INDICES.flatMap(r=>[new C(r,0),new C(r,aC.HEIGHT-1),new C(0,r),new C(aC.WIDTH-1,r)])).toList());class c4 extends wr{static of(e){return U.assert(xt.isOnBoard(e),"Move out of board"),new c4(e)}constructor(e){super(e.x,e.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!m2.isDrop(e)&&this.coord.equals(e.coord)}}u(c4,"encoder",wr.getEncoder(c4.of));class l4 extends Go{static from(e,t){const n=xt.isOnBoard(e),i=xt.isOnBoard(t);return U.assert(n&&i,"Move out of board"),e.isAlignedWith(t)&&1===e.getDistance(t)?re.success(new l4(e,t)):re.failure(a4.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(e,t){super(e,t)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!m2.isSimple(e)&&super.equals(e)}}u(l4,"encoder",Vs.getFallibleEncoder(l4.from));class Bo extends Hi{static from(e){if(e.length<2)return re.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const n of e)if(!1===xt.isOnBoard(n))return re.failure("Move out of board");for(let n=1;n<e.length;n++)if(e[n-1].getDirectionToward(e[n]).isFailure()||2!==e[n-1].getDistance(e[n]))return re.failure(a4.INVALID_JUMP());return new j1(e).size()===e.length?re.success(new Bo(e)):re.failure(a4.SAME_LOCATION_VISITED_IN_JUMP())}constructor(e){super(),u(this,"coords",void 0),this.coords=e}addJump(e){const t=en.copy(this.coords);return t.push(e),Bo.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,n)=>t+" -> "+n)})`}equals(e){return!(m2.isSimple(e)||m2.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}Yae=Bo,u(Bo,"encoder",we.tuple([we.list(C.encoder)],r=>[en.copy(r.coords)],r=>Yae.from(r[0]).get())),function(r){r.isDrop=function e(i){return i instanceof c4},r.isSimple=function t(i){return i instanceof l4},r.isJump=function n(i){return i instanceof Bo},r.encoder=we.disjunction([r.isDrop,r.isSimple,r.isJump],[c4.encoder,l4.encoder,Bo.encoder])}(m2||(m2={}));const v=Y.NONE,_t=Y.ZERO,ht=Y.ONE;class Kae extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,xt.getInitialState()),q.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,xt.getInitialState(),c4.of(new C(7,7)),$localize`Congratulations!`),q.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new xt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,_t,_t,ht,ht,_t,_t,ht,_t,ht,v,v,v,v],[v,v,v,v,_t,ht,_t,ht,_t,_t,_t,_t,ht,v,v,v,v],[v,v,v,v,_t,ht,v,v,v,v,v,ht,_t,v,v,v,v],[v,v,v,v,ht,_t,_t,ht,ht,ht,_t,_t,_t,v,v,v,v],[v,v,v,v,ht,_t,ht,ht,ht,ht,ht,ht,_t,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),l4.from(new C(4,6),new C(3,5)).get(),(t,n,i)=>m2.isSimple(t)?b.SUCCESS:b.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),q.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new xt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,_t,_t,ht,ht,_t,_t,ht,_t,ht,v,v,v,v],[v,v,v,v,_t,ht,_t,ht,_t,_t,_t,_t,ht,v,v,v,v],[v,v,v,v,_t,ht,v,v,v,v,v,ht,_t,v,v,v,v],[v,v,v,v,ht,_t,_t,ht,ht,ht,_t,_t,_t,v,v,v,v],[v,v,v,v,ht,_t,ht,ht,ht,ht,ht,ht,_t,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),Bo.from([new C(6,7),new C(6,5)]).get(),(t,n,i)=>m2.isJump(t)?b.SUCCESS:b.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),q.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new xt([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,ht,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,ht,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,ht,v,v,v,v,v,v,v,v,v],[v,v,v,v,_t,_t,v,ht,_t,_t,ht,_t,ht,v,v,v,v],[v,v,v,v,_t,v,_t,ht,_t,_t,_t,_t,ht,v,v,v,v],[v,v,v,v,_t,ht,v,v,v,v,v,ht,_t,v,v,v,v],[v,v,v,v,ht,_t,_t,ht,ht,ht,_t,_t,_t,v,v,v,v],[v,v,v,v,ht,_t,ht,ht,ht,ht,ht,ht,_t,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],40),[Bo.from([new C(8,6),new C(6,4),new C(6,2),new C(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)])}}class Gs extends Kn{static get(){return Gs.singleton.isAbsent()&&(Gs.singleton=g.of(new Gs)),Gs.singleton.get()}constructor(){super(xt)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();if(m2.isDrop(e))i[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(m2.isSimple(e))i[e.getStart().y][e.getStart().x]=Y.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const s=e.getStartingCoord(),o=e.getEndingCoord();i[s.y][s.x]=Y.NONE,i[o.y][o.x]=t.getCurrentPlayer()}return new xt(i,t.turn+1)}isLegal(e,t){return m2.isDrop(e)?this.dropLegality(e,t):m2.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?b.failure(a4.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?b.failure(a4.MUST_DROP_IN_CENTRAL_ZONE()):b.SUCCESS}simpleMoveLegality(e,t){return t.turn<40?b.failure(a4.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.getEnd()).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}jumpLegality(e,t){if(t.turn<40)return b.failure(a4.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());for(const n of e.getJumpedOverCoords())if(t.getPieceAt(n)===Y.NONE)return b.failure(a4.MUST_JUMP_OVER_PIECES());for(const n of e.getLandingCoords())if(t.getPieceAt(n).isPlayer())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());return b.SUCCESS}jumpTargetsFrom(e){const t=[new C(e.x+2,e.y),new C(e.x-2,e.y),new C(e.x,e.y+2),new C(e.x,e.y-2),new C(e.x+2,e.y+2),new C(e.x+2,e.y-2),new C(e.x-2,e.y+2),new C(e.x-2,e.y-2)],n=[];for(const i of t)Bo.from([e,i]).isSuccess()&&n.push(i);return n}nextJumps(e,t){const n=e.getEndingCoord(),i=[];for(const s of this.jumpTargetsFrom(n)){const o=e.addJump(s);o.isSuccess()&&this.jumpLegality(o.get(),t).isSuccess()&&i.push(o.get())}return i}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of xt.ALL_SHELTERS){const s=t.getPieceAt(i);if(s.isPlayer()&&(n[s.value]+=1,20===n[s.value]))return _e.getVictory(s)}return _e.ONGOING}}u(Gs,"singleton",g.empty());let xd=(()=>{class r{}return u(r,"NO_MORE_PIECES_OF_THIS_TYPE",()=>$localize`You do not have any pieces of this type anymore.`),u(r,"SPACE_IS_FULL",()=>$localize`You cannot play here: this space is already full.`),u(r,"TARGET_STACK_TOO_HIGH",()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`),u(r,"MUST_SHIFT_TO_NEIGHBOR",()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`),u(r,"MUST_SELECT_PIECE_FIRST",()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`),r})();var xa,Xae,Qae;class Tn{static of(e,t){return e===k.ZERO?t?Tn.ZERO_SECOND:Tn.ZERO_FIRST:e===k.ONE?t?Tn.ONE_SECOND:Tn.ONE_FIRST:Tn.EMPTY}constructor(e,t){u(this,"owner",void 0),u(this,"otherPieceType",void 0),this.owner=e,this.otherPieceType=t}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}xa=Tn,u(Tn,"encoder",we.tuple([Y.encoder,we.identity()],r=>[r.owner,r.otherPieceType],r=>xa.of(r[0],r[1]))),u(Tn,"EMPTY",new xa(Y.NONE,!1)),u(Tn,"ZERO_FIRST",new xa(k.ZERO,!1)),u(Tn,"ZERO_SECOND",new xa(k.ZERO,!0)),u(Tn,"ONE_FIRST",new xa(k.ONE,!1)),u(Tn,"ONE_SECOND",new xa(k.ONE,!0)),u(Tn,"PLAYER_PIECES",[xa.ZERO_FIRST,xa.ZERO_SECOND,xa.ONE_FIRST,xa.ONE_SECOND]);class Jae extends Hi{isDrop(){return this instanceof u4}isShift(){return this instanceof F2}}class u4 extends Jae{constructor(e,t){if(super(),u(this,"target",void 0),u(this,"piece",void 0),this.target=e,this.piece=t,t===Tn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof u4&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}Xae=u4,u(u4,"encoder",we.tuple([we.identity(),Tn.encoder],r=>[r.target,r.piece],r=>new Xae(r[0],r[1])));class F2 extends Jae{static ofRepresentation(e,t){return new F2(new C(e.x,3-e.y),t)}constructor(e,t){super(),u(this,"start",void 0),u(this,"moveDirection",void 0),this.start=e,this.moveDirection=t}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof F2&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}Qae=F2,u(F2,"encoder",we.tuple([C.encoder,we.identity()],r=>[r.start,"clockwise"===r.moveDirection],r=>new Qae(r[0],r[1]?"clockwise":"counterclockwise")));const jft=we.disjunction([r=>r.isDrop(),r=>r.isShift()],[u4.encoder,F2.encoder]);let tr=(()=>{class r extends q1{static getInitialState(){const t=Tn.EMPTY;return new r([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static ofRepresentation(t,n){const i=t.reverse(),s=[4,4,4,4];for(let o=0;o<r.HEIGHT;o++)for(let a=0;a<r.WIDTH;a++)i[o][a]!==Tn.EMPTY&&s[r.pieceIndex(i[o][a])]--;return je(s.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new r(i,s,n)}static pieceIndex(t){switch(t){case Tn.ZERO_FIRST:return 0;case Tn.ZERO_SECOND:return 1;case Tn.ONE_FIRST:return 2;default:return U.expectToBe(t,Tn.ONE_SECOND),3}}constructor(t,n,i){super(t,i),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPiecesOf(t){return this.remainingPieces[r.pieceIndex(t)]}getStackHeight(t){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(t,i)!==Tn.EMPTY;i++)n++;return n}}return u(r,"WIDTH",8),u(r,"HEIGHT",4),r})();class Vc extends Kn{static get(){return Vc.singleton.isAbsent()&&(Vc.singleton=g.of(new Vc)),Vc.singleton.get()}constructor(){super(tr)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=Rt.copy(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const i=en.copy(t.remainingPieces);return i[tr.pieceIndex(e.piece)]-=1,new tr(n,i,t.turn+1)}applyLegalShift(e,t){const n=Rt.copy(t.board),i=e.getTarget();let s=t.getStackHeight(i),o=e.start.y;for(;o<tr.HEIGHT&&t.getPieceAtXY(e.start.x,o)!==Tn.EMPTY;)n[s][i]=t.getPieceAtXY(e.start.x,o),n[o][e.start.x]=Tn.EMPTY,s++,o++;return new tr(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?b.failure(xd.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===tr.HEIGHT?b.failure(xd.SPACE_IS_FULL()):b.SUCCESS}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>tr.HEIGHT?b.failure(xd.TARGET_STACK_TOO_HIGH()):b.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return je(n.owner.isPlayer(),"highest alignment is owned by a player"),_e.getVictory(n.owner)}return _e.ONGOING}findHighestAlignment(e){for(let t=0;t<tr.WIDTH/2;t++)for(let n=tr.HEIGHT-1;n>0;n--){const i=e.getPieceAtXY(t,n),s=e.getPieceAtXY(t+tr.WIDTH/2,n);if(i!==Tn.EMPTY&&i===s)return g.of(new C(t,n))}return g.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new F2(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new F2(t,"counterclockwise"),e).isSuccess()}}u(Vc,"singleton",g.empty());const Fe=Tn.EMPTY,pu=Tn.ZERO_FIRST,ece=Tn.ZERO_SECOND,cC=Tn.ONE_FIRST,LL=Tn.ONE_SECOND;class tce{constructor(){u(this,"tutorial",[q.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,tr.getInitialState()),q.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,tr.ofRepresentation([[Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,cC,Fe,Fe,Fe],[pu,Fe,Fe,Fe,pu,Fe,Fe,Fe]],3),[new u4(0,Tn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),q.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,tr.ofRepresentation([[Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,LL,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,pu,Fe,Fe,Fe],[cC,Fe,Fe,Fe,ece,Fe,Fe,Fe]],4),[F2.ofRepresentation(new C(4,3),"counterclockwise"),F2.ofRepresentation(new C(4,3),"clockwise"),F2.ofRepresentation(new C(4,2),"counterclockwise"),F2.ofRepresentation(new C(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),q.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,tr.ofRepresentation([[Fe,Fe,Fe,Fe,pu,Fe,Fe,Fe],[Fe,Fe,Fe,Fe,LL,Fe,Fe,pu],[Fe,Fe,Fe,Fe,pu,Fe,Fe,LL],[Fe,cC,Fe,Fe,ece,Fe,Fe,cC]],8),[F2.ofRepresentation(new C(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)])}}let nce=(()=>{var r;class e extends Hc{constructor(...n){super(...n),u(this,"SPACE_SIZE",100),u(this,"board",void 0)}getTriangleCornerCoords(n,i){return(n+i)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(n,i){return this.getTriangleCornerCoords(n,i).map(a=>a.x+","+a.y).reduce((a,c)=>a+","+c)}getTriangleTranslateCoord(n,i){return new C(.5*n*this.SPACE_SIZE,i*this.SPACE_SIZE)}getTriangleTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i);return"translate("+s.x+", "+s.y+")"}getDownwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,o);return[c,new C(0,a),new C(s,o),c]}getUpwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,a);return[c,new C(0,o),new C(s,a),c]}getPyramidPoints(n,i){return(n+i)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+-n,s=n+", "+-n,o="0, "+n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}getUpwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+n,s=n+", "+n,o="0, "+-n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",We({type:r,selectors:[["ng-component"]],features:[Xe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),Ld=(()=>{class r{}return u(r,"INVALID_DISTANCE",()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`),u(r,"NOT_ENOUGH_TILES_TO_EXCHANGE",()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`),u(r,"FIRST_CLICK_SHOULD_NOT_BE_NULL",()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`),u(r,"CANNOT_CAPTURE_FROM_EMPTY",()=>$localize`You cannot capture from an empty space.`),r})();class Uo{static getNeighbors(e){let t;const n=new C(e.x-1,e.y),i=new C(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,i,new C(e.x,e.y-1)]:[n,i,new C(e.x,e.y+1)],t}static getFakeNeighbors(e){return new C(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=Uo.getNeighbors(e),i=Uo.getNeighbors(t);let s=0;for(;s<n.length;){const o=n[s];let a=0;for(;a<i.length;){if(o.equals(i[a]))return g.of(o);a++}s++}return g.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class w0 extends q1{static getEmptyNeighbors(e,t,n){const i=[];for(const s of Uo.getNeighbors(t))s.isInRange(e[0].length,e.length)&&e[s.y][s.x]===n&&i.push(s);return i}getEmptyNeighbors(e,t){return w0.getEmptyNeighbors(this.board,e,t)}}var lC,La;let Wr=(lC=class extends w0{static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new C(t,n)}static isOnBoard(e){return e.isInRange(15,10)}static getPresentNeighborEntrances(e){return[new C(e.x+1,e.y-1),new C(e.x+3,e.y+0),new C(e.x+3,e.y+1),new C(e.x+1,e.y+2),new C(e.x-1,e.y+1),new C(e.x-1,e.y+0)].filter(La.isOnBoard)}static getInitialState(){const e=ye.EMPTY,t=ye.UNREACHABLE,n=ye.ZERO,i=ye.ONE;return new La([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,i,e,i,e,e,n,e,n,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,i,e,i,e,e,n,e,n,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}constructor(e,t,n,i){super(e,t),u(this,"tiles",void 0),u(this,"captures",void 0),this.tiles=n,this.captures=i}applyLegalMovement(e){const t=e.getStart(),n=e.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=ye.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=ye.EMPTY,new La(i,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let n=this;for(const i of t)n=n.capture(i);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return Uo.getNeighbors(e).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(t)&&this.isSurrounded(i))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,ye.EMPTY).length}capture(e){const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return t[e.y][e.x]=ye.EMPTY,n[this.getCurrentPlayer().value]+=1,new La(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){let n=this;const i=La.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,t);const s=La.getPresentNeighborEntrances(i);for(const o of s){const a=n.getPieceAt(o);a===ye.EMPTY?n=n.removeTilesIfNeeded(o,t):a.is(this.getCurrentOpponent())&&n.isSurrounded(o)&&(n=n.capture(o))}}return n}isTileEmpty(e){U.assert(this.getPieceAt(e)!==ye.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const i=e.getNext(new Et(n,t),1);if(this.getPieceAt(i)!==ye.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let i=1;i<t.length;i++)!1===this.areNeighbor(t[i-1],t[i])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let n=g.empty();for(let i=0;i<6;i++){const o=e.getNext(La.NEIGHBORS_TILES_DIRECTIONS[i],1);La.isOnBoard(o)&&this.getPieceAt(o)!==ye.UNREACHABLE&&(n.isAbsent()&&(n=g.of(i)),t.push(i-n.get()))}return t}deconnectTile(e,t){const n=this.getCopiedBoard(),i=e.x,s=e.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[s+a][i+c]=ye.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return t&&(o[this.getCurrentPlayer().value]+=1),new La(n,this.turn,o,this.captures)}getLegalLandings(e){const t=[];for(const n of _s.STEPS){const i=e.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===ye.EMPTY&&t.push(i)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const i=this.board[t][n];if(i.isPlayer()){const s=this.getEmptyNeighbors(new C(n,t),ye.EMPTY).length;e[i.value][s]=e[i.value][s]+1}}return e}},La=lC,u(lC,"NEIGHBORS_TILES_DIRECTIONS",[new Et(0,-2),new Et(3,-1),new Et(3,1),new Et(0,2),new Et(-3,1),new Et(-3,-1)]),lC);var mo,wl,uC,N0;Wr=La=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Wr);class _s{static ofCoords(e,t){const n=e.getVectorToward(t),i=_s.STEPS.findIndex(s=>s.direction.equals(n));return U.assert(-1!==i,Ld.INVALID_DISTANCE()),_s.STEPS[i]}constructor(e,t){u(this,"direction",void 0),u(this,"str",void 0),this.direction=e,this.str=t}}u(_s,"LEFT",new(mo=_s)(new Et(-2,0),"LEFT")),u(_s,"UP_LEFT",new mo(Me.UP_LEFT,"UP_LEFT")),u(_s,"UP_RIGHT",new mo(Me.UP_RIGHT,"UP_RIGHT")),u(_s,"RIGHT",new mo(new Et(2,0),"RIGHT")),u(_s,"DOWN_LEFT",new mo(Me.DOWN_LEFT,"DOWN_LEFT")),u(_s,"DOWN_RIGHT",new mo(Me.DOWN_RIGHT,"DOWN_RIGHT")),u(_s,"STEPS",[mo.LEFT,mo.UP_LEFT,mo.UP_RIGHT,mo.RIGHT,mo.DOWN_LEFT,mo.DOWN_RIGHT]);class $2 extends Go{static of(e,t){const n=_s.ofCoords(e,t);return $2.ofMovement(e,n)}static ofMovement(e,t){U.assert(Wr.isOnBoard(e),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new C(e.x+t.direction.x,e.y+t.direction.y);return U.assert(Wr.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new $2(e,n)}constructor(e,t){super(e,t)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!wl.isTileExchange(e)&&super.equals(e)}}u($2,"encoder",Go.getEncoder($2.of));class f4 extends wr{static of(e){return U.assert(Wr.isOnBoard(e),"Captured coord cannot be out of range (width: 15, height: 10)."),new f4(e)}constructor(e){super(e.x,e.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!wl.isTileExchange(e)&&e.coord.equals(this.coord)}}u(f4,"encoder",wr.getEncoder(f4.of)),function(r){r.isNormalMove=function e(n){return n instanceof $2},r.isTileExchange=function t(n){return n instanceof f4},r.encoder=we.disjunction([r.isNormalMove,r.isTileExchange],[$2.encoder,f4.encoder])}(wl||(wl={}));let fC=(uC=class extends Kn{static get(){return N0.singleton.isAbsent()&&(N0.singleton=g.of(new N0)),N0.singleton.get()}constructor(){super(Wr)}applyLegalMove(e,t,n){return wl.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const n=t.getCopiedBoard(),i=e.coord;n[i.y][i.x]=ye.EMPTY;const s=[t.captures[0],t.captures[1]];s[t.getCurrentPlayer().value]+=1;const o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;const c=new Wr(n,t.turn,o,s).removeTilesIfNeeded(i,!1);return new Wr(c.getCopiedBoard(),c.turn+1,c.tiles,c.captures)}applyLegalMovement(e,t){const s=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new Wr(s.board,t.turn+1,s.tiles,s.captures)}isLegal(e,t){return wl.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return b.failure(Ld.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.coord);return n===ye.UNREACHABLE||n===ye.EMPTY?b.failure(Ld.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?b.failure(Le.CANNOT_SELF_CAPTURE()):b.SUCCESS}isLegalMovement(e,t){U.assert(t.getPieceAt(e.getStart())!==ye.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),U.assert(t.getPieceAt(e.getEnd())!==ye.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const n=t.getPieceAt(e.getStart());return n===ye.EMPTY?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?_e.ZERO_WON:t.captures[1]>=18?_e.ONE_WON:_e.ONGOING}getGameStatus(e){return N0.getGameStatus(e)}},N0=uC,u(uC,"singleton",g.empty()),uC);fC=N0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],fC);const ee=ye.EMPTY,x=ye.UNREACHABLE,s1=ye.ZERO,mn=ye.ONE;class sce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,Wr.getInitialState()),q.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,Wr.getInitialState(),$2.of(new C(3,5),new C(5,5)),$localize`Congratulations! Let's see captures now.`),q.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new Wr([[x,x,x,x,x,x,s1,ee,s1,x,x,x,x,x,x],[x,x,x,s1,ee,ee,ee,ee,ee,s1,ee,ee,x,x,x],[ee,mn,ee,mn,s1,mn,ee,ee,s1,ee,ee,mn,ee,mn,ee],[mn,ee,ee,ee,ee,ee,ee,ee,ee,ee,mn,ee,ee,ee,mn],[ee,mn,ee,mn,ee,ee,ee,ee,ee,ee,ee,mn,ee,mn,ee],[ee,s1,ee,s1,ee,ee,ee,ee,ee,ee,ee,s1,ee,s1,ee],[s1,ee,ee,ee,s1,ee,ee,ee,ee,ee,s1,ee,ee,ee,s1],[ee,s1,ee,s1,ee,ee,mn,ee,mn,ee,ee,s1,ee,s1,ee],[x,x,x,ee,ee,mn,ee,ee,ee,mn,ee,ee,x,x,x],[x,x,x,x,x,x,mn,ee,mn,x,x,x,x,x,x]],3,[0,0],[0,0]),[$2.of(new C(5,2),new C(4,1)),$2.of(new C(3,4),new C(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),q.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new Wr([[x,x,x,x,x,x,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,mn,ee,ee,x,x,x,x,x,x],[ee,ee,ee,x,x,x,ee,ee,ee,x,x,x,x,x,x],[ee,ee,mn,ee,ee,ee,ee,s1,ee,x,x,x,x,x,x],[ee,ee,ee,mn,ee,ee,ee,ee,ee,x,x,x,x,x,x],[ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,s1,x,x,x],[ee,ee,s1,ee,ee,mn,ee,ee,ee,ee,s1,ee,ee,ee,s1],[ee,ee,ee,ee,ee,ee,mn,ee,mn,ee,ee,s1,ee,s1,ee],[x,x,x,ee,ee,mn,ee,ee,ee,mn,ee,ee,x,x,x],[x,x,x,x,x,x,mn,ee,mn,x,x,x,x,x,x]],2,[0,0],[0,0]),[$2.of(new C(2,6),new C(4,6)),$2.of(new C(2,6),new C(3,5)),$2.of(new C(2,6),new C(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),q.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new Wr([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,s1,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,ee,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,ee,mn,ee,mn,x,x,x,x,x,x],[x,x,x,ee,ee,mn,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,mn,ee,mn,x,x,x,x,x,x]],1,[0,2],[0,0]),[f4.of(new C(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),q.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new Wr([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,ee,ee,s1,x,x,x,x,x,x],[x,x,x,ee,ee,s1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,s1,mn,ee,mn,ee,x,x,x,x,x,x],[x,x,x,ee,mn,s1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,mn,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],1,[0,0],[0,0]),[$2.of(new C(7,6),new C(6,5)),$2.of(new C(7,6),new C(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)])}}class Kft extends dr{getMetrics(e){const t=e.gameState,n=t.getPiecesByFreedom(),i=this.getPiecesScore(n);return[2*t.captures[0]+i[0],2*t.captures[1]+i[1]]}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}}class RL extends Wn{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),t}getListExchanges(e){const t=[],n=e.gameState,i=n.getCurrentPlayer().value,s=ye.ofPlayer(n.getCurrentOpponent());if(n.tiles[i]<2)return t;for(const o of n.getCoordsAndContents())if(o.content===s){const a=f4.of(o.coord);t.push(a)}return t}getListMovement(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(const s of n.getCoordsAndContents()){const o=s.coord;if(s.content.is(i)){const a=n.getLegalLandings(o);for(const c of a){const l=$2.of(o,c);t.push(l)}}}return t}}let Xft=(()=>{class r extends dr{getMetrics(t){const n=t.gameState,i=this.getPiecesMap(n),s=this.getThreatMap(n,i),o=this.filterThreatMap(s,n),a=[0,0];for(const c of k.PLAYERS){for(const l of i.get(c).get())o.get(l).isPresent()?a[c.value]+=r.SCORE_BY_THREATENED_PIECE:a[c.value]+=r.SCORE_BY_SAFE_PIECE;a[c.value]+=n.tiles[c.value]}return a}getPiecesMap(t){const n=new Sn,i=[],s=[];for(const o of t.getCoordsAndContents()){const a=o.coord,c=t.getPieceAt(a);c===ye.ZERO?i.push(a):c===ye.ONE&&s.push(a)}return n.set(k.ZERO,new j1(i)),n.set(k.ONE,new j1(s)),n}getThreatMap(t,n){const i=new Sn;for(const s of k.PLAYERS)for(const o of n.get(s).get()){const a=this.getThreat(o,t);a.isPresent()&&i.set(o,a.get())}return i}getThreat(t,n){const s=k.of(n.getPieceAt(t).value).getOpponent();let o=g.empty(),a=g.empty(),c=[];const l=Uo.getNeighbors(t).filter(Wr.isOnBoard);for(const f of l){const d=n.getPieceAt(f);if(d.is(s))c.push(f),this.tileCouldBeRemovedThisTurn(f,n,s)&&(a=g.of(f));else if(d===ye.EMPTY){if(o.isPresent())return g.empty();o=g.of(f)}}if(o.isPresent()){const f=[];for(const d of _s.STEPS){const m=o.get().getNext(d.direction,1);Wr.isOnBoard(m)&&n.getPieceAt(m).is(s)&&!1===c.some(E=>E.equals(m))&&f.push(m)}if(f.length>0)return g.of(new oC(new j1(c),new j1(f)))}if(a.isPresent()){c=c.filter(d=>d.equals(a.get()));const f=new j1(c);return g.of(new oC(f,new j1([a.get()])))}return g.empty()}tileCouldBeRemovedThisTurn(t,n,i){const s=i.getOpponent();if(!1===n.isDeconnectable(t))return!1;let a=g.empty();const c=Wr.getTilesUpperLeftCoord(t);for(let l=0;l<2;l++)for(let f=0;f<3;f++){const d=c.getNext(new Et(f,l),1);if(n.getPieceAt(d).is(i)){if(!this.pieceCouldLeaveTheTile(d,n))return!1;a=g.of(d)}else if(n.getPieceAt(d).is(s))return!1}return a.isPresent()}pieceCouldLeaveTheTile(t,n){const i=Wr.getTilesUpperLeftCoord(t);for(const s of _s.STEPS){const o=t.getNext(s.direction,1),a=Wr.getTilesUpperLeftCoord(o);if(!1===i.equals(a)&&Wr.isOnBoard(o)&&n.getPieceAt(o)===ye.EMPTY)return!0}return!1}filterThreatMap(t,n){const i=new Sn,s=t.listKeys(),o=s.filter(c=>n.getPieceAt(c).is(n.getCurrentPlayer())),a=new j1(s.filter(c=>n.getPieceAt(c).is(n.getCurrentOpponent())));for(const c of o){const l=t.get(c).get();let f=g.empty();for(const d of l.directThreats)if(!1===a.contains(d)){const m=[];for(const E of l.mover)!1===a.contains(E)&&m.push(E);m.length>0&&(f=g.of(new oC(l.directThreats,new j1(m))))}f.isPresent()&&i.set(c,f.get())}for(const c of a){const l=t.get(c).get();i.set(c,l)}return i}}return u(r,"SCORE_BY_THREATENED_PIECE",1e3),u(r,"SCORE_BY_SAFE_PIECE",1e6),r})();class Qft extends RL{getListMoves(e){const t=super.getListMoves(e);return this.putCaptureFirst(e,t)}putCaptureFirst(e,t){return en.sortByDescending(t,n=>this.moveCapturesList(e,n).length),t}moveCapturesList(e,t){return wl.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}function Jft(r,e){if(1&r&&(A(),F(0,"polygon",7)),2&r){const t=p().index,n=p().index,i=p();Ce("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function e9t(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,Jft,1,5,"polygon",6),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),_(1),y("ngIf",i.mustDraw(t,n))}}function t9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,e9t,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function n9t(r,e){if(1&r&&(A(),F(0,"polygon",9)),2&r){const t=p().index,n=p().index,i=p();Ce("id","pyramid_",t,"_",n,""),y("ngClass",i.getPyramidClass(t,n)),I("points",i.getPyramidPoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function r9t(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,n9t,1,5,"polygon",8),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),_(1),y("ngIf",i.isPyramid(t,n))}}function i9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,r9t,2,3,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function s9t(r,e){if(1&r){const t=pe();A(),S(0,"rect",12),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p(2);I("x",-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(t))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslate(t.x,t.y))}}function o9t(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polygon",10),T(2,s9t,1,5,"rect",11),P()),2&r){const t=p();_(1),Ce("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleInHexTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y)),_(1),y("ngForOf",t.possibleLandings)}}function a9t(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);Ce("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),I("points",t.getTrianglePoints(t.lastStart.get().x,t.lastStart.get().y))("transform",t.getTriangleInHexTranslate(t.lastStart.get().x,t.lastStart.get().y))}}function c9t(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);Ce("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),I("points",t.getTrianglePoints(t.lastEnd.get().x,t.lastEnd.get().y))("transform",t.getTriangleInHexTranslate(t.lastEnd.get().x,t.lastEnd.get().y))}}function l9t(r,e){if(1&r&&(A(),T(0,a9t,1,4,"polygon",13),T(1,c9t,1,4,"polygon",13)),2&r){const t=p();y("ngIf",t.lastStart.isPresent()),_(1),y("ngIf",t.lastEnd.isPresent())}}const u9t=function(r){return["base",r]};function f9t(r,e){if(1&r&&(A(),S(0,"g",16),F(1,"polygon",17),S(2,"text",18),ct(3),P()()),2&r){const t=p().$implicit,n=p();y("id","tilesCount"+t.value),I("transform",n.getTilesCountTranslate(t)),_(1),y("ngClass",va(7,u9t,"player"+t+"-fill")),I("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(t)?"yellow":"black"),_(1),I("font-size",n.SPACE_SIZE/2),_(1),An(n.tiles[t.value])}}function d9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,f9t,4,9,"g",15),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngIf",n.mustShowTilesOf(t))}}let h9t=(()=>{var r;class e extends nce{constructor(n){super(n),u(this,"state",void 0),u(this,"tiles",[0,0]),u(this,"NONE",ye.UNREACHABLE),u(this,"INDICATOR_SIZE",15),u(this,"chosenCoord",g.empty()),u(this,"lastStart",g.empty()),u(this,"lastEnd",g.empty()),u(this,"possibleLandings",[]),u(this,"left",-2*this.STROKE_WIDTH),u(this,"up",-this.SPACE_SIZE/2-2*this.STROKE_WIDTH),u(this,"width",8*this.SPACE_SIZE),u(this,"height",10*(this.SPACE_SIZE+this.STROKE_WIDTH)),this.scores=g.of([0,0]),this.rules=fC.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Pieces > Threats > Tiles`,this.rules,new Xft,new Qft),new an($localize`Captures > Freedom`,this.rules,new Kft,new RL),new Xn($localize`MCTS`,new RL,this.rules)],this.encoder=wl.encoder,this.tutorial=(new sce).tutorial,this.SPACE_SIZE=70}updateBoard(n){var i=this;return M(function*(){i.chosenCoord=g.empty(),i.state=i.getState(),i.scores=g.of(i.state.captures),i.tiles=i.state.tiles,i.board=i.getState().board})()}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.possibleLandings=[]}showLastMove(n){var i=this;return M(function*(){n instanceof $2?(i.lastStart=g.of(n.getStart()),i.lastEnd=g.of(n.getEnd())):(i.lastStart=g.empty(),i.lastEnd=g.empty())})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(a)?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(a).is(c)?s.firstClick(a):s.secondClick(a)})()}firstClick(n){var i=this;return M(function*(){const s=i.state.getPieceAt(n);if(s.is(i.state.getCurrentOpponent())){const o=f4.of(n);return i.chooseMove(o)}return s.is(i.state.getCurrentPlayer())?(i.chosenCoord=g.of(n),i.showHighlight(),b.SUCCESS):i.cancelMove(Ld.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(n){var i=this;return M(function*(){if(i.possibleLandings.some(s=>s.equals(n))){const s=$2.of(i.chosenCoord.get(),n);return i.chooseMove(s)}return i.cancelMove(Ld.INVALID_DISTANCE())})()}isPyramid(n,i){return this.board[i][n].isPlayer()||this.wasOpponent(n,i)}wasOpponent(n,i){const s=this.node.parent;if(s.isPresent()){const o=s.get().gameState.getCurrentOpponent();return s.get().gameState.getPieceAtXY(n,i).is(o)}return!1}getPyramidClass(n,i){const s=this.board[i][n];return s===ye.ZERO?this.getPlayerClass(k.ZERO):s===ye.ONE?this.getPlayerClass(k.ONE):"captured-fill"}mustDraw(n,i){return this.board[i][n]!==ye.UNREACHABLE||this.wasRemoved(n,i)}wasRemoved(n,i){const o=this.node.parent;if(this.board[i][n]===ye.UNREACHABLE&&o.isPresent()){const a=o.get().gameState.getPieceAtXY(n,i);return a===ye.EMPTY||a.is(o.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(n,i){return this.wasRemoved(n,i)?"captured-alternate-fill":(n+i)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(n){return this.tiles[n.value]>0||this.lastTurnWasTilesExchange(n)}lastTurnWasTilesExchange(n){return!this.node.parent.isAbsent()&&this.getPreviousState().tiles[n.value]>this.tiles[n.value]}getIndicatorY(n){const i=this.INDICATOR_SIZE/2;return(n.x+n.y)%2==0?i:i-30}getTriangleInHexTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i),o=s.x+2*Math.floor(n/3)*this.STROKE_WIDTH;let a=s.y;return Math.floor(n/3)%2==0?a+=2*Math.floor(i/2)*this.STROKE_WIDTH:(a+=2*Math.abs(Math.floor((i-1)/2))*this.STROKE_WIDTH,a+=this.STROKE_WIDTH),"translate("+o+", "+a+")"}getTilesCountTranslate(n){let i,s;return n===k.ZERO?(i=-.05,s=-.1):(i=7.5,s=9.45),i*=this.SPACE_SIZE,s*=this.SPACE_SIZE,"translate("+i+", "+s+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-coerceo"]],features:[Xe],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill mid-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(A(),S(0,"svg",0),T(1,t9t,2,1,"g",1),T(2,i9t,2,1,"g",1),T(3,o9t,3,5,"g",2),T(4,l9t,2,2,"ng-template",null,3,fn),T(6,d9t,2,1,"g",1),P()),2&n){const s=ln(5);I("viewBox",i.left+" "+i.up+" "+i.width+" "+i.height),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s),_(3),y("ngForOf",i.Player.PLAYERS)}},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class oce extends Wn{getListMoves(e){return e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState)}getListMovesDrop(e){const t=[],n=xt.CENTRAL_ZONE_TOP_LEFT,i=xt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let s=n.y;s<=i.y;s++)for(let o=n.x;o<=i.x;o++)e.getPieceAtXY(o,s)===Y.NONE&&t.push(c4.of(new C(o,s)));return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let i=0;i<xt.HEIGHT;i++)for(let s=0;s<xt.WIDTH;s++){const o=new C(s,i);e.getPieceAt(o)===n&&(t=t.concat(this.getListSimpleMoves(e,o)),t=t.concat(this.getListJumps(e,o)))}return t}getListSimpleMoves(e,t){const n=[],i=[new C(t.x+1,t.y),new C(t.x-1,t.y),new C(t.x,t.y+1),new C(t.x,t.y-1),new C(t.x+1,t.y+1),new C(t.x+1,t.y-1),new C(t.x-1,t.y+1),new C(t.x-1,t.y-1)].filter(s=>xt.isOnBoard(s));for(const s of i){const o=l4.from(t,s);o.isSuccess()&&Gs.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}getListJumps(e,t){const n=new ft;for(const i of Gs.get().jumpTargetsFrom(t)){const s=Bo.from([t,i]).get();Gs.get().jumpLegality(s,e).isSuccess()&&(n.add(s),n.addAll(this.getListJumpStartingFrom(e,s)))}return n.toList()}getListJumpStartingFrom(e,t){const n=Gs.get().nextJumps(t,e),i=new ft(n);for(const s of n)i.addAll(this.getListJumpStartingFrom(e,s));return i}}class p9t extends dr{getMetrics(e){const t=e.gameState,n=[0,0];for(let i=0;i<xt.HEIGHT;i++)for(let s=0;s<xt.WIDTH;s++){const o=new C(s,i),a=t.getPieceAt(o);if(a.isPlayer())if(t.isShelter(o))n[a.value]+=20;else{let c=100;for(const l of xt.ALL_SHELTERS)if(t.getPieceAt(l)===Y.NONE){const f=o.getOrthogonalDistance(l);c=Math.min(c,f)}n[a.value]-=c}}return n}}class g9t extends oce{getListMoves(e){return this.sortByNumberOfJumps(super.getListMoves(e))}sortByNumberOfJumps(e){return e.sort((t,n)=>{const i=m2.isDrop(t)?1:m2.isSimple(t)?2:t.coords.length;return(m2.isDrop(n)?1:m2.isSimple(n)?2:n.coords.length)-i})}}class m9t extends an{constructor(){super($localize`Jump`,Gs.get(),new p9t,new g9t)}}function _9t(r,e){if(1&r){const t=pe();A(),S(0,"rect",9),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p().$implicit,n=p(2);I("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function v9t(r,e){if(1&r){const t=pe();A(),S(0,"circle",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();Ce("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function C9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",6),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s.coord))}),P(),T(2,_9t,1,4,"rect",7),T(3,v9t,1,6,"circle",8),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","click_",n,"_",i,""),y("ngClass",t.squareClasses),I("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isShelter),_(1),y("ngIf",t.hasPiece)}}function y9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,C9t,4,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function M9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",10),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngClass",n.viewInfo.boardInfo[t.y][t.x].shelterClasses),I("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function E9t(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=e.$implicit,n=p();Dn("id","sidePiece_0_",t,""),I("cx",-n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function S9t(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=e.$implicit,n=p();Dn("id","sidePiece_1_",t,""),I("cx",1715+n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function P9t(r,e){if(1&r&&(A(),F(0,"rect",13)),2&r){const t=p();I("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let T9t=(()=>{var r;class e extends Hc{constructor(n){super(n),u(this,"PIECE_RADIUS",void 0),u(this,"ALL_SHELTERS",xt.ALL_SHELTERS),u(this,"CENTRAL_ZONE_START",xt.CENTRAL_ZONE_TOP_LEFT),u(this,"CENTRAL_ZONE_SIZE",new Et(xt.CENTRAL_ZONE_BOTTOM_RIGHT.x-xt.CENTRAL_ZONE_TOP_LEFT.x+1,xt.CENTRAL_ZONE_BOTTOM_RIGHT.y-xt.CENTRAL_ZONE_TOP_LEFT.y+1)),u(this,"viewInfo",{dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]}),u(this,"selected",g.empty()),u(this,"jumpInConstruction",g.empty()),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=Gs.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new m9t,new Xn($localize`MCTS`,new oce,this.rules)],this.encoder=m2.encoder,this.tutorial=(new Kae).tutorial}updateBoard(n){var i=this;return M(function*(){i.updateViewInfo()})()}updateViewInfo(){const n=this.getState();this.viewInfo.dropPhase=n.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let i=0;i<xt.HEIGHT;i++){this.viewInfo.boardInfo.push([]);for(let s=0;s<xt.WIDTH;s++){const o=new C(s,i),a=n.getPieceAt(o),c={coord:o,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(a)],hasPiece:a.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[i].push(c)}}this.viewInfo.sidePieces=n.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const n of xt.ALL_SHELTERS){const i=this.viewInfo.boardInfo[n.y][n.x];i.isShelter=!0,i.hasPiece&&i.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const n=this.jumpInConstruction.get(),i=n.getStartingCoord(),s=n.getEndingCoord();this.viewInfo.boardInfo[i.y][i.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const o of n.coords)this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill")}else{const n=this.selected.get();this.viewInfo.boardInfo[n.y][n.x].pieceClasses.push("selected-stroke")}}updateVictory(){const n=this.getState(),i=Gs.get().getGameStatus(this.node);if(!0===i.isEndGame)for(const s of xt.ALL_SHELTERS)n.getPieceAt(s)===i.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(n){var i=this;return M(function*(){if(m2.isDrop(n))i.viewInfo.boardInfo[n.coord.y][n.coord.x].squareClasses.push("moved-fill");else if(m2.isSimple(n))i.viewInfo.boardInfo[n.getStart().y][n.getStart().x].squareClasses.push("moved-fill"),i.viewInfo.boardInfo[n.getEnd().y][n.getEnd().x].squareClasses.push("moved-fill");else{i.viewInfo.lastMoveArrow="";for(const s of n.coords)i.viewInfo.boardInfo[s.y][s.x].squareClasses.push("moved-fill"),i.viewInfo.lastMoveArrow+=s.x*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" ",i.viewInfo.lastMoveArrow+=s.y*i.SPACE_SIZE+i.SPACE_SIZE/2+i.STROKE_WIDTH,i.viewInfo.lastMoveArrow+=" "}})()}cancelMoveAttempt(){var n=this;return M(function*(){n.jumpInConstruction=g.empty(),n.selected=g.empty(),yield n.updateBoard(!1)})()}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());const o=i.getState();if(o.getPieceAt(n)===i.getCurrentPlayer())return i.selected.equalsValue(n)?yield i.cancelMoveAttempt():(i.selected=g.of(n),i.jumpInConstruction=g.empty()),i.updateViewInfo(),b.SUCCESS;if(i.jumpInConstruction.isPresent())return i.constructJump(n);if(i.selected.isPresent())return i.selectNextCoord(n);if(o.isDropPhase()){const a=c4.of(n);return i.chooseMove(a)}return i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(n){var i=this;return M(function*(){const s=i.jumpInConstruction.get(),o=i.getState();if(n.equals(s.getEndingCoord()))return i.chooseMove(s);{const a=s.addJump(n);if(a.isFailure())return i.cancelMove(a.getReason());const c=i.rules.jumpLegality(a.get(),o);return c.isFailure()?i.cancelMove(c.getReason()):i.updateJump(a.get())}})()}updateJump(n){var i=this;return M(function*(){const s=i.getState();return i.rules.jumpHasPossibleNextTargets(n,s)?(i.jumpInConstruction=g.of(n),i.updateViewInfo(),b.SUCCESS):i.chooseMove(n)})()}selectNextCoord(n){var i=this;return M(function*(){const s=i.selected.get(),o=l4.from(s,n);if(o.isSuccess())return i.chooseMove(o.get());{const a=Bo.from([s,n]);return a.isFailure()?i.cancelMove(a.getReason()):i.updateJump(a.get())}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-conspirateurs"]],features:[Xe],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,y9t,2,1,"g",1),T(2,M9t,2,5,"g",1),T(3,E9t,1,4,"circle",2),T(4,S9t,1,4,"circle",3),T(5,P9t,1,4,"rect",4),F(6,"polyline",5),P()),2&n&&(_(1),y("ngForOf",i.viewInfo.boardInfo),_(1),y("ngForOf",i.ALL_SHELTERS),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[0])),_(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[1])),_(1),y("ngIf",i.viewInfo.dropPhase),_(1),I("points",i.viewInfo.lastMoveArrow))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class ace extends Wn{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),i=this.getListShifts(t);return n.concat(i)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const i of n)for(const s of[new F2(i,"clockwise"),new F2(i,"counterclockwise")])Vc.get().shiftHeightValidity(s,e).isSuccess()&&t.push(s);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let i=0;i<tr.WIDTH;i++)for(const s of t){const o=new u4(i,s);Vc.get().dropHeightValidity(o,e).isSuccess()&&n.push(o)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of Tn.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let i=0;i<tr.HEIGHT;i++)for(let s=0;s<tr.WIDTH;s++)e.getPieceAtXY(s,i).owner===n&&t.push(new C(s,i));return t}}var zL;function O9t(r,e){if(1&r){const t=pe();A(),S(0,"g",6)(1,"path",7),W("click",function(){const s=te(t).$implicit;return ne(p().onSpaceClick(s))}),P(),S(2,"path",8),W("click",function(){const s=te(t).$implicit;return ne(p().onSpaceClick(s))}),P()()}if(2&r){const t=e.$implicit,n=p();Dn("id","board_space_",t,""),_(1),Dn("id","click_",t,""),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),I("d",n.BOARD_PATHS[t]),_(1),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),I("d",n.DECORATION_PATHS[t])}}function b9t(r,e){if(1&r){const t=pe();A(),S(0,"g",10),W("click",function(){const s=te(t).$implicit,o=p().$implicit;return ne(p().onPieceInGameClick(o,s.y))}),F(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit;Ce("id","click_",p().$implicit,"_",t.y,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),I("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),I("x",t.drawPosition.x)("y",t.drawPosition.y)}}function w9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,b9t,3,8,"g",9),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.boardInfo[t].pieces)}}function N9t(r,e){if(1&r){const t=pe();A(),S(0,"g",14),W("click",function(){const i=te(t),s=i.$implicit,o=i.index;return ne(p(2).onRemainingPieceClick(s.actualPiece,o))}),F(1,"use",11)(2,"use",12),P()}if(2&r){const t=e.$implicit,n=e.index;Ni("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",n,""),y("ngClass",t.foregroundClasses),_(1),y("ngClass",t.backgroundClasses),I("x",t.drawPosition.x)("y",t.drawPosition.y),_(1),I("x",t.drawPosition.x)("y",t.drawPosition.y)}}function A9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,N9t,3,9,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.viewInfo.remainingPieces.get(t).get())}}const I9t=function(){return[0,1,2,3,4,5,6,7]},k9t=function(){return[2,1,3,0,4,7,5,6]};class Fc extends Hc{constructor(e){super(e),u(this,"BOARD_PATHS",["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"]),u(this,"DECORATION_PATHS",["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"]),u(this,"selected",g.empty()),u(this,"viewInfo",{boardInfo:[],remainingPieces:new Sn([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}])}),this.rules=Vc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Dummy`,this.rules,new OL,new ace),new Xn($localize`MCTS`,new ace,this.rules)],this.encoder=jft,this.tutorial=(new tce).tutorial}onSpaceClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return M(function*(){if(t.selected.isPresent()){const n=t.selected.get();let i;if("pieceFromReserve"===n.type)i=new u4(e,n.piece);else if((n.position.x+1)%tr.WIDTH===e)i=new F2(n.position,"clockwise");else{if((n.position.x+(tr.WIDTH-1))%tr.WIDTH!==e)return t.cancelMove(xd.MUST_SHIFT_TO_NEIGHBOR());i=new F2(n.position,"counterclockwise")}return t.chooseMove(i)}return t.cancelMove(xd.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);return n.getState().getPieceAt(s).owner===n.getCurrentPlayer()?(n.isSelected(null,s)?yield n.cancelMoveAttempt():n.selected=g.of({type:"pieceFromBoard",position:s}),n.updateViewInfo(),b.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay(n.getPieceId(e,t));return i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?g.empty():g.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),b.SUCCESS):n.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(e){var t=this;return M(function*(){t.updateViewInfo()})()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),i=e.getTarget(),s=t.getStackHeight(e.getTarget()),o=this.getDrawPositionOnBoard(i,s),a=new C(i,s);return[{start:g.empty(),end:a,startDrawPosition:n,endDrawPosition:o}]}getLastMovedFromShift(e,t){const n=e.start.x,i=e.getTarget();let s=t.getStackHeight(i);const o=[];for(let a=e.start.y;a<tr.HEIGHT&&t.getPieceAtXY(n,a)!==Tn.EMPTY;a++,s++)o.push({start:g.of(new C(n,a)),end:new C(i,s),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,s)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<tr.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){var t=this;return M(function*(){t.showLastMoveOnSpaces(e),t.showLastMoveOnPieces(e)})()}showLastMoveOnSpaces(e){for(let t=0;t<tr.WIDTH;t++){const n=[];if(e.isDrop())e.getTarget()===t&&n.push("moved-fill");else{const i=e;(i.getTarget()===t||i.start.x===t)&&n.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=n}}showLastMoveOnPieces(e){const t=this.getPreviousState();let n=[];n=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Sn([{key:k.ZERO,value:[]},{key:k.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of Tn.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let s=0;s<i;s++){const o=[];this.isTopPieceOfReserveAndSelected(s,i,n)&&o.push("selected-stroke"),t&&s===i-1&&n.owner===e&&o.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.value+"-alternate-fill":"player"+n.owner.value+"-fill"),a.push({backgroundClasses:c,foregroundClasses:o,y:s,drawPosition:this.getDrawPositionRemainingPiece(n,s),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,i;return n=e.owner===k.ZERO?-100:600,i=e.otherPieceType?100:450,new C(n,i).getNext(new Et(0,-t*Fc.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let s=0;s<tr.HEIGHT;s++){const o=this.getState().getPieceAtXY(e,s),a=new C(e,s);if(o!==Tn.EMPTY){const c=[];this.pieceFromBoardIsSelected(e,s)&&c.push("selected-stroke"),this.isVictory(e,s,t)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:s,drawPosition:this.getDrawPositionOnBoard(e,s),actualPiece:o})}}return i}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const i=n.get();return i.x%4==e%4&&i.y===t}return!1}getDrawPositionOnBoard(e,t){return Fc.CENTER[e].getNext(new Et(0,-t*Fc.PIECE_HEIGHT))}cancelMoveAttempt(){var e=this;return M(function*(){e.selected=g.empty(),yield e.updateBoard(!1)})()}}zL=Fc,u(Fc,"CENTER",[new C(40,160),new C(100,50),new C(255,2),new C(400,50),new C(460,160),new C(400,270),new C(255,320),new C(100,270)]),u(Fc,"PIECE_HEIGHT",36),u(Fc,"\u0275fac",function(e){return new(e||zL)(B(Ut))}),u(Fc,"\u0275cmp",We({type:zL,selectors:[["app-diam"]],features:[Xe],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),P()(),T(5,O9t,3,6,"g",4),T(6,w9t,2,1,"g",5),T(7,A9t,2,1,"g",5),P()),2&e&&(_(5),y("ngForOf",H1(3,I9t)),_(1),y("ngForOf",H1(4,k9t)),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class _o{static fromTwoCoords(e,t){const n=e.x,i=t.x,s=e.y,o=t.y,a=n+s,c=i+o;return n===i&&s!==o&&a!==c?g.of(_o.constantQ(n)):n!==i&&s===o&&a!==c?g.of(_o.constantR(s)):n!==i&&s!==o&&a===c?g.of(_o.constantS(a)):g.empty()}static constantQ(e){return new _o(e,"q")}static constantR(e){return new _o(e,"r")}static constantS(e){return new _o(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=_o.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const i of e.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(e,t){u(this,"offset",void 0),u(this,"constant",void 0),this.offset=e,this.constant=t}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return be.DOWN;case"r":return be.RIGHT;case"s":return be.DOWN_LEFT}}}class DL extends q1{constructor(e,t,n,i,s,o){super(t,e),u(this,"width",void 0),u(this,"height",void 0),u(this,"excludedSpaces",void 0),u(this,"empty",void 0),this.width=n,this.height=i,this.excludedSpaces=s,this.empty=o,je(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(_o.constantQ(t));for(let t=0;t<this.height;t++)e.push(_o.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(_o.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new C(e.offset,0):new C(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let i=t;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const s=h2.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(s.getReason())}}class _2{static getNeighbors(e,t=1){const n=[];for(const i of be.factory.all)n.push(e.getNext(i,t));return n}static areNeighbors(e,t){for(const n of be.factory.all)if(e.getNext(n).equals(t))return!0;return!1}}var A0;class g1{static append(e,t){return new g1(e.owner,e.size+t.size,e.source||t.source)}constructor(e,t,n){u(this,"owner",void 0),u(this,"size",void 0),u(this,"source",void 0),this.owner=e,this.size=t,this.source=n}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}A0=g1,u(g1,"encoder",we.tuple([we.identity(),k.encoder,we.identity()],r=>[r.source,r.owner,r.size],r=>new A0(r[1],r[2],r[0]))),u(g1,"MAX_SIZE",49),u(g1,"EMPTY",new A0(Y.NONE,0,!1)),u(g1,"UNREACHABLE",new A0(Y.NONE,-1,!1)),u(g1,"PLAYER_ZERO",new A0(k.ZERO,1,!1)),u(g1,"PLAYER_ONE",new A0(k.ONE,1,!1)),u(g1,"SOURCE",new A0(Y.NONE,1,!0));let Wo=(()=>{class r extends DL{static balancedBoard(){const t=g1.UNREACHABLE,n=g1.PLAYER_ZERO,i=g1.PLAYER_ONE,s=g1.SOURCE;return[[t,t,n,i,i,i,n,n,i,s,i],[t,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,s,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,t],[n,s,n,i,i,n,n,n,i,t,t]]}static isOnBoard(t){return!t.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[t.y][t.x]!==g1.UNREACHABLE}static getInitialState(){return new r(r.balancedBoard(),0,!1)}constructor(t,n,i){super(n,t,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,g1.EMPTY),u(this,"alreadyPassed",void 0),this.alreadyPassed=i}getAllPieces(){const t=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const s=new C(i,n);this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()&&t.push(s)}return t}numberOfNeighbors(t){return _2.getNeighbors(t,1).filter(s=>this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()).length}setAtUnsafe(t,n){const i=Rt.copy(this.board);return i[t.y][t.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==g1.UNREACHABLE}}return u(r,"WIDTH",11),u(r,"HEIGHT",5),u(r,"EXCLUDED_SPACES",[2,1]),r})(),I0=(()=>{class r{}return u(r,"NOT_PLAYER_PIECE",()=>$localize`You must select a piece or a stack of your color.`),u(r,"EMPTY_STACK",()=>$localize`You must select a stack.`),u(r,"TOO_MANY_NEIGHBORS",()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`),u(r,"CANT_REACH_TARGET",()=>$localize`This stack cannot move because it could never land on another piece.`),u(r,"INVALID_MOVE_LENGTH",()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`),u(r,"EMPTY_TARGET_STACK",()=>$localize`The stack must land on an occupied space.`),u(r,"MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`A stack must move in a straight line.`),r})();var HL;class hr extends Go{constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?re.success(hr.PASS):!1===Wo.isOnBoard(e)?re.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString()):!1===Wo.isOnBoard(t)?re.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?re.success(new hr(e,t)):re.failure(I0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===hr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}u(hr,"PASS",new(HL=hr)(new C(-1,-1),new C(-2,-2))),u(hr,"encoder",Vs.getFallibleEncoder(HL.from));const se=g1.EMPTY,nr=g1.UNREACHABLE,Nl=g1.SOURCE,gu=g1.PLAYER_ZERO,mu=g1.PLAYER_ONE,x9t=new g1(k.ZERO,2,!1),VL=new g1(k.ONE,2,!1),cce=new g1(k.ZERO,4,!1),L9t=new g1(k.ONE,4,!1);class lce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Wo.getInitialState(),hr.from(new C(2,0),new C(3,0)).get(),$localize`Congratulations!`),q.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Wo([[nr,nr,mu,Nl,se,se,se,se,se,se,se],[nr,se,gu,se,se,se,se,se,se,se,se],[se,se,L9t,se,se,se,se,mu,Nl,se,se],[se,se,se,se,se,se,se,se,se,se,nr],[se,se,se,se,se,se,se,se,se,nr,nr]],0,!1),hr.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(3,0))?b.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(je(t.getEnd().equals(new C(2,0)),"player made an impossible move"),b.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),q.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Wo([[nr,nr,Nl,mu,se,se,se,se,se,se,se],[nr,gu,gu,se,se,se,se,se,se,se,se],[se,mu,gu,mu,se,se,gu,VL,Nl,se,se],[se,se,mu,se,se,se,se,se,se,se,nr],[se,se,se,se,se,se,se,se,se,nr,nr]],0,!1),hr.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(2,0))?b.SUCCESS:b.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),q.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Wo([[nr,nr,Nl,se,se,se,se,se,se,se,se],[nr,se,x9t,se,se,se,se,se,se,se,se],[se,se,VL,se,se,se,se,VL,Nl,cce,se],[se,se,se,se,se,se,se,se,se,se,nr],[se,se,se,se,se,se,se,se,se,nr,nr]],0,!1)),q.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Wo([[nr,nr,Nl,se,se,se,se,se,se,se,se],[nr,se,gu,se,se,se,se,se,se,se,se],[se,se,se,se,se,se,se,se,Nl,cce,se],[se,se,se,se,se,se,se,se,se,se,nr],[se,se,se,se,se,se,se,se,se,nr,nr]],0,!1),[hr.from(new C(2,1),new C(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)])}}class Nr extends Kn{static get(){return Nr.singleton.isAbsent()&&(Nr.singleton=g.of(new Nr)),Nr.singleton.get()}constructor(){super(Wo)}static getGameStatus(e){const t=e.gameState,n=Nr.getScores(t);return 0===Nr.getMovablePieces(t).length?n[0]>n[1]?_e.ZERO_WON:n[0]<n[1]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static getMovablePieces(e){return Nr.getFreePieces(e).filter(t=>Nr.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==_2.getNeighbors(t,n).find(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return _2.getNeighbors(t,n).filter(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(i=>{const s=e.getPieceAt(i);s.belongsTo(k.ZERO)?t+=s.getSize():s.belongsTo(k.ONE)&&(n+=s.getSize())}),[t,n]}isMovablePiece(e,t){je(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?b.failure(I0.EMPTY_STACK()):!1===n.belongsTo(e.getCurrentPlayer())?b.failure(I0.NOT_PLAYER_PIECE()):e.numberOfNeighbors(t)>=6?b.failure(I0.TOO_MANY_NEIGHBORS()):!1===Nr.pieceHasTarget(e,t)?b.failure(I0.CANT_REACH_TARGET()):b.SUCCESS}canOnlyPass(e){return 0===Nr.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){_2.getNeighbors(t,1).forEach(i=>{e.isOnBoard(i)&&!1===n[i.y][i.x]&&e.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,n))})}removeDisconnectedPieces(e){const t=Rt.create(Wo.WIDTH,Wo.HEIGHT,!1);this.sourceCoords(e).forEach(i=>{t[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,t)});let n=e;return n.getAllPieces().forEach(i=>{!1===t[i.y][i.x]&&(n=n.setAt(i,g1.EMPTY))}),n}applyLegalMove(e,t,n){if(e===hr.PASS)return new Wo(t.board,t.turn+1,!0);{const i=t.getPieceAt(e.getStart()),s=t.getPieceAt(e.getEnd()),o=t.setAt(e.getStart(),g1.EMPTY).setAt(e.getEnd(),g1.append(i,s));return this.removeDisconnectedPieces(new Wo(o.board,t.turn+1,!1))}}isLegal(e,t){if(0===Nr.getMovablePieces(t).length)return e===hr.PASS&&!1===t.alreadyPassed?b.SUCCESS:b.failure(Le.MUST_PASS());if(e===hr.PASS)return b.failure(Le.CANNOT_PASS());const n=this.isMovablePiece(t,e.getStart());if(n.isFailure())return n;const i=t.getPieceAt(e.getStart());return e.length()!==i.getSize()?re.failure(I0.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?re.failure(I0.EMPTY_TARGET_STACK()):re.success(void 0)}getGameStatus(e){return Nr.getGameStatus(e)}}u(Nr,"singleton",g.empty());class R9t extends dr{getMetrics(e){return Nr.getScores(e.gameState)}}class uce extends Wn{getListMoves(e){const t=e.previousMove,n=e.gameState,i=[];return Nr.getMovablePieces(n).forEach(s=>Nr.pieceTargets(n,s).forEach(o=>{const a=hr.from(s,o).get();i.push(a)})),0===i.length&&!1===t.equalsValue(hr.PASS)&&i.push(hr.PASS),i}}class fce extends uce{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),i=t.getCurrentOpponent();return en.sortByDescending(n,s=>{je(s!==hr.PASS,"Cannot sort with DvonnMove.PASS");const o=t.getPieceAt(s.getEnd());return o.belongsTo(i)?o.getSize():0}),n}}class z9t extends dr{getMetrics(e){const t=e.gameState,n=Nr.getScores(t),i=t.getAllPieces(),s=i.length;for(const o of k.PLAYERS){const a=i.filter(c=>t.getPieceAt(c).belongsTo(o)).length;n[o.value]=n[o.value]*a/s}return n}}function D9t(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=p().$implicit,n=p().$implicit,i=p();Ce("id","piece_",n.x,"_",n.y,""),y("ngClass",i.getPieceClasses(t)),I("cx",i.getCenterAt(n).x)("cy",i.getCenterAt(n).y)("r",i.SPACE_SIZE)}}function H9t(r,e){if(1&r&&(A(),F(0,"polygon",12)),2&r){const t=p().$implicit,n=p().$implicit,i=p();I("transform",1===t.getSize()?"translate("+(i.getCenterAt(n).x-18)+" "+(i.getCenterAt(n).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(n).x-3)+" "+(i.getCenterAt(n).y-12)+") scale(0.07)")}}function V9t(r,e){if(1&r){const t=pe();A(),S(0,"text",13),W("click",function(){te(t);const i=p(2).$implicit;return ne(p().onClick(i.x,i.y))}),ct(1),P()}if(2&r){const t=p().$implicit,n=p().$implicit,i=p();I("x",t.containsSource()?i.getCenterAt(n).x-7:i.getCenterAt(n).x)("y",i.getCenterAt(n).y),_(1),An(t.getSize())}}function F9t(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p().onClick(i.x,i.y))}),F(1,"polygon",7),T(2,D9t,1,6,"circle",8),T(3,H9t,1,1,"polygon",9),T(4,V9t,2,3,"text",10),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","click_",n.x,"_",n.y,""),_(1),I("points",i.getHexaPointsAt(n)),_(1),y("ngIf",t.getSize()>0),_(1),y("ngIf",t.containsSource()),_(1),y("ngIf",t.getSize()>1)}}const $9t=function(r){return[r]};function G9t(r,e){if(1&r&&(A(),S(0,"g"),T(1,F9t,5,6,"g",5),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",va(1,$9t,n.state.getPieceAt(t)))}}function B9t(r,e){if(1&r&&(A(),S(0,"text",18),ct(1),P()),2&r){const t=p().$implicit,n=p();I("x",n.getCenterAt(t.coord).x)("y",n.getCenterAt(t.coord).y),_(1),An(t.spaceContent.getSize())}}function U9t(r,e){if(1&r&&(A(),S(0,"g",14),F(1,"polygon",15)(2,"circle",16),T(3,B9t,2,3,"text",17),P()),2&r){const t=e.$implicit,n=p();Ce("id","disconnected_",t.coord.x,"_",t.coord.y,""),_(1),I("points",n.getHexaPointsAt(t.coord)),_(1),Ce("id","captured_",t.coord.x,"_",t.coord.y,""),y("ngClass",n.getPieceClasses(t.spaceContent)),I("cx",n.getCenterAt(t.coord).x)("cy",n.getCenterAt(t.coord).y)("r",n.SPACE_SIZE),_(1),y("ngIf",t.spaceContent.getSize()>1)}}function W9t(r,e){if(1&r&&(A(),Gt(0),F(1,"polygon",19)(2,"polygon",19),Bt()),2&r){const t=p();_(1),I("points",t.getHexaPointsAt(t.lastMove.get().getStart())),_(1),I("points",t.getHexaPointsAt(t.lastMove.get().getEnd()))}}function q9t(r,e){if(1&r&&(A(),F(0,"polygon",20)),2&r){const t=p();Ce("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),I("points",t.getHexaPointsAt(t.chosen.get()))}}let j9t=(()=>{var r;class e extends lu{constructor(n){super(n),u(this,"lastMove",g.empty()),u(this,"chosen",g.empty()),u(this,"disconnecteds",[]),u(this,"state",void 0),this.rules=Nr.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Stacks`,this.rules,new z9t,new fce),new an($localize`Score`,this.rules,new R9t,new fce),new Xn($localize`MCTS`,new uce,this.rules)],this.encoder=hr.encoder,this.tutorial=(new lce).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=g.of(Nr.getScores(this.getState())),this.hexaLayout=new uu(1.5*this.SPACE_SIZE,new C(-this.SPACE_SIZE,2*this.SPACE_SIZE),rC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=g.empty()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.state=i.getState(),i.disconnecteds=[],i.hideLastMove(),i.canPass=i.rules.canOnlyPass(i.state),i.scores=g.of(Nr.getScores(i.state))})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=g.of(n);const s=i.getPreviousState(),o=i.getState();for(let a=0;a<o.board.length;a++)for(let c=0;c<o.board[a].length;c++){const l=new C(c,a);if(!0===o.isOnBoard(l)&&!1===l.equals(i.lastMove.get().getStart())){const f=o.getPieceAt(l),d=s.getPieceAt(l);if(f.isEmpty()&&d.hasPieces()){const E={coord:new C(c,a),spaceContent:d};i.disconnecteds.push(E)}}}})()}cancelMoveAttempt(){this.chosen=g.empty()}pass(){var n=this;return M(function*(){return je(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(hr.PASS)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.chosen.isAbsent()?s.choosePiece(n,i):s.chosen.equalsValue(new C(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):yield s.chooseDestination(n,i)})()}choosePiece(n,i){var s=this;return M(function*(){const o=new C(n,i),a=s.rules.isMovablePiece(s.getState(),o);return a.isSuccess()?(s.chosen=g.of(o),b.SUCCESS):s.cancelMove(a.getReason())})()}chooseDestination(n,i){var s=this;return M(function*(){const o=s.getState(),a=s.chosen.get(),c=new C(n,i),l=hr.from(a,c);return l.isFailure()?s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.cancelMove(l.getReason()):s.rules.isLegal(l.get(),o).isFailure()&&s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.chooseMove(l.get())})()}getPieceClasses(n){if(n.containsSource()&&1===n.getSize())return["nonplayer-fill","dashed-stroke"];const i=this.getPlayerClass(n.getOwner());return n.containsSource()?[i,"nonplayer-stroke","dashed-stroke"]:[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-dvonn"]],features:[Xe],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,G9t,2,3,"g",1),T(2,U9t,4,10,"g",2),T(3,W9t,3,2,"ng-container",3),T(4,q9t,1,3,"polygon",4),P()),2&n&&(_(1),y("ngForOf",i.state.allCoords()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.lastMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var d4,R1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(R1||{});class Be{static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===k.ZERO&&e===R1.BIG?Be.BIG_DARK:t===k.ZERO&&e===R1.MEDIUM?Be.MEDIUM_DARK:t===k.ZERO&&e===R1.SMALL?Be.SMALL_DARK:t===k.ONE&&e===R1.BIG?Be.BIG_LIGHT:t===k.ONE&&e===R1.MEDIUM?Be.MEDIUM_LIGHT:t===k.ONE&&e===R1.SMALL?Be.SMALL_LIGHT:Be.NONE}constructor(e){u(this,"value",void 0),this.value=e}getPlayer(){switch(this){case Be.SMALL_DARK:case Be.MEDIUM_DARK:case Be.BIG_DARK:return k.ZERO;case Be.SMALL_LIGHT:case Be.MEDIUM_LIGHT:case Be.BIG_LIGHT:return k.ONE;default:return Y.NONE}}getSize(){switch(this){case Be.BIG_DARK:case Be.BIG_LIGHT:return R1.BIG;case Be.MEDIUM_DARK:case Be.MEDIUM_LIGHT:return R1.MEDIUM;case Be.SMALL_DARK:case Be.SMALL_LIGHT:return R1.SMALL;default:return U.expectToBe(this,Be.NONE),R1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case Be.BIG_DARK:return"BIG_DARK";case Be.BIG_LIGHT:return"BIG_LIGHT";case Be.MEDIUM_DARK:return"MEDIUM_DARK";case Be.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Be.SMALL_DARK:return"SMALL_DARK";case Be.SMALL_LIGHT:return"SMALL_LIGHT";default:return U.expectToBe(this,Be.NONE),"EMPTY"}}}d4=Be,u(Be,"encoder",we.tuple([we.identity()],r=>[r.value],r=>d4.of(r[0]))),u(Be,"SMALL_DARK",new d4(0)),u(Be,"SMALL_LIGHT",new d4(1)),u(Be,"MEDIUM_DARK",new d4(2)),u(Be,"MEDIUM_LIGHT",new d4(3)),u(Be,"BIG_DARK",new d4(4)),u(Be,"BIG_LIGHT",new d4(5)),u(Be,"NONE",new d4(6));class Al extends q1{constructor(e,t,n){super(e,t),u(this,"remainingPieces",void 0),this.remainingPieces=n}static getInitialState(){const e=new G2(Y.NONE,Y.NONE,Y.NONE),t=Rt.create(3,3,e);return new Al(t,0,[Be.BIG_DARK,Be.BIG_DARK,Be.BIG_LIGHT,Be.BIG_LIGHT,Be.MEDIUM_DARK,Be.MEDIUM_DARK,Be.MEDIUM_LIGHT,Be.MEDIUM_LIGHT,Be.SMALL_DARK,Be.SMALL_DARK,Be.SMALL_LIGHT,Be.SMALL_LIGHT])}getRemainingPieces(){return en.copy(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class G2{constructor(e,t,n){u(this,"small",void 0),u(this,"medium",void 0),u(this,"big",void 0),this.small=e,this.medium=t,this.big=n}isEmpty(){return this.small===Y.NONE&&this.medium===Y.NONE&&this.big===Y.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(Be.ofSizeAndPlayer(R1.SMALL,this.small)),this.medium.isPlayer()&&e.push(Be.ofSizeAndPlayer(R1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(Be.ofSizeAndPlayer(R1.BIG,this.big)),e}toOrderedPieceNames(){const e=Be.ofSizeAndPlayer(R1.SMALL,this.small),t=Be.ofSizeAndPlayer(R1.MEDIUM,this.medium),n=Be.ofSizeAndPlayer(R1.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===k.ZERO?Be.BIG_DARK:this.big===k.ONE?Be.BIG_LIGHT:this.medium===k.ZERO?Be.MEDIUM_DARK:this.medium===k.ONE?Be.MEDIUM_LIGHT:this.small===k.ZERO?Be.SMALL_DARK:this.small===k.ONE?Be.SMALL_LIGHT:Be.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===Be.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?g.of(this.put(e)):g.empty()}removeBiggest(){const e=this.getBiggest();if(e===Be.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case R1.BIG:t=new G2(this.small,this.medium,Y.NONE);break;case R1.MEDIUM:t=new G2(this.small,Y.NONE,Y.NONE);break;default:U.expectToBe(n,R1.SMALL),t=new G2(Y.NONE,Y.NONE,Y.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===Be.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case R1.BIG:return new G2(this.small,this.medium,t);case R1.MEDIUM:return je(this.big===Y.NONE,"Cannot put a piece on top of a bigger one"),new G2(this.small,t,this.big);default:return U.expectToBe(n,R1.SMALL),je(this.big===Y.NONE,"Cannot put a piece on top of a bigger one"),je(this.medium===Y.NONE,"Cannot put a piece on top of a bigger one"),new G2(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}u(G2,"EMPTY",new G2(Y.NONE,Y.NONE,Y.NONE));let Rd=(()=>{class r{}return u(r,"PIECE_OUT_OF_STOCK",()=>$localize`You do not have pieces of this type anymore.`),u(r,"INVALID_PLACEMENT",()=>$localize`You must put your piece on an empty square or on a smaller piece.`),u(r,"NOT_DROPPABLE",()=>$localize`You must pick your piece among the remaining ones.`),u(r,"INVALID_PIECE_SELECTED",()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`),u(r,"END_YOUR_MOVE",()=>$localize`You are performing a move, you must select a landing square.`),r})();var zd,Ra;let _u=(zd=class extends Kn{static get(){return Ra.singleton.isAbsent()&&(Ra.singleton=g.of(new Ra)),Ra.singleton.get()}constructor(){super(Al)}static isVictory(e){const t=e.getCopiedBoard();for(const n of Ra.LINES){const s=Ra.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(s.isPresent())return s}return g.empty()}static isVictoriousLine(e){const n=e.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===Y.NONE?g.empty():n[0]===n[1]&&n[1]===n[2]?g.of(n[0]):g.empty()}static isLegal(e,t){let n;if(e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return re.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return re.failure(Rd.PIECE_OUT_OF_STOCK())}else{const o=e.startingCoord.get();if(n=t.getPieceAt(o).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return re.failure(Le.MUST_CHOOSE_PLAYER_PIECE())}const s=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return s.isPresent()?re.success(s.get()):re.failure(Rd.INVALID_PLACEMENT())}isLegal(e,t){return Ra.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();let s=t.getRemainingPieces();const o=t.turn+1;let a;if(i[e.landingCoord.y][e.landingCoord.x]=n,e.isDropping()){a=e.piece.get();const l=s.indexOf(a);s=s.slice(0,l).concat(s.slice(l+1))}else{const l=e.startingCoord.get(),d=i[l.y][l.x].removeBiggest();i[l.y][l.x]=d.removedSpace,a=d.removedPiece}return new Al(i,o,s)}static getGameStatus(e){const n=Ra.isVictory(e.gameState);return n.isPresent()?_e.getVictory(n.get()):_e.ONGOING}getGameStatus(e){return Ra.getGameStatus(e)}},Ra=zd,u(zd,"singleton",g.empty()),u(zd,"LINES",[[new C(0,0),new C(0,1),new C(0,2)],[new C(1,0),new C(1,1),new C(1,2)],[new C(2,0),new C(2,1),new C(2,2)],[new C(0,0),new C(1,0),new C(2,0)],[new C(0,1),new C(1,1),new C(2,1)],[new C(0,2),new C(1,2),new C(2,2)],[new C(0,0),new C(1,1),new C(2,2)],[new C(0,2),new C(1,1),new C(2,0)]]),zd);var hce;_u=Ra=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],_u);class v2 extends Hi{constructor(e,t,n){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"piece",void 0),this.startingCoord=e,this.landingCoord=t,this.piece=n}static ofMove(e,t){return U.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new v2(g.of(e),t,g.empty())}static ofDrop(e,t){return new v2(g.empty(),t,g.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}hce=v2,u(v2,"encoder",we.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(Be.encoder)],r=>[r.startingCoord,r.landingCoord,r.piece],r=>new hce(r[0],r[1],r[2])));const vs=new G2(Y.NONE,Y.NONE,Y.NONE),pce=new G2(k.ZERO,Y.NONE,Y.NONE),Y9t=new G2(Y.NONE,k.ZERO,Y.NONE),K9t=new G2(Y.NONE,Y.NONE,k.ZERO),gce=new G2(k.ONE,Y.NONE,Y.NONE),dC=new G2(Y.NONE,Y.NONE,k.ONE),X9t=new G2(k.ONE,k.ZERO,Y.NONE),Q9t=new G2(k.ZERO,k.ZERO,Y.NONE);class mce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new Al([[pce,gce,dC],[vs,Y9t,vs],[vs,vs,K9t]],0,[Be.SMALL_DARK,Be.MEDIUM_DARK,Be.BIG_DARK,Be.SMALL_LIGHT,Be.MEDIUM_LIGHT,Be.MEDIUM_LIGHT,Be.BIG_LIGHT])),q.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,Al.getInitialState(),v2.ofDrop(Be.SMALL_DARK,new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new Al([[pce,dC,vs],[vs,vs,vs],[vs,vs,vs]],0,[]),[v2.ofMove(new C(0,0),new C(2,0)),v2.ofMove(new C(0,0),new C(0,1)),v2.ofMove(new C(0,0),new C(1,1)),v2.ofMove(new C(0,0),new C(2,1)),v2.ofMove(new C(0,0),new C(0,2)),v2.ofMove(new C(0,0),new C(1,2)),v2.ofMove(new C(0,0),new C(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new Al([[X9t,vs,gce],[Q9t,dC,dC],[vs,vs,vs]],0,[Be.MEDIUM_DARK,Be.BIG_DARK,Be.MEDIUM_LIGHT,Be.MEDIUM_LIGHT]),v2.ofMove(new C(0,1),new C(0,2)),(t,n,i)=>{if(t.landingCoord.equals(new C(0,2))){if(t.isDropping())return b.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new C(0,1)))return b.SUCCESS}return b.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)])}}class _ce extends Wn{getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getCurrentPlayer(),o=dae.toComparableObjectSet(n.getPlayerRemainingPieces());for(let a=0;a<3;a++)for(let c=0;c<3;c++){const l=new C(c,a);for(const f of o){const d=v2.ofDrop(f,l);_u.isLegal(d,n).isSuccess()&&t.push(d)}if(i[a][c].belongsTo(s))for(let f=0;f<3;f++)for(let d=0;d<3;d++){const m=new C(d,f);if(!1===m.equals(l)){const E=v2.ofMove(l,m);_u.isLegal(E,n).isSuccess()&&t.push(E)}}}return t}}function J9t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",5),W("click",function(){const i=te(t),s=i.$implicit,o=i.index,a=p().$implicit;return ne(p().onPieceClick(a.value,s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();_(1),Ni("id","piece_",i.value,"_",t.toString(),"_",n,""),y("ngClass",s.getSidePieceClasses(t,n)),I("transform","rotate("+180*(s.getPointOfView().value+i.value)+" "+s.CENTER+" "+s.CENTER+")")("r",s.getPieceRadius(t))("cx",s.getRemainingPieceCenterCoord(i,n).x)("cy",s.getRemainingPieceCenterCoord(i,n).y)}}function edt(r,e){if(1&r&&(A(),S(0,"g",null,4),T(2,J9t,2,8,"g",1),P()),2&r){const t=e.$implicit,n=p();_(2),y("ngForOf",n.getRemainingPieces(t))}}function tdt(r,e){if(1&r){const t=pe();A(),S(0,"circle",8),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onBoardClick(i,s))}),P()}if(2&r){const t=e.$implicit,n=p().index,i=p().index,s=p();y("ngClass",s.getPieceClasses(t)),I("r",s.getPieceRadius(t))("cx",s.getPieceCenter(n))("cy",s.getPieceCenter(i))}}function ndt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",6),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onBoardClick(s,o))}),P(),T(2,tdt,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","click_",n,"_",i,""),y("ngClass",s.getRectClasses(n,i)),I("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngForOf",s.getListPieces(t))}}function rdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,ndt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function idt(r,e){if(1&r){const t=pe();A(),S(0,"rect",9),W("click",function(){te(t);const i=p();return ne(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),P()}if(2&r){const t=p();Ce("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let sdt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"CENTER",this.getPieceCenter(1)),u(this,"UPLEFT",-(this.SPACE_SIZE+.5*this.STROKE_WIDTH)),u(this,"WIDTH",5*this.SPACE_SIZE+3*this.STROKE_WIDTH),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenPiece",g.empty()),u(this,"chosenPieceIndex",void 0),u(this,"remainingPieceCenterCoords",new Sn),this.rules=_u.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Dummy`,this.rules,new OL,new _ce),new Xn($localize`MCTS`,new _ce,this.rules)],this.encoder=v2.encoder,this.tutorial=(new mce).tutorial}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard();const o=i.node.previousMove;i.calculateLeftPieceCoords(),o.isPresent()?(i.lastLandingCoord=g.of(o.get().landingCoord),i.lastStartingCoord=o.get().startingCoord):(i.lastLandingCoord=g.empty(),i.lastStartingCoord=g.empty())})()}getListPieces(n){return n.toList()}getRemainingPieces(n){return this.getState().getRemainingPiecesOfPlayer(n)}onBoardClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=g.of(a),s.chosenPiece.isPresent()){const l=v2.ofDrop(s.chosenPiece.get(),a);return s.chooseMove(l)}return!1===c.getPieceAt(a).belongsTo(c.getCurrentPlayer())?s.cancelMove(Rd.INVALID_PIECE_SELECTED()):b.SUCCESS}if(s.chosenCoord.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const l=v2.ofMove(s.chosenCoord.get(),a);return s.chooseMove(l)}})()}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.chosenPiece=g.empty(),this.chosenPieceIndex=g.empty()}onPieceClick(n,i,s){var o=this;return M(function*(){const a="#piece_"+n+"_"+i.toString()+"_"+s,c=yield o.canUserPlay(a);return c.isFailure()?o.cancelMove(c.getReason()):!1===o.getState().isDroppable(i)?o.cancelMove(Rd.NOT_DROPPABLE()):o.chosenCoord.isAbsent()?(o.chosenPiece.equalsValue(i)&&o.chosenPieceIndex.equalsValue(s)?(o.chosenPiece=g.empty(),o.chosenPieceIndex=g.empty()):(o.chosenPiece=g.of(i),o.chosenPieceIndex=g.of(s)),b.SUCCESS):o.cancelMove(Rd.END_YOUR_MOVE())})()}getRectClasses(n,i){return this.isSelected(n,i)?"moved-fill":""}isSelected(n,i){const s=new C(n,i);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(n){return[this.getPieceStrokeClass(n)]}getPieceCenter(n){return this.SPACE_SIZE*n+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(n){const i=n.getPlayer();return je(i.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+i.value+"-stroke"}getPieceRadius(n){switch(n.getSize()){case R1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case R1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return U.expectToBe(n.getSize(),R1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(n,i){const s=this.getPieceClasses(n);return this.isSelectedPiece(n)&&this.chosenPieceIndex.equalsValue(i)&&s.push("selected-stroke"),s}isSelectedPiece(n){return this.chosenPiece.equalsValue(n)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Sn;for(const n of k.PLAYERS){const i=[],s=this.getRemainingPieces(n);for(let o=0;o<s.length;o++){let a,c=0,l=0;o<=2?(a=new C(2-o,3),l=this.STROKE_WIDTH):(a=new C(-1,5-o),c=-this.STROKE_WIDTH);const f=this.getPieceCenter(a.x),d=this.getPieceCenter(a.y);i.push(new C(f+c,d+l))}this.remainingPieceCenterCoords.set(n,i)}}getRemainingPieceCenterCoord(n,i){return this.remainingPieceCenterCoords.get(n).get()[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-encapsule"]],features:[Xe],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,edt,3,1,"g",1),S(2,"g",null,2),T(4,rdt,2,1,"g",1),T(5,idt,1,6,"rect",3),P()()),2&n&&(I("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),_(1),y("ngForOf",i.Player.PLAYERS),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),dn=(()=>{class r extends q1{static getInitialState(){const t=Y.NONE,n=Y.ZERO,i=Y.ONE;return new r([[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}count(t,n){let i=0;for(let s=0;s<14;s++)this.board[n][s]===t&&i++;return i}doesOwnPiece(t){for(const n of this.getCoordsAndContents())if(n.content===t)return!0;return!1}}return u(r,"WIDTH",14),u(r,"HEIGHT",12),r})();var vce;class qo extends wr{constructor(e,t,n,i,s){super(e,t),u(this,"movedPieces",void 0),u(this,"stepSize",void 0),u(this,"direction",void 0),this.movedPieces=n,this.stepSize=i,this.direction=s,U.assert(dn.isOnBoard(this.coord),"Illegal coord outside of board "+this.coord.toString()+"."),U.assert(n>0,"Must select minimum one piece (got "+n+")."),U.assert(i>0,"Step size must be minimum one (got "+i+")."),U.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}vce=qo,u(qo,"encoder",we.tuple([C.encoder,we.identity(),we.identity(),Me.encoder],r=>[r.coord,r.movedPieces,r.stepSize,r.direction],r=>new vce(r[0].x,r[0].y,r[1],r[2],r[3])));let jo=(()=>{class r{}return u(r,"PHALANX_IS_LEAVING_BOARD",()=>$localize`The move distance of your phalanx puts it out of the board.`),u(r,"SOMETHING_IN_PHALANX_WAY",()=>$localize`There is something in the way of your phalanx.`),u(r,"PHALANX_SHOULD_BE_GREATER_TO_CAPTURE",()=>$localize`Your phalanx must be bigger than the one you are capturing.`),u(r,"SQUARE_NOT_ALIGNED_WITH_SELECTED",()=>$localize`This square is not aligned with the selected piece.`),u(r,"SINGLE_PIECE_MUST_MOVE_BY_ONE",()=>$localize`A single piece can only move by one square.`),u(r,"SINGLE_PIECE_CANNOT_CAPTURE",()=>$localize`A single piece cannot make a capture.`),u(r,"SQUARE_NOT_ALIGNED_WITH_PHALANX",()=>$localize`This square is not aligned with the direction of the phalanx.`),u(r,"PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD",()=>$localize`A phalanx can't contain pieces outside of the board.`),u(r,"PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE",()=>$localize`A phalanx cannot contain an empty square.`),u(r,"PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE",()=>$localize`A phalanx cannot contain a piece of the opponent.`),r})();class Gi extends Kn{static get(){return Gi.singleton.isAbsent()&&(Gi.singleton=g.of(new Gi)),Gi.singleton.get()}constructor(){super(dn)}static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return re.failure(n.getReason());const i=this.getLandingStatus(t,e);if(i.isFailure())return i;const s=Rt.copy(i.get()),o=t.getCurrentOpponent(),a=Gi.getCaptureValidity(t,s,e,o);return a.isFailure()?a:re.success(a.get())}static getPhalanxValidity(e,t){let n=t.coord,i=0;const s=e.getCurrentOpponent();for(;i<t.movedPieces;){if(!1===dn.isOnBoard(n))return b.failure(jo.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=e.getPieceAt(n);if(o===Y.NONE)return b.failure(jo.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===s)return b.failure(jo.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),i++}return b.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),i=e.getCurrentPlayer();let s=t.coord,o=t.coord.getNext(t.direction,t.movedPieces),a=0;for(;a+1<t.stepSize;){if(n[s.y][s.x]=Y.NONE,n[o.y][o.x]=i,!1===dn.isOnBoard(o))return re.failure(jo.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(o).isPlayer())return re.failure(jo.SOMETHING_IN_PHALANX_WAY());a++,o=o.getNext(t.direction,1),s=s.getNext(t.direction,1)}return!1===dn.isOnBoard(o)?re.failure(jo.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(o)===i?re.failure(Le.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[s.y][s.x]=Y.NONE,n[o.y][o.x]=i,re.success(n))}static getCaptureValidity(e,t,n,i){let s=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),o=0;for(;dn.isOnBoard(s)&&e.getPieceAt(s)===i;){if(o>0&&(t[s.y][s.x]=Y.NONE),o++,o>=n.movedPieces)return re.failure(jo.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());s=s.getNext(n.direction,1)}return re.success(t)}isLegal(e,t){return Gi.isLegal(e,t)}applyLegalMove(e,t,n){return new dn(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(k.ZERO,0),i=t.count(k.ONE,dn.HEIGHT-1);if(t.turn%2==0){if(n>i)return _e.ZERO_WON}else if(i>n)return _e.ONE_WON;return!1===t.doesOwnPiece(k.ZERO)?_e.ONE_WON:!1===t.doesOwnPiece(k.ONE)?_e.ZERO_WON:_e.ONGOING}}u(Gi,"singleton",g.empty());const O=Y.NONE,Z1=Y.ZERO,o1=Y.ONE;class Cce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,dn.getInitialState()),q.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new dn([[O,O,O,O,O,Z1,O,O,o1,o1,o1,o1,o1,o1],[O,O,O,O,O,Z1,O,O,O,O,O,O,o1,o1],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,o1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,Z1,Z1,Z1,Z1,O,O,O]],0)),q.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new dn([[O,O,O,O,O,Z1,O,O,O,O,o1,o1,o1,o1],[O,O,O,O,O,Z1,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,o1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,o1,o1,O,O,O,Z1,Z1,O,Z1,Z1,Z1,Z1]],1)),q.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,dn.getInitialState(),new qo(0,10,1,1,Me.UP),(t,n,i)=>1===t.movedPieces?b.SUCCESS:b.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),q.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,dn.getInitialState(),new qo(0,11,2,1,Me.UP),(t,n,i)=>t.movedPieces>1?b.SUCCESS:b.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),q.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new dn([[O,O,O,O,O,O,O,O,o1,o1,o1,o1,o1,o1],[O,O,O,O,O,O,o1,O,O,O,O,O,O,O],[O,O,O,O,O,o1,O,O,O,O,O,O,O,O],[O,O,o1,O,o1,O,O,O,O,O,O,O,O,O],[O,O,o1,o1,O,O,O,O,O,O,O,O,O,O],[O,O,o1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,Z1,O,O,O,O,O,O,O,O,O,O,O],[O,O,Z1,O,O,O,O,o1,O,O,O,O,O,O],[O,O,Z1,O,O,O,O,O,O,O,O,O,O,O],[O,O,Z1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,Z1,Z1,Z1,Z1,Z1,Z1,Z1]],0),[new qo(2,10,4,2,Me.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)])}}class yce extends Wn{getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),i=Y.NONE;let s=[];const o=e.gameState;for(const a of o.getCoordsAndContents()){const c=a.coord;if(a.content===t){let l;for(const f of Me.DIRECTIONS){let d=1,m=c.getNext(f,1);for(;dn.isOnBoard(m)&&o.getPieceAt(m)===t;)d+=1,m=m.getNext(f,1);let E=1;for(;dn.isOnBoard(m)&&E<=d&&o.getPieceAt(m)===i;)l=new qo(c.x,c.y,d,E,f),s=this.addMove(s,l,o),E++,m=m.getNext(f,1);dn.isOnBoard(m)&&E<=d&&o.getPieceAt(m)===n&&(l=new qo(c.x,c.y,d,E,f),s=this.addMove(s,l,o))}}}return s}addMove(e,t,n){return Gi.isLegal(t,n).isSuccess()&&e.push(t),e}}class Mce extends Na{getBoardValue(e){return new e1(this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){const t=13*dn.WIDTH*11;let o=0;for(let a=0;a<dn.HEIGHT;a++){let c=0;const l=[0,0];for(let f=0;f<dn.WIDTH;f++){const d=new C(f,a),m=e.getPieceAt(d);if(m.isPlayer()){const E=m.getScoreModifier();o+=t*E,l[m.value]=E,c+=E;for(const w of[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]){let R=d.getNext(w,1);for(;dn.isOnBoard(R)&&e.getPieceAt(R)===m;)o+=1*E,R=R.getNext(w,1)}}}0!==c&&(o+=Math.abs(c)/c*2),o+=1*l.reduce((f,d)=>f+d)}return o}}class odt extends Mce{constructor(...e){super(...e),u(this,"DOMINANCE_FACTOR",20),u(this,"DEFENSE_FACTOR",5),u(this,"TERRITORY_FACTOR",2),u(this,"OFFENSE_FACTOR",10),u(this,"CENTER_FACTOR",5),u(this,"MOBILITY_FACTOR",.12)}getBoardValue(e){const t=e.gameState,n=this.getDominance(t),i=this.getDefense(t),s=this.getTerritory(t),o=this.getCenter(t),a=this.getOffense(t),c=this.getMobility(t);return new e1(n+i+s+o+a+c)}getDominance(e){let t=0;for(const n of e.getCoordsAndContents())n.content.isPlayer()&&(t+=n.content.getScoreModifier());return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<dn.WIDTH;n++)e.getPieceAtXY(n,dn.HEIGHT-1)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(n,0)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(const n of e.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++){const a=n.coord.getNext(new C(s,o),1);if(dn.isOnBoard(a)){const c=e.getPieceAt(a);(c===i||c===Y.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<dn.WIDTH;n++)e.getPieceAtXY(n,0)===k.ZERO&&(t+=k.ZERO.getScoreModifier()),e.getPieceAtXY(n,dn.HEIGHT-1)===k.ONE&&(t+=k.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;const n=(dn.WIDTH-1)/2;for(const i of e.getCoordsAndContents()){const s=i.content;s.isPlayer()&&(t+=s.getScoreModifier()*Math.abs(i.coord.x-n))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,i=0;for(const s of e.getCoordsAndContents()){const o=s.coord,a=s.content;if(a.isPlayer())for(const c of Me.DIRECTIONS){let l=1,f=o.getNext(c,1);for(;dn.isOnBoard(f)&&e.getPieceAt(f)===a;)l+=1,f=f.getNext(c,1);let d=1;for(;dn.isOnBoard(f)&&d<=l&&e.getPieceAt(f)===Y.NONE;)d++,f=f.getNext(c,1);t+=d*d*a.getScoreModifier(),a===k.ZERO?n=Math.max(n,d):a===k.ONE&&(i=Math.max(i,d))}}return(t+n*k.ZERO.getScoreModifier()+i*k.ONE.getScoreModifier())*this.MOBILITY_FACTOR}}class FL extends yce{getListMoves(e){const t=super.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return en.sortByDescending(e,n=>n.movedPieces),e.length>40?e.filter(i=>!!this.moveIsCapture(i,t)||i.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}}class adt extends an{constructor(){super($localize`Attack`,Gi.get(),new odt,new FL)}}class cdt extends Na{getBoardValue(e){return new e1(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){const n=28*dn.WIDTH+1,s=444*n+1;let o=0;for(const a of e.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer()){let f,d;l===k.ZERO?(f=dn.HEIGHT-c.y,d=[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]):(f=c.y+1,d=[Me.DOWN_LEFT,Me.DOWN,Me.DOWN_RIGHT]);const m=l.getScoreModifier();o+=f*m,o+=s*m;for(const E of d){let w=c.getNext(E,1);for(;dn.isOnBoard(w)&&e.getPieceAt(w)===l;)o+=m*n,w=w.getNext(E,1)}}}return o}}class ldt extends an{constructor(){super($localize`Positional`,Gi.get(),new cdt,new FL)}}class udt extends an{constructor(){super($localize`Minimax`,Gi.get(),new Mce,new FL)}}function fdt(r,e){if(1&r){const t=pe();A(),S(0,"circle",4),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onClick(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClasses(t,n)),I("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.STROKE_WIDTH+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function ddt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",2),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),T(2,fdt,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("x",i.SPACE_SIZE*t+i.STROKE_WIDTH)("y",i.SPACE_SIZE*n+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.NONE)}}function hdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,ddt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function pdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",5),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),I("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let gdt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"NONE",Y.NONE),u(this,"firstPiece",g.empty()),u(this,"validExtensions",[]),u(this,"phalanxValidLandings",[]),u(this,"lastPiece",g.empty()),u(this,"phalanxDirection",g.empty()),u(this,"phalanxMiddles",[]),u(this,"moveds",[]),u(this,"capturedCoords",[]),this.hasAsymmetricBoard=!0,this.rules=Gi.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new udt,new ldt,new adt,new Xn($localize`MCTS`,new yce,this.rules)],this.encoder=qo.encoder,this.tutorial=(new Cce).tutorial}updateBoard(n){var i=this;return M(function*(){i.firstPiece=g.empty(),i.lastPiece=g.empty(),i.hideLastMove(),i.board=i.getState().getCopiedBoard()})()}showLastMove(n){var i=this;return M(function*(){let s=n.coord;i.moveds=[s];for(let c=1;c<n.stepSize+n.movedPieces;c++)s=s.getNext(n.direction,1),i.moveds.push(s);const o=i.node.parent.get(),a=o.gameState.getCurrentOpponent();for(;dn.isOnBoard(s)&&o.gameState.getPieceAt(s)===a;)i.capturedCoords.push(s),s=s.getNext(n.direction,1)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.firstPiece.isAbsent()?s.firstClick(n,i):s.lastPiece.isAbsent()?s.secondClick(n,i):s.thirdClick(n,i)})()}firstClick(n,i){var s=this;return M(function*(){const o=s.getState().getCurrentOpponent(),a=s.getState().getCurrentPlayer();switch(s.board[i][n]){case a:return s.firstPiece=g.of(new C(n,i)),s.validExtensions=s.getValidExtensions(a),s.phalanxValidLandings=s.getPhalanxValidLandings(),b.SUCCESS;case o:return s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE());default:return U.expectToBe(s.board[i][n],Y.NONE),s.cancelMove(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hideLastMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(n){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(n):this.getFirstPieceExtensions(n)}getFirstPieceExtensions(n){const i=[];for(const s of Me.DIRECTIONS){let o=this.firstPiece.get().getNext(s,1);for(;dn.isOnBoard(o)&&this.board[o.y][o.x]===n;)i.push(o),o=o.getNext(s,1)}return i}getPhalanxValidExtensions(n){let i=Me.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(i,1),o=this.getExtensionsToward(s,i,n);i=i.getOpposite();const a=this.firstPiece.get().getNext(i,1),c=this.getExtensionsToward(a,i,n);return o.concat(c)}getExtensionsToward(n,i,s){const o=[];for(;dn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o.push(n),n=n.getNext(i,1);return o}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const n=this.firstPiece.get(),i=this.lastPiece.get(),s=Math.abs(n.x-i.x),o=Math.abs(n.y-i.y),a=Math.max(s,o)+1;let c=Me.factory.fromMove(n,i).get();const l=i.getNext(c,1),f=this.getLandingsToward(l,c,a);c=c.getOpposite();const d=n.getNext(c,1);return this.getLandingsToward(d,c,a).concat(f)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const n=[];for(const i of Me.DIRECTIONS){const s=this.firstPiece.get().getNext(i,1);dn.isOnBoard(s)&&this.board[s.y][s.x]===Y.NONE&&n.push(s)}return n}getLandingsToward(n,i,s){const o=this.getState().getCurrentPlayer(),a=this.getState().getCurrentOpponent(),c=[];for(;dn.isOnBoard(n)&&c.length<s&&this.board[n.y][n.x]!==o;){if(this.board[n.y][n.x]===a)return this.getPhalanxLength(n,i,a)<s&&c.push(n),c;c.push(n),n=n.getNext(i,1)}return c}getPhalanxLength(n,i,s){let o=0;for(;dn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o++,n=n.getNext(i,1);return o}cancelMoveAttempt(){this.firstPiece=g.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=g.empty(),this.phalanxMiddles=[],this.hideLastMove()}secondClick(n,i){var s=this;return M(function*(){const o=new C(n,i),a=s.firstPiece.get();if(o.equals(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentOpponent(),l=s.getState().getCurrentPlayer();if(!1===o.isAlignedWith(a))return s.cancelMove(jo.SQUARE_NOT_ALIGNED_WITH_SELECTED());const f=o.getDistance(a),d=a.getDirectionToward(o).get();switch(s.board[i][n]){case Y.NONE:return 1===f?s.chooseMove(new qo(a.x,a.y,1,1,d)):s.cancelMove(jo.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(jo.SINGLE_PIECE_CANNOT_CAPTURE());default:U.expectToBe(s.board[i][n],l);const m=new qo(a.x,a.y,f,1,d),E=s.getState(),w=Gi.getPhalanxValidity(E,m);return w.isFailure()?s.cancelMove(w.getReason()):(s.lastPiece=g.of(o),s.validExtensions=s.getValidExtensions(l),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=a.getCoordsToward(o),s.phalanxDirection=g.of(d),b.SUCCESS)}})()}thirdClick(n,i){var s=this;return M(function*(){const o=s.getState().getCurrentPlayer(),a=new C(n,i);if(s.firstPiece.equalsValue(a))return s.moveFirstPiece(o);if(s.lastPiece.equalsValue(a))return s.moveLastPiece(o);const c=s.firstPiece.get(),l=s.lastPiece.get();if(!1===a.isAlignedWith(c))return s.cancelMove(jo.SQUARE_NOT_ALIGNED_WITH_PHALANX());let f=Me.factory.fromMove(c,l).get();const d=Me.factory.fromMove(c,a).get();if(f===d.getOpposite()&&(s.firstPiece=g.of(l),s.lastPiece=g.of(c),f=d),f!==d)return s.cancelMove(jo.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[i][n]===o)return s.thirdClickOnPlayerPiece(a,f,o);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,E=s.lastPiece.get().getDistance(a),w=new qo(s.firstPiece.get().x,s.firstPiece.get().y,m,E,f);return s.chooseMove(w)}})()}thirdClickOnPlayerPiece(n,i,s){var o=this;return M(function*(){o.lastPiece=g.of(n);const a=o.firstPiece.get().getDistance(n)+1,c=new qo(o.firstPiece.get().x,o.firstPiece.get().y,a,1,i),l=Gi.getPhalanxValidity(o.node.gameState,c);return l.isFailure()?o.cancelMove(l.getReason()):(o.phalanxMiddles=o.firstPiece.get().getCoordsToward(o.lastPiece.get()),o.validExtensions=o.getValidExtensions(s),o.phalanxValidLandings=o.getPhalanxValidLandings(),b.SUCCESS)})()}moveFirstPiece(n){var i=this;return M(function*(){return i.firstPiece=g.of(i.firstPiece.get().getNext(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?yield i.moveOnlyPiece(n):(i.phalanxMiddles=i.phalanxMiddles.slice(1),i.validExtensions=i.getPhalanxValidExtensions(n)),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}moveLastPiece(n){var i=this;return M(function*(){return i.lastPiece=g.of(i.lastPiece.get().getPrevious(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?i.moveOnlyPiece(n):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getPhalanxValidExtensions(n),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS)})()}moveOnlyPiece(n){var i=this;return M(function*(){return i.lastPiece=g.empty(),i.validExtensions=i.getFirstPieceExtensions(n),i.phalanxDirection=g.empty(),i.phalanxMiddles=[],i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}getPieceClasses(n,i){const s=this.getPlayerClass(this.board[i][n]);return this.getPieceStrokeClasses(n,i).concat([s])}getPieceStrokeClasses(n,i){const s=new C(n,i);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(o=>o.equals(s))?["selected-stroke"]:[]}getRectClasses(n,i){const s=new C(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:this.moveds.some(o=>o.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return!1===this.isInteractive?[]:this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const n=[],s=this.getState().getCurrentPlayer();for(let o=0;o<this.board.length;o++)for(let a=0;a<this.board[o].length;a++)this.board[o][a]===s&&n.push(new C(a,o));return n}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-epaminondas"]],features:[Xe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,hdt,2,1,"g",1),T(2,pdt,2,4,"g",1),P()),2&n&&(I("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getHighlightedCoords()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var $L,Ece,Sce;class B2{constructor(e){u(this,"capturedSpaces",void 0),U.assert(e.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),U.assert(_o.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=en.copy(e).sort((n,i)=>n.x===i.x?(U.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let t=g.empty();for(const n of this.capturedSpaces)U.assert(t.isAbsent()||1===t.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),t=g.of(n)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return _o.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!1===this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}$L=B2,u(B2,"encoder",we.tuple([we.list(C.encoder)],r=>[r.capturedSpaces],r=>new $L(r[0]))),u(B2,"listEncoder",we.list($L.encoder));class hC{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=hC.computeIntersections(e);let n=[[]];return e.forEach((i,s)=>{if(0===t[s].length)n.forEach(o=>{o.push(s)});else{const o=[],a=t[s].some(c=>c>s);for(const c of n)!0===c.some(f=>t[s].some(d=>f===d))?o.push(en.copy(c)):a?(o.push(en.copy(c)),c.push(s),o.push(en.copy(c))):(c.push(s),o.push(en.copy(c)));n=o}}),n.map(i=>i.map(s=>e[s]))}static computeIntersections(e){const t=[];return e.forEach((n,i)=>{t.push([]),e.forEach((s,o)=>{i!==o&&n.intersectsWith(s)&&t[i].push(o)})}),t}}class Zo{constructor(e,t){u(this,"coord",void 0),u(this,"direction",void 0),this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}Ece=Zo,u(Zo,"encoder",we.tuple([C.encoder,g.getEncoder(be.encoder)],r=>[r.coord,r.direction],r=>new Ece(r[0],r[1])));class za extends Hi{constructor(e,t,n){super(),u(this,"placement",void 0),u(this,"initialCaptures",void 0),u(this,"finalCaptures",void 0),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===en.compare(this.initialCaptures,e.initialCaptures)||!1===en.compare(this.finalCaptures,e.finalCaptures))}}Sce=za,u(za,"encoder",we.tuple([Zo.encoder,B2.listEncoder,B2.listEncoder],r=>[r.placement,r.initialCaptures,r.finalCaptures],r=>new Sce(r[0],r[1],r[2])));class Yo extends DL{static getInitialState(){const e=ye.EMPTY,t=ye.UNREACHABLE,n=ye.ZERO,i=ye.ONE;return new Yo([[t,t,t,i,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,n,t,t,t]],0,[12,12],[0,0])}constructor(e,t,n,i){super(t,e,7,7,[3,2,1],ye.EMPTY),u(this,"sidePieces",void 0),u(this,"capturedPieces",void 0),this.sidePieces=n,this.capturedPieces=i}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&Rt.compare(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=Rt.copy(this.board);return n[e.y][e.x]=t,new Yo(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==ye.UNREACHABLE}}let Ko=(()=>{class r{}return u(r,"CAPTURE_MUST_BE_ALIGNED",()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`),u(r,"INVALID_CAPTURED_PIECES",()=>$localize`You must select a valid capture that contains 4 pieces or more.`),u(r,"MISSING_CAPTURES",()=>$localize`There are still possible captures to be done.`),u(r,"PLACEMENT_NOT_ON_BORDER",()=>$localize`Pieces must be inserted in spaces on the edge of the board.`),u(r,"INVALID_PLACEMENT_DIRECTION",()=>$localize`You must select a valid placement direction.`),u(r,"PLACEMENT_WITHOUT_DIRECTION",()=>$localize`You must select a placement with a direction alongside the insertion space.`),u(r,"PLACEMENT_ON_COMPLETE_LINE",()=>$localize`You cannot place a piece on a complete line.`),u(r,"AMBIGUOUS_CAPTURE_COORD",()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`),u(r,"NO_DIRECTIONS_AVAILABLE",()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`),r})();class Qt extends Kn{static get(){return Qt.singleton.isAbsent()&&(Qt.singleton=g.of(new Qt)),Qt.singleton.get()}constructor(){super(Yo)}applyLegalMove(e,t,n){return new Yo(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(i=>{n=Qt.applyCapture(i,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let i=t;const s=[t.sidePieces[0],t.sidePieces[1]],o=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(a=>{const c=t.getPieceAt(a);i=i.setAt(a,ye.EMPTY),c.is(n)?s[n.value]+=1:o[n.value]+=1}),new Yo(i.board,t.turn,s,o)}static getPlacements(e){const t=[];return Ur.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===ye.EMPTY?t.push(new Zo(n,g.empty())):Qt.getAllDirectionsForEntrance(e,n).forEach(i=>{!1===Qt.isLineComplete(e,n,i)&&t.push(new Zo(n,g.of(i)))})}),t}static isLineComplete(e,t,n){return Qt.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let i=t;e.isOnBoard(i);i=i.getNext(n))if(e.getPieceAt(i)===ye.EMPTY)return g.of(i);return g.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let i=t,s=ye.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const a=e.coord;if(t.getPieceAt(a)!==ye.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,s)}else for(let a=e.coord;i.isOnBoard(a)&&s!==ye.EMPTY;a=a.getNext(e.direction.get())){const c=t.getPieceAt(a);i=i.setAt(a,s),s=c}const o=[t.sidePieces[0],t.sidePieces[1]];return o[n.value]-=1,new Yo(i.board,t.turn,o,t.capturedPieces)}getPiecesMoved(e,t,n){const i=Qt.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const s=n.direction.get(),o=[];o.push(n.coord);let a=n.coord.getNext(s);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==ye.EMPTY;)o.push(a),a=a.getNext(s);return je(i.isOnBoard(a)&&i.getPieceAt(a)===ye.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(a),o}}static getAllDirectionsForEntrance(e,t){if(Ur.INSTANCE.isTopLeftCorner(e,t))return[be.RIGHT,be.DOWN,be.UP_RIGHT];if(Ur.INSTANCE.isTopCorner(e,t))return[be.DOWN,be.DOWN_LEFT,be.RIGHT];if(Ur.INSTANCE.isTopRightCorner(e,t))return[be.DOWN_LEFT,be.DOWN,be.LEFT];if(Ur.INSTANCE.isBottomLeftCorner(e,t))return[be.UP_RIGHT,be.UP,be.RIGHT];if(Ur.INSTANCE.isBottomCorner(e,t))return[be.UP,be.LEFT,be.UP_RIGHT];if(Ur.INSTANCE.isBottomRightCorner(e,t))return[be.LEFT,be.UP,be.DOWN_LEFT];if(Ur.INSTANCE.isOnTopLeftBorder(e,t))return[be.RIGHT,be.DOWN];if(Ur.INSTANCE.isOnLeftBorder(e,t))return[be.UP_RIGHT,be.RIGHT];if(Ur.INSTANCE.isOnBottomLeftBorder(e,t))return[be.UP,be.UP_RIGHT];if(Ur.INSTANCE.isOnBottomRightBorder(e,t))return[be.LEFT,be.UP];if(Ur.INSTANCE.isOnRightBorder(e,t))return[be.LEFT,be.DOWN_LEFT];if(Ur.INSTANCE.isOnTopRightBorder(e,t))return[be.DOWN_LEFT,be.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=Qt.applyCaptures(e.initialCaptures,t),s=this.noMoreCapturesValidity(i);if(s.isFailure())return s.toOtherFallible();const o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toOtherFallible();const a=Qt.applyPlacement(e.placement,i),c=this.capturesValidity(a,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=Qt.applyCaptures(e.finalCaptures,a),f=this.noMoreCapturesValidity(l);return f.isFailure()?f.toOtherFallible():re.success(l)}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=Qt.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),i=Qt.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(i.isAbsent())return b.failure(Ko.CAPTURE_MUST_BE_ALIGNED());const s=i.get();return Qt.getCapturable(e,s).equals(t)?b.SUCCESS:b.failure(Ko.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=Qt.getLinePortionWithFourPiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let a=s;for(let c=s;e.isOnBoard(c);c=c.getNext(o))if(e.getPieceAt(c).is(t)?(0===i&&(a=c),i+=1):i=0,4===i)return g.of({0:a,1:c,2:o});return g.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(Ko.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==ye.EMPTY){if(t.direction.isAbsent())return b.failure(Ko.PLACEMENT_WITHOUT_DIRECTION());if(Qt.isLineComplete(e,t.coord,t.direction.get()))return b.failure(Ko.PLACEMENT_ON_COMPLETE_LINE());for(const i of Qt.getAllDirectionsForEntrance(e,t.coord))if(i===t.direction.get())return b.SUCCESS;return b.failure(Ko.INVALID_PLACEMENT_DIRECTION())}return b.SUCCESS}placementCoordValidity(e,t){return Ur.INSTANCE.isOnBorder(e,t)?b.SUCCESS:b.failure(Ko.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],i=t[0],s=t[1],o=t[2],a=o.getOpposite();let c=i.getNext(a);for(;e.isOnBoard(c)&&e.getPieceAt(c)!==ye.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(s);l=l.getNext(o))n.push(l);for(let l=s;e.isOnBoard(l)&&e.getPieceAt(l)!==ye.EMPTY;l=l.getNext(o))n.push(l);return new B2(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(i=>{n.push(Qt.getCapturable(e,i))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===Qt.getPossibleCaptures(e).length)return g.empty();const i=e.getNumberOfPiecesCaptured(t);return g.of(n+3*i)}static isGameOver(e){const t=Qt.getPlayerScore(e,k.ZERO),n=Qt.getPlayerScore(e,k.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=Qt.getPlayerScore(t,k.ZERO),i=Qt.getPlayerScore(t,k.ONE);return n.isAbsent()?_e.ONE_WON:i.isAbsent()?_e.ZERO_WON:_e.ONGOING}}u(Qt,"singleton",g.empty());class Pce{constructor(e,t,n,i,s,o){u(this,"source",void 0),u(this,"destination",void 0),u(this,"x1",void 0),u(this,"y1",void 0),u(this,"x2",void 0),u(this,"y2",void 0),this.source=e,this.destination=t,this.x1=n,this.y1=i,this.x2=s,this.y2=o}}const On=ye.UNREACHABLE,Ke=ye.EMPTY,Y1=ye.ZERO,$c=ye.ONE;class Tce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Yo.getInitialState()),q.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Yo.getInitialState(),new za(new Zo(new C(3,0),g.of(be.DOWN)),[],[]),$localize`Congratulations!`),q.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Yo([[On,On,On,Y1,$c,Ke,Ke],[On,On,Ke,Ke,Ke,Ke,Ke],[On,Ke,Ke,Ke,Ke,Ke,Ke],[Y1,Y1,Y1,Ke,Ke,Ke,Ke],[$c,Ke,Ke,Ke,Ke,Ke,On],[Ke,Ke,Ke,$c,Ke,On,On],[Ke,Ke,Ke,$c,On,On,On]],42,[8,8],[0,0]),[new za(new Zo(new C(0,3),g.of(be.RIGHT)),[],[new B2([new C(0,3),new C(1,3),new C(2,3),new C(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),q.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Yo([[On,On,On,Ke,Ke,Ke,Ke],[On,On,Ke,$c,Ke,Ke,Ke],[On,Ke,Ke,Y1,Ke,Ke,Ke],[Y1,Y1,Y1,$c,Ke,Ke,Ke],[Ke,Ke,Ke,Y1,Ke,Ke,On],[Ke,Ke,Ke,Y1,Ke,On,On],[Ke,Ke,Ke,$c,On,On,On]],42,[8,4],[2,3]),[new za(new Zo(new C(0,3),g.of(be.RIGHT)),[],[new B2([new C(3,1),new C(3,2),new C(3,3),new C(3,4),new C(3,5),new C(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),q.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Yo([[On,On,On,Y1,Ke,Ke,Y1],[On,On,Ke,Y1,Ke,Ke,Y1],[On,Y1,Y1,Ke,Y1,$c,Y1],[Ke,Ke,Ke,Y1,Ke,Ke,Y1],[Ke,Ke,Ke,Y1,Ke,Ke,On],[Y1,Y1,Y1,$c,$c,On,On],[Ke,Ke,Ke,Y1,On,On,On]],42,[3,4],[2,3]),[new za(new Zo(new C(3,6),g.of(be.UP)),[new B2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new B2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new B2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)])]),new za(new Zo(new C(4,6),g.of(be.UP)),[new B2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new B2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new B2([new C(3,0),new C(3,1),new C(3,2),new C(3,3),new C(3,4)])]),new za(new Zo(new C(3,6),g.of(be.UP)),[new B2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new B2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)]),new B2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)])}}class Oce extends Wn{getListMoves(e){const t=e.gameState,n=[];return Qt.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(i=>{const s=Qt.applyCaptures(i,t);Qt.getPlacements(s).forEach(o=>{const a=Qt.applyPlacement(o,s);this.getPossibleCaptureCombinations(a).forEach(c=>{const l=new za(o,i,c);n.push(l)})})}),n}getPossibleCaptureCombinations(e){const t=Qt.getPossibleCaptures(e);return hC.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class mdt extends dr{getMetrics(e){const t=e.gameState;return[Qt.getPlayerScore(t,k.ZERO).get(),Qt.getPlayerScore(t,k.ONE).get()]}}function _dt(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClass(t)),I("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function vdt(r,e){if(1&r){const t=pe();A(),S(0,"g",10),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),F(1,"polygon",11),T(2,_dt,1,4,"circle",12),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","click_",t.x,"_",t.y,""),_(1),Ce("id","space_",t.x,"_",t.y,""),y("ngClass",n.getSpaceClass(t)),I("points",n.getHexaPointsAt(t)),_(1),y("ngIf",n.isPiece(t))}}function Cdt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",16),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s))}),P()}if(2&r){const t=e.$implicit;I("points",p(2).getHexaPointsAt(t))}}function ydt(r,e){if(1&r&&(A(),S(0,"g",14),T(1,Cdt,1,1,"polygon",15),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.capturedSpaces)}}function Mdt(r,e){if(1&r){const t=pe();A(),S(0,"line",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.destination))}),P()}if(2&r){const t=e.$implicit;I("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function Edt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",18),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),Ce("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),I("cx",i.getRemainingPieceCx(n,t))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function Sdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Edt,2,6,"g",8),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function Pdt(r,e){if(1&r&&(A(),F(0,"line",19)),2&r){const t=p();I("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let Tdt=(()=>{var r;class e extends lu{constructor(n){super(n),u(this,"inserted",g.empty()),u(this,"arrows",[]),u(this,"captured",[]),u(this,"moved",[]),u(this,"hexagonWidth",this.SPACE_SIZE),u(this,"sharedHexagonX",Math.cos(30)*this.hexagonWidth*.5),u(this,"boardWidth",this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2),u(this,"boardHeight",7*this.hexagonWidth+4.5*this.STROKE_WIDTH),u(this,"movePhase",e.PHASE_PLACEMENT_COORD),u(this,"constructedState",void 0),u(this,"possibleCaptures",[]),u(this,"initialCaptures",[]),u(this,"placement",g.empty()),u(this,"placementEntrance",g.empty()),u(this,"finalCaptures",[]),this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.rules=Qt.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Score`,this.rules,new mdt,new Oce),new Xn($localize`MCTS`,new Oce,this.rules)],this.encoder=za.encoder,this.tutorial=(new Tce).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new uu(1.5*this.SPACE_SIZE,new C(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Ur.INSTANCE)}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){if(i.inserted=g.empty(),n.placement.direction.isPresent()){const s=n.placement;i.inserted=g.of(i.arrowTowards(s.coord,s.direction.get()))}i.cancelMoveAttempt()})()}arrowTowards(n,i){const s=n.getNext(i.getOpposite()),o=this.getCenterAt(n),a=this.getCenterAt(s);return new Pce(s,n,a.x,a.y,o.x,o.y)}markCapture(n){n.forEach(i=>{this.captured.push(i)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(n){const i=this.constructedState.getNumberOfPiecesToPlace(n),s=[];for(let o=0;o<i;o+=1)s.push(o);return s}isPiece(n){return this.getPiece(n)!==ye.EMPTY}getPiece(n){return this.constructedState.getPieceAt(n)}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());switch(i.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return i.selectCapture(n);case e.PHASE_PLACEMENT_COORD:return i.selectPlacementCoord(n);default:return U.expectToBe(i.movePhase,e.PHASE_PLACEMENT_DIRECTION),i.selectPlacementDirectionOrPlacementCoord(n)}})()}selectCapture(n){var i=this;return M(function*(){const s=[];if(i.possibleCaptures.forEach(a=>{a.contains(n)&&s.push(a)}),s.length>1)return i.cancelMove(Ko.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return i.cancelMove(Ko.MISSING_CAPTURES());const o=s[0];return i.constructedState=Qt.applyCapture(o,i.constructedState),i.markCapture(o),i.possibleCaptures=Qt.getPossibleCaptures(i.constructedState),i.movePhase===e.PHASE_INITIAL_CAPTURE?(i.initialCaptures.push(o),0===i.possibleCaptures.length?i.moveToPlacementPhase():b.SUCCESS):(U.expectToBe(i.movePhase,e.PHASE_FINAL_CAPTURE),i.finalCaptures.push(o),0===i.possibleCaptures.length?i.tryMove(i.initialCaptures,i.placement.get(),i.finalCaptures):b.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,b.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Qt.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,b.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var n=this;return M(function*(){return n.possibleCaptures=Qt.getPossibleCaptures(n.constructedState),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):(n.movePhase=e.PHASE_FINAL_CAPTURE,b.SUCCESS)})()}computeArrows(n){this.arrows=[];for(const i of Qt.getAllDirectionsForEntrance(this.constructedState,n))if(!1===Qt.isLineComplete(this.constructedState,n,i)){const s=n.getNext(i),o=this.getCenterAt(n),a=this.getCenterAt(s);this.arrows.push(new Pce(n,s,o.x,o.y,a.x,a.y))}}selectPlacementCoord(n){var i=this;return M(function*(){const s=i.rules.placementCoordValidity(i.constructedState,n);return s.isFailure()?i.cancelMove(s.getReason()):i.placementEntrance.equalsValue(n)?(i.cancelMoveAttempt(),b.SUCCESS):(i.placementEntrance=g.of(n),i.constructedState.getPieceAt(n)===ye.EMPTY?i.selectPlacementDirection(g.empty()):(i.movePhase=e.PHASE_PLACEMENT_DIRECTION,i.computeArrows(n),0===i.arrows.length&&(yield i.cancelMove(Ko.NO_DIRECTIONS_AVAILABLE())),b.SUCCESS))})()}selectPlacementDirection(n){var i=this;return M(function*(){i.placement=g.of(new Zo(i.placementEntrance.get(),n));const s=i.rules.placementValidity(i.constructedState,i.placement.get());return s.isFailure()?i.cancelMove(s.getReason()):(i.arrows=[],i.constructedState=Qt.applyPlacement(i.placement.get(),i.constructedState),i.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(n){var i=this;return M(function*(){const s=i.placementEntrance.get();if(!1===s.isAlignedWith(n)||1!==s.getDistance(n))return i.selectPlacementCoord(n);const o=be.factory.fromMove(s,n);return i.selectPlacementDirection(o.toOptional())})()}tryMove(n,i,s){const o=new za(i,n,s);return this.chooseMove(o)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const n=this.node.previousMove;if(n.isPresent()){const i=n.get(),s=this.getPreviousState();i.initialCaptures.forEach(o=>this.markCapture(o)),i.finalCaptures.forEach(o=>this.markCapture(o)),this.moved=this.rules.getPiecesMoved(s,i.initialCaptures,i.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=g.empty(),this.placement=g.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(n){return this.captured.some(i=>i.equals(n))?"captured-fill":this.moved.some(i=>i.equals(n))?"moved-fill":""}getPieceClass(n){const i=this.getPiece(n);return this.getPlayerClass(k.of(i.value))}getRemainingPieceCy(n){return n===k.ONE?25:this.boardHeight-25}getRemainingPieceCx(n,i){const s=20+i*this.SPACE_SIZE*.5;return n===k.ONE?s:this.boardWidth-(15+s)}}return r=e,u(e,"PHASE_INITIAL_CAPTURE",0),u(e,"PHASE_PLACEMENT_COORD",1),u(e,"PHASE_PLACEMENT_DIRECTION",2),u(e,"PHASE_FINAL_CAPTURE",3),u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-gipf"]],features:[Xe],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),P(),S(4,"marker",3),F(5,"polygon",4),P()(),T(6,vdt,3,7,"g",5),T(7,ydt,2,1,"g",6),T(8,Mdt,1,4,"line",7),T(9,Sdt,2,1,"g",8),T(10,Pdt,1,4,"line",9),P()),2&n&&(I("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),_(6),y("ngForOf",i.getAllCoords()),_(1),y("ngForOf",i.possibleCaptures),_(1),y("ngForOf",i.arrows),_(1),y("ngForOf",i.Player.PLAYERS),_(1),y("ngIf",i.inserted.isPresent()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var pC,Il;class rr extends wr{static of(e){return new rr(e.x,e.y)}toString(){return this===rr.PASS?"GoMove.PASS":this===rr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}u(rr,"PASS",new(pC=rr)(-1,0)),u(rr,"ACCEPT",new pC(-2,0)),u(rr,"encoder",wr.getEncoder(pC.of));class ke{constructor(e,t){u(this,"player",void 0),u(this,"type",void 0),this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case ke.DARK:return"GoPiece.DARK";case ke.LIGHT:return"GoPiece.LIGHT";case ke.EMPTY:return"GoPiece.EMPTY";case ke.DEAD_DARK:return"GoPiece.DEAD_DARK";case ke.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case ke.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return je(this===ke.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===k.ZERO?ke.DARK:ke.LIGHT}isOccupied(){return[ke.DARK,ke.LIGHT,ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isEmpty(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY,ke.EMPTY].includes(this)}isDead(){return[ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isTerritory(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return je(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),ke.EMPTY}}u(ke,"DARK",new(Il=ke)(k.ZERO,"alive")),u(ke,"LIGHT",new Il(k.ONE,"alive")),u(ke,"EMPTY",new Il(Y.NONE,"empty")),u(ke,"DEAD_DARK",new Il(k.ZERO,"dead")),u(ke,"DEAD_LIGHT",new Il(k.ONE,"dead")),u(ke,"DARK_TERRITORY",new Il(Y.NONE,"territory")),u(ke,"LIGHT_TERRITORY",new Il(Y.NONE,"territory"));var hn=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(hn||{});let Ar=(()=>{class r extends q1{constructor(t,n,i,s,o){super(t,i),u(this,"koCoord",void 0),u(this,"captured",void 0),u(this,"phase",void 0),this.captured=n,this.koCoord=s,this.phase=o}static getInitialState(){const t=r.getStartingBoard();return new r(t,[0,0],0,g.empty(),hn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Rt.create(r.WIDTH,r.HEIGHT,ke.EMPTY)}copy(){return new r(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(t){return this.getPieceAt(t).isDead()}isTerritory(t){return this.getPieceAt(t).isTerritory()}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();const Ue=ke.LIGHT,Ve=ke.DARK,GL=ke.DEAD_LIGHT,vu=ke.LIGHT_TERRITORY,Xo=ke.DARK_TERRITORY,le=ke.EMPTY;class bce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Ar.getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Ar([[le,Ve,le,le,Ue,Ue],[le,Ve,le,le,Ue,le],[le,Ve,Ve,Ue,Ue,le],[le,le,Ve,Ue,le,le],[le,le,Ve,Ue,le,le],[le,le,Ve,Ue,le,le]],[0,0],0,g.empty(),hn.PLAYING)),q.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Ar([[le,le,le,le,le],[le,le,Ve,le,le],[le,Ve,Ue,le,le],[le,le,Ve,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),hn.PLAYING),[new rr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),q.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Ar([[le,Ve,le,le,le],[Ve,Ue,le,le,le],[Ve,Ue,Ue,Ve,le],[le,Ve,Ve,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),hn.PLAYING),[new rr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),q.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Ar([[le,Ve,le,le,le],[Ve,le,le,le,le],[Ve,le,le,le,Ue],[Ue,Ve,le,Ue,le],[le,Ue,le,Ue,Ve]],[0,0],0,g.empty(),hn.PLAYING)),q.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Ar([[le,le,le,le,le],[Ve,Ve,Ve,le,le],[Ue,Ue,Ve,le,le],[le,Ue,Ve,le,le],[Ue,Ue,Ve,le,le]],[0,0],0,g.empty(),hn.PLAYING)),q.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Ar([[le,Ve,Ue,le,le],[Ue,Ve,Ue,le,le],[Ve,Ve,Ue,le,le],[Ue,Ve,Ue,le,le],[le,Ve,Ue,le,le]],[0,0],0,g.empty(),hn.PLAYING)),q.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Ar([[le,Ue,Ve,le,Ue,Ve,le],[le,Ue,Ve,Ve,Ue,Ve,le],[le,Ue,Ve,Ve,Ue,Ve,le],[le,Ue,Ve,Ve,Ue,Ve,le],[le,Ue,Ve,Ue,Ue,Ve,le],[le,Ue,Ve,Ue,Ue,Ve,le],[le,Ue,Ve,le,Ue,Ve,le]],[0,0],0,g.empty(),hn.PLAYING)),q.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Ar([[le,le,le,le,le,le,le],[le,le,le,le,le,le,le],[le,le,le,Ve,Ue,le,le],[le,le,Ve,Ue,le,Ue,le],[le,le,le,Ve,Ue,le,le],[le,le,le,le,le,le,le],[le,le,le,le,le,le,le]],[0,0],0,g.empty(),hn.PLAYING),[new rr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),q.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Ar([[Ue,Ve,Ve,Ve,Ve,Ve,Xo,Xo,Xo],[Ue,Ue,Ue,Ue,Ve,Ve,Ve,Xo,Xo],[Ue,vu,Ue,Ue,Ve,GL,GL,Ve,Xo],[Ve,Ue,Ue,Ue,Ue,Ve,Xo,Xo,Xo],[le,Ue,vu,Ue,Ve,Ve,GL,Ve,Xo],[Ue,vu,Ue,Ue,Ve,Ve,Ve,Ve,Ve],[Ue,Ue,Ve,Ve,Ve,Ue,Ue,Ve,Ue],[Ve,Ve,Ve,Ue,Ue,Ue,vu,Ue,Ue],[Xo,Xo,Ve,Ve,Ve,Ue,Ue,vu,vu]],[0,0],0,g.empty(),hn.COUNTING),[new rr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)])}}let BL=class{getGroupDatas(e,t){const i=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,i)}_getGroupDatas(e,t,n){const i=t[e.y][e.x];if(n.addPawn(e,i),i===n.color)for(const s of this.getDirections()){const o=e.getNext(s);o.isInRange(t[0].length,t.length)&&!1===n.contains(o)&&(n=this._getGroupDatas(o,t,n))}return n}};BL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],BL);class Cu{constructor(e){u(this,"color",void 0),this.color=e}selfContains(e){return this.getCoords().some(n=>n.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class wdt extends Cu{constructor(e,t,n,i,s,o){super(e),u(this,"emptyCoords",void 0),u(this,"darkCoords",void 0),u(this,"lightCoords",void 0),u(this,"deadDarkCoords",void 0),u(this,"deadLightCoords",void 0),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=s,this.deadLightCoords=o}getCoords(){return this.color===ke.DARK?this.darkCoords:this.color===ke.LIGHT?this.lightCoords:this.color===ke.DEAD_DARK?this.deadDarkCoords:this.color===ke.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(e))}addPawn(e,t){switch(je(!1===this.contains(e),"This group already contains "+e.toString()),t){case ke.DARK:this.darkCoords=Cu.insertAsEntryPoint(this.darkCoords,e);break;case ke.LIGHT:this.lightCoords=Cu.insertAsEntryPoint(this.lightCoords,e);break;case ke.DEAD_DARK:this.deadDarkCoords=Cu.insertAsEntryPoint(this.deadDarkCoords,e);break;case ke.DEAD_LIGHT:this.deadLightCoords=Cu.insertAsEntryPoint(this.deadLightCoords,e);break;default:U.expectToBeMultiple(t,[ke.EMPTY,ke.DARK_TERRITORY,ke.LIGHT_TERRITORY]),this.emptyCoords=Cu.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new Sn;e.set(ke.EMPTY,this.emptyCoords.length),e.set(ke.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(ke.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((n,i)=>i>0);if(1===t.size())return t.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==ke.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==ke.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==ke.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==ke.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==ke.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class Dd extends BL{getNewInstance(e){return new wdt(e,[],[],[],[],[])}getDirections(){return Re.ORTHOGONALS}}let Hd=(()=>{class r{}return u(r,"ILLEGAL_KO",()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`),u(r,"CANNOT_PASS_AFTER_PASSED_PHASE",()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`),u(r,"CANNOT_ACCEPT_BEFORE_COUNTING_PHASE",()=>$localize`You cannot accept before the counting phase.`),u(r,"OCCUPIED_INTERSECTION",()=>$localize`This intersection is already occupied.`),u(r,"CANNOT_COMMIT_SUICIDE",()=>$localize`You cannot commit suicide.`),r})();var gC,_n;let Gc=(gC=class extends Kn{static get(){return _n.singleton.isAbsent()&&(_n.singleton=g.of(new _n)),_n.singleton.get()}constructor(){super(Ar)}static isLegal(e,t){if(_n.isPass(e)){const n=t.phase===hn.PLAYING,i=t.phase===hn.PASSED;return Ne.display("GoRules","isLegal","at "+t.phase+(n||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),n||i?re.success([]):re.failure(Hd.CANNOT_PASS_AFTER_PASSED_PHASE())}return _n.isAccept(e)?t.phase===hn.COUNTING||t.phase===hn.ACCEPT?re.success([]):re.failure(Hd.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):_n.isOccupied(e.coord,t.getCopiedBoard())?(Ne.display("GoRules","isLegal","move is marking"),_n.isLegalDeadMarking(e,t)?re.success([]):re.failure(Hd.OCCUPIED_INTERSECTION())):(Ne.display("GoRules","isLegal","move is normal stuff: "+e.toString()),_n.isLegalNormalMove(e,t))}static getNewKo(e,t,n){if(1===n.length){const i=n[0],s=e.coord,o=t[s.y][s.x],c=(new Dd).getGroupDatas(s,t),l=c.emptyCoords,f=ke.pieceBelongTo(o,k.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===f.length)return g.of(i)}return g.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),n=_n.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const s of n){const o=s.getWrapper();if(o===ke.LIGHT){i[1]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=ke.LIGHT_TERRITORY}else{je(o===ke.DARK,"territory should be wrapped by dark or light, not by "+o.toString()),i[0]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=ke.DARK_TERRITORY}}return new Ar(t,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let i;for(let s=0;s<e.board.length;s++)for(let o=0;o<e.board[0].length;o++)i=t[s][o],i===ke.DARK_TERRITORY?(t[s][o]=ke.EMPTY,n[0]=n[0]-1):i===ke.LIGHT_TERRITORY&&(t[s][o]=ke.EMPTY,n[1]=n[1]-1);return new Ar(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return _n.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let i,s,o;const a=new Dd;for(let c=0;c<e.length;c++)for(let l=0;l<e[0].length;l++)i=new C(l,c),o=e[c][l],t(o)&&!1===n.some(f=>f.selfContains(i))&&(s=a.getGroupDatas(i,e),n.push(s));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let s,n=t[1],i=t[0];for(let o=0;o<e.board.length;o++)for(let a=0;a<e.board[0].length;a++)s=e.getPieceAtXY(a,o),s===ke.DEAD_DARK?n++:s===ke.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(e,t){const n=t.getCopiedBoard();je(n[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const o=(new Dd).getGroupDatas(e,n),a=t.getCapturedCopy();switch(o.color){case ke.DEAD_DARK:a[1]-=2*o.deadDarkCoords.length;for(const c of o.deadDarkCoords)n[c.y][c.x]=ke.DARK;break;case ke.DEAD_LIGHT:a[0]-=2*o.deadLightCoords.length;for(const c of o.deadLightCoords)n[c.y][c.x]=ke.LIGHT;break;case ke.LIGHT:a[0]+=2*o.lightCoords.length;for(const c of o.lightCoords)n[c.y][c.x]=ke.DEAD_LIGHT;break;default:U.expectToBe(o.color,ke.DARK),a[1]+=2*o.darkCoords.length;for(const c of o.darkCoords)n[c.y][c.x]=ke.DEAD_DARK}return new Ar(n,a,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===hn.FINISHED?t.captured[0]>t.captured[1]?_e.ZERO_WON:t.captured[1]>t.captured[0]?_e.ONE_WON:_e.DRAW:_e.ONGOING}static isPass(e){return e.equals(rr.PASS)}static isAccept(e){return e.equals(rr.ACCEPT)}static isLegalDeadMarking(e,t){return _n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===hn.COUNTING||t.phase===hn.ACCEPT)}static isLegalNormalMove(e,t){const n=t.getCopiedBoard();if(_n.isKo(e,t))return re.failure(Hd.ILLEGAL_KO());[hn.COUNTING,hn.ACCEPT].includes(t.phase)&&(t=_n.resurrectStones(t));const i=_n.getCaptureState(e,t);if(Nce.isCapturing(i))return re.success(i.capturedCoords);{n[e.coord.y][e.coord.x]=t.turn%2==0?ke.DARK:ke.LIGHT;const a=0===(new Dd).getGroupDatas(e.coord,n).emptyCoords.length;return n[e.coord.y][e.coord.x]=ke.EMPTY,a?re.failure(Hd.CANNOT_COMMIT_SUICIDE()):re.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const n=new Nce;let i;for(const s of Re.ORTHOGONALS)i=_n.getCapturedInDirection(e.coord,s,t),i.length>0&&n.capturedCoords.every(o=>!1===i[0].equals(o))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(e,t,n){const i=n.getCopiedBoard(),s=e.getNext(t);if(s.isInRange(n.board[0].length,n.board.length)&&i[s.y][s.x]===(n.turn%2==0?ke.LIGHT:ke.DARK)){Ne.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new Dd).getGroupDatas(s,i);if(_n.isCapturableGroup(c,n.koCoord))return Ne.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return _n.getEmptyZones(e).filter(n=>n.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy(),i=e.turn;let s,o;return e.phase===hn.PASSED?(s=hn.COUNTING,o=new Ar(t,n,i+1,g.empty(),s),o=_n.markTerritoryAndCount(o)):(je(e.phase===hn.PLAYING,"Cannot pass in counting phase!"),s=hn.PASSED,o=new Ar(t,n,i+1,g.empty(),s)),o}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===hn.COUNTING?hn.ACCEPT:hn.FINISHED,new Ar(t,e.getCapturedCopy(),e.turn+1,g.empty(),n)}static applyNormalLegalMove(e,t,n){let i;i=[hn.COUNTING,hn.ACCEPT].includes(t.phase)?_n.resurrectStones(t):t.copy();const s=e.coord.x,o=e.coord.y,a=i.getCopiedBoard(),c=i.turn,l=ke.ofPlayer(i.getCurrentPlayer()),f=c+1;a[o][s]=l;for(const E of n)a[E.y][E.x]=ke.EMPTY;const d=_n.getNewKo(e,a,n),m=i.getCapturedCopy();return m[l.player.value]+=n.length,new Ar(a,m,f,d,hn.PLAYING)}static resurrectStones(e){for(let t=0;t<e.board.length;t++)for(let n=0;n<e.board[0].length;n++)e.getPieceAtXY(n,t).isDead()&&(e=_n.switchAliveness(new C(n,t),e));return _n.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const n=_n.removeAndSubstractTerritory(t),i=_n.switchAliveness(e.coord,n),s=new Ar(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,g.empty(),hn.COUNTING);return _n.markTerritoryAndCount(s)}isLegal(e,t){return _n.isLegal(e,t)}applyLegalMove(e,t,n){return _n.isPass(e)?(Ne.display("GoRules","applyLegalMove","isPass"),_n.applyPass(t)):_n.isAccept(e)?(Ne.display("GoRules","applyLegalMove","isAccept"),_n.applyLegalAccept(t)):_n.isLegalDeadMarking(e,t)?(Ne.display("GoRules","applyLegalMove","isDeadMarking"),_n.applyDeadMarkingMove(e,t)):(Ne.display("GoRules","applyLegalMove","else it is normal move"),_n.applyNormalLegalMove(e,t,n))}getGameStatus(e){return _n.getGameStatus(e)}},_n=gC,u(gC,"singleton",g.empty()),gC);Gc=_n=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Gc);class Nce{constructor(){u(this,"capturedCoords",[])}static isCapturing(e){return e.capturedCoords.length>0}}class Adt extends dr{getMetrics(e){const t=Gc.markTerritoryAndCount(e.gameState),n=t.getCapturedCopy(),i=this.getDeadStones(t);return[n[0]+2*i[1],n[1]+2*i[0]]}getDeadStones(e){const t=[0,0];for(let n=0;n<e.board.length;n++)for(let i=0;i<e.board[0].length;i++){const s=e.getPieceAtXY(i,n);"dead"===s.type&&(t[s.player.value]=t[s.player.value]+1)}return t}}let mC=class extends Wn{getListMoves(e){const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===hn.PLAYING||t.phase===hn.PASSED)return n.push(rr.PASS),n;{const i=this.getCountingMovesList(t);return 0===i.length?[rr.ACCEPT]:i}}getPlayingMovesList(e){const t=[];let n;for(let i=0;i<e.board.length;i++)for(let s=0;s<e.board[0].length;s++)n=new rr(s,i),e.getPieceAt(n.coord)===ke.EMPTY&&Gc.isLegal(n,e).isSuccess()&&t.push(n);return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),i=Gc.getGroupsDatasWhere(n,s=>s!==ke.EMPTY);for(const s of i){const o=s.getCoords()[0],a=n[o.y][o.x];if(e.getPieceAt(o)!==a){const l=new rr(o.x,o.y);return t.push(l),t}}return t}getCorrectBoard(e){const n=this.mapBoard(e.getCopiedBoard(),o=>o===ke.DARK?ke.DEAD_DARK:o===ke.LIGHT?ke.DEAD_LIGHT:o.isTerritory()?ke.EMPTY:o),i=new Ar(n,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),s=Gc.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,s)}mapBoard(e,t){const n=[];for(let i=0;i<e.length;i++){n[i]=[];for(let s=0;s<e[0].length;s++)n[i][s]=t(e[i][s])}return n}setAliveUniqueWrapper(e,t){let i,n=e.copy();for(const s of t){i=s.deadDarkCoords.concat(s.deadLightCoords);for(const o of i)n.isDead(o)&&(n=Gc.switchAliveness(o,n))}return n}};var yu;function xdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),S(2,"line",9),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),S(3,"line",9),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","click_",t,"_",n,""),I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function Ldt(r,e){if(1&r&&(A(),S(0,"g"),T(1,xdt,4,14,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Rdt(r,e){if(1&r){const t=pe();A(),S(0,"circle",10),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","hoshi_",t.x,"_",t.y,""),I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.1*n.SPACE_SIZE)}}function zdt(r,e){if(1&r&&(A(),F(0,"circle",16)),2&r){const t=p(2).index,n=p().index,i=p();I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function Ddt(r,e){if(1&r){const t=pe();A(),S(0,"line",17),W("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onClick(i,s))}),P()}if(2&r){const t=p(2).index,n=p().index,i=p();I("x1",.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function Hdt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",13),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onClick(i,s))}),P(),T(2,zdt,1,3,"circle",14),T(3,Ddt,1,4,"line",15),P()}if(2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE),_(1),y("ngIf",i.isLastSpace(t,n)),_(1),y("ngIf",i.isDead(t,n))}}function Vdt(r,e){if(1&r){const t=pe();A(),S(0,"circle",19),W("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onClick(i,s))}),P()}if(2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();I("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*n)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*s)("r",.1*o.SPACE_SIZE)("class",i===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function Fdt(r,e){if(1&r&&(A(),T(0,Vdt,1,4,"circle",18)),2&r){const t=p().index,n=p().index;y("ngIf",p().isTerritory(t,n))}}function $dt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Hdt,4,6,"g",11),T(2,Fdt,1,1,"ng-template",null,12,fn),P()),2&r){const t=e.index,n=ln(3),i=p().index,s=p();_(1),y("ngIf",s.spaceIsFull(t,i))("ngIfElse",n)}}function Gdt(r,e){if(1&r&&(A(),S(0,"g"),T(1,$dt,4,2,"g",3),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Bdt(r,e){if(1&r&&(A(),F(0,"rect",20)),2&r){const t=p();I("width",.25*t.SPACE_SIZE)("height",.25*t.SPACE_SIZE)("x",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().x)("y",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().y)}}function Udt(r,e){if(1&r){const t=pe();A(),S(0,"circle",21),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}mC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],mC);let UL=(yu=class extends xL{constructor(e){super(e),u(this,"boardInfo",void 0),u(this,"ko",g.empty()),u(this,"last",g.empty()),u(this,"captures",[]),u(this,"GoPiece",ke),u(this,"boardHeight",Ar.HEIGHT),u(this,"boardWidth",Ar.WIDTH),this.scores=g.of([0,0]),this.rules=Gc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,Gc.get(),new Adt,new mC),new Xn($localize`MCTS`,new mC,this.rules)],this.encoder=rr.encoder,this.tutorial=(new bce).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.last=g.empty();const s=new rr(e,t);return n.chooseMove(s)})()}updateBoard(e){var t=this;return M(function*(){const n=t.getState(),i=t.node.previousMove,s=n.phase;t.board=n.getCopiedBoard(),t.scores=g.of(n.getCapturedCopy()),t.ko=n.koCoord,i.isPresent()?t.showCaptures():t.captures=[],t.last=i.map(o=>o.coord),t.canPass=s!==hn.FINISHED,t.createHoshis()})()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t),s=e.getPieceAt(i).isOccupied(),o=this.board[t][n]===ke.EMPTY,a=!1===this.ko.equalsValue(i);s&&o&&a&&this.captures.push(i)}}pass(){var e=this;return M(function*(){const t=e.getState().phase;return t===hn.PLAYING||t===hn.PASSED?e.onClick(rr.PASS.coord.x,rr.PASS.coord.y):(je(t===hn.COUNTING||t===hn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(rr.ACCEPT.coord.x,rr.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==ke.EMPTY&&!1===this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.getState().isDead(new C(e,t))}isTerritory(e,t){return this.getState().isTerritory(new C(e,t))}},u(yu,"\u0275fac",function(e){return new(e||yu)(B(Ut))}),u(yu,"\u0275cmp",We({type:yu,selectors:[["app-go"]],features:[Xe],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),F(1,"rect",1),S(2,"g",2),T(3,Ldt,2,1,"g",3),T(4,Rdt,1,5,"circle",4),P(),S(5,"g",5),T(6,Gdt,2,1,"g",3),P(),T(7,Bdt,1,4,"rect",6),T(8,Udt,1,3,"circle",7),P()),2&e&&(I("viewBox","0 -3 "+t.boardWidth*t.SPACE_SIZE*.5+" "+(6+t.boardHeight*t.SPACE_SIZE*.5)),_(1),I("width",t.boardWidth*t.SPACE_SIZE*.5)("height",t.boardHeight*t.SPACE_SIZE*.5),_(2),y("ngForOf",t.board),_(1),y("ngForOf",t.hoshis),_(2),y("ngForOf",t.board),_(1),y("ngIf",t.ko.isPresent()),_(1),y("ngForOf",t.captures))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),yu);UL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],UL);class h4{static fromLimits(e,t,n,i){return new h4(e,n,t-e,i-n)}static fromHexa(e,t,n){const i=e.flatMap(f=>t.getHexaPointsListAt(f)),s=h4.getLimits(i);return new h4(s.minX-n/2,s.minY-n/2,n+s.maxX-s.minX,n+s.maxY-s.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;for(const o of e)i=Math.min(i,o.x),s=Math.min(s,o.y),t=Math.max(t,o.x),n=Math.max(n,o.y);return{minX:i,minY:s,maxX:t,maxY:n}}constructor(e,t,n,i){u(this,"left",void 0),u(this,"up",void 0),u(this,"width",void 0),u(this,"height",void 0),this.left=e,this.up=t,this.width=n,this.height=i}center(){return new C(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(e,t,n,i){return new h4(this.left-e,this.up-n,this.width+e+t,this.height+n+i)}containingAtLeast(e){const t=Math.min(this.left,e.left),n=Math.max(this.right(),e.right()),i=Math.min(this.up,e.up),s=Math.max(this.bottom(),e.bottom());return h4.fromLimits(t,n,i,s)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class Wdt{static getArrowTransform(e,t,n){let i,s,o;switch(n){case Re.UP:i=1,s=0,o=-90;break;case Re.DOWN:i=1,s=2,o=90;break;case Re.LEFT:i=0,s=1,o=180;break;default:U.expectToBe(n,Re.RIGHT),i=2,s=1,o=0}return["scale("+e/300+")",`translate(${100*i} ${100*s})`,"rotate("+o+" 50 50)"].join(" ")}}let pr=(()=>{class r{}return u(r,"CANNOT_DROP_PIECE_YOU_DONT_HAVE",()=>"You cannot drop a piece that you do not have in your reserve."),u(r,"QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The queen bee can only move to one of its direct neighbors.`),u(r,"BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The beetle can only move to one of its direct neighbors.`),u(r,"GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`The grasshopper must move in a straight line.`),u(r,"GRASSHOPPER_MUST_JUMP_OVER_PIECES",()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`),u(r,"SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES",()=>$localize`The spider must move on neighboring spaces.`),u(r,"SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT",()=>$localize`The spider can only move around pieces that are in direct contact with it.`),u(r,"SPIDER_CANNOT_BACKTRACK",()=>$localize`The spider cannot go twice through the same space in the same move.`),u(r,"QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE",()=>$localize`The queen bee must be placed on the board before moving a piece.`),u(r,"THIS_PIECE_CANNOT_CLIMB",()=>$localize`Only the beetle is allowed to climb over other pieces.`),u(r,"CANNOT_DISCONNECT_HIVE",()=>$localize`You are not allowed to split the hive.`),u(r,"MUST_BE_ABLE_TO_SLIDE",()=>$localize`This piece must be able to slide to its destination.`),u(r,"MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN",()=>$localize`You must place your queen bee at this turn!`),u(r,"CANNOT_DROP_NEXT_TO_OPPONENT",()=>$localize`You cannot drop a piece next to one of your opponent's stack.`),u(r,"MUST_DROP_ON_EMPTY_SPACE",()=>$localize`You must always drop your piece on an empty space.`),u(r,"MUST_BE_CONNECTED_TO_HIVE",()=>$localize`The piece you are dropping must be connected to the hive.`),r})();var Ace;const qdt=we.fromFunctions(r=>r,r=>r);class r2{constructor(e,t){u(this,"owner",void 0),u(this,"kind",void 0),this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}Ace=r2,u(r2,"encoder",we.tuple([k.encoder,qdt],r=>[r.owner,r.kind],r=>new Ace(r[0],r[1])));class Bc{constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.size()===e.size()&&en.compare(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new Bc([e,...this.pieces])}topPiece(){return U.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new Bc(e)}size(){return this.pieces.length}}var kce,Lce,C2;u(Bc,"EMPTY",new Bc([]));class Qo extends wr{static of(e,t){return new Qo(e,t.x,t.y)}constructor(e,t,n){super(t,n),u(this,"piece",void 0),this.piece=e}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof Qo&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}kce=Qo,u(Qo,"encoder",we.tuple([r2.encoder,C.encoder],r=>[r.piece,r.coord],r=>new kce(r[0],r[1].x,r[1].y)));class Bi extends Go{static from(e,t){return e.equals(t)?re.failure(Le.MOVE_CANNOT_BE_STATIC()):re.success(new Bi(e,t))}constructor(e,t){super(e,t)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof Da)&&e instanceof Bi&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}u(Bi,"encoder",Vs.getFallibleEncoder(Bi.from));class Da extends Bi{static ofCoords(e){return new Da(e)}constructor(e){super(e[0],e[3]),u(this,"coords",void 0),this.coords=e}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof Da&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}Lce=Da,u(Da,"encoder",we.tuple([C.encoder,C.encoder,C.encoder,C.encoder],r=>r.coords,r=>new Lce(r)));class k0 extends Hi{toString(){return"HiveMovePass"}equals(e){return e instanceof k0}}function jdt(r){return r instanceof Qo}function Zdt(r){return r instanceof Da}function Ydt(r){return r instanceof Bi}function Kdt(r){return r instanceof k0}u(k0,"encoder",we.constant("HiveMovePass",new k0)),function(r){r.PASS=new k0,r.drop=function e(i,s){return Qo.of(i,s)},r.move=function t(i,s){return Bi.from(i,s)},r.spiderMove=function n(i){return Da.ofCoords(i)},r.encoder=we.disjunction([jdt,Zdt,Ydt,Kdt],[Qo.encoder,Da.encoder,Bi.encoder,k0.encoder])}(C2||(C2={}));class Jo{static of(e){return Jo.INSTANCES.isAbsent()&&(Jo.INSTANCES=g.of({QueenBee:_C.get(),Beetle:vC.get(),Grasshopper:CC.get(),Spider:Vd.get(),SoldierAnt:yC.get()})),Jo.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?b.failure(pr.THIS_PIECE_CANNOT_CLIMB()):b.SUCCESS}canSlideBetweenNeighbors(e,t,n){const i=new ft(_2.getNeighbors(t)),s=new ft(_2.getNeighbors(n)),o=i.intersection(s);for(const a of o)if(e.getAt(a).isEmpty())return!0;return!1}}u(Jo,"INSTANCES",g.empty());class _C extends Jo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new _C)),this.INSTANCE.get()}moveValidity(e,t){return!1===_2.areNeighbors(e.getStart(),e.getEnd())?b.failure(pr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?b.failure(pr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of _2.getNeighbors(e))t.getAt(i).isEmpty()&&n.push(Bi.from(e,i).get());return n}}u(_C,"INSTANCE",g.empty());class vC extends Jo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new vC)),this.INSTANCE.get()}moveValidity(e,t){return!1===_2.areNeighbors(e.getStart(),e.getEnd())?b.failure(pr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):b.SUCCESS}getPotentialMoves(e,t){const n=[];for(const i of _2.getNeighbors(e))n.push(Bi.from(e,i).get());return n}}u(vC,"INSTANCE",g.empty());class CC extends Jo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new CC)),this.INSTANCE.get()}moveValidity(e,t){if(be.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return b.failure(pr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=e.getStart().getCoordsToward(e.getEnd());if(0===i.length)return b.failure(pr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const s of i)if(t.getAt(s).isEmpty())return b.failure(pr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of be.factory.all){const s=e.getNext(i);if(t.getAt(s).hasPieces()){let o=s;for(;t.getAt(o).hasPieces();)o=o.getNext(i);n.push(Bi.from(e,o).get())}}return n}}u(CC,"INSTANCE",g.empty());class Vd extends Jo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new Vd)),this.INSTANCE.get()}prefixLegality(e,t){const n=new ft,i=t.update().setAt(e[0],Bc.EMPTY).increaseTurnAndFinalizeUpdate();for(let s=1;s<e.length;s++){if(i.getAt(e[s]).hasPieces())return b.failure(pr.THIS_PIECE_CANNOT_CLIMB());if(!1===_2.areNeighbors(e[s-1],e[s]))return b.failure(pr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(e[s],e[s-1]))return b.failure(pr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,e[s-1],e[s]))return b.failure(pr.MUST_BE_ABLE_TO_SLIDE());if(n.contains(e[s]))return b.failure(pr.SPIDER_CANNOT_BACKTRACK());n.add(e[s])}return b.SUCCESS}moveValidity(e,t){U.assert(e instanceof Da,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(e.coords,t);return i.isFailure()?i:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=t.update().setAt(e,Bc.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[e]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new ft(i.map(function s(a){return Da.ofCoords(a)})).toList()}nextMoveStep(e,t){const n=t[t.length-1];return new ft(_2.getNeighbors(n)).filter(function i(o){return!e.getAt(o).hasPieces()&&void 0===t.find(a=>o.equals(a))&&e.haveCommonNeighbor(o,n)}).toList().map(o=>[...t,o])}}u(Vd,"INSTANCE",g.empty());class yC extends Jo{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new yC)),this.INSTANCE.get()}pathExists(e,t,n){const i=new ft,s=[t];for(;s.length>0;){const o=s.pop();if(!i.contains(o)){if(i.add(o),o.equals(n))return!0;for(const a of _2.getNeighbors(o)){const c=e.getAt(a).isEmpty(),l=e.getOccupiedNeighbors(a).size()>0,f=this.canSlideBetweenNeighbors(e,o,a);c&&l&&f&&s.push(a)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?b.failure(pr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=new ft;for(const i of t.occupiedSpaces())if(!i.equals(e))for(const s of t.emptyNeighbors(i))n.add(Bi.from(e,s).get());return n.toList()}}u(yC,"INSTANCE",g.empty());class zce extends eC{constructor(e,t){super(t),u(this,"pieces",void 0),u(this,"width",void 0),u(this,"height",void 0),this.pieces=e;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const s of this.pieces.listKeys())e=Math.min(s.x,e),t=Math.max(s.x,t),n=Math.min(s.y,n),i=Math.max(s.y,i);return{width:t+1-e,height:i+1-n}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new ft(_2.getNeighbors(e)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const e=new ft,t=new ft;return this.pieces.forEach(n=>{if(!1===e.contains(n.key)){const i=new ft,s=new ft([n.key]);for(;s.hasElements();){const o=s.getAnyElement().get();s.remove(o),e.add(o),i.add(o),s.addAll(this.getOccupiedNeighbors(o).filter(a=>!1===e.contains(a)))}t.add(i)}}),t}}class MC{static getInitial(){const e=new Sn;for(const t of k.PLAYERS)e.set(new r2(t,"QueenBee"),1),e.set(new r2(t,"Beetle"),2),e.set(new r2(t,"Spider"),2),e.set(new r2(t,"Grasshopper"),3),e.set(new r2(t,"SoldierAnt"),3);return e.makeImmutable(),new MC(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return g.of(t);return g.empty()}remove(e){const t=this.pieces.get(e).get();U.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(e,t-1),new MC(n)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const n=[];for(let i=0;i<t.value;i++)n.push(t.key);e.push(new Bc(n))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(n=>{n.key.owner===e&&n.value>0&&t.push(n.key)}),t}}class Fd{static of(e){return new Fd(e.pieces,e.remainingPieces,e.queenBees,e.turn)}constructor(e,t,n,i){u(this,"pieces",void 0),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),u(this,"turn",void 0),this.pieces=e,this.remainingPieces=t,this.queenBees=n,this.turn=i}setAt(e,t){const n=this.queenBees.getCopy();for(const s of k.PLAYERS)n.get(s).equalsValue(e)&&n.delete(s);for(const s of t.pieces)"QueenBee"===s.kind&&n.put(s.owner,e);const i=this.pieces.getCopy();return t.isEmpty()?i.delete(e):i.put(e,t),new Fd(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(e){return new Fd(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new pi(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class pi extends zce{static getInitialState(){return pi.fromRepresentation([],0)}static fromRepresentation(e,t,n=new Et(0,0)){const i=new iu;let s=MC.getInitial();const o=new Sn;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)if(e[a][c].length>0){const l=new C(c,a).getNext(n,1);i.set(l,new Bc(e[a][c]));const f=g.ofNullable(e[a][c].find(d=>"QueenBee"===d.kind));f.isPresent()&&o.set(f.get().owner,l);for(const d of e[a][c])s=s.remove(d)}return new pi(i,s,o,t)}constructor(e,t,n,i){super(e,i),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),this.remainingPieces=t,this.queenBees=n,this.queenBees=n.getCopy();for(const s of n.listKeys()){const o=n.get(s).get();this.queenBees.replace(s,o)}this.queenBees.makeImmutable()}update(){return Fd.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():Bc.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const n of _2.getNeighbors(e))this.getAt(n).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const n of _2.getNeighbors(e))this.getAt(n).isEmpty()&&t.push(n);return t}haveCommonNeighbor(e,t){const n=this.getOccupiedNeighbors(e),i=this.getOccupiedNeighbors(t);return n.findAnyCommonElement(i).isPresent()}}class y2 extends Kn{static get(){return y2.singleton.isAbsent()&&(y2.singleton=g.of(new y2)),y2.singleton.get()}constructor(){super(pi)}applyLegalMove(e,t,n){return e instanceof Qo?this.applyLegalDrop(e,t):e instanceof Bi?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const n=t.getAt(e.coord);return t.update().setAt(e.coord,n.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const n=t.getAt(e.getStart()),i=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),n.removeTopPiece()).setAt(e.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof Qo?this.isLegalDrop(e,t):e instanceof Bi?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?b.SUCCESS:b.failure(Le.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return b.failure(pr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=t.getAt(e.getStart());if(n.isEmpty())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());const i=n.topPiece();if(i.owner===t.getCurrentOpponent())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());const s=Jo.of(i).moveValidity(e,t);if(s.isFailure())return s;const o=t.update().setAt(e.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return b.failure(pr.CANNOT_DISCONNECT_HIVE());const a=e.getEnd();return 0===o.numberOfNeighbors(a)?b.failure(pr.CANNOT_DISCONNECT_HIVE()):b.SUCCESS}mustPlaceQueenBee(e){return e.turn>=6&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const n=t.getCurrentPlayer();if(e.piece.owner===n.getOpponent())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.remainingPieces.hasRemaining(e.piece))return b.failure(pr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return b.failure(pr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(e,t);return i.isFailure()?i:t.getAt(e.coord).hasPieces()?b.failure(pr.MUST_DROP_ON_EMPTY_SPACE()):b.SUCCESS}checkNeighborValidity(e,t){const n=t.getCurrentPlayer();let i=!1;for(const s of _2.getNeighbors(e.coord)){const o=t.getAt(s);if(o.hasPieces()&&(i=!0,1!==t.turn&&o.topPiece().owner===n.getOpponent()))return b.failure(pr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===i?b.failure(pr.MUST_BE_CONNECTED_TO_HIVE()):b.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new ft([new C(0,0)]);if(1===e.turn)return new ft(_2.getNeighbors(new C(0,0)));const n=e.remainingPieces.getAny(t);if(n.isAbsent())return new ft;const i=n.get(),s=new ft;for(const o of e.occupiedSpaces())if(e.getAt(o).topPiece().owner===t)for(const a of e.emptyNeighbors(o)){const c=Qo.of(i,a);this.isLegalDrop(c,e).isSuccess()&&s.add(a)}return s}getPossibleMovesFrom(e,t){const n=e.getCurrentPlayer(),i=new ft,s=e.getAt(t).topPiece();if(s.owner===n)for(const o of Jo.of(s).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(o,e).isSuccess()&&i.add(o);return i}getPossibleMovesOnBoard(e){const t=new ft;for(const n of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,n));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of k.PLAYERS){const s=t.queenBeeLocation(i);s.isPresent()&&(n[i.value]=t.numberOfNeighbors(s.get()))}return 6===n[0]&&6===n[1]?_e.DRAW:6===n[0]?_e.getVictory(k.ONE):6===n[1]?_e.getVictory(k.ZERO):_e.ONGOING}}u(y2,"singleton",g.empty());class Xdt extends dr{getMetrics(e){return[this.queenBeeMobility(e.gameState,k.ZERO),this.queenBeeMobility(e.gameState,k.ONE)]}queenBeeMobility(e,t){const n=e.queenBeeLocation(t);return n.isPresent()?y2.get().getPossibleMovesFrom(e,n.get()).size():0}}class Dce extends Wn{getListMoves(e){const t=this.getListDrops(e.gameState),n=this.getListOfOnBoardMoves(e.gameState),i=t.concat(n);return 0===i.length?[C2.PASS]:i}getListOfOnBoardMoves(e){return y2.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],n=e.getCurrentPlayer(),i=new r2(n,"QueenBee");for(const s of y2.get().getPossibleDropLocations(e))if(y2.get().mustPlaceQueenBee(e))t.push(C2.drop(i,s));else for(const o of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(C2.drop(o,s));return t}}const Uc=new r2(k.ZERO,"QueenBee"),x0=new r2(k.ZERO,"Beetle"),Mu=new r2(k.ZERO,"Grasshopper"),EC=new r2(k.ZERO,"Spider"),SC=new r2(k.ZERO,"SoldierAnt"),L0=new r2(k.ONE,"QueenBee"),vo=new r2(k.ONE,"Beetle"),WL=new r2(k.ONE,"Grasshopper"),qL=new r2(k.ONE,"Spider"),$d=new r2(k.ONE,"SoldierAnt");class Hce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,pi.fromRepresentation([[[L0],[vo],[qL],[Mu]],[[Mu],[],[SC],[]],[[SC],[],[],[]]],8)),q.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,pi.fromRepresentation([[[],[vo],[EC]],[[$d],[L0],[Uc]],[[Mu],[x0],[]]],7)),q.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,pi.getInitialState(),C2.drop(x0,new C(0,0)),$localize`Congratulations!`),q.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,pi.fromRepresentation([[[vo],[Mu]]],2),C2.drop(Uc,new C(2,0)),$localize`Congratulations!`),q.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,pi.fromRepresentation([[[],[EC],[WL],[L0],[vo]],[[vo],[Uc],[x0],[],[]]],4),[C2.move(new C(1,1),new C(0,2)).get(),C2.move(new C(1,1),new C(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,pi.fromRepresentation([[[Uc],[L0],[x0]],[[vo],[],[]]],6),[C2.move(new C(2,0),new C(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,pi.fromRepresentation([[[vo,Uc],[L0],[x0]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,pi.fromRepresentation([[[Mu],[Uc],[vo],[$d]],[[WL],[],[],[]]],6),[C2.move(new C(0,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,pi.fromRepresentation([[[],[SC],[L0]],[[],[Uc],[vo]],[[$d],[qL],[]]],6),C2.move(new C(1,0),new C(3,1)).get(),(t,n,i)=>t.equals(C2.move(new C(1,0),new C(0,1)).get())?b.failure($localize`You have not freed your queen, try again!`):b.SUCCESS,$localize`Congratulations!`),q.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,pi.fromRepresentation([[[],[EC],[qL],[vo]],[[],[],[],[x0]],[[vo],[],[],[$d]],[[SC],[],[Mu],[]],[[Uc],[WL],[],[]]],6),C2.spiderMove([new C(1,0),new C(1,1),new C(2,1),new C(2,2)]),$localize`Congratulations!`),q.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,pi.fromRepresentation([[[],[EC],[]],[[],[Uc],[vo]],[[$d],[],[]]],6)),q.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,pi.fromRepresentation([[[vo,x0],[Uc],[L0]]],4))])}}const Qdt=["app-hive-piece",""];function Jdt(r,e){1&r&&(A(),F(0,"path",9))}function eht(r,e){1&r&&(A(),F(0,"path",10))}function tht(r,e){1&r&&(A(),F(0,"path",11))}function nht(r,e){1&r&&(A(),F(0,"path",12))}function rht(r,e){1&r&&(A(),F(0,"path",13))}let iht=(()=>{var r;class e extends Cae{constructor(...n){super(...n),u(this,"piece",void 0),u(this,"x",void 0),u(this,"y",void 0),u(this,"hexaLayout",void 0),u(this,"layer",void 0),u(this,"pieceHeight",void 0),u(this,"hexaPoints",""),u(this,"pieceClass",""),u(this,"isoPointsLight",""),u(this,"isoPointsDark",""),u(this,"isoPointsStroke",""),u(this,"layerTransform",""),u(this,"hexaCenter",new C(0,0))}ngAfterContentChecked(){const n=new C(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(n),this.hexaCenter=this.hexaLayout.getCenterAt(n);const s=this.hexaLayout.getIsoPoints(n,this.pieceHeight).map(o=>o.map(a=>a.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",We({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[Xe],attrs:Qdt,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(A(),S(0,"g"),F(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),S(5,"g"),T(6,Jdt,1,0,"path",4),T(7,eht,1,0,"path",5),T(8,tht,1,0,"path",6),T(9,nht,1,0,"path",7),T(10,rht,1,0,"path",8),P()()),2&n&&(I("transform",i.layerTransform),_(1),y("ngClass",i.pieceClass),I("points",i.isoPointsLight),_(1),y("ngClass",i.pieceClass),I("points",i.isoPointsDark),_(1),I("points",i.isoPointsStroke),_(1),y("ngClass",i.pieceClass),I("points",i.hexaPoints),_(1),I("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),_(1),y("ngIf","QueenBee"===i.piece.kind),_(1),y("ngIf","Beetle"===i.piece.kind),_(1),y("ngIf","Grasshopper"===i.piece.kind),_(1),y("ngIf","Spider"===i.piece.kind),_(1),y("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[Ft,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function sht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",4),W("click",function(){const s=te(t).$implicit;return ne(p().selectSpace(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","space_",t.x,"_",t.y,""),y("ngClass",t.content.spaceClasses),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function oht(r,e){if(1&r){const t=pe();A(),S(0,"polygon",6),W("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();Ce("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function aht(r,e){if(1&r&&(A(),S(0,"g"),T(1,oht,1,4,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function cht(r,e){if(1&r){const t=pe();A(),S(0,"polygon",8),W("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();Ce("id","stroke_",t.x,"_",t.y,""),I("points",n.getHexaPointsAtXY(t.x,t.y))}}function lht(r,e){if(1&r&&(A(),S(0,"g"),T(1,cht,1,3,"polygon",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.selected)}}function uht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",9),W("click",function(){const s=te(t).$implicit;return ne(p(2).selectStack(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p().index,i=p();_(1),Ce("id","piece_",t.x,"_",t.y,""),y("piece",t.content.piece)("x",t.x)("y",t.y)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n)}}function fht(r,e){if(1&r){const t=pe();A(),S(0,"polygon",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectStack(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p().index,i=p();Ce("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),I("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")("points",i.getHexaPointsAtXY(t.x,t.y))}}function dht(r,e){if(1&r&&(A(),S(0,"g"),T(1,fht,1,5,"polygon",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.content.strokeClasses.length>0)}}function hht(r,e){if(1&r&&(A(),S(0,"g"),T(1,uht,2,8,"g",1),T(2,dht,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t),_(1),y("ngForOf",t)}}function pht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",10),W("click",function(){const s=te(t).$implicit;return ne(p(2).selectRemaining(s))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),Dn("id","remainingPiece_",t.toString(),""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),I("transform",i.getRemainingPieceTransform(t))}}function ght(r,e){if(1&r&&(A(),S(0,"g"),T(1,pht,2,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t.pieces)}}function mht(r,e){if(1&r&&(A(),F(0,"polygon",11)),2&r){const t=p();I("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))("points",t.getHexaPointsAt(t.ORIGIN))}}function _ht(r,e){if(1&r&&(A(),F(0,"g",13)),2&r){const t=e.$implicit,n=e.index,i=p(2);Dn("id","inspectedStack_",n,""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),I("transform",i.inspectedStackTransform)}}function vht(r,e){if(1&r&&(A(),S(0,"g"),T(1,_ht,1,8,"g",12),P()),2&r){const t=p();_(1),y("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class Vce extends mae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(n=>n.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class Cht extends mae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let yht=(()=>{var r;class e extends lu{constructor(n){super(n),u(this,"ORIGIN",new C(0,0)),u(this,"remainingStacks",[]),u(this,"layers",[]),u(this,"ground",new Vce),u(this,"inspectedStack",g.empty()),u(this,"inspectedStackCoord",g.empty()),u(this,"selectedRemaining",g.empty()),u(this,"selectedStart",g.empty()),u(this,"selectedSpiderCoords",[]),u(this,"PIECE_HEIGHT",void 0),u(this,"boardViewBox",void 0),u(this,"viewBox",void 0),u(this,"inspectedStackTransform",void 0),this.rules=y2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,y2.get(),new Xdt,new Dce),new Xn($localize`MCTS`,new Dce,this.rules)],this.encoder=C2.encoder,this.tutorial=(new Hce).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new uu(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Ur.INSTANCE),this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.layers=[];for(const o of i.getState().occupiedSpaces()){const a=i.getState().getAt(o),c=o.x,l=o.y;for(let f=0;f<a.size();f++){f in i.layers||(i.layers[f]=new Cht);const d=a.pieces[a.size()-1-f];i.layers[f].initialize(new C(c,l),d)}}i.ground=i.getGround(),i.computeViewBox(),i.remainingStacks=i.getState().remainingPieces.toListOfStacks(),i.canPass=y2.get().shouldPass(i.getState());const s=y2.get().getGameStatus(i.node);switch(s){case _e.ONGOING:break;case _e.DRAW:i.highlight(i.getState().queenBeeLocation(k.ZERO).get(),"victory-stroke"),i.highlight(i.getState().queenBeeLocation(k.ONE).get(),"victory-stroke");break;default:const a=s.winner.getOpponent();i.highlight(i.getState().queenBeeLocation(a).get(),"victory-stroke")}})()}highlight(n,i){const s=this.getState().getAt(n).size();s-1 in this.layers&&this.layers[s-1].highlight(n,i)}pass(){var n=this;return M(function*(){return U.assert(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(C2.PASS)})()}computeViewBox(){const n=this.getPieceCoords().union(this.getAllNeighbors()).toList();n.push(new C(0,0)),this.boardViewBox=h4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH);const i=new h4(this.getRemainingPieceTransformAsCoord(new r2(k.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let o=0;this.getState().remainingPieces.getAny(k.ZERO).isPresent()&&(o=s);let a=0;this.getState().remainingPieces.getAny(k.ONE).isPresent()&&(a=s);const c=this.boardViewBox.containingAtLeast(i).expand(0,0,o,a);if(this.inspectedStack.isPresent()){const l=new C(c.right()+this.SPACE_SIZE,c.center().y),f=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${l.x} ${l.y+3*(f-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const n=new Vce;for(const i of this.getAllNeighbors())n.initialize(i);return n}getAllNeighbors(){const n=new ft;for(const i of this.getPieceCoords())n.addAll(new ft(this.getState().emptyNeighbors(i)));return n.isEmpty()&&n.add(new C(0,0)),n}clearHighlights(){for(const n of this.layers)n.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=g.empty(),this.selectedRemaining=g.empty(),this.selectedSpiderCoords=[],this.inspectedStack=g.empty(),this.computeViewBox()}showLastMove(n){var i=this;return M(function*(){for(const s of i.getLastMoveCoords(n))i.highlight(s,"last-move-stroke"),i.ground.highlightStroke(s,"last-move-stroke"),i.ground.highlightFill(s,"moved-fill")})()}getLastMoveCoords(n){let i=[];return n instanceof Qo?i=[n.coord]:n instanceof Bi&&(i=[n.getStart(),n.getEnd()]),i}getRemainingPieceTransformAsCoord(n){const i=this.getRemainingPieceShift(n),s=this.boardViewBox.center().x+i*this.SPACE_SIZE*4;let o;return o=n.owner===this.getPointOfView()?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new C(s,o)}getRemainingPieceTransform(n){const i=this.getRemainingPieceTransformAsCoord(n);return`translate(${i.x} ${i.y})`}getRemainingPieceHighlightTransform(n){const i=this.getRemainingPieceTransformAsCoord(n),s=this.getState().remainingPieces.getQuantity(n);return`translate(${i.x} ${i.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(n){switch(n.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return U.expectToBe(n.kind,"SoldierAnt"),1.5}}selectRemaining(n){var i=this;return M(function*(){const s=yield i.canUserPlay(`#remainingPiece_${n.toString()}`);if(s.isFailure())return i.cancelMove(s.getReason());if(n.owner===i.getCurrentOpponent())return i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==n.kind&&y2.get().mustPlaceQueenBee(i.getState()))return i.cancelMove(pr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(i.selectedRemaining.equalsValue(n))i.cancelMoveAttempt();else{i.cancelMoveAttempt(),i.selectedRemaining=g.of(n),i.clearHighlights();const o=y2.get().getPossibleDropLocations(i.getState()).toList();for(const a of o)i.ground.highlightStroke(a,"clickable-stroke")}return b.SUCCESS})()}selectStack(n,i){var s=this;return M(function*(){return yield s.select(new C(n,i),"piece")})()}selectSpace(n,i){var s=this;return M(function*(){return yield s.select(new C(n,i),"space")})()}select(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay(`#${i}_${n.x}_${n.y}`);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState(),c=a.getAt(n);if(s.selectedRemaining.isPresent()){const l=C2.drop(s.selectedRemaining.get(),n);return s.chooseMove(l)}if(s.selectedStart.isPresent()){const l=a.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(n)?s.cancelMove():s.selectTarget(n,l)}return 0===c.size()?s.cancelMove():s.selectStart(n,c)})()}selectTarget(n,i){var s=this;return M(function*(){if("Spider"===i.kind)return s.selectNextSpiderSpace(n);{const o=C2.move(s.selectedStart.get(),n);return je(o.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(o.get())}})()}selectStart(n,i){var s=this;return M(function*(){const o=s.getState(),a=i.topPiece();return a.owner===o.getCurrentOpponent()?1===i.size()?s.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),b.SUCCESS):(s.highlight(n,"selected-stroke"),s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox(),b.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==a.kind&&y2.get().mustPlaceQueenBee(o)?s.cancelMove(pr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=g.of(n),s.highlight(n,"selected-stroke"),"Spider"===a.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),i.size()>1&&(s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox()),s.highlightNextPossibleCoords(n),b.SUCCESS))})()}highlightNextPossibleCoords(n){for(const i of this.getNextPossibleCoords(n))this.highlight(i,"clickable-stroke"),this.ground.highlightStroke(i,"clickable-stroke")}getNextPossibleCoords(n){const i=this.getState(),s=i.getAt(n).topPiece(),o=y2.get().getPossibleMovesFrom(i,n);return"Spider"===s.kind?o.filter(c=>en.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():o.map(a=>a.getEnd()).toList()}selectNextSpiderSpace(n){var i=this;return M(function*(){if(i.selectedSpiderCoords.push(n),4===i.selectedSpiderCoords.length){const o=C2.spiderMove(i.selectedSpiderCoords);return i.chooseMove(o)}const s=Vd.get().prefixLegality(i.selectedSpiderCoords,i.getState());if(s.isFailure())return i.cancelMove(s.getReason());i.clearHighlights(),i.highlight(i.selectedStart.get(),"selected-stroke");for(const o of i.selectedSpiderCoords)i.ground.select(o);return i.highlightNextPossibleCoords(i.selectedStart.get()),b.SUCCESS})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-hive"]],features:[Xe],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,sht,2,4,"g",1),T(2,aht,2,1,"g",1),T(3,lht,2,1,"g",1),T(4,hht,3,2,"g",1),T(5,ght,2,1,"g",1),T(6,mht,1,2,"polygon",2),T(7,vht,2,1,"g",3),P()),2&n&&(I("viewBox",i.viewBox),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.ground),_(1),y("ngForOf",i.layers),_(1),y("ngForOf",i.remainingStacks),_(1),y("ngIf",i.selectedRemaining.isPresent()),_(1),y("ngIf",i.inspectedStack.isPresent()))},dependencies:[Ft,Wt,wt,iht],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const Mht={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:k.ZERO};class Wc extends NL{static getInitialState(){const e=sn.UNOCCUPIED,t=sn.INVADERS,n=sn.DEFENDERS;return new Wc([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,n,e,e,e,e,t],[t,e,e,e,n,n,n,e,e,e,t],[t,t,e,n,n,sn.PLAYER_ONE_KING,n,n,e,t,t],[t,e,e,e,n,n,n,e,e,e,t],[t,e,e,e,e,n,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}of(e,t){return new Wc(e,t)}}class Cs extends wL{static of(e,t){return new Cs(e,t)}static from(e,t){try{const n=new Cs(e,t);return re.success(n)}catch(n){return re.failure(n.message)}}getMaximalDistance(){return 11}}u(Cs,"encoder",Vs.getFallibleEncoder(Cs.from));class kl extends AL{static get(){return kl.singleton.isAbsent()&&(kl.singleton=g.of(new kl)),kl.singleton.get()}constructor(){super(Wc,Mht,Cs.from)}}u(kl,"singleton",g.empty());const N=sn.UNOCCUPIED,Nt=sn.INVADERS,gr=sn.DEFENDERS,PC=sn.PLAYER_ONE_KING;class $ce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Wc.getInitialState()),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Wc.getInitialState(),Cs.of(new C(5,1),new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Wc([[N,N,N,N,Nt,Nt,Nt,Nt,N,N,N],[N,N,N,N,N,Nt,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[Nt,N,N,N,N,gr,N,N,N,N,Nt],[Nt,N,N,Nt,gr,gr,gr,N,N,N,Nt],[Nt,Nt,N,gr,gr,PC,gr,gr,N,Nt,Nt],[Nt,N,N,N,gr,gr,gr,N,N,N,Nt],[Nt,N,N,N,N,gr,N,N,N,N,Nt],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,Nt,N,N,N,N,N],[N,N,N,Nt,Nt,Nt,Nt,Nt,N,N,N]],1),[Cs.of(new C(5,3),new C(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Cs.of(new C(3,0),new C(3,4))),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Wc([[N,N,N,Nt,Nt,Nt,Nt,Nt,N,N,N],[N,gr,N,N,N,Nt,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,gr,N,N,N,N,Nt],[Nt,N,N,N,N,gr,gr,N,N,N,Nt],[Nt,Nt,PC,N,gr,N,gr,gr,N,N,Nt],[N,N,Nt,N,N,gr,gr,N,N,N,Nt],[Nt,N,N,N,N,gr,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,Nt,N,N,N,N,N,N,N,N,N],[N,N,N,Nt,Nt,Nt,Nt,N,Nt,N,N]],12),[Cs.of(new C(3,0),new C(3,5)),Cs.of(new C(3,10),new C(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Wc([[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,Nt,N,N,N,N,N,N,N,N,N],[Nt,PC,N,Nt,N,N,N,N,N,N,N],[N,Nt,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[Cs.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Wc([[N,N,Nt,PC,Nt,N,N,N,N,N,N],[N,N,N,N,N,N,gr,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,Nt,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[Cs.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function Eht(r,e){1&r&&(A(),F(0,"polygon",8))}function Sht(r,e){1&r&&(A(),F(0,"rect",9))}function Pht(r,e){if(1&r&&(A(),S(0,"g"),T(1,Eht,1,0,"polygon",6),T(2,Sht,1,0,"ng-template",null,7,fn),P()),2&r){const t=ln(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function Tht(r,e){if(1&r&&(A(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Oht(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function bht(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function wht(r,e){if(1&r&&(A(),T(0,Oht,1,1,"polyline",14),T(1,bht,4,20,"ng-template",null,15,fn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function Nht(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",10),T(2,Tht,6,25,"g",11),T(3,wht,3,2,"ng-template",null,12,fn),P()),2&r){const t=ln(4),n=p().index,i=p().index,s=p();_(1),Ce("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function Aht(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,Pht,4,2,"g",5),T(3,Nht,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Iht(r,e){if(1&r&&(A(),S(0,"g"),T(1,Aht,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function kht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let xht=(()=>{var r;class e extends IL{constructor(n){super(n,Cs.from),this.rules=kl.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=Cs.encoder,this.tutorial=(new $ce).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-hnefatafl"]],features:[Xe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Iht,2,1,"g",1),T(2,kht,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Lht extends Lae{constructor(e,t){super(e,t)}updateOrCreateCurrentMove(e){if(this.currentMove.isAbsent())this.hideLastMove(),this.currentMove=g.of(this.generateMove(e));else{const t=this.addToMove(e);this.currentMove=g.of(t)}}}class p4 extends gs{static get(){return p4.singleton.isAbsent()&&(p4.singleton=g.of(new p4)),p4.singleton.get()}constructor(){super({passByPlayerStore:!0,mustFeed:!1,feedOriginalHouse:!0})}isLegal(e,t){const n=t.getCurrentPlayerY();let i=!0;for(const s of e){U.assert(!0===i,"CANNOT_PLAY_AFTER_NON_KALAH_MOVE");const o=this.isLegalDistribution(s,t);if(o.isFailure())return b.ofFallible(o);t=this.distributeHouse(s.x,n,t).resultingState,i=o.get()}return U.assert(!1===i,"MUST_CONTINUE_PLAYING_AFTER_KALAH_MOVE"),b.SUCCESS}isLegalDistribution(e,t){const n=t.getCurrentPlayerY();if(0===t.getPieceAtXY(e.x,n))return re.failure(du.MUST_CHOOSE_NON_EMPTY_HOUSE());const i=this.distributeHouse(e.x,n,t),s=gs.isStarving(i.resultingState.getCurrentPlayer(),i.resultingState.board);return re.success(i.endsUpInKalah&&!1===s)}distributeMove(e,t){const n=t.getCurrentPlayer().value,i=t.getCurrentPlayerY(),s=[];let o=0,a=!1,c=t;for(const d of e){const m=this.distributeHouse(d.x,i,c);c.getScoresCopy()[n]+=m.passedByKalahNTimes,c=m.resultingState,s.push(...m.filledCoords),o+=m.passedByKalahNTimes,a=m.endsUpInKalah}const l=c.getScoresCopy();return l[n]+=o,{endsUpInKalah:a,filledCoords:s,passedByKalahNTimes:o,resultingState:new Pn(c.getCopiedBoard(),c.turn,l)}}applyCapture(e){const t=e.resultingState,n={capturedSum:0,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]],resultingState:t};if(e.endsUpInKalah)return n;{const i=e.filledCoords[e.filledCoords.length-1],s=e.resultingState.getCurrentPlayerY(),o=e.resultingState.getOpponentY(),a=e.resultingState.getPieceAt(i),c=e.resultingState.getPieceAtXY(i.x,o);if(i.y===s&&1===a&&c>0){const l=t.getCopiedBoard(),f=l[0][i.x]+l[1][i.x],d=Rt.create(Pn.WIDTH,2,0);d[0][i.x]=l[0][i.x],d[1][i.x]=l[1][i.x],l[0][i.x]=0,l[1][i.x]=0;const m=t.getScoresCopy();return m[t.getCurrentPlayer().value]+=f,{capturedSum:f,captureMap:d,resultingState:new Pn(l,t.turn,m)}}return n}}}var Gce;u(p4,"singleton",g.empty());class ea extends Nae{static of(e,t=[]){const n=[e];return n.push(...t),new ea(n)}add(e){return ea.of(this.distributions[0],this.distributions.slice(1).concat(e))}toString(){return"KalahMove(["+this.distributions.map(t=>t.x).join(", ")+"])"}equals(e){return en.compare(this.distributions,e.distributions)}}Gce=ea,u(ea,"encoder",we.tuple([we.list(h1.encoder)],r=>[r.distributions],r=>Gce.of(r[0][0],r[0].slice(1))));class Bce extends Yn{constructor(...e){super(...e),u(this,"gameName",$localize`Kalah`),u(this,"tutorial",[q.informational(this.gameName,$localize`${this.gameName} is a Mancala. Mancala is the name of a family of board games that dates back at least to the third century. Mancalas are games of distribution (sowing) and capture. Their goal is to capture the most seeds. The spaces in Mancalas are called the houses. The ones on the extreme left and right are called the stores, they contain the seeds that each player won. As you are playing Dark, the 6 houses on the bottom are yours.`,Pn.getInitialState()),q.informational($localize`Kalah`,$localize`Bonus fact: Kalah has been created in the U.S.A in 1940 by William Julius Champion Jr.`,Pn.getInitialState()),Aae.SOWING(ea.of(h1.FIVE)),q.forClick($localize`The Kalah (1/2)`,$localize`The houses on the extreme left and right, unaligned with the others, are the Kalah. Yours is on the left, the opponent's on the right. When sowing, before passing from your last house to the first of the opponent, you must drop one seed in your Kalah, but you won't have to drop seed in your opponent's Kalah. When you make a capture, the captured seeds are put in your Kalah.<br/><br/>You're playing Dark. Make a move that passes through your Kalah then feeds opponent's houses.`,Pn.getInitialState(),["#click_0_1","#click_1_1","#click_2_1"],$localize`As you see, three houses have been fed in addition to your Kalah.`,$localize`Failed. Choose the three leftmost house on the bottom.`),q.fromPredicate($localize`The Kalah (2/2)`,$localize`When ending in the Kalah, you must distribute again.<br/><br/>You're playing Dark, play the house that ends up in the Kalah then do a second distribution!`,Pn.getInitialState(),ea.of(h1.THREE,[h1.ONE]),(t,n,i)=>1===t.distributions.length?b.failure($localize`This move only distributed one house, do one distribution that ends in the Kalah, then do a second one!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Capture`,$localize`When the last seed of a distribution ends up in one of your empty houses, if the opposite house is filled, then you capture both houses. On this board, such a move is possible.<br/><br/>You're playing Dark, do a capture!`,new Pn([[0,4,4,4,4,4],[0,2,0,2,4,0]],4,[0,0]),ea.of(h1.ONE,[h1.ZERO,h1.THREE]),(t,n,i)=>0===i.getPieceAtXY(1,0)?b.SUCCESS:b.failure($localize`You did not capture, try again!`),$localize`Congratulations!`),q.fromMove($localize`End of the game`,$localize`At any moment, when one player has more than 24 seeds in their Kalah, they win. That can happen before the board is empty, but, there is also a second way. When you don't have any seed in your houses, the game is over and your opponent takes all the remaining seeds from their houses. Here, your opponent just need one more point to win and will get it next turn if you allow it.<br/><br/>You're playing Dark, win!`,new Pn([[0,0,0,0,2,0],[2,0,0,0,0,1]],0,[19,24]),[ea.of(h1.FIVE)],$localize`Since there is no longer seeds in the opponent houses, all your seeds have been captured by you. Congratulations, you won!`,$localize`Failed, you gave the opponent a seed! Try again.`)])}}class Rht extends Wn{getListMoves(e){const t=[],n=e.gameState.getCurrentPlayerY();for(let i=0;i<Pn.WIDTH;i++)if(e.gameState.getPieceAtXY(i,n)>0){const s=e.gameState,o=ea.of(h1.of(i));t.push(...this.getPossibleMoveContinuations(s,i,n,o))}return t}getPossibleMoveContinuations(e,t,n,i){const s=[],o=p4.get().distributeHouse(t,n,e),a=o.resultingState,c=!1===gs.isStarving(a.getCurrentPlayer(),a.board);if(o.endsUpInKalah&&c){for(let l=0;l<Pn.WIDTH;l++)if(a.getPieceAtXY(l,n)>0){const f=i.add(h1.of(l));s.push(...this.getPossibleMoveContinuations(a,l,n,f))}return s}return[i]}}function zht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","click_",n,"_",i,""),y("x",n)("y",i)("content",t)("spaceClasses",s.getSpaceClasses(n,i))("rotation",s.getPieceRotation())("secondaryContent",s.getHouseSecondaryContent(n,i)),I("transform",s.getPieceTransform(n,i))}}function Dht(r,e){if(1&r&&(A(),S(0,"g"),T(1,zht,2,9,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Hht=(()=>{var r;class e extends Lht{constructor(n,i){super(n,i),this.rules=p4.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(new Rht),this.encoder=ea.encoder,this.tutorial=(new Bce).tutorial}generateMove(n){return ea.of(h1.of(n))}addToMove(n){return this.currentMove.get().add(h1.of(n))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut),B(T3))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-kalah-component"]],features:[Xe],decls:8,vars:14,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 870 250","preserveAspectRatio","xMidYMid meet"],["x","0","y","0","ry","115","rx","115","width","860","height","240","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","120","y1","120","x2","740","y2","120",1,"base"],["x1","120","y1","0","x2","120","y2","240",1,"base"],["x1","740","y1","0","x2","740","y2","240",1,"base"],["id","store_player_0","app-numbered-circle","","transform","translate(60 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["id","store_player_1","app-numbered-circle","","transform","translate(800 120)",3,"x","y","content","spaceClasses","rotation","secondaryContent","click"],["app-numbered-circle","",3,"id","x","y","content","spaceClasses","rotation","secondaryContent","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,Dht,2,1,"g",2),F(3,"line",3)(4,"line",4)(5,"line",5),S(6,"g",6),W("click",function(){return i.onStoreClick(i.Player.ZERO)}),P(),S(7,"g",7),W("click",function(){return i.onStoreClick(i.Player.ONE)}),P()()),2&n&&(I("transform",i.rotation),_(2),y("ngForOf",i.board),_(4),y("x",-1)("y",-1)("content",i.getStoreContent(i.Player.ZERO))("spaceClasses",i.getSpaceClasses(-1,-1))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ZERO)),_(1),y("x",2)("y",2)("content",i.getStoreContent(i.Player.ONE))("spaceClasses",i.getSpaceClasses(2,2))("rotation",i.getPieceRotation())("secondaryContent",i.getStoreSecondaryContent(i.Player.ONE)))},dependencies:[Wt,Rae],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"],changeDetection:0})),e})();var qc,TC,jL,M2;class vn{static of(e){switch(e){case 0:return vn.ANY;case 1:return vn.ORANGE;case 2:return vn.BLUE;case 3:return vn.PURPLE;case 4:return vn.PINK;case 5:return vn.YELLOW;case 6:return vn.RED;case 7:return vn.GREEN;default:return U.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),vn.BROWN}}constructor(e,t,n){u(this,"value",void 0),u(this,"name",void 0),u(this,"rgb",void 0),this.value=e,this.name=t,this.rgb=n}}u(vn,"ANY",new(qc=vn)(0,"any","#000")),u(vn,"ORANGE",new qc(1,"orange","#d67421")),u(vn,"BLUE",new qc(2,"blue","#006bac")),u(vn,"PURPLE",new qc(3,"purple","#6f3787")),u(vn,"PINK",new qc(4,"pink","#d2719e")),u(vn,"YELLOW",new qc(5,"yellow","#e2c200")),u(vn,"RED",new qc(6,"red","#d23339")),u(vn,"GREEN",new qc(7,"green","#009157")),u(vn,"BROWN",new qc(8,"brown","#562500"));class pn{constructor(e,t){u(this,"player",void 0),u(this,"color",void 0),this.player=e,this.color=t}static of(e,t){return new pn(e,vn.of(t))}static createPlayerColors(e){return{ORANGE:new pn(e,vn.ORANGE),BLUE:new pn(e,vn.BLUE),PURPLE:new pn(e,vn.PURPLE),PINK:new pn(e,vn.PINK),YELLOW:new pn(e,vn.YELLOW),RED:new pn(e,vn.RED),GREEN:new pn(e,vn.GREEN),BROWN:new pn(e,vn.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(Y.NONE)}belongsTo(e){return this.player===e}}u(pn,"EMPTY",new(TC=pn)(Y.NONE,vn.ANY)),u(pn,"ZERO",TC.createPlayerColors(k.ZERO)),u(pn,"ONE",TC.createPlayerColors(k.ONE));class gi{static getColorAt(e,t){return gi.COLORS[t][e]}static getInitialBoard(){const e=pn.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>pn.of(k.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>pn.of(k.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(pn.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const s=new C(i,n);!1===gi.isEmptyAt(e,s)&&t.push(s)}return t}}u(gi,"INITIAL",gi.getInitialBoard()),u(gi,"SIZE",8),u(gi,"COLORS",Rt.map([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],vn.of));class ta extends q1{static isOnBoard(e){return e.isInRange(gi.SIZE,gi.SIZE)}static getInitialState(){return new ta(0,vn.ANY,g.empty(),!1,gi.INITIAL)}constructor(e,t,n,i,s){super(Rt.copy(s),e),u(this,"colorToPlay",void 0),u(this,"coordToPlay",void 0),u(this,"alreadyPassed",void 0),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=i}}class Eu extends Hi{constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}u(Eu,"PASS",new(jL=Eu)),u(Eu,"encoder",we.constant("PASS",jL.PASS));class R0 extends Go{static of(e,t){return U.assert(ta.isOnBoard(e),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),U.assert(ta.isOnBoard(t),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new R0(e,t)}constructor(e,t){super(e,t)}equals(e){return e===this||!!M2.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function Vht(r){return r instanceof Eu}u(R0,"encoder",Vs.getEncoder(R0.of)),function(r){r.PASS=Eu.PASS,r.of=function e(n,i){return R0.of(n,i)},r.isPiece=function t(n){return n instanceof R0},r.encoder=we.disjunction([r.isPiece,Vht],[R0.encoder,Eu.encoder])}(M2||(M2={}));let Gd=(()=>{class r{}return u(r,"NOT_RIGHT_COLOR",()=>$localize`This piece is not of the color you have to play.`),u(r,"DIRECTION_NOT_ALLOWED",()=>$localize`You can only move forward, orthogonally or diagonally.`),u(r,"MOVE_BLOCKED",()=>$localize`This move is blocked by another piece.`),u(r,"PLAY_WITH_SELECTED_PIECE",()=>$localize`You must play with the selected piece.`),r})();class U2 extends Kn{static get(){return U2.singleton.isAbsent()&&(U2.singleton=g.of(new U2)),U2.singleton.get()}constructor(){super(ta)}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new C(0,7),new C(1,7),new C(2,7),new C(3,7),new C(4,7),new C(5,7),new C(6,7),new C(7,7)]}static getMovablePieces(e){return U2.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const i=t.getNext(n);if(e.isOnBoard(i)&&gi.isEmptyAt(e.board,i))return!0}return!1})}static playerDirections(e){return e===k.ONE?[Me.DOWN,Me.DOWN_LEFT,Me.DOWN_RIGHT]:[Me.UP,Me.UP_LEFT,Me.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===k.ZERO?e.y<0:e.y>0}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return gi.allPieceCoords(e.board).forEach(i=>{const s=e.getPieceAt(i);je(s!==pn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),s.player===k.ONE?n=Math.max(n,i.y):t=Math.min(t,i.y)}),[t,n]}static isLegal(e,t){if(M2.isPiece(e)){const n=e.getStart(),i=e.getEnd(),s=t.colorToPlay,o=t.getPieceAt(n);if(!1===o.belongsTo(t.getCurrentPlayer()))return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(s!==vn.ANY&&o.color!==s)return b.failure(Gd.NOT_RIGHT_COLOR());if(!1===t.getPieceAt(i).isEmpty())return b.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const c=Me.factory.fromMove(n,i);if(c.isFailure())return b.failure(Gd.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===U2.directionAllowedForPlayer(l,t.getCurrentPlayer()))return b.failure(Gd.DIRECTION_NOT_ALLOWED());let f=n;for(;!1===f.equals(i);)if(f=f.getNext(l),!1===t.getPieceAt(f).isEmpty())return b.failure(Gd.MOVE_BLOCKED());return b.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!1===e.alreadyPassed?b.SUCCESS:b.failure(Le.CANNOT_PASS())}nextCoordToPlay(e,t){return g.ofNullable(gi.allPieceCoords(e.board).find(n=>{const i=e.getPieceAt(n);return i.player===e.getCurrentOpponent()&&i.color===t}))}applyLegalMove(e,t,n){if(M2.isPiece(e)){const i=e.getStart(),s=e.getEnd(),o=t.getCopiedBoard();o[s.y][s.x]=o[i.y][i.x],o[i.y][i.x]=pn.EMPTY;const a=gi.getColorAt(s.x,s.y),c=this.nextCoordToPlay(t,a);return new ta(t.turn+1,a,c,!1,o)}{const i=this.nextCoordToPlay(t,t.colorToPlay);return new ta(t.turn+1,t.colorToPlay,i,!0,t.board)}}isLegal(e,t){return U2.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(U2.mustPass(t)&&t.alreadyPassed)return _e.getDefeat(n);const[i,s]=U2.getFurthestPiecePositions(t);return 7===s?_e.ONE_WON:0===i?_e.ZERO_WON:_e.ONGOING}}u(U2,"singleton",g.empty());const K=pn.EMPTY,OC=pn.ZERO.ORANGE,bC=pn.ONE.ORANGE,wC=pn.ZERO.BLUE,NC=pn.ONE.BLUE,ZL=pn.ZERO.PURPLE,Bd=pn.ONE.PURPLE,AC=pn.ZERO.PINK,IC=pn.ONE.PINK,kC=pn.ZERO.YELLOW,xC=pn.ONE.YELLOW,LC=pn.ZERO.RED,RC=pn.ONE.RED,zC=pn.ZERO.GREEN,DC=pn.ONE.GREEN,HC=pn.ZERO.BROWN,VC=pn.ONE.BROWN;class qce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new ta(5,vn.ORANGE,g.empty(),!1,[[HC,NC,Bd,IC,xC,RC,DC,VC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,bC,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,zC,LC,kC,AC,ZL,wC,OC]])).withPreviousMove(M2.of(new C(0,7),new C(0,0))),q.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,ta.getInitialState(),M2.of(new C(7,7),new C(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),q.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new ta(1,vn.PINK,g.of(new C(3,0)),!1,[[bC,NC,Bd,IC,xC,RC,DC,VC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,wC,K],[K,K,K,K,K,K,K,K],[HC,zC,LC,kC,AC,ZL,K,OC]]),[M2.of(new C(3,0),new C(3,6)),M2.of(new C(3,0),new C(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(M2.of(new C(6,7),new C(6,5))),q.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new ta(1,vn.PINK,g.of(new C(3,6)),!1,[[bC,NC,Bd,K,xC,RC,DC,VC],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,K],[K,K,K,K,K,K,K,wC],[K,K,K,K,K,K,K,K],[K,K,K,IC,K,K,K,K],[HC,zC,LC,kC,AC,ZL,K,OC]])).withPreviousMove(M2.of(new C(6,5),new C(7,4))),q.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new ta(2,vn.RED,g.of(new C(2,4)),!1,[[K,NC,Bd,K,K,RC,K,K],[K,K,K,xC,K,K,K,K],[K,K,K,IC,K,Bd,K,K],[K,K,K,kC,K,K,K,K],[K,K,LC,K,K,K,K,K],[K,K,K,K,K,K,DC,K],[bC,K,K,K,K,AC,K,VC],[HC,zC,K,K,K,K,wC,OC]]),[M2.of(new C(2,4),new C(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(M2.of(new C(4,0),new C(3,1)))])}}class Fht extends dr{getMetrics(e){const t=e.gameState,[n,i]=U2.getFurthestPiecePositions(t);return[7-n,i]}}class jce extends Wn{getListMoves(e){const t=e.gameState,n=U2.getMovablePieces(t);if(0===n.length)return U.assert(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[M2.PASS];{const i=this.getListMovesFromNonBlockedState(t,n);return en.sortByDescending(i,s=>s.length()),i}}getListMovesFromNonBlockedState(e,t){const n=[],i=e.getCurrentPlayer();for(const s of t)for(const o of U2.playerDirections(i))for(let a=1;a<gi.SIZE;a++){const c=s.getNext(o,a);if(!e.isOnBoard(c)||!gi.isEmptyAt(e.board,c))break;{const l=M2.of(s,c);n.push(l)}}return n}}function $ht(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p(),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.piecePlayerClass(n)),I("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function Ght(r,e){if(1&r&&(A(),F(0,"rect",9)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();I("x",o.SPACE_SIZE/2+n*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+s*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function Bht(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",4),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"rect",5),T(3,$ht,1,4,"circle",6),T(4,Ght,1,7,"rect",7),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","click_",n,"_",i,""),_(1),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)("fill",s.backgroundColor(n,i)),_(1),y("ngIf",t!==s.UNOCCUPIED),_(1),y("ngIf",t!==s.UNOCCUPIED)}}function Uht(r,e){if(1&r&&(A(),S(0,"g"),T(1,Bht,5,9,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Wht(r,e){if(1&r&&(A(),S(0,"g"),F(1,"rect",10)(2,"rect",10),P()),2&r){const t=p();_(1),Ce("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),I("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),_(1),Ce("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),I("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function qht(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=p();I("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let jht=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"UNOCCUPIED",pn.EMPTY),u(this,"lastMove",g.empty()),u(this,"lastPieceMove",g.empty()),u(this,"chosen",g.empty()),u(this,"chosenAutomatically",!1),this.hasAsymmetricBoard=!0,this.rules=U2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,U2.get(),new Fht,new jce),new Xn($localize`MCTS`,new jce,this.rules)],this.encoder=M2.encoder,this.tutorial=(new qce).tutorial,this.canPass=!1}backgroundColor(n,i){return gi.getColorAt(n,i).rgb}isPlayerZero(n){return n.player===k.ZERO}pieceColor(n){return n.color.rgb}piecePlayerClass(n){return this.getPlayerClass(n.player)}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.lastPieceMove=g.empty(),i.canPass=U2.mustPass(s);const o=i.rules.getGameStatus(i.node)!==_e.ONGOING;i.canPass||s.coordToPlay.isAbsent()||o?(i.chosenAutomatically=!1,i.chosen=g.empty()):(i.chosenAutomatically=!0,i.chosen=s.coordToPlay)})()}showLastMove(n){var i=this;return M(function*(){M2.isPiece(n)&&(i.lastPieceMove=g.of(n))})()}pass(){var n=this;return M(function*(){return je(n.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),n.chooseMove(M2.PASS)})()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.canPass)return s.cancelMove(Le.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(n,i);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const c=s.getState().getPieceAtXY(n,i),l=s.getState().getCurrentPlayer();return c.belongsTo(l)?s.chosenAutomatically?s.cancelMove(Gd.PLAY_WITH_SELECTED_PIECE()):(s.chosen=g.of(a),b.SUCCESS):yield s.chooseDestination(n,i)}})()}choosePiece(n,i){var s=this;return M(function*(){const o=s.getState().getPieceAtXY(n,i),a=s.getState().getCurrentOpponent();return o.belongsTo(a)?s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(s.chosen=g.of(new C(n,i)),b.SUCCESS)})()}chooseDestination(n,i){var s=this;return M(function*(){const o=s.chosen.get(),a=new C(n,i),c=M2.of(o,a);return s.chooseMove(c)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=g.empty())}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-kamisado"]],features:[Xe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Uht,2,1,"g",1),T(2,Wht,3,12,"g",2),T(3,qht,1,3,"circle",3),P()),2&n&&(I("viewBox",i.getViewBox())("transform",i.rotation),_(1),y("ngForOf",i.board),_(1),y("ngIf",i.lastPieceMove.isPresent()),_(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Zce=(()=>{var r;class e extends $i{getParallelogramCoords(n){const i=n.parallelogramHeight,s=i*n.horizontalWidthRatio,o=i*n.offsetRatio,a=s,l=s-o,f=i,d=-o,m=i;return[new C(0,0),new C(a,0),new C(l,f),new C(d,m)]}getCoordTranslate(n,i,s,o){const a=o.parallelogramHeight;return new C(n*(a*o.horizontalWidthRatio)+o.offsetRatio*a*(o.abstractBoardSize-i),i*a-o.pieceHeightRatio*a*s)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=ar(r)))(i||r)}}()),u(e,"\u0275cmp",We({type:r,selectors:[["ng-component"]],features:[Xe],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),g4=(()=>{class r{}return u(r,"CANNOT_GO_BACKWARD",()=>$localize`You cannot go backward with normal pieces!`),u(r,"CANNOT_CAPTURE_EMPTY_SPACE",()=>$localize`You cannot capture an empty square, nor jump over it!`),u(r,"CANNOT_SKIP_CAPTURE",()=>$localize`You must capture when it is possible!`),u(r,"MUST_FINISH_CAPTURING",()=>$localize`You must finish this capture!`),u(r,"THIS_PIECE_CANNOT_MOVE",()=>$localize`This piece cannot move!`),u(r,"CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL",()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`),u(r,"MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL",()=>$localize`You must move in a single diagonal step!`),u(r,"CANNOT_CAPTURE_TWICE_THE_SAME_COORD",()=>$localize`You cannot jump over the same square several times!`),r})();var Ud;class W2{static getPlayerOfficer(e){return e===k.ZERO?W2.ZERO_OFFICER:W2.ONE_OFFICER}constructor(e,t){u(this,"player",void 0),u(this,"isOfficer",void 0),this.player=e,this.isOfficer=t}toString(){switch(this){case W2.ZERO:return"u";case W2.ONE:return"v";case W2.ZERO_OFFICER:return"O";default:return U.expectToBe(this,W2.ONE_OFFICER),"X"}}equals(e){return this===e}}u(W2,"ZERO",new(Ud=W2)(k.ZERO,!1)),u(W2,"ONE",new Ud(k.ONE,!1)),u(W2,"ZERO_OFFICER",new Ud(k.ZERO,!0)),u(W2,"ONE_OFFICER",new Ud(k.ONE,!0));class ys{constructor(e){u(this,"pieces",void 0),this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new ys(this.pieces.slice(1))}capturePiece(e){return new ys(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const n of e.pieces)t=t.capturePiece(n);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=W2.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new ys([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),n="";for(;t>0;)n+="_",t--;for(const i of this.pieces)n+=i.toString();return n}}u(ys,"EMPTY",new ys([]));let z1=(()=>{class r extends q1{static getInitialState(){const t=new ys([W2.ZERO]),n=new ys([W2.ONE]),i=ys.EMPTY;return new r([[n,i,n,i,n,i,n],[i,n,i,n,i,n,i],[n,i,n,i,n,i,n],[i,i,i,i,i,i,i],[t,i,t,i,t,i,t],[i,t,i,t,i,t,i],[t,i,t,i,t,i,t]],0)}static of(t,n){return new r(t,n)}static isNotOnBoard(t){return t.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}getStacksOf(t){const n=[];for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++)this.getPieceAtXY(s,i).isCommandedBy(t)&&n.push(new C(s,i));return n}set(t,n){const i=this.getCopiedBoard();return i[t.y][t.x]=n,new r(i,this.turn)}remove(t){return this.set(t,ys.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===k.ZERO?0:r.SIZE-1}toString(){let t=1;for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++){const o=this.getPieceAtXY(s,i).getStackSize();t=Math.max(t,o)}const n=[];for(let i=0;i<r.SIZE;i++){const s=[];for(let o=0;o<r.SIZE;o++)s.push(this.getPieceAtXY(o,i).toString(t));n.push(s.join(" "))}return n.join("\n")}}return u(r,"SIZE",7),r})();class Zht extends ft{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===Do(e.get(t),this.get(t)))return!1;return!0}get(e){return U.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return U.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}var Kce;class qr extends Hi{static of(e,t){return new qr(e,t)}static fromCapture(e){const t=qr.getSteppedOverCoords(e);return t.isSuccess()?re.success(new qr(e,!1)):re.failure(t.getReason())}static getSteppedOverCoords(e){let t=g.empty();const n=new ft;for(const i of e){if(z1.isNotOnBoard(i))return re.failure(au.OUT_OF_RANGE(i));if(t.isPresent()){const s=t.get();if(!1===s.getVectorToward(i).isDiagonalOfLength(2))return re.failure(g4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=s.getCoordsToward(i)[0];if(n.contains(a))return re.failure(g4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}t=g.of(i)}return re.success(n)}static fromStep(e,t){return z1.isNotOnBoard(e)?re.failure(au.OUT_OF_RANGE(e)):z1.isNotOnBoard(t)?re.failure(au.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?re.failure(g4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):re.success(new qr([e,t],!0))}constructor(e,t){super(),u(this,"isStep",void 0),u(this,"coords",void 0),this.isStep=t,this.coords=new Zht(e)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),n=e.coords.size(),i=Math.min(t,n);for(let s=0;s<i;s++)if(!1===this.coords.toList()[s].equals(e.coords.toList()[s]))return"INEQUALITY";return t===n?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return qr.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),n=e.coords.toList()[0];je(t.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),s=en.copy(i),o=e.coords.toList(),a=en.copy(o).slice(1);return qr.fromCapture(s.concat(a)).get()}}Kce=qr,u(qr,"encoder",we.tuple([we.list(C.encoder),we.identity()],r=>[r.coords.toList(),r.isStep],r=>Kce.of(r[0],r[1])));class na extends Kn{static get(){return na.singleton.isAbsent()&&(na.singleton=g.of(new na)),na.singleton.get()}constructor(){super(z1)}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceCaptures(e,s));return n}getPieceCaptures(e,t){let n=[];const o=e.getPieceAt(t).getCommander().player.getOpponent(),a=this.getPieceDirections(e,t),c=e.getPieceAt(t);for(const l of a){const f=t.getNext(l,1);if(z1.isOnBoard(f)&&e.getPieceAt(f).isCommandedBy(o)){const d=f.getNext(l,1);if(z1.isOnBoard(d)&&e.getPieceAt(d).isEmpty()){const m=e.remove(t).remove(f).set(d,c),E=qr.fromCapture([t,d]).get(),w=this.getPieceCaptures(m,d);if(0===w.length)n=n.concat(E);else{const R=w.map(z=>E.concatenate(z));n=n.concat(R)}}}}return n}getPieceDirections(e,t){const s=e.getPieceAt(t).getCommander().player.getScoreModifier(),o=[Me.factory.fromDelta(-1,s).get(),Me.factory.fromDelta(1,s).get()];return e.getPieceAt(t).getCommander().isOfficer&&o.push(Me.factory.fromDelta(-1,-s).get(),Me.factory.fromDelta(1,-s).get()),o}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceSteps(e,s));return n}getPieceSteps(e,t){const n=[],i=this.getPieceDirections(e,t);for(const s of i){const o=t.getNext(s,1);if(z1.isOnBoard(o)&&e.getPieceAt(o).isEmpty()){const a=qr.fromStep(t,o).get();n.push(a)}}return n}applyLegalMove(e,t,n){const i=e.getStartingCoord(),s=e.getEndingCoord();let o=t.getPieceAt(i),a=t.remove(i);if(!1===e.isStep)for(const c of e.getCapturedCoords().get()){const l=t.getPieceAt(c),f=l.getCommander();o=o.capturePiece(f);const d=l.getPiecesUnderCommander();a=a.set(c,d)}if(a=a.set(s,o),s.y===t.getFinishLineOf(t.getCurrentPlayer())){const c=o.promoteCommander();a=a.set(s,c)}return a.incrementTurn()}isLegal(e,t){const n=e.getStartingCoord();if(t.getPieceAt(n).isEmpty())return b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=t.getPieceAt(n),s=t.getCurrentOpponent();if(i.isCommandedBy(s))return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());const o=e.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(o).get().y===s.getScoreModifier())return b.failure(g4.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(o).isEmpty())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(t);return e.isStep?a.length>0?b.failure(g4.CANNOT_SKIP_CAPTURE()):b.SUCCESS:this.isLegalCapture(e,t,a)}isLegalCapture(e,t,n){const i=t.getCurrentPlayer(),s=e.getCapturedCoords().get();for(const o of s){const a=t.getPieceAt(o);if(a.isCommandedBy(i))return b.failure(Le.CANNOT_SELF_CAPTURE());if(a.isEmpty())return b.failure(g4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(o=>o.equals(e))?b.SUCCESS:b.failure(g4.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?_e.ONGOING:_e.getVictory(t.getCurrentOpponent())}}u(na,"singleton",g.empty());const Xce=W2.ZERO,YL=W2.ONE,jr=new ys([Xce]),D1=new ys([YL]),Yht=new ys([Xce,YL]),Kht=new ys([W2.ZERO_OFFICER,YL]),Z=ys.EMPTY;class Qce extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,z1.getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,z1.getInitialState()),q.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,z1.getInitialState(),qr.fromStep(new C(4,4),new C(3,3)).get(),$localize`Congratulations!`),q.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,z1.of([[D1,Z,Z,Z,D1,Z,D1],[Z,Z,Z,D1,Z,D1,Z],[Z,Z,D1,Z,D1,Z,D1],[Z,D1,Z,Z,Z,Z,Z],[jr,Z,jr,Z,jr,Z,jr],[Z,jr,Z,jr,Z,jr,Z],[jr,Z,jr,Z,jr,Z,jr]],2),qr.fromCapture([new C(2,4),new C(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),q.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,z1.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[D1,Z,Z,Z,D1,Z,D1],[Z,D1,Z,D1,Z,D1,Z],[Z,Z,D1,Z,D1,Z,D1],[Z,D1,Z,Z,Z,Z,Z],[Z,Z,jr,Z,jr,Z,jr]],2),qr.fromCapture([new C(2,6),new C(0,4),new C(2,2)]).get(),$localize`Congratulations!`),q.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,z1.of([[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,D1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,D1,Z,D1,Z,Z,Z],[Z,Z,jr,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z]],2)),q.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,z1.of([[Z,Z,Z,Z,Z,Z,D1],[Z,Z,Z,Yht,Z,D1,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,jr,Z,jr,Z,jr]],2),[qr.fromStep(new C(3,1),new C(2,0)).get(),qr.fromStep(new C(3,1),new C(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),q.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,z1.of([[Z,Z,Z,Z,Kht,Z,D1],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,D1,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z],[Z,Z,jr,Z,jr,Z,jr]],2),[qr.fromStep(new C(4,0),new C(3,1)).get(),qr.fromStep(new C(4,0),new C(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)])}}class Jce extends dr{getMetrics(e){const t=e.gameState;return[this.getNumberOfMobileCoords(t,k.ZERO),this.getNumberOfMobileCoords(t,k.ONE)]}getNumberOfMobileCoords(e,t){const i=this.getCapturesAndSteps(e,t).map(o=>o.getStartingCoord());return new ft(i).size()}getCapturesAndSteps(e,t){const n=na.get().getCapturesOf(e,t),i=na.get().getStepsOf(e,t);return n.concat(i)}}class Xht extends Wn{getListMoves(e){const t=na.get().getCaptures(e.gameState);return t.length>0?t:na.get().getSteps(e.gameState)}}class Qht extends Jce{getBoardValue(e){const t=12*super.getBoardValue(e).value;let n=0;for(let i=0;i<z1.SIZE;i++)for(let s=0;s<z1.SIZE;s++){const o=e.gameState.getPieceAtXY(s,i);if(o.getStackSize()>0){const a=o.getStackSize();let c=0;const l=o.getCommander().player;for(;c<a&&o.get(c).player===l;)c++;n+=c*l.getScoreModifier()}}return new e1(t+n)}}function Jht(r,e){if(1&r&&(A(),F(0,"circle",15)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p(2);Ni("id","square_",s.x,"_",s.y,"_piece_",n,"_officer_symbol"),y("ngClass",i.classes),I("cx",.4*o.SPACE_SIZE)("cy",.575*o.SPACE_SIZE)("r",.045*o.SPACE_SIZE)}}function ept(r,e){if(1&r&&(A(),S(0,"g",12),F(1,"use",13),T(2,Jht,1,7,"circle",14),P()),2&r){const t=e.$implicit,n=e.index,i=p().$implicit;I("transform",p(2).getPieceTranslate(n)),_(1),Ni("id","square_",i.x,"_",i.y,"_piece_",n,""),y("ngClass",t.classes),_(1),y("ngIf",t.isOfficer)}}function tpt(r,e){if(1&r){const t=pe();A(),S(0,"g",8)(1,"g",9),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s.x,s.y))}),F(2,"polygon",10),T(3,ept,3,6,"g",11),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();Ce("id","square_at_",n,"_",i,""),_(1),Ce("id","coord_",t.x,"_",t.y,""),I("transform",s.getTranslate(n,i,0)),_(1),Ce("id","square_",t.x,"_",t.y,""),y("ngClass",t.squareClasses),I("points",s.getParallelogramPoints()),_(1),y("ngForOf",t.pieceInfos)}}function npt(r,e){if(1&r&&(A(),S(0,"g"),T(1,tpt,4,10,"g",7),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let rpt=(()=>{var r;class e extends Zce{constructor(n){super(n),u(this,"THICKNESS",40),u(this,"mode",{horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:z1.SIZE}),u(this,"LEFT",0),u(this,"UP",-this.SPACE_SIZE),u(this,"basicWidth",this.mode.abstractBoardSize*this.mode.parallelogramHeight),u(this,"WIDTH",this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio)),u(this,"HEIGHT",this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP),u(this,"CX",this.WIDTH/2),u(this,"CY",(this.HEIGHT+this.UP)/2),u(this,"adaptedBoard",{isAlreadySwitched:!1,spaceInfo:[]}),u(this,"lastMove",g.empty()),u(this,"currentMoveClicks",[]),u(this,"capturedCoords",[]),u(this,"legalMoves",[]),u(this,"moveGenerator",new Xht),this.hasAsymmetricBoard=!0,this.rules=na.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Control`,this.rules,new Jce,this.moveGenerator),new an($localize`Control and Domination`,this.rules,new Qht,this.moveGenerator),new Xn($localize`MCTS`,this.moveGenerator,this.rules)],this.encoder=qr.encoder,this.tutorial=(new Qce).tutorial,this.canPass=!1}updateBoard(n){var i=this;return M(function*(){i.lastMove=i.node.previousMove;const s=i.getState();i.board=s.getCopiedBoard(),i.legalMoves=i.moveGenerator.getListMoves(i.node),i.createAdaptedBoardFrom(s),i.showPossibleMoves(),i.rotateAdaptedBoardIfNeeded()})()}createAdaptedBoardFrom(n){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let o=0;o<z1.SIZE;o++){const a=[];for(let c=0;c<z1.SIZE;c++){const l=this.getSpaceInfo(n,c,o);a.push(l)}this.adaptedBoard.spaceInfo.push(a)}const s=g.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const o=s.get();for(const a of this.getSpaceInfoAt(o).pieceInfos)a.classes.push("selected-stroke");this.showPossibleLandings(o,n)}for(const o of this.capturedCoords)this.getSpaceInfoAt(o).squareClasses.push("captured-fill");for(const o of this.currentMoveClicks)this.getSpaceInfoAt(o).squareClasses.push("moved-fill")}getSpaceInfo(n,i,s){const o=n.getPieceAtXY(i,s),a=[];for(let c=o.getStackSize()-1;c>=0;c--){const l=o.get(c);a.push({classes:[this.getPlayerClass(l.player)],isOfficer:l.isOfficer})}return{pieceInfos:a,x:i,y:s,squareClasses:[]}}showLastMove(n){var i=this;return M(function*(){i.showLastCapture(n),i.showSteppedOnCoord(n)})()}showLastCapture(n){if(!1===n.isStep){const i=n.getCapturedCoords();U.assert(i.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of i.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(n){for(const i of n.coords)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}showPossibleMoves(){if(this.isInteractive)for(const n of this.legalMoves){const i=n.getStartingCoord();this.getSpaceInfoAt(i).squareClasses.push("selectable-fill")}}getSpaceInfoAt(n){if(this.getPointOfView()===k.ONE&&this.adaptedBoard.isAlreadySwitched){const i=z1.SIZE-1,s=new C(i-n.x,i-n.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[n.y][n.x]}rotateAdaptedBoardIfNeeded(){if(this.getPointOfView()===k.ONE){const n=[];for(let i=0;i<z1.SIZE;i++){n[z1.SIZE-1-i]=[];for(let s=0;s<z1.SIZE;s++)n[z1.SIZE-1-i][z1.SIZE-1-s]=this.getSpaceInfoAt(new C(s,i))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:n}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#coord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.getState().getPieceAt(a),l=s.getState().getCurrentOpponent();return c.isCommandedBy(l)?s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(a):s.moveClick(a)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(n){var i=this;return M(function*(){if(n.equals(i.currentMoveClicks[0]))return i.cancelMoveAttempt(),b.SUCCESS;const s=i.getState().getPieceAt(n),o=i.getState().getCurrentPlayer();if(s.isCommandedBy(o))return i.cancelMoveAttempt(),i.trySelectingPiece(n);if(1===i.currentMoveClicks.length&&i.currentMoveClicks[0].getVectorToward(n).isDiagonalOfLength(1)){const c=qr.fromStep(i.currentMoveClicks[0],n).get();return i.chooseMove(c)}return i.capture(n)})()}capture(n){var i=this;return M(function*(){const o=i.currentMoveClicks[i.currentMoveClicks.length-1],a=o.getVectorToward(n);if(a.isDiagonalOfLength(2)){const c=new C(o.x+a.x/2,o.y+a.y/2);i.capturedCoords.push(c),i.currentMoveClicks.push(n);const l=qr.fromCapture(i.currentMoveClicks).get();return i.legalMoves.some(f=>f.isPrefix(l))?i.applyPartialCapture():i.chooseMove(l)}return i.cancelMove(g4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let n=this.getState().remove(this.currentMoveClicks[0]),i=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const o of this.capturedCoords){const a=this.getState().getPieceAt(o),c=a.getCommander(),l=a.getPiecesUnderCommander();n=n.set(o,l),i=i.capturePiece(c)}return n=n.set(this.currentMoveClicks[this.currentMoveClicks.length-1],i),this.createAdaptedBoardFrom(n),this.rotateAdaptedBoardIfNeeded(),b.SUCCESS}trySelectingPiece(n){var i=this;return M(function*(){return i.getState().getPieceAt(n).isEmpty()?i.cancelMove(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.selectPiece(n)})()}selectPiece(n){var i=this;return M(function*(){return i.capturedCoords=[],i.legalMoves.some(s=>s.getStartingCoord().equals(n))?(i.currentMoveClicks=[n],i.hideLastMove(),b.SUCCESS):i.cancelMove(g4.THIS_PIECE_CANNOT_MOVE())})()}showPossibleLandings(n,i){const s=this.rules.getPieceCaptures(i,n);if(0===s.length){const o=this.rules.getPieceSteps(i,n);for(const a of o)this.getSpaceInfoAt(a.getEndingCoord()).squareClasses.push("selectable-fill")}else{const o=s.map(a=>a.coords.get(1));for(const a of o)this.getSpaceInfoAt(a).squareClasses.push("capturable-fill")}}getTranslate(n,i,s){const o=this.getCoordTranslate(n,i,s,this.mode);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(i=>i.x+", "+i.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const n=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(n[0],n[1],n[2],n[3])}getParallelogramCenterOf(n,i,s,o){const a=Math.max(n.x,i.x,s.x,o.x),c=Math.max(n.y,i.y,s.y,o.y),l=Math.min(n.x,i.x,s.x,o.x),f=Math.min(n.y,i.y,s.y,o.y);return new C((a-l)/2,(c-f)/2)}getRightEdge(){const n=this.basicWidth*this.mode.horizontalWidthRatio,i=this.basicWidth*this.mode.offsetRatio;return[i+n,0,i+n,this.THICKNESS,n,this.basicWidth+this.THICKNESS,n,this.basicWidth].join(" ")}getPieceTranslate(n){return"translate(0 "+(this.getParallelogramCenter().y-32.5-n*(.15*this.SPACE_SIZE))+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-lasca"]],features:[Xe],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id",4,"ngFor","ngForOf"],[3,"id"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),P()(),T(5,npt,2,1,"g",4),F(6,"rect",5)(7,"polygon",6),P()),2&n&&(I("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(5),y("ngForOf",i.adaptedBoard.spaceInfo),_(1),I("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),_(1),I("points",i.getRightEdge()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),mi=(()=>{class r extends q1{static getInitialState(){const t=Y.NONE,n=Y.ZERO,i=Y.ONE;return new r([[t,n,n,n,n,n,n,t],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[t,n,n,n,n,n,n,t]],0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}}return u(r,"SIZE",8),r})();class Ui extends Go{static from(e,t){const n=Me.factory.fromMove(e,t);return n.isFailure()?re.failure(n.getReason()):e.isNotInRange(mi.SIZE,mi.SIZE)?re.failure("start coord is not in range"):t.isNotInRange(mi.SIZE,mi.SIZE)?re.failure("end coord is not in range"):re.success(new Ui(e,t,n.get()))}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n,this.direction=Me.factory.fromMove(e,t).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}u(Ui,"encoder",Vs.getFallibleEncoder(Ui.from));let KL=(()=>{class r{}return u(r,"INVALID_MOVE_LENGTH",()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`),u(r,"CANNOT_JUMP_OVER_OPPONENT",()=>$localize`You cannot jump over the opponent's pieces.`),u(r,"PIECE_CANNOT_MOVE",()=>$localize`This piece has no possible move, select another one.`),r})();class s2 extends Kn{static get(){return s2.singleton.isAbsent()&&(s2.singleton=g.of(new s2)),s2.singleton.get()}constructor(){super(mi)}static getNumberOfGroups(e){const t=Rt.create(mi.SIZE,mi.SIZE,-1),n=[0,0];let i=0;for(const s of e.getCoordsAndContents())-1===t[s.coord.y][s.coord.x]&&s.content.isPlayer()&&(i+=1,s2.markGroupStartingAt(e,t,s.coord,i),n[s.content.value]+=1);return n}static markGroupStartingAt(e,t,n,i){const s=[n],o=e.getPieceAt(n);for(;s.length>0;){const a=U.getNonNullable(s.pop());if(-1===t[a.y][a.x]){const c=e.getPieceAt(a);if(c===o){t[a.y][a.x]=i;for(const l of Me.DIRECTIONS){const f=a.getNext(l);e.isOnBoard(f)&&s.push(f)}}else c===Y.NONE&&(t[a.y][a.x]=0)}}}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getStart().y][e.getStart().x]=Y.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new mi(i,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?b.failure(KL.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(n=>t.getPieceAt(n)===t.getCurrentOpponent())?b.failure(KL.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?b.failure(Le.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):b.SUCCESS}isLegal(e,t){return s2.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let i=0;for(const s of s2.getLineCoords(t,n))e.getPieceAt(s).isPlayer()&&(i+=1);return i}static getLineCoords(e,t){const n=s2.getEntranceAndForwardDirection(e,t);let i=n[0];const s=n[1],o=[];for(;mi.isOnBoard(i);)o.push(i),i=i.getNext(s);return o}static getEntranceAndForwardDirection(e,t){switch(t){case Me.UP:case Me.DOWN:return[new C(e.x,0),Me.DOWN];case Me.LEFT:case Me.RIGHT:return[new C(0,e.y),Me.RIGHT];case Me.UP_RIGHT:case Me.DOWN_LEFT:return[new C(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Me.UP_RIGHT];default:return U.expectToBeMultiple(t,[Me.UP_LEFT,Me.DOWN_RIGHT]),[new C(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Me.DOWN_RIGHT]}}static getVictory(e){const[t,n]=s2.getNumberOfGroups(e);return 1===t&&1===n?g.of(Y.NONE):1===t?g.of(k.ZERO):1===n?g.of(k.ONE):g.empty()}static possibleTargets(e,t){const n=[];for(const i of Me.DIRECTIONS){const s=s2.numberOfPiecesOnLine(e,t,i),o=t.getNext(i,s);if(e.isOnBoard(o)){const a=Ui.from(t,o).get();s2.isLegal(a,e).isSuccess()&&n.push(o)}}return n}getGameStatus(e){const t=e.gameState,[n,i]=s2.getNumberOfGroups(t);return 1===n&&i>1?_e.ZERO_WON:n>1&&1===i?_e.ONE_WON:_e.ONGOING}}u(s2,"singleton",g.empty());const V=Y.NONE,S1=Y.ZERO,_1=Y.ONE;class t3e{constructor(){u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new mi([[V,V,V,V,V,V,V,V],[_1,V,V,V,S1,V,V,_1],[V,V,S1,S1,_1,V,V,V],[V,V,V,S1,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V]],0)),q.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,mi.getInitialState(),Ui.from(new C(1,7),new C(1,5)).get(),$localize`Congratulations!`),q.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new mi([[V,V,V,V,V,V,V,V],[V,V,_1,S1,S1,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,S1]],0),[Ui.from(new C(3,1),new C(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),q.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new mi([[V,V,V,V,V,V,_1,V],[V,V,V,V,V,S1,V,V],[V,V,V,V,_1,V,V,V],[V,V,V,S1,V,V,V,V],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,_1,V,_1],[V,V,V,S1,V,V,_1,_1],[V,V,V,S1,V,V,V,V]],0),[Ui.from(new C(3,3),new C(3,0)).get(),Ui.from(new C(3,3),new C(0,0)).get(),Ui.from(new C(3,3),new C(2,3)).get(),Ui.from(new C(3,3),new C(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),q.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new mi([[V,S1,V,S1,S1,S1,S1,V],[_1,V,V,V,V,V,V,_1],[V,V,S1,V,_1,V,V,V],[_1,V,V,V,V,V,V,_1],[_1,V,V,V,V,V,V,_1],[_1,V,V,V,V,V,V,_1],[_1,V,V,V,V,V,V,_1],[V,S1,S1,S1,S1,S1,S1,V]],0),Ui.from(new C(2,2),new C(4,2)).get(),(e,t,n)=>t.getPieceAt(e.getEnd())===Y.ONE?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations!`),q.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new mi([[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[S1,V,V,S1,_1,S1,V,V],[V,V,V,S1,V,V,V,_1],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,_1],[V,V,V,V,V,V,V,V]],0),[Ui.from(new C(0,2),new C(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class ipt extends dr{getMetrics(e){const t=e.gameState,[n,i]=s2.getNumberOfGroups(t);return[100/n,100/i]}}class n3e extends Wn{getListMoves(e){const t=e.gameState,n=[];if(s2.getVictory(t).isPresent())return n;for(let i=0;i<mi.SIZE;i++)for(let s=0;s<mi.SIZE;s++){const o=new C(s,i);if(t.getPieceAt(o).isPlayer())for(const c of s2.possibleTargets(t,o)){const l=Ui.from(o,c).get();n.push(l)}}return n}}function spt(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("cx",i.SPACE_SIZE/2+t*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function opt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"rect",4),T(3,spt,1,6,"circle",5),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","click_",n,"_",i,""),_(1),Ce("id","space_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function apt(r,e){if(1&r&&(A(),S(0,"g"),T(1,opt,4,10,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function cpt(r,e){if(1&r){const t=pe();A(),S(0,"rect",6),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();I("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let lpt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"EMPTY",Y.NONE),u(this,"targets",[]),u(this,"state",void 0),u(this,"selected",g.empty()),u(this,"lastMove",g.empty()),u(this,"captured",g.empty()),this.rules=s2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,this.rules,new ipt,new n3e),new Xn($localize`MCTS`,new n3e,this.rules)],this.encoder=Ui.encoder,this.tutorial=(new t3e).tutorial}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.selected.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(a)===c?s.select(a):s.concludeMove(a)})()}concludeMove(n){var i=this;return M(function*(){const s=Ui.from(i.selected.get(),n);return s.isSuccess()?i.chooseMove(s.get()):i.cancelMove(s.getReason())})()}select(n){var i=this;return M(function*(){return i.getState().getPieceAt(n)!==i.getState().getCurrentPlayer()?i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):(i.selected=g.of(n),i.targets=s2.possibleTargets(i.getState(),i.selected.get()),0===i.targets.length?i.cancelMove(KL.PIECE_CANNOT_MOVE()):b.SUCCESS)})()}updateBoard(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.board=i.getState().board,i.lastMove=i.node.previousMove})()}showLastMove(n){var i=this;return M(function*(){i.captured=i.getPreviousState().getPieceAt(n.getEnd()).isPlayer()?g.of(n.getEnd()):g.empty()})()}cancelMoveAttempt(){this.selected=g.empty(),this.targets=[]}getSquareClasses(n,i){const s=new C(n,i);if(this.lastMove.isPresent()){const o=this.lastMove.get().getStart(),a=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(o)||s.equals(a))return["moved-fill"]}return[]}getPieceClasses(n,i){const s=this.board[i][n],o=new C(n,i),a=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(o)&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-linesofaction"]],features:[Xe],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,apt,2,1,"g",1),T(2,cpt,1,4,"rect",2),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.targets))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var r3e,XL,QL,m4,JL;class jc extends wr{constructor(e,t,n,i={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),u(this,"direction",void 0),u(this,"orientation",void 0),u(this,"captures",void 0),this.direction=t,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}r3e=jc,u(jc,"encoder",new class extends we{encode(r){return{coord:C.encoder.encode(r.coord),direction:r.direction,orientation:r.orientation,captures:r.captures}}decode(r){const e=r;return je(null!=e.coord,"Invalid encoded LodestoneMove"),je(null!=e.direction,"Invalid encoded LodestoneMove"),je(null!=e.orientation,"Invalid encoded LodestoneMove"),je(null!=e.captures,"Invalid encoded LodestoneMove"),new r3e(C.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}});class Ms{constructor(e){u(this,"unreachable",void 0),this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}u(Ms,"UNREACHABLE",new(XL=Ms)(!0)),u(Ms,"EMPTY",new XL(!1));class Ha{static of(e){return e===k.ZERO?Ha.ZERO:Ha.ONE}constructor(e){u(this,"owner",void 0),this.owner=e}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(Ha,"ZERO",new(QL=Ha)(k.ZERO)),u(Ha,"ONE",new QL(k.ONE));class xl{constructor(e,t,n){u(this,"owner",void 0),u(this,"direction",void 0),u(this,"orientation",void 0),this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return xl.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(xl,"LODESTONES",{0:{push:{diagonal:new(m4=xl)(k.ZERO,"push","diagonal"),orthogonal:new m4(k.ZERO,"push","orthogonal")},pull:{diagonal:new m4(k.ZERO,"pull","diagonal"),orthogonal:new m4(k.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new m4(k.ONE,"push","diagonal"),orthogonal:new m4(k.ONE,"push","orthogonal")},pull:{diagonal:new m4(k.ONE,"pull","diagonal"),orthogonal:new m4(k.ONE,"pull","orthogonal")}}});class K1{constructor(e,t){u(this,"width",void 0),u(this,"pieces",void 0),this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?K1.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(je(this.pieces.length+t===3,"should never put more pieces than the plate can support"),g.empty());{const n=en.copy(this.pieces);for(let i=0;i<t;i++)n.push(Ha.of(e));return g.of(new K1(this.width,n))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:Ms.EMPTY}}JL=K1,u(K1,"POSITIONS",["top","bottom","left","right"]),u(K1,"EMPTY_5",new JL(5,[])),u(K1,"EMPTY_3",new JL(3,[]));let v1=(()=>{class r extends q1{static getInitialState(){const t=Ms.EMPTY,n=Ha.ZERO,i=Ha.ONE;return new r([[t,t,n,i,n,i,t,t],[t,n,i,n,i,n,i,t],[n,i,n,i,n,i,n,i],[i,n,i,t,t,n,i,n],[n,i,n,t,t,i,n,i],[i,n,i,n,i,n,i,n],[t,i,n,i,n,i,n,t],[t,t,i,n,i,n,t,t]],0,new Sn,{top:g.of(K1.EMPTY_5),bottom:g.of(K1.EMPTY_5),left:g.of(K1.EMPTY_5),right:g.of(K1.EMPTY_5)})}constructor(t,n,i,s){super(t,n),u(this,"lodestones",void 0),u(this,"pressurePlates",void 0),this.lodestones=i,this.pressurePlates=s}withBoard(t){return new r(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const t=this.remainingSpacesDetails();return t.top+t.bottom+t.left+t.right}remainingSpacesDetails(){const t={top:0,bottom:0,left:0,right:0};for(const n of K1.POSITIONS){const i=this.pressurePlates[n];i.isPresent()&&(t[n]=i.get().remainingSpaces())}return t}numberOfPieces(){const t=[0,0];for(let n=0;n<r.SIZE;n++)for(let i=0;i<r.SIZE;i++){const s=this.getPieceAtXY(i,n);s.isPlayerPiece()&&(t[s.owner.value]+=1)}return t}getScores(){const t=this.numberOfPieces();return[24-t[1],24-t[0]]}nextLodestoneDirection(){const t=this.getCurrentPlayer(),n=this.lodestones.get(t);if(!n.isPresent())return g.empty();{const i=this.getPieceAt(n.get());switch(je(i.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+n.get()),i.direction){case"push":return g.of("pull");case"pull":return g.of("push")}}}}return u(r,"SIZE",8),r})();const Ae=Ms.UNREACHABLE,J=Ms.EMPTY,Ir=Ha.ZERO,Wi=Ha.ONE,Wd=xl.of(k.ONE,{direction:"push",orientation:"orthogonal"}),eR={top:g.of(K1.EMPTY_5),bottom:g.of(K1.EMPTY_5),left:g.of(K1.EMPTY_5),right:g.of(K1.EMPTY_5)};class i3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,v1.getInitialState()),q.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,v1.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),q.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,v1.getInitialState()),q.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,v1.getInitialState()),q.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,v1.getInitialState()),q.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,v1.getInitialState(),new jc(new C(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,n,i)=>32===i.remainingSpaces()?b.failure($localize`You have not captured any of the opponent's pieces, try again!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new v1([[J,J,J,J,Wi,J,J,J],[J,J,Ir,J,J,Wi,J,J],[J,J,Wd,J,J,J,J,Ir],[J,J,J,J,Wi,J,J,Ir],[J,J,J,J,J,Ir,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new Sn([{key:k.ONE,value:new C(2,2)}]),{...eR,top:K1.EMPTY_5.addCaptured(k.ONE,4)}),new jc(new C(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>5===i.pressurePlates.top.get().width?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new v1([[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,Ir],[J,J,J,J,J,Ir,J,Ir],[J,Wd,J,J,Wi,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,Wi,J,J,J],[J,J,J,J,J,J,J,J]],0,new Sn([{key:k.ONE,value:new C(1,4)}]),{...eR,top:K1.EMPTY_3.addCaptured(k.ONE,2)}),new jc(new C(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>i.pressurePlates.top.isPresent()?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):b.SUCCESS,$localize`Congratulations!`),q.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new v1([[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ir,Wi,J,J,Ae,Ae],[Ae,Ae,Wd,Wi,J,J,Ae,Ae],[Ae,Ae,J,Ir,Ir,J,Ae,Ae],[Ae,Ae,Ir,J,J,J,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae]],0,new Sn([{key:k.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:g.empty(),left:g.empty(),right:g.empty()})),q.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new v1([[J,J,J,J,J,J,J,J],[J,J,J,J,J,Wi,J,J],[J,J,J,Wd,J,J,Ir,J],[J,J,Ir,Ir,Wi,J,J,Ir],[J,J,J,J,J,Ir,J,J],[J,J,Ir,J,J,J,J,J],[J,J,Wi,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new Sn([{key:k.ONE,value:new C(3,2)}]),{...eR,top:K1.EMPTY_5.addCaptured(k.ONE,4)}),[new jc(new C(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),q.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new v1([[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae],[Ae,Wi,Ir,Wi,J,J,Ae,Ae],[Ae,Wi,Wd,J,Wi,J,Ae,Ae],[Ae,J,J,Ir,Ir,J,Ae,Ae],[Ae,Wi,Ir,J,Wi,J,Ae,Ae],[Ae,J,J,J,Ir,J,Ae,Ae],[Ae,Ae,Ae,Ae,Ae,Ae,Ae,Ae]],0,new Sn([{key:k.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:K1.EMPTY_3.addCaptured(k.ZERO,2),left:g.of(K1.EMPTY_3),right:g.empty()}),[new jc(new C(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)])}}let Su=(()=>{class r{}return u(r,"MUST_FLIP_LODESTONE",()=>$localize`You must flip your lodestone before putting it back on the board.`),u(r,"MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES",()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`),u(r,"TARGET_IS_CRUMBLED",()=>$localize`You must place your lodestone on a non-crumbled square!`),u(r,"TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE",()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`),u(r,"MUST_PLACE_CAPTURES",()=>$localize`You must place your captures on the pressure plates, on the side of the board.`),u(r,"NO_CAPTURES_TO_PLACE_YET",()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`),r})();class _i extends Kn{static get(){return _i.singleton.isAbsent()&&(_i.singleton=g.of(new _i)),_i.singleton.get()}constructor(){super(v1)}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=i.getOpponent(),o=Rt.copy(n.board),a=t.lodestones.getCopy();a.put(i,e.coord);const c={...t.pressurePlates};return this.updatePressurePlates(o,c,a,s,e.captures),new v1(o,t.turn+1,a,c)}updatePressurePlates(e,t,n,i,s){for(const o of K1.POSITIONS)t[o]=this.updatePressurePlate(e,o,t[o],n,i,s[o])}updatePressurePlate(e,t,n,i,s,o){if(n.isPresent()){const a=n.get().addCaptured(s,o),c=_i.THREATENED_COORD_RANGE.get(t).get();return a.isAbsent()?(this.removePressurePlate(e,c.startForBigPlate,c.direction,i),this.removePressurePlate(e,c.startForSmallPlate,c.direction,i)):a.get().width<n.get().width&&this.removePressurePlate(e,c.startForBigPlate,c.direction,i),a}return n}removePressurePlate(e,t,n,i){for(let s=t;s.isInRange(v1.SIZE,v1.SIZE);s=s.getNext(n)){for(const o of k.PLAYERS)i.get(o).equalsValue(s)&&i.delete(o);e[s.y][s.x]=Ms.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return re.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(i.captures.length,t.remainingSpaces()))return re.failure(Su.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of K1.POSITIONS){const c=t.pressurePlates[a];if(c.isPresent()&&c.get().remainingSpaces()<e.captures[a])return re.failure(Su.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return re.success(i)}applyMoveWithoutPlacingCaptures(e,t,n){let i;const s=Rt.copy(e.board),o=e.lodestones.get(e.getCurrentPlayer());if(o.isPresent()){const a=o.get();s[a.y][a.x]=Ms.EMPTY}return i="pull"===n.direction?this.applyPull(e,s,t,n.orientation):this.applyPush(e,s,t,n.orientation),i.board[t.y][t.x]=xl.of(e.getCurrentPlayer(),n),i.moved.push(t),i}applyPull(e,t,n,i){const s=e.getCurrentPlayer(),o=s.getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let d=n.getNext(f);e.isOnBoard(d);d=d.getNext(f)){const m=t[d.y][d.x],E=d.getNext(f);if(e.isOnBoard(E)){const w=t[E.y][E.x];w.isPlayerPiece()&&w.owner===s&&(m.isEmpty()?(c.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=Ms.EMPTY):m.isPlayerPiece()&&m.owner===o&&(a.push(d),t[d.y][d.x]=w,c.push(E),t[E.y][E.x]=Ms.EMPTY))}}return{board:t,captures:a,moved:c}}applyPush(e,t,n,i){const o=e.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let m=n.getNext(f,v1.SIZE);!1===m.equals(n);m=m.getPrevious(f))if(e.isOnBoard(m)){const E=t[m.y][m.x];if(E.isPlayerPiece()&&E.owner===o){const w=m.getNext(f);if(e.isOnBoard(w)){const R=t[w.y][w.x];R.isUnreachable()?(a.push(m),t[m.y][m.x]=Ms.EMPTY):R.isEmpty()&&(c.push(w),t[w.y][w.x]=E,c.push(m),t[m.y][m.x]=Ms.EMPTY)}else a.push(m),t[m.y][m.x]=Ms.EMPTY}}return{board:t,captures:a,moved:c}}isLegalWithoutCaptures(e,t,n){const i=this.isTargetLegal(e,t);if(i.isFailure())return i;const s=e.nextLodestoneDirection();return!1===(s.isAbsent()||s.equalsValue(n))?b.failure(Su.MUST_FLIP_LODESTONE()):b.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return b.failure(Su.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE());const i=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const n=e.gameState.numberOfPieces();return 0===n[0]&&0===n[1]?_e.DRAW:0===n[0]?_e.ONE_WON:0===n[1]?_e.ZERO_WON:_e.ONGOING}}u(_i,"THREATENED_COORD_RANGE",Sn.from({top:{startForBigPlate:new C(0,0),startForSmallPlate:new C(0,1),direction:Me.RIGHT},bottom:{startForBigPlate:new C(0,v1.SIZE-1),startForSmallPlate:new C(0,v1.SIZE-2),direction:Me.RIGHT},left:{startForBigPlate:new C(0,0),startForSmallPlate:new C(1,0),direction:Me.DOWN},right:{startForBigPlate:new C(v1.SIZE-1,0),startForSmallPlate:new C(v1.SIZE-2,0),direction:Me.DOWN}})),u(_i,"singleton",g.empty());class s3e extends Wn{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,n=>{const i=[];for(const s of this.nextDirection(t)){const o=["diagonal","orthogonal"];for(const a of o){const f=_i.get().applyMoveWithoutPlacingCaptures(t,n,{direction:s,orientation:a}).captures.length;for(const d of this.captureCombinations(t,f))i.push(new jc(n,s,a,d))}}return i})}captureCombinations(e,t){if(0===t)return new ft([{top:0,bottom:0,left:0,right:0}]);{const n=new ft,i=e.remainingSpacesDetails(),s=this.captureCombinations(e,t-1);for(const o of s)o.top+1<=i.top&&n.add({...o,top:o.top+1}),o.bottom+1<=i.bottom&&n.add({...o,bottom:o.bottom+1}),o.left+1<=i.left&&n.add({...o,left:o.left+1}),o.right+1<=i.right&&n.add({...o,right:o.right+1});return 0===n.size()?s:n}}flatMapEmptyCoords(e,t){let n=[];for(let i=0;i<v1.SIZE;i++)for(let s=0;s<v1.SIZE;s++){const o=new C(s,i),a=e.getPieceAt(o);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===e.getCurrentPlayer())&&(n=n.concat(t(o)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}}class upt extends dr{getMetrics(e){return e.gameState.getScores()}}var Va;function fpt(r,e){if(1&r&&(A(),F(0,"circle",10)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();Ce("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function dpt(r,e){if(1&r&&(A(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);l6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),I("points",i.TRIANGLE_OUT)}}function hpt(r,e){if(1&r&&(A(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);l6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),I("points",i.TRIANGLE_IN)}}function ppt(r,e){if(1&r&&(A(),S(0,"g"),T(1,dpt,1,3,"polygon",14),T(2,hpt,1,3,"polygon",14),P()),2&r){const t=p(3).$implicit;_(1),y("ngIf","push"===t.lodestone.direction),_(1),y("ngIf","pull"===t.lodestone.direction)}}const o3e=function(){return[0,1,2,3]};function gpt(r,e){if(1&r&&(A(),S(0,"g",11),F(1,"circle",12)(2,"circle",13),S(3,"g"),T(4,ppt,3,2,"g",1),P()()),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();I("transform",o.getSquareTransform(n,s)),_(1),y("ngClass",i.lodestone.selectedClass),I("r",o.PIECE_RADIUS),_(1),y("ngClass",i.lodestone.pieceClasses),I("r",o.PIECE_RADIUS/4),_(1),l6("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),_(1),y("ngForOf",H1(7,o3e))}}function mpt(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectCoord(i.coord))}),F(1,"rect",7),T(2,fpt,1,6,"circle",8),T(3,gpt,5,8,"g",9),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();Ce("id","square_",n,"_",s,""),_(1),y("ngClass",i.squareClasses),I("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*s+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),_(1),y("ngIf",i.hasPiece),_(1),y("ngIf",i.lodestone)}}function _pt(r,e){if(1&r&&(A(),S(0,"g"),T(1,mpt,4,9,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",!1===t.crumbled)}}function vpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,_pt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Cpt(r,e){if(1&r&&(A(),S(0,"g",16),F(1,"circle",17),P()),2&r){const t=e.$implicit,n=e.index,i=p();Dn("id","capture_",n,""),I("transform",i.getCaptureTransform(n)),_(1),y("ngClass",t.pieceClasses),I("r",i.PIECE_RADIUS)}}function ypt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polygon",15),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p();_(1),l6("transform","rotate(",90*t,")"),y("ngClass",n.movingClass),I("points","push"===n.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Mpt(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){const s=te(t).$implicit;return ne(p().selectLodestone(s))}),F(1,"circle",12)(2,"circle",13),S(3,"g"),T(4,ypt,2,3,"g",1),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p();Ce("id","lodestone_",t.direction,"_",t.orientation,""),I("transform",i.getAvailableLodestoneTransform(n)),_(1),y("ngClass",t.selectedClass),I("r",i.PIECE_RADIUS),_(1),y("ngClass",t.pieceClasses),I("r",i.PIECE_RADIUS/4),_(1),l6("transform","rotate(","diagonal"===t.orientation?45:0,")"),_(1),y("ngForOf",H1(9,o3e))}}function Ept(r,e){if(1&r&&(A(),F(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();Ce("id","platePiece_",s.position,"_",n,""),y("ngClass",i.pieceClasses),I("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Spt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"g",6),W("click",function(){const i=te(t),s=i.$implicit,o=i.index,a=p().$implicit;return ne(p().onPressurePlateClick(s.temporary,a.position,o))}),F(2,"rect",18),T(3,Ept,1,6,"circle",8),P()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();I("transform",s.getPressurePlateTransform(i.position)),_(1),Ce("id","plate_",i.position,"_",n,""),_(1),Ce("id","plateSquare_",i.position,"_",n,""),y("ngClass",t.squareClasses),I("x",s.SPACE_SIZE*t.coord.x+s.STROKE_WIDTH)("y",s.SPACE_SIZE*t.coord.y+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.hasPiece)}}function Ppt(r,e){if(1&r&&(A(),S(0,"g",16),T(1,Spt,4,11,"g",1),P()),2&r){const t=e.$implicit;Dn("id","pressurePlate_",t.position,""),_(1),y("ngForOf",t.coords)}}function Tpt(r,e){if(1&r&&(A(),F(0,"rect",19)),2&r){const t=p();Ce("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),I("x",t.SPACE_SIZE*t.viewInfo.selected.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class Ll extends Hc{constructor(e){super(e),u(this,"PIECE_RADIUS",void 0),u(this,"TRIANGLE_OUT",void 0),u(this,"TRIANGLE_IN",void 0),u(this,"viewInfo",{availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:g.empty(),pressurePlateShift:{top:new Et(0,0),left:new Et(0,0),right:new Et(0,0),bottom:new Et(0,0)}}),u(this,"displayedState",void 0),u(this,"stateAfterPlacingLodestone",g.empty()),u(this,"lastInfos",g.empty()),u(this,"capturesToPlace",0),u(this,"selectedCoord",g.empty()),u(this,"selectedLodestone",g.empty()),u(this,"captures",{top:0,bottom:0,left:0,right:0}),this.rules=_i.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new i3e).tutorial,this.availableAIs=[new an($localize`Score`,this.rules,new upt,new s3e),new Xn($localize`MCTS`,new s3e,this.rules)],this.encoder=jc.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,i=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${i} ${n},-${i}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`,this.displayedState=this.getState(),this.scores=g.of([0,0])}selectCoord(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(Su.MUST_PLACE_CAPTURES());const i=_i.get().isTargetLegal(t.getState(),e);return i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedCoord=g.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}selectLodestone(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(n.isFailure())return t.cancelMove(n.getReason());je(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const i=t.getCurrentPlayer(),s=xl.of(i,e);return t.selectedLodestone.equalsValue(s)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedLodestone=g.of(s),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}putLodestone(){var e=this;return M(function*(){je(e.selectedCoord.isPresent(),"coord should have been selected"),je(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=e.getState();je(_i.get().isLegalWithoutCaptures(i,t,n.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=_i.get().applyMoveWithoutPlacingCaptures(i,t,n);return e.lastInfos=g.of(o),e.capturesToPlace=Math.min(o.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(o.board),e.stateAfterPlacingLodestone=g.of(e.displayedState),e.updateViewInfo(),b.SUCCESS)})()}applyMove(){var e=this;return M(function*(){je(e.selectedCoord.isPresent(),"coord should have been selected"),je(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=new jc(t,n.direction,n.orientation,e.captures);return e.chooseMove(i)})()}onPressurePlateClick(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}selectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());if(0===n.capturesToPlace)return n.cancelMove(Su.NO_CAPTURES_TO_PLACE_YET());n.capturesToPlace--,n.captures[e]++;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentOpponent(),a=Rt.copy(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return _i.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new v1(a,s.turn,l,c),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS)})()}deselectPressurePlate(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.capturesToPlace++,n.captures[e]--;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentOpponent(),a=Rt.copy(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return _i.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new v1(a,s.turn,l,c),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS})()}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt(),t.scores=g.of(t.getState().getScores())})()}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=g.empty(),this.lastInfos=g.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=Rt.copy(this.displayedState.board);t[e.get().y][e.get().x]=Ms.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=g.empty(),this.selectedLodestone=g.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<v1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<v1.SIZE;t++){const n=new C(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:g.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=xl.of(e,t),i={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return i.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of K1.POSITIONS){const t=[],n=this.displayedState.pressurePlates[e];if(n.isPresent()){const i=Ll.PRESSURE_PLATES_POSITIONS.get(e).get(),s=n.get().width;let o=5===s?i.startForBigPlate:i.startForSmallPlate;for(let a=0;a<s;a++){o=o.getNext(i.direction);const c=n.get().getPieceAt(a);let l="";c.isPlayerPiece()&&(l=this.getPlayerClass(c.owner)),t.push({coord:o,hasPiece:c.isPlayerPiece(),pieceClasses:[l],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(e){var t=this;return M(function*(){const n=t.getPreviousState();t.lastInfos=g.of(_i.get().applyMoveWithoutPlacingCaptures(n,e.coord,e)),t.updateViewInfo();const i=t.getState();t.showPressurePlateDifferences(n,i,!1)})()}showPressurePlateDifferences(e,t,n){for(const i of K1.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[i],t.pressurePlates[i],i,n)}showPressurePlateDifference(e,t,n,i){if(e.isPresent()&&t.isPresent()){const s=e.get(),o=t.get(),a=U.getNonNullable(this.viewInfo.pressurePlates.find(c=>c.position===n));if(s.width===o.width)for(let c=0;c<o.width;c++){const l=s.getPieceAt(c),f=o.getPieceAt(c);!1===l.equals(f)&&(a.coords[c].squareClasses.push("moved-fill"),a.coords[c].temporary=i,i&&a.coords[c].pieceClasses.push("semi-transparent"))}else for(const c of a.coords)c.squareClasses.push("moved-fill")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),i=this.getPressurePlateShift(e.pressurePlates.top),s=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Et(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new Et(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new Et(0,.5*(i-s)),this.viewInfo.pressurePlateShift.right=new Et(0,.5*(i-s))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(v1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(v1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}var qd,a3e;Va=Ll,u(Ll,"PRESSURE_PLATE_EXTRA_SHIFT",.2),u(Ll,"PRESSURE_PLATES_POSITIONS",Sn.from({top:{startForBigPlate:new C(.5,-1-Va.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,0-Va.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},bottom:{startForBigPlate:new C(.5,8+Va.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,7+Va.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},left:{startForBigPlate:new C(-1-Va.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(0-Va.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN},right:{startForBigPlate:new C(8+Va.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(7+Va.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN}})),u(Ll,"\u0275fac",function(e){return new(e||Va)(B(Ut))}),u(Ll,"\u0275cmp",We({type:Va,selectors:[["app-lodestone"]],features:[Xe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),T(1,vpt,2,1,"g",1),T(2,Cpt,2,4,"g",2),T(3,Mpt,5,10,"g",3),T(4,Ppt,2,2,"g",2),T(5,Tpt,1,6,"rect",4),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.boardInfo),_(1),y("ngForOf",t.viewInfo.capturesToPlace),_(1),y("ngForOf",t.viewInfo.availableLodestones),_(1),y("ngForOf",t.viewInfo.pressurePlates),_(1),y("ngIf",t.viewInfo.selected.isPresent()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Ot{static tryMerge(e,t){je(e!==Ot.EMPTY&&t!==Ot.EMPTY,"tryMerge cannot be called with empty pieces");const i=e.value+t.value;return 2===i||3===i?g.of(Ot.of(i)):g.empty()}static of(e){return e===Ot.DRONE.value?Ot.DRONE:(U.expectToBe(e,Ot.QUEEN.value),Ot.QUEEN)}constructor(e){u(this,"value",void 0),this.value=e}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}u(Ot,"EMPTY",new(qd=Ot)(0)),u(Ot,"PAWN",new qd(1)),u(Ot,"DRONE",new qd(2)),u(Ot,"QUEEN",new qd(3));class z0{static of(e){const t=new Sn;for(const n of e)z0.addToMap(t,n);return new z0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}constructor(e){u(this,"captures",void 0),this.captures=e,e.makeImmutable()}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return z0.addToMap(t,e),new z0(t)}}class bn extends q1{static getInitialState(){const e=Ot.EMPTY,t=Ot.PAWN,n=Ot.DRONE,i=Ot.QUEEN;return new bn([[i,i,n,e],[i,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,i],[e,n,i,i]],0,g.empty())}static isOnBoard(e){return e.isInRange(bn.WIDTH,bn.HEIGHT)}constructor(e,t,n=g.empty(),i=g.empty(),s){super(e,t),u(this,"lastMove",void 0),u(this,"countDown",void 0),u(this,"captured",void 0),this.lastMove=n,this.countDown=i,null==s&&(s=new Sn([{key:k.ZERO,value:z0.of([])},{key:k.ONE,value:z0.of([])}])),s.makeImmutable(),this.captured=s}getPlayerTerritory(e){return e===k.ZERO?bn.PLAYER_ZERO_TERRITORY:bn.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const i of n)for(let s=0;s<bn.WIDTH;s++)if(this.getPieceAtXY(s,i)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(k.ZERO)?g.of(k.ZERO):this.isTerritoryEmpty(k.ONE)?g.of(k.ONE):g.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let i=0;i<bn.WIDTH;i++)if(this.getPieceAtXY(i,n)!==Ot.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(Ot.PAWN).getOrElse(0),t.captures.get(Ot.DRONE).getOrElse(0),t.captures.get(Ot.QUEEN).getOrElse(0)]}}u(bn,"WIDTH",4),u(bn,"HEIGHT",8),u(bn,"PLAYER_ZERO_TERRITORY",new ft([4,5,6,7])),u(bn,"PLAYER_ONE_TERRITORY",new ft([0,1,2,3]));let FC=(()=>{class r{}return u(r,"START_COORD_OUT_OF_RANGE",()=>$localize`Start coord cannot be out of range`),u(r,"END_COORD_OUT_OF_RANGE",()=>$localize`End coord cannot be out of range`),u(r,"PAWN_MUST_MOVE_ONE_DIAGONAL_STEP",()=>$localize`Pawns must move one step diagonally.`),u(r,"DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS",()=>$localize`Drones must move one or two steps in any direction.`),r})();class kr extends Go{static from(e,t,n=!1){if(!1===bn.isOnBoard(e))return re.failure(FC.START_COORD_OUT_OF_RANGE());if(!1===bn.isOnBoard(t))return re.failure(FC.END_COORD_OUT_OF_RANGE());if(t.equals(e))return re.failure(Le.MOVE_CANNOT_BE_STATIC());const i=Me.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?re.failure(i.getReason()):re.success(new kr(e,t,n))}constructor(e,t,n){super(e,t),u(this,"calledTheClock",void 0),this.calledTheClock=n}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}a3e=kr,u(kr,"encoder",we.tuple([C.encoder,C.encoder,we.identity()],r=>[r.getStart(),r.getEnd(),r.calledTheClock],r=>a3e.from(r[0],r[1],r[2]).get()));let c3e=(()=>{class r{}return u(r,"YOU_DID_NOT_CAPTURE_ANY_PIECE",()=>$localize`Failed, you did not capture any piece.`),r})();const X=Ot.EMPTY,vi=Ot.PAWN,_4=Ot.DRONE,Rl=Ot.QUEEN;class l3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,bn.getInitialState()),q.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,bn.getInitialState()),q.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,bn.getInitialState(),kr.from(new C(2,5),new C(1,4)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===Ot.PAWN?b.SUCCESS:b.failure($localize`This is not a pawn!`),$localize`Congratulations!`),q.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,bn.getInitialState(),kr.from(new C(1,7),new C(0,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===Ot.DRONE?b.SUCCESS:b.failure($localize`This is not a drone!`),$localize`Congratulations!`),q.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new bn([[_4,vi,X,X],[Rl,X,X,X],[X,X,X,X],[X,X,Rl,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[Rl,_4,vi,X]],1),kr.from(new C(2,3),new C(2,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===Ot.QUEEN?b.SUCCESS:b.failure($localize`This is not a queen!`),$localize`Congratulations!`),q.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new bn([[_4,vi,vi,X],[X,X,X,X],[Rl,X,X,X],[X,X,X,X],[X,X,vi,X],[X,X,X,X],[X,X,X,X],[X,_4,vi,X]],1),[kr.from(new C(0,2),new C(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,c3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),q.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new bn([[X,X,X,Rl],[X,vi,X,X],[X,X,vi,X],[X,X,X,X],[X,X,X,X],[X,X,X,Rl],[X,X,_4,X],[X,vi,X,X]],1),[kr.from(new C(1,1),new C(2,2)).get(),kr.from(new C(2,2),new C(1,1)).get()],$localize`Congratulations!`,$localize`This is not a field promotion!`),q.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new bn([[vi,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,_4,X],[X,vi,X,X]],0),kr.from(new C(1,7),new C(2,6)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===Ot.QUEEN?b.SUCCESS:b.failure($localize`This is not a field promotion!`),$localize`Congratulations!`),q.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,bn.getInitialState(),kr.from(new C(1,5),new C(0,4),!0).get(),(t,n,i)=>t.calledTheClock?b.SUCCESS:b.failure($localize`You did not call the clock!`),$localize`Congratulations!`),q.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new bn([[X,X,X,X],[X,vi,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,vi],[X,X,_4,X],[X,vi,X,X]],15,g.empty(),g.of(1)),[kr.from(new C(1,1),new C(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),q.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new bn([[X,X,X,Rl],[X,vi,X,X],[X,X,X,X],[X,X,X,X],[X,X,X,X],[_4,X,X,X],[X,X,X,X],[X,_4,X,X]],15,g.empty(),g.of(1)),kr.from(new C(1,1),new C(2,2)).get(),$localize`Congratulations!`),q.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new bn([[X,X,X,Rl],[X,vi,X,X],[X,X,X,X],[X,X,X,X],[X,X,vi,X],[X,X,X,X],[X,X,X,X],[X,X,X,X]],0),kr.from(new C(2,4),new C(1,3)).get(),(t,n,i)=>3===t.getEnd().y?b.SUCCESS:b.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)])}}let $C=(()=>{class r{}return u(r,"MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY",()=>$localize`You must pick a piece from your side of the board in order to move it.`),u(r,"CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT",()=>$localize`This is not a valid promotion nor a valid capture.`),u(r,"CANNOT_UNDO_LAST_MOVE",()=>$localize`You cannot perform a move that is the reverse of the previous one.`),r})();class Fa extends Kn{static get(){return Fa.singleton.isAbsent()&&(Fa.singleton=g.of(new Fa)),Fa.singleton.get()}constructor(){super(bn)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();i[e.getStart().y][e.getStart().x]=Ot.EMPTY;const s=n.finalPiece;i[e.getEnd().y][e.getEnd().x]=s;const o=n.score;let a=t.countDown;if(a.isPresent())if(this.isCapture(e,t))a=Fa.STARTING_COUNT_DOWN;else{const l=t.countDown.get();a=g.of(l-1)}return e.calledTheClock&&(a=Fa.STARTING_COUNT_DOWN),new bn(i,t.turn+1,g.of(e),a,o)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return n.toOtherFallible();if(e.isUndoneBy(t.lastMove))return re.failure($C.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const i=t.getPieceAt(e.getStart()),s=t.captured.getCopy();if(this.isCapture(e,t)){const a=t.getCurrentPlayer();let c=s.get(a).get();const l=t.getPieceAt(e.getEnd());c=c.add(l),s.replace(a,c),s.makeImmutable()}return re.success({finalPiece:i,score:s})}assertNonDoubleClockCall(e,t){je(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==Ot.EMPTY;return n&&i}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==Ot.EMPTY;return n&&i}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return re.failure($C.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(t.isTherePieceOnPlayerSide(i))return re.failure($C.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const s={finalPiece:i,score:t.captured.getCopy()};return re.success(s)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return b.failure($C.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=t.getPieceAt(e.getStart());if(i===Ot.EMPTY)return b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===Ot.PAWN)return e.isValidForPawn()?b.SUCCESS:b.failure(FC.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===Ot.DRONE&&!1===e.isValidForDrone())return b.failure(FC.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const s of e.getStart().getUntil(e.getEnd()))if(t.getPieceAt(s)!==Ot.EMPTY)return b.failure(Le.SOMETHING_IN_THE_WAY());return b.SUCCESS}getPromotedPiece(e,t){const n=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd());return Ot.tryMerge(n,i)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,_e.DRAW);if(t.getEmptyTerritory().isPresent()){const i=t.getCurrentOpponent(),s=_e.getVictory(i);return this.getGameStatusScoreVictoryOr(t,s)}return _e.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(k.ZERO),i=e.getScoreOf(k.ONE);return n>i?_e.ZERO_WON:i>n?_e.ONE_WON:t}}u(Fa,"STARTING_COUNT_DOWN",g.of(7)),u(Fa,"singleton",g.empty());class u3e extends Wn{getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=t.getPlayerTerritory(n);let s=[];for(const o of i)for(let a=0;a<bn.WIDTH;a++)switch(t.getPieceAtXY(a,o)){case Ot.PAWN:s=s.concat(this.getMovesForPawnAt(t,a,o));break;case Ot.DRONE:s=s.concat(this.getMovesForDroneAt(t,a,o));break;case Ot.QUEEN:s=s.concat(this.getMovesForQueenAt(t,a,o))}return s}getMovesForPawnAt(e,t,n){const i=new C(t,n),s=[];for(const o of Me.DIAGONALS){const a=i.getNext(o);bn.isOnBoard(a)&&s.push(a)}return this.addLegalMoves(e,i,s)}addLegalMoves(e,t,n){const i=[],s=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(Ot.DRONE),a=!1===e.isTherePieceOnPlayerSide(Ot.QUEEN),c=e.lastMove;for(const l of n){const f=e.getPieceAt(l);if(f===Ot.EMPTY)this.add(i,kr.from(t,l).get(),c);else if(e.isInPlayerTerritory(l)){const d=Ot.tryMerge(f,s);if(d.isPresent()){const m=d.get(),E=kr.from(t,l).get();(m===Ot.DRONE&&o||m===Ot.QUEEN&&a)&&this.add(i,E,c)}}else this.add(i,kr.from(t,l).get(),c)}return i}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const i=new C(t,n),s=this.getLandingCoordsForLinearMove(i,e,2);return this.addLegalMoves(e,i,s)}getLandingCoordsForLinearMove(e,t,n){const i=[];for(const s of Me.DIRECTIONS){let o=1,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(Ot.EMPTY);for(;l;)i.push(a),o++,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(Ot.EMPTY)&&o<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(e,t,n){const i=new C(t,n),s=this.getLandingCoordsForQueen(i,e);return this.addLegalMoves(e,i,s)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,bn.HEIGHT)}}class Opt extends dr{getMetrics(e){return[e.gameState.getScoreOf(k.ZERO),e.gameState.getScoreOf(k.ONE)]}}function bpt(r,e){if(1&r&&(A(),F(0,"g",19)),2&r){const t=p(2).index,n=p().index,i=p();ri(i.style),Ce("mainShapeId","pawn_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function wpt(r,e){if(1&r&&(A(),F(0,"g",20)),2&r){const t=p(2).index,n=p().index,i=p();ri(i.style),Ce("mainShapeId","drone_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Npt(r,e){if(1&r&&(A(),F(0,"g",21)),2&r){const t=p(2).index,n=p().index,i=p();ri(i.style),Ce("mainShapeId","queen_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Apt(r,e){if(1&r&&(A(),S(0,"g"),T(1,bpt,1,5,"g",16),T(2,wpt,1,5,"g",17),T(3,Npt,1,5,"g",18),P()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();I("transform",o.getPieceLocation(n,s)),_(1),y("ngIf",i===o.pieces.PAWN),_(1),y("ngIf",i===o.pieces.DRONE),_(1),y("ngIf",i===o.pieces.QUEEN)}}function Ipt(r,e){if(1&r){const t=pe();A(),S(0,"g",14),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",15),T(2,Apt,4,4,"g",13),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();Ce("id","click_",n,"_",i,""),I("transform",s.getPieceTranslation(i)),_(1),Ce("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.pieces.EMPTY)}}function kpt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",22),W("click",function(){const s=te(t).$implicit;return ne(p(3).onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p(3);_(1),Ce("id","indicator_",t.x,"_",t.y,""),I("transform",n.getPieceTranslation(t.y))("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function xpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,kpt,2,7,"g",1),P()),2&r){const t=p(2);_(1),y("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function Lpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Ipt,3,11,"g",12),T(2,xpt,2,1,"g",13),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",t),_(1),y("ngIf",n.selectedPieceInfo.isPresent())}}function Rpt(r,e){if(1&r&&(A(),S(0,"text",23),ct(1),P()),2&r){const t=p();y("ngClass","player"+t.getCurrentPlayer().value)("ngClass",t.getClockCircleClasses()),I("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),_(1),An(t.countDown.get())}}function zpt(r,e){if(1&r&&(A(),F(0,"polyline",24)),2&r){const t=p();y("ngClass",t.getClockCircleClasses()),I("points",t.clockNeedlesPoints)}}const GC=function(r){return[r]};function Dpt(r,e){if(1&r){const t=pe();A(),Gt(0),S(1,"g",27),W("click",function(){const s=te(t).index;return ne(p(2).chooseStyle(s))}),P(),Bt()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);_(1),ri(t.style),y("id",t.name)("pieceClasses",va(5,GC,"player"+i.getCurrentPlayer().value+"-fill")),I("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function Hpt(r,e){if(1&r&&(A(),S(0,"g",25),F(1,"rect",26),T(2,Dpt,2,7,"ng-container",1),P()),2&r){const t=p();_(1),I("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),_(1),y("ngForOf",t.listOfStyles)}}function Vpt(r,e){if(1&r&&(A(),S(0,"text",33),ct(1),P()),2&r){const t=p(2).$implicit,n=p().$implicit,i=p();y("ngClass",i.getPlayerClass(n)),I("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),_(1),An(t+" x ")}}function Fpt(r,e){if(1&r&&(A(),F(0,"g",34)),2&r){const t=p(3).$implicit,n=p();ri(n.style),y("pieceClasses",va(3,GC,n.getPlayerClass(t)))}}function $pt(r,e){if(1&r&&(A(),F(0,"g",35)),2&r){const t=p(3).$implicit,n=p();ri(n.style),y("pieceClasses",va(3,GC,n.getPlayerClass(t)))}}function Gpt(r,e){if(1&r&&(A(),F(0,"g",36)),2&r){const t=p(3).$implicit,n=p();ri(n.style),y("pieceClasses",va(3,GC,n.getPlayerClass(t)))}}function Bpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Vpt,2,4,"text",29),S(2,"g",28),T(3,Fpt,1,5,"g",30),T(4,$pt,1,5,"g",31),T(5,Gpt,1,5,"g",32),P()()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();I("transform","translate(0, "+2*n*o.SPACE_SIZE+")"),_(1),y("ngIf",i>1),_(1),Ce("id","piece_",n,"_player_",s.value,""),I("transform","translate("+o.SPACE_SIZE+", 0)"),_(1),y("ngIf",0===n),_(1),y("ngIf",1===n),_(1),y("ngIf",2===n)}}function Upt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Bpt,6,8,"g",13),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t>0)}}function Wpt(r,e){if(1&r&&(A(),S(0,"g")(1,"g",28),T(2,Upt,2,1,"g",1),P()()),2&r){const t=e.$implicit,n=p();_(1),Dn("id","capture_of_player_",t.value,""),I("transform",n.getCapturesTransformation(t)),_(1),y("ngForOf",n.state.getCapturesOf(t))}}let Es=(()=>{var r;class e extends $i{static getRegularPolygon(n,i=0){const s=e.getRegularPolygonCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStar(n,i){const s=this.getNPointedStarCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStarCoords(n,i){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;n*=2;for(let c=0;c<n;c++){const f=(c*(360/n)+i)/180*Math.PI,d=c%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,m=o+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f);s.push(new C(m,E))}return s}static getRegularPolygonCoords(n,i=0){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;for(let c=0;c<n;c++){const f=(c*(360/n)-90)/180*Math.PI,d=.5*e.SPACE_SIZE,m=o+.8*d*Math.cos(f),E=a+.8*d*Math.sin(f)+i;s.push(new C(m,E))}return s}static mapCoordsToString(n){let i="";for(const s of n)i+=s.x+", "+s.y+" ";return i}static getRadius(n){return this.SPACE_SIZE*n/10}constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"HORIZONTAL_CENTER",.5*bn.WIDTH*e.SPACE_SIZE),u(this,"UNSTROKED_HEIGHT",bn.HEIGHT*e.SPACE_SIZE),u(this,"VERTICAL_CENTER",.5*this.UNSTROKED_HEIGHT+e.STROKE_WIDTH),u(this,"LEFT",e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2),u(this,"UNSTROKED_WIDTH",bn.WIDTH*e.SPACE_SIZE),u(this,"UP",-e.STROKE_WIDTH/2),u(this,"WIDTH",this.UNSTROKED_WIDTH+2.5*e.SPACE_SIZE+e.STROKE_WIDTH),u(this,"HEIGHT",this.UNSTROKED_HEIGHT+3*e.STROKE_WIDTH),u(this,"MartianChessComponent",e),u(this,"style",{shape:"Circle",points:"Horizontal Points"}),u(this,"pieces",Ot),u(this,"state",void 0),u(this,"configViewTranslation",void 0),u(this,"configCogTransformation",void 0),u(this,"selectedPieceInfo",g.empty()),u(this,"countDown",g.empty()),u(this,"callTheClock",!1),u(this,"displayModePanel",!1),u(this,"listOfStyles",[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}]),u(this,"clockNeedlesPoints",void 0),this.hasAsymmetricBoard=!0,this.rules=Fa.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Score`,this.rules,new Opt,new u3e),new Xn($localize`MCTS`,new u3e,this.rules)],this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=kr.encoder,this.tutorial=(new l3e).tutorial,this.scores=g.of([0,0])}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const n=this.STROKE_WIDTH,s=(this.SPACE_SIZE-n)/40;return"translate("+1*n+", "+1*n+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const n=.5*this.SPACE_SIZE;return n+" "+.1*this.SPACE_SIZE+", "+n+" "+n+", "+.75*this.SPACE_SIZE+" "+n}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board;const s=i.state.getScoreOf(k.ZERO),o=i.state.getScoreOf(k.ONE);i.countDown=i.state.countDown,i.scores=g.of([s,o])})()}getPieceLocation(n,i){return"translate("+this.SPACE_SIZE*n+", "+this.SPACE_SIZE*i+")"}getPieceClasses(n,i){const s=new C(n,i),o=[];return o.push(i>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&o.push("selected-stroke"),this.node.previousMove.isPresent()&&this.node.previousMove.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==Ot.EMPTY&&this.getState().isInOpponentTerritory(new C(0,i))&&o.push("last-move-stroke"),o}onClick(n,i){var s=this;return M(function*(){s.displayModePanel=!1;const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);return s.selectedPieceInfo.isPresent()?s.secondClick(a):s.firstClick(a)})()}firstClick(n){var i=this;return M(function*(){return i.isOneOfUsersPieces(n)?i.selectAsFirstPiece(n):(i.cancelMoveAttempt(),b.SUCCESS)})()}selectAsFirstPiece(n){var i=this;return M(function*(){const s=i.getLegalLandings(n);return i.selectedPieceInfo=g.of({selectedPiece:n,legalLandings:s}),b.SUCCESS})()}getLegalLandings(n){const i=this.state.getPieceAt(n);let s;return s=i===Ot.PAWN?Me.DIAGONALS.map(o=>n.getNext(o)):this.getValidLinearLandingSquareUntil(n,i===Ot.DRONE?2:bn.HEIGHT),s.filter(o=>{const a=kr.from(n,o);return!!a.isSuccess()&&this.rules.isLegal(a.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(n,i){return Me.DIRECTIONS.flatMap(s=>{const o=[];let a=n.getNext(s),c=1;for(;bn.isOnBoard(a)&&c<=i&&(o.push(a),this.getState().getPieceAt(a)===Ot.EMPTY);)a=a.getNext(s),c++;return o})}secondClick(n){var i=this;return M(function*(){const s=i.selectedPieceInfo.get();if(s.selectedPiece.equals(n))return i.cancelMoveAttempt(),b.SUCCESS;if(s.legalLandings.some(o=>o.equals(n))){const o=kr.from(s.selectedPiece,n,i.callTheClock);return U.assert(o.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),i.chooseMove(o.get())}if(i.isOneOfUsersPieces(n))return i.selectAsFirstPiece(n);{const o=kr.from(s.selectedPiece,n,i.callTheClock);return o.isSuccess()?i.chooseMove(o.get()):i.cancelMove(o.getReason())}})()}isOneOfUsersPieces(n){return this.state.getPieceAt(n)!==Ot.EMPTY&&this.state.isInPlayerTerritory(n)}cancelMoveAttempt(){this.selectedPieceInfo=g.empty(),this.callTheClock=!1}onClockClick(){var n=this;return M(function*(){const i=yield n.canUserPlay("#clockOrCountDownView");return i.isFailure()?n.cancelMove(i.getReason()):(n.getState().countDown.isAbsent()&&(n.callTheClock=!1===n.callTheClock),b.SUCCESS)})()}getClockCircleClasses(){const n=["base"];return this.callTheClock&&n.push("selected-stroke"),this.getCurrentPlayer()===k.ZERO?n.push("player0-stroke"):n.push("player1-stroke"),n}getSquareClasses(n,i){const s=new C(n,i),o=["base"];if(this.node.previousMove.isPresent()){const a=this.node,c=a.previousMove.get();c.getStart().equals(s)?o.push("moved-fill"):c.getEnd().equals(s)&&(a.parent.get().gameState.getPieceAt(s)===Ot.EMPTY||a.gameState.isInOpponentTerritory(new C(0,i))?o.push("moved-fill"):o.push("captured-fill"))}return o}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(n){this.style=this.listOfStyles[n].style,this.displayModePanel=!1}getPieceTranslation(n){return"translate(0, "+(n<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.getPointOfView().value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(n){const s=-this.SPACE_SIZE/2;let o=this.SPACE_SIZE/2;return n===this.getPointOfView()&&(o+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+s+", "+o+")"}}return r=e,u(e,"SPACE_SIZE",100),u(e,"STROKE_WIDTH",8),u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-martian-chess"]],features:[Xe],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),T(2,Lpt,3,2,"g",1),P(),S(3,"g",2),W("click",function(){return i.onClockClick()}),F(4,"rect",3)(5,"circle",4),T(6,Rpt,2,5,"text",5),T(7,zpt,1,2,"polyline",6),P(),S(8,"g",7)(9,"g",8),W("click",function(){return i.onModeCogClick()}),F(10,"rect",3)(11,"path",9),P(),T(12,Hpt,3,5,"g",10),P(),S(13,"g",11),T(14,Wpt,3,3,"g",1),P()()),2&n&&(I("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),_(1),I("transform",i.getBoardTransformation()),_(1),y("ngForOf",i.board),_(1),I("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),_(1),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getClockCircleClasses()),I("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),_(1),y("ngIf",i.countDown.isPresent()),_(1),y("ngIf",i.countDown.isAbsent()),_(1),I("transform",i.configViewTranslation),_(2),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngClass",i.getPlayerClass(i.getCurrentPlayer())),I("transform",i.configCogTransformation),_(1),y("ngIf",i.displayModePanel),_(2),y("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),$a=(()=>{class r extends q1{static getInitialState(){const t=Rt.create(r.WIDTH,r.HEIGHT,Y.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"WIDTH",7),u(r,"HEIGHT",6),r})();var v4;class ir extends Hi{static of(e){switch(e){case 0:return ir.ZERO;case 1:return ir.ONE;case 2:return ir.TWO;case 3:return ir.THREE;case 4:return ir.FOUR;case 5:return ir.FIVE;case 6:return ir.SIX;default:throw new Error("Invalid P4Move")}}constructor(e){super(),u(this,"x",void 0),this.x=e}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}u(ir,"ZERO",new(v4=ir)(0)),u(ir,"ONE",new v4(1)),u(ir,"TWO",new v4(2)),u(ir,"THREE",new v4(3)),u(ir,"FOUR",new v4(4)),u(ir,"FIVE",new v4(5)),u(ir,"SIX",new v4(6)),u(ir,"encoder",we.tuple([we.identity()],r=>[r.x],r=>v4.of(r[0])));let qpt=(()=>{class r{}return u(r,"COLUMN_IS_FULL",()=>$localize`Please put your piece in an incomplete column.`),r})();var jd,C4;let y4=(jd=class extends Kn{static get(){return C4.singleton.isAbsent()&&(C4.singleton=g.of(new C4)),C4.singleton.get()}static getVictoriousCoords(e){return C4.P4_HELPER.getVictoriousCoord(e)}static getLowestUnoccupiedSpace(e,t){let n=0;for(;n<$a.HEIGHT&&e[n][t]===Y.NONE;)n++;return n-1}static getListMoves(e){const t=e.gameState,n=[];for(let i=0;i<$a.WIDTH;i++)if(t.getPieceAtXY(i,0)===Y.NONE){const s=ir.of(i);n.push(s)}return n}constructor(){super($a)}applyLegalMove(e,t,n){const i=e.x,s=t.getCopiedBoard(),o=C4.getLowestUnoccupiedSpace(s,i),a=t.turn;return s[o][i]=t.getCurrentPlayer(),new $a(s,a+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?b.failure(qpt.COLUMN_IS_FULL()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return C4.P4_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):42===t.turn?_e.DRAW:_e.ONGOING}},C4=jd,u(jd,"singleton",g.empty()),u(jd,"P4_HELPER",new hu($a.isOnBoard,U.identity,4)),jd);y4=C4=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],y4);const rt=Y.NONE,M4=Y.ZERO,Pu=Y.ONE;class f3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,$a.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,$a.getInitialState(),ir.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),q.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new $a([[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,Pu,rt,rt,rt],[rt,rt,rt,Pu,rt,rt,rt],[rt,rt,M4,M4,M4,Pu,rt]],0),[ir.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),q.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new $a([[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,rt,rt,rt,rt],[rt,rt,rt,M4,Pu,rt,rt],[rt,rt,M4,M4,Pu,rt,rt],[rt,M4,Pu,M4,M4,rt,rt]],0),[ir.of(3),ir.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)])}}let BC=class extends Wn{getListMoves(e){return y4.getListMoves(e).sort((t,n)=>Math.abs(t.x-3)-Math.abs(n.x-3))}};BC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],BC);class Ypt extends Na{getBoardValue(e){const t=e.gameState;let n=0;for(let i=0;i<$a.WIDTH;i++)for(let s=$a.HEIGHT-1;-1!==s&&t.board[s][i].isPlayer();s--)n+=y4.P4_HELPER.getSquareScore(t,new C(i,s));return new e1(n)}}class Kpt extends an{constructor(){super($localize`Minimax`,y4.get(),new Ypt,new BC)}}function Xpt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getSquareFillClass(t,n)),I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Qpt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=te(t).index;return ne(p(2).onClick(s))}),F(1,"rect",6),T(2,Xpt,1,4,"circle",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();Dn("id","click_",n,""),_(1),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function Jpt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Qpt,3,6,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function egt(r,e){if(1&r&&(A(),F(0,"rect",9)),2&r){const t=p();I("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function tgt(r,e){if(1&r&&(A(),F(0,"rect",10)),2&r){const t=e.$implicit,n=p();Ce("id","victory_coord_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let ngt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"EMPTY",Y.NONE),u(this,"last",void 0),u(this,"victoryCoords",[]),this.rules=y4.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Kpt,new Xn($localize`MCTS`,new BC,this.rules)],this.encoder=ir.encoder,this.tutorial=(new f3e).tutorial}onClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#click_"+n);if(s.isFailure())return i.cancelMove(s.getReason());const o=ir.of(n);return yield i.chooseMove(o)})()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.victoryCoords=y4.getVictoriousCoords(s),i.board=s.board})()}showLastMove(n){var i=this;return M(function*(){const s=i.getState(),o=y4.getLowestUnoccupiedSpace(s.board,n.x)+1;i.last=g.of(new C(n.x,o))})()}hideLastMove(){this.last=g.empty()}getSquareFillClass(n,i){return[this.getPlayerClass(this.board[i][n])]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-p4"]],features:[Xe],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,Jpt,2,1,"g",1),T(2,egt,1,4,"rect",2),T(3,tgt,1,6,"rect",3),P()),2&n&&(_(1),y("ngForOf",i.board),_(1),y("ngIf",i.last.isPresent()),_(1),y("ngForOf",i.victoryCoords))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class P1 extends q1{static getInitialState(){const e=Rt.create(P1.SIZE,P1.SIZE,Y.NONE);return new P1(e,0)}static isOnBoard(e){return e.isInRange(P1.SIZE,P1.SIZE)}constructor(e,t){super(e,t),u(this,"neutralBlocks",void 0),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=P1.getBlockCenter(e),n=this.getPieceAt(t.getNext(Me.UP,1)),i=this.getPieceAt(t.getNext(Me.UP_LEFT,1));return this.getPieceAt(t.getNext(Me.RIGHT,1))===n&&this.getPieceAt(t.getNext(Me.DOWN,1))===n&&this.getPieceAt(t.getNext(Me.LEFT,1))===n&&this.getPieceAt(t.getNext(Me.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_LEFT,1))===i}static getBlockCenter(e){return new C(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new P1(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const s=P1.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const o of P1.ROTATION_MAP){const a=o[0].getNext(s),c=o[1].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}else for(const o of P1.ROTATION_MAP){const a=o[1].getNext(s),c=o[0].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}}return new P1(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}var d3e;u(P1,"SIZE",6),u(P1,"ROTATION_MAP",[[new C(-1,-1),new C(1,-1)],[new C(0,-1),new C(1,0)],[new C(1,-1),new C(1,1)],[new C(1,0),new C(0,1)],[new C(1,1),new C(-1,1)],[new C(0,1),new C(-1,0)],[new C(-1,1),new C(-1,-1)],[new C(-1,0),new C(0,-1)]]);class Zr extends wr{static of(e,t,n){return new Zr(e.x,e.y,t,n)}static withRotation(e,t,n,i){return U.assert(0<=n&&n<=3,"This block does not exist: "+n),new Zr(e,t,g.of(n),i)}static rotationless(e,t){return new Zr(e,t,g.empty())}constructor(e,t,n,i=!1){super(e,t),u(this,"blockTurned",void 0),u(this,"turnedClockwise",void 0),this.blockTurned=n,this.turnedClockwise=i,U.assert(P1.isOnBoard(this.coord),"The board is a "+P1.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}d3e=Zr,u(Zr,"encoder",we.tuple([C.encoder,g.getEncoder(we.identity()),we.identity()],r=>[r.coord,r.blockTurned,r.turnedClockwise],r=>d3e.of(r[0],r[1],r[2])));let h3e=(()=>{class r{}return u(r,"CANNOT_ROTATE_NEUTRAL_BLOCK",()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`),u(r,"MUST_CHOOSE_BLOCK_TO_ROTATE",()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`),r})();class Zc extends Kn{static get(){return Zc.singleton.isAbsent()&&(Zc.singleton=g.of(new Zc)),Zc.singleton.get()}constructor(){super(P1)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return b.failure(h3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const i=e.blockTurned.get();if(n.neutralBlocks.includes(i))return b.failure(h3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return b.SUCCESS}getVictoryCoords(e){let t=[];for(const n of Zc.VICTORY_SOURCE){const i=e.getPieceAt(n[0]),s=[n[0]];if(i.isPlayer()){let o=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)e.getPieceAt(o)!==i?a=!1:(s.push(o),o=o.getNext(n[1]));if(a&&(e.getPieceAt(o)===i&&(s.push(o),t=t.concat(s)),n[2])){const c=n[0].getPrevious(n[1],1);e.getPieceAt(c)===i&&(s.push(c),t=t.concat(s))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),i=[!1,!1];for(let s=0;s<n.length;s+=5)i[t.getPieceAt(n[s]).value]=!0;return!0===i[0]?!0===i[1]?_e.DRAW:_e.ZERO_WON:!0===i[1]?_e.ONE_WON:t.turn===P1.SIZE*P1.SIZE?_e.DRAW:_e.ONGOING}}u(Zc,"singleton",g.empty()),u(Zc,"VICTORY_SOURCE",[[new C(1,0),new Et(1,1),!1],[new C(0,1),new Et(1,1),!1],[new C(4,0),new Et(-1,1),!1],[new C(5,1),new Et(-1,1),!1],[new C(1,1),new Et(1,1),!0],[new C(4,1),new Et(-1,1),!0],[new C(0,1),new Et(0,1),!0],[new C(1,1),new Et(0,1),!0],[new C(2,1),new Et(0,1),!0],[new C(3,1),new Et(0,1),!0],[new C(4,1),new Et(0,1),!0],[new C(5,1),new Et(0,1),!0],[new C(1,0),new Et(1,0),!0],[new C(1,1),new Et(1,0),!0],[new C(1,2),new Et(1,0),!0],[new C(1,3),new Et(1,0),!0],[new C(1,4),new Et(1,0),!0],[new C(1,5),new Et(1,0),!0]]);const ze=Y.NONE,Yc=Y.ZERO,E4=Y.ONE;class p3e{constructor(){u(this,"tutorial",[q.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,P1.getInitialState()),q.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new P1([[Yc,ze,ze,Yc,E4,ze],[Yc,E4,ze,ze,ze,ze],[Yc,ze,E4,ze,ze,ze],[Yc,ze,ze,ze,ze,E4],[Yc,ze,ze,ze,E4,ze],[ze,ze,ze,ze,ze,ze]],10)).withPreviousMove(Zr.withRotation(0,0,0,!1)),q.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new P1([[ze,ze,ze,ze,ze,ze],[ze,Yc,ze,ze,E4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,E4,ze,ze,Yc,ze],[ze,ze,ze,ze,ze,ze]],10),Zr.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?b.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):b.SUCCESS,$localize`Congratulations!`),q.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new P1([[ze,ze,ze,ze,ze,ze],[ze,Yc,ze,ze,E4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,E4,ze,ze,Yc,ze],[ze,ze,ze,ze,ze,ze]],10),Zr.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?b.SUCCESS:b.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)])}}class Zd extends Wn{getListMoves(e){const t=[],n=e.gameState.neutralBlocks;if(0===e.gameState.turn)return Zd.FIRST_TURN_MOVES;const i=this.getLegalDrops(e.gameState);for(const s of i){const o=Zr.rotationless(s.x,s.y),a=e.gameState.applyLegalDrop(o),c=this.getLegalRotations(a,n);for(const f of c)t.push(Zr.withRotation(s.x,s.y,f[0],f[1]));0===a.neutralBlocks.length==0&&t.push(o)}return t}getLegalDrops(e){const t=[];for(let n=0;n<P1.SIZE;n++)for(let i=0;i<P1.SIZE;i++){const s=new C(i,n);e.getPieceAt(s)===Y.NONE&&t.push(s)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,i=[];for(let s=0;s<4;s++)!1===e.blockIsNeutral(s)&&(t.includes(s)?n&&i.push([s,!0]):i.push([s,!0],[s,!1]));return i}}function rgt(r,e){if(1&r){const t=pe();A(),S(0,"circle",12),W("click",function(){const s=te(t).$implicit,o=p().$implicit,a=p().index,c=p().index;return ne(p().onClick(3*a+s,3*c+o))}),P()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p(),s=i.index,o=i.$implicit,a=p(),c=a.index,l=a.$implicit,f=p();Ce("id","click_",3*s+t,"_",3*c+n,""),y("ngClass",f.getSquareClasses(3*s+t,3*c+n)),I("cx",o+2*f.STROKE_WIDTH+(t+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(n+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}u(Zd,"FIRST_TURN_MOVES",[Zr.rotationless(0,0),Zr.rotationless(1,0),Zr.rotationless(2,0),Zr.rotationless(0,1),Zr.rotationless(1,1),Zr.rotationless(0,2)]);const g3e=function(){return[0,1,2]};function igt(r,e){1&r&&(A(),Gt(0),T(1,rgt,1,6,"circle",11),Bt()),2&r&&(_(1),y("ngForOf",H1(1,g3e)))}function sgt(r,e){if(1&r&&(A(),Gt(0),F(1,"rect",10),T(2,igt,2,2,"ng-container",4),Bt()),2&r){const t=e.$implicit,n=e.index,i=p(),s=i.index,o=i.$implicit,a=p();_(1),y("ngClass",a.getBlockClasses(n,s)),I("x",a.STROKE_WIDTH+t)("y",a.STROKE_WIDTH+o)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),_(1),y("ngForOf",H1(8,g3e))}}const m3e=function(r){return[0,r]};function ogt(r,e){if(1&r&&(A(),Gt(0),T(1,sgt,3,9,"ng-container",4),Bt()),2&r){const t=p();_(1),y("ngForOf",va(1,m3e,t.BLOCK_SEPARATION))}}function agt(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p();Ce("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),I("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function cgt(r,e){if(1&r){const t=pe();A(),S(0,"path",14),W("click",function(){const s=te(t).$implicit;return ne(p().rotate(s))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),I("d",t.path)("stroke-width",2*n.STROKE_WIDTH)}}function lgt(r,e){if(1&r&&(A(),F(0,"path",15)),2&r){const t=p();Ce("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),I("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function ugt(r,e){if(1&r&&(A(),F(0,"circle",16)),2&r){const t=e.$implicit,n=p();Ce("id","victoryCoord_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),I("cx",n.getCenter(t.x))("cy",n.getCenter(t.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function fgt(r,e){if(1&r){const t=pe();A(),S(0,"g",17),W("click",function(){return te(t),ne(p().skipRotation())}),F(1,"circle",18)(2,"line",19),P()}if(2&r){const t=p();_(1),I("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),_(1),I("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let dgt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"BLOCK_WIDTH",void 0),u(this,"BLOCK_SEPARATION",void 0),u(this,"DIAGONAL_BAR_OFFSET",void 0),u(this,"arrows",[]),u(this,"victoryCoords",[]),u(this,"canSkipRotation",void 0),u(this,"currentDrop",g.empty()),u(this,"movedBlock",g.empty()),u(this,"lastDrop",g.empty()),u(this,"lastRotation",g.empty()),u(this,"ARROWS",void 0),this.rules=Zc.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Dummy`,this.rules,new OL,new Zd),new Xn($localize`MCTS`,new Zd,this.rules)],this.encoder=Zr.encoder,this.tutorial=(new p3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord()}updateBoard(n){var i=this;return M(function*(){i.board=i.getState().getCopiedBoard(),i.victoryCoords=i.rules.getVictoryCoords(i.getState()),i.lastDrop=g.empty(),i.lastRotation=g.empty()})()}showLastMove(n){var i=this;return M(function*(){i.cancelMoveAttempt(),i.movedBlock=n.blockTurned;const s=new C(n.coord.x%3-1,n.coord.y%3-1);if(n.blockTurned.isPresent()&&(i.showLastRotation(n),!1===s.equals(new C(0,0))&&i.coordBelongToBlock(n)))return i.showLastDrop(n,s);i.lastDrop=g.of(n.coord)})()}showLastRotation(n){if(n.blockTurned.isPresent()){const i=n.blockTurned.get(),s=this.ARROWS.filter(o=>o.blockIndex===i&&o.clockwise===n.turnedClockwise)[0];this.lastRotation=g.of(s)}}showLastDrop(n,i){let s;s=n.turnedClockwise?U.getNonNullable(P1.ROTATION_MAP.find(f=>f[0].equals(i)))[1]:U.getNonNullable(P1.ROTATION_MAP.find(f=>f[1].equals(i)))[0];const o=n.blockTurned.get(),l=new C(o%2==0?1:4,o<2?1:4);s=s.getNext(l,1),this.lastDrop=g.of(s)}coordBelongToBlock(n){return n.blockTurned.equalsValue(2*(n.coord.y<3?0:1)+(n.coord.x<3?0:1))}hideLastMove(){this.lastDrop=g.empty(),this.movedBlock=g.empty(),this.lastRotation=g.empty(),this.victoryCoords=[]}generateArrowsCoord(){const n=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,o=n-s,a=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+a+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+a,blockIndex:0,clockwise:!1},{path:"M "+n+" "+c+" q  "+s+"  "+s+"  0  "+a,blockIndex:1,clockwise:!0},{path:"M "+o+" 0 q -"+s+" -"+s+" -"+a+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+o+" q -"+s+" -"+s+"  0 -"+a,blockIndex:2,clockwise:!0},{path:"M "+c+" "+n+" q  "+s+"  "+s+"  "+a+"  0",blockIndex:2,clockwise:!1},{path:"M "+o+" "+n+" q -"+s+"  "+s+" -"+a+"  0",blockIndex:3,clockwise:!0},{path:"M "+n+" "+o+" q  "+s+" -"+s+"  0 -"+a,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=g.empty(),this.canSkipRotation=!1}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hideLastMove(),s.board[i][n].isPlayer())return s.cancelMove(Le.MUST_LAND_ON_EMPTY_SPACE());const a=Zr.rotationless(n,i),l=s.getState().applyLegalDrop(a);if(4===l.neutralBlocks.length)return s.chooseMove(a);const f=s.rules.getGameStatus(s.node);return s.canSkipRotation=l.neutralBlocks.length>0&&!1===f.isEndGame,s.currentDrop=g.of(new C(n,i)),s.displayArrows(l.neutralBlocks),b.SUCCESS})()}getCenter(n){return(n<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(n%3+.5)*this.SPACE_SIZE}displayArrows(n){this.arrows=[];for(let i=0;i<4;i++)if(!1===n.includes(i)){const s=this.ARROWS.filter(o=>o.blockIndex===i);this.arrows=this.arrows.concat(s)}}getBlockClasses(n,i){return this.movedBlock.equalsValue(n+2*i)?["last-move-stroke"]:[]}getSquareClasses(n,i){const s=[],o=this.getPlayerClass(this.board[i][n]);return s.push(o),this.lastDrop.equalsValue(new C(n,i))&&s.push("last-move-stroke"),s}rotate(n){var i=this;return M(function*(){const s=n.clockwise?"clockwise":"counterclockwise",o=yield i.canUserPlay("#rotate_"+n.blockIndex+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const a=i.currentDrop.get(),c=Zr.withRotation(a.x,a.y,n.blockIndex,n.clockwise);return i.chooseMove(c)})()}skipRotation(){var n=this;return M(function*(){const i=yield n.canUserPlay("#skipRotation");if(i.isFailure())return n.cancelMove(i.getReason());const s=n.currentDrop.get(),o=Zr.rotationless(s.x,s.y);return n.chooseMove(o)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-pentago"]],features:[Xe],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),P()(),S(4,"defs")(5,"marker",3),F(6,"polygon",2),P()(),T(7,ogt,2,3,"ng-container",4),T(8,agt,1,6,"circle",5),T(9,cgt,1,4,"path",6),T(10,lgt,1,4,"path",7),T(11,ugt,1,7,"circle",8),T(12,fgt,3,9,"g",9),P()),2&n&&(_(7),y("ngForOf",va(6,m3e,i.BLOCK_SEPARATION)),_(1),y("ngIf",i.currentDrop.isPresent()),_(1),y("ngForOf",i.arrows),_(1),y("ngIf",i.lastRotation.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngIf",i.canSkipRotation))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Ga=(()=>{class r extends q1{static getInitialState(){const t=Rt.create(r.SIZE,r.SIZE,Y.NONE);return t[9][9]=Y.ONE,new r(t,[0,0],0)}constructor(t,n,i){super(t,i),u(this,"captures",void 0),this.captures=n}}return u(r,"SIZE",19),r})();class q2 extends wr{static isOnBoard(e){return e.isInRange(Ga.SIZE,Ga.SIZE)}static of(e){return U.assert(q2.isOnBoard(e),"PenteMove: coord is out of the board"),new q2(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}u(q2,"encoder",wr.getEncoder(q2.of));class Co extends Kn{static get(){return Co.singleton.isAbsent()&&(Co.singleton=g.of(new Co)),Co.singleton.get()}constructor(){super(Ga)}isLegal(e,t){return t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=t.getCopiedBoard();s[e.coord.y][e.coord.x]=i;const o=this.getCaptures(e.coord,t,i);for(const c of o)s[c.y][c.x]=Y.NONE;const a=[t.captures[0],t.captures[1]];return a[i.value]+=o.length,new Ga(s,a,t.turn+1)}getCaptures(e,t,n){const i=n.getOpponent(),s=[];for(const o of Me.factory.all){const a=e.getNext(o,1),c=e.getNext(o,2),l=e.getNext(o,3);q2.isOnBoard(a)&&t.getPieceAt(a)===i&&q2.isOnBoard(c)&&t.getPieceAt(c)===i&&q2.isOnBoard(l)&&t.getPieceAt(l)===n&&(s.push(a),s.push(c))}return s}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();return t.captures[n.value]>=10||Co.PENTE_HELPER.getVictoriousCoord(t).length>0?_e.getVictory(n):this.stillHaveEmptySquare(t)?_e.ONGOING:_e.DRAW}stillHaveEmptySquare(e){for(let t=0;t<Ga.SIZE;t++)for(let n=0;n<Ga.SIZE;n++)if(e.board[t][n]===Y.NONE)return!0;return!1}}u(Co,"PENTE_HELPER",new hu(q2.isOnBoard,U.identity,5)),u(Co,"singleton",g.empty());const h=Y.NONE,Kc=Y.ZERO,Ba=Y.ONE;class v3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,Ga.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Ga.getInitialState(),q2.of(new C(9,8)),$localize`Congratulations!`),q.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new Ga([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Kc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ba,Kc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ba,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],3),[q2.of(new C(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new Ga([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ba,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ba,Kc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ba,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],4),[q2.of(new C(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new Ga([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ba,h,h,Kc,Kc,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Kc,h,Kc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Ba,Kc,Kc,Kc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Ba,Ba,Ba,Ba,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[8,8],7),[q2.of(new C(9,6)),q2.of(new C(8,9)),q2.of(new C(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}class C3e extends Wn{getListMoves(e){const n=[];return e.gameState.forEachCoord((i,s)=>{!1===s.isPlayer()&&n.push(q2.of(i))}),n}}class hgt extends Na{getBoardValue(e){return Co.PENTE_HELPER.getBoardValue(e.gameState)}}function pgt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function ggt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();Ce("id","hoshi_",t,"_",n,""),I("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function mgt(r,e){if(1&r&&(A(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,ggt,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();I("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),_(1),I("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),I("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),_(1),y("ngIf",i.isHoshi(t,n))}}function _gt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,pgt,1,6,"circle",6),T(2,mgt,4,13,"ng-template",null,7,fn),P()}if(2&r){const t=e.$implicit,n=e.index,i=ln(3);Ce("id","click_",n,"_",p().index,""),_(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function vgt(r,e){if(1&r&&(A(),S(0,"g"),T(1,_gt,4,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Cgt(r,e){if(1&r){const t=pe();A(),S(0,"circle",13),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","capture_",t.x,"_",t.y,""),I("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}let ygt=(()=>{var r;class e extends xL{constructor(n){super(n),u(this,"lastMoved",g.empty()),u(this,"victoryCoords",[]),u(this,"captured",[]),this.scores=g.of([0,0]),this.rules=Co.get(),this.node=this.rules.getInitialNode(),this.encoder=q2.encoder,this.tutorial=(new v3e).tutorial,this.availableAIs=[new an($localize`Alignment`,this.rules,new hgt,new C3e),new Xn($localize`MCTS`,new C3e,this.rules)]}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.board,i.scores=g.of(i.getState().captures),i.victoryCoords=Co.PENTE_HELPER.getVictoriousCoord(s),i.createHoshis(),i.cancelMoveAttempt()})()}showLastMove(n){var i=this;return M(function*(){i.lastMoved=g.of(n.coord);const s=i.getCurrentOpponent();i.captured=Co.get().getCaptures(n.coord,i.getPreviousState(),s)})()}cancelMoveAttempt(){this.lastMoved=g.empty(),this.captured=[]}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);return s.chooseMove(q2.of(a))})()}getSpaceClass(n,i){const s=new C(n,i),o=this.getState().getPieceAt(s),a=[];return a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.equalsValue(s)&&a.push("last-move-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-new-game"]],features:[Xe],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),F(1,"rect",1),T(2,vgt,2,1,"g",2),T(3,Cgt,1,5,"circle",3),P()),2&n&&(I("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),_(1),I("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.captured))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Yd extends C{static getCoord3DEncoder(e){return we.tuple([we.identity(),we.identity(),we.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,n){return new Yd(e,t,n)}constructor(e,t,n){super(e,t),u(this,"z",void 0),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}var tR;class un extends Yd{static of(e,t,n){return new un(e,t,n)}constructor(e,t,n){super(e,t,n),U.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),U.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),U.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;U.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new un(this.x,this.y,e),new un(this.x+1,this.y,e),new un(this.x,this.y+1,e),new un(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new C(this.x-1,this.y-1),n=new C(this.x,this.y-1),i=new C(this.x-1,this.y),s=new C(this.x,this.y),o=4-e;return[t,n,i,s].filter(a=>a.isInRange(o,o)).map(a=>new un(a.x,a.y,e))}getNextValid(e){const t=new C(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?g.empty():g.of(new un(t.x,t.y,this.z))}}u(un,"coordEncoder",Yd.getCoord3DEncoder((tR=un).of)),u(un,"optionalEncoder",g.getEncoder(tR.coordEncoder));let zl=(()=>{class r{}return u(r,"MUST_MOVE_UPWARD",()=>$localize`You must move your pieces upward.`),u(r,"SHOULD_HAVE_SUPPORTING_PIECES",()=>$localize`Your piece must land on the board or on 4 other pieces.`),u(r,"CANNOT_MOVE_SUPPORTING_PIECE",()=>$localize`You cannot move a supporting piece.`),u(r,"CANNOT_CAPTURE",()=>$localize`You cannot capture.`),u(r,"INVALID_FIRST_CAPTURE",()=>$localize`Your first capture is invalid.`),u(r,"INVALID_SECOND_CAPTURE",()=>$localize`Your second capture is invalid.`),r})();var y3e;let M3e=(()=>{class r{}return u(r,"MUST_CAPTURE_MAXIMUM_TWO_PIECES",()=>$localize`You must capture one or two pieces, not more.`),r})();class mr extends Hi{static ofClimb(e,t,n){const i=g.of(e),s=mr.checkCaptures(n),o=new mr(i,t,s.firstCapture,s.secondCapture);return U.assert(t.isHigherThan(e),zl.MUST_MOVE_UPWARD()),o}static checkCaptures(e){let t=g.empty(),n=g.empty();if(e.length>0&&(t=g.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=g.of(e[1]),e[1].isHigherThan(e[0])&&(t=g.of(e[1]),n=g.of(e[0])),e.length>2)throw new Error(M3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static ofDrop(e,t){const n=g.empty(),i=mr.checkCaptures(t);return new mr(n,e,i.firstCapture,i.secondCapture)}static changeCapture(e,t){const n=mr.checkCaptures(t);return new mr(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}static of(e,t,n,i){return new mr(e,t,n,i)}constructor(e,t,n,i){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"firstCapture",void 0),u(this,"secondCapture",void 0),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!(!1===this.startingCoord.equals(e.startingCoord)||!1===this.landingCoord.equals(e.landingCoord)||!1===this.firstCapture.equals(e.firstCapture)||!1===this.secondCapture.equals(e.secondCapture))}}y3e=mr,u(mr,"encoder",we.tuple([un.optionalEncoder,un.coordEncoder,un.optionalEncoder,un.optionalEncoder],r=>[r.startingCoord,r.landingCoord,r.firstCapture,r.secondCapture],r=>y3e.of(r[0],r[1],r[2],r[3])));class Ua extends eC{static getInitialState(){const e=Rt.create(4,4,Y.NONE),t=Rt.create(3,3,Y.NONE),n=Rt.create(2,2,Y.NONE);return new Ua([e,t,n,[[Y.NONE]]],0)}static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return U.expectToBe(e,2),[0,1]}}constructor(e,t){super(t),u(this,"boards",void 0),this.boards=e}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let i;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:Y.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:Y.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:Y.NONE}),i=t?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(e,t){const n=[Rt.copy(this.boards[0]),Rt.copy(this.boards[1]),Rt.copy(this.boards[2]),Rt.copy(this.boards[3])];for(const i of e){const s=i.coord;n[s.z][s.y][s.x]=i.value}return new Ua(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===Y.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[Y.NONE.value]=0,e[k.ZERO.value]=0,e[k.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let i=0;i<4-t;i++){const s=new un(i,n,t),o=this.getPieceAt(s);e[o.value]=1+e[o.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:Y.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Ua.getLevelRange(n);for(const s of i)for(const o of i){const a=new un(o,s,n);this.getPieceAt(a).equals(t)&&!1===this.isSupporting(a)&&e.push(a)}}return e}}class E2 extends Kn{static get(){return E2.singleton.isAbsent()&&(E2.singleton=g.of(new E2)),E2.singleton.get()}constructor(){super(Ua)}static getStateInfo(e){const t=[],n=[];for(let i=0;i<3;i++)for(let s=0;s<4-i;s++)for(let o=0;o<4-i;o++){const a=new un(o,s,i);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const i of e.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(s=>n.equals(s))){const s=mr.ofClimb(n,i,[]);t.push(s)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const i=mr.ofDrop(n,[]);t.push(i)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const i of[Re.UP,Re.DOWN]){const s=t.getNextValid(i);if(s.isPresent()&&e.getPieceAt(s.get())===n)for(const o of[Re.LEFT,Re.RIGHT]){const a=s.get().getNextValid(o);if(a.isPresent()&&e.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(e.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new ft,n=e.getFreeToMoves();for(const i of n){t.add(new ft([i]));const o=e.removePieceAt(i).getFreeToMoves();for(const a of o){const c=new ft([i,a]);t.add(c)}}return t}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const i=e.getCurrentPlayer();return(!1!==n.equals(t.landingCoord)||e.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(o=>e.getPieceAt(o).isPlayer()&&!1===o.equals(t.firstCapture.get())).length}static getGameStatus(e){const n=e.gameState.getPiecesRepartition();return 15===n[k.ZERO.value]?_e.ONE_WON:15===n[k.ONE.value]?_e.ZERO_WON:_e.ONGOING}applyLegalMove(e,t,n){return E2.applyLegalMove(e,t,n)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return n.toOtherFallible();const i=n.get(),s=this.isLegalLandingCoord(e,i);if(s.isFailure())return s.toOtherFallible();const o=s.get(),a=this.isLegalCaptures(e,o);return a.isFailure()?a:b.SUCCESS}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const i=e.startingCoord.get(),s=t.getPieceAt(i);if(s===n)return re.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(s===Y.NONE)return re.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>t.getPieceAt(a).isPlayer()).length){const a=t.removePieceAt(e.startingCoord.get());return re.success(a)}return re.failure(zl.CANNOT_MOVE_SUPPORTING_PIECE())}return re.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?re.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?re.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):re.failure(zl.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return b.SUCCESS;if(!1===E2.canCapture(t,e.landingCoord))return b.failure(zl.CANNOT_CAPTURE());if(E2.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||E2.isValidCapture(n,e,e.secondCapture.get())?b.SUCCESS:b.failure(zl.INVALID_SECOND_CAPTURE())}return b.failure(zl.INVALID_FIRST_CAPTURE())}getGameStatus(e){return E2.getGameStatus(e)}}u(E2,"singleton",g.empty());const $e=Y.NONE,S4=Y.ZERO,E3e=Y.ONE;class S3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Ua.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Ua.getInitialState(),mr.ofDrop(new un(1,1,0),[]),$localize`There you go, as simple as that.`),q.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Ua([[[S4,E3e,$e,$e],[E3e,S4,$e,$e],[$e,$e,$e,$e],[$e,$e,$e,S4]],[[$e,$e,$e],[$e,$e,$e],[$e,$e,$e]],[[$e,$e],[$e,$e]],[[$e]]],0),[mr.ofClimb(new un(3,3,0),new un(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),q.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Ua([[[S4,S4,$e,$e],[$e,S4,$e,$e],[$e,$e,$e,$e],[$e,$e,$e,$e]],[[$e,$e,$e],[$e,$e,$e],[$e,$e,$e]],[[$e,$e],[$e,$e]],[[$e]]],0),[mr.ofDrop(new un(0,1,0),[new un(0,0,0)]),mr.ofDrop(new un(0,1,0),[new un(0,1,0)]),mr.ofDrop(new un(0,1,0),[new un(1,0,0)]),mr.ofDrop(new un(0,1,0),[new un(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),q.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Ua([[[S4,S4,$e,$e],[$e,S4,$e,$e],[$e,$e,$e,$e],[$e,$e,$e,$e]],[[$e,$e,$e],[$e,$e,$e],[$e,$e,$e]],[[$e,$e],[$e,$e]],[[$e]]],0),mr.ofDrop(new un(0,1,0),[new un(0,0,0),new un(1,0,0)]),(t,n,i)=>t.secondCapture.isPresent()?b.SUCCESS:t.firstCapture.isPresent()?b.failure($localize`Failed, you only captured one piece.`):b.failure(c3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)])}}class P3e extends Wn{getListMoves(e){const t=e.gameState,n=[],i=E2.getStateInfo(t),s=E2.getClimbingMoves(i),o=E2.getDropMoves(i),a=s.concat(o);for(const c of a){const l=t.applyLegalMove(c,!1);let f=new ft;E2.canCapture(l,c.landingCoord)?f=E2.getPossibleCaptures(l):n.push(c);for(const d of f){const m=mr.changeCapture(c,d.toList());n.push(m)}}return n}}class Mgt extends P3e{getListMoves(e){const t=super.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((t,n)=>{const i=12*this.countStoneUsed(t),s=12*this.countStoneUsed(n);return i+this.sumMoveEmplacementByValue(t)-(s+this.sumMoveEmplacementByValue(n))})}countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}class Egt extends dr{getMetrics(e){const t=e.gameState.getPiecesRepartition();return[t[k.ZERO.value],t[k.ONE.value]]}}function Sgt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),I("cx",i.SPACE_SIZE/4+t/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function Pgt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Sgt,1,6,"circle",7),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getPlayerSidePieces(t))}}function Tgt(r,e){if(1&r){const t=pe();A(),S(0,"circle",12),W("click",function(){te(t);const i=p(2).$implicit,s=p().$implicit,o=p().$implicit;return ne(p().onPieceClick(i,s,o))}),P()}if(2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit,s=p();Ni("id","piece_",t,"_",n,"_",i,""),y("ngClass",s.getPieceClasses(t,n,i)),I("r",s.getPieceRadius(i)-s.STROKE_WIDTH)("cx",s.getPieceCx(t,n,i))("cy",s.getPieceCy(t,n,i))}}function Ogt(r,e){if(1&r){const t=pe();A(),S(0,"rect",12),W("click",function(){te(t);const i=p(3).$implicit,s=p().$implicit,o=p().$implicit;return ne(p().onDrop(i,s,o))}),P()}if(2&r){const t=p(3).$implicit,n=p().$implicit,i=p().$implicit,s=p();Ni("id","drop_",t,"_",n,"_",i,""),y("ngClass",s.getSquareClasses(t,n,i)),I("width",2*s.getPieceRadius(i))("height",2*s.getPieceRadius(i))("x",s.getPieceCx(t,n,i)-s.getPieceRadius(i))("y",s.getPieceCy(t,n,i)-s.getPieceRadius(i))}}function bgt(r,e){if(1&r&&(A(),T(0,Ogt,1,8,"rect",13)),2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit;y("ngIf",p().mustDisplayLandingCoord(t,n,i))}}function wgt(r,e){if(1&r&&(A(),Gt(0),T(1,Tgt,1,7,"circle",10),T(2,bgt,1,1,"ng-template",null,11,fn),Bt()),2&r){const t=ln(3),n=p().$implicit,i=p().$implicit,s=p().$implicit,o=p();_(1),y("ngIf",o.isOccupied(n,i,s))("ngIfElse",t)}}function Ngt(r,e){if(1&r&&(A(),S(0,"g"),T(1,wgt,4,2,"ng-container",9),P()),2&r){const t=e.$implicit,n=p().$implicit,i=p().$implicit,s=p();_(1),y("ngIf",s.mustDraw(t,n,i))}}function Agt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Ngt,2,1,"g",1),P()),2&r){const t=p().$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function Igt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Agt,2,1,"g",1),P()),2&r){const t=e.$implicit,n=p();_(1),y("ngForOf",n.getLevelRange(t))}}function kgt(r,e){if(1&r&&(A(),F(0,"rect",14)),2&r){const t=p();Ni("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),I("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function xgt(r,e){if(1&r){const t=pe();A(),S(0,"g",15),W("click",function(){return te(t),ne(p().validateCapture())}),F(1,"circle",16)(2,"polygon",17),P()}if(2&r){const t=p();I("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),_(1),y("ngClass",t.getCaptureValidationButtonClasses()),I("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function Lgt(r,e){if(1&r){const t=pe();A(),S(0,"g",18),W("click",function(){const s=te(t).$implicit;return ne(p().onPieceClick(s.x,s.y,s.z))}),F(1,"line",19)(2,"line",19),P()}if(2&r){const t=e.$implicit,n=p();Ni("id","capturable_",t.x,"_",t.y,"_",t.z,""),I("transform","translate("+n.getPieceCxByCoord(t)+" "+n.getPieceCyByCoord(t)+")"),_(1),I("x1",-.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z)),_(1),I("x1",.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",-.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z))}}const Rgt=function(){return[0,1,2]};let zgt=(()=>{var r;class e extends Hc{constructor(n){super(n),u(this,"boardWidth",4*this.SPACE_SIZE+this.STROKE_WIDTH),u(this,"pieceRowHeight",this.SPACE_SIZE/2),u(this,"boardHeight",this.boardWidth+2*this.pieceRowHeight),u(this,"state",void 0),u(this,"constructedState",void 0),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"lastFirstCapture",g.empty()),u(this,"lastSecondCapture",g.empty()),u(this,"highCapture",g.empty()),u(this,"capturables",[]),u(this,"chosenStartingCoord",g.empty()),u(this,"chosenLandingCoord",g.empty()),u(this,"chosenFirstCapture",g.empty()),u(this,"chosenSecondCapture",g.empty()),u(this,"lastMove",g.empty()),u(this,"remainingPieces",{0:15,1:15}),this.hasAsymmetricBoard=!0,this.rules=E2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,this.rules,new Egt,new Mgt),new Xn($localize`MCTS`,new P3e,this.rules)],this.encoder=mr.encoder,this.tutorial=(new S3e).tutorial}getPiecesCyForPlayer(n){return n===k.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(n){return Ua.getLevelRange(n)}mustDraw(n,i,s){const o=new un(n,i,s);return!!(this.constructedState.getPieceAt(o).isPlayer()||this.justClimbed(o)||this.isCaptured(o))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(o)}isCaptured(n){return this.chosenFirstCapture.equalsValue(n)||this.chosenSecondCapture.equalsValue(n)}onPieceClick(n,i,s){var o=this;return M(function*(){const a=yield o.canUserPlay("#piece_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new un(n,i,s);return o.state.getPieceAt(c)===o.state.getCurrentOpponent()?o.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):o.chosenStartingCoord.equalsValue(c)?(o.cancelMoveAttempt(),b.SUCCESS):o.chosenLandingCoord.isPresent()?o.isSupporting(c,o.constructedState)?o.cancelMove(zl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onCaptureClick(c):o.isSupporting(c,o.getState())?o.cancelMove(zl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onClimbClick(c)})()}isSupporting(n,i){return i.isSupporting(n)}onClimbClick(n){var i=this;return M(function*(){return i.chosenStartingCoord=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),b.SUCCESS})()}onCaptureClick(n){var i=this;return M(function*(){return i.chosenFirstCapture.equalsValue(n)?(i.chosenFirstCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.equalsValue(n)?(i.chosenSecondCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenFirstCapture.isAbsent()?(i.chosenFirstCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.isAbsent()?(i.chosenSecondCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.cancelMove(M3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var n=this;return M(function*(){const i=yield n.canUserPlay("#capture_validation");return i.isFailure()?n.cancelMove(i.getReason()):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isAbsent()?b.SUCCESS:n.chosenFirstCapture.isPresent()&&n.chosenSecondCapture.isAbsent()?n.concludeMoveWithCapture([n.chosenFirstCapture.get()]):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isPresent()?n.concludeMoveWithCapture([n.chosenSecondCapture.get()]):n.concludeMoveWithCapture([n.chosenFirstCapture.get(),n.chosenSecondCapture.get()])})()}concludeMoveWithCapture(n){var i=this;return M(function*(){if(i.chosenStartingCoord.isAbsent()){const s=mr.ofDrop(i.chosenLandingCoord.get(),n);return i.chooseMove(s)}{const s=mr.ofClimb(i.chosenStartingCoord.get(),i.chosenLandingCoord.get(),n);return i.chooseMove(s)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=g.empty(),this.chosenLandingCoord=g.empty(),this.chosenFirstCapture=g.empty(),this.chosenSecondCapture=g.empty(),this.capturables=[]}onDrop(n,i,s){var o=this;return M(function*(){const a=yield o.canUserPlay("#drop_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new un(n,i,s);return E2.canCapture(o.constructedState,c)?(o.chosenLandingCoord=g.of(c),o.constructedState=o.constructedState.dropCurrentPlayersPieceAt(c),o.updateCapturableList(),b.SUCCESS):(o.chosenLandingCoord=g.of(c),o.concludeMoveWithCapture([]))})()}getSquareClasses(n,i,s){const o=new un(n,i,s);if(this.lastMove.isPresent()){const a=this.lastMove.get();if(a.firstCapture.equalsValue(o)||a.secondCapture.equalsValue(o))return["captured-fill"];if(o.equals(a.landingCoord)||a.startingCoord.equalsValue(o))return["moved-fill"]}else if(this.justClimbed(o))return["moved-fill"];return[]}justClimbed(n){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(n)}getPieceRadius(n){return this.SPACE_SIZE*(.45+.025*n)}getPieceCx(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCy(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+i*this.SPACE_SIZE}getPieceCxByCoord(n){return this.getPieceCx(n.x,n.y,n.z)}getPieceCyByCoord(n){return this.getPieceCy(n.x,n.y,n.z)}isOccupied(n,i,s){const o=new un(n,i,s);if(this.justClimbed(o))return!1;const a=this.getState().getPieceAt(o).isPlayer(),c=this.chosenLandingCoord.equalsValue(o);return a||c}getPieceClasses(n,i,s){const o=new un(n,i,s),a=[this.getPieceFillClass(o)];return(this.lastLandingCoord.equalsValue(o)||this.lastStartingCoord.equalsValue(o))&&a.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(o)||this.chosenLandingCoord.equalsValue(o))&&a.push("selected-stroke"),this.isCaptured(o)&&a.push("pre-captured-fill"),a}getPieceFillClass(n){return this.chosenLandingCoord.equalsValue(n)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(n))}getPlayerSidePieces(n){const i=this.remainingPieces[n.value],s=[];for(let o=0;o<i;o++)s.push(o);return s}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.constructedState=i.state,i.lastMove=i.node.previousMove;const s=i.state.getPiecesRepartition();i.remainingPieces={0:15-s[0],1:15-s[1]},i.highCapture=g.empty(),i.cancelMoveAttempt(),i.hideLastMove()})()}showLastMove(n){var i=this;return M(function*(){i.lastLandingCoord=g.of(n.landingCoord),i.lastStartingCoord=n.startingCoord,i.lastFirstCapture=n.firstCapture,i.lastSecondCapture=n.secondCapture,i.lastFirstCapture.isPresent()&&!1===i.mustDrawCoord(i.lastFirstCapture.get())&&(i.highCapture=i.lastFirstCapture)})()}hideLastMove(){this.lastStartingCoord=g.empty(),this.lastLandingCoord=g.empty(),this.lastFirstCapture=g.empty(),this.lastSecondCapture=g.empty()}mustDrawCoord(n){return this.mustDraw(n.x,n.y,n.z)}mustDisplayLandingCoord(n,i,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new un(n,i,s))||this.chosenStartingCoord.get().z<s}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-pylos"]],features:[Xe],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g"),T(2,Pgt,2,1,"g",1),P(),S(3,"g",null,2),F(5,"rect",3),T(6,Igt,2,1,"g",1),T(7,kgt,1,7,"rect",4),T(8,xgt,3,5,"g",5),T(9,Lgt,3,12,"g",6),P()()),2&n&&(I("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),_(1),I("transform","rotate("+180*i.getPointOfView().value+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),_(1),y("ngForOf",i.Player.PLAYERS),_(1),I("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),_(2),I("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),_(1),y("ngForOf",H1(10,Rgt)),_(1),y("ngIf",i.highCapture.isPresent()),_(1),y("ngIf",i.chosenLandingCoord.isPresent()),_(1),y("ngForOf",i.capturables))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var kn,T3e;class Ct{static ofInt(e){if(0<=e&&e<=15)return Ct.pieces[e];if(16===e)return Ct.EMPTY;throw new Error("Invalid piece ("+e+")")}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}u(Ct,"AAAA",new(kn=Ct)(0)),u(Ct,"AAAB",new kn(1)),u(Ct,"AABA",new kn(2)),u(Ct,"AABB",new kn(3)),u(Ct,"ABAA",new kn(4)),u(Ct,"ABAB",new kn(5)),u(Ct,"ABBA",new kn(6)),u(Ct,"ABBB",new kn(7)),u(Ct,"BAAA",new kn(8)),u(Ct,"BAAB",new kn(9)),u(Ct,"BABA",new kn(10)),u(Ct,"BABB",new kn(11)),u(Ct,"BBAA",new kn(12)),u(Ct,"BBAB",new kn(13)),u(Ct,"BBBA",new kn(14)),u(Ct,"BBBB",new kn(15)),u(Ct,"EMPTY",new kn(16)),u(Ct,"pieces",[kn.AAAA,kn.AAAB,kn.AABA,kn.AABB,kn.ABAA,kn.ABAB,kn.ABBA,kn.ABBB,kn.BAAA,kn.BAAB,kn.BABA,kn.BABB,kn.BBAA,kn.BBAB,kn.BBBA,kn.BBBB]),u(Ct,"encoder",we.fromFunctions(r=>r.value,kn.ofInt));class Xc extends wr{constructor(e,t,n){super(e,t),u(this,"piece",void 0),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}T3e=Xc,u(Xc,"encoder",we.tuple([C.encoder,Ct.encoder],r=>[r.coord,r.piece],r=>new T3e(r[0].x,r[0].y,r[1])));class Wa extends q1{constructor(e,t,n){super(e,t),u(this,"pieceInHand",void 0),this.pieceInHand=n}static getInitialState(){const e=Rt.create(4,4,Ct.EMPTY);return new Wa(e,0,Ct.AAAA)}static isGivable(e,t,n){return e!==n&&!1===Wa.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(t[n][i]===e)return!0;return!1}getRemainingPieces(){const e=Ct.pieces,t=[];for(const n of e)Wa.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}var a1=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(a1||{});let nR=(()=>{class r{}return u(r,"MUST_GIVE_A_PIECE",()=>$localize`You must give a piece.`),u(r,"PIECE_ALREADY_ON_BOARD",()=>$localize`That piece is already on the board.`),u(r,"CANNOT_GIVE_PIECE_IN_HAND",()=>$localize`You cannot give the piece that was in your hands.`),r})();class Kd{constructor(e){u(this,"subCriterion",[g.empty(),g.empty(),g.empty(),g.empty()]),this.subCriterion[0]=g.of(8==(8&e.value)),this.subCriterion[1]=g.of(4==(4&e.value)),this.subCriterion[2]=g.of(2==(2&e.value)),this.subCriterion[3]=g.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=g.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new Kd(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new Kd(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class Qc{constructor(e,t){u(this,"initialCoord",void 0),u(this,"direction",void 0),this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class xr extends Kn{static get(){return xr.singleton.isAbsent()&&(xr.singleton=g.of(new xr)),xr.singleton.get()}constructor(){super(Wa)}static isOccupied(e){return e!==Ct.EMPTY}static isLegal(e,t){const n=e.coord.x,i=e.coord.y,s=e.piece,o=t.getCopiedBoard(),a=t.pieceInHand;return xr.isOccupied(o[i][n])?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):s===Ct.EMPTY?15===t.turn?b.SUCCESS:b.failure(nR.MUST_GIVE_A_PIECE()):Wa.isAlreadyOnBoard(s,o)?b.failure(nR.PIECE_ALREADY_ON_BOARD()):a===s?b.failure(nR.CANNOT_GIVE_PIECE_IN_HAND()):b.SUCCESS}isLegal(e,t){return xr.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=t.pieceInHand,new Wa(i,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===a1.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:a1.VICTORY,sensitiveSquares:new j1}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,i=t.getPieceAt(n);const s=new Kd(i);for(let o=0;o<3&&!1!==xr.isOccupied(i)&&!s.areAllAbsent();o++)n=n.getNext(e.direction,1),i=t.getPieceAt(n),s.mergeWithQuartoPiece(i);return!(!xr.isOccupied(i)||!1!==s.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const i=xr.getLineInfos(e,t,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const s=i.commonCriterion,o=i.sensitiveCoord;if(s.isPresent()&&!1===s.get().areAllAbsent()){if(o.isAbsent())return{score:a1.VICTORY,sensitiveSquares:new j1};{s.get().matchPiece(t.pieceInHand)&&(n.score=a1.PRE_VICTORY);const a=o.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(e,t,n){let i=g.empty(),s=g.empty(),o=e.initialCoord;for(let a=0;a<4;a++){const c=t.getPieceAt(o);if(c===Ct.EMPTY){if(!i.isAbsent())return{sensitiveCoord:g.of(o),commonCriterion:s,boardStatus:g.of(n)};i=g.of(o)}else s.isAbsent()?(s=g.of(new Kd(c)),Ne.display("QuartoRules","getLineInfos","set commonCrit to "+s.toString())):(s.get().mergeWithQuartoPiece(c),Ne.display("QuartoRules","getLineInfos","update commonCrit: "+s.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:s,sensitiveCoord:i,boardStatus:g.empty()}}static scoreToGameStatus(e,t){const n=k.of(t%2);return e===a1.VICTORY?_e.getDefeat(n):16===t?_e.DRAW:_e.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:a1.DEFAULT,sensitiveSquares:new j1};for(const i of xr.lines)if(n=xr.updateBoardStatus(i,t,n),n.score===a1.VICTORY)return xr.scoreToGameStatus(n.score,t.turn);return xr.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of xr.lines)if(xr.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}u(xr,"singleton",g.empty()),u(xr,"lines",[new Qc(new C(0,0),Me.DOWN),new Qc(new C(1,0),Me.DOWN),new Qc(new C(2,0),Me.DOWN),new Qc(new C(3,0),Me.DOWN),new Qc(new C(0,0),Me.RIGHT),new Qc(new C(0,1),Me.RIGHT),new Qc(new C(0,2),Me.RIGHT),new Qc(new C(0,3),Me.RIGHT),new Qc(new C(0,0),Me.DOWN_RIGHT),new Qc(new C(0,3),Me.UP_RIGHT)]);const Dgt=Ct.AABA,Hgt=Ct.AABB,O3e=Ct.ABAA,Vgt=Ct.ABAB,Fgt=Ct.ABBA,b3e=Ct.BAAA,$gt=Ct.BAAB,Ggt=Ct.BABB,w3e=Ct.BBAA,Bgt=Ct.BBAB,rR=Ct.BBBA,Ugt=Ct.BBBB,t1=Ct.EMPTY;class N3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Wa([[rR,w3e,O3e,Dgt],[t1,t1,t1,t1],[t1,t1,t1,t1],[t1,t1,t1,t1]],7,Ct.ABAB)),q.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Wa([[rR,Hgt,Fgt,t1],[t1,t1,t1,t1],[t1,b3e,t1,t1],[t1,t1,t1,t1]],7,Ct.ABAA),new Xc(2,2,Ct.BAAB),$localize`Perfect!`),q.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Wa([[Ugt,rR,Bgt,t1],[O3e,Ggt,w3e,t1],[Vgt,b3e,$gt,t1],[t1,t1,t1,t1]],7,Ct.AABA),[new Xc(3,3,Ct.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)])}}class Wgt extends Na{scoreToBoardValue(e,t){if(e===a1.DEFAULT)return new e1(0);{U.assert(e===a1.PRE_VICTORY,"QuartoHeuristic score can only be pre-victory or default");const n=k.of(t%2);return new e1(n.getPreVictory())}}getBoardValue(e){const t=e.gameState;let n={score:a1.DEFAULT,sensitiveSquares:new j1};for(const i of xr.lines)n=xr.updateBoardStatus(i,t,n);return this.scoreToBoardValue(n.score,t.turn)}}class A3e extends Wn{getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getRemainingPieces(),o=n.pieceInHand;let a;for(let c=0;c<4;c++)for(let l=0;l<4;l++)if(i[c][l]===Ct.EMPTY){if(a=n.getCopiedBoard(),a[c][l]=o,15===n.turn){const f=new Xc(l,c,Ct.EMPTY);return t.push(f),t}for(const f of s){const d=new Xc(l,c,f);t.push(d)}}return t}}function qgt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),I("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("y",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("width",2*o.getPieceSize(n.value))("height",2*o.getPieceSize(n.value))}}function jgt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),I("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("r",o.getPieceSize(n.value))}}function Zgt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function Ygt(r,e){if(1&r&&(A(),S(0,"g"),T(1,qgt,1,5,"rect",10),T(2,jgt,1,4,"ng-template",null,11,fn),T(4,Zgt,1,3,"circle",7),P()),2&r){const t=ln(3),n=p().$implicit,i=p(2);_(1),y("ngIf",n.isRectangle())("ngIfElse",t),_(3),y("ngIf",i.pieceHasDot(n.value))}}function Kgt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",9),W("click",function(){const s=te(t).index,o=p().index;return ne(p().chooseCoord(s,o))}),P(),T(2,Ygt,5,3,"g",7),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","chooseCoord_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t!==s.EMPTY)}}function Xgt(r,e){if(1&r&&(A(),S(0,"g",null,8),T(2,Kgt,3,8,"g",2),P()),2&r){const t=e.$implicit;_(2),y("ngForOf",t)}}function Qgt(r,e){if(1&r&&(A(),F(0,"rect",17)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function Jgt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function emt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2);I("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function tmt(r,e){if(1&r){const t=pe();A(),S(0,"g",13,14),W("click",function(){return te(t),ne(p().deselectDroppedPiece())}),F(2,"rect",15),T(3,Qgt,1,5,"rect",16),T(4,Jgt,1,4,"ng-template",null,11,fn),T(6,emt,1,3,"circle",7),P()}if(2&r){const t=ln(5),n=p();Ce("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),I("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),_(2),I("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function nmt(r,e){if(1&r&&(A(),S(0,"g",null,18),F(2,"rect",19),P()),2&r){const t=e.$implicit,n=p();_(2),I("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+t.x*n.SPACE_SIZE+" "+t.y*n.SPACE_SIZE+")")}}function rmt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function imt(r,e){if(1&r&&(A(),F(0,"circle",21)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),I("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function smt(r,e){1&r&&(A(),F(0,"circle",22)),2&r&&I("cy",.75*p(2).SPACE_SIZE)("r",10)}function omt(r,e){if(1&r&&(A(),S(0,"g"),T(1,rmt,1,6,"rect",10),T(2,imt,1,3,"ng-template",null,11,fn),T(4,smt,1,2,"circle",20),P()),2&r){const t=ln(3),n=p();_(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),_(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function amt(r,e){if(1&r&&(A(),F(0,"rect",27)),2&r){const t=p(2).index,n=p().index,i=p();Dn("id","chosenPiece_",4*n+t,""),I("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function cmt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),I("x",i.SPACE_SIZE*t+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("width",2*i.getPieceSize(4*n+t))("height",2*i.getPieceSize(4*n+t))}}function lmt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+t))}}function umt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();I("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function fmt(r,e){if(1&r){const t=pe();A(),S(0,"g",13),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().choosePiece(4*s+i))}),T(1,amt,1,5,"rect",26),T(2,cmt,1,5,"rect",10),T(3,lmt,1,4,"ng-template",null,11,fn),T(5,umt,1,3,"circle",7),P()}if(2&r){const t=ln(4),n=p().index,i=p().index,s=p();Dn("id","choosePiece_",4*i+n,""),_(1),y("ngIf",s.pieceToGive.equalsValue(s.QuartoPiece.ofInt(4*i+n))),_(1),y("ngIf",(4*i+n)%4<2)("ngIfElse",t),_(3),y("ngIf",s.pieceHasDot(4*i+n))}}function dmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,fmt,6,5,"g",3),P()),2&r){const t=e.index,n=p().index,i=p();_(1),y("ngIf",i.isRemaining(4*n+t))}}function hmt(r,e){if(1&r&&(A(),S(0,"g",null,23),F(2,"rect",24,25),T(4,dmt,2,1,"g",2),P()),2&r){const t=e.$implicit,n=p();I("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),_(2),I("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),_(2),y("ngForOf",t)}}let pmt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"EMPTY",Ct.EMPTY),u(this,"QuartoPiece",Ct),u(this,"chosen",g.empty()),u(this,"lastMove",g.empty()),u(this,"pieceInHand",Ct.EMPTY),u(this,"pieceToGive",g.empty()),u(this,"victoriousCoords",[]),this.rules=xr.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,this.rules,new Wgt,new A3e),new Xn($localize`MCTS`,new A3e,this.rules)],this.encoder=Xc.encoder,this.tutorial=(new N3e).tutorial,this.pieceInHand=this.getState().pieceInHand}updateBoard(n){var i=this;return M(function*(){const s=i.getState(),o=i.node.previousMove;i.board=s.getCopiedBoard(),i.chosen=g.empty(),i.pieceInHand=s.pieceInHand,i.victoriousCoords=i.rules.getVictoriousCoords(s),i.lastMove=o.map(a=>a.coord)})()}chooseCoord(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#chooseCoord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hideLastMove(),s.board[i][n]===Ct.EMPTY){if(s.showPieceInHandOnBoard(n,i),15===s.getState().turn){const a=new Xc(n,i,Ct.EMPTY);return s.chooseMove(a)}if(s.pieceToGive.isAbsent())return b.SUCCESS;{const a=new Xc(n,i,s.pieceToGive.get());return s.chooseMove(a)}}return s.cancelMove(Le.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#choosePiece_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.hideLastMove(),i.pieceToGive.equalsValue(Ct.ofInt(n)))return i.cancelMoveAttempt(),b.SUCCESS;if(i.pieceToGive=g.of(Ct.ofInt(n)),i.chosen.isAbsent())return b.SUCCESS;{const o=i.chosen.get(),a=new Xc(o.x,o.y,i.pieceToGive.get());return i.chooseMove(a)}})()}hideLastMove(){this.lastMove=g.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=g.empty(),this.chosen=g.empty()}deselectDroppedPiece(){var n=this;return M(function*(){const i=n.chosen.getOrElse(new C(404,404)),s="#droppedPiece_"+i.x+"_"+i.y,o=yield n.canUserPlay(s);return o.isFailure()?n.cancelMove(o.getReason()):(n.cancelMoveAttempt(),b.SUCCESS)})()}showPieceInHandOnBoard(n,i){this.chosen=g.of(new C(n,i))}isRemaining(n){return Wa.isGivable(Ct.ofInt(n),this.board,this.pieceInHand)}getSquareClasses(n,i){const s=new C(n,i);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(n){const i=[];return i.push(n%2==0?"player0-fill":"player1-fill"),i}getPieceSize(n){return n<8?40:25}pieceHasDot(n){return n!==Ct.EMPTY.value&&n%8<4}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-quarto"]],features:[Xe],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"g",1),T(2,Xgt,3,1,"g",2),T(3,tmt,7,8,"g",3),T(4,nmt,3,3,"g",2),S(5,"g",null,4),F(7,"rect",5,6),T(9,omt,5,3,"g",7),P(),T(10,hmt,5,6,"g",2),P()()),2&n&&(I("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),_(2),y("ngForOf",i.board),_(1),y("ngIf",i.chosen.isPresent()),_(1),y("ngForOf",i.victoriousCoords),_(1),I("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),_(2),I("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),_(2),y("ngIf",i.chosen.isAbsent()&&i.pieceInHand!==i.EMPTY),_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),gmt=(()=>{class r{}return u(r,"NO_INSIDE_CLICK",()=>$localize`You must pick a space from the edge of the board.`),r})(),sr=(()=>{class r extends q1{static getInitialState(){const t=Rt.create(r.SIZE,r.SIZE,Y.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}applyLegalMove(t){const n=this.getCopiedBoard(),i=this.turn+1;let s=t.coord,o=t.coord.getNext(t.direction);for(;r.isOnBoard(o);)n[s.y][s.x]=n[o.y][o.x],s=s.getNext(t.direction),o=o.getNext(t.direction);return n[s.y][s.x]=this.getCurrentPlayer(),new r(n,i)}}return u(r,"SIZE",5),r})();var I3e;class Jc extends wr{static isValidCoord(e){return!1===sr.isOnBoard(e)?b.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&e.x!==sr.SIZE-1&&0!==e.y&&e.y!==sr.SIZE-1?b.failure(gmt.NO_INSIDE_CLICK()):b.SUCCESS}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n;const i=Jc.isValidCoord(this.coord);if(i.isFailure())throw new Error(i.getReason());if(0===e&&n===Re.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(e===sr.SIZE-1&&n===Re.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&n===Re.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(t===sr.SIZE-1&&n===Re.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.direction===this.direction}}I3e=Jc,u(Jc,"encoder",we.tuple([C.encoder,Re.encoder],r=>[r.coord,r.direction],r=>new I3e(r[0].x,r[0].y,r[1])));class j2 extends Kn{static get(){return j2.singleton.isAbsent()&&(j2.singleton=g.of(new j2)),j2.singleton.get()}constructor(){super(sr)}static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=0;i<sr.SIZE;i++)e.gameState.getPieceAtXY(0,i)!==t&&n.push(new C(0,i)),e.gameState.getPieceAtXY(sr.SIZE-1,i)!==t&&n.push(new C(sr.SIZE-1,i));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=1;i<sr.SIZE-1;i++)e.gameState.getPieceAtXY(i,0)!==t&&n.push(new C(i,0)),e.gameState.getPieceAtXY(i,sr.SIZE-1)!==t&&n.push(new C(i,sr.SIZE-1));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(Re.LEFT),0!==e.y&&t.push(Re.UP),e.x!==sr.SIZE-1&&t.push(Re.RIGHT),e.y!==sr.SIZE-1&&t.push(Re.DOWN),t}static getLinesSums(e){const t={};t[k.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[k.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(const n of e.getCoordsAndContents()){const i=n.content,s=n.coord.x,o=n.coord.y;if(i.isPlayer()){const a=i.value;t[a].columns[s]=t[a].columns[s]+1,t[a].rows[o]=t[a].rows[o]+1,s===o&&(t[a].diagonals[0]=t[a].diagonals[0]+1),s+o===sr.SIZE-1&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}static getVictoriousCoords(e){return j2.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}getGameStatus(e){const t=e.gameState,i=j2.QUIXO_HELPER.getVictoriousCoord(t).map(o=>t.getPieceAt(o)),s=new ft(i);return 0===s.size()?_e.ONGOING:1===s.size()?_e.getVictory(s.getAnyElement().get()):_e.getVictory(t.getCurrentPlayer())}}u(j2,"singleton",g.empty()),u(j2,"QUIXO_HELPER",new hu(sr.isOnBoard,U.identity,sr.SIZE));const T1=Y.NONE,ra=Y.ZERO,qa=Y.ONE;class k3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,sr.getInitialState()),q.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new sr([[T1,T1,T1,T1,T1],[T1,T1,T1,T1,T1],[T1,T1,T1,T1,T1],[T1,T1,T1,T1,T1],[ra,ra,ra,ra,T1]],1),[new Jc(4,4,Re.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),q.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new sr([[T1,qa,T1,qa,qa],[T1,ra,ra,T1,ra],[qa,qa,qa,ra,qa],[ra,T1,ra,qa,qa],[qa,ra,T1,qa,ra]],31),[new Jc(3,0,Re.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}class x3e extends Wn{getListMoves(e){const t=[],n=j2.getVerticalCoords(e),s=j2.getHorizontalCenterCoords(e).concat(n);for(const o of s){const a=j2.getPossibleDirections(o);for(const c of a){const l=new Jc(o.x,o.y,c);t.push(l)}}return t}}class mmt extends dr{getMetrics(e){const n=j2.getLinesSums(e.gameState);return[j2.getFullestLine(n[k.ZERO.value]),j2.getFullestLine(n[k.ONE.value])]}}function _mt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"circle",4),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onBoardClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","click_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("r",.45*i.SPACE_SIZE)("cx",(t+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function vmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,_mt,2,6,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Cmt(r,e){if(1&r){const t=pe();A(),S(0,"use",6),W("click",function(){const s=te(t).$implicit;return ne(p(2).chooseDirection(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);Dn("id","chooseDirection_",t,""),I("transform",n.getArrowTransform(t))}}function ymt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Cmt,1,2,"use",5),P()),2&r){const t=p();_(1),y("ngForOf",t.getPossiblesDirections())}}let Mmt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"QuixoState",sr),u(this,"state",void 0),u(this,"lastMoveCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenDirection",void 0),u(this,"victoriousCoords",[]),this.rules=j2.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,this.rules,new mmt,new x3e),new Xn($localize`MCTS`,new x3e,this.rules)],this.encoder=Jc.encoder,this.tutorial=(new k3e).tutorial}updateBoard(n){var i=this;return M(function*(){i.state=i.getState(),i.board=i.state.board,i.lastMoveCoord=i.node.previousMove.map(s=>s.coord),i.victoriousCoords=j2.getVictoriousCoords(i.state)})()}cancelMoveAttempt(){this.chosenCoord=g.empty()}getPieceClasses(n,i){const s=new C(n,i),a=[];return a.push(this.getPlayerClass(this.board[i][n])),this.chosenCoord.equalsValue(s)?a.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&a.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),a}onBoardClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=Jc.isValidCoord(a);return c.isFailure()?s.cancelMove(c.getReason()):s.board[i][n]===s.state.getCurrentOpponent()?s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(s.chosenCoord.equalsValue(a)?s.cancelMoveAttempt():s.chosenCoord=g.of(a),b.SUCCESS)})()}getPossiblesDirections(){const n=[],i=this.chosenCoord.get();return i.x!==sr.SIZE-1&&n.push(Re.RIGHT),0!==i.x&&n.push(Re.LEFT),i.y!==sr.SIZE&&n.push(Re.DOWN),0!==i.y&&n.push(Re.UP),n}chooseDirection(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#chooseDirection_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):(i.chosenDirection=n,yield i.tryMove())})()}tryMove(){var n=this;return M(function*(){const i=n.chosenCoord.get(),s=new Jc(i.x,i.y,n.chosenDirection);return n.chooseMove(s)})()}getArrowTransform(n){return Wdt.getArrowTransform(sr.SIZE*this.SPACE_SIZE,new C(0,0),n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-quixo"]],features:[Xe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0)(1,"defs"),F(2,"polygon",1),P(),T(3,vmt,2,1,"g",2),T(4,ymt,2,1,"g",3),P()),2&n&&(I("viewBox","0 0 "+i.QuixoState.SIZE*i.SPACE_SIZE+" "+i.QuixoState.SIZE*i.SPACE_SIZE),_(3),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),qi=(()=>{class r extends q1{static getInitialState(){const t=Rt.create(r.BOARD_WIDTH,r.BOARD_HEIGHT,Y.NONE);return t[3][3]=k.ZERO,t[4][4]=k.ZERO,t[3][4]=k.ONE,t[4][3]=k.ONE,new r(t,0)}static isOnBoard(t){return t.isInRange(r.BOARD_WIDTH,r.BOARD_HEIGHT)}static getNeighboringPawnLike(t,n,i,s){let o;const a=[];for(let c=-1;c<2;c++)for(let l=-1;l<2;l++)o=new C(i+l,s+c),r.isOnBoard(o)&&t[o.y][o.x]===n&&a.push(o);return a}countScore(){const t=[0,0];for(let n=0;n<r.BOARD_HEIGHT;n++)for(let i=0;i<r.BOARD_WIDTH;i++){const s=this.board[n][i];s.isPlayer()&&(t[s.value]+=1)}return t}}return u(r,"BOARD_WIDTH",8),u(r,"BOARD_HEIGHT",8),r})();var iR;class ji extends wr{static of(e){return new ji(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}u(ji,"encoder",wr.getEncoder((iR=ji).of)),u(ji,"PASS",new iR(-1,-1));let Emt=(()=>{class r{}return u(r,"NO_ELEMENT_SWITCHED",()=>$localize`Your move should switch at least one piece.`),r})();var UC,ia;class L3e{constructor(e,t){u(this,"move",void 0),u(this,"switched",void 0),this.move=e,this.switched=t}}let D0=(UC=class extends Kn{static get(){return ia.singleton.isAbsent()&&(ia.singleton=g.of(new ia)),ia.singleton.get()}constructor(){super(qi)}static getGameStatus(e){const t=e.gameState;if(!1===ia.isGameEnded(t))return _e.ONGOING;const i=t.countScore(),s=i[1]-i[0];return s<0?_e.ZERO_WON:s>0?_e.ONE_WON:_e.DRAW}applyLegalMove(e,t,n){const i=t.turn,s=t.getCurrentPlayer(),o=t.getCopiedBoard();if(e.equals(ji.PASS))return new qi(o,i+1);for(const c of n)o[c.y][c.x]=s;return o[e.coord.y][e.coord.x]=s,new qi(o,i+1)}static getAllSwitcheds(e,t,n){const i=[],s=t.getOpponent();for(const o of Me.DIRECTIONS){const a=e.coord.getNext(o);if(qi.isOnBoard(a)&&n[a.y][a.x]===s){const c=ia.getSandwicheds(t,o,a,n);for(const l of c)i.push(l)}}return i}static getSandwicheds(e,t,n,i){const s=[n];let o=n.getNext(t);for(;qi.isOnBoard(o);){const a=i[o.y][o.x];if(a===e)return s;if(a===Y.NONE)return[];s.push(o),o=o.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return ia.getGameStatus(e)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(ji.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),i=new qi(t,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const t=[];let n;const i=e.getCurrentPlayer(),s=e.getCurrentOpponent();for(let o=0;o<8;o++)for(let a=0;a<8;a++)if(e.getPieceAtXY(a,o)===Y.NONE&&(n=e.getCopiedBoard(),qi.getNeighboringPawnLike(n,s,a,o).length>0)){const l=new ji(a,o),f=ia.getAllSwitcheds(l,i,n);if(f.length>0){for(const d of f)U.assert(i!==e.getPieceAt(d),d+"was already switched!"),n[d.y][d.x]=i;n[o][a]=i,t.push(new L3e(l,f.length))}}return 0===t.length&&t.push(new L3e(ji.PASS,0)),t}isLegal(e,t){if(e.equals(ji.PASS))return ia.playerCanOnlyPass(t)?re.success([]):re.failure(Le.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return re.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const n=t.getCopiedBoard(),i=ia.getAllSwitcheds(e,t.getCurrentPlayer(),n);return 0===i.length?re.failure(Emt.NO_ELEMENT_SWITCHED()):re.success(i)}},ia=UC,u(UC,"singleton",g.empty()),UC);D0=ia=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],D0);const yt=Y.NONE,St=Y.ZERO,Ze=Y.ONE;class R3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new qi([[St,St,St,St,St,St,St,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,St,St,St,St,St,St,St]],60)),q.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,qi.getInitialState(),new ji(2,4),$localize`Congratulations!`),q.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new qi([[yt,yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,yt,Ze,yt,yt,yt],[yt,yt,yt,St,yt,yt,yt,yt],[yt,yt,St,yt,yt,yt,yt,yt],[St,St,yt,yt,yt,yt,yt,yt],[yt,St,Ze,St,Ze,St,yt,yt]],1),[new ji(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),q.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new qi([[Ze,St,St,St,St,St,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[St,Ze,Ze,Ze,Ze,Ze,Ze,St],[Ze,Ze,Ze,Ze,Ze,Ze,yt,yt],[St,St,St,St,St,St,yt,yt]],60))])}}class z3e extends Wn{getListMoves(e){return D0.getListMoves(e.gameState).map(n=>n.move)}}class Pmt extends dr{getMetrics(e){const n=e.gameState.getCopiedBoard();let i=0,s=0;for(let o=0;o<qi.BOARD_HEIGHT;o++)for(let a=0;a<qi.BOARD_WIDTH;a++){const f=(0===a||a===qi.BOARD_WIDTH-1?4:1)*(0===o||o===qi.BOARD_HEIGHT-1?4:1);n[o][a]===k.ZERO&&(i+=f),n[o][a]===k.ONE&&(s+=f)}return[i,s]}}class Tmt extends an{constructor(){super($localize`Minimax`,D0.get(),new Pmt,new z3e)}}function Omt(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClass(t,n)),I("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function bmt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",2),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P(),T(2,Omt,1,4,"circle",3),P()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function wmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,bmt,3,8,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Nmt=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"EMPTY",Y.NONE),u(this,"lastMove",new C(-2,-2)),u(this,"capturedCoords",[]),this.scores=g.of([2,2]),this.rules=D0.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Tmt,new Xn($localize`MCTS`,new z3e,this.rules)],this.encoder=ji.encoder,this.tutorial=(new R3e).tutorial,this.canPass=!1}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new ji(n,i);return yield s.chooseMove(a)})()}updateBoard(n){var i=this;return M(function*(){const s=i.getState();i.board=s.getCopiedBoard(),i.capturedCoords=[],i.lastMove=new C(-2,-2),i.scores=g.of(s.countScore()),i.canPass=D0.playerCanOnlyPass(s)})()}showLastMove(n){var i=this;return M(function*(){i.lastMove=n.coord;const s=i.getState().getCurrentPlayer(),o=i.getState().getCurrentOpponent();for(const a of Me.DIRECTIONS){let c=i.lastMove.getNext(a,1);for(;qi.isOnBoard(c)&&i.getState().getPieceAt(c)===o&&i.getPreviousState().getPieceAt(c)===s;)i.capturedCoords.push(c),c=c.getNext(a,1)}})()}getRectClasses(n,i){const s=new C(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(n,i){return this.getPlayerClass(this.board[i][n])}pass(){var n=this;return M(function*(){return U.assert(n.canPass,"ReversiComponent: pass() can only be called if canPass is true"),n.onClick(ji.PASS.coord.x,ji.PASS.coord.y)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-reversi"]],features:[Xe],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,wmt,2,1,"g",1),P()),2&n&&(I("viewBox","0 -4 "+8*i.SPACE_SIZE+" "+(10+8*i.SPACE_SIZE)),_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),ja=(()=>{class r extends w0{static getInitialState(){const t=ye.UNREACHABLE,n=ye.ZERO,i=ye.ONE,s=ye.EMPTY;return new r([[t,t,n,i,s,s,s,n,i,t,t],[t,s,s,s,s,s,s,s,s,s,t],[i,s,s,s,s,s,s,s,s,s,n],[n,s,s,s,s,s,s,s,s,s,i],[t,s,s,s,s,s,s,s,s,s,t],[t,t,i,n,s,s,s,i,n,t,t]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"HEIGHT",6),u(r,"WIDTH",11),r})(),Tu=(()=>{class r{}return u(r,"CAN_ONLY_REBOUND_ON_BLACK",()=>$localize`You can only rebound on dark spaces.`),u(r,"CAN_ONLY_REBOUND_ON_EMPTY_SPACE",()=>$localize`You can only rebound on empty spaces.`),u(r,"MUST_CHOOSE_PYRAMID_FIRST",()=>$localize`You must pick one of your pyramids first.`),u(r,"MUST_CHOOSE_OWN_PYRAMID",()=>$localize`You must pick one of your pyramids.`),u(r,"THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS",()=>$localize`Those two spaces are not neighbors.`),u(r,"THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR",()=>$localize`Those two spaces have no intermediary neighbor.`),r})();class Za extends Go{static checkDistanceAndLocation(e,t){const n=e.getOrthogonalDistance(t);if(0===n)return b.failure(Le.MOVE_CANNOT_BE_STATIC());if(1===n){const i=Uo.getFakeNeighbors(e);if(t.equals(i))return b.failure(Tu.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return b.failure($localize`You can move one or two spaces, not ${n}.`);if(Uo.isSpaceDark(e))return b.failure(Tu.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return b.failure(Tu.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return b.SUCCESS}static from(e,t){U.assert(ja.isOnBoard(e),"Move must start inside the board not at "+e.toString()+"."),U.assert(ja.isOnBoard(t),"Move must end inside the board not at "+t.toString()+".");const n=Za.checkDistanceAndLocation(e,t);return n.isFailure()?n.toOtherFallible():re.success(new Za(e,t))}constructor(e,t){super(e,t)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var WC,e3;u(Za,"encoder",Vs.getFallibleEncoder(Za.from));let H0=(WC=class extends Kn{static get(){return e3.singleton.isAbsent()&&(e3.singleton=g.of(new e3)),e3.singleton.get()}constructor(){super(ja)}static getStartingCoords(e,t){const n=[];for(let i=0;i<ja.HEIGHT;i++)for(let s=0;s<ja.WIDTH;s++)e[i][s].is(t)&&n.push(new C(s,i));return n}static getBoardValuesFor(e,t){const n=e3.getStartingCoords(e,t),i=[];for(const s of n){const o=w0.getEmptyNeighbors(e,s,ye.EMPTY).length;if(0===o)return[0];i.push(o)}return i.sort((s,o)=>s-o)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=ye.EMPTY,new ja(i,t.turn+1)}isLegal(e,t){if(t.getPieceAt(e.getStart()).value!==t.getCurrentPlayer().value)return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.getEnd())!==ye.EMPTY)return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const s=Uo.getCommonNeighbor(e.getStart(),e.getEnd());return s.isPresent()?t.getPieceAt(s.get())===ye.EMPTY?b.SUCCESS:b.failure(Tu.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):b.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),n=e3.getBoardValuesFor(t,k.ZERO),i=e3.getBoardValuesFor(t,k.ONE);return e3.getGameStatusFromFreedoms(n,i)}getLandingCoords(e,t){const n=s=>ja.isOnBoard(s)&&e[s.y][s.x]===ye.EMPTY,i=new ft(Uo.getNeighbors(t).filter(n));if(!0===Uo.isSpaceDark(t))return i.toList();{const s=new ft(i.toList());for(const o of i){const a=Uo.getNeighbors(o).filter(n);for(const c of a)s.add(c)}return s.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?_e.ONE_WON:0===t[0]?_e.ZERO_WON:_e.ONGOING}},e3=WC,u(WC,"singleton",g.empty()),WC);H0=e3=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],H0);const sa=ye.UNREACHABLE,Ou=ye.ZERO,bu=ye.ONE,on=ye.EMPTY;class H3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Initial board`,$localize`Shr is played on a board where each space is a triangle.
        Each player has six pyramids.`,ja.getInitialState()),q.informational($localize`Goal of the game`,$localize`At Shr, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new ja([[sa,sa,on,on,bu,on,on,Ou,bu,sa,sa],[sa,on,on,on,on,on,on,on,on,on,sa],[bu,Ou,on,on,on,on,on,on,on,on,Ou],[Ou,on,on,on,on,on,on,on,on,on,bu],[sa,on,on,on,on,on,on,on,on,on,sa],[sa,sa,bu,Ou,on,on,on,bu,Ou,sa,sa]],3)),q.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,ja.getInitialState(),Za.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>t.isSimpleStep()?b.SUCCESS:b.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),q.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,ja.getInitialState(),Za.from(new C(7,0),new C(5,0)).get(),(t,n,i)=>t.isSimpleStep()?b.failure($localize`Failed! You have made a single step.`):b.SUCCESS,$localize`Congratulations!`)])}}class Imt extends dr{getMetrics(e){const t=e.gameState.board,n=H0.getBoardValuesFor(t,k.ZERO),i=H0.getBoardValuesFor(t,k.ONE);let s=0;for(;s<6&&n[s]===i[s];)s++;return[n[s%6],i[s%6]]}}class V3e extends Wn{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),s=H0.getStartingCoords(n,i);for(const o of s){const a=w0.getEmptyNeighbors(n,o,ye.EMPTY);for(const c of a){const l=Za.from(o,c).get();if(n[c.y][c.x]=n[o.y][o.x],n[o.y][o.x]=ye.EMPTY,t.push(l),(c.y+c.x)%2==0){const d=w0.getEmptyNeighbors(n,c,ye.EMPTY);for(const m of d)if(!1===m.equals(o)){const E=Za.from(o,m).get();n[m.y][m.x]=n[c.y][c.x],n[c.y][c.x]=ye.EMPTY,t.push(E),n[c.y][c.x]=n[m.y][m.x],n[m.y][m.x]=ye.EMPTY}}n[o.y][o.x]=n[c.y][c.x],n[c.y][c.x]=ye.EMPTY}}return t}}function kmt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polygon",7),P()),2&r){const t=p().index,n=p().index,i=p();_(1),y("ngClass",i.getPlayerClassFor(t,n)),I("points",i.getPyramidPoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function xmt(r,e){if(1&r&&(A(),F(0,"polygon",10)),2&r){const t=p(2).index,n=p().index,i=p();I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Lmt(r,e){if(1&r&&(A(),F(0,"polygon",11)),2&r){const t=p(2).index,n=p().index,i=p();I("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Rmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,xmt,1,2,"polygon",8),T(2,Lmt,1,2,"polygon",9),P()),2&r){const t=p().index,n=p().index;_(1),y("ngIf",(t+n)%2==1),_(1),y("ngIf",(t+n)%2==0)}}function zmt(r,e){if(1&r){const t=pe();A(),S(0,"g",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,kmt,2,3,"g",6),T(2,Rmt,3,2,"g",6),P()}if(2&r){const t=e.$implicit;Ce("id","click_",e.index,"_",p().index,""),_(1),y("ngIf",t.isPlayer()),_(1),y("ngIf",2===t.value)}}function Dmt(r,e){if(1&r&&(A(),S(0,"g"),T(1,zmt,3,4,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Hmt(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=e.$implicit,n=p(2);Ce("id","possible_landing_",t.x,"_",t.y,""),I("points",n.getTrianglePoints(t.x,t.y))("transform",n.getTriangleTranslate(t.x,t.y))}}function Vmt(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);Ce("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),I("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function Fmt(r,e){if(1&r&&(A(),Gt(0),T(1,Hmt,1,4,"polygon",12),T(2,Vmt,1,4,"polygon",13),Bt()),2&r){const t=p();_(1),y("ngForOf",t.possibleLandings),_(1),y("ngIf",t.chosenCoord.isPresent())}}function $mt(r,e){if(1&r&&(A(),Gt(0),F(1,"polygon",15)(2,"polygon",15),Bt()),2&r){const t=p(2);_(1),I("points",t.getTrianglePoints(t.lastCoord.get().x,t.lastCoord.get().y))("transform",t.getTriangleTranslate(t.lastCoord.get().x,t.lastCoord.get().y)),_(1),I("points",t.getTrianglePoints(t.lastMoved.get().x,t.lastMoved.get().y))("transform",t.getTriangleTranslate(t.lastMoved.get().x,t.lastMoved.get().y))}}function Gmt(r,e){1&r&&(A(),T(0,$mt,3,4,"ng-container",6)),2&r&&y("ngIf",p().lastMoved.isPresent())}let Bmt=(()=>{var r;class e extends nce{constructor(n){super(n),u(this,"lastCoord",g.empty()),u(this,"lastMoved",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"possibleLandings",[]),this.rules=H0.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,this.rules,new Imt,new V3e),new Xn($localize`MCTS`,new V3e,this.rules)],this.encoder=Za.encoder,this.tutorial=(new H3e).tutorial}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=g.empty()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentPlayer(),c=ye.ofPlayer(a);return s.chosenCoord.equalsValue(new C(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.board[i][n]===c?s.choosePiece(n,i):s.chooseLandingCoord(n,i)})()}choosePiece(n,i){var s=this;return M(function*(){if(s.board[i][n]===ye.EMPTY)return s.cancelMove(Tu.MUST_CHOOSE_PYRAMID_FIRST());if(s.board[i][n].is(k.ofTurn(s.getTurn()))){const o=new C(n,i);return s.selectPiece(o),b.SUCCESS}return s.cancelMove(Tu.MUST_CHOOSE_OWN_PYRAMID())})()}selectPiece(n){this.chosenCoord=g.of(n),this.possibleLandings=this.rules.getLandingCoords(this.board,n)}chooseLandingCoord(n,i){var s=this;return M(function*(){const o=new C(n,i),a=Za.from(s.chosenCoord.get(),o);return a.isFailure()?s.cancelMove(a.getReason()):yield s.chooseMove(a.get())})()}updateBoard(n){var i=this;return M(function*(){const s=i.node.previousMove;i.lastCoord=s.map(o=>o.getStart()),i.lastMoved=s.map(o=>o.getEnd()),i.board=i.getState().board})()}getPlayerClassFor(n,i){return this.getPlayerClass(k.of(this.board[i][n].value))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-sahara"]],features:[Xe],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-55 -55 610 610","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["class","base mid-stroke",4,"ngIf"],["class","base mid-stroke background2",4,"ngIf"],[1,"base","mid-stroke"],[1,"base","mid-stroke","background2"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(A(),S(0,"svg",0),T(1,Dmt,2,1,"g",1),T(2,Fmt,3,2,"ng-container",2),T(3,Gmt,1,1,"ng-template",null,3,fn),P()),2&n){const s=ln(4);_(1),y("ngForOf",i.board),_(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var Ya;class lt{static decode(e){switch(e){case 0:return lt.EMPTY;case 1:return lt.LIGHT_UP;case 2:return lt.LIGHT_RIGHT;case 3:return lt.LIGHT_DOWN;case 4:return lt.LIGHT_LEFT;case 5:return lt.DARK_UP;case 6:return lt.DARK_RIGHT;case 7:return lt.DARK_DOWN;case 8:return lt.DARK_LEFT;case 9:return lt.MOUNTAIN}}belongTo(e){return e===k.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?k.ZERO:5<=this.value&&this.value<=8?k.ONE:Y.NONE}getOptionalDirection(){switch(this.value){case 0:return g.empty();case 1:case 5:return g.of(Re.UP);case 2:case 6:return g.of(Re.RIGHT);case 3:case 7:return g.of(Re.DOWN);case 4:case 8:return g.of(Re.LEFT);default:return U.expectToBe(this.value,9),g.empty()}}static of(e,t){return t===k.ZERO?e===Re.UP?lt.LIGHT_UP:e===Re.RIGHT?lt.LIGHT_RIGHT:e===Re.DOWN?lt.LIGHT_DOWN:lt.LIGHT_LEFT:e===Re.UP?lt.DARK_UP:e===Re.RIGHT?lt.DARK_RIGHT:e===Re.DOWN?lt.DARK_DOWN:lt.DARK_LEFT}constructor(e){u(this,"value",void 0),this.value=e}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return U.expectToBe(this.value,9),"MOUNTAIN"}}}u(lt,"EMPTY",new(Ya=lt)(0)),u(lt,"LIGHT_UP",new Ya(1)),u(lt,"LIGHT_RIGHT",new Ya(2)),u(lt,"LIGHT_DOWN",new Ya(3)),u(lt,"LIGHT_LEFT",new Ya(4)),u(lt,"DARK_UP",new Ya(5)),u(lt,"DARK_RIGHT",new Ya(6)),u(lt,"DARK_DOWN",new Ya(7)),u(lt,"DARK_LEFT",new Ya(8)),u(lt,"MOUNTAIN",new Ya(9));let O1=(()=>{class r extends q1{static getInitialState(){const t=Rt.create(r.SIZE,r.SIZE,lt.EMPTY);return t[2][1]=lt.MOUNTAIN,t[2][2]=lt.MOUNTAIN,t[2][3]=lt.MOUNTAIN,new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(const n of this.getCoordsAndContents())n.content!==lt.EMPTY&&t[n.content.getOwner().value]++;return t}}return u(r,"SIZE",5),r})();var F3e;class Bs extends wr{constructor(e,t,n,i){super(e,t),u(this,"x",void 0),u(this,"y",void 0),u(this,"direction",void 0),u(this,"landingOrientation",void 0),this.x=e,this.y=t,this.direction=n,this.landingOrientation=i}static from(e,t,n,i){const s=new Bs(e,t,n,i),o=!1===O1.isOnBoard(s.coord);if(s.isRotation()){if(o)return re.failure("Cannot rotate piece outside the board: "+s.toString())}else if(!1===O1.isOnBoard(s.coord.getNext(s.direction.get()))){if(o)return re.failure("SiamMove should end or start on the board: "+s.toString());if(s.direction.get()!==s.landingOrientation)return re.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+s.toString())}return re.success(s)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&!1!==this.direction.equals(e.direction)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||this.coord.x===+O1.SIZE||-1===this.coord.y||this.coord.y===+O1.SIZE}}F3e=Bs,u(Bs,"encoder",we.tuple([we.identity(),we.identity(),g.getEncoder(Re.encoder),Re.encoder],r=>[r.x,r.y,r.direction,r.landingOrientation],r=>F3e.from(r[0],r[1],r[2],r[3]).get()));let wu=(()=>{class r{}return u(r,"NO_REMAINING_PIECE_TO_INSERT",()=>$localize`You cannot insert a piece, all your pieces are already on the board.`),u(r,"NOT_ENOUGH_FORCE_TO_PUSH",()=>$localize`You do not have enough strength to push.`),u(r,"MUST_MOVE_OR_ROTATE",()=>$localize`You must move or rotate your piece.`),u(r,"ILLEGAL_PUSH",()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`),u(r,"MUST_SELECT_VALID_DESTINATION",()=>$localize`You must select a valid destination (highlighted on the board) for your piece`),u(r,"MUST_SELECT_ORIENTATION",()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`),r})();var qC,Nu;class $3e{constructor(e,t){u(this,"resultingBoard",void 0),u(this,"moved",void 0),this.resultingBoard=e,this.moved=t}}let Us=(qC=class extends Kn{static get(){return Nu.singleton.isAbsent()&&(Nu.singleton=g.of(new Nu)),Nu.singleton.get()}constructor(){super(O1)}isLegal(e,t){if(!1===e.isInsertion()&&!1===t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return re.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return this.isLegalRotation(e,t);{let n;if(e.isInsertion()){const i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return re.failure(i.legal.getReason());n=i.insertedPiece}else n=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,n)}}isLegalInsertion(e,t){const n=t.countCurrentPlayerPawn(),i=t.getCurrentPlayer(),s=n<5?b.SUCCESS:b.failure(wu.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,i),legal:s}}getInsertedPiece(e,t){return lt.of(-1===e.x?Re.RIGHT:-1===e.y?Re.DOWN:e.x===O1.SIZE?Re.LEFT:Re.UP,t)}isLegalForwarding(e,t,n){U.assert(n!==lt.MOUNTAIN&&n!==lt.EMPTY,"forwarding must be done with player piece");const i=[];let s=lt.of(e.landingOrientation,t.getCurrentPlayer());const o=e.direction.get();let a=e.coord.getNext(o);if(O1.isOnBoard(a)&&t.getPieceAt(a)!==lt.EMPTY&&!1===this.isStraight(n,e))return re.failure(wu.ILLEGAL_PUSH());let c=g.of(o);const l=o.getOpposite();let f=0;const d=t.getCopiedBoard();O1.isOnBoard(e.coord)&&(d[e.coord.y][e.coord.x]=lt.EMPTY,i.push(e.coord));let m=O1.isOnBoard(a)&&s!==lt.EMPTY;for(;m;){c.equalsValue(o)?f++:c.equalsValue(l)&&f--;const E=d[a.y][a.x];E===lt.MOUNTAIN&&(f-=.9),d[a.y][a.x]=s,i.push(a),s=E,a=a.getNext(o),c=s.getOptionalDirection(),m=O1.isOnBoard(a)&&s!==lt.EMPTY&&f>0}return!1===O1.isOnBoard(a)&&(c.equalsValue(o)?f++:c.equalsValue(l)&&f--),f<=0?re.failure(wu.NOT_ENOUGH_FORCE_TO_PUSH()):re.success(new $3e(d,i))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){const n=e.coord,i=t.getPieceAt(n),s=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return re.failure(wu.MUST_MOVE_OR_ROTATE());const o=t.getCopiedBoard();return o[n.y][n.x]=lt.of(e.landingOrientation,s),re.success(new $3e(o,[n]))}applyLegalMove(e,t,n){const i=Rt.copy(n.resultingBoard);return new O1(i,t.turn+1)}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const i=6-e,s=6-t;return i===s?n.getScoreModifier():i>s?-10*(i+1)+(s+1):10*(s+1)-(i+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let i=0;for(const s of e.getCoordsAndContents())s.content===lt.MOUNTAIN&&(!1===t.includes(s.coord.y)&&t.push(s.coord.y),!1===n.includes(s.coord.x)&&n.push(s.coord.x),i++);return{rows:t,columns:n,nbMountain:i}}getWinner(e,t,n){return 2===n?this.getPusher(e,t.get()):Y.NONE}getPusher(e,t){const n=t.coord;let i;i=O1.isOnBoard(n)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent());const s=i.getDirection(),o=this.getPusherCoord(e,s,n),a=e.getPieceAt(o).getOwner();return Ne.display("SiamRules","getPusher",n.toString()+" belong to "+e.getCurrentOpponent().value+", "+o.toString()+" belong to "+a.value+", "+a.value+" win"),a}getPusherCoord(e,t,n){let i=n.getNext(t),s=n;for(;O1.isOnBoard(i);){n=i,i=i.getNext(t);const o=e.getPieceAt(n);o!==lt.MOUNTAIN&&o.getDirection()===t&&(s=n)}return s}getPushers(e,t,n){let i=[];const s=[];for(const o of t){let a=Re.DOWN,c=new C(o,4);s.push({direction:a,fallingCoord:c}),a=Re.UP,c=new C(o,0),s.push({direction:a,fallingCoord:c})}for(const o of n){let a=Re.LEFT,c=new C(0,o);s.push({direction:a,fallingCoord:c}),a=Re.RIGHT,c=new C(4,o),s.push({direction:a,fallingCoord:c})}for(const o of s)i=this.addPotentialDirectionPusher(e,o.fallingCoord,o.direction,i);return i}addPotentialDirectionPusher(e,t,n,i){const s=this.getLineClosestPusher(e,t,n);if(s.isAbsent())return i;const o=s.get();return i.push({coord:o.coord,distance:o.distance}),i}getLineClosestPusher(e,t,n){const i=n.getOpposite();let s=1,o=e.getPieceAt(t),a=t,c=g.empty(),l=!1,f=!1,d=0;for(;O1.isOnBoard(a)&&!1===l;){const m=e.getPieceAt(a);if(m.isEmptyOrMountain())m===lt.MOUNTAIN?(d+=.9,f=!0):s++;else{const E=m.getDirection();E===n?f&&(d-=1,d<=0&&(l=!0,a=a.getNext(n))):E===i?(d+=1,!1===f&&s++):f?(c=g.of(a),o!==lt.EMPTY&&s++):s++}o=m,a=a.getPrevious(n)}if(!1===l&&c.isPresent())for(s++,d-=1;!1===a.equals(c.get());)a=a.getNext(n),s--;return!1===O1.isOnBoard(a)&&(d-=1,5===e.countCurrentPlayerPawn())||d>0?g.empty():g.of({distance:s,coord:a})}getInsertions(e){let t=[];for(let n=1;n<4;n++)t=t.concat(this.getInsertionsAt(e,0,n)),t=t.concat(this.getInsertionsAt(e,4,n)),t=t.concat(this.getInsertionsAt(e,n,0)),t=t.concat(this.getInsertionsAt(e,n,4));return t=t.concat(this.getInsertionsAt(e,0,0)),t=t.concat(this.getInsertionsAt(e,0,4)),t=t.concat(this.getInsertionsAt(e,4,0)),t=t.concat(this.getInsertionsAt(e,4,4)),t}getInsertionsAt(e,t,n){const i=[];for(const s of Re.ORTHOGONALS){const o=new C(t,n).getPrevious(s);if(!1===O1.isOnBoard(o))for(const a of Re.ORTHOGONALS){const c=Bs.from(o.x,o.y,g.of(s),a);U.assert(c.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(c.get(),e).isSuccess()&&i.push(c.get())}}return i}getMovesFrom(e,t,n,i){const s=new C(n,i);let o=this.getRotationMovesAt(s,t);for(const a of Re.ORTHOGONALS){const c=s.getNext(a);o=o.concat(this.getForwardMovesBetween(e,s,c))}return o}getMovesBetween(e,t,n,i){return n.equals(i)?this.getRotationMovesAt(n,t):Re.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(e,n,i):[]}getRotationMovesAt(e,t){const n=[],i=t.getDirection();for(const s of Re.ORTHOGONALS)if(s!==i){const o=Bs.from(e.x,e.y,g.empty(),s).get();n.push(o)}return n}getForwardMovesBetween(e,t,n){const i=[];let s;const o=Re.factory.fromMove(t,n).get(),a=e.getPieceAt(t);s=O1.isOnBoard(n)?Re.ORTHOGONALS:[o];for(const c of s){const l=Bs.from(t.x,t.y,g.of(o),c).get();this.isLegalForwarding(l,e,a).isSuccess()&&i.push(l)}return i}getGameStatus(e){const t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.previousMove,t.nbMountain);return n.isPlayer()?_e.getVictory(n):_e.ONGOING}},Nu=qC,u(qC,"singleton",g.empty()),qC);Us=Nu=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],Us);const Ie=lt.EMPTY,yo=lt.MOUNTAIN,sR=lt.LIGHT_UP,oR=lt.LIGHT_LEFT,Au=lt.LIGHT_RIGHT,Wmt=lt.LIGHT_DOWN,qmt=lt.DARK_UP,G3e=lt.DARK_LEFT,B3e=lt.DARK_RIGHT,jmt=lt.DARK_DOWN;class U3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,O1.getInitialState()),q.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,O1.getInitialState(),Bs.from(2,-1,g.of(Re.DOWN),Re.DOWN).get(),$localize`Congratulations!`),q.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new O1([[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,yo,yo,yo,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,sR,Ie,Ie]],0),[Bs.from(2,4,g.of(Re.UP),Re.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),q.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new O1([[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,yo,yo,yo,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,sR,Ie,Ie]],0),[Bs.from(2,4,g.of(Re.DOWN),Re.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),q.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new O1([[Ie,Au,G3e,Ie,Ie],[Au,B3e,oR,Ie,Ie],[Ie,Ie,sR,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie]],0),[Bs.from(2,2,g.of(Re.UP),Re.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new O1([[Ie,Ie,Au,yo,Ie],[Ie,Ie,Au,yo,oR],[Ie,Au,yo,yo,Ie],[Ie,Au,B3e,G3e,yo],[Ie,Ie,Ie,Ie,Ie]],0),[Bs.from(1,3,g.of(Re.RIGHT),Re.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),q.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new O1([[Ie,Ie,Ie,Ie,Ie],[Ie,Ie,Ie,Ie,Ie],[yo,qmt,oR,Ie,Wmt],[Ie,Ie,Ie,Ie,jmt],[Ie,Ie,Ie,Ie,yo]],0),[Bs.from(2,2,g.of(Re.LEFT),Re.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)])}}class W3e extends Wn{getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();for(const i of e.gameState.getCoordsAndContents()){const s=i.content;s.belongTo(n)&&(t=t.concat(Us.get().getMovesFrom(e.gameState,s,i.coord.x,i.coord.y)))}if(e.gameState.countCurrentPlayerPawn()<5)for(const i of Us.get().getInsertions(e.gameState))if(i.direction.get().getOpposite()!==i.landingOrientation){if(this.isOnBorder(i)&&i.direction.get()!==i.landingOrientation)continue;t.push(i)}return t}isOnBorder(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}}class Zmt extends Na{getBoardValue(e){const t=this.getBoardValueInfo(e.gameState);return new e1(t.boardValue)}getBoardValueInfo(e){const t=Us.get().getMountainsRowsAndColumns(e),n=t.rows,i=t.columns,s=Us.get().getPushers(e,i,n);let o=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER;const c=e.getCurrentPlayer();for(const f of s)O1.isOnBoard(f.coord)?e.getPieceAt(f.coord).belongTo(k.ZERO)?o=Math.min(o,f.distance):a=Math.min(a,f.distance):c===k.ZERO?o=Math.min(o,f.distance):a=Math.min(a,f.distance);return{shortestZero:o,shortestOne:a,boardValue:Us.get().getScoreFromShortestDistances(o,a,c)}}}class Ymt extends an{constructor(){super($localize`Minimax`,Us.get(),new Zmt,new W3e)}}var Iu;function Xmt(r,e){if(1&r){const t=pe();A(),S(0,"use",11),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().clickSquare(i,s))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();Ce("id","piece_",n,"_",s,""),y("ngClass",o.getPieceClasses(n,s,i)),I("transform",o.getPieceTransform(n,s))}}function Qmt(r,e){if(1&r){const t=pe();A(),S(0,"use",12),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p().clickSquare(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p();I("transform","translate("+(t+1)*i.SPACE_SIZE+" "+(n+1)*i.SPACE_SIZE+")")}}function Jmt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",8),W("click",function(){const s=te(t).index,o=p().index;return ne(p().clickSquare(s,o))}),P(),T(2,Xmt,1,4,"use",9),T(3,Qmt,1,1,"use",10),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();_(1),Ce("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),I("x",s.SPACE_SIZE*(n+1))("y",s.SPACE_SIZE*(i+1))("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isPiece()),_(1),y("ngIf",s.isMountain(t))}}function e_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,Jmt,4,9,"g",4),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function t_t(r,e){if(1&r){const t=pe();A(),S(0,"rect",15),W("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.x,i.y))}),P()}if(2&r){const t=p().$implicit,n=p();Ce("id","square_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),I("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function n_t(r,e){if(1&r){const t=pe();A(),S(0,"g"),T(1,t_t,1,7,"rect",13),S(2,"rect",14),W("click",function(){const s=te(t).$implicit;return ne(p().clickSquare(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),y("ngIf",!1===n.SiamState.isOnBoard(t)),_(1),I("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function r_t(r,e){if(1&r){const t=pe();A(),S(0,"rect",16),W("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),P()}if(2&r){const t=p();I("x",t.SPACE_SIZE*(t.selectedLanding.get().x+1))("y",t.SPACE_SIZE*(t.selectedLanding.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function i_t(r,e){if(1&r){const t=pe();A(),S(0,"rect",16),W("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),P()}if(2&r){const t=p();I("x",t.SPACE_SIZE*(t.selectedPiece.get().x+1))("y",t.SPACE_SIZE*(t.selectedPiece.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function s_t(r,e){if(1&r&&(A(),F(0,"use",19)),2&r){const t=e.$implicit,n=p().$implicit,i=p();Ce("id","remainingPieces_",n.value,"_",t,""),y("ngClass",i.getRemainingPieceClasses(n,t)),I("transform",i.getRemainingPieceTransform(t,n))}}function o_t(r,e){if(1&r){const t=pe();A(),S(0,"g",17),W("click",function(){const s=te(t).$implicit;return ne(p().selectPieceForInsertion(s))}),T(1,s_t,1,4,"use",18),P()}if(2&r){const t=e.$implicit,n=p();Dn("id","remainingPieces_",t.value,""),_(1),y("ngForOf",n.ArrayUtils.range(n.playerPieces(t)))}}function a_t(r,e){if(1&r){const t=pe();A(),S(0,"use",22),W("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),P()}if(2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),I("transform",n.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function c_t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"use",20),W("click",function(){const s=te(t).$implicit;return ne(p().clickArrow(s))}),P(),T(2,a_t,1,2,"use",21),P()}if(2&r){const t=e.$implicit,n=p();_(1),Ni("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),I("transform",n.getIndicatorTransform(t)),_(1),y("ngIf",t.source.isPresent())}}function l_t(r,e){if(1&r){const t=pe();A(),S(0,"use",23),W("click",function(){const s=te(t).$implicit;return ne(p().selectOrientation(s))}),P()}if(2&r){const t=e.$implicit,n=p();Dn("id","orientation_",t.landingOrientation,""),y("ngClass",n.getCurrentPlayerClass()),I("transform",n.getOrientationTransform(t.landingOrientation))}}let aR=(Iu=class extends $i{constructor(e){super(e),u(this,"SiamState",O1),u(this,"lastMove",g.empty()),u(this,"movedPieces",[]),u(this,"selectedPiece",g.empty()),u(this,"selectedLanding",g.empty()),u(this,"orientations",[]),u(this,"clickableCoords",new ft),u(this,"indicatorArrows",[]),u(this,"insertingPiece",!1),this.rules=Us.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new Ymt,new Xn($localize`MCTS`,new W3e,this.rules)],this.encoder=Bs.encoder,this.tutorial=(new U3e).tutorial}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.board,t.movedPieces=[]})()}showLastMove(e){var t=this;return M(function*(){t.lastMove=g.of(e);const n=t.getPreviousState();t.movedPieces=t.rules.isLegal(t.lastMove.get(),n).get().moved})()}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=g.empty(),this.selectedLanding=g.empty(),this.orientations=[],this.clickableCoords=new ft,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#remainingPieces_"+e.value);if(n.isFailure())return t.cancelMove(n.getReason());if(e!==t.getCurrentPlayer())return t.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE());if(t.insertingPiece)return t.cancelMoveAttempt(),b.SUCCESS;t.cancelMoveAttempt();for(const i of Us.get().getInsertions(t.getState())){const s=i.coord.getNext(i.direction.get());if(t.board[s.y][s.x]!==lt.EMPTY){const o={source:g.empty(),target:s,direction:i.direction.get(),move:i};t.indicatorArrows.push(o)}t.clickableCoords.add(s)}return t.insertingPiece=!0,b.SUCCESS})()}selectOrientation(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e)})()}clickSquare(e,t,n=!1){var i=this;return M(function*(){if(!1===n){const o=yield i.canUserPlay("#square_"+e+"_"+t);if(o.isFailure())return i.cancelMove(o.getReason())}const s=new C(e,t);if(i.insertingPiece)return i.insertPiece(s);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),b.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=g.of(s);const o=Us.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),s);return 0===o.length?i.changeMoveDestinationClick(s):i.performMoveOrShowOrientationArrows(o)}{U.assert(i.getState().isOnBoard(s),"SiamComponent: user clicked outside of board when it should not be possible");const o=i.board[t][e];return o.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(s,o)}})()}insertPiece(e){var t=this;return M(function*(){if(t.selectedLanding.isPresent())return yield t.cancelMove(wu.MUST_SELECT_ORIENTATION()),b.SUCCESS;t.selectedLanding=g.of(e);const n=Us.get().getInsertionsAt(t.getState(),e.x,e.y);return 0===n.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(n)})()}changeMoveDestinationClick(e){var t=this;return M(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(wu.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return M(function*(){return U.assert(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?t.chooseMove(e[0]):(t.clickableCoords=new ft,t.indicatorArrows=[],t.orientations=e,b.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=g.of(e);const i=Us.get().getMovesFrom(n,t,e.x,e.y);for(const s of i)if(s.direction.isPresent()){const o=s.coord.getNext(s.direction.get());if(this.clickableCoords.add(o),n.isOnBoard(o)&&n.getPieceAt(o)!==lt.EMPTY){const a={source:g.of({coord:e,piece:t}),target:o,direction:s.direction.get(),move:s};this.indicatorArrows.push(a)}}else this.clickableCoords.add(s.coord);return b.SUCCESS}clickArrow(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===lt.MOUNTAIN}getArrowTransform(e,t,n){const s=`rotate(${90*(n.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",s].join(" ")}getPieceTransform(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}getRemainingPieceTransform(e,t){const n=this.playerPieces(t);let a,c,o=2;return t===this.getPointOfView()?(o+=(e+1+(5-n)/2)/3,a=7,c=Re.LEFT):(o+=(n-e+(5-n)/2)/3,a=-1,c=Re.RIGHT),this.getArrowTransform(o,a,c)}getOrientationTransform(e){const t=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,t].join(" ")}getPieceClasses(e,t,n){const i=new C(e,t),s=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&s.push("selected-stroke"),s}getSquareClasses(e,t){const n=new C(e,t);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}},u(Iu,"\u0275fac",function(e){return new(e||Iu)(B(Ut))}),u(Iu,"\u0275cmp",We({type:Iu,selectors:[["app-siam"]],features:[Xe],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),S(0,"svg",0)(1,"defs"),F(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),P(),T(5,e_t,2,1,"g",4),T(6,n_t,3,5,"g",4),T(7,r_t,1,4,"rect",5),T(8,i_t,1,4,"rect",5),T(9,o_t,2,2,"g",6),T(10,c_t,3,5,"g",4),T(11,l_t,1,3,"use",7),P()),2&e&&(_(5),y("ngForOf",t.board),_(1),y("ngForOf",t.clickableCoords),_(1),y("ngIf",t.selectedLanding.isPresent()),_(1),y("ngIf",t.selectedPiece.isPresent()),_(1),y("ngForOf",t.Player.PLAYERS),_(1),y("ngForOf",t.indicatorArrows),_(1),y("ngForOf",t.orientations))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),Iu);var q3e;aR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],aR);class _r extends Hi{static of(e,t,n){return new _r(e,t,n)}static ofDrop(e){return new _r(g.empty(),e,g.empty())}static ofMovement(e,t){return new _r(g.of(e),t,g.empty())}static ofCut(e,t,n){return new _r(g.of(e),t,g.of(n))}constructor(e,t,n){super(),u(this,"start",void 0),u(this,"landing",void 0),u(this,"keep",void 0),this.start=e,this.landing=t,this.keep=n,U.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),U.assert(e.isAbsent()||!1===e.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}q3e=_r,u(_r,"encoder",we.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(C.encoder)],r=>[r.start,r.landing,r.keep],r=>q3e.of(r[0],r[1],r[2])));let Ka=(()=>{class r{}return u(r,"NO_MOVEMENT_BEFORE_TURN_40",()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`),u(r,"MUST_CUT",()=>$localize`Several groups are of the same size, you must pick the one to keep.`),u(r,"CANNOT_CHOOSE_TO_KEEP",()=>$localize`You cannot choose which part to keep when one is smaller than the other.`),u(r,"CAN_NO_LONGER_DROP",()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`),u(r,"MUST_CAPTURE_BIGGEST_GROUPS",()=>$localize`You must choose one of the biggest groups to keep it.`),u(r,"CANNOT_KEEP_EMPTY_COORD",()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`),u(r,"MUST_DROP_NEXT_TO_OTHER_PIECE",()=>$localize`You must put this piece next to another piece.`),r})();class Zi extends zce{static getInitialState(){return Zi.ofRepresentation([[k.ZERO],[k.ONE]],0)}static ofRepresentation(e,t,n=new Et(0,0)){const i=new iu;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)if(e[s][o]!==Y.NONE){const a=new C(o,s).getNext(n);i.set(a,e[s][o])}return new Zi(i,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new Zi(t,this.turn)}toRepresentation(){const e=Rt.create(this.width,this.height,Y.NONE);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t);e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?b.SUCCESS:b.failure(Ka.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of _2.getNeighbors(e))if(this.pieces.containsKey(n)&&!1===t.equalsValue(n))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():Y.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new Zi(t,this.turn+1)}applyLegalDeplacement(e,t){const n=this.movePiece(e);if(t.size()>0){const i=new iu;for(const s of t)i.set(s,n.getPieceAt(s));return new Zi(i,this.turn+1)}return new Zi(n.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(k.ZERO).getOrElse(new j1),n=e.get(k.ONE).getOrElse(new j1);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new Zi(t,this.turn);h2.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var jC,Dl;let t3=(jC=class extends Kn{static get(){return Dl.singleton.isAbsent()&&(Dl.singleton=g.of(new Dl)),Dl.singleton.get()}constructor(){super(Zi),u(this,"currentVictorySource",void 0)}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):Dl.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new j1;for(const n of e.getPieceCoords())for(const i of be.factory.all){const s=n.getNext(i,1);e.getPieceAt(s)===Y.NONE&&t.add(s)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?re.failure(Ka.NO_MOVEMENT_BEFORE_TURN_40()):re.success(new ft(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return re.failure(Ka.CAN_NO_LONGER_DROP());const n=t.getPieceAt(e.start.get());if(n===Y.NONE)return re.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return re.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());const i=t.movePiece(e),s=i.getGroups();if(Dl.isSplit(s)){const o=this.getLargestGroups(s);return 1===o.size()?e.keep.isPresent()?re.failure(Ka.CANNOT_CHOOSE_TO_KEEP()):re.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,o,i)}return re.success(new j1)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,n=new ft;for(const i of e){const s=i.size();s>t?(t=s,n=new ft([i])):s===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return re.failure(Ka.MUST_CUT());if(n.getPieces().get(e.get()).isAbsent())return re.failure(Ka.CANNOT_KEEP_EMPTY_COORD());const i=e.get();for(const s of t)if(s.contains(i))return re.success(s);return re.failure(Ka.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=[];if(e.previousMove.isPresent()&&(i=this.getShapeVictory(e.previousMove.get(),t)),6===i.length)return _e.getVictory(n);if(t.turn>39){const s=t.countPieces(),o=s[0],a=s[1];return o<6&&a<6?o<a?_e.ONE_WON:a<o?_e.ZERO_WON:_e.DRAW:o<6?_e.getDefeat(k.ZERO):a<6?_e.getDefeat(k.ONE):_e.ONGOING}return _e.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(be.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(e+o.length)%6;o.push(a),a=a.getNext(be.factory.all[l],1)}return o}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return[];c=!0,s=s.getOpposite(),o=o.getNext(s,a.length)}o=o.getNext(s,1)}return a}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return o}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.push(a),o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return o}},Dl=jC,u(jC,"singleton",g.empty()),jC);t3=Dl=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],t3);const ue=Y.NONE,Pt=k.ZERO,At=k.ONE;let cR=(()=>{class r{}return u(r,"MOVEMENT_NOT_DISCONNECTING",()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`),u(r,"MOVEMENT_SELF_DISCONNECTING",()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`),r})();class j3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,Zi.getInitialState()),q.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,Zi.ofRepresentation([[Pt,At,At,At,At,Pt],[ue,Pt,At,ue,Pt,ue],[At,At,Pt,ue,ue,ue],[ue,ue,Pt,ue,ue,ue],[ue,Pt,ue,ue,ue,ue],[Pt,ue,ue,ue,ue,ue]],0),[_r.ofDrop(new C(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Zi.ofRepresentation([[ue,ue,ue,At,ue,ue],[ue,ue,At,At,Pt,Pt],[ue,At,ue,Pt,At,ue],[At,Pt,Pt,Pt,Pt,At]],0),[_r.ofDrop(new C(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),q.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Zi.ofRepresentation([[ue,ue,ue,At,ue,ue],[ue,Pt,At,Pt,Pt,Pt],[ue,Pt,ue,Pt,Pt,ue],[At,At,At,ue,At,ue]],0),[_r.ofDrop(new C(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),q.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,Zi.ofRepresentation([[ue,ue,ue,ue,ue,ue,ue,At,ue],[ue,ue,ue,ue,ue,ue,Pt,ue,ue],[ue,ue,ue,ue,Pt,Pt,Pt,ue,ue],[ue,ue,ue,ue,At,At,ue,At,Pt],[ue,Pt,At,At,Pt,Pt,At,ue,ue],[Pt,Pt,Pt,Pt,At,At,At,Pt,ue],[At,At,Pt,ue,At,At,Pt,ue,ue],[ue,Pt,ue,Pt,Pt,ue,ue,ue,ue],[At,At,At,At,ue,ue,ue,ue,ue],[ue,Pt,ue,At,ue,ue,ue,ue,ue]],40),_r.ofMovement(new C(6,1),new C(5,1)),(t,n,i)=>{const s=i.countPieces();return 19===s[0]?18===s[1]?b.SUCCESS:b.failure(cR.MOVEMENT_NOT_DISCONNECTING()):b.failure(cR.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),q.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,Zi.ofRepresentation([[ue,ue,ue,ue,ue,At],[ue,ue,ue,ue,Pt,At],[ue,ue,ue,At,Pt,Pt],[ue,ue,Pt,ue,At,Pt],[At,At,ue,ue,ue,Pt],[Pt,At,ue,ue,ue,ue],[Pt,ue,ue,ue,ue,ue]],40),_r.ofMovement(new C(2,3),new C(3,3)),(t,n,i)=>t.start.equalsValue(new C(2,3))?b.SUCCESS:b.failure(cR.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),q.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,Zi.ofRepresentation([[ue,ue,ue,ue,ue,At],[ue,ue,ue,ue,Pt,At],[ue,ue,ue,At,Pt,Pt],[Pt,ue,Pt,ue,ue,At],[At,At,ue,ue,ue,ue],[Pt,Pt,ue,ue,ue,ue],[Pt,ue,ue,ue,ue,ue]],40),_r.ofCut(new C(2,3),new C(2,5),new C(2,5)),(t,n,i)=>t.keep.isAbsent()?b.failure($localize`This move has not cut the board in two equal halves.`):i.getPieceAt(t.landing)===Y.NONE?b.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):b.SUCCESS,$localize`Congratulations, you won!`)])}}class f_t extends Na{calculateBoardValue(e,t){this.startSearchingVictorySources();const n={status:a1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let s;if(s=n.status===a1.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n),s.status===a1.VICTORY)return s;n.status=s.status,n.sum=n.sum+s.sum,n.preVictory.isAbsent()&&(n.preVictory=s.preVictory)}return n}}class Z3e extends f_t{constructor(...e){super(...e),u(this,"VERBOSE",!1),u(this,"currentVictorySource",void 0)}getBoardValue(e){const t=e.previousMove,n=e.gameState,i=n.getCurrentOpponent(),s=i.getVictoryValue();let o={status:a1.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};if(t.isPresent()&&(o=this.calculateBoardValue(t.get(),n)),o.status===a1.VICTORY)return new e1(s);if(n.turn>39){const a=n.countPieces();return new e1(a[0]-a[1])}return new e1(o.status===a1.PRE_VICTORY?i.getPreVictory():o.sum*i.getScoreModifier())}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(be.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:a1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};const l=(e+o.length)%6;o.push(a),a=a.getNext(be.factory.all[l],1)}return{status:a1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return{status:a1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};c=!0,s=s.getOpposite(),o=o.getNext(s,a.length-1)}o=o.getNext(s,1)}return{status:a1.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:a1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return{status:a1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:a1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.push(a),o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return{status:a1.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}getBoardInfo(e,t,n,i){const s=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,s,n,i);case"LINE":return this.getBoardInfoForLine(e.index,s,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,s,n,i);default:return this.getBoardInfoForTriangleEdge(e.index,s,n,i)}}getBoardInfoForCircle(e,t,n,i){const s=n.getCurrentPlayer(),a=[t];let c=t.getNext(be.factory.all[e],1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;const m=(e+a.length)%6;a.push(c);const E=be.factory.all[m];d===Y.NONE?(l+=.16,f=g.of(c)):l++,c=c.getNext(E,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoResult(e,t,n,i){let s=i.preVictory;if(4.16===e){if(s.isPresent()&&!1===s.equals(t))return{status:a1.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s=t}else if(5===e)return{status:a1.VICTORY,victory:g.of(n),preVictory:g.empty(),sum:0};return{status:i.status,victory:g.empty(),preVictory:s,sum:i.sum+e}}getBoardInfoForLine(e,t,n,i){const s=be.factory.all[e];let o=t.getPrevious(s,5),a=[],c=[],l=g.empty();for(let R=0;R<6;R++){const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),a.push(o),o=o.getNext(s,1)}let f=i.status,d=i.preVictory,m=0,E=0;for(;m<6;){const R=c.reduce(($,G)=>$+G);5.16===R&&f===a1.DEFAULT&&(d.isPresent()?(U.assert(!1===d.equals(l),"Impossible to have point aligned with different line to a same point"),f=a1.PRE_VICTORY):d=l),E=Math.max(E,R),a=a.slice(1,6),a.push(o),c=c.slice(1,6);const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),m++,o=o.getNext(s,1)}const w={status:f,victory:g.of(a),preVictory:d,sum:E};return this.getBoardInfoResult(E,l,a,w)}updateEncounterAndReturnLastEmpty(e,t,n){const i=e.getCurrentPlayer();switch(e.getPieceAt(t)){case i:return n.push(-7),g.empty();case Y.NONE:return n.push(.16),g.of(t);default:return n.push(1),g.empty()}}getBoardInfoForTriangleCorner(e,t,n,i){const s=n.getCurrentPlayer();let o=be.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===Y.NONE?(l+=.16,f=g.of(c)):l++,a.length%2==0&&(o=be.factory.all[(e+a.length)%6]),a.push(c),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoForTriangleEdge(e,t,n,i){const s=n.getCurrentPlayer();let o=be.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===Y.NONE?(l+=.16,f=g.of(c)):l++,a.push(c),a.length%2==0&&(o=be.factory.all[(e+a.length)%6]),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}}let ZC=class extends Wn{getListMoves(e){const t=t3.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrops(t):this.getMovements(e.gameState,t)}getMovements(e,t){const n=e.getPieces().reverse(),i=e.getCurrentPlayer(),s=n.get(i).get();return this.getMovementsFrom(e,s,t)}getMovementsFrom(e,t,n){const i=[];for(const s of t)for(const o of n){const a=_r.ofMovement(s,o);if(e.isCoordConnected(o,g.of(s))){const l=e.movePiece(a).getGroups();if(t3.isSplit(l)){const f=t3.getLargestGroups(l);if(1===f.size())i.push(_r.ofMovement(s,o));else for(const d of f){const m=d.getAnyElement().get(),E=_r.ofCut(s,o,m);i.push(E)}}else i.push(a)}}return i}getListDrops(e){const t=[];for(const n of e){const i=_r.ofDrop(n);t.push(i)}return t}};ZC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],ZC);class h_t extends ZC{constructor(...e){super(...e),u(this,"heuristic",new Z3e)}getMovements(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementsFrom(e,n,t)}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),n=e.getCurrentPlayer(),i=t.get(n).get(),s=i.getAnyElement().get(),o=[];for(const a of i)!1===this.isPieceBlockingAVictory(e,a)&&o.push(a);return new j1(0===o.length?[s]:o)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),i=_r.ofDrop(t);for(this.heuristic.startSearchingVictorySources();this.heuristic.hasNextVictorySource();)if(this.heuristic.currentVictorySource=this.heuristic.getNextVictorySource(),this.heuristic.searchVictoryOnly(this.heuristic.currentVictorySource,i,n).status===a1.VICTORY)return!0;return!1}}function p_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",10),W("click",function(){const s=te(t).$implicit;return ne(p().onPieceClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","piece_",t.x,"_",t.y,""),y("ngClass",n.getPieceClass(t)),I("points",n.getHexaPointsAt(t))}}function g_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",11),W("click",function(){const s=te(t).$implicit;return ne(p().onNeighborClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","neighbor_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function m_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",10),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.chosenLanding.get()))}),P()}if(2&r){const t=p();Ce("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),y("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),I("points",t.getHexaPointsAt(t.chosenLanding.get()))}}function __t(r,e){if(1&r&&(A(),F(0,"polygon",12)),2&r){const t=e.$implicit,n=p();Ce("id","disconnected_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function v_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",13),W("click",function(){te(t);const i=p();return ne(i.onNeighborClick(i.leftCoord.get()))}),P()}if(2&r){const t=p();Ce("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),I("points",t.getHexaPointsAt(t.leftCoord.get()))}}function C_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",14),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.lastDrop.get()))}),P()}if(2&r){const t=p();Ce("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),I("points",t.getHexaPointsAt(t.lastDrop.get()))}}function y_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",15),W("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.selectedPiece.get()))}),P()}if(2&r){const t=p();Ce("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),y("ngClass",t.getSelectedPieceClass()),I("points",t.getHexaPointsAt(t.selectedPiece.get()))}}function M_t(r,e){if(1&r&&(A(),F(0,"polygon",16)),2&r){const t=e.$implicit,n=p();Ce("id","victoryCoord_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function E_t(r,e){if(1&r){const t=pe();A(),S(0,"polygon",19),W("click",function(){const s=te(t).$implicit;return ne(p(2).onPieceClick(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);Ce("id","cuttable_",t.x,"_",t.y,""),I("points",n.getHexaPointsAt(t))}}function S_t(r,e){if(1&r&&(A(),S(0,"g",17),T(1,E_t,1,3,"polygon",18),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let P_t=(()=>{var r;class e extends lu{constructor(n){super(n),u(this,"state",void 0),u(this,"pieces",void 0),u(this,"disconnecteds",[]),u(this,"cuttableGroups",[]),u(this,"victoryCoords",void 0),u(this,"neighbors",void 0),u(this,"leftCoord",g.empty()),u(this,"lastDrop",g.empty()),u(this,"selectedPiece",g.empty()),u(this,"chosenLanding",g.empty()),u(this,"viewBox",void 0),u(this,"nextClickShouldSelectGroup",!1),this.rules=t3.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Minimax`,this.rules,new Z3e,new h_t),new Xn($localize`MCTS`,new ZC,this.rules)],this.encoder=_r.encoder,this.tutorial=(new j3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new uu(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Ur.INSTANCE)}cancelMoveAttempt(){var n=this;return M(function*(){n.selectedPiece=g.empty(),n.chosenLanding=g.empty(),n.cuttableGroups=[],n.nextClickShouldSelectGroup=!1,yield n.updateBoard(!1)})()}updateBoard(n){var i=this;return M(function*(){i.state=i.node.gameState,i.node.previousMove.isAbsent()&&i.hideLastMove(),i.pieces=i.state.getPieceCoords(),i.neighbors=i.getEmptyNeighbors(),i.viewBox=i.getViewBox()})()}hideLastMove(){this.leftCoord=g.empty(),this.lastDrop=g.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const n=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return h4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(n){var i=this;return M(function*(){i.lastDrop=g.of(n.landing),i.leftCoord=!1===n.isDrop()?g.of(n.start.get()):g.empty();const s=i.getState();i.rules.getGameStatus(i.node).isEndGame&&(i.victoryCoords=i.rules.getShapeVictory(n,s)),i.disconnecteds=i.getDisconnected()})()}getDisconnected(){const n=this.getPreviousState().getPieceCoords(),i=this.getState().getPieceCoords(),s=[];for(const a of n)!1===this.node.previousMove.get().start.equalsValue(a)&&!1===i.some(l=>l.equals(a))&&s.push(a);const o=this.lastDrop.get();return!1===this.pieces.some(a=>a.equals(o))&&!1===i.some(a=>a.equals(o))&&s.push(o),s}getEmptyNeighbors(){let n=t3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const i=this.chosenLanding.get();n=n.filter(s=>!1===s.equals(i))}return n}getPieceClass(n){const i=this.getState().getPieceAt(n);return this.getPlayerClass(i)}onPieceClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#piece_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.state.turn<40)return i.cancelMove(Ka.NO_MOVEMENT_BEFORE_TURN_40());if(i.chosenLanding.isAbsent())return i.state.getPieceAt(n)===i.state.getCurrentOpponent()?i.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(i.selectedPiece=i.selectedPiece.equalsValue(n)?g.empty():g.of(n),b.SUCCESS);{const o=_r.ofCut(i.selectedPiece.get(),i.chosenLanding.get(),n);return i.chooseMove(o)}})()}onNeighborClick(n){var i=this;return M(function*(){const s=yield i.canUserPlay("#neighbor_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.nextClickShouldSelectGroup)return i.cancelMove(Ka.MUST_CUT());if(i.state.turn<40)return i.chooseMove(_r.ofDrop(n));if(i.selectedPiece.isAbsent())return i.cancelMove(Ka.CAN_NO_LONGER_DROP());{const o=_r.ofMovement(i.selectedPiece.get(),n),a=t3.isLegalPhaseTwoMove(o,i.state);return i.neededCutting(a)?(i.chosenLanding=g.of(n),i.moveVirtuallyPiece(),i.showCuttable(),i.nextClickShouldSelectGroup=!0,b.SUCCESS):i.chooseMove(o)}})()}neededCutting(n){return n.isFailure()&&n.getReason()===Ka.MUST_CUT()}moveVirtuallyPiece(){const n=this.selectedPiece.get();this.pieces=this.pieces.filter(i=>!1===i.equals(n)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const n=_r.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(n).getGroups(),o=t3.getLargestGroups(s);this.cuttableGroups=[];for(const a of o)this.cuttableGroups.push(a.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-six"]],features:[Xe],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,p_t,1,4,"polygon",1),T(2,g_t,1,3,"polygon",2),T(3,m_t,1,4,"polygon",3),T(4,__t,1,3,"polygon",4),T(5,v_t,1,3,"polygon",5),T(6,C_t,1,3,"polygon",6),T(7,y_t,1,4,"polygon",7),T(8,M_t,1,3,"polygon",8),T(9,S_t,2,1,"g",9),P()),2&n&&(I("viewBox",i.viewBox),_(1),y("ngForOf",i.pieces),_(1),y("ngForOf",i.neighbors),_(1),y("ngIf",i.chosenLanding.isPresent()),_(1),y("ngForOf",i.disconnecteds),_(1),y("ngIf",i.leftCoord.isPresent()),_(1),y("ngIf",i.lastDrop.isPresent()),_(1),y("ngIf",i.selectedPiece.isPresent()),_(1),y("ngForOf",i.victoryCoords),_(1),y("ngForOf",i.cuttableGroups))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Ws extends wL{static of(e,t){return new Ws(e,t)}static from(e,t){try{const n=new Ws(e,t);return re.success(n)}catch(n){return re.failure(n.message)}}getMaximalDistance(){return 9}}u(Ws,"encoder",Vs.getFallibleEncoder(Ws.from));const T_t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:k.ZERO};class n3 extends NL{static getInitialState(){const e=sn.UNOCCUPIED,t=sn.INVADERS,n=sn.DEFENDERS;return new n3([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,sn.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}of(e,t){return new n3(e,t)}}class Hl extends AL{static get(){return Hl.singleton.isAbsent()&&(Hl.singleton=g.of(new Hl)),Hl.singleton.get()}constructor(){super(n3,T_t,Ws.from)}}u(Hl,"singleton",g.empty());const H=sn.UNOCCUPIED,wn=sn.INVADERS,Yi=sn.DEFENDERS,YC=sn.PLAYER_ONE_KING;class K3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,n3.getInitialState()),q.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,n3.getInitialState(),Ws.of(new C(4,1),new C(1,1)),$localize`Congratulations!`),q.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new n3([[H,H,H,wn,wn,wn,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,H,Yi,H,H,H,H],[H,H,H,wn,Yi,H,H,H,wn],[wn,wn,Yi,Yi,YC,Yi,Yi,wn,wn],[H,H,H,H,Yi,H,H,H,wn],[H,H,H,H,Yi,H,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,wn,wn,wn,H,H,H]],1),[Ws.of(new C(2,4),new C(2,3)),Ws.of(new C(4,2),new C(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),q.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new n3([[H,H,H,wn,wn,wn,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,H,Yi,H,H,H,H],[H,H,Yi,H,YC,H,Yi,H,wn],[wn,wn,H,Yi,H,Yi,Yi,wn,wn],[H,H,H,H,Yi,H,H,H,wn],[H,H,H,H,Yi,H,H,H,H],[H,H,H,H,wn,H,H,H,H],[H,H,H,wn,wn,wn,H,H,H]],12),[Ws.of(new C(1,4),new C(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),q.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new n3([[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,wn,H,H,H,H,H,H,H],[wn,YC,H,wn,H,H,H,H,H],[H,wn,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Ws.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),q.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new n3([[H,H,wn,YC,wn,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,wn,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Ws.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function O_t(r,e){1&r&&(A(),F(0,"polygon",8))}function b_t(r,e){1&r&&(A(),F(0,"rect",9))}function w_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,O_t,1,0,"polygon",6),T(2,b_t,1,0,"ng-template",null,7,fn),P()),2&r){const t=ln(3),n=p().index,i=p().index,s=p();_(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function N_t(r,e){if(1&r&&(A(),S(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),P()),2&r){const t=p(2).index,n=p().index,i=p();_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function A_t(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function I_t(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),_(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),I("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function k_t(r,e){if(1&r&&(A(),T(0,A_t,1,1,"polyline",14),T(1,I_t,4,20,"ng-template",null,15,fn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function x_t(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",10),T(2,N_t,6,25,"g",11),T(3,k_t,3,2,"ng-template",null,12,fn),P()),2&r){const t=ln(4),n=p().index,i=p().index,s=p();_(1),Ce("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),I("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),_(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function L_t(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,w_t,4,2,"g",5),T(3,x_t,5,8,"g",5),P()}if(2&r){const t=e.index,n=p().index,i=p();Ce("id","click_",t,"_",n,""),I("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),I("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),_(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),_(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function R_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,L_t,4,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function z_t(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"rect",17),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),P()()}if(2&r){const t=e.$implicit,n=p();_(1),Ce("id","click_",t.x,"_",t.y,""),I("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let D_t=(()=>{var r;class e extends IL{constructor(n){super(n,Ws.from),this.rules=Hl.get(),this.node=this.rules.getInitialNode(),this.availableAIs=this.createAIs(),this.encoder=Ws.encoder,this.tutorial=(new K3e).tutorial}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-tablut"]],features:[Xe],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,R_t,2,1,"g",1),T(2,z_t,2,6,"g",1),P()),2&n&&(I("viewBox",i.getViewBox()),_(1),y("ngForOf",i.board),_(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Mo=(()=>{class r extends q1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.WIDTH)}static getInitialState(){const t=Rt.create(r.WIDTH,r.WIDTH,Y.NONE);return new r(t,0)}isInDropPhase(){return this.turn<8}}return u(r,"WIDTH",5),r})();var lR;class Eo extends wr{static from(e){return Mo.isOnBoard(e)?re.success(new Eo(e.x,e.y)):re.failure(au.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof Eo&&super.equals(e)}}u(Eo,"encoder",wr.getFallibleEncoder(Eo.from));class qs extends Go{static from(e,t){return!1===Mo.isOnBoard(e)?re.failure(au.OUT_OF_RANGE(e)):!1===Mo.isOnBoard(t)?re.failure(au.OUT_OF_RANGE(t)):e.equals(t)?re.failure(Le.MOVE_CANNOT_BE_STATIC()):re.success(new qs(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof qs&&super.equals(e)}}u(qs,"encoder",Go.getFallibleEncoder(qs.from)),function(r){r.encoder=we.disjunction([e=>e instanceof Eo,e=>e instanceof qs],[Eo.encoder,qs.encoder])}(lR||(lR={}));class oa extends Kn{static get(){return oa.singleton.isAbsent()&&(oa.singleton=g.of(new oa)),oa.singleton.get()}constructor(){super(Mo)}isLegal(e,t){return t.isInDropPhase()?this.isLegalDrop(e,t):this.isLegalTranslation(e,t)}isLegalDrop(e,t){return U.assert(e instanceof Eo,"Cannot translate in dropping phase !"),t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}isLegalTranslation(e,t){U.assert(e instanceof qs,"Cannot drop in translation phase !");const n=e,i=t.getCurrentOpponent();return t.getPieceAt(n.getStart())===i?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(n.getStart())===Y.NONE?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(n.getEnd()).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}applyLegalMove(e,t){return e instanceof Eo?this.applyLegalDrop(e,t):this.applyLegalTranslate(e,t)}applyLegalDrop(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new Mo(n,t.turn+1)}applyLegalTranslate(e,t){const n=t.getCopiedBoard();return n[e.getStart().y][e.getStart().x]=Y.NONE,n[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new Mo(n,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?_e.getVictory(t.getCurrentOpponent()):_e.ONGOING}getLastCoord(e){return e instanceof Eo?e.coord:e.getEnd()}getSquareInfo(e){const t=[],n=[0,0];for(let i=0;i<Mo.WIDTH-1;i++)for(let s=0;s<Mo.WIDTH-1;s++){const o=new C(i,s),a=new C(i+1,s),c=new C(i,s+1),l=new C(i+1,s+1),f=[e.getPieceAt(o),e.getPieceAt(a),e.getPieceAt(c),e.getPieceAt(l)],d=this.count(f,Y.NONE),m=this.count(f,Y.ZERO),E=this.count(f,Y.ONE);d<4&&(4===m||4===E?t.push(o,a,c,l):m>0?n[0]=n[0]+1:n[1]=n[1]+1)}return{score:n[1]-n[0],victoriousCoords:t}}count(e,t){let n=0;for(const i of e)i===t&&n++;return n}getVictoryCoord(e){const t=oa.TEEKO_HELPER.getVictoriousCoord(e);return t.push(...this.getSquareInfo(e).victoriousCoords),t}}u(oa,"singleton",g.empty()),u(oa,"TEEKO_HELPER",new hu(Mo.isOnBoard,U.identity,4));const Fn=Y.NONE,Vl=Y.ZERO,Fl=Y.ONE;class J3e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,Mo.getInitialState()),q.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,Mo.getInitialState(),Eo.from(new C(2,2)).get(),$localize`Congratulations!`),q.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to another empty space. The goal remain to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new Mo([[Vl,Fl,Fn,Fn,Fn],[Vl,Vl,Fn,Fn,Fn],[Fl,Fl,Fn,Fn,Fn],[Fl,Vl,Fn,Fn,Fn],[Fn,Fn,Fn,Fn,Fn]],8),qs.from(new C(1,3),new C(2,1)).get(),$localize`Congratulations!`),q.fromMove($localize`Victory`,$localize`In this board, you can win either by creating a line, or a square.<br/><br/>You are playing Dark, win.`,new Mo([[Fl,Fn,Fn,Fn,Fn],[Fl,Vl,Fn,Fn,Fn],[Fn,Vl,Vl,Fl,Fn],[Fn,Fl,Fn,Vl,Fn],[Fn,Fn,Fn,Fn,Fn]],8),[qs.from(new C(1,2),new C(4,4)).get(),qs.from(new C(3,3),new C(2,1)).get()],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}class H_t extends Na{getBoardValue(e){const t=oa.TEEKO_HELPER.getBoardValue(e.gameState).value,n=oa.get().getSquareInfo(e.gameState);return new e1(n.score+t)}}class e4e extends Wn{getListMoves(e){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState)}getListDrops(e){const t=[];for(const n of e.getCoordsAndContents()){const i=n.coord;if(!1===e.getPieceAt(i).isPlayer()){const s=Eo.from(i).get();t.push(s)}}return t}getListTranslations(e){const t=[],n=e.getCurrentPlayer(),i=this.getCoordsContaining(e,n),s=this.getCoordsContaining(e,Y.NONE);for(const o of i)for(const a of s){const c=qs.from(o,a).get();t.push(c)}return t}getCoordsContaining(e,t){const n=[];for(const i of e.getCoordsAndContents())i.content===t&&n.push(i.coord);return n}}function V_t(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();Ce("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),I("r",42)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function F_t(r,e){if(1&r){const t=pe();A(),S(0,"g",3),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,V_t,1,6,"circle",5),P()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();Ce("id","click_",n,"_",i,""),_(1),Ce("id","space_",n,"_",i,""),y("ngClass",s.getSpaceClasses(n,i)),I("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),_(1),y("ngIf",t.isPlayer())}}function $_t(r,e){if(1&r&&(A(),S(0,"g"),T(1,F_t,3,10,"g",2),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let G_t=(()=>{var r;class e extends $i{constructor(n){super(n),u(this,"selected",g.empty()),u(this,"last",g.empty()),u(this,"moved",[]),u(this,"victory",[]),this.rules=oa.get(),this.node=this.rules.getInitialNode(),this.encoder=lR.encoder,this.tutorial=(new J3e).tutorial,this.availableAIs=[new an($localize`Minimax`,this.rules,new H_t,new e4e),new Xn($localize`MCTS`,new e4e,this.rules)]}updateBoard(n){var i=this;return M(function*(){i.board=i.node.gameState.board})()}showLastMove(n){var i=this;return M(function*(){i.last=g.of(i.rules.getLastCoord(n)),i.moved=n instanceof qs?[n.getStart(),n.getEnd()]:[],i.victory=i.rules.getVictoryCoord(i.getState())})()}hideLastMove(){var n=this;return M(function*(){n.last=g.empty(),n.moved=[],n.victory=[]})()}cancelMoveAttempt(){this.selected=g.empty()}onClick(n,i){var s=this;return M(function*(){const o=yield s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.getState().isInDropPhase()){const c=Eo.from(a).get();return s.chooseMove(c)}if(s.selected.isPresent()){if(s.selected.equalsValue(a))return s.selected=g.empty(),b.SUCCESS;{const c=qs.from(s.selected.get(),a).get();return s.chooseMove(c)}}{const c=s.getState().getCurrentPlayer(),l=s.getState().getPieceAt(a);return l===c?(s.selected=g.of(a),b.SUCCESS):s.cancelMove(l===Y.NONE?Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Le.CANNOT_CHOOSE_OPPONENT_PIECE())}})()}getPieceClasses(n,i){const s=new C(n,i),a=[this.getPlayerClass(this.getState().getPieceAt(s))];return this.victory.some(c=>c.equals(s))?a.push("victory-stroke"):this.last.equalsValue(s)?a.push("last-move-stroke"):this.selected.equalsValue(s)&&a.push("selected-stroke"),a}getSpaceClasses(n,i){const s=new C(n,i);return this.moved.some(o=>o.equals(s))?["moved-fill"]:[]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-teeko"]],features:[Xe],decls:2,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 510 510","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(A(),S(0,"svg",0),T(1,$_t,2,1,"g",1),P()),2&n&&(_(1),y("ngForOf",i.board))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Ci{constructor(e,t){u(this,"owner",void 0),u(this,"tileId",void 0),this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Yr{static of(e){let t=-1;for(const n of e)U.assert(t<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=n.tileId;return new Yr(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?Y.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return Yr.of(this.pieces.concat(e))}getPieceAt(e){return U.assert(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}u(Yr,"EMPTY",Yr.of([]));let S2=(()=>{class r extends q1{static getInitialState(){const t=Rt.create(r.SIZE,r.SIZE,Yr.EMPTY);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}static of(t,n){U.assert(t.length===r.SIZE,"Invalid board dimensions");for(const i of t)U.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(t,n)}drop(t,n){const i=this.getCopiedBoard(),s=new Ci(n,this.turn);return i[t.y][t.x]=i[t.y][t.x].add(s),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,n,i){return this.getPieceAtXY(t,n).getPieceAt(i)}}return u(r,"SIZE",10),r})(),KC=(()=>{class r{}return u(r,"NON_NEIGHBORING_SPACES",()=>$localize`Those two spaces are not neighbors!`),u(r,"NO_WAY_TO_DROP_IT_HERE",()=>$localize`There is no way to put a piece there!`),u(r,"CANNOT_DROP_ON_ONLY_ONE_PIECE",()=>$localize`You cannot drop on only one piece!`),u(r,"CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS",()=>$localize`You cannot drop a piece on uneven grounds!`),r})();var r4e;class js extends Vs{static from(e,t){return U.assert(S2.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),U.assert(S2.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?re.success(new js(e,t)):re.failure(KC.NON_NEIGHBORING_SPACES())}constructor(e,t){super(e,t)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}u(js,"encoder",Vs.getFallibleEncoder(js.from));class yi extends Kn{static get(){return yi.instance.isAbsent()&&(yi.instance=g.of(new yi)),yi.instance.get()}static getOwner(e){return e.getOwner()}constructor(){super(S2)}applyLegalMove(e,t,n){return t.drop(e.getZero(),k.ZERO).drop(e.getOne(),k.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?b.failure(KC.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?b.failure(KC.CANNOT_DROP_ON_ONLY_ONE_PIECE()):b.SUCCESS}isUnevenGround(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}static getSquareScore(e,t){return yi.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],n=[],i=e.getCurrentOpponent();for(const s of e.toMap()){const o=s.key,a=e.getPieceAt(o).getOwner();if(a.isPlayer()){const c=yi.getSquareScore(e,o);e1.isVictory(c)&&(a===i?t.push(o):n.push(o))}}return n.length>0?n:t}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=!1;for(const s of t.toMap()){const o=s.key,a=t.getPieceAt(o).getOwner();if(a.isPlayer()){const c=yi.getSquareScore(t,o);if(e1.isVictory(c)){if(a!==n)return _e.getDefeat(n);i=!0}}}return i?_e.getVictory(n):_e.ONGOING}getLegalMoves(e){const t=[];for(const n of e.toMap()){const i=n.key;if(i.x+1<S2.SIZE){const s=new C(i.x+1,i.y);t.push(...this.getPossiblesMoves(e,i,s))}if(i.y+1<S2.SIZE){const s=new C(i.x,i.y+1);t.push(...this.getPossiblesMoves(e,i,s))}}return t}getPossiblesMoves(e,t,n){const i=e.getPieceAt(t),s=e.getPieceAt(n);let o;o=!i.isGround()&&i.getUpperTileId()===s.getUpperTileId();const a=i.getHeight()!==s.getHeight();return o||a?[]:[js.from(t,n).get(),js.from(n,t).get()]}}r4e=yi,u(yi,"instance",g.empty()),u(yi,"TREXO_HELPER",new hu(S2.isOnBoard,r4e.getOwner,5));const Q=Yr.EMPTY,i4e=Yr.of([new Ci(k.ONE,0)]),B_t=Yr.of([new Ci(k.ZERO,0)]),U_t=Yr.of([new Ci(k.ONE,1)]),s4e=Yr.of([new Ci(k.ZERO,1)]),W_t=Yr.of([new Ci(k.ZERO,2)]),q_t=Yr.of([new Ci(k.ONE,2)]),j_t=Yr.of([new Ci(k.ZERO,0),new Ci(k.ZERO,3)]),Z_t=Yr.of([new Ci(k.ONE,1),new Ci(k.ONE,3)]),Y_t=Yr.of([new Ci(k.ZERO,4)]),K_t=Yr.of([new Ci(k.ONE,4)]),X_t=Yr.of([new Ci(k.ZERO,5)]),Q_t=Yr.of([new Ci(k.ONE,5)]),J_t=Yr.of([new Ci(k.ONE,6)]),evt=Yr.of([new Ci(k.ZERO,6)]);class o4e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,S2.getInitialState()),q.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,S2.getInitialState(),js.from(new C(4,4),new C(3,4)).get(),$localize`Congratulations!`),q.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new S2([[Q,Q,Q,i4e,B_t,s4e,U_t,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),[js.from(new C(4,0),new C(5,0)).get(),js.from(new C(5,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),q.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new S2([[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,X_t,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q_t,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,i4e,Q,Q,Y_t,K_t,Q],[Q,Q,Q,Q,j_t,Z_t,s4e,Q,Q,Q],[Q,Q,Q,Q,Q,W_t,J_t,evt,Q,Q],[Q,Q,Q,Q,Q,q_t,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),js.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>yi.TREXO_HELPER.getSquareScore(i,t.getOne())===Number.MAX_SAFE_INTEGER?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)])}}class tvt extends Na{getBoardValue(e){let t=0;const n=e.gameState;for(const i of n.toMap())n.getPieceAt(i.key).getOwner().isPlayer()&&(t+=yi.getSquareScore(n,i.key));return new e1(t)}}class a4e extends Wn{constructor(...e){super(...e),u(this,"rules",yi.get())}getListMoves(e){return this.rules.getLegalMoves(e.gameState)}}var uR;function nvt(r,e){if(1&r){const t=pe();A(),S(0,"g")(1,"polygon",5),W("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),P()()}if(2&r){const t=e.index,n=p().index,i=p();_(1),Ce("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClasses(t,n)),I("points",i.getParallelogramPoints())("transform",i.getTranslate(t,n,0))}}function rvt(r,e){if(1&r&&(A(),S(0,"g"),T(1,nvt,2,5,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function ivt(r,e){if(1&r){const t=pe();A(),S(0,"g",8),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p(2).onClick(i,s))}),P()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p().index,a=p();Ni("id","half_tile_",n,"_",s,"_",o,""),y("mode",a.mode)("coord",a.Coord3D.of(n,s,o))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,s,o)),I("transform",a.getTranslate(n,s,o+1))}}const c4e=function(r){return[r]};function svt(r,e){if(1&r){const t=pe();A(),S(0,"g",9),W("click",function(){te(t);const i=p().index,s=p().index;return ne(p(2).onClick(i,s))}),P()}if(2&r){const t=p().index,n=p().index,i=p().index,s=p();Ni("id","dropped_piece_",t,"_",n,"_",i,""),y("mode",s.mode)("coord",s.Coord3D.of(t,n,i))("pieceClasses",va(7,c4e,s.currentOpponentClass)),I("transform",s.getTranslate(t,n,i+1))}}function ovt(r,e){if(1&r&&(A(),S(0,"g"),T(1,ivt,1,9,"g",6),T(2,svt,1,9,"g",7),P()),2&r){const t=e.$implicit;_(1),y("ngIf",t.move.isPresent()),_(1),y("ngIf",t.isDroppedPiece)}}function avt(r,e){if(1&r&&(A(),S(0,"g"),T(1,ovt,3,2,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function cvt(r,e){if(1&r&&(A(),S(0,"g"),T(1,avt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}const lvt=function(){return["player0-fill"]};function uvt(r,e){if(1&r){const t=pe();A(),S(0,"g",10),W("click",function(){return te(t),ne(p().switchToMode("3D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",H1(4,lvt)),I("transform",t.get3DSwitcherTransform())}}function fvt(r,e){if(1&r){const t=pe();A(),S(0,"g",11),W("click",function(){return te(t),ne(p().switchToMode("2D"))}),P()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",va(4,c4e,t.currentPlayerClass)),I("transform",t.getTranslate(12,9,0))}}class $n extends Zce{constructor(e){super(e),u(this,"TrexoComponent",$n),u(this,"left",-this.STROKE_WIDTH/2),u(this,"Coord3D",Yd),u(this,"up",0),u(this,"width",void 0),u(this,"height",void 0),u(this,"mode",void 0),u(this,"chosenMode","3D"),u(this,"victoryCoords",[]),u(this,"droppedPiece",g.empty()),u(this,"possibleNextClicks",[]),u(this,"possibleMoves",[]),u(this,"pieceOnBoard",[]),u(this,"currentOpponentClass","player1"),u(this,"currentPlayerClass","player0"),this.rules=yi.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Alignment`,this.rules,new tvt,new a4e),new Xn($localize`MCTS`,new a4e,this.rules)],this.encoder=js.encoder,this.tutorial=(new o4e).tutorial,$n.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D")}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=$n.modeMap[e]}getViewBoxWidth(){const e=$n.modeMap["3D"],t=S2.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=S2.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*$n.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(e){var t=this;return M(function*(){const n=t.getState();t.board=n.getCopiedBoard(),t.currentOpponentClass=t.getPlayerClass(n.getCurrentOpponent()),t.currentPlayerClass=t.getPlayerClass(n.getCurrentPlayer()),t.possibleMoves=t.rules.getLegalMoves(n),t.victoryCoords=yi.getVictoriousCoords(n),t.pieceOnBoard=t.get3DBoard(),t.height=t.getViewBoxHeight(),t.up=t.getViewBoxUp()})()}get3DBoard(){const e=z7t.create(1,S2.SIZE,S2.SIZE,$n.INITIAL_PIECE_ON_BOARD);let t=1;for(let n=0;n<=t;n++)for(const i of this.getState().toMap()){const s=i.key,o=i.value.getHeight();if(t=Math.max(t,o),n<o){const a=this.extractMoveFromState(s.x,s.y,n);this.addMoveToArray(n,a,e)}}return e}extractMoveFromState(e,t,n){const i=this.getState().getPieceAtXYZ(e,t,n),s=new C(e,t);let o=new C(-2,-2);for(const a of Me.ORTHOGONALS){const c=s.getNext(a);if(S2.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(o=c)}}return i.owner===k.ZERO?js.from(s,o).get():js.from(o,s).get()}addMoveToArray(e,t,n){for(;n.length<=e;)n.push(Rt.create(S2.SIZE,S2.SIZE,$n.INITIAL_PIECE_ON_BOARD));n[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)},n[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)}}onClick(e,t){var n=this;return M(function*(){const i=yield n.canUserPlay("#space_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);if(n.droppedPiece.isPresent()){const o=n.droppedPiece.get();if(n.droppedPiece.equalsValue(s))return yield n.cancelMoveAttempt(),b.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(s))){const a=n.getState().getCurrentPlayer()===k.ZERO,f=js.from(a?s:o,a?o:s).get();return n.chooseMove(f)}n.deselectPiece()}return n.selectPiece(s)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[e][t][n]=$n.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[e][i.y][i.x].isPossibleClick=!1}selectPiece(e){var t=this;return M(function*(){if(t.possibleMoves.some(n=>n.getZero().equals(e))){const n=t.getState().getPieceAt(e).getHeight();return n>=t.pieceOnBoard.length&&t.pieceOnBoard.push(Rt.create(S2.SIZE,S2.SIZE,$n.INITIAL_PIECE_ON_BOARD)),t.showDroppedPieceAndIndicators(e,n),b.SUCCESS}return t.cancelMove(KC.NO_WAY_TO_DROP_IT_HERE())})()}showDroppedPieceAndIndicators(e,t){this.droppedPiece=g.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const n of this.possibleNextClicks)this.pieceOnBoard[t][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:g.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:g.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(n=>n.getZero().equals(e)).map(n=>n.getOne())}cancelMoveAttempt(){var e=this;return M(function*(){e.droppedPiece=g.empty(),e.possibleNextClicks=[],yield e.updateBoard(!1)})()}getPieceClasses(e,t,n){const i=new C(e,t),s=this.getState().getPieceAtXYZ(e,t,n).owner;let o=[this.getPlayerClass(s)];o=o.concat(this.getSpaceClasses(e,t));for(const a of this.victoryCoords)if(a.equals(i)){o.push("victory-stroke");break}if(this.node.previousMove.isPresent()){const a=this.node.previousMove.get();(a.getZero().equals(i)||a.getOne().equals(i))&&o.push("last-move-stroke")}return o}getSpaceClasses(e,t){for(const n of this.pieceOnBoard)if(n[t][e].isPossibleClick)return["darker"];return[]}getTranslate(e,t,n){const s=this.getCoordTranslate(e,t,n,$n.modeMap[this.chosenMode]);return"translate("+s.x+" "+s.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords($n.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=$n.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}}uR=$n,u($n,"STROKE_WIDTH",void 0),u($n,"INITIAL_PIECE_ON_BOARD",{isDroppedPiece:!1,isPossibleClick:!1,move:g.empty()}),u($n,"modeMap",{"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}}),u($n,"\u0275fac",function(e){return new(e||uR)(B(Ut))}),u($n,"\u0275cmp",We({type:uR,selectors:[["app-trexo"]],features:[Xe],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,t){if(1&e&&(A(),S(0,"svg",0),T(1,rvt,2,1,"g",1),T(2,cvt,2,1,"g",1),S(3,"g",null,2),T(5,uvt,1,5,"g",3),T(6,fvt,1,6,"ng-template",null,4,fn),P()()),2&e){const n=ln(7);I("viewBox",t.left+" "+t.up+" "+t.width+" "+t.height),_(1),y("ngForOf",t.board),_(1),y("ngForOf",t.pieceOnBoard),_(3),y("ngIf","2D"===t.chosenMode)("ngIfElse",n)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class X1{}var aa;u(X1,"PLACEMENT_AFTER_INITIAL_PHASE",()=>$localize`You cannot put a new ring after the tenth turn.`),u(X1,"NO_MARKERS_IN_INITIAL_PHASE",()=>$localize`You cannot put a marker in a ring before placing all of your rings.`),u(X1,"MISSING_CAPTURES",Ko.MISSING_CAPTURES),u(X1,"MOVE_DIRECTION_INVALID",()=>$localize`The direction of your move is invalid: a move is made along a straight line.`),u(X1,"CAN_ONLY_CAPTURE_YOUR_MARKERS",()=>$localize`You can only capture your own markers.`),u(X1,"SHOULD_SELECT_PLAYER_RING",()=>$localize`You must pick one of your own rings to move.`),u(X1,"SHOULD_END_MOVE_ON_EMPTY_SPACE",()=>$localize`Your ring must land on an empty space.`),u(X1,"MOVE_SHOULD_NOT_PASS_ABOVE_RING",()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`),u(X1,"MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS",()=>$localize`Your ring must land on the first empty space after a group of markers.`),u(X1,"AMBIGUOUS_CAPTURE_COORD",Ko.AMBIGUOUS_CAPTURE_COORD),u(X1,"CAPTURE_SHOULD_TAKE_RING",()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`);class It{static of(e,t){return e===Y.NONE?It.EMPTY:t?It.RINGS[e.value]:It.MARKERS[e.value]}constructor(e,t){u(this,"player",void 0),u(this,"isRing",void 0),this.player=e,this.isRing=t}equals(e){return this===e}flip(){return je(!1===this.isRing,"cannot flip a ring (it should never happen)"),je(this.player.isPlayer(),"cannot flip a non-player piece"),It.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case It.UNREACHABLE:return"NONE";case It.EMPTY:return"EMPTY";case It.MARKER_ZERO:return"MARKER_ZERO";case It.MARKER_ONE:return"MARKER_ONE";case It.RING_ZERO:return"RING_ZERO";default:return U.expectToBe(this,It.RING_ONE),"RING_ONE"}}}aa=It,u(It,"encoder",we.tuple([Y.encoder,we.identity()],r=>[r.player,r.isRing],r=>aa.of(r[0],r[1]))),u(It,"UNREACHABLE",new aa(Y.NONE,!1)),u(It,"EMPTY",new aa(Y.NONE,!1)),u(It,"MARKER_ZERO",new aa(k.ZERO,!1)),u(It,"MARKER_ONE",new aa(k.ONE,!1)),u(It,"MARKERS",[aa.MARKER_ZERO,aa.MARKER_ONE]),u(It,"RING_ZERO",new aa(k.ZERO,!0)),u(It,"RING_ONE",new aa(k.ONE,!0)),u(It,"RINGS",[aa.RING_ZERO,aa.RING_ONE]);let ca=(()=>{class r extends DL{static getInitialState(){const t=It.EMPTY,n=It.UNREACHABLE;return new r([[n,n,n,n,n,n,t,t,t,t,n],[n,n,n,n,t,t,t,t,t,t,t],[n,n,n,t,t,t,t,t,t,t,t],[n,n,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,n,n],[t,t,t,t,t,t,t,t,n,n,n],[t,t,t,t,t,t,t,n,n,n,n],[n,t,t,t,t,n,n,n,n,n,n]],[5,5],0)}constructor(t,n,i){super(i,t,r.SIZE,r.SIZE,[6,4,3,2,1],It.EMPTY),u(this,"sideRings",void 0),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(t){return this===t||this.turn===t.turn&&this.sideRings[0]===t.sideRings[0]&&this.sideRings[1]===t.sideRings[1]&&Rt.compare(this.board,t.board)}getRingCoords(t){const n=[];return this.forEachCoord((i,s)=>{s.isRing&&s.player===t&&n.push(i)}),n}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==It.UNREACHABLE}setAtUnsafe(t,n){const i=Rt.copy(this.board);return i[t.y][t.x]=n,new r(i,this.sideRings,this.turn)}}return u(r,"SIZE",11),r})();var l4e,u4e;class la extends B2{static of(e,t,n){const i=[],s=be.factory.fromMove(e,t).get();for(let o=e;!1===o.equals(t);o=o.getNext(s))i.push(o);return i.push(t),new la(i,n)}constructor(e,t=g.empty()){if(super(e),u(this,"ringTaken",void 0),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}setRingTaken(e){return new la(this.capturedSpaces,g.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}l4e=la,u(la,"encoder",we.tuple([we.list(C.encoder),g.getEncoder(C.encoder)],r=>[r.capturedSpaces,r.ringTaken],r=>new l4e(r[0],r[1])));class r3 extends Hi{constructor(e,t,n,i){super(),u(this,"initialCaptures",void 0),u(this,"start",void 0),u(this,"end",void 0),u(this,"finalCaptures",void 0),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===en.compare(this.initialCaptures,e.initialCaptures)||!1===en.compare(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}u4e=r3,u(r3,"encoder",we.tuple([we.list(la.encoder),C.encoder,g.getEncoder(C.encoder),we.list(la.encoder)],r=>[r.initialCaptures,r.start,r.end,r.finalCaptures],r=>new u4e(r[0],r[1],r[2],r[3])));class Xa extends Kn{static get(){return Xa.singleton.isAbsent()&&(Xa.singleton=g.of(new Xa)),Xa.singleton.get()}constructor(){super(ca)}applyLegalMove(e,t,n){return new ca(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new ca(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,i=e.setAt(t,It.EMPTY).board,s=[e.sideRings[0],e.sideRings[1]];return s[n]+=1,new ca(i,s,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(n=>{e=e.setAt(n,It.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===It.RINGS[n]?b.SUCCESS:b.failure(X1.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const i=n.getCurrentPlayer().value;let s=n.setAt(e,It.MARKERS[i]);s=s.setAt(t,It.RINGS[i]);const o=be.factory.fromMove(e,t).get();for(let a=e.getNext(o);!1===a.equals(t);a=a.getNext(o)){const c=s.getPieceAt(a);c!==It.EMPTY&&(s=s.setAt(a,c.flip()))}return s}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return re.failure(X1.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(e.initialCaptures,t),s=this.moveValidity(i,e.start,e.end.get());if(s.isFailure())return s.toOtherFallible();const o=this.applyRingMoveAndFlip(e.start,e.end.get(),i),a=this.capturesValidity(o,e.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(e.finalCaptures,o),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():re.success(c)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return re.failure(X1.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==It.EMPTY)return re.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),i=[e.sideRings[0],e.sideRings[1]];i[n.value]-=1;const s=e.setAt(t,It.of(n,!0)).board,o=new ca(s,i,e.turn);return re.success(o)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==It.RINGS[n]?b.failure(X1.SHOULD_SELECT_PLAYER_RING()):b.SUCCESS}moveValidity(e,t,n){const i=this.moveStartValidity(e,t);if(i.isFailure())return i;if(e.getPieceAt(n)!==It.EMPTY)return b.failure(X1.SHOULD_END_MOVE_ON_EMPTY_SPACE());const s=be.factory.fromMove(t,n);if(s.isFailure())return b.failure(X1.MOVE_DIRECTION_INVALID());const o=s.get();let a=!1;for(let c=t.getNext(o);!1===c.equals(n);c=c.getNext(o)){const l=e.getPieceAt(c);if(l===It.EMPTY){if(a)return b.failure(X1.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return b.failure(X1.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return b.SUCCESS}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=this.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const i of t.capturedSpaces)if(e.getPieceAt(i)!==It.MARKERS[n])return b.failure(X1.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==It.RINGS[n]?b.failure(X1.CAPTURE_SHOULD_TAKE_RING()):b.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(X1.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let c,a=s;for(c=s;e.isOnBoard(c);c=c.getNext(o)){const l=e.getPieceAt(c);if(l.player===t&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(i>=5)break;i=0}}return i>=5?g.of({start:a,end:c,dir:o}):g.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(i=>{for(let s=i.start;s.getDistance(i.end)>=5;s=s.getNext(i.dir))n.push(la.of(s,s.getNext(i.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const i of be.factory.all){let s=!1;for(let o=t.getNext(i);e.isOnBoard(o);o=o.getNext(i)){const a=e.getPieceAt(o);if(a===It.EMPTY){if(n.push(o),s)break}else{if(a.isRing)break;s=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?_e.ONGOING:e.gameState.sideRings[0]>=3?_e.ZERO_WON:e.gameState.sideRings[1]>=3?_e.ONE_WON:_e.ONGOING}}u(Xa,"singleton",g.empty());const D=It.EMPTY,he=It.UNREACHABLE,Z2=It.MARKER_ZERO,Ki=It.RING_ZERO,i3=It.MARKER_ONE,P2=It.RING_ONE;let f4e=(()=>{class r{}return u(r,"MUST_ALIGN_FIVE",()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`),u(r,"MUST_CAPTURE_TWO",()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`),r})();class d4e extends Yn{constructor(...e){super(...e),u(this,"tutorial",[q.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new ca([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,Z2,P2,D,D,D,D,D,D],[he,he,D,Z2,D,P2,D,i3,D,D,D],[he,D,Ki,i3,D,D,P2,Z2,D,D,D],[he,D,D,Z2,i3,D,D,D,D,D,he],[D,D,D,Z2,D,D,D,P2,D,D,he],[D,D,D,i3,Z2,Ki,D,D,D,he,he],[D,D,D,D,D,D,D,D,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[3,1],20)),q.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new ca(ca.getInitialState().board,[5,5],0),new r3([],new C(5,5),g.empty(),[]),$localize`Congratulations!`),q.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new ca([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,P2,D,D,D,D,D,D,D],[he,he,P2,D,D,P2,D,D,D,D,D],[he,D,Ki,i3,D,D,P2,D,D,D,D],[he,D,D,i3,D,D,D,D,D,D,he],[D,D,D,D,Ki,D,D,P2,D,D,he],[D,D,D,D,D,Ki,D,D,D,he,he],[D,D,D,Ki,D,D,D,he,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new r3([],new C(2,4),g.of(new C(4,4)),[]),$localize`Congratulations!`),q.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new ca([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,P2,D,D,D,D,D,D,D],[he,he,P2,D,D,P2,D,D,D,D,D],[he,D,Z2,Z2,Ki,i3,i3,D,D,D,D],[he,D,D,P2,D,D,D,D,D,D,he],[D,D,D,D,Ki,D,D,P2,D,D,he],[D,D,D,D,D,Ki,D,D,D,he,he],[D,D,D,Ki,D,D,D,Ki,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new r3([],new C(4,4),g.of(new C(7,4)),[la.of(new C(2,4),new C(6,4),g.of(new C(7,4)))]),(t,n,i)=>1===i.sideRings[k.ZERO.value]?b.SUCCESS:b.failure(f4e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),q.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new ca([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,Ki,D,D,P2,P2,Ki,D],[he,he,he,Ki,D,D,i3,P2,D,Ki,D],[he,he,D,Ki,D,D,D,D,D,P2,D],[he,D,D,D,D,Z2,D,D,P2,D,D],[he,D,D,D,Z2,Z2,D,i3,D,D,he],[D,D,D,Z2,D,Z2,D,D,D,D,he],[D,D,Z2,D,D,Z2,D,D,D,he,he],[D,Z2,D,D,D,Z2,D,D,he,he,he],[D,D,D,D,D,Z2,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],10),new r3([la.of(new C(5,4),new C(1,8),g.of(new C(3,2))),la.of(new C(5,9),new C(5,5),g.of(new C(3,3)))],new C(4,1),g.of(new C(4,2)),[]),(t,n,i)=>2===i.sideRings[k.ZERO.value]?b.SUCCESS:b.failure(f4e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)])}}class dvt extends dr{getMetrics(e){return e.gameState.sideRings}}class hvt{static getCombinations(e,t){return je(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(e){const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let s=1;for(;s<t;)if(i[s]<s){const o=s%2&&i[s],a=e[s];e[s]=e[o],e[o]=a,++i[s],s=1,n.push(e.slice())}else i[s]=0,++s;return n}static getSubsetsOfSize(e,t){return function n(i,s){if(s>=e.length||i<1)return[[]];{const o=[];for(;s<=e.length-i;){const a=e[s];for(const c of n(i-1,s+1))c.push(a),o.push(c);++s}return o}}(t,0)}}class h4e extends Wn{getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const{coord:i,content:s}of n.getCoordsAndContents())s===It.EMPTY&&t.push(new r3([],i,g.empty(),[]));else{const i=Xa.get();this.getPossibleCaptureCombinations(n).forEach(s=>{const o=i.applyCaptures(s,n);this.getRingMoves(o).forEach(a=>{const c=i.applyRingMoveAndFlip(a.start,a.end,o);this.getPossibleCaptureCombinations(c).forEach(l=>{const f=new r3(s,a.start,g.of(a.end),l);t.push(f)})})})}return t}getPossibleCaptureCombinations(e){const n=Xa.get().getPossibleCaptures(e),i=this.getRingCoords(e);return hC.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(s=>hvt.getCombinations(i,s.length).map(o=>s.map((a,c)=>new la(a.capturedSpaces,g.of(o[c]))))).reduce((s,o)=>s.concat(o),[])}getRingMoves(e){const t=Xa.get(),n=[];for(const i of this.getRingCoords(e))for(const s of t.getRingTargets(e,i))n.push({start:i,end:s});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((i,s)=>{s===It.RINGS[t]&&n.push(i)}),n}}var XC;function pvt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);I("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringOuterSize)}}function gvt(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();Ce("id","ring_",n,"_",s,""),y("ngClass",i.ringClasses),I("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function mvt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);I("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringInnerSize)}}function _vt(r,e){if(1&r&&(A(),F(0,"circle",14)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();Ce("id","marker_",n,"_",s,""),y("ngClass",i.markerClasses),I("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function vvt(r,e){if(1&r){const t=pe();A(),S(0,"g",6),W("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),F(1,"polygon",7),S(2,"g",8),T(3,pvt,1,3,"circle",9),T(4,gvt,1,6,"circle",10),T(5,mvt,1,3,"circle",9),T(6,_vt,1,6,"circle",11),P()()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index;Ce("id","click_",n,"_",s,""),_(1),Ce("id","space_",n,"_",s,""),y("ngClass",i.spaceClasses),I("points",i.coordinates),_(1),Ce("id","pieceGroup_",n,"_",s,""),y("ngClass",i.removedClass),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isRing),_(1),y("ngIf",i.isMarker)}}function Cvt(r,e){if(1&r&&(A(),S(0,"g"),T(1,vvt,7,13,"g",5),P()),2&r){const t=e.$implicit;_(1),y("ngIf",null!=t)}}function yvt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Cvt,2,1,"g",1),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}function Mvt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",15),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","selected_",t.x,"_",t.y,""),I("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function Evt(r,e){if(1&r){const t=pe();A(),S(0,"polygon",17),W("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p(2);Ce("id","selectable_",t.x,"_",t.y,""),I("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function Svt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Evt,1,3,"polygon",16),P()),2&r){const t=p();_(1),y("ngForOf",t.viewInfo.selectableCoords)}}function Pvt(r,e){if(1&r){const t=pe();A(),S(0,"rect",18),W("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),P()}if(2&r){const t=e.$implicit,n=p();Ce("id","indicator_",t.x,"_",t.y,""),I("x",n.viewInfo.spaceInfo[t.y][t.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[t.y][t.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function Tvt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",19)(2,"circle",12)(3,"circle",20),P()),2&r){const t=e.index,n=p().$implicit,i=p();_(1),Ce("id","player_",n.value,"_sideRing_",t+1,""),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringOuterSize),_(1),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringInnerSize),_(1),y("ngClass",i.viewInfo.sideRingClass[n.value]),I("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringMidSize)}}const Ovt=function(){return[]};function bvt(r,e){if(1&r&&(A(),S(0,"g"),T(1,Tvt,4,12,"g",1),P()),2&r){const t=e.$implicit,n=p();I("transform","rotate("+180*(n.getPointOfView().value+1)+" 532.5 780)"),_(1),y("ngForOf",H1(2,Ovt).constructor(n.viewInfo.sideRings[t.value]))}}class Mi extends lu{constructor(e){super(e),u(this,"constructedState",void 0),u(this,"movePhase","MOVE_START"),u(this,"moveStart",g.empty()),u(this,"moveEnd",g.empty()),u(this,"currentlyMoved",[]),u(this,"currentCapture",g.empty()),u(this,"initialCaptures",[]),u(this,"finalCaptures",[]),u(this,"possibleCaptures",[]),u(this,"viewInfo",{spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:Mi.MARKER_SIZE,ringOuterSize:Mi.RING_OUTER_SIZE,ringMidSize:Mi.RING_MID_SIZE,ringInnerSize:Mi.RING_INNER_SIZE,indicatorSize:Mi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]}),this.scores=g.of([0,0]),this.rules=Xa.get(),this.node=this.rules.getInitialNode(),this.availableAIs=[new an($localize`Score`,this.rules,new dvt,new h4e),new Xn($localize`MCTS`,new h4e,this.rules)],this.encoder=r3.encoder,this.tutorial=(new d4e).tutorial,this.hexaLayout=new uu(1.5*Mi.RING_OUTER_SIZE,new C(2*Mi.RING_OUTER_SIZE,0),Ur.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPointsAt(t),center:this.getCenterAt(t),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(e){var t=this;return M(function*(){t.cancelMoveAttempt();const n=t.getState();t.scores=g.of(n.countScores())})()}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of k.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==It.EMPTY&&(!1===t.isRing||this.moveStart.equalsValue(e))){const i=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=g.empty(),this.moveStart=g.empty(),this.moveEnd=g.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){var t=this;return M(function*(){if(e.isInitialPlacement())t.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const i of t.coordsBetween(e.start,e.end.get()))t.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["moved-fill"];const n=t.currentCapture.isAbsent()&&0===t.initialCaptures.length&&t.moveStart.isAbsent();e.initialCaptures.forEach(i=>t.showLastMoveCapture(i,n)),e.finalCaptures.forEach(i=>t.showLastMoveCapture(i,n))}})()}coordsBetween(e,t){const n=[],i=be.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(i))this.constructedState.getPieceAt(s)!==It.EMPTY&&n.push(s),n.push(t);return n}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(n,this.getState().getCurrentOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),b.SUCCESS}onClick(e){var t=this;return M(function*(){const n=yield t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return M(function*(){const n=[];if(t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(X1.MISSING_CAPTURES());t.selectCapture(n[0])}return b.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const n of t.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(U.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return M(function*(){const n=[];return t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1?t.cancelMove(X1.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(X1.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=g.of(e),this.constructedState=new ca(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(je("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),b.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,It.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,It.RINGS[t.value])}selectRing(e){var t=this;return M(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const i=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=g.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS)):(U.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),b.SUCCESS}tryMove(){var e=this;return M(function*(){const t=new r3(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return M(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=g.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=g.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return b.SUCCESS})()}selectMoveEnd(e){var t=this;return M(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),b.SUCCESS;const n=It.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=g.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return M(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),b.SUCCESS)})()}}function wvt(r,e){if(1&r&&(S(0,"option",5),ct(1),P()),2&r){const t=e.$implicit;y("value",t.urlName),_(1),An(t.name)}}XC=Mi,u(Mi,"RING_OUTER_SIZE",40),u(Mi,"RING_MID_SIZE",34),u(Mi,"RING_INNER_SIZE",28),u(Mi,"MARKER_SIZE",XC.RING_INNER_SIZE),u(Mi,"INDICATOR_SIZE",10),u(Mi,"\u0275fac",function(e){return new(e||XC)(B(Ut))}),u(Mi,"\u0275cmp",We({type:XC,selectors:[["app-yinsh"]],features:[Xe],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(A(),S(0,"svg",0),T(1,yvt,2,1,"g",1),T(2,Mvt,1,3,"polygon",2),T(3,Svt,2,1,"g",3),T(4,Pvt,1,6,"rect",4),T(5,bvt,2,3,"g",1),P()),2&e&&(_(1),y("ngForOf",t.viewInfo.spaceInfo),_(1),y("ngForOf",t.viewInfo.selectedCoords),_(1),y("ngIf",t.isPlayerTurn()),_(1),y("ngForOf",t.viewInfo.targets),_(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Wt,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));let xn=(()=>{class r{}return u(r,"ABALONE",()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`),u(r,"APAGOS",()=>$localize`Very simple game, but, will you be able to win everytime?`),u(r,"AWALE",()=>$localize`The most widespread of the Mancalas.`),u(r,"BRANDHUB",()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"COERCEO",()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`),u(r,"CONNECT_SIX",()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`),u(r,"CONSPIRATEURS",()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`),u(r,"DIAM",()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`),u(r,"DVONN",()=>$localize`Stack your pieces and control as many stacks as you can to win!`),u(r,"ENCAPSULE",()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`),u(r,"EPAMINONDAS",()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`),u(r,"GIPF",()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`),u(r,"GO",()=>$localize`The oldest strategy game still practiced widely. A territory control game.`),u(r,"HIVE",()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`),u(r,"HNEFATAFL",()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`),u(r,"KALAH",()=>$localize`A modern version of the famous African strategy game!`),u(r,"KAMISADO",()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`),u(r,"LASCA",()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`),u(r,"LINES_OF_ACTION",()=>$localize`Regroup your pieces to win. But your possible moves will often change!`),u(r,"LODESTONE",()=>$localize`Push and crush your opponent's pieces using magnetic forces!`),u(r,"MARTIAN_CHESS",()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`),u(r,"P4",()=>$localize`The classical 4 in a row game!`),u(r,"PENTAGO",()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`),u(r,"PENTE",()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`),u(r,"PYLOS",()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`),u(r,"QUARTO",()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`),u(r,"QUIXO",()=>$localize`Align 5 of your pieces on a board where pieces slide!`),u(r,"REVERSI",()=>$localize`Sandwich your opponent's pieces to dominate the board!`),u(r,"SAHARA",()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`),u(r,"SIAM",()=>$localize`Be the first to push a mountain out of the board!`),u(r,"SIX",()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`),u(r,"TABLUT",()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"TEEKO",()=>$localize`Align your 4 pieces or form a square with them to win!`),u(r,"TREXO",()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`),u(r,"YINSH",()=>$localize`Align your pieces to score points, but beware, pieces can flip!`),r})(),ku=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=!0){u(this,"name",void 0),u(this,"urlName",void 0),u(this,"component",void 0),u(this,"tutorial",void 0),u(this,"rules",void 0),u(this,"creationDate",void 0),u(this,"description",void 0),u(this,"display",void 0),this.name=n,this.urlName=i,this.component=s,this.tutorial=o,this.rules=a,this.creationDate=c,this.description=l,this.display=f}}return r=e,u(e,"ALL_GAMES",()=>[new r($localize`Four in a Row`,"P4",ngt,new f3e,y4.get(),new Date("2018-08-28"),xn.P4()),new r($localize`Awal`,"Awale",_ft,new Iae,o4.get(),new Date("2018-11-29"),xn.AWALE()),new r($localize`Quarto`,"Quarto",pmt,new N3e,xr.get(),new Date("2018-12-09"),xn.QUARTO()),new r($localize`Tablut`,"Tablut",D_t,new K3e,Hl.get(),new Date("2018-12-27"),xn.TABLUT()),new r($localize`Reversi`,"Reversi",Nmt,new R3e,D0.get(),new Date("2019-01-16"),xn.REVERSI()),new r($localize`Go`,"Go",UL,new bce,Gc.get(),new Date("2019-12-21"),xn.GO()),new r($localize`Encapsule`,"Encapsule",sdt,new mce,_u.get(),new Date("2019-12-30"),xn.ENCAPSULE()),new r($localize`Siam`,"Siam",aR,new U3e,Us.get(),new Date("2020-01-11"),xn.SIAM()),new r($localize`Sahara`,"Sahara",Bmt,new H3e,H0.get(),new Date("2020-02-29"),xn.SAHARA()),new r($localize`Pylos`,"Pylos",zgt,new S3e,E2.get(),new Date("2020-10-02"),xn.PYLOS()),new r($localize`Kamisado`,"Kamisado",jht,new qce,U2.get(),new Date("2020-10-03"),xn.KAMISADO()),new r($localize`Quixo`,"Quixo",Mmt,new k3e,j2.get(),new Date("2020-10-15"),xn.QUIXO()),new r($localize`Dvonn`,"Dvonn",j9t,new lce,Nr.get(),new Date("2020-10-21"),xn.DVONN()),new r($localize`Epaminondas`,"Epaminondas",gdt,new Cce,Gi.get(),new Date("2021-01-16"),xn.EPAMINONDAS()),new r($localize`Gipf`,"Gipf",Tdt,new Tce,Qt.get(),new Date("2021-02-22"),xn.GIPF()),new r($localize`Coerceo`,"Coerceo",h9t,new sce,fC.get(),new Date("2021-03-21"),xn.COERCEO()),new r($localize`Six`,"Six",P_t,new j3e,t3.get(),new Date("2021-04-08"),xn.SIX()),new r($localize`Lines of Action`,"LinesOfAction",lpt,new t3e,s2.get(),new Date("2021-04-28"),xn.LINES_OF_ACTION()),new r($localize`Pentago`,"Pentago",dgt,new p3e,Zc.get(),new Date("2021-05-23"),xn.PENTAGO()),new r($localize`Abalone`,"Abalone",eft,new Tae,Fo.get(),new Date("2021-07-13"),xn.ABALONE()),new r($localize`Yinsh`,"Yinsh",Mi,new d4e,Xa.get(),new Date("2021-07-31"),xn.YINSH()),new r($localize`Apagos`,"Apagos",cft,new _ae,s4.get(),new Date("2021-11-04"),xn.APAGOS()),new r($localize`Diam`,"Diam",Fc,new tce,Vc.get(),new Date("2021-11-30"),xn.DIAM()),new r($localize`Brandhub`,"Brandhub",Dft,new Gae,bl.get(),new Date("2021-12-07"),xn.BRANDHUB()),new r($localize`Conspirateurs`,"Conspirateurs",T9t,new Kae,Gs.get(),new Date("2021-12-30"),xn.CONSPIRATEURS()),new r($localize`Lodestone`,"Lodestone",Ll,new i3e,_i.get(),new Date("2022-06-24"),xn.LODESTONE()),new r($localize`Martian Chess`,"MartianChess",Es,new l3e,Fa.get(),new Date("2022-07-01"),xn.MARTIAN_CHESS()),new r($localize`Hnefatafl`,"Hnefatafl",xht,new $ce,kl.get(),new Date("2022-09-21"),xn.HNEFATAFL()),new r($localize`Hive`,"Hive",yht,new Hce,y2.get(),new Date("2023-04-02"),xn.HIVE()),new r($localize`Trexo`,"Trexo",$n,new o4e,yi.get(),new Date("2023-04-23"),xn.TREXO()),new r($localize`Lasca`,"Lasca",rpt,new Qce,na.get(),new Date("2023-05-11"),xn.LASCA()),new r($localize`Connect Six`,"ConnectSix",qft,new Wae,$s.get(),new Date("2023-05-13"),xn.CONNECT_SIX()),new r($localize`Pente`,"Pente",ygt,new v3e,Co.get(),new Date("2023-05-20"),xn.PENTE()),new r($localize`Teeko`,"Teeko",G_t,new J3e,oa.get(),new Date("2023-07-30"),xn.TEEKO()),new r($localize`Kalah`,"Kalah",Hht,new Bce,p4.get(),new Date("2023-09-07"),xn.KALAH())].sort((t,n)=>t.name.localeCompare(n.name))),e})(),fR=(()=>{var r;class e{constructor(){u(this,"games",ku.ALL_GAMES()),u(this,"pickGame",new I1)}onChange(n){this.pickGame.emit(n.target.value)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",We({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"select",1),W("change",function(o){return i.onChange(o)}),S(2,"option",2),oe(3,3),P(),T(4,wvt,2,2,"option",4),P()()),2&n&&(_(4),y("ngForOf",i.games))},dependencies:[Wt,nf,rf],encapsulation:2})),e})();function Nvt(r,e){if(1&r){const t=pe();S(0,"div",26)(1,"div",27),W("click",function(){return te(t),ne(p().closeInfo())}),P(),S(2,"div",28)(3,"header",29)(4,"p",30),ct(5),P(),S(6,"button",31),W("click",function(){return te(t),ne(p().closeInfo())}),P()(),S(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),F(11,"img",35),P()(),S(12,"div",7)(13,"div",13),ct(14),P()()(),S(15,"div",6)(16,"div",33)(17,"a",36),W("click",function(){te(t);const i=p();return ne(i.createGame(i.gameInfoDetails.get().urlName))}),F(18,"fa-icon",37),ct(19,"\xa0"),S(20,"span"),oe(21,38),P()()(),S(22,"div",33)(23,"a",36),W("click",function(){te(t);const i=p();return ne(i.createLocalGame(i.gameInfoDetails.get().urlName))}),F(24,"fa-icon",37),ct(25,"\xa0"),S(26,"span"),oe(27,39),P()()(),S(28,"div",33)(29,"a",36),W("click",function(){te(t);const i=p();return ne(i.createTutorial(i.gameInfoDetails.get().urlName))}),F(30,"fa-icon",37),ct(31,"\xa0"),S(32,"span"),oe(33,40),P()()()()()()()}if(2&r){const t=p();_(5),An(t.gameInfoDetails.get().name),_(6),Ce("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",ip),_(3),b2(" ",t.gameInfoDetails.get().description," "),_(4),y("icon",t.iconOnlineGame),_(6),y("icon",t.iconLocalGame),_(6),y("icon",t.iconTutorial)}}function Avt(r,e){if(1&r){const t=pe();S(0,"div",8)(1,"div",9)(2,"p",10),ct(3),P()(),S(4,"div",42)(5,"figure",34)(6,"img",43),W("click",function(){const s=te(t).$implicit;return ne(p(2).openInfo(s))}),P(),S(7,"figcaption",44),W("click",function(){const s=te(t).$implicit;return ne(p(2).openInfo(s))}),S(8,"div",45),ct(9,"?"),P()(),S(10,"figcaption",46)(11,"a",47),W("click",function(){const s=te(t).$implicit;return ne(p(2).createGame(s.urlName))}),F(12,"fa-icon",37),P(),S(13,"a",48),W("click",function(){const s=te(t).$implicit;return ne(p(2).createLocalGame(s.urlName))}),F(14,"fa-icon",37),P(),S(15,"a",49),W("click",function(){const s=te(t).$implicit;return ne(p(2).createTutorial(s.urlName))}),F(16,"fa-icon",37),P()()()(),S(17,"div",50),ct(18),P()()}if(2&r){const t=e.$implicit,n=p(2);_(3),An(t.name),_(3),Dn("id","image_",t.urlName,""),Ce("src","assets/images/",n.theme,"/",t.urlName,".png",ip),_(5),Dn("id","playOnline_",t.urlName,""),_(1),y("icon",n.iconOnlineGame),_(1),Dn("id","playLocally_",t.urlName,""),_(1),y("icon",n.iconLocalGame),_(1),Dn("id","startTutorial_",t.urlName,""),_(1),y("icon",n.iconTutorial),_(2),b2(" ",t.description," ")}}function Ivt(r,e){if(1&r&&(S(0,"div",7),T(1,Avt,19,11,"div",41),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let kvt=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"currentGameService",void 0),u(this,"numberOfColumns",5),u(this,"games",[]),u(this,"theme",void 0),u(this,"iconOnlineGame",zie),u(this,"iconLocalGame",hL),u(this,"iconTutorial",Hoe),u(this,"gameInfoDetails",g.empty()),this.router=n,this.messageDisplayer=i,this.currentGameService=s,this.theme=o.getTheme();const a=ku.ALL_GAMES();let c=0;for(let l=0;l<a.length;l++)l<this.numberOfColumns&&this.games.push([]),this.games[c].push(a[l]),c=(c+1)%this.numberOfColumns}createGame(n){var i=this;return M(function*(){const s=i.currentGameService.canUserCreate();return s.isSuccess()?i.router.navigate(null==n?["/play"]:["/play",n]):(i.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(n){var i=this;return M(function*(){return i.router.navigate(["/local",n])})()}createTutorial(n){return this.router.navigate(["/tutorial",n])}openInfo(n){this.gameInfoDetails=g.of(n)}closeInfo(){this.gameInfoDetails=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Bn),B(Ut),B(hs),B(_v))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R;return t=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,s=$localize`Create an online game`,o=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,f=$localize`Play online`,d=$localize`Play offline`,m=$localize`Learn the rules`,E=$localize`Play online`,w=$localize`Play offline`,R=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],o,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],f,d,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",E,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",R,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(S(0,"section",0)(1,"div",1)(2,"p",2),oe(3,3),P(),S(4,"p",4),Is(5,5),F(6,"br"),ks(),P()(),S(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),oe(12,11),P()(),S(13,"div",12)(14,"div",13)(15,"button",14),W("click",function(){return i.createGame()}),oe(16,15),P(),S(17,"button",16),oe(18,17),P()()()()(),S(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),oe(23,18),P()(),S(24,"div",12)(25,"div",19)(26,"button",20),oe(27,21),P(),S(28,"button",22),oe(29,23),P()()()()()(),T(30,Nvt,34,7,"div",24),S(31,"div",6),T(32,Ivt,2,1,"div",25),P()()),2&n&&(_(30),y("ngIf",i.gameInfoDetails.isPresent()),_(2),y("ngForOf",i.games))},dependencies:[Wt,wt,Ec,O0],encapsulation:2})),e})();const xvt=["board"];let V0=(()=>{class r{static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}}return u(r,"NOT_YOUR_TURN",()=>$localize`It is not your turn!`),u(r,"GAME_HAS_ENDED",()=>$localize`This game has ended.`),u(r,"CANNOT_PLAY_AS_OBSERVER",()=>$localize`You are an observer in this game, you cannot play.`),u(r,"MUST_ANSWER_REQUEST",()=>$localize`You must answer your opponent's request.`),r})(),QC=(()=>{var r;class e{constructor(n,i,s,o){u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"boardRef",null),u(this,"gameComponent",void 0),u(this,"players",[g.empty(),g.empty()]),u(this,"role",Y.NONE),u(this,"endGame",!1),u(this,"Player",k),this.actRoute=n,this.connectedUserService=i,this.router=s,this.messageDisplayer=o}getMatchingComponent(n){return g.ofNullable(ku.ALL_GAMES().find(s=>s.urlName===n)).map(s=>s.component)}afterViewInit(){var n=this;return M(function*(){const i=yield n.createGameComponent();return i&&(n.gameComponent.node=n.gameComponent.rules.getInitialNode(),yield n.gameComponent.updateBoard(!1)),i})()}getGameName(){return U.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var n=this;return M(function*(){const i=n.getGameName(),s=n.getMatchingComponent(i);if(s.isAbsent())return yield n.router.navigate(["/notFound",V0.NO_MATCHING_GAME(i)],{skipLocationChange:!0}),!1;je(null!=n.boardRef,"Board element should be present");const o=U.getNonNullable(n.boardRef).createComponent(s.get());return n.gameComponent=o.instance,n.gameComponent.chooseMove=a=>n.receiveValidMove(a),n.gameComponent.canUserPlay=a=>n.canUserPlay(a),n.gameComponent.isPlayerTurn=()=>n.isPlayerTurn(),n.gameComponent.cancelMoveOnWrapper=a=>n.onCancelMove(a),yield n.setRole(n.role),!0})()}setRole(n){var i=this;return M(function*(){i.role=n,i.gameComponent.setPointOfView(n===Y.NONE?k.ZERO:n),yield i.updateBoardAndShowLastMove(!1)})()}receiveValidMove(n){var i=this;return M(function*(){const s=i.gameComponent.rules.isLegal(n,i.gameComponent.getState());return s.isFailure()?(yield i.gameComponent.cancelMove(s.getReason()),b.ofFallible(s)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(n),b.SUCCESS)})()}canUserPlay(n){var i=this;return M(function*(){if(i.role===Y.NONE){const s=V0.CANNOT_PLAY_AS_OBSERVER();return b.failure(s)}return!1===i.isPlayerTurn()?b.failure(V0.NOT_YOUR_TURN()):i.endGame?b.failure(V0.GAME_HAS_ENDED()):b.SUCCESS})()}isPlayerTurn(){if(this.role===Y.NONE||null==this.gameComponent)return!1;const i=this.gameComponent.getTurn()%2,s=this.getPlayer();return!this.players[i].isPresent()||this.players[i].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(n){var i=this;return M(function*(){if(i.gameComponent.cancelMoveAttempt(),i.gameComponent.hideLastMove(),yield i.gameComponent.updateBoard(n),i.gameComponent.node.previousMove.isPresent()){const s=i.gameComponent.node.previousMove.get();yield i.gameComponent.showLastMove(s)}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ls),B(ur),B(Bn),B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&L4(xvt,5,io),2&n){let s;S3(s=P3())&&(i.boardRef=s.first)}},decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();const Lvt=["board"];let Rvt=(()=>{var r;class e extends QC{constructor(n,i,s,o,a){super(n,i,s,o),u(this,"cdr",void 0),u(this,"demoNodeInfo",void 0),u(this,"boardRef",null),this.cdr=a}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var n=this;return M(function*(){window.setTimeout(M(function*(){yield n.afterViewInit(),n.gameComponent.node=n.demoNodeInfo.node,n.gameComponent.setInteractive(!0),yield n.setRole(n.gameComponent.getCurrentPlayer()),n.cdr.detectChanges(),n.demoNodeInfo.click.isPresent()&&(U.getNonNullable(document.querySelector(n.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),n.cdr.detectChanges())}),1)})()}onLegalUserMove(n,i){return M(function*(){})()}getPlayer(){return"no-player"}onCancelMove(n){return M(function*(){})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ls),B(ur),B(Bn),B(Ut),B(T3))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&L4(Lvt,5,io),2&n){let s;S3(s=P3())&&(i.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[Xe],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&F(0,"div",null,0)},encapsulation:2})),e})();function zvt(r,e){if(1&r&&(S(0,"div",17)(1,"figure",18),F(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function Dvt(r,e){if(1&r&&(S(0,"div",20)(1,"figure",21),F(2,"app-demo-card",19),P()()),2&r){const t=p().$implicit;_(2),y("demoNodeInfo",t)}}function Hvt(r,e){if(1&r&&(S(0,"div",12)(1,"div",13)(2,"p",14),ct(3),P()(),T(4,zvt,3,1,"div",15),T(5,Dvt,3,1,"ng-template",null,16,fn),P()),2&r){const t=e.$implicit,n=ln(6),i=p(2);_(3),An(t.name),_(1),y("ngIf",i.squared.value)("ngIfElse",n)}}function Vvt(r,e){if(1&r&&(S(0,"div",10),T(1,Hvt,7,3,"div",11),P()),2&r){const t=e.$implicit;_(1),y("ngForOf",t)}}let Fvt=(()=>{var r;class e{constructor(){u(this,"numberOfColumns",new oo(5)),u(this,"squared",new oo(!0)),u(this,"columns",[]),this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(n=>{this.fillColumns(n)})}fillColumns(n){const i=ku.ALL_GAMES();let s=0,o=0;this.columns=[];for(const a of i){const c=[],l=a.rules,f=a.tutorial.tutorial;for(const d of f){const m=this.getNodeFromStep(d,l);c.push(m)}for(const d of c)o<n&&this.columns.push([]),this.columns[s].push({name:a.urlName,node:d.node,click:d.click}),o++,s=(s+1)%n}}getNodeFromStep(n,i){if(n.hasSolution()){const s=n.getSolution();if("string"==typeof s)return{node:new Vo(n.state),click:g.of(s)};{const o=s,a=i.isLegal(o,n.state).get(),c=i.applyLegalMove(o,n.state,a),l=g.of(new Vo(n.state));return{node:new Vo(c,l,g.of(o)),click:g.empty()}}}return{node:new Vo(n.state),click:g.empty()}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",We({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,n;return t=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(S(0,"form")(1,"div",0)(2,"label",1),Gt(3),oe(4,2),Bt(),S(5,"output"),ct(6),P()(),S(7,"div",3),F(8,"input",4),P()(),S(9,"div",0)(10,"label",5),F(11,"input",6),ct(12," \xa0"),Gt(13),oe(14,7),Bt(),P()()(),S(15,"div",8),T(16,Vvt,2,1,"div",9),P()),2&n&&(_(6),An(i.numberOfColumns.value),_(2),y("formControl",i.numberOfColumns),_(3),y("formControl",i.squared),_(5),y("ngForOf",i.columns))},dependencies:[Wt,wt,C6,vc,gg,wS,N3,_6,$S,ef,Rvt],encapsulation:2})),e})(),dR=(()=>{var r;class e{constructor(n){u(this,"element",void 0),this.element=n}ngAfterViewInit(){this.element.nativeElement.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(bi))}),u(e,"\u0275dir",Lt({type:r,selectors:[["","autofocus",""]]})),e})(),p4e=(()=>{var r;class e{constructor(n){u(this,"shown",!1),u(this,"input",void 0),this.input=n.nativeElement.parentNode.previousSibling,n.nativeElement.addEventListener("click",i=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(bi))}),u(e,"\u0275dir",Lt({type:r,selectors:[["","toggleVisibility",""]]})),e})();function $vt(r,e){if(1&r&&(S(0,"div",29)(1,"div",30),oe(2,31),P(),S(3,"div",32),ct(4),P()()),2&r){const t=p();_(4),An(t.errorMessage)}}const Gvt=function(){return["/register"]},Bvt=function(){return["/reset-password"]};let Uvt=(()=>{var r;class e{constructor(n,i){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"faEye",Bx),u(this,"errorMessage",void 0),u(this,"loginForm",new $4({email:new oo,password:new oo})),u(this,"userSubscription",void 0),this.router=n,this.connectedUserService=i}ngOnInit(){var n=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var i=M(function*(s){s!==v0.NOT_CONNECTED&&(yield n.redirect())});return function(s){return i.apply(this,arguments)}}())}loginWithEmail(n){var i=this;return M(function*(){const s=yield i.connectedUserService.doEmailLogin(n.email,n.password);s.isFailure()&&(i.errorMessage=s.getReason())})()}loginWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isFailure()&&(n.errorMessage=i.getReason())})()}redirect(){var n=this;return M(function*(){return n.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Bn),B(ur))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E;return t=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,s=$localize`Password`,o=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,f=$localize`Register`,d=$localize`Forgot your password?`,m=$localize`Reset your password`,E=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",o,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],f,d,m,["role","alert",1,"message","is-danger"],[1,"message-header"],E,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),P()()()(),S(12,"div",4)(13,"div",5)(14,"label",12),oe(15,13),P()(),S(16,"div",8)(17,"div",9)(18,"div",14),F(19,"input",15),S(20,"span",16),F(21,"fa-icon",17),P()()()()(),S(22,"div",4),F(23,"div",5),S(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),W("click",function(){return i.loginWithEmail(i.loginForm.value)}),oe(28,19),P()()()()(),S(29,"div",4),F(30,"div",5),S(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),W("click",function(){return i.loginWithGoogle()}),oe(35,21),P()()()()(),T(36,$vt,5,1,"div",22),S(37,"p",23),Gt(38),oe(39,24),Bt(),ct(40,"\xa0 "),S(41,"a",25),oe(42,26),P()(),S(43,"p",23),Gt(44),oe(45,27),Bt(),ct(46,"\xa0 "),S(47,"a",25),oe(48,28),P()()()()),2&n&&(_(3),y("formGroup",i.loginForm),_(18),y("icon",i.faEye),_(6),y("disabled",!i.canLogin()),_(9),y("ngIf",i.errorMessage),_(5),y("routerLink",H1(6,Gvt)),_(6),y("routerLink",H1(7,Bvt)))},dependencies:[wt,Ec,C6,vc,N3,_6,E6,y6,$8,O0,dR,p4e],encapsulation:2})),e})(),Wvt=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}subscribeToActiveParts(n){let i=[];const c=new mv(l=>{i=i.concat(...l),n(i)},l=>{const f=i;for(const d of l)f.forEach(m=>{m.id===d.id&&(m.data=d.data)});i=f,n(i)},l=>{const f=[];for(const d of i)l.every(m=>m.id!==d.id)&&f.push(d);i=f,n(i)});return this.partDAO.observingWhere([["result","==",L1.UNACHIEVED.value]],c)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(cd))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),qvt=(()=>{var r;class e{transform(n){return EG(1e3*n.seconds,"HH:mm:ss","en-US")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Pi({name:"firestoreTime",type:r,pure:!0})),e})();var xu;const Zvt=["chatDiv"];function Yvt(r,e){1&r&&(Gt(0),oe(1,5),Bt())}function Kvt(r,e){1&r&&oe(0,6),2&r&&(Gn(p().unreadMessagesText),Zn(0))}function Xvt(r,e){if(1&r){const t=pe();S(0,"button",11),W("click",function(){return te(t),ne(p(2).scrollToBottom())}),ct(1),P()}if(2&r){const t=p(2);_(1),b2("",t.unreadMessagesText," \u2193")}}function Qvt(r,e){if(1&r&&(S(0,"p"),ct(1),Ca(2,"firestoreTime"),S(3,"b",12),ct(4),P(),S(5,"span",13),ct(6),P()()),2&r){const t=e.$implicit;_(1),b2(" [",gc(2,3,t.postedTime),"] "),_(3),b2("",t.sender.name," : "),_(2),An(t.content)}}function Jvt(r,e){if(1&r){const t=pe();S(0,"div"),T(1,Xvt,2,1,"button",7),S(2,"div",8,9),W("scroll",function(){return te(t),ne(p().updateCurrentScrollPosition())}),T(4,Qvt,7,5,"p",10),P()()}if(2&r){const t=p();_(1),y("ngIf",t.showUnreadMessagesButton),_(3),y("ngForOf",t.chat)}}const eCt=function(){return{standalone:!0}};function tCt(r,e){if(1&r){const t=pe();S(0,"form",14),W("onSubmit",function(){return te(t),ne(p().sendMessage())}),S(1,"div",15)(2,"div",16)(3,"input",17,18),W("ngModelChange",function(i){return te(t),ne(p().userMessage=i)}),P(),S(5,"p",19),ct(6),P()(),S(7,"div",20)(8,"button",21),W("click",function(){return te(t),ne(p().sendMessage())}),F(9,"fa-icon",22),P()()(),S(10,"div",23)(11,"p")(12,"strong"),oe(13,24),P()()()()}if(2&r){const t=ln(4),n=p();_(3),y("ngModel",n.userMessage)("ngModelOptions",H1(4,eCt)),_(3),b2("",t.value.length,"/128"),_(3),y("icon",n.faReply)}}let JC=(xu=class{constructor(e,t){u(this,"chatService",void 0),u(this,"connectedUserService",void 0),u(this,"chatId",void 0),u(this,"turn",void 0),u(this,"userMessage",""),u(this,"connected",!1),u(this,"chat",[]),u(this,"readMessages",0),u(this,"unreadMessagesText",""),u(this,"showUnreadMessagesButton",!1),u(this,"visible",!0),u(this,"faReply",wx),u(this,"isNearBottom",!0),u(this,"notYetScrolled",!0),u(this,"chatSubscription",void 0),u(this,"chatDiv",void 0),this.chatService=e,this.connectedUserService=t}ngOnInit(){je(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},t=new mv(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return M(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}},u(xu,"\u0275fac",function(e){return new(e||xu)(B(Y5),B(ur))}),u(xu,"\u0275cmp",We({type:xu,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&L4(Zvt,5),2&e){let n;S3(n=P3())&&(t.chatDiv=n.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let r,e,t,n;return r=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,t=$localize`Type your message here`,n=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],r,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",t,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],n]},template:function(e,t){if(1&e&&(S(0,"div")(1,"button",0),W("click",function(){return t.switchChatVisibility()}),T(2,Yvt,2,0,"ng-container",1),T(3,Kvt,1,1,"ng-template",null,2,fn),P(),T(5,Jvt,5,2,"div",3),T(6,tCt,14,5,"form",4),P()),2&e){const n=ln(4);_(2),y("ngIf",t.visible)("ngIfElse",n),_(3),y("ngIf",t.visible),_(1),y("ngIf",t.visible)}},dependencies:[Wt,wt,C6,vc,N3,_6,WS,tf,ef,O0,qvt],encapsulation:2})),xu);JC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],JC);let g4e=(()=>{var r;class e{constructor(n,i,s){u(this,"router",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"selectedGame",void 0),this.router=n,this.currentGameService=i,this.messageDisplayer=s}pickGame(n){this.selectedGame=n}navigateToOnlineGameCreation(){var n=this;return M(function*(){const i=n.currentGameService.canUserCreate();i.isSuccess()?yield n.router.navigate(["/play",n.selectedGame]):n.messageDisplayer.criticalMessage(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Bn),B(hs),B(Ut))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.navigateToOnlineGameCreation()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[fR],encapsulation:2})),e})();var Lu;function rCt(r,e){if(1&r&&(Gt(0),ct(1),Bt()),2&r){const t=p().$implicit;_(1),An(t.data.playerOne.name)}}function iCt(r,e){1&r&&(Gt(0),oe(1,27),Bt())}function sCt(r,e){if(1&r){const t=pe();S(0,"tr",22),W("click",function(){const s=te(t).$implicit;return ne(p(2).joinGame(s))}),S(1,"td",23),ct(2),P(),S(3,"td",23),ct(4),P(),S(5,"td",23),T(6,rCt,2,1,"ng-container",24),T(7,iCt,2,0,"ng-template",null,25,fn),P(),S(9,"td",26),ct(10),P()()}if(2&r){const t=e.$implicit,n=e.index,i=ln(8);Dn("id","part_",n,""),_(2),An(t.data.typeGame),_(2),An(t.data.playerZero.name),_(2),y("ngIf",t.data.playerOne)("ngIfElse",i),_(4),An(t.data.turn+1)}}function oCt(r,e){if(1&r&&(S(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),oe(6,17),P(),S(7,"th",16),oe(8,18),P(),S(9,"th",16),oe(10,19),P(),S(11,"th",16),oe(12,20),P()()(),S(13,"tbody"),T(14,sCt,11,6,"tr",21),P()()()()),2&r){const t=p();_(14),y("ngForOf",t.activeParts)}}function aCt(r,e){1&r&&(S(0,"div",28),F(1,"app-online-game-selection",29),P())}function cCt(r,e){1&r&&(S(0,"div",30)(1,"div",31)(2,"div",32),F(3,"app-chat",33),P()()()),2&r&&(_(3),y("turn",-1))}let hR=(Lu=class{constructor(e,t,n,i){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"activePartsService",void 0),u(this,"currentGameService",void 0),u(this,"activeParts",[]),u(this,"activePartsSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"currentTab","games"),u(this,"createTabClasses",[]),this.router=e,this.messageDisplayer=t,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return M(function*(){const n=e.id,i=e.data.typeGame,o=t.currentGameService.canUserJoin(n,null!=e.data.beginning);o.isSuccess()?yield t.router.navigate(["/play",i,n]):t.messageDisplayer.criticalMessage(o.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}},u(Lu,"\u0275fac",function(e){return new(e||Lu)(B(Bn),B(Ut),B(Wvt),B(hs))}),u(Lu,"\u0275cmp",We({type:Lu,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let r,e,t,n,i,s,o,a;return r=$localize`Games`,e=$localize`Create`,t=$localize`Chat`,n=$localize`Game`,i=$localize`First player`,s=$localize`Second player`,o=$localize`Turn`,a=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],r,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],t,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],n,i,s,o,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),W("click",function(){return t.selectTab("games")}),oe(4,3),P()(),S(5,"li",4)(6,"a",5),W("click",function(){return t.selectTab("create")}),oe(7,6),P()(),S(8,"li",7)(9,"a",8),W("click",function(){return t.selectTab("chat")}),oe(10,9),P()()()(),T(11,oCt,15,1,"div",10),T(12,aCt,2,0,"div",11),T(13,cCt,4,1,"div",12)),2&e&&(_(6),y("ngClass",t.createTabClasses),_(5),y("ngIf","games"===t.currentTab),_(1),y("ngIf","create"===t.currentTab),_(1),y("ngIf","chat"===t.currentTab))},dependencies:[Ft,Wt,wt,JC,g4e],encapsulation:2})),Lu);hR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],hR);let lCt=(()=>{var r;class e{constructor(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",We({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P()(),S(3,"div",3)(4,"p",1),ct(5,"Resetting password"),P(),S(6,"div",4)(7,"p",5),oe(8,6),P(),S(9,"button",7),oe(10,8),P()()())},dependencies:[Ec],encapsulation:2})),e})(),m4e=(()=>{var r;class e{constructor(n){u(this,"route",void 0),u(this,"message",void 0),this.route=n,this.message=n.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ls))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1),oe(2,2),P(),S(3,"div",3),ct(4),P()()),2&n&&(_(4),An(i.message))},encapsulation:2})),e})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const dCt=new Error("request for lock canceled");class pCt{constructor(e,t=dCt){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,s=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(s)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class mCt{constructor(e){this._semaphore=new pCt(1,e)}acquire(){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let v4e=(()=>{var r;class e{constructor(){u(this,"requestAwaitingReply",g.empty()),u(this,"lastDeniedRequest",g.empty()),u(this,"forbiddenRequests",new ft)}onGameStart(){this.requestAwaitingReply=g.empty(),this.lastDeniedRequest=g.empty(),this.forbiddenRequests=new ft}onReceivedMove(){this.forbiddenRequests=new ft,this.lastDeniedRequest=g.empty()}onReceivedRequest(n){U.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=g.of(n)}onReceivedReply(n,i){var s=this;return M(function*(){switch(s.requestAwaitingReply=g.empty(),n.reply){case"Accept":return!0;case"Reject":return n.player===i.getOpponent().value&&(s.lastDeniedRequest=g.of(n.requestType),s.forbiddenRequests.add(n.requestType)),!1}})()}canMakeRequest(n){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(n))}getRequestAwaitingReplyFrom(n){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===n.getOpponent().value?g.of(this.requestAwaitingReply.get().requestType):g.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return r=e,u(e,"requestInfos",{TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:Xx},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:Vne},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:y1e}}),u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),vCt=(()=>{var r;class e{constructor(){u(this,"turnClocks",void 0),u(this,"globalClocks",void 0),u(this,"allClocks",void 0),u(this,"configRoom",g.empty()),u(this,"takenGlobalTime",[0,0]),u(this,"extraGlobalTime",[0,0]),u(this,"availableTurnTime",[0,0]),u(this,"lastMoveStartTimestamp",g.empty())}setClocks(n,i){this.turnClocks=n,this.globalClocks=i,this.allClocks=n.concat(i)}onGameStart(n){this.configRoom=g.of(n);for(const i of k.PLAYERS)this.takenGlobalTime[i.value]=0,this.extraGlobalTime[i.value]=0,this.availableTurnTime[i.value]=this.getMoveDurationInMs(),this.globalClocks[i.value].setDuration(this.getPartDurationInMs()),this.turnClocks[i.value].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(n){switch(n.action){case"AddTurnTime":this.addTurnTime(k.of(n.player));break;case"AddGlobalTime":this.addGlobalTime(k.of(n.player));break;case"StartGame":this.lastMoveStartTimestamp=g.of(n.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(n){const i=k.of(n.player),s=n.time,o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.lastMoveStartTimestamp=g.of(s),this.takenGlobalTime[i.value]+=o,this.availableTurnTime[i.value]-=o;const a=i.getOpponent();this.availableTurnTime[a.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[a.value];this.globalClocks[a.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(n){return xae(this.lastMoveStartTimestamp.get(),n)}onGameEnd(){for(const n of this.allClocks)n.isStarted()&&n.stop();this.updateClocks()}beforeEventsBatch(n){!1===n&&this.pauseAllClocks()}afterEventsBatch(n,i,s){if(this.updateClocks(),!1===n){const o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.turnClocks[i.value].subtract(o),this.globalClocks[i.value].subtract(o),this.resumeClocks(i)}}resumeClocks(n){this.turnClocks[n.value].resume(),this.globalClocks[n.value].resume()}addTurnTime(n){this.availableTurnTime[n.getOpponent().value]+=3e4}addGlobalTime(n){this.extraGlobalTime[n.getOpponent().value]+=3e5}updateClocks(){for(const n of k.PLAYERS){this.turnClocks[n.value].changeDuration(this.availableTurnTime[n.value]);const i=this.getPartDurationInMs()+this.extraGlobalTime[n.value]-this.takenGlobalTime[n.value];this.globalClocks[n.value].changeDuration(i)}}pauseAllClocks(){for(const n of this.allClocks)!1===n.isIdle()&&n.pause()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Xd(r){return Kr((e,t)=>{Ks(r).subscribe(Cr(t,()=>t.complete(),Ss)),!t.closed&&e.subscribe(t)})}let CCt=(()=>{var r;class e{transform(n){const i=n%60,s=(n-i)%3600/60,o=(n-60*s-i)/3600,a=[];if(o>1?a.push($localize`${o} hours`):1===o&&a.push($localize`1 hour`),s>1?a.push($localize`${s} minutes`):1===s&&a.push($localize`1 minute`),i>1?a.push($localize`${i} seconds`):1===i&&a.push($localize`1 second`),0===a.length)return $localize`0 seconds`;if(1===a.length)return a[0];{const c=a.slice(0,-1).join(", "),l=a.slice(-1)[0];return $localize`${c} and ${l}`}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",Pi({name:"humanDuration",type:r,pure:!0})),e})();var P4,Qd;function MCt(r,e){if(1&r&&(Gt(0),ct(1),Bt()),2&r){const t=p(3);_(1),An(t.viewInfo.chosenOpponent)}}function ECt(r,e){1&r&&oe(0,44)}function SCt(r,e){if(1&r&&(S(0,"div",45)(1,"div",8)(2,"label",46),Gt(3),oe(4,47),Bt(),S(5,"output"),ct(6),Ca(7,"humanDuration"),P()(),S(8,"div",37),F(9,"input",48),P()(),S(10,"div",8)(11,"label",49),Is(12,50),F(13,"output"),Ca(14,"humanDuration"),ks(),P(),S(15,"div",37),F(16,"input",51),P()()()),2&r){const t=p(3);_(6),An(gc(7,2,t.viewInfo.maximalMoveDuration||0)),_(8),Gn(gc(14,4,t.viewInfo.totalPartDuration||0)),Zn(12)}}function PCt(r,e){1&r&&(S(0,"div"),Is(1,52),F(2,"br"),ks(),P())}function TCt(r,e){1&r&&(S(0,"button",64),oe(1,65),P())}function OCt(r,e){if(1&r){const t=pe();S(0,"tr",60),W("click",function(){const s=te(t).$implicit;return ne(p(4).selectOpponent(s))}),S(1,"td",61),ct(2),P(),S(3,"td",62),T(4,TCt,2,0,"button",63),P()()}if(2&r){const t=e.$implicit,n=p(4);Dn("id","presenceOf_",t,""),y("ngClass",n.viewInfo.candidateClasses[t]),_(1),y("id",n.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),_(1),An(t),_(2),y("ngIf",n.viewInfo.chosenOpponent!==t)}}function bCt(r,e){if(1&r&&(Gt(0),oe(1,53),Bt(),S(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),oe(7,57),P(),S(8,"th",56),oe(9,58),P()()(),S(10,"tbody"),T(11,OCt,5,5,"tr",59),P()()()),2&r){const t=p(3);_(11),y("ngForOf",t.viewInfo.candidates)}}function wCt(r,e){if(1&r){const t=pe();S(0,"button",66),W("click",function(){return te(t),ne(p(3).changeConfig())}),oe(1,67),P()}}function NCt(r,e){if(1&r){const t=pe();S(0,"div")(1,"h1",4),oe(2,5),P(),S(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),oe(7,10),P(),S(8,"div",11)(9,"button",12),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("RANDOM"))}),oe(10,13),P(),S(11,"button",14),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("CREATOR"))}),oe(12,15),P(),S(13,"button",16),W("click",function(){return te(t),ne(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),T(14,MCt,2,1,"ng-container",17),T(15,ECt,1,0,"ng-template",null,18,fn),P()()(),S(17,"div",8)(18,"label",9),oe(19,19),P(),S(20,"div",11)(21,"div",20),W("click",function(){return te(t),ne(p(2).selectPartType("STANDARD"))}),S(22,"div",21)(23,"span"),oe(24,22),P()(),S(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),Gt(29),oe(30,26),Bt(),S(31,"strong"),ct(32),Ca(33,"humanDuration"),P(),F(34,"br"),Gt(35),Is(36,27),F(37,"strong"),Ca(38,"humanDuration"),ks(),Bt(),P()()()()(),S(39,"div",28),W("click",function(){return te(t),ne(p(2).selectPartType("BLITZ"))}),S(40,"div",21)(41,"span"),oe(42,29),P()(),S(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),Gt(47),oe(48,30),Bt(),S(49,"strong"),ct(50),Ca(51,"humanDuration"),P(),F(52,"br"),Gt(53),Is(54,31),F(55,"strong"),Ca(56,"humanDuration"),ks(),Bt(),P()()()()(),S(57,"button",32),W("click",function(){return te(t),ne(p(2).selectPartType("CUSTOM"))}),oe(58,33),P()()(),T(59,SCt,17,6,"div",34),S(60,"div",8)(61,"label",35),oe(62,36),P(),S(63,"div",37),T(64,PCt,3,0,"div",17),T(65,bCt,12,1,"ng-template",null,38,fn),P()()(),S(67,"div",8)(68,"div",11)(69,"button",39),W("click",function(){return te(t),ne(p(2).proposeConfig())}),oe(70,40),P(),T(71,wCt,2,0,"button",41),S(72,"button",42),W("click",function(){return te(t),ne(p(2).cancelGameCreation())}),oe(73,43),P()()()()()}if(2&r){const t=ln(16),n=ln(66),i=p(2);_(3),y("formGroup",i.configFormGroup),_(1),y("disabled",!i.viewInfo.canEditConfig),_(5),y("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),_(2),y("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),_(1),y("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",t),_(7),y("ngClass",i.viewInfo.partTypeClasses.STANDARD),_(11),An(gc(33,19,i.partType.NORMAL_MOVE_DURATION)),_(6),Gn(gc(38,21,i.partType.NORMAL_PART_DURATION)),Zn(36),_(1),y("ngClass",i.viewInfo.partTypeClasses.BLITZ),_(11),An(gc(51,23,i.partType.BLITZ_MOVE_DURATION)),_(6),Gn(gc(56,25,i.partType.BLITZ_PART_DURATION)),Zn(54),_(1),y("ngClass",i.viewInfo.partTypeClasses.CUSTOM),_(2),y("ngIf",i.viewInfo.showCustomTime),_(5),y("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),_(5),y("disabled",!i.viewInfo.canProposeConfig),_(2),y("ngIf",i.viewInfo.canReviewConfig)}}function ACt(r,e){if(1&r&&(S(0,"div",74)(1,"p"),Is(2,75),F(3,"br"),ks(),P()()),2&r){const t=p(3);_(3),Gn(t.viewInfo.creator),Zn(2)}}function ICt(r,e){if(1&r&&(S(0,"span"),oe(1,81),P()),2&r){const t=p(4);_(1),Gn(t.viewInfo.creator),Zn(1)}}function kCt(r,e){1&r&&(S(0,"span"),oe(1,82),P())}function xCt(r,e){1&r&&(S(0,"span"),oe(1,83),P())}function LCt(r,e){if(1&r){const t=pe();S(0,"div",74)(1,"p"),oe(2,76),P(),S(3,"ul")(4,"li"),T(5,ICt,2,1,"span",2),T(6,kCt,2,0,"span",2),T(7,xCt,2,0,"span",2),P(),S(8,"li"),Is(9,77),F(10,"strong"),Ca(11,"humanDuration"),ks(),P(),S(12,"li"),Is(13,78),F(14,"strong"),Ca(15,"humanDuration"),ks(),P()(),S(16,"button",79),W("click",function(){return te(t),ne(p(3).acceptConfig())}),oe(17,80),P()()}if(2&r){const t=p(3);_(2),Gn(t.viewInfo.creator)(t.viewInfo.partTypeName),Zn(2),_(3),y("ngIf","CREATOR"===t.viewInfo.firstPlayer),_(1),y("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),_(1),y("ngIf","RANDOM"===t.viewInfo.firstPlayer),_(4),Gn(gc(11,7,t.viewInfo.maximalMoveDuration||0)),Zn(9),_(4),Gn(gc(15,9,t.viewInfo.totalPartDuration||0)),Zn(13)}}function RCt(r,e){if(1&r&&(S(0,"div")(1,"div",68)(2,"div",69)(3,"p"),oe(4,70),P()(),S(5,"div",71),T(6,ACt,4,1,"div",72),T(7,LCt,18,11,"ng-template",null,73,fn),P()()()),2&r){const t=ln(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function zCt(r,e){if(1&r&&(Gt(0),oe(1,86),Bt()),2&r){const t=p(3);_(1),Gn(t.viewInfo.creator),Zn(1)}}function DCt(r,e){if(1&r&&oe(0,87),2&r){const t=p(3);Gn(t.viewInfo.creator)(t.viewInfo.chosenOpponent),Zn(0)}}function HCt(r,e){if(1&r&&(S(0,"div",68)(1,"div",69)(2,"p"),oe(3,84),P()(),S(4,"div",71)(5,"p"),T(6,zCt,2,1,"ng-container",17),T(7,DCt,1,2,"ng-template",null,85,fn),P()()()),2&r){const t=ln(8),n=p(2);_(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function VCt(r,e){if(1&r&&(S(0,"div",1),T(1,NCt,74,27,"div",2),T(2,RCt,9,2,"div",2),T(3,HCt,9,2,"div",3),P()),2&r){const t=p();_(1),y("ngIf",t.viewInfo.userIsCreator),_(1),y("ngIf",t.viewInfo.userIsChosenOpponent),_(1),y("ngIf",t.viewInfo.userIsObserver)}}let pR=(Qd=P4=class{constructor(e,t,n,i,s,o,a,c,l,f){u(this,"router",void 0),u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"gameService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),u(this,"userService",void 0),u(this,"formBuilder",void 0),u(this,"messageDisplayer",void 0),u(this,"partType",fr),u(this,"partId",void 0),u(this,"gameStartNotification",new I1),u(this,"gameStarted",!1),u(this,"viewInfo",{userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]}),u(this,"currentConfigRoom",null),u(this,"candidates",[]),u(this,"ngUnsubscribe",new Ps),u(this,"allUserInterval",g.empty()),u(this,"ownTokenInterval",g.empty()),u(this,"lastToken",void 0),u(this,"selfSubscription",new Mn),u(this,"configRoomSubscription",new Mn),u(this,"candidatesSubscription",new Mn),u(this,"configFormGroup",void 0),u(this,"allDocDeleted",!1),this.router=e,this.actRoute=t,this.connectedUserService=n,this.currentGameService=i,this.gameService=s,this.configRoomService=o,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=f}ngOnInit(){var e=this;return M(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;je(e.isPresent(),"PartCreationComponent should not be called without connected user"),je(e.get()!==v0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),je(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[D2.RANDOM.value,Z7.required],maximalMoveDuration:[fr.NORMAL_MOVE_DURATION,Z7.required],partType:["STANDARD",Z7.required],totalPartDuration:[fr.NORMAL_PART_DURATION,Z7.required],chosenOpponent:["",Z7.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),n={id:this.partId,opponent:this.getOpponent(),typeGame:U.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:t};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let e=null;return e=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:U.getNonNullable(this.currentConfigRoom?.creator),e}subscribeToConfigRoomDoc(){var e=this;const t=function(){var i=M(function*(s){yield e.onCurrentConfigRoomUpdate(s)});return function(o){return i.apply(this,arguments)}}(),n=function(){var i=M(function*(s){yield e.onCandidatesUpdate(s)});return function(o){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return U.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=U.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==fi.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(Xd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=U.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===fi.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==fi.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==fi.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(fr.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(fr.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(fr.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(fr.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return M(function*(){const n=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:n}),t.configRoomService.setChosenOpponent(t.partId,n)])})()}getUserFromName(e){const t=this.candidates.find(n=>n.name===e);return U.getNonNullable(t)}changeConfig(){var e=this;return M(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return M(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,s=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,a=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,a,fr.of(n),i,D2.of(s),o)})()}cancelGameCreation(){var e=this;return M(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),Ne.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),Ne.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),Ne.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),Ne.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return M(function*(){if(e.isAbsent())return Ne.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const n=e.get();if(t.chosenOpponentJustLeft(n)&&t.userIsCreator(n)){const s=U.getNonNullable(t.currentConfigRoom),o=U.getNonNullable(s.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}let i=!1;t.userJustChosenAsOpponent(n)&&(yield t.updateUserDocWithCurrentGame(n),i=!0),t.currentConfigRoom=n,t.allUserInterval.isAbsent()&&(je(!1===i,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield t.updateUserDocWithCurrentGame(t.currentConfigRoom),yield t.observeNeededPlayers()),t.updateViewInfo(),t.isGameStarted(t.currentConfigRoom)&&(Ne.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return M(function*(){t.candidates=e,t.updateViewInfo()})()}userJustChosenAsOpponent(e){if(this.isGameStarted(e))return!1;const t=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==t&&e.chosenOpponent?.id===t}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var e=this;return M(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return je(null!=e,"configRoom should not be null (isGameStarted)"),U.getNonNullable(e).partStatus===fi.PART_STARTED.value}onGameStarted(){const e=U.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(){var e=this;return M(function*(){const t=U.getNonNullable(e.currentConfigRoom);je(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=g.of(window.setInterval(M(function*(){const n=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(n):yield e.checkCreatorTokenFreshness(n)}),Qd.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return M(function*(){const n=U.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return M(function*(){je(!1===e.isGameStarted(e.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),je(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return M(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return M(function*(){const i=yield n.userService.getUserLastUpdateTime(e);return i.isAbsent()?(h2.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):xae(i.get(),t)>Qd.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return M(function*(){const n=U.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return M(function*(){yield e.connectedUserService.sendPresenceToken(),je(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=g.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},Qd.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,n=>{je(n.isPresent(),"connected user should exist"),e.lastToken=U.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=g.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,U.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return M(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?Ne.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?Ne.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(Ne.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(Ne.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}},u(P4,"TOKEN_INTERVAL",5e3),u(P4,"TOKEN_TIMEOUT",1e4),u(P4,"\u0275fac",function(e){return new(e||P4)(B(Bn),B(Ls),B(ur),B(hs),B(Q5),B(ld),B(Y5),B(K5),B(tme),B(Ut))}),u(P4,"\u0275cmp",We({type:P4,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,E,w,R,z,$,G,de,ve,xe,tt,pt,Cn,Mt,Y2,$0,Ul,s3,nh,rh,ut,Tt,kt,Nn;return r=$localize`Game creation`,e=$localize`First player`,t=$localize`Random`,n=$localize`You`,i=$localize`Game type`,s=$localize`Standard`,o=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,c=$localize`Blitz`,l=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,d=$localize`Custom`,m=$localize`Opponents`,E=$localize`Propose configuration`,w=$localize`Cancel game`,R=$localize`The opponent`,z=$localize`Maximal turn duration: `,$=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,G=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,de=$localize`Click on the opponent against which you would like to play.`,ve=$localize`Name`,xe=$localize`Actions`,tt=$localize`Pick`,pt=$localize`Change configuration`,Cn=$localize`Configuration proposal`,Mt=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,Y2=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,$0=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Ul=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,s3=$localize`Accept and start`,nh=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,rh=$localize`you play first`,ut=$localize`the first player is selected randomly`,Tt=$localize`One moment...`,kt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,Nn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],r,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],t,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],n,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],c,l,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],d,["id","customTime",4,"ngIf"],[1,"label"],m,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],E,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],w,R,["id","customTime"],["for","maximalMoveDuration",1,"label"],z,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],G,de,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],ve,xe,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],tt,["id","reviewConfig",1,"button",3,"click"],pt,[1,"message","is-primary"],[1,"message-header"],Cn,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],Mt,Y2,$0,Ul,["id","acceptConfig",1,"button","is-primary",3,"click"],s3,nh,rh,ut,Tt,["proposalSent",""],kt,Nn]},template:function(e,t){1&e&&T(0,VCt,4,3,"div",0),2&e&&y("ngIf",t.viewInfo)},dependencies:[Ft,Wt,wt,C6,vc,gg,N3,_6,y6,$8,CCt],encapsulation:2})),P4);var Qa,F0;function $Ct(r,e){if(1&r){const t=pe();S(0,"button",3),W("click",function(){return te(t),ne(p().addTime())}),oe(1,4),P()}if(2&r){const t=p();_(1),Gn(t.timeToAdd),Zn(1)}}pR=Qd=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],pR);let gR=(F0=Qa=class{constructor(){u(this,"debugName",void 0),u(this,"timeToAdd",void 0),u(this,"dangerTimeLimit",void 0),u(this,"active",void 0),u(this,"canAddTime",void 0),u(this,"remainingMs",void 0),u(this,"displayedSec",void 0),u(this,"displayedMinute",void 0),u(this,"timeoutHandleGlobal",null),u(this,"timeoutHandleSec",null),u(this,"isPaused",!0),u(this,"isSet",!1),u(this,"started",!1),u(this,"startTime",void 0),u(this,"outOfTimeAction",new I1),u(this,"addTimeToOpponent",new I1),u(this,"cssClasses",F0.SAFE_TIME)}setDuration(e){U.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){U.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){U.assert(this.isSet,"Should not start a chrono that has not been set!"),U.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){U.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){U.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),U.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){U.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?F0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?F0.DANGER_TIME_ODD:F0.DANGER_TIME_EVEN:F0.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}},u(Qa,"DANGER_TIME_EVEN","has-background-danger has-text-white"),u(Qa,"DANGER_TIME_ODD","has-background-warning has-text-white"),u(Qa,"PASSIVE_STYLE","has-text-passive is-italic"),u(Qa,"SAFE_TIME",""),u(Qa,"\u0275fac",function(e){return new(e||Qa)}),u(Qa,"\u0275cmp",We({type:Qa,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let r;return r=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],r]},template:function(e,t){1&e&&(S(0,"div",0)(1,"p",1),ct(2),Ca(3,"number"),P(),T(4,$Ct,2,1,"button",2),P()),2&e&&(y("ngClass",t.getTimeClass()),_(2),uE("",t.displayedMinute,":",QF(3,4,t.displayedSec,"2.0-0"),""),_(2),y("ngIf",t.canAddTime))},dependencies:[Ft,wt,zG],encapsulation:2})),Qa);var Ru;gR=F0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],gR);const BCt=["chronoZeroGlobal"],UCt=["chronoOneGlobal"],WCt=["chronoZeroTurn"],qCt=["chronoOneTurn"];function jCt(r,e){if(1&r){const t=pe();S(0,"app-part-creation",5,6),W("gameStartNotification",function(i){return te(t),ne(p().startGame(i))}),P()}2&r&&y("partId",p().currentPartId)}function ZCt(r,e){1&r&&(Gt(0),S(1,"span",39),oe(2,40),P(),Bt())}function YCt(r,e){if(1&r&&(S(0,"span",41),oe(1,42),P()),2&r){const t=p(4);_(1),Gn(null==t.currentPlayer?null:t.currentPlayer.name),Zn(1)}}function KCt(r,e){if(1&r&&(S(0,"p",36),T(1,ZCt,3,0,"ng-container",37),T(2,YCt,2,1,"ng-template",null,38,fn),P()),2&r){const t=ln(3),n=p(3);_(1),y("ngIf",(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name)("ngIfElse",t)}}function XCt(r,e){if(1&r&&(S(0,"div",32)(1,"p",33),oe(2,34),P(),T(3,KCt,4,2,"p",35),P()),2&r){const t=p(2);_(2),Gn(t.currentPart.getTurn()+1),Zn(2),_(1),y("ngIf",!1===t.endGame)}}function QCt(r,e){if(1&r&&(S(0,"p",43),ct(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ZERO)),_(1),An(t.players[0].get().name)}}function JCt(r,e){if(1&r&&(S(0,"p",44),oe(1,45),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[0]),Zn(1)}}function eyt(r,e){if(1&r&&(S(0,"p",46),ct(1),P()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ONE)),_(1),An(t.players[1].get().name)}}function tyt(r,e){if(1&r&&(S(0,"p",47),oe(1,48),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[1]),Zn(1)}}function nyt(r,e){1&r&&(S(0,"div")(1,"p",50),oe(2,51),P()())}function ryt(r,e){1&r&&(S(0,"p",55),oe(1,56),P())}function iyt(r,e){1&r&&(S(0,"p",57),oe(1,58),P())}function syt(r,e){1&r&&(S(0,"p",59),oe(1,60),P())}function oyt(r,e){if(1&r&&(S(0,"div"),T(1,ryt,2,0,"p",52),T(2,iyt,2,0,"p",53),T(3,syt,2,0,"p",54),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function ayt(r,e){1&r&&(S(0,"p",64),oe(1,65),P())}function cyt(r,e){1&r&&(S(0,"p",66),oe(1,67),P())}function lyt(r,e){if(1&r&&(S(0,"p",68),oe(1,69),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getWinner().get().name),Zn(1)}}function uyt(r,e){if(1&r&&(S(0,"div"),T(1,ayt,2,0,"p",61),T(2,cyt,2,0,"p",62),T(3,lyt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function fyt(r,e){if(1&r&&(S(0,"p",64),oe(1,70),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getLoser().get().name),Zn(1)}}function dyt(r,e){1&r&&(S(0,"p",68),oe(1,71),P())}function hyt(r,e){if(1&r&&(S(0,"p",68),oe(1,72),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getLoser().get().name),Zn(1)}}function pyt(r,e){if(1&r&&(S(0,"div"),T(1,fyt,2,1,"p",61),T(2,dyt,2,0,"p",63),T(3,hyt,2,1,"p",63),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying())}}function gyt(r,e){1&r&&(S(0,"p",74),oe(1,75),P())}function myt(r,e){if(1&r&&(S(0,"p",74),oe(1,76),P()),2&r){const t=p(4);_(1),Gn(t.currentPart.getLoser().get().name),Zn(1)}}function _yt(r,e){if(1&r&&(S(0,"div"),T(1,gyt,2,0,"p",73),T(2,myt,2,1,"p",73),P()),2&r){const t=p(3);_(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),_(1),y("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function vyt(r,e){if(1&r&&(S(0,"div",49),F(1,"hr"),T(2,nyt,3,0,"div",27),T(3,oyt,4,3,"div",27),T(4,uyt,4,3,"div",27),T(5,pyt,4,3,"div",27),T(6,_yt,3,2,"div",27),P()),2&r){const t=p(2);_(2),y("ngIf",t.currentPart.isHardDraw()),_(1),y("ngIf",t.currentPart.isAgreedDraw()),_(1),y("ngIf",t.currentPart.isWin()),_(1),y("ngIf",t.currentPart.isTimeout()),_(1),y("ngIf",t.currentPart.isResign())}}function Cyt(r,e){if(1&r){const t=pe();Gt(0),S(1,"button",85),W("click",function(){const s=te(t).$implicit;return ne(p(4).propose(s))}),ct(2),F(3,"fa-icon",86),P(),Bt()}if(2&r){const t=e.$implicit,n=p(4);_(1),Dn("id","propose",t,""),y("disabled",!1===n.requestAvailable(t)),_(1),b2("",n.requestInfos[t].textForRequest(),"\xa0\xa0"),_(1),y("icon",n.requestInfos[t].icon)}}function yyt(r,e){if(1&r){const t=pe();Gt(0),S(1,"button",80),W("click",function(){return te(t),ne(p(3).resign())}),oe(2,81),P(),S(3,"button",82),W("click",function(){return te(t),ne(p(3).gameComponent.pass())}),oe(4,83),P(),T(5,Cyt,4,4,"ng-container",84),Bt()}if(2&r){const t=p(3);_(1),y("disabled",!1===t.canResign()),_(2),y("disabled",!1===t.canPass()),_(2),y("ngForOf",t.allRequests)}}function Myt(r,e){if(1&r){const t=pe();S(0,"div",87)(1,"p"),ct(2),F(3,"fa-icon",86),P(),S(4,"button",88),W("click",function(){return te(t),ne(p(3).accept())}),oe(5,89),P(),S(6,"button",90),W("click",function(){return te(t),ne(p(3).reject())}),oe(7,91),P()()}if(2&r){const t=p(3);_(2),b2(" ",t.requestInfos[t.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),_(1),y("icon",t.requestInfos[t.requestAwaitingReplyFromUs().get()].icon)}}function Eyt(r,e){if(1&r&&(S(0,"div",92)(1,"p")(2,"span"),Is(3,93),F(4,"fa-icon",86),ks(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.deniedRequest().get()].icon),Gn(t.requestInfos[t.deniedRequest().get()].name()),Zn(3)}}function Syt(r,e){if(1&r&&(S(0,"div",94)(1,"p")(2,"span"),Is(3,95),F(4,"fa-icon",86),ks(),P()()()),2&r){const t=p(3);_(4),y("icon",t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].icon),Gn(t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].name()),Zn(3)}}function Pyt(r,e){if(1&r&&(Gt(0),T(1,yyt,6,3,"ng-container",37),T(2,Myt,8,2,"ng-template",null,77,fn),T(4,Eyt,5,2,"div",78),T(5,Syt,5,2,"div",79),Bt()),2&r){const t=ln(3),n=p(2);_(1),y("ngIf",!1===n.mustReply())("ngIfElse",t),_(3),y("ngIf",n.deniedRequest().isPresent()),_(1),y("ngIf",n.requestAwaitingReplyFromOpponent().isPresent())}}function Tyt(r,e){1&r&&(S(0,"button",96),oe(1,97),P())}function Oyt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"div",9),T(3,XCt,4,2,"div",10),S(4,"div",11),T(5,QCt,2,2,"p",12),T(6,JCt,2,1,"p",13),S(7,"app-count-down",14,15),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),S(9,"app-count-down",16,17),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),S(11,"p",18),oe(12,19),P(),S(13,"div",11),T(14,eyt,2,2,"p",20),T(15,tyt,2,1,"p",21),S(16,"app-count-down",22,23),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),P(),S(18,"app-count-down",24,25),W("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),P()(),F(20,"hr"),T(21,vyt,7,5,"div",26),T(22,Pyt,6,4,"ng-container",27),T(23,Tyt,2,0,"button",28),P()(),S(24,"div",29)(25,"div",30),F(26,"div",null,31),P()()()}if(2&r){const t=p();_(3),y("ngIf",null!==t.currentPart),_(2),y("ngIf",t.players[0].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(5),y("ngIf",t.players[1].isPresent()),_(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),_(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),_(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),_(3),y("ngIf",t.endGame&&null!==t.currentPart),_(1),y("ngIf",t.isPlaying()),_(1),y("ngIf",t.endGame),_(1),y("ngClass",t.getBoardHighlight())}}let byt=(()=>{class r{}return u(r,"NO_MATCHING_PART",()=>$localize`The game you tried to join does not exist.`),r})(),mR=(Ru=class extends QC{constructor(e,t,n,i,s,o,a,c,l,f){super(e,t,n,i),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"gameService",void 0),u(this,"gameEventService",void 0),u(this,"timeManager",void 0),u(this,"requestManager",void 0),u(this,"chronoZeroGlobal",void 0),u(this,"chronoOneGlobal",void 0),u(this,"chronoZeroTurn",void 0),u(this,"chronoOneTurn",void 0),u(this,"currentPart",null),u(this,"currentPartId",void 0),u(this,"gameStarted",!1),u(this,"opponent",null),u(this,"authUser",void 0),u(this,"currentPlayer",null),u(this,"configRoom",void 0),u(this,"currentGame",g.empty()),u(this,"userLinkedToThisPart",!0),u(this,"routerEventsSubscription",void 0),u(this,"userSubscription",void 0),u(this,"opponentSubscription",new Mn),u(this,"partSubscription",new Mn),u(this,"gameEventsSubscription",new Mn),u(this,"currentGameSubscription",new Mn),u(this,"OFFLINE_FONT_COLOR",{color:"lightgrey"}),u(this,"globalTimeMessage",$localize`5 minutes`),u(this,"turnTimeMessage",$localize`30 seconds`),u(this,"requestInfos",v4e.requestInfos),u(this,"allRequests",["TakeBack","Draw","Rematch"]),this.currentGameService=s,this.userService=o,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=f}extractPartIdFromURL(){return U.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return U.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return M(function*(){const t=e.extractGameNameFromURL();if(ku.ALL_GAMES().some(i=>i.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const s=byt.NO_MATCHING_PART();yield e.router.navigate(["/notFound",s],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=V0.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return M(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=M(function*(n){n instanceof W4&&(yield e.setCurrentPartIdOrRedirect())});return function(n){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=M(function*(n){yield e.onCurrentGameUpdate(n)});return function(n){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return M(function*(){if(e.isPresent()){const n=e.get();"Observer"===n.role||n.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=g.empty()})()}startGame(e){var t=this;return M(function*(){U.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(M(function*(){const n=yield t.afterViewInit();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),U.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),yield t.startPart()}),2)})()}startPart(){var e=this;return M(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new hv(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var n=M(function*(i){U.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new hv(e.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return M(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();U.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new mCt,n=function(){var i=M(function*(s){yield t.runExclusive(M(function*(){const o=s.filter(c=>"Move"===c.eventType).length;let a=0;e.beforeEventsBatch();for(const c of s)switch(c.eventType){case"Move":const l=a+1===o;yield e.onReceivedMove(c,l),a+=1;break;case"Request":e.requestManager.onReceivedRequest(c);break;case"Reply":(yield e.requestManager.onReceivedReply(c,e.role))&&(yield e.handleReply(c));break;default:U.expectToBe(c.eventType,"Action","Event should be an action"),e.timeManager.onReceivedAction(c),"EndGame"===c.action?yield e.onGameEnd():"StartGame"===c.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(o){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(e){var t=this;return M(function*(){switch(e.requestType){case"TakeBack":const n=k.of(e.player);yield t.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const i=t.extractGameNameFromURL();yield t.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return M(function*(){yield e.currentGameService.removeCurrentGame(),e.gameComponent.setInteractive(!1),e.endGame=!0})()}onReceivedMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules,s=n.gameComponent.getTurn(),o=n.gameComponent.encoder.decode(e.move),a=i.isLegal(o,n.gameComponent.getState()),c="We received an incorrect db move: "+o.toString()+" at turn "+s+'because "'+a.getReasonOr("")+'"';U.assert(a.isSuccess(),c);const l=i.choose(n.gameComponent.node,o);if(U.assert(l.isSuccess(),"Chosen move should be legal after all checks, but it is not! Reason: "+l.getReasonOr("")),n.gameComponent.node=l.get(),n.role===Y.NONE)yield n.updateBoardAndShowLastMove(t);else{const f=s%2!==n.role.value;yield n.updateBoardAndShowLastMove(f&&t)}n.setCurrentPlayerAccordingToCurrentTurn(),n.timeManager.onReceivedMove(e),n.requestManager.onReceivedMove()})()}setCurrentPlayerAccordingToCurrentTurn(){this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.setInteractive(this.currentPlayer.name===this.getPlayer().name)}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return M(function*(){const t=k.ofTurn(e.gameComponent.getTurn()),n=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,n)})()}takeBackToPreviousPlayerTurn(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.node.parent.get(),t.gameComponent.getCurrentPlayer()!==e&&(U.assert(t.gameComponent.getTurn()>0,"Should not allow player that never played to take back"),t.gameComponent.node=t.gameComponent.node.parent.get()),t.setCurrentPlayerAccordingToCurrentTurn();const n=0===t.gameComponent.getTurn();yield t.updateBoardAndShowLastMove(n)})()}canResign(){return U.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return U.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return U.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return U.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return U.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return U.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),U.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||U.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return U.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var t=this;return M(function*(){t.players=[g.of(e.data.playerZero),g.ofNullable(e.data.playerOne)],U.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.setCurrentPlayerAccordingToCurrentTurn();const n=yield t.setRealObserverRole();if(n.isPresent()){const i=s=>{U.assert(s.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=n.get()};t.opponentSubscription=t.userService.observeUserOnServer(n.get().id,i)}})()}setRealObserverRole(){var e=this;return M(function*(){let t=g.empty();return e.players[0].equalsValue(e.getPlayer())?(yield e.setRole(k.ZERO),t=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(yield e.setRole(k.ONE),t=e.players[0]):yield e.setRole(Y.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===Y.NONE?"Observer":"Player"}),t})()}onLegalUserMove(e){var t=this;return M(function*(){if(!t.mustReply()){const n=t.gameComponent.rules.isLegal(e,t.gameComponent.node.gameState);U.assert(n.isSuccess(),"onLegalUserMove called with an illegal move");const i=t.gameComponent.rules.applyLegalMove(e,t.gameComponent.node.gameState,n.get()),s=new Vo(i,g.of(t.gameComponent.node),g.of(e)),o=t.gameComponent.rules.getGameStatus(s),a=t.gameComponent.encoder.encode(e);return yield t.gameService.addMove(t.currentPartId,t.role,a),t.updatePartWithStatusAndScores(o,t.gameComponent.scores)}t.gameComponent.message(V0.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,t){var n=this;return M(function*(){return e.isEndGame?e===_e.DRAW?yield n.gameService.drawPart(n.currentPartId,n.role,t):(U.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(e.winner,t)):n.gameService.updatePart(n.currentPartId,t)})()}notifyTimeoutVictory(e,t){var n=this;return M(function*(){const i=n.role;yield n.gameService.notifyTimeout(n.currentPartId,i,e,t)})()}notifyVictory(e,t){var n=this;return M(function*(){const i=U.getNonNullable(n.currentPart),s=n.players[0].get(),o=n.players[1].get();n.currentPart=e===k.ONE?i.setWinnerAndLoser(o,s):i.setWinnerAndLoser(s,o);const a=n.role;yield n.gameService.endPartWithVictory(n.currentPartId,a,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),t)})()}resign(){var e=this;return M(function*(){const t=e.role,n=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,t,i,n)})()}reachedOutOfTime(e){var t=this;return M(function*(){if(!1===t.isPlaying())return;const n=U.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(n,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),n)})()}propose(e){var t=this;return M(function*(){U.assert(t.role.isPlayer(),"cannot propose request if not player");const n=t.role;switch(e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId,n);case"Draw":return t.gameService.proposeDraw(t.currentPartId,n);default:return U.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId,n)}})()}accept(){var e=this;return M(function*(){U.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,n=U.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(n,t);case"Draw":return e.gameService.acceptDraw(n.id,t);default:return U.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(n.id,n.data.turn,t)}})()}reject(){var e=this;return M(function*(){U.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.role,n=e.requestManager.getCurrentRequest().get().requestType;switch(n){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,t);case"Draw":return e.gameService.refuseDraw(e.currentPartId,t);default:return U.expectToBe(n,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,t)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===k.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}ngOnDestroy(){var e=this;return M(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}},u(Ru,"\u0275fac",function(e){return new(e||Ru)(B(Ls),B(ur),B(Bn),B(Ut),B(hs),B(K5),B(Q5),B(jk),B(vCt),B(v4e))}),u(Ru,"\u0275cmp",We({type:Ru,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(L4(BCt,5),L4(UCt,5),L4(WCt,5),L4(qCt,5)),2&e){let n;S3(n=P3())&&(t.chronoZeroGlobal=n.first),S3(n=P3())&&(t.chronoOneGlobal=n.first),S3(n=P3())&&(t.chronoZeroTurn=n.first),S3(n=P3())&&(t.chronoOneTurn=n.first)}},features:[Xe],decls:5,vars:4,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,E,w,R,z,$,G,de,ve,xe,tt,pt,Cn;return r=$localize`vs.`,e=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`It is your turn.`,n=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Draw`,a=$localize`You agreed to draw.`,c=$localize`Your draw proposal has been accepted.`,l=$localize`Players agreed to draw.`,f=$localize`You won.`,d=$localize`You lost.`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,E=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,w=$localize`You reached your time limit.`,R=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,z=$localize`You resigned.`,$=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,G=$localize`Resign`,de=$localize`Pass a turn`,ve=$localize`Accept`,xe=$localize`Reject`,tt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,pt=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,Cn=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],r,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],t,["id","opponentTurn"],n,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],o,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],a,["id","yourOpponentAgreedToDrawIndicator",1,"title"],c,["id","playersAgreedToDraw",1,"title"],l,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],d,[1,"title"],m,E,w,R,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],z,$,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],G,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],de,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],ve,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],xe,["id","requestRejected",1,"notification","is-danger"],tt,["id","requestAwaitingReply",1,"notification"],pt,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],Cn]},template:function(e,t){1&e&&(T(0,jCt,2,1,"app-part-creation",0),T(1,Oyt,28,25,"div",1),S(2,"div",2)(3,"div",3),F(4,"app-chat",4),P()()),2&e&&(y("ngIf",!1===t.gameStarted),_(1),y("ngIf",t.gameStarted),_(3),y("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},dependencies:[Ft,Wt,wt,Ec,O0,JC,pR,gR],encapsulation:2})),Ru);var $l,_R;function Nyt(r,e){if(1&r&&(S(0,"option",26),ct(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),An(t.name)}}function Ayt(r,e){if(1&r&&(S(0,"option",26),oe(1,30),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),Gn(t.name),Zn(1)}}function Iyt(r,e){if(1&r){const t=pe();S(0,"select",27),W("ngModelChange",function(i){return te(t),ne(p(2).aiOptions[0]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ZERO))}),S(1,"option",28),oe(2,29),P(),T(3,Ayt,2,2,"option",17),P()}if(2&r){const t=p(2);y("ngModel",t.aiOptions[0]),_(3),y("ngForOf",t.availableAIOptions(0))}}function kyt(r,e){if(1&r&&(S(0,"p",31),oe(1,32),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[0]),Zn(1)}}function xyt(r,e){if(1&r&&(S(0,"option",26),ct(1),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),An(t.name)}}function Lyt(r,e){if(1&r&&(S(0,"option",26),oe(1,35),P()),2&r){const t=e.$implicit;y("value",t.name),_(1),Gn(t.name),Zn(1)}}function Ryt(r,e){if(1&r){const t=pe();S(0,"select",33),W("ngModelChange",function(i){return te(t),ne(p(2).aiOptions[1]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ONE))}),S(1,"option",28),oe(2,34),P(),T(3,Lyt,2,2,"option",17),P()}if(2&r){const t=p(2);y("ngModel",t.aiOptions[1]),_(3),y("ngForOf",t.availableAIOptions(1))}}function zyt(r,e){if(1&r&&(S(0,"p",36),oe(1,37),P()),2&r){const t=p(2);_(1),Gn(t.gameComponent.scores.get()[1]),Zn(1)}}function Dyt(r,e){if(1&r&&(S(0,"h4",41),ct(1),P()),2&r){const t=p(3);_(1),An(t.winnerMessage.get())}}function Hyt(r,e){1&r&&(S(0,"h4",42),oe(1,43),P())}function Vyt(r,e){if(1&r&&(S(0,"div",38),T(1,Dyt,2,1,"h4",39),T(2,Hyt,2,0,"h4",40),P()),2&r){const t=p(2);_(1),y("ngIf",t.winnerMessage.isPresent()),_(1),y("ngIf",t.winnerMessage.isAbsent())}}function Fyt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"div",8)(2,"p",9),oe(3,10),P()(),S(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),W("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ZERO))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[0]=i)}),S(8,"option",15),oe(9,16),P(),T(10,Nyt,2,2,"option",17),P()(),S(11,"div",13),T(12,Iyt,4,2,"select",18),P(),T(13,kyt,2,1,"p",19),P(),S(14,"div",20)(15,"div",13)(16,"select",21),W("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ONE))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[1]=i)}),S(17,"option",15),oe(18,22),P(),T(19,xyt,2,2,"option",17),P()(),S(20,"div",13),T(21,Ryt,4,2,"select",23),P(),T(22,zyt,2,1,"p",24),P()(),T(23,Vyt,3,2,"div",25),P()}if(2&r){const t=p();_(3),Gn(t.gameComponent.getTurn()+1),Zn(3),_(4),y("ngModel",t.playerSelection[0]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[0].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(3),y("ngModel",t.playerSelection[1]),_(3),y("ngForOf",t.gameComponent.availableAIs),_(2),y("ngIf",!1===t.players[1].equalsValue("human")),_(1),y("ngIf",t.gameComponent.scores.isPresent()),_(1),y("ngIf",t.endGame)}}function $yt(r,e){if(1&r){const t=pe();S(0,"button",50),W("click",function(){return te(t),ne(p(2).gameComponent.pass())}),oe(1,51),P()}}function Gyt(r,e){if(1&r){const t=pe();S(0,"button",52),W("click",function(){return te(t),ne(p(2).takeBack())}),oe(1,53),P()}}function Byt(r,e){if(1&r&&(Gt(0),ct(1),F(2,"br"),Bt()),2&r){const t=e.$implicit,n=p(3);_(1),b2(" ",t.name+": "+t.getInfo(n.gameComponent.node)," ")}}function Uyt(r,e){if(1&r&&(S(0,"div",54),T(1,Byt,3,1,"ng-container",55),ct(2),F(3,"br"),ct(4),F(5,"br"),P()),2&r){const t=p(2);_(1),y("ngForOf",t.gameComponent.availableAIs),_(1),b2(" Created ",t.getCreatedNodes()," nodes."),_(2),b2(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function Wyt(r,e){if(1&r){const t=pe();S(0,"div",44),T(1,$yt,2,0,"button",45),T(2,Gyt,2,0,"button",46),S(3,"button",47),W("click",function(){return te(t),ne(p().restartGame())}),oe(4,48),P(),T(5,Uyt,6,3,"div",49),P()}if(2&r){const t=p();_(1),y("ngIf",!1===t.endGame&&t.gameComponent.canPass),_(1),y("ngIf",t.canTakeBack()),_(3),y("ngIf",t.gameComponent.node.previousMove.isPresent()&&t.displayAIInfo())}}mR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],mR);let vR=(_R=$l=class extends QC{constructor(e,t,n,i,s){super(e,t,n,i),u(this,"cdr",void 0),u(this,"aiOptions",["none","none"]),u(this,"playerSelection",["human","human"]),u(this,"winnerMessage",g.empty()),u(this,"displayAIMetrics",!1),this.cdr=s,this.players=[g.of(this.playerSelection[0]),g.of(this.playerSelection[1])],this.role=k.ZERO}getCreatedNodes(){return vae.createdNodes}getMinimaxTime(){return q7t.aiTime}ngAfterViewInit(){var e=this;window.setTimeout(M(function*(){(yield e.afterViewInit())&&(yield e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){var t=this;return M(function*(){t.players[e.value]=g.of(t.playerSelection[e.value]),"human"===t.playerSelection[1]&&"human"!==t.playerSelection[0]?(t.gameComponent.setInteractive(!1),yield t.setRole(k.ONE)):(t.gameComponent.setInteractive(!0),yield t.setRole(k.ZERO)),yield t.proposeAIToPlay()})()}onLegalUserMove(e){var t=this;return M(function*(){t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e).get(),yield t.proposeAIToPlay()})()}updateBoard(e){var t=this;return M(function*(){yield t.updateBoardAndShowLastMove(e);const n=t.gameComponent.rules.getGameStatus(t.gameComponent.node);if(!0===n.isEndGame&&(t.endGame=!0,n.winner.isPlayer())){const i=$localize`Player ${n.winner.value+1}`,o=n.winner.getOpponent().value;t.winnerMessage=t.players[n.winner.value].equalsValue("human")?t.players[o].equalsValue("human")?g.of($localize`${i} won`):g.of($localize`You won`):t.players[o].equalsValue("human")?g.of($localize`You lost`):g.of($localize`${t.players[n.winner.value].get()} (Player ${n.winner.value+1}) won`)}})()}proposeAIToPlay(){var e=this;return M(function*(){if(e.hasSelectedAI()){e.gameComponent.setInteractive(!1),yield e.updateBoard(!1);const t=e.getPlayingAI();t.isPresent()&&window.setTimeout(M(function*(){yield e.doAIMove(t.get().ai,t.get().options)}),_R.AI_TIMEOUT)}else e.gameComponent.setInteractive(!0),yield e.updateBoard(!1),e.cdr.detectChanges()})()}hasSelectedAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return!1;const e=this.gameComponent.getTurn()%2;return"human"!==this.playerSelection[e]}getPlayingAI(){const e=this.gameComponent.getTurn()%2,t=this.findAI(e);if(t.isPresent()){const n=t.get(),i=this.aiOptions[e];return g.ofNullable(n.availableOptions.find(o=>o.name===i)).map(o=>({ai:n,options:o}))}return g.empty()}findAI(e){return g.ofNullable(this.gameComponent.availableAIs.find(t=>this.players[e].equalsValue(t.name)))}doAIMove(e,t){var n=this;return M(function*(){const i=n.gameComponent.rules;je(i.getGameStatus(n.gameComponent.node)===_e.ONGOING,"AI should not try to play when game is over!");const o=e.chooseNextMove(n.gameComponent.node,t),a=i.choose(n.gameComponent.node,o);return a.isSuccess()?(n.gameComponent.node=a.get(),yield n.updateBoard(!0),n.cdr.detectChanges(),yield n.proposeAIToPlay(),b.SUCCESS):(n.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),h2.logError("LocalGameWrapper","AI chose illegal move",{game:n.getGameName(),name:e.name,move:o.toString(),reason:a.getReason()}))})()}availableAIOptions(e){return this.findAI(e).get().availableOptions}canTakeBack(){return this.players[0].equalsValue("human")?this.gameComponent.getTurn()>0:!!this.players[1].equalsValue("human")&&this.gameComponent.getTurn()>1}takeBack(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.node.parent.get(),e.isAITurn()&&(U.assert(e.gameComponent.node.parent.isPresent(),"Cannot take back in first turn when AI is Player.ZERO"),e.gameComponent.node=e.gameComponent.node.parent.get()),yield e.updateBoardAndShowLastMove(!1)})()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){var e=this;return M(function*(){e.gameComponent.node=e.gameComponent.rules.getInitialNode(),e.endGame=!1,e.winnerMessage=g.empty(),yield e.proposeAIToPlay()})()}getPlayer(){return"human"}onCancelMove(e){var t=this;return M(function*(){if(t.gameComponent.node.previousMove.isPresent()){const n=t.gameComponent.node.previousMove.get();yield t.gameComponent.showLastMove(n)}})()}displayAIInfo(){return"true"===localStorage.getItem("displayAIInfo")}},u($l,"AI_TIMEOUT",1e3),u($l,"\u0275fac",function(e){return new(e||$l)(B(Ls),B(ur),B(Bn),B(Ut),B(T3))}),u($l,"\u0275cmp",We({type:$l,selectors:[["app-local-game-wrapper"]],features:[Xe],decls:8,vars:3,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m;return r=$localize`Turn n${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,t=$localize`Human`,n=$localize`Pick the options`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Pick the options`,a=$localize`${"\ufffd0\ufffd"}:INTERPOLATION:`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,l=$localize`Draw`,f=$localize`Start a new game`,d=$localize`Pass a turn`,m=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],r,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],t,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroLevelSelect",3,"ngModel","ngModelChange","change"],["selected","","value","none"],n,i,["id","scoreOne",1,"block"],s,["id","aiOneLevelSelect",3,"ngModel","ngModelChange","change"],o,a,["id","scoreZero",1,"block"],c,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],l,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIInfo",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","AIInfo"],[4,"ngFor","ngForOf"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1),T(2,Fyt,24,10,"div",2),T(3,Wyt,6,3,"div",3),P(),S(4,"div",4)(5,"div",5),F(6,"div",null,6),P()()()),2&e&&(_(2),y("ngIf",t.gameComponent),_(1),y("ngIf",t.gameComponent),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Wt,wt,nf,rf,mg,N3,tf],encapsulation:2,changeDetection:0})),$l);vR=_R=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],vR);let C4e=(()=>{class r{}return u(r,"STEP_FINISHED",()=>$localize`Step finished!`),u(r,"INFORMATIONAL_STEP",()=>$localize`This step is not expecting any move from your part.`),r})();var zu;function jyt(r,e){if(1&r&&(S(0,"div",21)(1,"div",22),oe(2,23),P(),F(3,"div",24),P()),2&r){const t=p();_(3),y("innerHTML",t.currentReason.get(),g7)}}function Zyt(r,e){if(1&r){const t=pe();S(0,"button",25),W("click",function(){return te(t),ne(p().retry())}),oe(1,26),P()}}function Yyt(r,e){1&r&&(Gt(0),oe(1,31),Bt())}function Kyt(r,e){1&r&&(Gt(0),oe(1,32),Bt())}function Xyt(r,e){if(1&r&&T(0,Kyt,2,0,"ng-container",28),2&r){p();const t=ln(5),n=p();y("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",t)}}function Qyt(r,e){1&r&&(Gt(0),oe(1,33),Bt())}function Jyt(r,e){if(1&r){const t=pe();S(0,"button",27),W("click",function(){return te(t),ne(p().next())}),T(1,Yyt,2,0,"ng-container",28),T(2,Xyt,1,2,"ng-template",null,29,fn),T(4,Qyt,2,0,"ng-template",null,30,fn),P()}if(2&r){const t=ln(3),n=p();_(1),y("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",t)}}function eMt(r,e){if(1&r){const t=pe();S(0,"button",34),W("click",function(){return te(t),ne(p().start())}),oe(1,35),P()}}function tMt(r,e){if(1&r){const t=pe();S(0,"button",36),W("click",function(){return te(t),ne(p().playLocally())}),oe(1,37),P()}}function nMt(r,e){if(1&r){const t=pe();S(0,"button",38),W("click",function(){return te(t),ne(p().createGame())}),oe(1,39),P()}}function rMt(r,e){if(1&r){const t=pe();S(0,"button",40),W("click",function(){return te(t),ne(p().showSolution())}),oe(1,41),P()}}function iMt(r,e){if(1&r&&(Gt(0),S(1,"option",43),ct(2),P(),Bt()),2&r){const t=p(),n=t.index,i=t.$implicit;_(1),Dn("id","step_",n,""),y("value",n),_(1),An(i.title)}}function sMt(r,e){1&r&&(Gt(0),ct(1,"v "),Bt())}function oMt(r,e){1&r&&ct(0,"x ")}function aMt(r,e){if(1&r&&(S(0,"option",44),T(1,sMt,2,0,"ng-container",28),T(2,oMt,1,0,"ng-template",null,45,fn),S(4,"span",46),ct(5),P()()),2&r){const t=ln(3),n=p(),i=n.index,s=n.$implicit,o=p();y("value",i),_(1),y("ngIf",o.stepFinished[i])("ngIfElse",t),_(3),Dn("id","step_",i,""),_(1),An(s.title)}}function cMt(r,e){if(1&r&&(Gt(0),T(1,iMt,3,3,"ng-container",28),T(2,aMt,6,5,"ng-template",null,42,fn),Bt()),2&r){const t=e.index,n=ln(3),i=p();_(1),y("ngIf",t===i.stepIndex)("ngIfElse",n)}}let CR=(zu=class extends QC{constructor(e,t,n,i,s){super(e,s,t,n),u(this,"cdr",void 0),u(this,"COMPLETED_TUTORIAL_MESSAGE",$localize`Congratulations, you completed the tutorial.`),u(this,"steps",[]),u(this,"successfulSteps",0),u(this,"stepIndex",-1),u(this,"currentMessage",""),u(this,"currentReason",g.empty()),u(this,"moveAttemptMade",!1),u(this,"stepFinished",[]),u(this,"tutorialOver",!1),this.cdr=i,this.role=k.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return M(function*(){(yield e.afterViewInit())&&(yield e.start())})()}start(){var e=this;return M(function*(){const t=e.gameComponent.tutorial;yield e.startTutorial(t)})()}startTutorial(e){var t=this;return M(function*(){t.steps=e,t.tutorialOver=!1,t.stepFinished=t.getCompletionArray(),t.successfulSteps=0,yield t.showStep(0)})()}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){var t=this;return M(function*(){const n=e.target;yield t.showStep(Number.parseInt(n.value,10))})()}showStep(e){var t=this;return M(function*(){t.moveAttemptMade=!1,t.stepFinished[e]=!1,t.updateSuccessCount(),t.stepIndex=e;const n=t.steps[t.stepIndex];t.currentMessage=n.instruction,t.currentReason=g.empty(),t.gameComponent.node=new Vo(n.state,g.empty(),n.previousMove),yield t.setRole(t.gameComponent.getCurrentPlayer()),t.gameComponent.setInteractive(!1===n.isInformation()),t.cdr.detectChanges()})()}onLegalUserMove(e){var t=this;return M(function*(){const n=t.steps[t.stepIndex],i=t.gameComponent.rules.choose(t.gameComponent.node,e);if(U.assert(i.isSuccess(),"It should be impossible to call onLegalUserMove with an illegal move, but got "+i.getReasonOr("")),t.gameComponent.node=i.get(),yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,n.isPredicate()){const s=t.gameComponent.getPreviousState(),o=t.gameComponent.getState(),a=U.getNonNullable(n.predicate)(e,s,o);a.isSuccess()?t.showStepSuccess(n.getSuccessMessage()):t.currentReason=g.of(a.getReason())}else if(n.isAnyMove())Ne.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(n.getSuccessMessage());else if(n.isMove()){const s=n;s.acceptedMoves.some(o=>o.equals(e))?(Ne.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(Ne.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=g.of(s.getFailureMessage()))}else U.assert(n.isClick(),"Here, we should have a click");t.cdr.detectChanges()})()}retry(){var e=this;return M(function*(){e.moveAttemptMade=!1,yield e.showStep(e.stepIndex)})()}canUserPlay(e){var t=this;return M(function*(){if(t.currentReason=g.empty(),t.stepFinished[t.stepIndex]||t.moveAttemptMade)return b.failure(C4e.STEP_FINISHED());const n=t.steps[t.stepIndex];return n.isClick()?(yield t.updateBoardAndShowLastMove(!1),t.moveAttemptMade=!0,U.getNonNullable(n.acceptedClicks).some(i=>i===e)?t.showStepSuccess(n.getSuccessMessage()):t.currentMessage=n.getFailureMessage(),b.SUCCESS):n.isMove()||n.isPredicate()||n.isAnyMove()?b.SUCCESS:b.failure(C4e.INFORMATIONAL_STEP())})()}onCancelMove(e){var t=this;return M(function*(){void 0!==e&&(t.currentReason=g.of(e)),t.cdr.detectChanges()})()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){var e=this;return M(function*(){if(e.steps[e.stepIndex].isInformation()&&(e.stepFinished[e.stepIndex]=!0,e.updateSuccessCount()),e.stepFinished.length===e.successfulSteps)e.currentMessage=e.COMPLETED_TUTORIAL_MESSAGE,e.tutorialOver=!0;else{let t=(e.stepIndex+1)%e.steps.length;for(;!0===e.stepFinished[t];)t=(t+1)%e.steps.length;yield e.showStep(t)}})()}showSolution(){var e=this;return M(function*(){const t=e.steps[e.stepIndex];U.assert(t.hasSolution(),"step must have solution");const n=t,i=n.getSolution();i instanceof Hi?(yield e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i).get(),yield e.updateBoardAndShowLastMove(!0)):(yield e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=n.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return M(function*(){const t=U.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return M(function*(){const t=U.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}},u(zu,"\u0275fac",function(e){return new(e||zu)(B(Ls),B(Bn),B(Ut),B(T3),B(ur))}),u(zu,"\u0275cmp",We({type:zu,selectors:[["app-tutorial-game-wrapper"]],features:[Xe],decls:23,vars:15,consts:function(){let r,e,t,n,i,s,o,a,c;return r=$localize`Failure`,e=$localize`Try again`,t=$localize`Ok`,n=$localize`Continue`,i=$localize`Skip`,s=$localize`Try again`,o=$localize`Play locally`,a=$localize`Create an online game`,c=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],r,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],t,n,i,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],o,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],c,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(S(0,"div",0)(1,"div",1)(2,"div",2),F(3,"progress",3),S(4,"div",4)(5,"p",5),ct(6),P(),F(7,"p",6),P(),T(8,jyt,4,1,"div",7),S(9,"div",8),T(10,Zyt,2,0,"button",9),T(11,Jyt,6,2,"button",10),T(12,eMt,2,0,"button",11),T(13,tMt,2,0,"button",12),T(14,nMt,2,0,"button",13),T(15,rMt,2,0,"button",14),S(16,"div",15)(17,"select",16),W("change",function(i){return t.changeStep(i)}),T(18,cMt,4,2,"ng-container",17),P()()()()(),S(19,"div",18)(20,"div",19),F(21,"div",null,20),P()()()),2&e&&(_(3),I("value",t.successfulSteps)("max",t.getNumberOfSteps()),_(3),fE("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),_(1),y("innerHTML",t.currentMessage,g7),_(1),y("ngIf",t.currentReason.isPresent()),_(2),y("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),_(1),y("ngIf",!1===t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.tutorialOver),_(1),y("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),_(3),y("ngForOf",t.steps),_(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Wt,wt,nf,rf],encapsulation:2,changeDetection:0})),zu);function lMt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),oe(2,37),P(),S(3,"div",38),ct(4),P()()),2&r){const t=p();_(4),An(t.errorMessage)}}CR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([Ne.log],CR);const uMt=function(){return["/login"]};let fMt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"faEye",Bx),u(this,"errorMessage",void 0),u(this,"registrationForm",new $4({email:new oo,username:new oo,password:new oo})),this.connectedUserService=n,this.router=i}registerWithEmail(){var n=this;return M(function*(){const i=n.registrationForm.value.username,s=n.registrationForm.value.email,o=n.registrationForm.value.password;if(null==i||null==s||null==o)n.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const a=yield n.connectedUserService.doRegister(i,s,o);if(a.isSuccess()){const c=yield n.connectedUserService.sendEmailVerification();c.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=c.getReason()}else n.errorMessage=a.getReason()}})()}registerWithGoogle(){var n=this;return M(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=i.getReason()})()}getPasswordHelpClass(){const n=this.registrationForm.value.password;return null==n||""===n?"":n.length<6?"is-danger":"is-success"}canRegister(){const n=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===n||n.length<6)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(ur),B(Bn))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,E,w,R;return t=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,o=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,f=$localize`The password should be at least 6 characters long`,d=$localize`Register`,m=$localize`Register with Google`,E=$localize`Have an account?`,w=$localize`Log in`,R=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],o,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],f,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],d,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],E,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],R,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),P()(),S(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),S(12,"p",12),oe(13,13),P()()()()(),S(14,"div",4)(15,"div",5)(16,"label",14),oe(17,15),P()(),S(18,"div",8)(19,"div",9)(20,"div",10),F(21,"input",16),P()()()(),S(22,"div",4)(23,"div",5)(24,"label",17),oe(25,18),P()(),S(26,"div",8)(27,"div",9)(28,"div",19),F(29,"input",20),S(30,"span",21),F(31,"fa-icon",22),P(),S(32,"p",23),oe(33,24),P()()()()(),S(34,"div",4),F(35,"div",5),S(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),W("click",function(){return i.registerWithEmail()}),oe(40,26),P()()()()(),S(41,"div",4),F(42,"div",5),S(43,"div",27),T(44,lMt,5,1,"div",28),P()(),S(45,"div",4),F(46,"div",5),S(47,"div",8)(48,"button",29),W("click",function(){return i.registerWithGoogle()}),oe(49,30),P()()(),S(50,"p",31),Gt(51),oe(52,32),Bt(),ct(53,"\xa0 "),S(54,"a",33),oe(55,34),P()()()()),2&n&&(_(3),y("formGroup",i.registrationForm),_(28),y("icon",i.faEye),_(1),y("ngClass",i.getPasswordHelpClass()),_(7),y("disabled",!i.canRegister()),_(5),y("ngIf",i.errorMessage),_(10),y("routerLink",H1(6,uMt)))},dependencies:[Ft,wt,Ec,C6,vc,N3,_6,E6,y6,$8,O0,dR,p4e],encapsulation:2})),e})(),dMt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}playLocally(){var n=this;return M(function*(){yield n.router.navigate(["local/"+n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Bn))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.playLocally()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[fR],encapsulation:2})),e})(),hMt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}launchTutorial(){var n=this;return M(function*(){yield n.router.navigate(["/tutorial/",n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Bn))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(S(0,"app-pick-game",0),W("pickGame",function(o){return i.pickGame(o)}),P(),S(1,"button",1),W("click",function(){return i.launchTutorial()}),oe(2,2),P()),2&n&&(_(1),y("disabled",!i.selectedGame))},dependencies:[fR],encapsulation:2})),e})(),pMt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",We({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),oe(1,0),P())},encapsulation:2})),e})();var yR,MR,Jd,ER;function mMt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessQueenComponent.HEPTAGON)}}function _Mt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function vMt(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function CMt(r,e){if(1&r&&(Gt(0),A(),F(1,"circle",6)(2,"circle",6)(3,"circle",6),Bt()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function yMt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"circle",7)(2,"circle",7)(3,"circle",7),P()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function MMt(r,e){if(1&r&&(A(),S(0,"g",8),F(1,"circle",9)(2,"circle",9)(3,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class Gl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessQueenComponent",Gl),u(this,"MartianChessComponent",Es),u(this,"horizontalDotsRadius",Es.SPACE_SIZE/15)}}function SMt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessDroneComponent.PENTAGON)}}function PMt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function TMt(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function OMt(r,e){if(1&r&&(Gt(0),A(),F(1,"circle",6)(2,"circle",6),Bt()),2&r){const t=p();_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function bMt(r,e){if(1&r&&(A(),S(0,"g",7),F(1,"circle",8)(2,"circle",8),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),_(1),I("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function wMt(r,e){if(1&r&&(A(),S(0,"g",7),F(1,"circle",9)(2,"circle",9),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}yR=Gl,u(Gl,"HEPTAGON",Es.getRegularPolygon(7)),u(Gl,"EIGHT_POINTED_STAR",Es.getNPointedStar(8,0)),u(Gl,"\u0275fac",function(e){return new(e||yR)}),u(Gl,"\u0275cmp",We({type:yR,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,mMt,1,3,"polygon",0),T(1,_Mt,1,3,"polygon",0),T(2,vMt,1,5,"circle",1),T(3,CMt,4,9,"ng-container",2),T(4,yMt,4,9,"g",2),T(5,MMt,4,10,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Bl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Es),u(this,"MartianChessDroneComponent",Bl),u(this,"horizontalDotsRadius",Es.SPACE_SIZE/15)}}function AMt(r,e){if(1&r&&(A(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessPawnComponent.TRIANGLE)}}function IMt(r,e){if(1&r&&(A(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function kMt(r,e){if(1&r&&(A(),F(0,"circle",6)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function xMt(r,e){if(1&r&&(A(),F(0,"circle",7)),2&r){const t=p();I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function LMt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p();I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function RMt(r,e){if(1&r&&(A(),S(0,"g",9),F(1,"circle",10),P()),2&r){const t=p();y("ngClass",t.pieceClasses),_(1),I("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}MR=Bl,u(Bl,"FOUR_POINTED_STAR_VERTICAL",Es.getNPointedStar(4,0)),u(Bl,"PENTAGON",Es.getRegularPolygon(5)),u(Bl,"\u0275fac",function(e){return new(e||MR)}),u(Bl,"\u0275cmp",We({type:MR,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,SMt,1,3,"polygon",0),T(1,PMt,1,3,"polygon",0),T(2,TMt,1,5,"circle",1),T(3,OMt,3,6,"ng-container",2),T(4,bMt,3,7,"g",3),T(5,wMt,3,7,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Ja{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Es),u(this,"MartianChessPawnComponent",Ja),u(this,"horizontalDotsRadius",Es.SPACE_SIZE/15)}static getTriangle(){return Es.getRegularPolygon(3,Ja.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=Es.getRegularPolygonCoords(3).map(c=>c.y);return(t.reduce((c,l)=>Math.min(c,l))+(100-t.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Ja.TRIANGLE_Y_OFFSET:0}}function DMt(r,e){if(1&r&&(A(),F(0,"text",8)),2&r){const t=p();Ni("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("innerHTML",t.coord.z,g7)}}function HMt(r,e){if(1&r&&(A(),F(0,"polyline",9)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getUpperHorizontalLine())}}function VMt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polyline",10)(2,"polyline",11),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),I("points",t.getMiddleHorizontalLine()),_(1),y("ngClass",t.pieceClasses),I("points",t.getLowerHorizontalLine())}}function FMt(r,e){if(1&r&&(A(),F(0,"polyline",12)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getLeftDiagonalLine())}}function $Mt(r,e){if(1&r&&(A(),S(0,"g"),F(1,"polyline",13)(2,"polyline",14),P()),2&r){const t=p();_(1),y("ngClass",t.pieceClasses),I("points",t.getMiddleDiagonalLine()),_(1),y("ngClass",t.pieceClasses),I("points",t.getRighterDiagonalLine())}}function GMt(r,e){if(1&r&&(A(),F(0,"polyline",15)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getLeftVerticalLine())}}function BMt(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getMiddleVerticalLine())}}function UMt(r,e){if(1&r&&(A(),F(0,"polyline",17)),2&r){const t=p();y("ngClass",t.pieceClasses),I("points",t.getRighterVerticalLine())}}Jd=Ja,u(Ja,"FOUR_POINTED_STAR_DIAGONAL",Es.getNPointedStar(4,45)),u(Ja,"TRIANGLE_Y_OFFSET",Jd.yOffsetForVerticalCentering()),u(Ja,"TRIANGLE",Jd.getTriangle()),u(Ja,"\u0275fac",function(e){return new(e||Jd)}),u(Ja,"\u0275cmp",We({type:Jd,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,AMt,1,3,"polygon",0),T(1,IMt,1,3,"polygon",0),T(2,kMt,1,5,"circle",1),T(3,xMt,1,3,"circle",2),T(4,LMt,1,3,"circle",3),T(5,RMt,2,4,"g",4)),2&e&&(y("ngIf","Polygon"===t.style.shape),_(1),y("ngIf","Star"===t.style.shape),_(1),y("ngIf","Circle"===t.style.shape),_(1),y("ngIf","Concentric Circles"===t.style.points),_(1),y("ngIf","Dots"===t.style.points),_(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class eh{constructor(){u(this,"coord",void 0),u(this,"move",void 0),u(this,"pieceClasses",void 0),u(this,"mode",void 0),u(this,"mustDisplayHeight",void 0)}mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,s=e,a=e-n,c=t,l=-n,f=t;return[new C(0,0),new C(s,0),new C(l,f),new C(a,c),new C(s,0+i),new C(l,f+i),new C(a,c+i)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],n=e[1],s=new Et(-1*this.mode.offsetRatio*$n.STROKE_WIDTH,$n.STROKE_WIDTH),o=t.getNext(s),a=n.getNext(s);return[t,n,a,o]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],n=e[3],s=new Et(-1*this.mode.offsetRatio*$n.STROKE_WIDTH,$n.STROKE_WIDTH);return[t.getNext(s,-1),n.getNext(s,-1),n,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],n=e[6],i=new Et(0,$n.STROKE_WIDTH),s=t.getNext(i,-1),o=n.getNext(i,-1);return this.mapCoordToPoints([s,o,n,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],n=e[2],s=new Et($n.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[3],s=new Et($n.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],n=e[6],s=new Et(0,$n.STROKE_WIDTH),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],n=e[5],s=new Et($n.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],n=e[6],s=new Et($n.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[4],o=new Et($n.STROKE_WIDTH,-$n.STROKE_WIDTH/this.mode.offsetRatio),a=t.getNext(o,-1),c=n.getNext(o,-1);return this.mapCoordToPoints([a,t,n,c])}getOtherCoord(){je(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}}ER=eh,u(eh,"STROKE_OFFSET",$n.STROKE_WIDTH/2),u(eh,"\u0275fac",function(e){return new(e||ER)}),u(eh,"\u0275cmp",We({type:ER,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,t){1&e&&(A(),F(0,"polyline",0),T(1,DMt,1,4,"text",1),T(2,HMt,1,2,"polyline",2),T(3,VMt,3,4,"g",3),T(4,FMt,1,2,"polyline",4),T(5,$Mt,3,4,"g",3),T(6,GMt,1,2,"polyline",5),T(7,BMt,1,2,"polyline",6),T(8,UMt,1,2,"polyline",7)),2&e&&(Ni("id","tile_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("ngClass",t.pieceClasses),I("points",t.get3DIsoSquarePoints()),_(1),y("ngIf",t.mustDisplayHeight),_(1),y("ngIf",!1===t.isBottomHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isTopHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",!1===t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isLeftHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isBottomHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()),_(1),y("ngIf",t.isTopHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()))},dependencies:[Ft,wt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const th_firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let SR=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"userSubscription",void 0),this.connectedUserService=n}canActivate(){var n=this;return M(function*(){const i=yield new Promise(s=>{n.userSubscription=n.connectedUserService.subscribeToUser(function(){var o=M(function*(a){return s(yield n.evaluateUserPermission(a))});return function(a){return o.apply(this,arguments)}}())});return n.userSubscription.unsubscribe(),i})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ur))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Du=(()=>{var r;class e extends SR{static evaluateUserPermission(n,i){return M(function*(){return!1===i.isConnected()?n.parseUrl("/login"):!1!==i.verified||n.parseUrl("/verify-account")})()}constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return e.evaluateUserPermission(i.router,n)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ur),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),PR=(()=>{var r;class e{constructor(n,i){u(this,"currentGameService",void 0),u(this,"router",void 0),u(this,"currentGameSubscription",g.empty()),this.currentGameService=n,this.router=i}canActivate(n){var i=this;return M(function*(){const s=yield i.currentGameService.getCurrentGame();if(s.isAbsent())return!0;const o=s.get();return n.params.id===o.id||i.router.parseUrl("/play/"+o.typeGame+"/"+o.id)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(hs),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),WMt=(()=>{var r;class e extends SR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()?i.router.parseUrl("/login"):!n.verified||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ur),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),qMt=(()=>{var r;class e extends SR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return M(function*(){return!1===n.isConnected()||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ur),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function jMt(r,e){1&r&&(S(0,"p",20),oe(1,21),P())}function ZMt(r,e){if(1&r){const t=pe();S(0,"div",7)(1,"p",8),oe(2,9),P(),S(3,"div",10)(4,"p",11),oe(5,12),P(),S(6,"button",13),W("click",function(){return te(t),ne(p().finalizeEmailVerification())}),oe(7,14),P()(),S(8,"div",15)(9,"p",11),oe(10,16),P(),S(11,"button",17),W("click",function(){return te(t),ne(p().sendEmailVerification())}),oe(12,18),P()(),T(13,jMt,2,0,"p",19),P()}if(2&r){const t=p();_(2),Gn(t.emailAddress),Zn(2),_(11),y("ngIf",t.success)}}function YMt(r,e){if(1&r){const t=pe();S(0,"div",24)(1,"div",8),oe(2,25),P(),S(3,"form",26)(4,"div",27)(5,"div",28),F(6,"input",29),P(),S(7,"div",28)(8,"button",30),W("click",function(){te(t);const i=p(2);return ne(i.pickUsername(i.usernameForm.value))}),oe(9,31),P()()()()()}if(2&r){const t=p(2);_(3),y("formGroup",t.usernameForm)}}const KMt=function(){return["/lobby"]};function XMt(r,e){1&r&&(S(0,"div",32),Is(1,33),F(2,"a",34),ks(),P()),2&r&&(_(2),y("routerLink",H1(1,KMt)))}function QMt(r,e){if(1&r&&(Gt(0),T(1,YMt,10,1,"div",22),T(2,XMt,3,2,"div",23),Bt()),2&r){const t=p();_(1),y("ngIf",!t.success),_(1),y("ngIf",t.success)}}function JMt(r,e){if(1&r&&(S(0,"div",35)(1,"div",36),ct(2),P()()),2&r){const t=p();_(2),An(t.errorMessage)}}let eEt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"verificationType",null),u(this,"success",!1),u(this,"triedToFinalize",!1),u(this,"errorMessage",void 0),u(this,"emailAddress",void 0),u(this,"userSubscription",void 0),u(this,"usernameForm",new $4({username:new oo})),this.connectedUserService=n,this.router=i}ngOnInit(){var n=this;return M(function*(){n.userSubscription=n.connectedUserService.subscribeToUser(function(){var i=M(function*(s){n.emailAddress=s.email.get(),s.username.isAbsent()?n.verificationType="enter-username":(n.verificationType="send-email",!0===n.triedToFinalize&&!1===s.verified&&(n.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield n.router.navigate(["/lobby"])))});return function(s){return i.apply(this,arguments)}}())})()}pickUsername(n){var i=this;return M(function*(){const s=yield i.connectedUserService.setUsername(n.username);s.isSuccess()?i.success=!0:i.errorMessage=s.getReason()})()}sendEmailVerification(){var n=this;return M(function*(){const i=yield n.connectedUserService.sendEmailVerification();i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}finalizeEmailVerification(){var n=this;return M(function*(){n.triedToFinalize=!0,yield n.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(ur),B(Bn))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,n,i,s,o,a,c,l,f,d,m;return t=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,o=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,f=$localize`Username`,d=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],o,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",f,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],d,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"div",1)(2,"div",2),oe(3,3),P(),T(4,ZMt,14,2,"div",4),T(5,QMt,3,2,"ng-container",5),P(),T(6,JMt,3,1,"div",6),P()),2&n&&(_(4),y("ngIf","send-email"===i.verificationType),_(1),y("ngIf","enter-username"===i.verificationType),_(1),y("ngIf",i.errorMessage))},dependencies:[wt,Ec,C6,vc,N3,_6,E6,y6,$8],encapsulation:2})),e})();function tEt(r,e){1&r&&(S(0,"p",17),oe(1,18),P())}function nEt(r,e){if(1&r&&(S(0,"div",19)(1,"div",20),oe(2,21),P(),S(3,"div",22),ct(4),P()()),2&r){const t=p();_(4),An(t.errorMessage.get())}}const rEt=function(){return{standalone:!0}};let iEt=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"success",!1),u(this,"errorMessage",g.empty()),u(this,"email",""),this.connectedUserService=n}resetPassword(){var n=this;return M(function*(){je(""!==n.email,"No email was entered, but it should not be possible to submit the form then!"),n.errorMessage=g.empty(),n.success=!1;const i=yield n.connectedUserService.sendPasswordResetEmail(n.email);i.isSuccess()?n.success=!0:n.errorMessage=g.of(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(ur))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,n,i,s,o,a,c;return t=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,s=$localize`An email will be sent with instruction to reset your password.`,o=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],s,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],o,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"div",3)(4,"div",4)(5,"label",5),oe(6,6),P()(),S(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),W("ngModelChange",function(o){return i.email=o}),P(),S(11,"p",11),oe(12,12),P(),T(13,tEt,2,0,"p",13),P()()()(),S(14,"button",14),W("click",function(){return i.resetPassword()}),oe(15,15),P(),T(16,nEt,5,1,"div",16),P()),2&n&&(_(10),y("ngModel",i.email)("ngModelOptions",H1(5,rEt)),_(3),y("ngIf",i.success),_(1),y("disabled",""===i.email),_(2),y("ngIf",i.errorMessage.isPresent()))},dependencies:[wt,vc,N3,E6,tf,dR],encapsulation:2})),e})();function sEt(r,e){if(1&r&&(S(0,"option",13),ct(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentTheme),_(1),b2(" ",t.name," ")}}function oEt(r,e){if(1&r&&(S(0,"option",13),ct(1),P()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentLanguage),_(1),b2(" ",t.name," ")}}let aEt=(()=>{var r;class e{constructor(n,i){u(this,"userSettingsService",void 0),u(this,"availableLanguages",[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}]),u(this,"availableThemes",[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}]),u(this,"currentTheme",void 0),u(this,"currentLanguage",void 0),this.userSettingsService=n,this.currentTheme=i.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(n){this.userSettingsService.changeLanguage(n.target.value),this.reload()}changeTheme(n){this.userSettingsService.changeTheme(n.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Hee),B(_v))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(S(0,"div",0)(1,"p",1),oe(2,2),P(),S(3,"div",3)(4,"label",4),oe(5,5),P(),S(6,"div",6)(7,"div",7)(8,"select",8),W("change",function(o){return i.changeTheme(o)}),T(9,sEt,2,3,"option",9),P()()()(),S(10,"div",3)(11,"label",10),oe(12,11),P(),S(13,"div",6)(14,"div",7)(15,"select",12),W("change",function(o){return i.changeLanguage(o)}),T(16,oEt,2,3,"option",9),P()()()()()),2&n&&(_(9),y("ngForOf",i.availableThemes),_(7),y("ngForOf",i.availableLanguages))},dependencies:[Wt,nf,rf],encapsulation:2})),e})(),cEt=(()=>{var r;class e{constructor(n,i,s,o,a,c){u(this,"route",void 0),u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"gameService",void 0),this.route=n,this.router=i,this.connectedUserService=s,this.currentGameService=o,this.messageDisplayer=a,this.gameService=c}ngOnInit(){var n=this;return M(function*(){yield n.createGameAndRedirectOrShowError(n.extractGameFromURL())})()}extractGameFromURL(){return U.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(n){var i=this;return M(function*(){if(je(i.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===i.gameExists(n))return yield i.router.navigate(["/notFound",V0.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;const o=i.currentGameService.canUserCreate();if(o.isSuccess()){const a=yield i.gameService.createPartConfigRoomAndChat(n);return yield i.router.navigate(["/play",n,a]),!0}return i.messageDisplayer.infoMessage(o.getReason()),yield i.router.navigate(["/lobby"]),!1})()}gameExists(n){return g.ofNullable(ku.ALL_GAMES().find(s=>s.urlName===n)).isPresent()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(B(Ls),B(Bn),B(ur),B(hs),B(Ut),B(Q5))}),u(e,"\u0275cmp",We({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(S(0,"p"),oe(1,0),P())},encapsulation:2})),e})();!function The(r,e,t){(function h7e(r,e,t){"string"!=typeof e&&(t=e,e=r[A1.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),L8[e]=r,t&&(L8[e][A1.ExtraData]=t)})(r,e,t)}(tMe);const lEt=[{path:"login",component:Uvt},{path:"lobby",component:hR,canActivate:[Du]},{path:"account",component:lCt,canActivate:[Du]},{path:"settings",component:aEt},{path:"register",component:fMt,canActivate:[qMt]},{path:"reset-password",component:iEt},{path:"notFound/:message",component:m4e},{path:"nextGameLoading",component:pMt,canActivate:[Du]},{path:"verify-account",component:eEt,canActivate:[WMt]},{path:"play",component:g4e,canActivate:[Du,PR]},{path:"play/:compo",component:cEt,canActivate:[Du,PR]},{path:"play/:compo/:id",component:mR,canActivate:[Du,PR]},{path:"local",component:dMt},{path:"local/:compo",component:vR},{path:"tutorial",component:hMt},{path:"tutorial/:compo",component:CR},{path:"",component:kvt},{path:"demo",component:Fvt},{path:"**",component:m4e}];class TR{static app(){return function KAe(r,...e){return{ngModule:YAe,providers:[{provide:gA,useFactory:ZAe(r),multi:!0,deps:[l1,ni,hA,...e]}]}}(()=>XAe(th_firebaseConfig))}static firestore(){return function QLe(r,...e){return{ngModule:XLe,providers:[{provide:Bk,useFactory:ZLe(r),multi:!0,deps:[l1,ni,hA,pA,[new is,KJ],[new is,zA],...e]}]}}(()=>{const e=sRe();e.toJSON();return e})}static auth(){return function zLe(r,...e){return{ngModule:RLe,providers:[{provide:Gk,useFactory:kLe(r),multi:!0,deps:[l1,ni,hA,pA,[new is,zA],...e]}]}}(()=>{const e=VLe();return e})}}let uEt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275mod",Si({type:r,bootstrap:[R7t]})),u(e,"\u0275inj",Q2({providers:[ur,Q5,jk,ld,K5,Y5,_v,{provide:mc,useValue:ud.getLocale()}],imports:[TR.app(),TR.firestore(),TR.auth(),nB,wme,Xve.forRoot(lEt,{useHash:!1}),rme,nme,Jye,XWe]})),e})();by(Es,function(){return[Ft,Wt,wt,Gl,Bl,Ja]},[]),by($n,function(){return[Ft,Wt,wt,eh]},[]);var fEt=Po(522);function y4e(){jpe().bootstrapModule(uEt).catch(r=>console.error(r))}const M4e=ud.getLocale();"en"!==M4e?fetch("/assets/"+M4e+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,fEt.XJ)(r.translations),$localize.locale=r.locale,y4e()}).catch(function(r){console.log(r)}):y4e()},1:function(Hu,B0){!function(Po){"use strict";function yn(dt,it){var zt=Object.keys(dt);if(Object.getOwnPropertySymbols){var Ln=Object.getOwnPropertySymbols(dt);it&&(Ln=Ln.filter(function(Lr){return Object.getOwnPropertyDescriptor(dt,Lr).enumerable})),zt.push.apply(zt,Ln)}return zt}function To(dt){for(var it,zt=1;zt<arguments.length;zt++)it=null==arguments[zt]?{}:arguments[zt],zt%2?yn(Object(it),!0).forEach(function(Ln){ql(dt,Ln,it[Ln])}):Object.getOwnPropertyDescriptors?Object.defineProperties(dt,Object.getOwnPropertyDescriptors(it)):yn(Object(it)).forEach(function(Ln){Object.defineProperty(dt,Ln,Object.getOwnPropertyDescriptor(it,Ln))});return dt}function a3(dt,it){if(!(dt instanceof it))throw new TypeError("Cannot call a class as a function")}function c3(dt,it){for(var zt,Ln=0;Ln<it.length;Ln++)(zt=it[Ln]).enumerable=zt.enumerable||!1,zt.configurable=!0,"value"in zt&&(zt.writable=!0),Object.defineProperty(dt,zt.key,zt)}function Mn(dt,it,zt){return it&&c3(dt.prototype,it),zt&&c3(dt,zt),dt}function ql(dt,it,zt){return it in dt?Object.defineProperty(dt,it,{value:zt,enumerable:!0,configurable:!0,writable:!0}):dt[it]=zt,dt}function l3(){var dt;return null!==(dt=U0)&&void 0!==dt?dt:document}var jl={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},Ss=To({},jl),Oo={},U0=null,Vu=function(dt,it,zt,Ln,Lr){return"top-left"===dt?"left:".concat(Ln,";top:").concat(it,";text-align:left;align-items:flex-start;"):"top-right"===dt?"right:".concat(Lr,";top:").concat(it,";text-align:right;align-items:flex-end;"):"top-center"===dt?"top:".concat(it,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===dt?"left:".concat(Ln,";bottom:").concat(zt,";text-align:left;align-items:flex-start;"):"bottom-right"===dt?"right:".concat(Lr,";bottom:").concat(zt,";text-align:right;align-items:flex-end;"):"bottom-center"===dt?"bottom:".concat(zt,";left:0;right:0;text-align:center;align-items:center;"):"center"===dt?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},Zl=function(){function dt(it){var zt=this;a3(this,dt),this.element=l3().createElement("div"),this.opacity=it.opacity,this.type=it.type,this.animate=it.animate,this.dismissible=it.dismissible,this.closeOnClick=it.closeOnClick,this.message=it.message,this.duration=it.duration,this.pauseOnHover=it.pauseOnHover,this.offsetTop=it.offsetTop,this.offsetBottom=it.offsetBottom,this.offsetLeft=it.offsetLeft,this.offsetRight=it.offsetRight,this.extraClasses=it.extraClasses;var Ln="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Lr=["notification",this.extraClasses];if(this.type&&Lr.push(this.type),this.animate&&this.animate.in){var f3="animate__".concat(this.animate.in),Ei=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Lr.push("animate__animated ".concat(f3," ").concat(Ei)),this.onAnimationEnd(function(){return zt.element.classList.remove(f3)})}if(this.element.className=Lr.join(" "),this.dismissible){var K2=l3().createElement("button");K2.className="delete",K2.addEventListener("click",function(){zt.destroy()}),this.element.insertAdjacentElement("afterbegin",K2)}else Ln+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){zt.destroy()}),this.element.setAttribute("style",Ln),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var Yl=new fa(function(){zt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){Yl.pause()}),this.element.addEventListener("mouseout",function(){Yl.resume()}))}return Mn(dt,[{key:"destroy",value:function(){var it=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){it.removeParent(it.element.parentNode),it.element.remove(),delete Oo.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete Oo.position)}},{key:"removeParent",value:function(it){it&&1>=it.children.length&&it.remove()}},{key:"onAnimationEnd",value:function(){var it=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},zt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var Ln in zt)if(void 0!==this.element.style[Ln]){this.element.addEventListener(zt[Ln],function(){return it()});break}}}]),dt}(),fa=function(){function dt(it,zt){a3(this,dt),this.remaining=zt,this.callback=it,this.resume()}return Mn(dt,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),dt}();Po.resetDefaults=function(){Ss=To({},jl)},Po.setDefaults=function(dt){Ss=To(To({},jl),dt)},Po.setDoc=function ec(dt){for(var it in Oo)Oo[it].remove();Oo={},U0=dt},Po.toast=function T4(dt){if(!dt.message)throw new Error("message is required");var it=To(To({},Ss),dt),zt=new Zl(it),Ln=function u3(dt,it,zt,Ln,Lr,f3){if(Oo.position)return Oo.position;var Ei=l3().createElement("div");return Ei.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+Vu(it,zt,Ln,Lr,f3)),dt.appendChild(Ei),Oo.position=Ei,Ei}(it.appendTo||l3().body,it.position||Ss.position,it.offsetTop||Ss.offsetTop,it.offsetBottom||Ss.offsetBottom,it.offsetLeft||Ss.offsetLeft,it.offsetRight||Ss.offsetRight);if(it.single)for(var Lr=Ln.lastElementChild;Lr;)Ln.removeChild(Lr),Lr=Ln.lastElementChild;Ln.appendChild(zt.element)},Object.defineProperty(Po,"__esModule",{value:!0})}(B0)},522:(Hu,B0,Po)=>{"use strict";Po.d(B0,{XJ:()=>Bu,pQ:()=>Wu});const yn=":",To="|",a3="@@",c3="\u241f";class Mn{static zero(){return new Mn([0])}static one(){return new Mn([1])}constructor(ie){this.digits=ie}clone(){return new Mn(this.digits.slice())}add(ie){const me=this.clone();return me.addToSelf(ie),me}addToSelf(ie){const me=Math.max(this.digits.length,ie.digits.length);let Se=0;for(let Ye=0;Ye<me;Ye++){let st=Se;Ye<this.digits.length&&(st+=this.digits[Ye]),Ye<ie.digits.length&&(st+=ie.digits[Ye]),st>=10?(this.digits[Ye]=st-10,Se=1):(this.digits[Ye]=st,Se=0)}Se>0&&(this.digits[me]=1)}toString(){let ie="";for(let me=this.digits.length-1;me>=0;me--)ie+=this.digits[me];return ie}}class ql{constructor(ie){this.powerOfTwos=[ie]}getValue(){return this.powerOfTwos[0]}multiplyBy(ie){const me=Mn.zero();return this.multiplyByAndAddTo(ie,me),me}multiplyByAndAddTo(ie,me){for(let Se=0;0!==ie;ie>>>=1,Se++)if(1&ie){const Ye=this.getMultipliedByPowerOfTwo(Se);me.addToSelf(Ye)}}getMultipliedByPowerOfTwo(ie){for(let me=this.powerOfTwos.length;me<=ie;me++){const Se=this.powerOfTwos[me-1];this.powerOfTwos[me]=Se.add(Se)}return this.powerOfTwos[ie]}}class l3{constructor(ie){this.base=ie,this.exponents=[new ql(Mn.one())]}toThePowerOf(ie){for(let me=this.exponents.length;me<=ie;me++){const Se=this.exponents[me-1].multiplyBy(this.base);this.exponents[me]=new ql(Se)}return this.exponents[ie]}}let u3;function zt(ae){u3??=new TextEncoder;const ie=u3.encode(ae),me=new DataView(ie.buffer,ie.byteOffset,ie.byteLength);let Se=Lr(me,ie.length,0),Ye=Lr(me,ie.length,102072);return 0==Se&&(0==Ye||1==Ye)&&(Se^=319790063,Ye^=-1801410264),[Se,Ye]}function Lr(ae,ie,me){let Se=2654435769,Ye=2654435769,st=0;const o2=ie-12;for(;st<=o2;st+=12){Se+=ae.getUint32(st,!0),Ye+=ae.getUint32(st+4,!0);const r1=f3(Se,Ye,me+=ae.getUint32(st+8,!0));Se=r1[0],Ye=r1[1],me=r1[2]}const n1=ie-st;return me+=ie,n1>=4?(Se+=ae.getUint32(st,!0),st+=4,n1>=8?(Ye+=ae.getUint32(st,!0),st+=4,n1>=9&&(me+=ae.getUint8(st++)<<8),n1>=10&&(me+=ae.getUint8(st++)<<16),11===n1&&(me+=ae.getUint8(st++)<<24)):(n1>=5&&(Ye+=ae.getUint8(st++)),n1>=6&&(Ye+=ae.getUint8(st++)<<8),7===n1&&(Ye+=ae.getUint8(st++)<<16))):(n1>=1&&(Se+=ae.getUint8(st++)),n1>=2&&(Se+=ae.getUint8(st++)<<8),3===n1&&(Se+=ae.getUint8(st++)<<16)),f3(Se,Ye,me)[2]}function f3(ae,ie,me){return ae-=ie,ae-=me,ie-=me,ie-=ae^=me>>>13,me-=ae,me-=ie^=ae<<8,ae-=ie,ae-=me^=ie>>>13,ie-=me,ie-=ae^=me>>>12,me-=ae,me-=ie^=ae<<16,ae-=ie,ae-=me^=ie>>>5,ie-=me,ie-=ae^=me>>>3,me-=ae,me-=ie^=ae<<10,[ae,ie,me^=ie>>>15]}function K2(ae,ie){return Yl(ae,ie)[1]}function Yl(ae,ie){const me=(65535&ae)+(65535&ie),Se=(ae>>>16)+(ie>>>16)+(me>>>16);return[Se>>>16,Se<<16|65535&me]}const b1=new l3(256);function ty(ae,ie,me,Se,Ye=[]){const st={},o2={},n1={},r1=function ny(ae,ie){const{text:me,block:Se}=Ps(ae,ie);if(void 0===Se)return{text:me};{const[Ye,...st]=Se.split(c3),[o2,n1]=Ye.split(a3,2);let[r1,T2]=o2.split(To,2);return void 0===T2&&(T2=r1,r1=void 0),""===T2&&(T2=void 0),{text:me,meaning:r1,description:T2,customId:n1,legacyIds:st}}}(ae[0],ae.raw[0]),T2=[r1.text],O4=[];let Kl=r1.text;for(let Ys=1;Ys<ae.length;Ys++){const{messagePart:Xl,placeholderName:Xr=ah(Ys),associatedMessageId:Ql}=ry(ae[Ys],ae.raw[Ys]);Kl+=`{$${Xr}}${Xl}`,void 0!==ie&&(st[Xr]=ie[Ys-1],o2[Xr]=Ye[Ys-1]),O4.push(Xr),void 0!==Ql&&(n1[Xr]=Ql),T2.push(Xl)}const Zs=r1.customId||function Ln(ae,ie=""){let me=zt(ae);if(ie){const st=zt(ie);me=function Fu(ae,ie){const me=ae[0],Ye=ie[0],o2=Yl(ae[1],ie[1]),n1=o2[0],r1=o2[1];return[K2(K2(me,Ye),n1),r1]}(function Gu(ae,ie){const me=ae[0],Se=ae[1];return[me<<ie|Se>>>32-ie,Se<<ie|me>>>32-ie]}(me,1),st)}return function oh(ae,ie){const me=b1.toThePowerOf(0).multiplyBy(ie);return b1.toThePowerOf(4).multiplyByAndAddTo(ae,me),me.toString()}(2147483647&me[0],me[1])}(Kl,r1.meaning||""),q0=r1.legacyIds?r1.legacyIds.filter(Ys=>Ys!==Zs):[];return{id:Zs,legacyIds:q0,substitutions:st,substitutionLocations:o2,text:Kl,customId:r1.customId,meaning:r1.meaning||"",description:r1.description||"",messageParts:T2,messagePartLocations:Se,placeholderNames:O4,associatedMessageIds:n1,location:me}}function ry(ae,ie){const{text:me,block:Se}=Ps(ae,ie);if(void 0===Se)return{messagePart:me};{const[Ye,st]=Se.split(a3);return{messagePart:me,placeholderName:Ye,associatedMessageId:st}}}function Ps(ae,ie){if(ie.charAt(0)!==yn)return{text:ae};{const me=Qi(ae,ie);return{block:ae.substring(1,me),text:ae.substring(me+1)}}}function ah(ae){return 1===ae?"PH":"PH_"+(ae-1)}function Qi(ae,ie){for(let me=1,Se=1;me<ae.length;me++,Se++)if("\\"===ie[Se])Se++;else if(ae[me]===yn)return me;throw new Error(`Unterminated $localize metadata block in "${ie}".`)}class ch extends Error{constructor(ie){super(`No translation found for ${lh(ie)}.`),this.parsedMessage=ie,this.type="MissingTranslationError"}}function W0(ae,ie){return Object.defineProperty(ae,"raw",{value:ie}),ae}function lh(ae){const ie=ae.meaning&&` - "${ae.meaning}"`,me=ae.legacyIds&&ae.legacyIds.length>0?` [${ae.legacyIds.map(Se=>`"${Se}"`).join(", ")}]`:"";return`"${ae.id}"${me} ("${ae.text}"${ie})`}function Bu(ae){$localize.translate||($localize.translate=sy),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(ae).forEach(ie=>{$localize.TRANSLATIONS[ie]=function iy(ae){const ie=ae.split(/{\$([^}]*)}/),me=[ie[0]],Se=[];for(let st=1;st<ie.length-1;st+=2)Se.push(ie[st]),me.push(`${ie[st+1]}`);const Ye=me.map(st=>st.charAt(0)===yn?"\\"+st:st);return{text:ae,messageParts:W0(me,Ye),placeholderNames:Se}}(ae[ie])})}function sy(ae,ie){try{return function Cr(ae,ie,me){const Se=ty(ie,me);let Ye=ae[Se.id];if(void 0!==Se.legacyIds)for(let st=0;st<Se.legacyIds.length&&void 0===Ye;st++)Ye=ae[Se.legacyIds[st]];if(void 0===Ye)throw new ch(Se);return[Ye.messageParts,Ye.placeholderNames.map(st=>{if(Se.substitutions.hasOwnProperty(st))return Se.substitutions[st];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${lh(Se)}.\nThe translation contains a placeholder with name ${st}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,ae,ie)}catch(me){return console.warn(me.message),[ae,ie]}}const Wu=function(ae,...ie){if(Wu.translate){const Se=Wu.translate(ae,ie);ae=Se[0],ie=Se[1]}let me=oy(ae[0],ae.raw[0]);for(let Se=1;Se<ae.length;Se++)me+=ie[Se-1]+oy(ae[Se],ae.raw[Se]);return me},bR=":";function oy(ae,ie){return ie.charAt(0)===bR?ae.substring(Qi(ae,ie)+1):ae}}},Hu=>{Hu(Hu.s=2052)}]);