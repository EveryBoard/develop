(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{9219:(Iu,L0,Eo)=>{"use strict";function Mn(r){return"function"==typeof r}function So(r){const t=r(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const e3=So(r=>function(t){r(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,i)=>`${i+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function t3(r,e){if(r){const t=r.indexOf(e);0<=t&&r.splice(t,1)}}class En{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Mn(n))try{n()}catch(s){e=s instanceof e3?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{r3(s)}catch(o){e=e??[],o instanceof e3?e=[...e,...o.errors]:e.push(o)}}if(e)throw new e3(e)}}add(e){var t;if(e&&e!==this)if(this.closed)r3(e);else{if(e instanceof En){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&t3(t,e)}remove(e){const{_finalizers:t}=this;t&&t3(t,e),e instanceof En&&e._removeParent(this)}}En.EMPTY=(()=>{const r=new En;return r.closed=!0,r})();const Dl=En.EMPTY;function n3(r){return r instanceof En||r&&"closed"in r&&Mn(r.remove)&&Mn(r.add)&&Mn(r.unsubscribe)}function r3(r){Mn(r)?r():r.unsubscribe()}const Ka={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},m4={setTimeout(r,e,...t){const{delegate:n}=m4;return n?.setTimeout?n.setTimeout(r,e,...t):setTimeout(r,e,...t)},clearTimeout(r){const{delegate:e}=m4;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function Hl(r){m4.setTimeout(()=>{const{onUnhandledError:e}=Ka;if(!e)throw r;e(r)})}function ys(){}const Po=Vl("C",void 0,void 0);function Vl(r,e,t){return{kind:r,value:e,error:t}}let sa=null;function ht(r){if(Ka.useDeprecatedSynchronousErrorHandling){const e=!sa;if(e&&(sa={errorThrown:!1,error:null}),r(),e){const{errorThrown:t,error:n}=sa;if(sa=null,t)throw n}}else r()}class zt extends En{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,n3(e)&&e.add(this)):this.destination=Lu}static create(e,t,n){return new vi(e,t,n)}next(e){this.isStopped?xu(function ku(r){return Vl("N",r,void 0)}(e),this):this._next(e)}error(e){this.isStopped?xu(function R0(r){return Vl("E",void 0,r)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?xu(Po,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const kn=Function.prototype.bind;function br(r,e){return kn.call(r,e)}class i3{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){q2(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){q2(n)}else q2(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){q2(t)}}}class vi extends zt{constructor(e,t,n){let i;if(super(),Mn(e)||!e)i={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Ka.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&br(e.next,s),error:e.error&&br(e.error,s),complete:e.complete&&br(e.complete,s)}):i=e}this.destination=new i3(i)}}function q2(r){Ka.useDeprecatedSynchronousErrorHandling?function st(r){Ka.useDeprecatedSynchronousErrorHandling&&sa&&(sa.errorThrown=!0,sa.error=r)}(r):Hl(r)}function xu(r,e){const{onStoppedNotification:t}=Ka;t&&m4.setTimeout(()=>t(r,e))}const Lu={closed:!0,next:ys,error:function Fl(r){throw r},complete:ys},Ru="function"==typeof Symbol&&Symbol.observable||"@@observable";function Xa(r){return r}function th(r){return 0===r.length?Xa:1===r.length?r[0]:function(t){return r.reduce((n,i)=>i(n),t)}}let S1=(()=>{class r{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new r;return n.source=this,n.operator=t,n}subscribe(t,n,i){const s=function ty(r){return r&&r instanceof zt||function ey(r){return r&&Mn(r.next)&&Mn(r.error)&&Mn(r.complete)}(r)&&n3(r)}(t)?t:new vi(t,n,i);return ht(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=nh(n))((i,s)=>{const o=new vi({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Ru](){return this}pipe(...t){return th(t)(this)}toPromise(t){return new(t=nh(t))((n,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>n(s))})}}return r.create=e=>new r(e),r})();function nh(r){var e;return null!==(e=r??Ka.Promise)&&void 0!==e?e:Promise}const ny=So(r=>function(){r(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ms=(()=>{class r extends S1{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new rh(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new ny}next(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:i,observers:s}=this;return n||i?Dl:(this.currentObservers=null,s.push(t),new En(()=>{this.currentObservers=null,t3(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:i,isStopped:s}=this;n?t.error(i):s&&t.complete()}asObservable(){const t=new S1;return t.source=this,t}}return r.create=(e,t)=>new rh(e,t),r})();class rh extends Ms{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Dl}}class Zi extends Ms{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}function ih(r){return Mn(r?.lift)}function Wr(r){return e=>{if(ih(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function dr(r,e,t,n,i){return new ry(r,e,t,n,i)}class ry extends zt{constructor(e,t,n,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Un(r,e){return Wr((t,n)=>{let i=0;t.subscribe(dr(n,s=>{n.next(r.call(e,s,i++))}))})}function Du(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(null!=r&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]])}return t}function Gs(r){return this instanceof Gs?(this.v=r,this):new Gs(r)}function Bl(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=r[Symbol.asyncIterator];return e?e.call(r):(r=function Qn(r){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&"number"==typeof r.length)return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(r),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(o){return new Promise(function(a,c){!function i(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}(a,c,(o=r[s](o)).done,o.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const NR=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function AR(r){return Mn(r?.then)}function IR(r){return Mn(r[Ru])}function kR(r){return Symbol.asyncIterator&&Mn(r?.[Symbol.asyncIterator])}function xR(r){return new TypeError(`You provided ${null!==r&&"object"==typeof r?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const LR=function j3e(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function RR(r){return Mn(r?.[LR])}function zR(r){return function D0(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=t.apply(r,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(m){n[m]&&(i[m]=function(M){return new Promise(function(w,L){s.push([m,M,w,L])>1||a(m,M)})})}function a(m,M){try{!function c(m){m.value instanceof Gs?Promise.resolve(m.value.v).then(l,f):d(s[0][2],m)}(n[m](M))}catch(w){d(s[0][3],w)}}function l(m){a("next",m)}function f(m){a("throw",m)}function d(m,M){m(M),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,function*(){const t=r.getReader();try{for(;;){const{value:n,done:i}=yield Gs(t.read());if(i)return yield Gs(void 0);yield yield Gs(n)}}finally{t.releaseLock()}})}function DR(r){return Mn(r?.getReader)}function Ws(r){if(r instanceof S1)return r;if(null!=r){if(IR(r))return function Z3e(r){return new S1(e=>{const t=r[Ru]();if(Mn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(r);if(NR(r))return function Y3e(r){return new S1(e=>{for(let t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()})}(r);if(AR(r))return function K3e(r){return new S1(e=>{r.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Hl)})}(r);if(kR(r))return HR(r);if(RR(r))return function X3e(r){return new S1(e=>{for(const t of r)if(e.next(t),e.closed)return;e.complete()})}(r);if(DR(r))return function Q3e(r){return HR(zR(r))}(r)}throw xR(r)}function HR(r){return new S1(e=>{(function J3e(r,e){var t,n,i,s;return function Se(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Bl(r);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){i={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(r,e).catch(t=>e.error(t))})}function s3(r,e,t,n=0,i=!1){const s=e.schedule(function(){t(),i?r.add(this.schedule(null,n)):this.unsubscribe()},n);if(r.add(s),!i)return s}function j2(r,e,t=1/0){return Mn(e)?j2((n,i)=>Un((s,o)=>e(n,s,i,o))(Ws(r(n,i))),t):("number"==typeof e&&(t=e),Wr((n,i)=>function e4e(r,e,t,n,i,s,o,a){const c=[];let l=0,f=0,d=!1;const m=()=>{d&&!c.length&&!l&&e.complete()},M=L=>l<n?w(L):c.push(L),w=L=>{s&&e.next(L),l++;let z=!1;Ws(t(L,f++)).subscribe(dr(e,$=>{i?.($),s?M($):e.next($)},()=>{z=!0},void 0,()=>{if(z)try{for(l--;c.length&&l<n;){const $=c.shift();o?s3(e,o,()=>w($)):w($)}m()}catch($){e.error($)}}))};return r.subscribe(dr(e,M,()=>{d=!0,m()})),()=>{a?.()}}(n,i,r,t)))}function H0(r=1/0){return j2(Xa,r)}const Qa=new S1(r=>r.complete());function ly(r){return r[r.length-1]}function VR(r){return Mn(ly(r))?r.pop():void 0}function Vu(r){return function n4e(r){return r&&Mn(r.schedule)}(ly(r))?r.pop():void 0}function oh(r,e=0){return Wr((t,n)=>{t.subscribe(dr(n,i=>s3(n,r,()=>n.next(i),e),()=>s3(n,r,()=>n.complete(),e),i=>s3(n,r,()=>n.error(i),e)))})}function ah(r,e=0){return Wr((t,n)=>{n.add(r.schedule(()=>t.subscribe(n),e))})}function FR(r,e){if(!r)throw new Error("Iterable cannot be null");return new S1(t=>{s3(t,e,()=>{const n=r[Symbol.asyncIterator]();s3(t,e,()=>{n.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function t2(r,e){return e?function l4e(r,e){if(null!=r){if(IR(r))return function i4e(r,e){return Ws(r).pipe(ah(e),oh(e))}(r,e);if(NR(r))return function o4e(r,e){return new S1(t=>{let n=0;return e.schedule(function(){n===r.length?t.complete():(t.next(r[n++]),t.closed||this.schedule())})})}(r,e);if(AR(r))return function s4e(r,e){return Ws(r).pipe(ah(e),oh(e))}(r,e);if(kR(r))return FR(r,e);if(RR(r))return function a4e(r,e){return new S1(t=>{let n;return s3(t,e,()=>{n=r[LR](),s3(t,e,()=>{let i,s;try{({value:i,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>Mn(n?.return)&&n.return()})}(r,e);if(DR(r))return function c4e(r,e){return FR(zR(r),e)}(r,e)}throw xR(r)}(r,e):Ws(r)}function Dt(...r){return t2(r,Vu(r))}function $R(r={}){const{connector:e=(()=>new Ms),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:i=!0}=r;return s=>{let o,a,c,l=0,f=!1,d=!1;const m=()=>{a?.unsubscribe(),a=void 0},M=()=>{m(),o=c=void 0,f=d=!1},w=()=>{const L=o;M(),L?.unsubscribe()};return Wr((L,z)=>{l++,!d&&!f&&m();const $=c=c??e();z.add(()=>{l--,0===l&&!d&&!f&&(a=uy(w,i))}),$.subscribe(z),!o&&l>0&&(o=new vi({next:B=>$.next(B),error:B=>{d=!0,m(),a=uy(M,t,B),$.error(B)},complete:()=>{f=!0,m(),a=uy(M,n),$.complete()}}),Ws(L).subscribe(o))})(s)}}function uy(r,e,...t){if(!0===e)return void r();if(!1===e)return;const n=new vi({next:()=>{n.unsubscribe(),r()}});return Ws(e(...t)).subscribe(n)}function oa(r,e){return Wr((t,n)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&n.complete();t.subscribe(dr(n,c=>{i?.unsubscribe();let l=0;const f=s++;Ws(r(c,f)).subscribe(i=dr(n,d=>n.next(e?e(c,d,f,l++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function d4e(r,e){return r===e}function r1(r){for(let e in r)if(r[e]===r1)return e;throw Error("Could not find renamed property on target object.")}function ch(r,e){for(const t in e)e.hasOwnProperty(t)&&!r.hasOwnProperty(t)&&(r[t]=e[t])}function n2(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(n2).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const e=r.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function fy(r,e){return null==r||""===r?null===e?"":e:null==e||""===e?r:r+" "+e}const h4e=r1({__forward_ref__:r1});function P1(r){return r.__forward_ref__=P1,r.toString=function(){return n2(this())},r}function $t(r){return dy(r)?r():r}function dy(r){return"function"==typeof r&&r.hasOwnProperty(h4e)&&r.__forward_ref__===P1}function hy(r){return r&&!!r.\u0275providers}const BR="https://g.co/ng/security#xss";class ge extends Error{constructor(e,t){super(function lh(r,e){return`NG0${Math.abs(r)}${e?": "+e:""}`}(e,t)),this.code=e}}function qt(r){return"string"==typeof r?r:null==r?"":String(r)}function py(r,e){throw new ge(-201,!1)}function Ht(r,e,t,n){throw new Error(`ASSERTION ERROR: ${r}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function De(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Z2(r){return{providers:r.providers||[],imports:r.imports||[]}}function uh(r){return GR(r,dh)||GR(r,UR)}function GR(r,e){return r.hasOwnProperty(e)?r[e]:null}function fh(r){return r&&(r.hasOwnProperty(gy)||r.hasOwnProperty(M4e))?r[gy]:null}const dh=r1({\u0275prov:r1}),gy=r1({\u0275inj:r1}),UR=r1({ngInjectableDef:r1}),M4e=r1({ngInjectorDef:r1});var cn=function(r){return r[r.Default=0]="Default",r[r.Host=1]="Host",r[r.Self=2]="Self",r[r.SkipSelf=4]="SkipSelf",r[r.Optional=8]="Optional",r}(cn||{});let my;function Es(r){const e=my;return my=r,e}function qR(r,e,t){const n=uh(r);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&cn.Optional?null:void 0!==e?e:void py(n2(r))}const p1=globalThis,Fu={},My="__NG_DI_FLAG__",hh="ngTempTokenPath",P4e=/\n/gm,ZR="__source";let V0;function v4(r){const e=V0;return V0=r,e}function b4e(r,e=cn.Default){if(void 0===V0)throw new ge(-203,!1);return null===V0?qR(r,void 0,e):V0.get(r,e&cn.Optional?null:void 0,e)}function Pe(r,e=cn.Default){return(function WR(){return my}()||b4e)($t(r),e)}function rt(r,e=cn.Default){return Pe(r,ph(e))}function ph(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function Ey(r){const e=[];for(let t=0;t<r.length;t++){const n=$t(r[t]);if(Array.isArray(n)){if(0===n.length)throw new ge(900,!1);let i,s=cn.Default;for(let o=0;o<n.length;o++){const a=n[o],c=w4e(a);"number"==typeof c?-1===c?i=a.token:s|=c:i=a}e.push(Pe(i,s))}else e.push(Pe(n))}return e}function $u(r,e){return r[My]=e,r.prototype[My]=e,r}function w4e(r){return r[My]}function o3(r){return{toString:r}.toString()}var gh=function(r){return r[r.OnPush=0]="OnPush",r[r.Default=1]="Default",r}(gh||{}),Oo=function(r){return r[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",r}(Oo||{});const Ja={},Wn=[],mh=r1({\u0275cmp:r1}),Sy=r1({\u0275dir:r1}),Py=r1({\u0275pipe:r1}),KR=r1({\u0275mod:r1}),a3=r1({\u0275fac:r1}),Bu=r1({__NG_ELEMENT_ID__:r1}),XR=r1({__NG_ENV_ID__:r1});function QR(r,e,t){let n=r.length;for(;;){const i=r.indexOf(e,t);if(-1===i)return i;if(0===i||r.charCodeAt(i-1)<=32){const s=e.length;if(i+s===n||r.charCodeAt(i+s)<=32)return i}t=i+1}}function Ty(r,e,t){let n=0;for(;n<t.length;){const i=t[n];if("number"==typeof i){if(0!==i)break;n++;const s=t[n++],o=t[n++],a=t[n++];r.setAttribute(e,o,a,s)}else{const s=i,o=t[++n];ez(s)?r.setProperty(e,s,o):r.setAttribute(e,s,o),n++}}return n}function JR(r){return 3===r||4===r||6===r}function ez(r){return 64===r.charCodeAt(0)}function Gu(r,e){if(null!==e&&0!==e.length)if(null===r||0===r.length)r=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t=i:0===t||tz(r,t,i,null,-1===t||2===t?e[++n]:null)}}return r}function tz(r,e,t,n,i){let s=0,o=r.length;if(-1===e)o=-1;else for(;s<r.length;){const a=r[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<r.length;){const a=r[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==i&&(r[s+1]=i));if(n===r[s+1])return void(r[s+2]=i)}s++,null!==n&&s++,null!==i&&s++}-1!==o&&(r.splice(o,0,e),s=o+1),r.splice(s++,0,t),null!==n&&r.splice(s++,0,n),null!==i&&r.splice(s++,0,i)}const nz="ng-template";function I4e(r,e,t){let n=0,i=!0;for(;n<r.length;){let s=r[n++];if("string"==typeof s&&i){const o=r[n++];if(t&&"class"===s&&-1!==QR(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;n<r.length&&"string"==typeof(s=r[n++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function rz(r){return 4===r.type&&r.value!==nz}function k4e(r,e,t){return e===(4!==r.type||t?r.value:nz)}function x4e(r,e,t){let n=4;const i=r.attrs||[],s=function z4e(r){for(let e=0;e<r.length;e++)if(JR(r[e]))return e;return r.length}(i);let o=!1;for(let a=0;a<e.length;a++){const c=e[a];if("number"!=typeof c){if(!o)if(4&n){if(n=2|1&n,""!==c&&!k4e(r,c,t)||""===c&&1===e.length){if(aa(n))return!1;o=!0}}else{const l=8&n?c:e[++a];if(8&n&&null!==r.attrs){if(!I4e(r.attrs,l,t)){if(aa(n))return!1;o=!0}continue}const d=L4e(8&n?"class":c,i,rz(r),t);if(-1===d){if(aa(n))return!1;o=!0;continue}if(""!==l){let m;m=d>s?"":i[d+1].toLowerCase();const M=8&n?m:null;if(M&&-1!==QR(M,l,0)||2&n&&l!==m){if(aa(n))return!1;o=!0}}}}else{if(!o&&!aa(n)&&!aa(c))return!1;if(o&&aa(c))continue;o=!1,n=c|1&n}}return aa(n)||o}function aa(r){return 0==(1&r)}function L4e(r,e,t,n){if(null===e)return-1;let i=0;if(n||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===r)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function D4e(r,e){let t=r.indexOf(4);if(t>-1)for(t++;t<r.length;){const n=r[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,r)}function iz(r,e,t=!1){for(let n=0;n<e.length;n++)if(x4e(r,e[n],t))return!0;return!1}function H4e(r,e){e:for(let t=0;t<e.length;t++){const n=e[t];if(r.length===n.length){for(let i=0;i<r.length;i++)if(r[i]!==n[i])continue e;return!0}}return!1}function sz(r,e){return r?":not("+e.trim()+")":e}function V4e(r){let e=r[0],t=1,n=2,i="",s=!1;for(;t<r.length;){let o=r[t];if("string"==typeof o)if(2&n){const a=r[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?i+="."+o:4&n&&(i+=" "+o);else""!==i&&!aa(o)&&(e+=sz(s,i),i=""),n=o,s=s||!aa(n);t++}return""!==i&&(e+=sz(s,i)),e}function Xe(r){return o3(()=>{const e=az(r),t={...e,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===gh.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&r.dependencies||null,getStandaloneInjector:null,signals:r.signals??!1,data:r.data||{},encapsulation:r.encapsulation||Oo.Emulated,styles:r.styles||Wn,_:null,schemas:r.schemas||null,tView:null,id:""};cz(t);const n=r.dependencies;return t.directiveDefs=_h(n,!1),t.pipeDefs=_h(n,!0),t.id=function q4e(r){let e=0;const t=[r.selectors,r.ngContentSelectors,r.hostVars,r.hostAttrs,r.consts,r.vars,r.decls,r.encapsulation,r.standalone,r.signals,r.exportAs,JSON.stringify(r.inputs),JSON.stringify(r.outputs),Object.getOwnPropertyNames(r.type.prototype),!!r.contentQueries,!!r.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function Oy(r,e,t){const n=r.\u0275cmp;n.directiveDefs=_h(e,!1),n.pipeDefs=_h(t,!0)}function B4e(r){return xn(r)||Y2(r)}function G4e(r){return null!==r}function Ci(r){return o3(()=>({type:r.type,bootstrap:r.bootstrap||Wn,declarations:r.declarations||Wn,imports:r.imports||Wn,exports:r.exports||Wn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function oz(r,e){if(null==r)return Ja;const t={};for(const n in r)if(r.hasOwnProperty(n)){let i=r[n],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=n,e&&(e[i]=s)}return t}function Rt(r){return o3(()=>{const e=az(r);return cz(e),e})}function yi(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function xn(r){return r[mh]||null}function Y2(r){return r[Sy]||null}function Yi(r){return r[Py]||null}function js(r,e){const t=r[KR]||null;if(!t&&!0===e)throw new Error(`Type ${n2(r)} does not have '\u0275mod' property.`);return t}function az(r){const e={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:r.inputs||Ja,exportAs:r.exportAs||null,standalone:!0===r.standalone,signals:!0===r.signals,selectors:r.selectors||Wn,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:oz(r.inputs,e),outputs:oz(r.outputs)}}function cz(r){r.features?.forEach(e=>e(r))}function _h(r,e){if(!r)return null;const t=e?Yi:B4e;return()=>("function"==typeof r?r():r).map(n=>t(n)).filter(G4e)}const wr=0,et=1,Kt=2,q1=3,ca=4,Uu=5,Mi=6,$0=7,Nr=8,C4=9,B0=10,jt=11,Wu=12,lz=13,G0=14,Ar=15,qu=16,U0=17,ec=18,ju=19,uz=20,y4=21,c3=22,vh=23,Ch=24,mn=25,by=1,fz=2,tc=7,W0=9,K2=11;function Ss(r){return Array.isArray(r)&&"object"==typeof r[by]}function Ps(r){return Array.isArray(r)&&!0===r[by]}function wy(r){return 0!=(4&r.flags)}function Wl(r){return r.componentOffset>-1}function Mh(r){return 1==(1&r.flags)}function la(r){return!!r.template}function Ny(r){return 0!=(512&r[Kt])}function ql(r,e){return r.hasOwnProperty(a3)?r[a3]:null}let Q4e=p1.WeakRef??class X4e{constructor(e){this.ref=e}deref(){return this.ref}},ele=0,nc=null,Eh=!1;function E2(r){const e=nc;return nc=r,e}class mz{constructor(){this.id=ele++,this.ref=function J4e(r){return new Q4e(r)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[e,t]of this.producers){const n=t.producerNode.deref();if(null!=n&&t.atTrackingVersion===this.trackingVersion){if(n.producerPollStatus(t.seenValueVersion))return!0}else this.producers.delete(e),n?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const e=Eh;Eh=!0;try{for(const[t,n]of this.consumers){const i=n.consumerNode.deref();null!=i&&i.trackingVersion===n.atTrackingVersion?i.onConsumerDependencyMayHaveChanged():(this.consumers.delete(t),i?.producers.delete(this.id))}}finally{Eh=e}}producerAccessed(){if(Eh)throw new Error("");if(null===nc)return;let e=nc.producers.get(this.id);void 0===e?(e={consumerNode:nc.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:nc.trackingVersion},nc.producers.set(this.id,e),this.consumers.set(nc.id,e)):(e.seenValueVersion=this.valueVersion,e.atTrackingVersion=nc.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==nc?.consumerAllowSignalWrites}producerPollStatus(e){return this.valueVersion!==e||(this.onProducerUpdateValueVersion(),this.valueVersion!==e)}}let _z=null;const Cz=()=>{};class ile extends mz{constructor(e,t,n){super(),this.watch=e,this.schedule=t,this.dirty=!1,this.cleanupFn=Cz,this.registerOnCleanup=i=>{this.cleanupFn=i},this.consumerAllowSignalWrites=n}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const e=E2(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=Cz,this.watch(this.registerOnCleanup)}finally{E2(e)}}cleanup(){this.cleanupFn()}}class sle{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function Ki(){return yz}function yz(r){return r.type.prototype.ngOnChanges&&(r.setInput=ale),ole}function ole(){const r=Ez(this),e=r?.current;if(e){const t=r.previous;if(t===Ja)r.previous=e;else for(let n in e)t[n]=e[n];r.current=null,this.ngOnChanges(e)}}function ale(r,e,t,n){const i=this.declaredInputs[t],s=Ez(r)||function cle(r,e){return r[Mz]=e}(r,{previous:Ja,current:null}),o=s.current||(s.current={}),a=s.previous,c=a[i];o[i]=new sle(c&&c.currentValue,e,a===Ja),r[n]=e}Ki.ngInherit=!0;const Mz="__ngSimpleChanges__";function Ez(r){return r[Mz]||null}const rc=function(r,e,t){},Sz="svg";function T1(r){for(;Array.isArray(r);)r=r[wr];return r}function Th(r,e){return T1(e[r])}function Ts(r,e){return T1(e[r.index])}function Tz(r,e){return r.data[e]}function q0(r,e){return r[e]}function Zs(r,e){const t=e[r];return Ss(t)?t:t[wr]}function M4(r,e){return null==e?null:r[e]}function Oz(r){r[U0]=0}function gle(r){1024&r[Kt]||(r[Kt]|=1024,wz(r,1))}function bz(r){1024&r[Kt]&&(r[Kt]&=-1025,wz(r,-1))}function wz(r,e){let t=r[q1];if(null===t)return;t[Uu]+=e;let n=t;for(t=t[q1];null!==t&&(1===e&&1===n[Uu]||-1===e&&0===n[Uu]);)t[Uu]+=e,n=t,t=t[q1]}const Vt={lFrame:Vz(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Iz(){return Vt.bindingsEnabled}function j0(){return null!==Vt.skipHydrationRootTNode}function Ee(){return Vt.lFrame.lView}function Ln(){return Vt.lFrame.tView}function te(r){return Vt.lFrame.contextLView=r,r[Nr]}function ne(r){return Vt.lFrame.contextLView=null,r}function X2(){let r=kz();for(;null!==r&&64===r.type;)r=r.parent;return r}function kz(){return Vt.lFrame.currentTNode}function Yu(){const r=Vt.lFrame,e=r.currentTNode;return r.isParent?e:e.parent}function ic(r,e){const t=Vt.lFrame;t.currentTNode=r,t.isParent=e}function Ry(){return Vt.lFrame.isParent}function zy(){Vt.lFrame.isParent=!1}function Xi(){const r=Vt.lFrame;let e=r.bindingRootIndex;return-1===e&&(e=r.bindingRootIndex=r.tView.bindingStartIndex),e}function l3(){return Vt.lFrame.bindingIndex}function Z0(){return Vt.lFrame.bindingIndex++}function u3(r){const e=Vt.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+r,t}function Rz(r){Vt.lFrame.inI18n=r}function ble(r,e){const t=Vt.lFrame;t.bindingIndex=t.bindingRootIndex=r,Dy(e)}function Dy(r){Vt.lFrame.currentDirectiveIndex=r}function zz(){return Vt.lFrame.currentQueryIndex}function Vy(r){Vt.lFrame.currentQueryIndex=r}function Nle(r){const e=r[et];return 2===e.type?e.declTNode:1===e.type?r[Mi]:null}function Dz(r,e,t){if(t&cn.SkipSelf){let i=e,s=r;for(;!(i=i.parent,null!==i||t&cn.Host||(i=Nle(s),null===i||(s=s[G0],10&i.type))););if(null===i)return!1;e=i,r=s}const n=Vt.lFrame=Hz();return n.currentTNode=e,n.lView=r,!0}function Fy(r){const e=Hz(),t=r[et];Vt.lFrame=e,e.currentTNode=t.firstChild,e.lView=r,e.tView=t,e.contextLView=r,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Hz(){const r=Vt.lFrame,e=null===r?null:r.child;return null===e?Vz(r):e}function Vz(r){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=e),e}function Fz(){const r=Vt.lFrame;return Vt.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const $z=Fz;function $y(){const r=Fz();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function Qi(){return Vt.lFrame.selectedIndex}function jl(r){Vt.lFrame.selectedIndex=r}function tr(){const r=Vt.lFrame;return Tz(r.tView,r.selectedIndex)}function A(){Vt.lFrame.currentNamespace=Sz}let Gz=!0;function Oh(){return Gz}function E4(r){Gz=r}function bh(r,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=r.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:f}=s;o&&(r.contentHooks??=[]).push(-t,o),a&&((r.contentHooks??=[]).push(t,a),(r.contentCheckHooks??=[]).push(t,a)),c&&(r.viewHooks??=[]).push(-t,c),l&&((r.viewHooks??=[]).push(t,l),(r.viewCheckHooks??=[]).push(t,l)),null!=f&&(r.destroyHooks??=[]).push(t,f)}}function wh(r,e,t){Uz(r,e,3,t)}function Nh(r,e,t,n){(3&r[Kt])===t&&Uz(r,e,t,n)}function By(r,e){let t=r[Kt];(3&t)===e&&(t&=8191,t+=1,r[Kt]=t)}function Uz(r,e,t,n){const s=n??-1,o=e.length-1;let a=0;for(let c=void 0!==n?65535&r[U0]:0;c<o;c++)if("number"==typeof e[c+1]){if(a=e[c],null!=n&&a>=n)break}else e[c]<0&&(r[U0]+=65536),(a<s||-1==s)&&(zle(r,t,e,c),r[U0]=(4294901760&r[U0])+c+2),c++}function Wz(r,e){rc(4,r,e);const t=E2(null);try{e.call(r)}finally{E2(t),rc(5,r,e)}}function zle(r,e,t,n){const i=t[n]<0,s=t[n+1],a=r[i?-t[n]:t[n]];i?r[Kt]>>13<r[U0]>>16&&(3&r[Kt])===e&&(r[Kt]+=8192,Wz(a,s)):Wz(a,s)}const Y0=-1;class Ku{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function Uy(r){return r!==Y0}function Xu(r){return 32767&r}function Qu(r,e){let t=function Fle(r){return r>>16}(r),n=e;for(;t>0;)n=n[G0],t--;return n}let Wy=!0;function Ah(r){const e=Wy;return Wy=r,e}const qz=255,jz=5;let $le=0;const sc={};function Ih(r,e){const t=Zz(r,e);if(-1!==t)return t;const n=e[et];n.firstCreatePass&&(r.injectorIndex=e.length,qy(n.data,r),qy(e,null),qy(n.blueprint,null));const i=kh(r,e),s=r.injectorIndex;if(Uy(i)){const o=Xu(i),a=Qu(i,e),c=a[et].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function qy(r,e){r.push(0,0,0,0,0,0,0,0,e)}function Zz(r,e){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===e[r.injectorIndex+8]?-1:r.injectorIndex}function kh(r,e){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let t=0,n=null,i=e;for(;null!==i;){if(n=tD(i),null===n)return Y0;if(t++,i=i[G0],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return Y0}function jy(r,e,t){!function Ble(r,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Bu)&&(n=t[Bu]),null==n&&(n=t[Bu]=$le++);const i=n&qz;e.data[r+(i>>jz)]|=1<<i}(r,e,t)}function Yz(r,e,t){if(t&cn.Optional||void 0!==r)return r;py()}function Kz(r,e,t,n){if(t&cn.Optional&&void 0===n&&(n=null),!(t&(cn.Self|cn.Host))){const i=r[C4],s=Es(void 0);try{return i?i.get(e,n,t&cn.Optional):qR(e,n,t&cn.Optional)}finally{Es(s)}}return Yz(n,0,t)}function Xz(r,e,t,n=cn.Default,i){if(null!==r){if(2048&e[Kt]&&!(n&cn.Self)){const o=function Zle(r,e,t,n,i){let s=r,o=e;for(;null!==s&&null!==o&&2048&o[Kt]&&!(512&o[Kt]);){const a=Qz(s,o,t,n|cn.Self,sc);if(a!==sc)return a;let c=s.parent;if(!c){const l=o[uz];if(l){const f=l.get(t,sc,n);if(f!==sc)return f}c=tD(o),o=o[G0]}s=c}return i}(r,e,t,n,sc);if(o!==sc)return o}const s=Qz(r,e,t,n,sc);if(s!==sc)return s}return Kz(e,t,n,i)}function Qz(r,e,t,n,i){const s=function Wle(r){if("string"==typeof r)return r.charCodeAt(0)||0;const e=r.hasOwnProperty(Bu)?r[Bu]:void 0;return"number"==typeof e?e>=0?e&qz:jle:e}(t);if("function"==typeof s){if(!Dz(e,r,n))return n&cn.Host?Yz(i,0,n):Kz(e,t,n,i);try{let o;if(o=s(n),null!=o||n&cn.Optional)return o;py()}finally{$z()}}else if("number"==typeof s){let o=null,a=Zz(r,e),c=Y0,l=n&cn.Host?e[Ar][Mi]:null;for((-1===a||n&cn.SkipSelf)&&(c=-1===a?kh(r,e):e[a+8],c!==Y0&&eD(n,!1)?(o=e[et],a=Xu(c),e=Qu(c,e)):a=-1);-1!==a;){const f=e[et];if(Jz(s,a,f.data)){const d=Ule(a,e,t,o,n,l);if(d!==sc)return d}c=e[a+8],c!==Y0&&eD(n,e[et].data[a+8]===l)&&Jz(s,a,e)?(o=f,a=Xu(c),e=Qu(c,e)):a=-1}}return i}function Ule(r,e,t,n,i,s){const o=e[et],a=o.data[r+8],f=xh(a,o,t,null==n?Wl(a)&&Wy:n!=o&&0!=(3&a.type),i&cn.Host&&s===a);return null!==f?Zl(e,o,f,a):sc}function xh(r,e,t,n,i){const s=r.providerIndexes,o=e.data,a=1048575&s,c=r.directiveStart,f=s>>20,m=i?a+f:r.directiveEnd;for(let M=n?a:a+f;M<m;M++){const w=o[M];if(M<c&&t===w||M>=c&&w.type===t)return M}if(i){const M=o[c];if(M&&la(M)&&M.type===t)return c}return null}function Zl(r,e,t,n){let i=r[t];const s=e.data;if(function Dle(r){return r instanceof Ku}(i)){const o=i;o.resolving&&function p4e(r,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${r}`:"";throw new ge(-200,`Circular dependency in DI detected for ${r}${t}`)}(function e1(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():qt(r)}(s[t]));const a=Ah(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Es(o.injectImpl):null;Dz(r,n,cn.Default);try{i=r[t]=o.factory(void 0,s,r,n),e.firstCreatePass&&t>=n.directiveStart&&function Rle(r,e,t){const{ngOnChanges:n,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(n){const o=yz(e);(t.preOrderHooks??=[]).push(r,o),(t.preOrderCheckHooks??=[]).push(r,o)}i&&(t.preOrderHooks??=[]).push(0-r,i),s&&((t.preOrderHooks??=[]).push(r,s),(t.preOrderCheckHooks??=[]).push(r,s))}(t,s[t],e)}finally{null!==l&&Es(l),Ah(a),o.resolving=!1,$z()}}return i}function Jz(r,e,t){return!!(t[e+(r>>jz)]&1<<r)}function eD(r,e){return!(r&cn.Self||r&cn.Host&&e)}class Ji{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return Xz(this._tNode,this._lView,e,ph(n),t)}}function jle(){return new Ji(X2(),Ee())}function nr(r){return o3(()=>{const e=r.prototype.constructor,t=e[a3]||Zy(e),n=Object.prototype;let i=Object.getPrototypeOf(r.prototype).constructor;for(;i&&i!==n;){const s=i[a3]||Zy(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Zy(r){return dy(r)?()=>{const e=Zy($t(r));return e&&e()}:ql(r)}function tD(r){const e=r[et],t=e.type;return 2===t?e.declTNode:1===t?r[Mi]:null}const X0="__parameters__";function J0(r,e,t){return o3(()=>{const n=function Yy(r){return function(...t){if(r){const n=r(...t);for(const i in n)this[i]=n[i]}}}(e);function i(...s){if(this instanceof i)return n.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(c,l,f){const d=c.hasOwnProperty(X0)?c[X0]:Object.defineProperty(c,X0,{value:[]})[X0];for(;d.length<=f;)d.push(null);return(d[f]=d[f]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=r,i.annotationCls=i,i})}function t8(r,e){r.forEach(t=>Array.isArray(t)?t8(t,e):e(t))}function rD(r,e,t){e>=r.length?r.push(t):r.splice(e,0,t)}function Rh(r,e){return e>=r.length-1?r.pop():r.splice(e,1)[0]}function t7(r,e){const t=[];for(let n=0;n<r;n++)t.push(e);return t}function Ys(r,e,t){let n=n8(r,e);return n>=0?r[1|n]=t:(n=~n,function t6e(r,e,t,n){let i=r.length;if(i==e)r.push(t,n);else if(1===i)r.push(n,r[0]),r[0]=t;else{for(i--,r.push(r[i-1],r[i]);i>e;)r[i]=r[i-2],i--;r[e]=t,r[e+1]=n}}(r,n,e,t)),n}function Ky(r,e){const t=n8(r,e);if(t>=0)return r[1|t]}function n8(r,e){return function iD(r,e,t){let n=0,i=r.length>>t;for(;i!==n;){const s=n+(i-n>>1),o=r[s<<t];if(e===o)return s<<t;o>e?i=s:n=s+1}return~(i<<t)}(r,e,1)}const es=$u(J0("Optional"),8),Dh=$u(J0("SkipSelf"),4);function Bh(r){return 128==(128&r.flags)}var S4=function(r){return r[r.Important=1]="Important",r[r.DashCase=2]="DashCase",r}(S4||{});const E6e=/^>|^->|<!--|-->|--!>|<!-$/g,S6e=/(<|>)/,P6e="\u200b$1\u200b";const tM=new Map;let T6e=0;const rM="__ngContext__";function Ei(r,e){Ss(e)?(r[rM]=e[ju],function b6e(r){tM.set(r[ju],r)}(e)):r[rM]=e}let iM;function sM(r,e){return iM(r,e)}function i7(r){const e=r[q1];return Ps(e)?e[q1]:e}function PD(r){return OD(r[Wu])}function TD(r){return OD(r[ca])}function OD(r){for(;null!==r&&!Ps(r);)r=r[ca];return r}function s8(r,e,t,n,i){if(null!=n){let s,o=!1;Ps(n)?s=n:Ss(n)&&(o=!0,n=n[wr]);const a=T1(n);0===r&&null!==t?null==i?AD(e,t,a):Yl(e,t,a,i||null,!0):1===r&&null!==t?Yl(e,t,a,i||null,!0):2===r?Yh(e,a,o):3===r&&e.destroyNode(a),null!=s&&function Y6e(r,e,t,n,i){const s=t[tc];s!==T1(t)&&s8(e,r,n,s,i);for(let a=K2;a<t.length;a++){const c=t[a];o7(c[et],c,r,e,n,s)}}(e,r,s,t,i)}}function Uh(r,e){return r.createText(e)}function bD(r,e,t){r.setValue(e,t)}function oM(r,e){return r.createComment(function mD(r){return r.replace(E6e,e=>e.replace(S6e,P6e))}(e))}function Wh(r,e,t){return r.createElement(e,t)}function wD(r,e){const t=r[W0],n=t.indexOf(e);bz(e),t.splice(n,1)}function qh(r,e){if(r.length<=K2)return;const t=K2+e,n=r[t];if(n){const i=n[qu];null!==i&&i!==r&&wD(i,n),e>0&&(r[t-1][ca]=n[ca]);const s=Rh(r,K2+e);!function H6e(r,e){o7(r,e,e[jt],2,null,null),e[wr]=null,e[Mi]=null}(n[et],n);const o=s[ec];null!==o&&o.detachView(s[et]),n[q1]=null,n[ca]=null,n[Kt]&=-129}return n}function aM(r,e){if(!(256&e[Kt])){const t=e[jt];e[vh]?.destroy(),e[Ch]?.destroy(),t.destroyNode&&o7(r,e,t,3,null,null),function $6e(r){let e=r[Wu];if(!e)return cM(r[et],r);for(;e;){let t=null;if(Ss(e))t=e[Wu];else{const n=e[K2];n&&(t=n)}if(!t){for(;e&&!e[ca]&&e!==r;)Ss(e)&&cM(e[et],e),e=e[q1];null===e&&(e=r),Ss(e)&&cM(e[et],e),t=e&&e[ca]}e=t}}(e)}}function cM(r,e){if(!(256&e[Kt])){e[Kt]&=-129,e[Kt]|=256,function W6e(r,e){let t;if(null!=r&&null!=(t=r.destroyHooks))for(let n=0;n<t.length;n+=2){const i=e[t[n]];if(!(i instanceof Ku)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],c=s[o+1];rc(4,a,c);try{c.call(a)}finally{rc(5,a,c)}}else{rc(4,i,s);try{s.call(i)}finally{rc(5,i,s)}}}}}(r,e),function U6e(r,e){const t=r.cleanup,n=e[$0];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else t[s].call(n[t[s+1]]);null!==n&&(e[$0]=null);const i=e[y4];if(null!==i){e[y4]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(r,e),1===e[et].type&&e[jt].destroy();const t=e[qu];if(null!==t&&Ps(e[q1])){t!==e[q1]&&wD(t,e);const n=e[ec];null!==n&&n.detachView(r)}!function w6e(r){tM.delete(r[ju])}(e)}}function lM(r,e,t){return ND(r,e.parent,t)}function ND(r,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[wr];{const{componentOffset:i}=n;if(i>-1){const{encapsulation:s}=r.data[n.directiveStart+i];if(s===Oo.None||s===Oo.Emulated)return null}return Ts(n,t)}}function Yl(r,e,t,n,i){r.insertBefore(e,t,n,i)}function AD(r,e,t){r.appendChild(e,t)}function ID(r,e,t,n,i){null!==n?Yl(r,e,t,n,i):AD(r,e,t)}function jh(r,e){return r.parentNode(e)}function kD(r,e,t){return LD(r,e,t)}function xD(r,e,t){return 40&r.type?Ts(r,t):null}let uM,Kh,pM,Xh,LD=xD;function RD(r,e){LD=r,uM=e}function Zh(r,e,t,n){const i=lM(r,n,e),s=e[jt],a=kD(n.parent||e[Mi],n,e);if(null!=i)if(Array.isArray(t))for(let c=0;c<t.length;c++)ID(s,i,t[c],a,!1);else ID(s,i,t,a,!1);void 0!==uM&&uM(s,n,e,t,i)}function s7(r,e){if(null!==e){const t=e.type;if(3&t)return Ts(e,r);if(4&t)return fM(-1,r[e.index]);if(8&t){const n=e.child;if(null!==n)return s7(r,n);{const i=r[e.index];return Ps(i)?fM(-1,i):T1(i)}}if(32&t)return sM(e,r)()||T1(r[e.index]);{const n=zD(r,e);return null!==n?Array.isArray(n)?n[0]:s7(i7(r[Ar]),n):s7(r,e.next)}}return null}function zD(r,e){return null!==e?r[Ar][Mi].projection[e.projection]:null}function fM(r,e){const t=K2+r+1;if(t<e.length){const n=e[t],i=n[et].firstChild;if(null!==i)return s7(n,i)}return e[tc]}function Yh(r,e,t){const n=jh(r,e);n&&function q6e(r,e,t,n){r.removeChild(e,t,n)}(r,n,e,t)}function dM(r,e,t,n,i,s,o){for(;null!=t;){const a=n[t.index],c=t.type;if(o&&0===e&&(a&&Ei(T1(a),n),t.flags|=2),32!=(32&t.flags))if(8&c)dM(r,e,t.child,n,i,s,!1),s8(e,r,i,a,s);else if(32&c){const l=sM(t,n);let f;for(;f=l();)s8(e,r,i,f,s);s8(e,r,i,a,s)}else 16&c?HD(r,e,n,t,i,s):s8(e,r,i,a,s);t=o?t.projectionNext:t.next}}function o7(r,e,t,n,i,s){dM(t,n,r.firstChild,e,i,s,!1)}function HD(r,e,t,n,i,s){const o=t[Ar],c=o[Mi].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++)s8(e,r,i,c[l],s);else{let l=c;const f=o[q1];Bh(n)&&(l.flags|=128),dM(r,e,l,f,i,s,!0)}}function VD(r,e,t){""===t?r.removeAttribute(e,"class"):r.setAttribute(e,"class",t)}function FD(r,e,t){const{mergedAttrs:n,classes:i,styles:s}=t;null!==n&&Ty(r,e,n),null!==i&&VD(r,e,i),null!==s&&function X6e(r,e,t){r.setAttribute(e,"style",t)}(r,e,s)}function o8(r){return function hM(){if(void 0===Kh&&(Kh=null,p1.trustedTypes))try{Kh=p1.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Kh}()?.createHTML(r)||r}function a8(){if(void 0!==pM)return pM;if(typeof document<"u")return document;throw new ge(210,!1)}function gM(){if(void 0===Xh&&(Xh=null,p1.trustedTypes))try{Xh=p1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Xh}function $D(r){return gM()?.createHTML(r)||r}function GD(r){return gM()?.createScriptURL(r)||r}class Kl{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${BR})`}}class n0e extends Kl{getTypeName(){return"HTML"}}class r0e extends Kl{getTypeName(){return"Style"}}class i0e extends Kl{getTypeName(){return"Script"}}class s0e extends Kl{getTypeName(){return"URL"}}class o0e extends Kl{getTypeName(){return"ResourceURL"}}function Ks(r){return r instanceof Kl?r.changingThisBreaksApplicationSecurity:r}function oc(r,e){const t=function a0e(r){return r instanceof Kl&&r.getTypeName()||null}(r);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${BR})`)}return t===e}function UD(r){const e=new p0e(r);return function g0e(){try{return!!(new window.DOMParser).parseFromString(o8(""),"text/html")}catch{return!1}}()?new h0e(e):e}class h0e{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(o8(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class p0e{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=o8(e),t}}const m0e=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Qh(r){return(r=String(r)).match(m0e)?r:"unsafe:"+r}function f3(r){const e={};for(const t of r.split(","))e[t]=!0;return e}function a7(...r){const e={};for(const t of r)for(const n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}const WD=f3("area,br,col,hr,img,wbr"),qD=f3("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),jD=f3("rp,rt"),mM=a7(WD,a7(qD,f3("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),a7(jD,f3("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),a7(jD,qD)),_M=f3("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ZD=a7(_M,f3("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),f3("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),_0e=f3("script,style,template");class v0e{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!mM.hasOwnProperty(t))return this.sanitizedSomething=!0,!_0e.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let i=0;i<n.length;i++){const s=n.item(i),o=s.name,a=o.toLowerCase();if(!ZD.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=s.value;_M[a]&&(c=Qh(c)),this.buf.push(" ",o,'="',YD(c),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();mM.hasOwnProperty(t)&&!WD.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(YD(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const C0e=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,y0e=/([^\#-~ |!])/g;function YD(r){return r.replace(/&/g,"&amp;").replace(C0e,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(y0e,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Jh;function KD(r,e){let t=null;try{Jh=Jh||UD(r);let n=e?String(e):"";t=Jh.getInertBodyElement(n);let i=5,s=n;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,n=s,s=t.innerHTML,t=Jh.getInertBodyElement(n)}while(n!==s);return o8((new v0e).sanitizeChildren(vM(t)||t))}finally{if(t){const n=vM(t)||t;for(;n.firstChild;)n.removeChild(n.firstChild)}}}function vM(r){return"content"in r&&function M0e(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var wo=function(r){return r[r.NONE=0]="NONE",r[r.HTML=1]="HTML",r[r.STYLE=2]="STYLE",r[r.SCRIPT=3]="SCRIPT",r[r.URL=4]="URL",r[r.RESOURCE_URL=5]="RESOURCE_URL",r}(wo||{});function c7(r){const e=l7();return e?$D(e.sanitize(wo.HTML,r)||""):oc(r,"HTML")?$D(Ks(r)):KD(a8(),qt(r))}function ep(r){const e=l7();return e?e.sanitize(wo.URL,r)||"":oc(r,"URL")?Ks(r):Qh(qt(r))}function XD(r){const e=l7();if(e)return GD(e.sanitize(wo.RESOURCE_URL,r)||"");if(oc(r,"ResourceURL"))return GD(Ks(r));throw new ge(904,!1)}function l7(){const r=Ee();return r&&r[B0].sanitizer}class tt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=De({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const u7=new tt("ENVIRONMENT_INITIALIZER"),JD=new tt("INJECTOR",-1),eH=new tt("INJECTOR_DEF_TYPES");class CM{get(e,t=Fu){if(t===Fu){const n=new Error(`NullInjectorError: No provider for ${n2(e)}!`);throw n.name="NullInjectorError",n}return t}}function b0e(...r){return{\u0275providers:tH(0,r),\u0275fromNgModule:!0}}function tH(r,...e){const t=[],n=new Set;let i;const s=o=>{t.push(o)};return t8(e,o=>{const a=o;tp(a,s,[],n)&&(i||=[],i.push(a))}),void 0!==i&&nH(i,s),t}function nH(r,e){for(let t=0;t<r.length;t++){const{ngModule:n,providers:i}=r[t];MM(i,s=>{e(s,n)})}}function tp(r,e,t,n){if(!(r=$t(r)))return!1;let i=null,s=fh(r);const o=!s&&xn(r);if(s||o){if(o&&!o.standalone)return!1;i=r}else{const c=r.ngModule;if(s=fh(c),!s)return!1;i=c}const a=n.has(i);if(o){if(a)return!1;if(n.add(i),o.dependencies){const c="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const l of c)tp(l,e,t,n)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let l;n.add(i);try{t8(s.imports,f=>{tp(f,e,t,n)&&(l||=[],l.push(f))})}finally{}void 0!==l&&nH(l,e)}if(!a){const l=ql(i)||(()=>new i);e({provide:i,useFactory:l,deps:Wn},i),e({provide:eH,useValue:i,multi:!0},i),e({provide:u7,useValue:()=>Pe(i),multi:!0},i)}const c=s.providers;if(null!=c&&!a){const l=r;MM(c,f=>{e(f,l)})}}}return i!==r&&void 0!==r.providers}function MM(r,e){for(let t of r)hy(t)&&(t=t.\u0275providers),Array.isArray(t)?MM(t,e):e(t)}const w0e=r1({provide:String,useValue:r1});function EM(r){return null!==r&&"object"==typeof r&&w0e in r}function Xl(r){return"function"==typeof r}const SM=new tt("Set Injector scope."),np={},A0e={};let PM;function rp(){return void 0===PM&&(PM=new CM),PM}class Xs{}class ip extends Xs{get destroyed(){return this._destroyed}constructor(e,t,n,i){super(),this.parent=t,this.source=n,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,OM(e,o=>this.processProvider(o)),this.records.set(JD,c8(void 0,this)),i.has("environment")&&this.records.set(Xs,c8(void 0,this));const s=this.records.get(SM);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(eH.multi,Wn,cn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=v4(this),n=Es(void 0);try{return e()}finally{v4(t),Es(n)}}get(e,t=Fu,n=cn.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(XR))return e[XR](this);n=ph(n);const s=v4(this),o=Es(void 0);try{if(!(n&cn.SkipSelf)){let c=this.records.get(e);if(void 0===c){const l=function R0e(r){return"function"==typeof r||"object"==typeof r&&r instanceof tt}(e)&&uh(e);c=l&&this.injectableDefInScope(l)?c8(TM(e),np):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(n&cn.Self?rp():this.parent).get(e,t=n&cn.Optional&&t===Fu?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[hh]=a[hh]||[]).unshift(n2(e)),s)throw a;return function N4e(r,e,t,n){const i=r[hh];throw e[ZR]&&i.unshift(e[ZR]),r.message=function A4e(r,e,t,n=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let i=n2(e);if(Array.isArray(e))i=e.map(n2).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):n2(a)))}i=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${i}]: ${r.replace(P4e,"\n  ")}`}("\n"+r.message,i,t,n),r.ngTokenPath=i,r[hh]=null,r}(a,e,"R3InjectorError",this.source)}throw a}finally{Es(o),v4(s)}}resolveInjectorInitializers(){const e=v4(this),t=Es(void 0);try{const i=this.get(u7.multi,Wn,cn.Self);for(const s of i)s()}finally{v4(e),Es(t)}}toString(){const e=[],t=this.records;for(const n of t.keys())e.push(n2(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(e){let t=Xl(e=$t(e))?e:$t(e&&e.provide);const n=function k0e(r){return EM(r)?c8(void 0,r.useValue):c8(sH(r),np)}(e);if(Xl(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=c8(void 0,np,!0),i.factory=()=>Ey(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,n)}hydrate(e,t){return t.value===np&&(t.value=A0e,t.value=t.factory()),"object"==typeof t.value&&t.value&&function L0e(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=$t(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function TM(r){const e=uh(r),t=null!==e?e.factory:ql(r);if(null!==t)return t;if(r instanceof tt)throw new ge(204,!1);if(r instanceof Function)return function I0e(r){const e=r.length;if(e>0)throw t7(e,"?"),new ge(204,!1);const t=function y4e(r){return r&&(r[dh]||r[UR])||null}(r);return null!==t?()=>t.factory(r):()=>new r}(r);throw new ge(204,!1)}function sH(r,e,t){let n;if(Xl(r)){const i=$t(r);return ql(i)||TM(i)}if(EM(r))n=()=>$t(r.useValue);else if(function iH(r){return!(!r||!r.useFactory)}(r))n=()=>r.useFactory(...Ey(r.deps||[]));else if(function rH(r){return!(!r||!r.useExisting)}(r))n=()=>Pe($t(r.useExisting));else{const i=$t(r&&(r.useClass||r.provide));if(!function x0e(r){return!!r.deps}(r))return ql(i)||TM(i);n=()=>new i(...Ey(r.deps))}return n}function c8(r,e,t=!1){return{factory:r,value:e,multi:t?[]:void 0}}function OM(r,e){for(const t of r)Array.isArray(t)?OM(t,e):t&&hy(t)?OM(t.\u0275providers,e):e(t)}const sp=new tt("AppId",{providedIn:"root",factory:()=>z0e}),z0e="ng",oH=new tt("Platform Initializer"),d3=new tt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),aH=new tt("AnimationModuleType"),cH=new tt("CSP nonce",{providedIn:"root",factory:()=>a8().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let uH=(r,e,t)=>null;function xM(r,e,t=!1){return uH(r,e,t)}class q0e{}class hH{}class Z0e{resolveComponentFactory(e){throw function j0e(r){const e=Error(`No component factory found for ${n2(r)}.`);return e.ngComponent=r,e}(e)}}let fp=(()=>{class e{}return e.NULL=new Z0e,e})();function Y0e(){return u8(X2(),Ee())}function u8(r,e){return new Si(Ts(r,e))}let Si=(()=>{class e{constructor(n){this.nativeElement=n}}return e.__NG_ELEMENT_ID__=Y0e,e})();function K0e(r){return r instanceof Si?r.nativeElement:r}class p7{}let ac=(()=>{class e{constructor(){this.destroyNode=null}}return e.__NG_ELEMENT_ID__=()=>function X0e(){const r=Ee(),t=Zs(X2().index,r);return(Ss(t)?t:r)[jt]}(),e})(),Q0e=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>null}),e})();class f8{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const gH=new f8("16.2.0"),zM={};function CH(r,e=null,t=null,n){const i=yH(r,e,t,n);return i.resolveInjectorInitializers(),i}function yH(r,e=null,t=null,n,i=new Set){const s=[t||Wn,b0e(r)];return n=n||("object"==typeof r?void 0:n2(r)),new ip(s,e||rp(),n||null,i)}let Q2=(()=>{var r;class e{static create(n,i){if(Array.isArray(n))return CH({name:""},i,n,"");{const s=n.name??"";return CH({name:s},n.parent,n.providers,s)}}}return(r=e).THROW_IF_NOT_FOUND=Fu,r.NULL=new CM,r.\u0275prov=De({token:r,providedIn:"any",factory:()=>Pe(JD)}),r.__NG_ELEMENT_ID__=-1,e})();function h3(r){return r instanceof Function?r():r}let VM=(()=>{var r;class e{constructor(){this.callbacks=new Set,this.deferredCallbacks=new Set,this.renderDepth=0,this.runningCallbacks=!1}begin(){if(this.runningCallbacks)throw new ge(102,!1);this.renderDepth++}end(){if(this.renderDepth--,0===this.renderDepth)try{this.runningCallbacks=!0;for(const n of this.callbacks)n.invoke()}finally{this.runningCallbacks=!1;for(const n of this.deferredCallbacks)this.callbacks.add(n);this.deferredCallbacks.clear()}}register(n){(this.runningCallbacks?this.deferredCallbacks:this.callbacks).add(n)}unregister(n){this.callbacks.delete(n),this.deferredCallbacks.delete(n)}ngOnDestroy(){this.callbacks.clear(),this.deferredCallbacks.clear()}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function g7(r){for(;r;){r[Kt]|=64;const e=i7(r);if(Ny(r)&&!e)return r;r=e}return null}function FM(r){return r.ngOriginalError}class Ql{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&FM(e);for(;t&&FM(t);)t=FM(t);return t||null}}const TH=new tt("",{providedIn:"root",factory:()=>!1});class NH extends mz{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(e){this._lView=e}onConsumerDependencyMayHaveChanged(){g7(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(e,t,n){const i=E2(this);this.trackingVersion++;try{e(t,n)}finally{E2(i)}}destroy(){this.trackingVersion++}}let hp=null;function AH(){return hp??=new NH,hp}function IH(r,e){return r[e]??AH()}function kH(r,e){const t=AH();t.hasReadASignal&&(r[e]=hp,t.lView=r,hp=new NH)}const Xt={};function v(r){xH(Ln(),Ee(),Qi()+r,!1)}function xH(r,e,t,n){if(!n)if(3==(3&e[Kt])){const s=r.preOrderCheckHooks;null!==s&&wh(e,s,t)}else{const s=r.preOrderHooks;null!==s&&Nh(e,s,0,t)}jl(t)}function G(r,e=cn.Default){const t=Ee();return null===t?Pe(r,e):Xz(X2(),t,$t(r),e)}function pp(r,e,t,n,i,s,o,a,c,l,f){const d=e.blueprint.slice();return d[wr]=i,d[Kt]=140|n,(null!==l||r&&2048&r[Kt])&&(d[Kt]|=2048),Oz(d),d[q1]=d[G0]=r,d[Nr]=t,d[B0]=o||r&&r[B0],d[jt]=a||r&&r[jt],d[C4]=c||r&&r[C4]||null,d[Mi]=s,d[ju]=function O6e(){return T6e++}(),d[c3]=f,d[uz]=l,d[Ar]=2==e.type?r[Ar]:d,d}function p8(r,e,t,n,i){let s=r.data[e];if(null===s)s=$M(r,e,t,n,i),function Ole(){return Vt.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=n,s.attrs=i;const o=Yu();s.injectorIndex=null===o?-1:o.injectorIndex}return ic(s,!0),s}function $M(r,e,t,n,i){const s=kz(),o=Ry(),c=r.data[e]=function M8e(r,e,t,n,i,s){let o=e?e.injectorIndex:-1,a=0;return j0()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,i);return null===r.firstChild&&(r.firstChild=c),null!==s&&(o?null==s.child&&null!==c.parent&&(s.child=c):null===s.next&&(s.next=c,c.prev=s)),c}function m7(r,e,t,n){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(n),r.blueprint.push(n),r.data.push(null);return i}function RH(r,e,t,n,i){const s=IH(e,vh),o=Qi(),a=2&n;try{if(jl(-1),a&&e.length>mn&&xH(r,e,mn,!1),rc(a?2:0,i),a)s.runInContext(t,n,i);else{const l=E2(null);try{t(n,i)}finally{E2(l)}}}finally{a&&null===e[vh]&&kH(e,vh),jl(o),rc(a?3:1,i)}}function BM(r,e,t){if(wy(e)){const n=E2(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=r.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{E2(n)}}}function GM(r,e,t){Iz()&&(function w8e(r,e,t,n){const i=t.directiveStart,s=t.directiveEnd;Wl(t)&&function R8e(r,e,t){const n=Ts(e,r),i=zH(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=gp(r,pp(r,i,null,o,n,e,null,r[B0].rendererFactory.createRenderer(n,t),null,null,null));r[e.index]=a}(e,t,r.data[i+t.componentOffset]),r.firstCreatePass||Ih(t,e),Ei(n,e);const o=t.initialInputs;for(let a=i;a<s;a++){const c=r.data[a],l=Zl(e,r,a,t);Ei(l,e),null!==o&&z8e(0,a-i,l,c,0,o),la(c)&&(Zs(t.index,e)[Nr]=Zl(e,r,a,t))}}(r,e,t,Ts(t,e)),64==(64&t.flags)&&$H(r,e,t))}function UM(r,e,t=Ts){const n=e.localNames;if(null!==n){let i=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,r):r[o];r[i++]=a}}}function zH(r){const e=r.tView;return null===e||e.incompleteFirstPass?r.tView=WM(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts,r.id):e}function WM(r,e,t,n,i,s,o,a,c,l,f){const d=mn+n,m=d+i,M=function g8e(r,e){const t=[];for(let n=0;n<e;n++)t.push(n<r?null:Xt);return t}(d,m),w="function"==typeof l?l():l;return M[et]={type:r,blueprint:M,template:t,queries:null,viewQuery:a,declTNode:e,data:M.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:f}}let DH=r=>null;function HH(r,e,t,n){for(let i in r)if(r.hasOwnProperty(i)){t=null===t?{}:t;const s=r[i];null===n?VH(t,e,i,s):n.hasOwnProperty(i)&&VH(t,e,n[i],s)}return t}function VH(r,e,t,n){r.hasOwnProperty(t)?r[t].push(e,n):r[t]=[e,n]}function Qs(r,e,t,n,i,s,o,a){const c=Ts(e,t);let f,l=e.inputs;!a&&null!=l&&(f=l[n])?(KM(r,t,f,n,i),Wl(e)&&function P8e(r,e){const t=Zs(e,r);16&t[Kt]||(t[Kt]|=64)}(t,e.index)):3&e.type&&(n=function S8e(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(n),i=null!=o?o(i,e.value||"",n):i,s.setProperty(c,n,i))}function qM(r,e,t,n){if(Iz()){const i=null===n?null:{"":-1},s=function A8e(r,e){const t=r.directiveRegistry;let n=null,i=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if(iz(e,o.selectors,!1))if(n||(n=[]),la(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),n.unshift(...a,o),jM(r,e,a.length)}else n.unshift(o),jM(r,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,n,i),n.push(o)}return null===n?null:[n,i]}(r,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&FH(r,e,t,o,i,a),i&&function I8e(r,e,t){if(e){const n=r.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new ge(-301,!1);n.push(e[i],s)}}}(t,n,i)}t.mergedAttrs=Gu(t.mergedAttrs,t.attrs)}function FH(r,e,t,n,i,s){for(let l=0;l<n.length;l++)jy(Ih(t,e),r,n[l].type);!function x8e(r,e,t){r.flags|=1,r.directiveStart=e,r.directiveEnd=e+t,r.providerIndexes=e}(t,r.data.length,n.length);for(let l=0;l<n.length;l++){const f=n[l];f.providersResolver&&f.providersResolver(f)}let o=!1,a=!1,c=m7(r,e,n.length,null);for(let l=0;l<n.length;l++){const f=n[l];t.mergedAttrs=Gu(t.mergedAttrs,f.hostAttrs),L8e(r,t,e,c,f),k8e(c,f,i),null!==f.contentQueries&&(t.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(t.flags|=64);const d=f.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((r.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((r.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}!function E8e(r,e,t){const i=e.directiveEnd,s=r.data,o=e.attrs,a=[];let c=null,l=null;for(let f=e.directiveStart;f<i;f++){const d=s[f],m=t?t.get(d):null,w=m?m.outputs:null;c=HH(d.inputs,f,c,m?m.inputs:null),l=HH(d.outputs,f,l,w);const L=null===c||null===o||rz(e)?null:D8e(c,f,o);a.push(L)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}(r,t,s)}function $H(r,e,t){const n=t.directiveStart,i=t.directiveEnd,s=t.index,o=function wle(){return Vt.lFrame.currentDirectiveIndex}();try{jl(s);for(let a=n;a<i;a++){const c=r.data[a],l=e[a];Dy(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&N8e(c,l)}}finally{jl(-1),Dy(o)}}function N8e(r,e){null!==r.hostBindings&&r.hostBindings(1,e)}function jM(r,e,t){e.componentOffset=t,(r.components??=[]).push(e.index)}function k8e(r,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=r;la(e)&&(t[""]=r)}}function L8e(r,e,t,n,i){r.data[n]=i;const s=i.factory||(i.factory=ql(i.type)),o=new Ku(s,la(i),G);r.blueprint[n]=o,t[n]=o,function O8e(r,e,t,n,i){const s=i.hostBindings;if(s){let o=r.hostBindingOpCodes;null===o&&(o=r.hostBindingOpCodes=[]);const a=~e.index;(function b8e(r){let e=r.length;for(;e>0;){const t=r[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,n,s)}}(r,e,n,m7(r,t,i.hostVars,Xt),i)}function cc(r,e,t,n,i,s){const o=Ts(r,e);ZM(e[jt],o,s,r.value,t,n,i)}function ZM(r,e,t,n,i,s,o){if(null==s)r.removeAttribute(e,i,t);else{const a=null==o?qt(s):o(s,n||"",i);r.setAttribute(e,i,a,t)}}function z8e(r,e,t,n,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)BH(n,t,o[a++],o[a++],o[a++])}function BH(r,e,t,n,i){const s=E2(null);try{const o=r.inputTransforms;null!==o&&o.hasOwnProperty(n)&&(i=o[n].call(e,i)),null!==r.setInput?r.setInput(e,i,t,n):e[n]=i}finally{E2(s)}}function D8e(r,e,t){let n=null,i=0;for(;i<t.length;){const s=t[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(r.hasOwnProperty(s)){null===n&&(n=[]);const o=r[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){n.push(s,o[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return n}function GH(r,e,t,n){return[r,!0,!1,e,null,0,n,t,null,null,null]}function UH(r,e){const t=r.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const s=t[n+1];if(-1!==s){const o=r.data[s];Vy(t[n]),o.contentQueries(2,e[s],s)}}}function gp(r,e){return r[Wu]?r[lz][ca]=e:r[Wu]=e,r[lz]=e,e}function YM(r,e,t){Vy(0);const n=E2(null);try{e(r,t)}finally{E2(n)}}function WH(r){return r[$0]||(r[$0]=[])}function qH(r){return r.cleanup||(r.cleanup=[])}function ZH(r,e){const t=r[C4],n=t?t.get(Ql,null):null;n&&n.handleError(e)}function KM(r,e,t,n,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];BH(r.data[o],e[o],n,a,i)}}function p3(r,e,t){const n=Th(e,r);bD(r[jt],n,t)}function H8e(r,e){const t=Zs(e,r),n=t[et];!function V8e(r,e){for(let t=e.length;t<r.blueprint.length;t++)e.push(r.blueprint[t])}(n,t);const i=t[wr];null!==i&&null===t[c3]&&(t[c3]=xM(i,t[C4])),XM(n,t,t[Nr])}function XM(r,e,t){Fy(e);try{const n=r.viewQuery;null!==n&&YM(1,n,t);const i=r.template;null!==i&&RH(r,e,i,1,t),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&UH(r,e),r.staticViewQueries&&YM(2,r.viewQuery,t);const s=r.components;null!==s&&function F8e(r,e){for(let t=0;t<e.length;t++)H8e(r,e[t])}(e,s)}catch(n){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),n}finally{e[Kt]&=-5,$y()}}let YH=(()=>{var r;class e{constructor(){this.all=new Set,this.queue=new Map}create(n,i,s){const o=typeof Zone>"u"?null:Zone.current,a=new ile(n,f=>{this.all.has(f)&&this.queue.set(f,o)},s);let c;this.all.add(a),a.notify();const l=()=>{a.cleanup(),c?.(),this.all.delete(a),this.queue.delete(a)};return c=i?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[n,i]of this.queue)this.queue.delete(n),i?i.run(()=>n.run()):n.run()}get isQueueEmpty(){return 0===this.queue.size}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new r}),e})();function mp(r,e,t){let n=t?r.styles:null,i=t?r.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=fy(i,a):2==s&&(n=fy(n,a+": "+e[++o]+";"))}t?r.styles=n:r.stylesWithoutHost=n,t?r.classes=i:r.classesWithoutHost=i}function _7(r,e,t,n,i=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(T1(s)),Ps(s)){for(let a=K2;a<s.length;a++){const c=s[a],l=c[et].firstChild;null!==l&&_7(c[et],c,l,n)}s[tc]!==s[wr]&&n.push(s[tc])}const o=t.type;if(8&o)_7(r,e,t.child,n);else if(32&o){const a=sM(t,e);let c;for(;c=a();)n.push(c)}else if(16&o){const a=zD(e,t);if(Array.isArray(a))n.push(...a);else{const c=i7(e[Ar]);_7(c[et],c,a,n,!0)}}t=i?t.projectionNext:t.next}return n}function _p(r,e,t,n=!0){const i=e[B0],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{KH(r,e,r.template,t)}catch(c){throw n&&ZH(e,c),c}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function KH(r,e,t,n){const i=e[Kt];if(256!=(256&i)){e[B0].effectManager?.flush(),Fy(e);try{Oz(e),function Lz(r){return Vt.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==t&&RH(r,e,t,2,n);const o=3==(3&i);if(o){const l=r.preOrderCheckHooks;null!==l&&wh(e,l,null)}else{const l=r.preOrderHooks;null!==l&&Nh(e,l,0,null),By(e,0)}if(function G8e(r){for(let e=PD(r);null!==e;e=TD(e)){if(!e[fz])continue;const t=e[W0];for(let n=0;n<t.length;n++){gle(t[n])}}}(e),XH(e,2),null!==r.contentQueries&&UH(r,e),o){const l=r.contentCheckHooks;null!==l&&wh(e,l)}else{const l=r.contentHooks;null!==l&&Nh(e,l,1),By(e,1)}!function p8e(r,e){const t=r.hostBindingOpCodes;if(null===t)return;const n=IH(e,Ch);try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)jl(~s);else{const o=s,a=t[++i],c=t[++i];ble(a,o),n.runInContext(c,2,e[o])}}}finally{null===e[Ch]&&kH(e,Ch),jl(-1)}}(r,e);const a=r.components;null!==a&&JH(e,a,0);const c=r.viewQuery;if(null!==c&&YM(2,c,n),o){const l=r.viewCheckHooks;null!==l&&wh(e,l)}else{const l=r.viewHooks;null!==l&&Nh(e,l,2),By(e,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),e[Kt]&=-73,bz(e)}finally{$y()}}}function XH(r,e){for(let t=PD(r);null!==t;t=TD(t))for(let n=K2;n<t.length;n++)QH(t[n],e)}function U8e(r,e,t){QH(Zs(e,r),t)}function QH(r,e){if(!function hle(r){return 128==(128&r[Kt])}(r))return;const t=r[et];if(80&r[Kt]&&0===e||1024&r[Kt]||2===e)KH(t,r,t.template,r[Nr]);else if(r[Uu]>0){XH(r,1);const i=r[et].components;null!==i&&JH(r,i,1)}}function JH(r,e,t){for(let n=0;n<e.length;n++)U8e(r,e[n],t)}class v7{get rootNodes(){const e=this._lView,t=e[et];return _7(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Nr]}set context(e){this._lView[Nr]=e}get destroyed(){return 256==(256&this._lView[Kt])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[q1];if(Ps(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(qh(e,n),Rh(t,n))}this._attachedToViewContainer=!1}aM(this._lView[et],this._lView)}onDestroy(e){!function Nz(r,e){if(256==(256&r[Kt]))throw new ge(911,!1);null===r[y4]&&(r[y4]=[]),r[y4].push(e)}(this._lView,e)}markForCheck(){g7(this._cdRefInjectingView||this._lView)}detach(){this._lView[Kt]&=-129}reattach(){this._lView[Kt]|=128}detectChanges(){_p(this._lView[et],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function F6e(r,e){o7(r,e,e[jt],2,null,null)}(this._lView[et],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=e}}class W8e extends v7{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;_p(e[et],e,e[Nr],!1)}checkNoChanges(){}get context(){return null}}class eV extends fp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=xn(e);return new C7(t,this.ngModule)}}function tV(r){const e=[];for(let t in r)r.hasOwnProperty(t)&&e.push({propName:r[t],templateName:t});return e}class j8e{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=ph(n);const i=this.injector.get(e,zM,n);return i!==zM||t===zM?i:this.parentInjector.get(e,t,n)}}class C7 extends hH{get inputs(){const e=this.componentDef,t=e.inputTransforms,n=tV(e.inputs);if(null!==t)for(const i of n)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return n}get outputs(){return tV(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function F4e(r){return r.map(V4e).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,i){let s=(i=i||this.ngModule)instanceof Xs?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new j8e(e,s):e,a=o.get(p7,null);if(null===a)throw new ge(407,!1);const d={rendererFactory:a,sanitizer:o.get(Q0e,null),effectManager:o.get(YH,null),afterRenderEventManager:o.get(VM,null)},m=a.createRenderer(null,this.componentDef),M=this.componentDef.selectors[0][0]||"div",w=n?function m8e(r,e,t,n){const s=n.get(TH,!1)||t===Oo.ShadowDom,o=r.selectRootElement(e,s);return function _8e(r){DH(r)}(o),o}(m,n,this.componentDef.encapsulation,o):Wh(m,M,function q8e(r){const e=r.toLowerCase();return"svg"===e?Sz:"math"===e?"math":null}(M)),$=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let B=null;null!==w&&(B=xM(w,o,!0));const de=WM(0,null,null,1,0,null,null,null,null,null,null),_e=pp(null,de,null,$,null,null,d,m,o,null,B);let xe,nt;Fy(_e);try{const gt=this.componentDef;let yn,Et=null;gt.findHostDirectiveDefs?(yn=[],Et=new Map,gt.findHostDirectiveDefs(gt,yn,Et),yn.push(gt)):yn=[gt];const W2=function Y8e(r,e){const t=r[et],n=mn;return r[n]=e,p8(t,n,2,"#host",null)}(_e,w),k0=function K8e(r,e,t,n,i,s,o){const a=i[et];!function X8e(r,e,t,n){for(const i of r)e.mergedAttrs=Gu(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(mp(e,e.mergedAttrs,!0),null!==t&&FD(n,t,e))}(n,r,e,o);let c=null;null!==e&&(c=xM(e,i[C4]));const l=s.rendererFactory.createRenderer(e,t);let f=16;t.signals?f=4096:t.onPush&&(f=64);const d=pp(i,zH(t),null,f,i[r.index],r,s,l,null,null,c);return a.firstCreatePass&&jM(a,r,n.length-1),gp(i,d),i[r.index]=d}(W2,w,gt,yn,_e,d,m);nt=Tz(de,mn),w&&function J8e(r,e,t,n){if(n)Ty(r,t,["ng-version",gH.full]);else{const{attrs:i,classes:s}=function $4e(r){const e=[],t=[];let n=1,i=2;for(;n<r.length;){let s=r[n];if("string"==typeof s)2===i?""!==s&&e.push(s,r[++n]):8===i&&t.push(s);else{if(!aa(i))break;i=s}n++}return{attrs:e,classes:t}}(e.selectors[0]);i&&Ty(r,t,i),s&&s.length>0&&VD(r,t,s.join(" "))}}(m,gt,w,n),void 0!==t&&function e5e(r,e,t){const n=r.projection=[];for(let i=0;i<e.length;i++){const s=t[i];n.push(null!=s?Array.from(s):null)}}(nt,this.ngContentSelectors,t),xe=function Q8e(r,e,t,n,i,s){const o=X2(),a=i[et],c=Ts(o,i);FH(a,i,o,t,null,n);for(let f=0;f<t.length;f++)Ei(Zl(i,a,o.directiveStart+f,o),i);$H(a,i,o),c&&Ei(c,i);const l=Zl(i,a,o.directiveStart+o.componentOffset,o);if(r[Nr]=i[Nr]=l,null!==s)for(const f of s)f(l,e);return BM(a,o,r),l}(k0,gt,yn,Et,_e,[t5e]),XM(de,_e,null)}finally{$y()}return new Z8e(this.componentType,xe,u8(nt,_e),_e,nt)}}class Z8e extends q0e{constructor(e,t,n,i,s){super(),this.location=n,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new W8e(i),this.componentType=e}setInput(e,t){const n=this._tNode.inputs;let i;if(null!==n&&(i=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;KM(s[et],s,i,e,t),this.previousInputValues.set(e,t),g7(Zs(this._tNode.index,s))}}get injector(){return new Ji(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function t5e(){const r=X2();bh(Ee()[et],r)}function Je(r){let e=function nV(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),t=!0;const n=[r];for(;e;){let i;if(la(r))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ge(903,!1);i=e.\u0275dir}if(i){if(t){n.push(i);const o=r;o.inputs=vp(r.inputs),o.inputTransforms=vp(r.inputTransforms),o.declaredInputs=vp(r.declaredInputs),o.outputs=vp(r.outputs);const a=i.hostBindings;a&&s5e(r,a);const c=i.viewQuery,l=i.contentQueries;if(c&&r5e(r,c),l&&i5e(r,l),ch(r.inputs,i.inputs),ch(r.declaredInputs,i.declaredInputs),ch(r.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),ch(o.inputTransforms,i.inputTransforms)),la(i)&&i.data.animation){const f=r.data;f.animation=(f.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(r),a===Je&&(t=!1)}}e=Object.getPrototypeOf(e)}!function n5e(r){let e=0,t=null;for(let n=r.length-1;n>=0;n--){const i=r[n];i.hostVars=e+=i.hostVars,i.hostAttrs=Gu(i.hostAttrs,t=Gu(t,i.hostAttrs))}}(n)}function vp(r){return r===Ja?{}:r===Wn?[]:r}function r5e(r,e){const t=r.viewQuery;r.viewQuery=t?(n,i)=>{e(n,i),t(n,i)}:e}function i5e(r,e){const t=r.contentQueries;r.contentQueries=t?(n,i,s)=>{e(n,i,s),t(n,i,s)}:e}function s5e(r,e){const t=r.hostBindings;r.hostBindings=t?(n,i)=>{e(n,i),t(n,i)}:e}function oV(r){const e=r.inputConfig,t={};for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];Array.isArray(i)&&i[2]&&(t[n]=i[2])}r.inputTransforms=t}function Cp(r){return!!QM(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function QM(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function lc(r,e,t){return r[e]=t}function Pi(r,e,t){return!Object.is(r[e],t)&&(r[e]=t,!0)}function Jl(r,e,t,n){const i=Pi(r,e,t);return Pi(r,e+1,n)||i}function k(r,e,t,n){const i=Ee();return Pi(i,Z0(),e)&&(Ln(),cc(tr(),i,r,e,t,n)),k}function m8(r,e,t,n){return Pi(r,Z0(),t)?e+qt(t)+n:Xt}function _8(r,e,t,n,i,s){const a=Jl(r,l3(),t,i);return u3(2),a?e+qt(t)+n+qt(i)+s:Xt}function v8(r,e,t,n,i,s,o,a){const l=function yp(r,e,t,n,i){const s=Jl(r,e,t,n);return Pi(r,e+2,i)||s}(r,l3(),t,i,o);return u3(3),l?e+qt(t)+n+qt(i)+s+qt(o)+a:Xt}function e6(r,e,t,n,i,s){const o=Ee(),a=m8(o,e,t,n);return a!==Xt&&cc(tr(),o,r,a,i,s),e6}function T(r,e,t,n,i,s,o,a){const c=Ee(),l=Ln(),f=r+mn,d=l.firstCreatePass?function A5e(r,e,t,n,i,s,o,a,c){const l=e.consts,f=p8(e,r,4,o||null,M4(l,a));qM(e,t,f,M4(l,c)),bh(e,f);const d=f.tView=WM(2,f,n,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return null!==e.queries&&(e.queries.template(e,f),d.queries=e.queries.embeddedTView(f)),f}(f,l,c,e,t,n,i,s,o):l.data[f];ic(d,!1);const m=vV(l,c,d,r);Oh()&&Zh(l,c,m,d),Ei(m,c),gp(c,c[f]=GH(m,c,m,d)),Mh(d)&&GM(l,c,d),null!=o&&UM(c,d,a)}let vV=function CV(r,e,t,n){return E4(!0),e[jt].createComment("")};function ln(r){return q0(function Tle(){return Vt.lFrame.contextLView}(),mn+r)}function y(r,e,t){const n=Ee();return Pi(n,Z0(),e)&&Qs(Ln(),tr(),n,r,e,n[jt],t,!1),y}function iE(r,e,t,n,i){const o=i?"class":"style";KM(r,t,e.inputs[o],o,n)}function E(r,e,t,n){const i=Ee(),s=Ln(),o=mn+r,a=i[jt],c=s.firstCreatePass?function L5e(r,e,t,n,i,s){const o=e.consts,c=p8(e,r,2,n,M4(o,i));return qM(e,t,c,M4(o,s)),null!==c.attrs&&mp(c,c.attrs,!1),null!==c.mergedAttrs&&mp(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,i,e,t,n):s.data[o],l=yV(s,i,c,a,e,r);i[o]=l;const f=Mh(c);return ic(c,!0),FD(a,l,c),32!=(32&c.flags)&&Oh()&&Zh(s,i,l,c),0===function _le(){return Vt.lFrame.elementDepthCount}()&&Ei(l,i),function vle(){Vt.lFrame.elementDepthCount++}(),f&&(GM(s,i,c),BM(s,c,i)),null!==n&&UM(i,c),E}function S(){let r=X2();Ry()?zy():(r=r.parent,ic(r,!1));const e=r;(function yle(r){return Vt.skipHydrationRootTNode===r})(e)&&function Ple(){Vt.skipHydrationRootTNode=null}(),function Cle(){Vt.lFrame.elementDepthCount--}();const t=Ln();return t.firstCreatePass&&(bh(t,r),wy(r)&&t.queries.elementEnd(r)),null!=e.classesWithoutHost&&function Hle(r){return 0!=(8&r.flags)}(e)&&iE(t,e,Ee(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Vle(r){return 0!=(16&r.flags)}(e)&&iE(t,e,Ee(),e.stylesWithoutHost,!1),S}function F(r,e,t,n){return E(r,e,t,n),S(),F}let yV=(r,e,t,n,i,s)=>(E4(!0),Wh(n,i,function Bz(){return Vt.lFrame.currentNamespace}()));function Bt(r,e,t){const n=Ee(),i=Ln(),s=r+mn,o=i.firstCreatePass?function D5e(r,e,t,n,i){const s=e.consts,o=M4(s,n),a=p8(e,r,8,"ng-container",o);return null!==o&&mp(a,o,!0),qM(e,t,a,M4(s,i)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,i,n,e,t):i.data[s];ic(o,!0);const a=EV(i,n,o,r);return n[s]=a,Oh()&&Zh(i,n,a,o),Ei(a,n),Mh(o)&&(GM(i,n,o),BM(i,o,n)),null!=t&&UM(n,o),Bt}function Gt(){let r=X2();const e=Ln();return Ry()?zy():(r=r.parent,ic(r,!1)),e.firstCreatePass&&(bh(e,r),wy(r)&&e.queries.elementEnd(r)),Gt}let EV=(r,e,t,n)=>(E4(!0),oM(e[jt],""));function pe(){return Ee()}function P7(r){return!!r&&"function"==typeof r.then}function SV(r){return!!r&&"function"==typeof r.subscribe}function U(r,e,t,n){const i=Ee(),s=Ln(),o=X2();return function TV(r,e,t,n,i,s,o){const a=Mh(n),l=r.firstCreatePass&&qH(r),f=e[Nr],d=WH(e);let m=!0;if(3&n.type||o){const L=Ts(n,e),z=o?o(L):L,$=d.length,B=o?_e=>o(T1(_e[n.index])):n.index;let de=null;if(!o&&a&&(de=function F5e(r,e,t,n){const i=r.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===n){const a=e[$0],c=i[s+2];return a.length>c?a[c]:null}"string"==typeof o&&(s+=2)}return null}(r,e,i,n.index)),null!==de)(de.__ngLastListenerFn__||de).__ngNextListenerFn__=s,de.__ngLastListenerFn__=s,m=!1;else{s=bV(n,e,f,s,!1);const _e=t.listen(z,i,s);d.push(s,_e),l&&l.push(i,B,$,$+1)}}else s=bV(n,e,f,s,!1);const M=n.outputs;let w;if(m&&null!==M&&(w=M[i])){const L=w.length;if(L)for(let z=0;z<L;z+=2){const xe=e[w[z]][w[z+1]].subscribe(s),nt=d.length;d.push(s,xe),l&&l.push(i,n.index,nt,-(nt+1))}}}(s,i,i[jt],o,r,e,n),U}function OV(r,e,t,n){try{return rc(6,e,t),!1!==t(n)}catch(i){return ZH(r,i),!1}finally{rc(7,e,t)}}function bV(r,e,t,n,i){return function s(o){if(o===Function)return n;g7(r.componentOffset>-1?Zs(r.index,e):e);let c=OV(e,t,n,o),l=s.__ngNextListenerFn__;for(;l;)c=OV(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return i&&!1===c&&o.preventDefault(),c}}function p(r=1){return function Ale(r){return(Vt.lFrame.contextLView=function Ile(r,e){for(;r>0;)e=e[G0],r--;return e}(r,Vt.lFrame.contextLView))[Nr]}(r)}function $5e(r,e){let t=null;const n=function R4e(r){const e=r.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(r);for(let i=0;i<e.length;i++){const s=e[i];if("*"!==s){if(null===n?iz(r,s,!0):H4e(n,s))return i}else t=i}return t}function Rn(r,e,t,n,i){const s=Ee(),o=m8(s,e,t,n);return o!==Xt&&Qs(Ln(),tr(),s,r,o,s[jt],i,!1),Rn}function ye(r,e,t,n,i,s,o){const a=Ee(),c=_8(a,e,t,n,i,s);return c!==Xt&&Qs(Ln(),tr(),a,r,c,a[jt],o,!1),ye}function Ti(r,e,t,n,i,s,o,a,c){const l=Ee(),f=v8(l,e,t,n,i,s,o,a);return f!==Xt&&Qs(Ln(),tr(),l,r,f,l[jt],c,!1),Ti}function Pp(r,e){return r<<17|e<<2}function P4(r){return r>>17&32767}function sE(r){return 2|r}function t6(r){return(131068&r)>>2}function oE(r,e){return-131069&r|e<<2}function aE(r){return 1|r}function DV(r,e,t,n,i){const s=r[t+1],o=null===e;let a=n?P4(s):t6(s),c=!1;for(;0!==a&&(!1===c||o);){const f=r[a+1];j5e(r[a],e)&&(c=!0,r[a+1]=n?aE(f):sE(f)),a=n?P4(f):t6(f)}c&&(r[t+1]=n?sE(s):aE(s))}function j5e(r,e){return null===r||null==e||(Array.isArray(r)?r[1]:r)===e||!(!Array.isArray(r)||"string"!=typeof e)&&n8(r,e)>=0}const s2={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function HV(r){return r.substring(s2.key,s2.keyEnd)}function Z5e(r){return r.substring(s2.value,s2.valueEnd)}function FV(r,e){const t=s2.textEnd;let n=s2.key=P8(r,e,t);return t===n?-1:(n=s2.keyEnd=function Q5e(r,e,t){let n;for(;e<t&&(45===(n=r.charCodeAt(e))||95===n||(-33&n)>=65&&(-33&n)<=90||n>=48&&n<=57);)e++;return e}(r,n,t),n=BV(r,n,t),n=s2.value=P8(r,n,t),n=s2.valueEnd=function J5e(r,e,t){let n=-1,i=-1,s=-1,o=e,a=o;for(;o<t;){const c=r.charCodeAt(o++);if(59===c)return a;34===c||39===c?a=o=GV(r,c,o,t):e===o-4&&85===s&&82===i&&76===n&&40===c?a=o=GV(r,41,o,t):c>32&&(a=o),s=i,i=n,n=-33&c}return a}(r,n,t),BV(r,n,t))}function P8(r,e,t){for(;e<t&&r.charCodeAt(e)<=32;)e++;return e}function BV(r,e,t,n){return(e=P8(r,e,t))<t&&e++,e}function GV(r,e,t,n){let i=-1,s=t;for(;s<n;){const o=r.charCodeAt(s++);if(o==e&&92!==i)return s;i=92==o&&92===i?0:o}throw new Error}function Tp(r,e){return function ua(r,e,t,n){const i=Ee(),s=Ln(),o=u3(2);s.firstUpdatePass&&qV(s,r,o,n),e!==Xt&&Pi(i,o,e)&&ZV(s,s.data[Qi()],i,i[jt],r,i[o+1]=function lue(r,e){return null==r||""===r||("string"==typeof e?r+=e:"object"==typeof r&&(r=n2(Ks(r)))),r}(e,t),n,o)}(r,e,null,!0),Tp}function J2(r){!function fa(r,e,t,n){const i=Ln(),s=u3(2);i.firstUpdatePass&&qV(i,null,s,n);const o=Ee();if(t!==Xt&&Pi(o,s,t)){const a=i.data[Qi()];if(KV(a,n)&&!WV(i,s)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(t=fy(c,t||"")),iE(i,a,o,t,n)}else!function cue(r,e,t,n,i,s,o,a){i===Xt&&(i=Wn);let c=0,l=0,f=0<i.length?i[0]:null,d=0<s.length?s[0]:null;for(;null!==f||null!==d;){const m=c<i.length?i[c+1]:void 0,M=l<s.length?s[l+1]:void 0;let L,w=null;f===d?(c+=2,l+=2,m!==M&&(w=d,L=M)):null===d||null!==f&&f<d?(c+=2,w=f):(l+=2,w=d,L=M),null!==w&&ZV(r,e,t,n,w,L,o,a),f=c<i.length?i[c]:null,d=l<s.length?s[l]:null}}(i,a,o,o[jt],o[s+1],o[s+1]=function oue(r,e,t){if(null==t||""===t)return Wn;const n=[],i=Ks(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)r(n,i[s],!0);else if("object"==typeof i)for(const s in i)i.hasOwnProperty(s)&&r(n,s,i[s]);else"string"==typeof i&&e(n,i);return n}(r,e,t),n,s)}}(jV,eue,r,!1)}function eue(r,e){for(let t=function K5e(r){return function $V(r){s2.key=0,s2.keyEnd=0,s2.value=0,s2.valueEnd=0,s2.textEnd=r.length}(r),FV(r,P8(r,0,s2.textEnd))}(e);t>=0;t=FV(e,t))jV(r,HV(e),Z5e(e))}function WV(r,e){return e>=r.expandoStartIndex}function qV(r,e,t,n){const i=r.data;if(null===i[t+1]){const s=i[Qi()],o=WV(r,t);KV(s,n)&&null===e&&!o&&(e=!1),e=function nue(r,e,t,n){const i=function Hy(r){const e=Vt.lFrame.currentDirectiveIndex;return-1===e?null:r[e]}(r);let s=n?e.residualClasses:e.residualStyles;if(null===i)0===(n?e.classBindings:e.styleBindings)&&(t=T7(t=cE(null,r,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||r[o]!==i)if(t=cE(i,r,e,t,n),null===s){let c=function rue(r,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==t6(n))return r[P4(n)]}(r,e,n);void 0!==c&&Array.isArray(c)&&(c=cE(null,r,e,c[1],n),c=T7(c,e.attrs,n),function iue(r,e,t,n){r[P4(t?e.classBindings:e.styleBindings)]=n}(r,e,n,c))}else s=function sue(r,e,t){let n;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)n=T7(n,r[s].hostAttrs,t);return T7(n,e.attrs,t)}(r,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,n),function W5e(r,e,t,n,i,s){let o=s?e.classBindings:e.styleBindings,a=P4(o),c=t6(o);r[n]=t;let f,l=!1;if(Array.isArray(t)?(f=t[1],(null===f||n8(t,f)>0)&&(l=!0)):f=t,i)if(0!==c){const m=P4(r[a+1]);r[n+1]=Pp(m,a),0!==m&&(r[m+1]=oE(r[m+1],n)),r[a+1]=function G5e(r,e){return 131071&r|e<<17}(r[a+1],n)}else r[n+1]=Pp(a,0),0!==a&&(r[a+1]=oE(r[a+1],n)),a=n;else r[n+1]=Pp(c,0),0===a?a=n:r[c+1]=oE(r[c+1],n),c=n;l&&(r[n+1]=sE(r[n+1])),DV(r,f,n,!0),DV(r,f,n,!1),function q5e(r,e,t,n,i){const s=i?r.residualClasses:r.residualStyles;null!=s&&"string"==typeof e&&n8(s,e)>=0&&(t[n+1]=aE(t[n+1]))}(e,f,r,n,s),o=Pp(a,c),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,n)}}function cE(r,e,t,n,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=T7(n,s.hostAttrs,i),s!==r);)a++;return null!==r&&(t.directiveStylingLast=a),n}function T7(r,e,t){const n=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===n&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),Ys(r,o,!!t||e[++s]))}return void 0===r?null:r}function jV(r,e,t){Ys(r,e,Ks(t))}function ZV(r,e,t,n,i,s,o,a){if(!(3&e.type))return;const c=r.data,l=c[a+1],f=function U5e(r){return 1==(1&r)}(l)?YV(c,e,t,i,t6(l),o):void 0;Op(f)||(Op(s)||function B5e(r){return 2==(2&r)}(l)&&(s=YV(c,null,t,i,a,o)),function K6e(r,e,t,n,i){if(e)i?r.addClass(t,n):r.removeClass(t,n);else{let s=-1===n.indexOf("-")?void 0:S4.DashCase;null==i?r.removeStyle(t,n,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=S4.Important),r.setStyle(t,n,i,s))}}(n,o,Th(Qi(),t),i,s))}function YV(r,e,t,n,i,s){const o=null===e;let a;for(;i>0;){const c=r[i],l=Array.isArray(c),f=l?c[1]:c,d=null===f;let m=t[i+1];m===Xt&&(m=d?Wn:void 0);let M=d?Ky(m,n):f===n?m:void 0;if(l&&!Op(M)&&(M=Ky(c,n)),Op(M)&&(a=M,o))return a;const w=r[i+1];i=o?P4(w):t6(w)}if(null!==e){let c=s?e.residualClasses:e.residualStyles;null!=c&&(a=Ky(c,n))}return a}function Op(r){return void 0!==r}function KV(r,e){return 0!=(r.flags&(e?8:16))}function lt(r,e=""){const t=Ee(),n=Ln(),i=r+mn,s=n.firstCreatePass?p8(n,i,1,e,null):n.data[i],o=XV(n,t,s,e,r);t[i]=o,Oh()&&Zh(n,t,o,s),ic(s,!1)}let XV=(r,e,t,n,i)=>(E4(!0),Uh(e[jt],n));function Nn(r){return S2("",r,""),Nn}function S2(r,e,t){const n=Ee(),i=m8(n,r,e,t);return i!==Xt&&p3(n,Qi(),i),S2}function lE(r,e,t,n,i){const s=Ee(),o=_8(s,r,e,t,n,i);return o!==Xt&&p3(s,Qi(),o),lE}function uE(r,e,t,n,i,s,o){const a=Ee(),c=v8(a,r,e,t,n,i,s,o);return c!==Xt&&p3(a,Qi(),c),uE}function fE(r,e,t){const n=Ee();return Pi(n,Z0(),e)&&Qs(Ln(),tr(),n,r,e,n[jt],t,!0),fE}const n6=void 0;var Iue=["en",[["a","p"],["AM","PM"],n6],[["AM","PM"],n6,n6],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],n6,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],n6,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",n6,"{1} 'at' {0}",n6],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Aue(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let T8={};function ts(r){const e=function xue(r){return r.toLowerCase().replace(/_/g,"-")}(r);let t=gF(e);if(t)return t;const n=e.split("-")[0];if(t=gF(n),t)return t;if("en"===n)return Iue;throw new ge(701,!1)}function gF(r){return r in T8||(T8[r]=p1.ng&&p1.ng.common&&p1.ng.common.locales&&p1.ng.common.locales[r]),T8[r]}var O1=function(r){return r[r.LocaleId=0]="LocaleId",r[r.DayPeriodsFormat=1]="DayPeriodsFormat",r[r.DayPeriodsStandalone=2]="DayPeriodsStandalone",r[r.DaysFormat=3]="DaysFormat",r[r.DaysStandalone=4]="DaysStandalone",r[r.MonthsFormat=5]="MonthsFormat",r[r.MonthsStandalone=6]="MonthsStandalone",r[r.Eras=7]="Eras",r[r.FirstDayOfWeek=8]="FirstDayOfWeek",r[r.WeekendRange=9]="WeekendRange",r[r.DateFormat=10]="DateFormat",r[r.TimeFormat=11]="TimeFormat",r[r.DateTimeFormat=12]="DateTimeFormat",r[r.NumberSymbols=13]="NumberSymbols",r[r.NumberFormats=14]="NumberFormats",r[r.CurrencyCode=15]="CurrencyCode",r[r.CurrencySymbol=16]="CurrencySymbol",r[r.CurrencyName=17]="CurrencyName",r[r.Currencies=18]="Currencies",r[r.Directionality=19]="Directionality",r[r.PluralCase=20]="PluralCase",r[r.ExtraData=21]="ExtraData",r}(O1||{});const Lue=["zero","one","two","few","many"],O8="en-US",bp={marker:"element"},wp={marker:"ICU"};var bs=function(r){return r[r.SHIFT=2]="SHIFT",r[r.APPEND_EAGERLY=1]="APPEND_EAGERLY",r[r.COMMENT=2]="COMMENT",r}(bs||{});let mF=O8;function _F(r){(function To(r,e){null==r&&Ht(e,r,null,"!=")})(r,"Expected localeId to be defined"),"string"==typeof r&&(mF=r.toLowerCase().replace(/_/g,"-"))}function vF(r,e,t){const n=e.insertBeforeIndex,i=Array.isArray(n)?n[0]:n;return null===i?xD(r,0,t):T1(t[i])}function CF(r,e,t,n,i){const s=e.insertBeforeIndex;if(Array.isArray(s)){let o=n,a=null;if(3&e.type||(a=o,o=i),null!==o&&-1===e.componentOffset)for(let c=1;c<s.length;c++)Yl(r,o,t[s[c]],a,!1)}}function yF(r,e){if(r.push(e),r.length>1)for(let t=r.length-2;t>=0;t--){const n=r[t];MF(n)||Hue(n,e)&&null===Vue(n)&&Fue(n,e.index)}}function MF(r){return!(64&r.type)}function Hue(r,e){return MF(e)||r.index>e.index}function Vue(r){const e=r.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function Fue(r,e){const t=r.insertBeforeIndex;Array.isArray(t)?t[0]=e:(RD(vF,CF),r.insertBeforeIndex=e)}function O7(r,e){const t=r.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function Gue(r,e,t){const n=$M(r,t,64,null,null);return yF(e,n),n}function Np(r,e){const t=e[r.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function EF(r){return r>>>17}function SF(r){return(131070&r)>>>1}let b7=0,w7=0;function TF(r,e,t,n){const i=t[jt];let o,s=null;for(let a=0;a<e.length;a++){const c=e[a];if("string"==typeof c){const l=e[++a];null===t[l]&&(t[l]=Uh(i,c))}else if("number"==typeof c)switch(1&c){case 0:const l=EF(c);let f,d;if(null===s&&(s=l,o=jh(i,n)),l===s?(f=n,d=o):(f=null,d=T1(t[l])),null!==d){const L=SF(c);Yl(i,d,t[L],f,!1);const $=O7(r,L);if(null!==$&&"object"==typeof $){const B=Np($,t);null!==B&&TF(r,$.create[B],t,t[$.anchorIdx])}}break;case 1:const M=e[++a],w=e[++a];ZM(i,Th(c>>>1,t),null,null,M,w,null)}else switch(c){case wp:const l=e[++a],f=e[++a];null===t[f]&&Ei(t[f]=oM(i,l),t);break;case bp:const d=e[++a],m=e[++a];null===t[m]&&Ei(t[m]=Wh(i,d,null),t)}}}function OF(r,e,t,n,i){for(let s=0;s<t.length;s++){const o=t[s],a=t[++s];if(o&i){let c="";for(let l=s+1;l<=s+a;l++){const f=t[l];if("string"==typeof f)c+=f;else if("number"==typeof f)if(f<0)c+=qt(e[n-f]);else{const d=f>>>2;switch(3&f){case 1:const m=t[++l],M=t[++l],w=r.data[d];"string"==typeof w?ZM(e[jt],e[d],null,w,m,c,M):Qs(r,w,e,m,c,e[jt],M,!1);break;case 0:const L=e[d];null!==L&&bD(e[jt],L,c);break;case 2:Zue(r,O7(r,d),e,c);break;case 3:bF(r,O7(r,d),n,e)}}}}else{const c=t[s+1];if(c>0&&3==(3&c)){const f=O7(r,c>>>2);e[f.currentCaseLViewIndex]<0&&bF(r,f,n,e)}}s+=a}}function bF(r,e,t,n){let i=n[e.currentCaseLViewIndex];if(null!==i){let s=b7;i<0&&(i=n[e.currentCaseLViewIndex]=~i,s=-1),OF(r,n,e.update[i],t,s)}}function Zue(r,e,t,n){const i=function Yue(r,e){let t=r.cases.indexOf(e);if(-1===t)switch(r.type){case 1:{const n=function Rue(r,e){const t=function pF(r){return ts(r)[O1.PluralCase]}(e)(parseInt(r,10)),n=Lue[t];return void 0!==n?n:"other"}(e,function Due(){return mF}());t=r.cases.indexOf(n),-1===t&&"other"!==n&&(t=r.cases.indexOf("other"));break}case 0:t=r.cases.indexOf("other")}return-1===t?null:t}(e,n);if(Np(e,t)!==i&&(wF(r,e,t),t[e.currentCaseLViewIndex]=null===i?null:~i,null!==i)){const o=t[e.anchorIdx];o&&TF(r,e.create[i],t,o)}}function wF(r,e,t){let n=Np(e,t);if(null!==n){const i=e.remove[n];for(let s=0;s<i.length;s++){const o=i[s];if(o>0){const a=Th(o,t);null!==a&&Yh(t[jt],a)}else wF(r,O7(r,~o),t)}}}function Kue(){const r=[];let t,n,e=-1;function s(a,c){e=0;const l=Np(a,c);n=null!==l?a.remove[l]:Wn}function o(){if(e<n.length){const a=n[e++];return a>0?t[a]:(r.push(e,n),s(t[et].data[~a],t),o())}return 0===r.length?null:(n=r.pop(),e=r.pop(),o())}return function i(a,c){for(t=c;r.length;)r.pop();return s(a.value,c),o}}const Ap=/\ufffd(\d+):?\d*\ufffd/gi,Que=/\ufffd(\d+)\ufffd/,AF=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,N7="\ufffd",Jue=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,e7e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,t7e=/\uE500/g;function IF(r,e,t,n,i,s,o){const a=m7(r,n,1,null);let c=a<<bs.SHIFT,l=Yu();e===l&&(l=null),null===l&&(c|=bs.APPEND_EAGERLY),o&&(c|=bs.COMMENT,function R6e(r){void 0===iM&&(iM=r())}(Kue)),i.push(c,null===s?"":s);const f=$M(r,a,o?32:1,null===s?"":s,null);yF(t,f);const d=f.index;return ic(f,!1),null!==l&&e!==l&&function Bue(r,e){let t=r.insertBeforeIndex;null===t?(RD(vF,CF),t=r.insertBeforeIndex=[null,e]):(function Ul(r,e,t){r!=e&&Ht(t,r,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(l,d),f}function i7e(r,e,t,n,i,s,o){const a=o.match(Ap),c=IF(r,e,t,s,n,a?null:o,!1);a&&A7(i,o,c.index,null,0,null)}function A7(r,e,t,n,i,s){const o=r.length,a=o+1;r.push(null,null);const c=o+2,l=e.split(Ap);let f=0;for(let d=0;d<l.length;d++){const m=l[d];if(1&d){const M=i+parseInt(m,10);r.push(-1-M),f|=kF(M)}else""!==m&&r.push(m)}return r.push(t<<2|(n?1:0)),n&&r.push(n,s),r[o]=f,r[a]=r.length-c,f}function kF(r){return 1<<Math.min(r,31)}function xF(r){let e,s,t="",n=0,i=!1;for(;null!==(e=Jue.exec(r));)i?e[0]===`${N7}/*${s}${N7}`&&(n=e.index,i=!1):(t+=r.substring(n,e.index+e[0].length),s=e[1],i=!0);return t+=r.slice(n),t}function LF(r,e,t,n,i,s){let o=0;const a={type:i.type,currentCaseLViewIndex:m7(r,e,1,null),anchorIdx:s,cases:[],create:[],remove:[],update:[]};(function d7e(r,e,t){r.push(kF(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,i,s),function $ue(r,e,t){const n=r.data[e];null===n?r.data[e]=t:n.value=t}(r,s,a);const c=i.values;for(let l=0;l<c.length;l++){const f=c[l],d=[];for(let m=0;m<f.length;m++){const M=f[m];if("string"!=typeof M){const w=d.push(M)-1;f[m]=`\x3c!--\ufffd${w}\ufffd--\x3e`}}o=u7e(r,a,e,t,n,i.cases[l],f.join(""),d)|o}o&&function h7e(r,e,t){r.push(e,1,t<<2|3)}(t,o,s)}function l7e(r){const e=[],t=[];let n=1,i=0;const s=dE(r=r.replace(AF,function(o,a,c){return n="select"===c?0:1,i=parseInt(a.slice(1),10),""}));for(let o=0;o<s.length;){let a=s[o++].trim();1===n&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);const c=dE(s[o++]);e.length>t.length&&t.push(c)}return{type:n,mainBinding:i,cases:e,values:t}}function dE(r){if(!r)return[];let e=0;const t=[],n=[],i=/[{}]/g;let s;for(i.lastIndex=0;s=i.exec(r);){const a=s.index;if("}"==s[0]){if(t.pop(),0==t.length){const c=r.substring(e,a);AF.test(c)?n.push(l7e(c)):n.push(c),e=a+1}}else{if(0==t.length){const c=r.substring(e,a);n.push(c),e=a+1}t.push("{")}}const o=r.substring(e);return n.push(o),n}function u7e(r,e,t,n,i,s,o,a){const c=[],l=[],f=[];e.cases.push(s),e.create.push(c),e.remove.push(l),e.update.push(f);const m=UD(a8()).getInertBodyElement(o),M=vM(m)||m;return M?RF(r,e,t,n,c,l,f,M,i,a,0):0}function RF(r,e,t,n,i,s,o,a,c,l,f){let d=0,m=a.firstChild;for(;m;){const M=m7(r,t,1,null);switch(m.nodeType){case Node.ELEMENT_NODE:const w=m,L=w.tagName.toLowerCase();if(mM.hasOwnProperty(L)){hE(i,bp,L,c,M),r.data[M]=L;const de=w.attributes;for(let _e=0;_e<de.length;_e++){const xe=de.item(_e),nt=xe.name.toLowerCase();xe.value.match(Ap)?ZD.hasOwnProperty(nt)&&A7(o,xe.value,M,xe.name,0,_M[nt]?Qh:null):p7e(i,M,xe)}d=RF(r,e,t,n,i,s,o,m,M,l,f+1)|d,zF(s,M,f)}break;case Node.TEXT_NODE:const z=m.textContent||"",$=z.match(Ap);hE(i,null,$?"":z,c,M),zF(s,M,f),$&&(d=A7(o,z,M,null,0,null)|d);break;case Node.COMMENT_NODE:const B=Que.exec(m.textContent||"");if(B){const _e=l[parseInt(B[1],10)];hE(i,wp,"",c,M),LF(r,t,n,c,_e,M),f7e(s,M,f)}}m=m.nextSibling}return d}function zF(r,e,t){0===t&&r.push(e)}function f7e(r,e,t){0===t&&(r.push(~e),r.push(e))}function hE(r,e,t,n,i){null!==e&&r.push(e),r.push(t,i,function Uue(r,e,t){return r|e<<17|t<<1}(0,n,i))}function p7e(r,e,t){r.push(e<<1|1,t.name,t.value)}function ws(r,e,t=-1){const n=Ln(),i=Ee(),s=mn+r,o=M4(n.consts,e),a=Yu();n.firstCreatePass&&function r7e(r,e,t,n,i,s){const o=Yu(),a=[],c=[],l=[[]];i=function c7e(r,e){if(function a7e(r){return-1===r}(e))return xF(r);{const t=r.indexOf(`:${e}${N7}`)+2+e.toString().length,n=r.search(new RegExp(`${N7}\\/\\*\\d+:${e}${N7}`));return xF(r.substring(t,n))}}(i,s);const f=function n7e(r){return r.replace(t7e," ")}(i).split(e7e);for(let d=0;d<f.length;d++){let m=f[d];if(1&d){const M=47===m.charCodeAt(0),L=(m.charCodeAt(M?1:0),mn+Number.parseInt(m.substring(M?2:1)));if(M)l.shift(),ic(Yu(),!1);else{const z=Gue(r,l[0],L);l.unshift([]),ic(z,!0)}}else{const M=dE(m);for(let w=0;w<M.length;w++){let L=M[w];if(1&w){const z=L;if("object"!=typeof z)throw new Error(`Unable to parse ICU expression in "${i}" message.`);LF(r,t,c,e,z,IF(r,o,l[0],t,a,"",!0).index)}else""!==L&&i7e(r,o,l[0],a,c,t,L)}}}r.data[n]={create:a,update:c}}(n,null===a?0:a.index,i,s,o,t),2===n.type?i[Ar][Kt]|=32:i[Kt]|=32;const c=n.data[s],f=ND(n,a===i[Mi]?null:a,i);(function jue(r,e,t,n){const i=r[jt];for(let s=0;s<e.length;s++){const o=e[s++],a=e[s],l=(o&bs.APPEND_EAGERLY)===bs.APPEND_EAGERLY,f=o>>>bs.SHIFT;let d=r[f];null===d&&(d=r[f]=(o&bs.COMMENT)===bs.COMMENT?i.createComment(a):Uh(i,a)),l&&null!==t&&Yl(i,t,d,n,!1)}})(i,c.create,f,a&&8&a.type?i[a.index]:null),Rz(!0)}function Ns(){Rz(!1)}function oe(r,e,t){ws(r,e,t),Ns()}function $n(r){return function Wue(r){r&&(b7|=1<<Math.min(w7,31)),w7++}(Pi(Ee(),Z0(),r)),$n}function qn(r){!function que(r,e,t){if(w7>0){const n=r.data[t];OF(r,e,Array.isArray(n)?n:n.update,l3()-w7-1,b7)}b7=0,w7=0}(Ln(),Ee(),r+mn)}function pE(r,e,t,n,i){if(r=$t(r),Array.isArray(r))for(let s=0;s<r.length;s++)pE(r[s],e,t,n,i);else{const s=Ln(),o=Ee(),a=X2();let c=Xl(r)?r:$t(r.provide);const l=sH(r),f=1048575&a.providerIndexes,d=a.directiveStart,m=a.providerIndexes>>20;if(Xl(r)||!r.multi){const M=new Ku(l,i,G),w=mE(c,e,i?f:f+m,d);-1===w?(jy(Ih(a,o),s,c),gE(s,r,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(M),o.push(M)):(t[w]=M,o[w]=M)}else{const M=mE(c,e,f+m,d),w=mE(c,e,f,f+m),z=w>=0&&t[w];if(i&&!z||!i&&!(M>=0&&t[M])){jy(Ih(a,o),s,c);const $=function N7e(r,e,t,n,i){const s=new Ku(r,t,G);return s.multi=[],s.index=e,s.componentProviders=0,HF(s,i,n&&!t),s}(i?w7e:b7e,t.length,i,n,l);!i&&z&&(t[w].providerFactory=$),gE(s,r,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push($),o.push($)}else gE(s,r,M>-1?M:w,HF(t[i?w:M],l,!i&&n));!i&&n&&z&&t[w].componentProviders++}}}function gE(r,e,t,n){const i=Xl(e),s=function N0e(r){return!!r.useClass}(e);if(i||s){const c=(s?$t(e.useClass):e).prototype.ngOnDestroy;if(c){const l=r.destroyHooks||(r.destroyHooks=[]);if(!i&&e.multi){const f=l.indexOf(t);-1===f?l.push(t,[n,c]):l[f+1].push(n,c)}else l.push(t,c)}}}function HF(r,e,t){return t&&r.componentProviders++,r.multi.push(e)-1}function mE(r,e,t,n){for(let i=t;i<n;i++)if(e[i]===r)return i;return-1}function b7e(r,e,t,n){return _E(this.multi,[])}function w7e(r,e,t,n){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Zl(t,t[et],this.providerFactory.index,n);s=a.slice(0,o),_E(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],_E(i,s);return s}function _E(r,e){for(let t=0;t<r.length;t++)e.push((0,r[t])());return e}function j1(r,e=[]){return t=>{t.providersResolver=(n,i)=>function O7e(r,e,t){const n=Ln();if(n.firstCreatePass){const i=la(r);pE(t,n.data,n.blueprint,i,!0),pE(e,n.data,n.blueprint,i,!1)}}(n,i?i(r):r,e)}}class r6{}class VF{}class vE extends r6{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new eV(this);const i=js(e);this._bootstrapComponents=h3(i.bootstrap),this._r3Injector=yH(e,t,[{provide:r6,useValue:this},{provide:fp,useValue:this.componentFactoryResolver},...n],n2(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class CE extends VF{constructor(e){super(),this.moduleType=e}create(e){return new vE(this.moduleType,e,[])}}class FF extends r6{constructor(e){super(),this.componentFactoryResolver=new eV(this),this.instance=null;const t=new ip([...e.providers,{provide:r6,useValue:this},{provide:fp,useValue:this.componentFactoryResolver}],e.parent||rp(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function yE(r,e,t=null){return new FF({providers:r,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let k7e=(()=>{var r;class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const i=tH(0,n.type),s=i.length>0?yE([i],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}}return(r=e).\u0275prov=De({token:r,providedIn:"environment",factory:()=>new r(Pe(Xs))}),e})();function $F(r){r.getStandaloneInjector=e=>e.get(k7e).getOrCreateStandaloneInjector(r)}function g1(r,e,t){const n=Xi()+r,i=Ee();return i[n]===Xt?lc(i,n,t?e.call(t):e()):function y7(r,e){return r[e]}(i,n)}function da(r,e,t,n){return ZF(Ee(),Xi(),r,e,t,n)}function I7(r,e){const t=r[e];return t===Xt?void 0:t}function ZF(r,e,t,n,i,s){const o=e+t;return Pi(r,o,i)?lc(r,o+1,s?n.call(s,i):n(i)):I7(r,o+1)}function ha(r,e){const t=Ln();let n;const i=r+mn;t.firstCreatePass?(n=function Y7e(r,e){if(e)for(let t=e.length-1;t>=0;t--){const n=e[t];if(r===n.name)return n}}(e,t.pipeRegistry),t.data[i]=n,n.onDestroy&&(t.destroyHooks??=[]).push(i,n.onDestroy)):n=t.data[i];const s=n.factory||(n.factory=ql(n.type)),a=Es(G);try{const c=Ah(!1),l=s();return Ah(c),function x5e(r,e,t,n){t>=r.data.length&&(r.data[t]=null,r.blueprint[t]=null),e[t]=n}(t,Ee(),i,l),l}finally{Es(a)}}function fc(r,e,t){const n=r+mn,i=Ee(),s=q0(i,n);return k7(i,n)?ZF(i,Xi(),e,s.transform,t,s):s.transform(t)}function JF(r,e,t,n){const i=r+mn,s=Ee(),o=q0(s,i);return k7(s,i)?function YF(r,e,t,n,i,s,o){const a=e+t;return Jl(r,a,i,s)?lc(r,a+2,o?n.call(o,i,s):n(i,s)):I7(r,a+2)}(s,Xi(),e,o.transform,t,n,o):o.transform(t,n)}function k7(r,e){return r[et].data[e].pure}function EE(r){return e=>{setTimeout(r,void 0,e)}}const b1=class J7e extends Ms{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i=e,s=t||(()=>null),o=n;if(e&&"object"==typeof e){const c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=EE(s),i&&(i=EE(i)),o&&(o=EE(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof En&&e.add(a),a}};function efe(){return this._results[Symbol.iterator]()}class SE{get changes(){return this._changes||(this._changes=new b1)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=SE.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=efe)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const i=function bo(r){return r.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function Jle(r,e,t){if(r.length!==e.length)return!1;for(let n=0;n<r.length;n++){let i=r[n],s=e[n];if(t&&(i=t(i),s=t(s)),s!==i)return!1}return!0}(n._results,i,t))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function nfe(r,e,t,n=!0){const i=e[et];if(function B6e(r,e,t,n){const i=K2+n,s=t.length;n>0&&(t[i-1][ca]=e),n<s-K2?(e[ca]=t[i],rD(t,K2+n,e)):(t.push(e),e[ca]=null),e[q1]=t;const o=e[qu];null!==o&&t!==o&&function G6e(r,e){const t=r[W0];e[Ar]!==e[q1][q1][Ar]&&(r[fz]=!0),null===t?r[W0]=[e]:t.push(e)}(o,e);const a=e[ec];null!==a&&a.insertView(r),e[Kt]|=128}(i,e,r,t),n){const s=fM(t,r),o=e[jt],a=jh(o,r[tc]);null!==a&&function V6e(r,e,t,n,i,s){n[wr]=i,n[Mi]=e,o7(r,n,t,1,i,s)}(i,r[Mi],o,e,a,s)}}let g3=(()=>{class e{}return e.__NG_ELEMENT_ID__=sfe,e})();const rfe=g3,ife=class extends rfe{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){const i=function tfe(r,e,t,n){const i=e.tView,a=pp(r,i,t,4096&r[Kt]?4096:16,null,e,null,null,null,n?.injector??null,n?.hydrationInfo??null);a[qu]=r[e.index];const l=r[ec];return null!==l&&(a[ec]=l.createEmbeddedView(i)),XM(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:n});return new v7(i)}};function sfe(){return Ip(X2(),Ee())}function Ip(r,e){return 4&r.type?new ife(e,r,u8(r,e)):null}let Js=(()=>{class e{}return e.__NG_ELEMENT_ID__=ffe,e})();function ffe(){return o$(X2(),Ee())}const dfe=Js,i$=class extends dfe{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return u8(this._hostTNode,this._hostLView)}get injector(){return new Ji(this._hostTNode,this._hostLView)}get parentInjector(){const e=kh(this._hostTNode,this._hostLView);if(Uy(e)){const t=Qu(e,this._hostLView),n=Xu(e);return new Ji(t[et].data[n+8],t)}return new Ji(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=s$(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-K2}createEmbeddedView(e,t,n){let i,s;"number"==typeof n?i=n:null!=n&&(i=n.index,s=n.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,t,n,i,s){const o=e&&!function e7(r){return"function"==typeof r}(e);let a;if(o)a=t;else{const L=t||{};a=L.index,n=L.injector,i=L.projectableNodes,s=L.environmentInjector||L.ngModuleRef}const c=o?e:new C7(xn(e)),l=n||this.parentInjector;if(!s&&null==c.ngModule){const z=(o?l:this.parentInjector).get(Xs,null);z&&(s=z)}xn(c.componentType??{});const M=c.create(l,i,null,s);return this.insertImpl(M.hostView,a,false),M}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,n){const i=e._lView;if(function ple(r){return Ps(r[q1])}(i)){const c=this.indexOf(e);if(-1!==c)this.detach(c);else{const l=i[q1],f=new i$(l,l[Mi],l[q1]);f.detach(f.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return nfe(a,i,o,!n),e.attachToViewContainerRef(),rD(PE(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=s$(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=qh(this._lContainer,t);n&&(Rh(PE(this._lContainer),t),aM(n[et],n))}detach(e){const t=this._adjustIndex(e,-1),n=qh(this._lContainer,t);return n&&null!=Rh(PE(this._lContainer),t)?new v7(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function s$(r){return r[8]}function PE(r){return r[8]||(r[8]=[])}function o$(r,e){let t;const n=e[r.index];return Ps(n)?t=n:(t=GH(n,e,null,r),e[r.index]=t,gp(e,t)),a$(t,e,r,n),new i$(t,r,e)}let a$=function c$(r,e,t,n){if(r[tc])return;let i;i=8&t.type?T1(n):function hfe(r,e){const t=r[jt],n=t.createComment(""),i=Ts(e,r);return Yl(t,jh(t,i),n,function j6e(r,e){return r.nextSibling(e)}(t,i),!1),n}(e,t),r[tc]=i};class TE{constructor(e){this.queryList=e,this.matches=null}clone(){return new TE(this.queryList)}setDirty(){this.queryList.setDirty()}}class OE{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);i.push(this.queries[o.indexInDeclarationView].clone())}return new OE(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==p$(e,t).matches&&this.queries[t].setDirty()}}class l${constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class bE{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,i);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new bE(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class wE{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new wE(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const s=n[i];this.matchTNodeWithReadOption(e,t,mfe(t,s)),this.matchTNodeWithReadOption(e,t,xh(t,e,s,!1,!1))}else n===g3?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,xh(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Si||i===Js||i===g3&&4&t.type)this.addMatch(t.index,-2);else{const s=xh(t,e,i,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function mfe(r,e){const t=r.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function vfe(r,e,t,n){return-1===t?function _fe(r,e){return 11&r.type?u8(r,e):4&r.type?Ip(r,e):null}(e,r):-2===t?function Cfe(r,e,t){return t===Si?u8(e,r):t===g3?Ip(e,r):t===Js?o$(e,r):void 0}(r,e,n):Zl(r,r[et],t,e)}function u$(r,e,t,n){const i=e[ec].queries[n];if(null===i.matches){const s=r.data,o=t.matches,a=[];for(let c=0;c<o.length;c+=2){const l=o[c];a.push(l<0?null:vfe(e,s[l],o[c+1],t.metadata.read))}i.matches=a}return i.matches}function NE(r,e,t,n){const i=r.queries.getByIndex(t),s=i.matches;if(null!==s){const o=u$(r,e,i,t);for(let a=0;a<s.length;a+=2){const c=s[a];if(c>0)n.push(o[a/2]);else{const l=s[a+1],f=e[-c];for(let d=K2;d<f.length;d++){const m=f[d];m[qu]===m[q1]&&NE(m[et],m,l,n)}if(null!==f[W0]){const d=f[W0];for(let m=0;m<d.length;m++){const M=d[m];NE(M[et],M,l,n)}}}}}return n}function m3(r){const e=Ee(),t=Ln(),n=zz();Vy(n+1);const i=p$(t,n);if(r.dirty&&function dle(r){return 4==(4&r[Kt])}(e)===(2==(2&i.metadata.flags))){if(null===i.matches)r.reset([]);else{const s=i.crossesNgTemplate?NE(t,e,n,[]):u$(t,e,i,n);r.reset(s,K0e),r.notifyOnChanges()}return!0}return!1}function T4(r,e,t){const n=Ln();n.firstCreatePass&&(function h$(r,e,t){null===r.queries&&(r.queries=new bE),r.queries.track(new wE(e,t))}(n,new l$(r,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function d$(r,e,t){const n=new SE(4==(4&t));(function y8e(r,e,t,n){const i=WH(e);i.push(t),r.firstCreatePass&&qH(r).push(n,i.length-1)})(r,e,n,n.destroy),null===e[ec]&&(e[ec]=new OE),e[ec].queries.push(new TE(n))}(n,Ee(),e)}function _3(){return function yfe(r,e){return r[ec].queries[e].queryList}(Ee(),zz())}function p$(r,e){return r.queries.getByIndex(e)}function dn(r,e){return Ip(r,e)}const RE=new tt("Application Initializer");let zE=(()=>{var r;class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,i)=>{this.resolve=n,this.reject=i}),this.appInits=rt(RE,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const n=[];for(const s of this.appInits){const o=s();if(P7(o))n.push(o);else if(SV(o)){const a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});n.push(a)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{i()}).catch(s=>{this.reject(s)}),0===n.length&&i(),this.initialized=!0}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),I$=(()=>{var r;class e{log(n){console.log(n)}warn(n){console.warn(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();const dc=new tt("LocaleId",{providedIn:"root",factory:()=>rt(dc,cn.Optional|cn.SkipSelf)||function Bfe(){return typeof $localize<"u"&&$localize.locale||O8}()});let Lp=(()=>{var r;class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Zi(!1)}add(){this.hasPendingTasks.next(!0);const n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class Wfe{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let k$=(()=>{var r;class e{compileModuleSync(n){return new CE(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const i=this.compileModuleSync(n),o=h3(js(n).declarations).reduce((a,c)=>{const l=xn(c);return l&&a.push(new C7(l)),a},[]);return new Wfe(i,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function z$(...r){}class i1{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new b1(!1),this.onMicrotaskEmpty=new b1(!1),this.onStable=new b1(!1),this.onError=new b1(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&t,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function f9e(){const r="function"==typeof p1.requestAnimationFrame;let e=p1[r?"requestAnimationFrame":"setTimeout"],t=p1[r?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function p9e(r){const e=()=>{!function h9e(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(p1,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,FE(r),r.isCheckStableRunning=!0,VE(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),FE(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,i,s,o,a)=>{try{return D$(r),t.invokeTask(i,s,o,a)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||r.shouldCoalesceRunChangeDetection)&&e(),H$(r)}},onInvoke:(t,n,i,s,o,a,c)=>{try{return D$(r),t.invoke(i,s,o,a,c)}finally{r.shouldCoalesceRunChangeDetection&&e(),H$(r)}},onHasTask:(t,n,i,s)=>{t.hasTask(i,s),n===i&&("microTask"==s.change?(r._hasPendingMicrotasks=s.microTask,FE(r),VE(r)):"macroTask"==s.change&&(r.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,i,s)=>(t.handleError(i,s),r.runOutsideAngular(()=>r.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!i1.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(i1.isInAngularZone())throw new ge(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,d9e,z$,z$);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const d9e={};function VE(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function FE(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function D$(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function H$(r){r._nesting--,VE(r)}class g9e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new b1,this.onMicrotaskEmpty=new b1,this.onStable=new b1,this.onError=new b1}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}const V$=new tt("",{providedIn:"root",factory:F$});function F$(){const r=rt(i1);let e=!0;return function u4e(...r){const e=Vu(r),t=function r4e(r,e){return"number"==typeof ly(r)?r.pop():e}(r,1/0),n=r;return n.length?1===n.length?Ws(n[0]):H0(t)(t2(n,e)):Qa}(new S1(i=>{e=r.isStable&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks,r.runOutsideAngular(()=>{i.next(e),i.complete()})}),new S1(i=>{let s;r.runOutsideAngular(()=>{s=r.onStable.subscribe(()=>{i1.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!r.hasPendingMacrotasks&&!r.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=r.onUnstable.subscribe(()=>{i1.assertInAngularZone(),e&&(e=!1,r.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe($R()))}const $$=new tt(""),zp=new tt("");let GE,$E=(()=>{var r;class e{constructor(n,i,s){this._ngZone=n,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,GE||(function m9e(r){GE=r}(s),s.addToWindow(i)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{i1.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb(this._didWork)}this._didWork=!1});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(n)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),n(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:s})}whenStable(n,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,i,s){return[]}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(i1),Pe(BE),Pe(zp))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),BE=(()=>{var r;class e{constructor(){this._applications=new Map}registerApplication(n,i){this._applications.set(n,i)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,i=!0){return GE?.findTestabilityInTree(this,n,i)??null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})(),O4=null;const B$=new tt("AllowMultipleToken"),UE=new tt("PlatformDestroyListeners"),WE=new tt("appBootstrapListener");class U${constructor(e,t){this.name=e,this.token=t}}function q$(r,e,t=[]){const n=`Platform: ${e}`,i=new tt(n);return(s=[])=>{let o=qE();if(!o||o.injector.get(B$,!1)){const a=[...t,...s,{provide:i,useValue:!0}];r?r(a):function C9e(r){if(O4&&!O4.get(B$,!1))throw new ge(400,!1);(function G$(){!function nle(r){_z=r}(()=>{throw new ge(600,!1)})})(),O4=r;const e=r.get(Z$);(function W$(r){r.get(oH,null)?.forEach(t=>t())})(r)}(function j$(r=[],e){return Q2.create({name:e,providers:[{provide:SM,useValue:"platform"},{provide:UE,useValue:new Set([()=>O4=null])},...r]})}(a,n))}return function M9e(r){const e=qE();if(!e)throw new ge(401,!1);return e}()}}function qE(){return O4?.get(Z$)??null}let Z$=(()=>{var r;class e{constructor(n){this._injector=n,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(n,i){const s=function E9e(r="zone.js",e){return"noop"===r?new g9e:"zone.js"===r?new i1(e):r}(i?.ngZone,function Y$(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:r?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:r?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{const o=function I7e(r,e,t){return new vE(r,e,t)}(n.moduleType,this.injector,function eB(r){return[{provide:i1,useFactory:r},{provide:u7,multi:!0,useFactory:()=>{const e=rt(P9e,{optional:!0});return()=>e.initialize()}},{provide:J$,useFactory:S9e},{provide:V$,useFactory:F$}]}(()=>s)),a=o.injector.get(Ql,null);return s.runOutsideAngular(()=>{const c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Dp(this._modules,o),c.unsubscribe()})}),function K$(r,e,t){try{const n=t();return P7(n)?n.catch(i=>{throw e.runOutsideAngular(()=>r.handleError(i)),i}):n}catch(n){throw e.runOutsideAngular(()=>r.handleError(n)),n}}(a,s,()=>{const c=o.injector.get(zE);return c.runInitializers(),c.donePromise.then(()=>(_F(o.injector.get(dc,O8)||O8),this._moduleDoBootstrap(o),o))})})}bootstrapModule(n,i=[]){const s=X$({},i);return function _9e(r,e,t){const n=new CE(t);return Promise.resolve(n)}(0,0,n).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(n){const i=n.injector.get(i6);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!n.instance.ngDoBootstrap)throw new ge(-403,!1);n.instance.ngDoBootstrap(i)}this._modules.push(n)}onDestroy(n){this._destroyListeners.push(n)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const n=this._injector.get(UE,null);n&&(n.forEach(i=>i()),n.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(Q2))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"platform"}),e})();function X$(r,e){return Array.isArray(e)?e.reduce(X$,r):{...r,...e}}let i6=(()=>{var r;class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=rt(J$),this.zoneIsStable=rt(V$),this.componentTypes=[],this.components=[],this.isStable=rt(Lp).hasPendingTasks.pipe(oa(n=>n?Dt(!1):this.zoneIsStable),function f4e(r,e=Xa){return r=r??d4e,Wr((t,n)=>{let i,s=!0;t.subscribe(dr(n,o=>{const a=e(o);(s||!r(i,a))&&(s=!1,i=a,n.next(o))}))})}(),$R()),this._injector=rt(Xs)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,i){const s=n instanceof hH;if(!this._injector.get(zE).done)throw!s&&function F0(r){const e=xn(r)||Y2(r)||Yi(r);return null!==e&&e.standalone}(n),new ge(405,!1);let a;a=s?n:this._injector.get(fp).resolveComponentFactory(n),this.componentTypes.push(a.componentType);const c=function v9e(r){return r.isBoundToModule}(a)?void 0:this._injector.get(r6),f=a.create(Q2.NULL,[],i||a.selector,c),d=f.location.nativeElement,m=f.injector.get($$,null);return m?.registerApplication(d),f.onDestroy(()=>{this.detachView(f.hostView),Dp(this.components,f),m?.unregisterApplication(d)}),this._loadComponent(f),f}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let n of this._views)n.detectChanges()}catch(n){this.internalErrorHandler(n)}finally{this._runningTick=!1}}attachView(n){const i=n;this._views.push(i),i.attachToAppRef(this)}detachView(n){const i=n;Dp(this._views,i),i.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);const i=this._injector.get(WE,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Dp(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new ge(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function Dp(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}const J$=new tt("",{providedIn:"root",factory:()=>rt(Ql).handleError.bind(void 0)});function S9e(){const r=rt(i1),e=rt(Ql);return t=>r.runOutsideAngular(()=>e.handleError(t))}let P9e=(()=>{var r;class e{constructor(){this.zone=rt(i1),this.applicationRef=rt(i6)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();let s6=(()=>{class e{}return e.__NG_ELEMENT_ID__=O9e,e})();function O9e(r){return function b9e(r,e,t){if(Wl(r)&&!t){const n=Zs(r.index,e);return new v7(n,n)}return 47&r.type?new v7(e[Ar],e):null}(X2(),Ee(),16==(16&r))}class iB{constructor(){}supports(e){return Cp(e)}create(e){return new x9e(e)}}const k9e=(r,e)=>e;class x9e{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||k9e}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<oB(n,i,s)?t:n,a=oB(o,i,s),c=o.currentIndex;if(o===n)i--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const l=a-i,f=c-i;if(l!=f){for(let m=0;m<l;m++){const M=m<s.length?s[m]:s[m]=0,w=M+m;f<=w&&w<l&&(s[m]=M+1)}s[o.previousIndex]=f-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Cp(e))throw new ge(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else i=0,function d5e(r,e){if(Array.isArray(r))for(let t=0;t<r.length;t++)e(r[t]);else{const t=r[Symbol.iterator]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),n=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new L9e(t,n),s,i),e}_verifyReinsertion(e,t,n,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new sB),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new sB),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class L9e{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class R9e{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class sB{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new R9e,this.map.set(t,n)),n.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function oB(r,e,t){const n=r.previousIndex;if(null===n)return n;let i=0;return t&&n<t.length&&(i=t[n]),n+e+i}class aB{constructor(){}supports(e){return e instanceof Map||QM(e)}create(){return new z9e}}class z9e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||QM(e)))throw new ge(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(i,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const n=new D9e(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class D9e{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function cB(){return new Fp([new iB])}let Fp=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(null!=i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||cB()),deps:[[e,new Dh,new es]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(null!=i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:cB}),e})();function lB(){return new R7([new aB])}let R7=(()=>{var r;class e{constructor(n){this.factories=n}static create(n,i){if(i){const s=i.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:i=>e.create(n,i||lB()),deps:[[e,new Dh,new es]]}}find(n){const i=this.factories.find(s=>s.supports(n));if(i)return i;throw new ge(901,!1)}}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:lB}),e})();const F9e=q$(null,"core",[]);let $9e=(()=>{var r;class e{constructor(n){}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(i6))},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({}),e})();function N8(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}let QE=null;function b4(){return QE}class tde{}const P2=new tt("DocumentToken");let JE=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return rt(rde)},providedIn:"platform"}),e})();const nde=new tt("Location Initialized");let rde=(()=>{var r;class e extends JE{constructor(){super(),this._doc=rt(P2),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return b4().getBaseHref(this._doc)}onPopState(n){const i=b4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",n,!1),()=>i.removeEventListener("popstate",n)}onHashChange(n){const i=b4().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",n,!1),()=>i.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,i,s){this._history.pushState(n,i,s)}replaceState(n,i,s){this._history.replaceState(n,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new r},providedIn:"platform"}),e})();function eS(r,e){if(0==r.length)return e;if(0==e.length)return r;let t=0;return r.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?r+e.substring(1):1==t?r+e:r+"/"+e}function _B(r){const e=r.match(/#|\?|$/),t=e&&e.index||r.length;return r.slice(0,t-("/"===r[t-1]?1:0))+r.slice(t)}function v3(r){return r&&"?"!==r[0]?"?"+r:r}let a6=(()=>{var r;class e{historyGo(n){throw new Error("Not implemented")}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return rt(CB)},providedIn:"root"}),e})();const vB=new tt("appBaseHref");let CB=(()=>{var r;class e extends a6{constructor(n,i){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??rt(P2).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return eS(this._baseHref,n)}path(n=!1){const i=this._platformLocation.pathname+v3(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${i}${s}`:i}pushState(n,i,s,o){const a=this.prepareExternalUrl(s+v3(o));this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){const a=this.prepareExternalUrl(s+v3(o));this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(JE),Pe(vB,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),ide=(()=>{var r;class e extends a6{constructor(n,i){super(),this._platformLocation=n,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}path(n=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(n){const i=eS(this._baseHref,n);return i.length>0?"#"+i:i}pushState(n,i,s,o){let a=this.prepareExternalUrl(s+v3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(n,i,a)}replaceState(n,i,s,o){let a=this.prepareExternalUrl(s+v3(o));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(n,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(JE),Pe(vB,8))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),tS=(()=>{var r;class e{constructor(n){this._subject=new b1,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;const i=this._locationStrategy.getBaseHref();this._basePath=function ade(r){if(new RegExp("^(https?:)?//").test(r)){const[,t]=r.split(/\/\/[^\/]+/);return t}return r}(_B(yB(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,i=""){return this.path()==this.normalize(n+v3(i))}normalize(n){return e.stripTrailingSlash(function ode(r,e){if(!r||!e.startsWith(r))return e;const t=e.substring(r.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,yB(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,i="",s=null){this._locationStrategy.pushState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+v3(i)),s)}replaceState(n,i="",s=null){this._locationStrategy.replaceState(s,"",n,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+v3(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",i){this._urlChangeListeners.forEach(s=>s(n,i))}subscribe(n,i,s){return this._subject.subscribe({next:n,error:i,complete:s})}}return(r=e).normalizeQueryParams=v3,r.joinWithSlash=eS,r.stripTrailingSlash=_B,r.\u0275fac=function(n){return new(n||r)(Pe(a6))},r.\u0275prov=De({token:r,factory:function(){return function sde(){return new tS(Pe(a6))}()},providedIn:"root"}),e})();function yB(r){return r.replace(/\/index.html$/,"")}var Bp=function(r){return r[r.Decimal=0]="Decimal",r[r.Percent=1]="Percent",r[r.Currency=2]="Currency",r[r.Scientific=3]="Scientific",r}(Bp||{}),rs=function(r){return r[r.Format=0]="Format",r[r.Standalone=1]="Standalone",r}(rs||{}),m1=function(r){return r[r.Narrow=0]="Narrow",r[r.Abbreviated=1]="Abbreviated",r[r.Wide=2]="Wide",r[r.Short=3]="Short",r}(m1||{}),eo=function(r){return r[r.Short=0]="Short",r[r.Medium=1]="Medium",r[r.Long=2]="Long",r[r.Full=3]="Full",r}(eo||{}),Ir=function(r){return r[r.Decimal=0]="Decimal",r[r.Group=1]="Group",r[r.List=2]="List",r[r.PercentSign=3]="PercentSign",r[r.PlusSign=4]="PlusSign",r[r.MinusSign=5]="MinusSign",r[r.Exponential=6]="Exponential",r[r.SuperscriptingExponent=7]="SuperscriptingExponent",r[r.PerMille=8]="PerMille",r[r.Infinity=9]="Infinity",r[r.NaN=10]="NaN",r[r.TimeSeparator=11]="TimeSeparator",r[r.CurrencyDecimal=12]="CurrencyDecimal",r[r.CurrencyGroup=13]="CurrencyGroup",r}(Ir||{});function Gp(r,e){return Io(ts(r)[O1.DateFormat],e)}function Up(r,e){return Io(ts(r)[O1.TimeFormat],e)}function Wp(r,e){return Io(ts(r)[O1.DateTimeFormat],e)}function Ao(r,e){const t=ts(r),n=t[O1.NumberSymbols][e];if(typeof n>"u"){if(e===Ir.CurrencyDecimal)return t[O1.NumberSymbols][Ir.Decimal];if(e===Ir.CurrencyGroup)return t[O1.NumberSymbols][Ir.Group]}return n}function EB(r){if(!r[O1.ExtraData])throw new Error(`Missing extra locale data for the locale "${r[O1.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Io(r,e){for(let t=e;t>-1;t--)if(typeof r[t]<"u")return r[t];throw new Error("Locale data API: locale data undefined")}function rS(r){const[e,t]=r.split(":");return{hours:+e,minutes:+t}}const Mde=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,z7={},Ede=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var C3=function(r){return r[r.Short=0]="Short",r[r.ShortGMT=1]="ShortGMT",r[r.Long=2]="Long",r[r.Extended=3]="Extended",r}(C3||{}),Zn=function(r){return r[r.FullYear=0]="FullYear",r[r.Month=1]="Month",r[r.Date=2]="Date",r[r.Hours=3]="Hours",r[r.Minutes=4]="Minutes",r[r.Seconds=5]="Seconds",r[r.FractionalSeconds=6]="FractionalSeconds",r[r.Day=7]="Day",r}(Zn||{}),Yn=function(r){return r[r.DayPeriods=0]="DayPeriods",r[r.Days=1]="Days",r[r.Months=2]="Months",r[r.Eras=3]="Eras",r}(Yn||{});function SB(r,e,t,n){let i=function Ide(r){if(OB(r))return r;if("number"==typeof r&&!isNaN(r))return new Date(r);if("string"==typeof r){if(r=r.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(r)){const[i,s=1,o=1]=r.split("-").map(a=>+a);return qp(i,s-1,o)}const t=parseFloat(r);if(!isNaN(r-t))return new Date(t);let n;if(n=r.match(Mde))return function kde(r){const e=new Date(0);let t=0,n=0;const i=r[8]?e.setUTCFullYear:e.setFullYear,s=r[8]?e.setUTCHours:e.setHours;r[9]&&(t=Number(r[9]+r[10]),n=Number(r[9]+r[11])),i.call(e,Number(r[1]),Number(r[2])-1,Number(r[3]));const o=Number(r[4]||0)-t,a=Number(r[5]||0)-n,c=Number(r[6]||0),l=Math.floor(1e3*parseFloat("0."+(r[7]||0)));return s.call(e,o,a,c,l),e}(n)}const e=new Date(r);if(!OB(e))throw new Error(`Unable to convert "${r}" into a date`);return e}(r);e=y3(t,e)||e;let a,o=[];for(;e;){if(a=Ede.exec(e),!a){o.push(e);break}{o=o.concat(a.slice(1));const f=o.pop();if(!f)break;e=f}}let c=i.getTimezoneOffset();n&&(c=TB(n,c),i=function Ade(r,e,t){const n=t?-1:1,i=r.getTimezoneOffset();return function Nde(r,e){return(r=new Date(r.getTime())).setMinutes(r.getMinutes()+e),r}(r,n*(TB(e,i)-i))}(i,n,!0));let l="";return o.forEach(f=>{const d=function wde(r){if(sS[r])return sS[r];let e;switch(r){case"G":case"GG":case"GGG":e=w1(Yn.Eras,m1.Abbreviated);break;case"GGGG":e=w1(Yn.Eras,m1.Wide);break;case"GGGGG":e=w1(Yn.Eras,m1.Narrow);break;case"y":e=jr(Zn.FullYear,1,0,!1,!0);break;case"yy":e=jr(Zn.FullYear,2,0,!0,!0);break;case"yyy":e=jr(Zn.FullYear,3,0,!1,!0);break;case"yyyy":e=jr(Zn.FullYear,4,0,!1,!0);break;case"Y":e=Kp(1);break;case"YY":e=Kp(2,!0);break;case"YYY":e=Kp(3);break;case"YYYY":e=Kp(4);break;case"M":case"L":e=jr(Zn.Month,1,1);break;case"MM":case"LL":e=jr(Zn.Month,2,1);break;case"MMM":e=w1(Yn.Months,m1.Abbreviated);break;case"MMMM":e=w1(Yn.Months,m1.Wide);break;case"MMMMM":e=w1(Yn.Months,m1.Narrow);break;case"LLL":e=w1(Yn.Months,m1.Abbreviated,rs.Standalone);break;case"LLLL":e=w1(Yn.Months,m1.Wide,rs.Standalone);break;case"LLLLL":e=w1(Yn.Months,m1.Narrow,rs.Standalone);break;case"w":e=iS(1);break;case"ww":e=iS(2);break;case"W":e=iS(1,!0);break;case"d":e=jr(Zn.Date,1);break;case"dd":e=jr(Zn.Date,2);break;case"c":case"cc":e=jr(Zn.Day,1);break;case"ccc":e=w1(Yn.Days,m1.Abbreviated,rs.Standalone);break;case"cccc":e=w1(Yn.Days,m1.Wide,rs.Standalone);break;case"ccccc":e=w1(Yn.Days,m1.Narrow,rs.Standalone);break;case"cccccc":e=w1(Yn.Days,m1.Short,rs.Standalone);break;case"E":case"EE":case"EEE":e=w1(Yn.Days,m1.Abbreviated);break;case"EEEE":e=w1(Yn.Days,m1.Wide);break;case"EEEEE":e=w1(Yn.Days,m1.Narrow);break;case"EEEEEE":e=w1(Yn.Days,m1.Short);break;case"a":case"aa":case"aaa":e=w1(Yn.DayPeriods,m1.Abbreviated);break;case"aaaa":e=w1(Yn.DayPeriods,m1.Wide);break;case"aaaaa":e=w1(Yn.DayPeriods,m1.Narrow);break;case"b":case"bb":case"bbb":e=w1(Yn.DayPeriods,m1.Abbreviated,rs.Standalone,!0);break;case"bbbb":e=w1(Yn.DayPeriods,m1.Wide,rs.Standalone,!0);break;case"bbbbb":e=w1(Yn.DayPeriods,m1.Narrow,rs.Standalone,!0);break;case"B":case"BB":case"BBB":e=w1(Yn.DayPeriods,m1.Abbreviated,rs.Format,!0);break;case"BBBB":e=w1(Yn.DayPeriods,m1.Wide,rs.Format,!0);break;case"BBBBB":e=w1(Yn.DayPeriods,m1.Narrow,rs.Format,!0);break;case"h":e=jr(Zn.Hours,1,-12);break;case"hh":e=jr(Zn.Hours,2,-12);break;case"H":e=jr(Zn.Hours,1);break;case"HH":e=jr(Zn.Hours,2);break;case"m":e=jr(Zn.Minutes,1);break;case"mm":e=jr(Zn.Minutes,2);break;case"s":e=jr(Zn.Seconds,1);break;case"ss":e=jr(Zn.Seconds,2);break;case"S":e=jr(Zn.FractionalSeconds,1);break;case"SS":e=jr(Zn.FractionalSeconds,2);break;case"SSS":e=jr(Zn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Zp(C3.Short);break;case"ZZZZZ":e=Zp(C3.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Zp(C3.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Zp(C3.Long);break;default:return null}return sS[r]=e,e}(f);l+=d?d(i,t,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function qp(r,e,t){const n=new Date(0);return n.setFullYear(r,e,t),n.setHours(0,0,0),n}function y3(r,e){const t=function lde(r){return ts(r)[O1.LocaleId]}(r);if(z7[t]=z7[t]||{},z7[t][e])return z7[t][e];let n="";switch(e){case"shortDate":n=Gp(r,eo.Short);break;case"mediumDate":n=Gp(r,eo.Medium);break;case"longDate":n=Gp(r,eo.Long);break;case"fullDate":n=Gp(r,eo.Full);break;case"shortTime":n=Up(r,eo.Short);break;case"mediumTime":n=Up(r,eo.Medium);break;case"longTime":n=Up(r,eo.Long);break;case"fullTime":n=Up(r,eo.Full);break;case"short":const i=y3(r,"shortTime"),s=y3(r,"shortDate");n=jp(Wp(r,eo.Short),[i,s]);break;case"medium":const o=y3(r,"mediumTime"),a=y3(r,"mediumDate");n=jp(Wp(r,eo.Medium),[o,a]);break;case"long":const c=y3(r,"longTime"),l=y3(r,"longDate");n=jp(Wp(r,eo.Long),[c,l]);break;case"full":const f=y3(r,"fullTime"),d=y3(r,"fullDate");n=jp(Wp(r,eo.Full),[f,d])}return n&&(z7[t][e]=n),n}function jp(r,e){return e&&(r=r.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),r}function pa(r,e,t="-",n,i){let s="";(r<0||i&&r<=0)&&(i?r=1-r:(r=-r,s=t));let o=String(r);for(;o.length<e;)o="0"+o;return n&&(o=o.slice(o.length-e)),s+o}function jr(r,e,t=0,n=!1,i=!1){return function(s,o){let a=function Pde(r,e){switch(r){case Zn.FullYear:return e.getFullYear();case Zn.Month:return e.getMonth();case Zn.Date:return e.getDate();case Zn.Hours:return e.getHours();case Zn.Minutes:return e.getMinutes();case Zn.Seconds:return e.getSeconds();case Zn.FractionalSeconds:return e.getMilliseconds();case Zn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${r}".`)}}(r,s);if((t>0||a>-t)&&(a+=t),r===Zn.Hours)0===a&&-12===t&&(a=12);else if(r===Zn.FractionalSeconds)return function Sde(r,e){return pa(r,3).substring(0,e)}(a,e);const c=Ao(o,Ir.MinusSign);return pa(a,e,c,n,i)}}function w1(r,e,t=rs.Format,n=!1){return function(i,s){return function Tde(r,e,t,n,i,s){switch(t){case Yn.Months:return function dde(r,e,t){const n=ts(r),s=Io([n[O1.MonthsFormat],n[O1.MonthsStandalone]],e);return Io(s,t)}(e,i,n)[r.getMonth()];case Yn.Days:return function fde(r,e,t){const n=ts(r),s=Io([n[O1.DaysFormat],n[O1.DaysStandalone]],e);return Io(s,t)}(e,i,n)[r.getDay()];case Yn.DayPeriods:const o=r.getHours(),a=r.getMinutes();if(s){const l=function mde(r){const e=ts(r);return EB(e),(e[O1.ExtraData][2]||[]).map(n=>"string"==typeof n?rS(n):[rS(n[0]),rS(n[1])])}(e),f=function _de(r,e,t){const n=ts(r);EB(n);const s=Io([n[O1.ExtraData][0],n[O1.ExtraData][1]],e)||[];return Io(s,t)||[]}(e,i,n),d=l.findIndex(m=>{if(Array.isArray(m)){const[M,w]=m,L=o>=M.hours&&a>=M.minutes,z=o<w.hours||o===w.hours&&a<w.minutes;if(M.hours<w.hours){if(L&&z)return!0}else if(L||z)return!0}else if(m.hours===o&&m.minutes===a)return!0;return!1});if(-1!==d)return f[d]}return function ude(r,e,t){const n=ts(r),s=Io([n[O1.DayPeriodsFormat],n[O1.DayPeriodsStandalone]],e);return Io(s,t)}(e,i,n)[o<12?0:1];case Yn.Eras:return function hde(r,e){return Io(ts(r)[O1.Eras],e)}(e,n)[r.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(i,s,r,e,t,n)}}function Zp(r){return function(e,t,n){const i=-1*n,s=Ao(t,Ir.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(r){case C3.Short:return(i>=0?"+":"")+pa(o,2,s)+pa(Math.abs(i%60),2,s);case C3.ShortGMT:return"GMT"+(i>=0?"+":"")+pa(o,1,s);case C3.Long:return"GMT"+(i>=0?"+":"")+pa(o,2,s)+":"+pa(Math.abs(i%60),2,s);case C3.Extended:return 0===n?"Z":(i>=0?"+":"")+pa(o,2,s)+":"+pa(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${r}"`)}}}const Ode=0,Yp=4;function PB(r){return qp(r.getFullYear(),r.getMonth(),r.getDate()+(Yp-r.getDay()))}function iS(r,e=!1){return function(t,n){let i;if(e){const s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{const s=PB(t),o=function bde(r){const e=qp(r,Ode,1).getDay();return qp(r,0,1+(e<=Yp?Yp:Yp+7)-e)}(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return pa(i,r,Ao(n,Ir.MinusSign))}}function Kp(r,e=!1){return function(t,n){return pa(PB(t).getFullYear(),r,Ao(n,Ir.MinusSign),e)}}const sS={};function TB(r,e){r=r.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+r)/6e4;return isNaN(t)?e:t}function OB(r){return r instanceof Date&&!isNaN(r.valueOf())}const xde=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function lS(r){const e=parseInt(r);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+r);return e}function AB(r,e){e=encodeURIComponent(e);for(const t of r.split(";")){const n=t.indexOf("="),[i,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}const fS=/\s+/,IB=[];let Ft=(()=>{var r;class e{constructor(n,i,s,o){this._iterableDiffers=n,this._keyValueDiffers=i,this._ngEl=s,this._renderer=o,this.initialClasses=IB,this.stateMap=new Map}set klass(n){this.initialClasses=null!=n?n.trim().split(fS):IB}set ngClass(n){this.rawClass="string"==typeof n?n.trim().split(fS):n}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const n=this.rawClass;if(Array.isArray(n)||n instanceof Set)for(const i of n)this._updateState(i,!0);else if(null!=n)for(const i of Object.keys(n))this._updateState(i,!!n[i]);this._applyStateDiff()}_updateState(n,i){const s=this.stateMap.get(n);void 0!==s?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(n,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const n of this.stateMap){const i=n[0],s=n[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(n,i){(n=n.trim()).length>0&&n.split(fS).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Fp),G(R7),G(Si),G(ac))},r.\u0275dir=Rt({type:r,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class qde{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Zt=(()=>{var r;class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,i,s){this._viewContainer=n,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;!this._differ&&n&&(this._differ=this._differs.find(n).create(this.ngForTrackBy))}if(this._differ){const n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){const i=this._viewContainer;n.forEachOperation((s,o,a)=>{if(null==s.previousIndex)i.createEmbeddedView(this._template,new qde(s.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)i.remove(null===o?void 0:o);else if(null!==o){const c=i.get(o);i.move(c,a),xB(c,s)}});for(let s=0,o=i.length;s<o;s++){const c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}n.forEachIdentityChange(s=>{xB(i.get(s.currentIndex),s)})}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Js),G(g3),G(Fp))},r.\u0275dir=Rt({type:r,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function xB(r,e){r.context.$implicit=e.item}let Nt=(()=>{var r;class e{constructor(n,i){this._viewContainer=n,this._context=new jde,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){LB("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){LB("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,i){return!0}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Js),G(g3))},r.\u0275dir=Rt({type:r,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class jde{constructor(){this.$implicit=null,this.ngIf=null}}function LB(r,e){if(e&&!e.createEmbeddedView)throw new Error(`${r} must be a TemplateRef, but received '${n2(e)}'.`)}let DB=(()=>{var r;class e{constructor(n){this._locale=n}transform(n,i,s){if(!function pS(r){return!(null==r||""===r||r!=r)}(n))return null;s=s||this._locale;try{return function Vde(r,e,t){return function aS(r,e,t,n,i,s,o=!1){let a="",c=!1;if(isFinite(r)){let l=function $de(r){let n,i,s,o,a,e=Math.abs(r)+"",t=0;for((i=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(i<0&&(i=s),i+=+e.slice(s+1),e=e.substring(0,s)):i<0&&(i=e.length),s=0;"0"===e.charAt(s);s++);if(s===(a=e.length))n=[0],i=1;else{for(a--;"0"===e.charAt(a);)a--;for(i-=s,n=[],o=0;s<=a;s++,o++)n[o]=Number(e.charAt(s))}return i>22&&(n=n.splice(0,21),t=i-1,i=1),{digits:n,exponent:t,integerLen:i}}(r);o&&(l=function Fde(r){if(0===r.digits[0])return r;const e=r.digits.length-r.integerLen;return r.exponent?r.exponent+=2:(0===e?r.digits.push(0,0):1===e&&r.digits.push(0),r.integerLen+=2),r}(l));let f=e.minInt,d=e.minFrac,m=e.maxFrac;if(s){const B=s.match(xde);if(null===B)throw new Error(`${s} is not a valid digit info`);const de=B[1],_e=B[3],xe=B[5];null!=de&&(f=lS(de)),null!=_e&&(d=lS(_e)),null!=xe?m=lS(xe):null!=_e&&d>m&&(m=d)}!function Bde(r,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let n=r.digits,i=n.length-r.integerLen;const s=Math.min(Math.max(e,i),t);let o=s+r.integerLen,a=n[o];if(o>0){n.splice(Math.max(r.integerLen,o));for(let d=o;d<n.length;d++)n[d]=0}else{i=Math.max(0,i),r.integerLen=1,n.length=Math.max(1,o=s+1),n[0]=0;for(let d=1;d<o;d++)n[d]=0}if(a>=5)if(o-1<0){for(let d=0;d>o;d--)n.unshift(0),r.integerLen++;n.unshift(1),r.integerLen++}else n[o-1]++;for(;i<Math.max(0,s);i++)n.push(0);let c=0!==s;const l=e+r.integerLen,f=n.reduceRight(function(d,m,M,w){return w[M]=(m+=d)<10?m:m-10,c&&(0===w[M]&&M>=l?w.pop():c=!1),m>=10?1:0},0);f&&(n.unshift(f),r.integerLen++)}(l,d,m);let M=l.digits,w=l.integerLen;const L=l.exponent;let z=[];for(c=M.every(B=>!B);w<f;w++)M.unshift(0);for(;w<0;w++)M.unshift(0);w>0?z=M.splice(w,M.length):(z=M,M=[0]);const $=[];for(M.length>=e.lgSize&&$.unshift(M.splice(-e.lgSize,M.length).join(""));M.length>e.gSize;)$.unshift(M.splice(-e.gSize,M.length).join(""));M.length&&$.unshift(M.join("")),a=$.join(Ao(t,n)),z.length&&(a+=Ao(t,i)+z.join("")),L&&(a+=Ao(t,Ir.Exponential)+"+"+L)}else a=Ao(t,Ir.Infinity);return a=r<0&&!c?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(r,function cS(r,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},n=r.split(";"),i=n[0],s=n[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],a=o[0],c=o[1]||"";t.posPre=a.substring(0,a.indexOf("#"));for(let f=0;f<c.length;f++){const d=c.charAt(f);"0"===d?t.minFrac=t.maxFrac=f+1:"#"===d?t.maxFrac=f+1:t.posSuf+=d}const l=a.split(",");if(t.gSize=l[1]?l[1].length:0,t.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,s){const f=i.length-t.posPre.length-t.posSuf.length,d=s.indexOf("#");t.negPre=s.substring(0,d).replace(/'/g,""),t.negSuf=s.slice(d+f).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function nS(r,e){return ts(r)[O1.NumberFormats][e]}(e,Bp.Decimal),Ao(e,Ir.MinusSign)),e,Ir.Group,Ir.Decimal,t)}(function gS(r){if("string"==typeof r&&!isNaN(Number(r)-parseFloat(r)))return Number(r);if("number"!=typeof r)throw new Error(`${r} is not a number`);return r}(n),s,i)}catch(o){throw function ga(r,e){return new ge(2100,!1)}()}}}return(r=e).\u0275fac=function(n){return new(n||r)(G(dc,16))},r.\u0275pipe=yi({name:"number",type:r,pure:!0,standalone:!0}),e})();let _he=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({}),e})();function VB(r){return"server"===r}let Mhe=(()=>{var r;class e{}return(r=e).\u0275prov=De({token:r,providedIn:"root",factory:()=>new Ehe(Pe(P2),window)}),e})();class Ehe{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function She(r,e){const t=r.getElementById(e)||r.getElementsByName(e)[0];if(t)return t;if("function"==typeof r.createTreeWalker&&r.body&&"function"==typeof r.body.attachShadow){const n=r.createTreeWalker(r.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class FB{}class qhe extends tde{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class vS extends qhe{static makeCurrent(){!function ede(r){QE||(QE=r)}(new vS)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function jhe(){return V7=V7||document.querySelector("base"),V7?V7.getAttribute("href"):null}();return null==t?null:function Zhe(r){eg=eg||document.createElement("a"),eg.setAttribute("href",r);const e=eg.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){V7=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return AB(document.cookie,e)}}let eg,V7=null,Khe=(()=>{var r;class e{build(){return new XMLHttpRequest}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const CS=new tt("EventManagerPlugins");let WB=(()=>{var r;class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(o=>o.supports(n)),!i)throw new ge(5101,!1);return this._eventNameToPlugin.set(n,i),i}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(CS),Pe(i1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class qB{constructor(e){this._doc=e}}const yS="ng-app-id";let jB=(()=>{var r;class e{constructor(n,i,s,o={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=VB(o),this.resetHostNodes()}addStyles(n){for(const i of n)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(n){for(const i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(const i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(const i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){const i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){const n=this.doc.head?.querySelectorAll(`style[${yS}="${this.appId}"]`);if(n?.length){const i=new Map;return n.forEach(s=>{null!=s.textContent&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){const s=this.styleRef;if(s.has(n)){const o=s.get(n);return o.usage+=i,o.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){const s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===n)return s.delete(i),o.removeAttribute(yS),o;{const a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(yS,this.appId),a}}addStyleToHost(n,i){const s=this.getStyleElement(n,i);n.appendChild(s);const o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){const n=this.hostNodes;n.clear(),n.add(this.doc.head)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(P2),Pe(sp),Pe(cH,8),Pe(d3))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const MS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ES=/%COMP%/g,epe=new tt("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function YB(r,e){return e.map(t=>t.replace(ES,r))}let SS=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=f,this.rendererByCompId=new Map,this.platformIsServer=VB(c),this.defaultRenderer=new PS(n,a,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Oo.ShadowDom&&(i={...i,encapsulation:Oo.Emulated});const s=this.getOrCreateRenderer(n,i);return s instanceof XB?s.applyToHost(n):s instanceof TS&&s.applyStyles(),s}getOrCreateRenderer(n,i){const s=this.rendererByCompId;let o=s.get(i.id);if(!o){const a=this.doc,c=this.ngZone,l=this.eventManager,f=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case Oo.Emulated:o=new XB(l,f,i,this.appId,d,a,c,m);break;case Oo.ShadowDom:return new ipe(l,f,n,i,a,c,this.nonce,m);default:o=new TS(l,f,i,d,a,c,m)}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(WB),Pe(jB),Pe(sp),Pe(epe),Pe(P2),Pe(d3),Pe(i1),Pe(cH))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class PS{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(MS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(KB(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(KB(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?this.doc.querySelector(e):e;if(!n)throw new ge(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const s=MS[i];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=MS[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(S4.DashCase|S4.Important)?e.style.setProperty(t,n,i&S4.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&S4.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){if("string"==typeof e&&!(e=b4().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function KB(r){return"TEMPLATE"===r.tagName&&void 0!==r.content}class ipe extends PS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=YB(i.id,i.styles);for(const f of l){const d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=f,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class TS extends PS{constructor(e,t,n,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?YB(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class XB extends TS{constructor(e,t,n,i,s,o,a,c){const l=i+"-"+n.id;super(e,t,n,s,o,a,c,l),this.contentAttr=function tpe(r){return"_ngcontent-%COMP%".replace(ES,r)}(l),this.hostAttr=function npe(r){return"_nghost-%COMP%".replace(ES,r)}(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}let spe=(()=>{var r;class e extends qB{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(P2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const QB=["alt","control","meta","shift"],ope={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ape={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let cpe=(()=>{var r;class e extends qB{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,i,s){const o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>b4().onAndCancel(n,o.domEventName,a))}static parseEventName(n){const i=n.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const o=e._normalizeKey(i.pop());let a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),QB.forEach(f=>{const d=i.indexOf(f);d>-1&&(i.splice(d,1),a+=f+".")}),a+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(n,i){let s=ope[n.key]||n.key,o="";return i.indexOf("code.")>-1&&(s=n.code,o="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),QB.forEach(a=>{a!==s&&(0,ape[a])(n)&&(o+=a+".")}),o+=s,o===i)}static eventCallback(n,i,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>i(o))}}static _normalizeKey(n){return"esc"===n?"escape":n}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(P2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const eG=[{provide:d3,useValue:"browser"},{provide:oH,useValue:function lpe(){vS.makeCurrent()},multi:!0},{provide:P2,useFactory:function fpe(){return function t0e(r){pM=r}(document),document},deps:[]}],dpe=q$(F9e,"browser",eG),hpe=new tt(""),tG=[{provide:zp,useClass:class Yhe{addToWindow(e){p1.getAngularTestability=(n,i=!0)=>{const s=e.findTestabilityInTree(n,i);if(null==s)throw new ge(5103,!1);return s},p1.getAllAngularTestabilities=()=>e.getAllTestabilities(),p1.getAllAngularRootElements=()=>e.getAllRootElements(),p1.frameworkStabilizers||(p1.frameworkStabilizers=[]),p1.frameworkStabilizers.push(n=>{const i=p1.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(c){o=o||c,s--,0==s&&n(o)};i.forEach(c=>{c.whenStable(a)})})}findTestabilityInTree(e,t,n){return null==t?null:e.getTestability(t)??(n?b4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:$$,useClass:$E,deps:[i1,BE,zp]},{provide:$E,useClass:$E,deps:[i1,BE,zp]}],nG=[{provide:SM,useValue:"root"},{provide:Ql,useFactory:function upe(){return new Ql},deps:[]},{provide:CS,useClass:spe,multi:!0,deps:[P2,i1,d3]},{provide:CS,useClass:cpe,multi:!0,deps:[P2]},SS,jB,WB,{provide:p7,useExisting:SS},{provide:FB,useClass:Khe,deps:[]},[]];let rG=(()=>{var r;class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:sp,useValue:n.appId}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(hpe,12))},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({providers:[...nG,...tG],imports:[_he,$9e]}),e})(),iG=(()=>{var r;class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(P2))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function gpe(){return new iG(Pe(P2))}(),i},providedIn:"root"}),e})();typeof window<"u"&&window;let aG=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new(n||r):Pe(cG),i},providedIn:"root"}),e})(),cG=(()=>{var r;class e extends aG{constructor(n){super(),this._doc=n}sanitize(n,i){if(null==i)return null;switch(n){case wo.NONE:return i;case wo.HTML:return oc(i,"HTML")?Ks(i):KD(this._doc,String(i)).toString();case wo.STYLE:return oc(i,"Style")?Ks(i):i;case wo.SCRIPT:if(oc(i,"Script"))return Ks(i);throw new ge(5200,!1);case wo.URL:return oc(i,"URL")?Ks(i):Qh(String(i));case wo.RESOURCE_URL:if(oc(i,"ResourceURL"))return Ks(i);throw new ge(5201,!1);default:throw new ge(5202,!1)}}bypassSecurityTrustHtml(n){return function c0e(r){return new n0e(r)}(n)}bypassSecurityTrustStyle(n){return function l0e(r){return new r0e(r)}(n)}bypassSecurityTrustScript(n){return function u0e(r){return new i0e(r)}(n)}bypassSecurityTrustUrl(n){return function f0e(r){return new s0e(r)}(n)}bypassSecurityTrustResourceUrl(n){return function d0e(r){return new o0e(r)}(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(P2))},r.\u0275prov=De({token:r,factory:function(n){let i=null;return i=n?new n:function Cpe(r){return new cG(r.get(P2))}(Pe(Q2)),i},providedIn:"root"}),e})();function F7(r){return(F7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function u(r,e,t){return(e=function Mpe(r){var e=function ype(r,e){if("object"!==F7(r)||null===r)return r;var t=r[Symbol.toPrimitive];if(void 0!==t){var n=t.call(r,e||"default");if("object"!==F7(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(r)}(r,"string");return"symbol"===F7(e)?e:String(e)}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}const{isArray:Epe}=Array,{getPrototypeOf:Spe,prototype:Ppe,keys:Tpe}=Object;function uG(r){if(1===r.length){const e=r[0];if(Epe(e))return{args:e,keys:null};if(function Ope(r){return r&&"object"==typeof r&&Spe(r)===Ppe}(e)){const t=Tpe(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:r,keys:null}}const{isArray:bpe}=Array;function fG(r){return Un(e=>function wpe(r,e){return bpe(e)?r(...e):r(e)}(r,e))}function dG(r,e){return r.reduce((t,n,i)=>(t[n]=e[i],t),{})}let hG=(()=>{var r;class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(ac),G(Si))},r.\u0275dir=Rt({type:r}),e})(),c6=(()=>{var r;class e extends hG{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,features:[Je]}),e})();const hc=new tt("NgValueAccessor"),Ape={provide:hc,useExisting:P1(()=>bS),multi:!0};let bS=(()=>{var r;class e extends c6{writeValue(n){this.setProperty("checked",n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,i){1&n&&U("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[j1([Ape]),Je]}),e})();const Ipe={provide:hc,useExisting:P1(()=>pc),multi:!0},xpe=new tt("CompositionEventMode");let pc=(()=>{var r;class e extends hG{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function kpe(){const r=b4()?b4().getUserAgent():"";return/android (\d+)/.test(r.toLowerCase())}())}writeValue(n){this.setProperty("value",n??"")}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(ac),G(Si),G(xpe,8))},r.\u0275dir=Rt({type:r,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,i){1&n&&U("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[j1([Ipe]),Je]}),e})();function N4(r){return null==r||("string"==typeof r||Array.isArray(r))&&0===r.length}function pG(r){return null!=r&&"number"==typeof r.length}const Oi=new tt("NgValidators"),A4=new tt("NgAsyncValidators"),Lpe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class $7{static min(e){return function gG(r){return e=>{if(N4(e.value)||N4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<r?{min:{min:r,actual:e.value}}:null}}(e)}static max(e){return function mG(r){return e=>{if(N4(e.value)||N4(r))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>r?{max:{max:r,actual:e.value}}:null}}(e)}static required(e){return _G(e)}static requiredTrue(e){return function vG(r){return!0===r.value?null:{required:!0}}(e)}static email(e){return function CG(r){return N4(r.value)||Lpe.test(r.value)?null:{email:!0}}(e)}static minLength(e){return function yG(r){return e=>N4(e.value)||!pG(e.value)?null:e.value.length<r?{minlength:{requiredLength:r,actualLength:e.value.length}}:null}(e)}static maxLength(e){return MG(e)}static pattern(e){return function EG(r){if(!r)return tg;let e,t;return"string"==typeof r?(t="","^"!==r.charAt(0)&&(t+="^"),t+=r,"$"!==r.charAt(r.length-1)&&(t+="$"),e=new RegExp(t)):(t=r.toString(),e=r),n=>{if(N4(n.value))return null;const i=n.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}(e)}static nullValidator(e){return null}static compose(e){return wG(e)}static composeAsync(e){return NG(e)}}function _G(r){return N4(r.value)?{required:!0}:null}function MG(r){return e=>pG(e.value)&&e.value.length>r?{maxlength:{requiredLength:r,actualLength:e.value.length}}:null}function tg(r){return null}function SG(r){return null!=r}function PG(r){return P7(r)?t2(r):r}function TG(r){let e={};return r.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function OG(r,e){return e.map(t=>t(r))}function bG(r){return r.map(e=>function Rpe(r){return!r.validate}(e)?e:t=>e.validate(t))}function wG(r){if(!r)return null;const e=r.filter(SG);return 0==e.length?null:function(t){return TG(OG(t,e))}}function wS(r){return null!=r?wG(bG(r)):null}function NG(r){if(!r)return null;const e=r.filter(SG);return 0==e.length?null:function(t){return function Npe(...r){const e=VR(r),{args:t,keys:n}=uG(r),i=new S1(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let c=o,l=o;for(let f=0;f<o;f++){let d=!1;Ws(t[f]).subscribe(dr(s,m=>{d||(d=!0,l--),a[f]=m},()=>c--,void 0,()=>{(!c||!d)&&(l||s.next(n?dG(n,a):a),s.complete())}))}});return e?i.pipe(fG(e)):i}(OG(t,e).map(PG)).pipe(Un(TG))}}function NS(r){return null!=r?NG(bG(r)):null}function AG(r,e){return null===r?[e]:Array.isArray(r)?[...r,e]:[r,e]}function IG(r){return r._rawValidators}function kG(r){return r._rawAsyncValidators}function AS(r){return r?Array.isArray(r)?r:[r]:[]}function ng(r,e){return Array.isArray(r)?r.includes(e):r===e}function xG(r,e){const t=AS(e);return AS(r).forEach(i=>{ng(t,i)||t.push(i)}),t}function LG(r,e){return AS(e).filter(t=>!ng(r,t))}class RG{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=wS(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=NS(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class is extends RG{get formDirective(){return null}get path(){return null}}class I4 extends RG{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class zG{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let M3=(()=>{var r;class e extends zG{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(I4,2))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,i){2&n&&Tp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Je]}),e})(),l6=(()=>{var r;class e extends zG{constructor(n){super(n)}}return(r=e).\u0275fac=function(n){return new(n||r)(G(is,10))},r.\u0275dir=Rt({type:r,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(n,i){2&n&&Tp("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Je]}),e})();const B7="VALID",ig="INVALID",I8="PENDING",G7="DISABLED";function xS(r){return(sg(r)?r.validators:r)||null}function LS(r,e){return(sg(e)?e.asyncValidators:r)||null}function sg(r){return null!=r&&!Array.isArray(r)&&"object"==typeof r}function HG(r,e,t){const n=r.controls;if(!(e?Object.keys(n):n).length)throw new ge(1e3,"");if(!n[t])throw new ge(1001,"")}function VG(r,e,t){r._forEachChild((n,i)=>{if(void 0===t[i])throw new ge(1002,"")})}class og{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===B7}get invalid(){return this.status===ig}get pending(){return this.status==I8}get disabled(){return this.status===G7}get enabled(){return this.status!==G7}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(xG(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(xG(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(LG(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(LG(e,this._rawAsyncValidators))}hasValidator(e){return ng(this._rawValidators,e)}hasAsyncValidator(e){return ng(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=I8,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=G7,this.errors=null,this._forEachChild(n=>{n.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=B7,this._forEachChild(n=>{n.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===B7||this.status===I8)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?G7:B7}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=I8,this._hasOwnPendingAsyncValidator=!0;const t=PG(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((n,i)=>n&&n._find(i),this)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new b1,this.statusChanges=new b1}_calculateStatus(){return this._allControlsDisabled()?G7:this.errors?ig:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(I8)?I8:this._anyControlsHaveStatus(ig)?ig:B7}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){sg(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Vpe(r){return Array.isArray(r)?wS(r):r||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Fpe(r){return Array.isArray(r)?NS(r):r||null}(this._rawAsyncValidators)}}class k4 extends og{constructor(e,t,n){super(xS(t),LS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){VG(this,0,e),Object.keys(e).forEach(n=>{HG(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{const i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,n]of Object.entries(this.controls))if(this.contains(t)&&e(n))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,n,i)=>((n.enabled||this.disabled)&&(t[i]=n.value),t))}_reduceChildren(e,t){let n=e;return this._forEachChild((i,s)=>{n=t(n,i,s)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class FG extends k4{}const u6=new tt("CallSetDisabledState",{providedIn:"root",factory:()=>U7}),U7="always";function ag(r,e){return[...e.path,r]}function W7(r,e,t=U7){RS(r,e),e.valueAccessor.writeValue(r.value),(r.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(r.disabled),function Bpe(r,e){e.valueAccessor.registerOnChange(t=>{r._pendingValue=t,r._pendingChange=!0,r._pendingDirty=!0,"change"===r.updateOn&&$G(r,e)})}(r,e),function Upe(r,e){const t=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};r.registerOnChange(t),e._registerOnDestroy(()=>{r._unregisterOnChange(t)})}(r,e),function Gpe(r,e){e.valueAccessor.registerOnTouched(()=>{r._pendingTouched=!0,"blur"===r.updateOn&&r._pendingChange&&$G(r,e),"submit"!==r.updateOn&&r.markAsTouched()})}(r,e),function $pe(r,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};r.registerOnDisabledChange(t),e._registerOnDestroy(()=>{r._unregisterOnDisabledChange(t)})}}(r,e)}function cg(r,e,t=!0){const n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),ug(r,e),r&&(e._invokeOnDestroyCallbacks(),r._registerOnCollectionChange(()=>{}))}function lg(r,e){r.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function RS(r,e){const t=IG(r);null!==e.validator?r.setValidators(AG(t,e.validator)):"function"==typeof t&&r.setValidators([t]);const n=kG(r);null!==e.asyncValidator?r.setAsyncValidators(AG(n,e.asyncValidator)):"function"==typeof n&&r.setAsyncValidators([n]);const i=()=>r.updateValueAndValidity();lg(e._rawValidators,i),lg(e._rawAsyncValidators,i)}function ug(r,e){let t=!1;if(null!==r){if(null!==e.validator){const i=IG(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.validator);s.length!==i.length&&(t=!0,r.setValidators(s))}}if(null!==e.asyncValidator){const i=kG(r);if(Array.isArray(i)&&i.length>0){const s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(t=!0,r.setAsyncValidators(s))}}}const n=()=>{};return lg(e._rawValidators,n),lg(e._rawAsyncValidators,n),t}function $G(r,e){r._pendingDirty&&r.markAsDirty(),r.setValue(r._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1}function BG(r,e){RS(r,e)}function DS(r,e){if(!r.hasOwnProperty("model"))return!1;const t=r.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function GG(r,e){r._syncPendingControls(),e.forEach(t=>{const n=t.control;"submit"===n.updateOn&&n._pendingChange&&(t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function HS(r,e){if(!e)return null;let t,n,i;return Array.isArray(e),e.forEach(s=>{s.constructor===pc?t=s:function jpe(r){return Object.getPrototypeOf(r.constructor)===c6}(s)?n=s:i=s}),i||n||t||null}const Ype={provide:is,useExisting:P1(()=>j7)},q7=(()=>Promise.resolve())();let j7=(()=>{var r;class e extends is{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new b1,this.form=new k4({},wS(n),NS(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){q7.then(()=>{const i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),W7(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){q7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){q7.then(()=>{const i=this._findContainer(n.path),s=new k4({});BG(s,n),i.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){q7.then(()=>{const i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){q7.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,GG(this.form,this._directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Oi,10),G(A4,10),G(u6,8))},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(n,i){1&n&&U("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[j1([Ype]),Je]}),e})();function UG(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}function WG(r){return"object"==typeof r&&null!==r&&2===Object.keys(r).length&&"value"in r&&"disabled"in r}const to=class extends og{constructor(e=null,t,n){super(xS(t),LS(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),sg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=WG(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){UG(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){UG(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){WG(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Qpe={provide:I4,useExisting:P1(()=>Z7)},ZG=(()=>Promise.resolve())();let Z7=(()=>{var r;class e extends I4{constructor(n,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new to,this._registered=!1,this.name="",this.update=new b1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=HS(0,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){const i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),DS(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){W7(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(n){ZG.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){const i=n.isDisabled.currentValue,s=0!==i&&N8(i);ZG.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?ag(n,this._parent):[n]}}return(r=e).\u0275fac=function(n){return new(n||r)(G(is,9),G(Oi,10),G(A4,10),G(hc,10),G(s6,8),G(u6,8))},r.\u0275dir=Rt({type:r,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[j1([Qpe]),Je,Ki]}),e})(),f6=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),KG=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({}),e})();const nge={provide:hc,useExisting:P1(()=>fg),multi:!0};let fg=(()=>{var r;class e extends c6{writeValue(n){this.setProperty("value",parseFloat(n))}registerOnChange(n){this.onChange=i=>{n(""==i?null:parseFloat(i))}}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,i){1&n&&U("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[j1([nge]),Je]}),e})();const VS=new tt("NgModelWithFormControlWarning"),rge={provide:I4,useExisting:P1(()=>FS)};let FS=(()=>{var r;class e extends I4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=a,this.update=new b1,this._ngModelWarningSent=!1,this._setValidators(n),this._setAsyncValidators(i),this.valueAccessor=HS(0,s)}ngOnChanges(n){if(this._isControlChanged(n)){const i=n.form.previousValue;i&&cg(i,this,!1),W7(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}DS(n,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&cg(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_isControlChanged(n){return n.hasOwnProperty("form")}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(G(Oi,10),G(A4,10),G(hc,10),G(VS,8),G(u6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[j1([rge]),Je,Ki]}),e})();const ige={provide:is,useExisting:P1(()=>d6)};let d6=(()=>{var r;class e extends is{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new b1,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ug(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){const i=this.form.get(n.path);return W7(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){cg(n.control||null,n,!1),function Zpe(r,e){const t=r.indexOf(e);t>-1&&r.splice(t,1)}(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,GG(this.form,this.directives),this.ngSubmit.emit(n),"dialog"===n?.target?.method}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{const i=n.control,s=this.form.get(n.path);i!==s&&(cg(i||null,n),(r=>r instanceof to)(s)&&(W7(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){const i=this.form.get(n.path);BG(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){const i=this.form.get(n.path);i&&function Wpe(r,e){return ug(r,e)}(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){RS(this.form,this),this._oldForm&&ug(this._oldForm,this)}_checkFormPresent(){}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Oi,10),G(A4,10),G(u6,8))},r.\u0275dir=Rt({type:r,selectors:[["","formGroup",""]],hostBindings:function(n,i){1&n&&U("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[j1([ige]),Je,Ki]}),e})();const age={provide:I4,useExisting:P1(()=>k8)};let k8=(()=>{var r;class e extends I4{set isDisabled(n){}constructor(n,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new b1,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=HS(0,o)}ngOnChanges(n){this._added||this._setUpControl(),DS(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return ag(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return(r=e)._ngModelWarningSentOnce=!1,r.\u0275fac=function(n){return new(n||r)(G(is,13),G(Oi,10),G(A4,10),G(hc,10),G(VS,8))},r.\u0275dir=Rt({type:r,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[j1([age]),Je,Ki]}),e})();const cge={provide:hc,useExisting:P1(()=>dg),multi:!0};function JG(r,e){return null==r?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let dg=(()=>{var r;class e extends c6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;const s=JG(this._getOptionId(n),n);this.setProperty("value",s)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){const i=function lge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i):n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,i){1&n&&U("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[j1([cge]),Je]}),e})(),Y7=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){null!=this._select&&(this._select._optionMap.set(this.id,n),this._setElementValue(JG(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Si),G(ac),G(dg,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const uge={provide:hc,useExisting:P1(()=>GS),multi:!0};function eU(r,e){return null==r?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${r}: ${e}`.slice(0,50))}let GS=(()=>{var r;class e extends c6{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){let i;if(this.value=n,Array.isArray(n)){const s=n.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{const s=[],o=i.selectedOptions;if(void 0!==o){const a=o;for(let c=0;c<a.length;c++){const f=this._getOptionValue(a[c].value);s.push(f)}}else{const a=i.options;for(let c=0;c<a.length;c++){const l=a[c];if(l.selected){const f=this._getOptionValue(l.value);s.push(f)}}}this.value=s,n(s)}}_registerOption(n){const i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){const i=function fge(r){return r.split(":")[0]}(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,i){1&n&&U("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[j1([uge]),Je]}),e})(),K7=(()=>{var r;class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){null!=this._select&&(this._value=n,this._setElementValue(eU(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(eU(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Si),G(ac),G(GS,9))},r.\u0275dir=Rt({type:r,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();let h6=(()=>{var r;class e{constructor(){this._validator=tg}ngOnChanges(n){if(this.inputName in n){const i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):tg,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return null!=n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,features:[Ki]}),e})();const pge={provide:Oi,useExisting:P1(()=>p6),multi:!0};let p6=(()=>{var r;class e extends h6{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=N8,this.createValidator=n=>_G}enabled(n){return n}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(n,i){2&n&&k("required",i._enabled?"":null)},inputs:{required:"required"},features:[j1([pge]),Je]}),e})();const vge={provide:Oi,useExisting:P1(()=>US),multi:!0};let US=(()=>{var r;class e extends h6{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=n=>function tU(r){return"number"==typeof r?r:parseInt(r,10)}(n),this.createValidator=n=>MG(n)}}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275dir=Rt({type:r,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(n,i){2&n&&k("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[j1([vge]),Je]}),e})(),lU=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({imports:[KG]}),e})();class uU extends og{constructor(e,t,n){super(xS(t),LS(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){VG(this,0,e),e.forEach((n,i)=>{HG(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function fU(r){return!!r&&(void 0!==r.asyncValidators||void 0!==r.validators||void 0!==r.updateOn)}let yge=(()=>{var r;class e{constructor(){this.useNonNullable=!1}get nonNullable(){const n=new e;return n.useNonNullable=!0,n}group(n,i=null){const s=this._reduceControls(n);let o={};return fU(i)?o=i:null!==i&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new k4(s,o)}record(n,i=null){const s=this._reduceControls(n);return new FG(s,i)}control(n,i,s){let o={};return this.useNonNullable?(fU(i)?o=i:(o.validators=i,o.asyncValidators=s),new to(n,{...o,nonNullable:!0})):new to(n,i,s)}array(n,i,s){const o=n.map(a=>this._createControl(a));return new uU(o,i,s)}_reduceControls(n){const i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){return n instanceof to||n instanceof og?n:Array.isArray(n)?this.control(n[0],n.length>1?n[1]:null,n.length>2?n[2]:null):this.control(n)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),Mge=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:u6,useValue:n.callSetDisabledState??U7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({imports:[lU]}),e})(),Ege=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:[{provide:VS,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:u6,useValue:n.callSetDisabledState??U7}]}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({imports:[lU]}),e})();function x8(r,e){return Mn(e)?j2(r,e,1):j2(r,1)}function E3(r,e){return Wr((t,n)=>{let i=0;t.subscribe(dr(n,s=>r.call(e,s,i++)&&n.next(s)))})}function X7(r){return Wr((e,t)=>{try{e.subscribe(t)}finally{t.add(r)}})}class hg{}class pg{}class gc{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const i=t.slice(0,n),s=i.toLowerCase(),o=t.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.setHeaderEntries(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof gc?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new gc;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof gc?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...n),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const n=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Sge{encodeKey(e){return dU(e)}encodeValue(e){return dU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Tge=/%(\d[a-f0-9])/gi,Oge={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function dU(r){return encodeURIComponent(r).replace(Tge,(e,t)=>Oge[t]??e)}function gg(r){return`${r}`}class x4{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Sge,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Pge(r,e){const t=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(o)||[];c.push(a),t.set(o,c)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t],i=Array.isArray(n)?n.map(gg):[gg(n)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const i=e[n];Array.isArray(i)?i.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new x4({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(gg(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const i=n.indexOf(gg(e.value));-1!==i&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class bge{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function hU(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function pU(r){return typeof Blob<"u"&&r instanceof Blob}function gU(r){return typeof FormData<"u"&&r instanceof FormData}class Q7{constructor(e,t,n,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function wge(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new gc),this.context||(this.context=new bge),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new x4,this.urlWithParams=t}serializeBody(){return null===this.body?null:hU(this.body)||pU(this.body)||gU(this.body)||function Nge(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof x4?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||gU(this.body)?null:pU(this.body)?this.body.type||null:hU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof x4?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,l=e.params||this.params;const f=e.context??this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),c)),e.setParams&&(l=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),l)),new Q7(t,n,s,{params:l,headers:c,context:f,reportProgress:a,responseType:i,withCredentials:o})}}var L8=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(L8||{});class WS{constructor(e,t=200,n="OK"){this.headers=e.headers||new gc,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class qS extends WS{constructor(e={}){super(e),this.type=L8.ResponseHeader}clone(e={}){return new qS({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class R8 extends WS{constructor(e={}){super(e),this.type=L8.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new R8({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class mU extends WS{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function jS(r,e){return{body:e,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials}}let Age=(()=>{var r;class e{constructor(n){this.handler=n}request(n,i,s={}){let o;if(n instanceof Q7)o=n;else{let l,f;l=s.headers instanceof gc?s.headers:new gc(s.headers),s.params&&(f=s.params instanceof x4?s.params:new x4({fromObject:s.params})),o=new Q7(n,i,void 0!==s.body?s.body:null,{headers:l,context:s.context,params:f,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const a=Dt(o).pipe(x8(l=>this.handler.handle(l)));if(n instanceof Q7||"events"===s.observe)return a;const c=a.pipe(E3(l=>l instanceof R8));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(Un(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(Un(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(Un(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return c.pipe(Un(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:(new x4).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,jS(s,i))}post(n,i,s={}){return this.request("POST",n,jS(s,i))}put(n,i,s={}){return this.request("PUT",n,jS(s,i))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(hg))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function CU(r,e){return e(r)}function kge(r,e){return(t,n)=>e.intercept(t,{handle:i=>r(i,n)})}const Lge=new tt(""),J7=new tt(""),yU=new tt("");function Rge(){let r=null;return(e,t)=>{null===r&&(r=(rt(Lge,{optional:!0})??[]).reduceRight(kge,CU));const n=rt(Lp),i=n.add();return r(e,t).pipe(X7(()=>n.remove(i)))}}let MU=(()=>{var r;class e extends hg{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=rt(Lp)}handle(n){if(null===this.chain){const s=Array.from(new Set([...this.injector.get(J7),...this.injector.get(yU,[])]));this.chain=s.reduceRight((o,a)=>function xge(r,e,t){return(n,i)=>t.runInContext(()=>e(n,s=>r(s,i)))}(o,a,this.injector),CU)}const i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(X7(()=>this.pendingTasks.remove(i)))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(pg),Pe(Xs))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const Vge=/^\)\]\}',?\n/;let SU=(()=>{var r;class e{constructor(n){this.xhrFactory=n}handle(n){if("JSONP"===n.method)throw new ge(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?t2(i.\u0275loadImpl()):Dt(null)).pipe(oa(()=>new S1(o=>{const a=i.build();if(a.open(n.method,n.urlWithParams),n.withCredentials&&(a.withCredentials=!0),n.headers.forEach((z,$)=>a.setRequestHeader(z,$.join(","))),n.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){const z=n.detectContentTypeHeader();null!==z&&a.setRequestHeader("Content-Type",z)}if(n.responseType){const z=n.responseType.toLowerCase();a.responseType="json"!==z?z:"text"}const c=n.serializeBody();let l=null;const f=()=>{if(null!==l)return l;const z=a.statusText||"OK",$=new gc(a.getAllResponseHeaders()),B=function Fge(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}(a)||n.url;return l=new qS({headers:$,status:a.status,statusText:z,url:B}),l},d=()=>{let{headers:z,status:$,statusText:B,url:de}=f(),_e=null;204!==$&&(_e=typeof a.response>"u"?a.responseText:a.response),0===$&&($=_e?200:0);let xe=$>=200&&$<300;if("json"===n.responseType&&"string"==typeof _e){const nt=_e;_e=_e.replace(Vge,"");try{_e=""!==_e?JSON.parse(_e):null}catch(gt){_e=nt,xe&&(xe=!1,_e={error:gt,text:_e})}}xe?(o.next(new R8({body:_e,headers:z,status:$,statusText:B,url:de||void 0})),o.complete()):o.error(new mU({error:_e,headers:z,status:$,statusText:B,url:de||void 0}))},m=z=>{const{url:$}=f(),B=new mU({error:z,status:a.status||0,statusText:a.statusText||"Unknown Error",url:$||void 0});o.error(B)};let M=!1;const w=z=>{M||(o.next(f()),M=!0);let $={type:L8.DownloadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),"text"===n.responseType&&a.responseText&&($.partialText=a.responseText),o.next($)},L=z=>{let $={type:L8.UploadProgress,loaded:z.loaded};z.lengthComputable&&($.total=z.total),o.next($)};return a.addEventListener("load",d),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),n.reportProgress&&(a.addEventListener("progress",w),null!==c&&a.upload&&a.upload.addEventListener("progress",L)),a.send(c),o.next({type:L8.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",d),a.removeEventListener("timeout",m),n.reportProgress&&(a.removeEventListener("progress",w),null!==c&&a.upload&&a.upload.removeEventListener("progress",L)),a.readyState!==a.DONE&&a.abort()}})))}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(FB))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const ZS=new tt("XSRF_ENABLED"),PU=new tt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),TU=new tt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class OU{}let Gge=(()=>{var r;class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=AB(n,this.cookieName),this.lastCookieString=n),this.lastToken}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(P2),Pe(d3),Pe(PU))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function Uge(r,e){const t=r.url.toLowerCase();if(!rt(ZS)||"GET"===r.method||"HEAD"===r.method||t.startsWith("http://")||t.startsWith("https://"))return e(r);const n=rt(OU).getToken(),i=rt(TU);return null!=n&&!r.headers.has(i)&&(r=r.clone({headers:r.headers.set(i,n)})),e(r)}var L4=function(r){return r[r.Interceptors=0]="Interceptors",r[r.LegacyInterceptors=1]="LegacyInterceptors",r[r.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",r[r.NoXsrfProtection=3]="NoXsrfProtection",r[r.JsonpSupport=4]="JsonpSupport",r[r.RequestsMadeViaParent=5]="RequestsMadeViaParent",r[r.Fetch=6]="Fetch",r}(L4||{});function g6(r,e){return{\u0275kind:r,\u0275providers:e}}function Wge(...r){const e=[Age,SU,MU,{provide:hg,useExisting:MU},{provide:pg,useExisting:SU},{provide:J7,useValue:Uge,multi:!0},{provide:ZS,useValue:!0},{provide:OU,useClass:Gge}];for(const t of r)e.push(...t.\u0275providers);return function yM(r){return{\u0275providers:r}}(e)}const bU=new tt("LEGACY_INTERCEPTOR_FN");let jge=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({providers:[Wge(g6(L4.LegacyInterceptors,[{provide:bU,useFactory:Rge},{provide:J7,useExisting:bU,multi:!0}]))]}),e})();function YS(...r){const e=Vu(r),t=VR(r),{args:n,keys:i}=uG(r);if(0===n.length)return t2([],e);const s=new S1(function eme(r,e,t=Xa){return n=>{wU(e,()=>{const{length:i}=r,s=new Array(i);let o=i,a=i;for(let c=0;c<i;c++)wU(e,()=>{const l=t2(r[c],e);let f=!1;l.subscribe(dr(n,d=>{s[c]=d,f||(f=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,i?o=>dG(i,o):Xa));return t?s.pipe(fG(t)):s}function wU(r,e,t){r?s3(t,r,e):e()}const _g=So(r=>function(){r(this),this.name="EmptyError",this.message="no elements in sequence"});function KS(...r){return function tme(){return H0(1)}()(t2(r,Vu(r)))}function NU(r){return new S1(e=>{Ws(r()).subscribe(e)})}function ef(r,e){const t=Mn(r)?r:()=>r,n=i=>i.error(t());return new S1(e?i=>e.schedule(n,0,i):n)}function XS(){return Wr((r,e)=>{let t=null;r._refCount++;const n=dr(e,void 0,void 0,void 0,()=>{if(!r||r._refCount<=0||0<--r._refCount)return void(t=null);const i=r._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});r.subscribe(n),n.closed||(t=r.connect())})}class AU extends S1{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ih(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new En;const t=this.getSubject();e.add(this.source.subscribe(dr(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=En.EMPTY)}return e}refCount(){return XS()(this)}}function z8(r){return r<=0?()=>Qa:Wr((e,t)=>{let n=0;e.subscribe(dr(t,i=>{++n<=r&&(t.next(i),r<=n&&t.complete())}))})}function vg(r){return Wr((e,t)=>{let n=!1;e.subscribe(dr(t,i=>{n=!0,t.next(i)},()=>{n||t.next(r),t.complete()}))})}function IU(r=rme){return Wr((e,t)=>{let n=!1;e.subscribe(dr(t,i=>{n=!0,t.next(i)},()=>n?t.complete():t.error(r())))})}function rme(){return new _g}function m6(r,e){const t=arguments.length>=2;return n=>n.pipe(r?E3((i,s)=>r(i,s,n)):Xa,z8(1),t?vg(e):IU(()=>new _g))}function bi(r,e,t){const n=Mn(r)||e||t?{next:r,error:e,complete:t}:r;return n?Wr((i,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;i.subscribe(dr(s,c=>{var l;null===(l=n.next)||void 0===l||l.call(n,c),s.next(c)},()=>{var c;a=!1,null===(c=n.complete)||void 0===c||c.call(n),s.complete()},c=>{var l;a=!1,null===(l=n.error)||void 0===l||l.call(n,c),s.error(c)},()=>{var c,l;a&&(null===(c=n.unsubscribe)||void 0===c||c.call(n)),null===(l=n.finalize)||void 0===l||l.call(n)}))}):Xa}function _6(r){return Wr((e,t)=>{let s,n=null,i=!1;n=e.subscribe(dr(t,void 0,void 0,o=>{s=Ws(r(o,_6(r)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):i=!0})),i&&(n.unsubscribe(),n=null,s.subscribe(t))})}function QS(r){return r<=0?()=>Qa:Wr((e,t)=>{let n=[];e.subscribe(dr(t,i=>{n.push(i),r<n.length&&n.shift()},()=>{for(const i of n)t.next(i);t.complete()},void 0,()=>{n=null}))})}const nn="primary",tf=Symbol("RouteTitle");class cme{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function D8(r){return new cme(r)}function lme(r,e,t){const n=t.path.split("/");if(n.length>r.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<r.length))return null;const i={};for(let s=0;s<n.length;s++){const o=n[s],a=r[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function mc(r,e){const t=r?Object.keys(r):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!kU(r[i],e[i]))return!1;return!0}function kU(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;const t=[...r].sort(),n=[...e].sort();return t.every((i,s)=>n[s]===i)}return r===e}function xU(r){return r.length>0?r[r.length-1]:null}function R4(r){return function Jge(r){return!!r&&(r instanceof S1||Mn(r.lift)&&Mn(r.subscribe))}(r)?r:P7(r)?t2(Promise.resolve(r)):Dt(r)}const fme={exact:function zU(r,e,t){if(!v6(r.segments,e.segments)||!Cg(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!r.children[n]||!zU(r.children[n],e.children[n],t))return!1;return!0},subset:DU},LU={exact:function dme(r,e){return mc(r,e)},subset:function hme(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>kU(r[t],e[t]))},ignored:()=>!0};function RU(r,e,t){return fme[t.paths](r.root,e.root,t.matrixParams)&&LU[t.queryParams](r.queryParams,e.queryParams)&&!("exact"===t.fragment&&r.fragment!==e.fragment)}function DU(r,e,t){return HU(r,e,e.segments,t)}function HU(r,e,t,n){if(r.segments.length>t.length){const i=r.segments.slice(0,t.length);return!(!v6(i,t)||e.hasChildren()||!Cg(i,t,n))}if(r.segments.length===t.length){if(!v6(r.segments,t)||!Cg(r.segments,t,n))return!1;for(const i in e.children)if(!r.children[i]||!DU(r.children[i],e.children[i],n))return!1;return!0}{const i=t.slice(0,r.segments.length),s=t.slice(r.segments.length);return!!(v6(r.segments,i)&&Cg(r.segments,i,n)&&r.children[nn])&&HU(r.children[nn],e,s,n)}}function Cg(r,e,t){return e.every((n,i)=>LU[t](r[i].parameters,n.parameters))}class H8{constructor(e=new s1([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=D8(this.queryParams)),this._queryParamMap}toString(){return mme.serialize(this)}}class s1{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yg(this)}}class nf{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=D8(this.parameters)),this._parameterMap}toString(){return $U(this)}}function v6(r,e){return r.length===e.length&&r.every((t,n)=>t.path===e[n].path)}let rf=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return new JS},providedIn:"root"}),e})();class JS{parse(e){const t=new bme(e);return new H8(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${sf(e.root,!0)}`,n=function Cme(r){const e=Object.keys(r).map(t=>{const n=r[t];return Array.isArray(n)?n.map(i=>`${Mg(t)}=${Mg(i)}`).join("&"):`${Mg(t)}=${Mg(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function _me(r){return encodeURI(r)}(e.fragment)}`:""}`}}const mme=new JS;function yg(r){return r.segments.map(e=>$U(e)).join("/")}function sf(r,e){if(!r.hasChildren())return yg(r);if(e){const t=r.children[nn]?sf(r.children[nn],!1):"",n=[];return Object.entries(r.children).forEach(([i,s])=>{i!==nn&&n.push(`${i}:${sf(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function gme(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===nn&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==nn&&(t=t.concat(e(i,n)))}),t}(r,(n,i)=>i===nn?[sf(r.children[nn],!1)]:[`${i}:${sf(n,!1)}`]);return 1===Object.keys(r.children).length&&null!=r.children[nn]?`${yg(r)}/${t[0]}`:`${yg(r)}/(${t.join("//")})`}}function VU(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Mg(r){return VU(r).replace(/%3B/gi,";")}function eP(r){return VU(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Eg(r){return decodeURIComponent(r)}function FU(r){return Eg(r.replace(/\+/g,"%20"))}function $U(r){return`${eP(r.path)}${function vme(r){return Object.keys(r).map(e=>`;${eP(e)}=${eP(r[e])}`).join("")}(r.parameters)}`}const yme=/^[^\/()?;#]+/;function tP(r){const e=r.match(yme);return e?e[0]:""}const Mme=/^[^\/()?;=#]+/,Sme=/^[^=?&#]+/,Tme=/^[^&#]+/;class bme{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new s1([],{}):new s1([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[nn]=new s1(e,t)),n}parseSegment(){const e=tP(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ge(4009,!1);return this.capture(e),new nf(Eg(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function Eme(r){const e=r.match(Mme);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const i=tP(this.remaining);i&&(n=i,this.capture(n))}e[Eg(t)]=Eg(n)}parseQueryParam(e){const t=function Pme(r){const e=r.match(Sme);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function Ome(r){const e=r.match(Tme);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const i=FU(t),s=FU(n);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=tP(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new ge(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=nn);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[nn]:new s1([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ge(4011,!1)}}function BU(r){return r.segments.length>0?new s1([],{[nn]:r}):r}function GU(r){const e={};for(const n of Object.keys(r.children)){const s=GU(r.children[n]);if(n===nn&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function wme(r){if(1===r.numberOfChildren&&r.children[nn]){const e=r.children[nn];return new s1(r.segments.concat(e.segments),e.children)}return r}(new s1(r.segments,e))}function C6(r){return r instanceof H8}function UU(r){let e;const i=BU(function t(s){const o={};for(const c of s.children){const l=t(c);o[c.outlet]=l}const a=new s1(s.url,o);return s===r&&(e=a),a}(r.root));return e??i}function WU(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(0===e.length)return nP(i,i,i,t,n);const s=function Ame(r){if("string"==typeof r[0]&&1===r.length&&"/"===r[0])return new jU(!0,0,r);let e=0,t=!1;const n=r.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]="string"==typeof l?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,c)=>{0==c&&"."===a||(0==c&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new jU(t,e,n)}(e);if(s.toRoot())return nP(i,i,new s1([],{}),t,n);const o=function Ime(r,e,t){if(r.isAbsolute)return new Pg(e,!0,0);if(!t)return new Pg(e,!1,NaN);if(null===t.parent)return new Pg(t,!0,0);const n=Sg(r.commands[0])?0:1;return function kme(r,e,t){let n=r,i=e,s=t;for(;s>i;){if(s-=i,n=n.parent,!n)throw new ge(4005,!1);i=n.segments.length}return new Pg(n,!1,i-s)}(t,t.segments.length-1+n,r.numberOfDoubleDots)}(s,i,r),a=o.processChildren?cf(o.segmentGroup,o.index,s.commands):ZU(o.segmentGroup,o.index,s.commands);return nP(i,o.segmentGroup,a,t,n)}function Sg(r){return"object"==typeof r&&null!=r&&!r.outlets&&!r.segmentPath}function af(r){return"object"==typeof r&&null!=r&&r.outlets}function nP(r,e,t,n,i){let o,s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(f=>`${f}`):`${l}`}),o=r===e?t:qU(r,e,t);const a=BU(GU(o));return new H8(a,s,i)}function qU(r,e,t){const n={};return Object.entries(r.children).forEach(([i,s])=>{n[i]=s===e?t:qU(s,e,t)}),new s1(r.segments,n)}class jU{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Sg(n[0]))throw new ge(4003,!1);const i=n.find(af);if(i&&i!==xU(n))throw new ge(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Pg{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function ZU(r,e,t){if(r||(r=new s1([],{})),0===r.segments.length&&r.hasChildren())return cf(r,e,t);const n=function Lme(r,e,t){let n=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return s;const o=r.segments[i],a=t[n];if(af(a))break;const c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&void 0===c)break;if(c&&l&&"object"==typeof l&&void 0===l.outlets){if(!KU(c,l,o))return s;n+=2}else{if(!KU(c,{},o))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){const s=new s1(r.segments.slice(0,n.pathIndex),{});return s.children[nn]=new s1(r.segments.slice(n.pathIndex),r.children),cf(s,0,i)}return n.match&&0===i.length?new s1(r.segments,{}):n.match&&!r.hasChildren()?rP(r,e,t):n.match?cf(r,0,i):rP(r,e,t)}function cf(r,e,t){if(0===t.length)return new s1(r.segments,{});{const n=function xme(r){return af(r[0])?r[0].outlets:{[nn]:r}}(t),i={};if(!n[nn]&&r.children[nn]&&1===r.numberOfChildren&&0===r.children[nn].segments.length){const s=cf(r.children[nn],e,t);return new s1(r.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=ZU(r.children[s],e,o))}),Object.entries(r.children).forEach(([s,o])=>{void 0===n[s]&&(i[s]=o)}),new s1(r.segments,i)}}function rP(r,e,t){const n=r.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(af(s)){const c=Rme(s.outlets);return new s1(n,c)}if(0===i&&Sg(t[0])){n.push(new nf(r.segments[e].path,YU(t[0]))),i++;continue}const o=af(s)?s.outlets[nn]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&Sg(a)?(n.push(new nf(o,YU(a))),i+=2):(n.push(new nf(o,{})),i++)}return new s1(n,{})}function Rme(r){const e={};return Object.entries(r).forEach(([t,n])=>{"string"==typeof n&&(n=[n]),null!==n&&(e[t]=rP(new s1([],{}),0,n))}),e}function YU(r){const e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function KU(r,e,t){return r==t.path&&mc(e,t.parameters)}const lf="imperative";class _c{constructor(e,t){this.id=e,this.url=t}}class iP extends _c{constructor(e,t,n="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class z4 extends _c{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Tg extends _c{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class uf extends _c{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=16}}class sP extends _c{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class zme extends _c{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Dme extends _c{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hme extends _c{constructor(e,t,n,i,s){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Vme extends _c{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Fme extends _c{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $me{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Bme{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Gme{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ume{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wme{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qme{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class XU{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class jme{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new ff,this.attachRef=null}}let ff=(()=>{var r;class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){const s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){const i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new jme,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();class QU{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=oP(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=oP(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=aP(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return aP(e,this._root).map(t=>t.value)}}function oP(r,e){if(r===e.value)return e;for(const t of e.children){const n=oP(r,t);if(n)return n}return null}function aP(r,e){if(r===e.value)return[e];for(const t of e.children){const n=aP(r,t);if(n.length)return n.unshift(e),n}return[]}class S3{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function V8(r){const e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}class JU extends QU{constructor(e,t){super(e),this.snapshot=t,cP(this,e)}toString(){return this.snapshot.toString()}}function eW(r,e){const t=function Zme(r,e){const o=new Og([],{},{},"",{},nn,e,null,{});return new nW("",new S3(o,[]))}(0,e),n=new Zi([new nf("",{})]),i=new Zi({}),s=new Zi({}),o=new Zi({}),a=new Zi(""),c=new Is(n,i,o,a,s,nn,e,t.root);return c.snapshot=t.root,new JU(new S3(c,[]),t)}class Is{constructor(e,t,n,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Un(l=>l[tf]))??Dt(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Un(e=>D8(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Un(e=>D8(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function tW(r,e="emptyOnly"){const t=r.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const i=t[n],s=t[n-1];if(i.routeConfig&&""===i.routeConfig.path)n--;else{if(s.component)break;n--}}return function Yme(r){return r.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(n))}class Og{get title(){return this.data?.[tf]}constructor(e,t,n,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=D8(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=D8(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class nW extends QU{constructor(e,t){super(t),this.url=e,cP(this,t)}toString(){return rW(this._root)}}function cP(r,e){e.value._routerState=r,e.children.forEach(t=>cP(r,t))}function rW(r){const e=r.children.length>0?` { ${r.children.map(rW).join(", ")} } `:"";return`${r.value}${e}`}function lP(r){if(r.snapshot){const e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,mc(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),mc(e.params,t.params)||r.paramsSubject.next(t.params),function ume(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!mc(r[t],e[t]))return!1;return!0}(e.url,t.url)||r.urlSubject.next(t.url),mc(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function uP(r,e){const t=mc(r.params,e.params)&&function pme(r,e){return v6(r,e)&&r.every((t,n)=>mc(t.parameters,e[n].parameters))}(r.url,e.url);return t&&!(!r.parent!=!e.parent)&&(!r.parent||uP(r.parent,e.parent))}let fP=(()=>{var r;class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=nn,this.activateEvents=new b1,this.deactivateEvents=new b1,this.attachEvents=new b1,this.detachEvents=new b1,this.parentContexts=rt(ff),this.location=rt(Js),this.changeDetector=rt(s6),this.environmentInjector=rt(Xs),this.inputBinder=rt(bg,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ge(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ge(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ge(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new ge(4013,!1);this._activatedRoute=n;const s=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Kme(n,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ki]}),e})();class Kme{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Is?this.route:e===ff?this.childContexts:this.parent.get(e,t)}}const bg=new tt("");let iW=(()=>{var r;class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:i}=n,s=YS([i.queryParams,i.params,i.data]).pipe(oa(([o,a,c],l)=>(c={...o,...a,...c},0===l?Dt(c):Promise.resolve(c)))).subscribe(o=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(n);const a=function J9e(r){const e=xn(r);if(!e)return null;const t=new C7(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(i.component);if(a)for(const{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,o[c]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,s)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function df(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const i=function Qme(r,e,t){return e.children.map(n=>{for(const i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return df(r,n,i);return df(r,n)})}(r,e,t);return new S3(n,i)}{if(r.shouldAttach(e.value)){const s=r.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>df(r,a)),o}}const n=function Jme(r){return new Is(new Zi(r.url),new Zi(r.params),new Zi(r.queryParams),new Zi(r.fragment),new Zi(r.data),r.outlet,r.component,r)}(e.value),i=e.children.map(s=>df(r,s));return new S3(n,i)}}const dP="ngNavigationCancelingError";function sW(r,e){const{redirectTo:t,navigationBehaviorOptions:n}=C6(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=oW(!1,0,e);return i.url=t,i.navigationBehaviorOptions=n,i}function oW(r,e,t){const n=new Error("NavigationCancelingError: "+(r||""));return n[dP]=!0,n.cancellationCode=e,t&&(n.url=t),n}function aW(r){return cW(r)&&C6(r.url)}function cW(r){return r&&r[dP]}let lW=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275cmp=Xe({type:r,selectors:[["ng-component"]],standalone:!0,features:[$F],decls:1,vars:0,template:function(n,i){1&n&&F(0,"router-outlet")},dependencies:[fP],encapsulation:2}),e})();function hP(r){const e=r.children&&r.children.map(hP),t=e?{...r,children:e}:{...r};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==nn&&(t.component=lW),t}function ma(r){return r.outlet||nn}function hf(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class o_e{constructor(e,t,n,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),lP(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const i=V8(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],n),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=n.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=V8(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,s=V8(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){const i=V8(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new qme(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Ume(e.value.snapshot))}activateRoutes(e,t,n){const i=e.value,s=t?t.value:null;if(lP(i),i===s)if(i.component){const o=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(i.component){const o=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),lP(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=hf(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class uW{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class wg{constructor(e,t){this.component=e,this.route=t}}function a_e(r,e,t){const n=r._root;return pf(n,e?e._root:null,t,[n.value])}function F8(r,e){const t=Symbol(),n=e.get(r,t);return n===t?"function"!=typeof r||function C4e(r){return null!==uh(r)}(r)?e.get(r):r:n}function pf(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=V8(e);return r.children.forEach(o=>{(function l_e(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=r.value,o=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const c=function u_e(r,e,t){if("function"==typeof t)return t(r,e);switch(t){case"pathParamsChange":return!v6(r.url,e.url);case"pathParamsOrQueryParamsChange":return!v6(r.url,e.url)||!mc(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!uP(r,e)||!mc(r.queryParams,e.queryParams);default:return!uP(r,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new uW(n)):(s.data=o.data,s._resolvedData=o._resolvedData),pf(r,e,s.component?a?a.children:null:t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new wg(a.outlet.component,o))}else o&&gf(e,a,i),i.canActivateChecks.push(new uW(n)),pf(r,null,s.component?a?a.children:null:t,n,i)})(o,s[o.value.outlet],t,n.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>gf(a,t.getContext(o),i)),i}function gf(r,e,t){const n=V8(r),i=r.value;Object.entries(n).forEach(([s,o])=>{gf(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new wg(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function mf(r){return"function"==typeof r}function fW(r){return r instanceof _g||"EmptyError"===r?.name}const Ng=Symbol("INITIAL_VALUE");function $8(){return oa(r=>YS(r.map(e=>e.pipe(z8(1),function nme(...r){const e=Vu(r);return Wr((t,n)=>{(e?KS(r,t,e):KS(r,t)).subscribe(n)})}(Ng)))).pipe(Un(e=>{for(const t of e)if(!0!==t){if(t===Ng)return Ng;if(!1===t||t instanceof H8)return t}return!0}),E3(e=>e!==Ng),z8(1)))}function dW(r){return function eh(...r){return th(r)}(bi(e=>{if(C6(e))throw sW(0,e)}),Un(e=>!0===e))}class Ag{constructor(e){this.segmentGroup=e||null}}class hW{constructor(e){this.urlTree=e}}function B8(r){return ef(new Ag(r))}function pW(r){return ef(new hW(r))}class A_e{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new ge(4002,!1)}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return Dt(n);if(i.numberOfChildren>1||!i.children[nn])return ef(new ge(4e3,!1));i=i.children[nn]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreateUrlTree(e,t,n,i){const s=this.createSegmentGroup(e,t.root,n,i);return new H8(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);n[i]=t[a]}else n[i]=s}),n}createSegmentGroup(e,t,n,i){const s=this.createSegments(e,t.segments,n,i);let o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,n,i)}),new s1(s,o)}createSegments(e,t,n,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,t,n){const i=n[t.path.substring(1)];if(!i)throw new ge(4001,!1);return i}findOrReturn(e,t){let n=0;for(const i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}}const pP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function I_e(r,e,t,n,i){const s=gP(r,e,t);return s.matched?(n=function e_e(r,e){return r.providers&&!r._injector&&(r._injector=yE(r.providers,e,`Route: ${r.path}`)),r._injector??e}(e,n),function b_e(r,e,t,n){const i=e.canMatch;return i&&0!==i.length?Dt(i.map(o=>{const a=F8(o,r);return R4(function m_e(r){return r&&mf(r.canMatch)}(a)?a.canMatch(e,t):r.runInContext(()=>a(e,t)))})).pipe($8(),dW()):Dt(!0)}(n,e,t).pipe(Un(o=>!0===o?s:{...pP}))):Dt(s)}function gP(r,e,t){if(""===e.path)return"full"===e.pathMatch&&(r.hasChildren()||t.length>0)?{...pP}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||lme)(t,r,e);if(!i)return{...pP};const s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function gW(r,e,t,n){return t.length>0&&function L_e(r,e,t){return t.some(n=>Ig(r,e,n)&&ma(n)!==nn)}(r,t,n)?{segmentGroup:new s1(e,x_e(n,new s1(t,r.children))),slicedSegments:[]}:0===t.length&&function R_e(r,e,t){return t.some(n=>Ig(r,e,n))}(r,t,n)?{segmentGroup:new s1(r.segments,k_e(r,0,t,n,r.children)),slicedSegments:t}:{segmentGroup:new s1(r.segments,r.children),slicedSegments:t}}function k_e(r,e,t,n,i){const s={};for(const o of n)if(Ig(r,t,o)&&!i[ma(o)]){const a=new s1([],{});s[ma(o)]=a}return{...i,...s}}function x_e(r,e){const t={};t[nn]=e;for(const n of r)if(""===n.path&&ma(n)!==nn){const i=new s1([],{});t[ma(n)]=i}return t}function Ig(r,e,t){return(!(r.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class V_e{constructor(e,t,n,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new A_e(this.urlSerializer,this.urlTree)}noMatchError(e){return new ge(4002,!1)}recognize(){const e=gW(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,nn).pipe(_6(t=>{if(t instanceof hW)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof Ag?this.noMatchError(t):t}),Un(t=>{const n=new Og([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},nn,this.rootComponentType,null,{}),i=new S3(n,t),s=new nW("",i),o=function Nme(r,e,t=null,n=null){return WU(UU(r),e,t,n)}(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,nn).pipe(_6(n=>{throw n instanceof Ag?this.noMatchError(n):n}))}inheritParamsAndData(e){const t=e.value,n=tW(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,n,i){return 0===n.segments.length&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,i,!0)}processChildren(e,t,n){const i=[];for(const s of Object.keys(n.children))"primary"===s?i.unshift(s):i.push(s);return t2(i).pipe(x8(s=>{const o=n.children[s],a=function i_e(r,e){const t=r.filter(n=>ma(n)===e);return t.push(...r.filter(n=>ma(n)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),function sme(r,e){return Wr(function ime(r,e,t,n,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(dr(o,f=>{const d=l++;c=a?r(c,f,d):(a=!0,f),n&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}(r,e,arguments.length>=2,!0))}((s,o)=>(s.push(...o),s)),vg(null),function ome(r,e){const t=arguments.length>=2;return n=>n.pipe(r?E3((i,s)=>r(i,s,n)):Xa,QS(1),t?vg(e):IU(()=>new _g))}(),j2(s=>{if(null===s)return B8(n);const o=mW(s);return function F_e(r){r.sort((e,t)=>e.value.outlet===nn?-1:t.value.outlet===nn?1:e.value.outlet.localeCompare(t.value.outlet))}(o),Dt(o)}))}processSegment(e,t,n,i,s,o){return t2(t).pipe(x8(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,i,s,o).pipe(_6(c=>{if(c instanceof Ag)return Dt(null);throw c}))),m6(a=>!!a),_6(a=>{if(fW(a))return function D_e(r,e,t){return 0===e.length&&!r.children[t]}(n,i,s)?Dt([]):B8(n);throw a}))}processSegmentAgainstRoute(e,t,n,i,s,o,a){return function z_e(r,e,t,n){return!!(ma(r)===n||n!==nn&&Ig(e,t,r))&&("**"===r.path||gP(e,r,t).matched)}(n,i,s,o)?void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,i,n,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,s,o):B8(i):B8(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,i){const s=this.applyRedirects.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?pW(s):this.applyRedirects.lineralizeSegments(n,s).pipe(j2(o=>{const a=new s1(o,{});return this.processSegment(e,t,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,i,s,o){const{matched:a,consumedSegments:c,remainingSegments:l,positionalParamSegments:f}=gP(t,i,s);if(!a)return B8(t);const d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,f);return i.redirectTo.startsWith("/")?pW(d):this.applyRedirects.lineralizeSegments(i,d).pipe(j2(m=>this.processSegment(e,n,t,m.concat(l),o,!1)))}matchSegmentAgainstRoute(e,t,n,i,s,o){let a;if("**"===n.path){const c=i.length>0?xU(i).parameters:{};a=Dt({snapshot:new Og(i,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,_W(n),ma(n),n.component??n._loadedComponent??null,n,vW(n)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=I_e(t,n,i,e).pipe(Un(({matched:c,consumedSegments:l,remainingSegments:f,parameters:d})=>c?{snapshot:new Og(l,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,_W(n),ma(n),n.component??n._loadedComponent??null,n,vW(n)),consumedSegments:l,remainingSegments:f}:null));return a.pipe(oa(c=>null===c?B8(t):this.getChildConfig(e=n._injector??e,n,i).pipe(oa(({routes:l})=>{const f=n._loadedInjector??e,{snapshot:d,consumedSegments:m,remainingSegments:M}=c,{segmentGroup:w,slicedSegments:L}=gW(t,m,M,l);if(0===L.length&&w.hasChildren())return this.processChildren(f,l,w).pipe(Un($=>null===$?null:[new S3(d,$)]));if(0===l.length&&0===L.length)return Dt([new S3(d,[])]);const z=ma(n)===s;return this.processSegment(f,l,w,L,z?nn:s,!0).pipe(Un($=>[new S3(d,$)]))}))))}getChildConfig(e,t,n){return t.children?Dt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Dt({routes:t._loadedRoutes,injector:t._loadedInjector}):function O_e(r,e,t,n){const i=e.canLoad;return void 0===i||0===i.length?Dt(!0):Dt(i.map(o=>{const a=F8(o,r);return R4(function d_e(r){return r&&mf(r.canLoad)}(a)?a.canLoad(e,t):r.runInContext(()=>a(e,t)))})).pipe($8(),dW())}(e,t,n).pipe(j2(i=>i?this.configLoader.loadChildren(e,t).pipe(bi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function N_e(r){return ef(oW(!1,3))}())):Dt({routes:[],injector:e})}}function $_e(r){const e=r.value.routeConfig;return e&&""===e.path}function mW(r){const e=[],t=new Set;for(const n of r){if(!$_e(n)){e.push(n);continue}const i=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...n.children),t.add(i)):e.push(n)}for(const n of t){const i=mW(n.children);e.push(new S3(n.value,i))}return e.filter(n=>!t.has(n))}function _W(r){return r.data||{}}function vW(r){return r.resolve||{}}function CW(r){return"string"==typeof r.title||null===r.title}function mP(r){return oa(e=>{const t=r(e);return t?t2(t).pipe(Un(()=>e)):Dt(e)})}const G8=new tt("ROUTES");let _P=(()=>{var r;class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=rt(k$)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Dt(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const i=R4(n.loadComponent()).pipe(Un(yW),bi(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),X7(()=>{this.componentLoaders.delete(n)})),s=new AU(i,()=>new Ms).pipe(XS());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Dt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(Un(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let l,f;return Array.isArray(c)?f=c:(l=c.create(n).injector,f=l.get(G8,[],cn.Self|cn.Optional).flat()),{routes:f.map(hP),injector:l}}),X7(()=>{this.childrenLoaders.delete(i)})),a=new AU(o,()=>new Ms).pipe(XS());return this.childrenLoaders.set(i,a),a}loadModuleFactoryOrRoutes(n){return R4(n()).pipe(Un(yW),j2(i=>i instanceof VF||Array.isArray(i)?Dt(i):t2(this.compiler.compileModuleAsync(i))))}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function yW(r){return function Z_e(r){return r&&"object"==typeof r&&"default"in r}(r)?r.default:r}let kg=(()=>{var r;class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ms,this.configLoader=rt(_P),this.environmentInjector=rt(Xs),this.urlSerializer=rt(rf),this.rootContexts=rt(ff),this.inputBindingEnabled=null!==rt(bg,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Dt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new Bme(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new $me(s))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:i})}setupNavigations(n){return this.transitions=new Zi({id:0,currentUrlTree:n.currentUrlTree,currentRawUrl:n.currentUrlTree,extractedUrl:n.urlHandlingStrategy.extract(n.currentUrlTree),urlAfterRedirects:n.urlHandlingStrategy.extract(n.currentUrlTree),rawUrl:n.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:lf,restoredState:null,currentSnapshot:n.routerState.snapshot,targetSnapshot:null,currentRouterState:n.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(E3(i=>0!==i.id),Un(i=>({...i,extractedUrl:n.urlHandlingStrategy.extract(i.rawUrl)})),oa(i=>{let s=!1,o=!1;return Dt(i).pipe(bi(a=>{this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),oa(a=>{const c=n.browserUrlTree.toString(),l=!n.navigated||a.extractedUrl.toString()!==c||c!==n.currentUrlTree.toString();if(!l&&"reload"!==(a.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const d="";return this.events.next(new uf(a.id,n.serializeUrl(i.rawUrl),d,0)),n.rawUrlTree=a.rawUrl,a.resolve(null),Qa}if(n.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return MW(a.source)&&(n.browserUrlTree=a.extractedUrl),Dt(a).pipe(oa(d=>{const m=this.transitions?.getValue();return this.events.next(new iP(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?Qa:Promise.resolve(d)}),function B_e(r,e,t,n,i,s){return j2(o=>function H_e(r,e,t,n,i,s,o="emptyOnly"){return new V_e(r,e,t,n,i,o,s).recognize()}(r,e,t,n,o.extractedUrl,i,s).pipe(Un(({state:a,tree:c})=>({...o,targetSnapshot:a,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,n.paramsInheritanceStrategy),bi(d=>{if(i.targetSnapshot=d.targetSnapshot,i.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:d.urlAfterRedirects},"eager"===n.urlUpdateStrategy){if(!d.extras.skipLocationChange){const M=n.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);n.setBrowserUrl(M,d)}n.browserUrlTree=d.urlAfterRedirects}const m=new zme(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(l&&n.urlHandlingStrategy.shouldProcessUrl(n.rawUrlTree)){const{id:d,extractedUrl:m,source:M,restoredState:w,extras:L}=a,z=new iP(d,this.urlSerializer.serialize(m),M,w);this.events.next(z);const $=eW(0,this.rootComponentType).snapshot;return Dt(i={...a,targetSnapshot:$,urlAfterRedirects:m,extras:{...L,skipLocationChange:!1,replaceUrl:!1}})}{const d="";return this.events.next(new uf(a.id,n.serializeUrl(i.extractedUrl),d,1)),n.rawUrlTree=a.rawUrl,a.resolve(null),Qa}}),bi(a=>{const c=new Dme(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),Un(a=>i={...a,guards:a_e(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),function v_e(r,e){return j2(t=>{const{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Dt({...t,guardsResult:!0}):function C_e(r,e,t,n){return t2(r).pipe(j2(i=>function T_e(r,e,t,n,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Dt(s.map(a=>{const c=hf(e)??i,l=F8(a,c);return R4(function g_e(r){return r&&mf(r.canDeactivate)}(l)?l.canDeactivate(r,e,t,n):c.runInContext(()=>l(r,e,t,n))).pipe(m6())})).pipe($8()):Dt(!0)}(i.component,i.route,t,e,n)),m6(i=>!0!==i,!0))}(o,n,i,r).pipe(j2(a=>a&&function f_e(r){return"boolean"==typeof r}(a)?function y_e(r,e,t,n){return t2(e).pipe(x8(i=>KS(function E_e(r,e){return null!==r&&e&&e(new Gme(r)),Dt(!0)}(i.route.parent,n),function M_e(r,e){return null!==r&&e&&e(new Wme(r)),Dt(!0)}(i.route,n),function P_e(r,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function c_e(r){const e=r.routeConfig?r.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:r,guards:e}:null}(o)).filter(o=>null!==o).map(o=>NU(()=>Dt(o.guards.map(c=>{const l=hf(o.node)??t,f=F8(c,l);return R4(function p_e(r){return r&&mf(r.canActivateChild)}(f)?f.canActivateChild(n,r):l.runInContext(()=>f(n,r))).pipe(m6())})).pipe($8())));return Dt(s).pipe($8())}(r,i.path,t),function S_e(r,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return Dt(!0);const i=n.map(s=>NU(()=>{const o=hf(e)??t,a=F8(s,o);return R4(function h_e(r){return r&&mf(r.canActivate)}(a)?a.canActivate(e,r):o.runInContext(()=>a(e,r))).pipe(m6())}));return Dt(i).pipe($8())}(r,i.route,t))),m6(i=>!0!==i,!0))}(n,s,r,e):Dt(a)),Un(a=>({...t,guardsResult:a})))})}(this.environmentInjector,a=>this.events.next(a)),bi(a=>{if(i.guardsResult=a.guardsResult,C6(a.guardsResult))throw sW(0,a.guardsResult);const c=new Hme(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(c)}),E3(a=>!!a.guardsResult||(n.restoreHistory(a),this.cancelNavigationTransition(a,"",3),!1)),mP(a=>{if(a.guards.canActivateChecks.length)return Dt(a).pipe(bi(c=>{const l=new Vme(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),oa(c=>{let l=!1;return Dt(c).pipe(function G_e(r,e){return j2(t=>{const{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Dt(t);let s=0;return t2(i).pipe(x8(o=>function U_e(r,e,t,n){const i=r.routeConfig,s=r._resolve;return void 0!==i?.title&&!CW(i)&&(s[tf]=i.title),function W_e(r,e,t,n){const i=function q_e(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}(r);if(0===i.length)return Dt({});const s={};return t2(i).pipe(j2(o=>function j_e(r,e,t,n){const i=hf(e)??n,s=F8(r,i);return R4(s.resolve?s.resolve(e,t):i.runInContext(()=>s(e,t)))}(r[o],e,t,n).pipe(m6(),bi(a=>{s[o]=a}))),QS(1),function ame(r){return Un(()=>r)}(s),_6(o=>fW(o)?Qa:ef(o)))}(s,r,e,n).pipe(Un(o=>(r._resolvedData=o,r.data=tW(r,t).resolve,i&&CW(i)&&(r.data[tf]=i.title),null)))}(o.route,n,r,e)),bi(()=>s++),QS(1),j2(o=>s===i.length?Dt(t):Qa))})}(n.paramsInheritanceStrategy,this.environmentInjector),bi({next:()=>l=!0,complete:()=>{l||(n.restoreHistory(c),this.cancelNavigationTransition(c,"",2))}}))}),bi(c=>{const l=new Fme(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}))}),mP(a=>{const c=l=>{const f=[];l.routeConfig?.loadComponent&&!l.routeConfig._loadedComponent&&f.push(this.configLoader.loadComponent(l.routeConfig).pipe(bi(d=>{l.component=d}),Un(()=>{})));for(const d of l.children)f.push(...c(d));return f};return YS(c(a.targetSnapshot.root)).pipe(vg(),z8(1))}),mP(()=>this.afterPreactivation()),Un(a=>{const c=function Xme(r,e,t){const n=df(r,e._root,t?t._root:void 0);return new JU(n,e)}(n.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return i={...a,targetRouterState:c}}),bi(a=>{n.currentUrlTree=a.urlAfterRedirects,n.rawUrlTree=n.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),n.routerState=a.targetRouterState,"deferred"===n.urlUpdateStrategy&&(a.extras.skipLocationChange||n.setBrowserUrl(n.rawUrlTree,a),n.browserUrlTree=a.urlAfterRedirects)}),((r,e,t,n)=>Un(i=>(new o_e(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)))(this.rootContexts,n.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),z8(1),bi({next:a=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,n.navigated=!0,this.events.next(new z4(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(n.currentUrlTree))),n.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{s=!0}}),X7(()=>{s||o||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),_6(a=>{if(o=!0,cW(a)){aW(a)||(n.navigated=!0,n.restoreHistory(i,!0));const c=new Tg(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode);if(this.events.next(c),aW(a)){const l=n.urlHandlingStrategy.merge(a.url,n.rawUrlTree),f={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===n.urlUpdateStrategy||MW(i.source)};n.scheduleNavigation(l,lf,null,f,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{n.restoreHistory(i,!0);const c=new sP(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);this.events.next(c);try{i.resolve(n.errorHandler(a))}catch(l){i.reject(l)}}return Qa}))}))}cancelNavigationTransition(n,i,s){const o=new Tg(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(o),n.resolve(!1)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();function MW(r){return r!==lf}let EW=(()=>{var r;class e{buildTitle(n){let i,s=n.root;for(;void 0!==s;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===nn);return i}getResolvedTitleForRoute(n){return n.data[tf]}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return rt(Y_e)},providedIn:"root"}),e})(),Y_e=(()=>{var r;class e extends EW{constructor(n){super(),this.title=n}updateTitle(n){const i=this.buildTitle(n);void 0!==i&&this.title.setTitle(i)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(iG))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),K_e=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return rt(Q_e)},providedIn:"root"}),e})();class X_e{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Q_e=(()=>{var r;class e extends X_e{}return(r=e).\u0275fac=function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}(),r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const xg=new tt("",{providedIn:"root",factory:()=>({})});let J_e=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:function(){return rt(eve)},providedIn:"root"}),e})(),eve=(()=>{var r;class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();var _f=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(_f||{});function SW(r,e){r.events.pipe(E3(t=>t instanceof z4||t instanceof Tg||t instanceof sP||t instanceof uf),Un(t=>t instanceof z4||t instanceof uf?_f.COMPLETE:t instanceof Tg&&(0===t.code||1===t.code)?_f.REDIRECTING:_f.FAILED),E3(t=>t!==_f.REDIRECTING),z8(1)).subscribe(()=>{e()})}function tve(r){throw r}function nve(r,e,t){return e.parse("/")}const rve={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ive={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Bn=(()=>{var r;class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=rt(I$),this.isNgZoneEnabled=!1,this.options=rt(xg,{optional:!0})||{},this.pendingTasks=rt(Lp),this.errorHandler=this.options.errorHandler||tve,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||nve,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=rt(J_e),this.routeReuseStrategy=rt(K_e),this.titleStrategy=rt(EW),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=rt(G8,{optional:!0})?.flat()??[],this.navigationTransitions=rt(kg),this.urlSerializer=rt(rf),this.location=rt(tS),this.componentInputBindingEnabled=!!rt(bg,{optional:!0}),this.isNgZoneEnabled=rt(i1)instanceof i1&&i1.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new H8,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=eW(0,null),this.navigationTransitions.setupNavigations(this).subscribe(n=>{this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId??0},n=>{this.console.warn(`Unhandled Navigation Error: ${n}`)})}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const n=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),lf,n)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(n=>{const i="popstate"===n.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(n.url,i,n.state)},0)}))}navigateToSyncWithBrowser(n,i,s){const o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){const l={...s};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(o.state=l)}const c=this.parseUrl(n);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(hP),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(n,i={}){const{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,f=l?this.currentUrlTree.fragment:a;let m,d=null;switch(c){case"merge":d={...this.currentUrlTree.queryParams,...o};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}null!==d&&(d=this.removeEmptyProps(d));try{m=UU(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),m=this.currentUrlTree.root}return WU(m,n,d,f??null)}navigateByUrl(n,i={skipLocationChange:!1}){const s=C6(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,lf,null,i)}navigate(n,i={skipLocationChange:!1}){return function sve(r){for(let e=0;e<r.length;e++)if(null==r[e])throw new ge(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){let i;try{i=this.urlSerializer.parse(n)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,n)}return i}isActive(n,i){let s;if(s=!0===i?{...rve}:!1===i?{...ive}:i,C6(n))return RU(this.currentUrlTree,n,s);const o=this.parseUrl(n);return RU(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.keys(n).reduce((i,s)=>{const o=n[s];return null!=o&&(i[s]=o),i},{})}scheduleNavigation(n,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,f;a?(c=a.resolve,l=a.reject,f=a.promise):f=new Promise((m,M)=>{c=m,l=M});const d=this.pendingTasks.add();return SW(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:l,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}setBrowserUrl(n,i){const s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(s,"",a)}else{const o={...i.extras.state,...this.generateNgRouterState(i.id,(this.browserPageId??0)+1)};this.location.go(s,"",o)}}restoreHistory(n,i=!1){if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-(this.browserPageId??this.currentPageId);0!==o?this.location.historyGo(o):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===o&&(this.resetState(n),this.browserUrlTree=n.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=n.currentRouterState,this.currentUrlTree=n.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),vc=(()=>{var r;class e{constructor(n,i,s,o,a,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Ms,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=n.events.subscribe(f=>{f instanceof z4&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,o,a){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||i||s||o||a||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:function QD(r,e,t){return function O0e(r,e){return"src"===e&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===e&&("base"===r||"link"===r)?XD:ep}(e,t)(r)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,i){const s=this.renderer,o=this.el.nativeElement;null!==i?s.setAttribute(o,n,i):s.removeAttribute(o,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return(r=e).\u0275fac=function(n){return new(n||r)(G(Bn),G(Is),function Lh(r){return function Gle(r,e){if("class"===e)return r.classes;if("style"===e)return r.styles;const t=r.attrs;if(t){const n=t.length;let i=0;for(;i<n;){const s=t[i];if(JR(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<n&&"string"==typeof t[i];)i++;else{if(s===e)return t[i+1];i+=2}}}return null}(X2(),r)}("tabindex"),G(ac),G(Si),G(a6))},r.\u0275dir=Rt({type:r,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(n,i){1&n&&U("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&n&&k("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",N8],skipLocationChange:["skipLocationChange","skipLocationChange",N8],replaceUrl:["replaceUrl","replaceUrl",N8],routerLink:"routerLink"},standalone:!0,features:[oV,Ki]}),e})();class PW{}let cve=(()=>{var r;class e{constructor(n,i,s,o,a){this.router=n,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(E3(n=>n instanceof z4),x8(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,i){const s=[];for(const o of i){o.providers&&!o._injector&&(o._injector=yE(o.providers,n,`Route: ${o.path}`));const a=o._injector??n,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&void 0===o.canLoad||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return t2(s).pipe(H0())}preloadConfig(n,i){return this.preloadingStrategy.preload(i,()=>{let s;s=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(n,i):Dt(null);const o=s.pipe(j2(a=>null===a?Dt(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??n,a.routes))));return i.loadComponent&&!i._loadedComponent?t2([o,this.loader.loadComponent(i)]).pipe(H0()):o})}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(Bn),Pe(k$),Pe(Xs),Pe(PW),Pe(_P))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})();const vP=new tt("");let TW=(()=>{var r;class e{constructor(n,i,s,o,a={}){this.urlSerializer=n,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration=a.scrollPositionRestoration||"disabled",a.anchorScrolling=a.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof iP?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof z4?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof uf&&0===n.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof XU&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new XU(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return(r=e).\u0275fac=function(n){!function LH(){throw new Error("invalid")}()},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();function P3(r,e){return{\u0275kind:r,\u0275providers:e}}function bW(){const r=rt(Q2);return e=>{const t=r.get(i6);if(e!==t.components[0])return;const n=r.get(Bn),i=r.get(wW);1===r.get(CP)&&n.initialNavigation(),r.get(NW,null,cn.Optional)?.setUpPreloading(),r.get(vP,null,cn.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const wW=new tt("",{factory:()=>new Ms}),CP=new tt("",{providedIn:"root",factory:()=>1}),NW=new tt("");function dve(r){return P3(0,[{provide:NW,useExisting:cve},{provide:PW,useExisting:r}])}const AW=new tt("ROUTER_FORROOT_GUARD"),pve=[tS,{provide:rf,useClass:JS},Bn,ff,{provide:Is,useFactory:function OW(r){return r.routerState.root},deps:[Bn]},_P,[]];function gve(){return new U$("Router",Bn)}let mve=(()=>{var r;class e{constructor(n){}static forRoot(n,i){return{ngModule:e,providers:[pve,[],{provide:G8,multi:!0,useValue:n},{provide:AW,useFactory:yve,deps:[[Bn,new es,new Dh]]},{provide:xg,useValue:i||{}},i?.useHash?{provide:a6,useClass:ide}:{provide:a6,useClass:CB},{provide:vP,useFactory:()=>{const r=rt(Mhe),e=rt(i1),t=rt(xg),n=rt(kg),i=rt(rf);return t.scrollOffset&&r.setOffset(t.scrollOffset),new TW(i,n,r,e,t)}},i?.preloadingStrategy?dve(i.preloadingStrategy).\u0275providers:[],{provide:U$,multi:!0,useFactory:gve},i?.initialNavigation?Mve(i):[],i?.bindToComponentInputs?P3(8,[iW,{provide:bg,useExisting:iW}]).\u0275providers:[],[{provide:IW,useFactory:bW},{provide:WE,multi:!0,useExisting:IW}]]}}static forChild(n){return{ngModule:e,providers:[{provide:G8,multi:!0,useValue:n}]}}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(AW,8))},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({}),e})();function yve(r){return"guarded"}function Mve(r){return["disabled"===r.initialNavigation?P3(3,[{provide:RE,multi:!0,useFactory:()=>{const e=rt(Bn);return()=>{e.setUpLocationChangeListener()}}},{provide:CP,useValue:2}]).\u0275providers:[],"enabledBlocking"===r.initialNavigation?P3(2,[{provide:CP,useValue:0},{provide:RE,multi:!0,deps:[Q2],useFactory:e=>{const t=e.get(nde,Promise.resolve());return()=>t.then(()=>new Promise(n=>{const i=e.get(Bn),s=e.get(wW);SW(i,()=>{n(!0)}),e.get(kg).afterPreactivation=()=>(n(!0),s.closed?Dt(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const IW=new tt("");class kW{}class Sve{}const T3="*";function xW(r,e=null){return{type:2,steps:r,options:e}}function LW(r){return{type:6,styles:r,offset:null}}class vf{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class RW{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const s=this.players.length;0==s?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++i==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}function zW(r){return new ge(3e3,!1)}function D4(r){switch(r.length){case 0:return new vf;case 1:return r[0];default:return new RW(r)}}function DW(r,e,t=new Map,n=new Map){const i=[],s=[];let o=-1,a=null;if(e.forEach(c=>{const l=c.get("offset"),f=l==o,d=f&&a||new Map;c.forEach((m,M)=>{let w=M,L=m;if("offset"!==M)switch(w=r.normalizePropertyName(w,i),L){case"!":L=t.get(M);break;case T3:L=n.get(M);break;default:L=r.normalizeStyleValue(M,w,L,i)}d.set(w,L)}),f||s.push(d),a=d,o=l}),i.length)throw function qve(r){return new ge(3502,!1)}();return s}function MP(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&EP(t,"start",r)));break;case"done":r.onDone(()=>n(t&&EP(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&EP(t,"destroy",r)))}}function EP(r,e,t){const s=SP(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,t.totalTime??r.totalTime,!!t.disabled),o=r._data;return null!=o&&(s._data=o),s}function SP(r,e,t,n,i="",s=0,o){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:s,disabled:!!o}}function no(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function HW(r){const e=r.indexOf(":");return[r.substring(1,e),r.slice(e+1)]}const iCe=(()=>typeof document>"u"?null:document.documentElement)();function PP(r){const e=r.parentNode||r.host||null;return e===iCe?null:e}let y6=null,VW=!1;function FW(r,e){for(;e;){if(e===r)return!0;e=PP(e)}return!1}function $W(r,e,t){if(t)return Array.from(r.querySelectorAll(e));const n=r.querySelector(e);return n?[n]:[]}let BW=(()=>{var r;class e{validateStyleProperty(n){return function oCe(r){y6||(y6=function aCe(){return typeof document<"u"?document.body:null}()||{},VW=!!y6.style&&"WebkitAppearance"in y6.style);let e=!0;return y6.style&&!function sCe(r){return"ebkit"==r.substring(1,6)}(r)&&(e=r in y6.style,!e&&VW&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in y6.style)),e}(n)}matchesElement(n,i){return!1}containsElement(n,i){return FW(n,i)}getParentElement(n){return PP(n)}query(n,i,s){return $W(n,i,s)}computeStyle(n,i,s){return s||""}animate(n,i,s,o,a,c=[],l){return new vf(s,o)}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})(),TP=(()=>{class e{}return e.NOOP=new BW,e})();const cCe=1e3,OP="ng-enter",Lg="ng-leave",Rg="ng-trigger",zg=".ng-trigger",UW="ng-animating",bP=".ng-animating";function O3(r){if("number"==typeof r)return r;const e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:wP(parseFloat(e[1]),e[2])}function wP(r,e){return"s"===e?r*cCe:r}function Dg(r,e,t){return r.hasOwnProperty("duration")?r:function uCe(r,e,t){let i,s=0,o="";if("string"==typeof r){const a=r.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(zW()),{duration:0,delay:0,easing:""};i=wP(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(s=wP(parseFloat(c),a[4]));const l=a[5];l&&(o=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(function Pve(){return new ge(3100,!1)}()),a=!0),s<0&&(e.push(function Tve(){return new ge(3101,!1)}()),a=!0),a&&e.splice(c,0,zW())}return{duration:i,delay:s,easing:o}}(r,e,t)}function Cf(r,e={}){return Object.keys(r).forEach(t=>{e[t]=r[t]}),e}function WW(r){const e=new Map;return Object.keys(r).forEach(t=>{e.set(t,r[t])}),e}function H4(r,e=new Map,t){if(t)for(let[n,i]of t)e.set(n,i);for(let[n,i]of r)e.set(n,i);return e}function Cc(r,e,t){e.forEach((n,i)=>{const s=AP(i);t&&!t.has(i)&&t.set(i,r.style[s]),r.style[s]=n})}function M6(r,e){e.forEach((t,n)=>{const i=AP(n);r.style[i]=""})}function yf(r){return Array.isArray(r)?1==r.length?r[0]:xW(r):r}const NP=new RegExp("{{\\s*(.+?)\\s*}}","g");function jW(r){let e=[];if("string"==typeof r){let t;for(;t=NP.exec(r);)e.push(t[1]);NP.lastIndex=0}return e}function Mf(r,e,t){const n=r.toString(),i=n.replace(NP,(s,o)=>{let a=e[o];return null==a&&(t.push(function bve(r){return new ge(3003,!1)}()),a=""),a.toString()});return i==n?r:i}function Hg(r){const e=[];let t=r.next();for(;!t.done;)e.push(t.value),t=r.next();return e}const hCe=/-+([a-z0-9])/g;function AP(r){return r.replace(hCe,(...e)=>e[1].toUpperCase())}function ro(r,e,t){switch(e.type){case 7:return r.visitTrigger(e,t);case 0:return r.visitState(e,t);case 1:return r.visitTransition(e,t);case 2:return r.visitSequence(e,t);case 3:return r.visitGroup(e,t);case 4:return r.visitAnimate(e,t);case 5:return r.visitKeyframes(e,t);case 6:return r.visitStyle(e,t);case 8:return r.visitReference(e,t);case 9:return r.visitAnimateChild(e,t);case 10:return r.visitAnimateRef(e,t);case 11:return r.visitQuery(e,t);case 12:return r.visitStagger(e,t);default:throw function wve(r){return new ge(3004,!1)}()}}function ZW(r,e){return window.getComputedStyle(r)[e]}const Vg="*";function mCe(r,e){const t=[];return"string"==typeof r?r.split(/\s*,\s*/).forEach(n=>function _Ce(r,e,t){if(":"==r[0]){const c=function vCe(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function Bve(r){return new ge(3016,!1)}()),"* => *"}}(r,t);if("function"==typeof c)return void e.push(c);r=c}const n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function $ve(r){return new ge(3015,!1)}()),e;const i=n[1],s=n[2],o=n[3];e.push(YW(i,o));"<"==s[0]&&!(i==Vg&&o==Vg)&&e.push(YW(o,i))}(n,t,e)):t.push(r),t}const Fg=new Set(["true","1"]),$g=new Set(["false","0"]);function YW(r,e){const t=Fg.has(r)||$g.has(r),n=Fg.has(e)||$g.has(e);return(i,s)=>{let o=r==Vg||r==i,a=e==Vg||e==s;return!o&&t&&"boolean"==typeof i&&(o=i?Fg.has(r):$g.has(r)),!a&&n&&"boolean"==typeof s&&(a=s?Fg.has(e):$g.has(e)),o&&a}}const CCe=new RegExp("s*:selfs*,?","g");function IP(r,e,t,n){return new yCe(r).build(e,t,n)}class yCe{constructor(e){this._driver=e}build(e,t,n){const i=new SCe(t);return this._resetContextStyleTimingState(i),ro(this,yf(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function Ave(){return new ge(3006,!1)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,s.push(this.visitState(c,t))}),c.name=l}else if(1==a.type){const c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push(function Ive(){return new ge(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{jW(c).forEach(l=>{o.hasOwnProperty(l)||s.add(l)})})}),s.size&&(Hg(s.values()),t.errors.push(function kve(r,e){return new ge(3008,!1)}()))}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=ro(this,yf(e.animation),t);return{type:1,matchers:mCe(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:E6(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>ro(this,n,t)),options:E6(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const s=e.steps.map(o=>{t.currentTime=n;const a=ro(this,o,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:s,options:E6(e.options)}}visitAnimate(e,t){const n=function TCe(r,e){if(r.hasOwnProperty("duration"))return r;if("number"==typeof r)return kP(Dg(r,e).duration,0,"");const t=r;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=kP(0,0,"");return s.dynamic=!0,s.strValue=t,s}const i=Dg(t,e);return kP(i.duration,i.delay,i.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let i,s=e.styles?e.styles:LW({});if(5==s.type)i=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const l={};n.easing&&(l.easing=n.easing),o=LW(l)}t.currentTime+=n.duration+n.delay;const c=this.visitStyle(o,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)"string"==typeof a?a===T3?n.push(a):t.errors.push(new ge(3002,!1)):n.push(WW(a));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s))for(let c of a.values())if(c.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((a,c)=>{const l=t.collectedStyles.get(t.currentQuerySelector),f=l.get(c);let d=!0;f&&(s!=i&&s>=f.startTime&&i<=f.endTime&&(t.errors.push(function Lve(r,e,t,n,i){return new ge(3010,!1)}()),d=!1),s=f.startTime),d&&l.set(c,{startTime:s,endTime:i}),t.options&&function dCe(r,e,t){const n=e.params||{},i=jW(r);i.length&&i.forEach(s=>{n.hasOwnProperty(s)||t.push(function Ove(r){return new ge(3001,!1)}())})}(a,t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Rve(){return new ge(3011,!1)}()),n;let s=0;const o=[];let a=!1,c=!1,l=0;const f=e.steps.map($=>{const B=this._makeStyleAst($,t);let de=null!=B.offset?B.offset:function PCe(r){if("string"==typeof r)return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){const n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){const t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(B.styles),_e=0;return null!=de&&(s++,_e=B.offset=de),c=c||_e<0||_e>1,a=a||_e<l,l=_e,o.push(_e),B});c&&t.errors.push(function zve(){return new ge(3012,!1)}()),a&&t.errors.push(function Dve(){return new ge(3200,!1)}());const d=e.steps.length;let m=0;s>0&&s<d?t.errors.push(function Hve(){return new ge(3202,!1)}()):0==s&&(m=1/(d-1));const M=d-1,w=t.currentTime,L=t.currentAnimateTimings,z=L.duration;return f.forEach(($,B)=>{const de=m>0?B==M?1:m*B:o[B],_e=de*z;t.currentTime=w+L.delay+_e,L.duration=_e,this._validateStyleAst($,t),$.offset=de,n.styles.push($)}),n}visitReference(e,t){return{type:8,animation:ro(this,yf(e.animation),t),options:E6(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:E6(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:E6(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function MCe(r){const e=!!r.split(/\s*,\s*/).find(t=>":self"==t);return e&&(r=r.replace(CCe,"")),r=r.replace(/@\*/g,zg).replace(/@\w+/g,t=>zg+"-"+t.slice(1)).replace(/:animating/g,bP),[r,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,no(t.collectedStyles,t.currentQuerySelector,new Map);const a=ro(this,yf(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:i.limit||0,optional:!!i.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:E6(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function Vve(){return new ge(3013,!1)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Dg(e.timings,t.errors,!0);return{type:12,animation:ro(this,yf(e.animation),t),timings:n,options:null}}}class SCe{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function E6(r){return r?(r=Cf(r)).params&&(r.params=function ECe(r){return r?Cf(r):null}(r.params)):r={},r}function kP(r,e,t){return{duration:r,delay:e,easing:t}}function xP(r,e,t,n,i,s,o=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:s,totalTime:i+s,easing:o,subTimeline:a}}class Bg{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const wCe=new RegExp(":enter","g"),ACe=new RegExp(":leave","g");function LP(r,e,t,n,i,s=new Map,o=new Map,a,c,l=[]){return(new ICe).buildKeyframes(r,e,t,n,i,s,o,a,c,l)}class ICe{buildKeyframes(e,t,n,i,s,o,a,c,l,f=[]){l=l||new Bg;const d=new RP(e,t,l,i,s,f,[]);d.options=c;const m=c.delay?O3(c.delay):0;d.currentTimeline.delayNextStep(m),d.currentTimeline.setStyles([o],null,d.errors,c),ro(this,n,d);const M=d.timelines.filter(w=>w.containsAnimation());if(M.length&&a.size){let w;for(let L=M.length-1;L>=0;L--){const z=M[L];if(z.element===t){w=z;break}}w&&!w.allowOnlyTimelineStyles()&&w.setStyles([a],null,d.errors,c)}return M.length?M.map(w=>w.buildKeyframes()):[xP(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const i=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,i,i.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(const i of e){const s=i?.delay;if(s){const o="number"==typeof s?s:O3(Mf(s,i?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?O3(n.duration):null,a=null!=n.delay?O3(n.delay):null;return 0!==o&&e.forEach(c=>{const l=t.appendInstructionToTimeline(c,o,a);s=Math.max(s,l.duration+l.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ro(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const s=e.options;if(s&&(s.params||s.delay)&&(i=t.createSubContext(s),i.transformIntoNewTimeline(),null!=s.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=Gg);const o=O3(s.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>ro(this,o,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?O3(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),ro(this,o,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Dg(t.params?Mf(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();const s=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{a.forwardTime((c.offset||0)*s),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},s=i.delay?O3(i.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Gg);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,f)=>{t.currentQueryIndex=f;const d=t.createSubContext(e.options,l);s&&d.delayNextStep(s),l===t.element&&(c=d.currentTimeline),ro(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let c=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime}const f=t.currentTimeline;c&&f.delayNextStep(c);const d=f.currentTime;ro(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-d+(i.startTime-n.currentTimeline.startTime)}}const Gg={};class RP{constructor(e,t,n,i,s,o,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Gg,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Ug(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=O3(n.duration)),null!=n.delay&&(i.delay=O3(n.delay));const s=n.params;if(s){let o=i.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Mf(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,s=new RP(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Gg,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new kCe(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(s),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,s,o){let a=[];if(i&&a.push(this.element),e.length>0){e=(e=e.replace(wCe,"."+this._enterClassName)).replace(ACe,"."+this._leaveClassName);let l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!s&&0==a.length&&o.push(function Fve(r){return new ge(3014,!1)}()),a}}class Ug{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Ug(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||T3),this._currentKeyframe.set(t,T3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);const s=i&&i.params||{},o=function xCe(r,e){const t=new Map;let n;return r.forEach(i=>{if("*"===i){n=n||e.keys();for(let s of n)t.set(s,T3)}else H4(i,t)}),t}(e,this._globalTimelineStyles);for(let[a,c]of o){const l=Mf(c,s,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??T3),this._updateStyle(a,l)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{const i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((a,c)=>{const l=H4(a,new Map,this._backFill);l.forEach((f,d)=>{"!"===f?e.add(d):f===T3&&t.add(d)}),n||l.set("offset",c/this.duration),i.push(l)});const s=e.size?Hg(e.values()):[],o=t.size?Hg(t.values()):[];if(n){const a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return xP(this.element,i,s,o,this.duration,this.startTime,this.easing,!1)}}class kCe extends Ug{constructor(e,t,n,i,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,c=H4(e[0]);c.set("offset",0),s.push(c);const l=H4(e[0]);l.set("offset",QW(a)),s.push(l);const f=e.length-1;for(let d=1;d<=f;d++){let m=H4(e[d]);const M=m.get("offset");m.set("offset",QW((t+M*n)/o)),s.push(m)}n=o,t=0,i="",e=s}return xP(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function QW(r,e=3){const t=Math.pow(10,e-1);return Math.round(r*t)/t}class zP{}const LCe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class RCe extends zP{normalizePropertyName(e,t){return AP(e)}normalizeStyleValue(e,t,n,i){let s="";const o=n.toString().trim();if(LCe.has(t)&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&i.push(function Nve(r,e){return new ge(3005,!1)}())}return o+s}}function JW(r,e,t,n,i,s,o,a,c,l,f,d,m){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:f,totalTime:d,errors:m}}const DP={};class eq{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function zCe(r,e,t,n,i){return r.some(s=>s(e,t,n,i))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return void 0!==e&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,s,o,a,c,l,f){const d=[],m=this.ast.options&&this.ast.options.params||DP,w=this.buildStyles(n,a&&a.params||DP,d),L=c&&c.params||DP,z=this.buildStyles(i,L,d),$=new Set,B=new Map,de=new Map,_e="void"===i,xe={params:DCe(L,m),delay:this.ast.options?.delay},nt=f?[]:LP(e,t,this.ast.animation,s,o,w,z,xe,l,d);let gt=0;if(nt.forEach(Et=>{gt=Math.max(Et.duration+Et.delay,gt)}),d.length)return JW(t,this._triggerName,n,i,_e,w,z,[],[],B,de,gt,d);nt.forEach(Et=>{const W2=Et.element,k0=no(B,W2,new Set);Et.preStyleProps.forEach(Qc=>k0.add(Qc));const Rl=no(de,W2,new Set);Et.postStyleProps.forEach(Qc=>Rl.add(Qc)),W2!==t&&$.add(W2)});const yn=Hg($.values());return JW(t,this._triggerName,n,i,_e,w,z,nt,yn,B,de,gt)}}function DCe(r,e){const t=Cf(e);for(const n in r)r.hasOwnProperty(n)&&null!=r[n]&&(t[n]=r[n]);return t}class HCe{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n=new Map,i=Cf(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!==o&&(i[s]=o)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((o,a)=>{o&&(o=Mf(o,i,t));const c=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,c,o,t),n.set(a,o)})}),n}}class FCe{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{this.states.set(i.name,new HCe(i.style,i.options&&i.options.params||{},n))}),tq(this.states,"true","1"),tq(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new eq(e,i,this.states))}),this.fallbackTransition=function $Ce(r,e,t){return new eq(r,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(o=>o.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function tq(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}const BCe=new Bg;class GCe{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const n=[],s=IP(this._driver,t,n,[]);if(n.length)throw function jve(r){return new ge(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,n){const i=e.element,s=DW(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],s=this._animations.get(e);let o;const a=new Map;if(s?(o=LP(this._driver,t,s,OP,Lg,new Map,new Map,n,BCe,i),o.forEach(f=>{const d=no(a,f.element,new Map);f.postStyleProps.forEach(m=>d.set(m,null))})):(i.push(function Zve(){return new ge(3300,!1)}()),o=[]),i.length)throw function Yve(r){return new ge(3504,!1)}();a.forEach((f,d)=>{f.forEach((m,M)=>{f.set(M,this._driver.computeStyle(d,M,T3))})});const l=D4(o.map(f=>{const d=a.get(f.element);return this._buildPlayer(f,new Map,d)}));return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function Kve(r){return new ge(3301,!1)}();return t}listen(e,t,n,i){const s=SP(t,"","","");return MP(this._getPlayer(e),n,s,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const nq="ng-animate-queued",HP="ng-animate-disabled",ZCe=[],rq={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},YCe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},_a="__ng_removed";class VP{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function JCe(r){return r??null}(n?e.value:e),n){const s=Cf(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(i=>{null==n[i]&&(n[i]=t[i])})}}}const Ef="void",FP=new VP(Ef);class KCe{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,ko(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw function Xve(r,e){return new ge(3302,!1)}();if(null==n||0==n.length)throw function Qve(r){return new ge(3303,!1)}();if(!function eye(r){return"start"==r||"done"==r}(n))throw function Jve(r,e){return new ge(3400,!1)}();const s=no(this._elementListeners,e,[]),o={name:t,phase:n,callback:i};s.push(o);const a=no(this._engine.statesByElement,e,new Map);return a.has(t)||(ko(e,Rg),ko(e,Rg+"-"+t),a.set(t,FP)),()=>{this._engine.afterFlush(()=>{const c=s.indexOf(o);c>=0&&s.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function eCe(r){return new ge(3401,!1)}();return t}trigger(e,t,n,i=!0){const s=this._getTrigger(t),o=new $P(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(ko(e,Rg),ko(e,Rg+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t);const l=new VP(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=FP),l.value!==Ef&&c.value===l.value){if(!function rye(r,e){const t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){const s=t[i];if(!e.hasOwnProperty(s)||r[s]!==e[s])return!1}return!0}(c.params,l.params)){const L=[],z=s.matchStyles(c.value,c.params,L),$=s.matchStyles(l.value,l.params,L);L.length?this._engine.reportError(L):this._engine.afterFlush(()=>{M6(e,z),Cc(e,$)})}return}const m=no(this._engine.playersByElement,e,[]);m.forEach(L=>{L.namespaceId==this.id&&L.triggerName==t&&L.queued&&L.destroy()});let M=s.matchTransition(c.value,l.value,e,l.params),w=!1;if(!M){if(!i)return;M=s.fallbackTransition,w=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:M,fromState:c,toState:l,player:o,isFallbackTransition:w}),w||(ko(e,nq),o.onStart(()=>{U8(e,nq)})),o.onDone(()=>{let L=this.players.indexOf(o);L>=0&&this.players.splice(L,1);const z=this._engine.playersByElement.get(e);if(z){let $=z.indexOf(o);$>=0&&z.splice($,1)}}),this.players.push(o),m.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,zg,!0);n.forEach(i=>{if(i[_a])return;const s=this._engine.fetchNamespacesByElement(i);s.size?s.forEach(o=>o.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(s.forEach((c,l)=>{if(o.set(l,c.value),this._triggers.has(l)){const f=this.trigger(e,l,Ef,i);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&D4(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(s=>{const o=s.name;if(i.has(o))return;i.add(o);const c=this._triggers.get(o).fallbackTransition,l=n.get(o)||FP,f=new VP(Ef),d=new $P(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:c,fromState:l,toState:f,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)i=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[_a];(!s||s===rq)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){ko(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const c=SP(s,n.triggerName,n.fromState.value,n.toState.value);c._data=e,MP(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{const s=n.transition.ast.depCount,o=i.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}}class XCe{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new KCe(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){const c=i.get(a);if(c){const l=n.indexOf(c);n.splice(l+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);const i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n)for(let i of n.values())if(i.namespaceId){const s=this._fetchNamespace(i.namespaceId);s&&t.add(s)}return t}trigger(e,t,n,i){if(Wg(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!Wg(t))return;const s=t[_a];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),ko(e,HP)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),U8(e,HP))}removeNode(e,t,n){if(Wg(t)){const i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);const s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,s){this.collectedLeaveElements.push(t),t[_a]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,i,s){return Wg(t)?this._fetchNamespace(e).listen(t,n,i,s):()=>{}}_buildInstruction(e,t,n,i,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,zg,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,bP,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return D4(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[_a];if(t&&t.setForRemoval){if(e[_a]=rq,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(HP)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)ko(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?D4(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw function tCe(r){return new ge(3402,!1)}()}_flushAnimations(e,t){const n=new Bg,i=[],s=new Map,o=[],a=new Map,c=new Map,l=new Map,f=new Set;this.disabledNodes.forEach(ft=>{f.add(ft);const Ot=this.driver.query(ft,".ng-animate-queued",!0);for(let xt=0;xt<Ot.length;xt++)f.add(Ot[xt])});const d=this.bodyNode,m=Array.from(this.statesByElement.keys()),M=oq(m,this.collectedEnterElements),w=new Map;let L=0;M.forEach((ft,Ot)=>{const xt=OP+L++;w.set(Ot,xt),ft.forEach(wn=>ko(wn,xt))});const z=[],$=new Set,B=new Set;for(let ft=0;ft<this.collectedLeaveElements.length;ft++){const Ot=this.collectedLeaveElements[ft],xt=Ot[_a];xt&&xt.setForRemoval&&(z.push(Ot),$.add(Ot),xt.hasAnimation?this.driver.query(Ot,".ng-star-inserted",!0).forEach(wn=>$.add(wn)):B.add(Ot))}const de=new Map,_e=oq(m,Array.from($));_e.forEach((ft,Ot)=>{const xt=Lg+L++;de.set(Ot,xt),ft.forEach(wn=>ko(wn,xt))}),e.push(()=>{M.forEach((ft,Ot)=>{const xt=w.get(Ot);ft.forEach(wn=>U8(wn,xt))}),_e.forEach((ft,Ot)=>{const xt=de.get(Ot);ft.forEach(wn=>U8(wn,xt))}),z.forEach(ft=>{this.processLeaveNode(ft)})});const xe=[],nt=[];for(let ft=this._namespaceList.length-1;ft>=0;ft--)this._namespaceList[ft].drainQueuedTransitions(t).forEach(xt=>{const wn=xt.player,wt=xt.element;if(xe.push(wn),this.collectedEnterElements.length){const ji=wt[_a];if(ji&&ji.setForMove){if(ji.previousTriggersValues&&ji.previousTriggersValues.has(xt.triggerName)){const x0=ji.previousTriggersValues.get(xt.triggerName),ia=this.statesByElement.get(xt.element);if(ia&&ia.has(xt.triggerName)){const JC=ia.get(xt.triggerName);JC.value=x0,ia.set(xt.triggerName,JC)}}return void wn.destroy()}}const Jc=!d||!this.driver.containsElement(d,wt),Mo=de.get(wt),zl=w.get(wt),fr=this._buildInstruction(xt,n,zl,Mo,Jc);if(fr.errors&&fr.errors.length)return void nt.push(fr);if(Jc)return wn.onStart(()=>M6(wt,fr.fromStyles)),wn.onDestroy(()=>Cc(wt,fr.toStyles)),void i.push(wn);if(xt.isFallbackTransition)return wn.onStart(()=>M6(wt,fr.fromStyles)),wn.onDestroy(()=>Cc(wt,fr.toStyles)),void i.push(wn);const $3e=[];fr.timelines.forEach(ji=>{ji.stretchStartingKeyframe=!0,this.disabledNodes.has(ji.element)||$3e.push(ji)}),fr.timelines=$3e,n.append(wt,fr.timelines),o.push({instruction:fr,player:wn,element:wt}),fr.queriedElements.forEach(ji=>no(a,ji,[]).push(wn)),fr.preStyleProps.forEach((ji,x0)=>{if(ji.size){let ia=c.get(x0);ia||c.set(x0,ia=new Set),ji.forEach((JC,bR)=>ia.add(bR))}}),fr.postStyleProps.forEach((ji,x0)=>{let ia=l.get(x0);ia||l.set(x0,ia=new Set),ji.forEach((JC,bR)=>ia.add(bR))})});if(nt.length){const ft=[];nt.forEach(Ot=>{ft.push(function nCe(r,e){return new ge(3505,!1)}())}),xe.forEach(Ot=>Ot.destroy()),this.reportError(ft)}const gt=new Map,yn=new Map;o.forEach(ft=>{const Ot=ft.element;n.has(Ot)&&(yn.set(Ot,Ot),this._beforeAnimationBuild(ft.player.namespaceId,ft.instruction,gt))}),i.forEach(ft=>{const Ot=ft.element;this._getPreviousPlayers(Ot,!1,ft.namespaceId,ft.triggerName,null).forEach(wn=>{no(gt,Ot,[]).push(wn),wn.destroy()})});const Et=z.filter(ft=>cq(ft,c,l)),W2=new Map;sq(W2,this.driver,B,l,T3).forEach(ft=>{cq(ft,c,l)&&Et.push(ft)});const Rl=new Map;M.forEach((ft,Ot)=>{sq(Rl,this.driver,new Set(ft),c,"!")}),Et.forEach(ft=>{const Ot=W2.get(ft),xt=Rl.get(ft);W2.set(ft,new Map([...Ot?.entries()??[],...xt?.entries()??[]]))});const Qc=[],Qd=[],Jd={};o.forEach(ft=>{const{element:Ot,player:xt,instruction:wn}=ft;if(n.has(Ot)){if(f.has(Ot))return xt.onDestroy(()=>Cc(Ot,wn.toStyles)),xt.disabled=!0,xt.overrideTotalTime(wn.totalTime),void i.push(xt);let wt=Jd;if(yn.size>1){let Mo=Ot;const zl=[];for(;Mo=Mo.parentNode;){const fr=yn.get(Mo);if(fr){wt=fr;break}zl.push(Mo)}zl.forEach(fr=>yn.set(fr,wt))}const Jc=this._buildAnimation(xt.namespaceId,wn,gt,s,Rl,W2);if(xt.setRealPlayer(Jc),wt===Jd)Qc.push(xt);else{const Mo=this.playersByElement.get(wt);Mo&&Mo.length&&(xt.parentPlayer=D4(Mo)),i.push(xt)}}else M6(Ot,wn.fromStyles),xt.onDestroy(()=>Cc(Ot,wn.toStyles)),Qd.push(xt),f.has(Ot)&&i.push(xt)}),Qd.forEach(ft=>{const Ot=s.get(ft.element);if(Ot&&Ot.length){const xt=D4(Ot);ft.setRealPlayer(xt)}}),i.forEach(ft=>{ft.parentPlayer?ft.syncPlayerEvents(ft.parentPlayer):ft.destroy()});for(let ft=0;ft<z.length;ft++){const Ot=z[ft],xt=Ot[_a];if(U8(Ot,Lg),xt&&xt.hasAnimation)continue;let wn=[];if(a.size){let Jc=a.get(Ot);Jc&&Jc.length&&wn.push(...Jc);let Mo=this.driver.query(Ot,bP,!0);for(let zl=0;zl<Mo.length;zl++){let fr=a.get(Mo[zl]);fr&&fr.length&&wn.push(...fr)}}const wt=wn.filter(Jc=>!Jc.destroyed);wt.length?tye(this,Ot,wt):this.processLeaveNode(Ot)}return z.length=0,Qc.forEach(ft=>{this.players.push(ft),ft.onDone(()=>{ft.destroy();const Ot=this.players.indexOf(ft);this.players.splice(Ot,1)}),ft.play()}),Qc}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const c=!s||s==Ef;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||o.push(l)})}}return(n||i)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const c of t.timelines){const l=c.element,f=l!==s,d=no(n,l,[]);this._getPreviousPlayers(l,f,o,a,t.toState).forEach(M=>{const w=M.getRealPlayer();w.beforeDestroy&&w.beforeDestroy(),M.destroy(),d.push(M)})}M6(s,t.fromStyles)}_buildAnimation(e,t,n,i,s,o){const a=t.triggerName,c=t.element,l=[],f=new Set,d=new Set,m=t.timelines.map(w=>{const L=w.element;f.add(L);const z=L[_a];if(z&&z.removedBeforeQueried)return new vf(w.duration,w.delay);const $=L!==c,B=function nye(r){const e=[];return aq(r,e),e}((n.get(L)||ZCe).map(gt=>gt.getRealPlayer())).filter(gt=>!!gt.element&&gt.element===L),de=s.get(L),_e=o.get(L),xe=DW(this._normalizer,w.keyframes,de,_e),nt=this._buildPlayer(w,xe,B);if(w.subTimeline&&i&&d.add(L),$){const gt=new $P(e,a,L);gt.setRealPlayer(nt),l.push(gt)}return nt});l.forEach(w=>{no(this.playersByQueriedElement,w.element,[]).push(w),w.onDone(()=>function QCe(r,e,t){let n=r.get(e);if(n){if(n.length){const i=n.indexOf(t);n.splice(i,1)}0==n.length&&r.delete(e)}return n}(this.playersByQueriedElement,w.element,w))}),f.forEach(w=>ko(w,UW));const M=D4(m);return M.onDestroy(()=>{f.forEach(w=>U8(w,UW)),Cc(c,t.toStyles)}),d.forEach(w=>{no(i,w,[]).push(M)}),M}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new vf(e.duration,e.delay)}}class $P{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new vf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>MP(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){no(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Wg(r){return r&&1===r.nodeType}function iq(r,e){const t=r.style.display;return r.style.display=e??"none",t}function sq(r,e,t,n,i){const s=[];t.forEach(c=>s.push(iq(c)));const o=[];n.forEach((c,l)=>{const f=new Map;c.forEach(d=>{const m=e.computeStyle(l,d,i);f.set(d,m),(!m||0==m.length)&&(l[_a]=YCe,o.push(l))}),r.set(l,f)});let a=0;return t.forEach(c=>iq(c,s[a++])),o}function oq(r,e){const t=new Map;if(r.forEach(a=>t.set(a,[])),0==e.length)return t;const i=new Set(e),s=new Map;function o(a){if(!a)return 1;let c=s.get(a);if(c)return c;const l=a.parentNode;return c=t.has(l)?l:i.has(l)?1:o(l),s.set(a,c),c}return e.forEach(a=>{const c=o(a);1!==c&&t.get(c).push(a)}),t}function ko(r,e){r.classList?.add(e)}function U8(r,e){r.classList?.remove(e)}function tye(r,e,t){D4(t).onDone(()=>r.processLeaveNode(e))}function aq(r,e){for(let t=0;t<r.length;t++){const n=r[t];n instanceof RW?aq(n.players,e):e.push(n)}}function cq(r,e,t){const n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(s=>i.add(s)):e.set(r,n),t.delete(r),!0}class qg{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,s)=>{},this._transitionEngine=new XCe(e,t,n),this._timelineEngine=new GCe(e,t,n),this._transitionEngine.onRemovalComplete=(i,s)=>this.onRemovalComplete(i,s)}registerTrigger(e,t,n,i,s){const o=e+"-"+i;let a=this._triggerCache[o];if(!a){const c=[],f=IP(this._driver,s,c,[]);if(c.length)throw function Wve(r,e){return new ge(3404,!1)}();a=function VCe(r,e,t){return new FCe(r,e,t)}(i,f,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[s,o]=HW(n);this._timelineEngine.command(s,t,o,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,s){if("@"==n.charAt(0)){const[o,a]=HW(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,i,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}}let sye=(()=>{class e{constructor(n,i,s){this._element=n,this._startStyles=i,this._endStyles=s,this._state=0;let o=e.initialStylesByElement.get(n);o||e.initialStylesByElement.set(n,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Cc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Cc(this._element,this._initialStyles),this._endStyles&&(Cc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(M6(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(M6(this._element,this._endStyles),this._endStyles=null),Cc(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function BP(r){let e=null;return r.forEach((t,n)=>{(function oye(r){return"display"===r||"position"===r})(n)&&(e=e||new Map,e.set(n,t))}),e}class lq{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{"offset"!==i&&e.set(i,this._finished?n:ZW(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class aye{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return FW(e,t)}getParentElement(e){return PP(e)}query(e,t,n){return $W(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,i,s,o=[]){const c={duration:n,delay:i,fill:0==i?"both":"forwards"};s&&(c.easing=s);const l=new Map,f=o.filter(M=>M instanceof lq);(function pCe(r,e){return 0===r||0===e})(n,i)&&f.forEach(M=>{M.currentSnapshot.forEach((w,L)=>l.set(L,w))});let d=function fCe(r){return r.length?r[0]instanceof Map?r:r.map(e=>WW(e)):[]}(t).map(M=>H4(M));d=function gCe(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((s,o)=>{n.has(o)||i.push(o),n.set(o,s)}),i.length)for(let s=1;s<e.length;s++){let o=e[s];i.forEach(a=>o.set(a,ZW(r,a)))}}return e}(e,d,l);const m=function iye(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=BP(e[0]),e.length>1&&(n=BP(e[e.length-1]))):e instanceof Map&&(t=BP(e)),t||n?new sye(r,t,n):null}(e,d);return new lq(e,d,c,m)}}let cye=(()=>{var r;class e extends kW{constructor(n,i){super(),this._nextAnimationId=0,this._renderer=n.createRenderer(i.body,{id:"0",encapsulation:Oo.None,styles:[],data:{animation:[]}})}build(n){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(n)?xW(n):n;return uq(this._renderer,null,i,"register",[s]),new lye(i,this._renderer)}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(p7),Pe(P2))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class lye extends Sve{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new uye(this._id,e,t||{},this._renderer)}}class uye{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return uq(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function uq(r,e,t,n,i){return r.setProperty(e,`@@${t}:${n}`,i)}const fq="@.disabled";let fye=(()=>{var r;class e{constructor(n,i,s){this.delegate=n,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,i.onRemovalComplete=(o,a)=>{const c=a?.parentNode(o);c&&a.removeChild(c,o)}}createRenderer(n,i){const o=this.delegate.createRenderer(n,i);if(!(n&&i&&i.data&&i.data.animation)){let d=this._rendererCache.get(o);return d||(d=new dq("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,d)),d}const a=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,n);const l=d=>{Array.isArray(d)?d.forEach(l):this.engine.registerTrigger(a,c,n,d.name,d)};return i.data.animation.forEach(l),new dye(this,c,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,i,s){n>=0&&n<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[a,c]=o;a(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(p7),Pe(qg),Pe(i1))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();class dq{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==fq?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class dye extends dq{constructor(e,t,n,i,s){super(t,n,i,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==fq?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function hye(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}(e);let s=t.slice(1),o="";return"@"!=s.charAt(0)&&([s,o]=function pye(r){const e=r.indexOf(".");return[r.substring(0,e),r.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,i,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let gye=(()=>{var r;class e extends qg{constructor(n,i,s,o){super(n.body,i,s)}ngOnDestroy(){this.flush()}}return(r=e).\u0275fac=function(n){return new(n||r)(Pe(P2),Pe(TP),Pe(zP),Pe(i6))},r.\u0275prov=De({token:r,factory:r.\u0275fac}),e})();const hq=[{provide:kW,useClass:cye},{provide:zP,useFactory:function mye(){return new RCe}},{provide:qg,useClass:gye},{provide:p7,useFactory:function _ye(r,e,t){return new fye(r,e,t)},deps:[SS,qg,i1]}],GP=[{provide:TP,useFactory:()=>new aye},{provide:aH,useValue:"BrowserAnimations"},...hq],pq=[{provide:TP,useClass:BW},{provide:aH,useValue:"NoopAnimations"},...hq];let vye=(()=>{var r;class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?pq:GP}}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({providers:GP,imports:[rG]}),e})();const kr=void 0,yye=["fr",[["AM","PM"],kr,kr],kr,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],kr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],kr,[["av. J.-C.","ap. J.-C."],kr,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",kr],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[kr,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[kr,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[kr,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[kr,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[kr,"\xa5"],KMF:[kr,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[kr,"$C"],NZD:["$NZ","$"],PHP:[kr,"\u20b1"],RHD:["$RH"],RON:[kr,"L"],RWF:[kr,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[kr,"$T"],TTD:["$TT","$"],TWD:[kr,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[kr,"$"],XPF:["FCFP"],ZMW:[kr,"Kw"]},"ltr",function Cye(r){const t=Math.floor(Math.abs(r)),n=r.toString().replace(/^[^.]*\.?/,"").length,i=parseInt(r.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===i&&0!==t&&t%1e6==0&&0===n||!(i>=0&&i<=5)?4:5}];function gq(r,e,t,n,i,s,o){try{var a=r[s](o),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(n,i)}function P(r){return function(){var e=this,t=arguments;return new Promise(function(n,i){var s=r.apply(e,t);function o(c){gq(s,n,i,o,a,"next",c)}function a(c){gq(s,n,i,o,a,"throw",c)}o(void 0)})}}const mq=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&n+1<r.length&&56320==(64512&r.charCodeAt(n+1))?(i=65536+((1023&i)<<10)+(1023&r.charCodeAt(++n)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},WP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,a=o?r[i+1]:0,c=i+2<r.length,l=c?r[i+2]:0;let m=(15&a)<<2|l>>6,M=63&l;c||(M=64,o||(m=64)),n.push(t[s>>2],t[(3&s)<<4|a>>4],t[m],t[M])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(mq(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const c=((7&i)<<18|(63&r[t++])<<12|(63&r[t++])<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(1023&c))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],a=i<r.length?t[r.charAt(i)]:0;++i;const l=i<r.length?t[r.charAt(i)]:64;++i;const d=i<r.length?t[r.charAt(i)]:64;if(++i,null==s||null==a||null==l||null==d)throw new Pye;n.push(s<<2|a>>4),64!==l&&(n.push(a<<4&240|l>>2),64!==d&&n.push(l<<6&192|d))}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class Pye extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zg=function(r){return function(r){const e=mq(r);return WP.encodeByteArray(e,!0)}(r).replace(/\./g,"")},Yg=function(r){try{return WP.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},Kg=()=>{try{return function bye(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const r=process.env.__FIREBASE_DEFAULTS__;return r?JSON.parse(r):void 0})()||(()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&Yg(r[1]);return e&&JSON.parse(e)})()}catch(r){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`)}},vq=r=>{var e,t;return null===(t=null===(e=Kg())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[r]},Cq=()=>{var r;return null===(r=Kg())||void 0===r?void 0:r.config},yq=r=>{var e;return null===(e=Kg())||void 0===e?void 0:e[`_${r}`]};class Xg{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function T2(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function qP(){const r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function S6(){try{return"object"==typeof indexedDB}catch{return!1}}function Sf(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e((null===(s=i.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}function jP(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class xo extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,xo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yc.prototype.create)}}class yc{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?function Hye(r,e){return r.replace(Vye,(t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`})}(s,n):"Error";return new xo(i,`${this.serviceName}: ${o} (${i}).`,n)}}const Vye=/\{\$([^}]+)}/g;function Jg(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(Eq(s)&&Eq(o)){if(!Jg(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Eq(r){return null!==r&&"object"==typeof r}function Pf(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Tf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Of(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}class Bye{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");i=function Gye(r,e){if("object"!=typeof r||null===r)return!1;for(const t of e)if(t in r&&"function"==typeof r[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===i.next&&(i.next=ZP),void 0===i.error&&(i.error=ZP),void 0===i.complete&&(i.complete=ZP);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZP(){}const Uye=1e3,Wye=2,qye=144e5,jye=.5;function KP(r,e=Uye,t=Wye){const n=e*Math.pow(t,r),i=Math.round(jye*n*(Math.random()-.5)*2);return Math.min(qye,n+i)}function pr(r){return r&&r._delegate?r._delegate:r}class wi{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const P6="[DEFAULT]";class Yye{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Xg;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function Xye(r){return"EAGER"===r.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:P6})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=P6){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return P(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...t.filter(n=>"_delete"in n).map(n=>n._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=P6){return this.instances.has(e)}getOptions(e=P6){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(s)&&o.resolve(i);return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===P6?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=P6){return this.component?this.component.multipleInstances?e:P6:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Qye{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Yye(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const XP=[];var Gn=function(r){return r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT",r}(Gn||{});const Sq={debug:Gn.DEBUG,verbose:Gn.VERBOSE,info:Gn.INFO,warn:Gn.WARN,error:Gn.ERROR,silent:Gn.SILENT},Jye=Gn.INFO,eMe={[Gn.DEBUG]:"log",[Gn.VERBOSE]:"log",[Gn.INFO]:"info",[Gn.WARN]:"warn",[Gn.ERROR]:"error"},tMe=(r,e,...t)=>{if(e<r.logLevel)return;const n=(new Date).toISOString(),i=eMe[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${n}]  ${r.name}:`,...t)};class W8{constructor(e){this.name=e,this._logLevel=Jye,this._logHandler=tMe,this._userLogHandler=null,XP.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Gn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Sq[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Gn.DEBUG,...e),this._logHandler(this,Gn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Gn.VERBOSE,...e),this._logHandler(this,Gn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Gn.INFO,...e),this._logHandler(this,Gn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Gn.WARN,...e),this._logHandler(this,Gn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Gn.ERROR,...e),this._logHandler(this,Gn.ERROR,...e)}}const nMe=(r,e)=>e.some(t=>r instanceof t);let Pq,Tq;const Oq=new WeakMap,QP=new WeakMap,bq=new WeakMap,JP=new WeakMap,eT=new WeakMap;let tT={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return QP.get(r);if("objectStoreNames"===e)return r.objectStoreNames||bq.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return V4(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function lMe(r){return"function"==typeof r?function cMe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function iMe(){return Tq||(Tq=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(nT(this),e),V4(Oq.get(this))}:function(...e){return V4(r.apply(nT(this),e))}:function(e,...t){const n=r.call(nT(this),e,...t);return bq.set(n,e.sort?e.sort():[e]),V4(n)}}(r):(r instanceof IDBTransaction&&function oMe(r){if(QP.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});QP.set(r,e)}(r),nMe(r,function rMe(){return Pq||(Pq=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,tT):r)}function V4(r){if(r instanceof IDBRequest)return function sMe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(V4(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Oq.set(t,r)}).catch(()=>{}),eT.set(e,r),e}(r);if(JP.has(r))return JP.get(r);const e=lMe(r);return e!==r&&(JP.set(r,e),eT.set(e,r)),e}const nT=r=>eT.get(r),fMe=["get","getKey","getAll","getAllKeys","count"],dMe=["put","add","delete","clear"],rT=new Map;function wq(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(rT.get(e))return rT.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=dMe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!fMe.includes(t))return;const s=function(){var o=P(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return rT.set(e,s),s}!function aMe(r){tT=r(tT)}(r=>({...r,get:(e,t,n)=>wq(e,t)||r.get(e,t,n),has:(e,t)=>!!wq(e,t)||r.has(e,t)}));class hMe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function pMe(r){const e=r.getComponent();return"VERSION"===e?.type}(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}return null}).filter(t=>t).join(" ")}}const iT="@firebase/app",T6=new W8("@firebase/app"),em="[DEFAULT]",FMe={[iT]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},O6=new Map,tm=new Map;function $Me(r,e){try{r.container.addComponent(e)}catch(t){T6.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ss(r){const e=r.name;if(tm.has(e))return T6.debug(`There were multiple attempts to register component ${e}.`),!1;tm.set(e,r);for(const t of O6.values())$Me(t,r);return!0}function q8(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}const b3=new yc("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class GMe{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new wi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw b3.create("app-deleted",{appName:this._name})}}const b6="9.23.0";function Aq(r,e={}){let t=r;"object"!=typeof e&&(e={name:e});const n=Object.assign({name:em,automaticDataCollectionEnabled:!1},e),i=n.name;if("string"!=typeof i||!i)throw b3.create("bad-app-name",{appName:String(i)});if(t||(t=Cq()),!t)throw b3.create("no-options");const s=O6.get(i);if(s){if(Jg(t,s.options)&&Jg(n,s.config))return s;throw b3.create("duplicate-app",{appName:i})}const o=new Qye(i);for(const c of tm.values())o.addComponent(c);const a=new GMe(t,n,o);return O6.set(i,a),a}function sT(r=em){const e=O6.get(r);if(!e&&r===em&&Cq())return Aq();if(!e)throw b3.create("no-app",{appName:r});return e}function Iq(){return Array.from(O6.values())}function gr(r,e,t){var n;let i=null!==(n=FMe[r])&&void 0!==n?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];return s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void T6.warn(a.join(" "))}ss(new wi(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const UMe="firebase-heartbeat-database",WMe=1,bf="firebase-heartbeat-store";let aT=null;function kq(){return aT||(aT=function uMe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=V4(o);return n&&o.addEventListener("upgradeneeded",c=>{n(V4(o.result),c.oldVersion,c.newVersion,V4(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}(UMe,WMe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(bf)}}).catch(r=>{throw b3.create("idb-open",{originalErrorMessage:r.message})})),aT}function cT(){return(cT=P(function*(r){try{return yield(yield kq()).transaction(bf).objectStore(bf).get(Lq(r))}catch(e){if(e instanceof xo)T6.warn(e.message);else{const t=b3.create("idb-get",{originalErrorMessage:e?.message});T6.warn(t.message)}}})).apply(this,arguments)}function xq(r,e){return lT.apply(this,arguments)}function lT(){return(lT=P(function*(r,e){try{const n=(yield kq()).transaction(bf,"readwrite");yield n.objectStore(bf).put(e,Lq(r)),yield n.done}catch(t){if(t instanceof xo)T6.warn(t.message);else{const n=b3.create("idb-set",{originalErrorMessage:t?.message});T6.warn(n.message)}}})).apply(this,arguments)}function Lq(r){return`${r.name}!${r.options.appId}`}class YMe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new XMe(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){var e=this;return P(function*(){const n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Rq();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==i&&!e._heartbeatsCache.heartbeats.some(s=>s.date===i))return e._heartbeatsCache.heartbeats.push({date:i,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return P(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=Rq(),{heartbeatsToSend:n,unsentEntries:i}=function KMe(r,e=1024){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),zq(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),zq(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}(e._heartbeatsCache.heartbeats),s=Zg(JSON.stringify({version:2,heartbeats:n}));return e._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(e._heartbeatsCache.heartbeats=i,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function Rq(){return(new Date).toISOString().substring(0,10)}class XMe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return P(function*(){return!!S6()&&Sf().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return P(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function qMe(r){return cT.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return P(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return xq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return P(function*(){var n;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return xq(t.app,{lastSentHeartbeatDate:null!==(n=e.lastSentHeartbeatDate)&&void 0!==n?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function zq(r){return Zg(JSON.stringify({version:2,heartbeats:r})).length}!function QMe(r){ss(new wi("platform-logger",e=>new hMe(e),"PRIVATE")),ss(new wi("heartbeat",e=>new YMe(e),"PRIVATE")),gr(iT,"0.9.13",r),gr(iT,"0.9.13","esm2017"),gr("fire-js","")}("");var Qe,JMe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},va={},uT=uT||{},Yt=JMe||self;function nm(r){var e=typeof r;return"array"==(e="object"!=e?e:r?Array.isArray(r)?"array":e:"null")||"object"==e&&"number"==typeof r.length}function wf(r){var e=typeof r;return"object"==e&&null!=r||"function"==e}var fT="closure_uid_"+(1e9*Math.random()>>>0),tEe=0;function nEe(r,e,t){return r.call.apply(r.bind,arguments)}function rEe(r,e,t){if(!r)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),r.apply(e,i)}}return function(){return r.apply(e,arguments)}}function Ni(r,e,t){return(Ni=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?nEe:rEe).apply(null,arguments)}function rm(r,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),r.apply(this,n)}}function O2(r,e){function t(){}t.prototype=e.prototype,r.$=e.prototype,r.prototype=new t,r.prototype.constructor=r,r.ac=function(n,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(n,o)}}function F4(){this.s=this.s,this.o=this.o}F4.prototype.s=!1,F4.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function eEe(r){Object.prototype.hasOwnProperty.call(r,fT)&&r[fT]||(r[fT]=++tEe)}(this)},F4.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Dq=Array.prototype.indexOf?function(r,e){return Array.prototype.indexOf.call(r,e,void 0)}:function(r,e){if("string"==typeof r)return"string"!=typeof e||1!=e.length?-1:r.indexOf(e,0);for(let t=0;t<r.length;t++)if(t in r&&r[t]===e)return t;return-1};function dT(r){const e=r.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=r[n];return t}return[]}function Hq(r,e){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(nm(n)){const i=r.length||0,s=n.length||0;r.length=i+s;for(let o=0;o<s;o++)r[i+o]=n[o]}else r.push(n)}}function Ai(r,e){this.type=r,this.g=this.target=e,this.defaultPrevented=!1}Ai.prototype.h=function(){this.defaultPrevented=!0};var sEe=function(){if(!Yt.addEventListener||!Object.defineProperty)return!1;var r=!1,e=Object.defineProperty({},"passive",{get:function(){r=!0}});try{Yt.addEventListener("test",()=>{},e),Yt.removeEventListener("test",()=>{},e)}catch{}return r}();function Nf(r){return/^[\s\xa0]*$/.test(r)}function im(){var r=Yt.navigator;return r&&(r=r.userAgent)?r:""}function Mc(r){return-1!=im().indexOf(r)}function hT(r){return hT[" "](r),r}hT[" "]=function(){};var gT,r,aEe=Mc("Opera"),j8=Mc("Trident")||Mc("MSIE"),Vq=Mc("Edge"),pT=Vq||j8,Fq=Mc("Gecko")&&!(-1!=im().toLowerCase().indexOf("webkit")&&!Mc("Edge"))&&!(Mc("Trident")||Mc("MSIE"))&&!Mc("Edge"),cEe=-1!=im().toLowerCase().indexOf("webkit")&&!Mc("Edge");function $q(){var r=Yt.document;return r?r.documentMode:void 0}e:{var mT="",_T=(r=im(),Fq?/rv:([^\);]+)(\)|;)/.exec(r):Vq?/Edge\/([\d\.]+)/.exec(r):j8?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(r):cEe?/WebKit\/(\S+)/.exec(r):aEe?/(?:Version)[ \/]?(\S+)/.exec(r):void 0);if(_T&&(mT=_T?_T[1]:""),j8){var vT=$q();if(null!=vT&&vT>parseFloat(mT)){gT=String(vT);break e}}gT=mT}var lEe=Yt.document&&j8&&($q()||parseInt(gT,10))||void 0;function Af(r,e){if(Ai.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var t=this.type=r.type,n=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=e,e=r.relatedTarget){if(Fq){e:{try{hT(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=r.fromElement:"mouseout"==t&&(e=r.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType="string"==typeof r.pointerType?r.pointerType:uEe[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Af.$.h.call(this)}}O2(Af,Ai);var uEe={2:"touch",3:"pen",4:"mouse"};Af.prototype.h=function(){Af.$.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var If="closure_listenable_"+(1e6*Math.random()|0),fEe=0;function dEe(r,e,t,n,i){this.listener=r,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.la=i,this.key=++fEe,this.fa=this.ia=!1}function sm(r){r.fa=!0,r.listener=null,r.proxy=null,r.src=null,r.la=null}function yT(r,e,t){for(const n in r)e.call(t,r[n],n,r)}function Gq(r){const e={};for(const t in r)e[t]=r[t];return e}const Uq="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Wq(r,e){let t,n;for(let i=1;i<arguments.length;i++){for(t in n=arguments[i],n)r[t]=n[t];for(let s=0;s<Uq.length;s++)t=Uq[s],Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t])}}function om(r){this.src=r,this.g={},this.h=0}function MT(r,e){var t=e.type;if(t in r.g){var s,n=r.g[t],i=Dq(n,e);(s=0<=i)&&Array.prototype.splice.call(n,i,1),s&&(sm(e),0==r.g[t].length&&(delete r.g[t],r.h--))}}function ET(r,e,t,n){for(var i=0;i<r.length;++i){var s=r[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==n)return i}return-1}om.prototype.add=function(r,e,t,n,i){var s=r.toString();(r=this.g[s])||(r=this.g[s]=[],this.h++);var o=ET(r,e,n,i);return-1<o?(e=r[o],t||(e.ia=!1)):((e=new dEe(e,this.src,s,!!n,i)).ia=t,r.push(e)),e};var ST="closure_lm_"+(1e6*Math.random()|0),PT={};function qq(r,e,t,n,i){if(n&&n.once)return Zq(r,e,t,n,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)qq(r,e[s],t,n,i);return null}return t=wT(t),r&&r[If]?r.O(e,t,wf(n)?!!n.capture:!!n,i):jq(r,e,t,!1,n,i)}function jq(r,e,t,n,i,s){if(!e)throw Error("Invalid event type");var o=wf(i)?!!i.capture:!!i,a=OT(r);if(a||(r[ST]=a=new om(r)),(t=a.add(e,t,n,o,s)).proxy)return t;if(n=function pEe(){const e=gEe;return function r(t){return e.call(r.src,r.listener,t)}}(),t.proxy=n,n.src=r,n.listener=t,r.addEventListener)sEe||(i=o),void 0===i&&(i=!1),r.addEventListener(e.toString(),n,i);else if(r.attachEvent)r.attachEvent(Kq(e.toString()),n);else{if(!r.addListener||!r.removeListener)throw Error("addEventListener and attachEvent are unavailable.");r.addListener(n)}return t}function Zq(r,e,t,n,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Zq(r,e[s],t,n,i);return null}return t=wT(t),r&&r[If]?r.P(e,t,wf(n)?!!n.capture:!!n,i):jq(r,e,t,!0,n,i)}function Yq(r,e,t,n,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Yq(r,e[s],t,n,i);else n=wf(n)?!!n.capture:!!n,t=wT(t),r&&r[If]?(r=r.i,(e=String(e).toString())in r.g&&-1<(t=ET(s=r.g[e],t,n,i))&&(sm(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete r.g[e],r.h--))):r&&(r=OT(r))&&(e=r.g[e.toString()],r=-1,e&&(r=ET(e,t,n,i)),(t=-1<r?e[r]:null)&&TT(t))}function TT(r){if("number"!=typeof r&&r&&!r.fa){var e=r.src;if(e&&e[If])MT(e.i,r);else{var t=r.type,n=r.proxy;e.removeEventListener?e.removeEventListener(t,n,r.capture):e.detachEvent?e.detachEvent(Kq(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=OT(e))?(MT(t,r),0==t.h&&(t.src=null,e[ST]=null)):sm(r)}}}function Kq(r){return r in PT?PT[r]:PT[r]="on"+r}function gEe(r,e){if(r.fa)r=!0;else{e=new Af(e,this);var t=r.listener,n=r.la||r.src;r.ia&&TT(r),r=t.call(n,e)}return r}function OT(r){return(r=r[ST])instanceof om?r:null}var bT="__closure_events_fn_"+(1e9*Math.random()>>>0);function wT(r){return"function"==typeof r?r:(r[bT]||(r[bT]=function(e){return r.handleEvent(e)}),r[bT])}function b2(){F4.call(this),this.i=new om(this),this.S=this,this.J=null}function ei(r,e){var t,n=r.J;if(n)for(t=[];n;n=n.J)t.push(n);if(r=r.S,n=e.type||e,"string"==typeof e)e=new Ai(e,r);else if(e instanceof Ai)e.target=e.target||r;else{var i=e;Wq(e=new Ai(n,r),i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=am(o,n,!0,e)&&i}if(i=am(o=e.g=r,n,!0,e)&&i,i=am(o,n,!1,e)&&i,t)for(s=0;s<t.length;s++)i=am(o=e.g=t[s],n,!1,e)&&i}function am(r,e,t,n){if(!(e=r.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&MT(r.i,o),i=!1!==a.call(c,n)&&i}}return i&&!n.defaultPrevented}O2(b2,F4),b2.prototype[If]=!0,b2.prototype.removeEventListener=function(r,e,t,n){Yq(this,r,e,t,n)},b2.prototype.N=function(){if(b2.$.N.call(this),this.i){var e,r=this.i;for(e in r.g){for(var t=r.g[e],n=0;n<t.length;n++)sm(t[n]);delete r.g[e],r.h--}}this.J=null},b2.prototype.O=function(r,e,t,n){return this.i.add(String(r),e,!1,t,n)},b2.prototype.P=function(r,e,t,n){return this.i.add(String(r),e,!0,t,n)};var NT=Yt.JSON.stringify;function _Ee(){var r=AT;let e=null;return r.g&&(e=r.g,r.g=r.g.next,r.g||(r.h=null),e.next=null),e}var Xq=new class mEe{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new CEe,r=>r.reset());class CEe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function yEe(r){var e=1;r=r.split(":");const t=[];for(;0<e&&r.length;)t.push(r.shift()),e--;return r.length&&t.push(r.join(":")),t}function MEe(r){Yt.setTimeout(()=>{throw r},0)}let kf,xf=!1,AT=new class vEe{constructor(){this.h=this.g=null}add(e,t){const n=Xq.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Qq=()=>{const r=Yt.Promise.resolve(void 0);kf=()=>{r.then(EEe)}};var EEe=()=>{for(var r;r=_Ee();){try{r.h.call(r.g)}catch(t){MEe(t)}var e=Xq;e.j(r),100>e.h&&(e.h++,r.next=e.g,e.g=r)}xf=!1};function cm(r,e){b2.call(this),this.h=r||1,this.g=e||Yt,this.j=Ni(this.qb,this),this.l=Date.now()}function IT(r){r.ga=!1,r.T&&(r.g.clearTimeout(r.T),r.T=null)}function kT(r,e,t){if("function"==typeof r)t&&(r=Ni(r,t));else{if(!r||"function"!=typeof r.handleEvent)throw Error("Invalid listener argument");r=Ni(r.handleEvent,r)}return 2147483647<Number(e)?-1:Yt.setTimeout(r,e||0)}function Jq(r){r.g=kT(()=>{r.g=null,r.i&&(r.i=!1,Jq(r))},r.j);const e=r.h;r.h=null,r.m.apply(null,e)}O2(cm,b2),(Qe=cm.prototype).ga=!1,Qe.T=null,Qe.qb=function(){if(this.ga){var r=Date.now()-this.l;0<r&&r<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-r):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ei(this,"tick"),this.ga&&(IT(this),this.start()))}},Qe.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Qe.N=function(){cm.$.N.call(this),IT(this),delete this.g};class SEe extends F4{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Jq(this)}N(){super.N(),this.g&&(Yt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lf(r){F4.call(this),this.h=r,this.g={}}O2(Lf,F4);var ej=[];function tj(r,e,t,n){Array.isArray(t)||(t&&(ej[0]=t.toString()),t=ej);for(var i=0;i<t.length;i++){var s=qq(e,t[i],n||r.handleEvent,!1,r.h||r);if(!s)break;r.g[s.key]=s}}function nj(r){yT(r.g,function(e,t){this.g.hasOwnProperty(t)&&TT(e)},r),r.g={}}function lm(){this.g=!0}function Z8(r,e,t,n){r.info(function(){return"XMLHTTP TEXT ("+e+"): "+function bEe(r,e){if(!r.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(r=0;r<t.length;r++)if(Array.isArray(t[r])){var n=t[r];if(!(2>n.length)){var i=n[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return NT(t)}catch{return e}}(r,t)+(n?" "+n:"")})}Lf.prototype.N=function(){Lf.$.N.call(this),nj(this)},Lf.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},lm.prototype.Ea=function(){this.g=!1},lm.prototype.info=function(){};var w6={},rj=null;function um(){return rj=rj||new b2}function ij(r){Ai.call(this,w6.Ta,r)}function Rf(r){const e=um();ei(e,new ij(e))}function sj(r,e){Ai.call(this,w6.STAT_EVENT,r),this.stat=e}function os(r){const e=um();ei(e,new sj(e,r))}function oj(r,e){Ai.call(this,w6.Ua,r),this.size=e}function zf(r,e){if("function"!=typeof r)throw Error("Fn must not be null and must be a function");return Yt.setTimeout(function(){r()},e)}w6.Ta="serverreachability",O2(ij,Ai),w6.STAT_EVENT="statevent",O2(sj,Ai),w6.Ua="timingevent",O2(oj,Ai);var fm={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},aj={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function xT(){}function lj(){}xT.prototype.h=null;var zT,Df={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function LT(){Ai.call(this,"d")}function RT(){Ai.call(this,"c")}function dm(){}function Hf(r,e,t,n){this.l=r,this.j=e,this.m=t,this.W=n||1,this.U=new Lf(this),this.P=wEe,this.V=new cm(r=pT?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new uj}function uj(){this.i=null,this.g="",this.h=!1}O2(LT,Ai),O2(RT,Ai),O2(dm,xT),dm.prototype.g=function(){return new XMLHttpRequest},dm.prototype.i=function(){return{}},zT=new dm;var wEe=45e3,DT={},hm={};function HT(r,e,t){r.L=1,r.v=_m(w3(e)),r.s=t,r.S=!0,fj(r,null)}function fj(r,e){r.G=Date.now(),Vf(r),r.A=w3(r.v);var t=r.A,n=r.W;Array.isArray(n)||(n=[String(n)]),Mj(t.i,"t",n),r.C=0,t=r.l.J,r.h=new uj,r.g=Wj(r.l,t?e:null,!r.s),0<r.O&&(r.M=new SEe(Ni(r.Pa,r,r.g),r.O)),tj(r.U,r.g,"readystatechange",r.nb),e=r.I?Gq(r.I):{},r.s?(r.u||(r.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",r.g.ha(r.A,r.u,r.s,e)):(r.u="GET",r.g.ha(r.A,r.u,null,e)),Rf(),function PEe(r,e,t,n,i,s){r.info(function(){if(r.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var f=l[0];l=l[1];var d=f.split("_");o=2<=d.length&&"type"==d[1]?o+(f+"=")+l+"&":o+(f+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+i+"]: "+e+"\n"+t+"\n"+o})}(r.j,r.u,r.A,r.m,r.W,r.s)}function dj(r){return!!r.g&&"GET"==r.u&&2!=r.L&&r.l.Ha}function hj(r,e,t){let i,n=!0;for(;!r.J&&r.C<t.length;){if(i=NEe(r,t),i==hm){4==e&&(r.o=4,os(14),n=!1),Z8(r.j,r.m,null,"[Incomplete Response]");break}if(i==DT){r.o=4,os(15),Z8(r.j,r.m,t,"[Invalid Chunk]"),n=!1;break}Z8(r.j,r.m,i,null),VT(r,i)}dj(r)&&i!=hm&&i!=DT&&(r.h.g="",r.C=0),4!=e||0!=t.length||r.h.h||(r.o=1,os(16),n=!1),r.i=r.i&&n,n?0<t.length&&!r.ba&&(r.ba=!0,(e=r.l).g==r&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),qT(e),e.M=!0,os(11))):(Z8(r.j,r.m,t,"[Invalid Chunked Response]"),N6(r),Ff(r))}function NEe(r,e){var t=r.C,n=e.indexOf("\n",t);return-1==n?hm:(t=Number(e.substring(t,n)),isNaN(t)?DT:(n+=1)+t>e.length?hm:(e=e.slice(n,n+t),r.C=n+t,e))}function Vf(r){r.Y=Date.now()+r.P,pj(r,r.P)}function pj(r,e){if(null!=r.B)throw Error("WatchDog timer not null");r.B=zf(Ni(r.lb,r),e)}function pm(r){r.B&&(Yt.clearTimeout(r.B),r.B=null)}function Ff(r){0==r.l.H||r.J||$j(r.l,r)}function N6(r){pm(r);var e=r.M;e&&"function"==typeof e.sa&&e.sa(),r.M=null,IT(r.V),nj(r.U),r.g&&(e=r.g,r.g=null,e.abort(),e.sa())}function VT(r,e){try{var t=r.l;if(0!=t.H&&(t.g==r||FT(t.i,r)))if(!r.K&&FT(t.i,r)&&3==t.H){try{var n=t.Ja.g.parse(e)}catch{n=null}if(Array.isArray(n)&&3==n.length){var i=n;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.G+3e3<r.G))break e;Sm(t),Mm(t)}WT(t),os(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&0==t.A&&!t.v&&(t.v=zf(Ni(t.ib,t),6e3));if(1>=Pj(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else I6(t,11)}else if((r.K||t.g==r)&&Sm(t),!Nf(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(t.V=l[0],l=l[1],2==t.H)if("c"==l[0]){t.K=l[1],t.pa=l[2];const f=l[3];null!=f&&(t.ra=f,t.l.info("VER="+t.ra));const d=l[4];null!=d&&(t.Ga=d,t.l.info("SVER="+t.Ga));const m=l[5];null!=m&&"number"==typeof m&&0<m&&(t.L=n=1.5*m,t.l.info("backChannelRequestTimeoutMs_="+n)),n=t;const M=r.g;if(M){const w=M.g?M.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var s=n.i;s.g||-1==w.indexOf("spdy")&&-1==w.indexOf("quic")&&-1==w.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&($T(s,s.h),s.h=null))}if(n.F){const L=M.g?M.g.getResponseHeader("X-HTTP-Session-Id"):null;L&&(n.Da=L,x1(n.I,n.F,L))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-r.G,t.l.info("Handshake RTT: "+t.S+"ms"));var o=r;if((n=t).wa=Uj(n,n.J?n.pa:null,n.Y),o.K){Tj(n.i,o);var a=o,c=n.L;c&&a.setTimeout(c),a.B&&(pm(a),Vf(a)),n.g=o}else Vj(n);0<t.j.length&&Em(t)}else"stop"!=l[0]&&"close"!=l[0]||I6(t,7);else 3==t.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?I6(t,7):UT(t):"noop"!=l[0]&&t.h&&t.h.Aa(l),t.A=0)}Rf()}catch{}}function gj(r,e){if(r.forEach&&"function"==typeof r.forEach)r.forEach(e,void 0);else if(nm(r)||"string"==typeof r)Array.prototype.forEach.call(r,e,void 0);else for(var t=function IEe(r){if(r.ta&&"function"==typeof r.ta)return r.ta();if(!r.Z||"function"!=typeof r.Z){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(nm(r)||"string"==typeof r){var e=[];r=r.length;for(var t=0;t<r;t++)e.push(t);return e}e=[],t=0;for(const n in r)e[t++]=n;return e}}}(r),n=function AEe(r){if(r.Z&&"function"==typeof r.Z)return r.Z();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if("string"==typeof r)return r.split("");if(nm(r)){for(var e=[],t=r.length,n=0;n<t;n++)e.push(r[n]);return e}for(n in e=[],t=0,r)e[t++]=r[n];return e}(r),i=n.length,s=0;s<i;s++)e.call(void 0,n[s],t&&t[s],r)}(Qe=Hf.prototype).setTimeout=function(r){this.P=r},Qe.nb=function(r){r=r.target;const e=this.M;e&&3==Ec(r)?e.l():this.Pa(r)},Qe.Pa=function(r){try{if(r==this.g)e:{const f=Ec(this.g);var e=this.g.Ia();if(this.g.da(),!(3>f)&&(3!=f||pT||this.g&&(this.h.h||this.g.ja()||xj(this.g)))){this.J||4!=f||7==e||Rf(),pm(this);var t=this.g.da();this.ca=t;t:if(dj(this)){var n=xj(this.g);r="";var i=n.length,s=4==Ec(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){N6(this),Ff(this);var o="";break t}this.h.i=new Yt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,r+=this.h.i.decode(n[e],{stream:s&&e==i-1});n.splice(0,i),this.h.g+=r,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==t,function TEe(r,e,t,n,i,s,o){r.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,f,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Nf(a)){var l=a;break t}}l=null}if(!(t=l)){this.i=!1,this.o=3,os(12),N6(this),Ff(this);break e}Z8(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,VT(this,t)}this.S?(hj(this,f,o),pT&&this.i&&3==f&&(tj(this.U,this.V,"tick",this.mb),this.V.start())):(Z8(this.j,this.m,o,null),VT(this,o)),4==f&&N6(this),this.i&&!this.J&&(4==f?$j(this.l,this):(this.i=!1,Vf(this)))}else(function YEe(r){const e={};r=(r.g&&2<=Ec(r)&&r.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<r.length;n++){if(Nf(r[n]))continue;var t=yEe(r[n]);const i=t[0];if("string"!=typeof(t=t[1]))continue;t=t.trim();const s=e[i]||[];e[i]=s,s.push(t)}!function hEe(r,e){for(const t in r)e.call(void 0,r[t],t,r)}(e,function(n){return n.join(", ")})})(this.g),400==t&&0<o.indexOf("Unknown SID")?(this.o=3,os(12)):(this.o=0,os(13)),N6(this),Ff(this)}}}catch{}},Qe.mb=function(){if(this.g){var r=Ec(this.g),e=this.g.ja();this.C<e.length&&(pm(this),hj(this,r,e),this.i&&4!=r&&Vf(this))}},Qe.cancel=function(){this.J=!0,N6(this)},Qe.lb=function(){this.B=null;const r=Date.now();0<=r-this.Y?(function OEe(r,e){r.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.L&&(Rf(),os(17)),N6(this),this.o=2,Ff(this)):pj(this,this.Y-r)};var mj=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function A6(r){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,r instanceof A6){this.h=r.h,gm(this,r.j),this.s=r.s,this.g=r.g,mm(this,r.m),this.l=r.l;var e=r.i,t=new Gf;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),_j(this,t),this.o=r.o}else r&&(e=String(r).match(mj))?(this.h=!1,gm(this,e[1]||"",!0),this.s=$f(e[2]||""),this.g=$f(e[3]||"",!0),mm(this,e[4]),this.l=$f(e[5]||"",!0),_j(this,e[6]||"",!0),this.o=$f(e[7]||"")):(this.h=!1,this.i=new Gf(null,this.h))}function w3(r){return new A6(r)}function gm(r,e,t){r.j=t?$f(e,!0):e,r.j&&(r.j=r.j.replace(/:$/,""))}function mm(r,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);r.m=e}else r.m=null}function _j(r,e,t){e instanceof Gf?(r.i=e,function HEe(r,e){e&&!r.j&&($4(r),r.i=null,r.g.forEach(function(t,n){var i=n.toLowerCase();n!=i&&(Cj(this,n),Mj(this,i,t))},r)),r.j=e}(r.i,r.h)):(t||(e=Bf(e,zEe)),r.i=new Gf(e,r.h))}function x1(r,e,t){r.i.set(e,t)}function _m(r){return x1(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function $f(r,e){return r?e?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function Bf(r,e,t){return"string"==typeof r?(r=encodeURI(r).replace(e,xEe),t&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function xEe(r){return"%"+((r=r.charCodeAt(0))>>4&15).toString(16)+(15&r).toString(16)}A6.prototype.toString=function(){var r=[],e=this.j;e&&r.push(Bf(e,vj,!0),":");var t=this.g;return(t||"file"==e)&&(r.push("//"),(e=this.s)&&r.push(Bf(e,vj,!0),"@"),r.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&r.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&r.push("/"),r.push(Bf(t,"/"==t.charAt(0)?REe:LEe,!0))),(t=this.i.toString())&&r.push("?",t),(t=this.o)&&r.push("#",Bf(t,DEe)),r.join("")};var vj=/[#\/\?@]/g,LEe=/[#\?:]/g,REe=/[#\?]/g,zEe=/[#\?@]/g,DEe=/#/g;function Gf(r,e){this.h=this.g=null,this.i=r||null,this.j=!!e}function $4(r){r.g||(r.g=new Map,r.h=0,r.i&&function kEe(r,e){if(r){r=r.split("&");for(var t=0;t<r.length;t++){var n=r[t].indexOf("="),i=null;if(0<=n){var s=r[t].substring(0,n);i=r[t].substring(n+1)}else s=r[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(r.i,function(e,t){r.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Cj(r,e){$4(r),e=Y8(r,e),r.g.has(e)&&(r.i=null,r.h-=r.g.get(e).length,r.g.delete(e))}function yj(r,e){return $4(r),e=Y8(r,e),r.g.has(e)}function Mj(r,e,t){Cj(r,e),0<t.length&&(r.i=null,r.g.set(Y8(r,e),dT(t)),r.h+=t.length)}function Y8(r,e){return e=String(e),r.j&&(e=e.toLowerCase()),e}function Ej(r){this.l=r||FEe,r=Yt.PerformanceNavigationTiming?0<(r=Yt.performance.getEntriesByType("navigation")).length&&("hq"==r[0].nextHopProtocol||"h2"==r[0].nextHopProtocol):!!(Yt.g&&Yt.g.Ka&&Yt.g.Ka()&&Yt.g.Ka().ec),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Qe=Gf.prototype).add=function(r,e){$4(this),this.i=null,r=Y8(this,r);var t=this.g.get(r);return t||this.g.set(r,t=[]),t.push(e),this.h+=1,this},Qe.forEach=function(r,e){$4(this),this.g.forEach(function(t,n){t.forEach(function(i){r.call(e,i,n,this)},this)},this)},Qe.ta=function(){$4(this);const r=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let n=0;n<e.length;n++){const i=r[n];for(let s=0;s<i.length;s++)t.push(e[n])}return t},Qe.Z=function(r){$4(this);let e=[];if("string"==typeof r)yj(this,r)&&(e=e.concat(this.g.get(Y8(this,r))));else{r=Array.from(this.g.values());for(let t=0;t<r.length;t++)e=e.concat(r[t])}return e},Qe.set=function(r,e){return $4(this),this.i=null,yj(this,r=Y8(this,r))&&(this.h-=this.g.get(r).length),this.g.set(r,[e]),this.h+=1,this},Qe.get=function(r,e){return r&&0<(r=this.Z(r)).length?String(r[0]):e},Qe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var n=e[t];const s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var i=s;""!==o[n]&&(i+="="+encodeURIComponent(String(o[n]))),r.push(i)}}return this.i=r.join("&")};var FEe=10;function Sj(r){return!!r.h||!!r.g&&r.g.size>=r.j}function Pj(r){return r.h?1:r.g?r.g.size:0}function FT(r,e){return r.h?r.h==e:!!r.g&&r.g.has(e)}function $T(r,e){r.g?r.g.add(e):r.h=e}function Tj(r,e){r.h&&r.h==e?r.h=null:r.g&&r.g.has(e)&&r.g.delete(e)}function Oj(r){if(null!=r.h)return r.i.concat(r.h.F);if(null!=r.g&&0!==r.g.size){let e=r.i;for(const t of r.g.values())e=e.concat(t.F);return e}return dT(r.i)}Ej.prototype.cancel=function(){if(this.i=Oj(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const r of this.g.values())r.cancel();this.g.clear()}};var $Ee=class{stringify(r){return Yt.JSON.stringify(r,void 0)}parse(r){return Yt.JSON.parse(r,void 0)}};function BEe(){this.g=new $Ee}function GEe(r,e,t){const n=t||"";try{gj(r,function(i,s){let o=i;wf(i)&&(o=NT(i)),e.push(n+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(n+"type="+encodeURIComponent("_badmap")),i}}function vm(r,e,t,n,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(n)}catch{}}function Uf(r){this.l=r.fc||null,this.j=r.ob||!1}function Cm(r,e){b2.call(this),this.F=r,this.u=e,this.m=void 0,this.readyState=BT,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}O2(Uf,xT),Uf.prototype.g=function(){return new Cm(this.l,this.j)},Uf.prototype.i=function(r){return function(){return r}}({}),O2(Cm,b2);var BT=0;function bj(r){r.j.read().then(r.Xa.bind(r)).catch(r.ka.bind(r))}function Wf(r){r.readyState=4,r.l=null,r.j=null,r.A=null,qf(r)}function qf(r){r.onreadystatechange&&r.onreadystatechange.call(r)}(Qe=Cm.prototype).open=function(r,e){if(this.readyState!=BT)throw this.abort(),Error("Error reopening a connection");this.C=r,this.B=e,this.readyState=1,qf(this)},Qe.send=function(r){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};r&&(e.body=r),(this.F||Yt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Qe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Wf(this)),this.readyState=BT},Qe.$a=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,qf(this)),this.g&&(this.readyState=3,qf(this),this.g)))if("arraybuffer"===this.responseType)r.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Yt.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bj(this)}else r.text().then(this.Za.bind(this),this.ka.bind(this))},Qe.Xa=function(r){if(this.g){if(this.u&&r.value)this.response.push(r.value);else if(!this.u){var e=r.value?r.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!r.done}))&&(this.response=this.responseText+=e)}r.done?Wf(this):qf(this),3==this.readyState&&bj(this)}},Qe.Za=function(r){this.g&&(this.response=this.responseText=r,Wf(this))},Qe.Ya=function(r){this.g&&(this.response=r,Wf(this))},Qe.ka=function(){this.g&&Wf(this)},Qe.setRequestHeader=function(r,e){this.v.append(r,e)},Qe.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},Qe.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],e=this.h.entries();for(var t=e.next();!t.done;)r.push((t=t.value)[0]+": "+t[1]),t=e.next();return r.join("\r\n")},Object.defineProperty(Cm.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(r){this.m=r?"include":"same-origin"}});var WEe=Yt.JSON.parse;function mr(r){b2.call(this),this.headers=new Map,this.u=r||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=wj,this.L=this.M=!1}O2(mr,b2);var wj="",qEe=/^https?$/i,jEe=["POST","PUT"];function Nj(r,e){r.h=!1,r.g&&(r.l=!0,r.g.abort(),r.l=!1),r.j=e,r.m=5,Aj(r),ym(r)}function Aj(r){r.F||(r.F=!0,ei(r,"complete"),ei(r,"error"))}function Ij(r){if(r.h&&typeof uT<"u"&&(!r.C[1]||4!=Ec(r)||2!=r.da()))if(r.v&&4==Ec(r))kT(r.La,0,r);else if(ei(r,"readystatechange"),4==Ec(r)){r.h=!1;try{const o=r.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===o){var i=String(r.I).match(mj)[1]||null;!i&&Yt.self&&Yt.self.location&&(i=Yt.self.location.protocol.slice(0,-1)),n=!qEe.test(i?i.toLowerCase():"")}t=n}if(t)ei(r,"complete"),ei(r,"success");else{r.m=6;try{var s=2<Ec(r)?r.g.statusText:""}catch{s=""}r.j=s+" ["+r.da()+"]",Aj(r)}}finally{ym(r)}}}function ym(r,e){if(r.g){kj(r);const t=r.g,n=r.C[0]?()=>{}:null;r.g=null,r.C=null,e||ei(r,"ready");try{t.onreadystatechange=n}catch{}}}function kj(r){r.g&&r.L&&(r.g.ontimeout=null),r.A&&(Yt.clearTimeout(r.A),r.A=null)}function Ec(r){return r.g?r.g.readyState:0}function xj(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.K){case wj:case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function Lj(r){let e="";return yT(r,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function GT(r,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=Lj(t),"string"==typeof r?null!=t&&encodeURIComponent(String(t)):x1(r,e,t))}function jf(r,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[r]||e}function Rj(r){this.Ga=0,this.j=[],this.l=new lm,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=jf("failFast",!1,r),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=jf("baseRetryDelayMs",5e3,r),this.hb=jf("retryDelaySeedMs",1e4,r),this.eb=jf("forwardChannelMaxRetries",2,r),this.xa=jf("forwardChannelRequestTimeoutMs",2e4,r),this.va=r&&r.xmlHttpFactory||void 0,this.Ha=r&&r.dc||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.i=new Ej(r&&r.concurrentRequestLimit),this.Ja=new BEe,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=r&&r.bc||!1,r&&r.Ea&&this.l.Ea(),r&&r.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&r&&r.detectBufferingProxy||!1,this.qa=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.qa=r.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function UT(r){if(zj(r),3==r.H){var e=r.W++,t=w3(r.I);if(x1(t,"SID",r.K),x1(t,"RID",e),x1(t,"TYPE","terminate"),Zf(r,t),(e=new Hf(r,r.l,e)).L=2,e.v=_m(w3(t)),t=!1,Yt.navigator&&Yt.navigator.sendBeacon)try{t=Yt.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&Yt.Image&&((new Image).src=e.v,t=!0),t||(e.g=Wj(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Vf(e)}Gj(r)}function Mm(r){r.g&&(qT(r),r.g.cancel(),r.g=null)}function zj(r){Mm(r),r.u&&(Yt.clearTimeout(r.u),r.u=null),Sm(r),r.i.cancel(),r.m&&("number"==typeof r.m&&Yt.clearTimeout(r.m),r.m=null)}function Em(r){if(!Sj(r.i)&&!r.m){r.m=!0;var e=r.Na;kf||Qq(),xf||(kf(),xf=!0),AT.add(e,r),r.C=0}}function Dj(r,e){var t;t=e?e.m:r.W++;const n=w3(r.I);x1(n,"SID",r.K),x1(n,"RID",t),x1(n,"AID",r.V),Zf(r,n),r.o&&r.s&&GT(n,r.o,r.s),t=new Hf(r,r.l,t,r.C+1),null===r.o&&(t.I=r.s),e&&(r.j=e.F.concat(r.j)),e=Hj(r,t,1e3),t.setTimeout(Math.round(.5*r.xa)+Math.round(.5*r.xa*Math.random())),$T(r.i,t),HT(t,n,e)}function Zf(r,e){r.na&&yT(r.na,function(t,n){x1(e,n,t)}),r.h&&gj({},function(t,n){x1(e,n,t)})}function Hj(r,e,t){t=Math.min(r.j.length,t);var n=r.h?Ni(r.h.Va,r.h,r):null;e:{var i=r.j;let s=-1;for(;;){const o=["count="+t];-1==s?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let l=i[c].g;const f=i[c].map;if(l-=s,0>l)s=Math.max(0,i[c].g-100),a=!1;else try{GEe(f,o,"req"+l+"_")}catch{n&&n(f)}}if(a){n=o.join("&");break e}}}return r=r.j.splice(0,t),e.F=r,n}function Vj(r){if(!r.g&&!r.u){r.ba=1;var e=r.Ma;kf||Qq(),xf||(kf(),xf=!0),AT.add(e,r),r.A=0}}function WT(r){return!(r.g||r.u||3<=r.A||(r.ba++,r.u=zf(Ni(r.Ma,r),Bj(r,r.A)),r.A++,0))}function qT(r){null!=r.B&&(Yt.clearTimeout(r.B),r.B=null)}function Fj(r){r.g=new Hf(r,r.l,"rpc",r.ba),null===r.o&&(r.g.I=r.s),r.g.O=0;var e=w3(r.wa);x1(e,"RID","rpc"),x1(e,"SID",r.K),x1(e,"AID",r.V),x1(e,"CI",r.G?"0":"1"),!r.G&&r.qa&&x1(e,"TO",r.qa),x1(e,"TYPE","xmlhttp"),Zf(r,e),r.o&&r.s&&GT(e,r.o,r.s),r.L&&r.g.setTimeout(r.L);var t=r.g;r=r.pa,t.L=1,t.v=_m(w3(e)),t.s=null,t.S=!0,fj(t,r)}function Sm(r){null!=r.v&&(Yt.clearTimeout(r.v),r.v=null)}function $j(r,e){var t=null;if(r.g==e){Sm(r),qT(r),r.g=null;var n=2}else{if(!FT(r.i,e))return;t=e.F,Tj(r.i,e),n=1}if(0!=r.H)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=r.C;ei(n=um(),new oj(n,t)),Em(r)}else Vj(r);else if(3==(i=e.o)||0==i&&0<e.ca||!(1==n&&function KEe(r,e){return!(Pj(r.i)>=r.i.j-(r.m?1:0)||(r.m?(r.j=e.F.concat(r.j),0):1==r.H||2==r.H||r.C>=(r.cb?0:r.eb)||(r.m=zf(Ni(r.Na,r,e),Bj(r,r.C)),r.C++,0)))}(r,e)||2==n&&WT(r)))switch(t&&0<t.length&&(e=r.i,e.i=e.i.concat(t)),i){case 1:I6(r,5);break;case 4:I6(r,10);break;case 3:I6(r,6);break;default:I6(r,2)}}function Bj(r,e){let t=r.ab+Math.floor(Math.random()*r.hb);return r.isActive()||(t*=2),t*e}function I6(r,e){if(r.l.info("Error code "+e),2==e){var t=null;r.h&&(t=null);var n=Ni(r.pb,r);t||(t=new A6("//www.google.com/images/cleardot.gif"),Yt.location&&"http"==Yt.location.protocol||gm(t,"https"),_m(t)),function UEe(r,e){const t=new lm;if(Yt.Image){const n=new Image;n.onload=rm(vm,t,n,"TestLoadImage: loaded",!0,e),n.onerror=rm(vm,t,n,"TestLoadImage: error",!1,e),n.onabort=rm(vm,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=rm(vm,t,n,"TestLoadImage: timeout",!1,e),Yt.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=r}else e(!1)}(t.toString(),n)}else os(2);r.H=0,r.h&&r.h.za(e),Gj(r),zj(r)}function Gj(r){if(r.H=0,r.ma=[],r.h){const e=Oj(r.i);(0!=e.length||0!=r.j.length)&&(Hq(r.ma,e),Hq(r.ma,r.j),r.i.i.length=0,dT(r.j),r.j.length=0),r.h.ya()}}function Uj(r,e,t){var n=t instanceof A6?w3(t):new A6(t);if(""!=n.g)e&&(n.g=e+"."+n.g),mm(n,n.m);else{var i=Yt.location;n=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new A6(null);n&&gm(s,n),e&&(s.g=e),i&&mm(s,i),t&&(s.l=t),n=s}return e=r.Da,(t=r.F)&&e&&x1(n,t,e),x1(n,"VER",r.ra),Zf(r,n),n}function Wj(r,e,t){if(e&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new mr(t&&r.Ha&&!r.va?new Uf({ob:!0}):r.va)).Oa(r.J),e}function qj(){}function Pm(){if(j8&&!(10<=Number(lEe)))throw Error("Environmental error: no available transport.")}function io(r,e){b2.call(this),this.g=new Rj(e),this.l=r,this.h=e&&e.messageUrlParams||null,r=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.s=r,r=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(r?r["X-WebChannel-Content-Type"]=e.messageContentType:r={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(r?r["X-WebChannel-Client-Profile"]=e.Ca:r={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=r,(r=e&&e.cc)&&!Nf(r)&&(this.g.o=r),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Nf(e)&&(this.g.F=e,null!==(r=this.h)&&e in r&&e in(r=this.h)&&delete r[e]),this.j=new K8(this)}function jj(r){LT.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var e=r.__sm__;if(e){e:{for(const t in e){r=t;break e}r=void 0}(this.i=r)&&(r=this.i,e=null!==e&&r in e?e[r]:void 0),this.data=e}else this.data=r}function Zj(){RT.call(this),this.status=1}function K8(r){this.g=r}function Ca(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function jT(r,e,t){t||(t=0);var n=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)n[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)n[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;var s=r.g[3],o=(e=r.g[0])+(s^(t=r.g[1])&((i=r.g[2])^s))+n[0]+3614090360&4294967295;o=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=(t=(i=(s=(e=t+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^t&(i^s))+n[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(t^i))+n[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(t^s&(e^t))+n[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=t+(e^i&(s^e))+n[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(t^i))+n[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(t^i))+n[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(t^i&(e^t))+n[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^t&(s^e))+n[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=t+(s^e&(i^s))+n[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(t^i^s)+n[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(t^i^s)+n[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^t^i)+n[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^t)+n[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=t+(i^s^e)+n[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(t|~s))+n[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(t|~s))+n[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~t))+n[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=t+(s^(i|~e))+n[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=t+((o=e+(i^(t|~s))+n[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(t^(e|~i))+n[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~t))+n[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+n[9]+3951481745&4294967295,r.g[0]=r.g[0]+e&4294967295,r.g[1]=r.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,r.g[2]=r.g[2]+i&4294967295,r.g[3]=r.g[3]+s&4294967295}function o1(r,e){this.h=e;for(var t=[],n=!0,i=r.length-1;0<=i;i--){var s=0|r[i];n&&s==e||(t[i]=s,n=!1)}this.g=t}(Qe=mr.prototype).Oa=function(r){this.M=r},Qe.ha=function(r,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+r);e=e?e.toUpperCase():"GET",this.I=r,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():zT.g(),this.C=function cj(r){return r.h||(r.h=r.i())}(this.u?this.u:zT),this.g.onreadystatechange=Ni(this.La,this);try{this.G=!0,this.g.open(e,String(r),!0),this.G=!1}catch(s){return void Nj(this,s)}if(r=t||"",t=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)t.set(i,n[i]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const s of n.keys())t.set(s,n.get(s))}n=Array.from(t.keys()).find(s=>"content-type"==s.toLowerCase()),i=Yt.FormData&&r instanceof Yt.FormData,!(0<=Dq(jEe,e))||n||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{kj(this),0<this.B&&((this.L=function ZEe(r){return j8&&"number"==typeof r.timeout&&void 0!==r.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ni(this.ua,this)):this.A=kT(this.ua,this.B,this)),this.v=!0,this.g.send(r),this.v=!1}catch(s){Nj(this,s)}},Qe.ua=function(){typeof uT<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ei(this,"timeout"),this.abort(8))},Qe.abort=function(r){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=r||7,ei(this,"complete"),ei(this,"abort"),ym(this))},Qe.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ym(this,!0)),mr.$.N.call(this)},Qe.La=function(){this.s||(this.G||this.v||this.l?Ij(this):this.kb())},Qe.kb=function(){Ij(this)},Qe.isActive=function(){return!!this.g},Qe.da=function(){try{return 2<Ec(this)?this.g.status:-1}catch{return-1}},Qe.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},Qe.Wa=function(r){if(this.g){var e=this.g.responseText;return r&&0==e.indexOf(r)&&(e=e.substring(r.length)),WEe(e)}},Qe.Ia=function(){return this.m},Qe.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Qe=Rj.prototype).ra=8,Qe.H=1,Qe.Na=function(r){if(this.m)if(this.m=null,1==this.H){if(!r){this.W=Math.floor(1e5*Math.random()),r=this.W++;const i=new Hf(this,this.l,r);let s=this.s;if(this.U&&(s?(s=Gq(s),Wq(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){var n=this.j[t];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Hj(this,i,e),x1(t=w3(this.I),"RID",r),x1(t,"CVER",22),this.F&&x1(t,"X-HTTP-Session-Id",this.F),Zf(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(Lj(s)))+"&"+e:this.o&&GT(t,this.o,s)),$T(this.i,i),this.bb&&x1(t,"TYPE","init"),this.P?(x1(t,"$req",e),x1(t,"SID","null"),i.aa=!0,HT(i,t,null)):HT(i,t,e),this.H=2}}else 3==this.H&&(r?Dj(this,r):0==this.j.length||Sj(this.i)||Dj(this))},Qe.Ma=function(){if(this.u=null,Fj(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var r=2*this.S;this.l.info("BP detection timer enabled: "+r),this.B=zf(Ni(this.jb,this),r)}},Qe.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,os(10),Mm(this),Fj(this))},Qe.ib=function(){null!=this.v&&(this.v=null,Mm(this),WT(this),os(19))},Qe.pb=function(r){r?(this.l.info("Successfully pinged google.com"),os(2)):(this.l.info("Failed to ping google.com"),os(1))},Qe.isActive=function(){return!!this.h&&this.h.isActive(this)},(Qe=qj.prototype).Ba=function(){},Qe.Aa=function(){},Qe.za=function(){},Qe.ya=function(){},Qe.isActive=function(){return!0},Qe.Va=function(){},Pm.prototype.g=function(r,e){return new io(r,e)},O2(io,b2),io.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var r=this.g,e=this.l,t=this.h||void 0;os(0),r.Y=e,r.na=t||{},r.G=r.aa,r.I=Uj(r,null,r.Y),Em(r)},io.prototype.close=function(){UT(this.g)},io.prototype.u=function(r){var e=this.g;if("string"==typeof r){var t={};t.__data__=r,r=t}else this.v&&((t={}).__data__=NT(r),r=t);e.j.push(new class{constructor(r,e){this.g=r,this.map=e}}(e.fb++,r)),3==e.H&&Em(e)},io.prototype.N=function(){this.g.h=null,delete this.j,UT(this.g),delete this.g,io.$.N.call(this)},O2(jj,LT),O2(Zj,RT),O2(K8,qj),K8.prototype.Ba=function(){ei(this.g,"a")},K8.prototype.Aa=function(r){ei(this.g,new jj(r))},K8.prototype.za=function(r){ei(this.g,new Zj)},K8.prototype.ya=function(){ei(this.g,"b")},O2(Ca,function XEe(){this.blockSize=-1}),Ca.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ca.prototype.j=function(r,e){void 0===e&&(e=r.length);for(var t=e-this.blockSize,n=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=t;)jT(this,r,s),s+=this.blockSize;if("string"==typeof r){for(;s<e;)if(n[i++]=r.charCodeAt(s++),i==this.blockSize){jT(this,n),i=0;break}}else for(;s<e;)if(n[i++]=r[s++],i==this.blockSize){jT(this,n),i=0;break}}this.h=i,this.i+=e},Ca.prototype.l=function(){var r=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);r[0]=128;for(var e=1;e<r.length-8;++e)r[e]=0;var t=8*this.i;for(e=r.length-8;e<r.length;++e)r[e]=255&t,t/=256;for(this.j(r),r=Array(16),e=t=0;4>e;++e)for(var n=0;32>n;n+=8)r[t++]=this.g[e]>>>n&255;return r};var QEe={};function ZT(r){return-128<=r&&128>r?function oEe(r,e){var t=QEe;return Object.prototype.hasOwnProperty.call(t,r)?t[r]:t[r]=e(r)}(r,function(e){return new o1([0|e],0>e?-1:0)}):new o1([0|r],0>r?-1:0)}function Sc(r){if(isNaN(r)||!isFinite(r))return X8;if(0>r)return ti(Sc(-r));for(var e=[],t=1,n=0;r>=t;n++)e[n]=r/t|0,t*=YT;return new o1(e,0)}var YT=4294967296,X8=ZT(0),KT=ZT(1),Kj=ZT(16777216);function N3(r){if(0!=r.h)return!1;for(var e=0;e<r.g.length;e++)if(0!=r.g[e])return!1;return!0}function Lo(r){return-1==r.h}function ti(r){for(var e=r.g.length,t=[],n=0;n<e;n++)t[n]=~r.g[n];return new o1(t,~r.h).add(KT)}function Tm(r,e){return r.add(ti(e))}function Om(r,e){for(;(65535&r[e])!=r[e];)r[e+1]+=r[e]>>>16,r[e]&=65535,e++}function Yf(r,e){this.g=r,this.h=e}function bm(r,e){if(N3(e))throw Error("division by zero");if(N3(r))return new Yf(X8,X8);if(Lo(r))return e=bm(ti(r),e),new Yf(ti(e.g),ti(e.h));if(Lo(e))return e=bm(r,ti(e)),new Yf(ti(e.g),e.h);if(30<r.g.length){if(Lo(r)||Lo(e))throw Error("slowDivide_ only works with positive integers.");for(var t=KT,n=e;0>=n.X(r);)t=Xj(t),n=Xj(n);var i=Q8(t,1),s=Q8(n,1);for(n=Q8(n,2),t=Q8(t,2);!N3(n);){var o=s.add(n);0>=o.X(r)&&(i=i.add(t),s=o),n=Q8(n,1),t=Q8(t,1)}return e=Tm(r,i.R(e)),new Yf(i,e)}for(i=X8;0<=r.X(e);){for(t=Math.max(1,Math.floor(r.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(t)/Math.LN2))?1:Math.pow(2,n-48),o=(s=Sc(t)).R(e);Lo(o)||0<o.X(r);)o=(s=Sc(t-=n)).R(e);N3(s)&&(s=KT),i=i.add(s),r=Tm(r,o)}return new Yf(i,r)}function Xj(r){for(var e=r.g.length+1,t=[],n=0;n<e;n++)t[n]=r.D(n)<<1|r.D(n-1)>>>31;return new o1(t,r.h)}function Q8(r,e){var t=e>>5;e%=32;for(var n=r.g.length-t,i=[],s=0;s<n;s++)i[s]=0<e?r.D(s+t)>>>e|r.D(s+t+1)<<32-e:r.D(s+t);return new o1(i,r.h)}(Qe=o1.prototype).ea=function(){if(Lo(this))return-ti(this).ea();for(var r=0,e=1,t=0;t<this.g.length;t++){var n=this.D(t);r+=(0<=n?n:YT+n)*e,e*=YT}return r},Qe.toString=function(r){if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if(N3(this))return"0";if(Lo(this))return"-"+ti(this).toString(r);for(var e=Sc(Math.pow(r,6)),t=this,n="";;){var i=bm(t,e).g,s=((0<(t=Tm(t,i.R(e))).g.length?t.g[0]:t.h)>>>0).toString(r);if(N3(t=i))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},Qe.D=function(r){return 0>r?0:r<this.g.length?this.g[r]:this.h},Qe.X=function(r){return Lo(r=Tm(this,r))?-1:N3(r)?0:1},Qe.abs=function(){return Lo(this)?ti(this):this},Qe.add=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0,i=0;i<=e;i++){var s=n+(65535&this.D(i))+(65535&r.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(r.D(i)>>>16);n=o>>>16,t[i]=(o&=65535)<<16|(s&=65535)}return new o1(t,-2147483648&t[t.length-1]?-1:0)},Qe.R=function(r){if(N3(this)||N3(r))return X8;if(Lo(this))return Lo(r)?ti(this).R(ti(r)):ti(ti(this).R(r));if(Lo(r))return ti(this.R(ti(r)));if(0>this.X(Kj)&&0>r.X(Kj))return Sc(this.ea()*r.ea());for(var e=this.g.length+r.g.length,t=[],n=0;n<2*e;n++)t[n]=0;for(n=0;n<this.g.length;n++)for(var i=0;i<r.g.length;i++){var s=this.D(n)>>>16,o=65535&this.D(n),a=r.D(i)>>>16,c=65535&r.D(i);t[2*n+2*i]+=o*c,Om(t,2*n+2*i),t[2*n+2*i+1]+=s*c,Om(t,2*n+2*i+1),t[2*n+2*i+1]+=o*a,Om(t,2*n+2*i+1),t[2*n+2*i+2]+=s*a,Om(t,2*n+2*i+2)}for(n=0;n<e;n++)t[n]=t[2*n+1]<<16|t[2*n];for(n=e;n<2*e;n++)t[n]=0;return new o1(t,0)},Qe.gb=function(r){return bm(this,r).h},Qe.and=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)&r.D(n);return new o1(t,this.h&r.h)},Qe.or=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)|r.D(n);return new o1(t,this.h|r.h)},Qe.xor=function(r){for(var e=Math.max(this.g.length,r.g.length),t=[],n=0;n<e;n++)t[n]=this.D(n)^r.D(n);return new o1(t,this.h^r.h)},Pm.prototype.createWebChannel=Pm.prototype.g,io.prototype.send=io.prototype.u,io.prototype.open=io.prototype.m,io.prototype.close=io.prototype.close,fm.NO_ERROR=0,fm.TIMEOUT=8,fm.HTTP_ERROR=6,aj.COMPLETE="complete",lj.EventType=Df,Df.OPEN="a",Df.CLOSE="b",Df.ERROR="c",Df.MESSAGE="d",b2.prototype.listen=b2.prototype.O,mr.prototype.listenOnce=mr.prototype.P,mr.prototype.getLastError=mr.prototype.Sa,mr.prototype.getLastErrorCode=mr.prototype.Ia,mr.prototype.getStatus=mr.prototype.da,mr.prototype.getResponseJson=mr.prototype.Wa,mr.prototype.getResponseText=mr.prototype.ja,mr.prototype.send=mr.prototype.ha,mr.prototype.setWithCredentials=mr.prototype.Oa,Ca.prototype.digest=Ca.prototype.l,Ca.prototype.reset=Ca.prototype.reset,Ca.prototype.update=Ca.prototype.j,o1.prototype.add=o1.prototype.add,o1.prototype.multiply=o1.prototype.R,o1.prototype.modulo=o1.prototype.gb,o1.prototype.compare=o1.prototype.X,o1.prototype.toNumber=o1.prototype.ea,o1.prototype.toString=o1.prototype.toString,o1.prototype.getBits=o1.prototype.D,o1.fromNumber=Sc,o1.fromString=function Yj(r,e){if(0==r.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==r.charAt(0))return ti(Yj(r.substring(1),e));if(0<=r.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=Sc(Math.pow(e,8)),n=X8,i=0;i<r.length;i+=8){var s=Math.min(8,r.length-i),o=parseInt(r.substring(i,i+s),e);8>s?(s=Sc(Math.pow(e,s)),n=n.R(s).add(Sc(o))):n=(n=n.R(t)).add(Sc(o))}return n};var JEe=va.createWebChannelTransport=function(){return new Pm},eSe=va.getStatEventTarget=function(){return um()},XT=va.ErrorCode=fm,tSe=va.EventType=aj,nSe=va.Event=w6,Qj=va.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},rSe=va.FetchXmlHttpFactory=Uf,wm=va.WebChannel=lj,iSe=va.XhrIo=mr,sSe=va.Md5=Ca,J8=va.Integer=o1;const Jj="@firebase/firestore";class w2{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}w2.UNAUTHENTICATED=new w2(null),w2.GOOGLE_CREDENTIALS=new w2("google-credentials-uid"),w2.FIRST_PARTY=new w2("first-party-uid"),w2.MOCK_USER=new w2("mock-user");let e5="9.23.0";const B4=new W8("@firebase/firestore");function QT(){return B4.logLevel}function Oe(r,...e){if(B4.logLevel<=Gn.DEBUG){const t=e.map(JT);B4.debug(`Firestore (${e5}): ${r}`,...t)}}function xr(r,...e){if(B4.logLevel<=Gn.ERROR){const t=e.map(JT);B4.error(`Firestore (${e5}): ${r}`,...t)}}function ya(r,...e){if(B4.logLevel<=Gn.WARN){const t=e.map(JT);B4.warn(`Firestore (${e5}): ${r}`,...t)}}function JT(r){if("string"==typeof r)return r;try{return JSON.stringify(r)}catch{return r}}function at(r="Unexpected state"){const e=`FIRESTORE (${e5}) INTERNAL ASSERTION FAILED: `+r;throw xr(e),new Error(e)}function mt(r,e){r||at()}function je(r,e){return r}const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends xo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class o2{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class eZ{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oSe{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(w2.UNAUTHENTICATED))}shutdown(){}}class aSe{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class cSe{constructor(e){this.t=e,this.currentUser=w2.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let i=this.i;const s=l=>this.i!==i?(i=this.i,t(l)):Promise.resolve();let o=new o2;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new o2,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=o;e.enqueueRetryable(P(function*(){yield l.promise,yield s(n.currentUser)}))},c=l=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new o2)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mt("string"==typeof n.accessToken),new eZ(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return mt(null===e||"string"==typeof e),new w2(e)}}class lSe{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=w2.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class uSe{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new lSe(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(w2.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tZ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fSe{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=s=>{null!=s.error&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.T;return this.T=s.token,Oe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.I.getImmediate({optional:!0});s?i(s):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(mt("string"==typeof t.token),this.T=t.token,new tZ(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function dSe(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}class nZ{static A(){const t=62*Math.floor(256/62);let n="";for(;n.length<20;){const i=dSe(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return n}}function Ut(r,e){return r<e?-1:r>e?1:0}function t5(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}class rr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rr.fromMillis(Date.now())}static fromDate(e){return rr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new rr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ut(this.nanoseconds,e.nanoseconds):Ut(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ct{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ct(e)}static min(){return new Ct(new rr(0,0))}static max(){return new Ct(new rr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Kf{constructor(e,t,n){void 0===t?t=0:t>e.length&&at(),void 0===n?n=e.length-t:n>e.length-t&&at(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Kf.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Kf?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class zn extends Kf{construct(e,t,n){return new zn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Te(fe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new zn(t)}static emptyPath(){return new zn([])}}const hSe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Lr extends Kf{construct(e,t,n){return new Lr(e,t,n)}static isValidIdentifier(e){return hSe.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Lr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Lr(["__name__"])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(0===n.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new Te(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if("\\"!==c&&"."!==c&&"`"!==c)throw new Te(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(n+=a,i++):(s(),i++)}if(s(),o)throw new Te(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Lr(t)}static emptyPath(){return new Lr([])}}class Ue{constructor(e){this.path=e}static fromPath(e){return new Ue(zn.fromString(e))}static fromName(e){return new Ue(zn.fromString(e).popFirst(5))}static empty(){return new Ue(zn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===zn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return zn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ue(new zn(e.slice()))}}function sZ(r){return new so(r.readTime,r.key,-1)}class so{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new so(Ct.min(),Ue.empty(),-1)}static max(){return new so(Ct.max(),Ue.empty(),-1)}}function tO(r,e){let t=r.readTime.compareTo(e.readTime);return 0!==t?t:(t=Ue.comparator(r.documentKey,e.documentKey),0!==t?t:Ut(r.largestBatchId,e.largestBatchId))}const oZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mSe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function G4(r){return nO.apply(this,arguments)}function nO(){return nO=P(function*(r){if(r.code!==fe.FAILED_PRECONDITION||r.message!==oZ)throw r;Oe("LocalStore","Unexpectedly lost primary lease")}),nO.apply(this,arguments)}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&at(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ce.reject(t)}static resolve(e){return new ce((t,n)=>{t(e)})}static reject(e){return new ce((t,n)=>{n(e)})}static waitFor(e){return new ce((t,n)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>n(c))}),o=!0,s===i&&t()})}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next(i=>i?ce.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ce((n,i)=>{const s=e.length,o=new Array(s);let a=0;for(let c=0;c<s;c++){const l=c;t(e[l]).next(f=>{o[l]=f,++a,a===s&&n(o)},f=>i(f))}})}static doWhile(e,t){return new ce((n,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):n()};s()})}}function U4(r){return"IndexedDbTransactionError"===r.name}let oo=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ot(i),this.ut=i=>n.writeSequenceNumber(i))}ot(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ut&&this.ut(t),t}}return r.ct=-1,r})();function Jf(r){return null==r}function e9(r){return 0===r&&1/r==-1/0}function gZ(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function W4(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function mZ(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}class N1{constructor(e,t){this.comparator=e,this.root=t||ni.EMPTY}insert(e,t){return new N1(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ni.BLACK,null,null))}remove(e){return new N1(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ni.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(0===i)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xm(this.root,e,this.comparator,!1)}getReverseIterator(){return new xm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xm(this.root,e,this.comparator,!0)}}class xm{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ni{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??ni.RED,this.left=i??ni.EMPTY,this.right=s??ni.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new ni(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ni.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return ni.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ni.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ni.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw at();const e=this.left.check();if(e!==this.right.check())throw at();return e+(this.isRed()?0:1)}}ni.EMPTY=null,ni.RED=!0,ni.BLACK=!1,ni.EMPTY=new class{constructor(){this.size=0}get key(){throw at()}get value(){throw at()}get color(){throw at()}get left(){throw at()}get right(){throw at()}copy(r,e,t,n,i){return this}insert(r,e,t){return new ni(r,e)}remove(r,e){return this}isEmpty(){return!0}inorderTraversal(r){return!1}reverseTraversal(r){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class L1{constructor(e){this.comparator=e,this.data=new N1(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _Z(this.data.getIterator())}getIteratorFrom(e){return new _Z(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof L1)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new L1(this.comparator);return t.data=e,t}}class _Z{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ks{constructor(e){this.fields=e,e.sort(Lr.comparator)}static empty(){return new ks([])}unionWith(e){let t=new L1(Lr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ks(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return t5(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class vZ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class a2{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(n){try{return atob(n)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new vZ("Invalid base64 string: "+i):i}}(e);return new a2(t)}static fromUint8Array(e){const t=function(n){let i="";for(let s=0;s<n.length;++s)i+=String.fromCharCode(n[s]);return i}(e);return new a2(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ut(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}a2.EMPTY_BYTE_STRING=new a2("");const VSe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function q4(r){if(mt(!!r),"string"==typeof r){let e=0;const t=VSe.exec(r);if(mt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:_r(r.seconds),nanos:_r(r.nanos)}}function _r(r){return"number"==typeof r?r:"string"==typeof r?Number(r):0}function A3(r){return"string"==typeof r?a2.fromBase64String(r):a2.fromUint8Array(r)}function Lm(r){var e,t;return"server_timestamp"===(null===(t=((null===(e=r?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Rm(r){const e=r.mapValue.fields.__previous_value__;return Lm(e)?Rm(e):e}function t9(r){const e=q4(r.mapValue.fields.__local_write_time__.timestampValue);return new rr(e.seconds,e.nanos)}class FSe{constructor(e,t,n,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}}class L6{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new L6("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof L6&&e.projectId===this.projectId&&e.database===this.database}}const j4={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Z4(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Lm(r)?4:EZ(r)?9007199254740991:10:at()}function Tc(r,e){if(r===e)return!0;const t=Z4(r);if(t!==Z4(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return t9(r).isEqual(t9(e));case 3:return function(n,i){if("string"==typeof n.timestampValue&&"string"==typeof i.timestampValue&&n.timestampValue.length===i.timestampValue.length)return n.timestampValue===i.timestampValue;const s=q4(n.timestampValue),o=q4(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return i=e,A3(r.bytesValue).isEqual(A3(i.bytesValue));case 7:return r.referenceValue===e.referenceValue;case 8:return function(n,i){return _r(n.geoPointValue.latitude)===_r(i.geoPointValue.latitude)&&_r(n.geoPointValue.longitude)===_r(i.geoPointValue.longitude)}(r,e);case 2:return function(n,i){if("integerValue"in n&&"integerValue"in i)return _r(n.integerValue)===_r(i.integerValue);if("doubleValue"in n&&"doubleValue"in i){const s=_r(n.doubleValue),o=_r(i.doubleValue);return s===o?e9(s)===e9(o):isNaN(s)&&isNaN(o)}return!1}(r,e);case 9:return t5(r.arrayValue.values||[],e.arrayValue.values||[],Tc);case 10:return function(n,i){const s=n.mapValue.fields||{},o=i.mapValue.fields||{};if(gZ(s)!==gZ(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(void 0===o[a]||!Tc(s[a],o[a])))return!1;return!0}(r,e);default:return at()}var i}function n9(r,e){return void 0!==(r.values||[]).find(t=>Tc(t,e))}function Y4(r,e){if(r===e)return 0;const t=Z4(r),n=Z4(e);if(t!==n)return Ut(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ut(r.booleanValue,e.booleanValue);case 2:return function(i,s){const o=_r(i.integerValue||i.doubleValue),a=_r(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(r,e);case 3:return CZ(r.timestampValue,e.timestampValue);case 4:return CZ(t9(r),t9(e));case 5:return Ut(r.stringValue,e.stringValue);case 6:return function(i,s){const o=A3(i),a=A3(s);return o.compareTo(a)}(r.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=Ut(o[c],a[c]);if(0!==l)return l}return Ut(o.length,a.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,s){const o=Ut(_r(i.latitude),_r(s.latitude));return 0!==o?o:Ut(_r(i.longitude),_r(s.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=Y4(o[c],a[c]);if(l)return l}return Ut(o.length,a.length)}(r.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===j4.mapValue&&s===j4.mapValue)return 0;if(i===j4.mapValue)return 1;if(s===j4.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),c=s.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let f=0;f<a.length&&f<l.length;++f){const d=Ut(a[f],l[f]);if(0!==d)return d;const m=Y4(o[a[f]],c[l[f]]);if(0!==m)return m}return Ut(a.length,l.length)}(r.mapValue,e.mapValue);default:throw at()}}function CZ(r,e){if("string"==typeof r&&"string"==typeof e&&r.length===e.length)return Ut(r,e);const t=q4(r),n=q4(e),i=Ut(t.seconds,n.seconds);return 0!==i?i:Ut(t.nanos,n.nanos)}function r5(r){return sO(r)}function sO(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(n){const i=q4(n);return`time(${i.seconds},${i.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?A3(r.bytesValue).toBase64():"referenceValue"in r?Ue.fromName(r.referenceValue).toString():"geoPointValue"in r?`geo(${(e=r.geoPointValue).latitude},${e.longitude})`:"arrayValue"in r?function(n){let i="[",s=!0;for(const o of n.values||[])s?s=!1:i+=",",i+=sO(o);return i+"]"}(r.arrayValue):"mapValue"in r?function(n){const i=Object.keys(n.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${sO(n.fields[a])}`;return s+"}"}(r.mapValue):at();var e}function R6(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function oO(r){return!!r&&"integerValue"in r}function r9(r){return!!r&&"arrayValue"in r}function yZ(r){return!!r&&"nullValue"in r}function MZ(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Hm(r){return!!r&&"mapValue"in r}function i9(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&"object"==typeof r.timestampValue)return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return W4(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=i9(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=i9(r.arrayValue.values[t]);return e}return Object.assign({},r)}function EZ(r){return"__max__"===(((r.mapValue||{}).fields||{}).__type__||{}).stringValue}class ri{constructor(e){this.value=e}static empty(){return new ri({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Hm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=i9(t)}setAll(e){let t=Lr.emptyPath(),n={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=a.popLast()}o?n[a.lastSegment()]=i9(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());Hm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Hm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){W4(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new ri(i9(this.value))}}function TZ(r){const e=[];return W4(r.fields,(t,n)=>{const i=new Lr([t]);if(Hm(n)){const s=TZ(n.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new ks(e)}class R1{constructor(e,t,n,i,s,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new R1(e,0,Ct.min(),Ct.min(),Ct.min(),ri.empty(),0)}static newFoundDocument(e,t,n,i){return new R1(e,1,t,Ct.min(),n,i,0)}static newNoDocument(e,t){return new R1(e,2,t,Ct.min(),Ct.min(),ri.empty(),0)}static newUnknownDocument(e,t){return new R1(e,3,t,Ct.min(),Ct.min(),ri.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ct.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ri.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ri.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof R1&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new R1(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class K4{constructor(e,t){this.position=e,this.inclusive=t}}function OZ(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(n=s.field.isKeyField()?Ue.comparator(Ue.fromName(o.referenceValue),t.key):Y4(o,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function bZ(r,e){if(null===r)return null===e;if(null===e||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Tc(r.position[t],e.position[t]))return!1;return!0}class i5{constructor(e,t="asc"){this.field=e,this.dir=t}}function GSe(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}class wZ{}class Sn extends wZ{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new USe(e,t,n):"array-contains"===t?new jSe(e,n):"in"===t?new LZ(e,n):"not-in"===t?new ZSe(e,n):"array-contains-any"===t?new YSe(e,n):new Sn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new WSe(e,n):new qSe(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Y4(t,this.value)):null!==t&&Z4(this.value)===Z4(t)&&this.matchesComparison(Y4(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return at()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class a1 extends wZ{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new a1(e,t)}matches(e){return s5(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(t=>t.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function s5(r){return"and"===r.op}function cO(r){return function NZ(r){for(const e of r.filters)if(e instanceof a1)return!1;return!0}(r)&&s5(r)}function lO(r){if(r instanceof Sn)return r.field.canonicalString()+r.op.toString()+r5(r.value);if(cO(r))return r.filters.map(e=>lO(e)).join(",");{const e=r.filters.map(t=>lO(t)).join(",");return`${r.op}(${e})`}}function AZ(r,e){return r instanceof Sn?(t=r,(n=e)instanceof Sn&&t.op===n.op&&t.field.isEqual(n.field)&&Tc(t.value,n.value)):r instanceof a1?function(t,n){return n instanceof a1&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((i,s,o)=>i&&AZ(s,n.filters[o]),!0)}(r,e):void at();var t,n}function kZ(r){return r instanceof Sn?`${(e=r).field.canonicalString()} ${e.op} ${r5(e.value)}`:r instanceof a1?function(e){return e.op.toString()+" {"+e.getFilters().map(kZ).join(" ,")+"}"}(r):"Filter";var e}class USe extends Sn{constructor(e,t,n){super(e,t,n),this.key=Ue.fromName(n.referenceValue)}matches(e){const t=Ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class WSe extends Sn{constructor(e,t){super(e,"in",t),this.keys=xZ(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class qSe extends Sn{constructor(e,t){super(e,"not-in",t),this.keys=xZ(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function xZ(r,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Ue.fromName(n.referenceValue))}class jSe extends Sn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return r9(t)&&n9(t.arrayValue,this.value)}}class LZ extends Sn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&n9(this.value.arrayValue,t)}}class ZSe extends Sn{constructor(e,t){super(e,"not-in",t)}matches(e){if(n9(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!n9(this.value.arrayValue,t)}}class YSe extends Sn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!r9(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>n9(this.value.arrayValue,n))}}class KSe{constructor(e,t=null,n=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}}function uO(r,e=null,t=[],n=[],i=null,s=null,o=null){return new KSe(r,e,t,n,i,s,o)}function z6(r){const e=je(r);if(null===e.dt){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>lO(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(i=n).field.canonicalString()+i.dir;var i}).join(","),Jf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>r5(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>r5(n)).join(",")),e.dt=t}return e.dt}function s9(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!GSe(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!AZ(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!bZ(r.startAt,e.startAt)&&bZ(r.endAt,e.endAt)}function Vm(r){return Ue.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length}class I3{constructor(e,t=null,n=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this._t=null}}function o5(r){return new I3(r)}function HZ(r){return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())}function fO(r){return r.explicitOrderBy.length>0?r.explicitOrderBy[0].field:null}function $m(r){for(const e of r.filters){const t=e.getFirstInequalityField();if(null!==t)return t}return null}function dO(r){return null!==r.collectionGroup}function D6(r){const e=je(r);if(null===e.wt){e.wt=[];const t=$m(e),n=fO(e);if(null!==t&&null===n)t.isKeyField()||e.wt.push(new i5(t)),e.wt.push(new i5(Lr.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new i5(Lr.keyField(),s))}}}return e.wt}function as(r){const e=je(r);if(!e._t)if("F"===e.limitType)e._t=uO(e.path,e.collectionGroup,D6(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of D6(e))t.push(new i5(s.field,"desc"===s.dir?"asc":"desc"));const n=e.endAt?new K4(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new K4(e.startAt.position,e.startAt.inclusive):null;e._t=uO(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e._t}function hO(r,e){e.getFirstInequalityField(),$m(r);const t=r.filters.concat([e]);return new I3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Bm(r,e,t){return new I3(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function o9(r,e){return s9(as(r),as(e))&&r.limitType===e.limitType}function VZ(r){return`${z6(as(r))}|lt:${r.limitType}`}function pO(r){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(n=>kZ(n)).join(", ")}]`),Jf(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(n=>{return`${(i=n).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>r5(n)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>r5(n)).join(",")),`Target(${t})`}(as(r))}; limitType=${r.limitType})`}function a9(r,e){return e.isFoundDocument()&&function(t,n){const i=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):Ue.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(r,e)&&function(t,n){for(const i of D6(t))if(!i.field.isKeyField()&&null===n.data.field(i.field))return!1;return!0}(r,e)&&function(t,n){for(const i of t.filters)if(!i.matches(n))return!1;return!0}(r,e)&&(n=e,!((t=r).startAt&&!function(i,s,o){const a=OZ(i,s,o);return i.inclusive?a<=0:a<0}(t.startAt,D6(t),n)||t.endAt&&!function(i,s,o){const a=OZ(i,s,o);return i.inclusive?a>=0:a>0}(t.endAt,D6(t),n)));var t,n}function $Z(r){return(e,t)=>{let n=!1;for(const i of D6(r)){const s=XSe(i,e,t);if(0!==s)return s;n=n||i.field.isKeyField()}return 0}}function XSe(r,e,t){const n=r.field.isKeyField()?Ue.comparator(e.key,t.key):function(i,s,o){const a=s.data.field(i),c=o.data.field(i);return null!==a&&null!==c?Y4(a,c):at()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return at()}}class k3{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[i,s]of n)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(void 0===i)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return 1===n.length?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){W4(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return mZ(this.inner)}size(){return this.innerSize}}const QSe=new N1(Ue.comparator);function xs(){return QSe}const BZ=new N1(Ue.comparator);function c9(...r){let e=BZ;for(const t of r)e=e.insert(t.key,t);return e}function GZ(r){let e=BZ;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Oc(){return l9()}function UZ(){return l9()}function l9(){return new k3(r=>r.toString(),(r,e)=>r.isEqual(e))}const JSe=new N1(Ue.comparator),ePe=new L1(Ue.comparator);function rn(...r){let e=ePe;for(const t of r)e=e.add(t);return e}const tPe=new L1(Ut);function WZ(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e9(e)?"-0":e}}function qZ(r){return{integerValue:""+r}}function jZ(r,e){return function cZ(r){return"number"==typeof r&&Number.isInteger(r)&&!e9(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}(e)?qZ(e):WZ(r,e)}class Gm{constructor(){this._=void 0}}function nPe(r,e,t){return r instanceof a5?function(n,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return i&&Lm(i)&&(i=Rm(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):r instanceof H6?YZ(r,e):r instanceof V6?KZ(r,e):function(n,i){const s=ZZ(n,i),o=XZ(s)+XZ(n.gt);return oO(s)&&oO(n.gt)?qZ(o):WZ(n.serializer,o)}(r,e)}function rPe(r,e,t){return r instanceof H6?YZ(r,e):r instanceof V6?KZ(r,e):t}function ZZ(r,e){return r instanceof c5?oO(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class a5 extends Gm{}class H6 extends Gm{constructor(e){super(),this.elements=e}}function YZ(r,e){const t=QZ(e);for(const n of r.elements)t.some(i=>Tc(i,n))||t.push(n);return{arrayValue:{values:t}}}class V6 extends Gm{constructor(e){super(),this.elements=e}}function KZ(r,e){let t=QZ(e);for(const n of r.elements)t=t.filter(i=>!Tc(i,n));return{arrayValue:{values:t}}}class c5 extends Gm{constructor(e,t){super(),this.serializer=e,this.gt=t}}function XZ(r){return _r(r.integerValue||r.doubleValue)}function QZ(r){return r9(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}class u9{constructor(e,t){this.field=e,this.transform=t}}class sPe{constructor(e,t){this.version=e,this.transformResults=t}}class Z1{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Z1}static exists(e){return new Z1(void 0,e)}static updateTime(e){return new Z1(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Um(r,e){return void 0!==r.updateTime?e.isFoundDocument()&&e.version.isEqual(r.updateTime):void 0===r.exists||r.exists===e.isFoundDocument()}class Wm{}function JZ(r,e){if(!r.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return r.isNoDocument()?new u5(r.key,Z1.none()):new l5(r.key,r.data,Z1.none());{const t=r.data,n=ri.empty();let i=new L1(Lr.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?n.delete(s):n.set(s,o),i=i.add(s)}return new x3(r.key,n,new ks(i.toArray()),Z1.none())}}function oPe(r,e,t){r instanceof l5?function(n,i,s){const o=n.value.clone(),a=nY(n.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(r,e,t):r instanceof x3?function(n,i,s){if(!Um(n.precondition,i))return void i.convertToUnknownDocument(s.version);const o=nY(n.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(tY(n)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(r,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function f9(r,e,t,n){return r instanceof l5?function(i,s,o,a){if(!Um(i.precondition,s))return o;const c=i.value.clone(),l=rY(i.fieldTransforms,a,s);return c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof x3?function(i,s,o,a){if(!Um(i.precondition,s))return o;const c=rY(i.fieldTransforms,a,s),l=s.data;return l.setAll(tY(i)),l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null===o?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(r,e,t,n):(o=t,Um(r.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o);var s,o}function aPe(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=ZZ(n.transform,i||null);null!=s&&(null===t&&(t=ri.empty()),t.set(n.field,s))}return t||null}function eY(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=r.fieldTransforms)&&void 0===n||t&&n&&t5(t,n,(i,s)=>function iPe(r,e){return r.field.isEqual(e.field)&&(n=e.transform,(t=r.transform)instanceof H6&&n instanceof H6||t instanceof V6&&n instanceof V6?t5(t.elements,n.elements,Tc):t instanceof c5&&n instanceof c5?Tc(t.gt,n.gt):t instanceof a5&&n instanceof a5);var t,n}(i,s))))&&(0===r.type?r.value.isEqual(e.value):1!==r.type||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask));var t,n}class l5 extends Wm{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class x3 extends Wm{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function tY(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function nY(r,e,t){const n=new Map;mt(r.length===t.length);for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,a=e.data.field(s.field);n.set(s.field,rPe(o,a,t[i]))}return n}function rY(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,nPe(s,o,e))}return n}class u5 extends Wm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mO extends Wm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class _O{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&oPe(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=f9(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=f9(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=UZ();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const c=JZ(o,a);null!==c&&n.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ct.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),rn())}isEqual(e){return this.batchId===e.batchId&&t5(this.mutations,e.mutations,(t,n)=>eY(t,n))&&t5(this.baseMutations,e.baseMutations,(t,n)=>eY(t,n))}}class vO{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){mt(e.mutations.length===n.length);let i=JSe;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new vO(e,t,n,i)}}class CO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class lPe{constructor(e,t){this.count=e,this.unchangedNames=t}}var Zr,Dn;function sY(r){if(void 0===r)return xr("GRPC error has no .code"),fe.UNKNOWN;switch(r){case Zr.OK:return fe.OK;case Zr.CANCELLED:return fe.CANCELLED;case Zr.UNKNOWN:return fe.UNKNOWN;case Zr.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case Zr.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case Zr.INTERNAL:return fe.INTERNAL;case Zr.UNAVAILABLE:return fe.UNAVAILABLE;case Zr.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case Zr.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case Zr.NOT_FOUND:return fe.NOT_FOUND;case Zr.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case Zr.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case Zr.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case Zr.ABORTED:return fe.ABORTED;case Zr.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case Zr.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case Zr.DATA_LOSS:return fe.DATA_LOSS;default:return at()}}(Dn=Zr||(Zr={}))[Dn.OK=0]="OK",Dn[Dn.CANCELLED=1]="CANCELLED",Dn[Dn.UNKNOWN=2]="UNKNOWN",Dn[Dn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Dn[Dn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Dn[Dn.NOT_FOUND=5]="NOT_FOUND",Dn[Dn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Dn[Dn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Dn[Dn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Dn[Dn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Dn[Dn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Dn[Dn.ABORTED=10]="ABORTED",Dn[Dn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Dn[Dn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Dn[Dn.INTERNAL=13]="INTERNAL",Dn[Dn.UNAVAILABLE=14]="UNAVAILABLE",Dn[Dn.DATA_LOSS=15]="DATA_LOSS";class yO{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return qm}static getOrCreateInstance(){return null===qm&&(qm=new yO),qm}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let qm=null;const uPe=new J8([4294967295,4294967295],0);function aY(r){const e=function oY(){return new TextEncoder}().encode(r),t=new sSe;return t.update(e),new Uint8Array(t.digest())}function cY(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new J8([t,n],0),new J8([i,s],0)]}class MO{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new d9(`Invalid padding: ${t}`);if(n<0)throw new d9(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new d9(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new d9(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=J8.fromNumber(this.It)}Et(e,t,n){let i=e.add(t.multiply(J8.fromNumber(n)));return 1===i.compare(uPe)&&(i=new J8([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=aY(e),[n,i]=cY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);if(!this.At(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new MO(s,i,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(0===this.It)return;const t=aY(e),[n,i]=cY(t);for(let s=0;s<this.hashCount;s++){const o=this.Et(n,i,s);this.Rt(o)}}Rt(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class d9 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class h9{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,p9.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new h9(Ct.min(),i,new N1(Ut),xs(),rn())}}class p9{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new p9(n,t,rn(),rn(),rn())}}class jm{constructor(e,t,n,i){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=i}}class lY{constructor(e,t){this.targetId=e,this.Vt=t}}class uY{constructor(e,t,n=a2.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class fY{constructor(){this.St=0,this.Dt=hY(),this.Ct=a2.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=rn(),t=rn(),n=rn();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:at()}}),new p9(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=hY()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class fPe{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=xs(),this.zt=dY(),this.Wt=new N1(Ut)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:at()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((n,i)=>{this.te(i)&&t(i)})}ne(e){var t;const n=e.targetId,i=e.Vt.count,s=this.se(n);if(s){const o=s.target;if(Vm(o))if(0===i){const a=new Ue(o.path);this.Yt(n,a,R1.newNoDocument(a,Ct.min()))}else mt(1===i);else{const a=this.ie(n);if(a!==i){const c=this.re(e,a);0!==c&&(this.ee(n),this.Wt=this.Wt.insert(n,2===c?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=yO.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(l,f,d){var m,M,w,L,z,$;const B={localCacheCount:f,existenceFilterCount:d.count},de=d.unchangedNames;return de&&(B.bloomFilter={applied:0===l,hashCount:null!==(m=de?.hashCount)&&void 0!==m?m:0,bitmapLength:null!==(L=null===(w=null===(M=de?.bits)||void 0===M?void 0:M.bitmap)||void 0===w?void 0:w.length)&&void 0!==L?L:0,padding:null!==($=null===(z=de?.bits)||void 0===z?void 0:z.padding)&&void 0!==$?$:0}),B}(c,a,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:i}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=n;let c,l;try{c=A3(s).toUint8Array()}catch(f){if(f instanceof vZ)return ya("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw f}try{l=new MO(c,o,a)}catch(f){return ya(f instanceof d9?"BloomFilter error: ":"Applying bloom filter failed: ",f),1}return 0===l.It?1:i!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let i=0;return n.forEach(s=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.vt(a)||(this.Yt(e,s,null),i++)}),i}ce(e){const t=new Map;this.Qt.forEach((s,o)=>{const a=this.se(o);if(a){if(s.current&&Vm(a.target)){const c=new Ue(a.target.path);null!==this.jt.get(c)||this.ae(o,c)||this.Yt(o,c,R1.newNoDocument(c,e))}s.Mt&&(t.set(o,s.Ot()),s.Ft())}});let n=rn();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.se(c);return!l||"TargetPurposeLimboResolution"===l.purpose||(a=!1,!1)}),a&&(n=n.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));const i=new h9(e,t,this.Wt,this.jt,n);return this.jt=xs(),this.zt=dY(),this.Wt=new N1(Ut),i}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new fY,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new L1(Ut),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new fY),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function dY(){return new N1(Ue.comparator)}function hY(){return new N1(Ue.comparator)}const dPe={asc:"ASCENDING",desc:"DESCENDING"},hPe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},pPe={and:"AND",or:"OR"};class gPe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function EO(r,e){return r.useProto3Json||Jf(e)?e:{value:e}}function f5(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pY(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function mPe(r,e){return f5(r,e.toTimestamp())}function Rr(r){return mt(!!r),Ct.fromTimestamp(function(e){const t=q4(e);return new rr(t.seconds,t.nanos)}(r))}function SO(r,e){return(t=r,new zn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function gY(r){const e=zn.fromString(r);return mt(PY(e)),e}function g9(r,e){return SO(r.databaseId,e.path)}function bc(r,e){const t=gY(e);if(t.get(1)!==r.databaseId.projectId)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Te(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new Ue(_Y(t))}function PO(r,e){return SO(r.databaseId,e)}function m9(r){return new zn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function _Y(r){return mt(r.length>4&&"documents"===r.get(4)),r.popFirst(5)}function vY(r,e,t){return{name:g9(r,e),fields:t.value.mapValue.fields}}function yY(r,e){return{documents:[PO(r,e.path)]}}function OO(r,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=PO(r,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=PO(r,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const i=function(c){if(0!==c.length)return SY(a1.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const s=function(c){if(0!==c.length)return c.map(l=>{return{field:X4((f=l).field),direction:MPe(f.dir)};var f})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const o=EO(r,e.limit);var a,c;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt={before:!(c=e.endAt).inclusive,values:c.position}),t}function MY(r){let e=function mY(r){const e=gY(r);return 4===e.length?zn.emptyPath():_Y(e)}(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){mt(1===n);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(f){const d=EY(f);return d instanceof a1&&cO(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(f=>{return new i5(d5((d=f).field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(d.direction));var d}));let a=null;t.limit&&(a=function(f){let d;return d="object"==typeof f?f.value:f,Jf(d)?null:d}(t.limit));let c=null;var f;t.startAt&&(c=new K4((f=t.startAt).values||[],!!f.before));let l=null;return t.endAt&&(l=function(f){return new K4(f.values||[],!f.before)}(t.endAt)),function DZ(r,e,t,n,i,s,o,a){return new I3(r,e,t,n,i,s,o,a)}(e,i,o,s,a,"F",c,l)}function EY(r){return void 0!==r.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=d5(e.unaryFilter.field);return Sn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=d5(e.unaryFilter.field);return Sn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=d5(e.unaryFilter.field);return Sn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=d5(e.unaryFilter.field);return Sn.create(s,"!=",{nullValue:"NULL_VALUE"});default:return at()}}(r):void 0!==r.fieldFilter?Sn.create(d5((e=r).fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return at()}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==r.compositeFilter?function(e){return a1.create(e.compositeFilter.filters.map(t=>EY(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return at()}}(e.compositeFilter.op))}(r):at();var e}function MPe(r){return dPe[r]}function EPe(r){return hPe[r]}function SPe(r){return pPe[r]}function X4(r){return{fieldPath:r.canonicalString()}}function d5(r){return Lr.fromServerFormat(r.fieldPath)}function SY(r){return r instanceof Sn?function(e){if("=="===e.op){if(MZ(e.value))return{unaryFilter:{field:X4(e.field),op:"IS_NAN"}};if(yZ(e.value))return{unaryFilter:{field:X4(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(MZ(e.value))return{unaryFilter:{field:X4(e.field),op:"IS_NOT_NAN"}};if(yZ(e.value))return{unaryFilter:{field:X4(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:X4(e.field),op:EPe(e.op),value:e.value}}}(r):r instanceof a1?function(e){const t=e.getFilters().map(n=>SY(n));return 1===t.length?t[0]:{compositeFilter:{op:SPe(e.op),filters:t}}}(r):at()}function PPe(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function PY(r){return r.length>=4&&"projects"===r.get(0)&&"databases"===r.get(2)}class L3{constructor(e,t,n,i,s=Ct.min(),o=Ct.min(),a=a2.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new L3(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new L3(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new L3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new L3(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class TY{constructor(e){this.fe=e}}function bO(r){const e=MY({parent:r.parent,structuredQuery:r.structuredQuery});return"LAST"===r.limitType?Bm(e,e.limit,"L"):e}class G6{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(_r(e.integerValue));else if("doubleValue"in e){const n=_r(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),e9(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(A3(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?EZ(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):at()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const i of Object.keys(n))this.Te(i,t),this.me(n[i],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const i of n)this.me(i,t)}ve(e,t){this.ye(t,37),Ue.fromName(e).path.forEach(n=>{this.ye(t,60),this.be(n,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}G6.Ve=new G6;class xPe{constructor(){this.rn=new xO}addToCollectionParentIndex(e,t){return this.rn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(so.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(so.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class xO{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new L1(zn.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new L1(zn.comparator)).toArray()}}new Uint8Array(0);class ki{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ki(e,ki.DEFAULT_COLLECTION_PERCENTILE,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ki.DEFAULT_COLLECTION_PERCENTILE=10,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ki.DEFAULT=new ki(41943040,ki.DEFAULT_COLLECTION_PERCENTILE,ki.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ki.DISABLED=new ki(-1,0,0);class W6{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new W6(0)}static Mn(){return new W6(-1)}}class VPe{constructor(){this.changes=new k3(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,R1.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class BPe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class XY{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==n&&f9(n.mutation,i,ks.empty(),rr.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,rn()).next(()=>n))}getLocalViewOfDocuments(e,t,n=rn()){const i=Oc();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=c9();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Oc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,rn()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,i){let s=xs();const o=l9(),a=l9();return t.forEach((c,l)=>{const f=n.get(l.key);i.has(l.key)&&(void 0===f||f.mutation instanceof x3)?s=s.insert(l.key,l):void 0!==f?(o.set(l.key,f.mutation.getFieldMask()),f9(f.mutation,l,f.mutation.getFieldMask(),rr.now())):o.set(l.key,ks.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,f)=>o.set(l,f)),t.forEach((l,f)=>{var d;return a.set(l,new BPe(f,null!==(d=o.get(l))&&void 0!==d?d:null))}),a))}recalculateAndSaveOverlays(e,t){const n=l9();let i=new N1((o,a)=>o-a),s=rn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=t.get(c);if(null===l)return;let f=n.get(c)||ks.empty();f=a.applyToLocalView(l,f),n.set(c,f);const d=(i.get(a.batchId)||rn()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,f=c.value,d=UZ();f.forEach(m=>{if(!s.has(m)){const M=JZ(t.get(m),n.get(m));null!==M&&d.set(m,M),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return ce.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return Ue.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):dO(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var i}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ce.resolve(Oc());let a=-1,c=s;return o.next(l=>ce.forEach(l,(f,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(f)?ce.resolve():this.remoteDocumentCache.getEntry(e,f).next(m=>{c=c.insert(f,m)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,rn())).next(f=>({batchId:a,changes:GZ(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ue(t)).next(n=>{let i=c9();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const i=t.collectionGroup;let s=c9();return this.indexManager.getCollectionParents(e,i).next(o=>ce.forEach(o,a=>{const c=(l=t,f=a.child(i),new I3(f,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt));var l,f;return this.getDocumentsMatchingCollectionQuery(e,c,n).next(l=>{l.forEach((f,d)=>{s=s.insert(f,d)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i))).next(s=>{i.forEach((a,c)=>{const l=c.getKey();null===s.get(l)&&(s=s.insert(l,R1.newInvalidDocument(l)))});let o=c9();return s.forEach((a,c)=>{const l=i.get(a);void 0!==l&&f9(l.mutation,c,ks.empty(),rr.now()),a9(t,c)&&(o=o.insert(a,c))}),o})}}class GPe{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ce.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Rr(n.createTime)}),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:bO(n.bundledQuery),readTime:Rr(n.readTime)}),ce.resolve();var n}}class UPe{constructor(){this.overlays=new N1(Ue.comparator),this.ls=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Oc();return ce.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.we(e,t,s)}),ce.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.ls.get(n);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const i=Oc(),s=t.length+1,o=new Ue(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ce.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new N1((l,f)=>l-f);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>n){let f=s.get(l.largestBatchId);null===f&&(f=Oc(),s=s.insert(l.largestBatchId,f)),f.set(l.getKey(),l)}}const a=Oc(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,f)=>a.set(l,f)),!(a.size()>=i)););return ce.resolve(a)}we(e,t,n){const i=this.overlays.get(n.key);if(null!==i){const o=this.ls.get(i.largestBatchId).delete(n.key);this.ls.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new CO(t,n));let s=this.ls.get(t);void 0===s&&(s=rn(),this.ls.set(t,s)),this.ls.set(t,s.add(n.key))}}class LO{constructor(){this.fs=new L1(A2.ds),this.ws=new L1(A2._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new A2(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.ys(new A2(e,t))}ps(e,t){e.forEach(n=>this.removeReference(n,t))}Is(e){const t=new Ue(new zn([])),n=new A2(t,e),i=new A2(t,e+1),s=[];return this.ws.forEachInRange([n,i],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Ue(new zn([])),n=new A2(t,e),i=new A2(t,e+1);let s=rn();return this.ws.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new A2(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class A2{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Ue.comparator(e.key,t.key)||Ut(e.As,t.As)}static _s(e,t){return Ut(e.As,t.As)||Ue.comparator(e.key,t.key)}}class WPe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new L1(A2.ds)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,i){const s=this.vs;this.vs++;const o=new _O(s,t,n,i);this.mutationQueue.push(o);for(const a of i)this.Rs=this.Rs.add(new A2(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ce.resolve(o)}lookupMutationBatch(e,t){return ce.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.bs(t+1),s=i<0?0:i;return ce.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new A2(t,0),i=new A2(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([n,i],o=>{const a=this.Ps(o.As);s.push(a)}),ce.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new L1(Ut);return t.forEach(i=>{const s=new A2(i,0),o=new A2(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{n=n.add(a.As)})}),ce.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;Ue.isDocumentKey(s)||(s=s.child(""));const o=new A2(new Ue(s),0);let a=new L1(Ut);return this.Rs.forEachWhile(c=>{const l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.As)),!0)},o),ce.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(n=>{const i=this.Ps(n);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){mt(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ce.forEach(t.mutations,i=>{const s=new A2(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new A2(t,0),i=this.Rs.firstAfterOrEqual(n);return ce.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ce.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class qPe{constructor(e){this.Ds=e,this.docs=new N1(Ue.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():R1.newInvalidDocument(t))}getEntries(e,t){let n=xs();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():R1.newInvalidDocument(i))}),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=xs();const o=t.path,a=new Ue(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:l,value:{document:f}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||tO(sZ(f),n)<=0||(i.has(f.key)||a9(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return ce.resolve(s)}getAllFromCollectionGroup(e,t,n,i){at()}Cs(e,t){return ce.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new jPe(this)}getSize(e){return ce.resolve(this.size)}}class jPe extends VPe{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(n)}),ce.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}class ZPe{constructor(e){this.persistence=e,this.xs=new k3(t=>z6(t),s9),this.lastRemoteSnapshotVersion=Ct.min(),this.highestTargetId=0,this.Ns=0,this.ks=new LO,this.targetCount=0,this.Ms=W6.kn()}forEachTarget(e,t){return this.xs.forEach((n,i)=>t(i)),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ce.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new W6(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Fn(t),ce.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),ce.waitFor(s).next(()=>i)}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ce.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this.ks.containsKey(t))}}class RO{constructor(e,t){this.$s={},this.overlays={},this.Os=new oo(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new ZPe(this),this.indexManager=new xPe,this.remoteDocumentCache=new qPe(n=>this.referenceDelegate.Ls(n)),this.serializer=new TY(t),this.qs=new GPe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new UPe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new WPe(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Oe("MemoryPersistence","Starting transaction:",e);const i=new YPe(this.Os.next());return this.referenceDelegate.Us(),n(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,t){return ce.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class YPe extends mSe{constructor(e){super(),this.currentSequenceNumber=e}}class n_{constructor(e){this.persistence=e,this.Qs=new LO,this.js=null}static zs(e){return new n_(e)}get Ws(){if(this.js)return this.js;throw at()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Ws,n=>{const i=Ue.fromPath(n);return this.Hs(e,i).next(s=>{s||t.removeEntry(i,Ct.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(n=>{n?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ce.or([()=>ce.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}class VO{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=i}static Li(e,t){let n=rn(),i=rn();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new VO(e,t.fromCache,n,i)}}class JY{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,i){return this.Ki(e,t).next(s=>s||this.Gi(e,t,i,n)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(HZ(t))return ce.resolve(null);let n=as(t);return this.indexManager.getIndexType(e,n).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=Bm(t,null,"F"),n=as(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=rn(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(c=>{const l=this.ji(t,a);return this.zi(t,l,o,c.readTime)?this.Ki(e,Bm(t,null,"F")):this.Wi(e,l,t,c)}))})))}Gi(e,t,n,i){return HZ(t)||i.isEqual(Ct.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(s=>{const o=this.ji(t,s);return this.zi(t,o,n,i)?this.Qi(e,t):(QT()<=Gn.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),pO(t)),this.Wi(e,o,t,function iZ(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=Ct.fromTimestamp(1e9===n?new rr(t+1,0):new rr(t,n));return new so(i,Ue.empty(),e)}(i,-1)))})}ji(e,t){let n=new L1($Z(e));return t.forEach((i,s)=>{a9(e,s)&&(n=n.add(s))}),n}zi(e,t,n,i){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,t){return QT()<=Gn.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",pO(t)),this.Ui.getDocumentsMatchingQuery(e,t,so.min())}Wi(e,t,n,i){return this.Ui.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class XPe{constructor(e,t,n,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new N1(Ut),this.Yi=new k3(s=>z6(s),s9),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XY(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function tK(r,e){return FO.apply(this,arguments)}function FO(){return FO=P(function*(r,e){const t=je(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.tr(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],a=[];let c=rn();for(const l of i){o.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}for(const l of s){a.push(l.batchId);for(const f of l.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(l=>({er:l,removedBatchIds:o,addedBatchIds:a}))})})}),FO.apply(this,arguments)}function nK(r){const e=je(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function eTe(r,e){const t=je(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function m5(r,e,t){return $O.apply(this,arguments)}function $O(){return $O=P(function*(r,e,t){const n=je(r),i=n.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!U4(o))throw o;Oe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ji=n.Ji.remove(e),n.Yi.delete(i.target)}),$O.apply(this,arguments)}function s_(r,e,t){const n=je(r);let i=Ct.min(),s=rn();return n.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const f=je(a),d=f.Yi.get(l);return void 0!==d?ce.resolve(f.Ji.get(d)):f.Bs.getTargetData(c,l)}(n,o,as(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,n.Bs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>n.Hi.getDocumentsMatchingQuery(o,e,t?i:Ct.min(),t?s:rn())).next(a=>(function oK(r,e,t){let n=r.Xi.get(e)||Ct.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Xi.set(e,n)}(n,function FZ(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}(e),a),{documents:a,ir:s})))}class qO{constructor(){this.activeTargetIds=function gO(){return tPe}()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lK{constructor(){this.Hr=new qO,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new qO,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class rTe{Yr(e){}shutdown(){}}class uK{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Oe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Oe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let c_=null;function ZO(){return null===c_?c_=268435456+Math.round(2147483648*Math.random()):c_++,"0x"+c_.toString(16)}const iTe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sTe{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}const xi="WebChannelConnection";class oTe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.mo=(e.ssl?"https":"http")+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,i,s){const o=ZO(),a=this.To(e,t);Oe("RestConnection",`Sending RPC '${e}' ${o}:`,a,n);const c={};return this.Eo(c,i,s),this.Ao(e,a,c,n).then(l=>(Oe("RestConnection",`Received RPC '${e}' ${o}: `,l),l),l=>{throw ya("RestConnection",`RPC '${e}' ${o} failed with error: `,l,"url: ",a,"request:",n),l})}vo(e,t,n,i,s,o){return this.Io(e,t,n,i,s)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+e5,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}To(e,t){return`${this.mo}/v1/${t}:${iTe[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,i){const s=ZO();return new Promise((o,a)=>{const c=new iSe;c.setWithCredentials(!0),c.listenOnce(tSe.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case XT.NO_ERROR:const f=c.getResponseJson();Oe(xi,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),o(f);break;case XT.TIMEOUT:Oe(xi,`RPC '${e}' ${s} timed out`),a(new Te(fe.DEADLINE_EXCEEDED,"Request time out"));break;case XT.HTTP_ERROR:const d=c.getStatus();if(Oe(xi,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const M=m?.error;if(M&&M.status&&M.message){const w=function(L){const z=L.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(z)>=0?z:fe.UNKNOWN}(M.status);a(new Te(w,M.message))}else a(new Te(fe.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new Te(fe.UNAVAILABLE,"Connection failed."));break;default:at()}}finally{Oe(xi,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(i);Oe(xi,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,n,15)})}Ro(e,t,n){const i=ZO(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=JEe(),a=eSe(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new rSe({})),this.Eo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const f=s.join("");Oe(xi,`Creating RPC '${e}' stream ${i}: ${f}`,c);const d=o.createWebChannel(f,c);let m=!1,M=!1;const w=new sTe({ro:z=>{M?Oe(xi,`Not sending because RPC '${e}' stream ${i} is closed:`,z):(m||(Oe(xi,`Opening RPC '${e}' stream ${i} transport.`),d.open(),m=!0),Oe(xi,`RPC '${e}' stream ${i} sending:`,z),d.send(z))},oo:()=>d.close()}),L=(z,$,B)=>{z.listen($,de=>{try{B(de)}catch(_e){setTimeout(()=>{throw _e},0)}})};return L(d,wm.EventType.OPEN,()=>{M||Oe(xi,`RPC '${e}' stream ${i} transport opened.`)}),L(d,wm.EventType.CLOSE,()=>{M||(M=!0,Oe(xi,`RPC '${e}' stream ${i} transport closed`),w.wo())}),L(d,wm.EventType.ERROR,z=>{M||(M=!0,ya(xi,`RPC '${e}' stream ${i} transport errored:`,z),w.wo(new Te(fe.UNAVAILABLE,"The operation could not be completed")))}),L(d,wm.EventType.MESSAGE,z=>{var $;if(!M){const B=z.data[0];mt(!!B);const _e=B.error||(null===($=B[0])||void 0===$?void 0:$.error);if(_e){Oe(xi,`RPC '${e}' stream ${i} received error:`,_e);const xe=_e.status;let nt=function(yn){const Et=Zr[yn];if(void 0!==Et)return sY(Et)}(xe),gt=_e.message;void 0===nt&&(nt=fe.INTERNAL,gt="Unknown error status: "+xe+" with message "+_e.message),M=!0,w.wo(new Te(nt,gt)),d.close()}else Oe(xi,`RPC '${e}' stream ${i} received:`,B),w._o(B)}}),L(a,nSe.STAT_EVENT,z=>{z.stat===Qj.PROXY?Oe(xi,`RPC '${e}' stream ${i} detected buffering proxy`):z.stat===Qj.NOPROXY&&Oe(xi,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}}function l_(){return typeof document<"u"?document:null}function O9(r){return new gPe(r,!0)}class YO{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-n);i>0&&Oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class dK{constructor(e,t,n,i,s,o,a,c){this.ii=e,this.$o=n,this.Oo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new YO(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var e=this;return P(function*(){e.Uo()&&(yield e.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}zo(){var e=this;return P(function*(){if(e.Ko())return e.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(e,t){var n=this;return P(function*(){n.Ho(),n.Jo(),n.qo.cancel(),n.Fo++,4!==e?n.qo.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(xr(t.toString()),xr("Using maximum backoff delay to prevent overloading the backend."),n.qo.xo()):t&&t.code===fe.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Yo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.ao(t)})()}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Fo===t&&this.Zo(n,i)},n=>{e(()=>{const i=new Te(fe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.tu(i)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{n(()=>this.tu(i))}),this.stream.onMessage(i=>{n(()=>this.onMessage(i))})}Go(){var e=this;this.state=5,this.qo.No(P(function*(){e.state=0,e.start()}))}tu(e){return Oe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Oe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class aTe extends dK{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function vPe(r,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(c=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===c?1:"REMOVE"===c?2:"CURRENT"===c?3:"RESET"===c?4:at(),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(mt(void 0===l||"string"==typeof l),a2.fromBase64String(l||"")):(mt(void 0===l||l instanceof Uint8Array),a2.fromUint8Array(l||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=void 0===c.code?fe.UNKNOWN:sY(c.code);return new Te(l,c.message||"")}(o);t=new uY(n,i,s,a||null)}else if("documentChange"in e){const n=e.documentChange,i=bc(r,n.document.name),s=Rr(n.document.updateTime),o=n.document.createTime?Rr(n.document.createTime):Ct.min(),a=new ri({mapValue:{fields:n.document.fields}}),c=R1.newFoundDocument(i,s,o,a);t=new jm(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,i=bc(r,n.document),s=n.readTime?Rr(n.readTime):Ct.min(),o=R1.newNoDocument(i,s);t=new jm([],n.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const n=e.documentRemove,i=bc(r,n.document);t=new jm([],n.removedTargetIds||[],i,null)}else{if(!("filter"in e))return at();{const n=e.filter,{count:i=0,unchangedNames:s}=n,o=new lPe(i,s);t=new lY(n.targetId,o)}}var c;return t}(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ct.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?Ct.min():s.readTime?Rr(s.readTime):Ct.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=m9(this.serializer),t.addTarget=function(i,s){let o;const a=s.target;if(o=Vm(a)?{documents:yY(i,a)}:{query:OO(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=pY(i,s.resumeToken);const c=EO(i,s.expectedCount);null!==c&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(Ct.min())>0){o.readTime=f5(i,s.snapshotVersion.toTimestamp());const c=EO(i,s.expectedCount);null!==c&&(o.expectedCount=c)}return o}(this.serializer,e);const n=function yPe(r,e){const t=function(n){switch(n){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=m9(this.serializer),t.removeTarget=e,this.Wo(t)}}class cTe extends dK{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(mt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function CPe(r,e){return r&&r.length>0?(mt(void 0!==e),r.map(t=>function(n,i){let s=Rr(n.updateTime?n.updateTime:i);return s.isEqual(Ct.min())&&(s=Rr(i)),new sPe(s,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=Rr(e.commitTime);return this.listener.cu(n,t)}return mt(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=m9(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>function _9(r,e){let t;if(e instanceof l5)t={update:vY(r,e.key,e.value)};else if(e instanceof u5)t={delete:g9(r,e.key)};else if(e instanceof x3)t={update:vY(r,e.key,e.data),updateMask:PPe(e.fieldMask)};else{if(!(e instanceof mO))return at();t={verify:g9(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,s){const o=s.transform;if(o instanceof a5)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof H6)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof V6)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof c5)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw at()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:mPe(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:at()),t;var i}(this.serializer,n))};this.Wo(t)}}class lTe extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,t,n,i,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Te(fe.UNKNOWN,i.toString())})}vo(e,t,n,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,t,n,s,o,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Te(fe.UNKNOWN,s.toString())})}terminate(){this.lu=!0}}class fTe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(xr(t),this.mu=!1):Oe("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class dTe{constructor(e,t,n,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(a=>{n.enqueueAndForget(P(function*(){var c;tl(o)&&(Oe("RemoteStore","Restarting streams for network reachability change."),yield(c=P(function*(l){const f=je(l);f.vu.add(4),yield _5(f),f.bu.set("Unknown"),f.vu.delete(4),yield b9(f)}),function(l){return c.apply(this,arguments)})(o))}))}),this.bu=new fTe(n,i)}}function b9(r){return XO.apply(this,arguments)}function XO(){return XO=P(function*(r){if(tl(r))for(const e of r.Ru)yield e(!0)}),XO.apply(this,arguments)}function _5(r){return QO.apply(this,arguments)}function QO(){return QO=P(function*(r){for(const e of r.Ru)yield e(!1)}),QO.apply(this,arguments)}function u_(r,e){const t=je(r);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),tb(t)?eb(t):C5(t).Ko()&&JO(t,e))}function w9(r,e){const t=je(r),n=C5(t);t.Au.delete(e),n.Ko()&&hK(t,e),0===t.Au.size&&(n.Ko()?n.jo():tl(t)&&t.bu.set("Unknown"))}function JO(r,e){if(r.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ct.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}C5(r).su(e)}function hK(r,e){r.Vu.qt(e),C5(r).iu(e)}function eb(r){r.Vu=new fPe({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),le:e=>r.Au.get(e)||null,ue:()=>r.datastore.serializer.databaseId}),C5(r).start(),r.bu.gu()}function tb(r){return tl(r)&&!C5(r).Uo()&&r.Au.size>0}function tl(r){return 0===je(r).vu.size}function pK(r){r.Vu=void 0}function hTe(r){return nb.apply(this,arguments)}function nb(){return nb=P(function*(r){r.Au.forEach((e,t)=>{JO(r,e)})}),nb.apply(this,arguments)}function pTe(r,e){return rb.apply(this,arguments)}function rb(){return rb=P(function*(r,e){pK(r),tb(r)?(r.bu.Iu(e),eb(r)):r.bu.set("Unknown")}),rb.apply(this,arguments)}function gTe(r,e,t){return ib.apply(this,arguments)}function ib(){return ib=P(function*(r,e,t){if(r.bu.set("Online"),e instanceof uY&&2===e.state&&e.cause)try{yield(n=P(function*(i,s){const o=s.cause;for(const a of s.targetIds)i.Au.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.Au.delete(a),i.Vu.removeTarget(a))}),function(i,s){return n.apply(this,arguments)})(r,e)}catch(n){Oe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield f_(r,n)}else if(e instanceof jm?r.Vu.Ht(e):e instanceof lY?r.Vu.ne(e):r.Vu.Xt(e),!t.isEqual(Ct.min()))try{const n=yield nK(r.localStore);t.compareTo(n)>=0&&(yield function(i,s){const o=i.Vu.ce(s);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=i.Au.get(c);l&&i.Au.set(c,l.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,c)=>{const l=i.Au.get(a);if(!l)return;i.Au.set(a,l.withResumeToken(a2.EMPTY_BYTE_STRING,l.snapshotVersion)),hK(i,a);const f=new L3(l.target,a,c,l.sequenceNumber);JO(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(r,t))}catch(n){Oe("RemoteStore","Failed to raise snapshot:",n),yield f_(r,n)}var n}),ib.apply(this,arguments)}function f_(r,e,t){return sb.apply(this,arguments)}function sb(){return sb=P(function*(r,e,t){if(!U4(e))throw e;r.vu.add(1),yield _5(r),r.bu.set("Offline"),t||(t=()=>nK(r.localStore)),r.asyncQueue.enqueueRetryable(P(function*(){Oe("RemoteStore","Retrying IndexedDB access"),yield t(),r.vu.delete(1),yield b9(r)}))}),sb.apply(this,arguments)}function gK(r,e){return e().catch(t=>f_(r,t,e))}function v5(r){return ob.apply(this,arguments)}function ob(){return ob=P(function*(r){const e=je(r),t=nl(e);let n=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;mTe(e);)try{const i=yield eTe(e.localStore,n);if(null===i){0===e.Eu.length&&t.jo();break}n=i.batchId,_Te(e,i)}catch(i){yield f_(e,i)}mK(e)&&_K(e)}),ob.apply(this,arguments)}function mTe(r){return tl(r)&&r.Eu.length<10}function _Te(r,e){r.Eu.push(e);const t=nl(r);t.Ko()&&t.ou&&t.uu(e.mutations)}function mK(r){return tl(r)&&!nl(r).Uo()&&r.Eu.length>0}function _K(r){nl(r).start()}function vTe(r){return ab.apply(this,arguments)}function ab(){return ab=P(function*(r){nl(r).hu()}),ab.apply(this,arguments)}function CTe(r){return cb.apply(this,arguments)}function cb(){return cb=P(function*(r){const e=nl(r);for(const t of r.Eu)e.uu(t.mutations)}),cb.apply(this,arguments)}function yTe(r,e,t){return lb.apply(this,arguments)}function lb(){return lb=P(function*(r,e,t){const n=r.Eu.shift(),i=vO.from(n,e,t);yield gK(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield v5(r)}),lb.apply(this,arguments)}function MTe(r,e){return ub.apply(this,arguments)}function ub(){return ub=P(function*(r,e){var t;e&&nl(r).ou&&(yield(t=P(function*(n,i){if(function iY(r){switch(r){default:return at();case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0}}(s=i.code)&&s!==fe.ABORTED){const o=n.Eu.shift();nl(n).Qo(),yield gK(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield v5(n)}var s}),function(n,i){return t.apply(this,arguments)})(r,e)),mK(r)&&_K(r)}),ub.apply(this,arguments)}function vK(r,e){return fb.apply(this,arguments)}function fb(){return fb=P(function*(r,e){const t=je(r);t.asyncQueue.verifyOperationInProgress(),Oe("RemoteStore","RemoteStore received new credentials");const n=tl(t);t.vu.add(3),yield _5(t),n&&t.bu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),yield b9(t)}),fb.apply(this,arguments)}function hb(){return hb=P(function*(r,e){const t=je(r);e?(t.vu.delete(2),yield b9(t)):e||(t.vu.add(2),yield _5(t),t.bu.set("Unknown"))}),hb.apply(this,arguments)}function C5(r){return r.Su||(r.Su=function(e,t,n){const i=je(e);return i.fu(),new aTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:hTe.bind(null,r),ao:pTe.bind(null,r),nu:gTe.bind(null,r)}),r.Ru.push(function(){var e=P(function*(t){t?(r.Su.Qo(),tb(r)?eb(r):r.bu.set("Unknown")):(yield r.Su.stop(),pK(r))});return function(t){return e.apply(this,arguments)}}())),r.Su}function nl(r){return r.Du||(r.Du=function(e,t,n){const i=je(e);return i.fu(),new cTe(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,n)}(r.datastore,r.asyncQueue,{uo:vTe.bind(null,r),ao:MTe.bind(null,r),au:CTe.bind(null,r),cu:yTe.bind(null,r)}),r.Ru.push(function(){var e=P(function*(t){t?(r.Du.Qo(),yield v5(r)):(yield r.Du.stop(),r.Eu.length>0&&(Oe("RemoteStore",`Stopping write stream with ${r.Eu.length} pending writes`),r.Eu=[]))});return function(t){return e.apply(this,arguments)}}())),r.Du}class pb{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new o2,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,a=new pb(e,t,o,i,s);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Te(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function y5(r,e){if(xr("AsyncQueue",`${e}: ${r}`),U4(r))return new Te(fe.UNAVAILABLE,`${e}: ${r}`);throw r}class M5{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ue.comparator(t.key,n.key):(t,n)=>Ue.comparator(t.key,n.key),this.keyedMap=c9(),this.sortedSet=new N1(this.comparator)}static emptySet(e){return new M5(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof M5)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new M5;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class CK{constructor(){this.Cu=new N1(Ue.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):at():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class E5{constructor(e,t,n,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new E5(e,t,M5.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&o9(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}class ETe{constructor(){this.Nu=void 0,this.listeners=[]}}class STe{constructor(){this.queries=new k3(e=>VZ(e),o9),this.onlineState="Unknown",this.ku=new Set}}function gb(r,e){return mb.apply(this,arguments)}function mb(){return mb=P(function*(r,e){const t=je(r),n=e.query;let i=!1,s=t.queries.get(n);if(s||(i=!0,s=new ETe),i)try{s.Nu=yield t.onListen(n)}catch(o){const a=y5(o,`Initialization of query '${pO(e.query)}' failed`);return void e.onError(a)}t.queries.set(n,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&Cb(t)}),mb.apply(this,arguments)}function _b(r,e){return vb.apply(this,arguments)}function vb(){return vb=P(function*(r,e){const t=je(r),n=e.query;let i=!1;const s=t.queries.get(n);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=0===s.listeners.length)}if(i)return t.queries.delete(n),t.onUnlisten(n)}),vb.apply(this,arguments)}function PTe(r,e){const t=je(r);let n=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.listeners)a.$u(i)&&(n=!0);o.Nu=i}}n&&Cb(t)}function TTe(r,e,t){const n=je(r),i=n.queries.get(e);if(i)for(const s of i.listeners)s.onError(t);n.queries.delete(e)}function Cb(r){r.ku.forEach(e=>{e.next()})}class yb{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)3!==i.type&&n.push(i);e=new E5(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){return!e.fromCache||(!this.options.Ku||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(e){e=E5.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}class EK{constructor(e){this.key=e}}class SK{constructor(e){this.key=e}}class PK{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=rn(),this.mutatedKeys=rn(),this.tc=$Z(e),this.ec=new M5(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new CK,i=t?t.ec:this.ec;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const c="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,l="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,d)=>{const m=i.get(f),M=a9(this.query,d)?d:null,w=!!m&&this.mutatedKeys.has(m.key),L=!!M&&(M.hasLocalMutations||this.mutatedKeys.has(M.key)&&M.hasCommittedMutations);let z=!1;m&&M?m.data.isEqual(M.data)?w!==L&&(n.track({type:3,doc:M}),z=!0):this.rc(m,M)||(n.track({type:2,doc:M}),z=!0,(c&&this.tc(M,c)>0||l&&this.tc(M,l)<0)&&(a=!0)):!m&&M?(n.track({type:0,doc:M}),z=!0):m&&!M&&(n.track({type:1,doc:m}),z=!0,(c||l)&&(a=!0)),z&&(M?(o=o.add(M),s=L?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const f="F"===this.query.limitType?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{ec:o,ic:n,zi:a,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const s=e.ic.xu();s.sort((l,f)=>function(d,m){const M=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at()}};return M(d)-M(m)}(l.type,f.type)||this.tc(l.doc,f.doc)),this.oc(n);const o=t?this.uc():[],a=0===this.Zu.size&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,0!==s.length||c?{snapshot:new E5(this.query,e.ec,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new CK,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=rn(),this.ec.forEach(n=>{this.ac(n.key)&&(this.Zu=this.Zu.add(n.key))});const t=[];return e.forEach(n=>{this.Zu.has(n)||t.push(new SK(n))}),this.Zu.forEach(n=>{e.has(n)||t.push(new EK(n))}),t}hc(e){this.Yu=e.ir,this.Zu=rn();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return E5.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class wTe{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class NTe{constructor(e){this.key=e,this.fc=!1}}class ATe{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new k3(a=>VZ(a),o9),this._c=new Map,this.mc=new Set,this.gc=new N1(Ue.comparator),this.yc=new Map,this.Ic=new LO,this.Tc={},this.Ec=new Map,this.Ac=W6.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function ITe(r,e){return Mb.apply(this,arguments)}function Mb(){return Mb=P(function*(r,e){const t=function Ub(r){const e=je(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=TK.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=FTe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LTe.bind(null,e),e.dc.nu=PTe.bind(null,e.eventManager),e.dc.Pc=TTe.bind(null,e.eventManager),e}(r);let n,i;const s=t.wc.get(e);if(s)n=s.targetId,t.sharedClientState.addLocalQueryTarget(n),i=s.view.lc();else{const o=yield function g5(r,e){const t=je(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Bs.getTargetData(n,e).next(s=>s?(i=s,ce.resolve(i)):t.Bs.allocateTargetId(n).next(o=>(i=new L3(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Bs.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ji.get(n.targetId);return(null===i||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(n.targetId,n),t.Yi.set(e,n.targetId)),n})}(t.localStore,as(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);n=o.targetId,i=yield function Eb(r,e,t,n,i){return Sb.apply(this,arguments)}(t,e,n,"current"===a,o.resumeToken),t.isPrimaryClient&&u_(t.remoteStore,o)}return i}),Mb.apply(this,arguments)}function Sb(){return Sb=P(function*(r,e,t,n,i){r.Rc=(d,m,M)=>{return(w=P(function*(L,z,$,B){let de=z.view.sc($);de.zi&&(de=yield s_(L.localStore,z.query,!1).then(({documents:nt})=>z.view.sc(nt,de)));const _e=B&&B.targetChanges.get(z.targetId),xe=z.view.applyChanges(de,L.isPrimaryClient,_e);return xb(L,z.targetId,xe.cc),xe.snapshot}),function(L,z,$,B){return w.apply(this,arguments)})(r,d,m,M);var w};const s=yield s_(r.localStore,e,!0),o=new PK(e,s.ir),a=o.sc(s.documents),c=p9.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==r.onlineState,i),l=o.applyChanges(a,r.isPrimaryClient,c);xb(r,t,l.cc);const f=new wTe(e,t,o);return r.wc.set(e,f),r._c.has(t)?r._c.get(t).push(e):r._c.set(t,[e]),l.snapshot}),Sb.apply(this,arguments)}function kTe(r,e){return Pb.apply(this,arguments)}function Pb(){return Pb=P(function*(r,e){const t=je(r),n=t.wc.get(e),i=t._c.get(n.targetId);if(i.length>1)return t._c.set(n.targetId,i.filter(s=>!o9(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield m5(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),w9(t.remoteStore,n.targetId),S5(t,n.targetId)}).catch(G4))):(S5(t,n.targetId),yield m5(t.localStore,n.targetId,!0))}),Pb.apply(this,arguments)}function Tb(){return Tb=P(function*(r,e,t){const n=function Wb(r){const e=je(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=RTe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zTe.bind(null,e),e}(r);try{const i=yield function(s,o){const a=je(s),c=rr.now(),l=o.reduce((m,M)=>m.add(M.key),rn());let f,d;return a.persistence.runTransaction("Locally write mutations","readwrite",m=>{let M=xs(),w=rn();return a.Zi.getEntries(m,l).next(L=>{M=L,M.forEach((z,$)=>{$.isValidDocument()||(w=w.add(z))})}).next(()=>a.localDocuments.getOverlayedDocuments(m,M)).next(L=>{f=L;const z=[];for(const $ of o){const B=aPe($,f.get($.key).overlayedDocument);null!=B&&z.push(new x3($.key,B,TZ(B.value.mapValue),Z1.exists(!0)))}return a.mutationQueue.addMutationBatch(m,c,z,o)}).next(L=>{d=L;const z=L.applyToLocalDocumentSet(f,w);return a.documentOverlayCache.saveOverlays(m,L.batchId,z)})}).then(()=>({batchId:d.batchId,changes:GZ(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let c=s.Tc[s.currentUser.toKey()];c||(c=new N1(Ut)),c=c.insert(o,a),s.Tc[s.currentUser.toKey()]=c}(n,i.batchId,t),yield R3(n,i.changes),yield v5(n.remoteStore)}catch(i){const s=y5(i,"Failed to persist write");t.reject(s)}}),Tb.apply(this,arguments)}function TK(r,e){return Ob.apply(this,arguments)}function Ob(){return Ob=P(function*(r,e){const t=je(r);try{const n=yield function JPe(r,e){const t=je(r),n=e.snapshotVersion;let i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;const a=[];e.targetChanges.forEach((f,d)=>{const m=i.get(d);if(!m)return;a.push(t.Bs.removeMatchingKeys(s,f.removedDocuments,d).next(()=>t.Bs.addMatchingKeys(s,f.addedDocuments,d)));let M=m.withSequenceNumber(s.currentSequenceNumber);var w,L,z;null!==e.targetMismatches.get(d)?M=M.withResumeToken(a2.EMPTY_BYTE_STRING,Ct.min()).withLastLimboFreeSnapshotVersion(Ct.min()):f.resumeToken.approximateByteSize()>0&&(M=M.withResumeToken(f.resumeToken,n)),i=i.insert(d,M),L=M,z=f,(0===(w=m).resumeToken.approximateByteSize()||L.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8||z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0)&&a.push(t.Bs.updateTargetData(s,M))});let c=xs(),l=rn();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),a.push(function rK(r,e,t){let n=rn(),i=rn();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=xs();return t.forEach((a,c)=>{const l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Ct.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||0===c.version.compareTo(l.version)&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):Oe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{nr:o,sr:i}})}(s,o,e.documentUpdates).next(f=>{c=f.nr,l=f.sr})),!n.isEqual(Ct.min())){const f=t.Bs.getLastRemoteSnapshotVersion(s).next(d=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,n));a.push(f)}return ce.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.Ji=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.yc.get(s);o&&(mt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.fc=!0:i.modifiedDocuments.size>0?mt(o.fc):i.removedDocuments.size>0&&(mt(o.fc),o.fc=!1))}),yield R3(t,n,e)}catch(n){yield G4(n)}}),Ob.apply(this,arguments)}function OK(r,e,t){const n=je(r);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const i=[];n.wc.forEach((s,o)=>{const a=o.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=je(s);a.onlineState=o;let c=!1;a.queries.forEach((l,f)=>{for(const d of f.listeners)d.Mu(o)&&(c=!0)}),c&&Cb(a)}(n.eventManager,e),i.length&&n.dc.nu(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function LTe(r,e,t){return bb.apply(this,arguments)}function bb(){return bb=P(function*(r,e,t){const n=je(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.yc.get(e),s=i&&i.key;if(s){let o=new N1(Ue.comparator);o=o.insert(s,R1.newNoDocument(s,Ct.min()));const a=rn().add(s),c=new h9(Ct.min(),new Map,new N1(Ut),o,a);yield TK(n,c),n.gc=n.gc.remove(s),n.yc.delete(e),Lb(n)}else yield m5(n.localStore,e,!1).then(()=>S5(n,e,t)).catch(G4)}),bb.apply(this,arguments)}function RTe(r,e){return wb.apply(this,arguments)}function wb(){return wb=P(function*(r,e){const t=je(r),n=e.batch.batchId;try{const i=yield function QPe(r,e){const t=je(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const f=c.batch,d=f.keys();let m=ce.resolve();return d.forEach(M=>{m=m.next(()=>l.getEntry(a,M)).next(w=>{const L=c.docVersions.get(M);mt(null!==L),w.version.compareTo(L)<0&&(f.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),l.addEntry(w)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(a,f))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let a=rn();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}(t.localStore,e);kb(t,n,null),Ib(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield R3(t,i)}catch(i){yield G4(i)}}),wb.apply(this,arguments)}function zTe(r,e,t){return Nb.apply(this,arguments)}function Nb(){return Nb=P(function*(r,e,t){const n=je(r);try{const i=yield function(s,o){const a=je(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(f=>(mt(null!==f),l=f.keys(),a.mutationQueue.removeMutationBatch(c,f))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(n.localStore,e);kb(n,e,t),Ib(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield R3(n,i)}catch(i){yield G4(i)}}),Nb.apply(this,arguments)}function Ib(r,e){(r.Ec.get(e)||[]).forEach(t=>{t.resolve()}),r.Ec.delete(e)}function kb(r,e,t){const n=je(r);let i=n.Tc[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Tc[n.currentUser.toKey()]=i}}function S5(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r._c.get(e))r.wc.delete(n),t&&r.dc.Pc(n,t);r._c.delete(e),r.isPrimaryClient&&r.Ic.Is(e).forEach(n=>{r.Ic.containsKey(n)||bK(r,n)})}function bK(r,e){r.mc.delete(e.path.canonicalString());const t=r.gc.get(e);null!==t&&(w9(r.remoteStore,t),r.gc=r.gc.remove(e),r.yc.delete(t),Lb(r))}function xb(r,e,t){for(const n of t)n instanceof EK?(r.Ic.addReference(n.key,e),HTe(r,n)):n instanceof SK?(Oe("SyncEngine","Document no longer in limbo: "+n.key),r.Ic.removeReference(n.key,e),r.Ic.containsKey(n.key)||bK(r,n.key)):at()}function HTe(r,e){const t=e.key,n=t.path.canonicalString();r.gc.get(t)||r.mc.has(n)||(Oe("SyncEngine","New document in limbo: "+t),r.mc.add(n),Lb(r))}function Lb(r){for(;r.mc.size>0&&r.gc.size<r.maxConcurrentLimboResolutions;){const e=r.mc.values().next().value;r.mc.delete(e);const t=new Ue(zn.fromString(e)),n=r.Ac.next();r.yc.set(n,new NTe(t)),r.gc=r.gc.insert(t,n),u_(r.remoteStore,new L3(as(o5(t.path)),n,"TargetPurposeLimboResolution",oo.ct))}}function R3(r,e,t){return Rb.apply(this,arguments)}function Rb(){return Rb=P(function*(r,e,t){const n=je(r),i=[],s=[],o=[];var a;n.wc.isEmpty()||(n.wc.forEach((a,c)=>{o.push(n.Rc(c,e,t).then(l=>{if((l||t)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(c.targetId,l?.fromCache?"not-current":"current"),l){i.push(l);const f=VO.Li(c.targetId,l);s.push(f)}}))}),yield Promise.all(o),n.dc.nu(i),yield(a=P(function*(c,l){const f=je(c);try{yield f.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>ce.forEach(l,m=>ce.forEach(m.Fi,M=>f.persistence.referenceDelegate.addReference(d,m.targetId,M)).next(()=>ce.forEach(m.Bi,M=>f.persistence.referenceDelegate.removeReference(d,m.targetId,M)))))}catch(d){if(!U4(d))throw d;Oe("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const m=d.targetId;if(!d.fromCache){const M=f.Ji.get(m),L=M.withLastLimboFreeSnapshotVersion(M.snapshotVersion);f.Ji=f.Ji.insert(m,L)}}}),function(c,l){return a.apply(this,arguments)})(n.localStore,s))}),Rb.apply(this,arguments)}function VTe(r,e){return zb.apply(this,arguments)}function zb(){return zb=P(function*(r,e){const t=je(r);if(!t.currentUser.isEqual(e)){Oe("SyncEngine","User change. New user:",e.toKey());const n=yield tK(t.localStore,e);t.currentUser=e,(i=t).Ec.forEach(o=>{o.forEach(a=>{a.reject(new Te(fe.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.Ec.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield R3(t,n.er)}var i}),zb.apply(this,arguments)}function FTe(r,e){const t=je(r),n=t.yc.get(e);if(n&&n.fc)return rn().add(n.key);{let i=rn();const s=t._c.get(e);if(!s)return i;for(const o of s){const a=t.wc.get(o);i=i.unionWith(a.view.nc)}return i}}class d_{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return P(function*(){t.serializer=O9(e.databaseInfo.databaseId),t.sharedClientState=t.createSharedClientState(e),t.persistence=t.createPersistence(e),yield t.persistence.start(),t.localStore=t.createLocalStore(e),t.gcScheduler=t.createGarbageCollectionScheduler(e,t.localStore),t.indexBackfillerScheduler=t.createIndexBackfillerScheduler(e,t.localStore)})()}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function eK(r,e,t,n){return new XPe(r,e,t,n)}(this.persistence,new JY,e.initialUser,this.serializer)}createPersistence(e){return new RO(n_.zs,this.serializer)}createSharedClientState(e){return new lK}terminate(){var e=this;return P(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class P5{initialize(e,t){var n=this;return P(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=i=>OK(n.syncEngine,i,1),n.remoteStore.remoteSyncer.handleCredentialChange=VTe.bind(null,n.syncEngine),yield function db(r,e){return hb.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new STe}createDatastore(e){const t=O9(e.databaseInfo.databaseId),n=new oTe(e.databaseInfo);return new lTe(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,i=e.asyncQueue,s=a=>OK(this.syncEngine,a,0),o=uK.D()?new uK:new rTe,new dTe(t,n,i,s,o);var t,n,i,s,o}createSyncEngine(e,t){return function(n,i,s,o,a,c,l){const f=new ATe(n,i,s,o,a,c);return l&&(f.vc=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=P(function*(t){const n=je(t);Oe("RemoteStore","RemoteStore shutting down."),n.vu.add(5),yield _5(n),n.Pu.shutdown(),n.bu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}class h_{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):xr("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class JTe{constructor(e,t,n,i){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=w2.UNAUTHENTICATED,this.clientId=nZ.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var o=P(function*(a){Oe("FirestoreClient","Received user=",a.uid),yield s.authCredentialListener(a),s.user=a});return function(a){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(n,o=>(Oe("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return P(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Te(fe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new o2;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(P(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const i=y5(n,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function p_(r,e){return qb.apply(this,arguments)}function qb(){return qb=P(function*(r,e){r.asyncQueue.verifyOperationInProgress(),Oe("FirestoreClient","Initializing OfflineComponentProvider");const t=yield r.getConfiguration();yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(function(){var i=P(function*(s){n.isEqual(s)||(yield tK(e.localStore,s),n=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}),qb.apply(this,arguments)}function jb(r,e){return Zb.apply(this,arguments)}function Zb(){return Zb=P(function*(r,e){r.asyncQueue.verifyOperationInProgress();const t=yield function Yb(r){return Kb.apply(this,arguments)}(r);Oe("FirestoreClient","Initializing OnlineComponentProvider");const n=yield r.getConfiguration();yield e.initialize(t,n),r.setCredentialChangeListener(i=>vK(e.remoteStore,i)),r.setAppCheckTokenChangeListener((i,s)=>vK(e.remoteStore,s)),r._onlineComponents=e}),Zb.apply(this,arguments)}function Kb(){return Kb=P(function*(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Oe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield p_(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function xK(r){return"FirebaseError"===r.name?r.code===fe.FAILED_PRECONDITION||r.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code}(t))throw t;ya("Error using user provided cache. Falling back to memory cache: "+t),yield p_(r,new d_)}}else Oe("FirestoreClient","Using default OfflineComponentProvider"),yield p_(r,new d_);return r._offlineComponents}),Kb.apply(this,arguments)}function g_(r){return Xb.apply(this,arguments)}function Xb(){return Xb=P(function*(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Oe("FirestoreClient","Using user provided OnlineComponentProvider"),yield jb(r,r._uninitializedComponentsProvider._online)):(Oe("FirestoreClient","Using default OnlineComponentProvider"),yield jb(r,new P5))),r._onlineComponents}),Xb.apply(this,arguments)}function T5(r){return Jb.apply(this,arguments)}function Jb(){return Jb=P(function*(r){const e=yield g_(r),t=e.eventManager;return t.onListen=ITe.bind(null,e.syncEngine),t.onUnlisten=kTe.bind(null,e.syncEngine),t}),Jb.apply(this,arguments)}function VK(r){const e={};return void 0!==r.timeoutSeconds&&(e.timeoutSeconds=r.timeoutSeconds),e}const FK=new Map;function ew(r,e,t){if(!t)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function $K(r){if(!Ue.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function BK(r){if(Ue.isDocumentKey(r))throw new Te(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function __(r){if(void 0===r)return"undefined";if(null===r)return"null";if("string"==typeof r)return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if("number"==typeof r||"boolean"==typeof r)return""+r;if("object"==typeof r){if(r instanceof Array)return"an array";{const e=(t=r).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof r?"a function":at()}function An(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Te(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=__(r);throw new Te(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}class UK{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Te(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Te(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function cOe(r,e,t,n){if(!0===e&&!0===n)throw new Te(fe.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=VK(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(i){if(void 0!==i.timeoutSeconds){if(isNaN(i.timeoutSeconds))throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class N9{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new UK({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Te(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Te(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new UK(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new oSe;switch(t.type){case"firstParty":return new uSe(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Te(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=FK.get(e);t&&(Oe("ComponentProvider","Removing Datastore"),FK.delete(e),t.terminate())}(this),Promise.resolve()}}function WK(r,e,t,n={}){var i;const s=(r=An(r,N9))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&ya("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=w2.MOCK_USER;else{a=function kye(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Zg(JSON.stringify({alg:"none",type:"JWT"})),Zg(JSON.stringify(o)),""].join(".")}(n.mockUserToken,null===(i=r._app)||void 0===i?void 0:i.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Te(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new w2(l)}r._authCredentials=new aSe(new eZ(a,c))}}class zr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zr(this.firestore,e,this._key)}}class ii{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ii(this.firestore,e,this._query)}}class wc extends ii{constructor(e,t,n){super(e,t,o5(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zr(this.firestore,null,new Ue(e))}withConverter(e){return new wc(this.firestore,e,this._path)}}function lOe(r,e,...t){if(r=pr(r),ew("collection","path",e),r instanceof N9){const n=zn.fromString(e,...t);return BK(n),new wc(r,null,n)}{if(!(r instanceof zr||r instanceof wc))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(zn.fromString(e,...t));return BK(n),new wc(r.firestore,null,n)}}function qK(r,e,...t){if(r=pr(r),1===arguments.length&&(e=nZ.A()),ew("doc","path",e),r instanceof N9){const n=zn.fromString(e,...t);return $K(n),new zr(r,null,new Ue(n))}{if(!(r instanceof zr||r instanceof wc))throw new Te(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(zn.fromString(e,...t));return $K(n),new zr(r.firestore,r instanceof wc?r.converter:null,new Ue(n))}}class uOe{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new YO(this,"async_queue_retry"),this.Xc=()=>{const t=l_();t&&Oe("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};const e=l_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=l_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new o2;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}ea(){var e=this;return P(function*(){if(0!==e.Qc.length){try{yield e.Qc[0](),e.Qc.shift(),e.qo.reset()}catch(t){if(!U4(t))throw t;Oe("AsyncQueue","Operation failed with retryable error: "+t)}e.Qc.length>0&&e.qo.No(()=>e.ea())}})()}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(n=>{throw this.Wc=n,this.Hc=!1,xr("INTERNAL UNHANDLED ERROR: ",function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),o}(n)),n}).then(n=>(this.Hc=!1,n))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const i=pb.createAndSchedule(this,e,t,n,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&at()}verifyOperationInProgress(){}sa(){var e=this;return P(function*(){let t;do{t=e.Gc,yield t}while(t!==e.Gc)})()}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function tw(r){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(r)}class z1 extends N9{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new uOe,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||ZK(this),this._firestoreClient.terminate()}}function dOe(r,e){const n="string"==typeof r?r:e||"(default)",i=q8("object"==typeof r?r:sT(),"firestore").getImmediate({identifier:n});if(!i._initialized){const s=(r=>{const e=vq("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),n]:[e.substring(0,t),n]})();s&&WK(i,...s)}return i}function Yr(r){return r._firestoreClient||ZK(r),r._firestoreClient.verifyNotTerminated(),r._firestoreClient}function ZK(r){var e,t,n;const i=r._freezeSettings(),s=(a=(null===(e=r._app)||void 0===e?void 0:e.options.appId)||"",new FSe(r._databaseId,a,r._persistenceKey,(l=i).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,VK(l.experimentalLongPollingOptions),l.useFetchStreams));var a,l;r._firestoreClient=new JTe(r._authCredentials,r._appCheckCredentials,r._queue,s),null!==(t=i.cache)&&void 0!==t&&t._offlineComponentProvider&&null!==(n=i.cache)&&void 0!==n&&n._onlineComponentProvider&&(r._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}class j6{constructor(e){this._byteString=e}static fromBase64String(e){try{return new j6(a2.fromBase64String(e))}catch(t){throw new Te(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new j6(a2.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class O5{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Te(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Lr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class v_{constructor(e){this._methodName=e}}class nw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ut(this._lat,e._lat)||Ut(this._long,e._long)}}const pOe=/^__.*__$/;class gOe{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new x3(e,this.data,this.fieldMask,t,this.fieldTransforms):new l5(e,this.data,t,this.fieldTransforms)}}class XK{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new x3(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function QK(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw at()}}class C_{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===s&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new C_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.fa(e),i}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.aa({path:n,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return M_(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(QK(this.ca)&&pOe.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class mOe{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||O9(e)}ya(e,t,n,i=!1){return new C_({ca:e,methodName:t,ga:n,path:Lr.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function b5(r){const e=r._freezeSettings(),t=O9(r._databaseId);return new mOe(r._databaseId,!!e.ignoreUndefinedProperties,t)}function rw(r,e,t,n,i,s={}){const o=r.ya(s.merge||s.mergeFields?2:0,e,t,i);sw("Data must be an object, but it was:",o,n);const a=rX(n,o);let c,l;if(s.merge)c=new ks(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const f=[];for(const d of s.mergeFields){const m=k9(e,d,t);if(!o.contains(m))throw new Te(fe.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);sX(f,m)||f.push(m)}c=new ks(f),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new gOe(new ri(a),c,l)}class I9 extends v_{_toFieldTransform(e){if(2!==e.ca)throw e._a(1===e.ca?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof I9}}class iw extends v_{_toFieldTransform(e){return new u9(e.path,new a5)}isEqual(e){return e instanceof iw}}function Z6(r,e){if(iX(r=pr(r)))return sw("Unsupported field value:",e,r),rX(r,e);if(r instanceof v_)return function(t,n){if(!QK(n.ca))throw n._a(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n._a(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(n);i&&n.fieldTransforms.push(i)}(r,e),null;if(void 0===r&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.la&&4!==e.ca)throw e._a("Nested arrays are not supported");return function(t,n){const i=[];let s=0;for(const o of t){let a=Z6(o,n.wa(s));null==a&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(r,e)}return function(t,n){if(null===(t=pr(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return jZ(n.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=rr.fromDate(t);return{timestampValue:f5(n.serializer,i)}}if(t instanceof rr){const i=new rr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:f5(n.serializer,i)}}if(t instanceof nw)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof j6)return{bytesValue:pY(n.serializer,t._byteString)};if(t instanceof zr){const i=n.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw n._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:SO(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n._a(`Unsupported field value: ${__(t)}`)}(r,e)}function rX(r,e){const t={};return mZ(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):W4(r,(n,i)=>{const s=Z6(i,e.ha(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function iX(r){return!("object"!=typeof r||null===r||r instanceof Array||r instanceof Date||r instanceof rr||r instanceof nw||r instanceof j6||r instanceof zr||r instanceof v_)}function sw(r,e,t){if(!iX(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=__(t);throw e._a("an object"===n?r+" a custom object":r+" "+n)}var n}function k9(r,e,t){if((e=pr(e))instanceof O5)return e._internalPath;if("string"==typeof e)return y_(r,e);throw M_("Field path arguments must be of type string or ",r,!1,void 0,t)}const yOe=new RegExp("[~\\*/\\[\\]]");function y_(r,e,t){if(e.search(yOe)>=0)throw M_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new O5(...e.split("."))._internalPath}catch{throw M_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function M_(r,e,t,n,i){const s=n&&!n.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${n}`),o&&(c+=` in document ${i}`),c+=")"),new Te(fe.INVALID_ARGUMENT,a+r+c)}function sX(r,e){return r.some(t=>t.isEqual(e))}class ow{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new zr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new MOe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(E_("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class MOe extends ow{data(){return super.data()}}function E_(r,e){return"string"==typeof e?y_(r,e):e instanceof O5?e._internalPath:e._delegate._internalPath}function oX(r){if("L"===r.limitType&&0===r.explicitOrderBy.length)throw new Te(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class aw{}class cw extends aw{}function EOe(r,e,...t){let n=[];e instanceof aw&&n.push(e),n=n.concat(t),function(i){const s=i.filter(a=>a instanceof w5).length,o=i.filter(a=>a instanceof x9).length;if(s>1||s>0&&o>0)throw new Te(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class x9 extends cw{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new x9(e,t,n)}_apply(e){const t=this._parse(e);return uX(e._query,t),new ii(e.firestore,e.converter,hO(e._query,t))}_parse(e){const t=b5(e.firestore);return function(i,s,o,a,c,l,f){let d;if(c.isKeyField()){if("array-contains"===l||"array-contains-any"===l)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if("in"===l||"not-in"===l){lX(f,l);const m=[];for(const M of f)m.push(cX(a,i,M));d={arrayValue:{values:m}}}else d=cX(a,i,f)}else"in"!==l&&"not-in"!==l&&"array-contains-any"!==l||lX(f,l),d=function nX(r,e,t,n=!1){return Z6(t,r.ya(n?4:3,e))}(o,"where",f,"in"===l||"not-in"===l);return Sn.create(c,l,d)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function SOe(r,e,t){const n=e,i=E_("where",r);return x9._create(i,n,t)}class w5 extends aw{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new w5(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return 1===t.length?t[0]:a1.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(n,i){let s=n;const o=i.getFlattenedFilters();for(const a of o)uX(s,a),s=hO(s,a)}(e._query,t),new ii(e.firestore,e.converter,hO(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class lw extends cw{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new lw(e,t)}_apply(e){const t=function(n,i,s){if(null!==n.startAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new i5(i,s);return function(a,c){if(null===fO(a)){const l=$m(a);null!==l&&fX(0,l,c.field)}}(n,o),o}(e._query,this._field,this._direction);return new ii(e.firestore,e.converter,function(n,i){const s=n.explicitOrderBy.concat([i]);return new I3(n.path,n.collectionGroup,s,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}function POe(r,e="asc"){const t=e,n=E_("orderBy",r);return lw._create(n,t)}class S_ extends cw{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new S_(e,t,n)}_apply(e){return new ii(e.firestore,e.converter,Bm(e._query,this._limit,this._limitType))}}function TOe(r){return function GK(r,e){if(e<=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}("limit",r),S_._create("limit",r,"F")}function cX(r,e,t){if("string"==typeof(t=pr(t))){if(""===t)throw new Te(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dO(e)&&-1!==t.indexOf("/"))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(zn.fromString(t));if(!Ue.isDocumentKey(n))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return R6(r,new Ue(n))}if(t instanceof zr)return R6(r,t._key);throw new Te(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${__(t)}.`)}function lX(r,e){if(!Array.isArray(r)||0===r.length)throw new Te(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uX(r,e){if(e.isInequality()){const n=$m(r),i=e.field;if(null!==n&&!n.isEqual(i))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${i.toString()}'`);const s=fO(r);null!==s&&fX(0,i,s)}const t=function(n,i){for(const s of n)for(const o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(n){switch(n){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new Te(fe.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function fX(r,e,t){if(!t.isEqual(e))throw new Te(fe.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class OOe{convertValue(e,t="none"){switch(Z4(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _r(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(A3(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw at()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return W4(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new nw(_r(e.latitude),_r(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Rm(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(t9(e));default:return null}}convertTimestamp(e){const t=q4(e);return new rr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=zn.fromString(e);mt(PY(n));const i=new L6(n.get(1),n.get(3)),s=new Ue(n.popFirst(5));return i.isEqual(t)||xr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function uw(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class Y6{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class N5 extends ow{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new O_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(E_("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class O_ extends N5{data(e={}){return super.data(e)}}class A5{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Y6(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new O_(this._firestore,this._userDataWriter,n.key,n,new Y6(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,i){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(o=>({type:"added",doc:new O_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Y6(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:s++}))}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(o=>i||3!==o.type).map(o=>{const a=new O_(n._firestore,n._userDataWriter,o.doc.key,o.doc,new Y6(n._snapshot.mutatedKeys.has(o.doc.key),n._snapshot.fromCache),n.query.converter);let c=-1,l=-1;return 0!==o.type&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),1!==o.type&&(s=s.add(o.doc),l=s.indexOf(o.doc.key)),{type:wOe(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function wOe(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at()}}function NOe(r){r=An(r,zr);const e=An(r.firestore,z1);return function DK(r,e,t={}){const n=new o2;return r.asyncQueue.enqueueAndForget(P(function*(){return function(i,s,o,a,c){const l=new h_({next:d=>{s.enqueueAndForget(()=>_b(i,f));const m=d.docs.has(o);!m&&d.fromCache?c.reject(new Te(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&a&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new yb(o5(o.path),l,{includeMetadataChanges:!0,Ku:!0});return gb(i,f)}(yield T5(r),r.asyncQueue,e,t,n)})),n.promise}(Yr(e),r._key).then(t=>fw(e,r,t))}class rl extends OOe{constructor(e){super(),this.firestore=e}convertBytes(e){return new j6(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new zr(this.firestore,null,t)}}function AOe(r){r=An(r,ii);const e=An(r.firestore,z1),t=Yr(e),n=new rl(e);return oX(r._query),function HK(r,e,t={}){const n=new o2;return r.asyncQueue.enqueueAndForget(P(function*(){return function(i,s,o,a,c){const l=new h_({next:d=>{s.enqueueAndForget(()=>_b(i,f)),d.fromCache&&"server"===a.source?c.reject(new Te(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new yb(o,l,{includeMetadataChanges:!0,Ku:!0});return gb(i,f)}(yield T5(r),r.asyncQueue,e,t,n)})),n.promise}(t,r._query).then(i=>new A5(e,n,r,i))}function IOe(r,e,t){r=An(r,zr);const n=An(r.firestore,z1),i=uw(r.converter,e,t);return L9(n,[rw(b5(n),"setDoc",r._key,i,null!==r.converter,t).toMutation(r._key,Z1.none())])}function kOe(r,e,t,...n){r=An(r,zr);const i=An(r.firestore,z1),s=b5(i);let o;return o="string"==typeof(e=pr(e))||e instanceof O5?function tX(r,e,t,n,i,s){const o=r.ya(1,e,t),a=[k9(e,n,t)],c=[i];if(s.length%2!=0)throw new Te(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(k9(e,s[m])),c.push(s[m+1]);const l=[],f=ri.empty();for(let m=a.length-1;m>=0;--m)if(!sX(l,a[m])){const M=a[m];let w=c[m];w=pr(w);const L=o.da(M);if(w instanceof I9)l.push(M);else{const z=Z6(w,L);null!=z&&(l.push(M),f.set(M,z))}}const d=new ks(l);return new XK(f,d,o.fieldTransforms)}(s,"updateDoc",r._key,e,t,n):function eX(r,e,t,n){const i=r.ya(1,e,t);sw("Data must be an object, but it was:",i,n);const s=[],o=ri.empty();W4(n,(c,l)=>{const f=y_(e,c,t);l=pr(l);const d=i.da(f);if(l instanceof I9)s.push(f);else{const m=Z6(l,d);null!=m&&(s.push(f),o.set(f,m))}});const a=new ks(s);return new XK(o,a,i.fieldTransforms)}(s,"updateDoc",r._key,e),L9(i,[o.toMutation(r._key,Z1.exists(!0))])}function xOe(r){return L9(An(r.firestore,z1),[new u5(r._key,Z1.none())])}function LOe(r,e){const t=An(r.firestore,z1),n=qK(r),i=uw(r.converter,e);return L9(t,[rw(b5(r.firestore),"addDoc",n._key,i,null!==r.converter,{}).toMutation(n._key,Z1.exists(!1))]).then(()=>n)}function ROe(r,...e){var t,n,i;r=pr(r);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||tw(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(tw(e[o])){const d=e[o];e[o]=null===(t=d.next)||void 0===t?void 0:t.bind(d),e[o+1]=null===(n=d.error)||void 0===n?void 0:n.bind(d),e[o+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}let c,l,f;if(r instanceof zr)l=An(r.firestore,z1),f=o5(r._key.path),c={next:d=>{e[o]&&e[o](fw(l,r,d))},error:e[o+1],complete:e[o+2]};else{const d=An(r,ii);l=An(d.firestore,z1),f=d._query;const m=new rl(l);c={next:M=>{e[o]&&e[o](new A5(l,m,d,M))},error:e[o+1],complete:e[o+2]},oX(r._query)}return function(d,m,M,w){const L=new h_(w),z=new yb(m,L,M);return d.asyncQueue.enqueueAndForget(P(function*(){return gb(yield T5(d),z)})),()=>{L.Dc(),d.asyncQueue.enqueueAndForget(P(function*(){return _b(yield T5(d),z)}))}}(Yr(l),f,a,c)}function L9(r,e){return function(t,n){const i=new o2;return t.asyncQueue.enqueueAndForget(P(function*(){return function xTe(r,e,t){return Tb.apply(this,arguments)}(yield function Qb(r){return g_(r).then(e=>e.syncEngine)}(t),n,i)})),i.promise}(Yr(r),e)}function fw(r,e,t){const n=t.docs.get(e._key),i=new rl(r);return new N5(r,i,e._key,n,new Y6(t.hasPendingWrites,t.fromCache),e.converter)}function Nc(){return new iw("serverTimestamp")}function pX(r,e){if(null!=r&&null!=e&&"object"==typeof r){if(null!=r.equals)return r.equals(e);{const t=r,n=e;for(const i of Object.keys(t)){if(!(i in n))return!1;if(!1===pX(t[i],n[i]))return!1}return!0}}return r===e}function dw(r){return null==r||function jOe(r){return"object"==typeof r&&null!=r&&null!=r.equals}(r)||function kLe(r){return"string"==typeof r||"number"==typeof r||"boolean"==typeof r||null===r}(r)||function ZOe(r){if("object"==typeof r){for(const e in r)if(null!=r[e]&&!1===dw(r[e]))return!1;return null!=r&&r.constructor.prototype===Object.prototype}return!1}(r)}function Ro(r,e){if(dw(r)&&dw(e))return pX(r,e);throw new Error(`Comparing non comparable objects: ${r.constructor.name} and ${e.constructor.name}`)}!function(r,e=!0){e5=b6,ss(new wi("firestore",(t,{instanceIdentifier:n,options:i})=>{const s=t.getProvider("app").getImmediate(),o=new z1(new cSe(t.getProvider("auth-internal")),new fSe(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Te(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new L6(a.options.projectId,c)}(s,n),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),gr(Jj,"3.13.0",r),gr(Jj,"3.13.0","esm2017")}();class Ie{static fromFunctions(e,t){return new class extends Ie{encode(n){return e(n)}decode(n){return t(n)}}}static identity(){function e(t){return t}return Ie.fromFunctions(e,e)}static constant(e,t){return new class extends Ie{encode(n){return e}decode(n){return t}}}static tuple(e,t,n){return new class extends Ie{encode(i){const s=t(i),o={};return Object.keys(s).forEach(a=>{o[a]=e[a].encode(s[a])}),o}decode(i){const s={};return Object.keys(e).reverse().forEach(o=>{s[o]=e[o].decode(i[o])}),n(Object.values(s))}}}static disjunction(e,t){return K.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends Ie{encode(n){let i=0;for(const s of e){if(!0===s(n))return{type:i,encoded:t[i].encode(n)};i++}}decode(n){const i=K.getNonNullable(n).type,s=K.getNonNullable(n).encoded;return t[i].decode(s)}}}static list(e){return new class extends Ie{encode(t){return t.map(n=>{const i=e.encode(n);return K.assert(!1===Array.isArray(i),"This encoder should not encode as array"),i})}decode(t){return t.map(e.decode)}}}}class g{static of(e){return new g(e)}static ofNullable(e){return null==e?g.empty():g.of(e)}static empty(){return new g(null)}static getEncoder(e){return new class extends Ie{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?g.empty():g.of(e.decode(t))}}}constructor(e){u(this,"value",void 0),this.value=e}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&Ro(this.value,e.value)}equalsValue(e){return this.equals(g.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?g.of(e(this.get())):g.empty()}}class se{static success(e){return new YOe(e)}static failure(e){return new KOe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&Ro(this.get(),e.get())}}class YOe extends se{constructor(e){super(),u(this,"value",void 0),u(this,"__nominal",void 0),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return g.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class KOe extends se{constructor(e){super(),u(this,"reason",void 0),u(this,"__nominal",void 0),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return g.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return se.failure(this.reason)}}var b;!function(r){r.SUCCESS=se.success(void 0),r.ofFallible=function e(n){return n.isSuccess()?r.SUCCESS:r.failure(n.getReason())},r.failure=function t(n){return se.failure(n)}}(b||(b={})),gr("firebase","9.23.0","app");const JOe=(r,e)=>e.some(t=>r instanceof t);let gX,mX;const _X=new WeakMap,hw=new WeakMap,vX=new WeakMap,pw=new WeakMap,gw=new WeakMap;let mw={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return hw.get(r);if("objectStoreNames"===e)return r.objectStoreNames||vX.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return il(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function obe(r){return"function"==typeof r?function sbe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function tbe(){return mX||(mX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(_w(this),e),il(_X.get(this))}:function(...e){return il(r.apply(_w(this),e))}:function(e,...t){const n=r.call(_w(this),e,...t);return vX.set(n,e.sort?e.sort():[e]),il(n)}}(r):(r instanceof IDBTransaction&&function rbe(r){if(hw.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});hw.set(r,e)}(r),JOe(r,function ebe(){return gX||(gX=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,mw):r)}function il(r){if(r instanceof IDBRequest)return function nbe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(il(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&_X.set(t,r)}).catch(()=>{}),gw.set(e,r),e}(r);if(pw.has(r))return pw.get(r);const e=obe(r);return e!==r&&(pw.set(r,e),gw.set(e,r)),e}const _w=r=>gw.get(r),cbe=["get","getKey","getAll","getAllKeys","count"],lbe=["put","add","delete","clear"],vw=new Map;function CX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(vw.get(e))return vw.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=lbe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!cbe.includes(t))return;const s=function(){var o=P(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return vw.set(e,s),s}!function ibe(r){mw=r(mw)}(r=>({...r,get:(e,t,n)=>CX(e,t)||r.get(e,t,n),has:(e,t)=>!!CX(e,t)||r.has(e,t)}));const yX="@firebase/installations",Cw="0.6.4",MX=1e4,EX=`w:${Cw}`,SX="FIS_v2",ube="https://firebaseinstallations.googleapis.com/v1",fbe=36e5,z3=new yc("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function PX(r){return r instanceof xo&&r.code.includes("request-failed")}function yw({projectId:r}){return`${ube}/projects/${r}/installations`}function TX(r){return{token:r.token,requestStatus:2,expiresIn:gbe(r.expiresIn),creationTime:Date.now()}}function Mw(r,e){return Ew.apply(this,arguments)}function Ew(){return Ew=P(function*(r,e){const n=(yield e.json()).error;return z3.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}),Ew.apply(this,arguments)}function OX({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Sw(r){return Pw.apply(this,arguments)}function Pw(){return Pw=P(function*(r){const e=yield r();return e.status>=500&&e.status<600?r():e}),Pw.apply(this,arguments)}function gbe(r){return Number(r.replace("s","000"))}function Tw(){return Tw=P(function*({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=yw(r),i=OX(r),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({fid:t,authVersion:SX,appId:r.appId,sdkVersion:EX})},c=yield Sw(()=>fetch(n,a));if(c.ok){const l=yield c.json();return{fid:l.fid||t,registrationStatus:2,refreshToken:l.refreshToken,authToken:TX(l.authToken)}}throw yield Mw("Create Installation",c)}),Tw.apply(this,arguments)}function wX(r){return new Promise(e=>{setTimeout(e,r)})}const Cbe=/^[cdef][\w-]{21}$/,Ow="";function ybe(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=function Mbe(r){return function vbe(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}(r).substr(0,22)}(r);return Cbe.test(t)?t:Ow}catch{return Ow}}function I5(r){return`${r.appName}!${r.appId}`}const k5=new Map;function NX(r,e){const t=I5(r);AX(t,e),function Pbe(r,e){const t=function IX(){return!K6&&"BroadcastChannel"in self&&(K6=new BroadcastChannel("[Firebase] FID Change"),K6.onmessage=r=>{AX(r.data.key,r.data.fid)}),K6}();t&&t.postMessage({key:r,fid:e}),function kX(){0===k5.size&&K6&&(K6.close(),K6=null)}()}(t,e)}function AX(r,e){const t=k5.get(r);if(t)for(const n of t)n(e)}let K6=null;const Tbe="firebase-installations-database",Obe=1,X6="firebase-installations-store";let bw=null;function ww(){return bw||(bw=function abe(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=il(o);return n&&o.addEventListener("upgradeneeded",c=>{n(il(o.result),c.oldVersion,c.newVersion,il(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}(Tbe,Obe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(X6)}})),bw}function w_(r,e){return Nw.apply(this,arguments)}function Nw(){return Nw=P(function*(r,e){const t=I5(r),i=(yield ww()).transaction(X6,"readwrite"),s=i.objectStore(X6),o=yield s.get(t);return yield s.put(e,t),yield i.done,(!o||o.fid!==e.fid)&&NX(r,e.fid),e}),Nw.apply(this,arguments)}function Aw(r){return Iw.apply(this,arguments)}function Iw(){return Iw=P(function*(r){const e=I5(r),n=(yield ww()).transaction(X6,"readwrite");yield n.objectStore(X6).delete(e),yield n.done}),Iw.apply(this,arguments)}function R9(r,e){return kw.apply(this,arguments)}function kw(){return kw=P(function*(r,e){const t=I5(r),i=(yield ww()).transaction(X6,"readwrite"),s=i.objectStore(X6),o=yield s.get(t),a=e(o);return void 0===a?yield s.delete(t):yield s.put(a,t),yield i.done,a&&(!o||o.fid!==a.fid)&&NX(r,a.fid),a}),kw.apply(this,arguments)}function xw(r){return Lw.apply(this,arguments)}function Lw(){return Lw=P(function*(r){let e;const t=yield R9(r.appConfig,n=>{const i=function bbe(r){return LX(r||{fid:ybe(),registrationStatus:0})}(n),s=function wbe(r,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(z3.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=function Nbe(r,e){return Rw.apply(this,arguments)}(r,t);return{installationEntry:t,registrationPromise:n}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Abe(r)}:{installationEntry:e}}(r,i);return e=s.registrationPromise,s.installationEntry});return t.fid===Ow?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),Lw.apply(this,arguments)}function Rw(){return Rw=P(function*(r,e){try{const t=yield function _be(r,e){return Tw.apply(this,arguments)}(r,e);return w_(r.appConfig,t)}catch(t){throw PX(t)&&409===t.customData.serverCode?yield Aw(r.appConfig):yield w_(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}),Rw.apply(this,arguments)}function Abe(r){return zw.apply(this,arguments)}function zw(){return zw=P(function*(r){let e=yield xX(r.appConfig);for(;1===e.registrationStatus;)yield wX(100),e=yield xX(r.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:n}=yield xw(r);return n||t}return e}),zw.apply(this,arguments)}function xX(r){return R9(r,e=>{if(!e)throw z3.create("installation-not-found");return LX(e)})}function LX(r){return function Ibe(r){return 1===r.registrationStatus&&r.registrationTime+MX<Date.now()}(r)?{fid:r.fid,registrationStatus:0}:r}function Dw(){return Dw=P(function*({appConfig:r,heartbeatServiceProvider:e},t){const n=function xbe(r,{fid:e}){return`${yw(r)}/${e}/authTokens:generate`}(r,t),i=function bX(r,{refreshToken:e}){const t=OX(r);return t.append("Authorization",function mbe(r){return`${SX} ${r}`}(e)),t}(r,t),s=e.getImmediate({optional:!0});if(s){const l=yield s.getHeartbeatsHeader();l&&i.append("x-firebase-client",l)}const a={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:EX,appId:r.appId}})},c=yield Sw(()=>fetch(n,a));if(c.ok)return TX(yield c.json());throw yield Mw("Generate Auth Token",c)}),Dw.apply(this,arguments)}function Hw(r){return Vw.apply(this,arguments)}function Vw(){return Vw=P(function*(r,e=!1){let t;const n=yield R9(r.appConfig,s=>{if(!zX(s))throw z3.create("not-registered");const o=s.authToken;if(!e&&function zbe(r){return 2===r.requestStatus&&!function Dbe(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+fbe}(r)}(o))return s;if(1===o.requestStatus)return t=function Lbe(r,e){return Fw.apply(this,arguments)}(r,e),s;{if(!navigator.onLine)throw z3.create("app-offline");const a=function Hbe(r){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:e})}(s);return t=function Rbe(r,e){return $w.apply(this,arguments)}(r,a),a}});return t?yield t:n.authToken}),Vw.apply(this,arguments)}function Fw(){return Fw=P(function*(r,e){let t=yield RX(r.appConfig);for(;1===t.authToken.requestStatus;)yield wX(100),t=yield RX(r.appConfig);const n=t.authToken;return 0===n.requestStatus?Hw(r,e):n}),Fw.apply(this,arguments)}function RX(r){return R9(r,e=>{if(!zX(e))throw z3.create("not-registered");return function Vbe(r){return 1===r.requestStatus&&r.requestTime+MX<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function $w(){return $w=P(function*(r,e){try{const t=yield function kbe(r,e){return Dw.apply(this,arguments)}(r,e),n=Object.assign(Object.assign({},e),{authToken:t});return yield w_(r.appConfig,n),t}catch(t){if(!PX(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield w_(r.appConfig,n)}else yield Aw(r.appConfig);throw t}}),$w.apply(this,arguments)}function zX(r){return void 0!==r&&2===r.registrationStatus}function Bw(){return Bw=P(function*(r){const e=r,{installationEntry:t,registrationPromise:n}=yield xw(e);return n?n.catch(console.error):Hw(e).catch(console.error),t.fid}),Bw.apply(this,arguments)}function Gw(){return Gw=P(function*(r,e=!1){const t=r;return yield function Bbe(r){return Uw.apply(this,arguments)}(t),(yield Hw(t,e)).token}),Gw.apply(this,arguments)}function Uw(){return Uw=P(function*(r){const{registrationPromise:e}=yield xw(r);e&&(yield e)}),Uw.apply(this,arguments)}function jw(r){return z3.create("missing-app-config-values",{valueName:r})}const DX="installations",jbe=r=>{const e=r.getProvider("app").getImmediate(),t=function Wbe(r){if(!r||!r.options)throw jw("App Configuration");if(!r.name)throw jw("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw jw(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:q8(e,"heartbeat"),_delete:()=>Promise.resolve()}},Zbe=r=>{const t=q8(r.getProvider("app").getImmediate(),DX).getImmediate();return{getId:()=>function Fbe(r){return Bw.apply(this,arguments)}(t),getToken:i=>function $be(r){return Gw.apply(this,arguments)}(t,i)}};(function Ybe(){ss(new wi(DX,jbe,"PUBLIC")),ss(new wi("installations-internal",Zbe,"PRIVATE"))})(),gr(yX,Cw),gr(yX,Cw,"esm2017");const Zw="@firebase/remote-config",Ls=new yc("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class owe{constructor(e,t,n,i){this.client=e,this.storage=t,this.storageCache=n,this.logger=i}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,i=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${i}.`),i}fetch(e){var t=this;return P(function*(){const[n,i]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(i&&t.isCachedDataFresh(e.cacheMaxAgeMillis,n))return i;e.eTag=i&&i.eTag;const s=yield t.client.fetch(e),o=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&o.push(t.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(o),s})()}}function awe(r=navigator){return r.languages&&r.languages[0]||r.language}class cwe{constructor(e,t,n,i,s,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=i,this.apiKey=s,this.appId=o}fetch(e){var t=this;return P(function*(){const[n,i]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),o=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},c={sdk_version:t.sdkVersion,app_instance_id:n,app_instance_id_token:i,app_id:t.appId,language_code:awe()},l={method:"POST",headers:a,body:JSON.stringify(c)},f=fetch(o,l),d=new Promise(($,B)=>{e.signal.addEventListener(()=>{const de=new Error("The operation was aborted.");de.name="AbortError",B(de)})});let m;try{yield Promise.race([f,d]),m=yield f}catch($){let B="fetch-client-network";throw"AbortError"===$?.name&&(B="fetch-timeout"),Ls.create(B,{originalErrorMessage:$?.message})}let M=m.status;const w=m.headers.get("ETag")||void 0;let L,z;if(200===m.status){let $;try{$=yield m.json()}catch(B){throw Ls.create("fetch-client-parse",{originalErrorMessage:B?.message})}L=$.entries,z=$.state}if("INSTANCE_STATE_UNSPECIFIED"===z?M=500:"NO_CHANGE"===z?M=304:("NO_TEMPLATE"===z||"EMPTY_CONFIG"===z)&&(L={}),304!==M&&200!==M)throw Ls.create("fetch-status",{httpStatus:M});return{status:M,eTag:w,config:L}})()}}class fwe{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return P(function*(){const n=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,n)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){var i=this;return P(function*(){yield function lwe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(Ls.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const s=yield i.client.fetch(e);return yield i.storage.deleteThrottleMetadata(),s}catch(s){if(!function uwe(r){if(!(r instanceof xo&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s))throw s;const o={throttleEndTimeMillis:Date.now()+KP(n),backoffCount:n+1};return yield i.storage.setThrottleMetadata(o),i.attemptFetch(e,o)}})()}}class pwe{constructor(e,t,n,i,s){this.app=e,this._client=t,this._storageCache=n,this._storage=i,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function A_(r,e){const t=r.target.error||void 0;return Ls.create(e,{originalErrorMessage:t&&t?.message})}const Q6="app_namespace_store";class vwe{constructor(e,t,n,i=function _we(){return new Promise((r,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=n=>{e(A_(n,"storage-open"))},t.onsuccess=n=>{r(n.target.result)},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(Q6,{keyPath:"compositeKey"})}}catch(t){e(Ls.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=i}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return P(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([Q6],"readonly").objectStore(Q6),c=t.createCompositeKey(e);try{const l=a.get(c);l.onerror=f=>{s(A_(f,"storage-get"))},l.onsuccess=f=>{const d=f.target.result;i(d?d.value:void 0)}}catch(l){s(Ls.create("storage-get",{originalErrorMessage:l?.message}))}})})()}set(e,t){var n=this;return P(function*(){const i=yield n.openDbPromise;return new Promise((s,o)=>{const c=i.transaction([Q6],"readwrite").objectStore(Q6),l=n.createCompositeKey(e);try{const f=c.put({compositeKey:l,value:t});f.onerror=d=>{o(A_(d,"storage-set"))},f.onsuccess=()=>{s()}}catch(f){o(Ls.create("storage-set",{originalErrorMessage:f?.message}))}})})()}delete(e){var t=this;return P(function*(){const n=yield t.openDbPromise;return new Promise((i,s)=>{const a=n.transaction([Q6],"readwrite").objectStore(Q6),c=t.createCompositeKey(e);try{const l=a.delete(c);l.onerror=f=>{s(A_(f,"storage-delete"))},l.onsuccess=()=>{i()}}catch(l){s(Ls.create("storage-delete",{originalErrorMessage:l?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class Cwe{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return P(function*(){const t=e.storage.getLastFetchStatus(),n=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),s=yield t;s&&(e.lastFetchStatus=s);const o=yield n;o&&(e.lastSuccessfulFetchTimestampMillis=o);const a=yield i;a&&(e.activeConfig=a)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function Mwe(){return Jw.apply(this,arguments)}function Jw(){return(Jw=P(function*(){if(!S6())return!1;try{return yield Sf()}catch{return!1}})).apply(this,arguments)}!function ywe(){ss(new wi("remote-config",function r(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Ls.create("registration-window");if(!S6())throw Ls.create("indexed-db-unavailable");const{projectId:s,apiKey:o,appId:a}=n.options;if(!s)throw Ls.create("registration-project-id");if(!o)throw Ls.create("registration-api-key");if(!a)throw Ls.create("registration-app-id");const c=new vwe(a,n.name,t=t||"firebase"),l=new Cwe(c),f=new W8(Zw);f.logLevel=Gn.ERROR;const d=new cwe(i,b6,t,s,o,a),m=new fwe(d,c),M=new owe(m,c,l,f),w=new pwe(n,M,l,c,f);return function rwe(r){const e=pr(r);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(w),w},"PUBLIC").setMultipleInstances(!0)),gr(Zw,"0.4.4"),gr(Zw,"0.4.4","esm2017")}();const Ewe=(r,e)=>e.some(t=>r instanceof t);let $X,BX;const GX=new WeakMap,eN=new WeakMap,UX=new WeakMap,tN=new WeakMap,nN=new WeakMap;let rN={get(r,e,t){if(r instanceof IDBTransaction){if("done"===e)return eN.get(r);if("objectStoreNames"===e)return r.objectStoreNames||UX.get(r);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return D3(r[e])},set:(r,e,t)=>(r[e]=t,!0),has:(r,e)=>r instanceof IDBTransaction&&("done"===e||"store"===e)||e in r};function Nwe(r){return"function"==typeof r?function wwe(r){return r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Pwe(){return BX||(BX=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(r)?function(...e){return r.apply(iN(this),e),D3(GX.get(this))}:function(...e){return D3(r.apply(iN(this),e))}:function(e,...t){const n=r.call(iN(this),e,...t);return UX.set(n,e.sort?e.sort():[e]),D3(n)}}(r):(r instanceof IDBTransaction&&function Owe(r){if(eN.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});eN.set(r,e)}(r),Ewe(r,function Swe(){return $X||($X=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(r,rN):r)}function D3(r){if(r instanceof IDBRequest)return function Twe(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(D3(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&GX.set(t,r)}).catch(()=>{}),nN.set(e,r),e}(r);if(tN.has(r))return tN.get(r);const e=Nwe(r);return e!==r&&(tN.set(r,e),nN.set(e,r)),e}const iN=r=>nN.get(r);function WX(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),a=D3(o);return n&&o.addEventListener("upgradeneeded",c=>{n(D3(o.result),c.oldVersion,c.newVersion,D3(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}function sN(r,{blocked:e}={}){const t=indexedDB.deleteDatabase(r);return e&&t.addEventListener("blocked",()=>e()),D3(t).then(()=>{})}const Awe=["get","getKey","getAll","getAllKeys","count"],Iwe=["put","add","delete","clear"],oN=new Map;function qX(r,e){if(!(r instanceof IDBDatabase)||e in r||"string"!=typeof e)return;if(oN.get(e))return oN.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Iwe.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!Awe.includes(t))return;const s=function(){var o=P(function*(a,...c){const l=this.transaction(a,i?"readwrite":"readonly");let f=l.store;return n&&(f=f.index(c.shift())),(yield Promise.all([f[t](...c),i&&l.done]))[0]});return function(c){return o.apply(this,arguments)}}();return oN.set(e,s),s}!function bwe(r){rN=r(rN)}(r=>({...r,get:(e,t,n)=>qX(e,t)||r.get(e,t,n),has:(e,t)=>!!qX(e,t)||r.has(e,t)}));const kwe="/firebase-messaging-sw.js",xwe="/firebase-cloud-messaging-push-scope",jX="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Lwe="https://fcmregistrations.googleapis.com/v1",ZX="google.c.a.c_id",Rwe="google.c.a.c_l",zwe="google.c.a.ts";var I_=function(r){return r.PUSH_RECEIVED="push-received",r.NOTIFICATION_CLICKED="notification-clicked",r}(I_||{});function H3(r){const e=new Uint8Array(r);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Vwe(r){const t=(r+"=".repeat((4-r.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),i=new Uint8Array(n.length);for(let s=0;s<n.length;++s)i[s]=n.charCodeAt(s);return i}const aN="fcm_token_details_db",Fwe=5,YX="fcm_token_object_Store";function cN(){return cN=P(function*(r){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(aN))return null;let e=null;return(yield WX(aN,Fwe,{upgrade:(n=P(function*(i,s,o,a){var c;if(s<2||!i.objectStoreNames.contains(YX))return;const l=a.objectStore(YX),f=yield l.index("fcmSenderId").get(r);if(yield l.clear(),f)if(2===s){const d=f;if(!d.auth||!d.p256dh||!d.endpoint)return;e={token:d.fcmToken,createTime:null!==(c=d.createTime)&&void 0!==c?c:Date.now(),subscriptionOptions:{auth:d.auth,p256dh:d.p256dh,endpoint:d.endpoint,swScope:d.swScope,vapidKey:"string"==typeof d.vapidKey?d.vapidKey:H3(d.vapidKey)}}}else if(3===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:H3(d.auth),p256dh:H3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:H3(d.vapidKey)}}}else if(4===s){const d=f;e={token:d.fcmToken,createTime:d.createTime,subscriptionOptions:{auth:H3(d.auth),p256dh:H3(d.p256dh),endpoint:d.endpoint,swScope:d.swScope,vapidKey:H3(d.vapidKey)}}}}),function(s,o,a,c){return n.apply(this,arguments)})})).close(),yield sN(aN),yield sN("fcm_vapid_details_db"),yield sN("undefined"),function Bwe(r){if(!r||!r.subscriptionOptions)return!1;const{subscriptionOptions:e}=r;return"number"==typeof r.createTime&&r.createTime>0&&"string"==typeof r.token&&r.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var n}),cN.apply(this,arguments)}const Gwe="firebase-messaging-database",Uwe=1,J6="firebase-messaging-store";let lN=null;function uN(){return lN||(lN=WX(Gwe,Uwe,{upgrade:(r,e)=>{0===e&&r.createObjectStore(J6)}})),lN}function KX(r){return fN.apply(this,arguments)}function fN(){return fN=P(function*(r){const e=gN(r),n=yield(yield uN()).transaction(J6).objectStore(J6).get(e);if(n)return n;{const i=yield function $we(r){return cN.apply(this,arguments)}(r.appConfig.senderId);if(i)return yield dN(r,i),i}}),fN.apply(this,arguments)}function dN(r,e){return hN.apply(this,arguments)}function hN(){return hN=P(function*(r,e){const t=gN(r),i=(yield uN()).transaction(J6,"readwrite");return yield i.objectStore(J6).put(e,t),yield i.done,e}),hN.apply(this,arguments)}function pN(){return pN=P(function*(r){const e=gN(r),n=(yield uN()).transaction(J6,"readwrite");yield n.objectStore(J6).delete(e),yield n.done}),pN.apply(this,arguments)}function gN({appConfig:r}){return r.appId}const si=new yc("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function jwe(r,e){return mN.apply(this,arguments)}function mN(){return mN=P(function*(r,e){const t=yield yN(r),n=QX(e),i={method:"POST",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(CN(r.appConfig),i)).json()}catch(o){throw si.create("token-subscribe-failed",{errorInfo:o?.toString()})}if(s.error)throw si.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw si.create("token-subscribe-no-token");return s.token}),mN.apply(this,arguments)}function _N(){return _N=P(function*(r,e){const t=yield yN(r),n=QX(e.subscriptionOptions),i={method:"PATCH",headers:t,body:JSON.stringify(n)};let s;try{s=yield(yield fetch(`${CN(r.appConfig)}/${e.token}`,i)).json()}catch(o){throw si.create("token-update-failed",{errorInfo:o?.toString()})}if(s.error)throw si.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw si.create("token-update-no-token");return s.token}),_N.apply(this,arguments)}function XX(r,e){return vN.apply(this,arguments)}function vN(){return vN=P(function*(r,e){const n={method:"DELETE",headers:yield yN(r)};try{const s=yield(yield fetch(`${CN(r.appConfig)}/${e}`,n)).json();if(s.error)throw si.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(i){throw si.create("token-unsubscribe-failed",{errorInfo:i?.toString()})}}),vN.apply(this,arguments)}function CN({projectId:r}){return`${Lwe}/projects/${r}/registrations`}function yN(r){return MN.apply(this,arguments)}function MN(){return MN=P(function*({appConfig:r,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),MN.apply(this,arguments)}function QX({p256dh:r,auth:e,endpoint:t,vapidKey:n}){const i={web:{endpoint:t,auth:e,p256dh:r}};return n!==jX&&(i.web.applicationPubKey=n),i}const Ywe=6048e5;function EN(){return EN=P(function*(r){const e=yield function Qwe(r,e){return ON.apply(this,arguments)}(r.swRegistration,r.vapidKey),t={vapidKey:r.vapidKey,swScope:r.swRegistration.scope,endpoint:e.endpoint,auth:H3(e.getKey("auth")),p256dh:H3(e.getKey("p256dh"))},n=yield KX(r.firebaseDependencies);if(n){if(function Jwe(r,e){return e.vapidKey===r.vapidKey&&e.endpoint===r.endpoint&&e.auth===r.auth&&e.p256dh===r.p256dh}(n.subscriptionOptions,t))return Date.now()>=n.createTime+Ywe?function Xwe(r,e){return PN.apply(this,arguments)}(r,{token:n.token,createTime:Date.now(),subscriptionOptions:t}):n.token;try{yield XX(r.firebaseDependencies,n.token)}catch(i){console.warn(i)}return eQ(r.firebaseDependencies,t)}return eQ(r.firebaseDependencies,t)}),EN.apply(this,arguments)}function SN(){return SN=P(function*(r){const e=yield KX(r.firebaseDependencies);e&&(yield XX(r.firebaseDependencies,e.token),yield function Wwe(r){return pN.apply(this,arguments)}(r.firebaseDependencies));const t=yield r.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),SN.apply(this,arguments)}function PN(){return PN=P(function*(r,e){try{const t=yield function Zwe(r,e){return _N.apply(this,arguments)}(r.firebaseDependencies,e),n=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield dN(r.firebaseDependencies,n),t}catch(t){throw yield function JX(r){return SN.apply(this,arguments)}(r),t}}),PN.apply(this,arguments)}function eQ(r,e){return TN.apply(this,arguments)}function TN(){return TN=P(function*(r,e){const n={token:yield jwe(r,e),createTime:Date.now(),subscriptionOptions:e};return yield dN(r,n),n.token}),TN.apply(this,arguments)}function ON(){return ON=P(function*(r,e){return(yield r.pushManager.getSubscription())||r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Vwe(e)})}),ON.apply(this,arguments)}function tQ(r){const e={from:r.from,collapseKey:r.collapse_key,messageId:r.fcmMessageId};return function eNe(r,e){if(!e.notification)return;r.notification={};const t=e.notification.title;t&&(r.notification.title=t);const n=e.notification.body;n&&(r.notification.body=n);const i=e.notification.image;i&&(r.notification.image=i);const s=e.notification.icon;s&&(r.notification.icon=s)}(e,r),function tNe(r,e){e.data&&(r.data=e.data)}(e,r),function nNe(r,e){var t,n,i,s,o;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;r.fcmOptions={};const a=null!==(i=null===(n=e.fcmOptions)||void 0===n?void 0:n.link)&&void 0!==i?i:null===(s=e.notification)||void 0===s?void 0:s.click_action;a&&(r.fcmOptions.link=a);const c=null===(o=e.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(r.fcmOptions.analyticsLabel=c)}(e,r),e}function nQ(r,e){const t=[];for(let n=0;n<r.length;n++)t.push(r.charAt(n)),n<e.length&&t.push(e.charAt(n));return t.join("")}function bN(r){return si.create("missing-app-config-values",{valueName:r})}nQ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),nQ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class sNe{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const i=function iNe(r){if(!r||!r.options)throw bN("App Configuration Object");if(!r.name)throw bN("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=r;for(const n of e)if(!t[n])throw bN(n);return{appName:r.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:i,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}function wN(){return wN=P(function*(r){try{r.swRegistration=yield navigator.serviceWorker.register(kwe,{scope:xwe}),r.swRegistration.update().catch(()=>{})}catch(e){throw si.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}}),wN.apply(this,arguments)}function NN(){return NN=P(function*(r,e){if(!e&&!r.swRegistration&&(yield function rQ(r){return wN.apply(this,arguments)}(r)),e||!r.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw si.create("invalid-sw-registration");r.swRegistration=e}}),NN.apply(this,arguments)}function AN(){return AN=P(function*(r,e){e?r.vapidKey=e:r.vapidKey||(r.vapidKey=jX)}),AN.apply(this,arguments)}function IN(){return IN=P(function*(r,e){if(!navigator)throw si.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw si.create("permission-blocked");return yield function aNe(r,e){return AN.apply(this,arguments)}(r,e?.vapidKey),yield function oNe(r,e){return NN.apply(this,arguments)}(r,e?.serviceWorkerRegistration),function Kwe(r){return EN.apply(this,arguments)}(r)}),IN.apply(this,arguments)}function kN(){return kN=P(function*(r,e,t){const n=function lNe(r){switch(r){case I_.NOTIFICATION_CLICKED:return"notification_open";case I_.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield r.firebaseDependencies.analyticsProvider.get()).logEvent(n,{message_id:t[ZX],message_name:t[Rwe],message_time:t[zwe],message_device_time:Math.floor(Date.now()/1e3)})}),kN.apply(this,arguments)}function xN(){return xN=P(function*(r,e){const t=e.data;if(!t.isFirebaseMessaging)return;r.onMessageHandler&&t.messageType===I_.PUSH_RECEIVED&&("function"==typeof r.onMessageHandler?r.onMessageHandler(tQ(t)):r.onMessageHandler.next(tQ(t)));const n=t.data;(function rNe(r){return"object"==typeof r&&!!r&&ZX in r})(n)&&"1"===n["google.c.a.e"]&&(yield function cNe(r,e,t){return kN.apply(this,arguments)}(r,t.messageType,n))}),xN.apply(this,arguments)}const sQ="@firebase/messaging",fNe=r=>{const e=new sNe(r.getProvider("app").getImmediate(),r.getProvider("installations-internal").getImmediate(),r.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function uNe(r,e){return xN.apply(this,arguments)}(e,t)),e},dNe=r=>{const e=r.getProvider("messaging").getImmediate();return{getToken:n=>function iQ(r,e){return IN.apply(this,arguments)}(e,n)}};function aQ(){return LN.apply(this,arguments)}function LN(){return(LN=P(function*(){try{yield Sf()}catch{return!1}return typeof window<"u"&&S6()&&jP()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function hNe(){ss(new wi("messaging",fNe,"PUBLIC")),ss(new wi("messaging-internal",dNe,"PRIVATE")),gr(sQ,"0.12.4"),gr(sQ,"0.12.4","esm2017")}();const k_="analytics",mNe="firebase_id",_Ne="origin",vNe=6e4,CNe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",DN="https://www.googletagmanager.com/gtag/js",I2=new W8("@firebase/analytics"),cs=new yc("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function MNe(r){if(!r.startsWith(DN)){const e=cs.create("invalid-gtag-resource",{gtagURL:r});return I2.warn(e.message),""}return r}function cQ(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function HN(){return HN=P(function*(r,e,t,n,i,s){const o=n[i];try{if(o)yield e[o];else{const c=(yield cQ(t)).find(l=>l.measurementId===i);c&&(yield e[c.appId])}}catch(a){I2.error(a)}r("config",i,s)}),HN.apply(this,arguments)}function VN(){return VN=P(function*(r,e,t,n,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=yield cQ(t);for(const c of o){const l=a.find(d=>d.measurementId===c),f=l&&e[l.appId];if(!f){s=[];break}s.push(f)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),r("event",n,i||{})}catch(s){I2.error(s)}}),VN.apply(this,arguments)}const ANe=30,lQ=new class kNe{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function xNe(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}function FN(){return FN=P(function*(r){var e;const{appId:t,apiKey:n}=r,i={method:"GET",headers:xNe(n)},s=CNe.replace("{app-id}",t),o=yield fetch(s,i);if(200!==o.status&&304!==o.status){let a="";try{const c=yield o.json();null!==(e=c.error)&&void 0!==e&&e.message&&(a=c.error.message)}catch{}throw cs.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}),FN.apply(this,arguments)}function $N(){return $N=P(function*(r,e=lQ,t){const{appId:n,apiKey:i,measurementId:s}=r.options;if(!n)throw cs.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:n};throw cs.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new HNe;return setTimeout(P(function*(){a.abort()}),void 0!==t?t:vNe),uQ({appId:n,apiKey:i,measurementId:s},o,a,e)}),$N.apply(this,arguments)}function uQ(r,e,t){return BN.apply(this,arguments)}function BN(){return BN=P(function*(r,{throttleEndTimeMillis:e,backoffCount:t},n,i=lQ){var s;const{appId:o,measurementId:a}=r;try{yield function zNe(r,e){return new Promise((t,n)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(t,i);r.addEventListener(()=>{clearTimeout(s),n(cs.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(n,e)}catch(c){if(a)return I2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c?.message}]`),{appId:o,measurementId:a};throw c}try{const c=yield function LNe(r){return FN.apply(this,arguments)}(r);return i.deleteThrottleMetadata(o),c}catch(c){const l=c;if(!function DNe(r){if(!(r instanceof xo&&r.customData))return!1;const e=Number(r.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(i.deleteThrottleMetadata(o),a)return I2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:o,measurementId:a};throw c}const f=503===Number(null===(s=l?.customData)||void 0===s?void 0:s.httpStatus)?KP(t,i.intervalMillis,ANe):KP(t,i.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return i.setThrottleMetadata(o,d),I2.debug(`Calling attemptFetch again in ${f} millis`),uQ(r,d,n,i)}}),BN.apply(this,arguments)}class HNe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let GN,KN;function UN(){return UN=P(function*(r,e,t,n,i){if(i&&i.global)r("event",t,n);else{const s=yield e;r("event",t,Object.assign(Object.assign({},n),{send_to:s}))}}),UN.apply(this,arguments)}function XN(){return XN=P(function*(){if(!S6())return I2.warn(cs.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Sf()}catch(r){return I2.warn(cs.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}return!0}),XN.apply(this,arguments)}function QN(){return QN=P(function*(r,e,t,n,i,s,o){var a;const c=function RNe(r){return $N.apply(this,arguments)}(r);c.then(M=>{t[M.measurementId]=M.appId,r.options.measurementId&&M.measurementId!==r.options.measurementId&&I2.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${M.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(M=>I2.error(M)),e.push(c);const l=function WNe(){return XN.apply(this,arguments)}().then(M=>{if(M)return n.getId()}),[f,d]=yield Promise.all([c,l]);(function NNe(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(DN)&&t.src.includes(r))return t;return null})(s)||function SNe(r,e){const t=function ENe(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}("firebase-js-sdk-policy",{createScriptURL:MNe}),n=document.createElement("script"),i=`${DN}?l=${r}&id=${e}`;n.src=t?t?.createScriptURL(i):i,n.async=!0,document.head.appendChild(n)}(s,f.measurementId),KN&&(i("consent","default",KN),function fQ(r){KN=r}(void 0)),i("js",new Date);const m=null!==(a=o?.config)&&void 0!==a?a:{};return m[_Ne]="firebase",m.update=!0,null!=d&&(m[mNe]=d),i("config",f.measurementId,m),GN&&(i("set",GN),function dQ(r){GN=r}(void 0)),f.measurementId}),QN.apply(this,arguments)}class jNe{constructor(e){this.app=e}_delete(){return delete Ac[this.app.options.appId],Promise.resolve()}}let Ac={},hQ=[];const pQ={};let mQ,Ic,x_="dataLayer",JN=!1;function YNe(r,e,t){!function ZNe(){const r=[];if(qP()&&r.push("This is a browser extension environment."),jP()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,i)=>`(${i+1}) ${n}`).join(" "),t=cs.create("invalid-analytics-context",{errorInfo:e});I2.warn(t.message)}}();const n=r.options.appId;if(!n)throw cs.create("no-app-id");if(!r.options.apiKey){if(!r.options.measurementId)throw cs.create("no-api-key");I2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Ac[n])throw cs.create("already-exists",{id:n});if(!JN){!function PNe(r){let e=[];Array.isArray(window[r])?e=window[r]:window[r]=e}(x_);const{wrappedGtag:s,gtagCore:o}=function wNe(r,e,t,n,i){let s=function(...o){window[n].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=function bNe(r,e,t,n){function s(){return s=P(function*(o,...a){try{if("event"===o){const[c,l]=a;yield function ONe(r,e,t,n,i){return VN.apply(this,arguments)}(r,e,t,c,l)}else if("config"===o){const[c,l]=a;yield function TNe(r,e,t,n,i,s){return HN.apply(this,arguments)}(r,e,t,n,c,l)}else if("consent"===o){const[c]=a;r("consent","update",c)}else if("get"===o){const[c,l,f]=a;r("get",c,l,f)}else if("set"===o){const[c]=a;r("set",c)}else r(o,...a)}catch(c){I2.error(c)}}),s.apply(this,arguments)}return function i(o){return s.apply(this,arguments)}}(s,r,e,t),{gtagCore:s,wrappedGtag:window[i]}}(Ac,hQ,pQ,x_,"gtag");Ic=s,mQ=o,JN=!0}return Ac[n]=function qNe(r,e,t,n,i,s,o){return QN.apply(this,arguments)}(r,hQ,pQ,e,mQ,x_,t),new jNe(r)}function XNe(){return eA.apply(this,arguments)}function eA(){return(eA=P(function*(){if(qP()||!jP()||!S6())return!1;try{return yield Sf()}catch{return!1}})).apply(this,arguments)}const _Q="@firebase/analytics";!function JNe(){ss(new wi(k_,(e,{options:t})=>YNe(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),ss(new wi("analytics-internal",function r(e){try{const t=e.getProvider(k_).getImmediate();return{logEvent:(n,i,s)=>function QNe(r,e,t,n){r=pr(r),function VNe(r,e,t,n,i){return UN.apply(this,arguments)}(Ic,Ac[r.app.options.appId],e,t,n).catch(i=>I2.error(i))}(t,n,i,s)}}catch(t){throw cs.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),gr(_Q,"0.10.0"),gr(_Q,"0.10.0","esm2017")}();class eAe extends En{constructor(e,t){super()}schedule(e,t=0){return this}}const L_={setInterval(r,e,...t){const{delegate:n}=L_;return n?.setInterval?n.setInterval(r,e,...t):setInterval(r,e,...t)},clearInterval(r){const{delegate:e}=L_;return(e?.clearInterval||clearInterval)(r)},delegate:void 0};class CQ extends eAe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return L_.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&L_.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,n=!1;try{this.work(e)}catch(s){n=!0,i=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,t3(n,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const nA={now:()=>(nA.delegate||Date).now(),delegate:void 0};class z9{constructor(e,t=z9.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}}z9.now=nA.now;class yQ extends z9{constructor(e,t=z9.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const rAe=new class nAe extends yQ{}(class tAe extends CQ{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,n=0){return null!=n&&n>0||null==n&&this.delay>0?super.requestAsyncId(e,t,n):(e.flush(this),0)}}),iAe=new yQ(CQ),R_=new f8("7.6.1"),rA="__angularfire_symbol__analyticsIsSupportedValue",iA="__angularfire_symbol__analyticsIsSupported",sA="__angularfire_symbol__remoteConfigIsSupportedValue",oA="__angularfire_symbol__remoteConfigIsSupported",aA="__angularfire_symbol__messagingIsSupportedValue",cA="__angularfire_symbol__messagingIsSupported";function uA(r,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(o=>o.app===t);if(1===s.length)return s[0]}return t.container.getProvider(r).getImmediate({optional:!0})}globalThis[iA]||(globalThis[iA]=XNe().then(r=>globalThis[rA]=r).catch(()=>globalThis[rA]=!1)),globalThis[cA]||(globalThis[cA]=aQ().then(r=>globalThis[aA]=r).catch(()=>globalThis[aA]=!1)),globalThis[oA]||(globalThis[oA]=Mwe().then(r=>globalThis[sA]=r).catch(()=>globalThis[sA]=!1));const fA=(r,e)=>{const t=e?[e]:Iq(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(o=>{n.includes(o)||n.push(o)})}),n};function x5(){}class MQ{constructor(e,t=rAe){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},t,n)}}class sAe{constructor(e){this.zone=e,this.task=null}call(e,t){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",x5,{},x5,x5)),t.pipe(bi({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let dA=(()=>{class r{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new MQ(Zone.current)),this.insideAngular=t.run(()=>new MQ(Zone.current,iAe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return r.\u0275fac=function(t){return new(t||r)(Pe(i1))},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function e0(){const r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return r}function t0(r){return e0().ngZone.run(()=>r())}function aAe(r){return e0(),function cAe(r){return function(t){return(t=t.lift(new sAe(r.ngZone))).pipe(ah(r.outsideAngular),oh(r.insideAngular))}}(e0())(r)}const lAe=(r,e)=>function(){const n=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),t0(()=>r.apply(void 0,n))},D1=(r,e)=>function(){let t;const n=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof n[s]&&(e&&(t||(t=t0(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",x5,{},x5,x5)))),n[s]=lAe(n[s],t));const i=function oAe(r){return e0().ngZone.runOutsideAngular(()=>r())}(()=>r.apply(this,n));if(!e){if(i instanceof S1){const s=e0();return i.pipe(ah(s.outsideAngular),oh(s.insideAngular))}return t0(()=>i)}return i instanceof S1?i.pipe(aAe):i instanceof Promise?t0(()=>new Promise((s,o)=>i.then(a=>t0(()=>s(a)),a=>t0(()=>o(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:t0(()=>i)};class L5{constructor(e){return e}}class hA{constructor(){return Iq()}}const pA=new tt("angularfire2._apps"),fAe={provide:L5,useFactory:function uAe(r){return r&&1===r.length?r[0]:new L5(sT())},deps:[[new es,pA]]},dAe={provide:hA,deps:[[new es,pA]]};function hAe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new L5(n)}}let pAe=(()=>{class r{constructor(t){gr("angularfire",R_.full,"core"),gr("angularfire",R_.full,"app"),gr("angular",gH.full,t.toString())}}return r.\u0275fac=function(t){return new(t||r)(Pe(d3))},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({providers:[fAe,dAe]}),r})();const mAe=D1(Aq,!0),gA=new Map,EQ={activated:!1,tokenObservers:[]},_Ae={initialized:!1,enabled:!1};function vr(r){return gA.get(r)||Object.assign({},EQ)}function z_(){return _Ae}const mA="https://content-firebaseappcheck.googleapis.com/v1",MAe="exchangeDebugToken",SQ={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class SAe{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return P(function*(){t.stop();try{t.pending=new Xg,yield function PAe(r){return new Promise(e=>{setTimeout(e,r)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new Xg,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const oi=new yc("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function _A(r){if(!vr(r).activated)throw oi.create("use-before-activation",{appName:r.name})}function V_(r,e){return CA.apply(this,arguments)}function CA(){return CA=P(function*({url:r,body:e},t){const n={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const d=yield i.getHeartbeatsHeader();d&&(n["X-Firebase-Client"]=d)}const s={method:"POST",body:JSON.stringify(e),headers:n};let o,a;try{o=yield fetch(r,s)}catch(d){throw oi.create("fetch-network-error",{originalErrorMessage:d?.message})}if(200!==o.status)throw oi.create("fetch-status-error",{httpStatus:o.status});try{a=yield o.json()}catch(d){throw oi.create("fetch-parse-error",{originalErrorMessage:d?.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw oi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const l=1e3*Number(c[1]),f=Date.now();return{token:a.token,expireTimeMillis:f+l,issuedAtTimeMillis:f}}),CA.apply(this,arguments)}function PQ(r,e){const{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${mA}/projects/${t}/apps/${n}:${MAe}?key=${i}`,body:{debug_token:e}}}const wAe="firebase-app-check-database",NAe=1,D9="firebase-app-check-store";let F_=null;function yA(){return yA=P(function*(r,e){const n=(yield function OQ(){return F_||(F_=new Promise((r,e)=>{try{const t=indexedDB.open(wAe,NAe);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(oi.create("storage-open",{originalErrorMessage:null===(i=n.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=n=>{0===n.oldVersion&&n.target.result.createObjectStore(D9,{keyPath:"compositeKey"})}}catch(t){e(oi.create("storage-open",{originalErrorMessage:t?.message}))}}),F_)}()).transaction(D9,"readwrite"),s=n.objectStore(D9).put({compositeKey:r,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},n.onerror=c=>{var l;a(oi.create("storage-set",{originalErrorMessage:null===(l=c.target.error)||void 0===l?void 0:l.message}))}})}),yA.apply(this,arguments)}const H9=new W8("@firebase/app-check");function SA(r,e){return S6()?function IAe(r,e){return function bQ(r,e){return yA.apply(this,arguments)}(function NQ(r){return`${r.options.appId}-${r.name}`}(r),e)}(r,e).catch(t=>{H9.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function TA(){return z_().enabled}function OA(){return bA.apply(this,arguments)}function bA(){return bA=P(function*(){const r=z_();if(r.enabled&&r.token)return r.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),bA.apply(this,arguments)}const DAe={error:"UNKNOWN_ERROR"};function HAe(r){return WP.encodeString(JSON.stringify(r),!1)}function $_(r){return wA.apply(this,arguments)}function wA(){return wA=P(function*(r,e=!1){const t=r.app;_A(t);const n=vr(t);let s,i=n.token;if(i&&!R5(i)&&(n.token=void 0,i=void 0),!i){const c=yield n.cachedTokenPromise;c&&(R5(c)?i=c:yield SA(t,void 0))}if(!e&&i&&R5(i))return{token:i.token};let a,o=!1;if(TA()){n.exchangeTokenPromise||(n.exchangeTokenPromise=V_(PQ(t,yield OA()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),o=!0);const c=yield n.exchangeTokenPromise;return yield SA(t,c),n.token=c,{token:c.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),o=!0),i=yield vr(t).exchangeTokenPromise}catch(c){"appCheck/throttled"===c.code?H9.warn(c.message):H9.error(c),s=c}return i?s?a=R5(i)?{token:i.token,internalError:s}:xQ(s):(a={token:i.token},n.token=i,yield SA(t,i)):a=xQ(s),o&&function kQ(r,e){const t=vr(r).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch{}}(t,a),a}),wA.apply(this,arguments)}function NA(){return NA=P(function*(r){const e=r.app;_A(e);const{provider:t}=vr(e);if(TA()){const n=yield OA(),{token:i}=yield V_(PQ(e,n),r.heartbeatServiceProvider);return{token:i}}{const{token:n}=yield t.getToken();return{token:n}}}),NA.apply(this,arguments)}function IA(r,e){const t=vr(r),n=t.tokenObservers.filter(i=>i.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function IQ(r){const{app:e}=r,t=vr(e);let n=t.tokenRefresher;n||(n=function VAe(r){const{app:e}=r;return new SAe(P(function*(){let n;if(n=vr(e).token?yield $_(r,!0):yield $_(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{const t=vr(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},SQ.RETRIAL_MIN_WAIT,SQ.RETRIAL_MAX_WAIT)}(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function R5(r){return r.expireTimeMillis-Date.now()>0}function xQ(r){return{token:HAe(DAe),error:r}}class FAe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=vr(this.app);for(const t of e)IA(this.app,t.next);return Promise.resolve()}}const $Q="app-check-internal";!function eIe(){ss(new wi("app-check",r=>function $Ae(r,e){return new FAe(r,e)}(r.getProvider("app").getImmediate(),r.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider($Q).initialize()})),ss(new wi($Q,r=>function BAe(r){return{getToken:e=>$_(r,e),getLimitedUseToken:()=>function AQ(r){return NA.apply(this,arguments)}(r),addTokenListener:e=>function AA(r,e,t,n){const{app:i}=r,s=vr(i);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:n,type:e}],s.token&&R5(s.token)){const a=s.token;Promise.resolve().then(()=>{t({token:a.token}),IQ(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>IQ(r))}(r,"INTERNAL",e),removeTokenListener:e=>IA(r.app,e)}}(r.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),gr("@firebase/app-check","0.8.0")}();class RA{constructor(){return fA("app-check")}}typeof window<"u"&&window;const sIe=function GQ(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},UQ=new yc("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),G_=new W8("@firebase/auth");function U_(r,...e){G_.logLevel<=Gn.ERROR&&G_.error(`Auth (${b6}): ${r}`,...e)}function Rs(r,...e){throw DA(r,...e)}function ao(r,...e){return DA(r,...e)}function WQ(r,e,t){const n=Object.assign(Object.assign({},sIe()),{[e]:t});return new yc("auth","Firebase",n).create(e,{appName:r.name})}function DA(r,...e){if("string"!=typeof r){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return UQ.create(r,...e)}function Fe(r,e,...t){if(!r)throw DA(e,...t)}function kc(r){const e="INTERNAL ASSERTION FAILED: "+r;throw U_(e),new Error(e)}function V3(r,e){r||kc(e)}function V9(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.href)||""}function qQ(){var r;return typeof self<"u"&&(null===(r=self.location)||void 0===r?void 0:r.protocol)||null}class F9{constructor(e,t){this.shortDelay=e,this.longDelay=t,V3(t>e,"Short delay should be less than long delay!"),this.isMobile=function xye(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(T2())}()||function Rye(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function aIe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function HA(){return"http:"===qQ()||"https:"===qQ()}()||qP()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function VA(r,e){V3(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class jQ{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void kc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void kc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void kc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const lIe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},uIe=new F9(3e4,6e4);function ir(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}function Cr(r,e,t,n){return FA.apply(this,arguments)}function FA(){return FA=P(function*(r,e,t,n,i={}){return ZQ(r,i,P(function*(){let s={},o={};n&&("GET"===e?o=n:s={body:JSON.stringify(n)});const a=Pf(Object.assign({key:r.config.apiKey},o)).slice(1),c=yield r._getAdditionalHeaders();return c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode),jQ.fetch()(YQ(r,r.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))}))}),FA.apply(this,arguments)}function ZQ(r,e,t){return $A.apply(this,arguments)}function $A(){return $A=P(function*(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},lIe),e);try{const i=new fIe(r),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=yield s.json();if("needConfirmation"in o)throw $9(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===c)throw $9(r,"credential-already-in-use",o);if("EMAIL_EXISTS"===c)throw $9(r,"email-already-in-use",o);if("USER_DISABLED"===c)throw $9(r,"user-disabled",o);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw WQ(r,f,l);Rs(r,f)}}catch(i){if(i instanceof xo)throw i;Rs(r,"network-request-failed",{message:String(i)})}}),$A.apply(this,arguments)}function F3(r,e,t,n){return BA.apply(this,arguments)}function BA(){return BA=P(function*(r,e,t,n,i={}){const s=yield Cr(r,e,t,n,i);return"mfaPendingCredential"in s&&Rs(r,"multi-factor-auth-required",{_serverResponse:s}),s}),BA.apply(this,arguments)}function YQ(r,e,t,n){const i=`${e}${t}?${n}`;return r.config.emulator?VA(r.config,i):`${r.config.apiScheme}://${i}`}class fIe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(ao(this.auth,"network-request-failed")),uIe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function $9(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=ao(r,e,n);return i.customData._tokenResponse=t,i}function GA(){return GA=P(function*(r,e){return Cr(r,"POST","/v1/accounts:delete",e)}),GA.apply(this,arguments)}function WA(){return WA=P(function*(r,e){return Cr(r,"POST","/v1/accounts:lookup",e)}),WA.apply(this,arguments)}function B9(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function qA(){return qA=P(function*(r,e=!1){const t=pr(r),n=yield t.getIdToken(e),i=W_(n);Fe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:n,authTime:B9(jA(i.auth_time)),issuedAtTime:B9(jA(i.iat)),expirationTime:B9(jA(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}),qA.apply(this,arguments)}function jA(r){return 1e3*Number(r)}function W_(r){const[e,t,n]=r.split(".");if(void 0===e||void 0===t||void 0===n)return U_("JWT malformed, contained fewer than 3 sections"),null;try{const i=Yg(t);return i?JSON.parse(i):(U_("Failed to decode base64 JWT payload"),null)}catch(i){return U_("Caught error parsing JWT payload as JSON",i?.toString()),null}}function $3(r,e){return ZA.apply(this,arguments)}function ZA(){return ZA=P(function*(r,e,t=!1){if(t)return e;try{return yield e}catch(n){throw n instanceof xo&&function _Ie({code:r}){return"auth/user-disabled"===r||"auth/user-token-expired"===r}(n)&&r.auth.currentUser===r&&(yield r.auth.signOut()),n}}),ZA.apply(this,arguments)}class vIe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}{this.errorBackoff=3e4;const i=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(P(function*(){yield t.iteration()}),n)}iteration(){var e=this;return P(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class KQ{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=B9(this.lastLoginAt),this.creationTime=B9(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function G9(r){return YA.apply(this,arguments)}function YA(){return YA=P(function*(r){var e;const t=r.auth,n=yield r.getIdToken(),i=yield $3(r,function pIe(r,e){return WA.apply(this,arguments)}(t,{idToken:n}));Fe(i?.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const o=null!==(e=s.providerUserInfo)&&void 0!==e&&e.length?function MIe(r){return r.map(e=>{var{providerId:t}=e,n=Du(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}(s.providerUserInfo):[],a=function yIe(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}(r.providerData,o),f=!!r.isAnonymous&&!(r.email&&s.passwordHash||a?.length),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new KQ(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(r,d)}),YA.apply(this,arguments)}function KA(){return KA=P(function*(r){const e=pr(r);yield G9(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}),KA.apply(this,arguments)}function XA(){return XA=P(function*(r,e){const t=yield ZQ(r,{},P(function*(){const n=Pf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=YQ(r,i,"/v1/token",`key=${s}`),a=yield r._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",jQ.fetch()(o,{method:"POST",headers:a,body:n})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}),XA.apply(this,arguments)}class U9{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function mIe(r){const e=W_(r);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var n=this;return P(function*(){return Fe(!n.accessToken||n.refreshToken,e,"user-token-expired"),t||!n.accessToken||n.isExpired?n.refreshToken?(yield n.refresh(e,n.refreshToken),n.accessToken):null:n.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var n=this;return P(function*(){const{accessToken:i,refreshToken:s,expiresIn:o}=yield function EIe(r,e){return XA.apply(this,arguments)}(e,t);n.updateTokensAndExpiration(i,s,Number(o))})()}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new U9;return n&&(Fe("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),i&&(Fe("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),s&&(Fe("number"==typeof s,"internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new U9,this.toJSON())}_performRefresh(){return kc("not implemented")}}function sl(r,e){Fe("string"==typeof r||typeof r>"u","internal-error",{appName:e})}class n0{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=Du(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new vIe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new KQ(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){var t=this;return P(function*(){const n=yield $3(t,t.stsTokenManager.getToken(t.auth,e));return Fe(n,t.auth,"internal-error"),t.accessToken!==n&&(t.accessToken=n,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),n})()}getIdTokenResult(e){return function gIe(r){return qA.apply(this,arguments)}(this,e)}reload(){return function CIe(r){return KA.apply(this,arguments)}(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new n0(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var n=this;return P(function*(){let i=!1;e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),t&&(yield G9(n)),yield n.auth._persistUserIfCurrent(n),i&&n.auth._notifyListenersIfCurrent(n)})()}delete(){var e=this;return P(function*(){const t=yield e.getIdToken();return yield $3(e,function dIe(r,e){return GA.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,o,a,c,l,f;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,m=null!==(i=t.email)&&void 0!==i?i:void 0,M=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,w=null!==(o=t.photoURL)&&void 0!==o?o:void 0,L=null!==(a=t.tenantId)&&void 0!==a?a:void 0,z=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,$=null!==(l=t.createdAt)&&void 0!==l?l:void 0,B=null!==(f=t.lastLoginAt)&&void 0!==f?f:void 0,{uid:de,emailVerified:_e,isAnonymous:xe,providerData:nt,stsTokenManager:gt}=t;Fe(de&&gt,e,"internal-error");const yn=U9.fromJSON(this.name,gt);Fe("string"==typeof de,e,"internal-error"),sl(d,e.name),sl(m,e.name),Fe("boolean"==typeof _e,e,"internal-error"),Fe("boolean"==typeof xe,e,"internal-error"),sl(M,e.name),sl(w,e.name),sl(L,e.name),sl(z,e.name),sl($,e.name),sl(B,e.name);const Et=new n0({uid:de,auth:e,email:m,emailVerified:_e,displayName:d,isAnonymous:xe,photoURL:w,phoneNumber:M,tenantId:L,stsTokenManager:yn,createdAt:$,lastLoginAt:B});return nt&&Array.isArray(nt)&&(Et.providerData=nt.map(W2=>Object.assign({},W2))),z&&(Et._redirectEventId=z),Et}static _fromIdTokenResponse(e,t,n=!1){return P(function*(){const i=new U9;i.updateFromServerResponse(t);const s=new n0({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield G9(s),s})()}}const XQ=new Map;function B3(r){V3(r instanceof Function,"Expected a class definition");let e=XQ.get(r);return e?(V3(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,XQ.set(r,e),e)}const QQ=(()=>{class r{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return P(function*(){return!0})()}_set(t,n){var i=this;return P(function*(){i.storage[t]=n})()}_get(t){var n=this;return P(function*(){const i=n.storage[t];return void 0===i?null:i})()}_remove(t){var n=this;return P(function*(){delete n.storage[t]})()}_addListener(t,n){}_removeListener(t,n){}}return r.type="NONE",r})();function q_(r,e,t){return`firebase:${r}:${e}:${t}`}class D5{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=q_(this.userKey,i.apiKey,s),this.fullPersistenceKey=q_("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return P(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?n0._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return P(function*(){if(t.persistence===e)return;const n=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,n?t.setCurrentUser(n):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,n="authUser"){return P(function*(){if(!t.length)return new D5(B3(QQ),e,n);const i=(yield Promise.all(t.map(function(){var l=P(function*(f){if(yield f._isAvailable())return f});return function(f){return l.apply(this,arguments)}}()))).filter(l=>l);let s=i[0]||B3(QQ);const o=q_(n,e.config.apiKey,e.name);let a=null;for(const l of t)try{const f=yield l._get(o);if(f){const d=n0._fromJSON(e,f);l!==s&&(a=d),s=l;break}}catch{}const c=i.filter(l=>l._shouldAllowMigration);return s._shouldAllowMigration&&c.length?(s=c[0],a&&(yield s._set(o,a.toJSON())),yield Promise.all(t.map(function(){var l=P(function*(f){if(f!==s)try{yield f._remove(o)}catch{}});return function(f){return l.apply(this,arguments)}}())),new D5(s,e,n)):new D5(s,e,n)})()}}function JQ(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nJ(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eJ(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(iJ(e))return"Blackberry";if(sJ(e))return"Webos";if(QA(e))return"Safari";if((e.includes("chrome/")||tJ(e))&&!e.includes("edge/"))return"Chrome";if(rJ(e))return"Android";{const n=r.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===n?.length)return n[1]}return"Other"}function eJ(r=T2()){return/firefox\//i.test(r)}function QA(r=T2()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tJ(r=T2()){return/crios\//i.test(r)}function nJ(r=T2()){return/iemobile/i.test(r)}function rJ(r=T2()){return/android/i.test(r)}function iJ(r=T2()){return/blackberry/i.test(r)}function sJ(r=T2()){return/webos/i.test(r)}function j_(r=T2()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function oJ(r=T2()){return j_(r)||rJ(r)||sJ(r)||iJ(r)||/windows phone/i.test(r)||nJ(r)}function aJ(r,e=[]){let t;switch(r){case"Browser":t=JQ(T2());break;case"Worker":t=`${JQ(T2())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${b6}/${n}`}function cJ(r,e){return eI.apply(this,arguments)}function eI(){return eI=P(function*(r,e){return Cr(r,"GET","/v2/recaptchaConfig",ir(r,e))}),eI.apply(this,arguments)}function uJ(r){return void 0!==r&&void 0!==r.enterprise}class fJ{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState)}}function tI(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=ao("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",function bIe(){var r,e;return null!==(e=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==e?e:document}().appendChild(n)})}function dJ(r){return`__${r}${Math.floor(1e6*Math.random())}`}class hJ{constructor(e){this.type="recaptcha-enterprise",this.auth=k2(e)}verify(e="verify",t=!1){var n=this;return P(function*(){function s(){return s=P(function*(a){if(!t){if(null==a.tenantId&&null!=a._agentRecaptchaConfig)return a._agentRecaptchaConfig.siteKey;if(null!=a.tenantId&&void 0!==a._tenantRecaptchaConfigs[a.tenantId])return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(function(){var c=P(function*(l,f){cJ(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0!==d.recaptchaKey){const m=new fJ(d);return null==a.tenantId?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,l(m.siteKey)}f(new Error("recaptcha Enterprise site key undefined"))}).catch(d=>{f(d)})});return function(l,f){return c.apply(this,arguments)}}())}),s.apply(this,arguments)}function o(a,c,l){const f=window.grecaptcha;uJ(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(d=>{c(d)}).catch(()=>{c("NO_RECAPTCHA")})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((a,c)=>{(function i(a){return s.apply(this,arguments)})(n.auth).then(l=>{if(!t&&uJ(window.grecaptcha))o(l,a,c);else{if(typeof window>"u")return void c(new Error("RecaptchaVerifier is only supported in browser"));tI("https://www.google.com/recaptcha/enterprise.js?render="+l).then(()=>{o(l,a,c)}).catch(f=>{c(f)})}}).catch(l=>{c(l)})})})()}}function ol(r,e,t){return nI.apply(this,arguments)}function nI(){return nI=P(function*(r,e,t,n=!1){const i=new hJ(r);let s;try{s=yield i.verify(t)}catch{s=yield i.verify(t,!0)}const o=Object.assign({},e);return Object.assign(o,n?{captchaResp:s}:{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}),nI.apply(this,arguments)}class IIe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,a)=>{try{o(e(s))}catch(c){a(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return P(function*(){if(t.auth.currentUser===e)return;const n=[];try{for(const i of t.queue)yield i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const s of n)try{s()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}})()}}class kIe{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pJ(this),this.idTokenSubscription=new pJ(this),this.beforeStateQueue=new IIe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=UQ,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=B3(t)),this._initializationPromise=this.queue(P(function*(){var i,s;if(!n._deleted&&(n.persistenceManager=yield D5.create(n,e),!n._deleted)){if(null!==(i=n._popupRedirectResolver)&&void 0!==i&&i._shouldInitProactively)try{yield n._popupRedirectResolver._initialize(n)}catch{}yield n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(s=n.currentUser)||void 0===s?void 0:s.uid)||null,!n._deleted&&(n._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return P(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return P(function*(){var n;const i=yield t.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const a=null===(n=t.redirectUser)||void 0===n?void 0:n._redirectEventId,c=s?._redirectEventId,l=yield t.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(s=l.user,o=!0)}if(!s)return t.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{yield t.beforeStateQueue.runMiddleware(s)}catch(a){s=i,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(a))}return s?t.reloadAndSetCurrentUserOrClear(s):t.directlySetCurrentUser(null)}return Fe(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===s._redirectEventId?t.directlySetCurrentUser(s):t.reloadAndSetCurrentUserOrClear(s)})()}tryRedirectSignIn(e){var t=this;return P(function*(){let n=null;try{n=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return n})()}reloadAndSetCurrentUserOrClear(e){var t=this;return P(function*(){try{yield G9(e)}catch(n){if("auth/network-request-failed"!==n?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function cIe(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}()}_delete(){var e=this;return P(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return P(function*(){const n=e?pr(e):null;return n&&Fe(n.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(n&&n._clone(t))})()}_updateCurrentUser(e,t=!1){var n=this;return P(function*(){if(!n._deleted)return e&&Fe(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),t||(yield n.beforeStateQueue.runMiddleware(e)),n.queue(P(function*(){yield n.directlySetCurrentUser(e),n.notifyAuthListeners()}))})()}signOut(){var e=this;return P(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(P(function*(){yield t.assertedPersistence.setPersistence(B3(e))}))}initializeRecaptchaConfig(){var e=this;return P(function*(){const t=yield cJ(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new fJ(t);null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,n.emailPasswordEnabled&&new hJ(e).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yc("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var n=this;return P(function*(){const i=yield n.getOrInitRedirectPersistenceManager(t);return null===e?i.removeCurrentUser():i.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return P(function*(){if(!t.redirectPersistenceManager){const n=e&&B3(e)||t._popupRedirectResolver;Fe(n,t,"argument-error"),t.redirectPersistenceManager=yield D5.create(t,[B3(n._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return P(function*(){var n,i;return t._isInitialized&&(yield t.queue(P(function*(){}))),(null===(n=t._currentUser)||void 0===n?void 0:n._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return P(function*(){if(e===t.currentUser)return t.queue(P(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Fe(o,this,"internal-error"),o.then(()=>s(this.currentUser)),"function"==typeof t?e.addObserver(t,n,i):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return P(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=aJ(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return P(function*(){var t;const n={"X-Client-Version":e.clientVersion};e.app.options.appId&&(n["X-Firebase-gmpid"]=e.app.options.appId);const i=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();i&&(n["X-Firebase-Client"]=i);const s=yield e._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n})()}_getAppCheckToken(){var e=this;return P(function*(){var t;const n=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return n?.error&&function oIe(r,...e){G_.logLevel<=Gn.WARN&&G_.warn(`Auth (${b6}): ${r}`,...e)}(`Error while retrieving App Check token: ${n.error}`),n?.token})()}}function k2(r){return pr(r)}class pJ{constructor(e){this.auth=e,this.observer=null,this.addObserver=function $ye(r,e){const t=new Bye(r,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function gJ(r,e,t){const n=k2(r);Fe(n._canInitEmulator,n,"emulator-config-failed"),Fe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!!t?.disableWarnings,s=mJ(e),{host:o,port:a}=function RIe(r){const e=mJ(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:_J(n.substr(s.length+1))}}{const[s,o]=n.split(":");return{host:s,port:_J(o)}}}(e);n.config.emulator={url:`${s}//${o}${null===a?"":`:${a}`}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function zIe(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",r):r())}()}function mJ(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function _J(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}class rI{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return kc("not implemented")}_getIdTokenResponse(e){return kc("not implemented")}_linkToIdToken(e,t){return kc("not implemented")}_getReauthenticationResolver(e){return kc("not implemented")}}function sI(){return sI=P(function*(r,e){return Cr(r,"POST","/v1/accounts:update",e)}),sI.apply(this,arguments)}function aI(r,e){return cI.apply(this,arguments)}function cI(){return cI=P(function*(r,e){return F3(r,"POST","/v1/accounts:signInWithPassword",ir(r,e))}),cI.apply(this,arguments)}function Z_(r,e){return lI.apply(this,arguments)}function lI(){return lI=P(function*(r,e){return Cr(r,"POST","/v1/accounts:sendOobCode",ir(r,e))}),lI.apply(this,arguments)}function uI(){return uI=P(function*(r,e){return Z_(r,e)}),uI.apply(this,arguments)}function fI(r,e){return dI.apply(this,arguments)}function dI(){return dI=P(function*(r,e){return Z_(r,e)}),dI.apply(this,arguments)}function mI(){return mI=P(function*(r,e){return F3(r,"POST","/v1/accounts:signInWithEmailLink",ir(r,e))}),mI.apply(this,arguments)}function _I(){return _I=P(function*(r,e){return F3(r,"POST","/v1/accounts:signInWithEmailLink",ir(r,e))}),_I.apply(this,arguments)}class W9 extends rI{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new W9(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new W9(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return P(function*(){var n;switch(t.signInMethod){case"password":const i={returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=e._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const s=yield ol(e,i,"signInWithPassword");return aI(e,s)}return aI(e,i).catch(function(){var s=P(function*(o){if("auth/missing-recaptcha-token"===o.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const a=yield ol(e,i,"signInWithPassword");return aI(e,a)}return Promise.reject(o)});return function(o){return s.apply(this,arguments)}}());case"emailLink":return function FIe(r,e){return mI.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Rs(e,"internal-error")}})()}_linkToIdToken(e,t){var n=this;return P(function*(){switch(n.signInMethod){case"password":return function CJ(r,e){return sI.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password});case"emailLink":return function $Ie(r,e){return _I.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password});default:Rs(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function G3(r,e){return vI.apply(this,arguments)}function vI(){return vI=P(function*(r,e){return F3(r,"POST","/v1/accounts:signInWithIdp",ir(r,e))}),vI.apply(this,arguments)}class H5 extends rI{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new H5(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Rs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=Du(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new H5(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return G3(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,G3(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,G3(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Pf(t)}return e}}class j9{constructor(e){var t,n,i,s,o,a;const c=Tf(Of(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,f=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function ZIe(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);Fe(l&&f&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=f,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function YIe(r){const e=Tf(Of(r)).link,t=e?Tf(Of(e)).deep_link_id:null,n=Tf(Of(r)).deep_link_id;return(n?Tf(Of(n)).link:null)||n||t||e||r}(e);try{return new j9(t)}catch{return null}}}let yJ=(()=>{class r{constructor(){this.providerId=r.PROVIDER_ID}static credential(t,n){return W9._fromEmailAndPassword(t,n)}static credentialWithLink(t,n){const i=j9.parseLink(n);return Fe(i,"argument-error"),W9._fromEmailAndCode(t,i.code,i.tenantId)}}return r.PROVIDER_ID="password",r.EMAIL_PASSWORD_SIGN_IN_METHOD="password",r.EMAIL_LINK_SIGN_IN_METHOD="emailLink",r})();class al{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class MJ extends al{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let KIe=(()=>{class r extends MJ{constructor(){super("google.com"),this.addScope("profile")}static credential(t,n){return H5._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return r.credentialFromTaggedObject(t)}static credentialFromError(t){return r.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:n,oauthAccessToken:i}=t;if(!n&&!i)return null;try{return r.credential(n,i)}catch{return null}}}return r.GOOGLE_SIGN_IN_METHOD="google.com",r.PROVIDER_ID="google.com",r})();function K_(r,e){return PI.apply(this,arguments)}function PI(){return PI=P(function*(r,e){return F3(r,"POST","/v1/accounts:signUp",ir(r,e))}),PI.apply(this,arguments)}class zo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,n,i=!1){return P(function*(){const s=yield n0._fromIdTokenResponse(e,n,i),o=EJ(n);return new zo({user:s,providerId:o,_tokenResponse:n,operationType:t})})()}static _forOperation(e,t,n){return P(function*(){yield e._updateTokensIfNecessary(n,!0);const i=EJ(n);return new zo({user:e,providerId:i,_tokenResponse:n,operationType:t})})()}}function EJ(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}class X_ extends xo{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,X_.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new X_(e,t,n,i)}}function SJ(r,e,t,n){return("reauthenticate"===e?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw"auth/multi-factor-auth-required"===s.code?X_._fromErrorAndOperation(r,s,e,n):s})}function wI(){return wI=P(function*(r,e,t=!1){const n=yield $3(r,e._linkToIdToken(r.auth,yield r.getIdToken()),t);return zo._forOperation(r,"link",n)}),wI.apply(this,arguments)}function AI(){return AI=P(function*(r,e,t=!1){const{auth:n}=r,i="reauthenticate";try{const s=yield $3(r,SJ(n,i,e,r),t);Fe(s.idToken,n,"internal-error");const o=W_(s.idToken);Fe(o,n,"internal-error");const{sub:a}=o;return Fe(r.uid===a,n,"user-mismatch"),zo._forOperation(r,i,s)}catch(s){throw"auth/user-not-found"===s?.code&&Rs(n,"user-mismatch"),s}}),AI.apply(this,arguments)}function OJ(r,e){return II.apply(this,arguments)}function II(){return II=P(function*(r,e,t=!1){const n="signIn",i=yield SJ(r,n,e),s=yield zo._fromIdTokenResponse(r,n,i);return t||(yield r._updateCurrentUser(s.user)),s}),II.apply(this,arguments)}function xI(){return xI=P(function*(r,e){return OJ(k2(r),e)}),xI.apply(this,arguments)}function V5(r,e,t){var n;Fe((null===(n=t.url)||void 0===n?void 0:n.length)>0,r,"invalid-continue-uri"),Fe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(Fe(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(Fe(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function nke(r,e,t){return $I.apply(this,arguments)}function $I(){return $I=P(function*(r,e,t){var n;const i=k2(r),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const o=yield ol(i,s,"getOobCode",!0);t&&V5(i,o,t),yield fI(i,o)}else t&&V5(i,s,t),yield fI(i,s).catch(function(){var o=P(function*(a){if("auth/missing-recaptcha-token"!==a.code)return Promise.reject(a);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const c=yield ol(i,s,"getOobCode",!0);t&&V5(i,c,t),yield fI(i,c)}});return function(a){return o.apply(this,arguments)}}())}),$I.apply(this,arguments)}function ike(r,e,t){return qI.apply(this,arguments)}function qI(){return qI=P(function*(r,e,t){var n;const i=k2(r),s={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"};let o;if(null!==(n=i._getRecaptchaConfig())&&void 0!==n&&n.emailPasswordEnabled){const l=yield ol(i,s,"signUpPassword");o=K_(i,l)}else o=K_(i,s).catch(function(){var l=P(function*(f){if("auth/missing-recaptcha-token"===f.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const d=yield ol(i,s,"signUpPassword");return K_(i,d)}return Promise.reject(f)});return function(f){return l.apply(this,arguments)}}());const a=yield o.catch(l=>Promise.reject(l)),c=yield zo._fromIdTokenResponse(i,"signIn",a);return yield i._updateCurrentUser(c.user),c}),qI.apply(this,arguments)}function ske(r,e,t){return function kI(r,e){return xI.apply(this,arguments)}(pr(r),yJ.credential(e,t))}function ake(r,e){return XI.apply(this,arguments)}function XI(){return XI=P(function*(r,e){const t=pr(r),i={requestType:"VERIFY_EMAIL",idToken:yield r.getIdToken()};e&&V5(t.auth,i,e);const{email:s}=yield function HIe(r,e){return uI.apply(this,arguments)}(t.auth,i);s!==r.email&&(yield r.reload())}),XI.apply(this,arguments)}function JI(){return JI=P(function*(r,e){return Cr(r,"POST","/v1/accounts:update",e)}),JI.apply(this,arguments)}function lke(r,e){return ek.apply(this,arguments)}function ek(){return ek=P(function*(r,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const n=pr(r),s={idToken:yield n.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=yield $3(n,function cke(r,e){return JI.apply(this,arguments)}(n.auth,s));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const a=n.providerData.find(({providerId:c})=>"password"===c);a&&(a.displayName=n.displayName,a.photoURL=n.photoURL),yield n._updateTokensIfNecessary(o)}),ek.apply(this,arguments)}function _ke(r,e,t,n){return pr(r).onAuthStateChanged(e,t,n)}const J_="__sak";class wJ{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(J_,"1"),this.storage.removeItem(J_),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Tke=(()=>{class r extends wJ{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,n)=>this.onStorageEvent(t,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Eke(){const r=T2();return QA(r)||j_(r)}()&&function TIe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=oJ(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),s=this.localCache[n];i!==s&&t(n,s,i)}}onStorageEvent(t,n=!1){if(!t.key)return void this.forAllChangedKeys((a,c,l)=>{this.notifyListeners(a,l)});const i=t.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(i);if(t.newValue!==a)null!==t.newValue?this.storage.setItem(i,t.newValue):this.storage.removeItem(i);else if(this.localCache[i]===t.newValue&&!n)return}const s=()=>{const a=this.storage.getItem(i);!n&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);!function PIe(){return function zye(){const r=T2();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===t.newValue||t.newValue===t.oldValue?s():setTimeout(s,10)}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:i}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,n){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,n){var i=()=>super._set,s=this;return P(function*(){yield i().call(s,t,n),s.localCache[t]=JSON.stringify(n)})()}_get(t){var n=()=>super._get,i=this;return P(function*(){const s=yield n().call(i,t);return i.localCache[t]=JSON.stringify(s),s})()}_remove(t){var n=()=>super._remove,i=this;return P(function*(){yield n().call(i,t),delete i.localCache[t]})()}}return r.type="LOCAL",r})(),NJ=(()=>{class r extends wJ{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,n){}_removeListener(t,n){}}return r.type="SESSION",r})();let bke=(()=>{class r{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const n=this.receivers.find(s=>s.isListeningto(t));if(n)return n;const i=new r(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){var n=this;return P(function*(){const i=t,{eventId:s,eventType:o,data:a}=i.data,c=n.handlersMap[o];if(!c?.size)return;i.ports[0].postMessage({status:"ack",eventId:s,eventType:o});const l=Array.from(c).map(function(){var d=P(function*(m){return m(i.origin,a)});return function(m){return d.apply(this,arguments)}}()),f=yield function Oke(r){return Promise.all(r.map(function(){var e=P(function*(t){try{return{fulfilled:!0,value:yield t}}catch(n){return{fulfilled:!1,reason:n}}});return function(t){return e.apply(this,arguments)}}()))}(l);i.ports[0].postMessage({status:"done",eventId:s,eventType:o,response:f})})()}_subscribe(t,n){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(n)}_unsubscribe(t,n){this.handlersMap[t]&&n&&this.handlersMap[t].delete(n),(!n||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return r.receivers=[],r})();function ev(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(10*Math.random());return r+t}class wke{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,n=50){var i=this;return P(function*(){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((c,l)=>{const f=ev("",20);s.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(m){const M=m;if(M.data.eventId===f)switch(M.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(M.data.response);break;default:clearTimeout(d),clearTimeout(o),l(new Error("invalid_response"))}}},i.handlers.add(a),s.port1.addEventListener("message",a.onMessage),i.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{a&&i.removeMessageHandler(a)})})()}}function Kr(){return window}function ak(){return typeof Kr().WorkerGlobalScope<"u"&&"function"==typeof Kr().importScripts}function ck(){return(ck=P(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const AJ="firebaseLocalStorageDb",tv="firebaseLocalStorage",IJ="fbase_key";class Y9{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nv(r,e){return r.transaction([tv],e?"readwrite":"readonly").objectStore(tv)}function lk(){const r=indexedDB.open(AJ,1);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(tv,{keyPath:IJ})}catch(i){t(i)}}),r.addEventListener("success",P(function*(){const n=r.result;n.objectStoreNames.contains(tv)?e(n):(n.close(),yield function Lke(){const r=indexedDB.deleteDatabase(AJ);return new Y9(r).toPromise()}(),e(yield lk()))}))})}function kJ(r,e,t){return uk.apply(this,arguments)}function uk(){return uk=P(function*(r,e,t){const n=nv(r,!0).put({[IJ]:e,value:t});return new Y9(n).toPromise()}),uk.apply(this,arguments)}function fk(){return fk=P(function*(r,e){const t=nv(r,!1).get(e),n=yield new Y9(t).toPromise();return void 0===n?null:n.value}),fk.apply(this,arguments)}function xJ(r,e){const t=nv(r,!0).delete(e);return new Y9(t).toPromise()}const Hke=(()=>{class r{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return P(function*(){return t.db||(t.db=yield lk()),t.db})()}_withRetries(t){var n=this;return P(function*(){let i=0;for(;;)try{const s=yield n._openDb();return yield t(s)}catch(s){if(i++>3)throw s;n.db&&(n.db.close(),n.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return P(function*(){return ak()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return P(function*(){t.receiver=bke._getInstance(function kke(){return ak()?self:null}()),t.receiver._subscribe("keyChanged",function(){var n=P(function*(i,s){return{keyProcessed:(yield t._poll()).includes(s.key)}});return function(i,s){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var n=P(function*(i,s){return["keyChanged"]});return function(i,s){return n.apply(this,arguments)}}())})()}initializeSender(){var t=this;return P(function*(){var n,i;if(t.activeServiceWorker=yield function Ake(){return ck.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new wke(t.activeServiceWorker);const s=yield t.sender._send("ping",{},800);s&&null!==(n=s[0])&&void 0!==n&&n.fulfilled&&null!==(i=s[0])&&void 0!==i&&i.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var n=this;return P(function*(){if(n.sender&&n.activeServiceWorker&&function Ike(){var r;return(null===(r=navigator?.serviceWorker)||void 0===r?void 0:r.controller)||null}()===n.activeServiceWorker)try{yield n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return P(function*(){try{if(!indexedDB)return!1;const t=yield lk();return yield kJ(t,J_,"1"),yield xJ(t,J_),!0}catch{}return!1})()}_withPendingWrite(t){var n=this;return P(function*(){n.pendingWrites++;try{yield t()}finally{n.pendingWrites--}})()}_set(t,n){var i=this;return P(function*(){return i._withPendingWrite(P(function*(){return yield i._withRetries(s=>kJ(s,t,n)),i.localCache[t]=n,i.notifyServiceWorker(t)}))})()}_get(t){var n=this;return P(function*(){const i=yield n._withRetries(s=>function Rke(r,e){return fk.apply(this,arguments)}(s,t));return n.localCache[t]=i,i})()}_remove(t){var n=this;return P(function*(){return n._withPendingWrite(P(function*(){return yield n._withRetries(i=>xJ(i,t)),delete n.localCache[t],n.notifyServiceWorker(t)}))})()}_poll(){var t=this;return P(function*(){const n=yield t._withRetries(o=>{const a=nv(o,!1).getAll();return new Y9(a).toPromise()});if(!n)return[];if(0!==t.pendingWrites)return[];const i=[],s=new Set;for(const{fbase_key:o,value:a}of n)s.add(o),JSON.stringify(t.localCache[o])!==JSON.stringify(a)&&(t.notifyListeners(o,a),i.push(o));for(const o of Object.keys(t.localCache))t.localCache[o]&&!s.has(o)&&(t.notifyListeners(o,null),i.push(o));return i})()}notifyListeners(t,n){this.localCache[t]=n;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(n)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(P(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,n){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(n)}_removeListener(t,n){this.listeners[t]&&(this.listeners[t].delete(n),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return r.type="LOCAL",r})();function s0(r,e){return e?B3(e):(Fe(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}dJ("rcb"),new F9(3e4,6e4);class yk extends rI{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return G3(e,this._buildIdpRequest())}_linkToIdToken(e,t){return G3(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return G3(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function exe(r){return OJ(r.auth,new yk(r),r.bypassAuthState)}function txe(r){const{auth:e,user:t}=r;return Fe(t,e,"internal-error"),function TJ(r,e){return AI.apply(this,arguments)}(t,new yk(r),r.bypassAuthState)}function nxe(r){return Mk.apply(this,arguments)}function Mk(){return Mk=P(function*(r){const{auth:e,user:t}=r;return Fe(t,e,"internal-error"),function bI(r,e){return wI.apply(this,arguments)}(t,new yk(r),r.bypassAuthState)}),Mk.apply(this,arguments)}class RJ{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=P(function*(n,i){e.pendingPromise={resolve:n,reject:i};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(s){e.reject(s)}});return function(n,i){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return P(function*(){const{urlResponse:n,sessionId:i,postBody:s,tenantId:o,error:a,type:c}=e;if(a)return void t.reject(a);const l={auth:t.auth,requestUri:n,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(c)(l))}catch(f){t.reject(f)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return exe;case"linkViaPopup":case"linkViaRedirect":return nxe;case"reauthViaPopup":case"reauthViaRedirect":return txe;default:Rs(this.auth,"internal-error")}}resolve(e){V3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){V3(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const rxe=new F9(2e3,1e4);function ixe(r,e,t){return Ek.apply(this,arguments)}function Ek(){return Ek=P(function*(r,e,t){const n=k2(r);!function z5(r,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Rs(r,"argument-error"),WQ(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(r,e,al);const i=s0(n,t);return new Tk(n,"signInViaPopup",e,i).executeNotNull()}),Ek.apply(this,arguments)}let Tk=(()=>{class r extends RJ{constructor(t,n,i,s,o){super(t,n,s,o),this.provider=i,this.authWindow=null,this.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=this}executeNotNull(){var t=this;return P(function*(){const n=yield t.execute();return Fe(n,t.auth,"internal-error"),n})()}onExecution(){var t=this;return P(function*(){V3(1===t.filter.length,"Popup operations only handle one event");const n=ev();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],n),t.authWindow.associatedEvent=n,t.resolver._originValidation(t.auth).catch(i=>{t.reject(i)}),t.resolver._isIframeWebStorageSupported(t.auth,i=>{i||t.reject(ao(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(ao(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}pollUserCancellation(){const t=()=>{var n,i;this.pollId=null!==(i=null===(n=this.authWindow)||void 0===n?void 0:n.window)&&void 0!==i&&i.closed?window.setTimeout(()=>{this.pollId=null,this.reject(ao(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,rxe.get())};t()}}return r.currentPopupAction=null,r})();const sxe="pendingRedirect",K9=new Map;class oxe extends RJ{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}execute(){var e=()=>super.execute,t=this;return P(function*(){let n=K9.get(t.auth._key());if(!n){try{const s=(yield function axe(r,e){return Ok.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;n=()=>Promise.resolve(s)}catch(i){n=()=>Promise.reject(i)}K9.set(t.auth._key(),n)}return t.bypassAuthState||K9.set(t.auth._key(),()=>Promise.resolve(null)),n()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,n=this;return P(function*(){if("signInViaRedirect"===e.type)return t().call(n,e);if("unknown"!==e.type){if(e.eventId){const i=yield n.auth._redirectUserForId(e.eventId);if(i)return n.user=i,t().call(n,e);n.resolve(null)}}else n.resolve(null)})()}onExecution(){return P(function*(){})()}cleanUp(){}}function Ok(){return Ok=P(function*(r,e){const t=function DJ(r){return q_(sxe,r.config.apiKey,r.name)}(e),n=function zJ(r){return B3(r._redirectPersistence)}(r);if(!(yield n._isAvailable()))return!1;const i="true"===(yield n._get(t));return yield n._remove(t),i}),Ok.apply(this,arguments)}function cxe(r,e){K9.set(r._key(),e)}function HJ(r,e){return xk.apply(this,arguments)}function xk(){return xk=P(function*(r,e,t=!1){const n=k2(r),i=s0(n,e),o=yield new oxe(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield n._persistUserIfCurrent(o.user),yield n._setRedirectUser(null,e)),o}),xk.apply(this,arguments)}class hxe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function pxe(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $J(r);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!$J(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ao(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(FJ(e))}saveEventToCache(e){this.cachedEventUids.add(FJ(e)),this.lastProcessedEventTime=Date.now()}}function FJ(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function $J({type:r,error:e}){return"unknown"===r&&"auth/no-auth-event"===e?.code}function Rk(){return Rk=P(function*(r,e={}){return Cr(r,"GET","/v1/projects",e)}),Rk.apply(this,arguments)}const mxe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_xe=/^https?/;function zk(){return zk=P(function*(r){if(r.config.emulator)return;const{authorizedDomains:e}=yield function gxe(r){return Rk.apply(this,arguments)}(r);for(const t of e)try{if(Cxe(t))return}catch{}Rs(r,"unauthorized-domain")}),zk.apply(this,arguments)}function Cxe(r){const e=V9(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return""===o.hostname&&""===n?"chrome-extension:"===t&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&o.hostname===n}if(!_xe.test(t))return!1;if(mxe.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}const yxe=new F9(3e4,6e4);function BJ(){const r=Kr().___jsl;if(r?.H)for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}let iv=null;const Sxe=new F9(5e3,15e3),Pxe="__/auth/iframe",Txe="emulator/auth/iframe",Oxe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bxe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wxe(r){const e=r.config;Fe(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?VA(e,Txe):`https://${r.config.authDomain}/${Pxe}`,n={apiKey:e.apiKey,appName:r.name,v:b6},i=bxe.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${Pf(n).slice(1)}`}function Dk(){return Dk=P(function*(r){const e=yield function Exe(r){return iv=iv||function Mxe(r){return new Promise((e,t)=>{var n,i,s;function o(){BJ(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{BJ(),t(ao(r,"network-request-failed"))},timeout:yxe.get()})}if(null!==(i=null===(n=Kr().gapi)||void 0===n?void 0:n.iframes)&&void 0!==i&&i.Iframe)e(gapi.iframes.getContext());else{if(null===(s=Kr().gapi)||void 0===s||!s.load){const a=dJ("iframefcb");return Kr()[a]=()=>{gapi.load?o():t(ao(r,"network-request-failed"))},tI(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}o()}}).catch(e=>{throw iv=null,e})}(r),iv}(r),t=Kr().gapi;return Fe(t,r,"internal-error"),e.open({where:document.body,url:wxe(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Oxe,dontclear:!0},n=>new Promise(function(){var i=P(function*(s,o){yield n.restyle({setHideOnLeave:!1});const a=ao(r,"network-request-failed"),c=Kr().setTimeout(()=>{o(a)},Sxe.get());function l(){Kr().clearTimeout(c),s(n)}n.ping(l).then(l,()=>{o(a)})});return function(s,o){return i.apply(this,arguments)}}()))}),Dk.apply(this,arguments)}const Axe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class GJ{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const Dxe="__/auth/handler",Hxe="emulator/auth/handler",Vxe=encodeURIComponent("fac");function UJ(r,e,t,n,i,s){return Hk.apply(this,arguments)}function Hk(){return Hk=P(function*(r,e,t,n,i,s){Fe(r.config.authDomain,r,"auth-domain-config-required"),Fe(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:b6,eventId:i};if(e instanceof al){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",function Fye(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries(s||{}))o[f]=d}if(e instanceof MJ){const f=e.getScopes().filter(d=>""!==d);f.length>0&&(o.scopes=f.join(","))}r.tenantId&&(o.tid=r.tenantId);const a=o;for(const f of Object.keys(a))void 0===a[f]&&delete a[f];const c=yield r._getAppCheckToken(),l=c?`#${Vxe}=${encodeURIComponent(c)}`:"";return`${function Fxe({config:r}){return r.emulator?VA(r,Hxe):`https://${r.authDomain}/${Dxe}`}(r)}?${Pf(a).slice(1)}${l}`}),Hk.apply(this,arguments)}const Vk="webStorageSupport",Bxe=class $xe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=NJ,this._completeRedirectFn=HJ,this._overrideRedirectResult=cxe}_openPopup(e,t,n,i){var s=this;return P(function*(){var o;V3(null===(o=s.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const a=yield UJ(e,t,n,V9(),i);return function Rxe(r,e,t,n=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const c=Object.assign(Object.assign({},Axe),{width:n.toString(),height:i.toString(),top:s,left:o}),l=T2().toLowerCase();t&&(a=tJ(l)?"_blank":t),eJ(l)&&(e=e||"http://localhost",c.scrollbars="yes");const f=Object.entries(c).reduce((m,[M,w])=>`${m}${M}=${w},`,"");if(function SIe(r=T2()){var e;return j_(r)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(l)&&"_self"!==a)return function zxe(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}(e||"",a),new GJ(null);const d=window.open(e||"",a,f);Fe(d,r,"popup-blocked");try{d.focus()}catch{}return new GJ(d)}(e,a,ev())})()}_openRedirect(e,t,n,i){var s=this;return P(function*(){return yield s._originValidation(e),function Nke(r){Kr().location.href=r}(yield UJ(e,t,n,V9(),i)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(V3(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}initAndGetManager(e){var t=this;return P(function*(){const n=yield function Nxe(r){return Dk.apply(this,arguments)}(e),i=new hxe(e);return n.register("authEvent",s=>(Fe(s?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=n,i})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Vk,{type:Vk},i=>{var s;const o=null===(s=i?.[0])||void 0===s?void 0:s[Vk];void 0!==o&&t(!!o),Rs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function vxe(r){return zk.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return oJ()||QA()||j_()}};var jJ="@firebase/auth";class Gxe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return P(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const jxe=yq("authIdTokenMaxAge")||300;let YJ=null;const Zxe=r=>function(){var e=P(function*(t){const n=t&&(yield t.getIdTokenResult()),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>jxe)return;const s=n?.token;YJ!==s&&(YJ=s,yield fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function Yxe(r=sT()){const e=q8(r,"auth");if(e.isInitialized())return e.getImmediate();const t=function xIe(r,e){const t=q8(r,"auth");if(t.isInitialized()){const i=t.getImmediate();if(Jg(t.getOptions(),e??{}))return i;Rs(i,"already-initialized")}return t.initialize({options:e})}(r,{popupRedirectResolver:Bxe,persistence:[Hke,Tke,NJ]}),n=yq("authTokenSyncURL");if(n){const s=Zxe(n);(function mke(r,e,t){pr(r).beforeAuthStateChanged(e,t)})(t,s,()=>s(t.currentUser)),function gke(r,e,t,n){pr(r).onIdTokenChanged(e,t,n)}(t,o=>s(o))}const i=vq("auth");return i&&gJ(t,`http://${i}`),t}!function Wxe(r){ss(new wi("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;Fe(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:o,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:aJ(r)},l=new kIe(n,i,s,c);return function LIe(r,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(B3);e?.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e?.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ss(new wi("auth-internal",e=>{const t=k2(e.getProvider("auth").getImmediate());return new Gxe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),gr(jJ,"0.23.2",function Uxe(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),gr(jJ,"0.23.2","esm2017")}("Browser");class ov{constructor(e){return e}}class XJ{constructor(){return fA("auth")}}const $k=new tt("angularfire2.auth-instances");function Xxe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new ov(n)}}const Qxe={provide:XJ,deps:[[new es,$k]]},Jxe={provide:ov,useFactory:function Kxe(r,e){const t=uA("auth",r,e);return t&&new ov(t)},deps:[[new es,$k],L5]};let eLe=(()=>{class r{constructor(){gr("angularfire",R_.full,"auth")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({providers:[Jxe,Qxe]}),r})();const rLe=D1(ike,!0),iLe=D1(Yxe,!0),sLe=D1(_ke,!0),oLe=D1(ake,!0),aLe=D1(nke,!0),cLe=D1(ske,!0),lLe=D1(ixe,!0),uLe=D1(lke,!0);class cl{constructor(e){return e}}const QJ="firestore",Bk=new tt("angularfire2.firestore-instances");function hLe(r){return(e,t)=>{const n=e.runOutsideAngular(()=>r(t));return new cl(n)}}const pLe={provide:class fLe{constructor(){return fA(QJ)}},deps:[[new es,Bk]]},gLe={provide:cl,useFactory:function dLe(r,e){const t=uA(QJ,r,e);return t&&new cl(t)},deps:[[new es,Bk],L5]};let mLe=(()=>{class r{constructor(){gr("angularfire",R_.full,"fst")}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({providers:[gLe,pLe]}),r})();const vLe=D1(LOe,!0),CLe=D1(lOe,!0),MLe=D1(xOe,!0),X9=D1(qK,!0),ELe=D1(NOe,!0),SLe=D1(AOe,!0),PLe=D1(dOe,!0),TLe=D1(TOe,!0),JJ=D1(ROe,!0),OLe=D1(POe,!0),av=D1(EOe,!0),bLe=D1(IOe,!0),wLe=D1(kOe,!0),NLe=D1(SOe,!0);class o0{constructor(e,t){u(this,"collectionName",void 0),u(this,"firestore",void 0),u(this,"collection",void 0),u(this,"subDAOs",{}),this.collectionName=e,this.firestore=t;this.collection=CLe(t,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var t=this;return P(function*(){return(yield vLe(t.collection,e)).id})()}read(e){var t=this;return P(function*(){const n=yield ELe(X9(t.collection,e));return n.exists()?g.of(K.getNonNullable(n.data())):g.empty()})()}exists(e){var t=this;return P(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var n=this;return P(function*(){return wLe(X9(n.collection,e),t)})()}delete(e){return MLe(X9(this.collection,e))}set(e,t){return bLe(X9(this.collection,e),t)}subscribeToChanges(e,t){return new En(JJ(X9(this.collection,e),n=>{t(g.ofNullable(n.data()))}))}findWhere(e,t,n){var i=this;return P(function*(){const s=i.constructQuery(e,t,n);return(yield SLe(s)).docs.map(a=>({id:a.id,data:a.data()}))})()}observingWhere(e,t,n){const i=this.constructQuery(e,n);return new En(JJ(i,s=>{const o=[],a=[],c=[];s.docChanges().forEach(l=>{const f={id:l.doc.id,data:l.doc.data()};switch(l.type){case"added":o.push(f);break;case"modified":a.push(f);break;case"removed":c.push(f)}}),o.length>0&&(we.display("FirestoreDAO","subscription","firebase gave us "+o.length+" NEW "+this.collectionName),t.onDocumentCreated(o)),a.length>0&&(we.display("FirestoreDAO","subscription","firebase gave us "+a.length+" MODIFIED "+this.collectionName),t.onDocumentModified(a)),c.length>0&&(we.display("FirestoreDAO","subscription","firebase gave us "+c.length+" DELETED "+this.collectionName),t.onDocumentDeleted(c))}))}constructQuery(e,t,n){let i=av(this.collection);null!=t&&(i=av(i,OLe(t))),null!=n&&(i=av(i,TLe(n)));for(const s of e)i=av(i,NLe(s[0],s[1],s[2]));return i}subCollectionDAO(e,t){const n=`${this.collection.path}/${e}/${t}`;if(n in this.subDAOs)return this.subDAOs[n];{const i=new class extends o0{constructor(s){super(n,s)}}(this.firestore);return this.subDAOs[n]=i,i}}}let ALe=(()=>{var r;class e extends o0{constructor(n){super("errors",n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(cl))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var ILe=Eo(1);let Wt=(()=>{var r;class e{infoMessage(n){this.message(n,"is-info")}gameMessage(n){this.message(n,"is-warning")}criticalMessage(n){this.message(n,"is-danger")}message(n,i){const s=this.getDuration(n);this.toast(n,i,s)}toast(n,i,s){(0,ILe.toast)({message:n,duration:s,type:i,position:"top-center",closeOnClick:!0,dismissible:!0})}getDuration(n){const i=n.split(" ").length;return Math.max(60*i*1e3/150,3e3)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var cv,a0;class c2{static setSingletonInstance(e){c2.singleton=g.of(e)}static logErrorAndFail(e,t,n){throw c2.logError(e,t,n),new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`)}static logError(e,t,n){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(n)})`);return this.singleton.get().logError(e,t,n),b.failure(e+": "+t)}constructor(e,t,n){u(this,"errorDAO",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),this.errorDAO=e,this.router=t,this.messageDisplayer=n,c2.setSingletonInstance(this)}findErrors(e,t,n,i){return this.errorDAO.findWhere(void 0===i?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",i]])}logError(e,t,n){var i=this;return P(function*(){i.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const s=i.router.url,o=yield i.findErrors(e,s,t,n);if(0===o.length){const a={component:e,route:s,message:t,firstEncounter:Nc(),lastEncounter:Nc(),occurences:1};null!=n&&(a.data=n),yield i.errorDAO.create(a)}else{const a=o[0].id,c=o[0].data;yield i.errorDAO.update(a,{lastEncounter:Nc(),occurences:c.occurences+1})}})()}}cv=c2,u(c2,"singleton",g.empty()),u(c2,"\u0275fac",function(e){return new(e||cv)(Pe(ALe),Pe(Bn),Pe(Wt))}),u(c2,"\u0275prov",De({token:cv,factory:cv.\u0275fac,providedIn:"root"}));class we{static enableLog(e,t,n){const i=localStorage.getItem("verbosity");let s={};null!=i&&(s=JSON.parse(i)),n?s[t+"."+n]=e:s[t]=e,localStorage.setItem("verbosity",JSON.stringify(s))}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];const n=JSON.parse(t);return null==n[e]?[!1,!1]:(K.assert(Array.isArray(n[e]),`malformed verbosity levels: ${n[e]}`),n[e])}static isMethodVerboseEntry(e,t){return we.isVerbose(e)[0]||we.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return we.isVerbose(e)[1]||we.isVerbose(e+"."+t)[1]}static display(e,t,n){we.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${n}`)}static log(e){const t=e.name;for(const n of Object.getOwnPropertyNames(e.prototype)){const i=Object.getOwnPropertyDescriptor(e.prototype,n),s=K.getNonNullable(i);K.assert(s.value instanceof Function,"cannot add logging to properties that are not methods!");const a=s.value;s.value=function(...c){if(we.isMethodVerboseEntry(t,n)){const f=Array.from(c).map(d=>JSON.stringify(d)).join(", ");console.log(`> ${t}.${n}(${f})`)}const l=a.apply(this,c);return we.isMethodVerboseExit(t,n)&&console.log(`< ${t}.${n} -> ${JSON.stringify(l)}`),l},Object.defineProperty(e.prototype,n,s)}}}window.enableLog=we.enableLog;class K{static expectToBe(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let n=!1;for(const i of t)if(e===i){n=!0;break}if(!1===n)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw c2.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let Gk=(u(a0=class extends o0{constructor(e){super("chats",e)}},"\u0275fac",function(e){return new(e||a0)(Pe(cl))}),u(a0,"\u0275prov",De({token:a0,factory:a0.\u0275fac,providedIn:"root"})),a0);var c0;Gk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],Gk);let eee=(()=>{class r{}return u(r,"CANNOT_SEND_MESSAGE",()=>$localize`You're not allowed to send a message here.`),u(r,"FORBIDDEN_MESSAGE",()=>$localize`This message is forbidden.`),r})(),F5=(c0=class{constructor(e){u(this,"chatDAO",void 0),this.chatDAO=e}addMessage(e,t){var n=this;return P(function*(){return n.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var n=this;return P(function*(){return n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return P(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return P(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,n,i){var s=this;return P(function*(){if(!1===s.userCanSendMessage(t.name,e))return b.failure(eee.CANNOT_SEND_MESSAGE());if(s.isForbiddenMessage(n))return b.failure(eee.FORBIDDEN_MESSAGE());const o={content:n,sender:t,postedTime:Nc(),currentTurn:i};return yield s.addMessage(e,o),b.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}},u(c0,"\u0275fac",function(e){return new(e||c0)(Pe(Gk))}),u(c0,"\u0275prov",De({token:c0,factory:c0.\u0275fac,providedIn:"root"})),c0);function Ve(r,e,t){if(!1===r)throw void 0!==t&&console.log(t),c2.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var U3,Uk;F5=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],F5);let Q9=(Uk=U3=class extends o0{constructor(e){super(Uk.COLLECTION_NAME,e)}},u(U3,"COLLECTION_NAME","users"),u(U3,"\u0275fac",function(e){return new(e||U3)(Pe(cl))}),u(U3,"\u0275prov",De({token:U3,factory:U3.\u0275fac,providedIn:"root"})),U3);Q9=Uk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],Q9);let $5=(()=>{var r;class e{constructor(n){u(this,"userDAO",void 0),this.userDAO=n}usernameIsAvailable(n){var i=this;return P(function*(){return 0===(yield i.userDAO.findWhere([["username","==",n]])).length})()}setUsername(n,i){var s=this;return P(function*(){yield s.userDAO.update(n,{username:i})})()}markAsVerified(n){var i=this;return P(function*(){yield i.userDAO.update(n,{verified:!0})})()}observeUserOnServer(n,i){return this.userDAO.subscribeToChanges(n,s=>{s.isPresent()&&null===s.get().lastUpdateTime||i(s)})}getUserLastUpdateTime(n){var i=this;return P(function*(){const s=yield i.userDAO.read(n);if(s.isAbsent())return g.empty();{const o=s.get().lastUpdateTime;return Ve(null!=o,"should not receive a lastUpdateTime equal to null"),g.of(o)}})()}updatePresenceToken(n){return this.userDAO.update(n,{lastUpdateTime:Nc()})}getServerTime(n){var i=this;return P(function*(){return new Promise(s=>{let o=!1;const c=i.userDAO.subscribeToChanges(n,l=>{null==l.get().lastUpdateTime?o=!0:o&&(c.unsubscribe(),s(l.get().lastUpdateTime))});i.updatePresenceToken(n)})})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(Q9))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();class tee extends Ms{constructor(e=1/0,t=1/0,n=nA){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(n.push(e),!i&&n.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=n?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!i){const o=t.now();let a=0;for(let c=1;c<n.length&&n[c]<=o;c+=2)a=c;a&&n.splice(0,a+1)}}}var l0;let J9=(()=>{class r{}return u(r,"YOU_ARE_ALREADY_PLAYING",()=>$localize`You are already playing in another game.`),u(r,"YOU_ARE_ALREADY_CREATING",()=>$localize`You are already the creator of another game.`),u(r,"YOU_ARE_ALREADY_CHOSEN_OPPONENT",()=>$localize`You are already the chosen opponent in another game.`),u(r,"YOU_ARE_ALREADY_CANDIDATE",()=>$localize`You are already candidate in another game.`),u(r,"YOU_ARE_ALREADY_OBSERVING",()=>$localize`You are already observing another game.`),r})();class ll{static createUserWithEmailAndPassword(e,t,n){return rLe(e,t,n)}static sendEmailVerification(e){return oLe(e)}static sendPasswordResetEmail(e,t){return aLe(e,t)}static signInWithEmailAndPassword(e,t,n){return P(function*(){return(yield cLe(e,t,n)).user})()}static signInWithPopup(e,t){return P(function*(){return(yield lLe(e,t)).user})()}static updateProfile(e,t){return uLe(e,t)}}class u0{constructor(e,t,n,i){u(this,"id",void 0),u(this,"email",void 0),u(this,"username",void 0),u(this,"verified",void 0),this.id=e,this.email=t,this.username=n,this.verified=i}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}u(u0,"NOT_CONNECTED",new u0("",g.empty(),g.empty(),!1));let sr=(l0=class{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"auth",void 0),u(this,"authSubscription",void 0),u(this,"user",g.empty()),u(this,"userRS",void 0),u(this,"userObs",void 0),u(this,"userSubscription",new En),this.userDAO=e,this.userService=t,this.auth=n,this.userRS=new tee(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new En(sLe(this.auth,function(){var s=P(function*(o){null==o?(we.display("ConnectedUserService","subscription","User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(u0.NOT_CONNECTED),i.user=g.empty()):(Ve(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(o.uid,a=>{if(a.isPresent()){const c=a.get(),l=c.username;we.display("ConnectedUserService","subscription",`User ${l} is connected, and the verified status is ${i.emailVerified(o)}`);const f=!0===i.emailVerified(o)&&null!=l;if(!0===f&&!1===c.verified)return i.userService.markAsVerified(o.uid);const d=new u0(o.uid,g.ofNullable(o.email),g.ofNullable(l),f);!1===i.user.equalsValue(d)&&(i.user=g.of(d),i.userRS.next(d))}}))});return function(o){return s.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return P(function*(){try{return yield ll.sendPasswordResetEmail(t.auth,e),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}doRegister(e,t,n){var i=this;return P(function*(){return(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,t,n):se.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,n){var i=this;return P(function*(){try{const s=yield ll.createUserWithEmailAndPassword(i.auth,t,n);yield ll.signInWithEmailAndPassword(i.auth,t,n);const o=K.getNonNullable(s.user);return yield i.createUser(o.uid,e),se.success(o)}catch(s){return se.failure(i.mapFirebaseError(s))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return c2.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return P(function*(){const t=g.ofNullable(e.auth.currentUser);if(!t.isPresent())return c2.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return c2.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield ll.sendEmailVerification(t.get()),b.SUCCESS}catch(n){return b.failure(e.mapFirebaseError(n))}})()}doEmailLogin(e,t){var n=this;return P(function*(){try{return yield ll.signInWithEmailAndPassword(n.auth,e,t),b.SUCCESS}catch(i){return b.failure(n.mapFirebaseError(i))}})()}createUser(e,t){var n=this;return P(function*(){null==t?yield n.userDAO.set(e,{verified:!1,currentGame:null}):yield n.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return P(function*(){return b.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return P(function*(){try{const t=new KIe;t.addScope("profile"),t.addScope("email");const n=yield ll.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(n.uid))&&(yield e.createUser(n.uid)),se.success(n)}catch(t){return se.failure(e.mapFirebaseError(t))}})()}disconnect(){var e=this;return P(function*(){return g.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),b.SUCCESS):b.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return P(function*(){if(""===e)return b.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return b.failure($localize`This username is already in use, please select a different one.`);const i=K.getNonNullable(t.auth.currentUser);return yield ll.updateProfile(i,{displayName:e}),yield t.userService.setUsername(i.uid,e),yield t.userService.markAsVerified(i.uid),yield t.reloadUser(),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}setPicture(e){var t=this;return P(function*(){try{const n=K.getNonNullable(t.auth.currentUser);return yield ll.updateProfile(n,{photoURL:e}),b.SUCCESS}catch(n){return b.failure(t.mapFirebaseError(n))}})()}reloadUser(){var e=this;return P(function*(){const t=K.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return Ve(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}},u(l0,"\u0275fac",function(e){return new(e||l0)(Pe(Q9),Pe($5),Pe(ov))}),u(l0,"\u0275prov",De({token:l0,factory:l0.\u0275fac,providedIn:"root"})),l0);var W3,uv,fv,ed,B5,X,f0;sr=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],sr);class A1{constructor(e){u(this,"value",void 0),this.value=e}}u(A1,"HARD_DRAW",new(W3=A1)(0)),u(A1,"RESIGN",new W3(1)),u(A1,"ESCAPE",new W3(2)),u(A1,"VICTORY",new W3(3)),u(A1,"TIMEOUT",new W3(4)),u(A1,"UNACHIEVED",new W3(5)),u(A1,"AGREED_DRAW_BY_ZERO",new W3(6)),u(A1,"AGREED_DRAW_BY_ONE",new W3(7));class lv{constructor(e,t){u(this,"id",void 0),u(this,"data",void 0),this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===A1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===A1.AGREED_DRAW_BY_ZERO.value||this.data.result===A1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===A1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(Ve(this.data.result===A1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),K.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===A1.VICTORY.value}isTimeout(){return this.data.result===A1.TIMEOUT.value}isResign(){return this.data.result===A1.RESIGN.value}getWinner(){return g.ofNullable(this.data.winner)}getLoser(){return g.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new lv(this.id,{...this.data,winner:e,loser:t})}}class x2{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"CREATOR":return x2.CREATOR;case"RANDOM":return x2.RANDOM;default:return Ve("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),x2.CHOSEN_PLAYER}}}u(x2,"CREATOR",new(uv=x2)("CREATOR")),u(x2,"RANDOM",new uv("RANDOM")),u(x2,"CHOSEN_PLAYER",new uv("CHOSEN_PLAYER"));class or{constructor(e){u(this,"value",void 0),this.value=e}static of(e){switch(e){case"STANDARD":return or.STANDARD;case"BLITZ":return or.BLITZ;case"CUSTOM":return or.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}u(or,"STANDARD",new(fv=or)("STANDARD")),u(or,"BLITZ",new fv("BLITZ")),u(or,"CUSTOM",new fv("CUSTOM")),u(or,"NORMAL_MOVE_DURATION",120),u(or,"NORMAL_PART_DURATION",1800),u(or,"BLITZ_MOVE_DURATION",30),u(or,"BLITZ_PART_DURATION",900);class ai{constructor(e){u(this,"value",void 0),this.value=e}}u(ai,"PART_CREATED",new(ed=ai)(0)),u(ai,"CONFIG_PROPOSED",new ed(2)),u(ai,"PART_STARTED",new ed(3)),u(ai,"PART_FINISHED",new ed(4));class Wk{constructor(){u(this,"value",2)}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}u(Wk,"NONE",new Wk);class I{static of(e){return 0===e?I.ZERO:(K.expectToBe(e,1),I.ONE)}static ofTurn(e){return e%2==0?I.ZERO:I.ONE}constructor(e){u(this,"value",void 0),this.value=e}isPlayer(){return!0}toString(){return this===I.ZERO?"PLAYER_ZERO":(K.expectToBe(this,I.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===I.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===I.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===I.ZERO?I.ONE:(K.expectToBe(this,I.ONE),I.ZERO)}}B5=I,u(I,"encoder",Ie.tuple([Ie.identity()],r=>[r.value],r=>B5.of(r[0]))),u(I,"ZERO",new B5(0)),u(I,"ONE",new B5(1)),u(I,"PLAYERS",[B5.ZERO,B5.ONE]),function(r){r.ZERO=I.ZERO,r.ONE=I.ONE,r.NONE=Wk.NONE,r.encoder=new class extends Ie{encode(e){return e.value}decode(e){return 2===e?r.NONE:(K.assert(0===e||1===e,"Invalid encoded player: "+e),I.of(e))}}}(X||(X={}));let td=(u(f0=class extends o0{constructor(e){super("parts",e)}},"\u0275fac",function(e){return new(e||f0)(Pe(cl))}),u(f0,"\u0275prov",De({token:f0,factory:f0.\u0275fac,providedIn:"root"})),f0);td=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],td);class dv{constructor(e,t,n){u(this,"onDocumentCreated",void 0),u(this,"onDocumentModified",void 0),u(this,"onDocumentDeleted",void 0),this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=n}}let qk=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}eventsCollection(n){return this.partDAO.subCollectionDAO(n,"events")}addEvent(n,i){return this.eventsCollection(n).create(i)}addMove(n,i,s){return this.addEvent(n,{eventType:"Move",time:Nc(),player:i.value,move:s})}addRequest(n,i,s){return this.addEvent(n,{eventType:"Request",time:Nc(),player:i.value,requestType:s})}addReply(n,i,s,o,a=null){return this.addEvent(n,{eventType:"Reply",time:Nc(),player:i.value,reply:s,requestType:o,data:a})}startGame(n,i){return this.addAction(n,i,"StartGame")}addAction(n,i,s){return this.addEvent(n,{eventType:"Action",time:Nc(),player:i.value,action:s})}subscribeToEvents(n,i){const s=new dv(o=>{const a=o.map(c=>c.data).filter(c=>null!=c.time);a.length>0&&i(a)},o=>{i(o.map(a=>a.data))},()=>{});return this.eventsCollection(n).observingWhere([],s,"time")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(td))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();var d0;let jk=(u(d0=class extends o0{constructor(e){super("config-room",e)}},"\u0275fac",function(e){return new(e||d0)(Pe(cl))}),u(d0,"\u0275prov",De({token:d0,factory:d0.\u0275fac,providedIn:"root"})),d0);var q3,Zk;jk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],jk);let nd=(q3=class{constructor(e,t){u(this,"configRoomDAO",void 0),u(this,"connectedUserService",void 0),this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let n=[];const i=new dv(o=>{for(const a of o)n.push(a.data);t(n)},o=>{for(const a of o)n=n.map(c=>c.id===a.data.id?a.data:c);t(n)},o=>{for(const a of o)n=n.filter(c=>c.id!==a.data.id);t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var t=this;return P(function*(){const n=t.connectedUserService.user.get().toMinimalUser();return t.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:x2.RANDOM.value,partType:or.STANDARD.value,partStatus:ai.PART_CREATED.value,maximalMoveDuration:or.NORMAL_MOVE_DURATION,totalPartDuration:or.NORMAL_PART_DURATION,creator:n})})()}joinGame(e){var t=this;return P(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);return i.isAbsent()?b.failure(Zk.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==n.id&&(yield t.addCandidate(e,n)),b.SUCCESS)})()}cancelJoining(e){var t=this;return P(function*(){const n=t.connectedUserService.user.get().toMinimalUser(),i=yield t.configRoomDAO.read(e);if(!i.isAbsent()){const s=i.get(),o=[t.removeCandidate(e,n)];s.chosenOpponent?.id===n.id&&o.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:ai.PART_CREATED.value})),yield Promise.all(o)}})()}deleteConfigRoom(e,t){var n=this;return P(function*(){yield Promise.all(t.map(i=>n.removeCandidate(e,i))),yield n.configRoomDAO.delete(e)})()}proposeConfig(e,t,n,i,s,o){var a=this;return P(function*(){return a.configRoomDAO.update(e,{partStatus:ai.CONFIG_PROPOSED.value,chosenOpponent:t,partType:n.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:s.value})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return P(function*(){return t.configRoomDAO.update(e,{partStatus:ai.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return P(function*(){return t.configRoomDAO.update(e,{partStatus:ai.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:ai.PART_STARTED.value})}createConfigRoom(e,t){var n=this;return P(function*(){return n.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return P(function*(){return(yield t.configRoomDAO.read(e)).get()})()}},Zk=q3,u(q3,"GAME_DOES_NOT_EXIST",()=>$localize`Game does not exist`),u(q3,"\u0275fac",function(e){return new(e||q3)(Pe(jk),Pe(sr))}),u(q3,"\u0275prov",De({token:q3,factory:q3.\u0275fac,providedIn:"root"})),q3);var h0;nd=Zk=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],nd);let G5=(h0=class{constructor(e,t,n,i,s){u(this,"partDAO",void 0),u(this,"gameEventService",void 0),u(this,"connectedUserService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),this.partDAO=e,this.gameEventService=t,this.connectedUserService=n,this.configRoomService=i,this.chatService=s}update(e,t){var n=this;return P(function*(){return n.partDAO.update(e,t)})()}getPartValidity(e,t){var n=this;return P(function*(){const i=yield n.partDAO.read(e);return i.isAbsent()?b.failure("NONEXISTENT_PART"):i.get().typeGame===t?b.SUCCESS:b.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){const t=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:A1.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return P(function*(){const n=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(n),yield t.createChat(n),n})()}getStartingConfig(e){let n,i,t=x2.of(e.firstPlayer);return t===x2.RANDOM&&(t=Math.random()<.5?x2.CREATOR:x2.CHOSEN_PLAYER),t===x2.CREATOR?(n=e.creator,i=K.getNonNullable(e.chosenOpponent)):(n=K.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:n,playerOne:i,turn:0,beginning:Nc()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var n=this;return P(function*(){yield n.configRoomService.acceptConfig(e);const i=n.getStartingConfig(t);let s;s=i.playerZero===t.creator?I.ONE:I.ZERO,yield n.partDAO.update(e,i),yield n.gameEventService.startGame(e,s)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,n,i){var s=this;return P(function*(){const o={winner:n,loser:i,result:A1.RESIGN.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}notifyTimeout(e,t,n,i){var s=this;return P(function*(){const o={winner:n,loser:i,result:A1.TIMEOUT.value};yield s.partDAO.update(e,o),yield s.gameEventService.addAction(e,t,"EndGame")})()}proposeDraw(e,t){var n=this;return P(function*(){yield n.gameEventService.addRequest(e,t,"Draw")})()}acceptDraw(e,t){var n=this;return P(function*(){yield n.gameEventService.addReply(e,t,"Accept","Draw");const s={result:(t===I.ZERO?A1.AGREED_DRAW_BY_ZERO:A1.AGREED_DRAW_BY_ONE).value};yield n.partDAO.update(e,s),yield n.gameEventService.addAction(e,t,"EndGame")})()}refuseDraw(e,t){var n=this;return P(function*(){yield n.gameEventService.addReply(e,t,"Reject","Draw")})()}proposeRematch(e,t){var n=this;return P(function*(){yield n.gameEventService.addRequest(e,t,"Rematch")})()}rejectRematch(e,t){var n=this;return P(function*(){yield n.gameEventService.addReply(e,t,"Reject","Rematch")})()}acceptRematch(e,t){var n=this;return P(function*(){const i=K.getNonNullable(e.data),s=yield n.configRoomService.readConfigRoomById(e.id);let o;const a=n.connectedUserService.user.get().toMinimalUser();let c;i.playerZero.id===a.id?(c=K.getNonNullable(i.playerOne),o=x2.CHOSEN_PLAYER):(c=i.playerZero,o=x2.CREATOR);const l={...s,firstPlayer:o.value,creator:a,chosenOpponent:c,partStatus:ai.PART_STARTED.value},f=n.getStartingConfig(l),d={typeGame:i.typeGame,result:A1.UNACHIEVED.value,...f},m=yield n.partDAO.create(d);yield n.configRoomService.createConfigRoom(m,l),yield n.createChat(m),yield n.gameEventService.addReply(e.id,t,"Accept","Rematch",m),yield n.gameEventService.startGame(m,t.getOpponent())})()}askTakeBack(e,t){var n=this;return P(function*(){yield n.gameEventService.addRequest(e,t,"TakeBack")})()}acceptTakeBack(e,t,n){var i=this;return P(function*(){let s=t-1;s%2===n.value&&s--;const o={turn:s};return yield i.gameEventService.addReply(e,n,"Accept","TakeBack"),yield i.partDAO.update(e,o)})()}refuseTakeBack(e,t){var n=this;return P(function*(){yield n.gameEventService.addReply(e,t,"Reject","TakeBack")})()}addGlobalTime(e,t){var n=this;return P(function*(){yield n.gameEventService.addAction(e,t,"AddGlobalTime")})()}addTurnTime(e,t){var n=this;return P(function*(){yield n.gameEventService.addAction(e,t,"AddTurnTime")})()}preparePartUpdate(e,t){var n=this;return P(function*(){let o={turn:(yield n.partDAO.read(e)).get().turn+1};return o=n.updateScore(o,t),o})()}updatePart(e,t){var n=this;return P(function*(){const i=yield n.preparePartUpdate(e,t);yield n.update(e,i)})()}drawPart(e,t,n){var i=this;return P(function*(){let s=yield i.preparePartUpdate(e,n);s={...s,result:A1.HARD_DRAW.value},yield i.update(e,s),yield i.gameEventService.addAction(e,t,"EndGame")})()}endPartWithVictory(e,t,n,i,s){var o=this;return P(function*(){let a=yield o.preparePartUpdate(e,s);a={...a,winner:n,loser:i,result:A1.VICTORY.value},yield o.update(e,a),yield o.gameEventService.addAction(e,t,"EndGame")})()}addMove(e,t,n){var i=this;return P(function*(){yield i.gameEventService.addMove(e,t,n)})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get()[0],scorePlayerOne:t.get()[1]}:e}},u(h0,"\u0275fac",function(e){return new(e||h0)(Pe(td),Pe(qk),Pe(sr),Pe(nd),Pe(F5))}),u(h0,"\u0275prov",De({token:h0,factory:h0.\u0275fac,providedIn:"root"})),h0);G5=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],G5);var bee={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},xee={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Lee={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class rd{static getNavigatorLanguage(){return navigator.language}static getLocale(){const n=(localStorage.getItem("locale")??rd.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(i=>i===n)?n:"fr"}}let Vee=(()=>{var r;class e{changeTheme(n){localStorage.setItem("theme",n)}getTheme(){return g.ofNullable(localStorage.getItem("theme"))}changeLanguage(n){localStorage.setItem("locale",n.toLowerCase())}getLanguage(){return rd.getLocale()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),hv=(()=>{var r;class e{constructor(n,i){u(this,"document",void 0),u(this,"userSettingsService",void 0),u(this,"theme",void 0),u(this,"availableThemes",["dark","light"]),this.document=n,this.userSettingsService=i;const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const n=this.userSettingsService.getTheme();if(n.isPresent()){const i=n.get();if(this.availableThemes.some(s=>s===i))return g.of(i)}return g.empty()}loadTheme(n){this.loadStyle(n+".css"),this.theme=n}loadStyle(n){const i=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=n;else{const o=this.document.createElement("link");o.id="theme",o.rel="stylesheet",o.href=`${n}`,i.appendChild(o)}}getTheme(){return this.theme}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(P2),Pe(Vee))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Fee(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ct(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Fee(Object(t),!0).forEach(function(n){l2(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Fee(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function pv(r){return(pv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(r)}function $ee(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function l2(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Kk(r,e){return function NGe(r){if(Array.isArray(r))return r}(r)||function IGe(r,e){var t=null==r?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var o,a,n=[],i=!0,s=!1;try{for(t=t.call(r);!(i=(o=t.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(c){s=!0,a=c}finally{try{!i&&null!=t.return&&t.return()}finally{if(s)throw a}}return n}}(r,e)||Bee(r,e)||function xGe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sd(r){return function wGe(r){if(Array.isArray(r))return Xk(r)}(r)||function AGe(r){if(typeof Symbol<"u"&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(r)||Bee(r)||function kGe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bee(r,e){if(r){if("string"==typeof r)return Xk(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if("Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t)return Array.from(r);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Xk(r,e)}}function Xk(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}var Gee=function(){},Qk={},Uee={},Wee=null,qee={mark:Gee,measure:Gee};try{typeof window<"u"&&(Qk=window),typeof document<"u"&&(Uee=document),typeof MutationObserver<"u"&&(Wee=MutationObserver),typeof performance<"u"&&(qee=performance)}catch{}var _v,vv,Cv,yv,Mv,jee=(Qk.navigator||{}).userAgent,Zee=void 0===jee?"":jee,ul=Qk,H1=Uee,Yee=Wee,mv=qee,j3=!!H1.documentElement&&!!H1.head&&"function"==typeof H1.addEventListener&&"function"==typeof H1.createElement,Kee=~Zee.indexOf("MSIE")||~Zee.indexOf("Trident/"),Z3="___FONT_AWESOME___",Xee="fa",Qee="svg-inline--fa",p0="data-fa-i2svg",ex="data-fa-pseudo-element",RGe="data-fa-pseudo-element-pending",tx="data-prefix",nx="data-icon",Jee="fontawesome-i2svg",zGe="async",DGe=["HTML","HEAD","STYLE","SCRIPT"],ete=function(){try{return!0}catch{return!1}}(),V1="classic",yr="sharp",rx=[V1,yr];function od(r){return new Proxy(r,{get:function(t,n){return n in t?t[n]:t[V1]}})}var ad=od((l2(_v={},V1,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),l2(_v,yr,{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light"}),_v)),cd=od((l2(vv={},V1,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),l2(vv,yr,{solid:"fass",regular:"fasr",light:"fasl"}),vv)),ld=od((l2(Cv={},V1,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),l2(Cv,yr,{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light"}),Cv)),HGe=od((l2(yv={},V1,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),l2(yv,yr,{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl"}),yv)),VGe=/fa(s|r|l|t|d|b|k|ss|sr|sl)?[\-\ ]/,tte="fa-layers-text",FGe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,$Ge=od((l2(Mv={},V1,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),l2(Mv,yr,{900:"fass",400:"fasr",300:"fasl"}),Mv)),nte=[1,2,3,4,5,6,7,8,9,10],BGe=nte.concat([11,12,13,14,15,16,17,18,19,20]),GGe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],g0={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},ud=new Set;Object.keys(cd[V1]).map(ud.add.bind(ud)),Object.keys(cd[yr]).map(ud.add.bind(ud));var UGe=[].concat(rx,sd(ud),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",g0.GROUP,g0.SWAP_OPACITY,g0.PRIMARY,g0.SECONDARY]).concat(nte.map(function(r){return"".concat(r,"x")})).concat(BGe.map(function(r){return"w-".concat(r)})),fd=ul.FontAwesomeConfig||{};H1&&"function"==typeof H1.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(r){var e=Kk(r,2),n=e[1],i=function qGe(r){return""===r||"false"!==r&&("true"===r||r)}(function WGe(r){var e=H1.querySelector("script["+r+"]");if(e)return e.getAttribute(r)}(e[0]));null!=i&&(fd[n]=i)});var rte={styleDefault:"solid",familyDefault:"classic",cssPrefix:Xee,replacementClass:Qee,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};fd.familyPrefix&&(fd.cssPrefix=fd.familyPrefix);var U5=ct(ct({},rte),fd);U5.autoReplaceSvg||(U5.observeMutations=!1);var _t={};Object.keys(rte).forEach(function(r){Object.defineProperty(_t,r,{enumerable:!0,set:function(t){U5[r]=t,dd.forEach(function(n){return n(_t)})},get:function(){return U5[r]}})}),Object.defineProperty(_t,"familyPrefix",{enumerable:!0,set:function(e){U5.cssPrefix=e,dd.forEach(function(t){return t(_t)})},get:function(){return U5.cssPrefix}}),ul.FontAwesomeConfig=_t;var dd=[],xc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1},KGe="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function hd(){for(var r=12,e="";r-- >0;)e+=KGe[62*Math.random()|0];return e}function W5(r){for(var e=[],t=(r||[]).length>>>0;t--;)e[t]=r[t];return e}function ix(r){return r.classList?W5(r.classList):(r.getAttribute("class")||"").split(" ").filter(function(e){return e})}function ite(r){return"".concat(r).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ev(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(r[t].trim(),";")},"")}function sx(r){return r.size!==xc.size||r.x!==xc.x||r.y!==xc.y||r.rotate!==xc.rotate||r.flipX||r.flipY}var eUe=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    -webkit-transition-delay: 0s;\n            transition-delay: 0s;\n    -webkit-transition-duration: 0s;\n            transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function ste(){var r=Xee,e=Qee,t=_t.cssPrefix,n=_t.replacementClass,i=eUe;if(t!==r||n!==e){var s=new RegExp("\\.".concat(r,"\\-"),"g"),o=new RegExp("\\--".concat(r,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(s,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(a,".".concat(n))}return i}var ote=!1;function ox(){_t.autoAddCss&&!ote&&(function YGe(r){if(r&&j3){var e=H1.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=r;for(var t=H1.head.childNodes,n=null,i=t.length-1;i>-1;i--){var s=t[i],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(n=s)}H1.head.insertBefore(e,n)}}(ste()),ote=!0)}var tUe={mixout:function(){return{dom:{css:ste,insertCss:ox}}},hooks:function(){return{beforeDOMElementCreation:function(){ox()},beforeI2svg:function(){ox()}}}},Y3=ul||{};Y3[Z3]||(Y3[Z3]={}),Y3[Z3].styles||(Y3[Z3].styles={}),Y3[Z3].hooks||(Y3[Z3].hooks={}),Y3[Z3].shims||(Y3[Z3].shims=[]);var Ea=Y3[Z3],ate=[],Sv=!1;function pd(r){var e=r.tag,t=r.attributes,n=void 0===t?{}:t,i=r.children,s=void 0===i?[]:i;return"string"==typeof r?ite(r):"<".concat(e," ").concat(function XGe(r){return Object.keys(r||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(ite(r[t]),'" ')},"").trim()}(n),">").concat(s.map(pd).join(""),"</").concat(e,">")}function cte(r,e,t){if(r&&r[e]&&r[e][t])return{prefix:e,iconName:t,icon:r[e][t]}}j3&&((Sv=(H1.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(H1.readyState))||H1.addEventListener("DOMContentLoaded",function r(){H1.removeEventListener("DOMContentLoaded",r),Sv=1,ate.map(function(e){return e()})}));var ax=function(e,t,n,i){var c,l,f,s=Object.keys(e),o=s.length,a=void 0!==i?function(e,t){return function(n,i,s,o){return e.call(t,n,i,s,o)}}(t,i):t;for(void 0===n?(c=1,f=e[s[0]]):(c=0,f=n);c<o;c++)f=a(f,e[l=s[c]],l,e);return f};function cx(r){var e=function sUe(r){for(var e=[],t=0,n=r.length;t<n;){var i=r.charCodeAt(t++);if(i>=55296&&i<=56319&&t<n){var s=r.charCodeAt(t++);56320==(64512&s)?e.push(((1023&i)<<10)+(1023&s)+65536):(e.push(i),t--)}else e.push(i)}return e}(r);return 1===e.length?e[0].toString(16):null}function lte(r){return Object.keys(r).reduce(function(e,t){var n=r[t];return n.icon?e[n.iconName]=n.icon:e[t]=n,e},{})}function lx(r,e){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipHooks,i=void 0!==n&&n,s=lte(e);"function"!=typeof Ea.hooks.addPack||i?Ea.styles[r]=ct(ct({},Ea.styles[r]||{}),s):Ea.hooks.addPack(r,lte(e)),"fas"===r&&lx("fa",e)}var Pv,Tv,Ov,q5=Ea.styles,aUe=Ea.shims,cUe=(l2(Pv={},V1,Object.values(ld[V1])),l2(Pv,yr,Object.values(ld[yr])),Pv),ux=null,ute={},fte={},dte={},hte={},pte={},lUe=(l2(Tv={},V1,Object.keys(ad[V1])),l2(Tv,yr,Object.keys(ad[yr])),Tv);var gte=function(){var e=function(s){return ax(q5,function(o,a,c){return o[c]=ax(a,s,{}),o},{})};ute=e(function(i,s,o){return s[3]&&(i[s[3]]=o),s[2]&&s[2].filter(function(c){return"number"==typeof c}).forEach(function(c){i[c.toString(16)]=o}),i}),fte=e(function(i,s,o){return i[o]=o,s[2]&&s[2].filter(function(c){return"string"==typeof c}).forEach(function(c){i[c]=o}),i}),pte=e(function(i,s,o){var a=s[2];return i[o]=o,a.forEach(function(c){i[c]=o}),i});var t="far"in q5||_t.autoFetchSvg,n=ax(aUe,function(i,s){var o=s[0],a=s[1],c=s[2];return"far"===a&&!t&&(a="fas"),"string"==typeof o&&(i.names[o]={prefix:a,iconName:c}),"number"==typeof o&&(i.unicodes[o.toString(16)]={prefix:a,iconName:c}),i},{names:{},unicodes:{}});dte=n.names,hte=n.unicodes,ux=bv(_t.styleDefault,{family:_t.familyDefault})};function fx(r,e){return(ute[r]||{})[e]}function m0(r,e){return(pte[r]||{})[e]}function mte(r){return dte[r]||{prefix:null,iconName:null}}function dl(){return ux}(function ZGe(r){dd.push(r)})(function(r){ux=bv(r.styleDefault,{family:_t.familyDefault})}),gte();var dx=function(){return{prefix:null,iconName:null,rest:[]}};function bv(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).family,n=void 0===t?V1:t;return cd[n][r]||cd[n][ad[n][r]]||(r in Ea.styles?r:null)||null}var _te=(l2(Ov={},V1,Object.keys(ld[V1])),l2(Ov,yr,Object.keys(ld[yr])),Ov);function wv(r){var e,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).skipLookups,i=void 0!==n&&n,s=(l2(e={},V1,"".concat(_t.cssPrefix,"-").concat(V1)),l2(e,yr,"".concat(_t.cssPrefix,"-").concat(yr)),e),o=null,a=V1;(r.includes(s[V1])||r.some(function(l){return _te[V1].includes(l)}))&&(a=V1),(r.includes(s[yr])||r.some(function(l){return _te[yr].includes(l)}))&&(a=yr);var c=r.reduce(function(l,f){var d=function fUe(r,e){var t=e.split("-"),n=t[0],i=t.slice(1).join("-");return n!==r||""===i||function uUe(r){return~UGe.indexOf(r)}(i)?null:i}(_t.cssPrefix,f);if(q5[f]?(f=cUe[a].includes(f)?HGe[a][f]:f,o=f,l.prefix=f):lUe[a].indexOf(f)>-1?(o=f,l.prefix=bv(f,{family:a})):d?l.iconName=d:f!==_t.replacementClass&&f!==s[V1]&&f!==s[yr]&&l.rest.push(f),!i&&l.prefix&&l.iconName){var m="fa"===o?mte(l.iconName):{},M=m0(l.prefix,l.iconName);m.prefix&&(o=null),l.iconName=m.iconName||M||l.iconName,l.prefix=m.prefix||l.prefix,"far"===l.prefix&&!q5.far&&q5.fas&&!_t.autoFetchSvg&&(l.prefix="fas")}return l},dx());return(r.includes("fa-brands")||r.includes("fab"))&&(c.prefix="fab"),(r.includes("fa-duotone")||r.includes("fad"))&&(c.prefix="fad"),!c.prefix&&a===yr&&(q5.fass||_t.autoFetchSvg)&&(c.prefix="fass",c.iconName=m0(c.prefix,c.iconName)||c.iconName),("fa"===c.prefix||"fa"===o)&&(c.prefix=dl()||"fas"),c}var pUe=function(){function r(){(function TGe(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")})(this,r),this.definitions={}}return function OGe(r,e,t){e&&$ee(r.prototype,e),t&&$ee(r,t),Object.defineProperty(r,"prototype",{writable:!1})}(r,[{key:"add",value:function(){for(var t=this,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var o=i.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(a){t.definitions[a]=ct(ct({},t.definitions[a]||{}),o[a]),lx(a,o[a]);var c=ld[V1][a];c&&lx(c,o[a]),gte()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,n){var i=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(i).map(function(s){var o=i[s],a=o.prefix,c=o.iconName,l=o.icon,f=l[2];t[a]||(t[a]={}),f.length>0&&f.forEach(function(d){"string"==typeof d&&(t[a][d]=l)}),t[a][c]=l}),t}}]),r}(),vte=[],j5={},Z5={},gUe=Object.keys(Z5);function hx(r,e){for(var t=arguments.length,n=new Array(t>2?t-2:0),i=2;i<t;i++)n[i-2]=arguments[i];return(j5[r]||[]).forEach(function(o){e=o.apply(null,[e].concat(n))}),e}function _0(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];(j5[r]||[]).forEach(function(s){s.apply(null,t)})}function K3(){var r=arguments[0],e=Array.prototype.slice.call(arguments,1);return Z5[r]?Z5[r].apply(null,e):void 0}function px(r){"fa"===r.prefix&&(r.prefix="fas");var e=r.iconName,t=r.prefix||dl();if(e)return e=m0(t,e)||e,cte(Cte.definitions,t,e)||cte(Ea.styles,t,e)}var Cte=new pUe,vUe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return j3?(_0("beforeI2svg",e),K3("pseudoElements2svg",e),K3("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===_t.autoReplaceSvg&&(_t.autoReplaceSvg=!0),_t.observeMutations=!0,function rUe(r){j3&&(Sv?setTimeout(r,0):ate.push(r))}(function(){yUe({autoReplaceSvgRoot:t}),_0("watch",e)})}},co={noAuto:function(){_t.autoReplaceSvg=!1,_t.observeMutations=!1,_0("noAuto")},config:_t,dom:vUe,parse:{icon:function(e){if(null===e)return null;if("object"===pv(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:m0(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],n=bv(e[0]);return{prefix:n,iconName:m0(n,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(_t.cssPrefix,"-"))>-1||e.match(VGe))){var i=wv(e.split(" "),{skipLookups:!0});return{prefix:i.prefix||dl(),iconName:m0(i.prefix,i.iconName)||i.iconName}}if("string"==typeof e){var s=dl();return{prefix:s,iconName:m0(s,e)||e}}}},library:Cte,findIconDefinition:px,toHtml:pd},yUe=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).autoReplaceSvgRoot,n=void 0===t?H1:t;(Object.keys(Ea.styles).length>0||_t.autoFetchSvg)&&j3&&_t.autoReplaceSvg&&co.dom.i2svg({node:n})};function Nv(r,e){return Object.defineProperty(r,"abstract",{get:e}),Object.defineProperty(r,"html",{get:function(){return r.abstract.map(function(n){return pd(n)})}}),Object.defineProperty(r,"node",{get:function(){if(j3){var n=H1.createElement("div");return n.innerHTML=r.html,n.children}}}),r}function gx(r){var e=r.icons,t=e.main,n=e.mask,i=r.prefix,s=r.iconName,o=r.transform,a=r.symbol,c=r.title,l=r.maskId,f=r.titleId,d=r.extra,m=r.watchable,M=void 0!==m&&m,w=n.found?n:t,L=w.width,z=w.height,$="fak"===i,B=[_t.replacementClass,s?"".concat(_t.cssPrefix,"-").concat(s):""].filter(function(Et){return-1===d.classes.indexOf(Et)}).filter(function(Et){return""!==Et||!!Et}).concat(d.classes).join(" "),de={children:[],attributes:ct(ct({},d.attributes),{},{"data-prefix":i,"data-icon":s,class:B,role:d.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(L," ").concat(z)})},_e=$&&!~d.classes.indexOf("fa-fw")?{width:"".concat(L/z*16*.0625,"em")}:{};M&&(de.attributes[p0]=""),c&&(de.children.push({tag:"title",attributes:{id:de.attributes["aria-labelledby"]||"title-".concat(f||hd())},children:[c]}),delete de.attributes.title);var xe=ct(ct({},de),{},{prefix:i,iconName:s,main:t,mask:n,maskId:l,transform:o,symbol:a,styles:ct(ct({},_e),d.styles)}),nt=n.found&&t.found?K3("generateAbstractMask",xe)||{children:[],attributes:{}}:K3("generateAbstractIcon",xe)||{children:[],attributes:{}},yn=nt.attributes;return xe.children=nt.children,xe.attributes=yn,a?function EUe(r){var t=r.iconName,n=r.children,i=r.attributes,s=r.symbol,o=!0===s?"".concat(r.prefix,"-").concat(_t.cssPrefix,"-").concat(t):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:ct(ct({},i),{},{id:o}),children:n}]}]}(xe):function MUe(r){var e=r.children,t=r.main,n=r.mask,i=r.attributes,s=r.styles,o=r.transform;if(sx(o)&&t.found&&!n.found){var l={x:t.width/t.height/2,y:.5};i.style=Ev(ct(ct({},s),{},{"transform-origin":"".concat(l.x+o.x/16,"em ").concat(l.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(xe)}function yte(r){var e=r.content,t=r.width,n=r.height,i=r.transform,s=r.title,o=r.extra,a=r.watchable,c=void 0!==a&&a,l=ct(ct(ct({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});c&&(l[p0]="");var f=ct({},o.styles);sx(i)&&(f.transform=function JGe(r){var e=r.transform,t=r.width,i=r.height,s=void 0===i?16:i,o=r.startCentered,a=void 0!==o&&o,c="";return c+=a&&Kee?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-s/2,"em) "):a?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(c+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:i,startCentered:!0,width:t,height:n}),f["-webkit-transform"]=f.transform);var d=Ev(f);d.length>0&&(l.style=d);var m=[];return m.push({tag:"span",attributes:l,children:[e]}),s&&m.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),m}var mx=Ea.styles;function _x(r){var e=r[0],t=r[1],s=Kk(r.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(s)?{tag:"g",attributes:{class:"".concat(_t.cssPrefix,"-").concat(g0.GROUP)},children:[{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(g0.SECONDARY),fill:"currentColor",d:s[0]}},{tag:"path",attributes:{class:"".concat(_t.cssPrefix,"-").concat(g0.PRIMARY),fill:"currentColor",d:s[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:s}}}}var PUe={found:!1,width:512,height:512};function vx(r,e){var t=e;return"fa"===e&&null!==_t.styleDefault&&(e=dl()),new Promise(function(n,i){if(K3("missingIconAbstract"),"fa"===t){var o=mte(r)||{};r=o.iconName||r,e=o.prefix||e}if(r&&e&&mx[e]&&mx[e][r])return n(_x(mx[e][r]));(function TUe(r,e){!ete&&!_t.showMissingIcons&&r&&console.error('Icon with name "'.concat(r,'" and prefix "').concat(e,'" is missing.'))})(r,e),n(ct(ct({},PUe),{},{icon:_t.showMissingIcons&&r&&K3("missingIconAbstract")||{}}))})}var Mte=function(){},Cx=_t.measurePerformance&&mv&&mv.mark&&mv.measure?mv:{mark:Mte,measure:Mte},gd='FA "6.4.2"',Ete=function(e){Cx.mark("".concat(gd," ").concat(e," ends")),Cx.measure("".concat(gd," ").concat(e),"".concat(gd," ").concat(e," begins"),"".concat(gd," ").concat(e," ends"))},yx={begin:function(e){return Cx.mark("".concat(gd," ").concat(e," begins")),function(){return Ete(e)}},end:Ete},Av=function(){};function Ste(r){return"string"==typeof(r.getAttribute?r.getAttribute(p0):null)}function AUe(r){return H1.createElementNS("http://www.w3.org/2000/svg",r)}function IUe(r){return H1.createElement(r)}function Pte(r){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ceFn,n=void 0===t?"svg"===r.tag?AUe:IUe:t;if("string"==typeof r)return H1.createTextNode(r);var i=n(r.tag);return Object.keys(r.attributes||[]).forEach(function(o){i.setAttribute(o,r.attributes[o])}),(r.children||[]).forEach(function(o){i.appendChild(Pte(o,{ceFn:n}))}),i}var Iv={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(i){t.parentNode.insertBefore(Pte(i),t)}),null===t.getAttribute(p0)&&_t.keepOriginalSource){var n=H1.createComment(function kUe(r){var e=" ".concat(r.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(n,t)}else t.remove()},nest:function(e){var t=e[0],n=e[1];if(~ix(t).indexOf(_t.replacementClass))return Iv.replace(e);var i=new RegExp("".concat(_t.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){var s=n[0].attributes.class.split(" ").reduce(function(a,c){return c===_t.replacementClass||c.match(i)?a.toSvg.push(c):a.toNode.push(c),a},{toNode:[],toSvg:[]});n[0].attributes.class=s.toSvg.join(" "),0===s.toNode.length?t.removeAttribute("class"):t.setAttribute("class",s.toNode.join(" "))}var o=n.map(function(a){return pd(a)}).join("\n");t.setAttribute(p0,""),t.innerHTML=o}};function Tte(r){r()}function Ote(r,e){var t="function"==typeof e?e:Av;if(0===r.length)t();else{var n=Tte;_t.mutateApproach===zGe&&(n=ul.requestAnimationFrame||Tte),n(function(){var i=function NUe(){return!0===_t.autoReplaceSvg?Iv.replace:Iv[_t.autoReplaceSvg]||Iv.replace}(),s=yx.begin("mutate");r.map(i),s(),t()})}}var Mx=!1;function bte(){Mx=!0}function Ex(){Mx=!1}var kv=null;function wte(r){if(Yee&&_t.observeMutations){var e=r.treeCallback,t=void 0===e?Av:e,n=r.nodeCallback,i=void 0===n?Av:n,s=r.pseudoElementsCallback,o=void 0===s?Av:s,a=r.observeMutationsRoot,c=void 0===a?H1:a;kv=new Yee(function(l){if(!Mx){var f=dl();W5(l).forEach(function(d){if("childList"===d.type&&d.addedNodes.length>0&&!Ste(d.addedNodes[0])&&(_t.searchPseudoElements&&o(d.target),t(d.target)),"attributes"===d.type&&d.target.parentNode&&_t.searchPseudoElements&&o(d.target.parentNode),"attributes"===d.type&&Ste(d.target)&&~GGe.indexOf(d.attributeName))if("class"===d.attributeName&&function bUe(r){var e=r.getAttribute?r.getAttribute(tx):null,t=r.getAttribute?r.getAttribute(nx):null;return e&&t}(d.target)){var m=wv(ix(d.target)),w=m.iconName;d.target.setAttribute(tx,m.prefix||f),w&&d.target.setAttribute(nx,w)}else(function wUe(r){return r&&r.classList&&r.classList.contains&&r.classList.contains(_t.replacementClass)})(d.target)&&i(d.target)})}}),j3&&kv.observe(c,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function Nte(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=function RUe(r){var e=r.getAttribute("data-prefix"),t=r.getAttribute("data-icon"),n=void 0!==r.innerText?r.innerText.trim():"",i=wv(ix(r));return i.prefix||(i.prefix=dl()),e&&t&&(i.prefix=e,i.iconName=t),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function dUe(r,e){return(fte[r]||{})[e]}(i.prefix,r.innerText)||fx(i.prefix,cx(r.innerText))),!i.iconName&&_t.autoFetchSvg&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=r.firstChild.data)),i}(r),n=t.iconName,i=t.prefix,s=t.rest,o=function zUe(r){var e=W5(r.attributes).reduce(function(i,s){return"class"!==i.name&&"style"!==i.name&&(i[s.name]=s.value),i},{}),t=r.getAttribute("title"),n=r.getAttribute("data-fa-title-id");return _t.autoA11y&&(t?e["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(n||hd()):(e["aria-hidden"]="true",e.focusable="false")),e}(r),a=hx("parseNodeAttributes",{},r),c=e.styleParser?function LUe(r){var e=r.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(n,i){var s=i.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(n[o]=a.join(":").trim()),n},{})),t}(r):[];return ct({iconName:n,title:r.getAttribute("title"),titleId:r.getAttribute("data-fa-title-id"),prefix:i,transform:xc,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:s,styles:c,attributes:o}},a)}var HUe=Ea.styles;function Ate(r){var e="nest"===_t.autoReplaceSvg?Nte(r,{styleParser:!1}):Nte(r);return~e.extra.classes.indexOf(tte)?K3("generateLayersText",r,e):K3("generateSvgReplacementMutation",r,e)}var hl=new Set;function Ite(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!j3)return Promise.resolve();var t=H1.documentElement.classList,n=function(d){return t.add("".concat(Jee,"-").concat(d))},i=function(d){return t.remove("".concat(Jee,"-").concat(d))},s=_t.autoFetchSvg?hl:rx.map(function(f){return"fa-".concat(f)}).concat(Object.keys(HUe));s.includes("fa")||s.push("fa");var o=[".".concat(tte,":not([").concat(p0,"])")].concat(s.map(function(f){return".".concat(f,":not([").concat(p0,"])")})).join(", ");if(0===o.length)return Promise.resolve();var a=[];try{a=W5(r.querySelectorAll(o))}catch{}if(!(a.length>0))return Promise.resolve();n("pending"),i("complete");var c=yx.begin("onTree"),l=a.reduce(function(f,d){try{var m=Ate(d);m&&f.push(m)}catch(M){ete||"MissingIcon"===M.name&&console.error(M)}return f},[]);return new Promise(function(f,d){Promise.all(l).then(function(m){Ote(m,function(){n("active"),n("complete"),i("pending"),"function"==typeof e&&e(),c(),f()})}).catch(function(m){c(),d(m)})})}function VUe(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Ate(r).then(function(t){t&&Ote([t],e)})}function FUe(r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(e||{}).icon?e:px(e||{}),i=t.mask;return i&&(i=(i||{}).icon?i:px(i||{})),r(n,ct(ct({},t),{},{mask:i}))}}rx.map(function(r){hl.add("fa-".concat(r))}),Object.keys(ad[V1]).map(hl.add.bind(hl)),Object.keys(ad[yr]).map(hl.add.bind(hl)),hl=sd(hl);var $Ue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,i=void 0===n?xc:n,s=t.symbol,o=void 0!==s&&s,a=t.mask,c=void 0===a?null:a,l=t.maskId,f=void 0===l?null:l,d=t.title,m=void 0===d?null:d,M=t.titleId,w=void 0===M?null:M,L=t.classes,z=void 0===L?[]:L,$=t.attributes,B=void 0===$?{}:$,de=t.styles,_e=void 0===de?{}:de;if(e){var xe=e.prefix,nt=e.iconName,gt=e.icon;return Nv(ct({type:"icon"},e),function(){return _0("beforeDOMElementCreation",{iconDefinition:e,params:t}),_t.autoA11y&&(m?B["aria-labelledby"]="".concat(_t.replacementClass,"-title-").concat(w||hd()):(B["aria-hidden"]="true",B.focusable="false")),gx({icons:{main:_x(gt),mask:c?_x(c.icon):{found:!1,width:null,height:null,icon:{}}},prefix:xe,iconName:nt,transform:ct(ct({},xc),i),symbol:o,title:m,maskId:f,titleId:w,extra:{attributes:B,styles:_e,classes:z}})})}},BUe={mixout:function(){return{icon:FUe($Ue)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=Ite,t.nodeCallback=VUe,t}}},provides:function(e){e.i2svg=function(t){var n=t.node,s=t.callback;return Ite(void 0===n?H1:n,void 0===s?function(){}:s)},e.generateSvgReplacementMutation=function(t,n){var i=n.iconName,s=n.title,o=n.titleId,a=n.prefix,c=n.transform,l=n.symbol,f=n.mask,d=n.maskId,m=n.extra;return new Promise(function(M,w){Promise.all([vx(i,a),f.iconName?vx(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(L){var z=Kk(L,2);M([t,gx({icons:{main:z[0],mask:z[1]},prefix:a,iconName:i,transform:c,symbol:l,maskId:d,title:s,titleId:o,extra:m,watchable:!0})])}).catch(w)})},e.generateAbstractIcon=function(t){var l,n=t.children,i=t.attributes,s=t.main,o=t.transform,c=Ev(t.styles);return c.length>0&&(i.style=c),sx(o)&&(l=K3("generateAbstractTransformGrouping",{main:s,transform:o,containerWidth:s.width,iconWidth:s.width})),n.push(l||s.icon),{children:n,attributes:i}}}},GUe={mixout:function(){return{layer:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.classes,s=void 0===i?[]:i;return Nv({type:"layer"},function(){_0("beforeDOMElementCreation",{assembler:t,params:n});var o=[];return t(function(a){Array.isArray(a)?a.map(function(c){o=o.concat(c.abstract)}):o=o.concat(a.abstract)}),[{tag:"span",attributes:{class:["".concat(_t.cssPrefix,"-layers")].concat(sd(s)).join(" ")},children:o}]})}}}},UUe={mixout:function(){return{counter:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.title,s=void 0===i?null:i,o=n.classes,a=void 0===o?[]:o,c=n.attributes,l=void 0===c?{}:c,f=n.styles,d=void 0===f?{}:f;return Nv({type:"counter",content:t},function(){return _0("beforeDOMElementCreation",{content:t,params:n}),function SUe(r){var e=r.content,t=r.title,n=r.extra,i=ct(ct(ct({},n.attributes),t?{title:t}:{}),{},{class:n.classes.join(" ")}),s=Ev(n.styles);s.length>0&&(i.style=s);var o=[];return o.push({tag:"span",attributes:i,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}({content:t.toString(),title:s,extra:{attributes:l,styles:d,classes:["".concat(_t.cssPrefix,"-layers-counter")].concat(sd(a))}})})}}}},WUe={mixout:function(){return{text:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.transform,s=void 0===i?xc:i,o=n.title,a=void 0===o?null:o,c=n.classes,l=void 0===c?[]:c,f=n.attributes,d=void 0===f?{}:f,m=n.styles,M=void 0===m?{}:m;return Nv({type:"text",content:t},function(){return _0("beforeDOMElementCreation",{content:t,params:n}),yte({content:t,transform:ct(ct({},xc),s),title:a,extra:{attributes:d,styles:M,classes:["".concat(_t.cssPrefix,"-layers-text")].concat(sd(l))}})})}}},provides:function(e){e.generateLayersText=function(t,n){var i=n.title,s=n.transform,o=n.extra,a=null,c=null;if(Kee){var l=parseInt(getComputedStyle(t).fontSize,10),f=t.getBoundingClientRect();a=f.width/l,c=f.height/l}return _t.autoA11y&&!i&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,yte({content:t.innerHTML,width:a,height:c,transform:s,title:i,extra:o,watchable:!0})])}}},qUe=new RegExp('"',"ug"),kte=[1105920,1112319];function xte(r,e){var t="".concat(RGe).concat(e.replace(":","-"));return new Promise(function(n,i){if(null!==r.getAttribute(t))return n();var o=W5(r.children).filter(function(gt){return gt.getAttribute(ex)===e})[0],a=ul.getComputedStyle(r,e),c=a.getPropertyValue("font-family").match(FGe),l=a.getPropertyValue("font-weight"),f=a.getPropertyValue("content");if(o&&!c)return r.removeChild(o),n();if(c&&"none"!==f&&""!==f){var d=a.getPropertyValue("content"),m=~["Sharp"].indexOf(c[2])?yr:V1,M=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(c[2])?cd[m][c[2].toLowerCase()]:$Ge[m][l],w=function jUe(r){var e=r.replace(qUe,""),t=function oUe(r,e){var i,t=r.length,n=r.charCodeAt(e);return n>=55296&&n<=56319&&t>e+1&&(i=r.charCodeAt(e+1))>=56320&&i<=57343?1024*(n-55296)+i-56320+65536:n}(e,0),n=t>=kte[0]&&t<=kte[1],i=2===e.length&&e[0]===e[1];return{value:cx(i?e[0]:e),isSecondary:n||i}}(d),L=w.value,z=w.isSecondary,$=c[0].startsWith("FontAwesome"),B=fx(M,L),de=B;if($){var _e=function hUe(r){var e=hte[r],t=fx("fas",r);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(L);_e.iconName&&_e.prefix&&(B=_e.iconName,M=_e.prefix)}if(!B||z||o&&o.getAttribute(tx)===M&&o.getAttribute(nx)===de)n();else{r.setAttribute(t,de),o&&r.removeChild(o);var xe=function DUe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:xc,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),nt=xe.extra;nt.attributes[ex]=e,vx(B,M).then(function(gt){var yn=gx(ct(ct({},xe),{},{icons:{main:gt,mask:dx()},prefix:M,iconName:de,extra:nt,watchable:!0})),Et=H1.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===e?r.insertBefore(Et,r.firstChild):r.appendChild(Et),Et.outerHTML=yn.map(function(W2){return pd(W2)}).join("\n"),r.removeAttribute(t),n()}).catch(i)}}else n()})}function ZUe(r){return Promise.all([xte(r,"::before"),xte(r,"::after")])}function YUe(r){return!(r.parentNode===document.head||~DGe.indexOf(r.tagName.toUpperCase())||r.getAttribute(ex)||r.parentNode&&"svg"===r.parentNode.tagName)}function Lte(r){if(j3)return new Promise(function(e,t){var n=W5(r.querySelectorAll("*")).filter(YUe).map(ZUe),i=yx.begin("searchPseudoElements");bte(),Promise.all(n).then(function(){i(),Ex(),e()}).catch(function(){i(),Ex(),t()})})}var Rte=!1,zte=function(e){return e.toLowerCase().split(" ").reduce(function(n,i){var s=i.toLowerCase().split("-"),o=s[0],a=s.slice(1).join("-");if(o&&"h"===a)return n.flipX=!0,n;if(o&&"v"===a)return n.flipY=!0,n;if(a=parseFloat(a),isNaN(a))return n;switch(o){case"grow":n.size=n.size+a;break;case"shrink":n.size=n.size-a;break;case"left":n.x=n.x-a;break;case"right":n.x=n.x+a;break;case"up":n.y=n.y-a;break;case"down":n.y=n.y+a;break;case"rotate":n.rotate=n.rotate+a}return n},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},Sx={x:0,y:0,width:"100%",height:"100%"};function Dte(r){return r.attributes&&(r.attributes.fill||!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(r.attributes.fill="black"),r}function JUe(r){return"g"===r.tag?r.children:[r]}var eWe={hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-mask"),s=i?wv(i.split(" ").map(function(o){return o.trim()})):dx();return s.prefix||(s.prefix=dl()),t.mask=s,t.maskId=n.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var n=t.children,i=t.attributes,s=t.main,o=t.mask,a=t.maskId,f=s.icon,m=o.icon,M=function QGe(r){var e=r.transform,n=r.iconWidth,i={transform:"translate(".concat(r.containerWidth/2," 256)")},s="translate(".concat(32*e.x,", ").concat(32*e.y,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(s," ").concat(o," ").concat(a)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:t.transform,containerWidth:o.width,iconWidth:s.width}),w={tag:"rect",attributes:ct(ct({},Sx),{},{fill:"white"})},L=f.children?{children:f.children.map(Dte)}:{},z={tag:"g",attributes:ct({},M.inner),children:[Dte(ct({tag:f.tag,attributes:ct(ct({},f.attributes),M.path)},L))]},$={tag:"g",attributes:ct({},M.outer),children:[z]},B="mask-".concat(a||hd()),de="clip-".concat(a||hd()),_e={tag:"mask",attributes:ct(ct({},Sx),{},{id:B,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[w,$]},xe={tag:"defs",children:[{tag:"clipPath",attributes:{id:de},children:JUe(m)},_e]};return n.push(xe,{tag:"rect",attributes:ct({fill:"currentColor","clip-path":"url(#".concat(de,")"),mask:"url(#".concat(B,")")},Sx)}),{children:n,attributes:i}}}};!function mUe(r,e){var t=e.mixoutsTo;vte=r,j5={},Object.keys(Z5).forEach(function(n){-1===gUe.indexOf(n)&&delete Z5[n]}),vte.forEach(function(n){var i=n.mixout?n.mixout():{};if(Object.keys(i).forEach(function(o){"function"==typeof i[o]&&(t[o]=i[o]),"object"===pv(i[o])&&Object.keys(i[o]).forEach(function(a){t[o]||(t[o]={}),t[o][a]=i[o][a]})}),n.hooks){var s=n.hooks();Object.keys(s).forEach(function(o){j5[o]||(j5[o]=[]),j5[o].push(s[o])})}n.provides&&n.provides(Z5)})}([tUe,BUe,GUe,UUe,WUe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=Lte,t}}},provides:function(e){e.pseudoElements2svg=function(t){var n=t.node;_t.searchPseudoElements&&Lte(void 0===n?H1:n)}}},{mixout:function(){return{dom:{unwatch:function(){bte(),Rte=!0}}}},hooks:function(){return{bootstrap:function(){wte(hx("mutationObserverCallbacks",{}))},noAuto:function(){!function xUe(){kv&&kv.disconnect()}()},watch:function(t){var n=t.observeMutationsRoot;Rte?Ex():wte(hx("mutationObserverCallbacks",{observeMutationsRoot:n}))}}}},{mixout:function(){return{parse:{transform:function(t){return zte(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-transform");return i&&(t.transform=zte(i)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var n=t.main,i=t.transform,o=t.iconWidth,a={transform:"translate(".concat(t.containerWidth/2," 256)")},c="translate(".concat(32*i.x,", ").concat(32*i.y,") "),l="scale(".concat(i.size/16*(i.flipX?-1:1),", ").concat(i.size/16*(i.flipY?-1:1),") "),f="rotate(".concat(i.rotate," 0 0)"),M={outer:a,inner:{transform:"".concat(c," ").concat(l," ").concat(f)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:ct({},M.outer),children:[{tag:"g",attributes:ct({},M.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:ct(ct({},n.icon.attributes),M.path)}]}]}}}},eWe,{provides:function(e){var t=!1;ul.matchMedia&&(t=ul.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var n=[],i={fill:"currentColor"},s={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:ct(ct({},i),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=ct(ct({},s),{},{attributeName:"opacity"}),a={tag:"circle",attributes:ct(ct({},i),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||a.children.push({tag:"animate",attributes:ct(ct({},s),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:ct(ct({},o),{},{values:"1;0;1;1;0;1;"})}),n.push(a),n.push({tag:"path",attributes:ct(ct({},i),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:ct(ct({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||n.push({tag:"path",attributes:ct(ct({},i),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:ct(ct({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},{hooks:function(){return{parseNodeAttributes:function(t,n){var i=n.getAttribute("data-fa-symbol");return t.symbol=null!==i&&(""===i||i),t}}}}],{mixoutsTo:co});var iWe=co.parse,sWe=co.icon;const oWe=["*"],lWe=r=>{const e={[`fa-${r.animation}`]:null!=r.animation&&!r.animation.startsWith("spin"),"fa-spin":"spin"===r.animation||"spin-reverse"===r.animation,"fa-spin-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-spin-reverse":"spin-reverse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-pulse":"spin-pulse"===r.animation||"spin-pulse-reverse"===r.animation,"fa-fw":r.fixedWidth,"fa-border":r.border,"fa-inverse":r.inverse,"fa-layers-counter":r.counter,"fa-flip-horizontal":"horizontal"===r.flip||"both"===r.flip,"fa-flip-vertical":"vertical"===r.flip||"both"===r.flip,[`fa-${r.size}`]:null!==r.size,[`fa-rotate-${r.rotate}`]:null!==r.rotate,[`fa-pull-${r.pull}`]:null!==r.pull,[`fa-stack-${r.stackItemSize}`]:null!=r.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let dWe=(()=>{var r;class e{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),hWe=(()=>{var r;class e{constructor(){this.definitions={}}addIcons(...n){for(const i of n){i.prefix in this.definitions||(this.definitions[i.prefix]={}),this.definitions[i.prefix][i.iconName]=i;for(const s of i.icon[2])"string"==typeof s&&(this.definitions[i.prefix][s]=i)}}addIconPacks(...n){for(const i of n){const s=Object.keys(i).map(o=>i[o]);this.addIcons(...s)}}getIconDefinition(n,i){return n in this.definitions&&i in this.definitions[n]?this.definitions[n][i]:null}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275prov=De({token:r,factory:r.\u0275fac,providedIn:"root"}),e})(),pWe=(()=>{var r;class e{constructor(){this.stackItemSize="1x"}ngOnChanges(n){if("size"in n)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275dir=Rt({type:r,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Ki]}),e})(),gWe=(()=>{var r;class e{constructor(n,i){this.renderer=n,this.elementRef=i}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(n){"size"in n&&(null!=n.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${n.size.currentValue}`),null!=n.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${n.size.previousValue}`))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(ac),G(Si))},r.\u0275cmp=Xe({type:r,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Ki],ngContentSelectors:oWe,decls:1,vars:0,template:function(n,i){1&n&&(function wV(r){const e=Ee()[Ar][Mi];if(!e.projection){const n=e.projection=t7(r?r.length:1,null),i=n.slice();let s=e.child;for(;null!==s;){const o=r?$5e(s,r):0;null!==o&&(i[o]?i[o].projectionNext=s:n[o]=s,i[o]=s),s=s.next}}}(),function NV(r,e=0,t){const n=Ee(),i=Ln(),s=p8(i,mn+r,16,null,t||null);null===s.projection&&(s.projection=e),zy(),(!n[c3]||j0())&&32!=(32&s.flags)&&function Z6e(r,e,t){HD(e[jt],0,e,t,lM(r,t,e),kD(t.parent||e[Mi],t,e))}(i,n,s)}(0))},encapsulation:2}),e})(),v0=(()=>{var r;class e{set spin(n){this.animation=n?"spin":void 0}set pulse(n){this.animation=n?"spin-pulse":void 0}constructor(n,i,s,o,a){this.sanitizer=n,this.config=i,this.iconLibrary=s,this.stackItem=o,this.classes=[],null!=a&&null==o&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(n){if(null!=this.icon||null!=this.config.fallbackIcon){if(n){const s=this.findIconDefinition(null!=this.icon?this.icon:this.config.fallbackIcon);if(null!=s){const o=this.buildParams();this.renderIcon(s,o)}}}else(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})()}render(){this.ngOnChanges({})}findIconDefinition(n){const i=((r,e)=>(r=>void 0!==r.prefix&&void 0!==r.iconName)(r)?r:"string"==typeof r?{prefix:e,iconName:r}:{prefix:r[0],iconName:r[1]})(n,this.config.defaultPrefix);return"icon"in i?i:this.iconLibrary.getIconDefinition(i.prefix,i.iconName)??((r=>{throw new Error(`Could not find icon with iconName=${r.iconName} and prefix=${r.prefix} in the icon library.`)})(i),null)}buildParams(){const n={flip:this.flip,animation:this.animation,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},i="string"==typeof this.transform?iWe.transform(this.transform):this.transform;return{title:this.title,transform:i,classes:[...lWe(n),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(n,i){const s=sWe(n,i);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return(r=e).\u0275fac=function(n){return new(n||r)(G(aG),G(dWe),G(hWe),G(pWe,8),G(gWe,8))},r.\u0275cmp=Xe({type:r,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(n,i){2&n&&(fE("innerHTML",i.renderedIconHTML,c7),k("title",i.title))},inputs:{icon:"icon",title:"title",animation:"animation",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Ki],decls:0,vars:0,template:function(n,i){},encapsulation:2}),e})(),mWe=(()=>{var r;class e{}return(r=e).\u0275fac=function(n){return new(n||r)},r.\u0275mod=Ci({type:r}),r.\u0275inj=Z2({}),e})();var bx={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},Fne={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},M1e={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},Bx={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"]},bie={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"]},Kx={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Die={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},roe={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zm0 416a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM48 304a48 48 0 1 0 0-96 48 48 0 1 0 0 96zm464-48a48 48 0 1 0 -96 0 48 48 0 1 0 96 0zM142.9 437A48 48 0 1 0 75 369.1 48 48 0 1 0 142.9 437zm0-294.2A48 48 0 1 0 75 75a48 48 0 1 0 67.9 67.9zM369.1 437A48 48 0 1 0 437 369.1 48 48 0 1 0 369.1 437z"]},dL={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},Voe={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class hae{static toComparableObjectSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>i.equals(n))&&t.push(n)}),t}static toComparableSet(e){const t=[];return e.forEach(n=>{!1===t.some(i=>Ro(i,n))&&t.push(n)}),t}}let pae;pae=Symbol.iterator;class dt{constructor(e){u(this,"values",void 0),this.values=void 0===e?[]:hae.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(Ro(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new dt(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(Ro(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?g.of(this.values[0]):g.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const n of this.values)t.push(e(n));return new dt(t)}flatMap(e){const t=new dt;for(const n of this)t.addAll(e(n));return t}filter(e){const t=new dt;for(const n of this)e(n)&&t.add(n);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return g.of(t);return g.empty()}intersection(e){const t=new dt;for(const n of e)this.contains(n)&&t.add(n);return t}[pae](){return this.values.values()}}class un{static from(e){const t=Object.keys(e),n=new un;for(const i of t)n.set(i,e[i]);return n}constructor(e=[],t=!1){u(this,"map",void 0),u(this,"isImmutable",void 0),this.map=e,this.isImmutable=t}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(Ro(t.key,e))return g.of(t.value);return g.empty()}getAnyPair(){return this.size()>0?g.of(this.map[0]):g.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const n of this.map)if(Ro(n.key,e)){const i=n.value;return n.value=t,g.of(i)}return this.map.push({key:e,value:t}),g.empty()}containsKey(e){return this.map.some(t=>Ro(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}getKeySet(){return new dt(this.listKeys())}filter(e){const t=new un;for(const n of this.map)e(n.key,n.value)&&t.set(n.key,n.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(Ro(this.map[t].key,e)){const i=this.map[t].value,s=this.map.slice(0,t),o=this.map.slice(t+1);return this.map=s.concat(o),i}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;for(const i of t){const s=this.get(i).get(),o=e.get(i);if(Ve(o.isPresent(),"value is absent in a map even though its key is present!"),!1===Ro(s,o.get()))return!1}return!0}}class Md extends un{reverse(){const e=new Md;for(const t of this.listKeys()){const n=this.get(t).get();if(e.containsKey(n))e.get(n).get().add(t);else{const i=new dt;i.add(t),e.set(n,i)}}return e}}var Yv;class ls{constructor(e,t,n){var i=this;u(this,"userDAO",void 0),u(this,"userService",void 0),u(this,"connectedUserService",void 0),u(this,"authSubscription",void 0),u(this,"userSubscription",new En),u(this,"currentGame",g.empty()),u(this,"currentGameRS",void 0),u(this,"currentGameObs",void 0),this.userDAO=e,this.userService=t,this.connectedUserService=n,this.currentGameRS=new tee(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var s=P(function*(o){yield i.onUserUpdate(o)});return function(o){return s.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return P(function*(){if(e===u0.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=g.empty(),t.currentGameRS.next(g.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,i=>{Ve(i.isPresent(),"Observing part service expected user to already have a document!");const s=i.get();t.onCurrentGameUpdate(s.currentGame)});const n=yield t.userDAO.read(e.id);t.currentGame=g.ofNullable(n.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,n=null==e&&t.isAbsent(),i=null!=e&&t.equalsValue(e);!1===n&&!1===i&&(this.currentGame=g.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(Ve(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const n={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:n})}{const n=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const i of n)Ve(null!=e[i],"field "+i+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return Ve(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return b.SUCCESS;{const e=ls.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return b.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return b.SUCCESS;{const n=ls.roleToMessage.get(this.currentGame.get().role).get()();return b.failure(n)}}getCurrentGame(){return new Promise(e=>{let t=new En;t=this.currentGameObs.subscribe(n=>{e(n),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function Dut(r,e){if(1&r&&(Bt(0),oe(1,31),Gt()),2&r){const t=p(2);v(1),$n(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),qn(1)}}function Hut(r,e){if(1&r&&(Bt(0),oe(1,33),Gt()),2&r){const t=p(3);v(1),$n(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),qn(1)}}function Vut(r,e){if(1&r&&(Bt(0),oe(1,34),Gt()),2&r){const t=p(3);v(1),$n(t.currentGame.get().typeGame),qn(1)}}function Fut(r,e){if(1&r&&(T(0,Hut,2,2,"ng-container",27),T(1,Vut,2,1,"ng-template",null,32,dn)),2&r){const t=ln(2);y("ngIf",p(2).currentGame.get().opponent)("ngIfElse",t)}}function $ut(r,e){if(1&r){const t=pe();E(0,"a",29),U("click",function(){return te(t),ne(p().navigateToPart())}),T(1,Dut,2,2,"ng-container",27),T(2,Fut,3,2,"ng-template",null,30,dn),S()}if(2&r){const t=ln(3),n=p();v(1),y("ngIf","Observer"===n.currentGame.get().role||"Candidate"===n.currentGame.get().role)("ngIfElse",t)}}function But(r,e){if(1&r&&(Bt(0),F(1,"fa-icon",35),Gt()),2&r){const t=p();v(1),y("icon",t.faSpinner)}}function Gut(r,e){if(1&r){const t=pe();Bt(0),E(1,"div",10)(2,"a",37),lt(3),S(),E(4,"div",13)(5,"a",38),oe(6,39),S(),E(7,"a",40),U("click",function(){return te(t),ne(p(2).logout())}),oe(8,41),S()()(),Gt()}if(2&r){const t=p(2);v(3),Nn(t.username.get())}}Yv=ls,u(ls,"roleToMessage",new un([{key:"Candidate",value:J9.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:J9.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:J9.YOU_ARE_ALREADY_CREATING},{key:"Player",value:J9.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:J9.YOU_ARE_ALREADY_OBSERVING}])),u(ls,"\u0275fac",function(e){return new(e||Yv)(Pe(Q9),Pe($5),Pe(sr))}),u(ls,"\u0275prov",De({token:Yv,factory:Yv.\u0275fac,providedIn:"root"}));const Uut=function(){return["/register"]},Wut=function(){return["/login"]};function qut(r,e){1&r&&(E(0,"div",42)(1,"a",43)(2,"strong"),oe(3,44),S()(),E(4,"a",45),oe(5,46),S()()),2&r&&(v(1),y("routerLink",g1(2,Uut)),v(3),y("routerLink",g1(3,Wut)))}function jut(r,e){if(1&r&&(T(0,Gut,9,1,"ng-container",27),T(1,qut,6,4,"ng-template",null,36,dn)),2&r){const t=ln(2);y("ngIf",p().username.isPresent())("ngIfElse",t)}}const gae=function(){return["/"]},Zut=function(){return["/play"]},Yut=function(){return["/lobby"]},Kut=function(){return["/local"]},Xut=function(){return["/tutorial"]},Qut=function(){return["/settings"]};let Jut=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"loading",!0),u(this,"username",g.empty()),u(this,"faCog",bie),u(this,"faSpinner",roe),u(this,"userSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"showMenu",!1),u(this,"currentGame",g.empty()),this.router=n,this.connectedUserService=i,this.currentGameService=s,this.userService=o}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(n=>{this.loading=!1,this.username=n.username.isPresent()?n.username:n.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(n=>{this.currentGame=n})}logout(){var n=this;return P(function*(){yield n.connectedUserService.disconnect(),yield n.router.navigate(["/"])})()}navigateToPart(){var n=this;return P(function*(){return n.router.navigate(["/play",n.currentGame.get().typeGame,n.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Bn),G(sr),G(ls),G($5))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,M,w,L,z;return t=$localize`Home`,n=$localize`Play online`,i=$localize`Create a game`,s=$localize`Join a game`,o=$localize`Play offline`,a=$localize`Create a game`,c=$localize`Learn the rules`,l=$localize`Settings`,f=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,d=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,M=$localize`Account`,w=$localize`Log out`,L=$localize`Register`,z=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],n,[1,"navbar-dropdown"],i,s,["id","playOffline",1,"navbar-link"],o,["id","playLocally",1,"navbar-item",3,"routerLink"],a,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",l,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],f,["waitingForOpponent",""],d,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],M,["id","logout",1,"navbar-item",3,"click"],w,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],L,["id","login",1,"button","is-light",3,"routerLink"],z]},template:function(n,i){if(1&n&&(E(0,"nav",0)(1,"div",1)(2,"a",2),F(3,"img",3),S(),E(4,"a",4),U("click",function(){return i.showMenu=!i.showMenu}),F(5,"span",5)(6,"span",5)(7,"span",5),S()(),E(8,"div",6),U("click",function(){return i.showMenu=!i.showMenu}),E(9,"div",7)(10,"a",8),oe(11,9),S(),E(12,"div",10)(13,"a",11),oe(14,12),S(),E(15,"div",13)(16,"a",2),oe(17,14),S(),E(18,"a",2),oe(19,15),S()()(),E(20,"div",10)(21,"a",16),oe(22,17),S(),E(23,"div",13)(24,"a",18),oe(25,19),S(),E(26,"a",20),oe(27,21),S()()()(),E(28,"div",22),T(29,$ut,4,2,"a",23),E(30,"a",24),F(31,"fa-icon",25),S(),E(32,"div",26),T(33,But,2,1,"ng-container",27),T(34,jut,3,2,"ng-template",null,28,dn),S()()()()),2&n){const s=ln(35);v(2),y("routerLink",g1(13,gae)),v(2),y("ngClass",i.showMenu?"is-active":""),v(4),y("ngClass",i.showMenu?"is-active":""),v(2),y("routerLink",g1(14,gae)),v(6),y("routerLink",g1(15,Zut)),v(2),y("routerLink",g1(16,Yut)),v(6),y("routerLink",g1(17,Kut)),v(2),y("routerLink",g1(18,Xut)),v(3),y("ngIf",i.currentGame.isPresent()),v(1),y("routerLink",g1(19,Qut)),v(1),y("icon",i.faCog),v(2),y("ngIf",i.loading)("ngIfElse",s)}},dependencies:[Ft,Nt,vc,v0],encapsulation:2})),e})(),e7t=(()=>{var r;class e{constructor(n,i){u(this,"_themeService",void 0),u(this,"_errorLoggerService",void 0),u(this,"faTwitter",Lee),u(this,"faFacebook",bee),u(this,"faGithub",xee),this._themeService=n,this._errorLoggerService=i}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(hv),G(c2))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(n,i){1&n&&(F(0,"app-header"),E(1,"main",0),F(2,"router-outlet"),S(),E(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),ws(7,3),F(8,"strong"),Ns(),S(),lt(9," \xa0 "),E(10,"a",4),F(11,"fa-icon",5),S(),lt(12,"\xa0 "),E(13,"a",6),F(14,"fa-icon",5),S(),lt(15,"\xa0 "),E(16,"a",7),F(17,"fa-icon",5),S()()()()),2&n&&(v(11),y("icon",i.faGithub),v(3),y("icon",i.faTwitter),v(3),y("icon",i.faFacebook))},dependencies:[fP,v0,Jut],encapsulation:2})),e})();class Li{constructor(){u(this,"__nominal",void 0)}}var Y5;class Jt{static of(e){switch(e){case 0:return Jt.ZERO;case 1:return Jt.ONE;case 2:return Jt.TWO;default:return Ve(3===e,"Invalid Apagos Coord "+e),Jt.THREE}}constructor(e){u(this,"x",void 0),this.x=e}equals(e){return this.x===e.x}}Y5=Jt,u(Jt,"encoder",Ie.tuple([Ie.identity()],r=>[r.x],r=>Y5.of(r[0]))),u(Jt,"ZERO",new Y5(0)),u(Jt,"ONE",new Y5(1)),u(Jt,"TWO",new Y5(2)),u(Jt,"THREE",new Y5(3));let K5=(()=>{class r{}return u(r,"PIECE_SHOULD_MOVE_DOWNWARD",()=>$localize`Pieces should only move downward!`),u(r,"CANNOT_LAND_ON_A_FULL_SQUARE",()=>$localize`That square is already full, you cannot put a piece in it!`),u(r,"NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE",()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`),u(r,"NO_PIECE_REMAINING_TO_DROP",()=>$localize`There are no remaining pieces of that color to drop!`),u(r,"NO_POSSIBLE_TRANSFER_REMAINS",()=>$localize`There is no possible transfer from that square!`),r})();var Ri;class lo extends Li{static drop(e,t){return K.getNonNullable(lo.ALL_MOVES.find(i=>i.landing.equals(e)&&i.piece.equalsValue(t)&&i.starting.equals(g.empty())))}static transfer(e,t){if(e.x<=t.x)return se.failure(K5.PIECE_SHOULD_MOVE_DOWNWARD());const n=K.getNonNullable(lo.ALL_MOVES.find(i=>i.landing.equals(t)&&i.piece.equals(g.empty())&&i.starting.equals(g.of(e))));return se.success(n)}constructor(e,t,n){super(),u(this,"landing",void 0),u(this,"piece",void 0),u(this,"starting",void 0),this.landing=e,this.piece=t,this.starting=n}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}u(lo,"ALL_MOVES",[new(Ri=lo)(Jt.ZERO,g.of(I.ZERO),g.empty()),new Ri(Jt.ONE,g.of(I.ZERO),g.empty()),new Ri(Jt.TWO,g.of(I.ZERO),g.empty()),new Ri(Jt.THREE,g.of(I.ZERO),g.empty()),new Ri(Jt.ZERO,g.of(I.ONE),g.empty()),new Ri(Jt.ONE,g.of(I.ONE),g.empty()),new Ri(Jt.TWO,g.of(I.ONE),g.empty()),new Ri(Jt.THREE,g.of(I.ONE),g.empty()),new Ri(Jt.TWO,g.empty(),g.of(Jt.THREE)),new Ri(Jt.ONE,g.empty(),g.of(Jt.THREE)),new Ri(Jt.ZERO,g.empty(),g.of(Jt.THREE)),new Ri(Jt.ONE,g.empty(),g.of(Jt.TWO)),new Ri(Jt.ZERO,g.empty(),g.of(Jt.TWO)),new Ri(Jt.ZERO,g.empty(),g.of(Jt.ONE))]),u(lo,"encoder",Ie.tuple([Jt.encoder,g.getEncoder(I.encoder),g.getEncoder(Jt.encoder)],r=>[r.landing,r.piece,r.starting],r=>new Ri(r[0],r[1],r[2])));class Kv{constructor(e){u(this,"turn",void 0),this.turn=e}getCurrentPlayer(){return I.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?I.ZERO:I.ONE}}let mae;class He{static mapBiArray(e,t){const n=[];let i=0;for(;i<e.length;){n[i]=[];let s=0;for(;s<e[i].length;)n[i][s]=t(e[i][s]),s++;i++}return n}static create3DTable(e,t,n,i){const s=[];for(let o=0;o<e;o++)s.push(He.createTable(t,n,i));return s}static createTable(e,t,n){const i=[];for(let s=0;s<t;s++)i.push(He.createArray(e,n));return i}static createArray(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}static copyBiArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=He.copyImmutableArray(e[n]),n++;return t}static copyImmutableArray(e){const t=[];let n=0;for(;n<e.length;)t[n]=e[n],n++;return t}static sortByDescending(e,t){e.sort((n,i)=>{const s=t(n),o=t(i);return s<o?1:s>o?-1:0})}static compareArray(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===Ro(e[n],t[n]))return!1;return!0}static compareTable(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!1===He.compareArray(e[n],t[n]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&He.compareArray(e,t.slice(0,e.length))}static range(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}static smallerFirst(e,t){return e-t}}mae=Symbol.iterator;class _ae{constructor(){u(this,"content",new un)}get(e){const t=this.content.get(e.y);return t.isAbsent()?g.empty():t.get().get(e.x)}set(e,t){const n=this.content.get(e.y);let i;n.isPresent()?i=n.get():(i=new un,this.content.set(e.y,i)),i.set(e.x,t)}[mae](){const e=[],t=this.content.getKeySet().toList();t.sort(He.smallerFirst);for(const n of t){const i=this.content.get(n).get(),s=i.getKeySet().toList();s.sort(He.smallerFirst);for(const o of s){const a=i.get(o).get();e.push({x:o,y:n,content:a})}}return e.values()}}class Ed{static from(e,t,n){if(e+t>n)return se.failure("invalid starting space");const i=new un([{key:I.ZERO,value:e},{key:I.ONE,value:t},{key:X.NONE,value:n}]);i.makeImmutable();const s=new Ed(i);return se.success(s)}constructor(e){u(this,"containing",void 0),this.containing=e}isFull(){return this.count(I.ZERO)+this.count(I.ONE)>=this.count(X.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(I.ZERO),n=this.count(I.ONE);const i=this.count(X.NONE);return e===I.ZERO?t++:n++,Ed.from(t,n,i).get()}substractPiece(e){let t=this.count(I.ZERO),n=this.count(I.ONE);const i=this.count(X.NONE);return e===I.ZERO?t--:n--,Ed.from(t,n,i).get()}getDominatingPlayer(){const e=this.count(I.ZERO),t=this.count(I.ONE);return e>t?I.ZERO:t>e?I.ONE:X.NONE}equals(e){return this.containing.equals(e.containing)}}let pl=(()=>{class r extends Kv{static getInitialState(){return r.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,n,i,s){const o=[];for(let c=0;c<4;c++){const m=Ed.from(n[0][c],n[1][c],n[2][c]).get();o.push(m)}const a=new un;return a.set(I.ZERO,i),a.set(I.ONE,s),new r(t,o,a)}constructor(t,n,i){super(t),u(this,"board",void 0),u(this,"remaining",void 0),this.board=n,this.remaining=i,this.remaining.makeImmutable()}getPieceAt(t){return this.board[t.x]}updateAt(t,n){const i=[];for(let o=0;o<4;o++)i.push(t.x===o?n:this.board[o]);const s=this.getRemainingCopy();return new r(this.turn,i,s)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(t){return this.remaining.get(t).get()}equals(t){return this.turn===t.turn&&He.compareArray(t.board,this.board)&&this.remaining.equals(t.remaining)}}return u(r,"PIECES_PER_PLAYER",10),r})();class W{static fromMove(e,t,n,i,s,o){return new t7t(e,t,n,i,s,o)}static forClick(e,t,n,i,s,o){return new r7t(e,t,n,i,s,o)}static anyMove(e,t,n,i,s){return new n7t(e,t,n,i,s)}static fromPredicate(e,t,n,i,s,o){return new i7t(e,t,n,i,s,o)}static informational(e,t,n){return new s7t(e,t,n)}constructor(e,t,n){u(this,"title",void 0),u(this,"instruction",void 0),u(this,"state",void 0),u(this,"previousMove",g.empty()),this.title=e,this.instruction=t,this.state=n}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=g.of(e),this}}class Xv extends W{constructor(e,t,n,i){super(e,t,n),u(this,"successMessage",void 0),this.successMessage=i}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class t7t extends Xv{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedMoves",void 0),u(this,"failureMessage",void 0),this.acceptedMoves=i,this.failureMessage=o,Ve(i.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class n7t extends Xv{constructor(e,t,n,i,s){super(e,t,n,s),u(this,"solutionMove",void 0),this.solutionMove=i}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class r7t extends Xv{constructor(e,t,n,i,s,o){super(e,t,n,s),u(this,"acceptedClicks",void 0),u(this,"failureMessage",void 0),this.acceptedClicks=i,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class i7t extends Xv{constructor(e,t,n,i,s,o){super(e,t,n,o),u(this,"solutionMove",void 0),u(this,"predicate",void 0),this.solutionMove=i,this.predicate=s}getSolution(){return this.solutionMove}isPredicate(){return!0}}class s7t extends W{isInformation(){return!0}}class Kn{}class vae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,pl.getInitialState()),W.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,pl.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),lo.drop(Jt.ZERO,I.ZERO),$localize`Congratulations!`),W.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,pl.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),lo.transfer(Jt.TWO,Jt.ZERO).get(),(t,n,i)=>t.isDrop()?b.failure($localize`This move is a drop, please do a transfer!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,pl.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),lo.drop(Jt.TWO,I.ONE),(t,n,i)=>t.isDrop()?t.piece.equalsValue(I.ONE)?b.SUCCESS:b.failure($localize`You actively made your opponent win!`):b.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)])}}class an{static fromWinner(e){return e.isPlayer()?new an(e.getVictoryValue()):new an(0)}static of(e,t){return e*=I.ZERO.getScoreModifier(),t*=I.ONE.getScoreModifier(),new an(e+t)}toString(){return""+this.value}constructor(e){u(this,"value",void 0),this.value=e}}var Sd;u(an,"VICTORIES",[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]);class ve{static getVictory(e){return e===I.ZERO?ve.ZERO_WON:ve.ONE_WON}static getDefeat(e){return e===I.ZERO?ve.ONE_WON:ve.ZERO_WON}constructor(e,t){u(this,"isEndGame",void 0),u(this,"winner",void 0),this.isEndGame=e,this.winner=t}toBoardValue(){return this.winner.isPlayer()?new an(this.winner.getVictoryValue()):new an(0)}}u(ve,"ZERO_WON",new(Sd=ve)(!0,I.ZERO)),u(ve,"ONE_WON",new Sd(!0,I.ONE)),u(ve,"DRAW",new Sd(!0,X.NONE)),u(ve,"ONGOING",new Sd(!1,X.NONE));var Qv,yL,en=function(r){return r.VICTORY="VICTORY",r.PRE_VICTORY="PRE_VICTORY",r.DEFAULT="DEFAULT",r}(en||{});let Jv=(()=>{class r{}return u(r,"createdNodes",0),u(r,"minimaxTime",0),r})(),zi=(Qv=class{static getScoreStatus(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER?(we.display("MGPNode","getScoreStatus","VICTORY"),en.VICTORY):e===Number.MIN_SAFE_INTEGER+1?(we.display("MGPNode","getScoreStatus","PRE_VICTORY_MIN"),en.PRE_VICTORY):e===Number.MAX_SAFE_INTEGER-1?(we.display("MGPNode","getScoreStatus","PRE_VICTORY_MAX"),en.PRE_VICTORY):(we.display("MGPNode","getScoreStatus","DEFAULT"),en.DEFAULT)}constructor(e,t=g.empty(),n=g.empty(),i){if(u(this,"gameState",void 0),u(this,"mother",void 0),u(this,"move",void 0),u(this,"minimaxCreator",void 0),u(this,"childs",g.empty()),u(this,"hopedValue",new un),u(this,"ownValue",new un),u(this,"possibleMoves",new un),this.gameState=e,this.mother=t,this.move=n,this.minimaxCreator=i,this.ownValue=new un,null!=i){const s=i.getBoardValue(this);this.ownValue.set(i.name,s),this.hopedValue.set(i.name,s.value)}Jv.createdNodes++}findBestMove(e,t,n=!1,i=!0){const s=(new Date).getTime();let o=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,i);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),e--;return Jv.minimaxTime+=(new Date).getTime()-s,o.move.get()}alphaBeta(e,t,n,i,s,o){if(e<1)return we.display("MGPNode","alphaBeta","isLeaf-Calculation : "+this.myToString()+" at depth "+e),this;if(i.ruler.getGameStatus(this).isEndGame)return we.display("MGPNode","alphaBeta","isLeaf-EndGame("+i.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+e),this;const a=this.getPossibleMoves(i);Ve(a.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=g.of([]));const c=this.getBestChilds(a,e,t,n,i,s,o),l=this.getBestChildAmongst(c,s),f=l.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),f),l}getPossibleMoves(e){const t=this.possibleMoves.get(e.name);if(t.isAbsent()){const n=e.getListMoves(this);return this.possibleMoves.set(e.name,new dt(n)),new dt(n)}return t.get()}getBestChilds(e,t,n,i,s,o,a){let c=[];const l=this.gameState.getCurrentPlayer();let f=l===I.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const d=l===I.ZERO?(m,M)=>m<M:(m,M)=>M<m;for(const m of e){const w=this.getOrCreateChild(m,s).alphaBeta(t-1,n,i,s,o,a),L=w.getHopedValue(s);if(d(L,f)||0===c.length?(f=L,c=[w]):L===f&&c.push(w),a&&d(f,l===I.ZERO?n:i))break;l===I.ZERO?i=Math.min(f,i):n=Math.max(f,n)}return c}getBestChildAmongst(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}getOrCreateChild(e,t){let n=this.getSonByMove(e);if(n.isAbsent()){const i=t.ruler.isLegal(e,this.gameState),s=e.toString();Ve(i.isSuccess(),'The minimax "'+t.name+'" has proposed an illegal move ('+s+"), refusal reason: "+i.getReasonOr("")+" this should not happen.");const o=t.ruler.applyLegalMove(e,this.gameState,i.get());n=g.of(new yL(o,g.of(this),g.of(e),t)),this.childs.get().push(n.get())}return n.get()}getSonByMove(e){Ve(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const t of this.childs.get())if(t.move.isPresent()&&t.move.equalsValue(e))return g.of(t);return g.empty()}getHopedValue(e){return this.hopedValue.get(e.name).get()}getOwnValue(e){const t=this.ownValue.get(e.name);if(t.isAbsent()){const n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}myToString(){let e="",t=this;if(t.mother.isAbsent())return"InitialNode: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let e=this.childs.get().length;for(const t of this.childs.get())e+=t.countDescendants();return e}},yL=Qv,u(Qv,"minimaxes",new un),Qv);zi=yL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],zi);class jn{constructor(e){u(this,"stateType",void 0),this.stateType=e}choose(e,t){we.display("Rules","choose",t.toString()+" was proposed");const n=this.isLegal(t,e.gameState);if(e.hasMoves()){we.display("Rules","choose","current node has moves");const o=e.getSonByMove(t);if(o.isPresent())return Ve(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),we.display("Rules","choose","and this proposed move is found in the list, so it is legal"),g.of(o.get())}if(we.display("Rules","choose","current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return we.display("Rules","choose","Move is illegal: "+n.getReason()),g.empty();we.display("Rules","choose","Move is legal, let's apply it");const i=this.applyLegalMove(t,e.gameState,n.get()),s=new zi(i,g.of(e),g.of(t));return g.of(s)}getInitialNode(){const e=this.stateType.getInitialState();return new zi(e)}}class X3 extends jn{static get(){return X3.singleton.isAbsent()&&(X3.singleton=g.of(new X3)),X3.singleton.get()}constructor(){super(pl)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const n=t.getRemainingCopy(),i=n.get(e.piece.get()).get();n.put(e.piece.get(),i-1);const s=new pl(t.turn+1,t.board,n),o=e.piece.get(),a=s.getPieceAt(e.landing).addPiece(o);if(e.landing===Jt.THREE)return s.updateAt(e.landing,a);{const c=Jt.of(e.landing.x+1),l=s.getPieceAt(c);return s.updateAt(e.landing,l).updateAt(c,a)}}applyLegalTransfer(e,t){const n=t.getCurrentPlayer(),i=e.starting.get(),s=t.getPieceAt(i).substractPiece(n),o=t.getPieceAt(e.landing).addPiece(n);let a=t.updateAt(i,s);return a=a.updateAt(e.landing,o),new pl(a.turn+1,a.board,a.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?b.failure(K5.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?b.failure(K5.NO_PIECE_REMAINING_TO_DROP()):b.SUCCESS}isLegalSlideDown(e,t){const n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?b.failure(K5.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;for(let i=0;i<4;i++)if(!1===t.getPieceAt(Jt.of(i)).isFull())return ve.ONGOING;const n=t.getPieceAt(Jt.THREE).getDominatingPlayer();return Ve(n.isPlayer(),"winner can only be a player if the game is finished"),ve.getVictory(n)}}u(X3,"singleton",g.empty());class ML{static gcd(e,t){return 0===t?Math.abs(e):ML.gcd(t,e%t)}}class St{constructor(e,t){u(this,"x",void 0),u(this,"y",void 0),this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=ML.gcd(this.x,this.y);return new St(this.x/e,this.y/e)}combine(e,t=1){return new St(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}var _1,us;class EL extends St{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class SL{from(e,t){for(const n of this.all)if(n.x===e&&n.y===t)return se.success(n);return se.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?se.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):se.failure(a7t.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return se.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return se.failure(`Invalid int direction: ${e}`)}}}class Me extends EL{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return Me.factory.from(-this.x,-this.y).get()}}u(Me,"UP",new(_1=Me)(0,-1)),u(Me,"UP_RIGHT",new _1(1,-1)),u(Me,"RIGHT",new _1(1,0)),u(Me,"DOWN_RIGHT",new _1(1,1)),u(Me,"DOWN",new _1(0,1)),u(Me,"DOWN_LEFT",new _1(-1,1)),u(Me,"LEFT",new _1(-1,0)),u(Me,"UP_LEFT",new _1(-1,-1)),u(Me,"factory",new class extends SL{constructor(...r){super(...r),u(this,"all",[_1.UP,_1.UP_RIGHT,_1.RIGHT,_1.DOWN_RIGHT,_1.DOWN,_1.DOWN_LEFT,_1.LEFT,_1.UP_LEFT])}}),u(Me,"DIRECTIONS",_1.factory.all),u(Me,"DIAGONALS",[_1.UP_RIGHT,_1.DOWN_RIGHT,_1.DOWN_LEFT,_1.UP_LEFT]),u(Me,"ORTHOGONALS",[_1.UP,_1.RIGHT,_1.DOWN,_1.LEFT]),u(Me,"encoder",Ie.fromFunctions(r=>r.toString(),r=>(Ve("string"==typeof r,"Invalid encoded direction"),_1.factory.fromString(r).get())));class Re extends EL{constructor(e,t){super(e,t)}getOpposite(){return Re.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Re.factory.from(-this.y,this.x).get()}}u(Re,"UP",new(us=Re)(0,-1)),u(Re,"RIGHT",new us(1,0)),u(Re,"DOWN",new us(0,1)),u(Re,"LEFT",new us(-1,0)),u(Re,"factory",new class extends SL{constructor(...r){super(...r),u(this,"all",[us.UP,us.RIGHT,us.DOWN,us.LEFT])}from(r,e){return 0===r&&-1===e?se.success(us.UP):1===r&&0===e?se.success(us.RIGHT):0===r&&1===e?se.success(us.DOWN):-1===r&&0===e?se.success(us.LEFT):se.failure("Invalid orthogonal from x and y")}}),u(Re,"ORTHOGONALS",us.factory.all),u(Re,"encoder",Ie.fromFunctions(r=>r.toString(),r=>(Ve("string"==typeof r,"Invalid encoded orthogonal"),us.factory.fromString(r).get())));let a7t=(()=>{class r{}return u(r,"DIRECTION_MUST_BE_LINEAR",()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`),r})();var PL;let X5=(()=>{class r{}return u(r,"OUT_OF_RANGE",e=>`The coordinate ${e.toString()} is not on the board`),r})();class C extends St{static getEncoder(e){return Ie.tuple([Ie.identity(),Ie.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}constructor(e,t){super(e,t)}getNext(e,t){const n=this.combine(e,t);return new C(n.x,n.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new C(this.x+e.y,this.y+-e.x)}getRight(e){return new C(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return Me.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!1===e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}isHexagonallyAlignedWith(e){const t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}getVectorToward(e){return new St(e.x-this.x,e.y-this.y)}toVector(){return new St(this.x,this.y)}getCoordsToward(e){if(e.equals(this))return[];if(!1===e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let n=this.getNext(t,1);const i=[];for(;!1===n.equals(e);)i.push(n),n=n.getNext(t,1);return i}getUntil(e){const t=[],n=this.getDirectionToward(e).get();let i=this.getNext(n);for(;!1===i.equals(e);)t.push(i),i=i.getNext(n);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}}u(C,"encoder",(PL=C).getEncoder((r,e)=>new PL(r,e)));class Cae{constructor(){u(this,"ArrayUtils",He)}getPlayerClass(e){switch(e){case I.ZERO:return"player0-fill";case I.ONE:return"player1-fill";default:return K.expectToBe(e,X.NONE),""}}}let gl=(()=>{var r;class e extends Cae{constructor(n){super(),u(this,"messageDisplayer",void 0),u(this,"encoder",void 0),u(this,"Player",I),u(this,"SPACE_SIZE",100),u(this,"STROKE_WIDTH",8),u(this,"SMALL_STROKE_WIDTH",2),u(this,"rules",void 0),u(this,"node",void 0),u(this,"availableMinimaxes",void 0),u(this,"canPass",!1),u(this,"scores",g.empty()),u(this,"imagesLocation","assets/images/"),u(this,"hasAsymmetricBoard",!1),u(this,"rotation",""),u(this,"tutorial",void 0),u(this,"isPlayerTurn",void 0),u(this,"chooseMove",void 0),u(this,"canUserPlay",void 0),u(this,"cancelMoveOnWrapper",void 0),u(this,"role",void 0),this.messageDisplayer=n}message(n){this.messageDisplayer.gameMessage(n)}cancelMove(n){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(n),null==n?b.SUCCESS:(this.messageDisplayer.gameMessage(n),b.failure(n))}cancelMoveAttempt(){}pass(){var n=this;return P(function*(){return c2.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:n.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getState(){return this.node.gameState}getPreviousState(){return this.node.mother.get().gameState}showLastMove(n){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["ng-component"]],features:[Je],decls:0,vars:0,template:function(n,i){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Q5=(()=>{var r;class e extends gl{constructor(...n){super(...n),u(this,"hexaLayout",void 0),u(this,"hexaBoard",void 0)}getHexaPointsAtXY(n,i){const s=new C(n,i);return this.getHexaPointsAt(s)}getHexaPointsAt(n){return this.hexaLayout.getHexaPointsAt(n)}getCenterAtXY(n,i){const s=new C(n,i);return this.getCenterAt(s)}getCenterAt(n){return this.hexaLayout.getCenterAt(n)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}()),u(e,"\u0275cmp",Xe({type:r,selectors:[["ng-component"]],features:[Je],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();var Pd,u2;class Ce{static of(e){switch(e){case Ce.ZERO.value:return Ce.ZERO;case Ce.ONE.value:return Ce.ONE;case Ce.EMPTY.value:return Ce.EMPTY;case Ce.UNREACHABLE.value:return Ce.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===I.ZERO?Ce.ZERO:(K.expectToBe(e,I.ONE),Ce.ONE)}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===Ce.ZERO||this===Ce.ONE}}u(Ce,"ZERO",new(Pd=Ce)(I.ZERO.value)),u(Ce,"ONE",new Pd(I.ONE.value)),u(Ce,"EMPTY",new Pd(X.NONE.value)),u(Ce,"UNREACHABLE",new Pd(3));class be extends EL{static getAngle(e){switch(e){case be.UP:return 0;case be.UP_RIGHT:return 60;case be.RIGHT:return 120;case be.DOWN:return 180;case be.DOWN_LEFT:return 240;default:return K.expectToBe(e,be.LEFT),300}}constructor(e,t){super(e,t)}getOpposite(){return be.factory.from(-this.x,-this.y).get()}}u(be,"UP",new(u2=be)(0,-1)),u(be,"LEFT",new u2(-1,0)),u(be,"UP_RIGHT",new u2(1,-1)),u(be,"DOWN_LEFT",new u2(-1,1)),u(be,"RIGHT",new u2(1,0)),u(be,"DOWN",new u2(0,1)),u(be,"factory",new class extends SL{constructor(...r){super(...r),u(this,"all",[u2.UP,u2.UP_RIGHT,u2.RIGHT,u2.DOWN,u2.DOWN_LEFT,u2.LEFT])}}),u(be,"encoder",Ie.fromFunctions(r=>{switch(r){case u2.UP:return 0;case u2.UP_RIGHT:return 1;case u2.RIGHT:return 2;case u2.DOWN:return 3;case u2.DOWN_LEFT:return 4;default:return 5}},r=>(K.assert(0<=r&&r<=5,"Invalid encoded number for HexaDirection "+r),u2.factory.all[r])));class Eae{constructor(){u(this,"startAngle",void 0),u(this,"conversionMatrix",void 0),u(this,"inverseConversionMatrix",void 0)}}class eC extends Eae{constructor(){super(),u(this,"startAngle",.5),u(this,"conversionMatrix",[Math.sqrt(3),Math.sqrt(3)/2,0,1.5]),u(this,"inverseConversionMatrix",[Math.sqrt(3)/3,-1/3,0,2/3])}}u(eC,"INSTANCE",new eC);class Dr extends Eae{constructor(){super(),u(this,"startAngle",0),u(this,"conversionMatrix",[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)]),u(this,"inverseConversionMatrix",[2/3,0,-1/3,Math.sqrt(3)/3])}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((n,i)=>{this.isOnBorder(e,n)&&t.push(n)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}u(Dr,"INSTANCE",new Dr);class J5{constructor(e,t,n){u(this,"size",void 0),u(this,"origin",void 0),u(this,"orientation",void 0),this.size=e,this.origin=t,this.orientation=n}getCenterAt(e){const t=this.orientation.conversionMatrix;return new C(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new C(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsListAt(e){const t=this.getCenterAt(e),n=[];for(let i=0;i<6;i+=1){const s=this.getCornerOffset(i);n.push(new C(t.x+s.x,t.y+s.y))}return n}getHexaPointsAt(e){return this.getHexaPointsListAt(e).map(n=>n.toSVGPoint()).join(" ")}getIsoPoints(e,t){K.assert(this.orientation===Dr.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const n=this.getCenterAt(e),i=this.getCornerOffset(0),s=this.getCornerOffset(1),o=this.getCornerOffset(2),a=this.getCornerOffset(3);return[[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+o.x,n.y+o.y)],[new C(n.x+i.x,n.y+i.y),new C(n.x+i.x,n.y+i.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+o.x,n.y+o.y),new C(n.x+s.x,n.y+s.y)],[new C(n.x+a.x,n.y+a.y),new C(n.x+a.x,n.y+a.y+t),new C(n.x+o.x,n.y+o.y+t),new C(n.x+s.x,n.y+s.y+t),new C(n.x+i.x,n.y+i.y+t),new C(n.x+i.x,n.y+i.y),new C(n.x+s.x,n.y+s.y),new C(n.x+o.x,n.y+o.y)]]}}let Sae,Le=(()=>{class r{}return u(r,"CANNOT_CHOOSE_OPPONENT_PIECE",()=>$localize`You cannot pick a piece of the opponent.`),u(r,"MUST_CLICK_ON_EMPTY_SPACE",()=>$localize`You must click on an empty space.`),u(r,"MUST_CLICK_ON_EMPTY_SQUARE",()=>$localize`You must click on an empty square.`),u(r,"SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE",()=>$localize`Your landing space should be empty or contain a piece of the opponent.`),u(r,"CANNOT_SELF_CAPTURE",()=>$localize`You cannot capture your own pieces.`),u(r,"MUST_CHOOSE_PLAYER_PIECE",()=>$localize`You must pick one of your pieces.`),u(r,"CANNOT_PASS",()=>$localize`You cannot pass your turn.`),u(r,"MUST_LAND_ON_EMPTY_SPACE",()=>$localize`You must drop your piece on an empty space.`),u(r,"MUST_PASS",()=>$localize`You must pass your turn.`),u(r,"MUST_CHOOSE_OWN_PIECE_NOT_EMPTY",()=>$localize`You have selected an empty space, you must select one of your own pieces.`),u(r,"MOVE_CANNOT_BE_STATIC",()=>$localize`You must choose different starting and ending coordinates.`),u(r,"SOMETHING_IN_THE_WAY",()=>$localize`There is a piece between the piece you chose and its landing space.`),r})();class uo{constructor(e,t){u(this,"ruler",void 0),u(this,"name",void 0),this.ruler=e,this.name=t}toString(){return this.name}}class Hr extends uo{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return an.fromWinner(t.winner);{const n=this.getMetrics(e);return an.of(n[0],n[1])}}}Sae=Symbol.iterator;class F1 extends Kv{constructor(e,t){super(t),u(this,"board",void 0),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?g.of(this.board[e.y][e.x]):g.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new C(e,t))}forEachCoord(e){for(const{coord:t,content:n}of this.getCoordsAndContents())e(t,n)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isOnBoard(i)&&e.push({coord:i,content:this.getPieceAt(i)})}return e}getCopiedBoard(){return He.copyBiArray(this.board)}toMap(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t);e.push({key:i,value:this.getPieceAt(i)})}return e}[Sae](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class Di extends F1{static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new Di([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,n,n,n,e,e,t,t],[n,n,n,n,n,n,t,t,t],[n,n,n,n,n,t,t,t,t]],0)}static isOnBoard(e){return e.isInRange(9,9)&&Di.getInitialState().getPieceAt(e)!==Ce.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let n=0;n<9;n++)this.getPieceAtXY(n,t)===Ce.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===Ce.ONE&&(e[0]=e[0]-1);return e}}class Mr extends Li{static getFallibleEncoder(e){return Ie.tuple([C.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return Ie.tuple([C.encoder],t=>[t.coord],t=>e(t[0]))}constructor(e,t){super(),u(this,"coord",void 0),this.coord=new C(e,t)}equals(e){return this===e||this.coord.equals(e.coord)}}var Pae;class L2 extends Mr{static fromSingleCoord(e,t){try{return se.success(new L2(e,t,g.empty()))}catch(n){return se.failure(n.message)}}static fromDoubleCoord(e,t,n){const i=[e,t];He.sortByDescending(i,L2.sortCoord);const s=i[1].getDirectionToward(i[0]).get(),o=be.factory.fromDelta(s.x,s.y);if(o.isFailure())return se.failure("Invalid direction");const a=o.get();return i[1].getDistance(i[0])>2?se.failure("Distance between first coord and last coord is too big"):a.equals(n)?L2.fromSingleCoord(i[1],n):a.getOpposite().equals(n)?L2.fromSingleCoord(i[0],n):se.success(new L2(i[1],n,g.of(i[0])))}static sortCoord(e){return 9*e.y+e.x}constructor(e,t,n){if(super(e.x,e.y),u(this,"dir",void 0),u(this,"lastPiece",void 0),this.dir=t,this.lastPiece=n,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}Pae=L2,u(L2,"encoder",Ie.tuple([C.encoder,be.encoder,g.getEncoder(C.encoder)],r=>[r.coord,r.dir,r.lastPiece],r=>new Pae(r[0],r[1],r[2])));let ml=(()=>{class r{}return u(r,"CANNOT_MOVE_MORE_THAN_THREE_PIECES",()=>$localize`You cannot move more than 3 of your pieces!`),u(r,"NOT_ENOUGH_PIECE_TO_PUSH",()=>$localize`You don't have enough pieces to push that group!`),u(r,"CANNOT_PUSH_YOUR_OWN_PIECES",()=>$localize`You cannot push this piece because it is blocked by one of yours!`),u(r,"MUST_ONLY_TRANSLATE_YOUR_PIECES",()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`),u(r,"TRANSLATION_IMPOSSIBLE",()=>$localize`This move is impossible, some landing spaces are occupied.`),u(r,"LINE_AND_COORD_NOT_ALIGNED",()=>$localize`This space is not aligned with the current line.`),r})();class Do extends jn{static get(){return Do.singleton.isAbsent()&&(Do.singleton=g.of(new Do)),Do.singleton.get()}constructor(){super(Di)}static isLegalRealPush(e,t,n,i,s){let o=0;const a=Ce.ofPlayer(n.getCurrentOpponent()),c=Ce.ofPlayer(n.getCurrentPlayer());for(;o<i&&n.isOnBoard(e)&&n.getPieceAt(e)===a;)o++,e=e.getNext(t.dir);return o>=i?se.failure(ml.NOT_ENOUGH_PIECE_TO_PUSH()):Di.isOnBoard(e)&&(n.getPieceAt(e)===Ce.EMPTY&&(s[e.y][e.x]=a),n.getPieceAt(e)===c)?se.failure(ml.CANNOT_PUSH_YOUR_OWN_PIECES()):se.success(s)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?ve.ZERO_WON:t[1]>5?ve.ONE_WON:ve.ONGOING}applyLegalMove(e,t,n){return new Di(n,t.turn+1)}isLegal(e,t){const n=this.getFirstPieceValidity(e,t);return n.isFailure()?n.toOtherFallible():e.isSingleCoord()?this.isLegalPush(e,t):this.isLegalSideStep(e,t)}getFirstPieceValidity(e,t){const n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===Ce.ofPlayer(t.getCurrentOpponent())?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}isLegalPush(e,t){let n=1,i=e.coord.getNext(e.dir);const s=Ce.ofPlayer(t.getCurrentPlayer()),o=Ce.EMPTY,a=t.getCopiedBoard();for(a[e.coord.y][e.coord.x]=o;n<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===s;)n++,i=i.getNext(e.dir);return n>3?se.failure(ml.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===Di.isOnBoard(i)||(a[i.y][i.x]=s,t.getPieceAt(i)===o)?se.success(a):Do.isLegalRealPush(i,e,t,n,a)}isLegalSideStep(e,t){let n=e.lastPiece.get();const i=e.coord.getDirectionToward(n).get();n=n.getNext(i);let s=e.coord;const o=Ce.ofPlayer(t.getCurrentPlayer()),a=t.getCopiedBoard();for(;!1===s.equals(n)&&Di.isOnBoard(s);){if(t.getPieceAt(s)!==o)return se.failure(ml.MUST_ONLY_TRANSLATE_YOUR_PIECES());const c=s.getNext(e.dir);if(a[s.y][s.x]=Ce.EMPTY,Di.isOnBoard(c)){if(t.isPiece(c))return se.failure(ml.TRANSLATION_IMPOSSIBLE());t.getPieceAt(c)===Ce.EMPTY&&(a[c.y][c.x]=o)}s=s.getNext(i)}return se.success(a)}getGameStatus(e){return Do.getGameStatus(e)}}u(Do,"singleton",g.empty());class c7t extends Hr{getListMoves(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(let s=0;s<9;s++)for(let o=0;o<9;o++){const a=new C(o,s);if(!1!==n.getPieceAt(a).is(i))for(const c of be.factory.all){const l=L2.fromSingleCoord(a,c).get();if(this.isAcceptablePush(l,n)){t.push(l);for(const f of be.factory.all)for(let d=1;d<=2&&!f.equals(c);d++){const m=a.getNext(f,d);if(!Di.isOnBoard(m))break;{const M=L2.fromDoubleCoord(a,m,c).get();Do.get().isLegal(M,n).isSuccess()&&t.push(M)}}}}}return new dt(t).toList()}isAcceptablePush(e,t){const n=t.getScores(),i=Do.get().isLegal(e,t);if(i.isSuccess()){const s=t.getCurrentOpponent().value;return!(new Di(i.get(),t.turn+1).getScores()[s]>n[s])}return!1}getMetrics(e){return e.gameState.getScores()}}const tn=Ce.EMPTY,Xr=Ce.UNREACHABLE,Ho=Ce.ZERO,eu=Ce.ONE;class Tae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,Di.getInitialState()),W.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,Di.getInitialState(),L2.fromSingleCoord(new C(2,6),be.UP).get(),$localize`Congratulations!`),W.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new Di([[Xr,Xr,Xr,Xr,tn,Ho,Ho,eu,eu],[Xr,Xr,Xr,tn,tn,tn,tn,tn,tn],[Xr,Xr,tn,Ho,Ho,Ho,eu,Ho,tn],[Xr,tn,tn,tn,tn,tn,tn,tn,tn],[tn,tn,tn,tn,Ho,Ho,Ho,eu,eu],[tn,tn,tn,tn,tn,tn,tn,tn,Xr],[tn,tn,tn,tn,Ho,eu,tn,Xr,Xr],[tn,tn,tn,Ho,tn,tn,Xr,Xr,Xr],[tn,tn,Ho,tn,tn,Xr,Xr,Xr,Xr]],0),[L2.fromSingleCoord(new C(4,4),be.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)])}}function l7t(r,e){if(1&r){const t=pe();A(),E(0,"circle",6),U("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onPieceClick(i,s))}),S()}if(2&r){const t=p(2).index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("cx",i.getCenterAtXY(t,n).x)("cy",i.getCenterAtXY(t,n).y)("r",.5*i.SPACE_SIZE)}}function u7t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"polygon",4),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onSpaceClick(i,s))}),S(),T(2,l7t,1,6,"circle",5),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();v(1),ye("id","space_",n,"_",s,""),y("ngClass",o.getSquareClasses(n,s)),k("points",o.getHexaPointsAtXY(n,s)),v(1),y("ngIf",o.isPiece(i))}}function f7t(r,e){if(1&r&&(A(),E(0,"g"),T(1,u7t,3,5,"g",3),S()),2&r){const t=e.$implicit,n=p(2);v(1),y("ngIf",n.isBoard(t))}}function d7t(r,e){if(1&r&&(A(),E(0,"g"),T(1,f7t,2,1,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function h7t(r,e){1&r&&(A(),E(0,"marker",7),F(1,"polygon",8),S()),2&r&&Rn("id","arrowhead_",e.$implicit.dir.toString(),"")}function p7t(r,e){if(1&r){const t=pe();A(),E(0,"g"),F(1,"line",9),E(2,"line",10),U("click",function(){const s=te(t).$implicit;return ne(p().chooseDirection(s.dir))}),S(),E(3,"polygon",11),U("click",function(){const s=te(t).$implicit;return ne(p().chooseDirection(s.dir))}),S()()}if(2&r){const t=e.$implicit;v(1),Rn("id","line_start_",t.dir.toString(),""),k("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.middle.x)("y2",t.middle.y),v(1),Rn("id","line_end_",t.dir.toString(),""),k("x1",t.middle.x)("y1",t.middle.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),v(1),Rn("id","direction_",t.dir.toString(),""),k("transform",t.transformation)}}class g7t{constructor(e,t,n,i,s,o){u(this,"startCenter",void 0),u(this,"middle",void 0),u(this,"landingCenter",void 0),u(this,"landing",void 0),u(this,"dir",void 0),u(this,"transformation",void 0),this.startCenter=e,this.middle=t,this.landingCenter=n,this.landing=i,this.dir=s,this.transformation=o}}let m7t=(()=>{var r;class e extends Q5{constructor(n){super(n),u(this,"moveds",[]),u(this,"directions",[]),u(this,"selecteds",[]),this.rules=Do.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new c7t(this.rules,"Dummy")],this.encoder=L2.encoder,this.tutorial=(new Tae).tutorial,this.scores=g.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new J5(this.SPACE_SIZE,new C(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),eC.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=g.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(n){n.isSingleCoord()?this.showPushingMove(n):this.showSideStepMove(n)}showPushingMove(n){const i=this.getPreviousState();let s=n.coord;for(this.moveds=[s],s=s.getNext(n.dir);Di.isOnBoard(s)&&i.isPiece(s);)this.moveds.push(s),s=s.getNext(n.dir);Di.isOnBoard(s)&&this.moveds.push(s)}showSideStepMove(n){let i=n.lastPiece.get();const s=n.coord.getDirectionToward(i).get();i=i.getNext(s);let o=n.coord;for(;!1===o.equals(i);)this.moveds.push(o),this.moveds.push(o.getNext(n.dir)),o=o.getNext(s)}onPieceClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#piece_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentOpponent();return s.hexaBoard[i][n].is(a)?s.opponentClick(n,i):0===s.selecteds.length?s.firstClick(n,i):1===s.selecteds.length?s.secondClick(n,i):s.thirdClick(n,i)})()}opponentClick(n,i){var s=this;return P(function*(){return(yield s.tryChoosingDirection(n,i)).isSuccess()?b.SUCCESS:s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(n,i){var s=this;return P(function*(){return s.selecteds=[new C(n,i)],s.showPossibleDirections(),b.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(n){const i=this.getState(),s=Ce.ofPlayer(i.getCurrentPlayer()),o=this.selecteds[0],a=this.selecteds[this.selecteds.length-1];for(const c of be.factory.all){let f,l=o.getNext(c,1);if(i.isOnBoard(l)&&i.getPieceAt(l)===s){if(n)continue;if(l=a.getNext(c,1),i.isOnBoard(l)&&i.getPieceAt(l)===s)continue}if(f=n?L2.fromSingleCoord(o,c).get():L2.fromDoubleCoord(o,a,c).get(),this.rules.isLegal(f,i).isSuccess()){const m=this.getCenterAt(o),M=this.getCenterAt(l),w=this.getMiddleOfArrow(c,l,M),L=M.x+" "+M.y,$="rotate("+(be.getAngle(c)+150)+" "+L+")",_e=new g7t(m,w,M,l,c,$+" translate("+L+")");this.directions.push(_e)}}}getMiddleOfArrow(n,i,s){const o=i.getPrevious(n),a=this.getCenterAt(o);return new C(a.x+(s.x-a.x)/2,a.y+(s.y-a.y)/2)}isBoard(n){return n!==Ce.UNREACHABLE}isPiece(n){return n!==Ce.EMPTY}secondClick(n,i){var s=this;return P(function*(){const o=s.selecteds[0],a=new C(n,i);if(a.equals(o))return s.cancelMoveAttempt(),b.SUCCESS;if(!1===a.isHexagonallyAlignedWith(o))return s.cancelMoveAttempt(),s.firstClick(n,i);const c=a.getDistance(o);if(c>2)return s.cancelMove(ml.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const l=o.getDirectionToward(a).get();s.selecteds=[o];for(let f=0;f<c;f++)s.selecteds.push(o.getNext(l,f+1));if(3===s.selecteds.length){const f=s.selecteds[1],d=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[f.y][f.x].is(d))return s.cancelMoveAttempt(),s.firstClick(n,i)}return s.showPossibleDirections(),b.SUCCESS})()}thirdClick(n,i){var s=this;return P(function*(){const o=new C(n,i),a=s.selecteds[0];if(o.equals(a))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return o.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&o.equals(s.selecteds[1])?(s.cancelMoveAttempt(),b.SUCCESS):s.tryExtension(o,a,c)})()}tryExtension(n,i,s){var o=this;return P(function*(){const a=Me.factory.fromMove(i,n);if(a.isSuccess()){const l=Me.factory.fromMove(s,n);if(a.equals(l)){const f=i.getDistance(n),d=s.getDistance(n);return 2===Math.max(f,d)?(o.selecteds.push(n),He.sortByDescending(o.selecteds,L2.sortCoord),o.showPossibleDirections(),b.SUCCESS):o.cancelMove(ml.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=o.cancelMove(ml.LINE_AND_COORD_NOT_ALIGNED());return yield o.firstClick(n.x,n.y),c})()}deselectExtremity(n){var i=this;return P(function*(){return i.selecteds=i.selecteds.slice(n?1:0,n?void 0:-1),i.showPossibleDirections(),b.SUCCESS})()}chooseDirection(n){var i=this;return P(function*(){const s=i.canUserPlay("#direction_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):i._chooseDirection(n)})()}_chooseDirection(n){var i=this;return P(function*(){const s=i.selecteds[0];if(1===i.selecteds.length){const o=L2.fromSingleCoord(s,n).get();return i.chooseMove(o)}{const a=L2.fromDoubleCoord(s,i.selecteds[i.selecteds.length-1],n).get();return i.chooseMove(a)}})()}onSpaceClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#space_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.tryChoosingDirection(n,i)})()}tryChoosingDirection(n,i){var s=this;return P(function*(){const o=new C(n,i);for(const a of s.directions)if(a.landing.equals(o))return s._chooseDirection(a.dir);return b.failure("not a direction")})()}getSquareClasses(n,i){const s=new C(n,i),o=[];return this.moveds.some(a=>a.equals(s))&&o.push("moved-fill"),o}getPieceClasses(n,i){const s=new C(n,i),o=I.of(this.hexaBoard[i][n].value),a=[this.getPlayerClass(o)];return this.selecteds.some(c=>c.equals(s))&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-abalone"]],features:[Je],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,d7t,2,1,"g",1),E(2,"defs"),T(3,h7t,2,1,"marker",2),S(),T(4,p7t,4,12,"g",1),S()),2&n&&(v(1),y("ngForOf",i.hexaBoard),v(2),y("ngForOf",i.directions),v(1),y("ngForOf",i.directions))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class _7t extends Hr{getListMoves(e){const t=e.gameState;return lo.ALL_MOVES.filter(function n(i){return X3.get().isLegal(i,t).isSuccess()})}getMetrics(e){const t=e.gameState.board[3].getDominatingPlayer(),n=[0,0];return t.isPlayer()&&(n[t.value]=1),n}}function v7t(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=e.$implicit,n=p();k("cx",n.getRemainingPieceCx(t))("cy",n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function C7t(r,e){if(1&r&&(A(),F(0,"circle",6)),2&r){const t=e.$implicit,n=p();k("cx",n.BOARD_WIDTH-n.getRemainingPieceCx(t))("cy",n.BOARD_HEIGHT-n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function y7t(r,e){if(1&r){const t=pe();A(),E(0,"polygon",9),U("click",function(){te(t);const i=p().index,s=p();return ne(s.onArrowClick(i,s.PlayerOrNone.ZERO))}),S()}if(2&r){const t=p().index,n=p();Rn("id","dropArrow_zero_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ZERO)),k("points",n.ARROW_COORD)("transform","translate("+n.SPACE_SIZE/2+" "+-n.SPACE_SIZE/2+")")}}function M7t(r,e){if(1&r){const t=pe();A(),E(0,"polygon",9),U("click",function(){te(t);const i=p().index,s=p();return ne(s.onArrowClick(i,s.PlayerOrNone.ONE))}),S()}if(2&r){const t=p().index,n=p();Rn("id","dropArrow_one_",t,""),y("ngClass",n.getArrowClasses(t,n.PlayerOrNone.ONE)),k("points",n.ARROW_COORD)("transform","translate(0 "+-n.SPACE_SIZE/2+")")}}function E7t(r,e){if(1&r){const t=pe();A(),Bt(0),E(1,"circle",10),U("click",function(){te(t);const i=p().index;return ne(p().onSquareClick(i))}),S(),Gt()}if(2&r){const t=e.$implicit,n=p(),i=n.index,s=n.$implicit,o=p();v(1),Ti("id","square_",i,"_piece_",t,"_out_of_",s.count(o.PlayerOrNone.NONE),""),y("ngClass",o.getPieceClasses(i,t,s)),k("cx",o.getCircleCenter(i,t,s).x)("cy",o.getCircleCenter(i,t,s).y)}}function S7t(r,e){if(1&r){const t=pe();A(),E(0,"g"),T(1,y7t,1,4,"polygon",7),T(2,M7t,1,4,"polygon",7),E(3,"rect",8),U("click",function(){const s=te(t).index;return ne(p().onSquareClick(s))}),S(),T(4,E7t,2,6,"ng-container",4),S()}if(2&r){const t=e.$implicit,n=e.index,i=p();k("transform",i.getBlockTransform(n)),v(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ZERO)),v(1),y("ngIf",i.canDisplayArrow(n,i.PlayerOrNone.ONE)),v(1),Rn("id","square_",n,""),y("ngClass",i.getSquareClasses(n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngForOf",i.ArrayUtils.range(t.count(i.PlayerOrNone.NONE)))}}let P7t=(()=>{var r;class e extends gl{static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}constructor(n){super(n),u(this,"PlayerOrNone",X),u(this,"BOARD_WIDTH",4*this.SPACE_SIZE),u(this,"BOARD_HEIGHT",4.5*this.SPACE_SIZE),u(this,"board",void 0),u(this,"remainingZero",void 0),u(this,"remainingOne",void 0),u(this,"ARROW_COORD",e.getArrowCoord()),u(this,"PIECES_PER_PLAYER",pl.PIECES_PER_PLAYER),u(this,"PIECE_RADIUS",void 0),u(this,"movedSquare",void 0),u(this,"selectedPiece",g.empty()),u(this,"leftPiece",g.empty()),u(this,"droppedPiece",g.empty()),u(this,"displayableArrow",[]),this.rules=X3.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableMinimaxes=[new _7t(this.rules,"ApagosDummyMinimax")],this.encoder=lo.encoder,this.tutorial=(new vae).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=g.empty(),this.showPossibleDrops()}updateBoard(){const n=this.getState();this.board=n.board,this.remainingZero=n.remaining.get(I.ZERO).get(),this.remainingOne=n.remaining.get(I.ONE).get(),this.hideLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=g.empty(),this.leftPiece=g.empty(),this.selectedPiece=g.empty()}showLastMove(n){n.isDrop()?this.showLastDrop(n):this.showLastTransfer(n)}showLastDrop(n){const i=n.piece.get();let s=n.landing.x;this.movedSquare=[s],3!==n.landing.x&&(s+=1,this.movedSquare.push(s));const a=this.getLowestPlayerPiece(this.board[s],i);this.droppedPiece=g.of({square:s,piece:a})}getLowestPlayerPiece(n,i){const s=n.count(i);return i===I.ZERO?s-1:n.count(X.NONE)-s}showLastTransfer(n){const i=this.getPreviousState(),s=i.getCurrentPlayer(),o=n.starting.get().x,c=this.getLowestPlayerPiece(i.board[o],s);this.leftPiece=g.of({square:o,piece:c});const l=n.landing.x,d=this.getLowestPlayerPiece(this.board[l],s);this.droppedPiece=g.of({square:l,piece:d})}showPossibleDrops(){this.displayableArrow=[];const n=this.getState();for(let i=0;i<4;i++)!1===n.board[i].isFull()&&(n.remaining.get(I.ZERO).get()>0&&this.displayableArrow.push({x:i,player:I.ZERO}),n.remaining.get(I.ONE).get()>0&&this.displayableArrow.push({x:i,player:I.ONE}))}getCircleCenter(n,i,s){const o=this.SPACE_SIZE/2,a=this.SPACE_SIZE/2;if(1===s.count(X.NONE))return new C(o,a);const c=s.count(X.NONE),l=2*i*Math.PI/c-Math.PI/2,f=.3*this.SPACE_SIZE,d=f*Math.cos(l),m=f*Math.sin(l);return new C(o+d,a+m)}canDisplayArrow(n,i){return this.displayableArrow.some(s=>s.x===n&&s.player.equals(i))}getArrowClasses(n,i){return[this.getPlayerClass(i)]}getBlockTransform(n){return"translate("+n*this.SPACE_SIZE+", "+((3-n)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(n){const i=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===n?i.push("selected-stroke"):this.movedSquare.includes(n)&&i.push("last-move-stroke"),i}onArrowClick(n,i){var s=this;return P(function*(){const a=s.canUserPlay("#dropArrow_"+(i===I.ZERO?"zero":"one")+"_"+n);if(a.isFailure())return s.cancelMove(a.getReason());const c=Jt.of(n);if(s.selectedPiece.isPresent()){const l=s.selectedPiece.get().square,f=lo.transfer(Jt.of(l),c).get();return s.chooseMove(f)}{const l=lo.drop(c,i);return s.chooseMove(l)}})()}getPieceClasses(n,i,s){const o={square:n,piece:i},a=[];let c=s.count(I.ZERO),l=s.count(I.ONE);if(this.selectedPiece.equalsValue(o))a.push("selected-stroke");else if(this.droppedPiece.equalsValue(o))a.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===n){if(this.leftPiece.get().piece===i)return a.push("captured-stroke"),a;this.getState().getCurrentOpponent()===I.ZERO?c++:l++}const f=s.count(X.NONE)-(l+c),d=this.getPieceColor(i,c,f);return""!==d&&a.push(d),a}getPieceColor(n,i,s){return n<i?"player0-fill":n>=i+s?"player1-fill":""}onSquareClick(n){var i=this;return P(function*(){const s=i.canUserPlay("#square_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.selectedPiece.isPresent()&&i.selectedPiece.get().square===n)return i.cancelMoveAttempt(),b.SUCCESS;const o=i.getState().getCurrentPlayer(),a=i.board[n];return a.count(o)<=0?i.cancelMove(K5.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(i.selectedPiece=g.of({square:n,piece:i.getLowestPlayerPiece(a,o)}),0===i.showAndGetPossibleTranfers().length?i.cancelMove(K5.NO_POSSIBLE_TRANSFER_REMAINS()):b.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let n=this.selectedPiece.get().square-1;const i=this.getState().getCurrentPlayer();for(;0<=n;)!1===this.board[n].isFull()&&this.displayableArrow.push({x:n,player:i}),n--;return this.displayableArrow}getRemainingPieceCx(n){return(n+.5)*this.PIECE_RADIUS*1.5}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-apagos"]],features:[Je],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"g"),T(2,v7t,1,3,"circle",1),T(3,C7t,1,3,"circle",2),S(),E(4,"g",3),T(5,S7t,5,8,"g",4),S()()),2&n&&(k("viewBox",-i.STROKE_WIDTH/2+" "+-i.STROKE_WIDTH/2+" "+(i.BOARD_WIDTH+i.STROKE_WIDTH)+" "+(i.BOARD_HEIGHT+i.STROKE_WIDTH)),v(1),k("transform","rotate("+180*i.role.value+" "+i.BOARD_WIDTH/2+" "+i.BOARD_HEIGHT/2+")"),v(1),y("ngForOf",i.ArrayUtils.range(i.remainingOne)),v(1),y("ngForOf",i.ArrayUtils.range(i.remainingZero)),v(2),y("ngForOf",i.board))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Hi=(()=>{var r;class e extends gl{constructor(...n){super(...n),u(this,"board",void 0)}getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}()),u(e,"\u0275cmp",Xe({type:r,selectors:[["ng-component"]],features:[Je],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();class fs extends F1{static getInitialState(){const e=He.createTable(6,2,4);return new fs(e,0,[0,0])}constructor(e,t,n){super(e,t),u(this,"captured",void 0),this.captured=n}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let TL=(()=>{class r{}return u(r,"CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME",()=>$localize`You cannot distribute from the opponent's home.`),u(r,"MUST_CHOOSE_NON_EMPTY_HOUSE",()=>$localize`You should choose a non-empty house to distribute.`),u(r,"SHOULD_DISTRIBUTE",()=>$localize`You should distribute but you do not.`),r})();var tC,f2;let Sa=(tC=class extends jn{static get(){return f2.singleton.isAbsent()&&(f2.singleton=g.of(new f2)),f2.singleton.get()}constructor(){super(fs)}applyLegalMove(e,t,n){const i=e.x,s=t.getCurrentPlayer(),a=t.getCurrentOpponent().value,c=t.getCopiedBoard(),l=f2.distribute(i,a,c),f=l[l.length-1];return f.y===a?new fs(c,t.turn+1,t.captured):this.applyPotentialCapture(s,f,c,t)}applyPotentialCapture(e,t,n,i){const s=i.getCurrentOpponent(),o=[i.captured[0],i.captured[1]],a=f2.captureIfLegal(t.x,t.y,e,n);o[e.value]+=a.capturedSum;const c=a.resultingBoard;if(f2.mustMansoon(e,c)){const l=f2.mansoon(s,c);return o[s.value]+=l.capturedSum,new fs(l.resultingBoard,i.turn+1,o)}return new fs(c,i.turn+1,o)}static mustMansoon(e,t){return f2.isStarving(e,t)&&!1===f2.canDistribute(e.getOpponent(),t)}static mansoon(e,t){const n=He.copyBiArray(t);let i=0;const s=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let o=0;const a=e.getOpponent().value;do{i+=n[a][o],s[a][o]=n[a][o],n[a][o]=0,o++}while(o<6);return{capturedSum:i,captureMap:s,resultingBoard:n}}static isLegal(e,t){const n=t.getCurrentOpponent(),i=n.value,s=e.x;if(0===t.getPieceAtXY(s,i))return b.failure(TL.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=f2.isStarving(n,t.board),a=!1===f2.doesDistribute(s,i,t.board);return o&&a?b.failure(TL.SHOULD_DISTRIBUTE()):b.SUCCESS}isLegal(e,t){return f2.isLegal(e,t)}static doesDistribute(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}static canDistribute(e,t){for(let n=0;n<6;n++)if(f2.doesDistribute(n,e.getOpponent().value,t))return!0;return!1}static isStarving(e,t){let n=0;const i=e.getOpponent().value;do{if(t[i][n++]>0)return!1}while(n<6);return!0}static distribute(e,t,n){const i=e,s=t;let o=n[t][e];const a=[];for(n[t][e]=0;o>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==i||t!==s)&&(n[t][e]+=1,a.push(new C(e,t)),o--);return a}static capture(e,t,n,i){const s=He.copyBiArray(i);Ve(t!==n.getOpponent().value,"AwaleRules.capture cannot capture the players house");let a=s[t][e],c=0;const l=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(a<2||a>3)return{capturedSum:0,captureMap:l,resultingBoard:s};let f=-1,d=-1;n===I.ONE&&(f=1,d=6);do{l[t][e]=a,c+=a,s[t][e]=0,a=s[t][e+=f]}while(e!==d&&(2===a||3===a));return{capturedSum:c,captureMap:l,resultingBoard:s}}static captureIfLegal(e,t,n,i){const s=He.copyBiArray(i),o=f2.capture(e,t,n,i),a=f2.isStarving(n.getOpponent(),o.resultingBoard);return o.capturedSum>0&&a?{capturedSum:0,resultingBoard:s,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:o}static getGameStatus(e){const t=e.gameState;return t.captured[0]>24?ve.ZERO_WON:t.captured[1]>24?ve.ONE_WON:24===t.captured[0]&&24===t.captured[1]?ve.DRAW:ve.ONGOING}getGameStatus(e){return f2.getGameStatus(e)}},f2=tC,u(tC,"singleton",g.empty()),tC);var _l;Sa=f2=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],Sa);class u1 extends Li{static of(e){switch(e){case 0:return u1.ZERO;case 1:return u1.ONE;case 2:return u1.TWO;case 3:return u1.THREE;case 4:return u1.FOUR;default:return K.expectToBe(e,5,"Invalid x for AwaleMove: "+e),u1.FIVE}}constructor(e){super(),u(this,"x",void 0),this.x=e}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}u(u1,"ZERO",new(_l=u1)(0)),u(u1,"ONE",new _l(1)),u(u1,"TWO",new _l(2)),u(u1,"THREE",new _l(3)),u(u1,"FOUR",new _l(4)),u(u1,"FIVE",new _l(5)),u(u1,"encoder",Ie.tuple([Ie.identity()],r=>[r.x],r=>_l.of(r[0])));class O7t extends Hr{getListMoves(e){const t=[],n=e.gameState,s=(n.turn+1)%2;let o,a=0;do{0!==n.getPieceAtXY(a,s)&&(o=u1.of(a),Sa.isLegal(o,n).isSuccess()&&(o=u1.of(a),t.push(o))),a++}while(a<6);return this.orderMoves(e,t)}orderMoves(e,t){const n=e.gameState.getCurrentPlayer(),i=e.gameState.getCurrentOpponent().value,s=n.value;return He.sortByDescending(t,o=>{const a=e.gameState.getCopiedBoard(),c=a[i][o.x],l=Sa.distribute(o.x,i,a),f=l[l.length-1];let d,m=0;return f.y===i?(d=0,c<=6&&(m=10)):d=Sa.captureIfLegal(f.x,s,n,a).capturedSum,100*d+m-c}),t}getMetrics(e){const t=e.gameState.getCapturedCopy();return[t[0],t[1]]}}class Oae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.anyMove($localize`Sowing`,$localize`Awalé is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awalé are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,fs.getInitialState(),u1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),W.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new fs([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),u1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),W.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new fs([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[u1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),W.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new fs([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[u1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),W.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new fs([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[u1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),W.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new fs([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[u1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),W.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new fs([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[u1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),W.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new fs([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),u1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),W.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new fs([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),u1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)])}}function b7t(r,e){if(1&r){const t=pe();A(),E(0,"text",7),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onClick(i,s))}),lt(1),S()}if(2&r){const t=p().index,n=p().index,i=p();ye("id","captured_",t,"_",n,""),k("x",65+100*t)("y",81+120*n)("transform",i.getPieceRotation(t,n)),v(1),S2(" ",-i.captured[n][t]," ")}}function w7t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"circle",4),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),S(),E(2,"text",5),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),lt(3),S(),T(4,b7t,2,6,"text",6),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","click_",n,"_",i,""),y("ngClass",s.getSpaceClasses(n,i)),k("cx",s.getPieceCx(n))("cy",s.getPieceCy(i)),v(1),ye("id","number_",n,"__",i,""),k("x",50+100*n)("y",66+120*i)("transform",s.getPieceRotation(n,i)),v(1),S2(" ",t," "),v(1),y("ngIf",s.captured[i][n]>0)}}function N7t(r,e){if(1&r&&(A(),E(0,"g"),T(1,w7t,5,12,"g",2),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}let A7t=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"last",g.empty()),u(this,"captured",[[0,0,0,0,0,0],[0,0,0,0,0,0]]),u(this,"filledCoords",[]),this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.rules=Sa.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new O7t(this.rules,"AwaleMinimax")],this.encoder=u1.encoder,this.tutorial=(new Oae).tutorial,this.updateBoard()}updateBoard(){const n=this.getState();this.scores=g.of(n.getCapturedCopy()),this.hidePreviousMove(),this.board=n.getCopiedBoard(),this.last=g.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showLastMove(n){const i=this.getState().getCurrentPlayer().value;this.last=g.of(new C(n.x,i));const s=this.getPreviousState(),o=He.copyBiArray(s.board),a=s.getCurrentOpponent().value;this.filledCoords=Sa.distribute(n.x,a,o);const c=this.filledCoords[this.filledCoords.length-1];if(c.y!==a){const l=Sa.captureIfLegal(c.x,c.y,s.getCurrentPlayer(),o);this.captured=l.captureMap;const f=this.getState().getCurrentPlayer();Sa.mustMansoon(f.getOpponent(),l.resultingBoard)&&(this.captured=Sa.mansoon(f,l.resultingBoard).captureMap)}}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(i===s.getState().getCurrentPlayer().value)return s.cancelMove(TL.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=g.empty();const a=u1.of(n);return s.chooseMove(a)})()}getSpaceClasses(n,i){const s=new C(n,i),o="player"+(i+1)%2+"-fill";return this.captured[i][n]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",o]:this.filledCoords.some(a=>a.equals(s))?["moved-stroke",o]:[o]}getPieceCx(n){return 50+100*n}getPieceCy(n){return 50+120*n}getPieceRotation(n,i){return"rotate("+180*this.role.value+" "+this.getPieceCx(n)+" "+this.getPieceCy(i)+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-awale-component"]],features:[Je],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),F(1,"rect",1),T(2,N7t,2,1,"g",2),F(3,"line",3),S()),2&n&&(k("transform",i.rotation),v(2),y("ngForOf",i.board))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class zs extends Li{static getFallibleEncoder(e){return Ie.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return Ie.tuple([C.encoder,C.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}constructor(e,t){super(),u(this,"first",void 0),u(this,"second",void 0),this.first=e,this.second=t}getFirst(){return this.first}getSecond(){return this.second}}class Vo extends zs{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Le.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return Me.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}let nC=(()=>{class r{}return u(r,"LANDING_ON_OCCUPIED_SQUARE",()=>$localize`You cannot land on an occupied square.`),u(r,"THRONE_IS_LEFT_FOR_GOOD",()=>$localize`Once you left the central throne, you cannot return to it.`),u(r,"SOLDIERS_CANNOT_SIT_ON_THRONE",()=>$localize`Soldiers cannot sit on the throne.`),u(r,"MOVE_MUST_BE_ORTHOGONAL",()=>$localize`Tafl moves must be orthogonal.`),r})();class OL extends Vo{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const n=e.getDirectionToward(t);if(n.isFailure()||n.get().isDiagonal())throw new Error(nC.MOVE_MUST_BE_ORTHOGONAL())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class ds extends OL{static of(e,t){return new ds(e,t)}static from(e,t){try{const n=new ds(e,t);return se.success(n)}catch(n){return se.failure(n.message)}}getMaximalDistance(){return 7}}u(ds,"encoder",zs.getFallibleEncoder(ds.from));const I7t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:I.ZERO};var Td,rC;class sn{constructor(e,t){u(this,"owner",void 0),u(this,"king",void 0),this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}u(sn,"UNOCCUPIED",new(Td=sn)(X.NONE,!1)),u(sn,"PLAYER_ONE_KING",new Td(X.ONE,!0)),u(sn,"INVADERS",new Td(X.ZERO,!1)),u(sn,"DEFENDERS",new Td(X.ONE,!1));class v1{constructor(e){u(this,"value",void 0),this.value=e}}u(v1,"NONE",new(rC=v1)("NONE")),u(v1,"OPPONENT",new rC("OPPONENT")),u(v1,"PLAYER",new rC("PLAYER"));class bL extends F1{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new C(e,e)}getRelativeOwner(e,t){const n=this.getAbsoluteOwner(t);let i;return i=n===X.NONE?v1.NONE:e===n?v1.PLAYER:v1.OPPONENT,i}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class Pa extends bL{static getInitialState(){const e=sn.UNOCCUPIED,t=sn.INVADERS,n=sn.DEFENDERS;return new Pa([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,n,e,e,e],[t,t,n,sn.PLAYER_ONE_KING,n,t,t],[e,e,e,n,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}of(e,t){return new Pa(e,t)}}class wL extends jn{constructor(e,t,n){super(e),u(this,"config",void 0),u(this,"generateMove",void 0),this.config=t,this.generateMove=n}isLegal(e,t){const n=t.getCurrentPlayer(),i=this.getMoveValidity(n,e,t);return i.isFailure()?b.failure(i.getReason()):b.SUCCESS}getMoveValidity(e,t,n){const i=n.getRelativeOwner(e,t.getStart());if(i===v1.NONE)return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(i===v1.OPPONENT)return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.getEnd())!==v1.NONE)return b.failure(nC.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.getEnd())){if(!n.getPieceAt(t.getStart()).isKing())return b.failure(nC.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return b.failure(nC.THRONE_IS_LEFT_FOR_GOOD())}const o=t.getStart().getDirectionToward(t.getEnd()).get(),a=t.getStart().getOrthogonalDistance(t.getEnd());let c=t.getStart().getNext(o);for(let l=1;l<a;l++){if(n.getPieceAt(c)!==sn.UNOCCUPIED)return b.failure(Le.SOMETHING_IN_THE_WAY());c=c.getNext(o)}return b.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,n,i){const s=t.getNext(n);return s.isNotInRange(this.config.WIDTH,this.config.WIDTH)||i.getRelativeOwner(e,s)!==v1.OPPONENT?g.empty():i.getPieceAt(s).isKing()?this.captureKing(e,t,n,i):this.capturePawn(e,t,n,i)}captureKing(e,t,n,i){const s=t.getNext(n),{backCoord:o,back:a,backInRange:c,left:l,leftCoord:f,right:d,rightCoord:m}=this.getSurroundings(s,n,e,i);return!1===c?this.captureKingAgainstTheWall(l,d,s):a===v1.NONE&&this.isThrone(i,o)?this.captureKingAgainstThrone(o,s,l,d):a===v1.PLAYER?this.captureKingWithAtLeastASandwich(i,s,l,f,d,m):g.empty()}getSurroundings(e,t,n,i){const s=e.getNext(t),o=s.isInRange(this.config.WIDTH,this.config.WIDTH),a=o?i.getRelativeOwner(n,s):v1.NONE,c=e.getLeft(t),f=c.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,c):v1.NONE,d=e.getRight(t),M=d.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(n,d):v1.NONE;return{backCoord:s,back:a,backInRange:o,leftCoord:c,left:f,rightCoord:d,right:M}}captureKingAgainstTheWall(e,t,n){let i=e===v1.PLAYER?1:0;return i+=t===v1.PLAYER?1:0,2===i&&this.config.BORDER_CAN_SURROUND_KING?g.of(n):g.empty()}captureKingAgainstThrone(e,t,n,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t)}else if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&(n===v1.PLAYER||i===v1.PLAYER))return g.of(t);return g.empty()}capturePawn(e,t,n,i){const s=t.getNext(n),o=s.getNext(n);let a=v1.NONE;return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&(a=i.getRelativeOwner(e,o)),a===v1.NONE?!1===this.isThrone(i,o)?(we.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")cannot capture a pawn without an ally behind"),g.empty()):(we.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):a===v1.PLAYER?(we.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.of(s)):(we.display("TaflRules","capturePawn","no captures; "+s+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+n.x+", "+n.y+")"),g.empty())}captureKingWithAtLeastASandwich(e,t,n,i,s,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return g.of(t);const a=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,c=this.isThrone(e,i),l=n===v1.PLAYER||c&&a,f=this.isThrone(e,o);return l&&(s===v1.PLAYER||f&&a)?g.of(t):g.empty()}kingTouchCentralThrone(e,t){const n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}applyLegalMove(e,t,n){const i=t.turn,s=t.getCopiedBoard(),o=t.getCurrentPlayer(),a=e.getStart(),c=e.getEnd();s[c.y][c.x]=s[a.y][a.x],s[a.y][a.x]=sn.UNOCCUPIED;for(const l of Re.ORTHOGONALS){const f=this.tryCapture(o,e.getEnd(),l,t);f.isPresent()&&(s[f.get().y][f.get().x]=sn.UNOCCUPIED)}return t.of(s,i+1)}getGameStatus(e){const n=this.getWinner(e.gameState);return n.isPresent()?ve.getVictory(n.get()):ve.ONGOING}getWinner(e){const t=this.getKingCoord(e);if(t.isAbsent())return we.display("TaflRules","getWinner","The king is dead, victory to invader"),g.of(this.getInvader());const n=t.get();return this.isExternalThrone(n)?(we.display("TaflRules","getWinner","The king escape, victory to defender"),g.of(this.getDefender())):this.isPlayerImmobilized(I.ZERO,e)?(we.display("TaflRules","getWinner","Zero has no move, victory to one"),g.of(I.ONE)):this.isPlayerImmobilized(I.ONE,e)?(we.display("TaflRules","getWinner","One has no move, victory to zero"),g.of(I.ZERO)):(we.display("TaflRules","getWinner","no victory"),g.empty())}getKingCoord(e){for(let t=0;t<this.config.WIDTH;t++)for(let n=0;n<this.config.WIDTH;n++)if(e.getPieceAtXY(n,t).isKing())return g.of(new C(n,t));return g.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(e,t){const n=[],i=this.getPlayerListPawns(e,t);for(const s of i){const o=this.getPossibleDestinations(s,t);for(const a of o){const c=this.generateMove(s,a).get();n.push(c)}}return n}getPlayerListPawns(e,t){const n=[];for(let i=0;i<this.config.WIDTH;i++)for(let s=0;s<this.config.WIDTH;s++){const o=new C(s,i);t.getAbsoluteOwner(o)===e&&n.push(o)}return n}getPossibleDestinations(e,t){const n=[];let i;for(const s of Re.ORTHOGONALS){i=e.getNext(s,1);let o=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===o;)t.getAbsoluteOwner(i)===X.NONE?this.isExternalThrone(i)?t.getPieceAt(e).isKing()&&n.push(i):t.isCentralThrone(i)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&n.push(i):n.push(i):o=!0,i=i.getNext(s,1)}return n}}class vl extends wL{static get(){return vl.singleton.isAbsent()&&(vl.singleton=g.of(new vl)),vl.singleton.get()}constructor(){super(Pa,I7t,ds.from)}}u(vl,"singleton",g.empty());class NL extends Hi{constructor(e,t){super(e),u(this,"generateMove",void 0),u(this,"viewInfo",{pieceClasses:[]}),u(this,"EMPTY",sn.UNOCCUPIED),u(this,"capturedCoords",[]),u(this,"chosen",g.empty()),this.generateMove=t}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(){this.board=this.getState().getCopiedBoard(),this.capturedCoords=[],this.updateViewInfo()}showLastMove(e){const t=this.getPreviousState(),n=this.getState().getCurrentOpponent();for(const i of Re.ORTHOGONALS){const s=e.getEnd().getNext(i,1);if(s.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const a=t.getRelativeOwner(n,s)===v1.OPPONENT,l=this.getState().getPieceAt(s)===sn.UNOCCUPIED;a&&l&&this.capturedCoords.push(s)}}}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.board.length;t++){const n=[];for(let i=0;i<this.board[0].length;i++){let s=[];s=this.board[t][i].getOwner()===X.NONE?[""]:this.getPieceClasses(i,t),n.push(s)}e.push(n)}this.viewInfo={pieceClasses:e}}onClick(e,t){var n=this;return P(function*(){const i=n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);return n.chosen.equalsValue(s)?(n.cancelMoveAttempt(),b.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(s)?n.choosePiece(s):n.chooseDestination(e,t)})()}chooseDestination(e,t){var n=this;return P(function*(){const i=n.chosen.get(),s=new C(e,t),o=n.generateMove(i,s);return o.isSuccess()?yield n.chooseMove(o.get()):n.cancelMove(o.getReason())})()}choosePiece(e){return this.board[e.y][e.x]===sn.UNOCCUPIED?this.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):!1===this.pieceBelongToCurrentPlayer(e)?this.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=g.of(e),this.updateViewInfo(),b.SUCCESS)}pieceBelongToCurrentPlayer(e){const t=this.getState(),n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===v1.PLAYER}cancelMoveAttempt(){this.chosen=g.empty(),this.updateViewInfo()}isThrone(e,t){const n=this.getState();return this.rules.isThrone(n,new C(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new C(e,t))}getPieceClasses(e,t){const n=[],i=new C(e,t),s=this.getState().getAbsoluteOwner(i);return n.push(this.getPlayerClass(s)),this.chosen.equalsValue(i)&&n.push("selected-stroke"),n}getRectClasses(e,t){const n=[],i=new C(e,t);if(this.capturedCoords.some(s=>s.equals(i)))n.push("captured-fill");else if(this.node.move.isPresent()){const s=this.node.move.get().getStart(),o=this.node.move.get().getEnd();(i.equals(s)||i.equals(o))&&n.push("moved-fill")}return n}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[t].length;n++){const i=new C(n,t);this.isClickable(i)&&e.push(i)}return e}isClickable(e){return this.pieceBelongToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===sn.INVADERS}isKing(e,t){return this.board[t][e].isKing()}}let Nae,tu=class extends Hr{getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,i)}orderMoves(e,t){const n=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?He.sortByDescending(t,i=>-i.getEnd().getOrthogonalDistance(n)):He.sortByDescending(t,i=>i.getStart().equals(n)?this.ruler.isExternalThrone(i.getEnd())?2:1:0),t}getMetrics(e){const t=e.gameState,n=this.ruler.getPlayerListPawns(I.ZERO,t).length,i=this.ruler.getPlayerListPawns(I.ONE,t).length;return[n*[1,2][this.ruler.config.INVADER.value],i*[2,1][this.ruler.config.INVADER.value]]}};tu=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],tu);class iC{constructor(e,t){u(this,"directThreats",void 0),u(this,"mover",void 0),this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class wae extends iC{constructor(e,t){super(new dt([e]),t),u(this,"directThreat",void 0),this.directThreat=e}}Nae=Symbol.iterator;class x7t extends dt{constructor(e){if(super(),u(this,"valueMap",void 0),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0])void 0===n[s]&&(n[s]=[]),n=n[s];const i=t[1];return void 0===n[i]&&(n[i]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let n=this.valueMap;for(const s of t[0]){if(void 0===n[s])return!1;n=n[s]}return void 0!==n[t[1]]}[Nae](){return this.values.values()}}class $1 extends x7t{toFields(e){return[[e.y],e.x]}}class sC extends tu{constructor(e,t){super(e,t),u(this,"width",void 0),u(this,"maxInfluence",void 0),u(this,"scoreByThreatenedPiece",void 0),u(this,"scoreBySafePiece",void 0),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,i=sn.UNOCCUPIED;let s=0;const o=this.getPiecesMap(n),a=this.getThreatMap(n,o),c=this.filterThreatMap(a,n);for(const l of I.PLAYERS)for(const f of o.get(l).get())if(c.get(f).isPresent())s+=l.getScoreModifier()*this.scoreByThreatenedPiece;else{s+=l.getScoreModifier()*this.scoreBySafePiece;let d=0;for(const m of Re.ORTHOGONALS){let M=f.getNext(m,1);for(;M.isInRange(this.width,this.width)&&n.getPieceAt(M)===i;)d++,M=M.getNext(m,1)}s+=d*l.getScoreModifier()}return new an(s)}getPiecesMap(e){const t=sn.UNOCCUPIED,n=[],i=[];for(let o=0;o<this.width;o++)for(let a=0;a<this.width;a++){const c=new C(a,o);e.getPieceAt(c)!==t&&(e.getAbsoluteOwner(c)===I.ZERO?n.push(c):i.push(c))}return new un([{key:I.ZERO,value:new $1(n)},{key:I.ONE,value:new $1(i)}])}getThreatMap(e,t){const n=new un;for(const i of I.PLAYERS)for(const s of t.get(i).get()){const o=this.getThreats(s,e);this.isThreatReal(s,e,o)&&n.set(s,new dt(o))}return n}getThreats(e,t){const n=t.getAbsoluteOwner(e);Ve(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const i=n.getOpponent(),s=[];for(const o of Re.ORTHOGONALS){const a=e.getPrevious(o,1);if(this.isAThreat(a,t,i)){const c=[];for(const l of Re.ORTHOGONALS){if(l===o.getOpposite())continue;let f=e.getNext(o,1);for(;f.isInRange(this.width,this.width)&&t.getPieceAt(f)===sn.UNOCCUPIED;)f=f.getNext(l);f.isInRange(this.width,this.width)&&t.getAbsoluteOwner(f)===i&&!1===e.getNext(o,1).equals(f)&&c.push(f)}s.push(new wae(a,new $1(c)))}}return s}isAThreat(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==I.ONE&&t.getPieceAt(e)!==sn.UNOCCUPIED))}isThreatReal(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;for(const i of n)if(i.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const n=new un,i=e.listKeys(),s=i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentPlayer()),o=new $1(i.filter(a=>t.getAbsoluteOwner(a)===t.getCurrentOpponent()));for(const a of s){const c=e.get(a).get(),l=[];for(const f of c)if(!1===o.contains(f.directThreat)){const d=[];for(const m of f.mover)!1===o.contains(m)&&d.push(m);d.length>0&&l.push(new wae(f.directThreat,new $1(d)))}l.length>0&&n.set(a,new dt(l))}for(const a of o){const c=e.get(a).get();n.set(a,c)}return n}}class oC extends sC{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,s=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,n);let o=s.controlScore;o+=s.safeScore*this.getScoreBySafePiece(n);const a=this.getScoreByThreatenedPiece(n);return o+=s.threatenedScore*a,Ve(s.controlScore<=a,"Control Score should be below "+a+", got "+s.controlScore),Ve(s.threatenedScore<=16,"Threatened Score should be below 16, got "+s.threatenedScore),Ve(s.safeScore<=16,"Safe Score should be below 16, got "+s.threatenedScore),new an(o)}getControlScoreAndPieceScores(e,t){const n=this.getPiecesMap(t),i=this.getThreatMap(t,n),s=this.filterThreatMap(i,t),o={safeScore:0,threatenedScore:0,controlScore:0};for(const a of I.PLAYERS){const c=new $1;for(const l of n.get(a).get())if(s.get(l).isPresent())o.threatenedScore+=a.getScoreModifier();else{o.safeScore+=a.getScoreModifier();for(const f of Re.ORTHOGONALS){let d=l.getNext(f,1);for(;d.isInRange(e,e)&&t.getPieceAt(d)===sn.UNOCCUPIED;)c.add(d),d=d.getNext(f,1)}}for(const l of c){const f=this.getControlledPieceValue(l.x,l.y,e);o.controlScore+=a.getScoreModifier()*f}}return o}getControlledPieceValue(e,t,n){let i=1;return(0===e||e===n-1)&&(i*=n),(0===t||t===n-1)&&(i*=n),i}getScoreByThreatenedPiece(e){const t=e.board.length,n=t-2;return 4*t*t+4*n*t+n*n}getScoreBySafePiece(e){return 16*this.getScoreByThreatenedPiece(e)+1}}class AL extends oC{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,s=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,n),o=n.getPieceAt(this.ruler.getKingCoord(n).get()).getOwner(),a=this.getStepForEscape(n)*o.getScoreModifier();if(-1===a)return new an(o.getOpponent().getPreVictory());const c=this.getScoreByThreatenedPiece(n);return K.assert(s.controlScore<=c,"Control Score should be below "+c+", got "+s.controlScore),K.assert(s.threatenedScore<=16,"Threatened Score should be below 16, got "+s.threatenedScore),K.assert(s.safeScore<=16,"Safe Score should be below 16, got "+s.threatenedScore),new an(-1*a*(c+1)*17*17+s.safeScore*(c+1)*17+s.threatenedScore*(c+1)+s.controlScore)}getStepForEscape(e){const t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,n,i){const s=this.getNextGen(e,n,i);return 0===s.length?g.empty():s.some(o=>this.ruler.isExternalThrone(o))?g.of(t):(t++,i.push(...s),this._getStepForEscape(e,t,s,i))}getNextGen(e,t,n){const i=[];for(const s of t)for(const o of Re.ORTHOGONALS){let a=s.getNext(o,1);for(;a.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&e.getPieceAt(a)===sn.UNOCCUPIED;)n.every(c=>!1===c.equals(a))&&i.push(a),a=a.getNext(o,1)}return i}}const q=sn.UNOCCUPIED,c1=sn.INVADERS,Ds=sn.DEFENDERS,Od=sn.PLAYER_ONE_KING;class Aae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Pa.getInitialState()),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Pa.getInitialState(),ds.of(new C(3,1),new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Pa([[q,q,q,c1,q,q,q],[q,q,q,c1,q,q,q],[c1,q,q,Ds,q,q,q],[q,q,Ds,Od,Ds,c1,c1],[q,q,c1,q,q,q,q],[q,q,q,Ds,q,c1,q],[q,q,q,c1,q,q,q]],1),[ds.of(new C(3,5),new C(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Pa([[q,q,q,c1,q,q,q],[q,q,c1,q,q,q,q],[q,q,q,Ds,q,q,q],[c1,Ds,q,q,Ds,c1,c1],[q,Ds,q,q,q,q,q],[q,c1,q,Od,q,c1,q],[q,q,q,c1,q,q,q]],12),[ds.of(new C(2,1),new C(3,1)),ds.of(new C(3,0),new C(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new Pa([[q,q,q,q,q,q,q],[q,q,q,Ds,q,q,q],[q,q,q,c1,q,q,q],[q,c1,q,Od,c1,q,q],[q,q,q,c1,q,q,q],[q,Ds,q,q,q,q,q],[q,q,q,q,q,q,q]],72),[ds.of(new C(1,3),new C(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new Pa([[q,q,c1,q,q,q,q],[q,q,q,c1,q,q,q],[q,q,q,Od,c1,q,q],[q,c1,Ds,q,Ds,q,q],[q,q,q,c1,q,q,q],[q,q,q,q,q,q,q],[q,q,q,q,q,q,q]],72),[ds.of(new C(2,0),new C(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),W.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new Pa([[q,q,q,q,q,q,q],[q,q,q,q,q,q,q],[q,c1,q,c1,q,q,q],[c1,q,q,q,Ds,q,q],[q,q,q,Ds,q,q,q],[q,q,q,q,q,q,q],[q,Od,q,c1,q,q,q]],72),[ds.of(new C(3,6),new C(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function L7t(r,e){1&r&&(A(),F(0,"polygon",8))}function R7t(r,e){1&r&&(A(),F(0,"rect",9))}function z7t(r,e){if(1&r&&(A(),E(0,"g"),T(1,L7t,1,0,"polygon",6),T(2,R7t,1,0,"ng-template",null,7,dn),S()),2&r){const t=ln(3),n=p().index,i=p().index,s=p();v(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function D7t(r,e){if(1&r&&(A(),E(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),S()),2&r){const t=p(2).index,n=p().index,i=p();v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function H7t(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function V7t(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function F7t(r,e){if(1&r&&(A(),T(0,H7t,1,1,"polyline",14),T(1,V7t,4,20,"ng-template",null,15,dn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function $7t(r,e){if(1&r&&(A(),E(0,"g"),F(1,"circle",10),T(2,D7t,6,25,"g",11),T(3,F7t,3,2,"ng-template",null,12,dn),S()),2&r){const t=ln(4),n=p().index,i=p().index,s=p();v(1),ye("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),k("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),v(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function B7t(r,e){if(1&r){const t=pe();A(),E(0,"g",3),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,z7t,4,2,"g",5),T(3,$7t,5,8,"g",5),S()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),k("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),v(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),v(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function G7t(r,e){if(1&r&&(A(),E(0,"g"),T(1,B7t,4,10,"g",2),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function U7t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",17),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p();v(1),ye("id","click_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let W7t=(()=>{var r;class e extends NL{constructor(n){super(n,ds.from),this.rules=vl.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new tu(this.rules,"DummyBot"),new sC(this.rules,"Piece > Influence"),new oC(this.rules,"Piece > Control"),new AL(this.rules,"Escape > Piece > Control")],this.encoder=ds.encoder,this.tutorial=(new Aae).tutorial}ngOnInit(){this.updateBoard()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-brandhub"]],features:[Je],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,G7t,2,1,"g",1),T(2,U7t,2,6,"g",1),S()),2&n&&(k("viewBox",i.getViewBox()),v(1),y("ngForOf",i.board),v(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),ci=(()=>{class r extends F1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}static getInitialState(){const t=He.createTable(r.WIDTH,r.HEIGHT,X.NONE);return new r(t,0)}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();var IL;class Ta extends Mr{static of(e){return K.assert(ci.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),new Ta(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}u(Ta,"encoder",Mr.getEncoder(Ta.of));class Oa extends zs{static of(e,t){return K.assert(ci.isOnBoard(e),"FIRST_COORD_IS_OUT_OF_RANGE"),K.assert(ci.isOnBoard(t),"SECOND_COORD_IS_OUT_OF_RANGE"),K.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new Oa(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),n=e.getFirst(),i=this.getSecond(),s=e.getSecond();return!(!t.equals(n)||!i.equals(s))||!(!t.equals(s)||!i.equals(n))}}u(Oa,"encoder",zs.getEncoder(Oa.of)),function(r){r.isFirstMove=function e(n){return n instanceof Ta},r.isDrop=function t(n){return n instanceof Oa},r.encoder=Ie.disjunction([r.isFirstMove,r.isDrop],[Ta.encoder,Oa.encoder])}(IL||(IL={}));class nu{constructor(e,t,n){u(this,"isInRange",void 0),u(this,"getOwner",void 0),u(this,"N",void 0),this.isInRange=e,this.getOwner=t,this.N=n}getBoardValue(e){let t=0;for(const n of e.getCoordsAndContents()){const s=n.coord;if(this.getOwner(n.content,e).isPlayer()){const o=this.getSquareScore(e,s);if(an.VICTORIES.some(a=>a===o))return new an(o);t+=o}}return new an(t)}getSquareScore(e,t){const n=e.getPieceAt(t),i=this.getOwner(n,e);Ve(i.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const s=new un,o=new un;for(const c of Me.DIRECTIONS){const l=this.getNumberOfFreeSpacesAndAllies(e,t,c,i);s.set(c,l[0]),o.set(c,l[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,s)*i.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let n=0;for(const i of[Me.UP,Me.UP_RIGHT,Me.RIGHT,Me.DOWN_RIGHT]){const s=e.get(i).get(),o=e.get(i.getOpposite()).get();if(this.N<=s+o+1)return Number.MAX_SAFE_INTEGER;const f=t.get(i).get()+t.get(i.getOpposite()).get();this.N<=f+1&&(n+=2+f-this.N)}return n}getNumberOfFreeSpacesAndAllies(e,t,n,i){let s=0,o=0,a=!0,c=new C(t.x+n.x,t.y+n.y),l=1;const f=i.getOpponent();for(;this.isInRange(c)&&l<this.N;){const d=e.getPieceAt(c);if(this.getOwner(d,e)===f)return[s,o];this.getOwner(d,e)===i&&a?o++:a=!1,d!==f&&d!==i&&s++,c=c.getNext(n),l++}return[s,o]}getVictoriousCoord(e){const t=[];for(const n of e.getCoordsAndContents())if(this.getOwner(n.content,e).isPlayer()){const i=n.coord,s=this.getSquareScore(e,i);zi.getScoreStatus(s)===en.VICTORY&&(s===I.ZERO.getVictoryValue()||s===I.ONE.getVictoryValue())&&t.push(i)}return t}}class fo extends jn{static get(){return fo.singleton.isAbsent()&&(fo.singleton=g.of(new fo)),fo.singleton.get()}static getVictoriousCoords(e){return fo.CONNECT_SIX_HELPER.getVictoriousCoord(e)}constructor(){super(ci)}applyLegalMove(e,t,n){return e instanceof Oa?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const n=t.getCurrentPlayer(),i=e.getFirst(),s=e.getSecond(),o=t.getCopiedBoard();return o[i.y][i.x]=n,o[s.y][s.x]=n,new ci(o,t.turn+1)}applyLegalFirstMove(e,t){const n=t.getCurrentPlayer(),i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=n,new ci(i,t.turn+1)}isLegal(e,t){return 0===t.turn?(K.assert(e instanceof Ta,"First move should be instance of ConnectSixFirstMove"),b.SUCCESS):(K.assert(e instanceof Oa,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return fo.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):181===t.turn?ve.DRAW:ve.ONGOING}}u(fo,"singleton",g.empty()),u(fo,"CONNECT_SIX_HELPER",new nu(ci.isOnBoard,K.identity,6));const R=X.NONE,li=X.ZERO,R2=X.ONE;class xae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,ci.getInitialState()),W.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,ci.getInitialState(),Ta.of(new C(9,9)),$localize`Congratulations!`),W.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new ci([[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R2,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,li,R,R2,li,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,li,li,R,R,R2,R,R,R,R,R,R],[R,R,R,R,R,R,R,R2,li,li,li,li,R2,R,R,R,R,R,R],[R,R,R,R,R,R,R2,li,li,li,li,R2,R,R,R,R,R,R,R],[R,R,R,R,R,R,R2,R,R2,li,R2,R2,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,li,R2,li,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R2,R,R2,R,li,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R2,R2,R,R2,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R2,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,li,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R,R]],20),Oa.of(new C(4,11),new C(5,10)),$localize`Congratulations!`)])}}let kL=(()=>{var r;class e extends Hi{constructor(...n){super(...n),u(this,"hoshis",[])}createHoshis(){const n=this.board.length,i=Math.floor(n/2),s=n<12?2:3,o=n-(s+1);18<n&&this.hoshis.push(new C(s,i),new C(i,s),new C(i,o),new C(o,i)),this.hoshis.push(new C(i,i),new C(s,s),new C(s,o),new C(o,s),new C(o,o))}isHoshi(n,i){return this.hoshis.some(s=>s.x===n&&s.y===i)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}()),u(e,"\u0275cmp",Xe({type:r,selectors:[["ng-component"]],features:[Je],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();class q7t extends uo{getListMoves(e){return 0===e.gameState.turn?this.getFirstMove():this.getListDrops(e)}getFirstMove(){const t=ci.HEIGHT,n=Math.floor(ci.WIDTH/2),i=Math.floor(t/2);return[Ta.of(new C(n,i))]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),n=[];for(const i of t){const s=e.gameState.getCopiedBoard();s[i.y][i.x]=e.gameState.getCurrentPlayer();const o=new ci(s,e.gameState.turn),a=this.getAvailableCoords(o);for(const c of a){const l=Oa.of(i,c);n.push(l)}}return new dt(n).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),n=[];for(const i of e.getCoordsAndContents()){const s=i.coord;!0===t[s.y][s.x]&&!1===i.content.isPlayer()&&n.push(s)}return n}getUsefulCoordsMap(e){const t=He.createTable(ci.WIDTH,ci.HEIGHT,!1);for(const n of e.getCoordsAndContents())n.content.isPlayer()&&this.addNeighboringCoord(t,n.coord);return t}addNeighboringCoord(e,t){const i=Math.max(0,t.x-1),s=Math.max(0,t.y-1),o=Math.min(ci.WIDTH-1,t.x+1),a=Math.min(ci.HEIGHT-1,t.y+1);for(let c=s;c<=a;c++)for(let l=i;l<=o;l++)e[c][l]=!0}getBoardValue(e){const t=e.gameState;let n=0;for(const i of t.getCoordsAndContents())if(i.content.isPlayer()){const s=fo.CONNECT_SIX_HELPER.getSquareScore(t,i.coord);if(zi.getScoreStatus(s)===en.VICTORY)return new an(s);n+=s}return new an(n)}}function j7t(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function Z7t(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ye("id","hoshi_",t,"_",n,""),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function Y7t(r,e){if(1&r&&(A(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,Z7t,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();k("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),v(1),k("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),v(1),k("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),v(1),y("ngIf",i.isHoshi(t,n))}}function K7t(r,e){if(1&r){const t=pe();A(),E(0,"g",5),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,j7t,1,6,"circle",6),T(2,Y7t,4,13,"ng-template",null,7,dn),S()}if(2&r){const t=e.$implicit,n=e.index,i=ln(3);ye("id","click_",n,"_",p().index,""),v(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function X7t(r,e){if(1&r&&(A(),E(0,"g"),T(1,K7t,4,4,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Q7t(r,e){if(1&r){const t=pe();A(),E(0,"circle",13),U("click",function(){te(t);const i=p();return ne(i.onClick(i.droppedCoord.get().x,i.droppedCoord.get().y))}),S()}if(2&r){const t=p();y("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),k("cx",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().y)("r",.22*t.SPACE_SIZE)}}let J7t=(()=>{var r;class e extends kL{constructor(n){super(n),u(this,"droppedCoord",g.empty()),u(this,"lastMoved",[]),u(this,"victoryCoords",[]),this.rules=fo.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new q7t(this.rules,"Minimax")],this.encoder=IL.encoder,this.tutorial=(new xae).tutorial}updateBoard(){const n=this.getState();this.board=n.getCopiedBoard(),this.victoryCoords=fo.getVictoriousCoords(n),this.createHoshis()}showLastMove(n){this.lastMoved=n instanceof Ta?[n.coord]:[n.getFirst(),n.getSecond()]}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(0===s.getState().turn){const c=Ta.of(a);return s.chooseMove(c)}if(s.getState().getPieceAt(a).isPlayer())return s.cancelMove(Le.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(a))return s.droppedCoord=g.empty(),b.SUCCESS;{const c=Oa.of(s.droppedCoord.get(),a);return s.chooseMove(c)}}return s.droppedCoord=g.of(a),b.SUCCESS})()}getSpaceClass(n,i){const s=new C(n,i),o=this.getState().getPieceAt(s),a=[];return this.droppedCoord.equalsValue(s)?(a.push(this.getPlayerClass(this.getState().getCurrentPlayer())),a.push("highlighted-stroke")):(a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&a.push("last-move-stroke")),a}cancelMoveAttempt(){this.droppedCoord=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-connect-six"]],features:[Je],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),F(1,"rect",1),T(2,X7t,2,1,"g",2),T(3,Q7t,1,4,"circle",3),S()),2&n&&(k("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),v(1),k("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),v(1),y("ngForOf",i.board),v(1),y("ngIf",i.droppedCoord.isPresent()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Q3=(()=>{class r{}return u(r,"SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP",()=>$localize`Your piece should land on a neighboring square.`),u(r,"CANNOT_DROP_AFTER_TURN_40",()=>$localize`You cannot drop a piece during the moving phase.`),u(r,"CANNOT_MOVE_BEFORE_TURN_40",()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`),u(r,"MUST_JUMP_OVER_PIECES",()=>$localize`A jump must be made over a piece, not over an empty square.`),u(r,"MUST_DROP_IN_CENTRAL_ZONE",()=>$localize`A drop must occur in the central zone of the board.`),u(r,"INVALID_JUMP",()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`),u(r,"SAME_LOCATION_VISITED_IN_JUMP",()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`),r})();var aC,zae,d2;class Lt extends F1{static isOnBoard(e){return e.isInRange(Lt.WIDTH,Lt.HEIGHT)}static getInitialState(){const e=He.createTable(Lt.WIDTH,Lt.HEIGHT,X.NONE);return new Lt(e,0)}isShelter(e){return 0===e.x||e.x===Lt.WIDTH-1?Lt.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===Lt.HEIGHT-1)&&Lt.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=Lt.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=Lt.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}aC=Lt,u(Lt,"WIDTH",17),u(Lt,"HEIGHT",17),u(Lt,"CENTRAL_ZONE_TOP_LEFT",new C(4,6)),u(Lt,"CENTRAL_ZONE_BOTTOM_RIGHT",new C(12,10)),u(Lt,"SHELTERS_INDICES",[0,1,3,5,7,8,9,11,13,15,16]),u(Lt,"ALL_SHELTERS",new dt(aC.SHELTERS_INDICES.flatMap(r=>[new C(r,0),new C(r,aC.HEIGHT-1),new C(0,r),new C(aC.WIDTH-1,r)])).toList());class J3 extends Mr{static of(e){return K.assert(Lt.isOnBoard(e),"Move out of board"),new J3(e)}constructor(e){super(e.x,e.y)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!d2.isDrop(e)&&this.coord.equals(e.coord)}}u(J3,"encoder",Mr.getEncoder(J3.of));class e4 extends Vo{static from(e,t){const n=Lt.isOnBoard(e),i=Lt.isOnBoard(t);return K.assert(n&&i,"Move out of board"),e.isAlignedWith(t)&&1===e.getDistance(t)?se.success(new e4(e,t)):se.failure(Q3.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}constructor(e,t){super(e,t)}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!d2.isSimple(e)&&super.equals(e)}}u(e4,"encoder",zs.getFallibleEncoder(e4.from));class Fo extends Li{static from(e){if(e.length<2)return se.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const n of e)if(!1===Lt.isOnBoard(n))return se.failure("Move out of board");for(let n=1;n<e.length;n++)if(e[n-1].getDirectionToward(e[n]).isFailure()||2!==e[n-1].getDistance(e[n]))return se.failure(Q3.INVALID_JUMP());return new $1(e).size()===e.length?se.success(new Fo(e)):se.failure(Q3.SAME_LOCATION_VISITED_IN_JUMP())}constructor(e){super(),u(this,"coords",void 0),this.coords=e}addJump(e){const t=He.copyImmutableArray(this.coords);return t.push(e),Fo.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,n)=>t+" -> "+n)})`}equals(e){return!(d2.isSimple(e)||d2.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}zae=Fo,u(Fo,"encoder",Ie.tuple([Ie.list(C.encoder)],r=>[He.copyImmutableArray(r.coords)],r=>zae.from(r[0]).get())),function(r){r.isDrop=function e(i){return i instanceof J3},r.isSimple=function t(i){return i instanceof e4},r.isJump=function n(i){return i instanceof Fo},r.encoder=Ie.disjunction([r.isDrop,r.isSimple,r.isJump],[J3.encoder,e4.encoder,Fo.encoder])}(d2||(d2={}));const _=X.NONE,vt=X.ZERO,pt=X.ONE;class Dae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Lt.getInitialState()),W.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Lt.getInitialState(),J3.of(new C(7,7)),$localize`Congratulations!`),W.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Lt([[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,vt,vt,pt,pt,vt,vt,pt,vt,pt,_,_,_,_],[_,_,_,_,vt,pt,vt,pt,vt,vt,vt,vt,pt,_,_,_,_],[_,_,_,_,vt,pt,_,_,_,_,_,pt,vt,_,_,_,_],[_,_,_,_,pt,vt,vt,pt,pt,pt,vt,vt,vt,_,_,_,_],[_,_,_,_,pt,vt,pt,pt,pt,pt,pt,pt,vt,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_]],40),e4.from(new C(4,6),new C(3,5)).get(),(t,n,i)=>d2.isSimple(t)?b.SUCCESS:b.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),W.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Lt([[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,vt,vt,pt,pt,vt,vt,pt,vt,pt,_,_,_,_],[_,_,_,_,vt,pt,vt,pt,vt,vt,vt,vt,pt,_,_,_,_],[_,_,_,_,vt,pt,_,_,_,_,_,pt,vt,_,_,_,_],[_,_,_,_,pt,vt,vt,pt,pt,pt,vt,vt,vt,_,_,_,_],[_,_,_,_,pt,vt,pt,pt,pt,pt,pt,pt,vt,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_]],40),Fo.from([new C(6,7),new C(6,5)]).get(),(t,n,i)=>d2.isJump(t)?b.SUCCESS:b.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),W.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Lt([[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,pt,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,pt,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,pt,_,_,_,_,_,_,_,_,_],[_,_,_,_,vt,vt,_,pt,vt,vt,pt,vt,pt,_,_,_,_],[_,_,_,_,vt,_,vt,pt,vt,vt,vt,vt,pt,_,_,_,_],[_,_,_,_,vt,pt,_,_,_,_,_,pt,vt,_,_,_,_],[_,_,_,_,pt,vt,vt,pt,pt,pt,vt,vt,vt,_,_,_,_],[_,_,_,_,pt,vt,pt,pt,pt,pt,pt,pt,vt,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_],[_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_]],40),[Fo.from([new C(8,6),new C(6,4),new C(6,2),new C(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)])}}class ho extends jn{static get(){return ho.singleton.isAbsent()&&(ho.singleton=g.of(new ho)),ho.singleton.get()}constructor(){super(Lt)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();if(d2.isDrop(e))i[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(d2.isSimple(e))i[e.getStart().y][e.getStart().x]=X.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const s=e.getStartingCoord(),o=e.getEndingCoord();i[s.y][s.x]=X.NONE,i[o.y][o.x]=t.getCurrentPlayer()}return new Lt(i,t.turn+1)}isLegal(e,t){return d2.isDrop(e)?this.dropLegality(e,t):d2.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?b.failure(Q3.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?b.failure(Q3.MUST_DROP_IN_CENTRAL_ZONE()):b.SUCCESS}simpleMoveLegality(e,t){return t.turn<40?b.failure(Q3.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.getEnd()).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}jumpLegality(e,t){if(t.turn<40)return b.failure(Q3.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());for(const n of e.getJumpedOverCoords())if(t.getPieceAt(n)===X.NONE)return b.failure(Q3.MUST_JUMP_OVER_PIECES());for(const n of e.getLandingCoords())if(t.getPieceAt(n).isPlayer())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());return b.SUCCESS}jumpTargetsFrom(e){const t=[new C(e.x+2,e.y),new C(e.x-2,e.y),new C(e.x,e.y+2),new C(e.x,e.y-2),new C(e.x+2,e.y+2),new C(e.x+2,e.y-2),new C(e.x-2,e.y+2),new C(e.x-2,e.y-2)],n=[];for(const i of t)Fo.from([e,i]).isSuccess()&&n.push(i);return n}nextJumps(e,t){const n=e.getEndingCoord(),i=[];for(const s of this.jumpTargetsFrom(n)){const o=e.addJump(s);o.isSuccess()&&this.jumpLegality(o.get(),t).isSuccess()&&i.push(o.get())}return i}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of Lt.ALL_SHELTERS){const s=t.getPieceAt(i);if(s.isPlayer()&&(n[s.value]+=1,20===n[s.value]))return ve.getVictory(s)}return ve.ONGOING}}u(ho,"singleton",g.empty());let bd=(()=>{class r{}return u(r,"NO_MORE_PIECES_OF_THIS_TYPE",()=>$localize`You do not have any pieces of this type anymore.`),u(r,"SPACE_IS_FULL",()=>$localize`You cannot play here: this space is already full.`),u(r,"TARGET_STACK_TOO_HIGH",()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`),u(r,"MUST_SHIFT_TO_NEIGHBOR",()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`),u(r,"MUST_SELECT_PIECE_FIRST",()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`),r})();var ba,Hae,Vae;class Pn{static of(e,t){return e===I.ZERO?t?Pn.ZERO_SECOND:Pn.ZERO_FIRST:e===I.ONE?t?Pn.ONE_SECOND:Pn.ONE_FIRST:Pn.EMPTY}constructor(e,t){u(this,"owner",void 0),u(this,"otherPieceType",void 0),this.owner=e,this.otherPieceType=t}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}ba=Pn,u(Pn,"encoder",Ie.tuple([X.encoder,Ie.identity()],r=>[r.owner,r.otherPieceType],r=>ba.of(r[0],r[1]))),u(Pn,"EMPTY",new ba(X.NONE,!1)),u(Pn,"ZERO_FIRST",new ba(I.ZERO,!1)),u(Pn,"ZERO_SECOND",new ba(I.ZERO,!0)),u(Pn,"ONE_FIRST",new ba(I.ONE,!1)),u(Pn,"ONE_SECOND",new ba(I.ONE,!0)),u(Pn,"PLAYER_PIECES",[ba.ZERO_FIRST,ba.ZERO_SECOND,ba.ONE_FIRST,ba.ONE_SECOND]);class Fae extends Li{isDrop(){return this instanceof t4}isShift(){return this instanceof z2}}class t4 extends Fae{constructor(e,t){if(super(),u(this,"target",void 0),u(this,"piece",void 0),this.target=e,this.piece=t,t===Pn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof t4&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}Hae=t4,u(t4,"encoder",Ie.tuple([Ie.identity(),Pn.encoder],r=>[r.target,r.piece],r=>new Hae(r[0],r[1])));class z2 extends Fae{static ofRepresentation(e,t){return new z2(new C(e.x,3-e.y),t)}constructor(e,t){super(),u(this,"start",void 0),u(this,"moveDirection",void 0),this.start=e,this.moveDirection=t}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof z2&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}Vae=z2,u(z2,"encoder",Ie.tuple([C.encoder,Ie.identity()],r=>[r.start,"clockwise"===r.moveDirection],r=>new Vae(r[0],r[1]?"clockwise":"counterclockwise")));const eft=Ie.disjunction([r=>r.isDrop(),r=>r.isShift()],[t4.encoder,z2.encoder]);let Y1=(()=>{class r extends F1{static getInitialState(){const t=Pn.EMPTY;return new r([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static ofRepresentation(t,n){const i=t.reverse(),s=[4,4,4,4];for(let o=0;o<r.HEIGHT;o++)for(let a=0;a<r.WIDTH;a++)i[o][a]!==Pn.EMPTY&&s[r.pieceIndex(i[o][a])]--;return Ve(s.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new r(i,s,n)}static pieceIndex(t){switch(t){case Pn.ZERO_FIRST:return 0;case Pn.ZERO_SECOND:return 1;case Pn.ONE_FIRST:return 2;default:return K.expectToBe(t,Pn.ONE_SECOND),3}}constructor(t,n,i){super(t,i),u(this,"remainingPieces",void 0),this.remainingPieces=n}getRemainingPiecesOf(t){return this.remainingPieces[r.pieceIndex(t)]}getStackHeight(t){let n=0;for(let i=0;i<r.HEIGHT&&this.getPieceAtXY(t,i)!==Pn.EMPTY;i++)n++;return n}}return u(r,"WIDTH",8),u(r,"HEIGHT",4),r})();class Lc extends jn{static get(){return Lc.singleton.isAbsent()&&(Lc.singleton=g.of(new Lc)),Lc.singleton.get()}constructor(){super(Y1)}applyLegalMove(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const n=He.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;const i=He.copyImmutableArray(t.remainingPieces);return i[Y1.pieceIndex(e.piece)]-=1,new Y1(n,i,t.turn+1)}applyLegalShift(e,t){const n=He.copyBiArray(t.board),i=e.getTarget();let s=t.getStackHeight(i),o=e.start.y;for(;o<Y1.HEIGHT&&t.getPieceAtXY(e.start.x,o)!==Pn.EMPTY;)n[s][i]=t.getPieceAtXY(e.start.x,o),n[o][e.start.x]=Pn.EMPTY,s++,o++;return new Y1(n,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?b.failure(bd.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===Y1.HEIGHT?b.failure(bd.SPACE_IS_FULL()):b.SUCCESS}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>Y1.HEIGHT?b.failure(bd.TARGET_STACK_TOO_HIGH()):b.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const n=e.gameState.getPieceAt(t.get());return Ve(n.owner.isPlayer(),"highest alignment is owned by a player"),ve.getVictory(n.owner)}return ve.ONGOING}findHighestAlignment(e){for(let t=0;t<Y1.WIDTH/2;t++)for(let n=Y1.HEIGHT-1;n>0;n--){const i=e.getPieceAtXY(t,n),s=e.getPieceAtXY(t+Y1.WIDTH/2,n);if(i!==Pn.EMPTY&&i===s)return g.of(new C(t,n))}return g.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new z2(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new z2(t,"counterclockwise"),e).isSuccess()}}u(Lc,"singleton",g.empty());const Be=Pn.EMPTY,ru=Pn.ZERO_FIRST,$ae=Pn.ZERO_SECOND,cC=Pn.ONE_FIRST,xL=Pn.ONE_SECOND;class Bae{constructor(){u(this,"tutorial",[W.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,Y1.getInitialState()),W.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,Y1.ofRepresentation([[Be,Be,Be,Be,Be,Be,Be,Be],[Be,Be,Be,Be,Be,Be,Be,Be],[Be,Be,Be,Be,cC,Be,Be,Be],[ru,Be,Be,Be,ru,Be,Be,Be]],3),[new t4(0,Pn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),W.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,Y1.ofRepresentation([[Be,Be,Be,Be,Be,Be,Be,Be],[Be,Be,Be,Be,xL,Be,Be,Be],[Be,Be,Be,Be,ru,Be,Be,Be],[cC,Be,Be,Be,$ae,Be,Be,Be]],4),[z2.ofRepresentation(new C(4,3),"counterclockwise"),z2.ofRepresentation(new C(4,3),"clockwise"),z2.ofRepresentation(new C(4,2),"counterclockwise"),z2.ofRepresentation(new C(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),W.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,Y1.ofRepresentation([[Be,Be,Be,Be,ru,Be,Be,Be],[Be,Be,Be,Be,xL,Be,Be,ru],[Be,Be,Be,Be,ru,Be,Be,xL],[Be,cC,Be,Be,$ae,Be,Be,cC]],8),[z2.ofRepresentation(new C(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)])}}let Gae=(()=>{var r;class e extends gl{constructor(...n){super(...n),u(this,"SPACE_SIZE",100),u(this,"board",void 0)}getTriangleCornerCoords(n,i){return(n+i)%2==0?this.getUpwardCoordinate():this.getDownwardCoordinate()}getTrianglePoints(n,i){return this.getTriangleCornerCoords(n,i).map(a=>a.x+","+a.y).reduce((a,c)=>a+","+c)}getTriangleTranslateCoord(n,i){return new C(.5*n*this.SPACE_SIZE,i*this.SPACE_SIZE)}getTriangleTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i);return"translate("+s.x+", "+s.y+")"}getDownwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,o);return[c,new C(0,a),new C(s,o),c]}getUpwardCoordinate(){const s=this.SPACE_SIZE/2,o=-this.SPACE_SIZE/2,a=this.SPACE_SIZE/2,c=new C(-this.SPACE_SIZE/2,a);return[c,new C(0,o),new C(s,a),c]}getPyramidPoints(n,i){return(n+i)%2==1?this.getDownwardPyramidPoints():this.getUpwardPyramidPoints()}getDownwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+-n,s=n+", "+-n,o="0, "+n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}getUpwardPyramidPoints(){const n=this.SPACE_SIZE/2,i=-n+", "+n,s=n+", "+n,o="0, "+-n,a="0, 0";return i+","+o+","+a+","+i+","+a+","+s+","+i+","+s+","+o+","+a+","+s}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}()),u(e,"\u0275cmp",Xe({type:r,selectors:[["ng-component"]],features:[Je],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),wd=(()=>{class r{}return u(r,"INVALID_DISTANCE",()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`),u(r,"NOT_ENOUGH_TILES_TO_EXCHANGE",()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`),u(r,"FIRST_CLICK_SHOULD_NOT_BE_NULL",()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`),u(r,"CANNOT_CAPTURE_FROM_EMPTY",()=>$localize`You cannot capture from an empty space.`),r})();class $o{static getNeighbors(e){let t;const n=new C(e.x-1,e.y),i=new C(e.x+1,e.y);return t=(e.x+e.y)%2==1?[n,i,new C(e.x,e.y-1)]:[n,i,new C(e.x,e.y+1)],t}static getFakeNeighbors(e){return new C(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const n=$o.getNeighbors(e),i=$o.getNeighbors(t);let s=0;for(;s<n.length;){const o=n[s];let a=0;for(;a<i.length;){if(o.equals(i[a]))return g.of(o);a++}s++}return g.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class C0 extends F1{static getEmptyNeighbors(e,t,n){const i=[];for(const s of $o.getNeighbors(t))s.isInRange(e[0].length,e.length)&&e[s.y][s.x]===n&&i.push(s);return i}getEmptyNeighbors(e,t){return C0.getEmptyNeighbors(this.board,e,t)}}var lC,wa;let Vr=(lC=class extends C0{static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new C(t,n)}static isOnBoard(e){return e.isInRange(15,10)}static getPresentNeighborEntrances(e){return[new C(e.x+1,e.y-1),new C(e.x+3,e.y+0),new C(e.x+3,e.y+1),new C(e.x+1,e.y+2),new C(e.x-1,e.y+1),new C(e.x-1,e.y+0)].filter(wa.isOnBoard)}static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new wa([[t,t,t,t,t,t,n,e,n,t,t,t,t,t,t],[t,t,t,e,e,n,e,e,e,n,e,e,t,t,t],[e,i,e,i,e,e,n,e,n,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,n,e,n,e,e,e,e,e,e,e,n,e,n,e],[n,e,e,e,n,e,e,e,e,e,n,e,e,e,n],[e,n,e,n,e,e,i,e,i,e,e,n,e,n,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}constructor(e,t,n,i){super(e,t),u(this,"tiles",void 0),u(this,"captures",void 0),this.tiles=n,this.captures=i}applyLegalMovement(e){const t=e.getStart(),n=e.getEnd(),i=this.getCopiedBoard();return i[n.y][n.x]=Ce.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=Ce.EMPTY,new wa(i,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let n=this;for(const i of t)n=n.capture(i);return n}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return $o.getNeighbors(e).filter(i=>!i.isNotInRange(15,10)&&!!this.getPieceAt(i).is(t)&&this.isSurrounded(i))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,Ce.EMPTY).length}capture(e){const t=this.getCopiedBoard(),n=[this.captures[0],this.captures[1]];return t[e.y][e.x]=Ce.EMPTY,n[this.getCurrentPlayer().value]+=1,new wa(t,this.turn,this.tiles,n)}removeTilesIfNeeded(e,t){let n=this;const i=wa.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){n=this.deconnectTile(i,t);const s=wa.getPresentNeighborEntrances(i);for(const o of s){const a=n.getPieceAt(o);a===Ce.EMPTY?n=n.removeTilesIfNeeded(o,t):a.is(this.getCurrentOpponent())&&n.isSurrounded(o)&&(n=n.capture(o))}}return n}isTileEmpty(e){K.assert(this.getPieceAt(e)!==Ce.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let n=0;n<3;n++){const i=e.getNext(new St(n,t),1);if(this.getPieceAt(i)!==Ce.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let n=0;for(let i=1;i<t.length;i++)!1===this.areNeighbor(t[i-1],t[i])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let n=g.empty();for(let i=0;i<6;i++){const o=e.getNext(wa.NEIGHBORS_TILES_DIRECTIONS[i],1);wa.isOnBoard(o)&&this.getPieceAt(o)!==Ce.UNREACHABLE&&(n.isAbsent()&&(n=g.of(i)),t.push(i-n.get()))}return t}deconnectTile(e,t){const n=this.getCopiedBoard(),i=e.x,s=e.y;for(let a=0;a<2;a++)for(let c=0;c<3;c++)n[s+a][i+c]=Ce.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return t&&(o[this.getCurrentPlayer().value]+=1),new wa(n,this.turn,o,this.captures)}getLegalLandings(e){const t=[];for(const n of hs.STEPS){const i=e.getNext(n.direction,1);this.isOnBoard(i)&&this.getPieceAt(i)===Ce.EMPTY&&t.push(i)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let n=0;n<15;n++){const i=this.board[t][n];if(i.isPlayer()){const s=this.getEmptyNeighbors(new C(n,t),Ce.EMPTY).length;e[i.value][s]=e[i.value][s]+1}}return e}},wa=lC,u(lC,"NEIGHBORS_TILES_DIRECTIONS",[new St(0,-2),new St(3,-1),new St(3,1),new St(0,2),new St(-3,1),new St(-3,-1)]),lC);var po,Cl,uC,y0;Vr=wa=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],Vr);class hs{static ofCoords(e,t){const n=e.getVectorToward(t),i=hs.STEPS.findIndex(s=>s.direction.equals(n));return K.assert(-1!==i,wd.INVALID_DISTANCE()),hs.STEPS[i]}constructor(e,t){u(this,"direction",void 0),u(this,"str",void 0),this.direction=e,this.str=t}}u(hs,"LEFT",new(po=hs)(new St(-2,0),"LEFT")),u(hs,"UP_LEFT",new po(Me.UP_LEFT,"UP_LEFT")),u(hs,"UP_RIGHT",new po(Me.UP_RIGHT,"UP_RIGHT")),u(hs,"RIGHT",new po(new St(2,0),"RIGHT")),u(hs,"DOWN_LEFT",new po(Me.DOWN_LEFT,"DOWN_LEFT")),u(hs,"DOWN_RIGHT",new po(Me.DOWN_RIGHT,"DOWN_RIGHT")),u(hs,"STEPS",[po.LEFT,po.UP_LEFT,po.UP_RIGHT,po.RIGHT,po.DOWN_LEFT,po.DOWN_RIGHT]);class D2 extends Vo{static of(e,t){const n=hs.ofCoords(e,t);return D2.ofMovement(e,n)}static ofMovement(e,t){K.assert(Vr.isOnBoard(e),"Starting coord cannot be out of range (width: 15, height: 10).");const n=new C(e.x+t.direction.x,e.y+t.direction.y);return K.assert(Vr.isOnBoard(n),"Landing coord cannot be out of range (width: 15, height: 10)."),new D2(e,n)}constructor(e,t){super(e,t)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!Cl.isTileExchange(e)&&super.equals(e)}}u(D2,"encoder",Vo.getEncoder(D2.of));class n4 extends Mr{static of(e){return K.assert(Vr.isOnBoard(e),"Captured coord cannot be out of range (width: 15, height: 10)."),new n4(e)}constructor(e){super(e.x,e.y)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!Cl.isTileExchange(e)&&e.coord.equals(this.coord)}}u(n4,"encoder",Mr.getEncoder(n4.of)),function(r){r.isNormalMove=function e(n){return n instanceof D2},r.isTileExchange=function t(n){return n instanceof n4},r.encoder=Ie.disjunction([r.isNormalMove,r.isTileExchange],[D2.encoder,n4.encoder])}(Cl||(Cl={}));let fC=(uC=class extends jn{static get(){return y0.singleton.isAbsent()&&(y0.singleton=g.of(new y0)),y0.singleton.get()}constructor(){super(Vr)}applyLegalMove(e,t,n){return Cl.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const n=t.getCopiedBoard(),i=e.coord;n[i.y][i.x]=Ce.EMPTY;const s=[t.captures[0],t.captures[1]];s[t.getCurrentPlayer().value]+=1;const o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;const c=new Vr(n,t.turn,o,s).removeTilesIfNeeded(i,!1);return new Vr(c.getCopiedBoard(),c.turn+1,c.tiles,c.captures)}applyLegalMovement(e,t){const s=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new Vr(s.board,t.turn+1,s.tiles,s.captures)}isLegal(e,t){return Cl.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return b.failure(wd.NOT_ENOUGH_TILES_TO_EXCHANGE());const n=t.getPieceAt(e.coord);return n===Ce.UNREACHABLE||n===Ce.EMPTY?b.failure(wd.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?b.failure(Le.CANNOT_SELF_CAPTURE()):b.SUCCESS}isLegalMovement(e,t){K.assert(t.getPieceAt(e.getStart())!==Ce.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),K.assert(t.getPieceAt(e.getEnd())!==Ce.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const n=t.getPieceAt(e.getStart());return n===Ce.EMPTY?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n.is(t.getCurrentOpponent())?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?ve.ZERO_WON:t.captures[1]>=18?ve.ONE_WON:ve.ONGOING}getGameStatus(e){return y0.getGameStatus(e)}},y0=uC,u(uC,"singleton",g.empty()),uC);fC=y0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],fC);class qae extends Hr{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}getListExchanges(e){const t=[],n=e.gameState,i=n.getCurrentPlayer().value,s=Ce.ofPlayer(n.getCurrentOpponent());if(n.tiles[i]<2)return t;for(const o of n.getCoordsAndContents())if(o.content===s){const a=n4.of(o.coord);t.push(a)}return t}getListMovement(e){const t=[],n=e.gameState,i=n.getCurrentPlayer();for(const s of n.getCoordsAndContents()){const o=s.coord;if(s.content.is(i)){const a=n.getLegalLandings(o);for(const c of a){const l=D2.of(o,c);t.push(l)}}}return t}getMetrics(e){const t=e.gameState,n=t.getPiecesByFreedom(),i=this.getPiecesScore(n);return[2*t.captures[0]+i[0],2*t.captures[1]+i[1]]}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}putCaptureFirst(e,t){return He.sortByDescending(t,n=>this.moveCapturesList(e,n).length),t}moveCapturesList(e,t){return Cl.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}let rft=(()=>{class r extends qae{getMetrics(t){const n=t.gameState,i=this.getPiecesMap(n),s=this.getThreatMap(n,i),o=this.filterThreatMap(s,n),a=[0,0];for(const c of I.PLAYERS){for(const l of i.get(c).get())o.get(l).isPresent()?a[c.value]+=r.SCORE_BY_THREATENED_PIECE:a[c.value]+=r.SCORE_BY_SAFE_PIECE;a[c.value]+=n.tiles[c.value]}return a}getPiecesMap(t){const n=new un,i=[],s=[];for(const o of t.getCoordsAndContents()){const a=o.coord,c=t.getPieceAt(a);c===Ce.ZERO?i.push(a):c===Ce.ONE&&s.push(a)}return n.set(I.ZERO,new $1(i)),n.set(I.ONE,new $1(s)),n}getThreatMap(t,n){const i=new un;for(const s of I.PLAYERS)for(const o of n.get(s).get()){const a=this.getThreat(o,t);a.isPresent()&&i.set(o,a.get())}return i}getThreat(t,n){const s=I.of(n.getPieceAt(t).value).getOpponent();let o=g.empty(),a=g.empty(),c=[];const l=$o.getNeighbors(t).filter(Vr.isOnBoard);for(const f of l){const d=n.getPieceAt(f);if(d.is(s))c.push(f),this.tileCouldBeRemovedThisTurn(f,n,s)&&(a=g.of(f));else if(d===Ce.EMPTY){if(o.isPresent())return g.empty();o=g.of(f)}}if(o.isPresent()){const f=[];for(const d of hs.STEPS){const m=o.get().getNext(d.direction,1);Vr.isOnBoard(m)&&n.getPieceAt(m).is(s)&&!1===c.some(M=>M.equals(m))&&f.push(m)}if(f.length>0)return g.of(new iC(new $1(c),new $1(f)))}if(a.isPresent()){c=c.filter(d=>d.equals(a.get()));const f=new $1(c);return g.of(new iC(f,new $1([a.get()])))}return g.empty()}tileCouldBeRemovedThisTurn(t,n,i){const s=i.getOpponent();if(!1===n.isDeconnectable(t))return!1;let a=g.empty();const c=Vr.getTilesUpperLeftCoord(t);for(let l=0;l<2;l++)for(let f=0;f<3;f++){const d=c.getNext(new St(f,l),1);if(n.getPieceAt(d).is(i)){if(!this.pieceCouldLeaveTheTile(d,n))return!1;a=g.of(d)}else if(n.getPieceAt(d).is(s))return!1}return a.isPresent()}pieceCouldLeaveTheTile(t,n){const i=Vr.getTilesUpperLeftCoord(t);for(const s of hs.STEPS){const o=t.getNext(s.direction,1),a=Vr.getTilesUpperLeftCoord(o);if(!1===i.equals(a)&&Vr.isOnBoard(o)&&n.getPieceAt(o)===Ce.EMPTY)return!0}return!1}filterThreatMap(t,n){const i=new un,s=t.listKeys(),o=s.filter(c=>n.getPieceAt(c).is(n.getCurrentPlayer())),a=new $1(s.filter(c=>n.getPieceAt(c).is(n.getCurrentOpponent())));for(const c of o){const l=t.get(c).get();let f=g.empty();for(const d of l.directThreats)if(!1===a.contains(d)){const m=[];for(const M of l.mover)!1===a.contains(M)&&m.push(M);m.length>0&&(f=g.of(new iC(l.directThreats,new $1(m))))}f.isPresent()&&i.set(c,f.get())}for(const c of a){const l=t.get(c).get();i.set(c,l)}return i}}return u(r,"SCORE_BY_THREATENED_PIECE",1e3),u(r,"SCORE_BY_SAFE_PIECE",1e6),r})();const ee=Ce.EMPTY,x=Ce.UNREACHABLE,t1=Ce.ZERO,_n=Ce.ONE;class jae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,Vr.getInitialState()),W.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,Vr.getInitialState(),D2.of(new C(3,5),new C(5,5)),$localize`Congratulations! Let's see captures now.`),W.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new Vr([[x,x,x,x,x,x,t1,ee,t1,x,x,x,x,x,x],[x,x,x,t1,ee,ee,ee,ee,ee,t1,ee,ee,x,x,x],[ee,_n,ee,_n,t1,_n,ee,ee,t1,ee,ee,_n,ee,_n,ee],[_n,ee,ee,ee,ee,ee,ee,ee,ee,ee,_n,ee,ee,ee,_n],[ee,_n,ee,_n,ee,ee,ee,ee,ee,ee,ee,_n,ee,_n,ee],[ee,t1,ee,t1,ee,ee,ee,ee,ee,ee,ee,t1,ee,t1,ee],[t1,ee,ee,ee,t1,ee,ee,ee,ee,ee,t1,ee,ee,ee,t1],[ee,t1,ee,t1,ee,ee,_n,ee,_n,ee,ee,t1,ee,t1,ee],[x,x,x,ee,ee,_n,ee,ee,ee,_n,ee,ee,x,x,x],[x,x,x,x,x,x,_n,ee,_n,x,x,x,x,x,x]],3,[0,0],[0,0]),[D2.of(new C(5,2),new C(4,1)),D2.of(new C(3,4),new C(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),W.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new Vr([[x,x,x,x,x,x,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,_n,ee,ee,x,x,x,x,x,x],[ee,ee,ee,x,x,x,ee,ee,ee,x,x,x,x,x,x],[ee,ee,_n,ee,ee,ee,ee,t1,ee,x,x,x,x,x,x],[ee,ee,ee,_n,ee,ee,ee,ee,ee,x,x,x,x,x,x],[ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,t1,x,x,x],[ee,ee,t1,ee,ee,_n,ee,ee,ee,ee,t1,ee,ee,ee,t1],[ee,ee,ee,ee,ee,ee,_n,ee,_n,ee,ee,t1,ee,t1,ee],[x,x,x,ee,ee,_n,ee,ee,ee,_n,ee,ee,x,x,x],[x,x,x,x,x,x,_n,ee,_n,x,x,x,x,x,x]],2,[0,0],[0,0]),[D2.of(new C(2,6),new C(4,6)),D2.of(new C(2,6),new C(3,5)),D2.of(new C(2,6),new C(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),W.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new Vr([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,t1,x,x,x,x,x,x,x,x,x],[x,x,x,ee,ee,ee,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,ee,_n,ee,_n,x,x,x,x,x,x],[x,x,x,ee,ee,_n,ee,ee,ee,x,x,x,x,x,x],[x,x,x,x,x,x,_n,ee,_n,x,x,x,x,x,x]],1,[0,2],[0,0]),[n4.of(new C(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),W.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new Vr([[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,ee,ee,t1,x,x,x,x,x,x],[x,x,x,ee,ee,t1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,t1,_n,ee,_n,ee,x,x,x,x,x,x],[x,x,x,ee,_n,t1,ee,ee,ee,x,x,x,x,x,x],[x,x,x,ee,ee,_n,x,x,x,x,x,x,x,x,x],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]],1,[0,0],[0,0]),[D2.of(new C(7,6),new C(6,5)),D2.of(new C(7,6),new C(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)])}}function ift(r,e){if(1&r&&(A(),F(0,"polygon",7)),2&r){const t=p().index,n=p().index,i=p();ye("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),k("points",i.getTrianglePoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function sft(r,e){if(1&r){const t=pe();A(),E(0,"g",5),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,ift,1,5,"polygon",6),S()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),v(1),y("ngIf",i.mustDraw(t,n))}}function oft(r,e){if(1&r&&(A(),E(0,"g"),T(1,sft,2,3,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function aft(r,e){if(1&r&&(A(),F(0,"polygon",9)),2&r){const t=p().index,n=p().index,i=p();ye("id","pyramid_",t,"_",n,""),y("ngClass",i.getPyramidClass(t,n)),k("points",i.getPyramidPoints(t,n))("transform",i.getTriangleInHexTranslate(t,n))}}function cft(r,e){if(1&r){const t=pe();A(),E(0,"g",5),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,aft,1,5,"polygon",8),S()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),v(1),y("ngIf",i.isPyramid(t,n))}}function lft(r,e){if(1&r&&(A(),E(0,"g"),T(1,cft,2,3,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function uft(r,e){if(1&r){const t=pe();A(),E(0,"rect",12),U("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s.x,s.y))}),S()}if(2&r){const t=e.$implicit,n=p(2);k("x",-n.INDICATOR_SIZE/2)("y",n.getIndicatorY(t))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)("transform",n.getTriangleInHexTranslate(t.x,t.y))}}function fft(r,e){if(1&r&&(A(),E(0,"g"),F(1,"polygon",10),T(2,uft,1,5,"rect",11),S()),2&r){const t=p();v(1),ye("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),k("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleInHexTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y)),v(1),y("ngForOf",t.possibleLandings)}}function dft(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),k("points",t.getTrianglePoints(t.lastStart.get().x,t.lastStart.get().y))("transform",t.getTriangleInHexTranslate(t.lastStart.get().x,t.lastStart.get().y))}}function hft(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),k("points",t.getTrianglePoints(t.lastEnd.get().x,t.lastEnd.get().y))("transform",t.getTriangleInHexTranslate(t.lastEnd.get().x,t.lastEnd.get().y))}}function pft(r,e){if(1&r&&(A(),T(0,dft,1,4,"polygon",13),T(1,hft,1,4,"polygon",13)),2&r){const t=p();y("ngIf",t.lastStart.isPresent()),v(1),y("ngIf",t.lastEnd.isPresent())}}const gft=function(r){return["base",r]};function mft(r,e){if(1&r&&(A(),E(0,"g",16),F(1,"polygon",17),E(2,"text",18),lt(3),S()()),2&r){const t=p().$implicit,n=p();y("id","tilesCount"+t.value),k("transform",n.getTilesCountTranslate(t)),v(1),y("ngClass",da(7,gft,"player"+t+"-fill")),k("points",n.getTilesCountCoordinate())("stroke",n.lastTurnWasTilesExchange(t)?"yellow":"black"),v(1),k("font-size",n.SPACE_SIZE/2),v(1),Nn(n.tiles[t.value])}}function _ft(r,e){if(1&r&&(A(),E(0,"g"),T(1,mft,4,9,"g",15),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngIf",n.mustShowTilesOf(t))}}let vft=(()=>{var r;class e extends Gae{constructor(n){super(n),u(this,"state",void 0),u(this,"tiles",[0,0]),u(this,"NONE",Ce.UNREACHABLE),u(this,"INDICATOR_SIZE",15),u(this,"chosenCoord",g.empty()),u(this,"lastStart",g.empty()),u(this,"lastEnd",g.empty()),u(this,"possibleLandings",[]),u(this,"left",-2*this.STROKE_WIDTH),u(this,"up",-this.SPACE_SIZE/2-2*this.STROKE_WIDTH),u(this,"width",8*this.SPACE_SIZE),u(this,"height",10*(this.SPACE_SIZE+this.STROKE_WIDTH)),this.scores=g.of([0,0]),this.rules=fC.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new qae(this.rules,"Normal"),new rft(this.rules,"Piece > Threat > Tiles")],this.encoder=Cl.encoder,this.tutorial=(new jae).tutorial,this.updateBoard()}updateBoard(){this.chosenCoord=g.empty(),this.state=this.getState(),this.scores=g.of(this.state.captures),this.tiles=this.state.tiles,this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.possibleLandings=[]}showLastMove(n){n instanceof D2?(this.lastStart=g.of(n.getStart()),this.lastEnd=g.of(n.getEnd())):(this.lastStart=g.empty(),this.lastEnd=g.empty())}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(a)?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(a).is(c)?s.firstClick(a):s.secondClick(a)})()}firstClick(n){var i=this;return P(function*(){const s=i.state.getPieceAt(n);if(s.is(i.state.getCurrentOpponent())){const o=n4.of(n);return i.chooseMove(o)}return s.is(i.state.getCurrentPlayer())?(i.chosenCoord=g.of(n),i.showHighlight(),b.SUCCESS):i.cancelMove(wd.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(n){var i=this;return P(function*(){if(i.possibleLandings.some(s=>s.equals(n))){const s=D2.of(i.chosenCoord.get(),n);return i.chooseMove(s)}return i.cancelMove(wd.INVALID_DISTANCE())})()}isPyramid(n,i){return this.board[i][n].isPlayer()||this.wasOpponent(n,i)}wasOpponent(n,i){const s=this.node.mother;if(s.isPresent()){const o=s.get().gameState.getCurrentOpponent();return s.get().gameState.getPieceAtXY(n,i).is(o)}return!1}getPyramidClass(n,i){const s=this.board[i][n];return s===Ce.ZERO?this.getPlayerClass(I.ZERO):s===Ce.ONE?this.getPlayerClass(I.ONE):"captured-fill"}mustDraw(n,i){return this.board[i][n]!==Ce.UNREACHABLE||this.wasRemoved(n,i)}wasRemoved(n,i){const o=this.node.mother;if(this.board[i][n]===Ce.UNREACHABLE&&o.isPresent()){const a=o.get().gameState.getPieceAtXY(n,i);return a===Ce.EMPTY||a.is(o.get().gameState.getCurrentPlayer())}return!1}getSpaceClass(n,i){return this.wasRemoved(n,i)?"captured-alternate-fill":(n+i)%2==1?"background":"background2"}getTilesCountCoordinate(){return"-15, -40, 35, -40, 60, 10, 35, 60, -15, 60, -40, 10, -15, -40"}mustShowTilesOf(n){return this.tiles[n.value]>0||this.lastTurnWasTilesExchange(n)}lastTurnWasTilesExchange(n){return!this.node.mother.isAbsent()&&this.getPreviousState().tiles[n.value]>this.tiles[n.value]}getIndicatorY(n){const i=this.INDICATOR_SIZE/2;return(n.x+n.y)%2==0?i:i-30}getTriangleInHexTranslate(n,i){const s=this.getTriangleTranslateCoord(n,i),o=s.x+2*Math.floor(n/3)*this.STROKE_WIDTH;let a=s.y;return Math.floor(n/3)%2==0?a+=2*Math.floor(i/2)*this.STROKE_WIDTH:(a+=2*Math.abs(Math.floor((i-1)/2))*this.STROKE_WIDTH,a+=this.STROKE_WIDTH),"translate("+o+", "+a+")"}getTilesCountTranslate(n){let i,s;return n===I.ZERO?(i=-.05,s=-.1):(i=7.5,s=9.45),i*=this.SPACE_SIZE,s*=this.SPACE_SIZE,"translate("+i+", "+s+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-coerceo"]],features:[Je],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],["class","base-no-fill indicator clickable-fill",3,"click",4,"ngFor","ngForOf"],[1,"base-no-fill","indicator","clickable-fill",3,"click"],["class","base no-fill mid-stroke last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount","x","-5","y","5",1,"text-giant"]],template:function(n,i){if(1&n&&(A(),E(0,"svg",0),T(1,oft,2,1,"g",1),T(2,lft,2,1,"g",1),T(3,fft,3,5,"g",2),T(4,pft,2,2,"ng-template",null,3,dn),T(6,_ft,2,1,"g",1),S()),2&n){const s=ln(5);k("viewBox",i.left+" "+i.up+" "+i.width+" "+i.height),v(1),y("ngForOf",i.board),v(1),y("ngForOf",i.board),v(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s),v(3),y("ngForOf",i.Player.PLAYERS)}},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Cft extends Hr{getListMoves(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}sortByNumberOfJump(e){return e.sort((t,n)=>{const i=d2.isDrop(t)?1:d2.isSimple(t)?2:t.coords.length;return(d2.isDrop(n)?1:d2.isSimple(n)?2:n.coords.length)-i})}getListMovesDrop(e){const t=[],n=Lt.CENTRAL_ZONE_TOP_LEFT,i=Lt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let s=n.y;s<=i.y;s++)for(let o=n.x;o<=i.x;o++)e.getPieceAtXY(o,s)===X.NONE&&t.push(J3.of(new C(o,s)));return t}getListMovesAfterDrop(e){let t=[];const n=e.getCurrentPlayer();for(let i=0;i<Lt.HEIGHT;i++)for(let s=0;s<Lt.WIDTH;s++){const o=new C(s,i);e.getPieceAt(o)===n&&(t=t.concat(this.getListSimpleMoves(e,o)),t=t.concat(this.getListJumps(e,o)))}return t}getListSimpleMoves(e,t){const n=[],i=[new C(t.x+1,t.y),new C(t.x-1,t.y),new C(t.x,t.y+1),new C(t.x,t.y-1),new C(t.x+1,t.y+1),new C(t.x+1,t.y-1),new C(t.x-1,t.y+1),new C(t.x-1,t.y-1)].filter(s=>Lt.isOnBoard(s));for(const s of i){const o=e4.from(t,s);o.isSuccess()&&ho.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}getListJumps(e,t){const n=new dt;for(const i of ho.get().jumpTargetsFrom(t)){const s=Fo.from([t,i]).get();ho.get().jumpLegality(s,e).isSuccess()&&(n.add(s),n.addAll(this.getListJumpStartingFrom(e,s)))}return n.toList()}getListJumpStartingFrom(e,t){const n=ho.get().nextJumps(t,e),i=new dt(n);for(const s of n)i.addAll(this.getListJumpStartingFrom(e,s));return i}getMetrics(e){const t=e.gameState,n=[0,0];for(let i=0;i<Lt.HEIGHT;i++)for(let s=0;s<Lt.WIDTH;s++){const o=new C(s,i),a=t.getPieceAt(o);if(a.isPlayer())if(t.isShelter(o))n[a.value]+=20;else{let c=100;for(const l of Lt.ALL_SHELTERS)if(t.getPieceAt(l)===X.NONE){const f=o.getOrthogonalDistance(l);c=Math.min(c,f)}n[a.value]-=c}}return n}}function yft(r,e){if(1&r){const t=pe();A(),E(0,"rect",9),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),S()}if(2&r){const t=p().$implicit,n=p(2);k("x",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.x+n.STROKE_WIDTH)("y",1.5*n.STROKE_WIDTH+n.SPACE_SIZE*t.coord.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE-3*n.STROKE_WIDTH)("height",n.SPACE_SIZE-3*n.STROKE_WIDTH)}}function Mft(r,e){if(1&r){const t=pe();A(),E(0,"circle",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),k("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Eft(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",6),U("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s.coord))}),S(),T(2,yft,1,4,"rect",7),T(3,Mft,1,6,"circle",8),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","click_",n,"_",i,""),y("ngClass",t.squareClasses),k("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t.isShelter),v(1),y("ngIf",t.hasPiece)}}function Sft(r,e){if(1&r&&(A(),E(0,"g"),T(1,Eft,4,9,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Pft(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",10),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),S()()}if(2&r){const t=e.$implicit,n=p();v(1),y("ngClass",n.viewInfo.boardInfo[t.y][t.x].shelterClasses),k("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Tft(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=e.$implicit,n=p();Rn("id","sidePiece_0_",t,""),k("cx",-n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function Oft(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=e.$implicit,n=p();Rn("id","sidePiece_1_",t,""),k("cx",1715+n.PIECE_RADIUS)("cy",1670-t*n.PIECE_RADIUS)("r",n.PIECE_RADIUS-5)}}function bft(r,e){if(1&r&&(A(),F(0,"rect",13)),2&r){const t=p();k("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let wft=(()=>{var r;class e extends gl{constructor(n){super(n),u(this,"PIECE_RADIUS",void 0),u(this,"ALL_SHELTERS",Lt.ALL_SHELTERS),u(this,"CENTRAL_ZONE_START",Lt.CENTRAL_ZONE_TOP_LEFT),u(this,"CENTRAL_ZONE_SIZE",new St(Lt.CENTRAL_ZONE_BOTTOM_RIGHT.x-Lt.CENTRAL_ZONE_TOP_LEFT.x+1,Lt.CENTRAL_ZONE_BOTTOM_RIGHT.y-Lt.CENTRAL_ZONE_TOP_LEFT.y+1)),u(this,"viewInfo",{dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]}),u(this,"selected",g.empty()),u(this,"jumpInConstruction",g.empty()),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=ho.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Cft(this.rules,"ConspirateursMinimax")],this.encoder=d2.encoder,this.tutorial=(new Dae).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo()}updateViewInfo(){const n=this.getState();this.viewInfo.dropPhase=n.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let i=0;i<Lt.HEIGHT;i++){this.viewInfo.boardInfo.push([]);for(let s=0;s<Lt.WIDTH;s++){const o=new C(s,i),a=n.getPieceAt(o),c={coord:o,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(a)],hasPiece:a.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[i].push(c)}}this.viewInfo.sidePieces=n.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const n of Lt.ALL_SHELTERS){const i=this.viewInfo.boardInfo[n.y][n.x];i.isShelter=!0,i.hasPiece&&i.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const n=this.jumpInConstruction.get(),i=n.getStartingCoord(),s=n.getEndingCoord();this.viewInfo.boardInfo[i.y][i.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const o of n.coords)this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("moved-fill")}else{const n=this.selected.get();this.viewInfo.boardInfo[n.y][n.x].pieceClasses.push("selected-stroke")}}updateVictory(){const n=this.getState(),i=ho.get().getGameStatus(this.node);if(!0===i.isEndGame)for(const s of Lt.ALL_SHELTERS)n.getPieceAt(s)===i.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(n){if(d2.isDrop(n))this.viewInfo.boardInfo[n.coord.y][n.coord.x].squareClasses.push("moved-fill");else if(d2.isSimple(n))this.viewInfo.boardInfo[n.getStart().y][n.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[n.getEnd().y][n.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const i of n.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=i.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=i.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=g.empty(),this.selected=g.empty(),this.updateBoard()}onClick(n){var i=this;return P(function*(){const s=i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());const o=i.getState();if(o.getPieceAt(n)===i.getCurrentPlayer())return i.selected.equalsValue(n)?i.cancelMoveAttempt():(i.selected=g.of(n),i.jumpInConstruction=g.empty()),i.updateViewInfo(),b.SUCCESS;if(i.jumpInConstruction.isPresent())return i.constructJump(n);if(i.selected.isPresent())return i.selectNextCoord(n);if(o.isDropPhase()){const a=J3.of(n);return i.chooseMove(a)}return i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(n){var i=this;return P(function*(){const s=i.jumpInConstruction.get(),o=i.getState();if(n.equals(s.getEndingCoord()))return i.chooseMove(s);{const a=s.addJump(n);if(a.isFailure())return i.cancelMove(a.getReason());const c=i.rules.jumpLegality(a.get(),o);return c.isFailure()?i.cancelMove(c.getReason()):i.updateJump(a.get())}})()}updateJump(n){var i=this;return P(function*(){const s=i.getState();return i.rules.jumpHasPossibleNextTargets(n,s)?(i.jumpInConstruction=g.of(n),i.updateViewInfo(),b.SUCCESS):i.chooseMove(n)})()}selectNextCoord(n){var i=this;return P(function*(){const s=i.selected.get(),o=e4.from(s,n);if(o.isSuccess())return i.chooseMove(o.get());{const a=Fo.from([s,n]);return a.isFailure()?i.cancelMove(a.getReason()):i.updateJump(a.get())}})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-conspirateurs"]],features:[Je],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Sft,2,1,"g",1),T(2,Pft,2,5,"g",1),T(3,Tft,1,4,"circle",2),T(4,Oft,1,4,"circle",3),T(5,bft,1,4,"rect",4),F(6,"polyline",5),S()),2&n&&(v(1),y("ngForOf",i.viewInfo.boardInfo),v(1),y("ngForOf",i.ALL_SHELTERS),v(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[0])),v(1),y("ngForOf",i.ArrayUtils.range(i.viewInfo.sidePieces[1])),v(1),y("ngIf",i.viewInfo.dropPhase),v(1),k("points",i.viewInfo.lastMoveArrow))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Nft extends Hr{getListMoves(e){const t=e.gameState,n=this.getListDrops(t),i=this.getListShifts(t);return n.concat(i)}getListShifts(e){const t=[],n=this.getShiftSources(e);for(const i of n)for(const s of[new z2(i,"clockwise"),new z2(i,"counterclockwise")])Lc.get().shiftHeightValidity(s,e).isSuccess()&&t.push(s);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),n=[];for(let i=0;i<Y1.WIDTH;i++)for(const s of t){const o=new t4(i,s);Lc.get().dropHeightValidity(o,e).isSuccess()&&n.push(o)}return n}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const n of Pn.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,n)&&t.push(n);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],n=e.getCurrentPlayer();for(let i=0;i<Y1.HEIGHT;i++)for(let s=0;s<Y1.WIDTH;s++)e.getPieceAtXY(s,i).owner===n&&t.push(new C(s,i));return t}getMetrics(e){return[0,0]}}var LL;function Aft(r,e){if(1&r){const t=pe();A(),E(0,"g",6)(1,"path",7),U("click",function(){const s=te(t).$implicit;return ne(p().onSpaceClick(s))}),S(),E(2,"path",8),U("click",function(){const s=te(t).$implicit;return ne(p().onSpaceClick(s))}),S()()}if(2&r){const t=e.$implicit,n=p();Rn("id","board_space_",t,""),v(1),Rn("id","click_",t,""),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),k("d",n.BOARD_PATHS[t]),v(1),y("ngClass",n.viewInfo.boardInfo[t].spaceClasses),k("d",n.DECORATION_PATHS[t])}}function Ift(r,e){if(1&r){const t=pe();A(),E(0,"g",10),U("click",function(){const s=te(t).$implicit,o=p().$implicit;return ne(p().onPieceInGameClick(o,s.y))}),F(1,"use",11)(2,"use",12),S()}if(2&r){const t=e.$implicit;ye("id","click_",p().$implicit,"_",t.y,""),y("ngClass",t.foregroundClasses),v(1),y("ngClass",t.backgroundClasses),k("x",t.drawPosition.x)("y",t.drawPosition.y),v(1),k("x",t.drawPosition.x)("y",t.drawPosition.y)}}function kft(r,e){if(1&r&&(A(),E(0,"g"),T(1,Ift,3,8,"g",9),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngForOf",n.viewInfo.boardInfo[t].pieces)}}function xft(r,e){if(1&r){const t=pe();A(),E(0,"g",14),U("click",function(){const i=te(t),s=i.$implicit,o=i.index;return ne(p(2).onRemainingPieceClick(s.actualPiece,o))}),F(1,"use",11)(2,"use",12),S()}if(2&r){const t=e.$implicit,n=e.index;Ti("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",n,""),y("ngClass",t.foregroundClasses),v(1),y("ngClass",t.backgroundClasses),k("x",t.drawPosition.x)("y",t.drawPosition.y),v(1),k("x",t.drawPosition.x)("y",t.drawPosition.y)}}function Lft(r,e){if(1&r&&(A(),E(0,"g"),T(1,xft,3,9,"g",13),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngForOf",n.viewInfo.remainingPieces.get(t).get())}}const Rft=function(){return[0,1,2,3,4,5,6,7]},zft=function(){return[2,1,3,0,4,7,5,6]};class Rc extends gl{constructor(e){super(e),u(this,"BOARD_PATHS",["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"]),u(this,"DECORATION_PATHS",["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"]),u(this,"selected",g.empty()),u(this,"viewInfo",{boardInfo:[],remainingPieces:new un([{key:I.ZERO,value:[]},{key:I.ONE,value:[]}])}),this.rules=Lc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Nft(this.rules,"DiamDummyMinimax")],this.encoder=eft,this.tutorial=(new Bae).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(e){var t=this;return P(function*(){const n=t.canUserPlay("#click_"+e);return n.isFailure()?t.cancelMove(n.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return P(function*(){if(t.selected.isPresent()){const n=t.selected.get();let i;if("pieceFromReserve"===n.type)i=new t4(e,n.piece);else if((n.position.x+1)%Y1.WIDTH===e)i=new z2(n.position,"clockwise");else{if((n.position.x+(Y1.WIDTH-1))%Y1.WIDTH!==e)return t.cancelMove(bd.MUST_SHIFT_TO_NEIGHBOR());i=new z2(n.position,"counterclockwise")}return t.chooseMove(i)}return t.cancelMove(bd.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var n=this;return P(function*(){const i=n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);return n.getState().getPieceAt(s).owner===n.getCurrentPlayer()?(n.isSelected(null,s)?n.cancelMoveAttempt():n.selected=g.of({type:"pieceFromBoard",position:s}),n.updateViewInfo(),b.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e,t){var n=this;return P(function*(){const i=n.canUserPlay(n.getPieceId(e,t));return i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?g.empty():g.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),b.SUCCESS):n.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(){this.updateViewInfo()}getLastMovedFromDrop(e,t){const n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),i=e.getTarget(),s=t.getStackHeight(e.getTarget()),o=this.getDrawPositionOnBoard(i,s),a=new C(i,s);return[{start:g.empty(),end:a,startDrawPosition:n,endDrawPosition:o}]}getLastMovedFromShift(e,t){const n=e.start.x,i=e.getTarget();let s=t.getStackHeight(i);const o=[];for(let a=e.start.y;a<Y1.HEIGHT&&t.getPieceAtXY(n,a)!==Pn.EMPTY;a++,s++)o.push({start:g.of(new C(n,a)),end:new C(i,s),startDrawPosition:this.getDrawPositionOnBoard(n,a),endDrawPosition:this.getDrawPositionOnBoard(i,s)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<Y1.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){this.showLastMoveOnSpaces(e),this.showLastMoveOnPieces(e)}showLastMoveOnSpaces(e){for(let t=0;t<Y1.WIDTH;t++){const n=[];if(e.isDrop())e.getTarget()===t&&n.push("moved-fill");else{const i=e;(i.getTarget()===t||i.start.x===t)&&n.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=n}}showLastMoveOnPieces(e){const t=this.getPreviousState();let n=[];n=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const i of n)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new un([{key:I.ZERO,value:[]},{key:I.ONE,value:[]}]);const t=this.isPlayerTurn();for(const n of Pn.PLAYER_PIECES){const i=this.getState().getRemainingPiecesOf(n);for(let s=0;s<i;s++){const o=[];this.isTopPieceOfReserveAndSelected(s,i,n)&&o.push("selected-stroke"),t&&s===i-1&&n.owner===e&&o.push("clickable-stroke-hover");const a=this.viewInfo.remainingPieces.get(n.owner).get(),c=[];c.push(n.otherPieceType?"player"+n.owner.value+"-alternate-fill":"player"+n.owner.value+"-fill"),a.push({backgroundClasses:c,foregroundClasses:o,y:s,drawPosition:this.getDrawPositionRemainingPiece(n,s),actualPiece:n}),this.viewInfo.remainingPieces.put(n.owner,a)}}}isTopPieceOfReserveAndSelected(e,t,n){if(this.selected.isPresent()){const i=this.selected.get();return"pieceFromReserve"===i.type&&i.piece===n&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let n,i;return n=e.owner===I.ZERO?-100:600,i=e.otherPieceType?100:450,new C(n,i).getNext(new St(0,-t*Rc.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),i=[];for(let s=0;s<Y1.HEIGHT;s++){const o=this.getState().getPieceAtXY(e,s),a=new C(e,s);if(o!==Pn.EMPTY){const c=[];this.pieceFromBoardIsSelected(e,s)&&c.push("selected-stroke"),this.isVictory(e,s,t)&&c.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),a)&&c.push("clickable-stroke-hover"),i.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:c,y:s,drawPosition:this.getDrawPositionOnBoard(e,s),actualPiece:o})}}return i}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}isVictory(e,t,n){if(n.isPresent()){const i=n.get();return i.x%4==e%4&&i.y===t}return!1}getDrawPositionOnBoard(e,t){return Rc.CENTER[e].getNext(new St(0,-t*Rc.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=g.empty(),this.updateBoard()}}LL=Rc,u(Rc,"CENTER",[new C(40,160),new C(100,50),new C(255,2),new C(400,50),new C(460,160),new C(400,270),new C(255,320),new C(100,270)]),u(Rc,"PIECE_HEIGHT",36),u(Rc,"\u0275fac",function(e){return new(e||LL)(G(Wt))}),u(Rc,"\u0275cmp",Xe({type:LL,selectors:[["app-diam"]],features:[Je],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),E(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),S()(),T(5,Aft,3,6,"g",4),T(6,kft,2,1,"g",5),T(7,Lft,2,1,"g",5),S()),2&e&&(v(5),y("ngForOf",g1(3,Rft)),v(1),y("ngForOf",g1(4,zft)),v(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Zt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class go{static fromTwoCoords(e,t){const n=e.x,i=t.x,s=e.y,o=t.y,a=n+s,c=i+o;return n===i&&s!==o&&a!==c?g.of(go.constantQ(n)):n!==i&&s===o&&a!==c?g.of(go.constantR(s)):n!==i&&s!==o&&a===c?g.of(go.constantS(a)):g.empty()}static constantQ(e){return new go(e,"q")}static constantR(e){return new go(e,"r")}static constantS(e){return new go(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=go.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const n=t.get();for(const i of e.slice(2))if(!1===n.contains(i))return!1;return!0}constructor(e,t){u(this,"offset",void 0),u(this,"constant",void 0),this.offset=e,this.constant=t}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return be.DOWN;case"r":return be.RIGHT;case"s":return be.DOWN_LEFT}}}class RL extends F1{constructor(e,t,n,i,s,o){super(t,e),u(this,"width",void 0),u(this,"height",void 0),u(this,"excludedSpaces",void 0),u(this,"empty",void 0),this.width=n,this.height=i,this.excludedSpaces=s,this.empty=o,Ve(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let n=0;n<this.excludedSpaces.length;n++)if(this.excludedSpaces[n]!==e.excludedSpaces[n])return!1;for(const n of this.allCoords())if(!1===t(this.getPieceAt(n),e.getPieceAt(n)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(go.constantQ(t));for(let t=0;t<this.height;t++)e.push(go.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(go.constantS(t));return e}getEntranceOnLine(e){let t,n;switch(e.constant){case"q":return n=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(e.offset,n));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new C(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new C(e.offset,0):new C(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const n=e.getDirection();let i=t;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(i))return i;i=i.getNext(n)}const s=c2.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(s.getReason())}}class h2{static getNeighbors(e,t=1){const n=[];for(const i of be.factory.all)n.push(e.getNext(i,t));return n}static areNeighbors(e,t){for(const n of be.factory.all)if(e.getNext(n).equals(t))return!0;return!1}}var M0;class l1{static append(e,t){return new l1(e.owner,e.size+t.size,e.source||t.source)}constructor(e,t,n){u(this,"owner",void 0),u(this,"size",void 0),u(this,"source",void 0),this.owner=e,this.size=t,this.source=n}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}M0=l1,u(l1,"encoder",Ie.tuple([Ie.identity(),I.encoder,Ie.identity()],r=>[r.source,r.owner,r.size],r=>new M0(r[1],r[2],r[0]))),u(l1,"MAX_SIZE",49),u(l1,"EMPTY",new M0(X.NONE,0,!1)),u(l1,"UNREACHABLE",new M0(X.NONE,-1,!1)),u(l1,"PLAYER_ZERO",new M0(I.ZERO,1,!1)),u(l1,"PLAYER_ONE",new M0(I.ONE,1,!1)),u(l1,"SOURCE",new M0(X.NONE,1,!0));let Bo=(()=>{class r extends RL{static balancedBoard(){const t=l1.UNREACHABLE,n=l1.PLAYER_ZERO,i=l1.PLAYER_ONE,s=l1.SOURCE;return[[t,t,n,i,i,i,n,n,i,s,i],[t,i,i,n,n,n,i,i,n,i,i],[i,i,i,i,n,s,i,n,n,n,n],[n,n,i,n,n,i,i,i,n,n,t],[n,s,n,i,i,n,n,n,i,t,t]]}static isOnBoard(t){return!t.isNotInRange(r.WIDTH,r.HEIGHT)&&r.balancedBoard()[t.y][t.x]!==l1.UNREACHABLE}static getInitialState(){return new r(r.balancedBoard(),0,!1)}constructor(t,n,i){super(n,t,r.WIDTH,r.HEIGHT,r.EXCLUDED_SPACES,l1.EMPTY),u(this,"alreadyPassed",void 0),this.alreadyPassed=i}getAllPieces(){const t=[];for(let n=0;n<r.HEIGHT;n++)for(let i=0;i<r.WIDTH;i++){const s=new C(i,n);this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()&&t.push(s)}return t}numberOfNeighbors(t){return h2.getNeighbors(t,1).filter(s=>this.isOnBoard(s)&&this.getPieceAt(s).hasPieces()).length}setAtUnsafe(t,n){const i=He.copyBiArray(this.board);return i[t.y][t.x]=n,new r(i,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==l1.UNREACHABLE}}return u(r,"WIDTH",11),u(r,"HEIGHT",5),u(r,"EXCLUDED_SPACES",[2,1]),r})(),E0=(()=>{class r{}return u(r,"NOT_PLAYER_PIECE",()=>$localize`You must select a piece or a stack of your color.`),u(r,"EMPTY_STACK",()=>$localize`You must select a stack.`),u(r,"TOO_MANY_NEIGHBORS",()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`),u(r,"CANT_REACH_TARGET",()=>$localize`This stack cannot move because it could never land on another piece.`),u(r,"INVALID_MOVE_LENGTH",()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`),u(r,"EMPTY_TARGET_STACK",()=>$localize`The stack must land on an occupied space.`),u(r,"MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`A stack must move in a straight line.`),r})();var zL;class ar extends Vo{constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?se.success(ar.PASS):!1===Bo.isOnBoard(e)?se.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString()):!1===Bo.isOnBoard(t)?se.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?se.success(new ar(e,t)):se.failure(E0.MUST_MOVE_IN_STRAIGHT_LINE())}toString(){return this===ar.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}u(ar,"PASS",new(zL=ar)(new C(-1,-1),new C(-2,-2))),u(ar,"encoder",zs.getFallibleEncoder(zL.from));const ie=l1.EMPTY,K1=l1.UNREACHABLE,yl=l1.SOURCE,iu=l1.PLAYER_ZERO,su=l1.PLAYER_ONE,Dft=new l1(I.ZERO,2,!1),DL=new l1(I.ONE,2,!1),Zae=new l1(I.ZERO,4,!1),Hft=new l1(I.ONE,4,!1);class Yae extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Bo.getInitialState(),ar.from(new C(2,0),new C(3,0)).get(),$localize`Congratulations!`),W.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Bo([[K1,K1,su,yl,ie,ie,ie,ie,ie,ie,ie],[K1,ie,iu,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,Hft,ie,ie,ie,ie,su,yl,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,K1],[ie,ie,ie,ie,ie,ie,ie,ie,ie,K1,K1]],0,!1),ar.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(3,0))?b.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(Ve(t.getEnd().equals(new C(2,0)),"player made an impossible move"),b.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),W.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Bo([[K1,K1,yl,su,ie,ie,ie,ie,ie,ie,ie],[K1,iu,iu,ie,ie,ie,ie,ie,ie,ie,ie],[ie,su,iu,su,ie,ie,iu,DL,yl,ie,ie],[ie,ie,su,ie,ie,ie,ie,ie,ie,ie,K1],[ie,ie,ie,ie,ie,ie,ie,ie,ie,K1,K1]],0,!1),ar.from(new C(2,1),new C(2,0)).get(),(t,n,i)=>t.getEnd().equals(new C(2,0))?b.SUCCESS:b.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),W.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Bo([[K1,K1,yl,ie,ie,ie,ie,ie,ie,ie,ie],[K1,ie,Dft,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,DL,ie,ie,ie,ie,DL,yl,Zae,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,K1],[ie,ie,ie,ie,ie,ie,ie,ie,ie,K1,K1]],0,!1)),W.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Bo([[K1,K1,yl,ie,ie,ie,ie,ie,ie,ie,ie],[K1,ie,iu,ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie,yl,Zae,ie],[ie,ie,ie,ie,ie,ie,ie,ie,ie,ie,K1],[ie,ie,ie,ie,ie,ie,ie,ie,ie,K1,K1]],0,!1),[ar.from(new C(2,1),new C(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)])}}class Er extends jn{static get(){return Er.singleton.isAbsent()&&(Er.singleton=g.of(new Er)),Er.singleton.get()}constructor(){super(Bo)}static getGameStatus(e){const t=e.gameState,n=Er.getScores(t);return 0===Er.getMovablePieces(t).length?n[0]>n[1]?ve.ZERO_WON:n[0]<n[1]?ve.ONE_WON:ve.DRAW:ve.ONGOING}static getMovablePieces(e){return Er.getFreePieces(e).filter(t=>Er.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const n=e.getPieceAt(t).getSize();return void 0!==h2.getNeighbors(t,n).find(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static pieceTargets(e,t){const n=e.getPieceAt(t).getSize();return h2.getNeighbors(t,n).filter(s=>e.isOnBoard(s)&&e.getPieceAt(s).hasPieces())}static getScores(e){let t=0,n=0;return e.getAllPieces().map(i=>{const s=e.getPieceAt(i);s.belongsTo(I.ZERO)?t+=s.getSize():s.belongsTo(I.ONE)&&(n+=s.getSize())}),[t,n]}isMovablePiece(e,t){Ve(e.isOnBoard(t),"piece is not on the board");const n=e.getPieceAt(t);return n.getSize()<1?b.failure(E0.EMPTY_STACK()):!1===n.belongsTo(e.getCurrentPlayer())?b.failure(E0.NOT_PLAYER_PIECE()):e.numberOfNeighbors(t)>=6?b.failure(E0.TOO_MANY_NEIGHBORS()):!1===Er.pieceHasTarget(e,t)?b.failure(E0.CANT_REACH_TARGET()):b.SUCCESS}canOnlyPass(e){return 0===Er.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,n){h2.getNeighbors(t,1).forEach(i=>{e.isOnBoard(i)&&!1===n[i.y][i.x]&&e.getPieceAt(i).hasPieces()&&(n[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,n))})}removeDisconnectedPieces(e){const t=He.createTable(Bo.WIDTH,Bo.HEIGHT,!1);this.sourceCoords(e).forEach(i=>{t[i.y][i.x]=!0,this.markPiecesConnectedTo(e,i,t)});let n=e;return n.getAllPieces().forEach(i=>{!1===t[i.y][i.x]&&(n=n.setAt(i,l1.EMPTY))}),n}applyLegalMove(e,t,n){if(e===ar.PASS)return new Bo(t.board,t.turn+1,!0);{const i=t.getPieceAt(e.getStart()),s=t.getPieceAt(e.getEnd()),o=t.setAt(e.getStart(),l1.EMPTY).setAt(e.getEnd(),l1.append(i,s));return this.removeDisconnectedPieces(new Bo(o.board,t.turn+1,!1))}}isLegal(e,t){if(0===Er.getMovablePieces(t).length)return e===ar.PASS&&!1===t.alreadyPassed?b.SUCCESS:b.failure(Le.MUST_PASS());if(e===ar.PASS)return b.failure(Le.CANNOT_PASS());const n=this.isMovablePiece(t,e.getStart());if(n.isFailure())return n;const i=t.getPieceAt(e.getStart());return e.length()!==i.getSize()?se.failure(E0.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?se.failure(E0.EMPTY_TARGET_STACK()):se.success(void 0)}getGameStatus(e){return Er.getGameStatus(e)}}u(Er,"singleton",g.empty());class Kae extends Hr{getListMoves(e){const t=e.move,n=e.gameState,i=[];return Er.getMovablePieces(n).forEach(s=>Er.pieceTargets(n,s).forEach(o=>{const a=ar.from(s,o).get();i.push(a)})),0===i.length&&!1===t.equalsValue(ar.PASS)&&i.push(ar.PASS),i}getMetrics(e){return Er.getScores(e.gameState)}}class Vft extends Kae{getListMoves(e){const t=e.gameState,n=super.getListMoves(e),i=t.getCurrentPlayer().getOpponent();return He.sortByDescending(n,s=>{Ve(s!==ar.PASS,"Cannot sort with DvonnMove.PASS");const o=t.getPieceAt(s.getEnd());return o.belongsTo(i)?o.getSize():0}),n}getMetrics(e){const t=e.gameState,n=Er.getScores(t),i=t.getAllPieces(),s=i.length;for(const o of I.PLAYERS){const a=i.filter(c=>t.getPieceAt(c).belongsTo(o)).length;n[o.value]=n[o.value]*a/s}return n}}function Fft(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=p().$implicit,n=p().$implicit,i=p();ye("id","piece_",n.x,"_",n.y,""),y("ngClass",i.getPieceClasses(t)),k("cx",i.getCenterAt(n).x)("cy",i.getCenterAt(n).y)("r",i.SPACE_SIZE)}}function $ft(r,e){if(1&r&&(A(),F(0,"polygon",12)),2&r){const t=p().$implicit,n=p().$implicit,i=p();k("transform",1===t.getSize()?"translate("+(i.getCenterAt(n).x-18)+" "+(i.getCenterAt(n).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(n).x-3)+" "+(i.getCenterAt(n).y-12)+") scale(0.07)")}}function Bft(r,e){if(1&r){const t=pe();A(),E(0,"text",13),U("click",function(){te(t);const i=p(2).$implicit;return ne(p().onClick(i.x,i.y))}),lt(1),S()}if(2&r){const t=p().$implicit,n=p().$implicit,i=p();k("x",t.containsSource()?i.getCenterAt(n).x-7:i.getCenterAt(n).x)("y",i.getCenterAt(n).y),v(1),Nn(t.getSize())}}function Gft(r,e){if(1&r){const t=pe();A(),E(0,"g",6),U("click",function(){te(t);const i=p().$implicit;return ne(p().onClick(i.x,i.y))}),F(1,"polygon",7),T(2,Fft,1,6,"circle",8),T(3,$ft,1,1,"polygon",9),T(4,Bft,2,3,"text",10),S()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","click_",n.x,"_",n.y,""),v(1),k("points",i.getHexaPointsAt(n)),v(1),y("ngIf",t.getSize()>0),v(1),y("ngIf",t.containsSource()),v(1),y("ngIf",t.getSize()>1)}}const Uft=function(r){return[r]};function Wft(r,e){if(1&r&&(A(),E(0,"g"),T(1,Gft,5,6,"g",5),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngForOf",da(1,Uft,n.state.getPieceAt(t)))}}function qft(r,e){if(1&r&&(A(),E(0,"text",18),lt(1),S()),2&r){const t=p().$implicit,n=p();k("x",n.getCenterAt(t.coord).x)("y",n.getCenterAt(t.coord).y),v(1),Nn(t.spaceContent.getSize())}}function jft(r,e){if(1&r&&(A(),E(0,"g",14),F(1,"polygon",15)(2,"circle",16),T(3,qft,2,3,"text",17),S()),2&r){const t=e.$implicit,n=p();ye("id","disconnected_",t.coord.x,"_",t.coord.y,""),v(1),k("points",n.getHexaPointsAt(t.coord)),v(1),ye("id","captured_",t.coord.x,"_",t.coord.y,""),y("ngClass",n.getPieceClasses(t.spaceContent)),k("cx",n.getCenterAt(t.coord).x)("cy",n.getCenterAt(t.coord).y)("r",n.SPACE_SIZE),v(1),y("ngIf",t.spaceContent.getSize()>1)}}function Zft(r,e){if(1&r&&(A(),Bt(0),F(1,"polygon",19)(2,"polygon",19),Gt()),2&r){const t=p();v(1),k("points",t.getHexaPointsAt(t.lastMove.get().getStart())),v(1),k("points",t.getHexaPointsAt(t.lastMove.get().getEnd()))}}function Yft(r,e){if(1&r&&(A(),F(0,"polygon",20)),2&r){const t=p();ye("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),k("points",t.getHexaPointsAt(t.chosen.get()))}}let Kft=(()=>{var r;class e extends Q5{constructor(n){super(n),u(this,"lastMove",g.empty()),u(this,"chosen",g.empty()),u(this,"disconnecteds",[]),u(this,"state",void 0),this.rules=Er.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Kae(this.rules,"DvonnMinimax"),new Vft(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=ar.encoder,this.tutorial=(new Yae).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=g.of(Er.getScores(this.getState())),this.hexaLayout=new J5(1.5*this.SPACE_SIZE,new C(-this.SPACE_SIZE,2*this.SPACE_SIZE),eC.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=g.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.disconnecteds=[],this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=g.of(Er.getScores(this.state))}showLastMove(n){this.lastMove=g.of(n);const i=this.getPreviousState(),s=this.getState();for(let o=0;o<s.board.length;o++)for(let a=0;a<s.board[o].length;a++){const c=new C(a,o);if(!0===s.isOnBoard(c)&&!1===c.equals(this.lastMove.get().getStart())){const l=s.getPieceAt(c),f=i.getPieceAt(c);if(l.isEmpty()&&f.hasPieces()){const m={coord:new C(a,o),spaceContent:f};this.disconnecteds.push(m)}}}}cancelMoveAttempt(){this.chosen=g.empty()}pass(){var n=this;return P(function*(){return Ve(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(ar.PASS)})()}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.chosen.isAbsent()?s.choosePiece(n,i):s.chosen.equalsValue(new C(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):yield s.chooseDestination(n,i)})()}choosePiece(n,i){const s=new C(n,i),o=this.rules.isMovablePiece(this.getState(),s);return o.isSuccess()?(this.chosen=g.of(s),b.SUCCESS):this.cancelMove(o.getReason())}chooseDestination(n,i){var s=this;return P(function*(){const o=s.getState(),a=s.chosen.get(),c=new C(n,i),l=ar.from(a,c);return l.isFailure()?s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.cancelMove(l.getReason()):s.rules.isLegal(l.get(),o).isFailure()&&s.rules.isMovablePiece(o,c).isSuccess()?s.choosePiece(n,i):s.chooseMove(l.get())})()}getPieceClasses(n){if(n.containsSource()&&1===n.getSize())return["nonplayer-fill","dashed-stroke"];const i=this.getPlayerClass(n.getOwner());return n.containsSource()?[i,"nonplayer-stroke","dashed-stroke"]:[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-dvonn"]],features:[Je],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Wft,2,3,"g",1),T(2,jft,4,10,"g",2),T(3,Zft,3,2,"ng-container",3),T(4,Yft,1,3,"polygon",4),S()),2&n&&(v(1),y("ngForOf",i.state.allCoords()),v(1),y("ngForOf",i.disconnecteds),v(1),y("ngIf",i.lastMove.isPresent()),v(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var r4,I1=function(r){return r[r.NONE=0]="NONE",r[r.SMALL=1]="SMALL",r[r.MEDIUM=2]="MEDIUM",r[r.BIG=3]="BIG",r}(I1||{});class We{static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===I.ZERO&&e===I1.BIG?We.BIG_DARK:t===I.ZERO&&e===I1.MEDIUM?We.MEDIUM_DARK:t===I.ZERO&&e===I1.SMALL?We.SMALL_DARK:t===I.ONE&&e===I1.BIG?We.BIG_LIGHT:t===I.ONE&&e===I1.MEDIUM?We.MEDIUM_LIGHT:t===I.ONE&&e===I1.SMALL?We.SMALL_LIGHT:We.NONE}constructor(e){u(this,"value",void 0),this.value=e}getPlayer(){switch(this){case We.SMALL_DARK:case We.MEDIUM_DARK:case We.BIG_DARK:return I.ZERO;case We.SMALL_LIGHT:case We.MEDIUM_LIGHT:case We.BIG_LIGHT:return I.ONE;default:return X.NONE}}getSize(){switch(this){case We.BIG_DARK:case We.BIG_LIGHT:return I1.BIG;case We.MEDIUM_DARK:case We.MEDIUM_LIGHT:return I1.MEDIUM;case We.SMALL_DARK:case We.SMALL_LIGHT:return I1.SMALL;default:return K.expectToBe(this,We.NONE),I1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case We.BIG_DARK:return"BIG_DARK";case We.BIG_LIGHT:return"BIG_LIGHT";case We.MEDIUM_DARK:return"MEDIUM_DARK";case We.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case We.SMALL_DARK:return"SMALL_DARK";case We.SMALL_LIGHT:return"SMALL_LIGHT";default:return K.expectToBe(this,We.NONE),"EMPTY"}}}r4=We,u(We,"encoder",Ie.tuple([Ie.identity()],r=>[r.value],r=>r4.of(r[0]))),u(We,"SMALL_DARK",new r4(0)),u(We,"SMALL_LIGHT",new r4(1)),u(We,"MEDIUM_DARK",new r4(2)),u(We,"MEDIUM_LIGHT",new r4(3)),u(We,"BIG_DARK",new r4(4)),u(We,"BIG_LIGHT",new r4(5)),u(We,"NONE",new r4(6));class Ml extends F1{constructor(e,t,n){super(e,t),u(this,"remainingPieces",void 0),this.remainingPieces=n}static getInitialState(){const e=new H2(X.NONE,X.NONE,X.NONE),t=He.createTable(3,3,e);return new Ml(t,0,[We.BIG_DARK,We.BIG_DARK,We.BIG_LIGHT,We.BIG_LIGHT,We.MEDIUM_DARK,We.MEDIUM_DARK,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT,We.SMALL_DARK,We.SMALL_DARK,We.SMALL_LIGHT,We.SMALL_LIGHT])}getRemainingPieces(){return He.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class H2{constructor(e,t,n){u(this,"small",void 0),u(this,"medium",void 0),u(this,"big",void 0),this.small=e,this.medium=t,this.big=n}isEmpty(){return this.small===X.NONE&&this.medium===X.NONE&&this.big===X.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(We.ofSizeAndPlayer(I1.SMALL,this.small)),this.medium.isPlayer()&&e.push(We.ofSizeAndPlayer(I1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(We.ofSizeAndPlayer(I1.BIG,this.big)),e}toOrderedPieceNames(){const e=We.ofSizeAndPlayer(I1.SMALL,this.small),t=We.ofSizeAndPlayer(I1.MEDIUM,this.medium),n=We.ofSizeAndPlayer(I1.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}getBiggest(){return this.big===I.ZERO?We.BIG_DARK:this.big===I.ONE?We.BIG_LIGHT:this.medium===I.ZERO?We.MEDIUM_DARK:this.medium===I.ONE?We.MEDIUM_LIGHT:this.small===I.ZERO?We.SMALL_DARK:this.small===I.ONE?We.SMALL_LIGHT:We.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===We.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?g.of(this.put(e)):g.empty()}removeBiggest(){const e=this.getBiggest();if(e===We.NONE)throw new Error("Cannot removed piece from empty space");let t;const n=e.getSize();switch(n){case I1.BIG:t=new H2(this.small,this.medium,X.NONE);break;case I1.MEDIUM:t=new H2(this.small,X.NONE,X.NONE);break;default:K.expectToBe(n,I1.SMALL),t=new H2(X.NONE,X.NONE,X.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===We.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),n=e.getSize();switch(n){case I1.BIG:return new H2(this.small,this.medium,t);case I1.MEDIUM:return Ve(this.big===X.NONE,"Cannot put a piece on top of a bigger one"),new H2(this.small,t,this.big);default:return K.expectToBe(n,I1.SMALL),Ve(this.big===X.NONE,"Cannot put a piece on top of a bigger one"),Ve(this.medium===X.NONE,"Cannot put a piece on top of a bigger one"),new H2(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}u(H2,"EMPTY",new H2(X.NONE,X.NONE,X.NONE));let Nd=(()=>{class r{}return u(r,"PIECE_OUT_OF_STOCK",()=>$localize`You do not have pieces of this type anymore.`),u(r,"INVALID_PLACEMENT",()=>$localize`You must put your piece on an empty square or on a smaller piece.`),u(r,"NOT_DROPPABLE",()=>$localize`You must pick your piece among the remaining ones.`),u(r,"INVALID_PIECE_SELECTED",()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`),u(r,"END_YOUR_MOVE",()=>$localize`You are performing a move, you must select a landing square.`),r})();var Ad,Na;let ou=(Ad=class extends jn{static get(){return Na.singleton.isAbsent()&&(Na.singleton=g.of(new Na)),Na.singleton.get()}constructor(){super(Ml)}static isVictory(e){const t=e.getCopiedBoard();for(const n of Na.LINES){const s=Na.isVictoriousLine([t[n[0].y][n[0].x],t[n[1].y][n[1].x],t[n[2].y][n[2].x]]);if(s.isPresent())return s}return g.empty()}static isVictoriousLine(e){const n=e.map(i=>i.getBiggest()).map(i=>i.getPlayer());return n[0]===X.NONE?g.empty():n[0]===n[1]&&n[1]===n[2]?g.of(n[0]):g.empty()}static isLegal(e,t){let n;if(e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return se.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return se.failure(Nd.PIECE_OUT_OF_STOCK())}else{const o=e.startingCoord.get();if(n=t.getPieceAt(o).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return se.failure(Le.MUST_CHOOSE_PLAYER_PIECE())}const s=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return s.isPresent()?se.success(s.get()):se.failure(Nd.INVALID_PLACEMENT())}isLegal(e,t){return Na.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();let s=t.getRemainingPieces();const o=t.turn+1;let a;if(i[e.landingCoord.y][e.landingCoord.x]=n,e.isDropping()){a=e.piece.get();const l=s.indexOf(a);s=s.slice(0,l).concat(s.slice(l+1))}else{const l=e.startingCoord.get(),d=i[l.y][l.x].removeBiggest();i[l.y][l.x]=d.removedSpace,a=d.removedPiece}return new Ml(i,o,s)}static getGameStatus(e){const n=Na.isVictory(e.gameState);return n.isPresent()?ve.getVictory(n.get()):ve.ONGOING}getGameStatus(e){return Na.getGameStatus(e)}},Na=Ad,u(Ad,"singleton",g.empty()),u(Ad,"LINES",[[new C(0,0),new C(0,1),new C(0,2)],[new C(1,0),new C(1,1),new C(1,2)],[new C(2,0),new C(2,1),new C(2,2)],[new C(0,0),new C(1,0),new C(2,0)],[new C(0,1),new C(1,1),new C(2,1)],[new C(0,2),new C(1,2),new C(2,2)],[new C(0,0),new C(1,1),new C(2,2)],[new C(0,2),new C(1,1),new C(2,0)]]),Ad);var Qae;ou=Na=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],ou);class p2 extends Li{constructor(e,t,n){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"piece",void 0),this.startingCoord=e,this.landingCoord=t,this.piece=n}static ofMove(e,t){return K.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new p2(g.of(e),t,g.empty())}static ofDrop(e,t){return new p2(g.empty(),t,g.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Qae=p2,u(p2,"encoder",Ie.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(We.encoder)],r=>[r.startingCoord,r.landingCoord,r.piece],r=>new Qae(r[0],r[1],r[2])));class Qft extends Hr{getMetrics(e){return[0,0]}getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getCurrentPlayer(),o=hae.toComparableObjectSet(n.getPlayerRemainingPieces());for(let a=0;a<3;a++)for(let c=0;c<3;c++){const l=new C(c,a);for(const f of o){const d=p2.ofDrop(f,l);ou.isLegal(d,n).isSuccess()&&t.push(d)}if(i[a][c].belongsTo(s))for(let f=0;f<3;f++)for(let d=0;d<3;d++){const m=new C(d,f);if(!1===m.equals(l)){const M=p2.ofMove(l,m);ou.isLegal(M,n).isSuccess()&&t.push(M)}}}return t}}const ps=new H2(X.NONE,X.NONE,X.NONE),Jae=new H2(I.ZERO,X.NONE,X.NONE),Jft=new H2(X.NONE,I.ZERO,X.NONE),e9t=new H2(X.NONE,X.NONE,I.ZERO),ece=new H2(I.ONE,X.NONE,X.NONE),dC=new H2(X.NONE,X.NONE,I.ONE),t9t=new H2(I.ONE,I.ZERO,X.NONE),n9t=new H2(I.ZERO,I.ZERO,X.NONE);class tce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new Ml([[Jae,ece,dC],[ps,Jft,ps],[ps,ps,e9t]],0,[We.SMALL_DARK,We.MEDIUM_DARK,We.BIG_DARK,We.SMALL_LIGHT,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT,We.BIG_LIGHT])),W.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,Ml.getInitialState(),p2.ofDrop(We.SMALL_DARK,new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new Ml([[Jae,dC,ps],[ps,ps,ps],[ps,ps,ps]],0,[]),[p2.ofMove(new C(0,0),new C(2,0)),p2.ofMove(new C(0,0),new C(0,1)),p2.ofMove(new C(0,0),new C(1,1)),p2.ofMove(new C(0,0),new C(2,1)),p2.ofMove(new C(0,0),new C(0,2)),p2.ofMove(new C(0,0),new C(1,2)),p2.ofMove(new C(0,0),new C(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new Ml([[t9t,ps,ece],[n9t,dC,dC],[ps,ps,ps]],0,[We.MEDIUM_DARK,We.BIG_DARK,We.MEDIUM_LIGHT,We.MEDIUM_LIGHT]),p2.ofMove(new C(0,1),new C(0,2)),(t,n,i)=>{if(t.landingCoord.equals(new C(0,2))){if(t.isDropping())return b.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new C(0,1)))return b.SUCCESS}return b.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)])}}function r9t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"circle",5),U("click",function(){const i=te(t),s=i.$implicit,o=i.index,a=p().$implicit;return ne(p().onPieceClick(a.value,s,o))}),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();v(1),Ti("id","piece_",i.value,"_",t.toString(),"_",n,""),y("ngClass",s.getSidePieceClasses(t,n)),k("transform","rotate("+180*(s.role.value+i.value)+" "+s.CENTER+" "+s.CENTER+")")("r",s.getPieceRadius(t))("cx",s.getRemainingPieceCenterCoord(i,n).x)("cy",s.getRemainingPieceCenterCoord(i,n).y)}}function i9t(r,e){if(1&r&&(A(),E(0,"g",null,4),T(2,r9t,2,8,"g",1),S()),2&r){const t=e.$implicit,n=p();v(2),y("ngForOf",n.getRemainingPieces(t))}}function s9t(r,e){if(1&r){const t=pe();A(),E(0,"circle",8),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onBoardClick(i,s))}),S()}if(2&r){const t=e.$implicit,n=p().index,i=p().index,s=p();y("ngClass",s.getPieceClasses(t)),k("r",s.getPieceRadius(t))("cx",s.getPieceCenter(n))("cy",s.getPieceCenter(i))}}function o9t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",6),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onBoardClick(s,o))}),S(),T(2,s9t,1,4,"circle",7),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","click_",n,"_",i,""),y("ngClass",s.getRectClasses(n,i)),k("x",s.SPACE_SIZE*n+s.STROKE_WIDTH)("y",s.SPACE_SIZE*i+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngForOf",s.getListPieces(t))}}function a9t(r,e){if(1&r&&(A(),E(0,"g"),T(1,o9t,3,8,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function c9t(r,e){if(1&r){const t=pe();A(),E(0,"rect",9),U("click",function(){te(t);const i=p();return ne(i.onBoardClick(i.chosenCoord.get().x,i.chosenCoord.get().y))}),S()}if(2&r){const t=p();ye("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),k("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let l9t=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"CENTER",this.getPieceCenter(1)),u(this,"UPLEFT",-(this.SPACE_SIZE+.5*this.STROKE_WIDTH)),u(this,"WIDTH",5*this.SPACE_SIZE+3*this.STROKE_WIDTH),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenPiece",g.empty()),u(this,"chosenPieceIndex",void 0),u(this,"remainingPieceCenterCoords",new un),this.rules=ou.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Qft(this.rules,"EncapsuleMinimax")],this.encoder=p2.encoder,this.tutorial=(new tce).tutorial,this.updateBoard()}updateBoard(){const n=this.getState();this.board=n.getCopiedBoard();const i=this.node.move;this.calculateLeftPieceCoords(),i.isPresent()?(this.lastLandingCoord=g.of(i.get().landingCoord),this.lastStartingCoord=i.get().startingCoord):(this.lastLandingCoord=g.empty(),this.lastStartingCoord=g.empty())}getListPieces(n){return n.toList()}getRemainingPieces(n){return this.getState().getRemainingPiecesOfPlayer(n)}onBoardClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=g.of(a),s.chosenPiece.isPresent()){const l=p2.ofDrop(s.chosenPiece.get(),a);return s.chooseMove(l)}return!1===c.getPieceAt(a).belongsTo(c.getCurrentPlayer())?s.cancelMove(Nd.INVALID_PIECE_SELECTED()):b.SUCCESS}if(s.chosenCoord.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const l=p2.ofMove(s.chosenCoord.get(),a);return s.chooseMove(l)}})()}cancelMoveAttempt(){this.chosenCoord=g.empty(),this.chosenPiece=g.empty(),this.chosenPieceIndex=g.empty()}onPieceClick(n,i,s){var o=this;return P(function*(){const a="#piece_"+n+"_"+i.toString()+"_"+s,c=o.canUserPlay(a);return c.isFailure()?o.cancelMove(c.getReason()):!1===o.getState().isDroppable(i)?o.cancelMove(Nd.NOT_DROPPABLE()):o.chosenCoord.isAbsent()?(o.chosenPiece.equalsValue(i)&&o.chosenPieceIndex.equalsValue(s)?(o.chosenPiece=g.empty(),o.chosenPieceIndex=g.empty()):(o.chosenPiece=g.of(i),o.chosenPieceIndex=g.of(s)),b.SUCCESS):o.cancelMove(Nd.END_YOUR_MOVE())})()}getRectClasses(n,i){return this.isSelected(n,i)?"moved-fill":""}isSelected(n,i){const s=new C(n,i);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(n){return[this.getPieceStrokeClass(n)]}getPieceCenter(n){return this.SPACE_SIZE*n+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(n){const i=n.getPlayer();return Ve(i.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+i.value+"-stroke"}getPieceRadius(n){switch(n.getSize()){case I1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case I1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return K.expectToBe(n.getSize(),I1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(n,i){const s=this.getPieceClasses(n);return this.isSelectedPiece(n)&&this.chosenPieceIndex.equalsValue(i)&&s.push("selected-stroke"),s}isSelectedPiece(n){return this.chosenPiece.equalsValue(n)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new un;for(const n of I.PLAYERS){const i=[],s=this.getRemainingPieces(n);for(let o=0;o<s.length;o++){let a,c=0,l=0;o<=2?(a=new C(2-o,3),l=this.STROKE_WIDTH):(a=new C(-1,5-o),c=-this.STROKE_WIDTH);const f=this.getPieceCenter(a.x),d=this.getPieceCenter(a.y);i.push(new C(f+c,d+l))}this.remainingPieceCenterCoords.set(n,i)}}getRemainingPieceCenterCoord(n,i){return this.remainingPieceCenterCoords.get(n).get()[i]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-encapsule"]],features:[Je],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,i9t,3,1,"g",1),E(2,"g",null,2),T(4,a9t,2,1,"g",1),T(5,c9t,1,6,"rect",3),S()()),2&n&&(k("viewBox",i.UPLEFT+" "+i.UPLEFT+" "+i.WIDTH+" "+i.WIDTH),v(1),y("ngForOf",i.Player.PLAYERS),v(3),y("ngForOf",i.board),v(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),hn=(()=>{class r extends F1{static getInitialState(){const t=X.NONE,n=X.ZERO,i=X.ONE;return new r([[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[i,i,i,i,i,i,i,i,i,i,i,i,i,i],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[n,n,n,n,n,n,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}count(t,n){let i=0;for(let s=0;s<14;s++)this.board[n][s]===t&&i++;return i}doesOwnPiece(t){for(const n of this.getCoordsAndContents())if(n.content===t)return!0;return!1}}return u(r,"WIDTH",14),u(r,"HEIGHT",12),r})();var nce;class Go extends Mr{constructor(e,t,n,i,s){super(e,t),u(this,"movedPieces",void 0),u(this,"stepSize",void 0),u(this,"direction",void 0),this.movedPieces=n,this.stepSize=i,this.direction=s,K.assert(hn.isOnBoard(this.coord),"Illegal coord outside of board "+this.coord.toString()+"."),K.assert(n>0,"Must select minimum one piece (got "+n+")."),K.assert(i>0,"Step size must be minimum one (got "+i+")."),K.assert(i<=n,"Cannot move a phalanx further than its size (got step size "+i+" for "+n+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&this.movedPieces===e.movedPieces&&this.stepSize===e.stepSize&&this.direction.equals(e.direction)}}nce=Go,u(Go,"encoder",Ie.tuple([C.encoder,Ie.identity(),Ie.identity(),Me.encoder],r=>[r.coord,r.movedPieces,r.stepSize,r.direction],r=>new nce(r[0].x,r[0].y,r[1],r[2],r[3])));let Uo=(()=>{class r{}return u(r,"PHALANX_IS_LEAVING_BOARD",()=>$localize`The move distance of your phalanx puts it out of the board.`),u(r,"SOMETHING_IN_PHALANX_WAY",()=>$localize`There is something in the way of your phalanx.`),u(r,"PHALANX_SHOULD_BE_GREATER_TO_CAPTURE",()=>$localize`Your phalanx must be bigger than the one you are capturing.`),u(r,"SQUARE_NOT_ALIGNED_WITH_SELECTED",()=>$localize`This square is not aligned with the selected piece.`),u(r,"SINGLE_PIECE_MUST_MOVE_BY_ONE",()=>$localize`A single piece can only move by one square.`),u(r,"SINGLE_PIECE_CANNOT_CAPTURE",()=>$localize`A single piece cannot make a capture.`),u(r,"SQUARE_NOT_ALIGNED_WITH_PHALANX",()=>$localize`This square is not aligned with the direction of the phalanx.`),u(r,"PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD",()=>$localize`A phalanx can't contain pieces outside of the board.`),u(r,"PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE",()=>$localize`A phalanx cannot contain an empty square.`),u(r,"PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE",()=>$localize`A phalanx cannot contain a piece of the opponent.`),r})();class Vi extends jn{static get(){return Vi.singleton.isAbsent()&&(Vi.singleton=g.of(new Vi)),Vi.singleton.get()}constructor(){super(hn)}static isLegal(e,t){const n=this.getPhalanxValidity(t,e);if(n.isFailure())return se.failure(n.getReason());const i=this.getLandingStatus(t,e);if(i.isFailure())return i;const s=He.copyBiArray(i.get()),o=t.getCurrentOpponent(),a=Vi.getCaptureValidity(t,s,e,o);return a.isFailure()?a:se.success(a.get())}static getPhalanxValidity(e,t){let n=t.coord,i=0;const s=e.getCurrentOpponent();for(;i<t.movedPieces;){if(!1===hn.isOnBoard(n))return b.failure(Uo.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=e.getPieceAt(n);if(o===X.NONE)return b.failure(Uo.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===s)return b.failure(Uo.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),i++}return b.SUCCESS}static getLandingStatus(e,t){const n=e.getCopiedBoard(),i=e.getCurrentPlayer();let s=t.coord,o=t.coord.getNext(t.direction,t.movedPieces),a=0;for(;a+1<t.stepSize;){if(n[s.y][s.x]=X.NONE,n[o.y][o.x]=i,!1===hn.isOnBoard(o))return se.failure(Uo.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(o).isPlayer())return se.failure(Uo.SOMETHING_IN_PHALANX_WAY());a++,o=o.getNext(t.direction,1),s=s.getNext(t.direction,1)}return!1===hn.isOnBoard(o)?se.failure(Uo.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(o)===i?se.failure(Le.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(n[s.y][s.x]=X.NONE,n[o.y][o.x]=i,se.success(n))}static getCaptureValidity(e,t,n,i){let s=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),o=0;for(;hn.isOnBoard(s)&&e.getPieceAt(s)===i;){if(o>0&&(t[s.y][s.x]=X.NONE),o++,o>=n.movedPieces)return se.failure(Uo.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());s=s.getNext(n.direction,1)}return se.success(t)}isLegal(e,t){return Vi.isLegal(e,t)}applyLegalMove(e,t,n){return new hn(n,t.turn+1)}getGameStatus(e){const t=e.gameState,n=t.count(I.ZERO,0),i=t.count(I.ONE,hn.HEIGHT-1);if(t.turn%2==0){if(n>i)return ve.ZERO_WON}else if(i>n)return ve.ONE_WON;return!1===t.doesOwnPiece(I.ZERO)?ve.ONE_WON:!1===t.doesOwnPiece(I.ONE)?ve.ZERO_WON:ve.ONGOING}}u(Vi,"singleton",g.empty());class Id extends uo{static getListMoves(e){const t=e.gameState.getCurrentPlayer(),n=e.gameState.getCurrentOpponent(),i=X.NONE;let s=[];const o=e.gameState;for(const a of o.getCoordsAndContents()){const c=a.coord;if(a.content===t){let l;for(const f of Me.DIRECTIONS){let d=1,m=c.getNext(f,1);for(;hn.isOnBoard(m)&&o.getPieceAt(m)===t;)d+=1,m=m.getNext(f,1);let M=1;for(;hn.isOnBoard(m)&&M<=d&&o.getPieceAt(m)===i;)l=new Go(c.x,c.y,d,M,f),s=this.addMove(s,l,o),M++,m=m.getNext(f,1);hn.isOnBoard(m)&&M<=d&&o.getPieceAt(m)===n&&(l=new Go(c.x,c.y,d,M,f),s=this.addMove(s,l,o))}}}return s}static addMove(e,t,n){return Vi.isLegal(t,n).isSuccess()&&e.push(t),e}getListMoves(e){const t=Id.getListMoves(e);return He.sortByDescending(t,n=>n.stepSize),t}getBoardValue(e){const t=Vi.get().getGameStatus(e);return t.isEndGame?t.toBoardValue():new an(this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){const t=13*hn.WIDTH*11;let o=0;for(let a=0;a<hn.HEIGHT;a++){let c=0;const l=[0,0];for(let f=0;f<hn.WIDTH;f++){const d=new C(f,a),m=e.getPieceAt(d);if(m.isPlayer()){const M=m.getScoreModifier();o+=t*M,l[m.value]=M,c+=M;for(const w of[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]){let L=d.getNext(w,1);for(;hn.isOnBoard(L)&&e.getPieceAt(L)===m;)o+=1*M,L=L.getNext(w,1)}}}0!==c&&(o+=Math.abs(c)/c*2),o+=1*l.reduce((f,d)=>f+d)}return o}}class u9t extends uo{getListMoves(e){const t=Id.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return He.sortByDescending(e,n=>n.movedPieces),e.length>40?e.filter(i=>!!this.moveIsCapture(i,t)||i.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}getBoardValue(e){const t=Vi.get().getGameStatus(e);return t.isEndGame?t.toBoardValue():new an(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){const n=28*hn.WIDTH+1,s=444*n+1;let o=0;for(const a of e.getCoordsAndContents()){const c=a.coord,l=a.content;if(l.isPlayer()){let f,d;l===I.ZERO?(f=hn.HEIGHT-c.y,d=[Me.UP_LEFT,Me.UP,Me.UP_RIGHT]):(f=c.y+1,d=[Me.DOWN_LEFT,Me.DOWN,Me.DOWN_RIGHT]);const m=l.getScoreModifier();o+=f*m,o+=s*m;for(const M of d){let w=c.getNext(M,1);for(;hn.isOnBoard(w)&&e.getPieceAt(w)===l;)o+=m*n,w=w.getNext(M,1)}}}return o}}class f9t extends Id{constructor(...e){super(...e),u(this,"DOMINANCE_FACTOR",20),u(this,"DEFENSE_FACTOR",5),u(this,"TERRITORY_FACTOR",2),u(this,"OFFENSE_FACTOR",10),u(this,"CENTER_FACTOR",5),u(this,"MOBILITY_FACTOR",.12)}getDominance(e){let t=0;for(const n of e.getCoordsAndContents())n.content.isPlayer()&&(t+=n.content.getScoreModifier());return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let n=0;n<hn.WIDTH;n++)e.getPieceAtXY(n,hn.HEIGHT-1)===I.ZERO&&(t+=I.ZERO.getScoreModifier()),e.getPieceAtXY(n,0)===I.ONE&&(t+=I.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(const n of e.getCoordsAndContents()){const i=n.content;if(i.isPlayer()){for(let s=-1;s<=1;s++)for(let o=-1;o<=1;o++){const a=n.coord.getNext(new C(s,o),1);if(hn.isOnBoard(a)){const c=e.getPieceAt(a);(c===i||c===X.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let n=0;n<hn.WIDTH;n++)e.getPieceAtXY(n,0)===I.ZERO&&(t+=I.ZERO.getScoreModifier()),e.getPieceAtXY(n,hn.HEIGHT-1)===I.ONE&&(t+=I.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;const n=(hn.WIDTH-1)/2;for(const i of e.getCoordsAndContents()){const s=i.content;s.isPlayer()&&(t+=s.getScoreModifier()*Math.abs(i.coord.x-n))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,n=0,i=0;for(const s of e.getCoordsAndContents()){const o=s.coord,a=s.content;if(a.isPlayer())for(const c of Me.DIRECTIONS){let l=1,f=o.getNext(c,1);for(;hn.isOnBoard(f)&&e.getPieceAt(f)===a;)l+=1,f=f.getNext(c,1);let d=1;for(;hn.isOnBoard(f)&&d<=l&&e.getPieceAt(f)===X.NONE;)d++,f=f.getNext(c,1);t+=d*d*a.getScoreModifier(),a===I.ZERO?n=Math.max(n,d):a===I.ONE&&(i=Math.max(i,d))}}return(t+n*I.ZERO.getScoreModifier()+i*I.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(e){const t=e.gameState,n=Vi.get().getGameStatus(e);if(n.isEndGame)return n.toBoardValue();const i=this.getDominance(t),s=this.getDefense(t),o=this.getTerritory(t),a=this.getCenter(t),c=this.getOffense(t),l=this.getMobility(t);return new an(i+s+o+a+c+l)}}const O=X.NONE,B1=X.ZERO,n1=X.ONE;class rce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,hn.getInitialState()),W.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new hn([[O,O,O,O,O,B1,O,O,n1,n1,n1,n1,n1,n1],[O,O,O,O,O,B1,O,O,O,O,O,O,n1,n1],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,n1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,B1,B1,B1,B1,O,O,O]],0)),W.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new hn([[O,O,O,O,O,B1,O,O,O,O,n1,n1,n1,n1],[O,O,O,O,O,B1,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,n1,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,n1,n1,O,O,O,B1,B1,O,B1,B1,B1,B1]],1)),W.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,hn.getInitialState(),new Go(0,10,1,1,Me.UP),(t,n,i)=>1===t.movedPieces?b.SUCCESS:b.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),W.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,hn.getInitialState(),new Go(0,11,2,1,Me.UP),(t,n,i)=>t.movedPieces>1?b.SUCCESS:b.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),W.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new hn([[O,O,O,O,O,O,O,O,n1,n1,n1,n1,n1,n1],[O,O,O,O,O,O,n1,O,O,O,O,O,O,O],[O,O,O,O,O,n1,O,O,O,O,O,O,O,O],[O,O,n1,O,n1,O,O,O,O,O,O,O,O,O],[O,O,n1,n1,O,O,O,O,O,O,O,O,O,O],[O,O,n1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,O,O,O,O,O,O,O],[O,O,B1,O,O,O,O,O,O,O,O,O,O,O],[O,O,B1,O,O,O,O,n1,O,O,O,O,O,O],[O,O,B1,O,O,O,O,O,O,O,O,O,O,O],[O,O,B1,O,O,O,O,O,O,O,O,O,O,O],[O,O,O,O,O,O,O,B1,B1,B1,B1,B1,B1,B1]],0),[new Go(2,10,4,2,Me.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)])}}function d9t(r,e){if(1&r){const t=pe();A(),E(0,"circle",4),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onClick(i,s))}),S()}if(2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClasses(t,n)),k("cx",i.SPACE_SIZE*t+i.STROKE_WIDTH+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.STROKE_WIDTH+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function h9t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",2),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),S(),T(2,d9t,1,4,"circle",3),S()}if(2&r){const t=e.index,n=p().index,i=p();v(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("x",i.SPACE_SIZE*t+i.STROKE_WIDTH)("y",i.SPACE_SIZE*n+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngIf",i.board[n][t]!==i.NONE)}}function p9t(r,e){if(1&r&&(A(),E(0,"g"),T(1,h9t,3,8,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function g9t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",5),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p();v(1),k("x",n.SPACE_SIZE*t.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*t.y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let m9t=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"NONE",X.NONE),u(this,"firstPiece",g.empty()),u(this,"validExtensions",[]),u(this,"phalanxValidLandings",[]),u(this,"lastPiece",g.empty()),u(this,"phalanxDirection",g.empty()),u(this,"phalanxMiddles",[]),u(this,"moveds",[]),u(this,"capturedCoords",[]),this.hasAsymmetricBoard=!0,this.rules=Vi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Id(this.rules,"Normal"),new u9t(this.rules,"Positional"),new f9t(this.rules,"Attack")],this.encoder=Go.encoder,this.tutorial=(new rce).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=g.empty(),this.lastPiece=g.empty(),this.hidePreviousMove(),this.board=this.getState().getCopiedBoard()}showLastMove(n){let i=n.coord;this.moveds=[i];for(let a=1;a<n.stepSize+n.movedPieces;a++)i=i.getNext(n.direction,1),this.moveds.push(i);const s=this.node.mother.get(),o=s.gameState.getCurrentOpponent();for(;hn.isOnBoard(i)&&s.gameState.getPieceAt(i)===o;)this.capturedCoords.push(i),i=i.getNext(n.direction,1)}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);return o.isFailure()?s.cancelMove(o.getReason()):s.firstPiece.isAbsent()?s.firstClick(n,i):s.lastPiece.isAbsent()?s.secondClick(n,i):s.thirdClick(n,i)})()}firstClick(n,i){var s=this;return P(function*(){const o=s.getState().getCurrentOpponent(),a=s.getState().getCurrentPlayer();switch(s.board[i][n]){case a:return s.firstPiece=g.of(new C(n,i)),s.validExtensions=s.getValidExtensions(a),s.phalanxValidLandings=s.getPhalanxValidLandings(),b.SUCCESS;case o:return s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE());default:return K.expectToBe(s.board[i][n],X.NONE),s.cancelMove(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(n){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(n):this.getFirstPieceExtensions(n)}getFirstPieceExtensions(n){const i=[];for(const s of Me.DIRECTIONS){let o=this.firstPiece.get().getNext(s,1);for(;hn.isOnBoard(o)&&this.board[o.y][o.x]===n;)i.push(o),o=o.getNext(s,1)}return i}getPhalanxValidExtensions(n){let i=Me.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(i,1),o=this.getExtensionsToward(s,i,n);i=i.getOpposite();const a=this.firstPiece.get().getNext(i,1),c=this.getExtensionsToward(a,i,n);return o.concat(c)}getExtensionsToward(n,i,s){const o=[];for(;hn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o.push(n),n=n.getNext(i,1);return o}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const n=this.firstPiece.get(),i=this.lastPiece.get(),s=Math.abs(n.x-i.x),o=Math.abs(n.y-i.y),a=Math.max(s,o)+1;let c=Me.factory.fromMove(n,i).get();const l=i.getNext(c,1),f=this.getLandingsToward(l,c,a);c=c.getOpposite();const d=n.getNext(c,1);return this.getLandingsToward(d,c,a).concat(f)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const n=[];for(const i of Me.DIRECTIONS){const s=this.firstPiece.get().getNext(i,1);hn.isOnBoard(s)&&this.board[s.y][s.x]===X.NONE&&n.push(s)}return n}getLandingsToward(n,i,s){const o=this.getState().getCurrentPlayer(),a=this.getState().getCurrentOpponent(),c=[];for(;hn.isOnBoard(n)&&c.length<s&&this.board[n.y][n.x]!==o;){if(this.board[n.y][n.x]===a)return this.getPhalanxLength(n,i,a)<s&&c.push(n),c;c.push(n),n=n.getNext(i,1)}return c}getPhalanxLength(n,i,s){let o=0;for(;hn.isOnBoard(n)&&this.board[n.y][n.x]===s;)o++,n=n.getNext(i,1);return o}cancelMoveAttempt(){this.firstPiece=g.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=g.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(n,i){var s=this;return P(function*(){const o=new C(n,i),a=s.firstPiece.get();if(o.equals(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentOpponent(),l=s.getState().getCurrentPlayer();if(!1===o.isAlignedWith(a))return s.cancelMove(Uo.SQUARE_NOT_ALIGNED_WITH_SELECTED());const f=o.getDistance(a),d=a.getDirectionToward(o).get();switch(s.board[i][n]){case X.NONE:return 1===f?s.chooseMove(new Go(a.x,a.y,1,1,d)):s.cancelMove(Uo.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(Uo.SINGLE_PIECE_CANNOT_CAPTURE());default:K.expectToBe(s.board[i][n],l);const m=new Go(a.x,a.y,f,1,d),M=s.getState(),w=Vi.getPhalanxValidity(M,m);return w.isFailure()?s.cancelMove(w.getReason()):(s.lastPiece=g.of(o),s.validExtensions=s.getValidExtensions(l),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=a.getCoordsToward(o),s.phalanxDirection=g.of(d),b.SUCCESS)}})()}thirdClick(n,i){var s=this;return P(function*(){const o=s.getState().getCurrentPlayer(),a=new C(n,i);if(s.firstPiece.equalsValue(a))return s.moveFirstPiece(o);if(s.lastPiece.equalsValue(a))return s.moveLastPiece(o);const c=s.firstPiece.get(),l=s.lastPiece.get();if(!1===a.isAlignedWith(c))return s.cancelMove(Uo.SQUARE_NOT_ALIGNED_WITH_PHALANX());let f=Me.factory.fromMove(c,l).get();const d=Me.factory.fromMove(c,a).get();if(f===d.getOpposite()&&(s.firstPiece=g.of(l),s.lastPiece=g.of(c),f=d),f!==d)return s.cancelMove(Uo.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[i][n]===o)return s.thirdClickOnPlayerPiece(a,f,o);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,M=s.lastPiece.get().getDistance(a),w=new Go(s.firstPiece.get().x,s.firstPiece.get().y,m,M,f);return s.chooseMove(w)}})()}thirdClickOnPlayerPiece(n,i,s){var o=this;return P(function*(){o.lastPiece=g.of(n);const a=o.firstPiece.get().getDistance(n)+1,c=new Go(o.firstPiece.get().x,o.firstPiece.get().y,a,1,i),l=Vi.getPhalanxValidity(o.node.gameState,c);return l.isFailure()?o.cancelMove(l.getReason()):(o.phalanxMiddles=o.firstPiece.get().getCoordsToward(o.lastPiece.get()),o.validExtensions=o.getValidExtensions(s),o.phalanxValidLandings=o.getPhalanxValidLandings(),b.SUCCESS)})()}moveFirstPiece(n){var i=this;return P(function*(){return i.firstPiece=g.of(i.firstPiece.get().getNext(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?yield i.moveOnlyPiece(n):(i.phalanxMiddles=i.phalanxMiddles.slice(1),i.validExtensions=i.getPhalanxValidExtensions(n)),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}moveLastPiece(n){var i=this;return P(function*(){return i.lastPiece=g.of(i.lastPiece.get().getPrevious(i.phalanxDirection.get(),1)),i.firstPiece.equals(i.lastPiece)?i.moveOnlyPiece(n):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getPhalanxValidExtensions(n),i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS)})()}moveOnlyPiece(n){var i=this;return P(function*(){return i.lastPiece=g.empty(),i.validExtensions=i.getFirstPieceExtensions(n),i.phalanxDirection=g.empty(),i.phalanxMiddles=[],i.phalanxValidLandings=i.getPhalanxValidLandings(),b.SUCCESS})()}getPieceClasses(n,i){const s=this.getPlayerClass(this.board[i][n]);return this.getPieceStrokeClasses(n,i).concat([s])}getPieceStrokeClasses(n,i){const s=new C(n,i);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(o=>o.equals(s))?["selected-stroke"]:[]}getRectClasses(n,i){const s=new C(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:this.moveds.some(o=>o.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const n=[],s=this.getState().getCurrentPlayer();for(let o=0;o<this.board.length;o++)for(let a=0;a<this.board[o].length;a++)this.board[o][a]===s&&n.push(new C(a,o));return n}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-epaminondas"]],features:[Je],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,p9t,2,1,"g",1),T(2,g9t,2,4,"g",1),S()),2&n&&(k("transform",i.rotation),v(1),y("ngForOf",i.board),v(1),y("ngForOf",i.getHighlightedCoords()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var HL,ice,sce;class V2{constructor(e){u(this,"capturedSpaces",void 0),K.assert(e.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),K.assert(go.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=He.copyImmutableArray(e).sort((n,i)=>n.x===i.x?(K.assert(n.y!==i.y,"Cannot create a GipfCapture with duplicate coords"),n.y>i.y?1:-1):n.x>i.x?1:-1);let t=g.empty();for(const n of this.capturedSpaces)K.assert(t.isAbsent()||1===t.get().getDistance(n),"Cannot create a GipfCapture with non-consecutive coords"),t=g.of(n)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return go.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!1===this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}HL=V2,u(V2,"encoder",Ie.tuple([Ie.list(C.encoder)],r=>[r.capturedSpaces],r=>new HL(r[0]))),u(V2,"listEncoder",Ie.list(HL.encoder));class Wo{constructor(e,t){u(this,"coord",void 0),u(this,"direction",void 0),this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}ice=Wo,u(Wo,"encoder",Ie.tuple([C.encoder,g.getEncoder(be.encoder)],r=>[r.coord,r.direction],r=>new ice(r[0],r[1])));class Aa extends Li{constructor(e,t,n){super(),u(this,"placement",void 0),u(this,"initialCaptures",void 0),u(this,"finalCaptures",void 0),this.placement=e,this.initialCaptures=t,this.finalCaptures=n}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===He.compareArray(this.initialCaptures,e.initialCaptures)||!1===He.compareArray(this.finalCaptures,e.finalCaptures))}}sce=Aa,u(Aa,"encoder",Ie.tuple([Wo.encoder,V2.listEncoder,V2.listEncoder],r=>[r.placement,r.initialCaptures,r.finalCaptures],r=>new sce(r[0],r[1],r[2])));class qo extends RL{static getInitialState(){const e=Ce.EMPTY,t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE;return new qo([[t,t,t,i,e,e,n],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[n,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,n,t,t,t]],0,[12,12],[0,0])}constructor(e,t,n,i){super(t,e,7,7,[3,2,1],Ce.EMPTY),u(this,"sidePieces",void 0),u(this,"capturedPieces",void 0),this.sidePieces=n,this.capturedPieces=i}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&He.compareTable(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const n=He.copyBiArray(this.board);return n[e.y][e.x]=t,new qo(n,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Ce.UNREACHABLE}}let jo=(()=>{class r{}return u(r,"CAPTURE_MUST_BE_ALIGNED",()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`),u(r,"INVALID_CAPTURED_PIECES",()=>$localize`You must select a valid capture that contains 4 pieces or more.`),u(r,"MISSING_CAPTURES",()=>$localize`There are still possible captures to be done.`),u(r,"PLACEMENT_NOT_ON_BORDER",()=>$localize`Pieces must be inserted in spaces on the edge of the board.`),u(r,"INVALID_PLACEMENT_DIRECTION",()=>$localize`You must select a valid placement direction.`),u(r,"PLACEMENT_WITHOUT_DIRECTION",()=>$localize`You must select a placement with a direction alongside the insertion space.`),u(r,"PLACEMENT_ON_COMPLETE_LINE",()=>$localize`You cannot place a piece on a complete line.`),u(r,"AMBIGUOUS_CAPTURE_COORD",()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`),u(r,"NO_DIRECTIONS_AVAILABLE",()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`),r})();class Qt extends jn{static get(){return Qt.singleton.isAbsent()&&(Qt.singleton=g.of(new Qt)),Qt.singleton.get()}constructor(){super(qo)}applyLegalMove(e,t,n){return new qo(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}static applyCaptures(e,t){let n=t;return e.forEach(i=>{n=Qt.applyCapture(i,n)}),n}static applyCapture(e,t){const n=t.getCurrentPlayer();let i=t;const s=[t.sidePieces[0],t.sidePieces[1]],o=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(a=>{const c=t.getPieceAt(a);i=i.setAt(a,Ce.EMPTY),c.is(n)?s[n.value]+=1:o[n.value]+=1}),new qo(i.board,t.turn,s,o)}static getPlacements(e){const t=[];return Dr.INSTANCE.getAllBorders(e).forEach(n=>{e.getPieceAt(n)===Ce.EMPTY?t.push(new Wo(n,g.empty())):Qt.getAllDirectionsForEntrance(e,n).forEach(i=>{!1===Qt.isLineComplete(e,n,i)&&t.push(new Wo(n,g.of(i)))})}),t}static isLineComplete(e,t,n){return Qt.nextGapInLine(e,t,n).isAbsent()}static nextGapInLine(e,t,n){for(let i=t;e.isOnBoard(i);i=i.getNext(n))if(e.getPieceAt(i)===Ce.EMPTY)return g.of(i);return g.empty()}static applyPlacement(e,t){const n=t.getCurrentPlayer();let i=t,s=Ce.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const a=e.coord;if(t.getPieceAt(a)!==Ce.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");i=i.setAt(a,s)}else for(let a=e.coord;i.isOnBoard(a)&&s!==Ce.EMPTY;a=a.getNext(e.direction.get())){const c=t.getPieceAt(a);i=i.setAt(a,s),s=c}const o=[t.sidePieces[0],t.sidePieces[1]];return o[n.value]-=1,new qo(i.board,t.turn,o,t.capturedPieces)}getPiecesMoved(e,t,n){const i=Qt.applyCaptures(t,e);if(n.direction.isAbsent())return[n.coord];{const s=n.direction.get(),o=[];o.push(n.coord);let a=n.coord.getNext(s);for(;i.isOnBoard(a)&&i.getPieceAt(a)!==Ce.EMPTY;)o.push(a),a=a.getNext(s);return Ve(i.isOnBoard(a)&&i.getPieceAt(a)===Ce.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(a),o}}static getAllDirectionsForEntrance(e,t){if(Dr.INSTANCE.isTopLeftCorner(e,t))return[be.RIGHT,be.DOWN,be.UP_RIGHT];if(Dr.INSTANCE.isTopCorner(e,t))return[be.DOWN,be.DOWN_LEFT,be.RIGHT];if(Dr.INSTANCE.isTopRightCorner(e,t))return[be.DOWN_LEFT,be.DOWN,be.LEFT];if(Dr.INSTANCE.isBottomLeftCorner(e,t))return[be.UP_RIGHT,be.UP,be.RIGHT];if(Dr.INSTANCE.isBottomCorner(e,t))return[be.UP,be.LEFT,be.UP_RIGHT];if(Dr.INSTANCE.isBottomRightCorner(e,t))return[be.LEFT,be.UP,be.DOWN_LEFT];if(Dr.INSTANCE.isOnTopLeftBorder(e,t))return[be.RIGHT,be.DOWN];if(Dr.INSTANCE.isOnLeftBorder(e,t))return[be.UP_RIGHT,be.RIGHT];if(Dr.INSTANCE.isOnBottomLeftBorder(e,t))return[be.UP,be.UP_RIGHT];if(Dr.INSTANCE.isOnBottomRightBorder(e,t))return[be.LEFT,be.UP];if(Dr.INSTANCE.isOnRightBorder(e,t))return[be.LEFT,be.DOWN_LEFT];if(Dr.INSTANCE.isOnTopRightBorder(e,t))return[be.DOWN_LEFT,be.DOWN];throw new Error("not a border")}isLegal(e,t){const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=Qt.applyCaptures(e.initialCaptures,t),s=this.noMoreCapturesValidity(i);if(s.isFailure())return s.toOtherFallible();const o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toOtherFallible();const a=Qt.applyPlacement(e.placement,i),c=this.capturesValidity(a,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const l=Qt.applyCaptures(e.finalCaptures,a),f=this.noMoreCapturesValidity(l);return f.isFailure()?f.toOtherFallible():se.success(l)}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=Qt.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer(),i=Qt.getLinePortionWithFourPiecesOfPlayer(e,n,t.getLine());if(i.isAbsent())return b.failure(jo.CAPTURE_MUST_BE_ALIGNED());const s=i.get();return Qt.getCapturable(e,s).equals(t)?b.SUCCESS:b.failure(jo.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=Qt.getLinePortionWithFourPiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}static getLinePortionWithFourPiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let a=s;for(let c=s;e.isOnBoard(c);c=c.getNext(o))if(e.getPieceAt(c).is(t)?(0===i&&(a=c),i+=1):i=0,4===i)return g.of({0:a,1:c,2:o});return g.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(jo.MISSING_CAPTURES())}placementValidity(e,t){const n=this.placementCoordValidity(e,t.coord);if(n.isFailure())return n;if(e.getPieceAt(t.coord)!==Ce.EMPTY){if(t.direction.isAbsent())return b.failure(jo.PLACEMENT_WITHOUT_DIRECTION());if(Qt.isLineComplete(e,t.coord,t.direction.get()))return b.failure(jo.PLACEMENT_ON_COMPLETE_LINE());for(const i of Qt.getAllDirectionsForEntrance(e,t.coord))if(i===t.direction.get())return b.SUCCESS;return b.failure(jo.INVALID_PLACEMENT_DIRECTION())}return b.SUCCESS}placementCoordValidity(e,t){return Dr.INSTANCE.isOnBorder(e,t)?b.SUCCESS:b.failure(jo.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const n=[],i=t[0],s=t[1],o=t[2],a=o.getOpposite();let c=i.getNext(a);for(;e.isOnBoard(c)&&e.getPieceAt(c)!==Ce.EMPTY;)n.push(c),c=c.getNext(a);for(let l=i;!1===l.equals(s);l=l.getNext(o))n.push(l);for(let l=s;e.isOnBoard(l)&&e.getPieceAt(l)!==Ce.EMPTY;l=l.getNext(o))n.push(l);return new V2(n)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return Qt.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(i=>{n.push(Qt.getCapturable(e,i))}),n}static getPlayerScore(e,t){const n=e.getNumberOfPiecesToPlace(t);if(0===n&&0===Qt.getPossibleCaptures(e).length)return g.empty();const i=e.getNumberOfPiecesCaptured(t);return g.of(n+3*i)}static isGameOver(e){const t=Qt.getPlayerScore(e,I.ZERO),n=Qt.getPlayerScore(e,I.ONE);return t.isAbsent()||n.isAbsent()}getGameStatus(e){const t=e.gameState,n=Qt.getPlayerScore(t,I.ZERO),i=Qt.getPlayerScore(t,I.ONE);return n.isAbsent()?ve.ONE_WON:i.isAbsent()?ve.ZERO_WON:ve.ONGOING}}u(Qt,"singleton",g.empty());class kd extends Hr{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=kd.computeIntersections(e);let n=[[]];return e.forEach((i,s)=>{if(0===t[s].length)n.forEach(o=>{o.push(s)});else{const o=[],a=t[s].some(c=>c>s);for(const c of n)!0===c.some(f=>t[s].some(d=>f===d))?o.push(He.copyImmutableArray(c)):a?(o.push(He.copyImmutableArray(c)),c.push(s),o.push(He.copyImmutableArray(c))):(c.push(s),o.push(He.copyImmutableArray(c)));n=o}}),n.map(i=>i.map(s=>e[s]))}static computeIntersections(e){const t=[];return e.forEach((n,i)=>{t.push([]),e.forEach((s,o)=>{i!==o&&n.intersectsWith(s)&&t[i].push(o)})}),t}getMetrics(e){const t=e.gameState;return[Qt.getPlayerScore(t,I.ZERO).get(),Qt.getPlayerScore(t,I.ONE).get()]}getListMoves(e){return this.getListMoveFromState(e.gameState)}getListMoveFromState(e){const t=[];return Qt.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(n=>{const i=Qt.applyCaptures(n,e);Qt.getPlacements(i).forEach(s=>{const o=Qt.applyPlacement(s,i);this.getPossibleCaptureCombinations(o).forEach(a=>{const c=new Aa(s,n,a);t.push(c)})})}),t}getPossibleCaptureCombinations(e){const t=Qt.getPossibleCaptures(e);return kd.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class oce{constructor(e,t,n,i,s,o){u(this,"source",void 0),u(this,"destination",void 0),u(this,"x1",void 0),u(this,"y1",void 0),u(this,"x2",void 0),u(this,"y2",void 0),this.source=e,this.destination=t,this.x1=n,this.y1=i,this.x2=s,this.y2=o}}const Tn=Ce.UNREACHABLE,Ke=Ce.EMPTY,G1=Ce.ZERO,zc=Ce.ONE;class ace extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,qo.getInitialState()),W.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,qo.getInitialState(),new Aa(new Wo(new C(3,0),g.of(be.DOWN)),[],[]),$localize`Congratulations!`),W.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new qo([[Tn,Tn,Tn,G1,zc,Ke,Ke],[Tn,Tn,Ke,Ke,Ke,Ke,Ke],[Tn,Ke,Ke,Ke,Ke,Ke,Ke],[G1,G1,G1,Ke,Ke,Ke,Ke],[zc,Ke,Ke,Ke,Ke,Ke,Tn],[Ke,Ke,Ke,zc,Ke,Tn,Tn],[Ke,Ke,Ke,zc,Tn,Tn,Tn]],42,[8,8],[0,0]),[new Aa(new Wo(new C(0,3),g.of(be.RIGHT)),[],[new V2([new C(0,3),new C(1,3),new C(2,3),new C(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),W.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new qo([[Tn,Tn,Tn,Ke,Ke,Ke,Ke],[Tn,Tn,Ke,zc,Ke,Ke,Ke],[Tn,Ke,Ke,G1,Ke,Ke,Ke],[G1,G1,G1,zc,Ke,Ke,Ke],[Ke,Ke,Ke,G1,Ke,Ke,Tn],[Ke,Ke,Ke,G1,Ke,Tn,Tn],[Ke,Ke,Ke,zc,Tn,Tn,Tn]],42,[8,4],[2,3]),[new Aa(new Wo(new C(0,3),g.of(be.RIGHT)),[],[new V2([new C(3,1),new C(3,2),new C(3,3),new C(3,4),new C(3,5),new C(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),W.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new qo([[Tn,Tn,Tn,G1,Ke,Ke,G1],[Tn,Tn,Ke,G1,Ke,Ke,G1],[Tn,G1,G1,Ke,G1,zc,G1],[Ke,Ke,Ke,G1,Ke,Ke,G1],[Ke,Ke,Ke,G1,Ke,Ke,Tn],[G1,G1,G1,zc,zc,Tn,Tn],[Ke,Ke,Ke,G1,Tn,Tn,Tn]],42,[3,4],[2,3]),[new Aa(new Wo(new C(3,6),g.of(be.UP)),[new V2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new V2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new V2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)])]),new Aa(new Wo(new C(4,6),g.of(be.UP)),[new V2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new V2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)]),new V2([new C(3,0),new C(3,1),new C(3,2),new C(3,3),new C(3,4)])]),new Aa(new Wo(new C(3,6),g.of(be.UP)),[new V2([new C(6,0),new C(6,1),new C(6,2),new C(6,3)])],[new V2([new C(1,2),new C(2,2),new C(3,2),new C(4,2),new C(5,2)]),new V2([new C(0,5),new C(1,5),new C(2,5),new C(3,5),new C(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)])}}function _9t(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClass(t)),k("cx",n.getCenterAt(t).x)("cy",n.getCenterAt(t).y)("r",n.SPACE_SIZE)}}function v9t(r,e){if(1&r){const t=pe();A(),E(0,"g",10),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),F(1,"polygon",11),T(2,_9t,1,4,"circle",12),S()}if(2&r){const t=e.$implicit,n=p();ye("id","click_",t.x,"_",t.y,""),v(1),ye("id","space_",t.x,"_",t.y,""),y("ngClass",n.getSpaceClass(t)),k("points",n.getHexaPointsAt(t)),v(1),y("ngIf",n.isPiece(t))}}function C9t(r,e){if(1&r){const t=pe();A(),E(0,"polygon",16),U("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s))}),S()}if(2&r){const t=e.$implicit;k("points",p(2).getHexaPointsAt(t))}}function y9t(r,e){if(1&r&&(A(),E(0,"g",14),T(1,C9t,1,1,"polygon",15),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t.capturedSpaces)}}function M9t(r,e){if(1&r){const t=pe();A(),E(0,"line",17),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.destination))}),S()}if(2&r){const t=e.$implicit;k("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function E9t(r,e){if(1&r&&(A(),E(0,"g"),F(1,"circle",18),S()),2&r){const t=e.$implicit,n=p().$implicit,i=p();v(1),ye("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),k("cx",i.getRemainingPieceCx(n,t))("cy",i.getRemainingPieceCy(n))("r",.5*i.SPACE_SIZE)}}function S9t(r,e){if(1&r&&(A(),E(0,"g"),T(1,E9t,2,6,"g",8),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngForOf",n.getPlayerSidePieces(t))}}function P9t(r,e){if(1&r&&(A(),F(0,"line",19)),2&r){const t=p();k("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let T9t=(()=>{var r;class e extends Q5{constructor(n){super(n),u(this,"inserted",g.empty()),u(this,"arrows",[]),u(this,"captured",[]),u(this,"moved",[]),u(this,"hexagonWidth",this.SPACE_SIZE),u(this,"sharedHexagonX",Math.cos(30)*this.hexagonWidth*.5),u(this,"boardWidth",this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2),u(this,"boardHeight",7*this.hexagonWidth+4.5*this.STROKE_WIDTH),u(this,"movePhase",e.PHASE_PLACEMENT_COORD),u(this,"constructedState",void 0),u(this,"possibleCaptures",[]),u(this,"initialCaptures",[]),u(this,"placement",g.empty()),u(this,"placementEntrance",g.empty()),u(this,"finalCaptures",[]),this.hasAsymmetricBoard=!0,this.scores=g.of([0,0]),this.rules=Qt.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new kd(this.rules,"GipfMinimax")],this.encoder=Aa.encoder,this.tutorial=(new ace).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new J5(1.5*this.SPACE_SIZE,new C(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Dr.INSTANCE)}updateBoard(){this.cancelMoveAttempt()}showLastMove(n){if(this.inserted=g.empty(),n.placement.direction.isPresent()){const i=n.placement;this.inserted=g.of(this.arrowTowards(i.coord,i.direction.get()))}this.cancelMoveAttempt()}arrowTowards(n,i){const s=n.getNext(i.getOpposite()),o=this.getCenterAt(n),a=this.getCenterAt(s);return new oce(s,n,a.x,a.y,o.x,o.y)}markCapture(n){n.forEach(i=>{this.captured.push(i)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(n){const i=this.constructedState.getNumberOfPiecesToPlace(n),s=[];for(let o=0;o<i;o+=1)s.push(o);return s}isPiece(n){return this.getPiece(n)!==Ce.EMPTY}getPiece(n){return this.constructedState.getPieceAt(n)}onClick(n){var i=this;return P(function*(){const s=i.canUserPlay("#click_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());switch(i.movePhase){case e.PHASE_INITIAL_CAPTURE:case e.PHASE_FINAL_CAPTURE:return i.selectCapture(n);case e.PHASE_PLACEMENT_COORD:return i.selectPlacementCoord(n);default:return K.expectToBe(i.movePhase,e.PHASE_PLACEMENT_DIRECTION),i.selectPlacementDirectionOrPlacementCoord(n)}})()}selectCapture(n){var i=this;return P(function*(){const s=[];if(i.possibleCaptures.forEach(a=>{a.contains(n)&&s.push(a)}),s.length>1)return i.cancelMove(jo.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return i.cancelMove(jo.MISSING_CAPTURES());const o=s[0];return i.constructedState=Qt.applyCapture(o,i.constructedState),i.markCapture(o),i.possibleCaptures=Qt.getPossibleCaptures(i.constructedState),i.movePhase===e.PHASE_INITIAL_CAPTURE?(i.initialCaptures.push(o),0===i.possibleCaptures.length?i.moveToPlacementPhase():b.SUCCESS):(K.expectToBe(i.movePhase,e.PHASE_FINAL_CAPTURE),i.finalCaptures.push(o),0===i.possibleCaptures.length?i.tryMove(i.initialCaptures,i.placement.get(),i.finalCaptures):b.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=e.PHASE_PLACEMENT_COORD,b.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=Qt.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?e.PHASE_PLACEMENT_COORD:e.PHASE_INITIAL_CAPTURE,b.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var n=this;return P(function*(){return n.possibleCaptures=Qt.getPossibleCaptures(n.constructedState),0===n.possibleCaptures.length?n.tryMove(n.initialCaptures,n.placement.get(),n.finalCaptures):(n.movePhase=e.PHASE_FINAL_CAPTURE,b.SUCCESS)})()}computeArrows(n){this.arrows=[];for(const i of Qt.getAllDirectionsForEntrance(this.constructedState,n))if(!1===Qt.isLineComplete(this.constructedState,n,i)){const s=n.getNext(i),o=this.getCenterAt(n),a=this.getCenterAt(s);this.arrows.push(new oce(n,s,o.x,o.y,a.x,a.y))}}selectPlacementCoord(n){var i=this;return P(function*(){const s=i.rules.placementCoordValidity(i.constructedState,n);return s.isFailure()?i.cancelMove(s.getReason()):i.placementEntrance.equalsValue(n)?(i.cancelMoveAttempt(),b.SUCCESS):(i.placementEntrance=g.of(n),i.constructedState.getPieceAt(n)===Ce.EMPTY?i.selectPlacementDirection(g.empty()):(i.movePhase=e.PHASE_PLACEMENT_DIRECTION,i.computeArrows(n),0===i.arrows.length&&i.cancelMove(jo.NO_DIRECTIONS_AVAILABLE()),b.SUCCESS))})()}selectPlacementDirection(n){var i=this;return P(function*(){i.placement=g.of(new Wo(i.placementEntrance.get(),n));const s=i.rules.placementValidity(i.constructedState,i.placement.get());return s.isFailure()?i.cancelMove(s.getReason()):(i.arrows=[],i.constructedState=Qt.applyPlacement(i.placement.get(),i.constructedState),i.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(n){var i=this;return P(function*(){const s=i.placementEntrance.get();if(!1===s.isAlignedWith(n)||1!==s.getDistance(n))return i.selectPlacementCoord(n);const o=be.factory.fromMove(s,n);return i.selectPlacementDirection(o.toOptional())})()}tryMove(n,i,s){const o=new Aa(i,n,s);return this.chooseMove(o)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const n=this.node.move;if(n.isPresent()){const i=n.get(),s=this.getPreviousState();i.initialCaptures.forEach(o=>this.markCapture(o)),i.finalCaptures.forEach(o=>this.markCapture(o)),this.moved=this.rules.getPiecesMoved(s,i.initialCaptures,i.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=g.empty(),this.placement=g.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(n){return this.captured.some(i=>i.equals(n))?"captured-fill":this.moved.some(i=>i.equals(n))?"moved-fill":""}getPieceClass(n){const i=this.getPiece(n);return this.getPlayerClass(I.of(i.value))}getRemainingPieceCy(n){return n===I.ONE?25:this.boardHeight-25}getRemainingPieceCx(n,i){const s=20+i*this.SPACE_SIZE*.5;return n===I.ONE?s:this.boardWidth-(15+s)}}return r=e,u(e,"PHASE_INITIAL_CAPTURE",0),u(e,"PHASE_PLACEMENT_COORD",1),u(e,"PHASE_PLACEMENT_DIRECTION",2),u(e,"PHASE_FINAL_CAPTURE",3),u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-gipf"]],features:[Je],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),S(),E(4,"marker",3),F(5,"polygon",4),S()(),T(6,v9t,3,7,"g",5),T(7,y9t,2,1,"g",6),T(8,M9t,1,4,"line",7),T(9,S9t,2,1,"g",8),T(10,P9t,1,4,"line",9),S()),2&n&&(k("viewBox",-i.STROKE_WIDTH+" 0 "+i.boardWidth+" "+i.boardHeight)("transform",i.rotation),v(6),y("ngForOf",i.getAllCoords()),v(1),y("ngForOf",i.possibleCaptures),v(1),y("ngForOf",i.arrows),v(1),y("ngForOf",i.Player.PLAYERS),v(1),y("ngIf",i.inserted.isPresent()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var hC,El;class X1 extends Mr{static of(e){return new X1(e.x,e.y)}toString(){return this===X1.PASS?"GoMove.PASS":this===X1.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}u(X1,"PASS",new(hC=X1)(-1,0)),u(X1,"ACCEPT",new hC(-2,0)),u(X1,"encoder",Mr.getEncoder(hC.of));class ke{constructor(e,t){u(this,"player",void 0),u(this,"type",void 0),this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case ke.DARK:return"GoPiece.DARK";case ke.LIGHT:return"GoPiece.LIGHT";case ke.EMPTY:return"GoPiece.EMPTY";case ke.DEAD_DARK:return"GoPiece.DEAD_DARK";case ke.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case ke.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return Ve(this===ke.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===I.ZERO?ke.DARK:ke.LIGHT}isOccupied(){return[ke.DARK,ke.LIGHT,ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isEmpty(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY,ke.EMPTY].includes(this)}isDead(){return[ke.DEAD_DARK,ke.DEAD_LIGHT].includes(this)}isTerritory(){return[ke.DARK_TERRITORY,ke.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return Ve(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),ke.EMPTY}}u(ke,"DARK",new(El=ke)(I.ZERO,"alive")),u(ke,"LIGHT",new El(I.ONE,"alive")),u(ke,"EMPTY",new El(X.NONE,"empty")),u(ke,"DEAD_DARK",new El(I.ZERO,"dead")),u(ke,"DEAD_LIGHT",new El(I.ONE,"dead")),u(ke,"DARK_TERRITORY",new El(X.NONE,"territory")),u(ke,"LIGHT_TERRITORY",new El(X.NONE,"territory"));var pn=function(r){return r.PLAYING="PLAYING",r.PASSED="PASSED",r.COUNTING="COUNTING",r.ACCEPT="ACCEPT",r.FINISHED="FINISHED",r}(pn||{});let Sr=(()=>{class r extends F1{constructor(t,n,i,s,o){super(t,i),u(this,"koCoord",void 0),u(this,"captured",void 0),u(this,"phase",void 0),this.captured=n,this.koCoord=s,this.phase=o}static getInitialState(){const t=r.getStartingBoard();return new r(t,[0,0],0,g.empty(),pn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return He.createTable(r.WIDTH,r.HEIGHT,ke.EMPTY)}copy(){return new r(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(t){return this.getPieceAt(t).isDead()}isTerritory(t){return this.getPieceAt(t).isTerritory()}}return u(r,"WIDTH",19),u(r,"HEIGHT",19),r})();const qe=ke.LIGHT,$e=ke.DARK,VL=ke.DEAD_LIGHT,au=ke.LIGHT_TERRITORY,Zo=ke.DARK_TERRITORY,le=ke.EMPTY;class cce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Sr.getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Sr([[le,$e,le,le,qe,qe],[le,$e,le,le,qe,le],[le,$e,$e,qe,qe,le],[le,le,$e,qe,le,le],[le,le,$e,qe,le,le],[le,le,$e,qe,le,le]],[0,0],0,g.empty(),pn.PLAYING)),W.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Sr([[le,le,le,le,le],[le,le,$e,le,le],[le,$e,qe,le,le],[le,le,$e,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),pn.PLAYING),[new X1(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),W.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Sr([[le,$e,le,le,le],[$e,qe,le,le,le],[$e,qe,qe,$e,le],[le,$e,$e,le,le],[le,le,le,le,le]],[0,0],0,g.empty(),pn.PLAYING),[new X1(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),W.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Sr([[le,$e,le,le,le],[$e,le,le,le,le],[$e,le,le,le,qe],[qe,$e,le,qe,le],[le,qe,le,qe,$e]],[0,0],0,g.empty(),pn.PLAYING)),W.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Sr([[le,le,le,le,le],[$e,$e,$e,le,le],[qe,qe,$e,le,le],[le,qe,$e,le,le],[qe,qe,$e,le,le]],[0,0],0,g.empty(),pn.PLAYING)),W.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Sr([[le,$e,qe,le,le],[qe,$e,qe,le,le],[$e,$e,qe,le,le],[qe,$e,qe,le,le],[le,$e,qe,le,le]],[0,0],0,g.empty(),pn.PLAYING)),W.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Sr([[le,qe,$e,le,qe,$e,le],[le,qe,$e,$e,qe,$e,le],[le,qe,$e,$e,qe,$e,le],[le,qe,$e,$e,qe,$e,le],[le,qe,$e,qe,qe,$e,le],[le,qe,$e,qe,qe,$e,le],[le,qe,$e,le,qe,$e,le]],[0,0],0,g.empty(),pn.PLAYING)),W.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Sr([[le,le,le,le,le,le,le],[le,le,le,le,le,le,le],[le,le,le,$e,qe,le,le],[le,le,$e,qe,le,qe,le],[le,le,le,$e,qe,le,le],[le,le,le,le,le,le,le],[le,le,le,le,le,le,le]],[0,0],0,g.empty(),pn.PLAYING),[new X1(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),W.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Sr([[qe,$e,$e,$e,$e,$e,Zo,Zo,Zo],[qe,qe,qe,qe,$e,$e,$e,Zo,Zo],[qe,au,qe,qe,$e,VL,VL,$e,Zo],[$e,qe,qe,qe,qe,$e,Zo,Zo,Zo],[le,qe,au,qe,$e,$e,VL,$e,Zo],[qe,au,qe,qe,$e,$e,$e,$e,$e],[qe,qe,$e,$e,$e,qe,qe,$e,qe],[$e,$e,$e,qe,qe,qe,au,qe,qe],[Zo,Zo,$e,$e,$e,qe,qe,au,au]],[0,0],0,g.empty(),pn.COUNTING),[new X1(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)])}}let FL=class{getGroupDatas(e,t){const i=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,i)}_getGroupDatas(e,t,n){const i=t[e.y][e.x];if(n.addPawn(e,i),i===n.color)for(const s of this.getDirections()){const o=e.getNext(s);o.isInRange(t[0].length,t.length)&&!1===n.contains(o)&&(n=this._getGroupDatas(o,t,n))}return n}};FL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],FL);class cu{constructor(e){u(this,"color",void 0),this.color=e}selfContains(e){return this.getCoords().some(n=>n.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class w9t extends cu{constructor(e,t,n,i,s,o){super(e),u(this,"emptyCoords",void 0),u(this,"darkCoords",void 0),u(this,"lightCoords",void 0),u(this,"deadDarkCoords",void 0),u(this,"deadLightCoords",void 0),this.emptyCoords=t,this.darkCoords=n,this.lightCoords=i,this.deadDarkCoords=s,this.deadLightCoords=o}getCoords(){return this.color===ke.DARK?this.darkCoords:this.color===ke.LIGHT?this.lightCoords:this.color===ke.DEAD_DARK?this.deadDarkCoords:this.color===ke.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(n=>n.equals(e))}addPawn(e,t){switch(Ve(!1===this.contains(e),"This group already contains "+e.toString()),t){case ke.DARK:this.darkCoords=cu.insertAsEntryPoint(this.darkCoords,e);break;case ke.LIGHT:this.lightCoords=cu.insertAsEntryPoint(this.lightCoords,e);break;case ke.DEAD_DARK:this.deadDarkCoords=cu.insertAsEntryPoint(this.deadDarkCoords,e);break;case ke.DEAD_LIGHT:this.deadLightCoords=cu.insertAsEntryPoint(this.deadLightCoords,e);break;default:K.expectToBeMultiple(t,[ke.EMPTY,ke.DARK_TERRITORY,ke.LIGHT_TERRITORY]),this.emptyCoords=cu.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new un;e.set(ke.EMPTY,this.emptyCoords.length),e.set(ke.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(ke.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((n,i)=>i>0);if(1===t.size())return t.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==ke.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==ke.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==ke.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==ke.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==ke.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class xd extends FL{getNewInstance(e){return new w9t(e,[],[],[],[],[])}getDirections(){return Re.ORTHOGONALS}}let Ld=(()=>{class r{}return u(r,"ILLEGAL_KO",()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`),u(r,"CANNOT_PASS_AFTER_PASSED_PHASE",()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`),u(r,"CANNOT_ACCEPT_BEFORE_COUNTING_PHASE",()=>$localize`You cannot accept before the counting phase.`),u(r,"OCCUPIED_INTERSECTION",()=>$localize`This intersection is already occupied.`),u(r,"CANNOT_COMMIT_SUICIDE",()=>$localize`You cannot commit suicide.`),r})();var pC,vn;let i4=(pC=class extends jn{static get(){return vn.singleton.isAbsent()&&(vn.singleton=g.of(new vn)),vn.singleton.get()}constructor(){super(Sr)}static isLegal(e,t){if(vn.isPass(e)){const n=t.phase===pn.PLAYING,i=t.phase===pn.PASSED;return we.display("GoRules","isLegal","at "+t.phase+(n||i?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),n||i?se.success([]):se.failure(Ld.CANNOT_PASS_AFTER_PASSED_PHASE())}return vn.isAccept(e)?t.phase===pn.COUNTING||t.phase===pn.ACCEPT?se.success([]):se.failure(Ld.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE()):vn.isOccupied(e.coord,t.getCopiedBoard())?(we.display("GoRules","isLegal","move is marking"),vn.isLegalDeadMarking(e,t)?se.success([]):se.failure(Ld.OCCUPIED_INTERSECTION())):(we.display("GoRules","isLegal","move is normal stuff: "+e.toString()),vn.isLegalNormalMove(e,t))}static getNewKo(e,t,n){if(1===n.length){const i=n[0],s=e.coord,o=t[s.y][s.x],c=(new xd).getGroupDatas(s,t),l=c.emptyCoords,f=ke.pieceBelongTo(o,I.ZERO)?c.darkCoords:c.lightCoords;if(1===l.length&&l[0].equals(i)&&1===f.length)return g.of(i)}return g.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),n=vn.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const s of n){const o=s.getWrapper();if(o===ke.LIGHT){i[1]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=ke.LIGHT_TERRITORY}else{Ve(o===ke.DARK,"territory should be wrapped by dark or light, not by "+o.toString()),i[0]+=s.emptyCoords.length;for(const a of s.getCoords())t[a.y][a.x]=ke.DARK_TERRITORY}}return new Sr(t,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy();let i;for(let s=0;s<e.board.length;s++)for(let o=0;o<e.board[0].length;o++)i=t[s][o],i===ke.DARK_TERRITORY?(t[s][o]=ke.EMPTY,n[0]=n[0]-1):i===ke.LIGHT_TERRITORY&&(t[s][o]=ke.EMPTY,n[1]=n[1]-1);return new Sr(t,n,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return vn.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const n=[];let i,s,o;const a=new xd;for(let c=0;c<e.length;c++)for(let l=0;l<e[0].length;l++)i=new C(l,c),o=e[c][l],t(o)&&!1===n.some(f=>f.selfContains(i))&&(s=a.getGroupDatas(i,e),n.push(s));return n}static addDeadToScore(e){const t=e.getCapturedCopy();let s,n=t[1],i=t[0];for(let o=0;o<e.board.length;o++)for(let a=0;a<e.board[0].length;a++)s=e.getPieceAtXY(a,o),s===ke.DEAD_DARK?n++:s===ke.DEAD_LIGHT&&i++;return[i,n]}static switchAliveness(e,t){const n=t.getCopiedBoard();Ve(n[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const o=(new xd).getGroupDatas(e,n),a=t.getCapturedCopy();switch(o.color){case ke.DEAD_DARK:a[1]-=2*o.deadDarkCoords.length;for(const c of o.deadDarkCoords)n[c.y][c.x]=ke.DARK;break;case ke.DEAD_LIGHT:a[0]-=2*o.deadLightCoords.length;for(const c of o.deadLightCoords)n[c.y][c.x]=ke.LIGHT;break;case ke.LIGHT:a[0]+=2*o.lightCoords.length;for(const c of o.lightCoords)n[c.y][c.x]=ke.DEAD_LIGHT;break;default:K.expectToBe(o.color,ke.DARK),a[1]+=2*o.darkCoords.length;for(const c of o.darkCoords)n[c.y][c.x]=ke.DEAD_DARK}return new Sr(n,a,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===pn.FINISHED?t.captured[0]>t.captured[1]?ve.ZERO_WON:t.captured[1]>t.captured[0]?ve.ONE_WON:ve.DRAW:ve.ONGOING}static isPass(e){return e.equals(X1.PASS)}static isAccept(e){return e.equals(X1.ACCEPT)}static isLegalDeadMarking(e,t){return vn.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===pn.COUNTING||t.phase===pn.ACCEPT)}static isLegalNormalMove(e,t){const n=t.getCopiedBoard();if(vn.isKo(e,t))return se.failure(Ld.ILLEGAL_KO());[pn.COUNTING,pn.ACCEPT].includes(t.phase)&&(t=vn.resurrectStones(t));const i=vn.getCaptureState(e,t);if(uce.isCapturing(i))return se.success(i.capturedCoords);{n[e.coord.y][e.coord.x]=t.turn%2==0?ke.DARK:ke.LIGHT;const a=0===(new xd).getGroupDatas(e.coord,n).emptyCoords.length;return n[e.coord.y][e.coord.x]=ke.EMPTY,a?se.failure(Ld.CANNOT_COMMIT_SUICIDE()):se.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const n=new uce;let i;for(const s of Re.ORTHOGONALS)i=vn.getCapturedInDirection(e.coord,s,t),i.length>0&&n.capturedCoords.every(o=>!1===i[0].equals(o))&&(n.capturedCoords=n.capturedCoords.concat(i));return n}static getCapturedInDirection(e,t,n){const i=n.getCopiedBoard(),s=e.getNext(t);if(s.isInRange(n.board[0].length,n.board.length)&&i[s.y][s.x]===(n.turn%2==0?ke.LIGHT:ke.DARK)){we.display("GoRules","getCapturedInDirection","a group could be captured");const c=(new xd).getGroupDatas(s,i);if(vn.isCapturableGroup(c,n.koCoord))return we.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:c.getCoords(),message:"is capturable"}),c.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return vn.getEmptyZones(e).filter(n=>n.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),n=e.getCapturedCopy(),i=e.turn;let s,o;return e.phase===pn.PASSED?(s=pn.COUNTING,o=new Sr(t,n,i+1,g.empty(),s),o=vn.markTerritoryAndCount(o)):(Ve(e.phase===pn.PLAYING,"Cannot pass in counting phase!"),s=pn.PASSED,o=new Sr(t,n,i+1,g.empty(),s)),o}static applyLegalAccept(e){const t=e.getCopiedBoard();let n;return n=e.phase===pn.COUNTING?pn.ACCEPT:pn.FINISHED,new Sr(t,e.getCapturedCopy(),e.turn+1,g.empty(),n)}static applyNormalLegalMove(e,t,n){let i;i=[pn.COUNTING,pn.ACCEPT].includes(t.phase)?vn.resurrectStones(t):t.copy();const s=e.coord.x,o=e.coord.y,a=i.getCopiedBoard(),c=i.turn,l=ke.ofPlayer(i.getCurrentPlayer()),f=c+1;a[o][s]=l;for(const M of n)a[M.y][M.x]=ke.EMPTY;const d=vn.getNewKo(e,a,n),m=i.getCapturedCopy();return m[l.player.value]+=n.length,new Sr(a,m,f,d,pn.PLAYING)}static resurrectStones(e){for(let t=0;t<e.board.length;t++)for(let n=0;n<e.board[0].length;n++)e.getPieceAtXY(n,t).isDead()&&(e=vn.switchAliveness(new C(n,t),e));return vn.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const n=vn.removeAndSubstractTerritory(t),i=vn.switchAliveness(e.coord,n),s=new Sr(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,g.empty(),pn.COUNTING);return vn.markTerritoryAndCount(s)}isLegal(e,t){return vn.isLegal(e,t)}applyLegalMove(e,t,n){return vn.isPass(e)?(we.display("GoRules","applyLegalMove","isPass"),vn.applyPass(t)):vn.isAccept(e)?(we.display("GoRules","applyLegalMove","isAccept"),vn.applyLegalAccept(t)):vn.isLegalDeadMarking(e,t)?(we.display("GoRules","applyLegalMove","isDeadMarking"),vn.applyDeadMarkingMove(e,t)):(we.display("GoRules","applyLegalMove","else it is normal move"),vn.applyNormalLegalMove(e,t,n))}getGameStatus(e){return vn.getGameStatus(e)}},vn=pC,u(pC,"singleton",g.empty()),pC);i4=vn=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],i4);class uce{constructor(){u(this,"capturedCoords",[])}static isCapturing(e){return e.capturedCoords.length>0}}let $L=class extends Hr{getListMoves(e){const t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===pn.PLAYING||t.phase===pn.PASSED)return n.push(X1.PASS),n;{const i=this.getCountingMovesList(t);return 0===i.length?[X1.ACCEPT]:i}}getPlayingMovesList(e){const t=[];let n;for(let i=0;i<e.board.length;i++)for(let s=0;s<e.board[0].length;s++)n=new X1(s,i),e.getPieceAt(n.coord)===ke.EMPTY&&i4.isLegal(n,e).isSuccess()&&t.push(n);return t}getCountingMovesList(e){const t=[],n=this.getCorrectBoard(e).getCopiedBoard(),i=i4.getGroupsDatasWhere(n,s=>s!==ke.EMPTY);for(const s of i){const o=s.getCoords()[0],a=n[o.y][o.x];if(e.getPieceAt(o)!==a){const l=new X1(o.x,o.y);return t.push(l),t}}return t}getCorrectBoard(e){const n=this.mapBoard(e.getCopiedBoard(),o=>o===ke.DARK?ke.DEAD_DARK:o===ke.LIGHT?ke.DEAD_LIGHT:o.isTerritory()?ke.EMPTY:o),i=new Sr(n,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),s=i4.getTerritoryLikeGroup(i);return this.setAliveUniqueWrapper(i,s)}mapBoard(e,t){const n=[];for(let i=0;i<e.length;i++){n[i]=[];for(let s=0;s<e[0].length;s++)n[i][s]=t(e[i][s])}return n}setAliveUniqueWrapper(e,t){let i,n=e.copy();for(const s of t){i=s.deadDarkCoords.concat(s.deadLightCoords);for(const o of i)n.isDead(o)&&(n=i4.switchAliveness(o,n))}return n}getMetrics(e){const t=i4.markTerritoryAndCount(e.gameState),n=t.getCapturedCopy(),i=this.getDeadStones(t);return[n[0]+2*i[1],n[1]+2*i[0]]}getDeadStones(e){const t=[0,0];for(let n=0;n<e.board.length;n++)for(let i=0;i<e.board[0].length;i++){const s=e.getPieceAtXY(i,n);"dead"===s.type&&(t[s.player.value]=t[s.player.value]+1)}return t}};var lu;function k9t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",8),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),S(),E(2,"line",9),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),S(),E(3,"line",9),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),S()()}if(2&r){const t=e.index,n=p().index,i=p();v(1),ye("id","click_",t,"_",n,""),k("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),v(1),k("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),v(1),k("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function x9t(r,e){if(1&r&&(A(),E(0,"g"),T(1,k9t,4,14,"g",3),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function L9t(r,e){if(1&r){const t=pe();A(),E(0,"circle",10),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()}if(2&r){const t=e.$implicit,n=p();ye("id","hoshi_",t.x,"_",t.y,""),k("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.1*n.SPACE_SIZE)}}function R9t(r,e){if(1&r&&(A(),F(0,"circle",16)),2&r){const t=p(2).index,n=p().index,i=p();k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function z9t(r,e){if(1&r){const t=pe();A(),E(0,"line",17),U("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onClick(i,s))}),S()}if(2&r){const t=p(2).index,n=p().index,i=p();k("x1",.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)}}function D9t(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"circle",13),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().onClick(i,s))}),S(),T(2,R9t,1,3,"circle",14),T(3,z9t,1,4,"line",15),S()}if(2&r){const t=p().index,n=p().index,i=p();v(1),y("ngClass",i.getSpaceClass(t,n)),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE),v(1),y("ngIf",i.isLastSpace(t,n)),v(1),y("ngIf",i.isDead(t,n))}}function H9t(r,e){if(1&r){const t=pe();A(),E(0,"circle",19),U("click",function(){te(t);const i=p(2).index,s=p().index;return ne(p().onClick(i,s))}),S()}if(2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();k("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*n)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*s)("r",.1*o.SPACE_SIZE)("class",i===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function V9t(r,e){if(1&r&&(A(),T(0,H9t,1,4,"circle",18)),2&r){const t=p().index,n=p().index;y("ngIf",p().isTerritory(t,n))}}function F9t(r,e){if(1&r&&(A(),E(0,"g"),T(1,D9t,4,6,"g",11),T(2,V9t,1,1,"ng-template",null,12,dn),S()),2&r){const t=e.index,n=ln(3),i=p().index,s=p();v(1),y("ngIf",s.spaceIsFull(t,i))("ngIfElse",n)}}function $9t(r,e){if(1&r&&(A(),E(0,"g"),T(1,F9t,4,2,"g",3),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function B9t(r,e){if(1&r&&(A(),F(0,"rect",20)),2&r){const t=p();k("width",.25*t.SPACE_SIZE)("height",.25*t.SPACE_SIZE)("x",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().x)("y",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().y)}}function G9t(r,e){if(1&r){const t=pe();A(),E(0,"circle",21),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()}if(2&r){const t=e.$implicit,n=p();k("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}$L=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],$L);let BL=(lu=class extends kL{constructor(e){super(e),u(this,"boardInfo",void 0),u(this,"ko",g.empty()),u(this,"last",g.empty()),u(this,"captures",[]),u(this,"GoPiece",ke),u(this,"boardHeight",Sr.HEIGHT),u(this,"boardWidth",Sr.WIDTH),this.scores=g.of([0,0]),this.rules=i4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new $L(this.rules,"GoMinimax")],this.encoder=X1.encoder,this.tutorial=(new cce).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length,this.updateBoard()}onClick(e,t){var n=this;return P(function*(){const i=n.canUserPlay("#click_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.last=g.empty();const s=new X1(e,t);return n.chooseMove(s)})()}updateBoard(){const e=this.getState(),t=this.node.move,n=e.phase;this.board=e.getCopiedBoard(),this.scores=g.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(i=>i.coord),this.canPass=n!==pn.FINISHED,this.createHoshis()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.board.length;t++)for(let n=0;n<this.board[0].length;n++){const i=new C(n,t),s=e.getPieceAt(i).isOccupied(),o=this.board[t][n]===ke.EMPTY,a=!1===this.ko.equalsValue(i);s&&o&&a&&this.captures.push(i)}}pass(){var e=this;return P(function*(){const t=e.getState().phase;return t===pn.PLAYING||t===pn.PASSED?e.onClick(X1.PASS.coord.x,X1.PASS.coord.y):(Ve(t===pn.COUNTING||t===pn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(X1.ACCEPT.coord.x,X1.ACCEPT.coord.y))})()}getSpaceClass(e,t){const n=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==ke.EMPTY&&!1===this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const n=this.last.get();return e===n.x&&t===n.y}return!1}isDead(e,t){return this.getState().isDead(new C(e,t))}isTerritory(e,t){return this.getState().isTerritory(new C(e,t))}},u(lu,"\u0275fac",function(e){return new(e||lu)(G(Wt))}),u(lu,"\u0275cmp",Xe({type:lu,selectors:[["app-go"]],features:[Je],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(A(),E(0,"svg",0),F(1,"rect",1),E(2,"g",2),T(3,x9t,2,1,"g",3),T(4,L9t,1,5,"circle",4),S(),E(5,"g",5),T(6,$9t,2,1,"g",3),S(),T(7,B9t,1,4,"rect",6),T(8,G9t,1,3,"circle",7),S()),2&e&&(k("viewBox","0 -3 "+t.boardWidth*t.SPACE_SIZE*.5+" "+(6+t.boardHeight*t.SPACE_SIZE*.5)),v(1),k("width",t.boardWidth*t.SPACE_SIZE*.5)("height",t.boardHeight*t.SPACE_SIZE*.5),v(2),y("ngForOf",t.board),v(1),y("ngForOf",t.hoshis),v(2),y("ngForOf",t.board),v(1),y("ngIf",t.ko.isPresent()),v(1),y("ngForOf",t.captures))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),lu);BL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],BL);class s4{static fromLimits(e,t,n,i){return new s4(e,n,t-e,i-n)}static fromHexa(e,t,n){const i=e.flatMap(f=>t.getHexaPointsListAt(f)),s=s4.getLimits(i);return new s4(s.minX-n/2,s.minY-n/2,n+s.maxX-s.minX,n+s.maxY-s.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;for(const o of e)i=Math.min(i,o.x),s=Math.min(s,o.y),t=Math.max(t,o.x),n=Math.max(n,o.y);return{minX:i,minY:s,maxX:t,maxY:n}}constructor(e,t,n,i){u(this,"left",void 0),u(this,"up",void 0),u(this,"width",void 0),u(this,"height",void 0),this.left=e,this.up=t,this.width=n,this.height=i}center(){return new C(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(e,t,n,i){return new s4(this.left-e,this.up-n,this.width+e+t,this.height+n+i)}containingAtLeast(e){const t=Math.min(this.left,e.left),n=Math.max(this.right(),e.right()),i=Math.min(this.up,e.up),s=Math.max(this.bottom(),e.bottom());return s4.fromLimits(t,n,i,s)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}class U9t{static getArrowTransform(e,t,n){let i,s,o;switch(n){case Re.UP:i=1,s=0,o=-90;break;case Re.DOWN:i=1,s=2,o=90;break;case Re.LEFT:i=0,s=1,o=180;break;default:K.expectToBe(n,Re.RIGHT),i=2,s=1,o=0}return["scale("+e/300+")",`translate(${100*i} ${100*s})`,"rotate("+o+" 50 50)"].join(" ")}}let cr=(()=>{class r{}return u(r,"CANNOT_DROP_PIECE_YOU_DONT_HAVE",()=>"You cannot drop a piece that you do not have in your reserve."),u(r,"QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The queen bee can only move to one of its direct neighbors.`),u(r,"BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS",()=>$localize`The beetle can only move to one of its direct neighbors.`),u(r,"GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE",()=>$localize`The grasshopper must move in a straight line.`),u(r,"GRASSHOPPER_MUST_JUMP_OVER_PIECES",()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`),u(r,"SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES",()=>$localize`The spider must move on neighboring spaces.`),u(r,"SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT",()=>$localize`The spider can only move around pieces that are in direct contact with it.`),u(r,"SPIDER_CANNOT_BACKTRACK",()=>$localize`The spider cannot go twice through the same space in the same move.`),u(r,"QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE",()=>$localize`The queen bee must be placed on the board before moving a piece.`),u(r,"THIS_PIECE_CANNOT_CLIMB",()=>$localize`Only the beetle is allowed to climb over other pieces.`),u(r,"CANNOT_DISCONNECT_HIVE",()=>$localize`You are not allowed to split the hive.`),u(r,"MUST_BE_ABLE_TO_SLIDE",()=>$localize`This piece must be able to slide to its destination.`),u(r,"MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN",()=>$localize`You must place your queen bee at this turn!`),u(r,"CANNOT_DROP_NEXT_TO_OPPONENT",()=>$localize`You cannot drop a piece next to one of your opponent's stack.`),u(r,"MUST_DROP_ON_EMPTY_SPACE",()=>$localize`You must always drop your piece on an empty space.`),u(r,"MUST_BE_CONNECTED_TO_HIVE",()=>$localize`The piece you are dropping must be connected to the hive.`),r})();var fce;const W9t=Ie.fromFunctions(r=>r,r=>r);class Qr{constructor(e,t){u(this,"owner",void 0),u(this,"kind",void 0),this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}fce=Qr,u(Qr,"encoder",Ie.tuple([I.encoder,W9t],r=>[r.owner,r.kind],r=>new fce(r[0],r[1])));class Dc{constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.size()===e.size()&&He.compareArray(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new Dc([e,...this.pieces])}topPiece(){return K.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new Dc(e)}size(){return this.pieces.length}}var hce,gce,g2;u(Dc,"EMPTY",new Dc([]));class Yo extends Mr{static of(e,t){return new Yo(e,t.x,t.y)}constructor(e,t,n){super(t,n),u(this,"piece",void 0),this.piece=e}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof Yo&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}hce=Yo,u(Yo,"encoder",Ie.tuple([Qr.encoder,C.encoder],r=>[r.piece,r.coord],r=>new hce(r[0],r[1].x,r[1].y)));class Fi extends Vo{static from(e,t){return e.equals(t)?se.failure(Le.MOVE_CANNOT_BE_STATIC()):se.success(new Fi(e,t))}constructor(e,t){super(e,t)}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof Ia)&&e instanceof Fi&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}u(Fi,"encoder",zs.getFallibleEncoder(Fi.from));class Ia extends Fi{static ofCoords(e){return new Ia(e)}constructor(e){super(e[0],e[3]),u(this,"coords",void 0),this.coords=e}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof Ia&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}gce=Ia,u(Ia,"encoder",Ie.tuple([C.encoder,C.encoder,C.encoder,C.encoder],r=>r.coords,r=>new gce(r)));class S0 extends Li{toString(){return"HiveMovePass"}equals(e){return e instanceof S0}}function q9t(r){return r instanceof Yo}function j9t(r){return r instanceof Ia}function Z9t(r){return r instanceof Fi}function Y9t(r){return r instanceof S0}u(S0,"encoder",Ie.constant("HiveMovePass",new S0)),function(r){r.PASS=new S0,r.drop=function e(i,s){return Yo.of(i,s)},r.move=function t(i,s){return Fi.from(i,s)},r.spiderMove=function n(i){return Ia.ofCoords(i)},r.encoder=Ie.disjunction([q9t,j9t,Z9t,Y9t],[Yo.encoder,Ia.encoder,Fi.encoder,S0.encoder])}(g2||(g2={}));class Ko{static of(e){return Ko.INSTANCES.isAbsent()&&(Ko.INSTANCES=g.of({QueenBee:gC.get(),Beetle:mC.get(),Grasshopper:_C.get(),Spider:Rd.get(),SoldierAnt:vC.get()})),Ko.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?b.failure(cr.THIS_PIECE_CANNOT_CLIMB()):b.SUCCESS}canSlideBetweenNeighbors(e,t,n){const i=new dt(h2.getNeighbors(t)),s=new dt(h2.getNeighbors(n)),o=i.intersection(s);for(const a of o)if(e.getAt(a).isEmpty())return!0;return!1}}u(Ko,"INSTANCES",g.empty());class gC extends Ko{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new gC)),this.INSTANCE.get()}moveValidity(e,t){return!1===h2.areNeighbors(e.getStart(),e.getEnd())?b.failure(cr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?b.failure(cr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of h2.getNeighbors(e))t.getAt(i).isEmpty()&&n.push(Fi.from(e,i).get());return n}}u(gC,"INSTANCE",g.empty());class mC extends Ko{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new mC)),this.INSTANCE.get()}moveValidity(e,t){return!1===h2.areNeighbors(e.getStart(),e.getEnd())?b.failure(cr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):b.SUCCESS}getPotentialMoves(e,t){const n=[];for(const i of h2.getNeighbors(e))n.push(Fi.from(e,i).get());return n}}u(mC,"INSTANCE",g.empty());class _C extends Ko{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new _C)),this.INSTANCE.get()}moveValidity(e,t){if(be.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return b.failure(cr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const i=e.getStart().getCoordsToward(e.getEnd());if(0===i.length)return b.failure(cr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const s of i)if(t.getAt(s).isEmpty())return b.failure(cr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=[];for(const i of be.factory.all){const s=e.getNext(i);if(t.getAt(s).hasPieces()){let o=s;for(;t.getAt(o).hasPieces();)o=o.getNext(i);n.push(Fi.from(e,o).get())}}return n}}u(_C,"INSTANCE",g.empty());class Rd extends Ko{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new Rd)),this.INSTANCE.get()}prefixLegality(e,t){const n=new dt,i=t.update().setAt(e[0],Dc.EMPTY).increaseTurnAndFinalizeUpdate();for(let s=1;s<e.length;s++){if(i.getAt(e[s]).hasPieces())return b.failure(cr.THIS_PIECE_CANNOT_CLIMB());if(!1===h2.areNeighbors(e[s-1],e[s]))return b.failure(cr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===i.haveCommonNeighbor(e[s],e[s-1]))return b.failure(cr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(i,e[s-1],e[s]))return b.failure(cr.MUST_BE_ABLE_TO_SLIDE());if(n.contains(e[s]))return b.failure(cr.SPIDER_CANNOT_BACKTRACK());n.add(e[s])}return b.SUCCESS}moveValidity(e,t){K.assert(e instanceof Ia,"HiveSpiderRules: move should be a spider move");const i=this.prefixLegality(e.coords,t);return i.isFailure()?i:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=t.update().setAt(e,Dc.EMPTY).increaseTurnAndFinalizeUpdate();let i=[[e]];for(let a=0;a<3;a++)i=i.flatMap(c=>this.nextMoveStep(n,c));return new dt(i.map(function s(a){return Ia.ofCoords(a)})).toList()}nextMoveStep(e,t){const n=t[t.length-1];return new dt(h2.getNeighbors(n)).filter(function i(o){return!e.getAt(o).hasPieces()&&void 0===t.find(a=>o.equals(a))&&e.haveCommonNeighbor(o,n)}).toList().map(o=>[...t,o])}}u(Rd,"INSTANCE",g.empty());class vC extends Ko{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=g.of(new vC)),this.INSTANCE.get()}pathExists(e,t,n){const i=new dt,s=[t];for(;s.length>0;){const o=s.pop();if(!i.contains(o)){if(i.add(o),o.equals(n))return!0;for(const a of h2.getNeighbors(o)){const c=e.getAt(a).isEmpty(),l=e.getOccupiedNeighbors(a).size()>0,f=this.canSlideBetweenNeighbors(e,o,a);c&&l&&f&&s.push(a)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?b.failure(cr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const n=new dt;for(const i of t.occupiedSpaces())if(!i.equals(e))for(const s of t.emptyNeighbors(i))n.add(Fi.from(e,s).get());return n.toList()}}u(vC,"INSTANCE",g.empty());class _ce extends Kv{constructor(e,t){super(t),u(this,"pieces",void 0),u(this,"width",void 0),u(this,"height",void 0),this.pieces=e;const n=this.computeScale();this.width=n.width,this.height=n.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;for(const s of this.pieces.listKeys())e=Math.min(s.x,e),t=Math.max(s.x,t),n=Math.min(s.y,n),i=Math.max(s.y,i);return{width:t+1-e,height:i+1-n}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new dt(h2.getNeighbors(e)).filter(n=>this.pieces.get(n).isPresent())}getGroups(){const e=new dt,t=new dt;return this.pieces.forEach(n=>{if(!1===e.contains(n.key)){const i=new dt,s=new dt([n.key]);for(;s.hasElements();){const o=s.getAnyElement().get();s.remove(o),e.add(o),i.add(o),s.addAll(this.getOccupiedNeighbors(o).filter(a=>!1===e.contains(a)))}t.add(i)}}),t}}class CC{static getInitial(){const e=new un;for(const t of I.PLAYERS)e.set(new Qr(t,"QueenBee"),1),e.set(new Qr(t,"Beetle"),2),e.set(new Qr(t,"Spider"),2),e.set(new Qr(t,"Grasshopper"),3),e.set(new Qr(t,"SoldierAnt"),3);return e.makeImmutable(),new CC(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return g.of(t);return g.empty()}remove(e){const t=this.pieces.get(e).get();K.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const n=this.pieces.getCopy();return n.replace(e,t-1),new CC(n)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const n=[];for(let i=0;i<t.value;i++)n.push(t.key);e.push(new Dc(n))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(n=>{n.key.owner===e&&n.value>0&&t.push(n.key)}),t}}class zd{static of(e){return new zd(e.pieces,e.remainingPieces,e.queenBees,e.turn)}constructor(e,t,n,i){u(this,"pieces",void 0),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),u(this,"turn",void 0),this.pieces=e,this.remainingPieces=t,this.queenBees=n,this.turn=i}setAt(e,t){const n=this.queenBees.getCopy();for(const s of I.PLAYERS)n.get(s).equalsValue(e)&&n.delete(s);for(const s of t.pieces)"QueenBee"===s.kind&&n.put(s.owner,e);const i=this.pieces.getCopy();return t.isEmpty()?i.delete(e):i.put(e,t),new zd(i,this.remainingPieces,n,this.turn)}removeRemainingPiece(e){return new zd(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new ui(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class ui extends _ce{static getInitialState(){return ui.fromRepresentation([],0)}static fromRepresentation(e,t,n=new St(0,0)){const i=new Md;let s=CC.getInitial();const o=new un;for(let a=0;a<e.length;a++)for(let c=0;c<e[0].length;c++)if(e[a][c].length>0){const l=new C(c,a).getNext(n,1);i.set(l,new Dc(e[a][c]));const f=g.ofNullable(e[a][c].find(d=>"QueenBee"===d.kind));f.isPresent()&&o.set(f.get().owner,l);for(const d of e[a][c])s=s.remove(d)}return new ui(i,s,o,t)}constructor(e,t,n,i){super(e,i),u(this,"remainingPieces",void 0),u(this,"queenBees",void 0),this.remainingPieces=t,this.queenBees=n,this.queenBees=n.getCopy();for(const s of n.listKeys()){const o=n.get(s).get();this.queenBees.replace(s,o)}this.queenBees.makeImmutable()}update(){return zd.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():Dc.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const n of h2.getNeighbors(e))this.getAt(n).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const n of h2.getNeighbors(e))this.getAt(n).isEmpty()&&t.push(n);return t}haveCommonNeighbor(e,t){const n=this.getOccupiedNeighbors(e),i=this.getOccupiedNeighbors(t);return n.findAnyCommonElement(i).isPresent()}}class F2 extends jn{static get(){return F2.singleton.isAbsent()&&(F2.singleton=g.of(new F2)),F2.singleton.get()}constructor(){super(ui)}applyLegalMove(e,t,n){return e instanceof Yo?this.applyLegalDrop(e,t):e instanceof Fi?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const n=t.getAt(e.coord);return t.update().setAt(e.coord,n.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const n=t.getAt(e.getStart()),i=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),n.removeTopPiece()).setAt(e.getEnd(),i.add(n.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof Yo?this.isLegalDrop(e,t):e instanceof Fi?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?b.SUCCESS:b.failure(Le.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return b.failure(cr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const n=t.getAt(e.getStart());if(n.isEmpty())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());const i=n.topPiece();if(i.owner===t.getCurrentOpponent())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());const s=Ko.of(i).moveValidity(e,t);if(s.isFailure())return s;const o=t.update().setAt(e.getStart(),n.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return b.failure(cr.CANNOT_DISCONNECT_HIVE());const a=e.getEnd();return 0===o.numberOfNeighbors(a)?b.failure(cr.CANNOT_DISCONNECT_HIVE()):b.SUCCESS}mustPlaceQueenBee(e){return e.turn>=6&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const n=t.getCurrentPlayer();if(e.piece.owner===n.getOpponent())return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.remainingPieces.hasRemaining(e.piece))return b.failure(cr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return b.failure(cr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const i=this.checkNeighborValidity(e,t);return i.isFailure()?i:t.getAt(e.coord).hasPieces()?b.failure(cr.MUST_DROP_ON_EMPTY_SPACE()):b.SUCCESS}checkNeighborValidity(e,t){const n=t.getCurrentPlayer();let i=!1;for(const s of h2.getNeighbors(e.coord)){const o=t.getAt(s);if(o.hasPieces()&&(i=!0,1!==t.turn&&o.topPiece().owner===n.getOpponent()))return b.failure(cr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===i?b.failure(cr.MUST_BE_CONNECTED_TO_HIVE()):b.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new dt([new C(0,0)]);if(1===e.turn)return new dt(h2.getNeighbors(new C(0,0)));const n=e.remainingPieces.getAny(t);if(n.isAbsent())return new dt;const i=n.get(),s=new dt;for(const o of e.occupiedSpaces())if(e.getAt(o).topPiece().owner===t)for(const a of e.emptyNeighbors(o)){const c=Yo.of(i,a);this.isLegalDrop(c,e).isSuccess()&&s.add(a)}return s}getPossibleMovesFrom(e,t){const n=e.getCurrentPlayer(),i=new dt,s=e.getAt(t).topPiece();if(s.owner===n)for(const o of Ko.of(s).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(o,e).isSuccess()&&i.add(o);return i}getPossibleMovesOnBoard(e){const t=new dt;for(const n of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,n));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,n=[0,0];for(const i of I.PLAYERS){const s=t.queenBeeLocation(i);s.isPresent()&&(n[i.value]=t.numberOfNeighbors(s.get()))}return 6===n[0]&&6===n[1]?ve.DRAW:6===n[0]?ve.getVictory(I.ONE):6===n[1]?ve.getVictory(I.ZERO):ve.ONGOING}}u(F2,"singleton",g.empty());class K9t extends Hr{getListMoves(e){const t=this.getListDrops(e.gameState),n=this.getListOfOnBoardMoves(e.gameState),i=t.concat(n);return 0===i.length?[g2.PASS]:i}getListOfOnBoardMoves(e){return F2.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],n=e.getCurrentPlayer(),i=new Qr(n,"QueenBee");for(const s of F2.get().getPossibleDropLocations(e))if(F2.get().mustPlaceQueenBee(e))t.push(g2.drop(i,s));else for(const o of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(g2.drop(o,s));return t}getMetrics(e){return[this.queenBeeMobility(e.gameState,I.ZERO),this.queenBeeMobility(e.gameState,I.ONE)]}queenBeeMobility(e,t){const n=e.queenBeeLocation(t);return n.isPresent()?F2.get().getPossibleMovesFrom(e,n.get()).size():0}}const Hc=new Qr(I.ZERO,"QueenBee"),P0=new Qr(I.ZERO,"Beetle"),uu=new Qr(I.ZERO,"Grasshopper"),yC=new Qr(I.ZERO,"Spider"),MC=new Qr(I.ZERO,"SoldierAnt"),T0=new Qr(I.ONE,"QueenBee"),mo=new Qr(I.ONE,"Beetle"),GL=new Qr(I.ONE,"Grasshopper"),UL=new Qr(I.ONE,"Spider"),Dd=new Qr(I.ONE,"SoldierAnt");class vce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,ui.fromRepresentation([[[T0],[mo],[UL],[uu]],[[uu],[],[MC],[]],[[MC],[],[],[]]],8)),W.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,ui.fromRepresentation([[[],[mo],[yC]],[[Dd],[T0],[Hc]],[[uu],[P0],[]]],7)),W.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,ui.getInitialState(),g2.drop(P0,new C(0,0)),$localize`Congratulations!`),W.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,ui.fromRepresentation([[[mo],[uu]]],2),g2.drop(Hc,new C(2,0)),$localize`Congratulations!`),W.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,ui.fromRepresentation([[[],[yC],[GL],[T0],[mo]],[[mo],[Hc],[P0],[],[]]],4),[g2.move(new C(1,1),new C(0,2)).get(),g2.move(new C(1,1),new C(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,ui.fromRepresentation([[[Hc],[T0],[P0]],[[mo],[],[]]],6),[g2.move(new C(2,0),new C(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,ui.fromRepresentation([[[mo,Hc],[T0],[P0]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,ui.fromRepresentation([[[uu],[Hc],[mo],[Dd]],[[GL],[],[],[]]],6),[g2.move(new C(0,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,ui.fromRepresentation([[[],[MC],[T0]],[[],[Hc],[mo]],[[Dd],[UL],[]]],6),g2.move(new C(1,0),new C(3,1)).get(),(t,n,i)=>t.equals(g2.move(new C(1,0),new C(0,1)).get())?b.failure($localize`You have not freed your queen, try again!`):b.SUCCESS,$localize`Congratulations!`),W.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,ui.fromRepresentation([[[],[yC],[UL],[mo]],[[],[],[],[P0]],[[mo],[],[],[Dd]],[[MC],[],[uu],[]],[[Hc],[GL],[],[]]],6),g2.spiderMove([new C(1,0),new C(1,1),new C(2,1),new C(2,2)]),$localize`Congratulations!`),W.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,ui.fromRepresentation([[[],[yC],[]],[[],[Hc],[mo]],[[Dd],[],[]]],6)),W.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,ui.fromRepresentation([[[mo,P0],[Hc],[T0]]],4))])}}const X9t=["app-hive-piece",""];function Q9t(r,e){1&r&&(A(),F(0,"path",9))}function J9t(r,e){1&r&&(A(),F(0,"path",10))}function edt(r,e){1&r&&(A(),F(0,"path",11))}function tdt(r,e){1&r&&(A(),F(0,"path",12))}function ndt(r,e){1&r&&(A(),F(0,"path",13))}let rdt=(()=>{var r;class e extends Cae{constructor(...n){super(...n),u(this,"piece",void 0),u(this,"x",void 0),u(this,"y",void 0),u(this,"hexaLayout",void 0),u(this,"layer",void 0),u(this,"pieceHeight",void 0),u(this,"hexaPoints",""),u(this,"pieceClass",""),u(this,"isoPointsLight",""),u(this,"isoPointsDark",""),u(this,"isoPointsStroke",""),u(this,"layerTransform",""),u(this,"hexaCenter",new C(0,0))}ngAfterContentChecked(){const n=new C(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(n),this.hexaCenter=this.hexaLayout.getCenterAt(n);const s=this.hexaLayout.getIsoPoints(n,this.pieceHeight).map(o=>o.map(a=>a.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}()),u(e,"\u0275cmp",Xe({type:r,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[Je],attrs:X9t,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(n,i){1&n&&(A(),E(0,"g"),F(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),E(5,"g"),T(6,Q9t,1,0,"path",4),T(7,J9t,1,0,"path",5),T(8,edt,1,0,"path",6),T(9,tdt,1,0,"path",7),T(10,ndt,1,0,"path",8),S()()),2&n&&(k("transform",i.layerTransform),v(1),y("ngClass",i.pieceClass),k("points",i.isoPointsLight),v(1),y("ngClass",i.pieceClass),k("points",i.isoPointsDark),v(1),k("points",i.isoPointsStroke),v(1),y("ngClass",i.pieceClass),k("points",i.hexaPoints),v(1),k("transform","translate("+i.hexaCenter.x+" "+i.hexaCenter.y+")"),v(1),y("ngIf","QueenBee"===i.piece.kind),v(1),y("ngIf","Beetle"===i.piece.kind),v(1),y("ngIf","Grasshopper"===i.piece.kind),v(1),y("ngIf","Spider"===i.piece.kind),v(1),y("ngIf","SoldierAnt"===i.piece.kind))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();function idt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"polygon",4),U("click",function(){const s=te(t).$implicit;return ne(p().selectSpace(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p();v(1),ye("id","space_",t.x,"_",t.y,""),y("ngClass",t.content.spaceClasses),k("points",n.getHexaPointsAtXY(t.x,t.y))}}function sdt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",6),U("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p();ye("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),k("points",n.getHexaPointsAtXY(t.x,t.y))}}function odt(r,e){if(1&r&&(A(),E(0,"g"),T(1,sdt,1,4,"polygon",5),S()),2&r){const t=e.$implicit;v(1),y("ngIf",t.content.strokeClasses.length>0)}}function adt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",8),U("click",function(){te(t);const i=p().$implicit;return ne(p().selectSpace(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p();ye("id","stroke_",t.x,"_",t.y,""),k("points",n.getHexaPointsAtXY(t.x,t.y))}}function cdt(r,e){if(1&r&&(A(),E(0,"g"),T(1,adt,1,3,"polygon",7),S()),2&r){const t=e.$implicit;v(1),y("ngIf",t.content.selected)}}function ldt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"g",9),U("click",function(){const s=te(t).$implicit;return ne(p(2).selectStack(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p().index,i=p();v(1),ye("id","piece_",t.x,"_",t.y,""),y("piece",t.content.piece)("x",t.x)("y",t.y)("pieceHeight",i.PIECE_HEIGHT)("hexaLayout",i.hexaLayout)("layer",n)}}function udt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectStack(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p().index,i=p();ye("id","stroke_",t.x,"_",t.y,""),y("ngClass",t.content.strokeClasses),k("transform","translate(0 "+-(n+1)*i.PIECE_HEIGHT+")")("points",i.getHexaPointsAtXY(t.x,t.y))}}function fdt(r,e){if(1&r&&(A(),E(0,"g"),T(1,udt,1,5,"polygon",5),S()),2&r){const t=e.$implicit;v(1),y("ngIf",t.content.strokeClasses.length>0)}}function ddt(r,e){if(1&r&&(A(),E(0,"g"),T(1,ldt,2,8,"g",1),T(2,fdt,2,1,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t),v(1),y("ngForOf",t)}}function hdt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"g",10),U("click",function(){const s=te(t).$implicit;return ne(p(2).selectRemaining(s))}),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);v(1),Rn("id","remainingPiece_",t.toString(),""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("layer",n)("hexaLayout",i.hexaLayout),k("transform",i.getRemainingPieceTransform(t))}}function pdt(r,e){if(1&r&&(A(),E(0,"g"),T(1,hdt,2,8,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t.pieces)}}function gdt(r,e){if(1&r&&(A(),F(0,"polygon",11)),2&r){const t=p();k("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))("points",t.getHexaPointsAt(t.ORIGIN))}}function mdt(r,e){if(1&r&&(A(),F(0,"g",13)),2&r){const t=e.$implicit,n=e.index,i=p(2);Rn("id","inspectedStack_",n,""),y("piece",t)("pieceHeight",i.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",i.hexaLayout)("layer",6*n),k("transform",i.inspectedStackTransform)}}function _dt(r,e){if(1&r&&(A(),E(0,"g"),T(1,mdt,1,8,"g",12),S()),2&r){const t=p();v(1),y("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class Cce extends _ae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(n=>n.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class vdt extends _ae{constructor(...e){super(...e),u(this,"highlighted",[])}initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(n=>n.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let Cdt=(()=>{var r;class e extends Q5{constructor(n){super(n),u(this,"ORIGIN",new C(0,0)),u(this,"remainingStacks",[]),u(this,"layers",[]),u(this,"ground",new Cce),u(this,"inspectedStack",g.empty()),u(this,"inspectedStackCoord",g.empty()),u(this,"selectedRemaining",g.empty()),u(this,"selectedStart",g.empty()),u(this,"selectedSpiderCoords",[]),u(this,"PIECE_HEIGHT",void 0),u(this,"boardViewBox",void 0),u(this,"viewBox",void 0),u(this,"inspectedStackTransform",void 0),this.rules=F2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new K9t(this.rules,"HiveMinimax")],this.encoder=g2.encoder,this.tutorial=(new vce).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new J5(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Dr.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const i of this.getState().occupiedSpaces()){const s=this.getState().getAt(i),o=i.x,a=i.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new vdt);const l=s.pieces[s.size()-1-c];this.layers[c].initialize(new C(o,a),l)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=F2.get().shouldPass(this.getState());const n=F2.get().getGameStatus(this.node);switch(n){case ve.ONGOING:break;case ve.DRAW:this.highlight(this.getState().queenBeeLocation(I.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(I.ONE).get(),"victory-stroke");break;default:const s=n.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}}highlight(n,i){const s=this.getState().getAt(n).size();s-1 in this.layers&&this.layers[s-1].highlight(n,i)}pass(){var n=this;return P(function*(){return K.assert(n.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield n.chooseMove(g2.PASS)})()}computeViewBox(){const n=this.getPieceCoords().union(this.getAllNeighbors()).toList();n.push(new C(0,0)),this.boardViewBox=s4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH);const i=new s4(this.getRemainingPieceTransformAsCoord(new Qr(I.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let o=0;this.getState().remainingPieces.getAny(I.ZERO).isPresent()&&(o=s);let a=0;this.getState().remainingPieces.getAny(I.ONE).isPresent()&&(a=s);const c=this.boardViewBox.containingAtLeast(i).expand(0,0,o,a);if(this.inspectedStack.isPresent()){const l=new C(c.right()+this.SPACE_SIZE,c.center().y),f=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${l.x} ${l.y+3*(f-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const n=new Cce;for(const i of this.getAllNeighbors())n.initialize(i);return n}getAllNeighbors(){const n=new dt;for(const i of this.getPieceCoords())n.addAll(new dt(this.getState().emptyNeighbors(i)));return n.isEmpty()&&n.add(new C(0,0)),n}clearHighlights(){for(const n of this.layers)n.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=g.empty(),this.selectedRemaining=g.empty(),this.selectedSpiderCoords=[],this.inspectedStack=g.empty(),this.computeViewBox()}showLastMove(n){for(const i of this.getLastMoveCoords(n))this.highlight(i,"last-move-stroke"),this.ground.highlightStroke(i,"last-move-stroke"),this.ground.highlightFill(i,"moved-fill")}getLastMoveCoords(n){let i=[];return n instanceof Yo?i=[n.coord]:n instanceof Fi&&(i=[n.getStart(),n.getEnd()]),i}getRemainingPieceTransformAsCoord(n){const i=this.getRemainingPieceShift(n),s=this.boardViewBox.center().x+i*this.SPACE_SIZE*4;let o;return o=n.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new C(s,o)}getRemainingPieceTransform(n){const i=this.getRemainingPieceTransformAsCoord(n);return`translate(${i.x} ${i.y})`}getRemainingPieceHighlightTransform(n){const i=this.getRemainingPieceTransformAsCoord(n),s=this.getState().remainingPieces.getQuantity(n);return`translate(${i.x} ${i.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(n){switch(n.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return K.expectToBe(n.kind,"SoldierAnt"),1.5}}selectRemaining(n){var i=this;return P(function*(){const s=i.canUserPlay(`#remainingPiece_${n.toString()}`);if(s.isFailure())return i.cancelMove(s.getReason());if(n.owner===i.getCurrentPlayer().getOpponent())return i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==n.kind&&F2.get().mustPlaceQueenBee(i.getState()))return i.cancelMove(cr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(i.selectedRemaining.equalsValue(n))i.cancelMoveAttempt();else{i.cancelMoveAttempt(),i.selectedRemaining=g.of(n),i.clearHighlights();const o=F2.get().getPossibleDropLocations(i.getState()).toList();for(const a of o)i.ground.highlightStroke(a,"clickable-stroke")}return b.SUCCESS})()}selectStack(n,i){return this.select(new C(n,i),"piece")}selectSpace(n,i){return this.select(new C(n,i),"space")}select(n,i){var s=this;return P(function*(){const o=s.canUserPlay(`#${i}_${n.x}_${n.y}`);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState(),c=a.getAt(n);if(s.selectedRemaining.isPresent()){const l=g2.drop(s.selectedRemaining.get(),n);return s.chooseMove(l)}if(s.selectedStart.isPresent()){const l=a.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(n)?s.cancelMove():s.selectTarget(n,l)}return 0===c.size()?s.cancelMove():s.selectStart(n,c)})()}selectTarget(n,i){var s=this;return P(function*(){if("Spider"===i.kind)return s.selectNextSpiderSpace(n);{const o=g2.move(s.selectedStart.get(),n);return Ve(o.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(o.get())}})()}selectStart(n,i){var s=this;return P(function*(){const o=s.getState(),a=i.topPiece();return a.owner===o.getCurrentPlayer().getOpponent()?1===i.size()?s.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),b.SUCCESS):(s.highlight(n,"selected-stroke"),s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox(),b.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==a.kind&&F2.get().mustPlaceQueenBee(o)?s.cancelMove(cr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=g.of(n),s.highlight(n,"selected-stroke"),"Spider"===a.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),i.size()>1&&(s.inspectedStack=g.of(i),s.inspectedStackCoord=g.of(n),s.computeViewBox()),s.highlightNextPossibleCoords(n),b.SUCCESS))})()}highlightNextPossibleCoords(n){for(const i of this.getNextPossibleCoords(n))this.highlight(i,"clickable-stroke"),this.ground.highlightStroke(i,"clickable-stroke")}getNextPossibleCoords(n){const i=this.getState(),s=i.getAt(n).topPiece(),o=F2.get().getPossibleMovesFrom(i,n);return"Spider"===s.kind?o.filter(c=>He.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():o.map(a=>a.getEnd()).toList()}selectNextSpiderSpace(n){var i=this;return P(function*(){if(i.selectedSpiderCoords.push(n),4===i.selectedSpiderCoords.length){const o=g2.spiderMove(i.selectedSpiderCoords);return i.chooseMove(o)}const s=Rd.get().prefixLegality(i.selectedSpiderCoords,i.getState());if(s.isFailure())return i.cancelMove(s.getReason());i.clearHighlights(),i.highlight(i.selectedStart.get(),"selected-stroke");for(const o of i.selectedSpiderCoords)i.ground.select(o);return i.highlightNextPossibleCoords(i.selectedStart.get()),b.SUCCESS})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-hive"]],features:[Je],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,idt,2,4,"g",1),T(2,odt,2,1,"g",1),T(3,cdt,2,1,"g",1),T(4,ddt,3,2,"g",1),T(5,pdt,2,1,"g",1),T(6,gdt,1,2,"polygon",2),T(7,_dt,2,1,"g",3),S()),2&n&&(k("viewBox",i.viewBox),v(1),y("ngForOf",i.ground),v(1),y("ngForOf",i.ground),v(1),y("ngForOf",i.ground),v(1),y("ngForOf",i.layers),v(1),y("ngForOf",i.remainingStacks),v(1),y("ngIf",i.selectedRemaining.isPresent()),v(1),y("ngIf",i.inspectedStack.isPresent()))},dependencies:[Ft,Zt,Nt,rdt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();const ydt={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:I.ZERO};class Vc extends bL{static getInitialState(){const e=sn.UNOCCUPIED,t=sn.INVADERS,n=sn.DEFENDERS;return new Vc([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,n,e,e,e,e,t],[t,e,e,e,n,n,n,e,e,e,t],[t,t,e,n,n,sn.PLAYER_ONE_KING,n,n,e,t,t],[t,e,e,e,n,n,n,e,e,e,t],[t,e,e,e,e,n,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}of(e,t){return new Vc(e,t)}}class gs extends OL{static of(e,t){return new gs(e,t)}static from(e,t){try{const n=new gs(e,t);return se.success(n)}catch(n){return se.failure(n.message)}}getMaximalDistance(){return 11}}u(gs,"encoder",zs.getFallibleEncoder(gs.from));class Sl extends wL{static get(){return Sl.singleton.isAbsent()&&(Sl.singleton=g.of(new Sl)),Sl.singleton.get()}constructor(){super(Vc,ydt,gs.from)}}u(Sl,"singleton",g.empty());const N=sn.UNOCCUPIED,At=sn.INVADERS,lr=sn.DEFENDERS,EC=sn.PLAYER_ONE_KING;class Mce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Vc.getInitialState()),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Vc.getInitialState(),gs.of(new C(5,1),new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Vc([[N,N,N,N,At,At,At,At,N,N,N],[N,N,N,N,N,At,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[At,N,N,N,N,lr,N,N,N,N,At],[At,N,N,At,lr,lr,lr,N,N,N,At],[At,At,N,lr,lr,EC,lr,lr,N,At,At],[At,N,N,N,lr,lr,lr,N,N,N,At],[At,N,N,N,N,lr,N,N,N,N,At],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,At,N,N,N,N,N],[N,N,N,At,At,At,At,At,N,N,N]],1),[gs.of(new C(5,3),new C(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(gs.of(new C(3,0),new C(3,4))),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Vc([[N,N,N,At,At,At,At,At,N,N,N],[N,lr,N,N,N,At,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,lr,N,N,N,N,At],[At,N,N,N,N,lr,lr,N,N,N,At],[At,At,EC,N,lr,N,lr,lr,N,N,At],[N,N,At,N,N,lr,lr,N,N,N,At],[At,N,N,N,N,lr,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[N,N,N,At,At,At,At,N,At,N,N]],12),[gs.of(new C(3,0),new C(3,5)),gs.of(new C(3,10),new C(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Vc([[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[At,EC,N,At,N,N,N,N,N,N,N],[N,At,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[gs.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Vc([[N,N,At,EC,At,N,N,N,N,N,N],[N,N,N,N,N,N,lr,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,At,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N]],72),[gs.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function Mdt(r,e){1&r&&(A(),F(0,"polygon",8))}function Edt(r,e){1&r&&(A(),F(0,"rect",9))}function Sdt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Mdt,1,0,"polygon",6),T(2,Edt,1,0,"ng-template",null,7,dn),S()),2&r){const t=ln(3),n=p().index,i=p().index,s=p();v(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function Pdt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),S()),2&r){const t=p(2).index,n=p().index,i=p();v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Tdt(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function Odt(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function bdt(r,e){if(1&r&&(A(),T(0,Tdt,1,1,"polyline",14),T(1,Odt,4,20,"ng-template",null,15,dn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function wdt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"circle",10),T(2,Pdt,6,25,"g",11),T(3,bdt,3,2,"ng-template",null,12,dn),S()),2&r){const t=ln(4),n=p().index,i=p().index,s=p();v(1),ye("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),k("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),v(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function Ndt(r,e){if(1&r){const t=pe();A(),E(0,"g",3),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,Sdt,4,2,"g",5),T(3,wdt,5,8,"g",5),S()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),k("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),v(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),v(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Adt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Ndt,4,10,"g",2),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Idt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",17),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p();v(1),ye("id","click_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let kdt=(()=>{var r;class e extends NL{constructor(n){super(n,gs.from),this.rules=Sl.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new tu(this.rules,"DummyBot"),new sC(this.rules,"Piece > Influence"),new oC(this.rules,"Piece > Control"),new AL(this.rules,"Escape > Piece > Control")],this.encoder=gs.encoder,this.tutorial=(new Mce).tutorial}ngOnInit(){this.updateBoard()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-hnefatafl"]],features:[Je],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Adt,2,1,"g",1),T(2,Idt,2,6,"g",1),S()),2&n&&(k("viewBox",i.getViewBox()),v(1),y("ngForOf",i.board),v(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var Fc,SC,WL,m2;class Cn{static of(e){switch(e){case 0:return Cn.ANY;case 1:return Cn.ORANGE;case 2:return Cn.BLUE;case 3:return Cn.PURPLE;case 4:return Cn.PINK;case 5:return Cn.YELLOW;case 6:return Cn.RED;case 7:return Cn.GREEN;default:return K.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),Cn.BROWN}}constructor(e,t,n){u(this,"value",void 0),u(this,"name",void 0),u(this,"rgb",void 0),this.value=e,this.name=t,this.rgb=n}}u(Cn,"ANY",new(Fc=Cn)(0,"any","#000")),u(Cn,"ORANGE",new Fc(1,"orange","#d67421")),u(Cn,"BLUE",new Fc(2,"blue","#006bac")),u(Cn,"PURPLE",new Fc(3,"purple","#6f3787")),u(Cn,"PINK",new Fc(4,"pink","#d2719e")),u(Cn,"YELLOW",new Fc(5,"yellow","#e2c200")),u(Cn,"RED",new Fc(6,"red","#d23339")),u(Cn,"GREEN",new Fc(7,"green","#009157")),u(Cn,"BROWN",new Fc(8,"brown","#562500"));class gn{constructor(e,t){u(this,"player",void 0),u(this,"color",void 0),this.player=e,this.color=t}static of(e,t){return new gn(e,Cn.of(t))}static createPlayerColors(e){return{ORANGE:new gn(e,Cn.ORANGE),BLUE:new gn(e,Cn.BLUE),PURPLE:new gn(e,Cn.PURPLE),PINK:new gn(e,Cn.PINK),YELLOW:new gn(e,Cn.YELLOW),RED:new gn(e,Cn.RED),GREEN:new gn(e,Cn.GREEN),BROWN:new gn(e,Cn.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(X.NONE)}belongsTo(e){return this.player===e}}u(gn,"EMPTY",new(SC=gn)(X.NONE,Cn.ANY)),u(gn,"ZERO",SC.createPlayerColors(I.ZERO)),u(gn,"ONE",SC.createPlayerColors(I.ONE));class fi{static getColorAt(e,t){return fi.COLORS[t][e]}static getInitialBoard(){const e=gn.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>gn.of(I.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>gn.of(I.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(gn.EMPTY)}static allPieceCoords(e){const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++){const s=new C(i,n);!1===fi.isEmptyAt(e,s)&&t.push(s)}return t}}u(fi,"INITIAL",fi.getInitialBoard()),u(fi,"SIZE",8),u(fi,"COLORS",He.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Cn.of));class Xo extends F1{static isOnBoard(e){return e.isInRange(fi.SIZE,fi.SIZE)}static getInitialState(){return new Xo(0,Cn.ANY,g.empty(),!1,fi.INITIAL)}constructor(e,t,n,i,s){super(He.copyBiArray(s),e),u(this,"colorToPlay",void 0),u(this,"coordToPlay",void 0),u(this,"alreadyPassed",void 0),this.colorToPlay=t,this.coordToPlay=n,this.alreadyPassed=i}}class fu extends Li{constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}u(fu,"PASS",new(WL=fu)),u(fu,"encoder",Ie.constant("PASS",WL.PASS));class O0 extends Vo{static of(e,t){return K.assert(Xo.isOnBoard(e),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),K.assert(Xo.isOnBoard(t),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new O0(e,t)}constructor(e,t){super(e,t)}equals(e){return e===this||!!m2.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function xdt(r){return r instanceof fu}u(O0,"encoder",zs.getEncoder(O0.of)),function(r){r.PASS=fu.PASS,r.of=function e(n,i){return O0.of(n,i)},r.isPiece=function t(n){return n instanceof O0},r.encoder=Ie.disjunction([r.isPiece,xdt],[O0.encoder,fu.encoder])}(m2||(m2={}));let Hd=(()=>{class r{}return u(r,"NOT_RIGHT_COLOR",()=>$localize`This piece is not of the color you have to play.`),u(r,"DIRECTION_NOT_ALLOWED",()=>$localize`You can only move forward, orthogonally or diagonally.`),u(r,"MOVE_BLOCKED",()=>$localize`This move is blocked by another piece.`),u(r,"PLAY_WITH_SELECTED_PIECE",()=>$localize`You must play with the selected piece.`),r})();class _2 extends jn{static get(){return _2.singleton.isAbsent()&&(_2.singleton=g.of(new _2)),_2.singleton.get()}constructor(){super(Xo)}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new C(0,7),new C(1,7),new C(2,7),new C(3,7),new C(4,7),new C(5,7),new C(6,7),new C(7,7)]}static getMovablePieces(e){return _2.getColorMatchingPiece(e).filter(t=>{for(const n of this.playerDirections(e.getCurrentPlayer())){const i=t.getNext(n);if(e.isOnBoard(i)&&fi.isEmptyAt(e.board,i))return!0}return!1})}static playerDirections(e){return e===I.ONE?[Me.DOWN,Me.DOWN_LEFT,Me.DOWN_RIGHT]:[Me.UP,Me.UP_LEFT,Me.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===I.ZERO?e.y<0:e.y>0}static getListMovesFromState(e){const t=_2.getMovablePieces(e);return 0===t.length?(Ve(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[m2.PASS]):_2.getListMovesFromNonBlockedState(e,t)}static getListMovesFromNonBlockedState(e,t){const n=[],i=e.getCurrentPlayer();for(const s of t)for(const o of _2.playerDirections(i))for(let a=1;a<fi.SIZE;a++){const c=s.getNext(o,a);if(!e.isOnBoard(c)||!fi.isEmptyAt(e.board,c))break;{const l=m2.of(s,c);n.push(l)}}return n}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,n=0;return fi.allPieceCoords(e.board).forEach(i=>{const s=e.getPieceAt(i);Ve(s!==gn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),s.player===I.ONE?n=Math.max(n,i.y):t=Math.min(t,i.y)}),[t,n]}static isLegal(e,t){if(m2.isPiece(e)){const n=e.getStart(),i=e.getEnd(),s=t.colorToPlay,o=t.getPieceAt(n);if(!1===o.belongsTo(t.getCurrentPlayer()))return b.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(s!==Cn.ANY&&o.color!==s)return b.failure(Hd.NOT_RIGHT_COLOR());if(!1===t.getPieceAt(i).isEmpty())return b.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const c=Me.factory.fromMove(n,i);if(c.isFailure())return b.failure(Hd.DIRECTION_NOT_ALLOWED());const l=c.get();if(!1===_2.directionAllowedForPlayer(l,t.getCurrentPlayer()))return b.failure(Hd.DIRECTION_NOT_ALLOWED());let f=n;for(;!1===f.equals(i);)if(f=f.getNext(l),!1===t.getPieceAt(f).isEmpty())return b.failure(Hd.MOVE_BLOCKED());return b.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!1===e.alreadyPassed?b.SUCCESS:b.failure(Le.CANNOT_PASS())}nextCoordToPlay(e,t){return g.ofNullable(fi.allPieceCoords(e.board).find(n=>{const i=e.getPieceAt(n);return i.player===e.getCurrentOpponent()&&i.color===t}))}applyLegalMove(e,t,n){if(m2.isPiece(e)){const i=e.getStart(),s=e.getEnd(),o=t.getCopiedBoard();o[s.y][s.x]=o[i.y][i.x],o[i.y][i.x]=gn.EMPTY;const a=fi.getColorAt(s.x,s.y),c=this.nextCoordToPlay(t,a);return new Xo(t.turn+1,a,c,!1,o)}{const i=this.nextCoordToPlay(t,t.colorToPlay);return new Xo(t.turn+1,t.colorToPlay,i,!0,t.board)}}isLegal(e,t){return _2.isLegal(e,t)}getGameStatus(e){const t=e.gameState,n=t.getCurrentPlayer();if(_2.mustPass(t)&&t.alreadyPassed)return ve.getDefeat(n);const[i,s]=_2.getFurthestPiecePositions(t);return 7===s?ve.ONE_WON:0===i?ve.ZERO_WON:ve.ONGOING}}u(_2,"singleton",g.empty());class Ldt extends Hr{getListMoves(e){const t=_2.getListMovesFromState(e.gameState);return He.sortByDescending(t,n=>n.length()),t}getMetrics(e){const t=e.gameState,[n,i]=_2.getFurthestPiecePositions(t);return[7-n,i]}}const Z=gn.EMPTY,PC=gn.ZERO.ORANGE,TC=gn.ONE.ORANGE,OC=gn.ZERO.BLUE,bC=gn.ONE.BLUE,qL=gn.ZERO.PURPLE,Vd=gn.ONE.PURPLE,wC=gn.ZERO.PINK,NC=gn.ONE.PINK,AC=gn.ZERO.YELLOW,IC=gn.ONE.YELLOW,kC=gn.ZERO.RED,xC=gn.ONE.RED,LC=gn.ZERO.GREEN,RC=gn.ONE.GREEN,zC=gn.ZERO.BROWN,DC=gn.ONE.BROWN;class Pce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new Xo(5,Cn.ORANGE,g.empty(),!1,[[zC,bC,Vd,NC,IC,xC,RC,DC],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,TC,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,LC,kC,AC,wC,qL,OC,PC]])).withPreviousMove(m2.of(new C(0,7),new C(0,0))),W.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,Xo.getInitialState(),m2.of(new C(7,7),new C(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),W.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new Xo(1,Cn.PINK,g.of(new C(3,0)),!1,[[TC,bC,Vd,NC,IC,xC,RC,DC],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,OC,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[zC,LC,kC,AC,wC,qL,Z,PC]]),[m2.of(new C(3,0),new C(3,6)),m2.of(new C(3,0),new C(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(m2.of(new C(6,7),new C(6,5))),W.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new Xo(1,Cn.PINK,g.of(new C(3,6)),!1,[[TC,bC,Vd,Z,IC,xC,RC,DC],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,OC],[Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,NC,Z,Z,Z,Z],[zC,LC,kC,AC,wC,qL,Z,PC]])).withPreviousMove(m2.of(new C(6,5),new C(7,4))),W.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new Xo(2,Cn.RED,g.of(new C(2,4)),!1,[[Z,bC,Vd,Z,Z,xC,Z,Z],[Z,Z,Z,IC,Z,Z,Z,Z],[Z,Z,Z,NC,Z,Vd,Z,Z],[Z,Z,Z,AC,Z,Z,Z,Z],[Z,Z,kC,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,RC,Z],[TC,Z,Z,Z,Z,wC,Z,DC],[zC,LC,Z,Z,Z,Z,OC,PC]]),[m2.of(new C(2,4),new C(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(m2.of(new C(4,0),new C(3,1)))])}}function Rdt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p(),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.piecePlayerClass(n)),k("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function zdt(r,e){if(1&r&&(A(),F(0,"rect",9)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();k("x",o.SPACE_SIZE/2+n*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+s*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function Ddt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"g",4),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"rect",5),T(3,Rdt,1,4,"circle",6),T(4,zdt,1,7,"rect",7),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","click_",n,"_",i,""),v(1),k("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)("fill",s.backgroundColor(n,i)),v(1),y("ngIf",t!==s.UNOCCUPIED),v(1),y("ngIf",t!==s.UNOCCUPIED)}}function Hdt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Ddt,5,9,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Vdt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"rect",10)(2,"rect",10),S()),2&r){const t=p();v(1),ye("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),k("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),v(1),ye("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),k("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Fdt(r,e){if(1&r&&(A(),F(0,"circle",11)),2&r){const t=p();k("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let $dt=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"UNOCCUPIED",gn.EMPTY),u(this,"lastMove",g.empty()),u(this,"lastPieceMove",g.empty()),u(this,"chosen",g.empty()),u(this,"chosenAutomatically",!1),this.hasAsymmetricBoard=!0,this.rules=_2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Ldt(this.rules,"KamisadoMinimax")],this.encoder=m2.encoder,this.tutorial=(new Pce).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(n,i){return fi.getColorAt(n,i).rgb}isPlayerZero(n){return n.player===I.ZERO}pieceColor(n){return n.color.rgb}piecePlayerClass(n){return this.getPlayerClass(n.player)}updateBoard(){const n=this.getState();this.board=n.getCopiedBoard(),this.lastPieceMove=g.empty(),this.canPass=_2.mustPass(n);const i=this.rules.getGameStatus(this.node)!==ve.ONGOING;this.canPass||n.coordToPlay.isAbsent()||i?(this.chosenAutomatically=!1,this.chosen=g.empty()):(this.chosenAutomatically=!0,this.chosen=n.coordToPlay)}showLastMove(n){m2.isPiece(n)&&(this.lastPieceMove=g.of(n))}pass(){var n=this;return P(function*(){return Ve(n.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),n.chooseMove(m2.PASS)})()}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.canPass)return s.cancelMove(Le.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(n,i);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;{const c=s.getState().getPieceAtXY(n,i),l=s.getState().getCurrentPlayer();return c.belongsTo(l)?s.chosenAutomatically?s.cancelMove(Hd.PLAY_WITH_SELECTED_PIECE()):(s.chosen=g.of(a),b.SUCCESS):yield s.chooseDestination(n,i)}})()}choosePiece(n,i){const s=this.getState().getPieceAtXY(n,i),o=this.getState().getCurrentOpponent();return s.belongsTo(o)?this.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=g.of(new C(n,i)),b.SUCCESS)}chooseDestination(n,i){var s=this;return P(function*(){const o=s.chosen.get(),a=new C(n,i),c=m2.of(o,a);return s.chooseMove(c)})()}cancelMoveAttempt(){!1===this.chosenAutomatically&&(this.chosen=g.empty())}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-kamisado"]],features:[Je],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Hdt,2,1,"g",1),T(2,Vdt,3,12,"g",2),T(3,Fdt,1,3,"circle",3),S()),2&n&&(k("viewBox",i.getViewBox())("transform",i.rotation),v(1),y("ngForOf",i.board),v(1),y("ngIf",i.lastPieceMove.isPresent()),v(1),y("ngIf",i.chosen.isPresent()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Tce=(()=>{var r;class e extends Hi{getParallelogramCoords(n){const i=n.parallelogramHeight,s=i*n.horizontalWidthRatio,o=i*n.offsetRatio,a=s,l=s-o,f=i,d=-o,m=i;return[new C(0,0),new C(a,0),new C(l,f),new C(d,m)]}getCoordTranslate(n,i,s,o){const a=o.parallelogramHeight;return new C(n*(a*o.horizontalWidthRatio)+o.offsetRatio*a*(o.abstractBoardSize-i),i*a-o.pieceHeightRatio*a*s)}}return r=e,u(e,"\u0275fac",function(){let t;return function(i){return(t||(t=nr(r)))(i||r)}}()),u(e,"\u0275cmp",Xe({type:r,selectors:[["ng-component"]],features:[Je],decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})(),o4=(()=>{class r{}return u(r,"CANNOT_GO_BACKWARD",()=>$localize`You cannot go backward with normal pieces!`),u(r,"CANNOT_CAPTURE_EMPTY_SPACE",()=>$localize`You cannot capture an empty square, nor jump over it!`),u(r,"CANNOT_SKIP_CAPTURE",()=>$localize`You must capture when it is possible!`),u(r,"MUST_FINISH_CAPTURING",()=>$localize`You must finish this capture!`),u(r,"THIS_PIECE_CANNOT_MOVE",()=>$localize`This piece cannot move!`),u(r,"CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL",()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`),u(r,"MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL",()=>$localize`You must move in a single diagonal step!`),u(r,"CANNOT_CAPTURE_TWICE_THE_SAME_COORD",()=>$localize`You cannot jump over the same square several times!`),r})();var Fd;class $2{static getPlayerOfficer(e){return e===I.ZERO?$2.ZERO_OFFICER:$2.ONE_OFFICER}constructor(e,t){u(this,"player",void 0),u(this,"isOfficer",void 0),this.player=e,this.isOfficer=t}toString(){switch(this){case $2.ZERO:return"u";case $2.ONE:return"v";case $2.ZERO_OFFICER:return"O";default:return K.expectToBe(this,$2.ONE_OFFICER),"X"}}equals(e){return this===e}}u($2,"ZERO",new(Fd=$2)(I.ZERO,!1)),u($2,"ONE",new Fd(I.ONE,!1)),u($2,"ZERO_OFFICER",new Fd(I.ZERO,!0)),u($2,"ONE_OFFICER",new Fd(I.ONE,!0));class ms{constructor(e){u(this,"pieces",void 0),this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new ms(this.pieces.slice(1))}capturePiece(e){return new ms(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const n of e.pieces)t=t.capturePiece(n);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=$2.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new ms([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),n="";for(;t>0;)n+="_",t--;for(const i of this.pieces)n+=i.toString();return n}}u(ms,"EMPTY",new ms([]));let f1=(()=>{class r extends F1{static getInitialState(){const t=new ms([$2.ZERO]),n=new ms([$2.ONE]),i=ms.EMPTY;return new r([[n,i,n,i,n,i,n],[i,n,i,n,i,n,i],[n,i,n,i,n,i,n],[i,i,i,i,i,i,i],[t,i,t,i,t,i,t],[i,t,i,t,i,t,i],[t,i,t,i,t,i,t]],0)}static of(t,n){return new r(t,n)}static isNotOnBoard(t){return t.isNotInRange(r.SIZE,r.SIZE)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}getStacksOf(t){const n=[];for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++)this.getPieceAtXY(s,i).isCommandedBy(t)&&n.push(new C(s,i));return n}set(t,n){const i=this.getCopiedBoard();return i[t.y][t.x]=n,new r(i,this.turn)}remove(t){return this.set(t,ms.EMPTY)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===I.ZERO?0:r.SIZE-1}toString(){let t=1;for(let i=0;i<r.SIZE;i++)for(let s=0;s<r.SIZE;s++){const o=this.getPieceAtXY(s,i).getStackSize();t=Math.max(t,o)}const n=[];for(let i=0;i<r.SIZE;i++){const s=[];for(let o=0;o<r.SIZE;o++)s.push(this.getPieceAtXY(o,i).toString(t));n.push(s.join(" "))}return n.join("\n")}}return u(r,"SIZE",7),r})();class Bdt extends dt{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===Ro(e.get(t),this.get(t)))return!1;return!0}get(e){return K.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return K.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}var bce;class Fr extends Li{static of(e,t){return new Fr(e,t)}static fromCapture(e){const t=Fr.getSteppedOverCoords(e);return t.isSuccess()?se.success(new Fr(e,!1)):se.failure(t.getReason())}static getSteppedOverCoords(e){let t=g.empty();const n=new dt;for(const i of e){if(f1.isNotOnBoard(i))return se.failure(X5.OUT_OF_RANGE(i));if(t.isPresent()){const s=t.get();if(!1===s.getVectorToward(i).isDiagonalOfLength(2))return se.failure(o4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const a=s.getCoordsToward(i)[0];if(n.contains(a))return se.failure(o4.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());n.add(a)}t=g.of(i)}return se.success(n)}static fromStep(e,t){return f1.isNotOnBoard(e)?se.failure(X5.OUT_OF_RANGE(e)):f1.isNotOnBoard(t)?se.failure(X5.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?se.failure(o4.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):se.success(new Fr([e,t],!0))}constructor(e,t){super(),u(this,"isStep",void 0),u(this,"coords",void 0),this.isStep=t,this.coords=new Bdt(e)}toString(){return"LascaMove("+this.coords.toList().map(n=>n.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),n=e.coords.size(),i=Math.min(t,n);for(let s=0;s<i;s++)if(!1===this.coords.toList()[s].equals(e.coords.toList()[s]))return"INEQUALITY";return t===n?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Fr.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),n=e.coords.toList()[0];Ve(t.equals(n),"should not concatenate non-touching move");const i=this.coords.toList(),s=He.copyImmutableArray(i),o=e.coords.toList(),a=He.copyImmutableArray(o).slice(1);return Fr.fromCapture(s.concat(a)).get()}}bce=Fr,u(Fr,"encoder",Ie.tuple([Ie.list(C.encoder),Ie.identity()],r=>[r.coords.toList(),r.isStep],r=>bce.of(r[0],r[1])));class _s extends jn{static get(){return _s.singleton.isAbsent()&&(_s.singleton=g.of(new _s)),_s.singleton.get()}constructor(){super(f1)}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceCaptures(e,s));return n}getPieceCaptures(e,t){let n=[];const o=e.getPieceAt(t).getCommander().player.getOpponent(),a=this.getPieceDirections(e,t),c=e.getPieceAt(t);for(const l of a){const f=t.getNext(l,1);if(f1.isOnBoard(f)&&e.getPieceAt(f).isCommandedBy(o)){const d=f.getNext(l,1);if(f1.isOnBoard(d)&&e.getPieceAt(d).isEmpty()){const m=e.remove(t).remove(f).set(d,c),M=Fr.fromCapture([t,d]).get(),w=this.getPieceCaptures(m,d);if(0===w.length)n=n.concat(M);else{const L=w.map(z=>M.concatenate(z));n=n.concat(L)}}}}return n}getPieceDirections(e,t){const s=e.getPieceAt(t).getCommander().player.getScoreModifier(),o=[Me.factory.fromDelta(-1,s).get(),Me.factory.fromDelta(1,s).get()];return e.getPieceAt(t).getCommander().isOfficer&&o.push(Me.factory.fromDelta(-1,-s).get(),Me.factory.fromDelta(1,-s).get()),o}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const n=[],i=e.getStacksOf(t);for(const s of i)n.push(...this.getPieceSteps(e,s));return n}getPieceSteps(e,t){const n=[],i=this.getPieceDirections(e,t);for(const s of i){const o=t.getNext(s,1);if(f1.isOnBoard(o)&&e.getPieceAt(o).isEmpty()){const a=Fr.fromStep(t,o).get();n.push(a)}}return n}applyLegalMove(e,t,n){const i=e.getStartingCoord(),s=e.getEndingCoord();let o=t.getPieceAt(i),a=t.remove(i);if(!1===e.isStep)for(const c of e.getCapturedCoords().get()){const l=t.getPieceAt(c),f=l.getCommander();o=o.capturePiece(f);const d=l.getPiecesUnderCommander();a=a.set(c,d)}if(a=a.set(s,o),s.y===t.getFinishLineOf(t.getCurrentPlayer())){const c=o.promoteCommander();a=a.set(s,c)}return a.incrementTurn()}isLegal(e,t){const n=e.getStartingCoord();if(t.getPieceAt(n).isEmpty())return b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const i=t.getPieceAt(n),s=t.getCurrentOpponent();if(i.isCommandedBy(s))return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());const o=e.coords.get(1);if(!1===i.getCommander().isOfficer&&n.getDirectionToward(o).get().y===s.getScoreModifier())return b.failure(o4.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(o).isEmpty())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const a=this.getCaptures(t);return e.isStep?a.length>0?b.failure(o4.CANNOT_SKIP_CAPTURE()):b.SUCCESS:this.isLegalCapture(e,t,a)}isLegalCapture(e,t,n){const i=t.getCurrentPlayer(),s=e.getCapturedCoords().get();for(const o of s){const a=t.getPieceAt(o);if(a.isCommandedBy(i))return b.failure(Le.CANNOT_SELF_CAPTURE());if(a.isEmpty())return b.failure(o4.CANNOT_CAPTURE_EMPTY_SPACE())}return n.some(o=>o.equals(e))?b.SUCCESS:b.failure(o4.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?ve.ONGOING:ve.getVictory(t.getCurrentOpponent())}}u(_s,"singleton",g.empty());class $d extends uo{constructor(e){super(_s.get(),e)}static getListMoves(e){const t=_s.get().getCaptures(e.gameState);return t.length>0?t:_s.get().getSteps(e.gameState)}getListMoves(e){return $d.getListMoves(e)}getBoardValue(e){const t=_s.get().getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=e.gameState,i=this.getNumberOfMobileCoords(n,I.ZERO),s=this.getNumberOfMobileCoords(n,I.ONE);return an.of(i,s)}getNumberOfMobileCoords(e,t){const i=this.getCapturesAndSteps(e,t).map(o=>o.getStartingCoord());return new dt(i).size()}getCapturesAndSteps(e,t){const n=_s.get().getCapturesOf(e,t),i=_s.get().getStepsOf(e,t);return n.concat(i)}}class Gdt extends $d{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(e){const t=_s.get().getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const n=12*super.getBoardValue(e).value;let i=0;for(let s=0;s<f1.SIZE;s++)for(let o=0;o<f1.SIZE;o++){const a=e.gameState.getPieceAtXY(o,s);if(a.getStackSize()>0){const c=a.getStackSize();let l=0;const f=a.getCommander().player;for(;l<c&&a.get(l).player===f;)l++;i+=l*f.getScoreModifier()}}return new an(n+i)}}const wce=$2.ZERO,jL=$2.ONE,$r=new ms([wce]),k1=new ms([jL]),Udt=new ms([wce,jL]),Wdt=new ms([$2.ZERO_OFFICER,jL]),j=ms.EMPTY;class Nce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,f1.getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,f1.getInitialState()),W.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,f1.getInitialState(),Fr.fromStep(new C(4,4),new C(3,3)).get(),$localize`Congratulations!`),W.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,f1.of([[k1,j,j,j,k1,j,k1],[j,j,j,k1,j,k1,j],[j,j,k1,j,k1,j,k1],[j,k1,j,j,j,j,j],[$r,j,$r,j,$r,j,$r],[j,$r,j,$r,j,$r,j],[$r,j,$r,j,$r,j,$r]],2),Fr.fromCapture([new C(2,4),new C(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),W.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,f1.of([[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[k1,j,j,j,k1,j,k1],[j,k1,j,k1,j,k1,j],[j,j,k1,j,k1,j,k1],[j,k1,j,j,j,j,j],[j,j,$r,j,$r,j,$r]],2),Fr.fromCapture([new C(2,6),new C(0,4),new C(2,2)]).get(),$localize`Congratulations!`),W.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,f1.of([[j,j,j,j,j,j,j],[j,j,j,j,j,k1,j],[j,j,j,j,j,j,j],[j,k1,j,k1,j,j,j],[j,j,$r,j,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j]],2)),W.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,f1.of([[j,j,j,j,j,j,k1],[j,j,j,Udt,j,k1,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,j,$r,j,$r,j,$r]],2),[Fr.fromStep(new C(3,1),new C(2,0)).get(),Fr.fromStep(new C(3,1),new C(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),W.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,f1.of([[j,j,j,j,Wdt,j,k1],[j,j,j,j,j,j,j],[j,j,j,j,k1,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,j,j,j,j,j,j],[j,j,$r,j,$r,j,$r]],2),[Fr.fromStep(new C(4,0),new C(3,1)).get(),Fr.fromStep(new C(4,0),new C(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)])}}function qdt(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p().index,a=p();Ti("id","square_",s,"_",o,"_piece_",n,"_officer_symbol"),y("ngClass",i.classes),k("cx",.4*a.SPACE_SIZE)("cy",.575*a.SPACE_SIZE)("r",.045*a.SPACE_SIZE)}}function jdt(r,e){if(1&r&&(A(),E(0,"g",10),F(1,"use",11),T(2,qdt,1,7,"circle",12),S()),2&r){const t=e.$implicit,n=e.index,i=p().index,s=p().index;k("transform",p().getPieceTranslate(n)),v(1),Ti("id","square_",i,"_",s,"_piece_",n,""),y("ngClass",t.classes),v(1),y("ngIf",t.isOfficer)}}function Zdt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"g",7),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"polygon",8),T(3,jdt,3,6,"g",9),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","coord_",n,"_",i,""),k("transform",s.getTranslate(n,i,0)),v(1),ye("id","square_",n,"_",i,""),y("ngClass",t.squareClasses),k("points",s.getParallelogramPoints()),v(1),y("ngForOf",t.pieceInfos)}}function Ydt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Zdt,4,8,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}let Kdt=(()=>{var r;class e extends Tce{constructor(n){super(n),u(this,"THICKNESS",40),u(this,"mode",{horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:f1.SIZE}),u(this,"LEFT",0),u(this,"UP",-this.SPACE_SIZE),u(this,"basicWidth",this.mode.abstractBoardSize*this.mode.parallelogramHeight),u(this,"WIDTH",this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio)),u(this,"HEIGHT",this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP),u(this,"CX",this.WIDTH/2),u(this,"CY",(this.HEIGHT+this.UP)/2),u(this,"adaptedBoard",{isAlreadySwitched:!1,spaceInfo:[]}),u(this,"lastMove",g.empty()),u(this,"currentMoveClicks",[]),u(this,"capturedCoords",[]),u(this,"legalMoves",[]),this.hasAsymmetricBoard=!0,this.rules=_s.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new $d("Lasca Control Minimax"),new Gdt],this.encoder=Fr.encoder,this.tutorial=(new Nce).tutorial,this.canPass=!1,this.updateBoard()}updateBoard(){this.lastMove=this.node.move;const n=this.getState();this.board=n.getCopiedBoard(),this.legalMoves=$d.getListMoves(this.node),this.createAdaptedBoardFrom(n),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}createAdaptedBoardFrom(n){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let o=0;o<f1.SIZE;o++){const a=[];for(let c=0;c<f1.SIZE;c++){const l=this.getSpaceInfo(n,c,o);a.push(l)}this.adaptedBoard.spaceInfo.push(a)}const s=g.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const o=s.get();for(const a of this.getSpaceInfoAt(o).pieceInfos)a.classes.push("selected-stroke");this.showPossibleLandings(o,n)}for(const o of this.capturedCoords)this.getSpaceInfoAt(o).squareClasses.push("captured-fill");for(const o of this.currentMoveClicks)this.getSpaceInfoAt(o).squareClasses.push("moved-fill")}getSpaceInfo(n,i,s){const o=n.getPieceAtXY(i,s),a=[];for(let c=o.getStackSize()-1;c>=0;c--){const l=o.get(c);a.push({classes:[this.getPlayerClass(l.player)],isOfficer:l.isOfficer})}return{pieceInfos:a,squareClasses:[]}}showLastMove(n){this.showLastCapture(n),this.showSteppedOnCoord(n)}showLastCapture(n){if(!1===n.isStep){const i=n.getCapturedCoords();K.assert(i.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of i.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(n){for(const i of n.coords)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}showPossibleMoves(){for(const n of this.legalMoves){const i=n.getStartingCoord();this.getSpaceInfoAt(i).squareClasses.push("selectable-fill")}}getSpaceInfoAt(n){if(this.role===I.ONE&&this.adaptedBoard.isAlreadySwitched){const i=f1.SIZE-1,s=new C(i-n.x,i-n.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[n.y][n.x]}rotateAdaptedBoardIfNeeded(){if(this.role===I.ONE){const n=[];for(let i=0;i<f1.SIZE;i++){n[f1.SIZE-1-i]=[];for(let s=0;s<f1.SIZE;s++)n[f1.SIZE-1-i][f1.SIZE-1-s]=this.getSpaceInfoAt(new C(s,i))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:n}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(n,i){var s=this;return P(function*(){s.role===I.ONE&&(n=f1.SIZE-1-n,i=f1.SIZE-1-i);const o=s.canUserPlay("#coord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i),c=s.getState().getPieceAt(a),l=s.getState().getCurrentOpponent();return c.isCommandedBy(l)?s.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(a):s.moveClick(a)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(n){var i=this;return P(function*(){if(n.equals(i.currentMoveClicks[0]))return i.cancelMoveAttempt(),b.SUCCESS;const s=i.getState().getPieceAt(n),o=i.getState().getCurrentPlayer();if(s.isCommandedBy(o))return i.cancelMoveAttempt(),i.trySelectingPiece(n);if(1===i.currentMoveClicks.length&&i.currentMoveClicks[0].getVectorToward(n).isDiagonalOfLength(1)){const c=Fr.fromStep(i.currentMoveClicks[0],n).get();return i.chooseMove(c)}return i.capture(n)})()}capture(n){var i=this;return P(function*(){const o=i.currentMoveClicks[i.currentMoveClicks.length-1],a=o.getVectorToward(n);if(a.isDiagonalOfLength(2)){const c=new C(o.x+a.x/2,o.y+a.y/2);i.capturedCoords.push(c),i.currentMoveClicks.push(n);const l=Fr.fromCapture(i.currentMoveClicks).get();return i.legalMoves.some(f=>f.isPrefix(l))?i.applyPartialCapture():i.chooseMove(l)}return i.cancelMove(o4.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let n=this.getState().remove(this.currentMoveClicks[0]),i=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const o of this.capturedCoords){const a=this.getState().getPieceAt(o),c=a.getCommander(),l=a.getPiecesUnderCommander();n=n.set(o,l),i=i.capturePiece(c)}return n=n.set(this.currentMoveClicks[this.currentMoveClicks.length-1],i),this.createAdaptedBoardFrom(n),this.rotateAdaptedBoardIfNeeded(),b.SUCCESS}trySelectingPiece(n){var i=this;return P(function*(){return i.getState().getPieceAt(n).isEmpty()?i.cancelMove(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.selectPiece(n)})()}selectPiece(n){return this.capturedCoords=[],this.legalMoves.some(i=>i.getStartingCoord().equals(n))?(this.currentMoveClicks=[n],this.hideLastMove(),b.SUCCESS):this.cancelMove(o4.THIS_PIECE_CANNOT_MOVE())}showPossibleLandings(n,i){const s=this.rules.getPieceCaptures(i,n);if(0===s.length){const o=this.rules.getPieceSteps(i,n);for(const a of o)this.getSpaceInfoAt(a.getEndingCoord()).squareClasses.push("selectable-fill")}else{const o=s.map(a=>a.coords.get(1));for(const a of o)this.getSpaceInfoAt(a).squareClasses.push("capturable-fill")}}getTranslate(n,i,s){const o=this.getCoordTranslate(n,i,s,this.mode);return"translate("+o.x+" "+o.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(i=>i.x+", "+i.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const n=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(n[0],n[1],n[2],n[3])}getParallelogramCenterOf(n,i,s,o){const a=Math.max(n.x,i.x,s.x,o.x),c=Math.max(n.y,i.y,s.y,o.y),l=Math.min(n.x,i.x,s.x,o.x),f=Math.min(n.y,i.y,s.y,o.y);return new C((a-l)/2,(c-f)/2)}getRightEdge(){const n=this.basicWidth*this.mode.horizontalWidthRatio,i=this.basicWidth*this.mode.offsetRatio;return[i+n,0,i+n,this.THICKNESS,n,this.basicWidth+this.THICKNESS,n,this.basicWidth].join(" ")}getPieceTranslate(n){return"translate(0 "+(this.getParallelogramCenter().y-32.5-n*(.15*this.SPACE_SIZE))+")"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-lasca"]],features:[Je],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"defs")(2,"g",1),F(3,"path",2)(4,"ellipse",3),S()(),T(5,Ydt,2,1,"g",4),F(6,"rect",5)(7,"polygon",6),S()),2&n&&(k("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),v(5),y("ngForOf",i.adaptedBoard.spaceInfo),v(1),k("y",i.basicWidth)("width",i.basicWidth*i.mode.horizontalWidthRatio)("height",i.THICKNESS),v(1),k("points",i.getRightEdge()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),di=(()=>{class r extends F1{static getInitialState(){const t=X.NONE,n=X.ZERO,i=X.ONE;return new r([[t,n,n,n,n,n,n,t],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[i,t,t,t,t,t,t,i],[t,n,n,n,n,n,n,t]],0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}}return u(r,"SIZE",8),r})();class $i extends Vo{static from(e,t){const n=Me.factory.fromMove(e,t);return n.isFailure()?se.failure(n.getReason()):e.isNotInRange(di.SIZE,di.SIZE)?se.failure("start coord is not in range"):t.isNotInRange(di.SIZE,di.SIZE)?se.failure("end coord is not in range"):se.success(new $i(e,t,n.get()))}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n,this.direction=Me.factory.fromMove(e,t).get()}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}u($i,"encoder",zs.getFallibleEncoder($i.from));let ZL=(()=>{class r{}return u(r,"INVALID_MOVE_LENGTH",()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`),u(r,"CANNOT_JUMP_OVER_OPPONENT",()=>$localize`You cannot jump over the opponent's pieces.`),u(r,"PIECE_CANNOT_MOVE",()=>$localize`This piece has no possible move, select another one.`),r})();class Br extends jn{static get(){return Br.singleton.isAbsent()&&(Br.singleton=g.of(new Br)),Br.singleton.get()}constructor(){super(di)}static getListMovesFromState(e){const t=[];if(Br.getVictory(e).isPresent())return t;for(let n=0;n<di.SIZE;n++)for(let i=0;i<di.SIZE;i++){const s=new C(i,n);if(e.getPieceAt(s).isPlayer())for(const a of Br.possibleTargets(e,s)){const c=$i.from(s,a).get();t.push(c)}}return t}static getNumberOfGroups(e){const t=He.createTable(di.SIZE,di.SIZE,-1),n=[0,0];let i=0;for(const s of e.getCoordsAndContents())-1===t[s.coord.y][s.coord.x]&&s.content.isPlayer()&&(i+=1,Br.markGroupStartingAt(e,t,s.coord,i),n[s.content.value]+=1);return n}static markGroupStartingAt(e,t,n,i){const s=[n],o=e.getPieceAt(n);for(;s.length>0;){const a=K.getNonNullable(s.pop());if(-1===t[a.y][a.x]){const c=e.getPieceAt(a);if(c===o){t[a.y][a.x]=i;for(const l of Me.DIRECTIONS){const f=a.getNext(l);e.isOnBoard(f)&&s.push(f)}}else c===X.NONE&&(t[a.y][a.x]=0)}}}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getStart().y][e.getStart().x]=X.NONE,i[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new di(i,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?b.failure(Le.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?b.failure(ZL.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(n=>t.getPieceAt(n)===t.getCurrentOpponent())?b.failure(ZL.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?b.failure(Le.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):b.SUCCESS}isLegal(e,t){return Br.isLegal(e,t)}static numberOfPiecesOnLine(e,t,n){let i=0;for(const s of Br.getLineCoords(t,n))e.getPieceAt(s).isPlayer()&&(i+=1);return i}static getLineCoords(e,t){const n=Br.getEntranceAndForwardDirection(e,t);let i=n[0];const s=n[1],o=[];for(;di.isOnBoard(i);)o.push(i),i=i.getNext(s);return o}static getEntranceAndForwardDirection(e,t){switch(t){case Me.UP:case Me.DOWN:return[new C(e.x,0),Me.DOWN];case Me.LEFT:case Me.RIGHT:return[new C(0,e.y),Me.RIGHT];case Me.UP_RIGHT:case Me.DOWN_LEFT:return[new C(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),Me.UP_RIGHT];default:return K.expectToBeMultiple(t,[Me.UP_LEFT,Me.DOWN_RIGHT]),[new C(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),Me.DOWN_RIGHT]}}static getVictory(e){const[t,n]=Br.getNumberOfGroups(e);return 1===t&&1===n?g.of(X.NONE):1===t?g.of(I.ZERO):1===n?g.of(I.ONE):g.empty()}static possibleTargets(e,t){const n=[];for(const i of Me.DIRECTIONS){const s=Br.numberOfPiecesOnLine(e,t,i),o=t.getNext(i,s);if(e.isOnBoard(o)){const a=$i.from(t,o).get();Br.isLegal(a,e).isSuccess()&&n.push(o)}}return n}getGameStatus(e){const t=e.gameState,[n,i]=Br.getNumberOfGroups(t);return 1===n&&i>1?ve.ZERO_WON:n>1&&1===i?ve.ONE_WON:ve.ONGOING}}u(Br,"singleton",g.empty());class Xdt extends Hr{getListMoves(e){return Br.getListMovesFromState(e.gameState)}getMetrics(e){const t=e.gameState,[n,i]=Br.getNumberOfGroups(t);return[100/n,100/i]}}const V=X.NONE,C1=X.ZERO,d1=X.ONE;class Ice{constructor(){u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new di([[V,V,V,V,V,V,V,V],[d1,V,V,V,C1,V,V,d1],[V,V,C1,C1,d1,V,V,V],[V,V,V,C1,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V]],0)),W.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,di.getInitialState(),$i.from(new C(1,7),new C(1,5)).get(),$localize`Congratulations!`),W.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new di([[V,V,V,V,V,V,V,V],[V,V,d1,C1,C1,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,d1],[V,V,V,V,V,V,V,C1]],0),[$i.from(new C(3,1),new C(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),W.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new di([[V,V,V,V,V,V,d1,V],[V,V,V,V,V,C1,V,V],[V,V,V,V,d1,V,V,V],[V,V,V,C1,V,V,V,V],[V,V,V,V,V,V,V,d1],[V,V,V,V,V,d1,V,d1],[V,V,V,C1,V,V,d1,d1],[V,V,V,C1,V,V,V,V]],0),[$i.from(new C(3,3),new C(3,0)).get(),$i.from(new C(3,3),new C(0,0)).get(),$i.from(new C(3,3),new C(2,3)).get(),$i.from(new C(3,3),new C(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),W.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new di([[V,C1,V,C1,C1,C1,C1,V],[d1,V,V,V,V,V,V,d1],[V,V,C1,V,d1,V,V,V],[d1,V,V,V,V,V,V,d1],[d1,V,V,V,V,V,V,d1],[d1,V,V,V,V,V,V,d1],[d1,V,V,V,V,V,V,d1],[V,C1,C1,C1,C1,C1,C1,V]],0),$i.from(new C(2,2),new C(4,2)).get(),(e,t,n)=>t.getPieceAt(e.getEnd())===X.ONE?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations!`),W.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new di([[V,V,V,V,V,V,V,V],[V,V,V,V,V,V,V,V],[C1,V,V,C1,d1,C1,V,V],[V,V,V,C1,V,V,V,d1],[V,V,V,V,V,V,V,d1],[V,V,V,V,V,V,V,d1],[V,V,V,V,V,V,V,d1],[V,V,V,V,V,V,V,V]],0),[$i.from(new C(0,2),new C(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}function Qdt(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("cx",i.SPACE_SIZE/2+t*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Jdt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"g",3),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(2,"rect",4),T(3,Qdt,1,6,"circle",5),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","click_",n,"_",i,""),v(1),ye("id","space_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),k("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t!==s.EMPTY)}}function eht(r,e){if(1&r&&(A(),E(0,"g"),T(1,Jdt,4,10,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function tht(r,e){if(1&r){const t=pe();A(),E(0,"rect",6),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()}if(2&r){const t=e.$implicit,n=p();k("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}let nht=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"EMPTY",X.NONE),u(this,"targets",[]),u(this,"state",void 0),u(this,"selected",g.empty()),u(this,"lastMove",g.empty()),u(this,"captured",g.empty()),this.rules=Br.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Xdt(this.rules,"LinesOfActionMinimax")],this.encoder=$i.encoder,this.tutorial=(new Ice).tutorial,this.updateBoard()}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.selected.equalsValue(a))return s.cancelMoveAttempt(),b.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(a)===c?s.select(a):s.concludeMove(a)})()}concludeMove(n){var i=this;return P(function*(){const s=$i.from(i.selected.get(),n);return s.isSuccess()?i.chooseMove(s.get()):i.cancelMove(s.getReason())})()}select(n){var i=this;return P(function*(){return i.getState().getPieceAt(n)!==i.getState().getCurrentPlayer()?i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):(i.selected=g.of(n),i.targets=Br.possibleTargets(i.getState(),i.selected.get()),0===i.targets.length?i.cancelMove(ZL.PIECE_CANNOT_MOVE()):b.SUCCESS)})()}updateBoard(){this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.node.move}showLastMove(n){this.captured=this.getPreviousState().getPieceAt(n.getEnd()).isPlayer()?g.of(n.getEnd()):g.empty()}cancelMoveAttempt(){this.selected=g.empty(),this.targets=[]}getSquareClasses(n,i){const s=new C(n,i);if(this.lastMove.isPresent()){const o=this.lastMove.get().getStart(),a=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(o)||s.equals(a))return["moved-fill"]}return[]}getPieceClasses(n,i){const s=this.board[i][n],o=new C(n,i),a=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(o)&&a.push("selected-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-linesofaction"]],features:[Je],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,eht,2,1,"g",1),T(2,tht,1,4,"rect",2),S()),2&n&&(v(1),y("ngForOf",i.board),v(1),y("ngForOf",i.targets))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var kce,YL,KL,a4,XL;class $c extends Mr{constructor(e,t,n,i={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),u(this,"direction",void 0),u(this,"orientation",void 0),u(this,"captures",void 0),this.direction=t,this.orientation=n,this.captures=i}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}kce=$c,u($c,"encoder",new class extends Ie{encode(r){return{coord:C.encoder.encode(r.coord),direction:r.direction,orientation:r.orientation,captures:r.captures}}decode(r){const e=r;return Ve(null!=e.coord,"Invalid encoded LodestoneMove"),Ve(null!=e.direction,"Invalid encoded LodestoneMove"),Ve(null!=e.orientation,"Invalid encoded LodestoneMove"),Ve(null!=e.captures,"Invalid encoded LodestoneMove"),new kce(C.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}});class vs{constructor(e){u(this,"unreachable",void 0),this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}u(vs,"UNREACHABLE",new(YL=vs)(!0)),u(vs,"EMPTY",new YL(!1));class ka{static of(e){return e===I.ZERO?ka.ZERO:ka.ONE}constructor(e){u(this,"owner",void 0),this.owner=e}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(ka,"ZERO",new(KL=ka)(I.ZERO)),u(ka,"ONE",new KL(I.ONE));class Pl{constructor(e,t,n){u(this,"owner",void 0),u(this,"direction",void 0),u(this,"orientation",void 0),this.owner=e,this.direction=t,this.orientation=n}static of(e,t){return Pl.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}u(Pl,"LODESTONES",{0:{push:{diagonal:new(a4=Pl)(I.ZERO,"push","diagonal"),orthogonal:new a4(I.ZERO,"push","orthogonal")},pull:{diagonal:new a4(I.ZERO,"pull","diagonal"),orthogonal:new a4(I.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new a4(I.ONE,"push","diagonal"),orthogonal:new a4(I.ONE,"push","orthogonal")},pull:{diagonal:new a4(I.ONE,"pull","diagonal"),orthogonal:new a4(I.ONE,"pull","orthogonal")}}});class U1{constructor(e,t){u(this,"width",void 0),u(this,"pieces",void 0),this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?U1.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(Ve(this.pieces.length+t===3,"should never put more pieces than the plate can support"),g.empty());{const n=He.copyImmutableArray(this.pieces);for(let i=0;i<t;i++)n.push(ka.of(e));return g.of(new U1(this.width,n))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:vs.EMPTY}}XL=U1,u(U1,"POSITIONS",["top","bottom","left","right"]),u(U1,"EMPTY_5",new XL(5,[])),u(U1,"EMPTY_3",new XL(3,[]));let h1=(()=>{class r extends F1{static getInitialState(){const t=vs.EMPTY,n=ka.ZERO,i=ka.ONE;return new r([[t,t,n,i,n,i,t,t],[t,n,i,n,i,n,i,t],[n,i,n,i,n,i,n,i],[i,n,i,t,t,n,i,n],[n,i,n,t,t,i,n,i],[i,n,i,n,i,n,i,n],[t,i,n,i,n,i,n,t],[t,t,i,n,i,n,t,t]],0,new un,{top:g.of(U1.EMPTY_5),bottom:g.of(U1.EMPTY_5),left:g.of(U1.EMPTY_5),right:g.of(U1.EMPTY_5)})}constructor(t,n,i,s){super(t,n),u(this,"lodestones",void 0),u(this,"pressurePlates",void 0),this.lodestones=i,this.pressurePlates=s}withBoard(t){return new r(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const t=this.remainingSpacesDetails();return t.top+t.bottom+t.left+t.right}remainingSpacesDetails(){const t={top:0,bottom:0,left:0,right:0};for(const n of U1.POSITIONS){const i=this.pressurePlates[n];i.isPresent()&&(t[n]=i.get().remainingSpaces())}return t}numberOfPieces(){const t=[0,0];for(let n=0;n<r.SIZE;n++)for(let i=0;i<r.SIZE;i++){const s=this.getPieceAtXY(i,n);s.isPlayerPiece()&&(t[s.owner.value]+=1)}return t}getScores(){const t=this.numberOfPieces();return[24-t[1],24-t[0]]}nextLodestoneDirection(){const t=this.getCurrentPlayer(),n=this.lodestones.get(t);if(!n.isPresent())return g.empty();{const i=this.getPieceAt(n.get());switch(Ve(i.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+n.get()),i.direction){case"push":return g.of("pull");case"pull":return g.of("push")}}}}return u(r,"SIZE",8),r})();const Ne=vs.UNREACHABLE,J=vs.EMPTY,Pr=ka.ZERO,Bi=ka.ONE,Bd=Pl.of(I.ONE,{direction:"push",orientation:"orthogonal"}),QL={top:g.of(U1.EMPTY_5),bottom:g.of(U1.EMPTY_5),left:g.of(U1.EMPTY_5),right:g.of(U1.EMPTY_5)};class xce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,h1.getInitialState()),W.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,h1.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),W.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,h1.getInitialState()),W.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,h1.getInitialState()),W.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,h1.getInitialState()),W.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,h1.getInitialState(),new $c(new C(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,n,i)=>32===i.remainingSpaces()?b.failure($localize`You have not captured any of the opponent's pieces, try again!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new h1([[J,J,J,J,Bi,J,J,J],[J,J,Pr,J,J,Bi,J,J],[J,J,Bd,J,J,J,J,Pr],[J,J,J,J,Bi,J,J,Pr],[J,J,J,J,J,Pr,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new un([{key:I.ONE,value:new C(2,2)}]),{...QL,top:U1.EMPTY_5.addCaptured(I.ONE,4)}),new $c(new C(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>5===i.pressurePlates.top.get().width?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new h1([[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[J,J,J,J,J,J,J,J],[J,J,J,J,J,J,J,Pr],[J,J,J,J,J,Pr,J,Pr],[J,Bd,J,J,Bi,J,J,J],[J,J,J,J,J,J,J,J],[J,J,J,J,Bi,J,J,J],[J,J,J,J,J,J,J,J]],0,new un([{key:I.ONE,value:new C(1,4)}]),{...QL,top:U1.EMPTY_3.addCaptured(I.ONE,2)}),new $c(new C(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,n,i)=>i.pressurePlates.top.isPresent()?b.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):b.SUCCESS,$localize`Congratulations!`),W.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new h1([[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,Pr,Bi,J,J,Ne,Ne],[Ne,Ne,Bd,Bi,J,J,Ne,Ne],[Ne,Ne,J,Pr,Pr,J,Ne,Ne],[Ne,Ne,Pr,J,J,J,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne]],0,new un([{key:I.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:g.empty(),left:g.empty(),right:g.empty()})),W.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new h1([[J,J,J,J,J,J,J,J],[J,J,J,J,J,Bi,J,J],[J,J,J,Bd,J,J,Pr,J],[J,J,Pr,Pr,Bi,J,J,Pr],[J,J,J,J,J,Pr,J,J],[J,J,Pr,J,J,J,J,J],[J,J,Bi,J,J,J,J,J],[J,J,J,J,J,J,J,J]],0,new un([{key:I.ONE,value:new C(3,2)}]),{...QL,top:U1.EMPTY_5.addCaptured(I.ONE,4)}),[new $c(new C(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),W.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new h1([[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne],[Ne,Bi,Pr,Bi,J,J,Ne,Ne],[Ne,Bi,Bd,J,Bi,J,Ne,Ne],[Ne,J,J,Pr,Pr,J,Ne,Ne],[Ne,Bi,Pr,J,Bi,J,Ne,Ne],[Ne,J,J,J,Pr,J,Ne,Ne],[Ne,Ne,Ne,Ne,Ne,Ne,Ne,Ne]],0,new un([{key:I.ONE,value:new C(2,3)}]),{top:g.empty(),bottom:U1.EMPTY_3.addCaptured(I.ZERO,2),left:g.of(U1.EMPTY_3),right:g.empty()}),[new $c(new C(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)])}}let du=(()=>{class r{}return u(r,"MUST_FLIP_LODESTONE",()=>$localize`You must flip your lodestone before putting it back on the board.`),u(r,"MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES",()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`),u(r,"TARGET_IS_CRUMBLED",()=>$localize`You must place your lodestone on a non-crumbled square!`),u(r,"TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE",()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`),u(r,"MUST_PLACE_CAPTURES",()=>$localize`You must place your captures on the pressure plates, on the side of the board.`),u(r,"NO_CAPTURES_TO_PLACE_YET",()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`),r})();class hi extends jn{static get(){return hi.singleton.isAbsent()&&(hi.singleton=g.of(new hi)),hi.singleton.get()}constructor(){super(h1)}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=i.getOpponent(),o=He.copyBiArray(n.board),a=t.lodestones.getCopy();a.put(i,e.coord);const c={...t.pressurePlates};return this.updatePressurePlates(o,c,a,s,e.captures),new h1(o,t.turn+1,a,c)}updatePressurePlates(e,t,n,i,s){for(const o of U1.POSITIONS)t[o]=this.updatePressurePlate(e,o,t[o],n,i,s[o])}updatePressurePlate(e,t,n,i,s,o){if(n.isPresent()){const a=n.get().addCaptured(s,o),c=hi.THREATENED_COORD_RANGE.get(t).get();return a.isAbsent()?(this.removePressurePlate(e,c.startForBigPlate,c.direction,i),this.removePressurePlate(e,c.startForSmallPlate,c.direction,i)):a.get().width<n.get().width&&this.removePressurePlate(e,c.startForBigPlate,c.direction,i),a}return n}removePressurePlate(e,t,n,i){for(let s=t;s.isInRange(h1.SIZE,h1.SIZE);s=s.getNext(n)){for(const o of I.PLAYERS)i.get(o).equalsValue(s)&&i.delete(o);e[s.y][s.x]=vs.UNREACHABLE}}isLegal(e,t){const n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return se.failure(n.getReason());const i=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(i.captures.length,t.remainingSpaces()))return se.failure(du.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const a of U1.POSITIONS){const c=t.pressurePlates[a];if(c.isPresent()&&c.get().remainingSpaces()<e.captures[a])return se.failure(du.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return se.success(i)}applyMoveWithoutPlacingCaptures(e,t,n){let i;const s=He.copyBiArray(e.board),o=e.lodestones.get(e.getCurrentPlayer());if(o.isPresent()){const a=o.get();s[a.y][a.x]=vs.EMPTY}return i="pull"===n.direction?this.applyPull(e,s,t,n.orientation):this.applyPush(e,s,t,n.orientation),i.board[t.y][t.x]=Pl.of(e.getCurrentPlayer(),n),i.moved.push(t),i}applyPull(e,t,n,i){const s=e.getCurrentPlayer(),o=s.getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let d=n.getNext(f);e.isOnBoard(d);d=d.getNext(f)){const m=t[d.y][d.x],M=d.getNext(f);if(e.isOnBoard(M)){const w=t[M.y][M.x];w.isPlayerPiece()&&w.owner===s&&(m.isEmpty()?(c.push(d),t[d.y][d.x]=w,c.push(M),t[M.y][M.x]=vs.EMPTY):m.isPlayerPiece()&&m.owner===o&&(a.push(d),t[d.y][d.x]=w,c.push(M),t[M.y][M.x]=vs.EMPTY))}}return{board:t,captures:a,moved:c}}applyPush(e,t,n,i){const o=e.getCurrentPlayer().getOpponent(),a=[],c=[],l="diagonal"===i?Me.DIAGONALS:Me.ORTHOGONALS;for(const f of l)for(let m=n.getNext(f,h1.SIZE);!1===m.equals(n);m=m.getPrevious(f))if(e.isOnBoard(m)){const M=t[m.y][m.x];if(M.isPlayerPiece()&&M.owner===o){const w=m.getNext(f);if(e.isOnBoard(w)){const L=t[w.y][w.x];L.isUnreachable()?(a.push(m),t[m.y][m.x]=vs.EMPTY):L.isEmpty()&&(c.push(w),t[w.y][w.x]=M,c.push(m),t[m.y][m.x]=vs.EMPTY)}else a.push(m),t[m.y][m.x]=vs.EMPTY}}return{board:t,captures:a,moved:c}}isLegalWithoutCaptures(e,t,n){const i=this.isTargetLegal(e,t);if(i.isFailure())return i;const s=e.nextLodestoneDirection();return!1===(s.isAbsent()||s.equalsValue(n))?b.failure(du.MUST_FLIP_LODESTONE()):b.SUCCESS}isTargetLegal(e,t){const n=e.getPieceAt(t);if(n.isUnreachable())return b.failure(du.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE());const i=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==i?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}getGameStatus(e){const n=e.gameState.numberOfPieces();return 0===n[0]&&0===n[1]?ve.DRAW:0===n[0]?ve.ONE_WON:0===n[1]?ve.ZERO_WON:ve.ONGOING}}u(hi,"THREATENED_COORD_RANGE",un.from({top:{startForBigPlate:new C(0,0),startForSmallPlate:new C(0,1),direction:Me.RIGHT},bottom:{startForBigPlate:new C(0,h1.SIZE-1),startForSmallPlate:new C(0,h1.SIZE-2),direction:Me.RIGHT},left:{startForBigPlate:new C(0,0),startForSmallPlate:new C(1,0),direction:Me.DOWN},right:{startForBigPlate:new C(h1.SIZE-1,0),startForSmallPlate:new C(h1.SIZE-2,0),direction:Me.DOWN}})),u(hi,"singleton",g.empty());class rht extends uo{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,n=>{const i=[];for(const s of this.nextDirection(t)){const o=["diagonal","orthogonal"];for(const a of o){const f=hi.get().applyMoveWithoutPlacingCaptures(t,n,{direction:s,orientation:a}).captures.length;for(const d of this.captureCombinations(t,f))i.push(new $c(n,s,a,d))}}return i})}captureCombinations(e,t){if(0===t)return new dt([{top:0,bottom:0,left:0,right:0}]);{const n=new dt,i=e.remainingSpacesDetails(),s=this.captureCombinations(e,t-1);for(const o of s)o.top+1<=i.top&&n.add({...o,top:o.top+1}),o.bottom+1<=i.bottom&&n.add({...o,bottom:o.bottom+1}),o.left+1<=i.left&&n.add({...o,left:o.left+1}),o.right+1<=i.right&&n.add({...o,right:o.right+1});return 0===n.size()?s:n}}flatMapEmptyCoords(e,t){let n=[];for(let i=0;i<h1.SIZE;i++)for(let s=0;s<h1.SIZE;s++){const o=new C(s,i),a=e.getPieceAt(o);(a.isEmpty()&&!1===a.isUnreachable()||a.isLodestone()&&a.owner===e.getCurrentPlayer())&&(n=n.concat(t(o)))}return n}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}getBoardValue(e){const t=e.gameState.getScores();let n;return n=24===t[0]&&24!==t[1]?I.ZERO.getVictoryValue():24!==t[0]&&24===t[1]?I.ONE.getVictoryValue():an.of(t[0],t[1]).value,new an(n)}}var xa;function iht(r,e){if(1&r&&(A(),F(0,"circle",10)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","piece_",n,"_",s,""),y("ngClass",i.pieceClasses),k("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*n+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function sht(r,e){if(1&r&&(A(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);e6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),k("points",i.TRIANGLE_OUT)}}function oht(r,e){if(1&r&&(A(),F(0,"polygon",15)),2&r){const t=p().$implicit,n=p(3).$implicit,i=p(2);e6("transform","rotate(",90*t,")"),y("ngClass",n.lodestone.movingClass),k("points",i.TRIANGLE_IN)}}function aht(r,e){if(1&r&&(A(),E(0,"g"),T(1,sht,1,3,"polygon",14),T(2,oht,1,3,"polygon",14),S()),2&r){const t=p(3).$implicit;v(1),y("ngIf","push"===t.lodestone.direction),v(1),y("ngIf","pull"===t.lodestone.direction)}}const Lce=function(){return[0,1,2,3]};function cht(r,e){if(1&r&&(A(),E(0,"g",11),F(1,"circle",12)(2,"circle",13),E(3,"g"),T(4,aht,3,2,"g",1),S()()),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();k("transform",o.getSquareTransform(n,s)),v(1),y("ngClass",i.lodestone.selectedClass),k("r",o.PIECE_RADIUS),v(1),y("ngClass",i.lodestone.pieceClasses),k("r",o.PIECE_RADIUS/4),v(1),e6("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),v(1),y("ngForOf",g1(7,Lce))}}function lht(r,e){if(1&r){const t=pe();A(),E(0,"g",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).selectCoord(i.coord))}),F(1,"rect",7),T(2,iht,1,6,"circle",8),T(3,cht,5,8,"g",9),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","square_",n,"_",s,""),v(1),y("ngClass",i.squareClasses),k("x",o.SPACE_SIZE*n+o.STROKE_WIDTH)("y",o.SPACE_SIZE*s+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),v(1),y("ngIf",i.hasPiece),v(1),y("ngIf",i.lodestone)}}function uht(r,e){if(1&r&&(A(),E(0,"g"),T(1,lht,4,9,"g",5),S()),2&r){const t=e.$implicit;v(1),y("ngIf",!1===t.crumbled)}}function fht(r,e){if(1&r&&(A(),E(0,"g"),T(1,uht,2,1,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function dht(r,e){if(1&r&&(A(),E(0,"g",16),F(1,"circle",17),S()),2&r){const t=e.$implicit,n=e.index,i=p();Rn("id","capture_",n,""),k("transform",i.getCaptureTransform(n)),v(1),y("ngClass",t.pieceClasses),k("r",i.PIECE_RADIUS)}}function hht(r,e){if(1&r&&(A(),E(0,"g"),F(1,"polygon",15),S()),2&r){const t=e.$implicit,n=p().$implicit,i=p();v(1),e6("transform","rotate(",90*t,")"),y("ngClass",n.movingClass),k("points","push"===n.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function pht(r,e){if(1&r){const t=pe();A(),E(0,"g",6),U("click",function(){const s=te(t).$implicit;return ne(p().selectLodestone(s))}),F(1,"circle",12)(2,"circle",13),E(3,"g"),T(4,hht,2,3,"g",1),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p();ye("id","lodestone_",t.direction,"_",t.orientation,""),k("transform",i.getAvailableLodestoneTransform(n)),v(1),y("ngClass",t.selectedClass),k("r",i.PIECE_RADIUS),v(1),y("ngClass",t.pieceClasses),k("r",i.PIECE_RADIUS/4),v(1),e6("transform","rotate(","diagonal"===t.orientation?45:0,")"),v(1),y("ngForOf",g1(9,Lce))}}function ght(r,e){if(1&r&&(A(),F(0,"circle",10)),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();ye("id","platePiece_",s.position,"_",n,""),y("ngClass",i.pieceClasses),k("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function mht(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"g",6),U("click",function(){const i=te(t),s=i.$implicit,o=i.index,a=p().$implicit;return ne(p().onPressurePlateClick(s.temporary,a.position,o))}),F(2,"rect",18),T(3,ght,1,6,"circle",8),S()()}if(2&r){const t=e.$implicit,n=e.index,i=p().$implicit,s=p();k("transform",s.getPressurePlateTransform(i.position)),v(1),ye("id","plate_",i.position,"_",n,""),v(1),ye("id","plateSquare_",i.position,"_",n,""),y("ngClass",t.squareClasses),k("x",s.SPACE_SIZE*t.coord.x+s.STROKE_WIDTH)("y",s.SPACE_SIZE*t.coord.y+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t.hasPiece)}}function _ht(r,e){if(1&r&&(A(),E(0,"g",16),T(1,mht,4,11,"g",1),S()),2&r){const t=e.$implicit;Rn("id","pressurePlate_",t.position,""),v(1),y("ngForOf",t.coords)}}function vht(r,e){if(1&r&&(A(),F(0,"rect",19)),2&r){const t=p();ye("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),k("x",t.SPACE_SIZE*t.viewInfo.selected.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class Tl extends gl{constructor(e){super(e),u(this,"PIECE_RADIUS",void 0),u(this,"TRIANGLE_OUT",void 0),u(this,"TRIANGLE_IN",void 0),u(this,"viewInfo",{availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:g.empty(),pressurePlateShift:{top:new St(0,0),left:new St(0,0),right:new St(0,0),bottom:new St(0,0)}}),u(this,"displayedState",void 0),u(this,"stateAfterPlacingLodestone",g.empty()),u(this,"lastInfos",g.empty()),u(this,"capturesToPlace",0),u(this,"selectedCoord",g.empty()),u(this,"selectedLodestone",g.empty()),u(this,"captures",{top:0,bottom:0,left:0,right:0}),this.rules=hi.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new xce).tutorial,this.availableMinimaxes=[new rht(this.rules,"LodestoneDummyMinimax")],this.encoder=$c.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,n=.3*this.PIECE_RADIUS,i=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${n},${i} ${n},-${i}`,this.TRIANGLE_IN=`${n},0 ${t},${n} ${t},-${n}`,this.displayedState=this.getState(),this.scores=g.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(e){var t=this;return P(function*(){const n=t.canUserPlay("#square_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());if(t.capturesToPlace>0)return t.cancelMove(du.MUST_PLACE_CAPTURES());const i=hi.get().isTargetLegal(t.getState(),e);return i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedCoord=g.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}selectLodestone(e){var t=this;return P(function*(){const n=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(n.isFailure())return t.cancelMove(n.getReason());Ve(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const i=t.getCurrentPlayer(),s=Pl.of(i,e);return t.selectedLodestone.equalsValue(s)?(t.cancelMoveAttempt(),b.SUCCESS):(t.selectedLodestone=g.of(s),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),b.SUCCESS))})()}putLodestone(){var e=this;return P(function*(){Ve(e.selectedCoord.isPresent(),"coord should have been selected"),Ve(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=e.getState();Ve(hi.get().isLegalWithoutCaptures(i,t,n.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=hi.get().applyMoveWithoutPlacingCaptures(i,t,n);return e.lastInfos=g.of(o),e.capturesToPlace=Math.min(o.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(o.board),e.stateAfterPlacingLodestone=g.of(e.displayedState),e.updateViewInfo(),b.SUCCESS)})()}applyMove(){var e=this;return P(function*(){Ve(e.selectedCoord.isPresent(),"coord should have been selected"),Ve(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),n=e.selectedLodestone.get(),i=new $c(t,n.direction,n.orientation,e.captures);return e.chooseMove(i)})()}onPressurePlateClick(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}selectPressurePlate(e,t){var n=this;return P(function*(){const i=n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());if(0===n.capturesToPlace)return n.cancelMove(du.NO_CAPTURES_TO_PLACE_YET());n.capturesToPlace--,n.captures[e]++;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),a=He.copyBiArray(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return hi.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new h1(a,s.turn,l,c),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS)})()}deselectPressurePlate(e,t){var n=this;return P(function*(){const i=n.canUserPlay("#plate_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());n.capturesToPlace++,n.captures[e]--;const s=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),a=He.copyBiArray(s.board),c={...s.pressurePlates},l=s.lodestones.getCopy();return hi.get().updatePressurePlates(a,c,l,o,n.captures),n.displayedState=new h1(a,s.turn,l,c),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),b.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.scores=g.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=g.empty(),this.lastInfos=g.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=He.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=vs.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=g.empty(),this.selectedLodestone=g.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<h1.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<h1.SIZE;t++){const n=new C(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:g.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const n=Pl.of(e,t),i={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return i.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(i.selectedClass="selected-stroke"),i}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of U1.POSITIONS){const t=[],n=this.displayedState.pressurePlates[e];if(n.isPresent()){const i=Tl.PRESSURE_PLATES_POSITIONS.get(e).get(),s=n.get().width;let o=5===s?i.startForBigPlate:i.startForSmallPlate;for(let a=0;a<s;a++){o=o.getNext(i.direction);const c=n.get().getPieceAt(a);let l="";c.isPlayerPiece()&&(l=this.getPlayerClass(c.owner)),t.push({coord:o,hasPiece:c.isPlayerPiece(),pieceClasses:[l],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(e){const t=this.getPreviousState();this.lastInfos=g.of(hi.get().applyMoveWithoutPlacingCaptures(t,e.coord,e)),this.updateViewInfo();const n=this.getState();this.showPressurePlateDifferences(t,n,!1)}showPressurePlateDifferences(e,t,n){for(const i of U1.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[i],t.pressurePlates[i],i,n)}showPressurePlateDifference(e,t,n,i){if(e.isPresent()&&t.isPresent()){const s=e.get(),o=t.get(),a=K.getNonNullable(this.viewInfo.pressurePlates.find(c=>c.position===n));if(s.width===o.width)for(let c=0;c<o.width;c++){const l=s.getPieceAt(c),f=o.getPieceAt(c);!1===l.equals(f)&&(a.coords[c].squareClasses.push("moved-fill"),a.coords[c].temporary=i,i&&a.coords[c].pieceClasses.push("semi-transparent"))}else for(const c of a.coords)c.squareClasses.push("moved-fill")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),i=this.getPressurePlateShift(e.pressurePlates.top),s=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new St(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new St(0,.5*(i-s)),this.viewInfo.pressurePlateShift.right=new St(0,.5*(i-s))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(h1.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(h1.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}var Gd,Rce;xa=Tl,u(Tl,"PRESSURE_PLATE_EXTRA_SHIFT",.2),u(Tl,"PRESSURE_PLATES_POSITIONS",un.from({top:{startForBigPlate:new C(.5,-1-xa.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,0-xa.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},bottom:{startForBigPlate:new C(.5,8+xa.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new C(1.5,7+xa.PRESSURE_PLATE_EXTRA_SHIFT),direction:Me.RIGHT},left:{startForBigPlate:new C(-1-xa.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(0-xa.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN},right:{startForBigPlate:new C(8+xa.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new C(7+xa.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:Me.DOWN}})),u(Tl,"\u0275fac",function(e){return new(e||xa)(G(Wt))}),u(Tl,"\u0275cmp",Xe({type:xa,selectors:[["app-lodestone"]],features:[Je],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(A(),E(0,"svg",0),T(1,fht,2,1,"g",1),T(2,dht,2,4,"g",2),T(3,pht,5,10,"g",3),T(4,_ht,2,2,"g",2),T(5,vht,1,6,"rect",4),S()),2&e&&(v(1),y("ngForOf",t.viewInfo.boardInfo),v(1),y("ngForOf",t.viewInfo.capturesToPlace),v(1),y("ngForOf",t.viewInfo.availableLodestones),v(1),y("ngForOf",t.viewInfo.pressurePlates),v(1),y("ngIf",t.viewInfo.selected.isPresent()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class bt{static tryMerge(e,t){Ve(e!==bt.EMPTY&&t!==bt.EMPTY,"tryMerge cannot be called with empty pieces");const i=e.value+t.value;return 2===i||3===i?g.of(bt.of(i)):g.empty()}static of(e){return e===bt.DRONE.value?bt.DRONE:(K.expectToBe(e,bt.QUEEN.value),bt.QUEEN)}constructor(e){u(this,"value",void 0),this.value=e}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}u(bt,"EMPTY",new(Gd=bt)(0)),u(bt,"PAWN",new Gd(1)),u(bt,"DRONE",new Gd(2)),u(bt,"QUEEN",new Gd(3));class b0{static of(e){const t=new un;for(const n of e)b0.addToMap(t,n);return new b0(t)}static addToMap(e,t){const n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}constructor(e){u(this,"captures",void 0),this.captures=e,e.makeImmutable()}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return b0.addToMap(t,e),new b0(t)}}class On extends F1{static getInitialState(){const e=bt.EMPTY,t=bt.PAWN,n=bt.DRONE,i=bt.QUEEN;return new On([[i,i,n,e],[i,n,t,e],[n,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,n],[e,t,n,i],[e,n,i,i]],0,g.empty())}static isOnBoard(e){return e.isInRange(On.WIDTH,On.HEIGHT)}constructor(e,t,n=g.empty(),i=g.empty(),s){super(e,t),u(this,"lastMove",void 0),u(this,"countDown",void 0),u(this,"captured",void 0),this.lastMove=n,this.countDown=i,null==s&&(s=new un([{key:I.ZERO,value:b0.of([])},{key:I.ONE,value:b0.of([])}])),s.makeImmutable(),this.captured=s}getPlayerTerritory(e){return e===I.ZERO?On.PLAYER_ZERO_TERRITORY:On.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),n=this.getPlayerTerritory(t);for(const i of n)for(let s=0;s<On.WIDTH;s++)if(this.getPieceAtXY(s,i)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(I.ZERO)?g.of(I.ZERO):this.isTerritoryEmpty(I.ONE)?g.of(I.ONE):g.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const n of t)for(let i=0;i<On.WIDTH;i++)if(this.getPieceAtXY(i,n)!==bt.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(bt.PAWN).getOrElse(0),t.captures.get(bt.DRONE).getOrElse(0),t.captures.get(bt.QUEEN).getOrElse(0)]}}u(On,"WIDTH",4),u(On,"HEIGHT",8),u(On,"PLAYER_ZERO_TERRITORY",new dt([4,5,6,7])),u(On,"PLAYER_ONE_TERRITORY",new dt([0,1,2,3]));let HC=(()=>{class r{}return u(r,"START_COORD_OUT_OF_RANGE",()=>$localize`Start coord cannot be out of range`),u(r,"END_COORD_OUT_OF_RANGE",()=>$localize`End coord cannot be out of range`),u(r,"PAWN_MUST_MOVE_ONE_DIAGONAL_STEP",()=>$localize`Pawns must move one step diagonally.`),u(r,"DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS",()=>$localize`Drones must move one or two steps in any direction.`),r})();class Tr extends Vo{static from(e,t,n=!1){if(!1===On.isOnBoard(e))return se.failure(HC.START_COORD_OUT_OF_RANGE());if(!1===On.isOnBoard(t))return se.failure(HC.END_COORD_OUT_OF_RANGE());if(t.equals(e))return se.failure(Le.MOVE_CANNOT_BE_STATIC());const i=Me.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?se.failure(i.getReason()):se.success(new Tr(e,t,n))}constructor(e,t,n){super(e,t),u(this,"calledTheClock",void 0),this.calledTheClock=n}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}Rce=Tr,u(Tr,"encoder",Ie.tuple([C.encoder,C.encoder,Ie.identity()],r=>[r.getStart(),r.getEnd(),r.calledTheClock],r=>Rce.from(r[0],r[1],r[2]).get()));let zce=(()=>{class r{}return u(r,"YOU_DID_NOT_CAPTURE_ANY_PIECE",()=>$localize`Failed, you did not capture any piece.`),r})();const Y=bt.EMPTY,pi=bt.PAWN,c4=bt.DRONE,Ol=bt.QUEEN,Dce=()=>$localize`This is not a field promotion!`;class Hce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,On.getInitialState()),W.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,On.getInitialState()),W.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,On.getInitialState(),Tr.from(new C(2,5),new C(1,4)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.PAWN?b.SUCCESS:b.failure($localize`This is not a pawn!`),$localize`Congratulations!`),W.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,On.getInitialState(),Tr.from(new C(1,7),new C(0,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.DRONE?b.SUCCESS:b.failure($localize`This is not a drone!`),$localize`Congratulations!`),W.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new On([[c4,pi,Y,Y],[Ol,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Ol,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Ol,c4,pi,Y]],1),Tr.from(new C(2,3),new C(2,7)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure($localize`This is not a queen!`),$localize`Congratulations!`),W.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new On([[c4,pi,pi,Y],[Y,Y,Y,Y],[Ol,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,pi,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,c4,pi,Y]],1),[Tr.from(new C(0,2),new C(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,zce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),W.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new On([[Y,Y,Y,Ol],[Y,pi,Y,Y],[Y,Y,pi,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Ol],[Y,Y,c4,Y],[Y,pi,Y,Y]],1),[Tr.from(new C(1,1),new C(2,2)).get(),Tr.from(new C(2,2),new C(1,1)).get()],$localize`Congratulations!`,Dce()),W.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new On([[pi,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,c4,Y],[Y,pi,Y,Y]],0),Tr.from(new C(1,7),new C(2,6)).get(),(t,n,i)=>i.getPieceAt(t.getEnd())===bt.QUEEN?b.SUCCESS:b.failure(Dce()),$localize`Congratulations!`),W.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,On.getInitialState(),Tr.from(new C(1,5),new C(0,4),!0).get(),(t,n,i)=>t.calledTheClock?b.SUCCESS:b.failure($localize`You did not call the clock!`),$localize`Congratulations!`),W.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new On([[Y,Y,Y,Y],[Y,pi,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,pi],[Y,Y,c4,Y],[Y,pi,Y,Y]],15,g.empty(),g.of(1)),[Tr.from(new C(1,1),new C(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),W.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new On([[Y,Y,Y,Ol],[Y,pi,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[c4,Y,Y,Y],[Y,Y,Y,Y],[Y,c4,Y,Y]],15,g.empty(),g.of(1)),Tr.from(new C(1,1),new C(2,2)).get(),$localize`Congratulations!`),W.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new On([[Y,Y,Y,Ol],[Y,pi,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,pi,Y],[Y,Y,Y,Y],[Y,Y,Y,Y],[Y,Y,Y,Y]],0),Tr.from(new C(2,4),new C(1,3)).get(),(t,n,i)=>3===t.getEnd().y?b.SUCCESS:b.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)])}}let VC=(()=>{class r{}return u(r,"MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY",()=>$localize`You must pick a piece from your side of the board in order to move it.`),u(r,"CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT",()=>$localize`This is not a valid promotion nor a valid capture.`),u(r,"CANNOT_UNDO_LAST_MOVE",()=>$localize`You cannot perform a move that is the reverse of the previous one.`),r})();class La extends jn{static get(){return La.singleton.isAbsent()&&(La.singleton=g.of(new La)),La.singleton.get()}constructor(){super(On)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();i[e.getStart().y][e.getStart().x]=bt.EMPTY;const s=n.finalPiece;i[e.getEnd().y][e.getEnd().x]=s;const o=n.score;let a=t.countDown;if(a.isPresent())if(this.isCapture(e,t))a=La.STARTING_COUNT_DOWN;else{const l=t.countDown.get();a=g.of(l-1)}return e.calledTheClock&&(a=La.STARTING_COUNT_DOWN),new On(i,t.turn+1,g.of(e),a,o)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const n=this.isLegalMove(e,t);if(n.isFailure())return n.toOtherFallible();if(e.isUndoneBy(t.lastMove))return se.failure(VC.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const i=t.getPieceAt(e.getStart()),s=t.captured.getCopy();if(this.isCapture(e,t)){const a=t.getCurrentPlayer();let c=s.get(a).get();const l=t.getPieceAt(e.getEnd());c=c.add(l),s.replace(a,c),s.makeImmutable()}return se.success({finalPiece:i,score:s})}assertNonDoubleClockCall(e,t){Ve(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const n=t.isInOpponentTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isFieldPromotion(e,t){const n=t.isInPlayerTerritory(e.getEnd()),i=t.getPieceAt(e.getEnd())!==bt.EMPTY;return n&&i}isLegalFieldPromotion(e,t){const n=this.getPromotedPiece(e,t);if(n.isAbsent())return se.failure(VC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const i=n.get();if(t.isTherePieceOnPlayerSide(i))return se.failure(VC.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const s={finalPiece:i,score:t.captured.getCopy()};return se.success(s)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return b.failure(VC.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const i=t.getPieceAt(e.getStart());if(i===bt.EMPTY)return b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(i===bt.PAWN)return e.isValidForPawn()?b.SUCCESS:b.failure(HC.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(i===bt.DRONE&&!1===e.isValidForDrone())return b.failure(HC.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const s of e.getStart().getUntil(e.getEnd()))if(t.getPieceAt(s)!==bt.EMPTY)return b.failure(Le.SOMETHING_IN_THE_WAY());return b.SUCCESS}getPromotedPiece(e,t){const n=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd());return bt.tryMerge(n,i)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,ve.DRAW);if(t.getEmptyTerritory().isPresent()){const i=t.getCurrentOpponent(),s=ve.getVictory(i);return this.getGameStatusScoreVictoryOr(t,s)}return ve.ONGOING}getGameStatusScoreVictoryOr(e,t){const n=e.getScoreOf(I.ZERO),i=e.getScoreOf(I.ONE);return n>i?ve.ZERO_WON:i>n?ve.ONE_WON:t}}u(La,"STARTING_COUNT_DOWN",g.of(7)),u(La,"singleton",g.empty());class Cht extends Hr{constructor(e,t){super(e,t)}getListMoves(e){const t=e.gameState,n=t.getCurrentPlayer(),i=t.getPlayerTerritory(n);let s=[];for(const o of i)for(let a=0;a<On.WIDTH;a++)switch(t.getPieceAtXY(a,o)){case bt.PAWN:s=s.concat(this.getMovesForPawnAt(t,a,o));break;case bt.DRONE:s=s.concat(this.getMovesForDroneAt(t,a,o));break;case bt.QUEEN:s=s.concat(this.getMovesForQueenAt(t,a,o))}return s}getMovesForPawnAt(e,t,n){const i=new C(t,n),s=[];for(const o of Me.DIAGONALS){const a=i.getNext(o);On.isOnBoard(a)&&s.push(a)}return this.addLegalMoves(e,i,s)}addLegalMoves(e,t,n){const i=[],s=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(bt.DRONE),a=!1===e.isTherePieceOnPlayerSide(bt.QUEEN),c=e.lastMove;for(const l of n){const f=e.getPieceAt(l);if(f===bt.EMPTY)this.add(i,Tr.from(t,l).get(),c);else if(e.isInPlayerTerritory(l)){const d=bt.tryMerge(f,s);if(d.isPresent()){const m=d.get(),M=Tr.from(t,l).get();(m===bt.DRONE&&o||m===bt.QUEEN&&a)&&this.add(i,M,c)}}else this.add(i,Tr.from(t,l).get(),c)}return i}add(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}getMovesForDroneAt(e,t,n){const i=new C(t,n),s=this.getLandingCoordsForLinearMove(i,e,2);return this.addLegalMoves(e,i,s)}getLandingCoordsForLinearMove(e,t,n){const i=[];for(const s of Me.DIRECTIONS){let o=1,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY);for(;l;)i.push(a),o++,a=e.getNext(s,o),c=t.tryToGetPieceAt(a),l=c.equalsValue(bt.EMPTY)&&o<n;c.isPresent()&&i.push(a)}return i}getMovesForQueenAt(e,t,n){const i=new C(t,n),s=this.getLandingCoordsForQueen(i,e);return this.addLegalMoves(e,i,s)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,On.HEIGHT)}getMetrics(e){return[e.gameState.getScoreOf(I.ZERO),e.gameState.getScoreOf(I.ONE)]}}function yht(r,e){if(1&r&&(A(),F(0,"g",19)),2&r){const t=p(2).index,n=p().index,i=p();J2(i.style),ye("mainShapeId","pawn_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Mht(r,e){if(1&r&&(A(),F(0,"g",20)),2&r){const t=p(2).index,n=p().index,i=p();J2(i.style),ye("mainShapeId","drone_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Eht(r,e){if(1&r&&(A(),F(0,"g",21)),2&r){const t=p(2).index,n=p().index,i=p();J2(i.style),ye("mainShapeId","queen_",t,"_",n,""),y("pieceClasses",i.getPieceClasses(t,n))}}function Sht(r,e){if(1&r&&(A(),E(0,"g"),T(1,yht,1,5,"g",16),T(2,Mht,1,5,"g",17),T(3,Eht,1,5,"g",18),S()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();k("transform",o.getPieceLocation(n,s)),v(1),y("ngIf",i===o.pieces.PAWN),v(1),y("ngIf",i===o.pieces.DRONE),v(1),y("ngIf",i===o.pieces.QUEEN)}}function Pht(r,e){if(1&r){const t=pe();A(),E(0,"g",14),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",15),T(2,Sht,4,4,"g",13),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ye("id","click_",n,"_",i,""),k("transform",s.getPieceTranslation(i)),v(1),ye("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),k("x",n*s.SPACE_SIZE)("y",i*s.SPACE_SIZE)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t!==s.pieces.EMPTY)}}function Tht(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",22),U("click",function(){const s=te(t).$implicit;return ne(p(3).onClick(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p(3);v(1),ye("id","indicator_",t.x,"_",t.y,""),k("transform",n.getPieceTranslation(t.y))("x",t.x*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("y",t.y*n.SPACE_SIZE+(n.SPACE_SIZE/2-n.INDICATOR_SIZE/2))("width",n.INDICATOR_SIZE)("height",n.INDICATOR_SIZE)}}function Oht(r,e){if(1&r&&(A(),E(0,"g"),T(1,Tht,2,7,"g",1),S()),2&r){const t=p(2);v(1),y("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function bht(r,e){if(1&r&&(A(),E(0,"g"),T(1,Pht,3,11,"g",12),T(2,Oht,2,1,"g",13),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngForOf",t),v(1),y("ngIf",n.selectedPieceInfo.isPresent())}}function wht(r,e){if(1&r&&(A(),E(0,"text",23),lt(1),S()),2&r){const t=p();y("ngClass","player"+t.getCurrentPlayer().value)("ngClass",t.getClockCircleClasses()),k("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),v(1),Nn(t.countDown.get())}}function Nht(r,e){if(1&r&&(A(),F(0,"polyline",24)),2&r){const t=p();y("ngClass",t.getClockCircleClasses()),k("points",t.clockNeedlesPoints)}}const FC=function(r){return[r]};function Aht(r,e){if(1&r){const t=pe();A(),Bt(0),E(1,"g",27),U("click",function(){const s=te(t).index;return ne(p(2).chooseStyle(s))}),S(),Gt()}if(2&r){const t=e.$implicit,n=e.index,i=p(2);v(1),J2(t.style),y("id",t.name)("pieceClasses",da(5,FC,"player"+i.getCurrentPlayer().value+"-fill")),k("transform","translate(0, "+-(n+1)*i.SPACE_SIZE+")")}}function Iht(r,e){if(1&r&&(A(),E(0,"g",25),F(1,"rect",26),T(2,Aht,2,7,"ng-container",1),S()),2&r){const t=p();v(1),k("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),v(1),y("ngForOf",t.listOfStyles)}}function kht(r,e){if(1&r&&(A(),E(0,"text",33),lt(1),S()),2&r){const t=p(2).$implicit,n=p().$implicit,i=p();y("ngClass",i.getPlayerClass(n)),k("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),v(1),Nn(t+" x ")}}function xht(r,e){if(1&r&&(A(),F(0,"g",34)),2&r){const t=p(3).$implicit,n=p();J2(n.style),y("pieceClasses",da(3,FC,n.getPlayerClass(t)))}}function Lht(r,e){if(1&r&&(A(),F(0,"g",35)),2&r){const t=p(3).$implicit,n=p();J2(n.style),y("pieceClasses",da(3,FC,n.getPlayerClass(t)))}}function Rht(r,e){if(1&r&&(A(),F(0,"g",36)),2&r){const t=p(3).$implicit,n=p();J2(n.style),y("pieceClasses",da(3,FC,n.getPlayerClass(t)))}}function zht(r,e){if(1&r&&(A(),E(0,"g"),T(1,kht,2,4,"text",29),E(2,"g",28),T(3,xht,1,5,"g",30),T(4,Lht,1,5,"g",31),T(5,Rht,1,5,"g",32),S()()),2&r){const t=p(),n=t.index,i=t.$implicit,s=p().$implicit,o=p();k("transform","translate(0, "+2*n*o.SPACE_SIZE+")"),v(1),y("ngIf",i>1),v(1),ye("id","piece_",n,"_player_",s.value,""),k("transform","translate("+o.SPACE_SIZE+", 0)"),v(1),y("ngIf",0===n),v(1),y("ngIf",1===n),v(1),y("ngIf",2===n)}}function Dht(r,e){if(1&r&&(A(),E(0,"g"),T(1,zht,6,8,"g",13),S()),2&r){const t=e.$implicit;v(1),y("ngIf",t>0)}}function Hht(r,e){if(1&r&&(A(),E(0,"g")(1,"g",28),T(2,Dht,2,1,"g",1),S()()),2&r){const t=e.$implicit,n=p();v(1),Rn("id","capture_of_player_",t.value,""),k("transform",n.getCapturesTransformation(t)),v(1),y("ngForOf",n.state.getCapturesOf(t))}}let Cs=(()=>{var r;class e extends Hi{static getRegularPolygon(n,i=0){const s=e.getRegularPolygonCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStar(n,i){const s=this.getNPointedStarCoords(n,i);return e.mapCoordsToString(s)}static getNPointedStarCoords(n,i){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;n*=2;for(let c=0;c<n;c++){const f=(c*(360/n)+i)/180*Math.PI,d=c%2==0?e.SPACE_SIZE/2:e.SPACE_SIZE/6,m=o+.8*d*Math.cos(f),M=a+.8*d*Math.sin(f);s.push(new C(m,M))}return s}static getRegularPolygonCoords(n,i=0){const s=[],o=.5*e.SPACE_SIZE,a=.5*e.SPACE_SIZE;for(let c=0;c<n;c++){const f=(c*(360/n)-90)/180*Math.PI,d=.5*e.SPACE_SIZE,m=o+.8*d*Math.cos(f),M=a+.8*d*Math.sin(f)+i;s.push(new C(m,M))}return s}static mapCoordsToString(n){let i="";for(const s of n)i+=s.x+", "+s.y+" ";return i}static getRadius(n){return this.SPACE_SIZE*n/10}constructor(n){super(n),u(this,"INDICATOR_SIZE",20),u(this,"HORIZONTAL_CENTER",.5*On.WIDTH*e.SPACE_SIZE),u(this,"UNSTROKED_HEIGHT",On.HEIGHT*e.SPACE_SIZE),u(this,"VERTICAL_CENTER",.5*this.UNSTROKED_HEIGHT+e.STROKE_WIDTH),u(this,"LEFT",e.SPACE_SIZE/-4+e.STROKE_WIDTH/-2),u(this,"UNSTROKED_WIDTH",On.WIDTH*e.SPACE_SIZE),u(this,"UP",-e.STROKE_WIDTH/2),u(this,"WIDTH",this.UNSTROKED_WIDTH+2.5*e.SPACE_SIZE+e.STROKE_WIDTH),u(this,"HEIGHT",this.UNSTROKED_HEIGHT+3*e.STROKE_WIDTH),u(this,"MartianChessComponent",e),u(this,"style",{shape:"Circle",points:"Horizontal Points"}),u(this,"pieces",bt),u(this,"state",void 0),u(this,"configViewTranslation",void 0),u(this,"configCogTransformation",void 0),u(this,"selectedPieceInfo",g.empty()),u(this,"countDown",g.empty()),u(this,"callTheClock",!1),u(this,"displayModePanel",!1),u(this,"listOfStyles",[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}]),u(this,"clockNeedlesPoints",void 0),this.hasAsymmetricBoard=!0,this.rules=La.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Cht(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=e.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=Tr.encoder,this.tutorial=(new Hce).tutorial,this.scores=g.of([0,0]),this.updateBoard()}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const n=this.STROKE_WIDTH,s=(this.SPACE_SIZE-n)/40;return"translate("+1*n+", "+1*n+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const n=.5*this.SPACE_SIZE;return n+" "+.1*this.SPACE_SIZE+", "+n+" "+n+", "+.75*this.SPACE_SIZE+" "+n}updateBoard(){this.state=this.getState(),this.board=this.state.board;const n=this.state.getScoreOf(I.ZERO),i=this.state.getScoreOf(I.ONE);this.countDown=this.state.countDown,this.scores=g.of([n,i])}getPieceLocation(n,i){return"translate("+this.SPACE_SIZE*n+", "+this.SPACE_SIZE*i+")"}getPieceClasses(n,i){const s=new C(n,i),o=[];return o.push(i>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&o.push("selected-stroke"),this.node.move.isPresent()&&this.node.move.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==bt.EMPTY&&this.getState().isInOpponentTerritory(new C(0,i))&&o.push("last-move-stroke"),o}onClick(n,i){var s=this;return P(function*(){s.displayModePanel=!1;const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);return s.selectedPieceInfo.isPresent()?s.secondClick(a):s.firstClick(a)})()}firstClick(n){var i=this;return P(function*(){return i.isOneOfUsersPieces(n)?i.selectAsFirstPiece(n):(i.cancelMoveAttempt(),b.SUCCESS)})()}selectAsFirstPiece(n){var i=this;return P(function*(){const s=i.getLegalLandings(n);return i.selectedPieceInfo=g.of({selectedPiece:n,legalLandings:s}),b.SUCCESS})()}getLegalLandings(n){const i=this.state.getPieceAt(n);let s;return s=i===bt.PAWN?Me.DIAGONALS.map(o=>n.getNext(o)):this.getValidLinearLandingSquareUntil(n,i===bt.DRONE?2:On.HEIGHT),s.filter(o=>{const a=Tr.from(n,o);return!!a.isSuccess()&&this.rules.isLegal(a.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(n,i){return Me.DIRECTIONS.flatMap(s=>{const o=[];let a=n.getNext(s),c=1;for(;On.isOnBoard(a)&&c<=i&&(o.push(a),this.getState().getPieceAt(a)===bt.EMPTY);)a=a.getNext(s),c++;return o})}secondClick(n){var i=this;return P(function*(){const s=i.selectedPieceInfo.get();if(s.selectedPiece.equals(n))return i.cancelMoveAttempt(),b.SUCCESS;if(s.legalLandings.some(o=>o.equals(n))){const o=Tr.from(s.selectedPiece,n,i.callTheClock);return K.assert(o.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),i.chooseMove(o.get())}if(i.isOneOfUsersPieces(n))return i.selectAsFirstPiece(n);{const o=Tr.from(s.selectedPiece,n,i.callTheClock);return o.isSuccess()?i.chooseMove(o.get()):i.cancelMove(o.getReason())}})()}isOneOfUsersPieces(n){return this.state.getPieceAt(n)!==bt.EMPTY&&this.state.isInPlayerTerritory(n)}cancelMoveAttempt(){this.selectedPieceInfo=g.empty(),this.callTheClock=!1}onClockClick(){var n=this;return P(function*(){const i=n.canUserPlay("#clockOrCountDownView");return i.isFailure()?n.cancelMove(i.getReason()):(n.getState().countDown.isAbsent()&&(n.callTheClock=!1===n.callTheClock),b.SUCCESS)})()}getClockCircleClasses(){const n=["base"];return this.callTheClock&&n.push("selected-stroke"),this.getCurrentPlayer()===I.ZERO?n.push("player0-stroke"):n.push("player1-stroke"),n}getSquareClasses(n,i){const s=new C(n,i),o=["base"];if(this.node.move.isPresent()){const a=this.node,c=a.move.get();c.getStart().equals(s)?o.push("moved-fill"):c.getEnd().equals(s)&&(a.mother.get().gameState.getPieceAt(s)===bt.EMPTY||a.gameState.isInOpponentTerritory(new C(0,i))?o.push("moved-fill"):o.push("captured-fill"))}return o}onModeCogClick(){this.displayModePanel=!1===this.displayModePanel}chooseStyle(n){this.style=this.listOfStyles[n].style,this.displayModePanel=!1}getPieceTranslation(n){return"translate(0, "+(n<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(n){let o=this.SPACE_SIZE/2;return n===this.role&&(o+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+o+")"}}return r=e,u(e,"SPACE_SIZE",100),u(e,"STROKE_WIDTH",8),u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-martian-chess"]],features:[Je],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"g"),T(2,bht,3,2,"g",1),S(),E(3,"g",2),U("click",function(){return i.onClockClick()}),F(4,"rect",3)(5,"circle",4),T(6,wht,2,5,"text",5),T(7,Nht,1,2,"polyline",6),S(),E(8,"g",7)(9,"g",8),U("click",function(){return i.onModeCogClick()}),F(10,"rect",3)(11,"path",9),S(),T(12,Iht,3,5,"g",10),S(),E(13,"g",11),T(14,Hht,3,3,"g",1),S()()),2&n&&(k("viewBox",i.LEFT+" "+i.UP+" "+i.WIDTH+" "+i.HEIGHT),v(1),k("transform",i.getBoardTransformation()),v(1),y("ngForOf",i.board),v(1),k("transform","translate("+5.25*i.SPACE_SIZE+", 0)"),v(1),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngClass",i.getClockCircleClasses()),k("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE)("r",.4*i.SPACE_SIZE),v(1),y("ngIf",i.countDown.isPresent()),v(1),y("ngIf",i.countDown.isAbsent()),v(1),k("transform",i.configViewTranslation),v(2),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngClass",i.getPlayerClass(i.getCurrentPlayer())),k("transform",i.configCogTransformation),v(1),y("ngIf",i.displayModePanel),v(2),y("ngForOf",i.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Ra=(()=>{class r extends F1{static getInitialState(){const t=He.createTable(r.WIDTH,r.HEIGHT,X.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"WIDTH",7),u(r,"HEIGHT",6),r})();var l4;class Q1 extends Li{static of(e){switch(e){case 0:return Q1.ZERO;case 1:return Q1.ONE;case 2:return Q1.TWO;case 3:return Q1.THREE;case 4:return Q1.FOUR;case 5:return Q1.FIVE;case 6:return Q1.SIX;default:throw new Error("Invalid P4Move")}}constructor(e){super(),u(this,"x",void 0),this.x=e}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}u(Q1,"ZERO",new(l4=Q1)(0)),u(Q1,"ONE",new l4(1)),u(Q1,"TWO",new l4(2)),u(Q1,"THREE",new l4(3)),u(Q1,"FOUR",new l4(4)),u(Q1,"FIVE",new l4(5)),u(Q1,"SIX",new l4(6)),u(Q1,"encoder",Ie.tuple([Ie.identity()],r=>[r.x],r=>l4.of(r[0])));let Vht=(()=>{class r{}return u(r,"COLUMN_IS_FULL",()=>$localize`Please put your piece in an incomplete column.`),r})();var Ud,u4;let bl=(Ud=class extends jn{static get(){return u4.singleton.isAbsent()&&(u4.singleton=g.of(new u4)),u4.singleton.get()}static getVictoriousCoords(e){return u4.P4_HELPER.getVictoriousCoord(e)}static getLowestUnoccupiedSpace(e,t){let n=0;for(;n<Ra.HEIGHT&&e[n][t]===X.NONE;)n++;return n-1}static getListMoves(e){const t=e.gameState,n=[];for(let i=0;i<Ra.WIDTH;i++)if(t.getPieceAtXY(i,0)===X.NONE){const s=Q1.of(i);n.push(s)}return n}constructor(){super(Ra)}applyLegalMove(e,t,n){const i=e.x,s=t.getCopiedBoard(),o=u4.getLowestUnoccupiedSpace(s,i),a=t.turn;return s[o][i]=t.getCurrentPlayer(),new Ra(s,a+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?b.failure(Vht.COLUMN_IS_FULL()):b.SUCCESS}getGameStatus(e){const t=e.gameState;return u4.P4_HELPER.getVictoriousCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):42===t.turn?ve.DRAW:ve.ONGOING}},u4=Ud,u(Ud,"singleton",g.empty()),u(Ud,"P4_HELPER",new nu(Ra.isOnBoard,K.identity,4)),Ud);bl=u4=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],bl);let JL=class extends uo{getListMoves(e){return bl.getListMoves(e).sort((t,n)=>Math.abs(t.x-3)-Math.abs(n.x-3))}getBoardValue(e){const t=e.gameState;let n=0;for(let i=0;i<Ra.WIDTH;i++)for(let s=Ra.HEIGHT-1;-1!==s&&t.board[s][i].isPlayer();s--){const o=bl.P4_HELPER.getSquareScore(t,new C(i,s));if(zi.getScoreStatus(o)===en.VICTORY)return new an(o);n+=o}return new an(n)}};JL=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],JL);const it=X.NONE,f4=X.ZERO,hu=X.ONE;class Vce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,Ra.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,Ra.getInitialState(),Q1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),W.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new Ra([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,hu,it,it,it],[it,it,it,hu,it,it,it],[it,it,f4,f4,f4,hu,it]],0),[Q1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),W.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new Ra([[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,it,it,it,it],[it,it,it,f4,hu,it,it],[it,it,f4,f4,hu,it,it],[it,f4,hu,f4,f4,it,it]],0),[Q1.of(3),Q1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)])}}function Bht(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getSquareFillClass(t,n)),k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Ght(r,e){if(1&r){const t=pe();A(),E(0,"g",5),U("click",function(){const s=te(t).index;return ne(p(2).onClick(s))}),F(1,"rect",6),T(2,Bht,1,4,"circle",7),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();Rn("id","click_",n,""),v(1),k("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t!==s.EMPTY)}}function Uht(r,e){if(1&r&&(A(),E(0,"g"),T(1,Ght,3,6,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Wht(r,e){if(1&r&&(A(),F(0,"rect",9)),2&r){const t=p();k("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function qht(r,e){if(1&r&&(A(),F(0,"rect",10)),2&r){const t=e.$implicit,n=p();ye("id","victory_coord_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let jht=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"EMPTY",X.NONE),u(this,"last",void 0),u(this,"victoryCoords",[]),this.rules=bl.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new JL(this.rules,"P4Minimax")],this.encoder=Q1.encoder,this.tutorial=(new Vce).tutorial,this.updateBoard()}onClick(n){var i=this;return P(function*(){const s=i.canUserPlay("#click_"+n);if(s.isFailure())return i.cancelMove(s.getReason());const o=Q1.of(n);return yield i.chooseMove(o)})()}updateBoard(){const n=this.getState();this.victoryCoords=bl.getVictoriousCoords(n),this.board=n.board,this.hideLastMove()}showLastMove(n){const i=this.getState(),s=bl.getLowestUnoccupiedSpace(i.board,n.x)+1;this.last=g.of(new C(n.x,s))}hideLastMove(){this.last=g.empty()}getSquareFillClass(n,i){return[this.getPlayerClass(this.board[i][n])]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-p4"]],features:[Je],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Uht,2,1,"g",1),T(2,Wht,1,4,"rect",2),T(3,qht,1,6,"rect",3),S()),2&n&&(v(1),y("ngForOf",i.board),v(1),y("ngIf",i.last.isPresent()),v(1),y("ngForOf",i.victoryCoords))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class y1 extends F1{static getInitialState(){const e=He.createTable(y1.SIZE,y1.SIZE,X.NONE);return new y1(e,0)}static isOnBoard(e){return e.isInRange(y1.SIZE,y1.SIZE)}constructor(e,t){super(e,t),u(this,"neutralBlocks",void 0),this.neutralBlocks=this.getBlocksNeutralities()}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=y1.getBlockCenter(e),n=this.getPieceAt(t.getNext(Me.UP,1)),i=this.getPieceAt(t.getNext(Me.UP_LEFT,1));return this.getPieceAt(t.getNext(Me.RIGHT,1))===n&&this.getPieceAt(t.getNext(Me.DOWN,1))===n&&this.getPieceAt(t.getNext(Me.LEFT,1))===n&&this.getPieceAt(t.getNext(Me.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(Me.DOWN_LEFT,1))===i}static getBlockCenter(e){return new C(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new y1(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),n=t.getCopiedBoard();if(e.blockTurned.isPresent()){const s=y1.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const o of y1.ROTATION_MAP){const a=o[0].getNext(s),c=o[1].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}else for(const o of y1.ROTATION_MAP){const a=o[1].getNext(s),c=o[0].getNext(s),l=t.getPieceAt(a);n[c.y][c.x]=l}}return new y1(n,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}var Fce;u(y1,"SIZE",6),u(y1,"ROTATION_MAP",[[new C(-1,-1),new C(1,-1)],[new C(0,-1),new C(1,0)],[new C(1,-1),new C(1,1)],[new C(1,0),new C(0,1)],[new C(1,1),new C(-1,1)],[new C(0,1),new C(-1,0)],[new C(-1,1),new C(-1,-1)],[new C(-1,0),new C(0,-1)]]);class Gr extends Mr{static of(e,t,n){return new Gr(e.x,e.y,t,n)}static withRotation(e,t,n,i){return K.assert(0<=n&&n<=3,"This block does not exist: "+n),new Gr(e,t,g.of(n),i)}static rotationless(e,t){return new Gr(e,t,g.empty())}constructor(e,t,n,i=!1){super(e,t),u(this,"blockTurned",void 0),u(this,"turnedClockwise",void 0),this.blockTurned=n,this.turnedClockwise=i,K.assert(y1.isOnBoard(this.coord),"The board is a "+y1.SIZE+" space wide square, invalid coord: "+this.coord.toString())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}Fce=Gr,u(Gr,"encoder",Ie.tuple([C.encoder,g.getEncoder(Ie.identity()),Ie.identity()],r=>[r.coord,r.blockTurned,r.turnedClockwise],r=>Fce.of(r[0],r[1],r[2])));class $C extends Hr{getListMoves(e){const t=[],n=e.gameState.neutralBlocks;if(0===e.gameState.turn)return $C.FIRST_TURN_MOVES;const i=this.getLegalDrops(e.gameState);for(const s of i){const o=Gr.rotationless(s.x,s.y),a=e.gameState.applyLegalDrop(o),c=this.getLegalRotations(a,n);for(const f of c)t.push(Gr.withRotation(s.x,s.y,f[0],f[1]));0===a.neutralBlocks.length==0&&t.push(o)}return t}getLegalDrops(e){const t=[];for(let n=0;n<y1.SIZE;n++)for(let i=0;i<y1.SIZE;i++){const s=new C(i,n);e.getPieceAt(s)===X.NONE&&t.push(s)}return t}getLegalRotations(e,t){const n=0===e.neutralBlocks.length,i=[];for(let s=0;s<4;s++)!1===e.blockIsNeutral(s)&&(t.includes(s)?n&&i.push([s,!0]):i.push([s,!0],[s,!1]));return i}getMetrics(e){return[0,0]}}u($C,"FIRST_TURN_MOVES",[Gr.rotationless(0,0),Gr.rotationless(1,0),Gr.rotationless(2,0),Gr.rotationless(0,1),Gr.rotationless(1,1),Gr.rotationless(0,2)]);let $ce=(()=>{class r{}return u(r,"CANNOT_ROTATE_NEUTRAL_BLOCK",()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`),u(r,"MUST_CHOOSE_BLOCK_TO_ROTATE",()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`),r})();class Bc extends jn{static get(){return Bc.singleton.isAbsent()&&(Bc.singleton=g.of(new Bc)),Bc.singleton.get()}constructor(){super(y1)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return b.failure($ce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const i=e.blockTurned.get();if(n.neutralBlocks.includes(i))return b.failure($ce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return b.SUCCESS}getVictoryCoords(e){let t=[];for(const n of Bc.VICTORY_SOURCE){const i=e.getPieceAt(n[0]),s=[n[0]];if(i.isPlayer()){let o=n[0].getNext(n[1]),a=!0;for(let c=0;c<3&&a;c++)e.getPieceAt(o)!==i?a=!1:(s.push(o),o=o.getNext(n[1]));if(a&&(e.getPieceAt(o)===i&&(s.push(o),t=t.concat(s)),n[2])){const c=n[0].getPrevious(n[1],1);e.getPieceAt(c)===i&&(s.push(c),t=t.concat(s))}}}return t}getGameStatus(e){const t=e.gameState,n=this.getVictoryCoords(t),i=[!1,!1];for(let s=0;s<n.length;s+=5)i[t.getPieceAt(n[s]).value]=!0;return!0===i[0]?!0===i[1]?ve.DRAW:ve.ZERO_WON:!0===i[1]?ve.ONE_WON:t.turn===y1.SIZE*y1.SIZE?ve.DRAW:ve.ONGOING}}u(Bc,"singleton",g.empty()),u(Bc,"VICTORY_SOURCE",[[new C(1,0),new St(1,1),!1],[new C(0,1),new St(1,1),!1],[new C(4,0),new St(-1,1),!1],[new C(5,1),new St(-1,1),!1],[new C(1,1),new St(1,1),!0],[new C(4,1),new St(-1,1),!0],[new C(0,1),new St(0,1),!0],[new C(1,1),new St(0,1),!0],[new C(2,1),new St(0,1),!0],[new C(3,1),new St(0,1),!0],[new C(4,1),new St(0,1),!0],[new C(5,1),new St(0,1),!0],[new C(1,0),new St(1,0),!0],[new C(1,1),new St(1,0),!0],[new C(1,2),new St(1,0),!0],[new C(1,3),new St(1,0),!0],[new C(1,4),new St(1,0),!0],[new C(1,5),new St(1,0),!0]]);const ze=X.NONE,Gc=X.ZERO,d4=X.ONE;class Bce{constructor(){u(this,"tutorial",[W.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,y1.getInitialState()),W.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new y1([[Gc,ze,ze,Gc,d4,ze],[Gc,d4,ze,ze,ze,ze],[Gc,ze,d4,ze,ze,ze],[Gc,ze,ze,ze,ze,d4],[Gc,ze,ze,ze,d4,ze],[ze,ze,ze,ze,ze,ze]],10)).withPreviousMove(Gr.withRotation(0,0,0,!1)),W.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new y1([[ze,ze,ze,ze,ze,ze],[ze,Gc,ze,ze,d4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,d4,ze,ze,Gc,ze],[ze,ze,ze,ze,ze,ze]],10),Gr.rotationless(2,2),(e,t,n)=>e.blockTurned.isPresent()?b.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):b.SUCCESS,$localize`Congratulations!`),W.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new y1([[ze,ze,ze,ze,ze,ze],[ze,Gc,ze,ze,d4,ze],[ze,ze,ze,ze,ze,ze],[ze,ze,ze,ze,ze,ze],[ze,d4,ze,ze,Gc,ze],[ze,ze,ze,ze,ze,ze]],10),Gr.withRotation(0,0,0,!0),(e,t,n)=>e.blockTurned.isPresent()?b.SUCCESS:b.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)])}}function Zht(r,e){if(1&r){const t=pe();A(),E(0,"circle",12),U("click",function(){const s=te(t).$implicit,o=p().$implicit,a=p().index,c=p().index;return ne(p().onClick(3*a+s,3*c+o))}),S()}if(2&r){const t=e.$implicit,n=p().$implicit,i=p(),s=i.index,o=i.$implicit,a=p(),c=a.index,l=a.$implicit,f=p();ye("id","click_",3*s+t,"_",3*c+n,""),y("ngClass",f.getSquareClasses(3*s+t,3*c+n)),k("cx",o+2*f.STROKE_WIDTH+(t+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(n+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}const Gce=function(){return[0,1,2]};function Yht(r,e){1&r&&(A(),Bt(0),T(1,Zht,1,6,"circle",11),Gt()),2&r&&(v(1),y("ngForOf",g1(1,Gce)))}function Kht(r,e){if(1&r&&(A(),Bt(0),F(1,"rect",10),T(2,Yht,2,2,"ng-container",4),Gt()),2&r){const t=e.$implicit,n=e.index,i=p(),s=i.index,o=i.$implicit,a=p();v(1),y("ngClass",a.getBlockClasses(n,s)),k("x",a.STROKE_WIDTH+t)("y",a.STROKE_WIDTH+o)("rx",3*a.STROKE_WIDTH)("ry",3*a.STROKE_WIDTH)("width",a.BLOCK_WIDTH)("height",a.BLOCK_WIDTH),v(1),y("ngForOf",g1(8,Gce))}}const Uce=function(r){return[0,r]};function Xht(r,e){if(1&r&&(A(),Bt(0),T(1,Kht,3,9,"ng-container",4),Gt()),2&r){const t=p();v(1),y("ngForOf",da(1,Uce,t.BLOCK_SEPARATION))}}function Qht(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p();ye("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),y("ngClass",t.getPlayerClass(t.getCurrentPlayer())),k("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function Jht(r,e){if(1&r){const t=pe();A(),E(0,"path",14),U("click",function(){const s=te(t).$implicit;return ne(p().rotate(s))}),S()}if(2&r){const t=e.$implicit,n=p();ye("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),k("d",t.path)("stroke-width",2*n.STROKE_WIDTH)}}function ept(r,e){if(1&r&&(A(),F(0,"path",15)),2&r){const t=p();ye("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),k("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function tpt(r,e){if(1&r&&(A(),F(0,"circle",16)),2&r){const t=e.$implicit,n=p();ye("id","victoryCoord_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),k("cx",n.getCenter(t.x))("cy",n.getCenter(t.y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)("stroke-width",n.STROKE_WIDTH)}}function npt(r,e){if(1&r){const t=pe();A(),E(0,"g",17),U("click",function(){return te(t),ne(p().skipRotation())}),F(1,"circle",18)(2,"line",19),S()}if(2&r){const t=p();v(1),k("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),v(1),k("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let rpt=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"BLOCK_WIDTH",void 0),u(this,"BLOCK_SEPARATION",void 0),u(this,"DIAGONAL_BAR_OFFSET",void 0),u(this,"arrows",[]),u(this,"victoryCoords",[]),u(this,"canSkipRotation",void 0),u(this,"currentDrop",g.empty()),u(this,"movedBlock",g.empty()),u(this,"lastDrop",g.empty()),u(this,"lastRotation",g.empty()),u(this,"ARROWS",void 0),this.rules=Bc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new $C(this.rules,"PentagoMinimax")],this.encoder=Gr.encoder,this.tutorial=(new Bce).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.lastDrop=g.empty(),this.lastRotation=g.empty()}showLastMove(n){this.cancelMoveAttempt(),this.movedBlock=n.blockTurned;const i=new C(n.coord.x%3-1,n.coord.y%3-1);if(n.blockTurned.isPresent()&&(this.showLastRotation(n),!1===i.equals(new C(0,0))&&this.coordBelongToBlock(n)))return this.showLastDrop(n,i);this.lastDrop=g.of(n.coord)}showLastRotation(n){if(n.blockTurned.isPresent()){const i=n.blockTurned.get(),s=this.ARROWS.filter(o=>o.blockIndex===i&&o.clockwise===n.turnedClockwise)[0];this.lastRotation=g.of(s)}}showLastDrop(n,i){let s;s=n.turnedClockwise?K.getNonNullable(y1.ROTATION_MAP.find(f=>f[0].equals(i)))[1]:K.getNonNullable(y1.ROTATION_MAP.find(f=>f[1].equals(i)))[0];const o=n.blockTurned.get(),l=new C(o%2==0?1:4,o<2?1:4);s=s.getNext(l,1),this.lastDrop=g.of(s)}coordBelongToBlock(n){return n.blockTurned.equalsValue(2*(n.coord.y<3?0:1)+(n.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=g.empty(),this.movedBlock=g.empty(),this.lastRotation=g.empty(),this.victoryCoords=[]}generateArrowsCoord(){const n=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,o=n-s,a=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+a+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+a,blockIndex:0,clockwise:!1},{path:"M "+n+" "+c+" q  "+s+"  "+s+"  0  "+a,blockIndex:1,clockwise:!0},{path:"M "+o+" 0 q -"+s+" -"+s+" -"+a+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+o+" q -"+s+" -"+s+"  0 -"+a,blockIndex:2,clockwise:!0},{path:"M "+c+" "+n+" q  "+s+"  "+s+"  "+a+"  0",blockIndex:2,clockwise:!1},{path:"M "+o+" "+n+" q -"+s+"  "+s+" -"+a+"  0",blockIndex:3,clockwise:!0},{path:"M "+n+" "+o+" q  "+s+" -"+s+"  0 -"+a,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=g.empty(),this.canSkipRotation=!1}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hidePreviousMove(),s.board[i][n].isPlayer())return s.cancelMove(Le.MUST_LAND_ON_EMPTY_SPACE());const a=Gr.rotationless(n,i),l=s.getState().applyLegalDrop(a);if(4===l.neutralBlocks.length)return s.chooseMove(a);const f=s.rules.getGameStatus(s.node);return s.canSkipRotation=l.neutralBlocks.length>0&&!1===f.isEndGame,s.currentDrop=g.of(new C(n,i)),s.displayArrows(l.neutralBlocks),b.SUCCESS})()}getCenter(n){return(n<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(n%3+.5)*this.SPACE_SIZE}displayArrows(n){this.arrows=[];for(let i=0;i<4;i++)if(!1===n.includes(i)){const s=this.ARROWS.filter(o=>o.blockIndex===i);this.arrows=this.arrows.concat(s)}}getBlockClasses(n,i){return this.movedBlock.equalsValue(n+2*i)?["last-move-stroke"]:[]}getSquareClasses(n,i){const s=[],o=this.getPlayerClass(this.board[i][n]);return s.push(o),this.lastDrop.equalsValue(new C(n,i))&&s.push("last-move-stroke"),s}rotate(n){var i=this;return P(function*(){const o=i.canUserPlay("#rotate_"+n.blockIndex+"_"+(n.clockwise?"clockwise":"counterclockwise"));if(o.isFailure())return i.cancelMove(o.getReason());const a=i.currentDrop.get(),c=Gr.withRotation(a.x,a.y,n.blockIndex,n.clockwise);return i.chooseMove(c)})()}skipRotation(){var n=this;return P(function*(){const i=n.canUserPlay("#skipRotation");if(i.isFailure())return n.cancelMove(i.getReason());const s=n.currentDrop.get(),o=Gr.rotationless(s.x,s.y);return n.chooseMove(o)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-pentago"]],features:[Je],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"defs")(2,"marker",1),F(3,"polygon",2),S()(),E(4,"defs")(5,"marker",3),F(6,"polygon",2),S()(),T(7,Xht,2,3,"ng-container",4),T(8,Qht,1,6,"circle",5),T(9,Jht,1,4,"path",6),T(10,ept,1,4,"path",7),T(11,tpt,1,7,"circle",8),T(12,npt,3,9,"g",9),S()),2&n&&(v(7),y("ngForOf",da(6,Uce,i.BLOCK_SEPARATION)),v(1),y("ngIf",i.currentDrop.isPresent()),v(1),y("ngForOf",i.arrows),v(1),y("ngIf",i.lastRotation.isPresent()),v(1),y("ngForOf",i.victoryCoords),v(1),y("ngIf",i.canSkipRotation))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),za=(()=>{class r extends F1{static getInitialState(){const t=He.createTable(r.SIZE,r.SIZE,X.NONE);return t[9][9]=X.ONE,new r(t,[0,0],0)}constructor(t,n,i){super(t,i),u(this,"captures",void 0),this.captures=n}}return u(r,"SIZE",19),r})();class B2 extends Mr{static isOnBoard(e){return e.isInRange(za.SIZE,za.SIZE)}static of(e){return K.assert(B2.isOnBoard(e),"PenteMove: coord is out of the board"),new B2(e.x,e.y)}constructor(e,t){super(e,t)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}u(B2,"encoder",Mr.getEncoder(B2.of));class Hs extends jn{static get(){return Hs.singleton.isAbsent()&&(Hs.singleton=g.of(new Hs)),Hs.singleton.get()}constructor(){super(za)}isLegal(e,t){return t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_CLICK_ON_EMPTY_SQUARE()):b.SUCCESS}applyLegalMove(e,t,n){const i=t.getCurrentPlayer(),s=t.getCopiedBoard();s[e.coord.y][e.coord.x]=i;const o=this.getCaptures(e.coord,t,i);for(const c of o)s[c.y][c.x]=X.NONE;const a=[t.captures[0],t.captures[1]];return a[i.value]+=o.length,new za(s,a,t.turn+1)}getCaptures(e,t,n){const i=n.getOpponent(),s=[];for(const o of Me.factory.all){const a=e.getNext(o,1),c=e.getNext(o,2),l=e.getNext(o,3);B2.isOnBoard(a)&&t.getPieceAt(a)===i&&B2.isOnBoard(c)&&t.getPieceAt(c)===i&&B2.isOnBoard(l)&&t.getPieceAt(l)===n&&(s.push(a),s.push(c))}return s}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();return t.captures[n.value]>=10||Hs.PENTE_HELPER.getVictoriousCoord(t).length>0?ve.getVictory(n):this.stillHaveEmptySquare(t)?ve.ONGOING:ve.DRAW}stillHaveEmptySquare(e){for(let t=0;t<za.SIZE;t++)for(let n=0;n<za.SIZE;n++)if(e.board[t][n]===X.NONE)return!0;return!1}}u(Hs,"PENTE_HELPER",new nu(B2.isOnBoard,K.identity,5)),u(Hs,"singleton",g.empty());class ipt extends uo{getListMoves(e){const n=[];return e.gameState.forEachCoord((i,s)=>{!1===s.isPlayer()&&n.push(B2.of(i))}),n}getBoardValue(e){const t=Hs.get().getGameStatus(e);return t.isEndGame?an.fromWinner(t.winner):Hs.PENTE_HELPER.getBoardValue(e.gameState)}}const h=X.NONE,Uc=X.ZERO,Da=X.ONE;class qce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,za.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,za.getInitialState(),B2.of(new C(9,8)),$localize`Congratulations!`),W.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new za([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Uc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Da,Uc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Da,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],3),[B2.of(new C(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new za([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Da,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Da,Uc,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Da,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[0,0],4),[B2.of(new C(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new za([[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Da,h,h,Uc,Uc,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Uc,h,Uc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,Da,Uc,Uc,Uc,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,Da,Da,Da,Da,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h],[h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h]],[8,8],7),[B2.of(new C(9,6)),B2.of(new C(8,9)),B2.of(new C(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)])}}function spt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getSpaceClass(t,n)),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.22*i.SPACE_SIZE)}}function opt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();ye("id","hoshi_",t,"_",n,""),k("cx",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("cy",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("r",.1*i.SPACE_SIZE)}}function apt(r,e){if(1&r&&(A(),F(0,"rect",9)(1,"line",10)(2,"line",10),T(3,opt,1,5,"circle",11)),2&r){const t=p().index,n=p().index,i=p();k("width",.5*i.SPACE_SIZE)("height",.5*i.SPACE_SIZE)("x",.5*i.SPACE_SIZE*t)("y",.5*i.SPACE_SIZE*n),v(1),k("x1",.5*i.SPACE_SIZE*t)("y1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n)("x2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),v(1),k("x1",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y1",.5*i.SPACE_SIZE*n)("x2",.25*i.SPACE_SIZE+.5*i.SPACE_SIZE*t)("y2",.5*i.SPACE_SIZE+.5*i.SPACE_SIZE*n),v(1),y("ngIf",i.isHoshi(t,n))}}function cpt(r,e){if(1&r){const t=pe();A(),E(0,"g",5),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,spt,1,6,"circle",6),T(2,apt,4,13,"ng-template",null,7,dn),S()}if(2&r){const t=e.$implicit,n=e.index,i=ln(3);ye("id","click_",n,"_",p().index,""),v(1),y("ngIf",t.isPlayer())("ngIfElse",i)}}function lpt(r,e){if(1&r&&(A(),E(0,"g"),T(1,cpt,4,4,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function upt(r,e){if(1&r){const t=pe();A(),E(0,"circle",13),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()}if(2&r){const t=e.$implicit,n=p();ye("id","capture_",t.x,"_",t.y,""),k("cx",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.x)("cy",.25*n.SPACE_SIZE+.5*n.SPACE_SIZE*t.y)("r",.07*n.SPACE_SIZE)}}let fpt=(()=>{var r;class e extends kL{constructor(n){super(n),u(this,"lastMoved",g.empty()),u(this,"victoryCoords",[]),u(this,"captured",[]),this.scores=g.of([0,0]),this.rules=Hs.get(),this.node=this.rules.getInitialNode(),this.encoder=B2.encoder,this.tutorial=(new qce).tutorial,this.availableMinimaxes=[new ipt(this.rules,"Alignment")]}updateBoard(){const n=this.getState();this.board=n.board,this.scores=g.of(this.getState().captures),this.victoryCoords=Hs.PENTE_HELPER.getVictoriousCoord(n),this.createHoshis(),this.cancelMoveAttempt()}showLastMove(){const n=this.node.move.get();this.lastMoved=g.of(n.coord);const i=this.getCurrentPlayer().getOpponent();this.captured=Hs.get().getCaptures(n.coord,this.getPreviousState(),i)}cancelMoveAttempt(){this.lastMoved=g.empty(),this.captured=[]}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);return s.chooseMove(B2.of(a))})()}getSpaceClass(n,i){const s=new C(n,i),o=this.getState().getPieceAt(s),a=[];return a.push(this.getPlayerClass(o)),this.victoryCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),this.lastMoved.equalsValue(s)&&a.push("last-move-stroke"),a}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-new-game"]],features:[Je],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),F(1,"rect",1),T(2,lpt,2,1,"g",2),T(3,upt,1,5,"circle",3),S()),2&n&&(k("viewBox","0 -3 "+i.board.length*i.SPACE_SIZE*.5+" "+(6+i.board.length*i.SPACE_SIZE*.5)),v(1),k("width",i.board.length*i.SPACE_SIZE*.5)("height",i.board.length*i.SPACE_SIZE*.5),v(1),y("ngForOf",i.board),v(1),y("ngForOf",i.captured))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Wd extends C{static getCoord3DEncoder(e){return Ie.tuple([Ie.identity(),Ie.identity(),Ie.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,n){return new Wd(e,t,n)}constructor(e,t,n){super(e,t),u(this,"z",void 0),this.z=n}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}var eR;class fn extends Wd{static of(e,t,n){return new fn(e,t,n)}constructor(e,t,n){super(e,t,n),K.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),K.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),K.assert(0<=n&&n<=3,`PylosCoord: Invalid Z: ${n}.`);const i=4-n;K.assert(this.isInRange(i,i),this.toString()+" is not in range.")}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new fn(this.x,this.y,e),new fn(this.x+1,this.y,e),new fn(this.x,this.y+1,e),new fn(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new C(this.x-1,this.y-1),n=new C(this.x,this.y-1),i=new C(this.x-1,this.y),s=new C(this.x,this.y),o=4-e;return[t,n,i,s].filter(a=>a.isInRange(o,o)).map(a=>new fn(a.x,a.y,e))}getNextValid(e){const t=new C(this.x,this.y).getNext(e),n=4-this.z;return t.isNotInRange(n,n)?g.empty():g.of(new fn(t.x,t.y,this.z))}}u(fn,"coordEncoder",Wd.getCoord3DEncoder((eR=fn).of)),u(fn,"optionalEncoder",g.getEncoder(eR.coordEncoder));let wl=(()=>{class r{}return u(r,"MUST_MOVE_UPWARD",()=>$localize`You must move your pieces upward.`),u(r,"SHOULD_HAVE_SUPPORTING_PIECES",()=>$localize`Your piece must land on the board or on 4 other pieces.`),u(r,"CANNOT_MOVE_SUPPORTING_PIECE",()=>$localize`You cannot move a supporting piece.`),u(r,"CANNOT_CAPTURE",()=>$localize`You cannot capture.`),u(r,"INVALID_FIRST_CAPTURE",()=>$localize`Your first capture is invalid.`),u(r,"INVALID_SECOND_CAPTURE",()=>$localize`Your second capture is invalid.`),r})();var jce;let Zce=(()=>{class r{}return u(r,"MUST_CAPTURE_MAXIMUM_TWO_PIECES",()=>$localize`You must capture one or two pieces, not more.`),r})();class ur extends Li{static ofClimb(e,t,n){const i=g.of(e),s=ur.checkCaptures(n),o=new ur(i,t,s.firstCapture,s.secondCapture);return K.assert(t.isHigherThan(e),wl.MUST_MOVE_UPWARD()),o}static checkCaptures(e){let t=g.empty(),n=g.empty();if(e.length>0&&(t=g.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=g.of(e[1]),e[1].isHigherThan(e[0])&&(t=g.of(e[1]),n=g.of(e[0])),e.length>2)throw new Error(Zce.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:n}}static ofDrop(e,t){const n=g.empty(),i=ur.checkCaptures(t);return new ur(n,e,i.firstCapture,i.secondCapture)}static changeCapture(e,t){const n=ur.checkCaptures(t);return new ur(e.startingCoord,e.landingCoord,n.firstCapture,n.secondCapture)}static of(e,t,n,i){return new ur(e,t,n,i)}constructor(e,t,n,i){super(),u(this,"startingCoord",void 0),u(this,"landingCoord",void 0),u(this,"firstCapture",void 0),u(this,"secondCapture",void 0),this.startingCoord=e,this.landingCoord=t,this.firstCapture=n,this.secondCapture=i}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}equals(e){return e===this||!(!1===this.startingCoord.equals(e.startingCoord)||!1===this.landingCoord.equals(e.landingCoord)||!1===this.firstCapture.equals(e.firstCapture)||!1===this.secondCapture.equals(e.secondCapture))}}jce=ur,u(ur,"encoder",Ie.tuple([fn.optionalEncoder,fn.coordEncoder,fn.optionalEncoder,fn.optionalEncoder],r=>[r.startingCoord,r.landingCoord,r.firstCapture,r.secondCapture],r=>jce.of(r[0],r[1],r[2],r[3])));class Ha extends Kv{static getInitialState(){const e=He.createTable(4,4,X.NONE),t=He.createTable(3,3,X.NONE),n=He.createTable(2,2,X.NONE);return new Ha([e,t,n,[[X.NONE]]],0)}static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return K.expectToBe(e,2),[0,1]}}constructor(e,t){super(t),u(this,"boards",void 0),this.boards=e}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const n=[];let i;return n.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&n.push({coord:e.startingCoord.get(),value:X.NONE}),e.firstCapture.isPresent()&&n.push({coord:e.firstCapture.get(),value:X.NONE}),e.secondCapture.isPresent()&&n.push({coord:e.secondCapture.get(),value:X.NONE}),i=t?this.turn+1:this.turn,this.setBoardAtCoords(n,i)}setBoardAtCoords(e,t){const n=[He.copyBiArray(this.boards[0]),He.copyBiArray(this.boards[1]),He.copyBiArray(this.boards[2]),He.copyBiArray(this.boards[3])];for(const i of e){const s=i.coord;n[s.z][s.y][s.x]=i.value}return new Ha(n,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const n of t)if(this.getPieceAt(n)===X.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const n of t)if(this.getPieceAt(n).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[X.NONE.value]=0,e[I.ZERO.value]=0,e[I.ONE.value]=0;for(let t=0;t<3;t++)for(let n=0;n<4-t;n++)for(let i=0;i<4-t;i++){const s=new fn(i,n,t),o=this.getPieceAt(s);e[o.value]=1+e[o.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:X.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let n=0;n<=2;n++){const i=Ha.getLevelRange(n);for(const s of i)for(const o of i){const a=new fn(o,s,n);this.getPieceAt(a).equals(t)&&!1===this.isSupporting(a)&&e.push(a)}}return e}}class v2 extends jn{static get(){return v2.singleton.isAbsent()&&(v2.singleton=g.of(new v2)),v2.singleton.get()}constructor(){super(Ha)}static getStateInfo(e){const t=[],n=[];for(let i=0;i<3;i++)for(let s=0;s<4-i;s++)for(let o=0;o<4-i;o++){const a=new fn(o,s,i);e.getPieceAt(a)===e.getCurrentPlayer()&&!1===e.isSupporting(a)&&t.push(a),e.isLandable(a)&&n.push(a)}return{freeToMove:t,landable:n}}static getClimbingMoves(e){const t=[];for(const n of e.freeToMove)for(const i of e.landable)if(i.isHigherThan(n)&&!1===i.getLowerPieces().some(s=>n.equals(s))){const s=ur.ofClimb(n,i,[]);t.push(s)}return t}static getDropMoves(e){const t=[];for(const n of e.landable){const i=ur.ofDrop(n,[]);t.push(i)}return t}static canCapture(e,t){const n=e.getCurrentPlayer();for(const i of[Re.UP,Re.DOWN]){const s=t.getNextValid(i);if(s.isPresent()&&e.getPieceAt(s.get())===n)for(const o of[Re.LEFT,Re.RIGHT]){const a=s.get().getNextValid(o);if(a.isPresent()&&e.getPieceAt(a.get())===n){const c=i.getOpposite(),l=a.get().getNextValid(c).get();if(e.getPieceAt(l)===n)return!0}}}return!1}static getPossibleCaptures(e){const t=new dt,n=e.getFreeToMoves();for(const i of n){t.add(new dt([i]));const o=e.removePieceAt(i).getFreeToMoves();for(const a of o){const c=new dt([i,a]);t.add(c)}}return t}static applyLegalMove(e,t,n){return t.applyLegalMove(e)}static isValidCapture(e,t,n){const i=e.getCurrentPlayer();return(!1!==n.equals(t.landingCoord)||e.getPieceAt(n)===i)&&0===n.getHigherCoords().filter(o=>e.getPieceAt(o).isPlayer()&&!1===o.equals(t.firstCapture.get())).length}static getGameStatus(e){const n=e.gameState.getPiecesRepartition();return 15===n[I.ZERO.value]?ve.ONE_WON:15===n[I.ONE.value]?ve.ZERO_WON:ve.ONGOING}applyLegalMove(e,t,n){return v2.applyLegalMove(e,t,n)}isLegal(e,t){const n=this.isLegalStartingCoord(e,t);if(n.isFailure())return n.toOtherFallible();const i=n.get(),s=this.isLegalLandingCoord(e,i);if(s.isFailure())return s.toOtherFallible();const o=s.get(),a=this.isLegalCaptures(e,o);return a.isFailure()?a:b.SUCCESS}isLegalStartingCoord(e,t){const n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const i=e.startingCoord.get(),s=t.getPieceAt(i);if(s===n)return se.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(s===X.NONE)return se.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===i.getHigherCoords().filter(a=>t.getPieceAt(a).isPlayer()).length){const a=t.removePieceAt(e.startingCoord.get());return se.success(a)}return se.failure(wl.CANNOT_MOVE_SUPPORTING_PIECE())}return se.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?se.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?se.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):se.failure(wl.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return b.SUCCESS;if(!1===v2.canCapture(t,e.landingCoord))return b.failure(wl.CANNOT_CAPTURE());if(v2.isValidCapture(t,e,e.firstCapture.get())){const n=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||v2.isValidCapture(n,e,e.secondCapture.get())?b.SUCCESS:b.failure(wl.INVALID_SECOND_CAPTURE())}return b.failure(wl.INVALID_FIRST_CAPTURE())}getGameStatus(e){return v2.getGameStatus(e)}}u(v2,"singleton",g.empty());class qd extends Hr{static getListMoves(e){const t=e.gameState,n=[],i=v2.getStateInfo(t),s=v2.getClimbingMoves(i),o=v2.getDropMoves(i),a=s.concat(o);for(const c of a){const l=t.applyLegalMove(c,!1);let f=new dt;v2.canCapture(l,c.landingCoord)?f=v2.getPossibleCaptures(l):n.push(c);for(const d of f){const m=ur.changeCapture(c,d.toList());n.push(m)}}return n}getListMoves(e){return qd.getListMoves(e)}getMetrics(e){const t=e.gameState.getPiecesRepartition();return[t[I.ZERO.value],t[I.ONE.value]]}}class pu extends qd{static countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}static sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}getListMoves(e){const t=qd.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((t,n)=>{const i=12*pu.countStoneUsed(t),s=12*pu.countStoneUsed(n);return i+pu.sumMoveEmplacementByValue(t)-(s+pu.sumMoveEmplacementByValue(n))})}}const Ge=X.NONE,h4=X.ZERO,Yce=X.ONE;class Kce extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Ha.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Ha.getInitialState(),ur.ofDrop(new fn(1,1,0),[]),$localize`There you go, as simple as that.`),W.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Ha([[[h4,Yce,Ge,Ge],[Yce,h4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,h4]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),[ur.ofClimb(new fn(3,3,0),new fn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),W.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Ha([[[h4,h4,Ge,Ge],[Ge,h4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),[ur.ofDrop(new fn(0,1,0),[new fn(0,0,0)]),ur.ofDrop(new fn(0,1,0),[new fn(0,1,0)]),ur.ofDrop(new fn(0,1,0),[new fn(1,0,0)]),ur.ofDrop(new fn(0,1,0),[new fn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),W.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Ha([[[h4,h4,Ge,Ge],[Ge,h4,Ge,Ge],[Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge]],[[Ge,Ge,Ge],[Ge,Ge,Ge],[Ge,Ge,Ge]],[[Ge,Ge],[Ge,Ge]],[[Ge]]],0),ur.ofDrop(new fn(0,1,0),[new fn(0,0,0),new fn(1,0,0)]),(t,n,i)=>t.secondCapture.isPresent()?b.SUCCESS:t.firstCapture.isPresent()?b.failure($localize`Failed, you only captured one piece.`):b.failure(zce.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)])}}function dpt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","piece_",n.value,"_",t,""),y("ngClass",i.getPlayerClass(n)),k("cx",i.SPACE_SIZE/4+t/15*(i.boardWidth-i.SPACE_SIZE/4))("cy",i.getPiecesCyForPlayer(n))("r",i.SPACE_SIZE/4-i.STROKE_WIDTH)}}function hpt(r,e){if(1&r&&(A(),E(0,"g"),T(1,dpt,1,6,"circle",7),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngForOf",n.getPlayerSidePieces(t))}}function ppt(r,e){if(1&r){const t=pe();A(),E(0,"circle",12),U("click",function(){te(t);const i=p(2).$implicit,s=p().$implicit,o=p().$implicit;return ne(p().onPieceClick(i,s,o))}),S()}if(2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit,s=p();Ti("id","piece_",t,"_",n,"_",i,""),y("ngClass",s.getPieceClasses(t,n,i)),k("r",s.getPieceRadius(i)-s.STROKE_WIDTH)("cx",s.getPieceCx(t,n,i))("cy",s.getPieceCy(t,n,i))}}function gpt(r,e){if(1&r){const t=pe();A(),E(0,"rect",12),U("click",function(){te(t);const i=p(3).$implicit,s=p().$implicit,o=p().$implicit;return ne(p().onDrop(i,s,o))}),S()}if(2&r){const t=p(3).$implicit,n=p().$implicit,i=p().$implicit,s=p();Ti("id","drop_",t,"_",n,"_",i,""),y("ngClass",s.getSquareClasses(t,n,i)),k("width",2*s.getPieceRadius(i))("height",2*s.getPieceRadius(i))("x",s.getPieceCx(t,n,i)-s.getPieceRadius(i))("y",s.getPieceCy(t,n,i)-s.getPieceRadius(i))}}function mpt(r,e){if(1&r&&(A(),T(0,gpt,1,8,"rect",13)),2&r){const t=p(2).$implicit,n=p().$implicit,i=p().$implicit;y("ngIf",p().mustDisplayLandingCoord(t,n,i))}}function _pt(r,e){if(1&r&&(A(),Bt(0),T(1,ppt,1,7,"circle",10),T(2,mpt,1,1,"ng-template",null,11,dn),Gt()),2&r){const t=ln(3),n=p().$implicit,i=p().$implicit,s=p().$implicit,o=p();v(1),y("ngIf",o.isOccupied(n,i,s))("ngIfElse",t)}}function vpt(r,e){if(1&r&&(A(),E(0,"g"),T(1,_pt,4,2,"ng-container",9),S()),2&r){const t=e.$implicit,n=p().$implicit,i=p().$implicit,s=p();v(1),y("ngIf",s.mustDraw(t,n,i))}}function Cpt(r,e){if(1&r&&(A(),E(0,"g"),T(1,vpt,2,1,"g",1),S()),2&r){const t=p().$implicit,n=p();v(1),y("ngForOf",n.getLevelRange(t))}}function ypt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Cpt,2,1,"g",1),S()),2&r){const t=e.$implicit,n=p();v(1),y("ngForOf",n.getLevelRange(t))}}function Mpt(r,e){if(1&r&&(A(),F(0,"rect",14)),2&r){const t=p();Ti("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),k("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function Ept(r,e){if(1&r){const t=pe();A(),E(0,"g",15),U("click",function(){return te(t),ne(p().validateCapture())}),F(1,"circle",16)(2,"polygon",17),S()}if(2&r){const t=p();k("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),v(1),y("ngClass",t.getCaptureValidationButtonClasses()),k("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function Spt(r,e){if(1&r){const t=pe();A(),E(0,"g",18),U("click",function(){const s=te(t).$implicit;return ne(p().onPieceClick(s.x,s.y,s.z))}),F(1,"line",19)(2,"line",19),S()}if(2&r){const t=e.$implicit,n=p();Ti("id","capturable_",t.x,"_",t.y,"_",t.z,""),k("transform","translate("+n.getPieceCxByCoord(t)+" "+n.getPieceCyByCoord(t)+")"),v(1),k("x1",-.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z)),v(1),k("x1",.25*n.getPieceRadius(t.z))("y1",-.25*n.getPieceRadius(t.z))("x2",-.25*n.getPieceRadius(t.z))("y2",.25*n.getPieceRadius(t.z))}}const Ppt=function(){return[0,1,2]};let Tpt=(()=>{var r;class e extends gl{constructor(n){super(n),u(this,"boardWidth",4*this.SPACE_SIZE+this.STROKE_WIDTH),u(this,"pieceRowHeight",this.SPACE_SIZE/2),u(this,"boardHeight",this.boardWidth+2*this.pieceRowHeight),u(this,"state",void 0),u(this,"constructedState",void 0),u(this,"lastLandingCoord",g.empty()),u(this,"lastStartingCoord",g.empty()),u(this,"lastFirstCapture",g.empty()),u(this,"lastSecondCapture",g.empty()),u(this,"highCapture",g.empty()),u(this,"capturables",[]),u(this,"chosenStartingCoord",g.empty()),u(this,"chosenLandingCoord",g.empty()),u(this,"chosenFirstCapture",g.empty()),u(this,"chosenSecondCapture",g.empty()),u(this,"lastMove",g.empty()),u(this,"remainingPieces",{0:15,1:15}),this.hasAsymmetricBoard=!0,this.rules=v2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new qd(this.rules,"PylosMinimax"),new pu(this.rules,"PylosOrderedMinimax")],this.encoder=ur.encoder,this.tutorial=(new Kce).tutorial,this.updateBoard()}getPiecesCyForPlayer(n){return n===I.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(n){return Ha.getLevelRange(n)}mustDraw(n,i,s){const o=new fn(n,i,s);return!!(this.constructedState.getPieceAt(o).isPlayer()||this.justClimbed(o)||this.isCaptured(o))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(o)}isCaptured(n){return this.chosenFirstCapture.equalsValue(n)||this.chosenSecondCapture.equalsValue(n)}onPieceClick(n,i,s){var o=this;return P(function*(){const a=o.canUserPlay("#piece_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new fn(n,i,s);return o.state.getPieceAt(c)===o.state.getCurrentOpponent()?o.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):o.chosenStartingCoord.equalsValue(c)?(o.cancelMoveAttempt(),b.SUCCESS):o.chosenLandingCoord.isPresent()?o.isSupporting(c,o.constructedState)?o.cancelMove(wl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onCaptureClick(c):o.isSupporting(c,o.getState())?o.cancelMove(wl.CANNOT_MOVE_SUPPORTING_PIECE()):o.onClimbClick(c)})()}isSupporting(n,i){return i.isSupporting(n)}onClimbClick(n){var i=this;return P(function*(){return i.chosenStartingCoord=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),b.SUCCESS})()}onCaptureClick(n){var i=this;return P(function*(){return i.chosenFirstCapture.equalsValue(n)?(i.chosenFirstCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.equalsValue(n)?(i.chosenSecondCapture=g.empty(),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenFirstCapture.isAbsent()?(i.chosenFirstCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.chosenSecondCapture.isAbsent()?(i.chosenSecondCapture=g.of(n),i.constructedState=i.constructedState.removePieceAt(n),i.updateCapturableList(),b.SUCCESS):i.cancelMove(Zce.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var n=this;return P(function*(){const i=n.canUserPlay("#capture_validation");return i.isFailure()?n.cancelMove(i.getReason()):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isAbsent()?b.SUCCESS:n.chosenFirstCapture.isPresent()&&n.chosenSecondCapture.isAbsent()?n.concludeMoveWithCapture([n.chosenFirstCapture.get()]):n.chosenFirstCapture.isAbsent()&&n.chosenSecondCapture.isPresent()?n.concludeMoveWithCapture([n.chosenSecondCapture.get()]):n.concludeMoveWithCapture([n.chosenFirstCapture.get(),n.chosenSecondCapture.get()])})()}concludeMoveWithCapture(n){var i=this;return P(function*(){if(i.chosenStartingCoord.isAbsent()){const s=ur.ofDrop(i.chosenLandingCoord.get(),n);return i.chooseMove(s)}{const s=ur.ofClimb(i.chosenStartingCoord.get(),i.chosenLandingCoord.get(),n);return i.chooseMove(s)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=g.empty(),this.chosenLandingCoord=g.empty(),this.chosenFirstCapture=g.empty(),this.chosenSecondCapture=g.empty(),this.capturables=[]}onDrop(n,i,s){var o=this;return P(function*(){const a=o.canUserPlay("#drop_"+n+"_"+i+"_"+s);if(a.isFailure())return o.cancelMove(a.getReason());const c=new fn(n,i,s);return v2.canCapture(o.constructedState,c)?(o.chosenLandingCoord=g.of(c),o.constructedState=o.constructedState.dropCurrentPlayersPieceAt(c),o.updateCapturableList(),b.SUCCESS):(o.chosenLandingCoord=g.of(c),o.concludeMoveWithCapture([]))})()}getSquareClasses(n,i,s){const o=new fn(n,i,s);if(this.lastMove.isPresent()){const a=this.lastMove.get();if(a.firstCapture.equalsValue(o)||a.secondCapture.equalsValue(o))return["captured-fill"];if(o.equals(a.landingCoord)||a.startingCoord.equalsValue(o))return["moved-fill"]}else if(this.justClimbed(o))return["moved-fill"];return[]}justClimbed(n){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(n)}getPieceRadius(n){return this.SPACE_SIZE*(.45+.025*n)}getPieceCx(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+n*this.SPACE_SIZE}getPieceCy(n,i,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+i*this.SPACE_SIZE}getPieceCxByCoord(n){return this.getPieceCx(n.x,n.y,n.z)}getPieceCyByCoord(n){return this.getPieceCy(n.x,n.y,n.z)}isOccupied(n,i,s){const o=new fn(n,i,s);if(this.justClimbed(o))return!1;const a=this.getState().getPieceAt(o).isPlayer(),c=this.chosenLandingCoord.equalsValue(o);return a||c}getPieceClasses(n,i,s){const o=new fn(n,i,s),a=[this.getPieceFillClass(o)];return(this.lastLandingCoord.equalsValue(o)||this.lastStartingCoord.equalsValue(o))&&a.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(o)||this.chosenLandingCoord.equalsValue(o))&&a.push("selected-stroke"),this.isCaptured(o)&&a.push("pre-captured-fill"),a}getPieceFillClass(n){return this.chosenLandingCoord.equalsValue(n)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(n))}getPlayerSidePieces(n){const i=this.remainingPieces[n.value],s=[];for(let o=0;o<i;o++)s.push(o);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.node.move;const n=this.state.getPiecesRepartition();this.remainingPieces={0:15-n[0],1:15-n[1]},this.highCapture=g.empty(),this.cancelMoveAttempt(),this.hideLastMove()}showLastMove(n){this.lastLandingCoord=g.of(n.landingCoord),this.lastStartingCoord=n.startingCoord,this.lastFirstCapture=n.firstCapture,this.lastSecondCapture=n.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=g.empty(),this.lastLandingCoord=g.empty(),this.lastFirstCapture=g.empty(),this.lastSecondCapture=g.empty()}mustDrawCoord(n){return this.mustDraw(n.x,n.y,n.z)}mustDisplayLandingCoord(n,i,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new fn(n,i,s))||this.chosenStartingCoord.get().z<s}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-pylos"]],features:[Je],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"g"),T(2,hpt,2,1,"g",1),S(),E(3,"g",null,2),F(5,"rect",3),T(6,ypt,2,1,"g",1),T(7,Mpt,1,7,"rect",4),T(8,Ept,3,5,"g",5),T(9,Spt,3,12,"g",6),S()()),2&n&&(k("viewBox","0 0 "+i.boardWidth+" "+i.boardHeight),v(1),k("transform","rotate("+180*i.role.value+" "+i.boardWidth/2+" "+i.boardHeight/2+")"),v(1),y("ngForOf",i.Player.PLAYERS),v(1),k("transform","translate("+i.STROKE_WIDTH/2+" "+(i.STROKE_WIDTH/2+i.pieceRowHeight)+")"),v(2),k("width",4*i.SPACE_SIZE)("height",4*i.SPACE_SIZE),v(1),y("ngForOf",g1(10,Ppt)),v(1),y("ngIf",i.highCapture.isPresent()),v(1),y("ngIf",i.chosenLandingCoord.isPresent()),v(1),y("ngForOf",i.capturables))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var In,Xce;class yt{static ofInt(e){if(0<=e&&e<=15)return yt.pieces[e];if(16===e)return yt.EMPTY;throw new Error("Invalid piece ("+e+")")}constructor(e){u(this,"value",void 0),this.value=e}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}u(yt,"AAAA",new(In=yt)(0)),u(yt,"AAAB",new In(1)),u(yt,"AABA",new In(2)),u(yt,"AABB",new In(3)),u(yt,"ABAA",new In(4)),u(yt,"ABAB",new In(5)),u(yt,"ABBA",new In(6)),u(yt,"ABBB",new In(7)),u(yt,"BAAA",new In(8)),u(yt,"BAAB",new In(9)),u(yt,"BABA",new In(10)),u(yt,"BABB",new In(11)),u(yt,"BBAA",new In(12)),u(yt,"BBAB",new In(13)),u(yt,"BBBA",new In(14)),u(yt,"BBBB",new In(15)),u(yt,"EMPTY",new In(16)),u(yt,"pieces",[In.AAAA,In.AAAB,In.AABA,In.AABB,In.ABAA,In.ABAB,In.ABBA,In.ABBB,In.BAAA,In.BAAB,In.BABA,In.BABB,In.BBAA,In.BBAB,In.BBBA,In.BBBB]),u(yt,"encoder",Ie.fromFunctions(r=>r.value,In.ofInt));class Wc extends Mr{constructor(e,t,n){super(e,t),u(this,"piece",void 0),this.piece=n}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}Xce=Wc,u(Wc,"encoder",Ie.tuple([C.encoder,yt.encoder],r=>[r.coord,r.piece],r=>new Xce(r[0].x,r[0].y,r[1])));class Va extends F1{constructor(e,t,n){super(e,t),u(this,"pieceInHand",void 0),this.pieceInHand=n}static getInitialState(){const e=He.createTable(4,4,yt.EMPTY);return new Va(e,0,yt.AAAA)}static isGivable(e,t,n){return e!==n&&!1===Va.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let n=0;n<4;n++)for(let i=0;i<4;i++)if(t[n][i]===e)return!0;return!1}getRemainingPieces(){const e=yt.pieces,t=[];for(const n of e)Va.isGivable(n,this.board,this.pieceInHand)&&t.push(n);return t}}let tR=(()=>{class r{}return u(r,"MUST_GIVE_A_PIECE",()=>$localize`You must give a piece.`),u(r,"PIECE_ALREADY_ON_BOARD",()=>$localize`That piece is already on the board.`),u(r,"CANNOT_GIVE_PIECE_IN_HAND",()=>$localize`You cannot give the piece that was in your hands.`),r})();class jd{constructor(e){u(this,"subCriterion",[g.empty(),g.empty(),g.empty(),g.empty()]),this.subCriterion[0]=g.of(8==(8&e.value)),this.subCriterion[1]=g.of(4==(4&e.value)),this.subCriterion[2]=g.of(2==(2&e.value)),this.subCriterion[3]=g.of(1==(1&e.value))}mergeWith(e){let t=4;for(let n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=g.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new jd(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new jd(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class qc{constructor(e,t){u(this,"initialCoord",void 0),u(this,"direction",void 0),this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class Or extends jn{static get(){return Or.singleton.isAbsent()&&(Or.singleton=g.of(new Or)),Or.singleton.get()}constructor(){super(Va)}static isOccupied(e){return e!==yt.EMPTY}static isLegal(e,t){const n=e.coord.x,i=e.coord.y,s=e.piece,o=t.getCopiedBoard(),a=t.pieceInHand;return Or.isOccupied(o[i][n])?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):s===yt.EMPTY?15===t.turn?b.SUCCESS:b.failure(tR.MUST_GIVE_A_PIECE()):Va.isAlreadyOnBoard(s,o)?b.failure(tR.PIECE_ALREADY_ON_BOARD()):a===s?b.failure(tR.CANNOT_GIVE_PIECE_IN_HAND()):b.SUCCESS}isLegal(e,t){return Or.isLegal(e,t)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.coord.y][e.coord.x]=t.pieceInHand,new Va(i,t.turn+1,e.piece)}static updateBoardStatus(e,t,n){return n.score===en.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:en.VICTORY,sensitiveSquares:new $1}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}static isThereAVictoriousLine(e,t){let n=e.initialCoord,i=t.getPieceAt(n);const s=new jd(i);for(let o=0;o<3&&!1!==Or.isOccupied(i)&&!s.areAllAbsent();o++)n=n.getNext(e.direction,1),i=t.getPieceAt(n),s.mergeWithQuartoPiece(i);return!(!Or.isOccupied(i)||!1!==s.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,n){const i=Or.getLineInfos(e,t,n);if(i.boardStatus.isPresent())return i.boardStatus.get();const s=i.commonCriterion,o=i.sensitiveCoord;if(s.isPresent()&&!1===s.get().areAllAbsent()){if(o.isAbsent())return{score:en.VICTORY,sensitiveSquares:new $1};{s.get().matchPiece(t.pieceInHand)&&(n.score=en.PRE_VICTORY);const a=o.get();n.sensitiveSquares.add(a)}}return n}static getLineInfos(e,t,n){let i=g.empty(),s=g.empty(),o=e.initialCoord;for(let a=0;a<4;a++){const c=t.getPieceAt(o);if(c===yt.EMPTY){if(!i.isAbsent())return{sensitiveCoord:g.of(o),commonCriterion:s,boardStatus:g.of(n)};i=g.of(o)}else s.isAbsent()?(s=g.of(new jd(c)),we.display("QuartoRules","getLineInfos","set commonCrit to "+s.toString())):(s.get().mergeWithQuartoPiece(c),we.display("QuartoRules","getLineInfos","update commonCrit: "+s.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:s,sensitiveCoord:i,boardStatus:g.empty()}}static scoreToGameStatus(e,t){const n=I.of(t%2);return e===en.VICTORY?ve.getDefeat(n):16===t?ve.DRAW:ve.ONGOING}getGameStatus(e){const t=e.gameState;let n={score:en.DEFAULT,sensitiveSquares:new $1};for(const i of Or.lines)if(n=Or.updateBoardStatus(i,t,n),n.score===en.VICTORY)return Or.scoreToGameStatus(n.score,t.turn);return Or.scoreToGameStatus(n.score,t.turn)}getVictoriousCoords(e){for(const t of Or.lines)if(Or.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}u(Or,"singleton",g.empty()),u(Or,"lines",[new qc(new C(0,0),Me.DOWN),new qc(new C(1,0),Me.DOWN),new qc(new C(2,0),Me.DOWN),new qc(new C(3,0),Me.DOWN),new qc(new C(0,0),Me.RIGHT),new qc(new C(0,1),Me.RIGHT),new qc(new C(0,2),Me.RIGHT),new qc(new C(0,3),Me.RIGHT),new qc(new C(0,0),Me.DOWN_RIGHT),new qc(new C(0,3),Me.UP_RIGHT)]);class nR extends uo{static scoreToBoardValue(e,t){if(e===en.DEFAULT)return new an(0);{const n=I.of(t%2);return new an(e===en.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}getListMoves(e){const t=[],n=e.gameState,i=n.getCopiedBoard(),s=n.getRemainingPieces(),o=n.pieceInHand;let a;for(let c=0;c<4;c++)for(let l=0;l<4;l++)if(i[c][l]===yt.EMPTY){if(a=n.getCopiedBoard(),a[c][l]=o,15===n.turn){const f=new Wc(l,c,yt.EMPTY);return t.push(f),t}for(const f of s){const d=new Wc(l,c,f);t.push(d)}}return t}getBoardValue(e){const t=e.gameState;let n={score:en.DEFAULT,sensitiveSquares:new $1};for(const i of Or.lines)if(n=Or.updateBoardStatus(i,t,n),n.score===en.VICTORY)break;return nR.scoreToBoardValue(n.score,t.turn)}}const Opt=yt.AABA,bpt=yt.AABB,Qce=yt.ABAA,wpt=yt.ABAB,Npt=yt.ABBA,Jce=yt.BAAA,Apt=yt.BAAB,Ipt=yt.BABB,e3e=yt.BBAA,kpt=yt.BBAB,rR=yt.BBBA,xpt=yt.BBBB,Xn=yt.EMPTY;class t3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Va([[rR,e3e,Qce,Opt],[Xn,Xn,Xn,Xn],[Xn,Xn,Xn,Xn],[Xn,Xn,Xn,Xn]],7,yt.ABAB)),W.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Va([[rR,bpt,Npt,Xn],[Xn,Xn,Xn,Xn],[Xn,Jce,Xn,Xn],[Xn,Xn,Xn,Xn]],7,yt.ABAA),new Wc(2,2,yt.BAAB),$localize`Perfect!`),W.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Va([[xpt,rR,kpt,Xn],[Qce,Ipt,e3e,Xn],[wpt,Jce,Apt,Xn],[Xn,Xn,Xn,Xn]],7,yt.AABA),[new Wc(3,3,yt.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)])}}function Lpt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),k("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("y",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(n.value)))("width",2*o.getPieceSize(n.value))("height",2*o.getPieceSize(n.value))}}function Rpt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2),n=t.$implicit,i=t.index,s=p().index,o=p();y("ngClass",o.getPieceClasses(n.value)),k("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("r",o.getPieceSize(n.value))}}function zpt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function Dpt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Lpt,1,5,"rect",10),T(2,Rpt,1,4,"ng-template",null,11,dn),T(4,zpt,1,3,"circle",7),S()),2&r){const t=ln(3),n=p().$implicit,i=p(2);v(1),y("ngIf",n.isRectangle())("ngIfElse",t),v(3),y("ngIf",i.pieceHasDot(n.value))}}function Hpt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",9),U("click",function(){const s=te(t).index,o=p().index;return ne(p().chooseCoord(s,o))}),S(),T(2,Dpt,5,3,"g",7),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","chooseCoord_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),k("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t!==s.EMPTY)}}function Vpt(r,e){if(1&r&&(A(),E(0,"g",null,8),T(2,Hpt,3,8,"g",2),S()),2&r){const t=e.$implicit;v(2),y("ngForOf",t)}}function Fpt(r,e){if(1&r&&(A(),F(0,"rect",17)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function $pt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function Bpt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2);k("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function Gpt(r,e){if(1&r){const t=pe();A(),E(0,"g",13,14),U("click",function(){return te(t),ne(p().deselectDroppedPiece())}),F(2,"rect",15),T(3,Fpt,1,5,"rect",16),T(4,$pt,1,4,"ng-template",null,11,dn),T(6,Bpt,1,3,"circle",7),S()}if(2&r){const t=ln(5),n=p();ye("id","droppedPiece_",n.chosen.get().x,"_",n.chosen.get().y,""),k("transform","translate("+n.chosen.get().x*n.SPACE_SIZE+" "+n.chosen.get().y*n.SPACE_SIZE+")"),v(2),k("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),v(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),v(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function Upt(r,e){if(1&r&&(A(),E(0,"g",null,18),F(2,"rect",19),S()),2&r){const t=e.$implicit,n=p();v(2),k("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)("transform","translate("+t.x*n.SPACE_SIZE+" "+t.y*n.SPACE_SIZE+")")}}function Wpt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function qpt(r,e){if(1&r&&(A(),F(0,"circle",21)),2&r){const t=p(2);y("ngClass",t.getPieceClasses(t.pieceInHand.value)),k("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function jpt(r,e){1&r&&(A(),F(0,"circle",22)),2&r&&k("cy",.75*p(2).SPACE_SIZE)("r",10)}function Zpt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Wpt,1,6,"rect",10),T(2,qpt,1,3,"ng-template",null,11,dn),T(4,jpt,1,2,"circle",20),S()),2&r){const t=ln(3),n=p();v(1),y("ngIf",n.pieceInHand.isRectangle())("ngIfElse",t),v(3),y("ngIf",n.pieceHasDot(n.pieceInHand.value))}}function Ypt(r,e){if(1&r&&(A(),F(0,"rect",27)),2&r){const t=p(2).index,n=p().index,i=p();Rn("id","chosenPiece_",4*n+t,""),k("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Kpt(r,e){if(1&r&&(A(),F(0,"rect",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),k("x",i.SPACE_SIZE*t+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("y",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*n+t))("width",2*i.getPieceSize(4*n+t))("height",2*i.getPieceSize(4*n+t))}}function Xpt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).index,n=p().index,i=p();y("ngClass",i.getPieceClasses(4*n+t)),k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",i.getPieceSize(4*n+t))}}function Qpt(r,e){if(1&r&&(A(),F(0,"circle")),2&r){const t=p(2).index,n=p().index,i=p();k("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("r",10)}}function Jpt(r,e){if(1&r){const t=pe();A(),E(0,"g",13),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().choosePiece(4*s+i))}),T(1,Ypt,1,5,"rect",26),T(2,Kpt,1,5,"rect",10),T(3,Xpt,1,4,"ng-template",null,11,dn),T(5,Qpt,1,3,"circle",7),S()}if(2&r){const t=ln(4),n=p().index,i=p().index,s=p();Rn("id","choosePiece_",4*i+n,""),v(1),y("ngIf",s.pieceToGive.equalsValue(s.QuartoPiece.ofInt(4*i+n))),v(1),y("ngIf",(4*i+n)%4<2)("ngIfElse",t),v(3),y("ngIf",s.pieceHasDot(4*i+n))}}function egt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Jpt,6,5,"g",3),S()),2&r){const t=e.index,n=p().index,i=p();v(1),y("ngIf",i.isRemaining(4*n+t))}}function tgt(r,e){if(1&r&&(A(),E(0,"g",null,23),F(2,"rect",24,25),T(4,egt,2,1,"g",2),S()),2&r){const t=e.$implicit,n=p();k("transform","translate(0 "+6.5*n.SPACE_SIZE+")"),v(2),k("x",-.125*n.SPACE_SIZE)("y",-.125*n.SPACE_SIZE)("width",4.25*n.SPACE_SIZE)("height",4.25*n.SPACE_SIZE),v(2),y("ngForOf",t)}}let ngt=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"EMPTY",yt.EMPTY),u(this,"QuartoPiece",yt),u(this,"chosen",g.empty()),u(this,"lastMove",g.empty()),u(this,"pieceInHand",yt.EMPTY),u(this,"pieceToGive",g.empty()),u(this,"victoriousCoords",[]),this.rules=Or.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new nR(this.rules,"QuartoMinimax")],this.encoder=Wc.encoder,this.tutorial=(new t3e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const n=this.getState(),i=this.node.move;this.board=n.getCopiedBoard(),this.chosen=g.empty(),this.pieceInHand=n.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(n),this.lastMove=i.map(s=>s.coord)}chooseCoord(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#chooseCoord_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());if(s.hideLastMove(),s.board[i][n]===yt.EMPTY){if(s.showPieceInHandOnBoard(n,i),15===s.getState().turn){const a=new Wc(n,i,yt.EMPTY);return s.chooseMove(a)}if(s.pieceToGive.isAbsent())return b.SUCCESS;{const a=new Wc(n,i,s.pieceToGive.get());return s.chooseMove(a)}}return s.cancelMove(Le.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(n){var i=this;return P(function*(){const s=i.canUserPlay("#choosePiece_"+n);if(s.isFailure())return i.cancelMove(s.getReason());if(i.hideLastMove(),i.pieceToGive.equalsValue(yt.ofInt(n)))return i.cancelMoveAttempt(),b.SUCCESS;if(i.pieceToGive=g.of(yt.ofInt(n)),i.chosen.isAbsent())return b.SUCCESS;{const o=i.chosen.get(),a=new Wc(o.x,o.y,i.pieceToGive.get());return i.chooseMove(a)}})()}hideLastMove(){this.lastMove=g.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=g.empty(),this.chosen=g.empty()}deselectDroppedPiece(){const n=this.chosen.getOrElse(new C(404,404)),s=this.canUserPlay("#droppedPiece_"+n.x+"_"+n.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),b.SUCCESS)}showPieceInHandOnBoard(n,i){this.chosen=g.of(new C(n,i))}isRemaining(n){return Va.isGivable(yt.ofInt(n),this.board,this.pieceInHand)}getSquareClasses(n,i){const s=new C(n,i);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(n){const i=[];return i.push(n%2==0?"player0-fill":"player1-fill"),i}getPieceSize(n){return n<8?40:25}pieceHasDot(n){return n!==yt.EMPTY.value&&n%8<4}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-quarto"]],features:[Je],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"g",1),T(2,Vpt,3,1,"g",2),T(3,Gpt,7,8,"g",3),T(4,Upt,3,3,"g",2),E(5,"g",null,4),F(7,"rect",5,6),T(9,Zpt,5,3,"g",7),S(),T(10,tgt,5,6,"g",2),S()()),2&n&&(k("viewBox","0 0 "+4.25*i.SPACE_SIZE+" "+10.75*i.SPACE_SIZE),v(2),y("ngForOf",i.board),v(1),y("ngIf",i.chosen.isPresent()),v(1),y("ngForOf",i.victoriousCoords),v(1),k("transform","translate("+2*i.SPACE_SIZE+", "+4.5*i.SPACE_SIZE+")"),v(2),k("width",1.5*i.SPACE_SIZE)("height",1.5*i.SPACE_SIZE)("transform","translate("+-.75*i.SPACE_SIZE+", 0)"),v(2),y("ngIf",i.chosen.isAbsent()),v(1),y("ngForOf",i.board))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),rgt=(()=>{class r{}return u(r,"NO_INSIDE_CLICK",()=>$localize`You must pick a space from the edge of the board.`),r})(),J1=(()=>{class r extends F1{static getInitialState(){const t=He.createTable(r.SIZE,r.SIZE,X.NONE);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}applyLegalMove(t){const n=this.getCopiedBoard(),i=this.turn+1;let s=t.coord,o=t.coord.getNext(t.direction);for(;r.isOnBoard(o);)n[s.y][s.x]=n[o.y][o.x],s=s.getNext(t.direction),o=o.getNext(t.direction);return n[s.y][s.x]=this.getCurrentPlayer(),new r(n,i)}}return u(r,"SIZE",5),r})();var n3e;class jc extends Mr{static isValidCoord(e){return!1===J1.isOnBoard(e)?b.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&e.x!==J1.SIZE-1&&0!==e.y&&e.y!==J1.SIZE-1?b.failure(rgt.NO_INSIDE_CLICK()):b.SUCCESS}constructor(e,t,n){super(e,t),u(this,"direction",void 0),this.direction=n;const i=jc.isValidCoord(this.coord);if(i.isFailure())throw new Error(i.getReason());if(0===e&&n===Re.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(e===J1.SIZE-1&&n===Re.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&n===Re.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(t===J1.SIZE-1&&n===Re.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!1!==e.coord.equals(this.coord)&&e.direction===this.direction}}n3e=jc,u(jc,"encoder",Ie.tuple([C.encoder,Re.encoder],r=>[r.coord,r.direction],r=>new n3e(r[0].x,r[0].y,r[1])));class G2 extends jn{static get(){return G2.singleton.isAbsent()&&(G2.singleton=g.of(new G2)),G2.singleton.get()}constructor(){super(J1)}static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=0;i<J1.SIZE;i++)e.gameState.getPieceAtXY(0,i)!==t&&n.push(new C(0,i)),e.gameState.getPieceAtXY(J1.SIZE-1,i)!==t&&n.push(new C(J1.SIZE-1,i));return n}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),n=[];for(let i=1;i<J1.SIZE-1;i++)e.gameState.getPieceAtXY(i,0)!==t&&n.push(new C(i,0)),e.gameState.getPieceAtXY(i,J1.SIZE-1)!==t&&n.push(new C(i,J1.SIZE-1));return n}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(Re.LEFT),0!==e.y&&t.push(Re.UP),e.x!==J1.SIZE-1&&t.push(Re.RIGHT),e.y!==J1.SIZE-1&&t.push(Re.DOWN),t}static getLinesSums(e){const t={};t[I.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[I.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(const n of e.getCoordsAndContents()){const i=n.content,s=n.coord.x,o=n.coord.y;if(i.isPlayer()){const a=i.value;t[a].columns[s]=t[a].columns[s]+1,t[a].rows[o]=t[a].rows[o]+1,s===o&&(t[a].diagonals[0]=t[a].diagonals[0]+1),s+o===J1.SIZE-1&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}static getVictoriousCoords(e){return G2.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,n){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):b.SUCCESS}getGameStatus(e){const t=e.gameState,i=G2.QUIXO_HELPER.getVictoriousCoord(t).map(o=>t.getPieceAt(o)),s=new dt(i);return 0===s.size()?ve.ONGOING:1===s.size()?ve.getVictory(s.getAnyElement().get()):ve.getVictory(t.getCurrentPlayer())}}u(G2,"singleton",g.empty()),u(G2,"QUIXO_HELPER",new nu(J1.isOnBoard,K.identity,J1.SIZE));class igt extends Hr{getListMoves(e){const t=[],n=G2.getVerticalCoords(e),s=G2.getHorizontalCenterCoords(e).concat(n);for(const o of s){const a=G2.getPossibleDirections(o);for(const c of a){const l=new jc(o.x,o.y,c);t.push(l)}}return t}getMetrics(e){const n=G2.getLinesSums(e.gameState);return[G2.getFullestLine(n[I.ZERO.value]),G2.getFullestLine(n[I.ONE.value])]}}const M1=X.NONE,Qo=X.ZERO,Fa=X.ONE;class r3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,J1.getInitialState()),W.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new J1([[M1,M1,M1,M1,M1],[M1,M1,M1,M1,M1],[M1,M1,M1,M1,M1],[M1,M1,M1,M1,M1],[Qo,Qo,Qo,Qo,M1]],1),[new jc(4,4,Re.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),W.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new J1([[M1,Fa,M1,Fa,Fa],[M1,Qo,Qo,M1,Qo],[Fa,Fa,Fa,Qo,Fa],[Qo,M1,Qo,Fa,Fa],[Fa,Qo,M1,Fa,Qo]],31),[new jc(3,0,Re.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}function sgt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"circle",4),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onBoardClick(s,o))}),S()()}if(2&r){const t=e.index,n=p().index,i=p();v(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("r",.45*i.SPACE_SIZE)("cx",(t+.5)*i.SPACE_SIZE)("cy",(n+.5)*i.SPACE_SIZE)}}function ogt(r,e){if(1&r&&(A(),E(0,"g"),T(1,sgt,2,6,"g",2),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function agt(r,e){if(1&r){const t=pe();A(),E(0,"use",6),U("click",function(){const s=te(t).$implicit;return ne(p(2).chooseDirection(s))}),S()}if(2&r){const t=e.$implicit,n=p(2);Rn("id","chooseDirection_",t,""),k("transform",n.getArrowTransform(t))}}function cgt(r,e){if(1&r&&(A(),E(0,"g"),T(1,agt,1,2,"use",5),S()),2&r){const t=p();v(1),y("ngForOf",t.getPossiblesDirections())}}let lgt=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"QuixoState",J1),u(this,"state",void 0),u(this,"lastMoveCoord",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"chosenDirection",void 0),u(this,"victoriousCoords",[]),this.rules=G2.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new igt(this.rules,"QuixoMinimax")],this.encoder=jc.encoder,this.tutorial=(new r3e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.node.move.map(n=>n.coord),this.victoriousCoords=G2.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=g.empty()}getPieceClasses(n,i){const s=new C(n,i),a=[];return a.push(this.getPlayerClass(this.board[i][n])),this.chosenCoord.equalsValue(s)?a.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&a.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&a.push("victory-stroke"),a}onBoardClick(n,i){const s=this.canUserPlay("#click_"+n+"_"+i);if(s.isFailure())return this.cancelMove(s.getReason());const o=new C(n,i),a=jc.isValidCoord(o);return a.isFailure()?this.cancelMove(a.getReason()):this.board[i][n]===this.state.getCurrentOpponent()?this.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(o)?this.cancelMoveAttempt():this.chosenCoord=g.of(o),b.SUCCESS)}getPossiblesDirections(){const n=[],i=this.chosenCoord.get();return i.x!==J1.SIZE-1&&n.push(Re.RIGHT),0!==i.x&&n.push(Re.LEFT),i.y!==J1.SIZE&&n.push(Re.DOWN),0!==i.y&&n.push(Re.UP),n}chooseDirection(n){var i=this;return P(function*(){const s=i.canUserPlay("#chooseDirection_"+n.toString());return s.isFailure()?i.cancelMove(s.getReason()):(i.chosenDirection=n,yield i.tryMove())})()}tryMove(){var n=this;return P(function*(){const i=n.chosenCoord.get(),s=new jc(i.x,i.y,n.chosenDirection);return n.chooseMove(s)})()}getArrowTransform(n){return U9t.getArrowTransform(J1.SIZE*this.SPACE_SIZE,new C(0,0),n)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-quixo"]],features:[Je],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0)(1,"defs"),F(2,"polygon",1),S(),T(3,ogt,2,1,"g",2),T(4,cgt,2,1,"g",3),S()),2&n&&(k("viewBox","0 0 "+i.QuixoState.SIZE*i.SPACE_SIZE+" "+i.QuixoState.SIZE*i.SPACE_SIZE),v(3),y("ngForOf",i.board),v(1),y("ngIf",i.chosenCoord.isPresent()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),Jr=(()=>{class r extends F1{static getInitialState(){const t=He.createTable(r.BOARD_WIDTH,r.BOARD_HEIGHT,X.NONE);return t[3][3]=I.ZERO,t[4][4]=I.ZERO,t[3][4]=I.ONE,t[4][3]=I.ONE,new r(t,0)}static isOnBoard(t){return t.isInRange(r.BOARD_WIDTH,r.BOARD_HEIGHT)}static getNeighboringPawnLike(t,n,i,s){let o;const a=[];for(let c=-1;c<2;c++)for(let l=-1;l<2;l++)o=new C(i+l,s+c),r.isOnBoard(o)&&t[o.y][o.x]===n&&a.push(o);return a}countScore(){const t=[0,0];for(let n=0;n<r.BOARD_HEIGHT;n++)for(let i=0;i<r.BOARD_WIDTH;i++){const s=this.board[n][i];s.isPlayer()&&(t[s.value]+=1)}return t}}return u(r,"BOARD_WIDTH",8),u(r,"BOARD_HEIGHT",8),r})();var iR;class Gi extends Mr{static of(e){return new Gi(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}u(Gi,"encoder",Mr.getEncoder((iR=Gi).of)),u(Gi,"PASS",new iR(-1,-1));let ugt=(()=>{class r{}return u(r,"NO_ELEMENT_SWITCHED",()=>$localize`Your move should switch at least one piece.`),r})();var BC,Jo;class i3e{constructor(e,t){u(this,"move",void 0),u(this,"switched",void 0),this.move=e,this.switched=t}}let gu=(BC=class extends jn{static get(){return Jo.singleton.isAbsent()&&(Jo.singleton=g.of(new Jo)),Jo.singleton.get()}constructor(){super(Jr)}static getGameStatus(e){const t=e.gameState;if(!1===Jo.isGameEnded(t))return ve.ONGOING;const i=t.countScore(),s=i[1]-i[0];return s<0?ve.ZERO_WON:s>0?ve.ONE_WON:ve.DRAW}applyLegalMove(e,t,n){const i=t.turn,s=t.getCurrentPlayer(),o=t.getCopiedBoard();if(e.equals(Gi.PASS))return new Jr(o,i+1);for(const c of n)o[c.y][c.x]=s;return o[e.coord.y][e.coord.x]=s,new Jr(o,i+1)}static getAllSwitcheds(e,t,n){const i=[],s=t.getOpponent();for(const o of Me.DIRECTIONS){const a=e.coord.getNext(o);if(Jr.isOnBoard(a)&&n[a.y][a.x]===s){const c=Jo.getSandwicheds(t,o,a,n);for(const l of c)i.push(l)}}return i}static getSandwicheds(e,t,n,i){const s=[n];let o=n.getNext(t);for(;Jr.isOnBoard(o);){const a=i[o.y][o.x];if(a===e)return s;if(a===X.NONE)return[];s.push(o),o=o.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return Jo.getGameStatus(e)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(Gi.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),i=new Jr(t,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const t=[];let n;const i=e.getCurrentPlayer(),s=e.getCurrentOpponent();for(let o=0;o<8;o++)for(let a=0;a<8;a++)if(e.getPieceAtXY(a,o)===X.NONE&&(n=e.getCopiedBoard(),Jr.getNeighboringPawnLike(n,s,a,o).length>0)){const l=new Gi(a,o),f=Jo.getAllSwitcheds(l,i,n);if(f.length>0){for(const d of f)K.assert(i!==e.getPieceAt(d),d+"was already switched!"),n[d.y][d.x]=i;n[o][a]=i,t.push(new i3e(l,f.length))}}return 0===t.length&&t.push(new i3e(Gi.PASS,0)),t}isLegal(e,t){if(e.equals(Gi.PASS))return Jo.playerCanOnlyPass(t)?se.success([]):se.failure(Le.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return se.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const n=t.getCopiedBoard(),i=Jo.getAllSwitcheds(e,t.getCurrentPlayer(),n);return 0===i.length?se.failure(ugt.NO_ELEMENT_SWITCHED()):se.success(i)}},Jo=BC,u(BC,"singleton",g.empty()),BC);gu=Jo=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],gu);class GC extends Hr{getMetrics(e){const n=e.gameState.getCopiedBoard();let i=0,s=0;for(let o=0;o<Jr.BOARD_HEIGHT;o++)for(let a=0;a<Jr.BOARD_WIDTH;a++){const f=(0===a||a===Jr.BOARD_WIDTH-1?4:1)*(0===o||o===Jr.BOARD_HEIGHT-1?4:1);n[o][a]===I.ZERO&&(i+=f),n[o][a]===I.ONE&&(s+=f)}return[i,s]}getListMoves(e){const t=gu.getListMoves(e.gameState);return He.sortByDescending(t,n=>GC.bestCoords.some(i=>n.move.coord.equals(i))?100:n.switched),t.map(n=>n.move)}}u(GC,"bestCoords",[new C(0,0),new C(0,Jr.BOARD_HEIGHT-1),new C(Jr.BOARD_WIDTH-1,0),new C(Jr.BOARD_WIDTH-1,Jr.BOARD_HEIGHT-1)]);const Mt=X.NONE,Pt=X.ZERO,Ze=X.ONE;class s3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new Jr([[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Pt,Pt,Pt,Pt,Pt,Pt,Pt]],60)),W.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,Jr.getInitialState(),new Gi(2,4),$localize`Congratulations!`),W.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new Jr([[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Ze,Mt,Mt,Mt],[Mt,Mt,Mt,Pt,Mt,Mt,Mt,Mt],[Mt,Mt,Pt,Mt,Mt,Mt,Mt,Mt],[Pt,Pt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Pt,Ze,Pt,Ze,Pt,Mt,Mt]],1),[new Gi(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),W.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new Jr([[Ze,Pt,Pt,Pt,Pt,Pt,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Pt,Ze,Ze,Ze,Ze,Ze,Ze,Pt],[Ze,Ze,Ze,Ze,Ze,Ze,Mt,Mt],[Pt,Pt,Pt,Pt,Pt,Pt,Mt,Mt]],60))])}}function dgt(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();y("ngClass",i.getPieceClass(t,n)),k("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function hgt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",2),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),S(),T(2,dgt,1,4,"circle",3),S()}if(2&r){const t=e.index,n=p().index,i=p();v(1),ye("id","click_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("x",i.SPACE_SIZE*t)("y",i.SPACE_SIZE*n)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function pgt(r,e){if(1&r&&(A(),E(0,"g"),T(1,hgt,3,8,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}let ggt=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"EMPTY",X.NONE),u(this,"lastMove",new C(-2,-2)),u(this,"capturedCoords",[]),this.scores=g.of([2,2]),this.rules=gu.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new GC(this.rules,"ReversiMinimax")],this.encoder=Gi.encoder,this.tutorial=(new s3e).tutorial,this.canPass=!1,this.updateBoard()}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new Gi(n,i);return yield s.chooseMove(a)})()}updateBoard(){const n=this.getState();this.board=n.getCopiedBoard(),this.capturedCoords=[],this.lastMove=new C(-2,-2),this.scores=g.of(n.countScore()),this.canPass=gu.playerCanOnlyPass(n)}showLastMove(n){this.lastMove=n.coord;const i=this.getState().getCurrentPlayer(),s=this.getState().getCurrentOpponent();for(const o of Me.DIRECTIONS){let a=this.lastMove.getNext(o,1);for(;Jr.isOnBoard(a)&&this.getState().getPieceAt(a)===s&&this.getPreviousState().getPieceAt(a)===i;)this.capturedCoords.push(a),a=a.getNext(o,1)}}getRectClasses(n,i){const s=new C(n,i);return this.capturedCoords.some(o=>o.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(n,i){return this.getPlayerClass(this.board[i][n])}pass(){var n=this;return P(function*(){return K.assert(n.canPass,"ReversiComponent: pass() can only be called if canPass is true"),n.onClick(Gi.PASS.coord.x,Gi.PASS.coord.y)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-reversi"]],features:[Je],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,pgt,2,1,"g",1),S()),2&n&&(k("viewBox","0 -4 "+8*i.SPACE_SIZE+" "+(10+8*i.SPACE_SIZE)),v(1),y("ngForOf",i.board))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),$a=(()=>{class r extends C0{static getInitialState(){const t=Ce.UNREACHABLE,n=Ce.ZERO,i=Ce.ONE,s=Ce.EMPTY;return new r([[t,t,n,i,s,s,s,n,i,t,t],[t,s,s,s,s,s,s,s,s,s,t],[i,s,s,s,s,s,s,s,s,s,n],[n,s,s,s,s,s,s,s,s,s,i],[t,s,s,s,s,s,s,s,s,s,t],[t,t,i,n,s,s,s,i,n,t,t]],0)}static isOnBoard(t){return t.isInRange(r.WIDTH,r.HEIGHT)}}return u(r,"HEIGHT",6),u(r,"WIDTH",11),r})(),mu=(()=>{class r{}return u(r,"CAN_ONLY_REBOUND_ON_BLACK",()=>$localize`You can only rebound on dark spaces.`),u(r,"CAN_ONLY_REBOUND_ON_EMPTY_SPACE",()=>$localize`You can only rebound on empty spaces.`),u(r,"MUST_CHOOSE_PYRAMID_FIRST",()=>$localize`You must pick one of your pyramids first.`),u(r,"MUST_CHOOSE_OWN_PYRAMID",()=>$localize`You must pick one of your pyramids.`),u(r,"THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS",()=>$localize`Those two spaces are not neighbors.`),u(r,"THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR",()=>$localize`Those two spaces have no intermediary neighbor.`),r})();class Ba extends Vo{static checkDistanceAndLocation(e,t){const n=e.getOrthogonalDistance(t);if(0===n)return b.failure(Le.MOVE_CANNOT_BE_STATIC());if(1===n){const i=$o.getFakeNeighbors(e);if(t.equals(i))return b.failure(mu.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return b.failure($localize`You can move one or two spaces, not ${n}.`);if($o.isSpaceDark(e))return b.failure(mu.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return b.failure(mu.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return b.SUCCESS}static from(e,t){K.assert($a.isOnBoard(e),"Move must start inside the board not at "+e.toString()+"."),K.assert($a.isOnBoard(t),"Move must end inside the board not at "+t.toString()+".");const n=Ba.checkDistanceAndLocation(e,t);return n.isFailure()?n.toOtherFallible():se.success(new Ba(e,t))}constructor(e,t){super(e,t)}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var UC,Zc;u(Ba,"encoder",zs.getFallibleEncoder(Ba.from));let w0=(UC=class extends jn{static get(){return Zc.singleton.isAbsent()&&(Zc.singleton=g.of(new Zc)),Zc.singleton.get()}constructor(){super($a)}static getStartingCoords(e,t){const n=[];for(let i=0;i<$a.HEIGHT;i++)for(let s=0;s<$a.WIDTH;s++)e[i][s].is(t)&&n.push(new C(s,i));return n}static getBoardValuesFor(e,t){const n=Zc.getStartingCoords(e,t),i=[];for(const s of n){const o=C0.getEmptyNeighbors(e,s,Ce.EMPTY).length;if(0===o)return[0];i.push(o)}return i.sort((s,o)=>s-o)}applyLegalMove(e,t,n){const i=t.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=Ce.EMPTY,new $a(i,t.turn+1)}isLegal(e,t){if(t.getPieceAt(e.getStart()).value!==t.getCurrentPlayer().value)return b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.getEnd())!==Ce.EMPTY)return b.failure(Le.MUST_LAND_ON_EMPTY_SPACE());const s=$o.getCommonNeighbor(e.getStart(),e.getEnd());return s.isPresent()?t.getPieceAt(s.get())===Ce.EMPTY?b.SUCCESS:b.failure(mu.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):b.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),n=Zc.getBoardValuesFor(t,I.ZERO),i=Zc.getBoardValuesFor(t,I.ONE);return Zc.getGameStatusFromFreedoms(n,i)}getLandingCoords(e,t){const n=s=>$a.isOnBoard(s)&&e[s.y][s.x]===Ce.EMPTY,i=new dt($o.getNeighbors(t).filter(n));if(!0===$o.isSpaceDark(t))return i.toList();{const s=new dt(i.toList());for(const o of i){const a=$o.getNeighbors(o).filter(n);for(const c of a)s.add(c)}return s.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?ve.ONE_WON:0===t[0]?ve.ZERO_WON:ve.ONGOING}},Zc=UC,u(UC,"singleton",g.empty()),UC);w0=Zc=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],w0);class _gt extends Hr{getListMoves(e){const t=[],n=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),s=w0.getStartingCoords(n,i);for(const o of s){const a=C0.getEmptyNeighbors(n,o,Ce.EMPTY);for(const c of a){const l=Ba.from(o,c).get();if(n[c.y][c.x]=n[o.y][o.x],n[o.y][o.x]=Ce.EMPTY,t.push(l),(c.y+c.x)%2==0){const d=C0.getEmptyNeighbors(n,c,Ce.EMPTY);for(const m of d)if(!1===m.equals(o)){const M=Ba.from(o,m).get();n[m.y][m.x]=n[c.y][c.x],n[c.y][c.x]=Ce.EMPTY,t.push(M),n[c.y][c.x]=n[m.y][m.x],n[m.y][m.x]=Ce.EMPTY}}n[o.y][o.x]=n[c.y][c.x],n[c.y][c.x]=Ce.EMPTY}}return t}getMetrics(e){const t=e.gameState.board,n=w0.getBoardValuesFor(t,I.ZERO),i=w0.getBoardValuesFor(t,I.ONE);let s=0;for(;s<6&&n[s]===i[s];)s++;return[n[s%6],i[s%6]]}}const ea=Ce.UNREACHABLE,_u=Ce.ZERO,vu=Ce.ONE,on=Ce.EMPTY;class a3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,$a.getInitialState()),W.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new $a([[ea,ea,on,on,vu,on,on,_u,vu,ea,ea],[ea,on,on,on,on,on,on,on,on,on,ea],[vu,_u,on,on,on,on,on,on,on,on,_u],[_u,on,on,on,on,on,on,on,on,on,vu],[ea,on,on,on,on,on,on,on,on,on,ea],[ea,ea,vu,_u,on,on,on,vu,_u,ea,ea]],3)),W.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,$a.getInitialState(),Ba.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>t.isSimpleStep()?b.SUCCESS:b.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),W.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,$a.getInitialState(),Ba.from(new C(7,0),new C(5,0)).get(),(t,n,i)=>t.isSimpleStep()?b.failure($localize`Failed! You have made a single step.`):b.SUCCESS,$localize`Congratulations!`)])}}function vgt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"polygon",7),S()),2&r){const t=p().index,n=p().index,i=p();v(1),y("ngClass",i.getPlayerClassFor(t,n)),k("points",i.getPyramidPoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Cgt(r,e){if(1&r&&(A(),F(0,"polygon",10)),2&r){const t=p(2).index,n=p().index,i=p();k("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function ygt(r,e){if(1&r&&(A(),F(0,"polygon",11)),2&r){const t=p(2).index,n=p().index,i=p();k("points",i.getTrianglePoints(t,n))("transform",i.getTriangleTranslate(t,n))}}function Mgt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Cgt,1,2,"polygon",8),T(2,ygt,1,2,"polygon",9),S()),2&r){const t=p().index,n=p().index;v(1),y("ngIf",(t+n)%2==1),v(1),y("ngIf",(t+n)%2==0)}}function Egt(r,e){if(1&r){const t=pe();A(),E(0,"g",5),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),T(1,vgt,2,3,"g",6),T(2,Mgt,3,2,"g",6),S()}if(2&r){const t=e.$implicit;ye("id","click_",e.index,"_",p().index,""),v(1),y("ngIf",t.isPlayer()),v(1),y("ngIf",2===t.value)}}function Sgt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Egt,3,4,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Pgt(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=e.$implicit,n=p(2);ye("id","possible_landing_",t.x,"_",t.y,""),k("points",n.getTrianglePoints(t.x,t.y))("transform",n.getTriangleTranslate(t.x,t.y))}}function Tgt(r,e){if(1&r&&(A(),F(0,"polygon",14)),2&r){const t=p(2);ye("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),k("points",t.getTrianglePoints(t.chosenCoord.get().x,t.chosenCoord.get().y))("transform",t.getTriangleTranslate(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function Ogt(r,e){if(1&r&&(A(),Bt(0),T(1,Pgt,1,4,"polygon",12),T(2,Tgt,1,4,"polygon",13),Gt()),2&r){const t=p();v(1),y("ngForOf",t.possibleLandings),v(1),y("ngIf",t.chosenCoord.isPresent())}}function bgt(r,e){if(1&r&&(A(),Bt(0),F(1,"polygon",15)(2,"polygon",15),Gt()),2&r){const t=p(2);v(1),k("points",t.getTrianglePoints(t.lastCoord.get().x,t.lastCoord.get().y))("transform",t.getTriangleTranslate(t.lastCoord.get().x,t.lastCoord.get().y)),v(1),k("points",t.getTrianglePoints(t.lastMoved.get().x,t.lastMoved.get().y))("transform",t.getTriangleTranslate(t.lastMoved.get().x,t.lastMoved.get().y))}}function wgt(r,e){1&r&&(A(),T(0,bgt,3,4,"ng-container",6)),2&r&&y("ngIf",p().lastMoved.isPresent())}let Ngt=(()=>{var r;class e extends Gae{constructor(n){super(n),u(this,"lastCoord",g.empty()),u(this,"lastMoved",g.empty()),u(this,"chosenCoord",g.empty()),u(this,"possibleLandings",[]),this.rules=w0.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new _gt(this.rules,"SaharaMinimax")],this.encoder=Ba.encoder,this.tutorial=(new a3e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=g.empty()}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=s.getState().getCurrentPlayer(),c=Ce.ofPlayer(a);return s.chosenCoord.equalsValue(new C(n,i))?(s.cancelMoveAttempt(),b.SUCCESS):s.chosenCoord.isAbsent()||s.board[i][n]===c?s.choosePiece(n,i):s.chooseLandingCoord(n,i)})()}choosePiece(n,i){if(this.board[i][n]===Ce.EMPTY)return this.cancelMove(mu.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[i][n].is(I.ofTurn(this.getTurn()))){const s=new C(n,i);return this.selectPiece(s),b.SUCCESS}return this.cancelMove(mu.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(n){this.chosenCoord=g.of(n),this.possibleLandings=this.rules.getLandingCoords(this.board,n)}chooseLandingCoord(n,i){var s=this;return P(function*(){const o=new C(n,i),a=Ba.from(s.chosenCoord.get(),o);return a.isFailure()?s.cancelMove(a.getReason()):yield s.chooseMove(a.get())})()}updateBoard(){const n=this.node.move;this.lastCoord=n.map(i=>i.getStart()),this.lastMoved=n.map(i=>i.getEnd()),this.board=this.getState().board}getPlayerClassFor(n,i){return this.getPlayerClass(I.of(this.board[i][n].value))}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-sahara"]],features:[Je],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-55 -55 610 610","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["class","base mid-stroke",4,"ngIf"],["class","base mid-stroke background2",4,"ngIf"],[1,"base","mid-stroke"],[1,"base","mid-stroke","background2"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill mid-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","mid-stroke","selected-stroke",3,"id"],[1,"base","no-fill","mid-stroke","moved-stroke"]],template:function(n,i){if(1&n&&(A(),E(0,"svg",0),T(1,Sgt,2,1,"g",1),T(2,Ogt,3,2,"ng-container",2),T(3,wgt,1,1,"ng-template",null,3,dn),S()),2&n){const s=ln(4);v(1),y("ngForOf",i.board),v(1),y("ngIf",i.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();var Ga;class ut{static decode(e){switch(e){case 0:return ut.EMPTY;case 1:return ut.LIGHT_UP;case 2:return ut.LIGHT_RIGHT;case 3:return ut.LIGHT_DOWN;case 4:return ut.LIGHT_LEFT;case 5:return ut.DARK_UP;case 6:return ut.DARK_RIGHT;case 7:return ut.DARK_DOWN;case 8:return ut.DARK_LEFT;case 9:return ut.MOUNTAIN}}belongTo(e){return e===I.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!1===this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?I.ZERO:5<=this.value&&this.value<=8?I.ONE:X.NONE}getOptionalDirection(){switch(this.value){case 0:return g.empty();case 1:case 5:return g.of(Re.UP);case 2:case 6:return g.of(Re.RIGHT);case 3:case 7:return g.of(Re.DOWN);case 4:case 8:return g.of(Re.LEFT);default:return K.expectToBe(this.value,9),g.empty()}}static of(e,t){return t===I.ZERO?e===Re.UP?ut.LIGHT_UP:e===Re.RIGHT?ut.LIGHT_RIGHT:e===Re.DOWN?ut.LIGHT_DOWN:ut.LIGHT_LEFT:e===Re.UP?ut.DARK_UP:e===Re.RIGHT?ut.DARK_RIGHT:e===Re.DOWN?ut.DARK_DOWN:ut.DARK_LEFT}constructor(e){u(this,"value",void 0),this.value=e}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return K.expectToBe(this.value,9),"MOUNTAIN"}}}u(ut,"EMPTY",new(Ga=ut)(0)),u(ut,"LIGHT_UP",new Ga(1)),u(ut,"LIGHT_RIGHT",new Ga(2)),u(ut,"LIGHT_DOWN",new Ga(3)),u(ut,"LIGHT_LEFT",new Ga(4)),u(ut,"DARK_UP",new Ga(5)),u(ut,"DARK_RIGHT",new Ga(6)),u(ut,"DARK_DOWN",new Ga(7)),u(ut,"DARK_LEFT",new Ga(8)),u(ut,"MOUNTAIN",new Ga(9));let E1=(()=>{class r extends F1{static getInitialState(){const t=He.createTable(r.SIZE,r.SIZE,ut.EMPTY);return t[2][1]=ut.MOUNTAIN,t[2][2]=ut.MOUNTAIN,t[2][3]=ut.MOUNTAIN,new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(const n of this.getCoordsAndContents())n.content!==ut.EMPTY&&t[n.content.getOwner().value]++;return t}}return u(r,"SIZE",5),r})();var c3e;class Vs extends Mr{constructor(e,t,n,i){super(e,t),u(this,"x",void 0),u(this,"y",void 0),u(this,"direction",void 0),u(this,"landingOrientation",void 0),this.x=e,this.y=t,this.direction=n,this.landingOrientation=i}static from(e,t,n,i){const s=new Vs(e,t,n,i),o=!1===E1.isOnBoard(s.coord);if(s.isRotation()){if(o)return se.failure("Cannot rotate piece outside the board: "+s.toString())}else if(!1===E1.isOnBoard(s.coord.getNext(s.direction.get()))){if(o)return se.failure("SiamMove should end or start on the board: "+s.toString());if(s.direction.get()!==s.landingOrientation)return se.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+s.toString())}return se.success(s)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!1!==this.coord.equals(e.coord)&&!1!==this.direction.equals(e.direction)&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||this.coord.x===+E1.SIZE||-1===this.coord.y||this.coord.y===+E1.SIZE}}c3e=Vs,u(Vs,"encoder",Ie.tuple([Ie.identity(),Ie.identity(),g.getEncoder(Re.encoder),Re.encoder],r=>[r.x,r.y,r.direction,r.landingOrientation],r=>c3e.from(r[0],r[1],r[2],r[3]).get()));let Cu=(()=>{class r{}return u(r,"NO_REMAINING_PIECE_TO_INSERT",()=>$localize`You cannot insert a piece, all your pieces are already on the board.`),u(r,"NOT_ENOUGH_FORCE_TO_PUSH",()=>$localize`You do not have enough strength to push.`),u(r,"MUST_MOVE_OR_ROTATE",()=>$localize`You must move or rotate your piece.`),u(r,"ILLEGAL_PUSH",()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`),u(r,"MUST_SELECT_VALID_DESTINATION",()=>$localize`You must select a valid destination (highlighted on the board) for your piece`),u(r,"MUST_SELECT_ORIENTATION",()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`),r})();var WC,yu;class l3e{constructor(e,t){u(this,"resultingBoard",void 0),u(this,"moved",void 0),this.resultingBoard=e,this.moved=t}}let Ua=(WC=class extends jn{static get(){return yu.singleton.isAbsent()&&(yu.singleton=g.of(new yu)),yu.singleton.get()}constructor(){super(E1)}isLegal(e,t){if(!1===e.isInsertion()&&!1===t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return se.failure(Le.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return this.isLegalRotation(e,t);{let n;if(e.isInsertion()){const i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return se.failure(i.legal.getReason());n=i.insertedPiece}else n=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,n)}}isLegalInsertion(e,t){const n=t.countCurrentPlayerPawn(),i=t.getCurrentPlayer(),s=n<5?b.SUCCESS:b.failure(Cu.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,i),legal:s}}getInsertedPiece(e,t){return ut.of(-1===e.x?Re.RIGHT:-1===e.y?Re.DOWN:e.x===E1.SIZE?Re.LEFT:Re.UP,t)}isLegalForwarding(e,t,n){K.assert(n!==ut.MOUNTAIN&&n!==ut.EMPTY,"forwarding must be done with player piece");const i=[];let s=ut.of(e.landingOrientation,t.getCurrentPlayer());const o=e.direction.get();let a=e.coord.getNext(o);if(E1.isOnBoard(a)&&t.getPieceAt(a)!==ut.EMPTY&&!1===this.isStraight(n,e))return se.failure(Cu.ILLEGAL_PUSH());let c=g.of(o);const l=o.getOpposite();let f=0;const d=t.getCopiedBoard();E1.isOnBoard(e.coord)&&(d[e.coord.y][e.coord.x]=ut.EMPTY,i.push(e.coord));let m=E1.isOnBoard(a)&&s!==ut.EMPTY;for(;m;){c.equalsValue(o)?f++:c.equalsValue(l)&&f--;const M=d[a.y][a.x];M===ut.MOUNTAIN&&(f-=.9),d[a.y][a.x]=s,i.push(a),s=M,a=a.getNext(o),c=s.getOptionalDirection(),m=E1.isOnBoard(a)&&s!==ut.EMPTY&&f>0}return!1===E1.isOnBoard(a)&&(c.equalsValue(o)?f++:c.equalsValue(l)&&f--),f<=0?se.failure(Cu.NOT_ENOUGH_FORCE_TO_PUSH()):se.success(new l3e(d,i))}isStraight(e,t){const n=e.getDirection();return t.direction.equalsValue(n)&&n===t.landingOrientation}isLegalRotation(e,t){const n=e.coord,i=t.getPieceAt(n),s=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return se.failure(Cu.MUST_MOVE_OR_ROTATE());const o=t.getCopiedBoard();return o[n.y][n.x]=ut.of(e.landingOrientation,s),se.success(new l3e(o,[n]))}applyLegalMove(e,t,n){const i=He.copyBiArray(n.resultingBoard);return new E1(i,t.turn+1)}getBoardValueInfo(e,t){const n=this.getMountainsRowsAndColumns(t),i=n.rows,s=n.columns,o=this.getWinner(t,e,n.nbMountain);if(o.isPlayer())return o===I.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const a=this.getPushers(t,s,i);let c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER;const f=t.getCurrentPlayer();for(const m of a)E1.isOnBoard(m.coord)?t.getPieceAt(m.coord).belongTo(I.ZERO)?c=Math.min(c,m.distance):l=Math.min(l,m.distance):f===I.ZERO?c=Math.min(c,m.distance):l=Math.min(l,m.distance);return{shortestZero:c,shortestOne:l,boardValue:this.getScoreFromShortestDistances(c,l,f)}}}getScoreFromShortestDistances(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const i=6-e,s=6-t;return i===s?n.getScoreModifier():i>s?-10*(i+1)+(s+1):10*(s+1)-(i+1)}getMountainsRowsAndColumns(e){const t=[],n=[];let i=0;for(const s of e.getCoordsAndContents())s.content===ut.MOUNTAIN&&(!1===t.includes(s.coord.y)&&t.push(s.coord.y),!1===n.includes(s.coord.x)&&n.push(s.coord.x),i++);return{rows:t,columns:n,nbMountain:i}}getWinner(e,t,n){return 2===n?this.getPusher(e,t.get()):X.NONE}getPusher(e,t){const n=t.coord;let i;i=E1.isOnBoard(n)?e.getPieceAt(n.getNext(t.landingOrientation)):this.getInsertedPiece(n,e.getCurrentOpponent());const s=i.getDirection(),o=this.getPusherCoord(e,s,n),a=e.getPieceAt(o).getOwner();return we.display("SiamRules","getPusher",n.toString()+" belong to "+e.getCurrentOpponent().value+", "+o.toString()+" belong to "+a.value+", "+a.value+" win"),a}getPusherCoord(e,t,n){let i=n.getNext(t),s=n;for(;E1.isOnBoard(i);){n=i,i=i.getNext(t);const o=e.getPieceAt(n);o!==ut.MOUNTAIN&&o.getDirection()===t&&(s=n)}return s}getPushers(e,t,n){let i=[];const s=[];for(const o of t){let a=Re.DOWN,c=new C(o,4);s.push({direction:a,fallingCoord:c}),a=Re.UP,c=new C(o,0),s.push({direction:a,fallingCoord:c})}for(const o of n){let a=Re.LEFT,c=new C(0,o);s.push({direction:a,fallingCoord:c}),a=Re.RIGHT,c=new C(4,o),s.push({direction:a,fallingCoord:c})}for(const o of s)i=this.addPotentialDirectionPusher(e,o.fallingCoord,o.direction,i);return i}addPotentialDirectionPusher(e,t,n,i){const s=this.getLineClosestPusher(e,t,n);if(s.isAbsent())return i;const o=s.get();return i.push({coord:o.coord,distance:o.distance}),i}getLineClosestPusher(e,t,n){const i=n.getOpposite();let s=1,o=e.getPieceAt(t),a=t,c=g.empty(),l=!1,f=!1,d=0;for(;E1.isOnBoard(a)&&!1===l;){const m=e.getPieceAt(a);if(m.isEmptyOrMountain())m===ut.MOUNTAIN?(d+=.9,f=!0):s++;else{const M=m.getDirection();M===n?f&&(d-=1,d<=0&&(l=!0,a=a.getNext(n))):M===i?(d+=1,!1===f&&s++):f?(c=g.of(a),o!==ut.EMPTY&&s++):s++}o=m,a=a.getPrevious(n)}if(!1===l&&c.isPresent())for(s++,d-=1;!1===a.equals(c.get());)a=a.getNext(n),s--;return!1===E1.isOnBoard(a)&&(d-=1,5===e.countCurrentPlayerPawn())||d>0?g.empty():g.of({distance:s,coord:a})}getInsertions(e){let t=[];for(let n=1;n<4;n++)t=t.concat(this.getInsertionsAt(e,0,n)),t=t.concat(this.getInsertionsAt(e,4,n)),t=t.concat(this.getInsertionsAt(e,n,0)),t=t.concat(this.getInsertionsAt(e,n,4));return t=t.concat(this.getInsertionsAt(e,0,0)),t=t.concat(this.getInsertionsAt(e,0,4)),t=t.concat(this.getInsertionsAt(e,4,0)),t=t.concat(this.getInsertionsAt(e,4,4)),t}getInsertionsAt(e,t,n){const i=[];for(const s of Re.ORTHOGONALS){const o=new C(t,n).getPrevious(s);if(!1===E1.isOnBoard(o))for(const a of Re.ORTHOGONALS){const c=Vs.from(o.x,o.y,g.of(s),a);K.assert(c.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(c.get(),e).isSuccess()&&i.push(c.get())}}return i}getMovesFrom(e,t,n,i){const s=new C(n,i);let o=this.getRotationMovesAt(s,t);for(const a of Re.ORTHOGONALS){const c=s.getNext(a);o=o.concat(this.getForwardMovesBetween(e,s,c))}return o}getMovesBetween(e,t,n,i){return n.equals(i)?this.getRotationMovesAt(n,t):Re.factory.fromMove(n,i).isSuccess()&&1===n.getDistance(i)?this.getForwardMovesBetween(e,n,i):[]}getRotationMovesAt(e,t){const n=[],i=t.getDirection();for(const s of Re.ORTHOGONALS)if(s!==i){const o=Vs.from(e.x,e.y,g.empty(),s).get();n.push(o)}return n}getForwardMovesBetween(e,t,n){const i=[];let s;const o=Re.factory.fromMove(t,n).get(),a=e.getPieceAt(t);s=E1.isOnBoard(n)?Re.ORTHOGONALS:[o];for(const c of s){const l=Vs.from(t.x,t.y,g.of(o),c).get();this.isLegalForwarding(l,e,a).isSuccess()&&i.push(l)}return i}getGameStatus(e){const t=this.getMountainsRowsAndColumns(e.gameState),n=this.getWinner(e.gameState,e.move,t.nbMountain);return n.isPlayer()?ve.getVictory(n):ve.ONGOING}},yu=WC,u(WC,"singleton",g.empty()),WC);Ua=yu=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],Ua);let sR=class extends uo{getBoardValue(e){return new an(Ua.get().getBoardValueInfo(e.move,e.gameState).boardValue)}getListMoves(e){let t=[];const n=e.gameState.getCurrentPlayer();for(const i of e.gameState.getCoordsAndContents()){const s=i.content;s.belongTo(n)&&(t=t.concat(Ua.get().getMovesFrom(e.gameState,s,i.coord.x,i.coord.y)))}if(e.gameState.countCurrentPlayerPawn()<5)for(const i of Ua.get().getInsertions(e.gameState))if(i.direction.get().getOpposite()!==i.landingOrientation){if(this.isOnBorder(i)&&i.direction.get()!==i.landingOrientation)continue;t.push(i)}return t}isOnBorder(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}};sR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],sR);const Ae=ut.EMPTY,_o=ut.MOUNTAIN,oR=ut.LIGHT_UP,aR=ut.LIGHT_LEFT,Mu=ut.LIGHT_RIGHT,kgt=ut.LIGHT_DOWN,xgt=ut.DARK_UP,u3e=ut.DARK_LEFT,f3e=ut.DARK_RIGHT,Lgt=ut.DARK_DOWN;class d3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,E1.getInitialState()),W.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,E1.getInitialState(),Vs.from(2,-1,g.of(Re.DOWN),Re.DOWN).get(),$localize`Congratulations!`),W.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new E1([[Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae],[Ae,_o,_o,_o,Ae],[Ae,Ae,Ae,Ae,Ae],[Ae,Ae,oR,Ae,Ae]],0),[Vs.from(2,4,g.of(Re.UP),Re.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),W.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new E1([[Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae],[Ae,_o,_o,_o,Ae],[Ae,Ae,Ae,Ae,Ae],[Ae,Ae,oR,Ae,Ae]],0),[Vs.from(2,4,g.of(Re.DOWN),Re.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),W.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new E1([[Ae,Mu,u3e,Ae,Ae],[Mu,f3e,aR,Ae,Ae],[Ae,Ae,oR,Ae,Ae],[Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae]],0),[Vs.from(2,2,g.of(Re.UP),Re.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new E1([[Ae,Ae,Mu,_o,Ae],[Ae,Ae,Mu,_o,aR],[Ae,Mu,_o,_o,Ae],[Ae,Mu,f3e,u3e,_o],[Ae,Ae,Ae,Ae,Ae]],0),[Vs.from(1,3,g.of(Re.RIGHT),Re.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),W.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new E1([[Ae,Ae,Ae,Ae,Ae],[Ae,Ae,Ae,Ae,Ae],[_o,xgt,aR,Ae,kgt],[Ae,Ae,Ae,Ae,Lgt],[Ae,Ae,Ae,Ae,_o]],0),[Vs.from(2,2,g.of(Re.LEFT),Re.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)])}}var Eu;function zgt(r,e){if(1&r){const t=pe();A(),E(0,"use",11),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().clickSquare(i,s))}),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","piece_",n,"_",s,""),y("ngClass",o.getPieceClasses(n,s,i)),k("transform",o.getPieceTransform(n,s))}}function Dgt(r,e){if(1&r){const t=pe();A(),E(0,"use",12),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p().clickSquare(i,s))}),S()}if(2&r){const t=p().index,n=p().index,i=p();k("transform","translate("+(t+1)*i.SPACE_SIZE+" "+(n+1)*i.SPACE_SIZE+")")}}function Hgt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",8),U("click",function(){const s=te(t).index,o=p().index;return ne(p().clickSquare(s,o))}),S(),T(2,zgt,1,4,"use",9),T(3,Dgt,1,1,"use",10),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();v(1),ye("id","square_",n,"_",i,""),y("ngClass",s.getSquareClasses(n,i)),k("x",s.SPACE_SIZE*(n+1))("y",s.SPACE_SIZE*(i+1))("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t.isPiece()),v(1),y("ngIf",s.isMountain(t))}}function Vgt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Hgt,4,9,"g",4),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Fgt(r,e){if(1&r){const t=pe();A(),E(0,"rect",15),U("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.x,i.y))}),S()}if(2&r){const t=p().$implicit,n=p();ye("id","square_",t.x,"_",t.y,""),y("ngClass",n.getSquareClasses(t.x,t.y)),k("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function $gt(r,e){if(1&r){const t=pe();A(),E(0,"g"),T(1,Fgt,1,7,"rect",13),E(2,"rect",14),U("click",function(){const s=te(t).$implicit;return ne(p().clickSquare(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p();v(1),y("ngIf",!1===n.SiamState.isOnBoard(t)),v(1),k("x",n.SPACE_SIZE*(t.x+1))("y",n.SPACE_SIZE*(t.y+1))("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Bgt(r,e){if(1&r){const t=pe();A(),E(0,"rect",16),U("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedLanding.get().x,i.selectedLanding.get().y))}),S()}if(2&r){const t=p();k("x",t.SPACE_SIZE*(t.selectedLanding.get().x+1))("y",t.SPACE_SIZE*(t.selectedLanding.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Ggt(r,e){if(1&r){const t=pe();A(),E(0,"rect",16),U("click",function(){te(t);const i=p();return ne(i.clickSquare(i.selectedPiece.get().x,i.selectedPiece.get().y))}),S()}if(2&r){const t=p();k("x",t.SPACE_SIZE*(t.selectedPiece.get().x+1))("y",t.SPACE_SIZE*(t.selectedPiece.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Ugt(r,e){if(1&r&&(A(),F(0,"use",19)),2&r){const t=e.$implicit,n=p().$implicit,i=p();ye("id","remainingPieces_",n.value,"_",t,""),y("ngClass",i.getRemainingPieceClasses(n,t)),k("transform",i.getRemainingPieceTransform(t,n))}}function Wgt(r,e){if(1&r){const t=pe();A(),E(0,"g",17),U("click",function(){const s=te(t).$implicit;return ne(p().selectPieceForInsertion(s))}),T(1,Ugt,1,4,"use",18),S()}if(2&r){const t=e.$implicit,n=p();Rn("id","remainingPieces_",t.value,""),v(1),y("ngForOf",n.ArrayUtils.range(n.playerPieces(t)))}}function qgt(r,e){if(1&r){const t=pe();A(),E(0,"use",22),U("click",function(){te(t);const i=p().$implicit;return ne(p().clickSquare(i.source.get().coord.x,i.source.get().coord.y))}),S()}if(2&r){const t=p().$implicit,n=p();y("ngClass",n.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),k("transform",n.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function jgt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"use",20),U("click",function(){const s=te(t).$implicit;return ne(p().clickArrow(s))}),S(),T(2,qgt,1,2,"use",21),S()}if(2&r){const t=e.$implicit,n=p();v(1),Ti("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),k("transform",n.getIndicatorTransform(t)),v(1),y("ngIf",t.source.isPresent())}}function Zgt(r,e){if(1&r){const t=pe();A(),E(0,"use",23),U("click",function(){const s=te(t).$implicit;return ne(p().selectOrientation(s))}),S()}if(2&r){const t=e.$implicit,n=p();Rn("id","orientation_",t.landingOrientation,""),y("ngClass",n.getCurrentPlayerClass()),k("transform",n.getOrientationTransform(t.landingOrientation))}}let cR=(Eu=class extends Hi{constructor(e){super(e),u(this,"SiamState",E1),u(this,"lastMove",g.empty()),u(this,"movedPieces",[]),u(this,"selectedPiece",g.empty()),u(this,"selectedLanding",g.empty()),u(this,"orientations",[]),u(this,"clickableCoords",new dt),u(this,"indicatorArrows",[]),u(this,"insertingPiece",!1),this.rules=Ua.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new sR(this.rules,"SiamMinimax")],this.encoder=Vs.encoder,this.tutorial=(new d3e).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.board,this.movedPieces=[]}showLastMove(e){this.lastMove=g.of(e);const t=this.getPreviousState();this.movedPieces=this.rules.isLegal(this.lastMove.get(),t).get().moved}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=g.empty(),this.selectedLanding=g.empty(),this.orientations=[],this.clickableCoords=new dt,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return P(function*(){const n=t.canUserPlay("#remainingPieces_"+e.value);if(n.isFailure())return t.cancelMove(n.getReason());if(e!==t.getCurrentPlayer())return t.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE());if(t.insertingPiece)return t.cancelMoveAttempt(),b.SUCCESS;t.cancelMoveAttempt();for(const i of Ua.get().getInsertions(t.getState())){const s=i.coord.getNext(i.direction.get());if(t.board[s.y][s.x]!==ut.EMPTY){const o={source:g.empty(),target:s,direction:i.direction.get(),move:i};t.indicatorArrows.push(o)}t.clickableCoords.add(s)}return t.insertingPiece=!0,b.SUCCESS})()}selectOrientation(e){var t=this;return P(function*(){const n=t.canUserPlay("#orientation_"+e.landingOrientation.toString());return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e)})()}clickSquare(e,t,n=!1){var i=this;return P(function*(){if(!1===n){const o=i.canUserPlay("#square_"+e+"_"+t);if(o.isFailure())return i.cancelMove(o.getReason())}const s=new C(e,t);if(i.insertingPiece)return i.insertPiece(s);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),b.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=g.of(s);const o=Ua.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),s);return 0===o.length?i.changeMoveDestinationClick(s):i.performMoveOrShowOrientationArrows(o)}{K.assert(i.getState().isOnBoard(s),"SiamComponent: user clicked outside of board when it should not be possible");const o=i.board[t][e];return o.getOwner()!==i.getCurrentPlayer()?i.cancelMove(Le.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(s,o)}})()}insertPiece(e){var t=this;return P(function*(){if(t.selectedLanding.isPresent())return t.cancelMove(Cu.MUST_SELECT_ORIENTATION()),b.SUCCESS;t.selectedLanding=g.of(e);const n=Ua.get().getInsertionsAt(t.getState(),e.x,e.y);return 0===n.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(n)})()}changeMoveDestinationClick(e){var t=this;return P(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(Cu.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return P(function*(){return K.assert(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(t.cancelMove(),t.chooseMove(e[0])):(t.clickableCoords=new dt,t.indicatorArrows=[],t.orientations=e,b.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const n=this.getState();this.selectedPiece=g.of(e);const i=Ua.get().getMovesFrom(n,t,e.x,e.y);for(const s of i)if(s.direction.isPresent()){const o=s.coord.getNext(s.direction.get());if(this.clickableCoords.add(o),n.isOnBoard(o)&&n.getPieceAt(o)!==ut.EMPTY){const a={source:g.of({coord:e,piece:t}),target:o,direction:s.direction.get(),move:s};this.indicatorArrows.push(a)}}else this.clickableCoords.add(s.coord);return b.SUCCESS}clickArrow(e){var t=this;return P(function*(){const n=t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return n.isFailure()?t.cancelMove(n.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===ut.MOUNTAIN}getArrowTransform(e,t,n){const s=`rotate(${90*(n.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",s].join(" ")}getPieceTransform(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}getRemainingPieceTransform(e,t){const n=this.playerPieces(t);let a,c,o=2;return t===I.ONE?(o+=(n-e+(5-n)/2)/3,a=-1,c=Re.RIGHT):(o+=(e+1+(5-n)/2)/3,a=7,c=Re.LEFT),this.getArrowTransform(o,a,c)}getOrientationTransform(e){const t=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,t].join(" ")}getPieceClasses(e,t,n){const i=new C(e,t),s=[this.getPlayerClass(n.getOwner())];return this.selectedPiece.equalsValue(i)&&s.push("selected-stroke"),s}getSquareClasses(e,t){const n=new C(e,t);return this.movedPieces.some(i=>i.equals(n))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const n=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&n.push("selected-stroke"),n}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}},u(Eu,"\u0275fac",function(e){return new(e||Eu)(G(Wt))}),u(Eu,"\u0275cmp",Xe({type:Eu,selectors:[["app-siam"]],features:[Je],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(A(),E(0,"svg",0)(1,"defs"),F(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),S(),T(5,Vgt,2,1,"g",4),T(6,$gt,3,5,"g",4),T(7,Bgt,1,4,"rect",5),T(8,Ggt,1,4,"rect",5),T(9,Wgt,2,2,"g",6),T(10,jgt,3,5,"g",4),T(11,Zgt,1,3,"use",7),S()),2&e&&(v(5),y("ngForOf",t.board),v(1),y("ngForOf",t.clickableCoords),v(1),y("ngIf",t.selectedLanding.isPresent()),v(1),y("ngIf",t.selectedPiece.isPresent()),v(1),y("ngForOf",t.Player.PLAYERS),v(1),y("ngForOf",t.indicatorArrows),v(1),y("ngForOf",t.orientations))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),Eu);var h3e;cR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],cR);class er extends Li{static of(e,t,n){return new er(e,t,n)}static ofDrop(e){return new er(g.empty(),e,g.empty())}static ofMovement(e,t){return new er(g.of(e),t,g.empty())}static ofCut(e,t,n){return new er(g.of(e),t,g.of(n))}constructor(e,t,n){super(),u(this,"start",void 0),u(this,"landing",void 0),u(this,"keep",void 0),this.start=e,this.landing=t,this.keep=n,K.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),K.assert(e.isAbsent()||!1===e.equals(n),"Cannot keep starting coord, since it will always be empty after move!")}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}h3e=er,u(er,"encoder",Ie.tuple([g.getEncoder(C.encoder),C.encoder,g.getEncoder(C.encoder)],r=>[r.start,r.landing,r.keep],r=>h3e.of(r[0],r[1],r[2])));let Wa=(()=>{class r{}return u(r,"NO_MOVEMENT_BEFORE_TURN_40",()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`),u(r,"MUST_CUT",()=>$localize`Several groups are of the same size, you must pick the one to keep.`),u(r,"CANNOT_CHOOSE_TO_KEEP",()=>$localize`You cannot choose which part to keep when one is smaller than the other.`),u(r,"CAN_NO_LONGER_DROP",()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`),u(r,"MUST_CAPTURE_BIGGEST_GROUPS",()=>$localize`You must choose one of the biggest groups to keep it.`),u(r,"CANNOT_KEEP_EMPTY_COORD",()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`),u(r,"MUST_DROP_NEXT_TO_OTHER_PIECE",()=>$localize`You must put this piece next to another piece.`),r})();class Ui extends _ce{static getInitialState(){return Ui.ofRepresentation([[I.ZERO],[I.ONE]],0)}static ofRepresentation(e,t,n=new St(0,0)){const i=new Md;for(let s=0;s<e.length;s++)for(let o=0;o<e[0].length;o++)if(e[s][o]!==X.NONE){const a=new C(o,s).getNext(n);i.set(a,e[s][o])}return new Ui(i,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new Ui(t,this.turn)}toRepresentation(){const e=He.createTable(this.width,this.height,X.NONE);for(const t of this.pieces.listKeys()){const n=this.getPieceAt(t);e[t.y][t.x]=n}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?b.SUCCESS:b.failure(Wa.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const n of h2.getNeighbors(e))if(this.pieces.containsKey(n)&&!1===t.equalsValue(n))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():X.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new Ui(t,this.turn+1)}applyLegalDeplacement(e,t){const n=this.movePiece(e);if(t.size()>0){const i=new Md;for(const s of t)i.set(s,n.getPieceAt(s));return new Ui(i,this.turn+1)}return new Ui(n.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(I.ZERO).getOrElse(new $1),n=e.get(I.ONE).getOrElse(new $1);return[t.size(),n.size()]}switchPiece(e){const t=this.pieces.getCopy(),n=this.getPieceAt(e);if(n.isPlayer())return t.replace(e,n.getOpponent()),new Ui(t,this.turn);c2.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var qC,Nl;let qa=(qC=class extends jn{static get(){return Nl.singleton.isAbsent()&&(Nl.singleton=g.of(new Nl)),Nl.singleton.get()}constructor(){super(Ui),u(this,"currentVictorySource",void 0)}applyLegalMove(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}isLegal(e,t){const n=t.isIllegalLandingZone(e.landing,e.start);return n.isFailure()?n.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):Nl.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new $1;for(const n of e.getPieceCoords())for(const i of be.factory.all){const s=n.getNext(i,1);e.getPieceAt(s)===X.NONE&&t.add(s)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?se.failure(Wa.NO_MOVEMENT_BEFORE_TURN_40()):se.success(new dt(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return se.failure(Wa.CAN_NO_LONGER_DROP());const n=t.getPieceAt(e.start.get());if(n===X.NONE)return se.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===t.getCurrentOpponent())return se.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE());const i=t.movePiece(e),s=i.getGroups();if(Nl.isSplit(s)){const o=this.getLargestGroups(s);return 1===o.size()?e.keep.isPresent()?se.failure(Wa.CANNOT_CHOOSE_TO_KEEP()):se.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,o,i)}return se.success(new $1)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,n=new dt;for(const i of e){const s=i.size();s>t?(t=s,n=new dt([i])):s===t&&n.add(i)}return n}static moveKeepBiggerGroup(e,t,n){if(e.isAbsent())return se.failure(Wa.MUST_CUT());if(n.getPieces().get(e.get()).isAbsent())return se.failure(Wa.CANNOT_KEEP_EMPTY_COORD());const i=e.get();for(const s of t)if(s.contains(i))return se.success(s);return se.failure(Wa.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=[];if(e.move.isPresent()&&(i=this.getShapeVictory(e.move.get(),t)),6===i.length)return ve.getVictory(n);if(t.turn>39){const s=t.countPieces(),o=s[0],a=s[1];return o<6&&a<6?o<a?ve.ONE_WON:a<o?ve.ZERO_WON:ve.DRAW:o<6?ve.getDefeat(I.ZERO):a<6?ve.getDefeat(I.ONE):ve.ONGOING}return ve.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(be.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];const l=(e+o.length)%6;o.push(a),a=a.getNext(be.factory.all[l],1)}return o}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return[];c=!0,s=s.getOpposite(),o=o.getNext(s,a.length)}o=o.getNext(s,1)}return a}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return o}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return[];o.push(a),o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return o}},Nl=qC,u(qC,"singleton",g.empty()),qC);qa=Nl=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],qa);class Kgt extends uo{calculateBoardValue(e,t){this.startSearchingVictorySources();const n={status:en.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};for(;this.hasNextVictorySource();){const i=this.getNextVictorySource();let s;if(s=n.status===en.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n),s.status===en.VICTORY)return s;n.status=s.status,n.sum=n.sum+s.sum,n.preVictory.isAbsent()&&(n.preVictory=s.preVictory)}return n}}var jC,N0;class p4 extends an{constructor(e,t){super(e),u(this,"preVictory",void 0),this.preVictory=t}}let lR=(jC=class extends Kgt{constructor(...e){super(...e),u(this,"currentVictorySource",void 0)}static get(){if(N0.singleton.isAbsent()){const e=qa.get();N0.singleton=g.of(new N0(e,"SixMinimax"))}return N0.singleton.get()}getListMoves(e){const t=N0.get(),n=e.getOwnValue(t);if(n.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(n):this.createForcedMovement(e,n);const i=qa.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getMovement(e.gameState,i)}getMovement(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementFrom(e,n,t)}createForcedDrop(e){const t=[],n=er.ofDrop(e.preVictory.get());return t.push(n),t}createForcedMovement(e,t){const n=this.getSafelyMovablePieceOrFirstOne(e.gameState),i=[t.preVictory.get()];return this.getMovementFrom(e.gameState,n,i)}getMovementFrom(e,t,n){const i=[];for(const s of t)for(const o of n){const a=er.ofMovement(s,o);if(e.isCoordConnected(o,g.of(s))){const l=e.movePiece(a).getGroups();if(qa.isSplit(l)){const f=qa.getLargestGroups(l);if(1===f.size())i.push(er.ofMovement(s,o));else for(const d of f){const m=d.getAnyElement().get(),M=er.ofCut(s,o,m);i.push(M)}}else i.push(a)}}return i}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),n=e.getCurrentPlayer(),i=t.get(n).get(),s=i.getAnyElement().get(),o=[];for(const a of i)!1===this.isPieceBlockingAVictory(e,a)&&o.push(a);return new $1(0===o.length?[s]:o)}isPieceBlockingAVictory(e,t){const n=e.switchPiece(t),i=er.ofDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,i,n).status===en.VICTORY)return!0;return!1}getListDrop(e){const t=[];for(const n of e){const i=er.ofDrop(n);t.push(i)}return t}getBoardValue(e){const t=e.move,n=e.gameState,i=n.getCurrentOpponent(),s=i.getVictoryValue();let o={status:en.DEFAULT,victory:g.empty(),preVictory:g.empty(),sum:0};if(t.isPresent()&&(o=this.calculateBoardValue(t.get(),n)),o.status===en.VICTORY)return new p4(s,g.empty());if(n.turn>39){const a=n.countPieces(),c=a[0],l=a[1];return c<6&&l<6?new p4(c<l?I.ONE.getVictoryValue():l<c?I.ZERO.getVictoryValue():0,g.empty()):c<6?new p4(I.ZERO.getDefeatValue(),g.empty()):l<6?new p4(I.ONE.getDefeatValue(),g.empty()):new p4(c-l,o.preVictory)}return new p4(o.status===en.PRE_VICTORY?i.getPreVictory():o.sum*i.getScoreModifier(),o.preVictory)}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,n){const i=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,i,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,i,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,i,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,i,n)}}searchVictoryOnlyForCircle(e,t,n){const i=n.getCurrentOpponent(),o=[t];let a=t.getNext(be.factory.all[e],1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};const l=(e+o.length)%6;o.push(a),a=a.getNext(be.factory.all[l],1)}return{status:en.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForLine(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e],o=t.getNext(s,1);const a=[t];let c=!1;for(;a.length<6;){if(n.getPieceAt(o)===i)a.push(o);else{if(c)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};c=!0,s=s.getOpposite(),o=o.getNext(s,a.length-1)}o=o.getNext(s,1)}return{status:en.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),o.push(a),a=a.getNext(s,1)}return{status:en.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,n){const i=n.getCurrentOpponent();let s=be.factory.all[e];const o=[t];let a=t.getNext(s,1);for(;o.length<6;){if(n.getPieceAt(a)!==i)return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};o.push(a),o.length%2==0&&(s=be.factory.all[(e+o.length)%6]),a=a.getNext(s,1)}return{status:en.VICTORY,victory:g.of(o),preVictory:g.empty(),sum:0}}getBoardInfo(e,t,n,i){const s=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,s,n,i);case"LINE":return this.getBoardInfoForLine(e.index,s,n,i);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,s,n,i);default:return this.getBoardInfoForTriangleEdge(e.index,s,n,i)}}getBoardInfoForCircle(e,t,n,i){const s=n.getCurrentPlayer(),a=[t];let c=t.getNext(be.factory.all[e],1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;const m=(e+a.length)%6;a.push(c);const M=be.factory.all[m];d===X.NONE?(l+=.16,f=g.of(c)):l++,c=c.getNext(M,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoResult(e,t,n,i){let s=i.preVictory;if(4.16===e){if(s.isPresent()&&!1===s.equals(t))return{status:en.PRE_VICTORY,victory:g.empty(),preVictory:g.empty(),sum:0};s=t}else if(5===e)return{status:en.VICTORY,victory:g.of(n),preVictory:g.empty(),sum:0};return{status:i.status,victory:g.empty(),preVictory:s,sum:i.sum+e}}getBoardInfoForLine(e,t,n,i){const s=be.factory.all[e];let o=t.getPrevious(s,5),a=[],c=[],l=g.empty();for(let L=0;L<6;L++){const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),a.push(o),o=o.getNext(s,1)}let f=i.status,d=i.preVictory,m=0,M=0;for(;m<6;){const L=c.reduce(($,B)=>$+B);if(6===L)return{status:en.VICTORY,victory:g.of(a),preVictory:g.empty(),sum:0};5.16===L&&f===en.DEFAULT&&(d.isPresent()?(Ve(!1===d.equals(l),"Impossible to have point aligned with differents line to a same point"),f=en.PRE_VICTORY):d=l),M=Math.max(M,L),a=a.slice(1,6),a.push(o),c=c.slice(1,6);const z=this.updateEncounterAndReturnLastEmpty(n,o,c);z.isPresent()&&(l=z),m++,o=o.getNext(s,1)}const w={status:f,victory:g.of(a),preVictory:d,sum:M};return this.getBoardInfoResult(M,l,a,w)}updateEncounterAndReturnLastEmpty(e,t,n){const i=e.getCurrentPlayer();switch(e.getPieceAt(t)){case i:return n.push(-7),g.empty();case X.NONE:return n.push(.16),g.of(t);default:return n.push(1),g.empty()}}getBoardInfoForTriangleCorner(e,t,n,i){const s=n.getCurrentPlayer();let o=be.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===X.NONE?(l+=.16,f=g.of(c)):l++,a.length%2==0&&(o=be.factory.all[(e+a.length)%6]),a.push(c),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}getBoardInfoForTriangleEdge(e,t,n,i){const s=n.getCurrentPlayer();let o=be.factory.all[e];const a=[t];let c=t.getNext(o,1),l=0,f=g.empty();for(;a.length<6;){const d=n.getPieceAt(c);if(d===s)return i;d===X.NONE?(l+=.16,f=g.of(c)):l++,a.push(c),a.length%2==0&&(o=be.factory.all[(e+a.length)%6]),c=c.getNext(o,1)}return this.getBoardInfoResult(l,f,a,i)}},N0=jC,u(jC,"singleton",g.empty()),jC);lR=N0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],lR);const ue=X.NONE,Tt=I.ZERO,It=I.ONE;let uR=(()=>{class r{}return u(r,"MOVEMENT_NOT_DISCONNECTING",()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`),u(r,"MOVEMENT_SELF_DISCONNECTING",()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`),r})();class p3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,Ui.getInitialState()),W.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,Ui.ofRepresentation([[Tt,It,It,It,It,Tt],[ue,Tt,It,ue,Tt,ue],[It,It,Tt,ue,ue,ue],[ue,ue,Tt,ue,ue,ue],[ue,Tt,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],0),[er.ofDrop(new C(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Ui.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,ue,It,It,Tt,Tt],[ue,It,ue,Tt,It,ue],[It,Tt,Tt,Tt,Tt,It]],0),[er.ofDrop(new C(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),W.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Ui.ofRepresentation([[ue,ue,ue,It,ue,ue],[ue,Tt,It,Tt,Tt,Tt],[ue,Tt,ue,Tt,Tt,ue],[It,It,It,ue,It,ue]],0),[er.ofDrop(new C(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),W.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,Ui.ofRepresentation([[ue,ue,ue,ue,ue,ue,ue,It,ue],[ue,ue,ue,ue,ue,ue,Tt,ue,ue],[ue,ue,ue,ue,Tt,Tt,Tt,ue,ue],[ue,ue,ue,ue,It,It,ue,It,Tt],[ue,Tt,It,It,Tt,Tt,It,ue,ue],[Tt,Tt,Tt,Tt,It,It,It,Tt,ue],[It,It,Tt,ue,It,It,Tt,ue,ue],[ue,Tt,ue,Tt,Tt,ue,ue,ue,ue],[It,It,It,It,ue,ue,ue,ue,ue],[ue,Tt,ue,It,ue,ue,ue,ue,ue]],40),er.ofMovement(new C(6,1),new C(5,1)),(t,n,i)=>{const s=i.countPieces();return 19===s[0]?18===s[1]?b.SUCCESS:b.failure(uR.MOVEMENT_NOT_DISCONNECTING()):b.failure(uR.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),W.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,Ui.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Tt,It],[ue,ue,ue,It,Tt,Tt],[ue,ue,Tt,ue,It,Tt],[It,It,ue,ue,ue,Tt],[Tt,It,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],40),er.ofMovement(new C(2,3),new C(3,3)),(t,n,i)=>t.start.equalsValue(new C(2,3))?b.SUCCESS:b.failure(uR.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),W.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,Ui.ofRepresentation([[ue,ue,ue,ue,ue,It],[ue,ue,ue,ue,Tt,It],[ue,ue,ue,It,Tt,Tt],[Tt,ue,Tt,ue,ue,It],[It,It,ue,ue,ue,ue],[Tt,Tt,ue,ue,ue,ue],[Tt,ue,ue,ue,ue,ue]],40),er.ofCut(new C(2,3),new C(2,5),new C(2,5)),(t,n,i)=>t.keep.isAbsent()?b.failure($localize`This move has not cut the board in two equal halves.`):i.getPieceAt(t.landing)===X.NONE?b.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):b.SUCCESS,$localize`Congratulations, you won!`)])}}function Qgt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",10),U("click",function(){const s=te(t).$implicit;return ne(p().onPieceClick(s))}),S()}if(2&r){const t=e.$implicit,n=p();ye("id","piece_",t.x,"_",t.y,""),y("ngClass",n.getPieceClass(t)),k("points",n.getHexaPointsAt(t))}}function Jgt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",11),U("click",function(){const s=te(t).$implicit;return ne(p().onNeighborClick(s))}),S()}if(2&r){const t=e.$implicit,n=p();ye("id","neighbor_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function emt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",10),U("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.chosenLanding.get()))}),S()}if(2&r){const t=p();ye("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),y("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),k("points",t.getHexaPointsAt(t.chosenLanding.get()))}}function tmt(r,e){if(1&r&&(A(),F(0,"polygon",12)),2&r){const t=e.$implicit,n=p();ye("id","disconnected_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function nmt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",13),U("click",function(){te(t);const i=p();return ne(i.onNeighborClick(i.leftCoord.get()))}),S()}if(2&r){const t=p();ye("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),k("points",t.getHexaPointsAt(t.leftCoord.get()))}}function rmt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",14),U("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.lastDrop.get()))}),S()}if(2&r){const t=p();ye("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),k("points",t.getHexaPointsAt(t.lastDrop.get()))}}function imt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",15),U("click",function(){te(t);const i=p();return ne(i.onPieceClick(i.selectedPiece.get()))}),S()}if(2&r){const t=p();ye("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),y("ngClass",t.getSelectedPieceClass()),k("points",t.getHexaPointsAt(t.selectedPiece.get()))}}function smt(r,e){if(1&r&&(A(),F(0,"polygon",16)),2&r){const t=e.$implicit,n=p();ye("id","victoryCoord_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function omt(r,e){if(1&r){const t=pe();A(),E(0,"polygon",19),U("click",function(){const s=te(t).$implicit;return ne(p(2).onPieceClick(s))}),S()}if(2&r){const t=e.$implicit,n=p(2);ye("id","cuttable_",t.x,"_",t.y,""),k("points",n.getHexaPointsAt(t))}}function amt(r,e){if(1&r&&(A(),E(0,"g",17),T(1,omt,1,3,"polygon",18),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}let cmt=(()=>{var r;class e extends Q5{constructor(n){super(n),u(this,"state",void 0),u(this,"pieces",void 0),u(this,"disconnecteds",[]),u(this,"cuttableGroups",[]),u(this,"victoryCoords",void 0),u(this,"neighbors",void 0),u(this,"leftCoord",g.empty()),u(this,"lastDrop",g.empty()),u(this,"selectedPiece",g.empty()),u(this,"chosenLanding",g.empty()),u(this,"viewBox",void 0),u(this,"nextClickShouldSelectGroup",!1),this.rules=qa.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new lR(this.rules,"SixMinimax")],this.encoder=er.encoder,this.tutorial=(new p3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new J5(1.5*this.SPACE_SIZE,new C(2*this.SPACE_SIZE,0),Dr.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=g.empty(),this.chosenLanding=g.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.node.gameState,this.node.move.isAbsent()&&this.hideLastMove(),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}hideLastMove(){this.leftCoord=g.empty(),this.lastDrop=g.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const n=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return s4.fromHexa(n,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(n){this.lastDrop=g.of(n.landing),this.leftCoord=!1===n.isDrop()?g.of(n.start.get()):g.empty();const i=this.getState();this.rules.getGameStatus(this.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(n,i)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const n=this.getPreviousState().getPieceCoords(),i=this.getState().getPieceCoords(),s=[];for(const a of n)!1===this.node.move.get().start.equalsValue(a)&&!1===i.some(l=>l.equals(a))&&s.push(a);const o=this.lastDrop.get();return!1===this.pieces.some(a=>a.equals(o))&&!1===i.some(a=>a.equals(o))&&s.push(o),s}getEmptyNeighbors(){let n=qa.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const i=this.chosenLanding.get();n=n.filter(s=>!1===s.equals(i))}return n}getPieceClass(n){const i=this.getState().getPieceAt(n);return this.getPlayerClass(i)}onPieceClick(n){var i=this;return P(function*(){const s=i.canUserPlay("#piece_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.state.turn<40)return i.cancelMove(Wa.NO_MOVEMENT_BEFORE_TURN_40());if(i.chosenLanding.isAbsent())return i.state.getPieceAt(n)===i.state.getCurrentOpponent()?i.cancelMove(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):(i.selectedPiece=i.selectedPiece.equalsValue(n)?g.empty():g.of(n),b.SUCCESS);{const o=er.ofCut(i.selectedPiece.get(),i.chosenLanding.get(),n);return i.chooseMove(o)}})()}onNeighborClick(n){var i=this;return P(function*(){const s=i.canUserPlay("#neighbor_"+n.x+"_"+n.y);if(s.isFailure())return i.cancelMove(s.getReason());if(i.nextClickShouldSelectGroup)return i.cancelMove(Wa.MUST_CUT());if(i.state.turn<40)return i.chooseMove(er.ofDrop(n));if(i.selectedPiece.isAbsent())return i.cancelMove(Wa.CAN_NO_LONGER_DROP());{const o=er.ofMovement(i.selectedPiece.get(),n),a=qa.isLegalPhaseTwoMove(o,i.state);return i.neededCutting(a)?(i.chosenLanding=g.of(n),i.moveVirtuallyPiece(),i.showCuttable(),i.nextClickShouldSelectGroup=!0,b.SUCCESS):i.chooseMove(o)}})()}neededCutting(n){return n.isFailure()&&n.getReason()===Wa.MUST_CUT()}moveVirtuallyPiece(){const n=this.selectedPiece.get();this.pieces=this.pieces.filter(i=>!1===i.equals(n)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const n=er.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(n).getGroups(),o=qa.getLargestGroups(s);this.cuttableGroups=[];for(const a of o)this.cuttableGroups.push(a.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-six"]],features:[Je],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Qgt,1,4,"polygon",1),T(2,Jgt,1,3,"polygon",2),T(3,emt,1,4,"polygon",3),T(4,tmt,1,3,"polygon",4),T(5,nmt,1,3,"polygon",5),T(6,rmt,1,3,"polygon",6),T(7,imt,1,4,"polygon",7),T(8,smt,1,3,"polygon",8),T(9,amt,2,1,"g",9),S()),2&n&&(k("viewBox",i.viewBox),v(1),y("ngForOf",i.pieces),v(1),y("ngForOf",i.neighbors),v(1),y("ngIf",i.chosenLanding.isPresent()),v(1),y("ngForOf",i.disconnecteds),v(1),y("ngIf",i.leftCoord.isPresent()),v(1),y("ngIf",i.lastDrop.isPresent()),v(1),y("ngIf",i.selectedPiece.isPresent()),v(1),y("ngForOf",i.victoryCoords),v(1),y("ngForOf",i.cuttableGroups))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class Fs extends OL{static of(e,t){return new Fs(e,t)}static from(e,t){try{const n=new Fs(e,t);return se.success(n)}catch(n){return se.failure(n.message)}}getMaximalDistance(){return 9}}u(Fs,"encoder",zs.getFallibleEncoder(Fs.from));const lmt={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:I.ZERO};class Yc extends bL{static getInitialState(){const e=sn.UNOCCUPIED,t=sn.INVADERS,n=sn.DEFENDERS;return new Yc([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,n,e,e,e,e],[t,e,e,e,n,e,e,e,t],[t,t,n,n,sn.PLAYER_ONE_KING,n,n,t,t],[t,e,e,e,n,e,e,e,t],[e,e,e,e,n,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}of(e,t){return new Yc(e,t)}}class Al extends wL{static get(){return Al.singleton.isAbsent()&&(Al.singleton=g.of(new Al)),Al.singleton.get()}constructor(){super(Yc,lmt,Fs.from)}}u(Al,"singleton",g.empty());const H=sn.UNOCCUPIED,bn=sn.INVADERS,Wi=sn.DEFENDERS,ZC=sn.PLAYER_ONE_KING;class m3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,Yc.getInitialState()),W.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,Yc.getInitialState(),Fs.of(new C(4,1),new C(1,1)),$localize`Congratulations!`),W.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new Yc([[H,H,H,bn,bn,bn,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,H,Wi,H,H,H,H],[H,H,H,bn,Wi,H,H,H,bn],[bn,bn,Wi,Wi,ZC,Wi,Wi,bn,bn],[H,H,H,H,Wi,H,H,H,bn],[H,H,H,H,Wi,H,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,bn,bn,bn,H,H,H]],1),[Fs.of(new C(2,4),new C(2,3)),Fs.of(new C(4,2),new C(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),W.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new Yc([[H,H,H,bn,bn,bn,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,H,Wi,H,H,H,H],[H,H,Wi,H,ZC,H,Wi,H,bn],[bn,bn,H,Wi,H,Wi,Wi,bn,bn],[H,H,H,H,Wi,H,H,H,bn],[H,H,H,H,Wi,H,H,H,H],[H,H,H,H,bn,H,H,H,H],[H,H,H,bn,bn,bn,H,H,H]],12),[Fs.of(new C(1,4),new C(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),W.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new Yc([[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,bn,H,H,H,H,H,H,H],[bn,ZC,H,bn,H,H,H,H,H],[H,bn,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Fs.of(new C(3,4),new C(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),W.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new Yc([[H,H,bn,ZC,bn,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,bn,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H]],72),[Fs.of(new C(3,3),new C(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)])}}function umt(r,e){1&r&&(A(),F(0,"polygon",8))}function fmt(r,e){1&r&&(A(),F(0,"rect",9))}function dmt(r,e){if(1&r&&(A(),E(0,"g"),T(1,umt,1,0,"polygon",6),T(2,fmt,1,0,"ng-template",null,7,dn),S()),2&r){const t=ln(3),n=p().index,i=p().index,s=p();v(1),y("ngIf",s.isCentralThrone(n,i))("ngIfElse",t)}}function hmt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),S()),2&r){const t=p(2).index,n=p().index,i=p();v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function pmt(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p(3).index,n=p().index;y("ngClass",p().viewInfo.pieceClasses[n][t])}}function gmt(r,e){if(1&r&&(A(),F(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&r){const t=p(3).index,n=p().index,i=p();y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),v(1),y("ngClass",i.viewInfo.pieceClasses[n][t]),k("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function mmt(r,e){if(1&r&&(A(),T(0,pmt,1,1,"polyline",14),T(1,gmt,4,20,"ng-template",null,15,dn)),2&r){const t=ln(2),n=p(2).index,i=p().index;y("ngIf",p().isKing(n,i))("ngIfElse",t)}}function _mt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"circle",10),T(2,hmt,6,25,"g",11),T(3,mmt,3,2,"ng-template",null,12,dn),S()),2&r){const t=ln(4),n=p().index,i=p().index,s=p();v(1),ye("id","piece_",n,"_",i,""),y("ngClass",s.viewInfo.pieceClasses[i][n]),k("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",.5*s.SPACE_SIZE)("cy",.5*s.SPACE_SIZE),v(1),y("ngIf",s.isInvader(n,i))("ngIfElse",t)}}function vmt(r,e){if(1&r){const t=pe();A(),E(0,"g",3),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,dmt,4,2,"g",5),T(3,_mt,5,8,"g",5),S()}if(2&r){const t=e.index,n=p().index,i=p();ye("id","click_",t,"_",n,""),k("transform","translate("+i.SPACE_SIZE*t+", "+i.SPACE_SIZE*n+")"),v(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getRectClasses(t,n)),k("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),v(1),y("ngIf",i.board[n][t]===i.EMPTY&&i.isThrone(t,n)),v(1),y("ngIf",i.board[n][t]!==i.EMPTY)}}function Cmt(r,e){if(1&r&&(A(),E(0,"g"),T(1,vmt,4,10,"g",2),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function ymt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"rect",17),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s.x,s.y))}),S()()}if(2&r){const t=e.$implicit,n=p();v(1),ye("id","click_",t.x,"_",t.y,""),k("x",n.SPACE_SIZE*t.x)("y",n.SPACE_SIZE*t.y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}let Mmt=(()=>{var r;class e extends NL{constructor(n){super(n,Fs.from),this.rules=Al.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new tu(this.rules,"DummyBot"),new sC(this.rules,"Piece > Influence"),new oC(this.rules,"Piece > Control"),new AL(this.rules,"Escape > Piece > Control")],this.encoder=Fs.encoder,this.tutorial=(new m3e).tutorial,this.updateBoard()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-tablut"]],features:[Je],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Cmt,2,1,"g",1),T(2,ymt,2,6,"g",1),S()),2&n&&(k("viewBox",i.getViewBox()),v(1),y("ngForOf",i.board),v(1),y("ngForOf",i.getClickables()))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})(),vo=(()=>{class r extends F1{static isOnBoard(t){return t.isInRange(r.WIDTH,r.WIDTH)}static getInitialState(){const t=He.createTable(r.WIDTH,r.WIDTH,X.NONE);return new r(t,0)}isInDropPhase(){return this.turn<8}}return u(r,"WIDTH",5),r})();var fR;class Co extends Mr{static from(e){return vo.isOnBoard(e)?se.success(new Co(e.x,e.y)):se.failure(X5.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof Co&&super.equals(e)}}u(Co,"encoder",Mr.getFallibleEncoder(Co.from));class $s extends Vo{static from(e,t){return!1===vo.isOnBoard(e)?se.failure(X5.OUT_OF_RANGE(e)):!1===vo.isOnBoard(t)?se.failure(X5.OUT_OF_RANGE(t)):e.equals(t)?se.failure(Le.MOVE_CANNOT_BE_STATIC()):se.success(new $s(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof $s&&super.equals(e)}}u($s,"encoder",Vo.getFallibleEncoder($s.from)),function(r){r.encoder=Ie.disjunction([e=>e instanceof Co,e=>e instanceof $s],[Co.encoder,$s.encoder])}(fR||(fR={}));class yo extends jn{static get(){return yo.singleton.isAbsent()&&(yo.singleton=g.of(new yo)),yo.singleton.get()}constructor(){super(vo)}isLegal(e,t){return t.isInDropPhase()?this.isLegalDrop(e,t):this.isLegalTranslation(e,t)}isLegalDrop(e,t){return K.assert(e instanceof Co,"Cannot translate in dropping phase !"),t.getPieceAt(e.coord).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}isLegalTranslation(e,t){K.assert(e instanceof $s,"Cannot drop in translation phase !");const n=e,i=t.getCurrentOpponent();return t.getPieceAt(n.getStart())===i?b.failure(Le.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(n.getStart())===X.NONE?b.failure(Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(n.getEnd()).isPlayer()?b.failure(Le.MUST_LAND_ON_EMPTY_SPACE()):b.SUCCESS}applyLegalMove(e,t){return e instanceof Co?this.applyLegalDrop(e,t):this.applyLegalTranslate(e,t)}applyLegalDrop(e,t){const n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new vo(n,t.turn+1)}applyLegalTranslate(e,t){const n=t.getCopiedBoard();return n[e.getStart().y][e.getStart().x]=X.NONE,n[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new vo(n,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?ve.getVictory(t.getCurrentOpponent()):ve.ONGOING}getLastCoord(e){return e instanceof Co?e.coord:e.getEnd()}getSquareInfo(e){const t=[],n=[0,0];for(let i=0;i<vo.WIDTH-1;i++)for(let s=0;s<vo.WIDTH-1;s++){const o=new C(i,s),a=new C(i+1,s),c=new C(i,s+1),l=new C(i+1,s+1),f=[e.getPieceAt(o),e.getPieceAt(a),e.getPieceAt(c),e.getPieceAt(l)],d=this.count(f,X.NONE),m=this.count(f,X.ZERO),M=this.count(f,X.ONE);d<4&&(4===m||4===M?t.push(o,a,c,l):m>0?n[0]=n[0]+1:n[1]=n[1]+1)}return{score:n[1]-n[0],victoriousCoords:t}}count(e,t){let n=0;for(const i of e)i===t&&n++;return n}getVictoryCoord(e){const t=yo.TEEKO_HELPER.getVictoriousCoord(e);return t.push(...this.getSquareInfo(e).victoriousCoords),t}}u(yo,"singleton",g.empty()),u(yo,"TEEKO_HELPER",new nu(vo.isOnBoard,K.identity,4));class Emt extends uo{constructor(){super(yo.get(),"Teeko Minimax")}getListMoves(e){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState)}getListDrops(e){const t=[];for(const n of e.getCoordsAndContents()){const i=n.coord;if(!1===e.getPieceAt(i).isPlayer()){const s=Co.from(i).get();t.push(s)}}return t}getListTranslations(e){const t=[],n=e.getCurrentPlayer(),i=this.getCoordsContaining(e,n),s=this.getCoordsContaining(e,X.NONE);for(const o of i)for(const a of s){const c=$s.from(o,a).get();t.push(c)}return t}getCoordsContaining(e,t){const n=[];for(const i of e.getCoordsAndContents())i.content===t&&n.push(i.coord);return n}getBoardValue(e){const t=yo.TEEKO_HELPER.getBoardValue(e.gameState).value;if(an.VICTORIES.some(n=>n===t))return new an(t);{const n=yo.get().getSquareInfo(e.gameState);return n.victoriousCoords.length>0?an.fromWinner(e.gameState.getCurrentOpponent()):new an(n.score+t)}}}const Hn=X.NONE,Il=X.ZERO,kl=X.ONE;class C3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,vo.getInitialState()),W.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,vo.getInitialState(),Co.from(new C(2,2)).get(),$localize`Congratulations!`),W.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to another empty space. The goal remain to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new vo([[Il,kl,Hn,Hn,Hn],[Il,Il,Hn,Hn,Hn],[kl,kl,Hn,Hn,Hn],[kl,Il,Hn,Hn,Hn],[Hn,Hn,Hn,Hn,Hn]],8),$s.from(new C(1,3),new C(2,1)).get(),$localize`Congratulations!`),W.fromMove($localize`Victory`,$localize`In this board, you can win either by creating a line, or a square.<br/><br/>You are playing Dark, win.`,new vo([[kl,Hn,Hn,Hn,Hn],[kl,Il,Hn,Hn,Hn],[Hn,Il,Il,kl,Hn],[Hn,kl,Hn,Il,Hn],[Hn,Hn,Hn,Hn,Hn]],8),[$s.from(new C(1,2),new C(4,4)).get(),$s.from(new C(3,3),new C(2,1)).get()],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)])}}function Smt(r,e){if(1&r&&(A(),F(0,"circle",4)),2&r){const t=p().index,n=p().index,i=p();ye("id","piece_",t,"_",n,""),y("ngClass",i.getPieceClasses(t,n)),k("r",42)("cx",i.SPACE_SIZE*t+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*n+i.SPACE_SIZE/2)}}function Pmt(r,e){if(1&r){const t=pe();A(),E(0,"g",3),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),F(1,"rect",4),T(2,Smt,1,6,"circle",5),S()}if(2&r){const t=e.$implicit,n=e.index,i=p().index,s=p();ye("id","click_",n,"_",i,""),v(1),ye("id","space_",n,"_",i,""),y("ngClass",s.getSpaceClasses(n,i)),k("x",s.SPACE_SIZE*n)("y",s.SPACE_SIZE*i)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),v(1),y("ngIf",t.isPlayer())}}function Tmt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Pmt,3,10,"g",2),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}let Omt=(()=>{var r;class e extends Hi{constructor(n){super(n),u(this,"selected",g.empty()),u(this,"last",g.empty()),u(this,"moved",[]),u(this,"victory",[]),this.rules=yo.get(),this.node=this.rules.getInitialNode(),this.encoder=fR.encoder,this.tutorial=(new C3e).tutorial,this.availableMinimaxes=[new Emt]}updateBoard(){this.board=this.node.gameState.board}showLastMove(n){this.hideLastMove(),this.last=g.of(this.rules.getLastCoord(n)),this.moved=n instanceof $s?[n.getStart(),n.getEnd()]:[],this.victory=this.rules.getVictoryCoord(this.getState())}hideLastMove(){this.last=g.empty(),this.moved=[],this.victory=[]}cancelMoveAttempt(){this.selected=g.empty()}onClick(n,i){var s=this;return P(function*(){const o=s.canUserPlay("#click_"+n+"_"+i);if(o.isFailure())return s.cancelMove(o.getReason());const a=new C(n,i);if(s.getState().isInDropPhase()){const c=Co.from(a).get();return s.chooseMove(c)}if(s.selected.isPresent()){if(s.selected.equalsValue(a))return s.selected=g.empty(),b.SUCCESS;{const c=$s.from(s.selected.get(),a).get();return s.chooseMove(c)}}{const c=s.getState().getCurrentPlayer(),l=s.getState().getPieceAt(a);return l===c?(s.selected=g.of(a),b.SUCCESS):s.cancelMove(l===X.NONE?Le.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Le.CANNOT_CHOOSE_OPPONENT_PIECE())}})()}getPieceClasses(n,i){const s=new C(n,i),a=[this.getPlayerClass(this.getState().getPieceAt(s))];return this.victory.some(c=>c.equals(s))?a.push("victory-stroke"):this.last.equalsValue(s)?a.push("last-move-stroke"):this.selected.equalsValue(s)&&a.push("selected-stroke"),a}getSpaceClasses(n,i){const s=new C(n,i);return this.moved.some(o=>o.equals(s))?["moved-fill"]:[]}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-teeko"]],features:[Je],decls:2,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 510 510","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(n,i){1&n&&(A(),E(0,"svg",0),T(1,Tmt,2,1,"g",1),S()),2&n&&(v(1),y("ngForOf",i.board))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]})),e})();class gi{constructor(e,t){u(this,"owner",void 0),u(this,"tileId",void 0),this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Ur{static of(e){let t=-1;for(const n of e)K.assert(t<n.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=n.tileId;return new Ur(e)}constructor(e){u(this,"pieces",void 0),this.pieces=e}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?X.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return Ur.of(this.pieces.concat(e))}getPieceAt(e){return K.assert(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}u(Ur,"EMPTY",Ur.of([]));let C2=(()=>{class r extends F1{static getInitialState(){const t=He.createTable(r.SIZE,r.SIZE,Ur.EMPTY);return new r(t,0)}static isOnBoard(t){return t.isInRange(r.SIZE,r.SIZE)}static of(t,n){K.assert(t.length===r.SIZE,"Invalid board dimensions");for(const i of t)K.assert(i.length===r.SIZE,"Invalid board dimensions");return new r(t,n)}drop(t,n){const i=this.getCopiedBoard(),s=new gi(n,this.turn);return i[t.y][t.x]=i[t.y][t.x].add(s),new r(i,this.turn)}incrementTurn(){return new r(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(n=>"TrexoPieceStack.of("+n.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,n,i){return this.getPieceAtXY(t,n).getPieceAt(i)}}return u(r,"SIZE",10),r})(),YC=(()=>{class r{}return u(r,"NON_NEIGHBORING_SPACES",()=>$localize`Those two spaces are not neighbors!`),u(r,"NO_WAY_TO_DROP_IT_HERE",()=>$localize`There is no way to put a piece there!`),u(r,"CANNOT_DROP_ON_ONLY_ONE_PIECE",()=>$localize`You cannot drop on only one piece!`),u(r,"CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS",()=>$localize`You cannot drop a piece on uneven grounds!`),r})();var E3e;class Bs extends zs{static from(e,t){return K.assert(C2.isOnBoard(e),`${e.toString()} is out of the TrexoBoard!`),K.assert(C2.isOnBoard(t),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?se.success(new Bs(e,t)):se.failure(YC.NON_NEIGHBORING_SPACES())}constructor(e,t){super(e,t)}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}u(Bs,"encoder",zs.getFallibleEncoder(Bs.from));class mi extends jn{static get(){return mi.instance.isAbsent()&&(mi.instance=g.of(new mi)),mi.instance.get()}static getOwner(e){return e.getOwner()}constructor(){super(C2)}applyLegalMove(e,t,n){return t.drop(e.getZero(),I.ZERO).drop(e.getOne(),I.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?b.failure(YC.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?b.failure(YC.CANNOT_DROP_ON_ONLY_ONE_PIECE()):b.SUCCESS}isUnevenGround(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return n.getHeight()!==i.getHeight()}landsOnOnlyOnePiece(e,t){const n=t.getPieceAt(e.getZero()),i=t.getPieceAt(e.getOne());return(-1!==n.getUpperTileId()||-1!==i.getUpperTileId())&&n.getUpperTileId()===i.getUpperTileId()}static getSquareScore(e,t){return mi.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],n=[],i=e.getCurrentOpponent();for(const s of e.toMap()){const o=s.key,a=e.getPieceAt(o).getOwner();if(a.isPlayer()){const c=mi.getSquareScore(e,o);zi.getScoreStatus(c)===en.VICTORY&&(a===i?t.push(o):n.push(o))}}return n.length>0?n:t}getGameStatus(e){const t=e.gameState,n=t.getCurrentOpponent();let i=!1;for(const s of t.toMap()){const o=s.key,a=t.getPieceAt(o).getOwner();if(a.isPlayer()){const c=mi.getSquareScore(t,o);if(zi.getScoreStatus(c)===en.VICTORY){if(a!==n)return ve.getDefeat(n);i=!0}}}return i?ve.getVictory(n):ve.ONGOING}getLegalMoves(e){const t=[];for(const n of e.toMap()){const i=n.key;if(i.x+1<C2.SIZE){const s=new C(i.x+1,i.y);t.push(...this.getPossiblesMoves(e,i,s))}if(i.y+1<C2.SIZE){const s=new C(i.x,i.y+1);t.push(...this.getPossiblesMoves(e,i,s))}}return t}getPossiblesMoves(e,t,n){const i=e.getPieceAt(t),s=e.getPieceAt(n);let o;o=!i.isGround()&&i.getUpperTileId()===s.getUpperTileId();const a=i.getHeight()!==s.getHeight();return o||a?[]:[Bs.from(t,n).get(),Bs.from(n,t).get()]}}E3e=mi,u(mi,"instance",g.empty()),u(mi,"TREXO_HELPER",new nu(C2.isOnBoard,E3e.getOwner,5));class bmt extends uo{getListMoves(e){return mi.get().getLegalMoves(e.gameState)}getBoardValue(e){let t=0;const n=e.gameState,i=n.getCurrentOpponent();let s=!1;for(const o of n.toMap()){const a=n.getPieceAt(o.key).getOwner();if(a.isPlayer()){const c=mi.getSquareScore(n,o.key);if(zi.getScoreStatus(c)===en.VICTORY){if(a!==i)return new an(i.getDefeatValue());s=!0}else t+=c}}return new an(s?i.getVictoryValue():t)}}const Q=Ur.EMPTY,S3e=Ur.of([new gi(I.ONE,0)]),wmt=Ur.of([new gi(I.ZERO,0)]),Nmt=Ur.of([new gi(I.ONE,1)]),P3e=Ur.of([new gi(I.ZERO,1)]),Amt=Ur.of([new gi(I.ZERO,2)]),Imt=Ur.of([new gi(I.ONE,2)]),kmt=Ur.of([new gi(I.ZERO,0),new gi(I.ZERO,3)]),xmt=Ur.of([new gi(I.ONE,1),new gi(I.ONE,3)]),Lmt=Ur.of([new gi(I.ZERO,4)]),Rmt=Ur.of([new gi(I.ONE,4)]),zmt=Ur.of([new gi(I.ZERO,5)]),Dmt=Ur.of([new gi(I.ONE,5)]),Hmt=Ur.of([new gi(I.ONE,6)]),Vmt=Ur.of([new gi(I.ZERO,6)]);class T3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,C2.getInitialState()),W.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,C2.getInitialState(),Bs.from(new C(4,4),new C(3,4)).get(),$localize`Congratulations!`),W.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new C2([[Q,Q,Q,S3e,wmt,P3e,Nmt,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),[Bs.from(new C(4,0),new C(5,0)).get(),Bs.from(new C(5,0),new C(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),W.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new C2([[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,zmt,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Dmt,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,S3e,Q,Q,Lmt,Rmt,Q],[Q,Q,Q,Q,kmt,xmt,P3e,Q,Q,Q],[Q,Q,Q,Q,Q,Amt,Hmt,Vmt,Q,Q],[Q,Q,Q,Q,Q,Imt,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q],[Q,Q,Q,Q,Q,Q,Q,Q,Q,Q]],7),Bs.from(new C(2,0),new C(2,1)).get(),(t,n,i)=>mi.TREXO_HELPER.getSquareScore(i,t.getOne())===Number.MAX_SAFE_INTEGER?b.SUCCESS:b.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)])}}var dR;function Fmt(r,e){if(1&r){const t=pe();A(),E(0,"g")(1,"polygon",5),U("click",function(){const s=te(t).index,o=p().index;return ne(p().onClick(s,o))}),S()()}if(2&r){const t=e.index,n=p().index,i=p();v(1),ye("id","space_",t,"_",n,""),y("ngClass",i.getSpaceClasses(t,n)),k("points",i.getParallelogramPoints())("transform",i.getTranslate(t,n,0))}}function $mt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Fmt,2,5,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function Bmt(r,e){if(1&r){const t=pe();A(),E(0,"g",8),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p(2).onClick(i,s))}),S()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index,o=p().index,a=p();Ti("id","half_tile_",n,"_",s,"_",o,""),y("mode",a.mode)("coord",a.Coord3D.of(n,s,o))("mustDisplayHeight","2D"===a.chosenMode)("move",i.move.get())("pieceClasses",a.getPieceClasses(n,s,o)),k("transform",a.getTranslate(n,s,o+1))}}const O3e=function(r){return[r]};function Gmt(r,e){if(1&r){const t=pe();A(),E(0,"g",9),U("click",function(){te(t);const i=p().index,s=p().index;return ne(p(2).onClick(i,s))}),S()}if(2&r){const t=p().index,n=p().index,i=p().index,s=p();Ti("id","dropped_piece_",t,"_",n,"_",i,""),y("mode",s.mode)("coord",s.Coord3D.of(t,n,i))("pieceClasses",da(7,O3e,s.currentOpponentClass)),k("transform",s.getTranslate(t,n,i+1))}}function Umt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Bmt,1,9,"g",6),T(2,Gmt,1,9,"g",7),S()),2&r){const t=e.$implicit;v(1),y("ngIf",t.move.isPresent()),v(1),y("ngIf",t.isDroppedPiece)}}function Wmt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Umt,3,2,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function qmt(r,e){if(1&r&&(A(),E(0,"g"),T(1,Wmt,2,1,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}const jmt=function(){return["player0-fill"]};function Zmt(r,e){if(1&r){const t=pe();A(),E(0,"g",10),U("click",function(){return te(t),ne(p().switchToMode("3D"))}),S()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",g1(4,jmt)),k("transform",t.get3DSwitcherTransform())}}function Ymt(r,e){if(1&r){const t=pe();A(),E(0,"g",11),U("click",function(){return te(t),ne(p().switchToMode("2D"))}),S()}if(2&r){const t=p();y("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",da(4,O3e,t.currentPlayerClass)),k("transform",t.getTranslate(12,9,0))}}class Vn extends Tce{constructor(e){super(e),u(this,"TrexoComponent",Vn),u(this,"left",-this.STROKE_WIDTH/2),u(this,"Coord3D",Wd),u(this,"up",0),u(this,"width",void 0),u(this,"height",void 0),u(this,"mode",void 0),u(this,"chosenMode","3D"),u(this,"victoryCoords",[]),u(this,"droppedPiece",g.empty()),u(this,"possibleNextClicks",[]),u(this,"possibleMoves",[]),u(this,"pieceOnBoard",[]),u(this,"currentOpponentClass","player1"),u(this,"currentPlayerClass","player0"),this.rules=mi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new bmt(this.rules,"TrexoMinimax")],this.encoder=Bs.encoder,this.tutorial=(new T3e).tutorial,Vn.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=Vn.modeMap[e]}getViewBoxWidth(){const e=Vn.modeMap["3D"],t=C2.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=C2.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*Vn.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(e.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(e.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(e),this.victoryCoords=mi.getVictoriousCoords(e),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const e=He.create3DTable(1,C2.SIZE,C2.SIZE,Vn.INITIAL_PIECE_ON_BOARD);let t=1;for(let n=0;n<=t;n++)for(const i of this.getState().toMap()){const s=i.key,o=i.value.getHeight();if(t=Math.max(t,o),n<o){const a=this.extractMoveFromState(s.x,s.y,n);this.addMoveToArray(n,a,e)}}return e}extractMoveFromState(e,t,n){const i=this.getState().getPieceAtXYZ(e,t,n),s=new C(e,t);let o=new C(-2,-2);for(const a of Me.ORTHOGONALS){const c=s.getNext(a);if(C2.isOnBoard(c)){const l=this.getState().getPieceAt(c);l.getHeight()>n&&l.getPieceAt(n).tileId===i.tileId&&(o=c)}}return i.owner===I.ZERO?Bs.from(s,o).get():Bs.from(o,s).get()}addMoveToArray(e,t,n){for(;n.length<=e;)n.push(He.createTable(C2.SIZE,C2.SIZE,Vn.INITIAL_PIECE_ON_BOARD));n[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)},n[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:g.of(t)}}onClick(e,t){var n=this;return P(function*(){const i=n.canUserPlay("#space_"+e+"_"+t);if(i.isFailure())return n.cancelMove(i.getReason());const s=new C(e,t);if(n.droppedPiece.isPresent()){const o=n.droppedPiece.get();if(n.droppedPiece.equalsValue(s))return n.cancelMoveAttempt(),b.SUCCESS;if(n.possibleNextClicks.some(a=>a.equals(s))){const a=n.getState().getCurrentPlayer()===I.ZERO,f=Bs.from(a?s:o,a?o:s).get();return n.chooseMove(f)}n.deselectPiece()}return n.selectPiece(s)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,n=this.droppedPiece.get().x;this.pieceOnBoard[e][t][n]=Vn.INITIAL_PIECE_ON_BOARD;for(const i of this.possibleNextClicks)this.pieceOnBoard[e][i.y][i.x].isPossibleClick=!1}selectPiece(e){if(this.possibleMoves.some(t=>t.getZero().equals(e))){const t=this.getState().getPieceAt(e).getHeight();return t>=this.pieceOnBoard.length&&this.pieceOnBoard.push(He.createTable(C2.SIZE,C2.SIZE,Vn.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(e,t),b.SUCCESS}return this.cancelMove(YC.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(e,t){this.droppedPiece=g.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const n of this.possibleNextClicks)this.pieceOnBoard[t][n.y][n.x]={isDroppedPiece:!1,isPossibleClick:!0,move:g.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:g.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(n=>n.getZero().equals(e)).map(n=>n.getOne())}cancelMoveAttempt(){this.droppedPiece=g.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(e,t,n){const i=new C(e,t),s=this.getState().getPieceAtXYZ(e,t,n).owner;let o=[this.getPlayerClass(s)];o=o.concat(this.getSpaceClasses(e,t));for(const a of this.victoryCoords)if(a.equals(i)){o.push("victory-stroke");break}if(this.node.move.isPresent()){const a=this.node.move.get();(a.getZero().equals(i)||a.getOne().equals(i))&&o.push("last-move-stroke")}return o}getSpaceClasses(e,t){for(const n of this.pieceOnBoard)if(n[t][e].isPossibleClick)return["darker"];return[]}getTranslate(e,t,n){const s=this.getCoordTranslate(e,t,n,Vn.modeMap[this.chosenMode]);return"translate("+s.x+" "+s.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(Vn.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=Vn.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}}dR=Vn,u(Vn,"STROKE_WIDTH",void 0),u(Vn,"INITIAL_PIECE_ON_BOARD",{isDroppedPiece:!1,isPossibleClick:!1,move:g.empty()}),u(Vn,"modeMap",{"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}}),u(Vn,"\u0275fac",function(e){return new(e||dR)(G(Wt))}),u(Vn,"\u0275cmp",Xe({type:dR,selectors:[["app-trexo"]],features:[Je],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,t){if(1&e&&(A(),E(0,"svg",0),T(1,$mt,2,1,"g",1),T(2,qmt,2,1,"g",1),E(3,"g",null,2),T(5,Zmt,1,5,"g",3),T(6,Ymt,1,6,"ng-template",null,4,dn),S()()),2&e){const n=ln(7);k("viewBox",t.left+" "+t.up+" "+t.width+" "+t.height),v(1),y("ngForOf",t.board),v(1),y("ngForOf",t.pieceOnBoard),v(3),y("ngIf","2D"===t.chosenMode)("ngIfElse",n)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class W1{}var ta;u(W1,"PLACEMENT_AFTER_INITIAL_PHASE",()=>$localize`You cannot put a new ring after the tenth turn.`),u(W1,"NO_MARKERS_IN_INITIAL_PHASE",()=>$localize`You cannot put a marker in a ring before placing all of your rings.`),u(W1,"MISSING_CAPTURES",jo.MISSING_CAPTURES),u(W1,"MOVE_DIRECTION_INVALID",()=>$localize`The direction of your move is invalid: a move is made along a straight line.`),u(W1,"CAN_ONLY_CAPTURE_YOUR_MARKERS",()=>$localize`You can only capture your own markers.`),u(W1,"SHOULD_SELECT_PLAYER_RING",()=>$localize`You must pick one of your own rings to move.`),u(W1,"SHOULD_END_MOVE_ON_EMPTY_SPACE",()=>$localize`Your ring must land on an empty space.`),u(W1,"MOVE_SHOULD_NOT_PASS_ABOVE_RING",()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`),u(W1,"MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS",()=>$localize`Your ring must land on the first empty space after a group of markers.`),u(W1,"AMBIGUOUS_CAPTURE_COORD",jo.AMBIGUOUS_CAPTURE_COORD),u(W1,"CAPTURE_SHOULD_TAKE_RING",()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`);class kt{static of(e,t){return e===X.NONE?kt.EMPTY:t?kt.RINGS[e.value]:kt.MARKERS[e.value]}constructor(e,t){u(this,"player",void 0),u(this,"isRing",void 0),this.player=e,this.isRing=t}equals(e){return this===e}flip(){return Ve(!1===this.isRing,"cannot flip a ring (it should never happen)"),Ve(this.player.isPlayer(),"cannot flip a non-player piece"),kt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case kt.UNREACHABLE:return"NONE";case kt.EMPTY:return"EMPTY";case kt.MARKER_ZERO:return"MARKER_ZERO";case kt.MARKER_ONE:return"MARKER_ONE";case kt.RING_ZERO:return"RING_ZERO";default:return K.expectToBe(this,kt.RING_ONE),"RING_ONE"}}}ta=kt,u(kt,"encoder",Ie.tuple([X.encoder,Ie.identity()],r=>[r.player,r.isRing],r=>ta.of(r[0],r[1]))),u(kt,"UNREACHABLE",new ta(X.NONE,!1)),u(kt,"EMPTY",new ta(X.NONE,!1)),u(kt,"MARKER_ZERO",new ta(I.ZERO,!1)),u(kt,"MARKER_ONE",new ta(I.ONE,!1)),u(kt,"MARKERS",[ta.MARKER_ZERO,ta.MARKER_ONE]),u(kt,"RING_ZERO",new ta(I.ZERO,!0)),u(kt,"RING_ONE",new ta(I.ONE,!0)),u(kt,"RINGS",[ta.RING_ZERO,ta.RING_ONE]);let na=(()=>{class r extends RL{static getInitialState(){const t=kt.EMPTY,n=kt.UNREACHABLE;return new r([[n,n,n,n,n,n,t,t,t,t,n],[n,n,n,n,t,t,t,t,t,t,t],[n,n,n,t,t,t,t,t,t,t,t],[n,n,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,t],[n,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,t,n],[t,t,t,t,t,t,t,t,t,n,n],[t,t,t,t,t,t,t,t,n,n,n],[t,t,t,t,t,t,t,n,n,n,n],[n,t,t,t,t,n,n,n,n,n,n]],[5,5],0)}constructor(t,n,i){super(i,t,r.SIZE,r.SIZE,[6,4,3,2,1],kt.EMPTY),u(this,"sideRings",void 0),this.sideRings=n}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(t){return this===t||this.turn===t.turn&&this.sideRings[0]===t.sideRings[0]&&this.sideRings[1]===t.sideRings[1]&&He.compareTable(this.board,t.board)}getRingCoords(t){const n=[];return this.forEachCoord((i,s)=>{s.isRing&&s.player===t&&n.push(i)}),n}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==kt.UNREACHABLE}setAtUnsafe(t,n){const i=He.copyBiArray(this.board);return i[t.y][t.x]=n,new r(i,this.sideRings,this.turn)}}return u(r,"SIZE",11),r})();class Kmt{static getCombinations(e,t){return Ve(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(n=>this.getPermutations(n)).reduce((n,i)=>n.concat(i))}static getPermutations(e){const t=e.length,n=[e.slice()],i=new Array(t).fill(0);let s=1;for(;s<t;)if(i[s]<s){const o=s%2&&i[s],a=e[s];e[s]=e[o],e[o]=a,++i[s],s=1,n.push(e.slice())}else i[s]=0,++s;return n}static getSubsetsOfSize(e,t){return function n(i,s){if(s>=e.length||i<1)return[[]];{const o=[];for(;s<=e.length-i;){const a=e[s];for(const c of n(i-1,s+1))c.push(a),o.push(c);++s}return o}}(t,0)}}var b3e,w3e;class ra extends V2{static of(e,t,n){const i=[],s=be.factory.fromMove(e,t).get();for(let o=e;!1===o.equals(t);o=o.getNext(s))i.push(o);return i.push(t),new ra(i,n)}constructor(e,t=g.empty()){if(super(e),u(this,"ringTaken",void 0),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}setRingTaken(e){return new ra(this.capturedSpaces,g.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}b3e=ra,u(ra,"encoder",Ie.tuple([Ie.list(C.encoder),g.getEncoder(C.encoder)],r=>[r.capturedSpaces,r.ringTaken],r=>new b3e(r[0],r[1])));class Kc extends Li{constructor(e,t,n,i){super(),u(this,"initialCaptures",void 0),u(this,"start",void 0),u(this,"end",void 0),u(this,"finalCaptures",void 0),this.initialCaptures=e,this.start=t,this.end=n,this.finalCaptures=i}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===He.compareArray(this.initialCaptures,e.initialCaptures)||!1===He.compareArray(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const n of e)""!==t&&(t+=","),t+="["+n.toString()+"]";return t}}w3e=Kc,u(Kc,"encoder",Ie.tuple([Ie.list(ra.encoder),C.encoder,g.getEncoder(C.encoder),Ie.list(ra.encoder)],r=>[r.initialCaptures,r.start,r.end,r.finalCaptures],r=>new w3e(r[0],r[1],r[2],r[3])));class ja extends jn{static get(){return ja.singleton.isAbsent()&&(ja.singleton=g.of(new ja)),ja.singleton.get()}constructor(){super(na)}applyLegalMove(e,t,n){return new na(n.board,n.sideRings,n.turn+1)}applyCaptures(e,t){let n=t;return e.forEach(i=>{n=this.applyCapture(i,n)}),n}applyCapture(e,t){const n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new na(n,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const n=e.getCurrentPlayer().value,i=e.setAt(t,kt.EMPTY).board,s=[e.sideRings[0],e.sideRings[1]];return s[n]+=1,new na(i,s,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(n=>{e=e.setAt(n,kt.EMPTY)}),e.board}ringSelectionValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)===kt.RINGS[n]?b.SUCCESS:b.failure(W1.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,n){const i=n.getCurrentPlayer().value;let s=n.setAt(e,kt.MARKERS[i]);s=s.setAt(t,kt.RINGS[i]);const o=be.factory.fromMove(e,t).get();for(let a=e.getNext(o);!1===a.equals(t);a=a.getNext(o)){const c=s.getPieceAt(a);c!==kt.EMPTY&&(s=s.setAt(a,c.flip()))}return s}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return se.failure(W1.NO_MARKERS_IN_INITIAL_PHASE());const n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toOtherFallible();const i=this.applyCaptures(e.initialCaptures,t),s=this.moveValidity(i,e.start,e.end.get());if(s.isFailure())return s.toOtherFallible();const o=this.applyRingMoveAndFlip(e.start,e.end.get(),i),a=this.capturesValidity(o,e.finalCaptures);if(a.isFailure())return a.toOtherFallible();const c=this.applyCaptures(e.finalCaptures,o),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toOtherFallible():se.success(c)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return se.failure(W1.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==kt.EMPTY)return se.failure(Le.MUST_CLICK_ON_EMPTY_SPACE());const n=e.getCurrentPlayer(),i=[e.sideRings[0],e.sideRings[1]];i[n.value]-=1;const s=e.setAt(t,kt.of(n,!0)).board,o=new na(s,i,e.turn);return se.success(o)}moveStartValidity(e,t){const n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==kt.RINGS[n]?b.failure(W1.SHOULD_SELECT_PLAYER_RING()):b.SUCCESS}moveValidity(e,t,n){const i=this.moveStartValidity(e,t);if(i.isFailure())return i;if(e.getPieceAt(n)!==kt.EMPTY)return b.failure(W1.SHOULD_END_MOVE_ON_EMPTY_SPACE());const s=be.factory.fromMove(t,n);if(s.isFailure())return b.failure(W1.MOVE_DIRECTION_INVALID());const o=s.get();let a=!1;for(let c=t.getNext(o);!1===c.equals(n);c=c.getNext(o)){const l=e.getPieceAt(c);if(l===kt.EMPTY){if(a)return b.failure(W1.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(l.isRing)return b.failure(W1.MOVE_SHOULD_NOT_PASS_ABOVE_RING());a=!0}}return b.SUCCESS}capturesValidity(e,t){let n=e;for(const i of t){const s=this.captureValidity(n,i);if(s.isFailure())return s;n=this.applyCapture(i,n)}return b.SUCCESS}captureValidity(e,t){const n=e.getCurrentPlayer().value;for(const i of t.capturedSpaces)if(e.getPieceAt(i)!==kt.MARKERS[n])return b.failure(W1.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==kt.RINGS[n]?b.failure(W1.CAPTURE_SHOULD_TAKE_RING()):b.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?b.SUCCESS:b.failure(W1.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const n=[];return e.allLines().forEach(i=>{const s=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);s.isPresent()&&n.push(s.get())}),n}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,n){let i=0;const s=e.getEntranceOnLine(n),o=n.getDirection();let c,a=s;for(c=s;e.isOnBoard(c);c=c.getNext(o)){const l=e.getPieceAt(c);if(l.player===t&&!1===l.isRing)0===i&&(a=c),i+=1;else{if(i>=5)break;i=0}}return i>=5?g.of({start:a,end:c,dir:o}):g.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(i=>{for(let s=i.start;s.getDistance(i.end)>=5;s=s.getNext(i.dir))n.push(ra.of(s,s.getNext(i.dir,4)))}),n}getRingTargets(e,t){const n=[];for(const i of be.factory.all){let s=!1;for(let o=t.getNext(i);e.isOnBoard(o);o=o.getNext(i)){const a=e.getPieceAt(o);if(a===kt.EMPTY){if(n.push(o),s)break}else{if(a.isRing)break;s=!0}}}return n}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?ve.ONGOING:e.gameState.sideRings[0]>=3?ve.ZERO_WON:e.gameState.sideRings[1]>=3?ve.ONE_WON:ve.ONGOING}}u(ja,"singleton",g.empty());class Xmt extends Hr{getMetrics(e){return e.gameState.sideRings}getListMoves(e){const t=[],n=e.gameState;if(n.isInitialPlacementPhase())for(const{coord:i,content:s}of n.getCoordsAndContents())s===kt.EMPTY&&t.push(new Kc([],i,g.empty(),[]));else{const i=ja.get();this.getPossibleCaptureCombinations(n).forEach(s=>{const o=i.applyCaptures(s,n);this.getRingMoves(o).forEach(a=>{const c=i.applyRingMoveAndFlip(a.start,a.end,o);this.getPossibleCaptureCombinations(c).forEach(l=>{const f=new Kc(s,a.start,g.of(a.end),l);t.push(f)})})})}return t}getPossibleCaptureCombinations(e){const n=ja.get().getPossibleCaptures(e),i=this.getRingCoords(e);return kd.getPossibleCaptureCombinationsFromPossibleCaptures(n).map(s=>Kmt.getCombinations(i,s.length).map(o=>s.map((a,c)=>new ra(a.capturedSpaces,g.of(o[c]))))).reduce((s,o)=>s.concat(o),[])}getRingMoves(e){const t=ja.get(),n=[];for(const i of this.getRingCoords(e))for(const s of t.getRingTargets(e,i))n.push({start:i,end:s});return n}getRingCoords(e){const t=e.getCurrentPlayer().value,n=[];return e.forEachCoord((i,s)=>{s===kt.RINGS[t]&&n.push(i)}),n}}const D=kt.EMPTY,he=kt.UNREACHABLE,U2=kt.MARKER_ZERO,qi=kt.RING_ZERO,Xc=kt.MARKER_ONE,y2=kt.RING_ONE;let N3e=(()=>{class r{}return u(r,"MUST_ALIGN_FIVE",()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`),u(r,"MUST_CAPTURE_TWO",()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`),r})();class A3e extends Kn{constructor(...e){super(...e),u(this,"tutorial",[W.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new na([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,U2,y2,D,D,D,D,D,D],[he,he,D,U2,D,y2,D,Xc,D,D,D],[he,D,qi,Xc,D,D,y2,U2,D,D,D],[he,D,D,U2,Xc,D,D,D,D,D,he],[D,D,D,U2,D,D,D,y2,D,D,he],[D,D,D,Xc,U2,qi,D,D,D,he,he],[D,D,D,D,D,D,D,D,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[3,1],20)),W.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new na(na.getInitialState().board,[5,5],0),new Kc([],new C(5,5),g.empty(),[]),$localize`Congratulations!`),W.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new na([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,y2,D,D,D,D,D,D,D],[he,he,y2,D,D,y2,D,D,D,D,D],[he,D,qi,Xc,D,D,y2,D,D,D,D],[he,D,D,Xc,D,D,D,D,D,D,he],[D,D,D,D,qi,D,D,y2,D,D,he],[D,D,D,D,D,qi,D,D,D,he,he],[D,D,D,qi,D,D,D,he,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new Kc([],new C(2,4),g.of(new C(4,4)),[]),$localize`Congratulations!`),W.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new na([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,D,D,D,D,D,D,D],[he,he,he,y2,D,D,D,D,D,D,D],[he,he,y2,D,D,y2,D,D,D,D,D],[he,D,U2,U2,qi,Xc,Xc,D,D,D,D],[he,D,D,y2,D,D,D,D,D,D,he],[D,D,D,D,qi,D,D,y2,D,D,he],[D,D,D,D,D,qi,D,D,D,he,he],[D,D,D,qi,D,D,D,qi,he,he,he],[D,D,D,D,D,D,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],20),new Kc([],new C(4,4),g.of(new C(7,4)),[ra.of(new C(2,4),new C(6,4),g.of(new C(7,4)))]),(t,n,i)=>1===i.sideRings[I.ZERO.value]?b.SUCCESS:b.failure(N3e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),W.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new na([[he,he,he,he,he,he,D,D,D,D,he],[he,he,he,he,qi,D,D,y2,y2,qi,D],[he,he,he,qi,D,D,Xc,y2,D,qi,D],[he,he,D,qi,D,D,D,D,D,y2,D],[he,D,D,D,D,U2,D,D,y2,D,D],[he,D,D,D,U2,U2,D,Xc,D,D,he],[D,D,D,U2,D,U2,D,D,D,D,he],[D,D,U2,D,D,U2,D,D,D,he,he],[D,U2,D,D,D,U2,D,D,he,he,he],[D,D,D,D,D,U2,D,he,he,he,he],[he,D,D,D,D,he,he,he,he,he,he]],[0,0],10),new Kc([ra.of(new C(5,4),new C(1,8),g.of(new C(3,2))),ra.of(new C(5,9),new C(5,5),g.of(new C(3,3)))],new C(4,1),g.of(new C(4,2)),[]),(t,n,i)=>2===i.sideRings[I.ZERO.value]?b.SUCCESS:b.failure(N3e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)])}}var KC;function Qmt(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);k("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringOuterSize)}}function Jmt(r,e){if(1&r&&(A(),F(0,"circle",13)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","ring_",n,"_",s,""),y("ngClass",i.ringClasses),k("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function e_t(r,e){if(1&r&&(A(),F(0,"circle",12)),2&r){const t=p(2).$implicit,n=p(2);k("cx",t.center.x)("cy",t.center.y)("r",n.viewInfo.ringInnerSize)}}function t_t(r,e){if(1&r&&(A(),F(0,"circle",14)),2&r){const t=p(2),n=t.index,i=t.$implicit,s=p().index,o=p();ye("id","marker_",n,"_",s,""),y("ngClass",i.markerClasses),k("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function n_t(r,e){if(1&r){const t=pe();A(),E(0,"g",6),U("click",function(){te(t);const i=p().$implicit;return ne(p(2).onClick(i.coord))}),F(1,"polygon",7),E(2,"g",8),T(3,Qmt,1,3,"circle",9),T(4,Jmt,1,6,"circle",10),T(5,e_t,1,3,"circle",9),T(6,t_t,1,6,"circle",11),S()()}if(2&r){const t=p(),n=t.index,i=t.$implicit,s=p().index;ye("id","click_",n,"_",s,""),v(1),ye("id","space_",n,"_",s,""),y("ngClass",i.spaceClasses),k("points",i.coordinates),v(1),ye("id","pieceGroup_",n,"_",s,""),y("ngClass",i.removedClass),v(1),y("ngIf",i.isRing),v(1),y("ngIf",i.isRing),v(1),y("ngIf",i.isRing),v(1),y("ngIf",i.isMarker)}}function r_t(r,e){if(1&r&&(A(),E(0,"g"),T(1,n_t,7,13,"g",5),S()),2&r){const t=e.$implicit;v(1),y("ngIf",null!=t)}}function i_t(r,e){if(1&r&&(A(),E(0,"g"),T(1,r_t,2,1,"g",1),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}function s_t(r,e){if(1&r){const t=pe();A(),E(0,"polygon",15),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),S()}if(2&r){const t=e.$implicit,n=p();ye("id","selected_",t.x,"_",t.y,""),k("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function o_t(r,e){if(1&r){const t=pe();A(),E(0,"polygon",17),U("click",function(){const s=te(t).$implicit;return ne(p(2).onClick(s))}),S()}if(2&r){const t=e.$implicit,n=p(2);ye("id","selectable_",t.x,"_",t.y,""),k("points",n.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function a_t(r,e){if(1&r&&(A(),E(0,"g"),T(1,o_t,1,3,"polygon",16),S()),2&r){const t=p();v(1),y("ngForOf",t.viewInfo.selectableCoords)}}function c_t(r,e){if(1&r){const t=pe();A(),E(0,"rect",18),U("click",function(){const s=te(t).$implicit;return ne(p().onClick(s))}),S()}if(2&r){const t=e.$implicit,n=p();ye("id","indicator_",t.x,"_",t.y,""),k("x",n.viewInfo.spaceInfo[t.y][t.x].center.x-n.viewInfo.indicatorSize/2)("y",n.viewInfo.spaceInfo[t.y][t.x].center.y-n.viewInfo.indicatorSize/2)("width",n.viewInfo.indicatorSize)("height",n.viewInfo.indicatorSize)}}function l_t(r,e){if(1&r&&(A(),E(0,"g"),F(1,"circle",19)(2,"circle",12)(3,"circle",20),S()),2&r){const t=e.index,n=p().$implicit,i=p();v(1),ye("id","player_",n.value,"_sideRing_",t+1,""),k("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringOuterSize),v(1),k("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringInnerSize),v(1),y("ngClass",i.viewInfo.sideRingClass[n.value]),k("cx",(0===n.value?15:1050)+1.2*(0===n.value?1:-1)*i.viewInfo.ringOuterSize*(t+1))("cy",0===n.value?300:1260)("r",i.viewInfo.ringMidSize)}}const u_t=function(){return[]};function f_t(r,e){if(1&r&&(A(),E(0,"g"),T(1,l_t,4,12,"g",1),S()),2&r){const t=e.$implicit,n=p();k("transform","rotate("+180*(n.role.value+1)+" 532.5 780)"),v(1),y("ngForOf",g1(2,u_t).constructor(n.viewInfo.sideRings[t.value]))}}class _i extends Q5{constructor(e){super(e),u(this,"constructedState",void 0),u(this,"movePhase","MOVE_START"),u(this,"moveStart",g.empty()),u(this,"moveEnd",g.empty()),u(this,"currentlyMoved",[]),u(this,"currentCapture",g.empty()),u(this,"initialCaptures",[]),u(this,"finalCaptures",[]),u(this,"possibleCaptures",[]),u(this,"viewInfo",{spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:_i.MARKER_SIZE,ringOuterSize:_i.RING_OUTER_SIZE,ringMidSize:_i.RING_MID_SIZE,ringInnerSize:_i.RING_INNER_SIZE,indicatorSize:_i.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]}),this.scores=g.of([0,0]),this.rules=ja.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Xmt(this.rules,"YinshMinimax")],this.encoder=Kc.encoder,this.tutorial=(new A3e).tutorial,this.hexaLayout=new J5(1.5*_i.RING_OUTER_SIZE,new C(2*_i.RING_OUTER_SIZE,0),Dr.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPointsAt(t),center:this.getCenterAt(t),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const e=this.getState();this.scores=g.of(e.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of I.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==kt.EMPTY&&(!1===t.isRing||this.moveStart.equalsValue(e))){const i=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[i]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=g.empty(),this.moveStart=g.empty(),this.moveEnd=g.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){if(e.isInitialPlacement())this.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const n of this.coordsBetween(e.start,e.end.get()))this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["moved-fill"];const t=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();e.initialCaptures.forEach(n=>this.showLastMoveCapture(n,t)),e.finalCaptures.forEach(n=>this.showLastMoveCapture(n,t))}}coordsBetween(e,t){const n=[],i=be.factory.fromMove(e,t).get();for(let s=e;!1===s.equals(t);s=s.getNext(i))this.constructedState.getPieceAt(s)!==kt.EMPTY&&n.push(s),n.push(t);return n}showLastMoveCapture(e,t){for(const n of e.capturedSpaces)this.viewInfo.spaceInfo[n.y][n.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(n,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),b.SUCCESS}onClick(e){var t=this;return P(function*(){const n=t.canUserPlay("#click_"+e.x+"_"+e.y);if(n.isFailure())return t.cancelMove(n.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return P(function*(){const n=[];if(t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(n);else{if(0===n.length)return t.cancelMove(W1.MISSING_CAPTURES());t.selectCapture(n[0])}return b.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const n of t.capturedSpaces)this.viewInfo.selectableCoords.push(n);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(K.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return P(function*(){const n=[];return t.possibleCaptures.forEach(i=>{i.contains(e)&&n.push(i)}),n.length>1?t.cancelMove(W1.AMBIGUOUS_CAPTURE_COORD()):0===n.length?t.cancelMove(W1.MISSING_CAPTURES()):t.selectCapture(n[0])})()}selectCapture(e){return this.currentCapture=g.of(e),this.constructedState=new na(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(Ve("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),b.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,kt.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,kt.RINGS[t.value])}selectRing(e){var t=this;return P(function*(){const n=t.rules.ringSelectionValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const i=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=g.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS)):(K.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),b.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),b.SUCCESS}tryMove(){var e=this;return P(function*(){const t=new Kc(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return P(function*(){if(t.constructedState.isInitialPlacementPhase()){const n=t.rules.initialPlacementValidity(t.constructedState,e);return n.isFailure()?t.cancelMove(n.getReason()):(t.moveStart=g.of(e),t.tryMove())}{const n=t.rules.moveStartValidity(t.constructedState,e);if(n.isFailure())return t.cancelMove(n.getReason());t.moveStart=g.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return b.SUCCESS})()}selectMoveEnd(e){var t=this;return P(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),b.SUCCESS;const n=kt.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===n)return t.cancelMoveAttempt(),t.selectMoveStart(e);const i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=g.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return P(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),b.SUCCESS)})()}}function d_t(r,e){if(1&r&&(E(0,"option",5),lt(1),S()),2&r){const t=e.$implicit;y("value",t.urlName),v(1),Nn(t.name)}}KC=_i,u(_i,"RING_OUTER_SIZE",40),u(_i,"RING_MID_SIZE",34),u(_i,"RING_INNER_SIZE",28),u(_i,"MARKER_SIZE",KC.RING_INNER_SIZE),u(_i,"INDICATOR_SIZE",10),u(_i,"\u0275fac",function(e){return new(e||KC)(G(Wt))}),u(_i,"\u0275cmp",Xe({type:KC,selectors:[["app-yinsh"]],features:[Je],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(A(),E(0,"svg",0),T(1,i_t,2,1,"g",1),T(2,s_t,1,3,"polygon",2),T(3,a_t,2,1,"g",3),T(4,c_t,1,6,"rect",4),T(5,f_t,2,3,"g",1),S()),2&e&&(v(1),y("ngForOf",t.viewInfo.spaceInfo),v(1),y("ngForOf",t.viewInfo.selectedCoords),v(1),y("ngIf",t.isPlayerTurn()),v(1),y("ngForOf",t.viewInfo.targets),v(1),y("ngForOf",t.Player.PLAYERS))},dependencies:[Ft,Zt,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));let Fn=(()=>{class r{}return u(r,"ABALONE",()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`),u(r,"APAGOS",()=>$localize`Very simple game, but, will you be able to win everytime?`),u(r,"AWALE",()=>$localize`The international version of the famous African strategy game!`),u(r,"BRANDHUB",()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"COERCEO",()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`),u(r,"CONNECT_SIX",()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`),u(r,"CONSPIRATEURS",()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`),u(r,"DIAM",()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`),u(r,"DVONN",()=>$localize`Stack your pieces and control as many stacks as you can to win!`),u(r,"ENCAPSULE",()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`),u(r,"EPAMINONDAS",()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`),u(r,"GIPF",()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`),u(r,"GO",()=>$localize`The oldest strategy game still practiced widely. A territory control game.`),u(r,"HIVE",()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`),u(r,"HNEFATAFL",()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`),u(r,"KAMISADO",()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`),u(r,"LASCA",()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`),u(r,"LINES_OF_ACTION",()=>$localize`Regroup your pieces to win. But your possible moves will often change!`),u(r,"LODESTONE",()=>$localize`Push and crush your opponent's pieces using magnetic forces!`),u(r,"MARTIAN_CHESS",()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`),u(r,"P4",()=>$localize`The classical 4 in a row game!`),u(r,"PENTAGO",()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`),u(r,"PENTE",()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`),u(r,"PYLOS",()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`),u(r,"QUARTO",()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`),u(r,"QUIXO",()=>$localize`Align 5 of your pieces on a board where pieces slide!`),u(r,"REVERSI",()=>$localize`Sandwich your opponent's pieces to dominate the board!`),u(r,"SAHARA",()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`),u(r,"SIAM",()=>$localize`Be the first to push a mountain out of the board!`),u(r,"SIX",()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`),u(r,"TABLUT",()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`),u(r,"TEEKO",()=>$localize`Align your 4 pieces or form a square with them to win!`),u(r,"TREXO",()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`),u(r,"YINSH",()=>$localize`Align your pieces to score points, but beware, pieces can flip!`),r})(),Su=(()=>{var r;class e{constructor(n,i,s,o,a,c,l,f=!0){u(this,"name",void 0),u(this,"urlName",void 0),u(this,"component",void 0),u(this,"tutorial",void 0),u(this,"rules",void 0),u(this,"creationDate",void 0),u(this,"description",void 0),u(this,"display",void 0),this.name=n,this.urlName=i,this.component=s,this.tutorial=o,this.rules=a,this.creationDate=c,this.description=l,this.display=f}}return r=e,u(e,"ALL_GAMES",()=>[new r($localize`Four in a Row`,"P4",jht,new Vce,bl.get(),new Date("2018-08-28"),Fn.P4()),new r($localize`Awalé`,"Awale",A7t,new Oae,Sa.get(),new Date("2018-11-29"),Fn.AWALE()),new r($localize`Quarto`,"Quarto",ngt,new t3e,Or.get(),new Date("2018-12-09"),Fn.QUARTO()),new r($localize`Tablut`,"Tablut",Mmt,new m3e,Al.get(),new Date("2018-12-27"),Fn.TABLUT()),new r($localize`Reversi`,"Reversi",ggt,new s3e,gu.get(),new Date("2019-01-16"),Fn.REVERSI()),new r($localize`Go`,"Go",BL,new cce,i4.get(),new Date("2019-12-21"),Fn.GO()),new r($localize`Encapsule`,"Encapsule",l9t,new tce,ou.get(),new Date("2019-12-30"),Fn.ENCAPSULE()),new r($localize`Siam`,"Siam",cR,new d3e,Ua.get(),new Date("2020-01-11"),Fn.SIAM()),new r($localize`Sahara`,"Sahara",Ngt,new a3e,w0.get(),new Date("2020-02-29"),Fn.SAHARA()),new r($localize`Pylos`,"Pylos",Tpt,new Kce,v2.get(),new Date("2020-10-02"),Fn.PYLOS()),new r($localize`Kamisado`,"Kamisado",$dt,new Pce,_2.get(),new Date("2020-10-03"),Fn.KAMISADO()),new r($localize`Quixo`,"Quixo",lgt,new r3e,G2.get(),new Date("2020-10-15"),Fn.QUIXO()),new r($localize`Dvonn`,"Dvonn",Kft,new Yae,Er.get(),new Date("2020-10-21"),Fn.DVONN()),new r($localize`Epaminondas`,"Epaminondas",m9t,new rce,Vi.get(),new Date("2021-01-16"),Fn.EPAMINONDAS()),new r($localize`Gipf`,"Gipf",T9t,new ace,Qt.get(),new Date("2021-02-22"),Fn.GIPF()),new r($localize`Coerceo`,"Coerceo",vft,new jae,fC.get(),new Date("2021-03-21"),Fn.COERCEO()),new r($localize`Six`,"Six",cmt,new p3e,qa.get(),new Date("2021-04-08"),Fn.SIX()),new r($localize`Lines of Action`,"LinesOfAction",nht,new Ice,Br.get(),new Date("2021-04-28"),Fn.LINES_OF_ACTION()),new r($localize`Pentago`,"Pentago",rpt,new Bce,Bc.get(),new Date("2021-05-23"),Fn.PENTAGO()),new r($localize`Abalone`,"Abalone",m7t,new Tae,Do.get(),new Date("2021-07-13"),Fn.ABALONE()),new r($localize`Yinsh`,"Yinsh",_i,new A3e,ja.get(),new Date("2021-07-31"),Fn.YINSH()),new r($localize`Apagos`,"Apagos",P7t,new vae,X3.get(),new Date("2021-11-04"),Fn.APAGOS()),new r($localize`Diam`,"Diam",Rc,new Bae,Lc.get(),new Date("2021-11-30"),Fn.DIAM()),new r($localize`Brandhub`,"Brandhub",W7t,new Aae,vl.get(),new Date("2021-12-07"),Fn.BRANDHUB()),new r($localize`Conspirateurs`,"Conspirateurs",wft,new Dae,ho.get(),new Date("2021-12-30"),Fn.CONSPIRATEURS()),new r($localize`Lodestone`,"Lodestone",Tl,new xce,hi.get(),new Date("2022-06-24"),Fn.LODESTONE()),new r($localize`Martian Chess`,"MartianChess",Cs,new Hce,La.get(),new Date("2022-07-01"),Fn.MARTIAN_CHESS()),new r($localize`Hnefatafl`,"Hnefatafl",kdt,new Mce,Sl.get(),new Date("2022-09-21"),Fn.HNEFATAFL()),new r($localize`Hive`,"Hive",Cdt,new vce,F2.get(),new Date("2023-04-02"),Fn.HIVE()),new r($localize`Trexo`,"Trexo",Vn,new T3e,mi.get(),new Date("2023-04-23"),Fn.TREXO()),new r($localize`Lasca`,"Lasca",Kdt,new Nce,_s.get(),new Date("2023-05-11"),Fn.LASCA()),new r($localize`Connect Six`,"ConnectSix",J7t,new xae,fo.get(),new Date("2023-05-13"),Fn.CONNECT_SIX()),new r($localize`Pente`,"Pente",fpt,new qce,Hs.get(),new Date("2023-05-20"),Fn.PENTE()),new r($localize`Teeko`,"Teeko",Omt,new C3e,yo.get(),new Date("2023-07-30"),Fn.TEEKO())].sort((t,n)=>t.name.localeCompare(n.name))),e})(),hR=(()=>{var r;class e{constructor(){u(this,"games",Su.ALL_GAMES()),u(this,"pickGame",new b1)}onChange(n){this.pickGame.emit(n.target.value)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"select",1),U("change",function(o){return i.onChange(o)}),E(2,"option",2),oe(3,3),S(),T(4,d_t,2,2,"option",4),S()()),2&n&&(v(4),y("ngForOf",i.games))},dependencies:[Zt,Y7,K7],encapsulation:2})),e})();function h_t(r,e){if(1&r){const t=pe();E(0,"div",26)(1,"div",27),U("click",function(){return te(t),ne(p().closeInfo())}),S(),E(2,"div",28)(3,"header",29)(4,"p",30),lt(5),S(),E(6,"button",31),U("click",function(){return te(t),ne(p().closeInfo())}),S()(),E(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),F(11,"img",35),S()(),E(12,"div",7)(13,"div",13),lt(14),S()()(),E(15,"div",6)(16,"div",33)(17,"a",36),U("click",function(){te(t);const i=p();return ne(i.createGame(i.gameInfoDetails.get().urlName))}),F(18,"fa-icon",37),lt(19,"\xa0"),E(20,"span"),oe(21,38),S()()(),E(22,"div",33)(23,"a",36),U("click",function(){te(t);const i=p();return ne(i.createLocalGame(i.gameInfoDetails.get().urlName))}),F(24,"fa-icon",37),lt(25,"\xa0"),E(26,"span"),oe(27,39),S()()(),E(28,"div",33)(29,"a",36),U("click",function(){te(t);const i=p();return ne(i.createTutorial(i.gameInfoDetails.get().urlName))}),F(30,"fa-icon",37),lt(31,"\xa0"),E(32,"span"),oe(33,40),S()()()()()()()}if(2&r){const t=p();v(5),Nn(t.gameInfoDetails.get().name),v(6),ye("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",ep),v(3),S2(" ",t.gameInfoDetails.get().description," "),v(4),y("icon",t.iconOnlineGame),v(6),y("icon",t.iconLocalGame),v(6),y("icon",t.iconTutorial)}}function p_t(r,e){if(1&r){const t=pe();E(0,"div",8)(1,"div",9)(2,"p",10),lt(3),S()(),E(4,"div",42)(5,"figure",34)(6,"img",43),U("click",function(){const s=te(t).$implicit;return ne(p(2).openInfo(s))}),S(),E(7,"figcaption",44),U("click",function(){const s=te(t).$implicit;return ne(p(2).openInfo(s))}),E(8,"div",45),lt(9,"?"),S()(),E(10,"figcaption",46)(11,"a",47),U("click",function(){const s=te(t).$implicit;return ne(p(2).createGame(s.urlName))}),F(12,"fa-icon",37),S(),E(13,"a",48),U("click",function(){const s=te(t).$implicit;return ne(p(2).createLocalGame(s.urlName))}),F(14,"fa-icon",37),S(),E(15,"a",49),U("click",function(){const s=te(t).$implicit;return ne(p(2).createTutorial(s.urlName))}),F(16,"fa-icon",37),S()()()(),E(17,"div",50),lt(18),S()()}if(2&r){const t=e.$implicit,n=p(2);v(3),Nn(t.name),v(3),Rn("id","image_",t.urlName,""),ye("src","assets/images/",n.theme,"/",t.urlName,".png",ep),v(5),Rn("id","playOnline_",t.urlName,""),v(1),y("icon",n.iconOnlineGame),v(1),Rn("id","playLocally_",t.urlName,""),v(1),y("icon",n.iconLocalGame),v(1),Rn("id","startTutorial_",t.urlName,""),v(1),y("icon",n.iconTutorial),v(2),S2(" ",t.description," ")}}function g_t(r,e){if(1&r&&(E(0,"div",7),T(1,p_t,19,11,"div",41),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}let m_t=(()=>{var r;class e{constructor(n,i,s,o){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"currentGameService",void 0),u(this,"numberOfColumns",5),u(this,"games",[]),u(this,"theme",void 0),u(this,"iconOnlineGame",Die),u(this,"iconLocalGame",dL),u(this,"iconTutorial",Voe),u(this,"gameInfoDetails",g.empty()),this.router=n,this.messageDisplayer=i,this.currentGameService=s,this.theme=o.getTheme();const a=Su.ALL_GAMES();let c=0;for(let l=0;l<a.length;l++)l<this.numberOfColumns&&this.games.push([]),this.games[c].push(a[l]),c=(c+1)%this.numberOfColumns}createGame(n){var i=this;return P(function*(){const s=i.currentGameService.canUserCreate();return s.isSuccess()?i.router.navigate(null==n?["/play"]:["/play",n]):(i.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(n){var i=this;return P(function*(){return i.router.navigate(["/local",n])})()}createTutorial(n){return this.router.navigate(["/tutorial",n])}openInfo(n){this.gameInfoDetails=g.of(n)}closeInfo(){this.gameInfoDetails=g.empty()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Bn),G(Wt),G(ls),G(hv))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,M,w,L;return t=$localize`EveryBoard`,n=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,i=$localize`Play online`,s=$localize`Create an online game`,o=$localize`See the game list`,a=$localize`Play offline`,c=$localize`Play`,l=$localize`Learn`,f=$localize`Play online`,d=$localize`Play offline`,m=$localize`Learn the rules`,M=$localize`Play online`,w=$localize`Play offline`,L=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],n,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],i,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],o,a,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],l,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],f,d,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",M,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",L,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(n,i){1&n&&(E(0,"section",0)(1,"div",1)(2,"p",2),oe(3,3),S(),E(4,"p",4),ws(5,5),F(6,"br"),Ns(),S()(),E(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),oe(12,11),S()(),E(13,"div",12)(14,"div",13)(15,"button",14),U("click",function(){return i.createGame()}),oe(16,15),S(),E(17,"button",16),oe(18,17),S()()()()(),E(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),oe(23,18),S()(),E(24,"div",12)(25,"div",19)(26,"button",20),oe(27,21),S(),E(28,"button",22),oe(29,23),S()()()()()(),T(30,h_t,34,7,"div",24),E(31,"div",6),T(32,g_t,2,1,"div",25),S()()),2&n&&(v(30),y("ngIf",i.gameInfoDetails.isPresent()),v(2),y("ngForOf",i.games))},dependencies:[Zt,Nt,vc,v0],encapsulation:2})),e})();const __t=["board"];let A0=(()=>{class r{static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}}return u(r,"NOT_YOUR_TURN",()=>$localize`It is not your turn!`),u(r,"GAME_HAS_ENDED",()=>$localize`This game has ended.`),u(r,"CANNOT_PLAY_AS_OBSERVER",()=>$localize`You are an observer in this game, you cannot play.`),u(r,"MUST_ANSWER_REQUEST",()=>$localize`You must answer your opponent's request.`),r})(),XC=(()=>{var r;class e{constructor(n,i,s,o){u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"boardRef",null),u(this,"gameComponent",void 0),u(this,"players",[g.empty(),g.empty()]),u(this,"role",X.NONE),u(this,"endGame",!1),u(this,"Player",I),this.actRoute=n,this.connectedUserService=i,this.router=s,this.messageDisplayer=o}getMatchingComponent(n){return g.ofNullable(Su.ALL_GAMES().find(s=>s.urlName===n)).map(s=>s.component)}afterViewInit(){var n=this;return P(function*(){const i=yield n.createGameComponent();return i&&(n.gameComponent.node=n.gameComponent.rules.getInitialNode(),n.gameComponent.updateBoard()),i})()}getGameName(){return K.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var n=this;return P(function*(){const i=n.getGameName(),s=n.getMatchingComponent(i);if(s.isAbsent())return yield n.router.navigate(["/notFound",A0.NO_MATCHING_GAME(i)],{skipLocationChange:!0}),!1;Ve(null!=n.boardRef,"Board element should be present");const o=K.getNonNullable(n.boardRef).createComponent(s.get());return n.gameComponent=o.instance,n.gameComponent.chooseMove=a=>n.receiveValidMove(a),n.gameComponent.canUserPlay=a=>n.canUserPlay(a),n.gameComponent.isPlayerTurn=()=>n.isPlayerTurn(),n.gameComponent.cancelMoveOnWrapper=a=>{n.onCancelMove(a)},n.setRole(n.role),!0})()}setRole(n){this.role=n,this.gameComponent.role=this.role,this.gameComponent.hasAsymmetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")"),this.updateBoardAndShowLastMove()}receiveValidMove(n){var i=this;return P(function*(){const s=i.gameComponent.rules.isLegal(n,i.gameComponent.getState());return s.isFailure()?(i.gameComponent.cancelMove(s.getReason()),b.ofFallible(s)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(n),b.SUCCESS)})()}canUserPlay(n){if(this.role===X.NONE){const i=A0.CANNOT_PLAY_AS_OBSERVER();return b.failure(i)}return!1===this.isPlayerTurn()?b.failure(A0.NOT_YOUR_TURN()):this.endGame?b.failure(A0.GAME_HAS_ENDED()):b.SUCCESS}isPlayerTurn(){if(this.role===X.NONE||null==this.gameComponent)return!1;const i=this.gameComponent.getTurn()%2,s=this.getPlayer();return!this.players[i].isPresent()||this.players[i].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(){if(this.gameComponent.cancelMoveAttempt(),this.gameComponent.updateBoard(),this.gameComponent.node.move.isPresent()){const n=this.gameComponent.node.move.get();this.gameComponent.showLastMove(n)}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Is),G(sr),G(Bn),G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["ng-component"]],viewQuery:function(n,i){if(1&n&&T4(__t,5,Js),2&n){let s;m3(s=_3())&&(i.boardRef=s.first)}},decls:0,vars:0,template:function(n,i){},encapsulation:2})),e})();const v_t=["board"];let C_t=(()=>{var r;class e extends XC{constructor(n,i,s,o,a){super(n,i,s,o),u(this,"cdr",void 0),u(this,"demoNodeInfo",void 0),u(this,"boardRef",null),this.cdr=a}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var n=this;return P(function*(){setTimeout(P(function*(){yield n.afterViewInit(),n.gameComponent.node=n.demoNodeInfo.node,n.setRole(n.gameComponent.getCurrentPlayer()),n.cdr.detectChanges(),n.demoNodeInfo.click.isPresent()&&(K.getNonNullable(document.querySelector(n.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),n.cdr.detectChanges())}),1)})()}onLegalUserMove(n,i){return P(function*(){})()}getPlayer(){return"no-player"}onCancelMove(n){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Is),G(sr),G(Bn),G(Wt),G(s6))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-demo-card"]],viewQuery:function(n,i){if(1&n&&T4(v_t,5,Js),2&n){let s;m3(s=_3())&&(i.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[Je],decls:2,vars:0,consts:[["board",""]],template:function(n,i){1&n&&F(0,"div",null,0)},encapsulation:2})),e})();function y_t(r,e){if(1&r&&(E(0,"div",17)(1,"figure",18),F(2,"app-demo-card",19),S()()),2&r){const t=p().$implicit;v(2),y("demoNodeInfo",t)}}function M_t(r,e){if(1&r&&(E(0,"div",20)(1,"figure",21),F(2,"app-demo-card",19),S()()),2&r){const t=p().$implicit;v(2),y("demoNodeInfo",t)}}function E_t(r,e){if(1&r&&(E(0,"div",12)(1,"div",13)(2,"p",14),lt(3),S()(),T(4,y_t,3,1,"div",15),T(5,M_t,3,1,"ng-template",null,16,dn),S()),2&r){const t=e.$implicit,n=ln(6),i=p(2);v(3),Nn(t.name),v(1),y("ngIf",i.squared.value)("ngIfElse",n)}}function S_t(r,e){if(1&r&&(E(0,"div",10),T(1,E_t,7,3,"div",11),S()),2&r){const t=e.$implicit;v(1),y("ngForOf",t)}}let P_t=(()=>{var r;class e{constructor(){u(this,"numberOfColumns",new to(5)),u(this,"squared",new to(!0)),u(this,"columns",[]),this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(n=>{this.fillColumns(n)})}fillColumns(n){const i=Su.ALL_GAMES();let s=0,o=0;this.columns=[];for(const a of i){const c=[],l=a.rules,f=a.tutorial.tutorial;for(const d of f){const m=this.getNodeFromStep(d,l);c.push(m)}for(const d of c)o<n&&this.columns.push([]),this.columns[s].push({name:a.urlName,node:d.node,click:d.click}),o++,s=(s+1)%n}}getNodeFromStep(n,i){if(n.hasSolution()){const s=n.getSolution();if("string"==typeof s)return{node:new zi(n.state),click:g.of(s)};{const o=s;return{node:new zi(i.applyLegalMove(o,n.state,i.isLegal(o,n.state).get()),g.of(new zi(n.state)),g.of(o)),click:g.empty()}}}return{node:new zi(n.state),click:g.empty()}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,n;return t=$localize`Number of columns: `,n=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],n,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(n,i){1&n&&(E(0,"form")(1,"div",0)(2,"label",1),Bt(3),oe(4,2),Gt(),E(5,"output"),lt(6),S()(),E(7,"div",3),F(8,"input",4),S()(),E(9,"div",0)(10,"label",5),F(11,"input",6),lt(12," \xa0"),Bt(13),oe(14,7),Gt(),S()()(),E(15,"div",8),T(16,S_t,2,1,"div",9),S()),2&n&&(v(6),Nn(i.numberOfColumns.value),v(2),y("formControl",i.numberOfColumns),v(3),y("formControl",i.squared),v(5),y("ngForOf",i.columns))},dependencies:[Zt,Nt,f6,pc,fg,bS,M3,l6,FS,j7,C_t],encapsulation:2})),e})(),pR=(()=>{var r;class e{constructor(n){u(this,"element",void 0),this.element=n}ngAfterViewInit(){this.element.nativeElement.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Si))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","autofocus",""]]})),e})(),I3e=(()=>{var r;class e{constructor(n){u(this,"shown",!1),u(this,"input",void 0),this.input=n.nativeElement.parentNode.previousSibling,n.nativeElement.addEventListener("click",i=>{this.toggle()})}toggle(){this.shown=!1===this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Si))}),u(e,"\u0275dir",Rt({type:r,selectors:[["","toggleVisibility",""]]})),e})();function T_t(r,e){if(1&r&&(E(0,"div",29)(1,"div",30),oe(2,31),S(),E(3,"div",32),lt(4),S()()),2&r){const t=p();v(4),Nn(t.errorMessage)}}const O_t=function(){return["/register"]},b_t=function(){return["/reset-password"]};let w_t=(()=>{var r;class e{constructor(n,i){u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"faEye",Bx),u(this,"errorMessage",void 0),u(this,"loginForm",new k4({email:new to,password:new to})),u(this,"userSubscription",void 0),this.router=n,this.connectedUserService=i}ngOnInit(){var n=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var i=P(function*(s){s!==u0.NOT_CONNECTED&&(yield n.redirect())});return function(s){return i.apply(this,arguments)}}())}loginWithEmail(n){var i=this;return P(function*(){const s=yield i.connectedUserService.doEmailLogin(n.email,n.password);s.isFailure()&&(i.errorMessage=s.getReason())})()}loginWithGoogle(){var n=this;return P(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isFailure()&&(n.errorMessage=i.getReason())})()}redirect(){var n=this;return P(function*(){return n.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Bn),G(sr))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,M;return t=$localize`Log in`,n=$localize`Email`,i=$localize`Email`,s=$localize`Password`,o=$localize`Password`,a=$localize`Log in`,c=$localize`Log in with Google`,l=$localize`No account?`,f=$localize`Register`,d=$localize`Forgot your password?`,m=$localize`Reset your password`,M=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",i,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",o,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],a,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],l,[3,"routerLink"],f,d,m,["role","alert",1,"message","is-danger"],[1,"message-header"],M,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),oe(2,2),S(),E(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),S()(),E(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),S()()()(),E(12,"div",4)(13,"div",5)(14,"label",12),oe(15,13),S()(),E(16,"div",8)(17,"div",9)(18,"div",14),F(19,"input",15),E(20,"span",16),F(21,"fa-icon",17),S()()()()(),E(22,"div",4),F(23,"div",5),E(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),U("click",function(){return i.loginWithEmail(i.loginForm.value)}),oe(28,19),S()()()()(),E(29,"div",4),F(30,"div",5),E(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),U("click",function(){return i.loginWithGoogle()}),oe(35,21),S()()()()(),T(36,T_t,5,1,"div",22),E(37,"p",23),Bt(38),oe(39,24),Gt(),lt(40,"\xa0 "),E(41,"a",25),oe(42,26),S()(),E(43,"p",23),Bt(44),oe(45,27),Gt(),lt(46,"\xa0 "),E(47,"a",25),oe(48,28),S()()()()),2&n&&(v(3),y("formGroup",i.loginForm),v(18),y("icon",i.faEye),v(6),y("disabled",!i.canLogin()),v(9),y("ngIf",i.errorMessage),v(5),y("routerLink",g1(6,O_t)),v(6),y("routerLink",g1(7,b_t)))},dependencies:[Nt,vc,f6,pc,M3,l6,p6,d6,k8,v0,pR,I3e],encapsulation:2})),e})(),N_t=(()=>{var r;class e{constructor(n){u(this,"partDAO",void 0),this.partDAO=n}subscribeToActiveParts(n){let i=[];const c=new dv(l=>{i=i.concat(...l),n(i)},l=>{const f=i;for(const d of l)f.forEach(m=>{m.id===d.id&&(m.data=d.data)});i=f,n(i)},l=>{const f=[];for(const d of i)l.every(m=>m.id!==d.id)&&f.push(d);i=f,n(i)});return this.partDAO.observingWhere([["result","==",A1.UNACHIEVED.value]],c)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(td))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),A_t=(()=>{var r;class e{transform(n){return SB(1e3*n.seconds,"HH:mm:ss","en-US")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",yi({name:"firestoreTime",type:r,pure:!0})),e})();var Pu;const k_t=["chatDiv"];function x_t(r,e){1&r&&(Bt(0),oe(1,5),Gt())}function L_t(r,e){1&r&&oe(0,6),2&r&&($n(p().unreadMessagesText),qn(0))}function R_t(r,e){if(1&r){const t=pe();E(0,"button",11),U("click",function(){return te(t),ne(p(2).scrollToBottom())}),lt(1),S()}if(2&r){const t=p(2);v(1),S2("",t.unreadMessagesText," \u2193")}}function z_t(r,e){if(1&r&&(E(0,"p"),lt(1),ha(2,"firestoreTime"),E(3,"b",12),lt(4),S(),E(5,"span",13),lt(6),S()()),2&r){const t=e.$implicit;v(1),S2(" [",fc(2,3,t.postedTime),"] "),v(3),S2("",t.sender.name," : "),v(2),Nn(t.content)}}function D_t(r,e){if(1&r){const t=pe();E(0,"div"),T(1,R_t,2,1,"button",7),E(2,"div",8,9),U("scroll",function(){return te(t),ne(p().updateCurrentScrollPosition())}),T(4,z_t,7,5,"p",10),S()()}if(2&r){const t=p();v(1),y("ngIf",t.showUnreadMessagesButton),v(3),y("ngForOf",t.chat)}}const H_t=function(){return{standalone:!0}};function V_t(r,e){if(1&r){const t=pe();E(0,"form",14),U("onSubmit",function(){return te(t),ne(p().sendMessage())}),E(1,"div",15)(2,"div",16)(3,"input",17,18),U("ngModelChange",function(i){return te(t),ne(p().userMessage=i)}),S(),E(5,"p",19),lt(6),S()(),E(7,"div",20)(8,"button",21),U("click",function(){return te(t),ne(p().sendMessage())}),F(9,"fa-icon",22),S()()(),E(10,"div",23)(11,"p")(12,"strong"),oe(13,24),S()()()()}if(2&r){const t=ln(4),n=p();v(3),y("ngModel",n.userMessage)("ngModelOptions",g1(4,H_t)),v(3),S2("",t.value.length,"/128"),v(3),y("icon",n.faReply)}}let QC=(Pu=class{constructor(e,t){u(this,"chatService",void 0),u(this,"connectedUserService",void 0),u(this,"chatId",void 0),u(this,"turn",void 0),u(this,"userMessage",""),u(this,"connected",!1),u(this,"chat",[]),u(this,"readMessages",0),u(this,"unreadMessagesText",""),u(this,"showUnreadMessagesButton",!1),u(this,"visible",!0),u(this,"faReply",bx),u(this,"isNearBottom",!0),u(this,"notYetScrolled",!0),u(this,"chatSubscription",void 0),u(this,"chatDiv",void 0),this.chatService=e,this.connectedUserService=t}ngOnInit(){Ve(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=n=>{this.updateMessages(n.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},t=new dv(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return P(function*(){const t=e.userMessage;e.userMessage="";const n=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,n,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}},u(Pu,"\u0275fac",function(e){return new(e||Pu)(G(F5),G(sr))}),u(Pu,"\u0275cmp",Xe({type:Pu,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&T4(k_t,5),2&e){let n;m3(n=_3())&&(t.chatDiv=n.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let r,e,t,n;return r=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,t=$localize`Type your message here`,n=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],r,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",t,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],n]},template:function(e,t){if(1&e&&(E(0,"div")(1,"button",0),U("click",function(){return t.switchChatVisibility()}),T(2,x_t,2,0,"ng-container",1),T(3,L_t,1,1,"ng-template",null,2,dn),S(),T(5,D_t,5,2,"div",3),T(6,V_t,14,5,"form",4),S()),2&e){const n=ln(4);v(2),y("ngIf",t.visible)("ngIfElse",n),v(3),y("ngIf",t.visible),v(1),y("ngIf",t.visible)}},dependencies:[Zt,Nt,f6,pc,M3,l6,US,Z7,j7,v0,A_t],encapsulation:2})),Pu);QC=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],QC);let k3e=(()=>{var r;class e{constructor(n,i,s){u(this,"router",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"selectedGame",void 0),this.router=n,this.currentGameService=i,this.messageDisplayer=s}pickGame(n){this.selectedGame=n}navigateToOnlineGameCreation(){var n=this;return P(function*(){const i=n.currentGameService.canUserCreate();i.isSuccess()?yield n.router.navigate(["/play",n.selectedGame]):n.messageDisplayer.criticalMessage(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Bn),G(ls),G(Wt))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(E(0,"app-pick-game",0),U("pickGame",function(o){return i.pickGame(o)}),S(),E(1,"button",1),U("click",function(){return i.navigateToOnlineGameCreation()}),oe(2,2),S()),2&n&&(v(1),y("disabled",!i.selectedGame))},dependencies:[hR],encapsulation:2})),e})();var Tu;function $_t(r,e){if(1&r&&(Bt(0),lt(1),Gt()),2&r){const t=p().$implicit;v(1),Nn(t.data.playerOne.name)}}function B_t(r,e){1&r&&(Bt(0),oe(1,27),Gt())}function G_t(r,e){if(1&r){const t=pe();E(0,"tr",22),U("click",function(){const s=te(t).$implicit;return ne(p(2).joinGame(s))}),E(1,"td",23),lt(2),S(),E(3,"td",23),lt(4),S(),E(5,"td",23),T(6,$_t,2,1,"ng-container",24),T(7,B_t,2,0,"ng-template",null,25,dn),S(),E(9,"td",26),lt(10),S()()}if(2&r){const t=e.$implicit,n=e.index,i=ln(8);Rn("id","part_",n,""),v(2),Nn(t.data.typeGame),v(2),Nn(t.data.playerZero.name),v(2),y("ngIf",t.data.playerOne)("ngIfElse",i),v(4),Nn(t.data.turn+1)}}function U_t(r,e){if(1&r&&(E(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),oe(6,17),S(),E(7,"th",16),oe(8,18),S(),E(9,"th",16),oe(10,19),S(),E(11,"th",16),oe(12,20),S()()(),E(13,"tbody"),T(14,G_t,11,6,"tr",21),S()()()()),2&r){const t=p();v(14),y("ngForOf",t.activeParts)}}function W_t(r,e){1&r&&(E(0,"div",28),F(1,"app-online-game-selection",29),S())}function q_t(r,e){1&r&&(E(0,"div",30)(1,"div",31)(2,"div",32),F(3,"app-chat",33),S()()()),2&r&&(v(3),y("turn",-1))}let gR=(Tu=class{constructor(e,t,n,i){u(this,"router",void 0),u(this,"messageDisplayer",void 0),u(this,"activePartsService",void 0),u(this,"currentGameService",void 0),u(this,"activeParts",[]),u(this,"activePartsSubscription",void 0),u(this,"currentGameSubscription",void 0),u(this,"currentTab","games"),u(this,"createTabClasses",[]),this.router=e,this.messageDisplayer=t,this.activePartsService=n,this.currentGameService=i}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return P(function*(){const n=e.id,i=e.data.typeGame,o=t.currentGameService.canUserJoin(n,null!=e.data.beginning);o.isSuccess()?yield t.router.navigate(["/play",i,n]):t.messageDisplayer.criticalMessage(o.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}},u(Tu,"\u0275fac",function(e){return new(e||Tu)(G(Bn),G(Wt),G(N_t),G(ls))}),u(Tu,"\u0275cmp",Xe({type:Tu,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let r,e,t,n,i,s,o,a;return r=$localize`Games`,e=$localize`Create`,t=$localize`Chat`,n=$localize`Game`,i=$localize`First player`,s=$localize`Second player`,o=$localize`Turn`,a=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],r,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],t,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],n,i,s,o,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],a,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,t){1&e&&(E(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),U("click",function(){return t.selectTab("games")}),oe(4,3),S()(),E(5,"li",4)(6,"a",5),U("click",function(){return t.selectTab("create")}),oe(7,6),S()(),E(8,"li",7)(9,"a",8),U("click",function(){return t.selectTab("chat")}),oe(10,9),S()()()(),T(11,U_t,15,1,"div",10),T(12,W_t,2,0,"div",11),T(13,q_t,4,1,"div",12)),2&e&&(v(6),y("ngClass",t.createTabClasses),v(5),y("ngIf","games"===t.currentTab),v(1),y("ngIf","create"===t.currentTab),v(1),y("ngIf","chat"===t.currentTab))},dependencies:[Ft,Zt,Nt,QC,k3e],encapsulation:2})),Tu);gR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],gR);let j_t=(()=>{var r;class e{constructor(){}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`If you forgot your password or want to change it, click on the following button:`,i=$localize`Reset password`,[[1,"hero-body"],[1,"title"],t,[1,"box"],[1,"block","level-left"],[1,"level-item"],n,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],i]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),oe(2,2),S()(),E(3,"div",3)(4,"p",1),lt(5,"Resetting password"),S(),E(6,"div",4)(7,"p",5),oe(8,6),S(),E(9,"button",7),oe(10,8),S()()())},dependencies:[vc],encapsulation:2})),e})(),x3e=(()=>{var r;class e{constructor(n){u(this,"route",void 0),u(this,"message",void 0),this.route=n,this.message=n.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Is))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"div",1),oe(2,2),S(),E(3,"div",3),lt(4),S()()),2&n&&(v(4),Nn(i.message))},encapsulation:2})),e})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const K_t=new Error("request for lock canceled");class Q_t{constructor(e,t=K_t){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()})}runExclusive(e,t=1){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,s=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(s)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class evt{constructor(e){this._semaphore=new Q_t(1,e)}acquire(){return function(r,e,t,n){return new(t||(t=Promise))(function(s,o){function a(f){try{l(n.next(f))}catch(d){o(d)}}function c(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):function i(s){return s instanceof t?s:new t(function(o){o(s)})}(f.value).then(a,c)}l((n=n.apply(r,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let R3e=(()=>{var r;class e{constructor(){u(this,"requestAwaitingReply",g.empty()),u(this,"lastDeniedRequest",g.empty()),u(this,"forbiddenRequests",new dt)}onGameStart(){this.requestAwaitingReply=g.empty(),this.lastDeniedRequest=g.empty(),this.forbiddenRequests=new dt}onReceivedMove(){this.forbiddenRequests=new dt,this.lastDeniedRequest=g.empty()}onReceivedRequest(n){K.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=g.of(n)}onReceivedReply(n,i){var s=this;return P(function*(){switch(s.requestAwaitingReply=g.empty(),n.reply){case"Accept":return!0;case"Reject":return n.player===i.getOpponent().value&&(s.lastDeniedRequest=g.of(n.requestType),s.forbiddenRequests.add(n.requestType)),!1}})()}canMakeRequest(n){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(n))}getRequestAwaitingReplyFrom(n){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===n.getOpponent().value?g.of(this.requestAwaitingReply.get().requestType):g.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return r=e,u(e,"requestInfos",{TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:Kx},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:Fne},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:M1e}}),u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function z3e(r){return 1e3*r.seconds+r.nanoseconds/1e6}function D3e(r,e){return z3e(e)-z3e(r)}let nvt=(()=>{var r;class e{constructor(){u(this,"turnClocks",void 0),u(this,"globalClocks",void 0),u(this,"allClocks",void 0),u(this,"configRoom",g.empty()),u(this,"takenGlobalTime",[0,0]),u(this,"extraGlobalTime",[0,0]),u(this,"availableTurnTime",[0,0]),u(this,"lastMoveStartTimestamp",g.empty())}setClocks(n,i){this.turnClocks=n,this.globalClocks=i,this.allClocks=n.concat(i)}onGameStart(n){this.configRoom=g.of(n);for(const i of I.PLAYERS)this.takenGlobalTime[i.value]=0,this.extraGlobalTime[i.value]=0,this.availableTurnTime[i.value]=this.getMoveDurationInMs(),this.globalClocks[i.value].setDuration(this.getPartDurationInMs()),this.turnClocks[i.value].setDuration(this.getMoveDurationInMs());for(const i of this.allClocks)i.start(),i.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(n){switch(n.action){case"AddTurnTime":this.addTurnTime(I.of(n.player));break;case"AddGlobalTime":this.addGlobalTime(I.of(n.player));break;case"StartGame":this.lastMoveStartTimestamp=g.of(n.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(n){const i=I.of(n.player),s=n.time,o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.lastMoveStartTimestamp=g.of(s),this.takenGlobalTime[i.value]+=o,this.availableTurnTime[i.value]-=o;const a=i.getOpponent();this.availableTurnTime[a.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[a.value];this.globalClocks[a.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(n){return D3e(this.lastMoveStartTimestamp.get(),n)}onGameEnd(){for(const n of this.allClocks)n.isStarted()&&n.stop();this.updateClocks()}beforeEventsBatch(n){!1===n&&this.pauseAllClocks()}afterEventsBatch(n,i,s){if(this.updateClocks(),!1===n){const o=this.getMillisecondsElapsedSinceLastMoveStart(s);this.turnClocks[i.value].subtract(o),this.globalClocks[i.value].subtract(o),this.resumeClocks(i)}}resumeClocks(n){this.turnClocks[n.value].resume(),this.globalClocks[n.value].resume()}addTurnTime(n){this.availableTurnTime[n.getOpponent().value]+=3e4}addGlobalTime(n){this.extraGlobalTime[n.getOpponent().value]+=3e5}updateClocks(){for(const n of I.PLAYERS){this.turnClocks[n.value].changeDuration(this.availableTurnTime[n.value]);const i=this.getPartDurationInMs()+this.extraGlobalTime[n.value]-this.takenGlobalTime[n.value];this.globalClocks[n.value].changeDuration(i)}}pauseAllClocks(){for(const n of this.allClocks)!1===n.isIdle()&&n.pause()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function Zd(r){return Wr((e,t)=>{Ws(r).subscribe(dr(t,()=>t.complete(),ys)),!t.closed&&e.subscribe(t)})}let rvt=(()=>{var r;class e{transform(n){const i=n%60,s=(n-i)%3600/60,o=(n-60*s-i)/3600,a=[];if(o>1?a.push($localize`${o} hours`):1===o&&a.push($localize`1 hour`),s>1?a.push($localize`${s} minutes`):1===s&&a.push($localize`1 minute`),i>1?a.push($localize`${i} seconds`):1===i&&a.push($localize`1 second`),0===a.length)return $localize`0 seconds`;if(1===a.length)return a[0];{const c=a.slice(0,-1).join(", "),l=a.slice(-1)[0];return $localize`${c} and ${l}`}}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275pipe",yi({name:"humanDuration",type:r,pure:!0})),e})();var g4,Ou;function svt(r,e){if(1&r&&(Bt(0),lt(1),Gt()),2&r){const t=p(3);v(1),Nn(t.viewInfo.chosenOpponent)}}function ovt(r,e){1&r&&oe(0,44)}function avt(r,e){if(1&r&&(E(0,"div",45)(1,"div",8)(2,"label",46),Bt(3),oe(4,47),Gt(),E(5,"output"),lt(6),ha(7,"humanDuration"),S()(),E(8,"div",37),F(9,"input",48),S()(),E(10,"div",8)(11,"label",49),ws(12,50),F(13,"output"),ha(14,"humanDuration"),Ns(),S(),E(15,"div",37),F(16,"input",51),S()()()),2&r){const t=p(3);v(6),Nn(fc(7,2,t.viewInfo.maximalMoveDuration||0)),v(8),$n(fc(14,4,t.viewInfo.totalPartDuration||0)),qn(12)}}function cvt(r,e){1&r&&(E(0,"div"),ws(1,52),F(2,"br"),Ns(),S())}function lvt(r,e){1&r&&(E(0,"button",64),oe(1,65),S())}function uvt(r,e){if(1&r){const t=pe();E(0,"tr",60),U("click",function(){const s=te(t).$implicit;return ne(p(4).selectOpponent(s))}),E(1,"td",61),lt(2),S(),E(3,"td",62),T(4,lvt,2,0,"button",63),S()()}if(2&r){const t=e.$implicit,n=p(4);Rn("id","presenceOf_",t,""),y("ngClass",n.viewInfo.candidateClasses[t]),v(1),y("id",n.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),v(1),Nn(t),v(2),y("ngIf",n.viewInfo.chosenOpponent!==t)}}function fvt(r,e){if(1&r&&(Bt(0),oe(1,53),Gt(),E(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),oe(7,57),S(),E(8,"th",56),oe(9,58),S()()(),E(10,"tbody"),T(11,uvt,5,5,"tr",59),S()()()),2&r){const t=p(3);v(11),y("ngForOf",t.viewInfo.candidates)}}function dvt(r,e){if(1&r){const t=pe();E(0,"button",66),U("click",function(){return te(t),ne(p(3).changeConfig())}),oe(1,67),S()}}function hvt(r,e){if(1&r){const t=pe();E(0,"div")(1,"h1",4),oe(2,5),S(),E(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),oe(7,10),S(),E(8,"div",11)(9,"button",12),U("click",function(){return te(t),ne(p(2).selectFirstPlayer("RANDOM"))}),oe(10,13),S(),E(11,"button",14),U("click",function(){return te(t),ne(p(2).selectFirstPlayer("CREATOR"))}),oe(12,15),S(),E(13,"button",16),U("click",function(){return te(t),ne(p(2).selectFirstPlayer("CHOSEN_PLAYER"))}),T(14,svt,2,1,"ng-container",17),T(15,ovt,1,0,"ng-template",null,18,dn),S()()(),E(17,"div",8)(18,"label",9),oe(19,19),S(),E(20,"div",11)(21,"div",20),U("click",function(){return te(t),ne(p(2).selectPartType("STANDARD"))}),E(22,"div",21)(23,"span"),oe(24,22),S()(),E(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),Bt(29),oe(30,26),Gt(),E(31,"strong"),lt(32),ha(33,"humanDuration"),S(),F(34,"br"),Bt(35),ws(36,27),F(37,"strong"),ha(38,"humanDuration"),Ns(),Gt(),S()()()()(),E(39,"div",28),U("click",function(){return te(t),ne(p(2).selectPartType("BLITZ"))}),E(40,"div",21)(41,"span"),oe(42,29),S()(),E(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),Bt(47),oe(48,30),Gt(),E(49,"strong"),lt(50),ha(51,"humanDuration"),S(),F(52,"br"),Bt(53),ws(54,31),F(55,"strong"),ha(56,"humanDuration"),Ns(),Gt(),S()()()()(),E(57,"button",32),U("click",function(){return te(t),ne(p(2).selectPartType("CUSTOM"))}),oe(58,33),S()()(),T(59,avt,17,6,"div",34),E(60,"div",8)(61,"label",35),oe(62,36),S(),E(63,"div",37),T(64,cvt,3,0,"div",17),T(65,fvt,12,1,"ng-template",null,38,dn),S()()(),E(67,"div",8)(68,"div",11)(69,"button",39),U("click",function(){return te(t),ne(p(2).proposeConfig())}),oe(70,40),S(),T(71,dvt,2,0,"button",41),E(72,"button",42),U("click",function(){return te(t),ne(p(2).cancelGameCreation())}),oe(73,43),S()()()()()}if(2&r){const t=ln(16),n=ln(66),i=p(2);v(3),y("formGroup",i.configFormGroup),v(1),y("disabled",!i.viewInfo.canEditConfig),v(5),y("ngClass",i.viewInfo.firstPlayerClasses.RANDOM),v(2),y("ngClass",i.viewInfo.firstPlayerClasses.CREATOR),v(2),y("ngClass",i.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),v(1),y("ngIf",i.viewInfo.chosenOpponent)("ngIfElse",t),v(7),y("ngClass",i.viewInfo.partTypeClasses.STANDARD),v(11),Nn(fc(33,19,i.partType.NORMAL_MOVE_DURATION)),v(6),$n(fc(38,21,i.partType.NORMAL_PART_DURATION)),qn(36),v(1),y("ngClass",i.viewInfo.partTypeClasses.BLITZ),v(11),Nn(fc(51,23,i.partType.BLITZ_MOVE_DURATION)),v(6),$n(fc(56,25,i.partType.BLITZ_PART_DURATION)),qn(54),v(1),y("ngClass",i.viewInfo.partTypeClasses.CUSTOM),v(2),y("ngIf",i.viewInfo.showCustomTime),v(5),y("ngIf",0===i.viewInfo.candidates.length)("ngIfElse",n),v(5),y("disabled",!i.viewInfo.canProposeConfig),v(2),y("ngIf",i.viewInfo.canReviewConfig)}}function pvt(r,e){if(1&r&&(E(0,"div",74)(1,"p"),ws(2,75),F(3,"br"),Ns(),S()()),2&r){const t=p(3);v(3),$n(t.viewInfo.creator),qn(2)}}function gvt(r,e){if(1&r&&(E(0,"span"),oe(1,81),S()),2&r){const t=p(4);v(1),$n(t.viewInfo.creator),qn(1)}}function mvt(r,e){1&r&&(E(0,"span"),oe(1,82),S())}function _vt(r,e){1&r&&(E(0,"span"),oe(1,83),S())}function vvt(r,e){if(1&r){const t=pe();E(0,"div",74)(1,"p"),oe(2,76),S(),E(3,"ul")(4,"li"),T(5,gvt,2,1,"span",2),T(6,mvt,2,0,"span",2),T(7,_vt,2,0,"span",2),S(),E(8,"li"),ws(9,77),F(10,"strong"),ha(11,"humanDuration"),Ns(),S(),E(12,"li"),ws(13,78),F(14,"strong"),ha(15,"humanDuration"),Ns(),S()(),E(16,"button",79),U("click",function(){return te(t),ne(p(3).acceptConfig())}),oe(17,80),S()()}if(2&r){const t=p(3);v(2),$n(t.viewInfo.creator)(t.viewInfo.partTypeName),qn(2),v(3),y("ngIf","CREATOR"===t.viewInfo.firstPlayer),v(1),y("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),v(1),y("ngIf","RANDOM"===t.viewInfo.firstPlayer),v(4),$n(fc(11,7,t.viewInfo.maximalMoveDuration||0)),qn(9),v(4),$n(fc(15,9,t.viewInfo.totalPartDuration||0)),qn(13)}}function Cvt(r,e){if(1&r&&(E(0,"div")(1,"div",68)(2,"div",69)(3,"p"),oe(4,70),S()(),E(5,"div",71),T(6,pvt,4,1,"div",72),T(7,vvt,18,11,"ng-template",null,73,dn),S()()()),2&r){const t=ln(8),n=p(2);v(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function yvt(r,e){if(1&r&&(Bt(0),oe(1,86),Gt()),2&r){const t=p(3);v(1),$n(t.viewInfo.creator),qn(1)}}function Mvt(r,e){if(1&r&&oe(0,87),2&r){const t=p(3);$n(t.viewInfo.creator)(t.viewInfo.chosenOpponent),qn(0)}}function Evt(r,e){if(1&r&&(E(0,"div",68)(1,"div",69)(2,"p"),oe(3,84),S()(),E(4,"div",71)(5,"p"),T(6,yvt,2,1,"ng-container",17),T(7,Mvt,1,2,"ng-template",null,85,dn),S()()()),2&r){const t=ln(8),n=p(2);v(6),y("ngIf",n.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function Svt(r,e){if(1&r&&(E(0,"div",1),T(1,hvt,74,27,"div",2),T(2,Cvt,9,2,"div",2),T(3,Evt,9,2,"div",3),S()),2&r){const t=p();v(1),y("ngIf",t.viewInfo.userIsCreator),v(1),y("ngIf",t.viewInfo.userIsChosenOpponent),v(1),y("ngIf",t.viewInfo.userIsObserver)}}let mR=(Ou=g4=class{constructor(e,t,n,i,s,o,a,c,l,f){u(this,"router",void 0),u(this,"actRoute",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"gameService",void 0),u(this,"configRoomService",void 0),u(this,"chatService",void 0),u(this,"userService",void 0),u(this,"formBuilder",void 0),u(this,"messageDisplayer",void 0),u(this,"partType",or),u(this,"partId",void 0),u(this,"gameStartNotification",new b1),u(this,"gameStarted",!1),u(this,"viewInfo",{userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]}),u(this,"currentConfigRoom",null),u(this,"candidates",[]),u(this,"ngUnsubscribe",new Ms),u(this,"allUserInterval",g.empty()),u(this,"ownTokenInterval",g.empty()),u(this,"lastToken",void 0),u(this,"selfSubscription",new En),u(this,"configRoomSubscription",new En),u(this,"candidatesSubscription",new En),u(this,"configFormGroup",void 0),u(this,"allDocDeleted",!1),this.router=e,this.actRoute=t,this.connectedUserService=n,this.currentGameService=i,this.gameService=s,this.configRoomService=o,this.chatService=a,this.userService=c,this.formBuilder=l,this.messageDisplayer=f}ngOnInit(){var e=this;return P(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const n=t.getReason();e.messageDisplayer.criticalMessage(n)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;Ve(e.isPresent(),"PartCreationComponent should not be called without connected user"),Ve(e.get()!==u0.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),Ve(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[x2.RANDOM.value,$7.required],maximalMoveDuration:[or.NORMAL_MOVE_DURATION,$7.required],partType:["STANDARD",$7.required],totalPartDuration:[or.NORMAL_PART_DURATION,$7.required],chosenOpponent:["",$7.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),n={id:this.partId,opponent:this.getOpponent(),typeGame:K.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:t};return this.currentGameService.updateCurrentGame(n)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let e=null;return e=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:K.getNonNullable(this.currentConfigRoom?.creator),e}subscribeToConfigRoomDoc(){var e=this;const t=function(){var i=P(function*(s){yield e.onCurrentConfigRoomUpdate(s)});return function(o){return i.apply(this,arguments)}}(),n=function(){var i=P(function*(s){yield e.onCandidatesUpdate(s)});return function(o){return i.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,n)}getForm(e){return K.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Zd(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=K.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==ai.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(Zd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(Zd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(Zd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(Zd(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=K.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===ai.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==ai.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==ai.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(n=>n.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(i=>i.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(or.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(or.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(or.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(or.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return P(function*(){const n=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:n}),t.configRoomService.setChosenOpponent(t.partId,n)])})()}getUserFromName(e){const t=this.candidates.find(n=>n.name===e);return K.getNonNullable(t)}changeConfig(){var e=this;return P(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return P(function*(){const t=e.getForm("chosenOpponent").value,n=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,s=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,a=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,a,or.of(n),i,x2.of(s),o)})()}cancelGameCreation(){var e=this;return P(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),we.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),we.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),we.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),we.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return P(function*(){if(e.isAbsent())return we.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const n=e.get();if(t.chosenOpponentJustLeft(n)&&t.userIsCreator(n)){const s=K.getNonNullable(t.currentConfigRoom),o=K.getNonNullable(s.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}let i=!1;t.userJustChosenAsOpponent(n)&&(yield t.updateUserDocWithCurrentGame(n),i=!0),t.currentConfigRoom=n,t.allUserInterval.isAbsent()&&(Ve(!1===i,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield t.updateUserDocWithCurrentGame(t.currentConfigRoom),yield t.observeNeededPlayers()),t.updateViewInfo(),t.isGameStarted(t.currentConfigRoom)&&(we.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return P(function*(){t.candidates=e,t.updateViewInfo()})()}userJustChosenAsOpponent(e){if(this.isGameStarted(e))return!1;const t=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==t&&e.chosenOpponent?.id===t}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var e=this;return P(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return Ve(null!=e,"configRoom should not be null (isGameStarted)"),K.getNonNullable(e).partStatus===ai.PART_STARTED.value}onGameStarted(){const e=K.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(){var e=this;return P(function*(){const t=K.getNonNullable(e.currentConfigRoom);Ve(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=g.of(window.setInterval(P(function*(){const n=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(n):yield e.checkCreatorTokenFreshness(n)}),Ou.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return P(function*(){const n=K.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(n.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return P(function*(){Ve(!1===e.isGameStarted(e.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),Ve(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return P(function*(){for(const n of t.candidates)(yield t.didUserTimeout(n.id,e))&&(yield t.removeCandidateFromLobby(n))})()}didUserTimeout(e,t){var n=this;return P(function*(){const i=yield n.userService.getUserLastUpdateTime(e);return i.isAbsent()?(c2.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):D3e(i.get(),t)>Ou.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return P(function*(){const n=K.getNonNullable(t.currentConfigRoom);return e.id===n.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return P(function*(){yield e.connectedUserService.sendPresenceToken(),Ve(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=g.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},Ou.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,n=>{Ve(n.isPresent(),"connected user should exist"),e.lastToken=K.getNonNullable(n.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=g.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,K.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return P(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?we.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?we.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(we.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(we.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}},u(g4,"TOKEN_INTERVAL",5e3),u(g4,"TOKEN_TIMEOUT",2*Ou.TOKEN_INTERVAL),u(g4,"\u0275fac",function(e){return new(e||g4)(G(Bn),G(Is),G(sr),G(ls),G(G5),G(nd),G(F5),G($5),G(yge),G(Wt))}),u(g4,"\u0275cmp",Xe({type:g4,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,M,w,L,z,$,B,de,_e,xe,nt,gt,yn,Et,W2,k0,Rl,Qc,Qd,Jd,ft,Ot,xt,wn;return r=$localize`Game creation`,e=$localize`First player`,t=$localize`Random`,n=$localize`You`,i=$localize`Game type`,s=$localize`Standard`,o=$localize`Maximal turn duration: `,a=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,c=$localize`Blitz`,l=$localize`Maximal turn duration: `,f=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,d=$localize`Custom`,m=$localize`Opponents`,M=$localize`Propose configuration`,w=$localize`Cancel game`,L=$localize`The opponent`,z=$localize`Maximal turn duration: `,$=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,B=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,de=$localize`Click on the opponent against which you would like to play.`,_e=$localize`Name`,xe=$localize`Actions`,nt=$localize`Pick`,gt=$localize`Change configuration`,yn=$localize`Configuration proposal`,Et=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,W2=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,k0=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Rl=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,Qc=$localize`Accept and start`,Qd=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,Jd=$localize`you play first`,ft=$localize`the first player is selected randomly`,Ot=$localize`One moment...`,xt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,wn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],r,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],t,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],n,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],i,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],s,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,a,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],c,l,f,["id","partTypeCustom",1,"button",3,"ngClass","click"],d,["id","customTime",4,"ngIf"],[1,"label"],m,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],M,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],w,L,["id","customTime"],["for","maximalMoveDuration",1,"label"],z,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],B,de,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],_e,xe,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],nt,["id","reviewConfig",1,"button",3,"click"],gt,[1,"message","is-primary"],[1,"message-header"],yn,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],Et,W2,k0,Rl,["id","acceptConfig",1,"button","is-primary",3,"click"],Qc,Qd,Jd,ft,Ot,["proposalSent",""],xt,wn]},template:function(e,t){1&e&&T(0,Svt,4,3,"div",0),2&e&&y("ngIf",t.viewInfo)},dependencies:[Ft,Zt,Nt,f6,pc,fg,M3,l6,d6,k8,rvt],encapsulation:2})),g4);var Za,I0;function Tvt(r,e){if(1&r){const t=pe();E(0,"button",3),U("click",function(){return te(t),ne(p().addTime())}),oe(1,4),S()}if(2&r){const t=p();v(1),$n(t.timeToAdd),qn(1)}}mR=Ou=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],mR);let _R=(I0=Za=class{constructor(){u(this,"debugName",void 0),u(this,"timeToAdd",void 0),u(this,"dangerTimeLimit",void 0),u(this,"active",void 0),u(this,"canAddTime",void 0),u(this,"remainingMs",void 0),u(this,"displayedSec",void 0),u(this,"displayedMinute",void 0),u(this,"timeoutHandleGlobal",null),u(this,"timeoutHandleSec",null),u(this,"isPaused",!0),u(this,"isSet",!1),u(this,"started",!1),u(this,"startTime",void 0),u(this,"outOfTimeAction",new b1),u(this,"addTimeToOpponent",new b1),u(this,"cssClasses",I0.SAFE_TIME)}setDuration(e){K.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){K.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){K.assert(this.isSet,"Should not start a chrono that has not been set!"),K.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){K.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){K.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),K.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){K.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?I0.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?I0.DANGER_TIME_ODD:I0.DANGER_TIME_EVEN:I0.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}},u(Za,"DANGER_TIME_EVEN","has-background-danger has-text-white"),u(Za,"DANGER_TIME_ODD","has-background-warning has-text-white"),u(Za,"PASSIVE_STYLE","has-text-passive is-italic"),u(Za,"SAFE_TIME",""),u(Za,"\u0275fac",function(e){return new(e||Za)}),u(Za,"\u0275cmp",Xe({type:Za,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let r;return r=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],r]},template:function(e,t){1&e&&(E(0,"div",0)(1,"p",1),lt(2),ha(3,"number"),S(),T(4,Tvt,2,1,"button",2),S()),2&e&&(y("ngClass",t.getTimeClass()),v(2),lE("",t.displayedMinute,":",JF(3,4,t.displayedSec,"2.0-0"),""),v(2),y("ngIf",t.canAddTime))},dependencies:[Ft,Nt,DB],encapsulation:2})),Za);var bu;_R=I0=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],_R);const bvt=["chronoZeroGlobal"],wvt=["chronoOneGlobal"],Nvt=["chronoZeroTurn"],Avt=["chronoOneTurn"];function Ivt(r,e){if(1&r){const t=pe();E(0,"app-part-creation",5,6),U("gameStartNotification",function(i){return te(t),ne(p().startGame(i))}),S()}2&r&&y("partId",p().currentPartId)}function kvt(r,e){1&r&&(Bt(0),E(1,"span",39),oe(2,40),S(),Gt())}function xvt(r,e){if(1&r&&(E(0,"span",41),oe(1,42),S()),2&r){const t=p(4);v(1),$n(null==t.currentPlayer?null:t.currentPlayer.name),qn(1)}}function Lvt(r,e){if(1&r&&(E(0,"p",36),T(1,kvt,3,0,"ng-container",37),T(2,xvt,2,1,"ng-template",null,38,dn),S()),2&r){const t=ln(3),n=p(3);v(1),y("ngIf",(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name)("ngIfElse",t)}}function Rvt(r,e){if(1&r&&(E(0,"div",32)(1,"p",33),oe(2,34),S(),T(3,Lvt,4,2,"p",35),S()),2&r){const t=p(2);v(2),$n(t.currentPart.getTurn()+1),qn(2),v(1),y("ngIf",!1===t.endGame)}}function zvt(r,e){if(1&r&&(E(0,"p",43),lt(1),S()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ZERO)),v(1),Nn(t.players[0].get().name)}}function Dvt(r,e){if(1&r&&(E(0,"p",44),oe(1,45),S()),2&r){const t=p(2);v(1),$n(t.gameComponent.scores.get()[0]),qn(1)}}function Hvt(r,e){if(1&r&&(E(0,"p",46),lt(1),S()),2&r){const t=p(2);y("ngClass",t.getPlayerNameClass(t.Player.ONE)),v(1),Nn(t.players[1].get().name)}}function Vvt(r,e){if(1&r&&(E(0,"p",47),oe(1,48),S()),2&r){const t=p(2);v(1),$n(t.gameComponent.scores.get()[1]),qn(1)}}function Fvt(r,e){1&r&&(E(0,"div")(1,"p",50),oe(2,51),S()())}function $vt(r,e){1&r&&(E(0,"p",55),oe(1,56),S())}function Bvt(r,e){1&r&&(E(0,"p",57),oe(1,58),S())}function Gvt(r,e){1&r&&(E(0,"p",59),oe(1,60),S())}function Uvt(r,e){if(1&r&&(E(0,"div"),T(1,$vt,2,0,"p",52),T(2,Bvt,2,0,"p",53),T(3,Gvt,2,0,"p",54),S()),2&r){const t=p(3);v(1),y("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),v(1),y("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),v(1),y("ngIf",!1===t.isPlaying())}}function Wvt(r,e){1&r&&(E(0,"p",64),oe(1,65),S())}function qvt(r,e){1&r&&(E(0,"p",66),oe(1,67),S())}function jvt(r,e){if(1&r&&(E(0,"p",68),oe(1,69),S()),2&r){const t=p(4);v(1),$n(t.currentPart.getWinner().get().name),qn(1)}}function Zvt(r,e){if(1&r&&(E(0,"div"),T(1,Wvt,2,0,"p",61),T(2,qvt,2,0,"p",62),T(3,jvt,2,1,"p",63),S()),2&r){const t=p(3);v(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),v(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),v(1),y("ngIf",!1===t.isPlaying())}}function Yvt(r,e){if(1&r&&(E(0,"p",64),oe(1,70),S()),2&r){const t=p(4);v(1),$n(t.currentPart.getLoser().get().name),qn(1)}}function Kvt(r,e){1&r&&(E(0,"p",68),oe(1,71),S())}function Xvt(r,e){if(1&r&&(E(0,"p",68),oe(1,72),S()),2&r){const t=p(4);v(1),$n(t.currentPart.getLoser().get().name),qn(1)}}function Qvt(r,e){if(1&r&&(E(0,"div"),T(1,Yvt,2,1,"p",61),T(2,Kvt,2,0,"p",63),T(3,Xvt,2,1,"p",63),S()),2&r){const t=p(3);v(1),y("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),v(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),v(1),y("ngIf",!1===t.isPlaying())}}function Jvt(r,e){1&r&&(E(0,"p",74),oe(1,75),S())}function eCt(r,e){if(1&r&&(E(0,"p",74),oe(1,76),S()),2&r){const t=p(4);v(1),$n(t.currentPart.getLoser().get().name),qn(1)}}function tCt(r,e){if(1&r&&(E(0,"div"),T(1,Jvt,2,0,"p",73),T(2,eCt,2,1,"p",73),S()),2&r){const t=p(3);v(1),y("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),v(1),y("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function nCt(r,e){if(1&r&&(E(0,"div",49),F(1,"hr"),T(2,Fvt,3,0,"div",27),T(3,Uvt,4,3,"div",27),T(4,Zvt,4,3,"div",27),T(5,Qvt,4,3,"div",27),T(6,tCt,3,2,"div",27),S()),2&r){const t=p(2);v(2),y("ngIf",t.currentPart.isHardDraw()),v(1),y("ngIf",t.currentPart.isAgreedDraw()),v(1),y("ngIf",t.currentPart.isWin()),v(1),y("ngIf",t.currentPart.isTimeout()),v(1),y("ngIf",t.currentPart.isResign())}}function rCt(r,e){if(1&r){const t=pe();Bt(0),E(1,"button",85),U("click",function(){const s=te(t).$implicit;return ne(p(4).propose(s))}),lt(2),F(3,"fa-icon",86),S(),Gt()}if(2&r){const t=e.$implicit,n=p(4);v(1),Rn("id","propose",t,""),y("disabled",!1===n.requestAvailable(t)),v(1),S2("",n.requestInfos[t].textForRequest(),"\xa0\xa0"),v(1),y("icon",n.requestInfos[t].icon)}}function iCt(r,e){if(1&r){const t=pe();Bt(0),E(1,"button",80),U("click",function(){return te(t),ne(p(3).resign())}),oe(2,81),S(),E(3,"button",82),U("click",function(){return te(t),ne(p(3).gameComponent.pass())}),oe(4,83),S(),T(5,rCt,4,4,"ng-container",84),Gt()}if(2&r){const t=p(3);v(1),y("disabled",!1===t.canResign()),v(2),y("disabled",!1===t.canPass()),v(2),y("ngForOf",t.allRequests)}}function sCt(r,e){if(1&r){const t=pe();E(0,"div",87)(1,"p"),lt(2),F(3,"fa-icon",86),S(),E(4,"button",88),U("click",function(){return te(t),ne(p(3).accept())}),oe(5,89),S(),E(6,"button",90),U("click",function(){return te(t),ne(p(3).reject())}),oe(7,91),S()()}if(2&r){const t=p(3);v(2),S2(" ",t.requestInfos[t.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),v(1),y("icon",t.requestInfos[t.requestAwaitingReplyFromUs().get()].icon)}}function oCt(r,e){if(1&r&&(E(0,"div",92)(1,"p")(2,"span"),ws(3,93),F(4,"fa-icon",86),Ns(),S()()()),2&r){const t=p(3);v(4),y("icon",t.requestInfos[t.deniedRequest().get()].icon),$n(t.requestInfos[t.deniedRequest().get()].name()),qn(3)}}function aCt(r,e){if(1&r&&(E(0,"div",94)(1,"p")(2,"span"),ws(3,95),F(4,"fa-icon",86),Ns(),S()()()),2&r){const t=p(3);v(4),y("icon",t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].icon),$n(t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].name()),qn(3)}}function cCt(r,e){if(1&r&&(Bt(0),T(1,iCt,6,3,"ng-container",37),T(2,sCt,8,2,"ng-template",null,77,dn),T(4,oCt,5,2,"div",78),T(5,aCt,5,2,"div",79),Gt()),2&r){const t=ln(3),n=p(2);v(1),y("ngIf",!1===n.mustReply())("ngIfElse",t),v(3),y("ngIf",n.deniedRequest().isPresent()),v(1),y("ngIf",n.requestAwaitingReplyFromOpponent().isPresent())}}function lCt(r,e){1&r&&(E(0,"button",96),oe(1,97),S())}function uCt(r,e){if(1&r){const t=pe();E(0,"div",7)(1,"div",8)(2,"div",9),T(3,Rvt,4,2,"div",10),E(4,"div",11),T(5,zvt,2,2,"p",12),T(6,Dvt,2,1,"p",13),E(7,"app-count-down",14,15),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),S(),E(9,"app-count-down",16,17),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ZERO))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),S()(),E(11,"p",18),oe(12,19),S(),E(13,"div",11),T(14,Hvt,2,2,"p",20),T(15,Vvt,2,1,"p",21),E(16,"app-count-down",22,23),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addGlobalTime())}),S(),E(18,"app-count-down",24,25),U("outOfTimeAction",function(){te(t);const i=p();return ne(i.reachedOutOfTime(i.Player.ONE))})("addTimeToOpponent",function(){return te(t),ne(p().addTurnTime())}),S()(),F(20,"hr"),T(21,nCt,7,5,"div",26),T(22,cCt,6,4,"ng-container",27),T(23,lCt,2,0,"button",28),S()(),E(24,"div",29)(25,"div",30),F(26,"div",null,31),S()()()}if(2&r){const t=p();v(3),y("ngIf",null!==t.currentPart),v(2),y("ngIf",t.players[0].isPresent()),v(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),v(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),v(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),v(5),y("ngIf",t.players[1].isPresent()),v(1),y("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),v(1),y("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),v(2),y("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),v(3),y("ngIf",t.endGame&&null!==t.currentPart),v(1),y("ngIf",t.isPlaying()),v(1),y("ngIf",t.endGame),v(1),y("ngClass",t.getBoardHighlight())}}let fCt=(()=>{class r{}return u(r,"NO_MATCHING_PART",()=>$localize`The game you tried to join does not exist.`),r})(),vR=(bu=class extends XC{constructor(e,t,n,i,s,o,a,c,l,f){super(e,t,n,i),u(this,"currentGameService",void 0),u(this,"userService",void 0),u(this,"gameService",void 0),u(this,"gameEventService",void 0),u(this,"timeManager",void 0),u(this,"requestManager",void 0),u(this,"chronoZeroGlobal",void 0),u(this,"chronoOneGlobal",void 0),u(this,"chronoZeroTurn",void 0),u(this,"chronoOneTurn",void 0),u(this,"currentPart",null),u(this,"currentPartId",void 0),u(this,"gameStarted",!1),u(this,"opponent",null),u(this,"authUser",void 0),u(this,"currentPlayer",null),u(this,"configRoom",void 0),u(this,"currentGame",g.empty()),u(this,"userLinkedToThisPart",!0),u(this,"routerEventsSubscription",void 0),u(this,"userSubscription",void 0),u(this,"opponentSubscription",new En),u(this,"partSubscription",new En),u(this,"gameEventsSubscription",new En),u(this,"currentGameSubscription",new En),u(this,"OFFLINE_FONT_COLOR",{color:"lightgrey"}),u(this,"globalTimeMessage",$localize`5 minutes`),u(this,"turnTimeMessage",$localize`30 seconds`),u(this,"requestInfos",R3e.requestInfos),u(this,"allRequests",["TakeBack","Draw","Rematch"]),this.currentGameService=s,this.userService=o,this.gameService=a,this.gameEventService=c,this.timeManager=l,this.requestManager=f}extractPartIdFromURL(){return K.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return K.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return P(function*(){const t=e.extractGameNameFromURL();if(Su.ALL_GAMES().some(i=>i.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const s=fCt.NO_MATCHING_PART();yield e.router.navigate(["/notFound",s],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=A0.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return P(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=P(function*(n){n instanceof z4&&(yield e.setCurrentPartIdOrRedirect())});return function(n){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=P(function*(n){yield e.onCurrentGameUpdate(n)});return function(n){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return P(function*(){if(e.isPresent()){const n=e.get();"Observer"===n.role||n.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=g.empty()})()}startGame(e){var t=this;return P(function*(){K.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(P(function*(){const n=yield t.afterViewInit();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),K.assert(n,"Game should be created successfully, otherwise part-creation would have redirected"),yield t.startPart()}),2)})()}startPart(){var e=this;return P(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new lv(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var n=P(function*(i){K.assert(i.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new lv(e.currentPartId,i.get())});return function(i){return n.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return P(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();K.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new evt,n=function(){var i=P(function*(s){yield t.runExclusive(P(function*(){e.beforeEventsBatch();for(const o of s)switch(o.eventType){case"Move":const a=o;yield e.onReceivedMove(a);break;case"Request":e.requestManager.onReceivedRequest(o);break;case"Reply":const l=o;(yield e.requestManager.onReceivedReply(l,e.role))&&(yield e.handleReply(l));break;default:K.expectToBe(o.eventType,"Action","Event should be an action");const d=o;e.timeManager.onReceivedAction(d),"EndGame"===d.action?yield e.onGameEnd():"StartGame"===d.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(o){return i.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,n)}handleReply(e){var t=this;return P(function*(){switch(e.requestType){case"TakeBack":const n=I.of(e.player);t.takeBackToPreviousPlayerTurn(n.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const i=t.extractGameNameFromURL();yield t.router.navigate(["/play",i,e.data])}})()}onGameEnd(){var e=this;return P(function*(){yield e.currentGameService.removeCurrentGame(),e.endGame=!0})()}onReceivedMove(e){var t=this;return P(function*(){const n=t.gameComponent.rules,i=t.gameComponent.getTurn(),s=t.gameComponent.encoder.decode(e.move),o=n.isLegal(s,t.gameComponent.getState()),a="We received an incorrect db move: "+s.toString()+" at turn "+i+'because "'+o.getReasonOr("")+'"';K.assert(o.isSuccess(),a);const c=n.choose(t.gameComponent.node,s);K.assert(c.isPresent(),"Chosen move should be legal after all checks, but it is not!"),t.gameComponent.node=c.get(),t.updateBoardAndShowLastMove(),t.currentPlayer=t.players[t.gameComponent.getTurn()%2].get(),t.timeManager.onReceivedMove(e),t.requestManager.onReceivedMove()})()}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return P(function*(){const t=I.ofTurn(e.gameComponent.getTurn()),n=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,n)})()}takeBackToPreviousPlayerTurn(e){this.gameComponent.node=this.gameComponent.node.mother.get(),this.gameComponent.getCurrentPlayer()!==e&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.updateBoardAndShowLastMove()}canResign(){return K.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return K.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return K.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return K.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return K.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return K.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),K.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||K.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return K.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var t=this;return P(function*(){t.players=[g.of(e.data.playerZero),g.ofNullable(e.data.playerOne)],K.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.currentPlayer=t.players[e.data.turn%2].get();const n=yield t.setRealObserverRole();if(n.isPresent()){const i=s=>{K.assert(s.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=n.get()};t.opponentSubscription=t.userService.observeUserOnServer(n.get().id,i)}})()}setRealObserverRole(){var e=this;return P(function*(){let t=g.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(I.ZERO),t=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(I.ONE),t=e.players[0]):e.setRole(X.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===X.NONE?"Observer":"Player"}),t})()}onLegalUserMove(e){var t=this;return P(function*(){if(!t.mustReply()){const n=t.gameComponent.rules.isLegal(e,t.gameComponent.node.gameState);K.assert(n.isSuccess(),"onLegalUserMove called with an illegal move");const i=t.gameComponent.rules.applyLegalMove(e,t.gameComponent.node.gameState,n.get()),s=new zi(i,g.of(t.gameComponent.node),g.of(e)),o=t.gameComponent.rules.getGameStatus(s),a=t.gameComponent.encoder.encode(e);return yield t.gameService.addMove(t.currentPartId,t.role,a),t.updatePartWithStatusAndScores(o,t.gameComponent.scores)}t.gameComponent.message(A0.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,t){var n=this;return P(function*(){return e.isEndGame?e===ve.DRAW?yield n.gameService.drawPart(n.currentPartId,n.role,t):(K.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),n.notifyVictory(e.winner,t)):n.gameService.updatePart(n.currentPartId,t)})()}notifyTimeoutVictory(e,t){var n=this;return P(function*(){const i=n.role;yield n.gameService.notifyTimeout(n.currentPartId,i,e,t)})()}notifyVictory(e,t){var n=this;return P(function*(){const i=K.getNonNullable(n.currentPart),s=n.players[0].get(),o=n.players[1].get();n.currentPart=e===I.ONE?i.setWinnerAndLoser(o,s):i.setWinnerAndLoser(s,o);const a=n.role;yield n.gameService.endPartWithVictory(n.currentPartId,a,n.currentPart.getWinner().get(),n.currentPart.getLoser().get(),t)})()}resign(){var e=this;return P(function*(){const t=e.role,n=e.getPlayer(),i=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,t,i,n)})()}reachedOutOfTime(e){var t=this;return P(function*(){if(!1===t.isPlaying())return;const n=K.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(n,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),n)})()}propose(e){var t=this;return P(function*(){K.assert(t.role.isPlayer(),"cannot propose request if not player");const n=t.role;switch(e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId,n);case"Draw":return t.gameService.proposeDraw(t.currentPartId,n);default:return K.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId,n)}})()}accept(){var e=this;return P(function*(){K.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,n=K.getNonNullable(e.currentPart),i=e.requestManager.getCurrentRequest().get().requestType;switch(i){case"Rematch":return e.gameService.acceptRematch(n,t);case"Draw":return e.gameService.acceptDraw(n.id,t);default:return K.expectToBe(i,"TakeBack"),e.gameService.acceptTakeBack(n.id,n.data.turn,t)}})()}reject(){var e=this;return P(function*(){K.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.role,n=e.requestManager.getCurrentRequest().get().requestType;switch(n){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,t);case"Draw":return e.gameService.refuseDraw(e.currentPartId,t);default:return K.expectToBe(n,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,t)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===I.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const t=this.gameComponent.node.move.get();this.gameComponent.showLastMove(t)}}ngOnDestroy(){var e=this;return P(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}},u(bu,"\u0275fac",function(e){return new(e||bu)(G(Is),G(sr),G(Bn),G(Wt),G(ls),G($5),G(G5),G(qk),G(nvt),G(R3e))}),u(bu,"\u0275cmp",Xe({type:bu,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(T4(bvt,5),T4(wvt,5),T4(Nvt,5),T4(Avt,5)),2&e){let n;m3(n=_3())&&(t.chronoZeroGlobal=n.first),m3(n=_3())&&(t.chronoOneGlobal=n.first),m3(n=_3())&&(t.chronoZeroTurn=n.first),m3(n=_3())&&(t.chronoOneTurn=n.first)}},features:[Je],decls:5,vars:4,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m,M,w,L,z,$,B,de,_e,xe,nt,gt,yn;return r=$localize`vs.`,e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`It is your turn.`,n=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Draw`,a=$localize`You agreed to draw.`,c=$localize`Your draw proposal has been accepted.`,l=$localize`Players agreed to draw.`,f=$localize`You won.`,d=$localize`You lost.`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,M=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,w=$localize`You reached your time limit.`,L=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,z=$localize`You resigned.`,$=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,B=$localize`Resign`,de=$localize`Pass a turn`,_e=$localize`Accept`,xe=$localize`Reject`,nt=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,gt=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,yn=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],r,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],t,["id","opponentTurn"],n,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],s,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],o,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],a,["id","yourOpponentAgreedToDrawIndicator",1,"title"],c,["id","playersAgreedToDraw",1,"title"],l,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],f,["id","youLostIndicator",1,"title"],d,[1,"title"],m,M,w,L,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],z,$,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],B,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],de,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],_e,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],xe,["id","requestRejected",1,"notification","is-danger"],nt,["id","requestAwaitingReply",1,"notification"],gt,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],yn]},template:function(e,t){1&e&&(T(0,Ivt,2,1,"app-part-creation",0),T(1,uCt,28,25,"div",1),E(2,"div",2)(3,"div",3),F(4,"app-chat",4),S()()),2&e&&(y("ngIf",!1===t.gameStarted),v(1),y("ngIf",t.gameStarted),v(3),y("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},dependencies:[Ft,Zt,Nt,vc,v0,QC,mR,_R],encapsulation:2})),bu);var wu;function hCt(r,e){if(1&r&&(E(0,"option",26),lt(1),S()),2&r){const t=e.$implicit;y("value",t.name),v(1),Nn(t.name)}}function pCt(r,e){if(1&r&&(E(0,"option",26),oe(1,30),S()),2&r){const t=e.$implicit;y("value",t),v(1),$n(t),qn(1)}}vR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],vR);const gCt=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function mCt(r,e){if(1&r){const t=pe();E(0,"select",27),U("ngModelChange",function(i){return te(t),ne(p(2).aiDepths[0]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ZERO))}),E(1,"option",28),oe(2,29),S(),T(3,pCt,2,2,"option",17),S()}2&r&&(y("ngModel",p(2).aiDepths[0]),v(3),y("ngForOf",g1(2,gCt)))}function _Ct(r,e){if(1&r&&(E(0,"p",31),oe(1,32),S()),2&r){const t=p(2);v(1),$n(t.gameComponent.scores.get()[0]),qn(1)}}function vCt(r,e){if(1&r&&(E(0,"option",26),lt(1),S()),2&r){const t=e.$implicit;y("value",t.name),v(1),Nn(t.name)}}function CCt(r,e){if(1&r&&(E(0,"option",26),oe(1,35),S()),2&r){const t=e.$implicit;y("value",t),v(1),$n(t),qn(1)}}const yCt=function(){return[1,2,3,4,5,6,7,8,9,10]};function MCt(r,e){if(1&r){const t=pe();E(0,"select",33),U("ngModelChange",function(i){return te(t),ne(p(2).aiDepths[1]=i)})("change",function(){te(t);const i=p(2);return ne(i.updatePlayer(i.Player.ONE))}),E(1,"option",28),oe(2,34),S(),T(3,CCt,2,2,"option",17),S()}2&r&&(y("ngModel",p(2).aiDepths[1]),v(3),y("ngForOf",g1(2,yCt)))}function ECt(r,e){if(1&r&&(E(0,"p",36),oe(1,37),S()),2&r){const t=p(2);v(1),$n(t.gameComponent.scores.get()[1]),qn(1)}}function SCt(r,e){if(1&r&&(E(0,"h4",41),lt(1),S()),2&r){const t=p(3);v(1),Nn(t.winnerMessage.get())}}function PCt(r,e){1&r&&(E(0,"h4",42),oe(1,43),S())}function TCt(r,e){if(1&r&&(E(0,"div",38),T(1,SCt,2,1,"h4",39),T(2,PCt,2,0,"h4",40),S()),2&r){const t=p(2);v(1),y("ngIf",t.winnerMessage.isPresent()),v(1),y("ngIf",t.winnerMessage.isAbsent())}}function OCt(r,e){if(1&r){const t=pe();E(0,"div",7)(1,"div",8)(2,"p",9),oe(3,10),S()(),E(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),U("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ZERO))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[0]=i)}),E(8,"option",15),oe(9,16),S(),T(10,hCt,2,2,"option",17),S()(),E(11,"div",13),T(12,mCt,4,3,"select",18),S(),T(13,_Ct,2,1,"p",19),S(),E(14,"div",20)(15,"div",13)(16,"select",21),U("change",function(){te(t);const i=p();return ne(i.updatePlayer(i.Player.ONE))})("ngModelChange",function(i){return te(t),ne(p().playerSelection[1]=i)}),E(17,"option",15),oe(18,22),S(),T(19,vCt,2,2,"option",17),S()(),E(20,"div",13),T(21,MCt,4,3,"select",23),S(),T(22,ECt,2,1,"p",24),S()(),T(23,TCt,3,2,"div",25),S()}if(2&r){const t=p();v(3),$n(t.gameComponent.getTurn()+1),qn(3),v(4),y("ngModel",t.playerSelection[0]),v(3),y("ngForOf",t.gameComponent.availableMinimaxes),v(2),y("ngIf",!1===t.players[0].equalsValue("human")),v(1),y("ngIf",t.gameComponent.scores.isPresent()),v(3),y("ngModel",t.playerSelection[1]),v(3),y("ngForOf",t.gameComponent.availableMinimaxes),v(2),y("ngIf",!1===t.players[1].equalsValue("human")),v(1),y("ngIf",t.gameComponent.scores.isPresent()),v(1),y("ngIf",t.endGame)}}function bCt(r,e){if(1&r){const t=pe();E(0,"button",50),U("click",function(){return te(t),ne(p(2).gameComponent.pass())}),oe(1,51),S()}}function wCt(r,e){if(1&r){const t=pe();E(0,"button",52),U("click",function(){return te(t),ne(p(2).takeBack())}),oe(1,53),S()}}function NCt(r,e){if(1&r&&(Bt(0),lt(1),F(2,"br"),Gt()),2&r){const t=e.$implicit,n=p(3);v(1),S2(" ",t.name+": "+t.getBoardValue(n.gameComponent.node)," ")}}function ACt(r,e){if(1&r&&(E(0,"div",54),T(1,NCt,3,1,"ng-container",55),lt(2),F(3,"br"),lt(4),F(5,"br"),S()),2&r){const t=p(2);v(1),y("ngForOf",t.gameComponent.availableMinimaxes),v(1),S2(" Created ",t.getCreatedNodes()," nodes."),v(2),S2(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function ICt(r,e){if(1&r){const t=pe();E(0,"div",44),T(1,bCt,2,0,"button",45),T(2,wCt,2,0,"button",46),E(3,"button",47),U("click",function(){return te(t),ne(p().restartGame())}),oe(4,48),S(),T(5,ACt,6,3,"div",49),S()}if(2&r){const t=p();v(1),y("ngIf",!1===t.endGame&&t.gameComponent.canPass),v(1),y("ngIf",t.canTakeBack()),v(3),y("ngIf",t.gameComponent.node.move.isPresent()&&t.displayAIMetrics)}}let CR=(wu=class extends XC{constructor(e,t,n,i,s){super(e,t,n,i),u(this,"cdr",void 0),u(this,"aiDepths",["0","0"]),u(this,"playerSelection",["human","human"]),u(this,"winnerMessage",g.empty()),u(this,"botTimeOut",1e3),u(this,"displayAIMetrics",!1),this.cdr=s,this.players=[g.of(this.playerSelection[0]),g.of(this.playerSelection[1])],this.role=I.ZERO}getCreatedNodes(){return Jv.createdNodes}getMinimaxTime(){return Jv.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(P(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=g.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?I.ONE:I.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var t=this;return P(function*(){t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e).get(),t.updateBoard(),t.proposeAIToPlay()})()}updateBoard(){this.updateBoardAndShowLastMove();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const t=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?g.of($localize`${t} won`):g.of($localize`You won`):this.players[i].equalsValue("human")?g.of($localize`You lost`):g.of($localize`${this.players[e.winner.value].get()} (Player ${e.winner.value+1}) won`)}}proposeAIToPlay(){var e=this;const t=this.getPlayingAI();t.isPresent()&&window.setTimeout(P(function*(){yield e.doAIMove(t.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return g.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?g.empty():g.ofNullable(this.gameComponent.availableMinimaxes.find(t=>this.players[e].equalsValue(t.name)))}doAIMove(e){var t=this;return P(function*(){const n=t.gameComponent.rules;Ve(n.getGameStatus(t.gameComponent.node)===ve.ONGOING,"AI should not try to play when game is over!");const o=Number.parseInt(t.aiDepths[t.gameComponent.node.gameState.turn%2%2]),a=t.gameComponent.node.findBestMove(o,e,!0),c=n.choose(t.gameComponent.node,a);return c.isPresent()?(t.gameComponent.node=c.get(),t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),b.SUCCESS):(t.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),c2.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.node=this.gameComponent.node.mother.get(),this.isAITurn()&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.updateBoardAndShowLastMove()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.node=this.gameComponent.rules.getInitialNode(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=g.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const t=this.gameComponent.node.move.get();this.gameComponent.showLastMove(t)}}},u(wu,"\u0275fac",function(e){return new(e||wu)(G(Is),G(sr),G(Bn),G(Wt),G(s6))}),u(wu,"\u0275cmp",Xe({type:wu,selectors:[["app-local-game-wrapper"]],features:[Je],decls:8,vars:3,consts:function(){let r,e,t,n,i,s,o,a,c,l,f,d,m;return r=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,t=$localize`Human`,n=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Pick the level`,a=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,c=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,l=$localize`Draw`,f=$localize`Start a new game`,d=$localize`Pass a turn`,m=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],r,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],t,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],n,i,["id","scoreOne",1,"block"],s,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],o,a,["id","scoreZero",1,"block"],c,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],l,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],f,["id","AIMetrics",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],d,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","AIMetrics"],[4,"ngFor","ngForOf"]]},template:function(e,t){1&e&&(E(0,"div",0)(1,"div",1),T(2,OCt,24,10,"div",2),T(3,ICt,6,3,"div",3),S(),E(4,"div",4)(5,"div",5),F(6,"div",null,6),S()()()),2&e&&(v(2),y("ngIf",t.gameComponent),v(1),y("ngIf",t.gameComponent),v(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Zt,Nt,Y7,K7,dg,M3,Z7],encapsulation:2,changeDetection:0})),wu);CR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],CR);let H3e=(()=>{class r{}return u(r,"STEP_FINISHED",()=>$localize`Step finished!`),u(r,"INFORMATIONAL_STEP",()=>$localize`This step is not expecting any move from your part.`),r})();var Nu;function xCt(r,e){if(1&r&&(E(0,"div",21)(1,"div",22),oe(2,23),S(),F(3,"div",24),S()),2&r){const t=p();v(3),y("innerHTML",t.currentReason.get(),c7)}}function LCt(r,e){if(1&r){const t=pe();E(0,"button",25),U("click",function(){return te(t),ne(p().retry())}),oe(1,26),S()}}function RCt(r,e){1&r&&(Bt(0),oe(1,31),Gt())}function zCt(r,e){1&r&&(Bt(0),oe(1,32),Gt())}function DCt(r,e){if(1&r&&T(0,zCt,2,0,"ng-container",28),2&r){p();const t=ln(5),n=p();y("ngIf",n.stepFinished&&n.stepFinished[n.stepIndex])("ngIfElse",t)}}function HCt(r,e){1&r&&(Bt(0),oe(1,33),Gt())}function VCt(r,e){if(1&r){const t=pe();E(0,"button",27),U("click",function(){return te(t),ne(p().next())}),T(1,RCt,2,0,"ng-container",28),T(2,DCt,1,2,"ng-template",null,29,dn),T(4,HCt,2,0,"ng-template",null,30,dn),S()}if(2&r){const t=ln(3),n=p();v(1),y("ngIf",n.steps[n.stepIndex]&&n.steps[n.stepIndex].isInformation())("ngIfElse",t)}}function FCt(r,e){if(1&r){const t=pe();E(0,"button",34),U("click",function(){return te(t),ne(p().start())}),oe(1,35),S()}}function $Ct(r,e){if(1&r){const t=pe();E(0,"button",36),U("click",function(){return te(t),ne(p().playLocally())}),oe(1,37),S()}}function BCt(r,e){if(1&r){const t=pe();E(0,"button",38),U("click",function(){return te(t),ne(p().createGame())}),oe(1,39),S()}}function GCt(r,e){if(1&r){const t=pe();E(0,"button",40),U("click",function(){return te(t),ne(p().showSolution())}),oe(1,41),S()}}function UCt(r,e){if(1&r&&(Bt(0),E(1,"option",43),lt(2),S(),Gt()),2&r){const t=p(),n=t.index,i=t.$implicit;v(1),Rn("id","step_",n,""),y("value",n),v(1),Nn(i.title)}}function WCt(r,e){1&r&&(Bt(0),lt(1,"v "),Gt())}function qCt(r,e){1&r&&lt(0,"x ")}function jCt(r,e){if(1&r&&(E(0,"option",44),T(1,WCt,2,0,"ng-container",28),T(2,qCt,1,0,"ng-template",null,45,dn),E(4,"span",46),lt(5),S()()),2&r){const t=ln(3),n=p(),i=n.index,s=n.$implicit,o=p();y("value",i),v(1),y("ngIf",o.stepFinished[i])("ngIfElse",t),v(3),Rn("id","step_",i,""),v(1),Nn(s.title)}}function ZCt(r,e){if(1&r&&(Bt(0),T(1,UCt,3,3,"ng-container",28),T(2,jCt,6,5,"ng-template",null,42,dn),Gt()),2&r){const t=e.index,n=ln(3),i=p();v(1),y("ngIf",t===i.stepIndex)("ngIfElse",n)}}let yR=(Nu=class extends XC{constructor(e,t,n,i,s){super(e,s,t,n),u(this,"cdr",void 0),u(this,"COMPLETED_TUTORIAL_MESSAGE",$localize`Congratulations, you completed the tutorial.`),u(this,"steps",[]),u(this,"successfulSteps",0),u(this,"stepIndex",-1),u(this,"currentMessage",""),u(this,"currentReason",g.empty()),u(this,"moveAttemptMade",!1),u(this,"stepFinished",[]),u(this,"tutorialOver",!1),this.cdr=i,this.role=I.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return P(function*(){(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=g.empty(),this.gameComponent.node=new zi(t.state,g.empty(),t.previousMove),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var t=this;return P(function*(){const n=t.steps[t.stepIndex],i=t.gameComponent.rules.choose(t.gameComponent.node,e);if(Ve(i.isPresent(),"It should be impossible to call onLegalUserMove with an illegal move"),t.gameComponent.node=i.get(),t.updateBoardAndShowLastMove(),t.moveAttemptMade=!0,n.isPredicate()){const s=t.gameComponent.getPreviousState(),o=t.gameComponent.getState(),a=K.getNonNullable(n.predicate)(e,s,o);a.isSuccess()?t.showStepSuccess(n.getSuccessMessage()):t.currentReason=g.of(a.getReason())}else if(n.isAnyMove())we.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(n.getSuccessMessage());else{Ve(n.isMove(),"cannot reach here with a click step");const s=n;s.acceptedMoves.some(o=>o.equals(e))?(we.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(s.getSuccessMessage())):(we.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=g.of(s.getFailureMessage()))}t.cdr.detectChanges()})()}retry(){this.moveAttemptMade=!1,this.showStep(this.stepIndex)}canUserPlay(e){if(this.currentReason=g.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return b.failure(H3e.STEP_FINISHED());const t=this.steps[this.stepIndex];return t.isClick()?(this.updateBoardAndShowLastMove(),this.moveAttemptMade=!0,K.getNonNullable(t.acceptedClicks).some(n=>n===e)?this.showStepSuccess(t.getSuccessMessage()):this.currentMessage=t.getFailureMessage(),b.SUCCESS):t.isMove()||t.isPredicate()||t.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),b.SUCCESS):b.failure(H3e.INFORMATIONAL_STEP())}onCancelMove(e){void 0!==e&&(this.currentReason=g.of(e)),this.cdr.detectChanges()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return P(function*(){const t=e.steps[e.stepIndex];Ve(t.hasSolution(),"step must have solution");const n=t,i=n.getSolution();i instanceof Li?(e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,i).get(),e.updateBoardAndShowLastMove()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=n.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return P(function*(){const t=K.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return P(function*(){const t=K.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}},u(Nu,"\u0275fac",function(e){return new(e||Nu)(G(Is),G(Bn),G(Wt),G(s6),G(sr))}),u(Nu,"\u0275cmp",Xe({type:Nu,selectors:[["app-tutorial-game-wrapper"]],features:[Je],decls:23,vars:15,consts:function(){let r,e,t,n,i,s,o,a,c;return r=$localize`Failure`,e=$localize`Try again`,t=$localize`Ok`,n=$localize`Continue`,i=$localize`Skip`,s=$localize`Try again`,o=$localize`Play locally`,a=$localize`Create an online game`,c=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],r,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],t,n,i,["id","restartButton",1,"button",3,"click"],s,["id","playLocallyButton",1,"button",3,"click"],o,["id","playOnlineButton",1,"button",3,"click"],a,["id","showSolutionButton",1,"button",3,"click"],c,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(E(0,"div",0)(1,"div",1)(2,"div",2),F(3,"progress",3),E(4,"div",4)(5,"p",5),lt(6),S(),F(7,"p",6),S(),T(8,xCt,4,1,"div",7),E(9,"div",8),T(10,LCt,2,0,"button",9),T(11,VCt,6,2,"button",10),T(12,FCt,2,0,"button",11),T(13,$Ct,2,0,"button",12),T(14,BCt,2,0,"button",13),T(15,GCt,2,0,"button",14),E(16,"div",15)(17,"select",16),U("change",function(i){return t.changeStep(i)}),T(18,ZCt,4,2,"ng-container",17),S()()()()(),E(19,"div",18)(20,"div",19),F(21,"div",null,20),S()()()),2&e&&(v(3),k("value",t.successfulSteps)("max",t.getNumberOfSteps()),v(3),uE("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),v(1),y("innerHTML",t.currentMessage,c7),v(1),y("ngIf",t.currentReason.isPresent()),v(2),y("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),v(1),y("ngIf",!1===t.tutorialOver),v(1),y("ngIf",t.tutorialOver),v(1),y("ngIf",t.tutorialOver),v(1),y("ngIf",t.tutorialOver),v(1),y("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),v(3),y("ngForOf",t.steps),v(1),y("ngClass",t.getBoardHighlight()))},dependencies:[Ft,Zt,Nt,Y7,K7],encapsulation:2,changeDetection:0})),Nu);function YCt(r,e){if(1&r&&(E(0,"div",35)(1,"div",36),oe(2,37),S(),E(3,"div",38),lt(4),S()()),2&r){const t=p();v(4),Nn(t.errorMessage)}}yR=function(r,e,t,n){var o,i=arguments.length,s=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}([we.log],yR);const KCt=function(){return["/login"]};let XCt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"faEye",Bx),u(this,"errorMessage",void 0),u(this,"registrationForm",new k4({email:new to,username:new to,password:new to})),this.connectedUserService=n,this.router=i}registerWithEmail(){var n=this;return P(function*(){const i=n.registrationForm.value.username,s=n.registrationForm.value.email,o=n.registrationForm.value.password;if(null==i||null==s||null==o)n.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const a=yield n.connectedUserService.doRegister(i,s,o);if(a.isSuccess()){const c=yield n.connectedUserService.sendEmailVerification();c.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=c.getReason()}else n.errorMessage=a.getReason()}})()}registerWithGoogle(){var n=this;return P(function*(){const i=yield n.connectedUserService.doGoogleLogin();i.isSuccess()?yield n.router.navigate(["/verify-account"]):n.errorMessage=i.getReason()})()}getPasswordHelpClass(){const n=this.registrationForm.value.password;return null==n||""===n?"":n.length<6?"is-danger":"is-success"}canRegister(){const n=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===n||n.length<6)}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(sr),G(Bn))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,n,i,s,o,a,c,l,f,d,m,M,w,L;return t=$localize`Registering`,n=$localize`Email`,i=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,o=$localize`Username`,a=$localize`Username`,c=$localize`Password`,l=$localize`Password`,f=$localize`The password should be at least 6 characters long`,d=$localize`Register`,m=$localize`Register with Google`,M=$localize`Have an account?`,w=$localize`Log in`,L=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],o,["id","username","formControlName","username","name","username","placeholder",a,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",l,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],f,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],d,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],M,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],L,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),oe(2,2),S(),E(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),oe(7,7),S()(),E(8,"div",8)(9,"div",9)(10,"div",10),F(11,"input",11),E(12,"p",12),oe(13,13),S()()()()(),E(14,"div",4)(15,"div",5)(16,"label",14),oe(17,15),S()(),E(18,"div",8)(19,"div",9)(20,"div",10),F(21,"input",16),S()()()(),E(22,"div",4)(23,"div",5)(24,"label",17),oe(25,18),S()(),E(26,"div",8)(27,"div",9)(28,"div",19),F(29,"input",20),E(30,"span",21),F(31,"fa-icon",22),S(),E(32,"p",23),oe(33,24),S()()()()(),E(34,"div",4),F(35,"div",5),E(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),U("click",function(){return i.registerWithEmail()}),oe(40,26),S()()()()(),E(41,"div",4),F(42,"div",5),E(43,"div",27),T(44,YCt,5,1,"div",28),S()(),E(45,"div",4),F(46,"div",5),E(47,"div",8)(48,"button",29),U("click",function(){return i.registerWithGoogle()}),oe(49,30),S()()(),E(50,"p",31),Bt(51),oe(52,32),Gt(),lt(53,"\xa0 "),E(54,"a",33),oe(55,34),S()()()()),2&n&&(v(3),y("formGroup",i.registrationForm),v(28),y("icon",i.faEye),v(1),y("ngClass",i.getPasswordHelpClass()),v(7),y("disabled",!i.canRegister()),v(5),y("ngIf",i.errorMessage),v(10),y("routerLink",g1(6,KCt)))},dependencies:[Ft,Nt,vc,f6,pc,M3,l6,p6,d6,k8,v0,pR,I3e],encapsulation:2})),e})(),QCt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}playLocally(){var n=this;return P(function*(){yield n.router.navigate(["local/"+n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Bn))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(E(0,"app-pick-game",0),U("pickGame",function(o){return i.pickGame(o)}),S(),E(1,"button",1),U("click",function(){return i.playLocally()}),oe(2,2),S()),2&n&&(v(1),y("disabled",!i.selectedGame))},dependencies:[hR],encapsulation:2})),e})(),JCt=(()=>{var r;class e{constructor(n){u(this,"router",void 0),u(this,"selectedGame",void 0),this.router=n}pickGame(n){this.selectedGame=n}launchTutorial(){var n=this;return P(function*(){yield n.router.navigate(["/tutorial/",n.selectedGame])})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Bn))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(n,i){1&n&&(E(0,"app-pick-game",0),U("pickGame",function(o){return i.pickGame(o)}),S(),E(1,"button",1),U("click",function(){return i.launchTutorial()}),oe(2,2),S()),2&n&&(v(1),y("disabled",!i.selectedGame))},dependencies:[hR],encapsulation:2})),e})(),eyt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(E(0,"p"),oe(1,0),S())},encapsulation:2})),e})();var MR,ER,Yd,SR;function nyt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessQueenComponent.HEPTAGON)}}function ryt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function iyt(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function syt(r,e){if(1&r&&(Bt(0),A(),F(1,"circle",6)(2,"circle",6)(3,"circle",6),Gt()),2&r){const t=p();v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function oyt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"circle",7)(2,"circle",7)(3,"circle",7),S()),2&r){const t=p();v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),v(1),k("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),v(1),k("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function ayt(r,e){if(1&r&&(A(),E(0,"g",8),F(1,"circle",9)(2,"circle",9)(3,"circle",9),S()),2&r){const t=p();y("ngClass",t.pieceClasses),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class xl{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessQueenComponent",xl),u(this,"MartianChessComponent",Cs),u(this,"horizontalDotsRadius",Cs.SPACE_SIZE/15)}}function lyt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessDroneComponent.PENTAGON)}}function uyt(r,e){if(1&r&&(A(),F(0,"polygon",4)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function fyt(r,e){if(1&r&&(A(),F(0,"circle",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function dyt(r,e){if(1&r&&(Bt(0),A(),F(1,"circle",6)(2,"circle",6),Gt()),2&r){const t=p();v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function hyt(r,e){if(1&r&&(A(),E(0,"g",7),F(1,"circle",8)(2,"circle",8),S()),2&r){const t=p();y("ngClass",t.pieceClasses),v(1),k("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),v(1),k("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function pyt(r,e){if(1&r&&(A(),E(0,"g",7),F(1,"circle",9)(2,"circle",9),S()),2&r){const t=p();y("ngClass",t.pieceClasses),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}MR=xl,u(xl,"HEPTAGON",Cs.getRegularPolygon(7)),u(xl,"EIGHT_POINTED_STAR",Cs.getNPointedStar(8,0)),u(xl,"\u0275fac",function(e){return new(e||MR)}),u(xl,"\u0275cmp",Xe({type:MR,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,nyt,1,3,"polygon",0),T(1,ryt,1,3,"polygon",0),T(2,iyt,1,5,"circle",1),T(3,syt,4,9,"ng-container",2),T(4,oyt,4,9,"g",2),T(5,ayt,4,10,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),v(1),y("ngIf","Star"===t.style.shape),v(1),y("ngIf","Circle"===t.style.shape),v(1),y("ngIf","Concentric Circles"===t.style.points),v(1),y("ngIf","Dots"===t.style.points),v(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Ll{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Cs),u(this,"MartianChessDroneComponent",Ll),u(this,"horizontalDotsRadius",Cs.SPACE_SIZE/15)}}function myt(r,e){if(1&r&&(A(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessPawnComponent.TRIANGLE)}}function _yt(r,e){if(1&r&&(A(),F(0,"polygon",5)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function vyt(r,e){if(1&r&&(A(),F(0,"circle",6)),2&r){const t=p();y("id",t.mainShapeId)("ngClass",t.pieceClasses),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function Cyt(r,e){if(1&r&&(A(),F(0,"circle",7)),2&r){const t=p();k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function yyt(r,e){if(1&r&&(A(),F(0,"circle",8)),2&r){const t=p();k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function Myt(r,e){if(1&r&&(A(),E(0,"g",9),F(1,"circle",10),S()),2&r){const t=p();y("ngClass",t.pieceClasses),v(1),k("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}ER=Ll,u(Ll,"FOUR_POINTED_STAR_VERTICAL",Cs.getNPointedStar(4,0)),u(Ll,"PENTAGON",Cs.getRegularPolygon(5)),u(Ll,"\u0275fac",function(e){return new(e||ER)}),u(Ll,"\u0275cmp",Xe({type:ER,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,lyt,1,3,"polygon",0),T(1,uyt,1,3,"polygon",0),T(2,fyt,1,5,"circle",1),T(3,dyt,3,6,"ng-container",2),T(4,hyt,3,7,"g",3),T(5,pyt,3,7,"g",3)),2&e&&(y("ngIf","Polygon"===t.style.shape),v(1),y("ngIf","Star"===t.style.shape),v(1),y("ngIf","Circle"===t.style.shape),v(1),y("ngIf","Concentric Circles"===t.style.points),v(1),y("ngIf","Dots"===t.style.points),v(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Ya{constructor(){u(this,"mainShapeId",void 0),u(this,"pieceClasses",void 0),u(this,"style",void 0),u(this,"MartianChessComponent",Cs),u(this,"MartianChessPawnComponent",Ya),u(this,"horizontalDotsRadius",Cs.SPACE_SIZE/15)}static getTriangle(){return Cs.getRegularPolygon(3,Ya.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=Cs.getRegularPolygonCoords(3).map(c=>c.y);return(t.reduce((c,l)=>Math.min(c,l))+(100-t.reduce((c,l)=>Math.max(c,l))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Ya.TRIANGLE_Y_OFFSET:0}}function Syt(r,e){if(1&r&&(A(),F(0,"text",8)),2&r){const t=p();Ti("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("innerHTML",t.coord.z,c7)}}function Pyt(r,e){if(1&r&&(A(),F(0,"polyline",9)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getUpperHorizontalLine())}}function Tyt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"polyline",10)(2,"polyline",11),S()),2&r){const t=p();v(1),y("ngClass",t.pieceClasses),k("points",t.getMiddleHorizontalLine()),v(1),y("ngClass",t.pieceClasses),k("points",t.getLowerHorizontalLine())}}function Oyt(r,e){if(1&r&&(A(),F(0,"polyline",12)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getLeftDiagonalLine())}}function byt(r,e){if(1&r&&(A(),E(0,"g"),F(1,"polyline",13)(2,"polyline",14),S()),2&r){const t=p();v(1),y("ngClass",t.pieceClasses),k("points",t.getMiddleDiagonalLine()),v(1),y("ngClass",t.pieceClasses),k("points",t.getRighterDiagonalLine())}}function wyt(r,e){if(1&r&&(A(),F(0,"polyline",15)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getLeftVerticalLine())}}function Nyt(r,e){if(1&r&&(A(),F(0,"polyline",16)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getMiddleVerticalLine())}}function Ayt(r,e){if(1&r&&(A(),F(0,"polyline",17)),2&r){const t=p();y("ngClass",t.pieceClasses),k("points",t.getRighterVerticalLine())}}Yd=Ya,u(Ya,"FOUR_POINTED_STAR_DIAGONAL",Cs.getNPointedStar(4,45)),u(Ya,"TRIANGLE_Y_OFFSET",Yd.yOffsetForVerticalCentering()),u(Ya,"TRIANGLE",Yd.getTriangle()),u(Ya,"\u0275fac",function(e){return new(e||Yd)}),u(Ya,"\u0275cmp",Xe({type:Yd,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(T(0,myt,1,3,"polygon",0),T(1,_yt,1,3,"polygon",0),T(2,vyt,1,5,"circle",1),T(3,Cyt,1,3,"circle",2),T(4,yyt,1,3,"circle",3),T(5,Myt,2,4,"g",4)),2&e&&(y("ngIf","Polygon"===t.style.shape),v(1),y("ngIf","Star"===t.style.shape),v(1),y("ngIf","Circle"===t.style.shape),v(1),y("ngIf","Concentric Circles"===t.style.points),v(1),y("ngIf","Dots"===t.style.points),v(1),y("ngIf","Horizontal Points"===t.style.points))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));class Kd{constructor(){u(this,"coord",void 0),u(this,"move",void 0),u(this,"pieceClasses",void 0),u(this,"mode",void 0),u(this,"mustDisplayHeight",void 0)}mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,n=this.mode.offsetRatio*this.mode.parallelogramHeight,i=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,s=e,a=e-n,c=t,l=-n,f=t;return[new C(0,0),new C(s,0),new C(l,f),new C(a,c),new C(s,0+i),new C(l,f+i),new C(a,c+i)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],n=e[1],s=new St(-1*this.mode.offsetRatio*Vn.STROKE_WIDTH,Vn.STROKE_WIDTH),o=t.getNext(s),a=n.getNext(s);return[t,n,a,o]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],n=e[3],s=new St(-1*this.mode.offsetRatio*Vn.STROKE_WIDTH,Vn.STROKE_WIDTH);return[t.getNext(s,-1),n.getNext(s,-1),n,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],n=e[6],i=new St(0,Vn.STROKE_WIDTH),s=t.getNext(i,-1),o=n.getNext(i,-1);return this.mapCoordToPoints([s,o,n,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],n=e[2],s=new St(Vn.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[3],s=new St(Vn.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],n=e[6],s=new St(0,Vn.STROKE_WIDTH),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],n=e[5],s=new St(Vn.STROKE_WIDTH,0),o=t.getNext(s,1),a=n.getNext(s,1);return this.mapCoordToPoints([t,o,a,n])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],n=e[6],s=new St(Vn.STROKE_WIDTH,0),o=t.getNext(s,-1),a=n.getNext(s,-1);return this.mapCoordToPoints([o,t,n,a])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],n=e[4],o=new St(Vn.STROKE_WIDTH,-Vn.STROKE_WIDTH/this.mode.offsetRatio),a=t.getNext(o,-1),c=n.getNext(o,-1);return this.mapCoordToPoints([a,t,n,c])}getOtherCoord(){Ve(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}}SR=Kd,u(Kd,"STROKE_OFFSET",Vn.STROKE_WIDTH/2),u(Kd,"\u0275fac",function(e){return new(e||SR)}),u(Kd,"\u0275cmp",Xe({type:SR,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,t){1&e&&(A(),F(0,"polyline",0),T(1,Syt,1,4,"text",1),T(2,Pyt,1,2,"polyline",2),T(3,Tyt,3,4,"g",3),T(4,Oyt,1,2,"polyline",4),T(5,byt,3,4,"g",3),T(6,wyt,1,2,"polyline",5),T(7,Nyt,1,2,"polyline",6),T(8,Ayt,1,2,"polyline",7)),2&e&&(Ti("id","tile_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),y("ngClass",t.pieceClasses),k("points",t.get3DIsoSquarePoints()),v(1),y("ngIf",t.mustDisplayHeight),v(1),y("ngIf",!1===t.isBottomHalf()||t.mustForceStrokeDisplay()),v(1),y("ngIf",!1===t.isTopHalf()||t.mustForceStrokeDisplay()),v(1),y("ngIf",!1===t.isRightHalf()||t.mustForceStrokeDisplay()),v(1),y("ngIf",!1===t.isLeftHalf()||t.mustForceStrokeDisplay()),v(1),y("ngIf",t.isBottomHalf()||t.isLeftHalf()||t.mustForceStrokeDisplay()),v(1),y("ngIf",t.isBottomHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()),v(1),y("ngIf",t.isTopHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()))},dependencies:[Ft,Nt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}));const Xd_firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let PR=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"userSubscription",void 0),this.connectedUserService=n}canActivate(){var n=this;return P(function*(){const i=yield new Promise(s=>{n.userSubscription=n.connectedUserService.subscribeToUser(function(){var o=P(function*(a){return s(yield n.evaluateUserPermission(a))});return function(a){return o.apply(this,arguments)}}())});return n.userSubscription.unsubscribe(),i})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(sr))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Au=(()=>{var r;class e extends PR{static evaluateUserPermission(n,i){return P(function*(){return!1===i.isConnected()?n.parseUrl("/login"):!1!==i.verified||n.parseUrl("/verify-account")})()}constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return P(function*(){return e.evaluateUserPermission(i.router,n)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(sr),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),TR=(()=>{var r;class e{constructor(n,i){u(this,"currentGameService",void 0),u(this,"router",void 0),u(this,"currentGameSubscription",g.empty()),this.currentGameService=n,this.router=i}canActivate(n){var i=this;return P(function*(){const s=yield i.currentGameService.getCurrentGame();if(s.isAbsent())return!0;const o=s.get();return n.params.id===o.id||i.router.parseUrl("/play/"+o.typeGame+"/"+o.id)})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(ls),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),Iyt=(()=>{var r;class e extends PR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return P(function*(){return!1===n.isConnected()?i.router.parseUrl("/login"):!n.verified||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(sr),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})(),kyt=(()=>{var r;class e extends PR{constructor(n,i){super(n),u(this,"router",void 0),this.router=i}evaluateUserPermission(n){var i=this;return P(function*(){return!1===n.isConnected()||i.router.parseUrl("/")})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(Pe(sr),Pe(Bn))}),u(e,"\u0275prov",De({token:r,factory:r.\u0275fac,providedIn:"root"})),e})();function xyt(r,e){1&r&&(E(0,"p",20),oe(1,21),S())}function Lyt(r,e){if(1&r){const t=pe();E(0,"div",7)(1,"p",8),oe(2,9),S(),E(3,"div",10)(4,"p",11),oe(5,12),S(),E(6,"button",13),U("click",function(){return te(t),ne(p().finalizeEmailVerification())}),oe(7,14),S()(),E(8,"div",15)(9,"p",11),oe(10,16),S(),E(11,"button",17),U("click",function(){return te(t),ne(p().sendEmailVerification())}),oe(12,18),S()(),T(13,xyt,2,0,"p",19),S()}if(2&r){const t=p();v(2),$n(t.emailAddress),qn(2),v(11),y("ngIf",t.success)}}function Ryt(r,e){if(1&r){const t=pe();E(0,"div",24)(1,"div",8),oe(2,25),S(),E(3,"form",26)(4,"div",27)(5,"div",28),F(6,"input",29),S(),E(7,"div",28)(8,"button",30),U("click",function(){te(t);const i=p(2);return ne(i.pickUsername(i.usernameForm.value))}),oe(9,31),S()()()()()}if(2&r){const t=p(2);v(3),y("formGroup",t.usernameForm)}}const zyt=function(){return["/lobby"]};function Dyt(r,e){1&r&&(E(0,"div",32),ws(1,33),F(2,"a",34),Ns(),S()),2&r&&(v(2),y("routerLink",g1(1,zyt)))}function Hyt(r,e){if(1&r&&(Bt(0),T(1,Ryt,10,1,"div",22),T(2,Dyt,3,2,"div",23),Gt()),2&r){const t=p();v(1),y("ngIf",!t.success),v(1),y("ngIf",t.success)}}function Vyt(r,e){if(1&r&&(E(0,"div",35)(1,"div",36),lt(2),S()()),2&r){const t=p();v(2),Nn(t.errorMessage)}}let Fyt=(()=>{var r;class e{constructor(n,i){u(this,"connectedUserService",void 0),u(this,"router",void 0),u(this,"verificationType",null),u(this,"success",!1),u(this,"triedToFinalize",!1),u(this,"errorMessage",void 0),u(this,"emailAddress",void 0),u(this,"userSubscription",void 0),u(this,"usernameForm",new k4({username:new to})),this.connectedUserService=n,this.router=i}ngOnInit(){var n=this;return P(function*(){n.userSubscription=n.connectedUserService.subscribeToUser(function(){var i=P(function*(s){n.emailAddress=s.email.get(),s.username.isAbsent()?n.verificationType="enter-username":(n.verificationType="send-email",!0===n.triedToFinalize&&!1===s.verified&&(n.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield n.router.navigate(["/lobby"])))});return function(s){return i.apply(this,arguments)}}())})()}pickUsername(n){var i=this;return P(function*(){const s=yield i.connectedUserService.setUsername(n.username);s.isSuccess()?i.success=!0:i.errorMessage=s.getReason()})()}sendEmailVerification(){var n=this;return P(function*(){const i=yield n.connectedUserService.sendEmailVerification();i.isSuccess()?n.success=!0:n.errorMessage=i.getReason()})()}finalizeEmailVerification(){var n=this;return P(function*(){n.triedToFinalize=!0,yield n.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(sr),G(Bn))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,n,i,s,o,a,c,l,f,d,m;return t=$localize`Account verification`,n=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,i=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,o=$localize`If you have not received the verification email, click on the following button:`,a=$localize`Send verification email again`,c=$localize`The email has been sent`,l=$localize`In order to finalize your account, you must choose a username.`,f=$localize`Username`,d=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],n,[1,"block","level-left"],[1,"level-item"],i,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],o,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],a,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],l,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",f,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],d,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"div",1)(2,"div",2),oe(3,3),S(),T(4,Lyt,14,2,"div",4),T(5,Hyt,3,2,"ng-container",5),S(),T(6,Vyt,3,1,"div",6),S()),2&n&&(v(4),y("ngIf","send-email"===i.verificationType),v(1),y("ngIf","enter-username"===i.verificationType),v(1),y("ngIf",i.errorMessage))},dependencies:[Nt,vc,f6,pc,M3,l6,p6,d6,k8],encapsulation:2})),e})();function $yt(r,e){1&r&&(E(0,"p",17),oe(1,18),S())}function Byt(r,e){if(1&r&&(E(0,"div",19)(1,"div",20),oe(2,21),S(),E(3,"div",22),lt(4),S()()),2&r){const t=p();v(4),Nn(t.errorMessage.get())}}const Gyt=function(){return{standalone:!0}};let Uyt=(()=>{var r;class e{constructor(n){u(this,"connectedUserService",void 0),u(this,"success",!1),u(this,"errorMessage",g.empty()),u(this,"email",""),this.connectedUserService=n}resetPassword(){var n=this;return P(function*(){Ve(""!==n.email,"No email was entered, but it should not be possible to submit the form then!"),n.errorMessage=g.empty(),n.success=!1;const i=yield n.connectedUserService.sendPasswordResetEmail(n.email);i.isSuccess()?n.success=!0:n.errorMessage=g.of(i.getReason())})()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(sr))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let t,n,i,s,o,a,c;return t=$localize`Password reset`,n=$localize`Email`,i=$localize`Email`,s=$localize`An email will be sent with instruction to reset your password.`,o=$localize`Reset password`,a=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],n,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",i,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],s,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],o,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],a,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),oe(2,2),S(),E(3,"div",3)(4,"div",4)(5,"label",5),oe(6,6),S()(),E(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),U("ngModelChange",function(o){return i.email=o}),S(),E(11,"p",11),oe(12,12),S(),T(13,$yt,2,0,"p",13),S()()()(),E(14,"button",14),U("click",function(){return i.resetPassword()}),oe(15,15),S(),T(16,Byt,5,1,"div",16),S()),2&n&&(v(10),y("ngModel",i.email)("ngModelOptions",g1(5,Gyt)),v(3),y("ngIf",i.success),v(1),y("disabled",""===i.email),v(2),y("ngIf",i.errorMessage.isPresent()))},dependencies:[Nt,pc,M3,p6,Z7,pR],encapsulation:2})),e})();function Wyt(r,e){if(1&r&&(E(0,"option",13),lt(1),S()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentTheme),v(1),S2(" ",t.name," ")}}function qyt(r,e){if(1&r&&(E(0,"option",13),lt(1),S()),2&r){const t=e.$implicit,n=p();y("value",t.value)("selected",t.value===n.currentLanguage),v(1),S2(" ",t.name," ")}}let jyt=(()=>{var r;class e{constructor(n,i){u(this,"userSettingsService",void 0),u(this,"availableLanguages",[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}]),u(this,"availableThemes",[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}]),u(this,"currentTheme",void 0),u(this,"currentLanguage",void 0),this.userSettingsService=n,this.currentTheme=i.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(n){this.userSettingsService.changeLanguage(n.target.value),this.reload()}changeTheme(n){this.userSettingsService.changeTheme(n.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Vee),G(hv))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,n,i;return t=$localize`User settings`,n=$localize`Theme`,i=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],n,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],i,["id","language",3,"change"],[3,"value","selected"]]},template:function(n,i){1&n&&(E(0,"div",0)(1,"p",1),oe(2,2),S(),E(3,"div",3)(4,"label",4),oe(5,5),S(),E(6,"div",6)(7,"div",7)(8,"select",8),U("change",function(o){return i.changeTheme(o)}),T(9,Wyt,2,3,"option",9),S()()()(),E(10,"div",3)(11,"label",10),oe(12,11),S(),E(13,"div",6)(14,"div",7)(15,"select",12),U("change",function(o){return i.changeLanguage(o)}),T(16,qyt,2,3,"option",9),S()()()()()),2&n&&(v(9),y("ngForOf",i.availableThemes),v(7),y("ngForOf",i.availableLanguages))},dependencies:[Zt,Y7,K7],encapsulation:2})),e})(),Zyt=(()=>{var r;class e{constructor(n,i,s,o,a,c){u(this,"route",void 0),u(this,"router",void 0),u(this,"connectedUserService",void 0),u(this,"currentGameService",void 0),u(this,"messageDisplayer",void 0),u(this,"gameService",void 0),this.route=n,this.router=i,this.connectedUserService=s,this.currentGameService=o,this.messageDisplayer=a,this.gameService=c}ngOnInit(){var n=this;return P(function*(){yield n.createGameAndRedirectOrShowError(n.extractGameFromURL())})()}extractGameFromURL(){return K.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(n){var i=this;return P(function*(){if(Ve(i.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===i.gameExists(n))return yield i.router.navigate(["/notFound",A0.NO_MATCHING_GAME(n)],{skipLocationChange:!0}),!1;const o=i.currentGameService.canUserCreate();if(o.isSuccess()){const a=yield i.gameService.createPartConfigRoomAndChat(n);return yield i.router.navigate(["/play",n,a]),!0}return i.messageDisplayer.infoMessage(o.getReason()),yield i.router.navigate(["/lobby"]),!1})()}gameExists(n){return g.ofNullable(Su.ALL_GAMES().find(s=>s.urlName===n)).isPresent()}}return r=e,u(e,"\u0275fac",function(n){return new(n||r)(G(Is),G(Bn),G(sr),G(ls),G(Wt),G(G5))}),u(e,"\u0275cmp",Xe({type:r,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(n,i){1&n&&(E(0,"p"),oe(1,0),S())},encapsulation:2})),e})();!function Ude(r,e,t){(function kue(r,e,t){"string"!=typeof e&&(t=e,e=r[O1.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),T8[e]=r,t&&(T8[e][O1.ExtraData]=t)})(r,e,t)}(yye);const Yyt=[{path:"login",component:w_t},{path:"lobby",component:gR,canActivate:[Au]},{path:"account",component:j_t,canActivate:[Au]},{path:"settings",component:jyt},{path:"register",component:XCt,canActivate:[kyt]},{path:"reset-password",component:Uyt},{path:"notFound/:message",component:x3e},{path:"nextGameLoading",component:eyt,canActivate:[Au]},{path:"verify-account",component:Fyt,canActivate:[Iyt]},{path:"play",component:k3e,canActivate:[Au,TR]},{path:"play/:compo",component:Zyt,canActivate:[Au,TR]},{path:"play/:compo/:id",component:vR,canActivate:[Au,TR]},{path:"local",component:QCt},{path:"local/:compo",component:CR},{path:"tutorial",component:JCt},{path:"tutorial/:compo",component:yR},{path:"",component:m_t},{path:"demo",component:P_t},{path:"**",component:x3e}];class OR{static app(){return function gAe(r,...e){return{ngModule:pAe,providers:[{provide:pA,useFactory:hAe(r),multi:!0,deps:[i1,Q2,dA,...e]}]}}(()=>mAe(Xd_firebaseConfig))}static firestore(){return function _Le(r,...e){return{ngModule:mLe,providers:[{provide:Bk,useFactory:hLe(r),multi:!0,deps:[i1,Q2,dA,hA,[new es,XJ],[new es,RA],...e]}]}}(()=>{const e=PLe();e.toJSON();return e})}static auth(){return function tLe(r,...e){return{ngModule:eLe,providers:[{provide:$k,useFactory:Xxe(r),multi:!0,deps:[i1,Q2,dA,hA,[new es,RA],...e]}]}}(()=>{const e=iLe();return e})}}let Kyt=(()=>{var r;class e{}return r=e,u(e,"\u0275fac",function(n){return new(n||r)}),u(e,"\u0275mod",Ci({type:r,bootstrap:[e7t]})),u(e,"\u0275inj",Z2({providers:[sr,G5,qk,nd,$5,F5,hv,{provide:dc,useValue:rd.getLocale()}],imports:[OR.app(),OR.firestore(),OR.auth(),rG,jge,mve.forRoot(Yyt,{useHash:!1}),Ege,Mge,vye,mWe]})),e})();Oy(Cs,function(){return[Ft,Zt,Nt,xl,Ll,Ya]},[]),Oy(Vn,function(){return[Ft,Zt,Nt,Kd]},[]);var Xyt=Eo(522);function V3e(){dpe().bootstrapModule(Kyt).catch(r=>console.error(r))}const F3e=rd.getLocale();"en"!==F3e?fetch("/assets/"+F3e+".json").then(r=>r.ok?r.json():{locale:"en",translations:{}}).then(r=>{(0,Xyt.XJ)(r.translations),$localize.locale=r.locale,V3e()}).catch(function(r){console.log(r)}):V3e()},1:function(Iu,L0){!function(Eo){"use strict";function Mn(ht,st){var zt=Object.keys(ht);if(Object.getOwnPropertySymbols){var kn=Object.getOwnPropertySymbols(ht);st&&(kn=kn.filter(function(br){return Object.getOwnPropertyDescriptor(ht,br).enumerable})),zt.push.apply(zt,kn)}return zt}function So(ht){for(var st,zt=1;zt<arguments.length;zt++)st=null==arguments[zt]?{}:arguments[zt],zt%2?Mn(Object(st),!0).forEach(function(kn){Dl(ht,kn,st[kn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ht,Object.getOwnPropertyDescriptors(st)):Mn(Object(st)).forEach(function(kn){Object.defineProperty(ht,kn,Object.getOwnPropertyDescriptor(st,kn))});return ht}function e3(ht,st){if(!(ht instanceof st))throw new TypeError("Cannot call a class as a function")}function t3(ht,st){for(var zt,kn=0;kn<st.length;kn++)(zt=st[kn]).enumerable=zt.enumerable||!1,zt.configurable=!0,"value"in zt&&(zt.writable=!0),Object.defineProperty(ht,zt.key,zt)}function En(ht,st,zt){return st&&t3(ht.prototype,st),zt&&t3(ht,zt),ht}function Dl(ht,st,zt){return st in ht?Object.defineProperty(ht,st,{value:zt,enumerable:!0,configurable:!0,writable:!0}):ht[st]=zt,ht}function n3(){var ht;return null!==(ht=R0)&&void 0!==ht?ht:document}var Hl={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},ys=So({},Hl),Po={},R0=null,ku=function(ht,st,zt,kn,br){return"top-left"===ht?"left:".concat(kn,";top:").concat(st,";text-align:left;align-items:flex-start;"):"top-right"===ht?"right:".concat(br,";top:").concat(st,";text-align:right;align-items:flex-end;"):"top-center"===ht?"top:".concat(st,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===ht?"left:".concat(kn,";bottom:").concat(zt,";text-align:left;align-items:flex-start;"):"bottom-right"===ht?"right:".concat(br,";bottom:").concat(zt,";text-align:right;align-items:flex-end;"):"bottom-center"===ht?"bottom:".concat(zt,";left:0;right:0;text-align:center;align-items:center;"):"center"===ht?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},Vl=function(){function ht(st){var zt=this;e3(this,ht),this.element=n3().createElement("div"),this.opacity=st.opacity,this.type=st.type,this.animate=st.animate,this.dismissible=st.dismissible,this.closeOnClick=st.closeOnClick,this.message=st.message,this.duration=st.duration,this.pauseOnHover=st.pauseOnHover,this.offsetTop=st.offsetTop,this.offsetBottom=st.offsetBottom,this.offsetLeft=st.offsetLeft,this.offsetRight=st.offsetRight,this.extraClasses=st.extraClasses;var kn="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),br=["notification",this.extraClasses];if(this.type&&br.push(this.type),this.animate&&this.animate.in){var i3="animate__".concat(this.animate.in),vi=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";br.push("animate__animated ".concat(i3," ").concat(vi)),this.onAnimationEnd(function(){return zt.element.classList.remove(i3)})}if(this.element.className=br.join(" "),this.dismissible){var q2=n3().createElement("button");q2.className="delete",q2.addEventListener("click",function(){zt.destroy()}),this.element.insertAdjacentElement("afterbegin",q2)}else kn+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){zt.destroy()}),this.element.setAttribute("style",kn),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var Fl=new sa(function(){zt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){Fl.pause()}),this.element.addEventListener("mouseout",function(){Fl.resume()}))}return En(ht,[{key:"destroy",value:function(){var st=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){st.removeParent(st.element.parentNode),st.element.remove(),delete Po.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete Po.position)}},{key:"removeParent",value:function(st){st&&1>=st.children.length&&st.remove()}},{key:"onAnimationEnd",value:function(){var st=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},zt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var kn in zt)if(void 0!==this.element.style[kn]){this.element.addEventListener(zt[kn],function(){return st()});break}}}]),ht}(),sa=function(){function ht(st,zt){e3(this,ht),this.remaining=zt,this.callback=st,this.resume()}return En(ht,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),ht}();Eo.resetDefaults=function(){ys=So({},Hl)},Eo.setDefaults=function(ht){ys=So(So({},Hl),ht)},Eo.setDoc=function Ka(ht){for(var st in Po)Po[st].remove();Po={},R0=ht},Eo.toast=function m4(ht){if(!ht.message)throw new Error("message is required");var st=So(So({},ys),ht),zt=new Vl(st),kn=function r3(ht,st,zt,kn,br,i3){if(Po.position)return Po.position;var vi=n3().createElement("div");return vi.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+ku(st,zt,kn,br,i3)),ht.appendChild(vi),Po.position=vi,vi}(st.appendTo||n3().body,st.position||ys.position,st.offsetTop||ys.offsetTop,st.offsetBottom||ys.offsetBottom,st.offsetLeft||ys.offsetLeft,st.offsetRight||ys.offsetRight);if(st.single)for(var br=kn.lastElementChild;br;)kn.removeChild(br),br=kn.lastElementChild;kn.appendChild(zt.element)},Object.defineProperty(Eo,"__esModule",{value:!0})}(L0)},522:(Iu,L0,Eo)=>{"use strict";Eo.d(L0,{XJ:()=>zu,pQ:()=>Hu});const Mn=":",So="|",e3="@@",t3="\u241f";class En{static zero(){return new En([0])}static one(){return new En([1])}constructor(re){this.digits=re}clone(){return new En(this.digits.slice())}add(re){const me=this.clone();return me.addToSelf(re),me}addToSelf(re){const me=Math.max(this.digits.length,re.digits.length);let Se=0;for(let Ye=0;Ye<me;Ye++){let ot=Se;Ye<this.digits.length&&(ot+=this.digits[Ye]),Ye<re.digits.length&&(ot+=re.digits[Ye]),ot>=10?(this.digits[Ye]=ot-10,Se=1):(this.digits[Ye]=ot,Se=0)}Se>0&&(this.digits[me]=1)}toString(){let re="";for(let me=this.digits.length-1;me>=0;me--)re+=this.digits[me];return re}}class Dl{constructor(re){this.powerOfTwos=[re]}getValue(){return this.powerOfTwos[0]}multiplyBy(re){const me=En.zero();return this.multiplyByAndAddTo(re,me),me}multiplyByAndAddTo(re,me){for(let Se=0;0!==re;re>>>=1,Se++)if(1&re){const Ye=this.getMultipliedByPowerOfTwo(Se);me.addToSelf(Ye)}}getMultipliedByPowerOfTwo(re){for(let me=this.powerOfTwos.length;me<=re;me++){const Se=this.powerOfTwos[me-1];this.powerOfTwos[me]=Se.add(Se)}return this.powerOfTwos[re]}}class n3{constructor(re){this.base=re,this.exponents=[new Dl(En.one())]}toThePowerOf(re){for(let me=this.exponents.length;me<=re;me++){const Se=this.exponents[me-1].multiplyBy(this.base);this.exponents[me]=new Dl(Se)}return this.exponents[re]}}let r3;function zt(ae){r3??=new TextEncoder;const re=r3.encode(ae),me=new DataView(re.buffer,re.byteOffset,re.byteLength);let Se=br(me,re.length,0),Ye=br(me,re.length,102072);return 0==Se&&(0==Ye||1==Ye)&&(Se^=319790063,Ye^=-1801410264),[Se,Ye]}function br(ae,re,me){let Se=2654435769,Ye=2654435769,ot=0;const e2=re-12;for(;ot<=e2;ot+=12){Se+=ae.getUint32(ot,!0),Ye+=ae.getUint32(ot+4,!0);const Jn=i3(Se,Ye,me+=ae.getUint32(ot+8,!0));Se=Jn[0],Ye=Jn[1],me=Jn[2]}const Qn=re-ot;return me+=re,Qn>=4?(Se+=ae.getUint32(ot,!0),ot+=4,Qn>=8?(Ye+=ae.getUint32(ot,!0),ot+=4,Qn>=9&&(me+=ae.getUint8(ot++)<<8),Qn>=10&&(me+=ae.getUint8(ot++)<<16),11===Qn&&(me+=ae.getUint8(ot++)<<24)):(Qn>=5&&(Ye+=ae.getUint8(ot++)),Qn>=6&&(Ye+=ae.getUint8(ot++)<<8),7===Qn&&(Ye+=ae.getUint8(ot++)<<16))):(Qn>=1&&(Se+=ae.getUint8(ot++)),Qn>=2&&(Se+=ae.getUint8(ot++)<<8),3===Qn&&(Se+=ae.getUint8(ot++)<<16)),i3(Se,Ye,me)[2]}function i3(ae,re,me){return ae-=re,ae-=me,re-=me,re-=ae^=me>>>13,me-=ae,me-=re^=ae<<8,ae-=re,ae-=me^=re>>>13,re-=me,re-=ae^=me>>>12,me-=ae,me-=re^=ae<<16,ae-=re,ae-=me^=re>>>5,re-=me,re-=ae^=me>>>3,me-=ae,me-=re^=ae<<10,[ae,re,me^=re>>>15]}function q2(ae,re){return Fl(ae,re)[1]}function Fl(ae,re){const me=(65535&ae)+(65535&re),Se=(ae>>>16)+(re>>>16)+(me>>>16);return[Se>>>16,Se<<16|65535&me]}const S1=new n3(256);function ey(ae,re,me,Se,Ye=[]){const ot={},e2={},Qn={},Jn=function ty(ae,re){const{text:me,block:Se}=Ms(ae,re);if(void 0===Se)return{text:me};{const[Ye,...ot]=Se.split(t3),[e2,Qn]=Ye.split(e3,2);let[Jn,M2]=e2.split(So,2);return void 0===M2&&(M2=Jn,Jn=void 0),""===M2&&(M2=void 0),{text:me,meaning:Jn,description:M2,customId:Qn,legacyIds:ot}}}(ae[0],ae.raw[0]),M2=[Jn.text],_4=[];let $l=Jn.text;for(let Us=1;Us<ae.length;Us++){const{messagePart:Bl,placeholderName:qr=rh(Us),associatedMessageId:Gl}=ny(ae[Us],ae.raw[Us]);$l+=`{$${qr}}${Bl}`,void 0!==re&&(ot[qr]=re[Us-1],e2[qr]=Ye[Us-1]),_4.push(qr),void 0!==Gl&&(Qn[qr]=Gl),M2.push(Bl)}const Gs=Jn.customId||function kn(ae,re=""){let me=zt(ae);if(re){const ot=zt(re);me=function xu(ae,re){const me=ae[0],Ye=re[0],e2=Fl(ae[1],re[1]),Qn=e2[0],Jn=e2[1];return[q2(q2(me,Ye),Qn),Jn]}(function Ru(ae,re){const me=ae[0],Se=ae[1];return[me<<re|Se>>>32-re,Se<<re|me>>>32-re]}(me,1),ot)}return function nh(ae,re){const me=S1.toThePowerOf(0).multiplyBy(re);return S1.toThePowerOf(4).multiplyByAndAddTo(ae,me),me.toString()}(2147483647&me[0],me[1])}($l,Jn.meaning||""),D0=Jn.legacyIds?Jn.legacyIds.filter(Us=>Us!==Gs):[];return{id:Gs,legacyIds:D0,substitutions:ot,substitutionLocations:e2,text:$l,customId:Jn.customId,meaning:Jn.meaning||"",description:Jn.description||"",messageParts:M2,messagePartLocations:Se,placeholderNames:_4,associatedMessageIds:Qn,location:me}}function ny(ae,re){const{text:me,block:Se}=Ms(ae,re);if(void 0===Se)return{messagePart:me};{const[Ye,ot]=Se.split(e3);return{messagePart:me,placeholderName:Ye,associatedMessageId:ot}}}function Ms(ae,re){if(re.charAt(0)!==Mn)return{text:ae};{const me=Zi(ae,re);return{block:ae.substring(1,me),text:ae.substring(me+1)}}}function rh(ae){return 1===ae?"PH":"PH_"+(ae-1)}function Zi(ae,re){for(let me=1,Se=1;me<ae.length;me++,Se++)if("\\"===re[Se])Se++;else if(ae[me]===Mn)return me;throw new Error(`Unterminated $localize metadata block in "${re}".`)}class ih extends Error{constructor(re){super(`No translation found for ${sh(re)}.`),this.parsedMessage=re,this.type="MissingTranslationError"}}function z0(ae,re){return Object.defineProperty(ae,"raw",{value:re}),ae}function sh(ae){const re=ae.meaning&&` - "${ae.meaning}"`,me=ae.legacyIds&&ae.legacyIds.length>0?` [${ae.legacyIds.map(Se=>`"${Se}"`).join(", ")}]`:"";return`"${ae.id}"${me} ("${ae.text}"${re})`}function zu(ae){$localize.translate||($localize.translate=iy),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(ae).forEach(re=>{$localize.TRANSLATIONS[re]=function ry(ae){const re=ae.split(/{\$([^}]*)}/),me=[re[0]],Se=[];for(let ot=1;ot<re.length-1;ot+=2)Se.push(re[ot]),me.push(`${re[ot+1]}`);const Ye=me.map(ot=>ot.charAt(0)===Mn?"\\"+ot:ot);return{text:ae,messageParts:z0(me,Ye),placeholderNames:Se}}(ae[re])})}function iy(ae,re){try{return function dr(ae,re,me){const Se=ey(re,me);let Ye=ae[Se.id];if(void 0!==Se.legacyIds)for(let ot=0;ot<Se.legacyIds.length&&void 0===Ye;ot++)Ye=ae[Se.legacyIds[ot]];if(void 0===Ye)throw new ih(Se);return[Ye.messageParts,Ye.placeholderNames.map(ot=>{if(Se.substitutions.hasOwnProperty(ot))return Se.substitutions[ot];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${sh(Se)}.\nThe translation contains a placeholder with name ${ot}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,ae,re)}catch(me){return console.warn(me.message),[ae,re]}}const Hu=function(ae,...re){if(Hu.translate){const Se=Hu.translate(ae,re);ae=Se[0],re=Se[1]}let me=sy(ae[0],ae.raw[0]);for(let Se=1;Se<ae.length;Se++)me+=re[Se-1]+sy(ae[Se],ae.raw[Se]);return me},wR=":";function sy(ae,re){return re.charAt(0)===wR?ae.substring(Zi(ae,re)+1):ae}}},Iu=>{Iu(Iu.s=9219)}]);