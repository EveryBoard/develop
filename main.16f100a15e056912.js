(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{9713:(z9,M7,lc)=>{"use strict";function ln(n){return"function"==typeof n}function ts(n){const t=n(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const n4=ts(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function t3(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class I1{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const i of t)i.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(ln(r))try{r()}catch(i){e=i instanceof n4?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{vn(i)}catch(o){e=e??[],o instanceof n4?e=[...e,...o.errors]:e.push(o)}}if(e)throw new n4(e)}}add(e){var t;if(e&&e!==this)if(this.closed)vn(e);else{if(e instanceof I1){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&t3(t,e)}remove(e){const{_finalizers:t}=this;t&&t3(t,e),e instanceof I1&&e._removeParent(this)}}I1.EMPTY=(()=>{const n=new I1;return n.closed=!0,n})();const W8=I1.EMPTY;function n3(n){return n instanceof I1||n&&"closed"in n&&ln(n.remove)&&ln(n.add)&&ln(n.unsubscribe)}function vn(n){ln(n)?n():n.unsubscribe()}const uc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},r3={setTimeout(n,e,...t){const{delegate:r}=r3;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=r3;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function r4(n){r3.setTimeout(()=>{const{onUnhandledError:e}=uc;if(!e)throw n;e(n)})}function ho(){}const Ks=j8("C",void 0,void 0);function j8(n,e,t){return{kind:n,value:e,error:t}}let s3=null;function mt(n){if(uc.useDeprecatedSynchronousErrorHandling){const e=!s3;if(e&&(s3={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:r}=s3;if(s3=null,t)throw r}}else n()}class rn extends I1{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,n3(e)&&e.add(this)):this.destination=P7}static create(e,t,r){return new rr(e,t,r)}next(e){this.isStopped?V9(function H9(n){return j8("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?V9(function ml(n){return j8("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?V9(Ks,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const o1=Function.prototype.bind;function Ls(n,e){return o1.call(n,e)}class In{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){s4(r)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){s4(r)}else s4(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){s4(t)}}}class rr extends rn{constructor(e,t,r){let s;if(super(),ln(e)||!e)s={next:e??void 0,error:t??void 0,complete:r??void 0};else{let i;this&&uc.useDeprecatedNextContext?(i=Object.create(e),i.unsubscribe=()=>this.unsubscribe(),s={next:e.next&&Ls(e.next,i),error:e.error&&Ls(e.error,i),complete:e.complete&&Ls(e.complete,i)}):s=e}this.destination=new In(s)}}function s4(n){uc.useDeprecatedSynchronousErrorHandling?function ft(n){uc.useDeprecatedSynchronousErrorHandling&&s3&&(s3.errorThrown=!0,s3.error=n)}(n):r4(n)}function V9(n,e){const{onStoppedNotification:t}=uc;t&&r3.setTimeout(()=>t(n,e))}const P7={closed:!0,next:ho,error:function S7(n){throw n},complete:ho},Y_="function"==typeof Symbol&&Symbol.observable||"@@observable";function _l(n){return n}function K_(n){return 0===n.length?_l:1===n.length?n[0]:function(t){return n.reduce((r,s)=>s(r),t)}}let _r=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,s){const i=function T7(n){return n&&n instanceof rn||function $T(n){return n&&ln(n.next)&&ln(n.error)&&ln(n.complete)}(n)&&n3(n)}(t)?t:new rr(t,r,s);return mt(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=F9(r))((s,i)=>{const o=new rr({next:c=>{try{t(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[Y_](){return this}pipe(...t){return K_(t)(this)}toPromise(t){return new(t=F9(t))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=e=>new n(e),n})();function F9(n){var e;return null!==(e=n??uc.Promise)&&void 0!==e?e:Promise}const WF=ts(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let F2=(()=>{class n extends _r{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new B9(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new WF}next(t){mt(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){mt(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){mt(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:s,observers:i}=this;return r||s?W8:(this.currentObservers=null,i.push(t),new I1(()=>{this.currentObservers=null,t3(i,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:s,isStopped:i}=this;r?t.error(s):i&&t.complete()}asObservable(){const t=new _r;return t.source=this,t}}return n.create=(e,t)=>new B9(e,t),n})();class B9 extends F2{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)}error(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:W8}}function X_(n){return ln(n?.lift)}function lr(n){return e=>{if(X_(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ns(n,e,t,r,s){return new GT(n,e,t,r,s)}class GT extends rn{constructor(e,t,r,s,i,o){super(e),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=t?function(c){try{t(c)}catch(u){e.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function Cn(n,e){return lr((t,r)=>{let s=0;t.subscribe(ns(r,i=>{r.next(n.call(e,i,s++))}))})}function b7(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]])}return t}function Br(n){return this instanceof Br?(this.v=n,this):new Br(n)}function e2(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=t.apply(n,e||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(M){r[M]&&(s[M]=function(b){return new Promise(function(L,G){i.push([M,b,L,G])>1||c(M,b)})})}function c(M,b){try{!function u(M){M.value instanceof Br?Promise.resolve(M.value.v).then(h,g):m(i[0][2],M)}(r[M](b))}catch(L){m(i[0][3],L)}}function h(M){c("next",M)}function g(M){c("throw",M)}function m(M,b){M(b),i.shift(),i.length&&c(i[0][0],i[0][1])}}function KT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function ev(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const sv=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function iv(n){return ln(n?.then)}function U9(n){return ln(n[Y_])}function ov(n){return Symbol.asyncIterator&&ln(n?.[Symbol.asyncIterator])}function fc(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const x1=function Z8(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function hc(n){return ln(n?.[x1])}function ba(n){return e2(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:r,done:s}=yield Br(t.read());if(s)return yield Br(void 0);yield yield Br(r)}}finally{t.releaseLock()}})}function av(n){return ln(n?.getReader)}function po(n){if(n instanceof _r)return n;if(null!=n){if(U9(n))return function vl(n){return new _r(e=>{const t=n[Y_]();if(ln(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(sv(n))return function t2(n){return new _r(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(iv(n))return function cv(n){return new _r(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,r4)})}(n);if(ov(n))return Cl(n);if(hc(n))return function XT(n){return new _r(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(av(n))return function q9(n){return Cl(ba(n))}(n)}throw fc(n)}function Cl(n){return new _r(e=>{(function QT(n,e){var t,r,s,i;return function WT(n,e,t,r){return new(t||(t=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof t?i:new t(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=KT(n);!(r=yield t.next()).done;)if(e.next(r.value),e.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=t.return)&&(yield i.call(t))}finally{if(s)throw s.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Rs(n,e,t,r=0,s=!1){const i=e.schedule(function(){t(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function ze(n,e,t=1/0){return ln(e)?ze((r,s)=>Cn((i,o)=>e(r,i,s,o))(po(n(r,s))),t):("number"==typeof e&&(t=e),lr((r,s)=>function qo(n,e,t,r,s,i,o,c){const u=[];let h=0,g=0,m=!1;const M=()=>{m&&!u.length&&!h&&e.complete()},b=G=>h<r?L(G):u.push(G),L=G=>{i&&e.next(G),h++;let j=!1;po(t(G,g++)).subscribe(ns(e,ie=>{s?.(ie),i?b(ie):e.next(ie)},()=>{j=!0},void 0,()=>{if(j)try{for(h--;u.length&&h<r;){const ie=u.shift();o?Rs(e,o,()=>L(ie)):L(ie)}M()}catch(ie){e.error(ie)}}))};return n.subscribe(ns(e,b,()=>{m=!0,M()})),()=>{c?.()}}(r,s,n,t)))}function yl(n=1/0){return ze(_l,n)}const dc=new _r(n=>n.complete());function El(n){return n[n.length-1]}function tn(n){return ln(El(n))?n.pop():void 0}function i4(n){return function j6(n){return n&&ln(n.schedule)}(El(n))?n.pop():void 0}function Ml(n,e=0){return lr((t,r)=>{t.subscribe(ns(r,s=>Rs(r,n,()=>r.next(s),e),()=>Rs(r,n,()=>r.complete(),e),s=>Rs(r,n,()=>r.error(s),e)))})}function pc(n,e=0){return lr((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function N7(n,e){if(!n)throw new Error("Iterable cannot be null");return new _r(t=>{Rs(t,e,()=>{const r=n[Symbol.asyncIterator]();Rs(t,e,()=>{r.next().then(s=>{s.done?t.complete():t.next(s.value)})},0,!0)})})}function rs(n,e){return e?function Y8(n,e){if(null!=n){if(U9(n))return function A7(n,e){return po(n).pipe(pc(e),Ml(e))}(n,e);if(sv(n))return function jo(n,e){return new _r(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}(n,e);if(iv(n))return function Z6(n,e){return po(n).pipe(pc(e),Ml(e))}(n,e);if(ov(n))return N7(n,e);if(hc(n))return function W9(n,e){return new _r(t=>{let r;return Rs(t,e,()=>{r=n[x1](),Rs(t,e,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void t.error(o)}i?t.complete():t.next(s)},0,!0)}),()=>ln(r?.return)&&r.return()})}(n,e);if(av(n))return function Y6(n,e){return N7(ba(n),e)}(n,e)}throw fc(n)}(n,e):po(n)}function I7(n,e,...t){if(!0===e)return void n();if(!1===e)return;const r=new rr({next:()=>{r.unsubscribe(),n()}});return po(e(...t)).subscribe(r)}function P1(n){for(let e in n)if(n[e]===P1)return e;throw Error("Could not find renamed property on target object.")}function j9(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function U1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(U1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function K8(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const uv=P1({__forward_ref__:P1});function T1(n){return n.__forward_ref__=T1,n.toString=function(){return U1(this())},n}function sn(n){return K6(n)?n():n}function K6(n){return"function"==typeof n&&n.hasOwnProperty(uv)&&n.__forward_ref__===T1}class Ae extends Error{constructor(e,t){super(function i3(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function on(n){return"string"==typeof n?n:null==n?"":String(n)}function Q6(n,e){throw new Ae(-201,!1)}function w1(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}function nt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function $r(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ln(n){return pv(n,J6)||pv(n,X9)}function pv(n,e){return n.hasOwnProperty(e)?n[e]:null}function J8(n){return n&&(n.hasOwnProperty(Ee)||n.hasOwnProperty(Q9))?n[Ee]:null}const J6=P1({\u0275prov:P1}),Ee=P1({\u0275inj:P1}),X9=P1({ngInjectableDef:P1}),Q9=P1({ngInjectorDef:P1});var Yt=(()=>((Yt=Yt||{})[Yt.Default=0]="Default",Yt[Yt.Host=1]="Host",Yt[Yt.Self=2]="Self",Yt[Yt.SkipSelf=4]="SkipSelf",Yt[Yt.Optional=8]="Optional",Yt))();let J9;function Zo(n){const e=J9;return J9=n,e}function ed(n,e,t){const r=Ln(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&Yt.Optional?null:void 0!==e?e:void Q6(U1(n))}function c4(n){return{toString:n}.toString()}var G2=(()=>((G2=G2||{})[G2.OnPush=0]="OnPush",G2[G2.Default=1]="Default",G2))(),V1=(()=>{return(n=V1||(V1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",V1;var n})();const j1=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),K={},E1=[],R7=P1({\u0275cmp:P1}),td=P1({\u0275dir:P1}),nd=P1({\u0275pipe:P1}),eu=P1({\u0275mod:P1}),o3=P1({\u0275fac:P1}),a3=P1({__NG_ELEMENT_ID__:P1});let sw=0;function ct(n){return c4(()=>{const t=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===G2.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||E1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||V1.Emulated,id:"c"+sw++,styles:n.styles||E1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=sd(n.inputs,r),s.outputs=sd(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(rd).filter(D7):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(r2).filter(D7):null,s})}function tu(n,e,t){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof e?e():e).map(rd),r.pipeDefs=()=>("function"==typeof t?t():t).map(r2)}function rd(n){return b1(n)||n2(n)}function D7(n){return null!==n}function ei(n){return c4(()=>({type:n.type,bootstrap:n.bootstrap||E1,declarations:n.declarations||E1,imports:n.imports||E1,exports:n.exports||E1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function sd(n,e){if(null==n)return K;const t={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),t[s]=r,e&&(e[s]=i)}return t}const Ut=ct;function ti(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function b1(n){return n[R7]||null}function n2(n){return n[td]||null}function r2(n){return n[nd]||null}function mo(n,e){const t=n[eu]||null;if(!t&&!0===e)throw new Error(`Type ${U1(n)} does not have '\u0275mod' property.`);return t}function _o(n){return Array.isArray(n)&&"object"==typeof n[1]}function vr(n){return Array.isArray(n)&&!0===n[1]}function q2(n){return 0!=(8&n.flags)}function Qo(n){return 2==(2&n.flags)}function Jo(n){return 1==(1&n.flags)}function vs(n){return null!==n.template}function s0(n){return 0!=(256&n[2])}function Aa(n,e){return n.hasOwnProperty(o3)?n[o3]:null}class aw{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function a2(){return yv}function yv(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ev),cw}function cw(){const n=$7(this),e=n?.current;if(e){const t=n.previous;if(t===K)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function Ev(n,e,t,r){const s=$7(n)||function lw(n,e){return n[Mv]=e}(n,{previous:K,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[t],u=o[c];i[c]=new aw(u&&u.currentValue,e,o===K),n[r]=e}a2.ngInherit=!0;const Mv="__ngSimpleChanges__";function $7(n){return n[Mv]||null}function Cr(n){for(;Array.isArray(n);)n=n[0];return n}function su(n,e){return Cr(e[n])}function c2(n,e){return Cr(e[n.index])}function ld(n,e){return n.data[e]}function Tl(n,e){return n[e]}function Ai(n,e){const t=e[n];return _o(t)?t:t[0]}function c0(n){return 64==(64&n[2])}function l3(n,e){return null==e?null:n[e]}function wv(n){n[18]=0}function ud(n,e){n[5]+=e;let t=n,r=n[3];for(;null!==r&&(1===e&&1===t[5]||-1===e&&0===t[5]);)r[5]+=e,t=r,r=r[3]}const un={lFrame:_d(null),bindingsEnabled:!0};function fd(){return un.bindingsEnabled}function Le(){return un.lFrame.lView}function Qn(){return un.lFrame.tView}function he(n){return un.lFrame.contextLView=n,n[8]}function ce(n){return un.lFrame.contextLView=null,n}function xr(){let n=bv();for(;null!==n&&64===n.type;)n=n.parent;return n}function bv(){return un.lFrame.currentTNode}function wl(){const n=un.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function gc(n,e){const t=un.lFrame;t.currentTNode=n,t.isParent=e}function Gr(){return un.lFrame.isParent}function hd(){un.lFrame.isParent=!1}function Ni(){const n=un.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function mc(){return un.lFrame.bindingIndex}function u0(){return un.lFrame.bindingIndex++}function ta(n){const e=un.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function l2(n){un.lFrame.inI18n=n}function Cw(n,e){const t=un.lFrame;t.bindingIndex=t.bindingRootIndex=n,u3(e)}function u3(n){un.lFrame.currentDirectiveIndex=n}function gd(){return un.lFrame.currentQueryIndex}function ou(n){un.lFrame.currentQueryIndex=n}function Av(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function Z7(n,e,t){if(t&Yt.SkipSelf){let s=e,i=n;for(;!(s=s.parent,null!==s||t&Yt.Host||(s=Av(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;e=s,n=i}const r=un.lFrame=md();return r.currentTNode=e,r.lView=n,!0}function bl(n){const e=md(),t=n[1];un.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function md(){const n=un.lFrame,e=null===n?null:n.child;return null===e?_d(n):e}function _d(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Nv(){const n=un.lFrame;return un.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const au=Nv;function Ol(){const n=Nv();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function u2(){return un.lFrame.selectedIndex}function f3(n){un.lFrame.selectedIndex=n}function O1(){const n=un.lFrame;return ld(n.tView,n.selectedIndex)}function V(){un.lFrame.currentNamespace="svg"}function p3(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){const i=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:g}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),c&&((n.contentHooks||(n.contentHooks=[])).push(t,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-t,u),h&&((n.viewHooks||(n.viewHooks=[])).push(t,h),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,h)),null!=g&&(n.destroyHooks||(n.destroyHooks=[])).push(t,g)}}function Na(n,e,t){Iv(n,e,3,t)}function lu(n,e,t,r){(3&n[2])===t&&Iv(n,e,t,r)}function uu(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Iv(n,e,t,r){const i=r??-1,o=e.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof e[u+1]){if(c=e[u],null!=r&&c>=r)break}else e[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(xv(n,t,e,u),n[18]=(4294901760&n[18])+u+2),u++}function xv(n,e,t,r){const s=t[r]<0,i=t[r+1],c=n[s?-t[r]:t[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class fu{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function _c(n,e,t){let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const i=t[r++],o=t[r++],c=t[r++];n.setAttribute(e,o,c,i)}else{const i=s,o=t[++r];Rv(i)?n.setProperty(e,i,o):n.setAttribute(e,i,o),r++}}return r}function Lv(n){return 3===n||4===n||6===n}function Rv(n){return 64===n.charCodeAt(0)}function d0(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){const s=e[r];"number"==typeof s?t=s:0===t||Cd(n,t,s,null,-1===t||2===t?e[++r]:null)}}return n}function Cd(n,e,t,r,s){let i=0,o=n.length;if(-1===e)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===e){o=-1;break}if(c>e){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===t){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,e),i=o+1),n.splice(i++,0,t),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function yd(n){return-1!==n}function Nl(n){return 32767&n}function Il(n,e){let t=function Dv(n){return n>>16}(n),r=e;for(;t>0;)r=r[15],t--;return r}let K7=!0;function p4(n){const e=K7;return K7=n,e}let zv=0;const g3={};function X7(n,e){const t=du(n,e);if(-1!==t)return t;const r=e[1];r.firstCreatePass&&(n.injectorIndex=e.length,Md(r.data,n),Md(e,null),Md(r.blueprint,null));const s=xa(n,e),i=n.injectorIndex;if(yd(s)){const o=Nl(s),c=Il(s,e),u=c[1].data;for(let h=0;h<8;h++)e[i+h]=c[o+h]|u[o+h]}return e[i+8]=s,i}function Md(n,e){n.push(0,0,0,0,0,0,0,0,e)}function du(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function xa(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,r=null,s=e;for(;null!==s;){if(r=Fv(s),null===r)return-1;if(t++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return-1}function p0(n,e,t){!function uB(n,e,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(a3)&&(r=t[a3]),null==r&&(r=t[a3]=zv++);const s=255&r;e.data[n+(s>>5)]|=1<<s}(n,e,t)}function Sd(n,e,t){if(t&Yt.Optional||void 0!==n)return n;Q6()}function Pd(n,e,t,r){if(t&Yt.Optional&&void 0===r&&(r=null),0==(t&(Yt.Self|Yt.Host))){const s=n[9],i=Zo(void 0);try{return s?s.get(e,r,t&Yt.Optional):ed(e,r,t&Yt.Optional)}finally{Zo(i)}}return Sd(r,0,t)}function Q7(n,e,t,r=Yt.Default,s){if(null!==n){if(1024&e[2]){const o=function J7(n,e,t,r,s){let i=n,o=e;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=g4(i,o,t,r|Yt.Self,g3);if(c!==g3)return c;let u=i.parent;if(!u){const h=o[21];if(h){const g=h.get(t,g3,r);if(g!==g3)return g}u=Fv(o),o=o[15]}i=u}return s}(n,e,t,r,g3);if(o!==g3)return o}const i=g4(n,e,t,r,g3);if(i!==g3)return i}return Pd(e,t,r,s)}function g4(n,e,t,r,s){const i=function pu(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(a3)?n[a3]:void 0;return"number"==typeof e?e>=0?255&e:m0:e}(t);if("function"==typeof i){if(!Z7(e,n,r))return r&Yt.Host?Sd(s,0,r):Pd(e,t,r,s);try{const o=i(r);if(null!=o||r&Yt.Optional)return o;Q6()}finally{au()}}else if("number"==typeof i){let o=null,c=du(n,e),u=-1,h=r&Yt.Host?e[16][6]:null;for((-1===c||r&Yt.SkipSelf)&&(u=-1===c?xa(n,e):e[c+8],-1!==u&&Vv(r,!1)?(o=e[1],c=Nl(u),e=Il(u,e)):c=-1);-1!==c;){const g=e[1];if(Hv(i,c,g.data)){const m=Td(c,e,t,o,r,h);if(m!==g3)return m}u=e[c+8],-1!==u&&Vv(r,e[1].data[c+8]===h)&&Hv(i,c,e)?(o=g,c=Nl(u),e=Il(u,e)):c=-1}}return s}function Td(n,e,t,r,s,i){const o=e[1],c=o.data[n+8],g=Ur(c,o,t,null==r?Qo(c)&&K7:r!=o&&0!=(3&c.type),s&Yt.Host&&i===c);return null!==g?Ds(e,o,g,c):g3}function Ur(n,e,t,r,s){const i=n.providerIndexes,o=e.data,c=1048575&i,u=n.directiveStart,g=i>>20,M=s?c+g:n.directiveEnd;for(let b=r?c:c+g;b<M;b++){const L=o[b];if(b<u&&t===L||b>=u&&L.type===t)return b}if(s){const b=o[u];if(b&&vs(b)&&b.type===t)return u}return null}function Ds(n,e,t,r){let s=n[t];const i=e.data;if(function yw(n){return n instanceof fu}(s)){const o=s;o.resolving&&function X8(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Ae(-200,`Circular dependency in DI detected for ${n}${t}`)}(function zt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():on(n)}(i[t]));const c=p4(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Zo(o.injectImpl):null;Z7(n,r,Yt.Default);try{s=n[t]=o.factory(void 0,i,n,r),e.firstCreatePass&&t>=r.directiveStart&&function h0(n,e,t){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=e.type.prototype;if(r){const o=yv(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}s&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,s),i&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,i),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,i))}(t,i[t],e)}finally{null!==u&&Zo(u),p4(c),o.resolving=!1,au()}}return s}function Hv(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Vv(n,e){return!(n&Yt.Self||n&Yt.Host&&e)}class g0{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return Q7(this._tNode,this._lView,e,r,t)}}function m0(){return new g0(xr(),Le())}function yr(n){return c4(()=>{const e=n.prototype.constructor,t=e[o3]||wd(e),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[o3]||wd(s);if(i&&i!==t)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function wd(n){return K6(n)?()=>{const e=wd(sn(n));return e&&e()}:Aa(n)}function Fv(n){const e=n[1],t=e.type;return 2===t?e.declTNode:1===t?n[6]:null}function gu(n){return function Mw(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const r=t.length;let s=0;for(;s<r;){const i=t[s];if(Lv(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof t[s];)s++;else{if(i===e)return t[s+1];s+=2}}}return null}(xr(),n)}const _0="__parameters__";function Ll(n,e,t){return c4(()=>{const r=function ef(n){return function(...t){if(n){const r=n(...t);for(const s in r)this[s]=r[s]}}}(e);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,h,g){const m=u.hasOwnProperty(_0)?u[_0]:Object.defineProperty(u,_0,{value:[]})[_0];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(o),u}}return t&&(s.prototype=Object.create(t.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class Rt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=nt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function f2(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)?(e===n&&(e=n.slice(0,t)),f2(r,e)):e!==n&&e.push(r)}return e}function ka(n,e){n.forEach(t=>Array.isArray(t)?ka(t,e):e(t))}function m3(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function y0(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Rl(n,e){const t=[];for(let r=0;r<n;r++)t.push(e);return t}function h2(n,e,t){let r=d2(n,e);return r>=0?n[1|r]=t:(r=~r,function Od(n,e,t,r){let s=n.length;if(s==e)n.push(t,r);else if(1===s)n.push(r,n[0]),n[0]=t;else{for(s--,n.push(n[s-1],n[s]);s>e;)n[s]=n[s-2],s--;n[e]=t,n[e+1]=r}}(n,r,e,t)),r}function ni(n,e){const t=d2(n,e);if(t>=0)return n[1|t]}function d2(n,e){return function rf(n,e,t){let r=0,s=n.length>>t;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<t];if(e===o)return i<<t;o>e?s=i:r=i+1}return~(s<<t)}(n,e,1)}const Cu={},yu="__NG_DI_FLAG__",ri="ngTempTokenPath",ww=/\n/gm,cf="__source";let Eu;function M0(n){const e=Eu;return Eu=n,e}function bw(n,e=Yt.Default){if(void 0===Eu)throw new Ae(-203,!1);return null===Eu?ed(n,void 0,e):Eu.get(n,e&Yt.Optional?null:void 0,e)}function De(n,e=Yt.Default){return(function JF(){return J9}()||bw)(sn(n),e)}function kr(n,e=Yt.Default){return"number"!=typeof e&&(e=0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)),De(n,e)}function kd(n){const e=[];for(let t=0;t<n.length;t++){const r=sn(n[t]);if(Array.isArray(r)){if(0===r.length)throw new Ae(900,!1);let s,i=Yt.Default;for(let o=0;o<r.length;o++){const c=r[o],u=jv(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}e.push(De(s,i))}else e.push(De(r))}return e}function Dl(n,e){return n[yu]=e,n.prototype[yu]=e,n}function jv(n){return n[yu]}const si=Dl(Ll("Optional"),8),Mu=Dl(Ll("SkipSelf"),4);let Bd,uf,ff;function Yv(){return void 0!==Bd?Bd:typeof document<"u"?document:void 0}function v4(n){return function $d(){if(void 0===uf&&(uf=null,j1.trustedTypes))try{uf=j1.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return uf}()?.createHTML(n)||n}function hf(n){return function Gd(){if(void 0===ff&&(ff=null,j1.trustedTypes))try{ff=j1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return ff}()?.createHTML(n)||n}class C4{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Vw extends C4{getTypeName(){return"HTML"}}class Fw extends C4{getTypeName(){return"Style"}}class Bw extends C4{getTypeName(){return"Script"}}class Xv extends C4{getTypeName(){return"URL"}}class Qv extends C4{getTypeName(){return"ResourceURL"}}function Co(n){return n instanceof C4?n.changingThisBreaksApplicationSecurity:n}function yo(n,e){const t=function Jv(n){return n instanceof C4&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}function nC(n){const e=new Dt(n);return function qw(){try{return!!(new window.DOMParser).parseFromString(v4(""),"text/html")}catch{return!1}}()?new rC(e):e}class rC{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(v4(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class Dt{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const r=this.inertDocument.createElement("body");t.appendChild(r)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=v4(e),t;const r=this.inertDocument.createElement("body");return r.innerHTML=v4(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(e){const t=e.attributes;for(let s=t.length-1;0<s;s--){const o=t.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let r=e.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const sC=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function ia(n){return(n=String(n)).match(sC)?n:"unsafe:"+n}function Cc(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function Tu(...n){const e={};for(const t of n)for(const r in t)t.hasOwnProperty(r)&&(e[r]=!0);return e}const iC=Cc("area,br,col,hr,img,wbr"),oC=Cc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),df=Cc("rp,rt"),wu=Tu(iC,Tu(oC,Cc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Tu(df,Cc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Tu(df,oC)),pf=Cc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),gf=Tu(pf,Cc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Cc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Ww=Cc("script,style,template");class jw{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,r=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let s=this.checkClobberedElement(t,t.nextSibling);if(s){t=s;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!wu.hasOwnProperty(t))return this.sanitizedSomething=!0,!Ww.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const r=e.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!gf.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;pf[c]&&(u=ia(u)),this.buf.push(" ",o,'="',cC(u),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();wu.hasOwnProperty(t)&&!iC.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(cC(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Zw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Yw=/([^\#-~ |!])/g;function cC(n){return n.replace(/&/g,"&amp;").replace(Zw,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(Yw,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let mf;function qd(n,e){let t=null;try{mf=mf||nC(n);let r=e?String(e):"";t=mf.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=t.innerHTML,t=mf.getInertBodyElement(r)}while(r!==i);return v4((new jw).sanitizeChildren(Eo(t)||t))}finally{if(t){const r=Eo(t)||t;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function Eo(n){return"content"in n&&function bu(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var Z1=(()=>((Z1=Z1||{})[Z1.NONE=0]="NONE",Z1[Z1.HTML=1]="HTML",Z1[Z1.STYLE=2]="STYLE",Z1[Z1.SCRIPT=3]="SCRIPT",Z1[Z1.URL=4]="URL",Z1[Z1.RESOURCE_URL=5]="RESOURCE_URL",Z1))();function Ou(n){const e=w0();return e?hf(e.sanitize(Z1.HTML,n)||""):yo(n,"HTML")?hf(Co(n)):qd(Yv(),on(n))}function _3(n){const e=w0();return e?e.sanitize(Z1.URL,n)||"":yo(n,"URL")?Co(n):ia(on(n))}function w0(){const n=Le();return n&&n[12]}const xu=new Rt("ENVIRONMENT_INITIALIZER"),uC=new Rt("INJECTOR",-1),fC=new Rt("INJECTOR_DEF_TYPES");class hC{get(e,t=Cu){if(t===Cu){const r=new Error(`NullInjectorError: No provider for ${U1(e)}!`);throw r.name="NullInjectorError",r}return t}}function ku(...n){return{\u0275providers:jd(0,n)}}function jd(n,...e){const t=[],r=new Set;let s;return ka(e,i=>{const o=i;v3(o,t,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&dC(s,t),t}function dC(n,e){for(let t=0;t<n.length;t++){const{providers:s}=n[t];ka(s,i=>{e.push(i)})}}function v3(n,e,t,r){if(!(n=sn(n)))return!1;let s=null,i=J8(n);const o=!i&&b1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=J8(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of u)v3(h,e,t,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let h;r.add(s);try{ka(i.imports,g=>{v3(g,e,t,r)&&(h||(h=[]),h.push(g))})}finally{}void 0!==h&&dC(h,e)}if(!c){const h=Aa(s)||(()=>new s);e.push({provide:s,useFactory:h,deps:E1},{provide:fC,useValue:s,multi:!0},{provide:xu,useValue:()=>De(s),multi:!0})}const u=i.providers;null==u||c||ka(u,g=>{e.push(g)})}}return s!==n&&void 0!==n.providers}const Kw=P1({provide:String,useValue:P1});function p2(n){return null!==n&&"object"==typeof n&&Kw in n}function Vl(n){return"function"==typeof n}const Yd=new Rt("Set Injector scope."),vf={},mC={};let Kd;function y4(){return void 0===Kd&&(Kd=new hC),Kd}class Ra{}class Cf extends Ra{constructor(e,t,r,s){super(),this.parent=t,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ef(e,o=>this.processProvider(o)),this.records.set(uC,Fl(void 0,this)),s.has("environment")&&this.records.set(Ra,Fl(void 0,this));const i=this.records.get(Yd);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(fC.multi,E1,Yt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=M0(this),r=Zo(void 0);try{return e()}finally{M0(t),Zo(r)}}get(e,t=Cu,r=Yt.Default){this.assertNotDestroyed();const s=M0(this),i=Zo(void 0);try{if(!(r&Yt.SkipSelf)){let c=this.records.get(e);if(void 0===c){const u=function CC(n){return"function"==typeof n||"object"==typeof n&&n instanceof Rt}(e)&&Ln(e);c=u&&this.injectableDefInScope(u)?Fl(Mo(e),vf):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(r&Yt.Self?y4():this.parent).get(e,t=r&Yt.Optional&&t===Cu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[ri]=o[ri]||[]).unshift(U1(e)),s)throw o;return function Ow(n,e,t,r){const s=n[ri];throw e[cf]&&s.unshift(e[cf]),n.message=function Zn(n,e,t,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=U1(e);if(Array.isArray(e))s=e.map(U1).join(" -> ");else if("object"==typeof e){let i=[];for(let o in e)if(e.hasOwnProperty(o)){let c=e[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):U1(c)))}s=`{${i.join(", ")}}`}return`${t}${r?"("+r+")":""}[${s}]: ${n.replace(ww,"\n  ")}`}("\n"+n.message,s,t,r),n.ngTokenPath=s,n[ri]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{Zo(i),M0(s)}}resolveInjectorInitializers(){const e=M0(this),t=Zo(void 0);try{const r=this.get(xu.multi,E1,Yt.Self);for(const s of r)s()}finally{M0(e),Zo(t)}}toString(){const e=[],t=this.records;for(const r of t.keys())e.push(U1(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ae(205,!1)}processProvider(e){let t=Vl(e=sn(e))?e:sn(e&&e.provide);const r=function Qw(n){return p2(n)?Fl(void 0,n.useValue):Fl(yf(n),vf)}(e);if(Vl(e)||!0!==e.multi)this.records.get(t);else{let s=this.records.get(t);s||(s=Fl(void 0,vf,!0),s.factory=()=>kd(s.multi),this.records.set(t,s)),t=e,s.multi.push(e)}this.records.set(t,r)}hydrate(e,t){return t.value===vf&&(t.value=mC,t.value=t.factory()),"object"==typeof t.value&&t.value&&function vC(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=sn(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Mo(n){const e=Ln(n),t=null!==e?e.factory:Aa(n);if(null!==t)return t;if(n instanceof Rt)throw new Ae(204,!1);if(n instanceof Function)return function Lu(n){const e=n.length;if(e>0)throw Rl(e,"?"),new Ae(204,!1);const t=function gv(n){const e=n&&(n[J6]||n[X9]);if(e){const t=function Js(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Ae(204,!1)}function yf(n,e,t){let r;if(Vl(n)){const s=sn(n);return Aa(s)||Mo(s)}if(p2(n))r=()=>sn(n.useValue);else if(function gC(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...kd(n.deps||[]));else if(function Zd(n){return!(!n||!n.useExisting)}(n))r=()=>De(sn(n.useExisting));else{const s=sn(n&&(n.useClass||n.provide));if(!function _C(n){return!!n.deps}(n))return Aa(s)||Mo(s);r=()=>new s(...kd(n.deps))}return r}function Fl(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function Jw(n){return!!n.\u0275providers}function Ef(n,e){for(const t of n)Array.isArray(t)?Ef(t,e):Jw(t)?Ef(t.\u0275providers,e):e(t)}class yC{}class rb{resolveComponentFactory(e){throw function tb(n){const e=Error(`No component factory found for ${U1(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let b0=(()=>{class n{}return n.NULL=new rb,n})();function MB(){return O0(xr(),Le())}function O0(n,e){return new g2(c2(n,e))}let g2=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=MB,n})();function Mf(n){return n instanceof g2?n.nativeElement:n}class A0{}let So=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function sb(){const n=Le(),t=Ai(xr().index,n);return(_o(t)?t:n)[11]}(),n})(),SB=(()=>{class n{}return n.\u0275prov=nt({token:n,providedIn:"root",factory:()=>null}),n})();class N0{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const EC=new N0("14.2.10"),Jd={};function tp(n){return n.ngOriginalError}class I0{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&tp(e);for(;t&&tp(t);)t=tp(t);return t||null}}const db=/^>|^->|<!--|-->|--!>|<!-$/g,pb=/(<|>)/;const np=new Map;let TC=0;const wf="__ngContext__";function Li(n,e){_o(e)?(n[wf]=e[20],function yb(n){np.set(n[20],n)}(e)):n[wf]=e}function Da(n){return n instanceof Function?n():n}var _2=(()=>((_2=_2||{})[_2.Important=1]="Important",_2[_2.DashCase=2]="DashCase",_2))();let ip;function op(n,e){return ip(n,e)}function zu(n){const e=n[3];return vr(e)?e[3]:e}function ap(n){return yc(n[13])}function cp(n){return yc(n[4])}function yc(n){for(;null!==n&&!vr(n);)n=n[4];return n}function Bl(n,e,t,r,s){if(null!=r){let i,o=!1;vr(r)?i=r:_o(r)&&(o=!0,r=r[0]);const c=Cr(r);0===n&&null!==t?null==s?FC(e,t,c):E3(e,t,c,s||null,!0):1===n&&null!==t?E3(e,t,c,s||null,!0):2===n?WC(e,c,o):3===n&&e.destroyNode(c),null!=i&&function Bb(n,e,t,r,s){const i=t[7];i!==Cr(t)&&Bl(e,n,r,i,s);for(let c=10;c<t.length;c++){const u=t[c];L0(u[1],u,n,e,r,i)}}(e,n,i,t,s)}}function lp(n,e){return n.createText(e)}function DC(n,e,t){n.setValue(e,t)}function xb(n,e){return n.createComment(function PC(n){return n.replace(db,e=>e.replace(pb,"\u200b$1\u200b"))}(e))}function up(n,e,t){return n.createElement(e,t)}function zC(n,e){const t=n[9],r=t.indexOf(e),s=e[3];512&e[2]&&(e[2]&=-513,ud(s,-1)),t.splice(r,1)}function fp(n,e){if(n.length<=10)return;const t=10+e,r=n[t];if(r){const s=r[17];null!==s&&s!==n&&zC(s,r),e>0&&(n[t-1][4]=r[4]);const i=y0(n,10+e);!function kb(n,e){L0(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function HC(n,e){if(!(128&e[2])){const t=e[11];t.destroyNode&&L0(n,e,t,3,null,null),function Db(n){let e=n[13];if(!e)return hp(n[1],n);for(;e;){let t=null;if(_o(e))t=e[13];else{const r=e[10];r&&(t=r)}if(!t){for(;e&&!e[4]&&e!==n;)_o(e)&&hp(e[1],e),e=e[3];null===e&&(e=n),_o(e)&&hp(e[1],e),t=e&&e[4]}e=t}}(e)}}function hp(n,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function Vb(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let r=0;r<t.length;r+=2){const s=e[t[r]];if(!(s instanceof fu)){const i=t[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,e),function dp(n,e){const t=n.cleanup,r=e[7];let s=-1;if(null!==t)for(let i=0;i<t.length-1;i+=2)if("string"==typeof t[i]){const o=t[i+1],c="function"==typeof o?o(e):Cr(e[o]),u=r[s=t[i+2]],h=t[i+3];"boolean"==typeof h?c.removeEventListener(t[i],u,h):h>=0?r[s=h]():r[s=-h].unsubscribe(),i+=2}else{const o=r[s=t[i+1]];t[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();e[7]=null}}(n,e),1===e[1].type&&e[11].destroy();const t=e[17];if(null!==t&&vr(e[3])){t!==e[3]&&zC(t,e);const r=e[19];null!==r&&r.detachView(n)}!function Eb(n){np.delete(n[20])}(e)}}function VC(n,e,t){return pp(n,e.parent,t)}function pp(n,e,t){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return t[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===V1.None||s===V1.Emulated)return null}return c2(r,t)}function E3(n,e,t,r,s){n.insertBefore(e,t,r,s)}function FC(n,e,t){n.appendChild(e,t)}function M3(n,e,t,r,s){null!==r?E3(n,e,t,r,s):FC(n,e,t)}function x0(n,e){return n.parentNode(e)}function GC(n,e,t){return qC(n,e,t)}function UC(n,e,t){return 40&n.type?c2(n,t):null}let gp,qC=UC;function Of(n,e){qC=n,gp=e}function Hu(n,e,t,r){const s=VC(n,r,e),i=e[11],c=GC(r.parent||e[6],r,e);if(null!=s)if(Array.isArray(t))for(let u=0;u<t.length;u++)M3(i,s,t[u],c,!1);else M3(i,s,t,c,!1);void 0!==gp&&gp(i,r,e,t,s)}function Vu(n,e){if(null!==e){const t=e.type;if(3&t)return c2(e,n);if(4&t)return k0(-1,n[e.index]);if(8&t){const r=e.child;if(null!==r)return Vu(n,r);{const s=n[e.index];return vr(s)?k0(-1,s):Cr(s)}}if(32&t)return op(e,n)()||Cr(n[e.index]);{const r=$l(n,e);return null!==r?Array.isArray(r)?r[0]:Vu(zu(n[16]),r):Vu(n,e.next)}}return null}function $l(n,e){return null!==e?n[16][6].projection[e.projection]:null}function k0(n,e){const t=10+n+1;if(t<e.length){const r=e[t],s=r[1].firstChild;if(null!==s)return Vu(r,s)}return e[7]}function WC(n,e,t){const r=x0(n,e);r&&function BC(n,e,t,r){n.removeChild(e,t,r)}(n,r,e,t)}function mp(n,e,t,r,s,i,o){for(;null!=t;){const c=r[t.index],u=t.type;if(o&&0===e&&(c&&Li(Cr(c),r),t.flags|=4),64!=(64&t.flags))if(8&u)mp(n,e,t.child,r,s,i,!1),Bl(e,n,s,c,i);else if(32&u){const h=op(t,r);let g;for(;g=h();)Bl(e,n,s,g,i);Bl(e,n,s,c,i)}else 16&u?jC(n,e,r,t,s,i):Bl(e,n,s,c,i);t=o?t.projectionNext:t.next}}function L0(n,e,t,r,s,i){mp(t,r,n.firstChild,e,s,i,!1)}function jC(n,e,t,r,s,i){const o=t[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)Bl(e,n,s,u[h],i);else mp(n,e,u,o[3],s,i,!0)}function Fu(n,e,t){n.setAttribute(e,"style",t)}function Af(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function YC(n,e,t){let r=n.length;for(;;){const s=n.indexOf(e,t);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=e.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}t=s+1}}const KC="ng-template";function _p(n,e,t){let r=0;for(;r<n.length;){let s=n[r++];if(t&&"class"===s){if(s=n[r],-1!==YC(s.toLowerCase(),e,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===e)return!0;return!1}}return!1}function Bu(n){return 4===n.type&&n.value!==KC}function XC(n,e,t){return e===(4!==n.type||t?n.value:KC)}function $b(n,e,t){let r=4;const s=n.attrs||[],i=function Gb(n){for(let e=0;e<n.length;e++)if(Lv(n[e]))return e;return n.length}(s);let o=!1;for(let c=0;c<e.length;c++){const u=e[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!XC(n,u,t)||""===u&&1===e.length){if(za(r))return!1;o=!0}}else{const h=8&r?u:e[++c];if(8&r&&null!==n.attrs){if(!_p(n.attrs,h,t)){if(za(r))return!1;o=!0}continue}const m=QC(8&r?"class":u,s,Bu(n),t);if(-1===m){if(za(r))return!1;o=!0;continue}if(""!==h){let M;M=m>i?"":s[m+1].toLowerCase();const b=8&r?M:null;if(b&&-1!==YC(b,h,0)||2&r&&h!==M){if(za(r))return!1;o=!0}}}}else{if(!o&&!za(r)&&!za(u))return!1;if(o&&za(u))continue;o=!1,r=u|1&r}}return za(r)||o}function za(n){return 0==(1&n)}function QC(n,e,t,r){if(null===e)return-1;let s=0;if(r||!t){let i=!1;for(;s<e.length;){const o=e[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=e[++s];for(;"string"==typeof c;)c=e[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function Ub(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const r=n[t];if("number"==typeof r)return-1;if(r===e)return t;t++}return-1}(e,n)}function JC(n,e,t=!1){for(let r=0;r<e.length;r++)if($b(n,e[r],t))return!0;return!1}function ty(n,e){e:for(let t=0;t<e.length;t++){const r=e[t];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function vp(n,e){return n?":not("+e.trim()+")":e}function qb(n){let e=n[0],t=1,r=2,s="",i=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&r){const c=n[++t];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!za(o)&&(e+=vp(i,s),s=""),r=o,i=i||!za(r);t++}return""!==s&&(e+=vp(i,s)),e}const mn={};function T(n){ry(Qn(),Le(),u2()+n,!1)}function ry(n,e,t,r){if(!r)if(3==(3&e[2])){const i=n.preOrderCheckHooks;null!==i&&Na(e,i,t)}else{const i=n.preOrderHooks;null!==i&&lu(e,i,0,t)}f3(t)}function Mp(n,e=null,t=null,r){const s=oy(n,e,t,r);return s.resolveInjectorInitializers(),s}function oy(n,e=null,t=null,r,s=new Set){const i=[t||E1,ku(n)];return r=r||("object"==typeof n?void 0:U1(n)),new Cf(i,e||y4(),r||null,s)}let ii=(()=>{class n{static create(t,r){if(Array.isArray(t))return Mp({name:""},r,t,"");{const s=t.name??"";return Mp({name:s},t.parent,t.providers,s)}}}return n.THROW_IF_NOT_FOUND=Cu,n.NULL=new hC,n.\u0275prov=nt({token:n,providedIn:"any",factory:()=>De(uC)}),n.__NG_ELEMENT_ID__=-1,n})();function Q(n,e=Yt.Default){const t=Le();return null===t?De(n,e):Q7(xr(),t,sn(n),e)}function kf(){throw new Error("invalid")}function Lf(n,e){return n<<17|e<<2}function Ha(n){return n>>17&32767}function Np(n){return 2|n}function Ec(n){return(131068&n)>>2}function Ul(n,e){return-131069&n|e<<2}function Ip(n){return 1|n}function Cy(n,e){const t=n.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const s=t[r],i=t[r+1];if(-1!==i){const o=n.data[i];ou(s),o.contentQueries(2,e[i],i)}}}function Vf(n,e,t,r,s,i,o,c,u,h,g){const m=e.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==g||n&&1024&n[2])&&(m[2]|=1024),wv(m),m[3]=m[15]=n,m[8]=t,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=h||n&&n[9]||null,m[6]=i,m[20]=function ir(){return TC++}(),m[21]=g,m[16]=2==e.type?n[16]:m,m}function D0(n,e,t,r,s){let i=n.data[e];if(null===i)i=Ff(n,e,t,r,s),function na(){return un.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=t,i.value=r,i.attrs=s;const o=wl();i.injectorIndex=null===o?-1:o.injectorIndex}return gc(i,!0),i}function Ff(n,e,t,r,s){const i=bv(),o=Gr(),u=n.data[e]=function KB(n,e,t,r,s,i){return{type:t,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,t,e,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function ql(n,e,t,r){if(0===t)return-1;const s=e.length;for(let i=0;i<t;i++)e.push(r),n.blueprint.push(r),n.data.push(null);return s}function Bf(n,e,t){bl(e);try{const r=n.viewQuery;null!==r&&Gp(1,r,t);const s=n.template;null!==s&&yy(n,e,s,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Cy(n,e),n.staticViewQueries&&Gp(2,n.viewQuery,t);const i=n.components;null!==i&&function _O(n,e){for(let t=0;t<e.length;t++)r$(n,e[t])}(e,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[2]&=-5,Ol()}}function $f(n,e,t,r){const s=e[2];if(128!=(128&s)){bl(e);try{wv(e),function Ov(n){return un.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&yy(n,e,t,2,r);const o=3==(3&s);if(o){const h=n.preOrderCheckHooks;null!==h&&Na(e,h,null)}else{const h=n.preOrderHooks;null!==h&&lu(e,h,0,null),uu(e,0)}if(function n$(n){for(let e=ap(n);null!==e;e=cp(e)){if(!e[2])continue;const t=e[9];for(let r=0;r<t.length;r++){const s=t[r],i=s[3];0==(512&s[2])&&ud(i,1),s[2]|=512}}}(e),function bO(n){for(let e=ap(n);null!==e;e=cp(e))for(let t=10;t<e.length;t++){const r=e[t],s=r[1];c0(r)&&$f(s,r,s.template,r[8])}}(e),null!==n.contentQueries&&Cy(n,e),o){const h=n.contentCheckHooks;null!==h&&Na(e,h)}else{const h=n.contentHooks;null!==h&&lu(e,h,1),uu(e,1)}!function Hp(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let r=0;r<t.length;r++){const s=t[r];if(s<0)f3(~s);else{const i=s,o=t[++r],c=t[++r];Cw(o,i),c(2,e[i])}}}finally{f3(-1)}}(n,e);const c=n.components;null!==c&&function mO(n,e){for(let t=0;t<e.length;t++)OO(n,e[t])}(e,c);const u=n.viewQuery;if(null!==u&&Gp(2,u,r),o){const h=n.viewCheckHooks;null!==h&&Na(e,h)}else{const h=n.viewHooks;null!==h&&lu(e,h,2),uu(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,ud(e[3],-1))}finally{Ol()}}}function yy(n,e,t,r,s){const i=u2(),o=2&r;try{f3(-1),o&&e.length>22&&ry(n,e,22,!1),t(r,s)}finally{f3(i)}}function Ey(n,e,t){if(q2(e)){const s=e.directiveEnd;for(let i=e.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,t[i],i)}}}function Vp(n,e,t){!fd()||(function Ty(n,e,t,r){const s=t.directiveStart,i=t.directiveEnd;n.firstCreatePass||X7(t,e),Li(r,e);const o=t.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],h=vs(u);h&&TO(e,t,u);const g=Ds(e,n,c,t);Li(g,e),null!==o&&t$(0,c-s,g,u,0,o),h&&(Ai(t.index,e)[8]=g)}}(n,e,t,c2(t,e)),128==(128&t.flags)&&function MO(n,e,t){const r=t.directiveStart,s=t.directiveEnd,i=t.index,o=function pd(){return un.lFrame.currentDirectiveIndex}();try{f3(i);for(let c=r;c<s;c++){const u=n.data[c],h=e[c];u3(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&SO(u,h)}}finally{f3(-1),u3(o)}}(n,e,t))}function z0(n,e,t=c2){const r=e.localNames;if(null!==r){let s=e.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?t(e,n):n[o];n[s++]=c}}}function My(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Sy(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Sy(n,e,t,r,s,i,o,c,u,h){const g=22+r,m=g+s,M=function vO(n,e){const t=[];for(let r=0;r<e;r++)t.push(r<n?null:mn);return t}(g,m),b="function"==typeof h?h():h;return M[1]={type:n,blueprint:M,template:t,queries:null,viewQuery:c,declTNode:e,data:M.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:b,incompleteFirstPass:!1}}function yO(n,e,t,r){const s=xy(e);null===t?s.push(r):(s.push(t),n.firstCreatePass&&ky(n).push(r,s.length-1))}function H0(n,e,t){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(t=null===t?{}:t).hasOwnProperty(r)?t[r].push(e,s):t[r]=[e,s]}return t}function Gf(n,e){const r=e.directiveEnd,s=n.data,i=e.attrs,o=[];let c=null,u=null;for(let h=e.directiveStart;h<r;h++){const g=s[h],m=g.inputs,M=null===i||Bu(e)?null:wO(m,i);o.push(M),c=H0(m,h,c),u=H0(g.outputs,h,u)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=16),c.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=c,e.outputs=u}function Po(n,e,t,r,s,i,o,c){const u=c2(e,t);let g,h=e.inputs;!c&&null!=h&&(g=h[r])?(Zf(n,t,g,r,s),Qo(e)&&Py(t,e.index)):3&e.type&&(r=function Uf(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,e.value||"",r):s,i.setProperty(u,r,s))}function Py(n,e){const t=Ai(e,n);16&t[2]||(t[2]|=32)}function Wl(n,e,t,r){let s=!1;if(fd()){const i=function wy(n,e,t){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];JC(t,o.selectors,!1)&&(s||(s=[]),p0(X7(t,e),n,o.type),vs(o)?(Fp(n,t),s.unshift(o)):s.push(o))}return s}(n,e,t),o=null===r?null:{"":-1};if(null!==i){s=!0,by(t,n.data.length,i.length);for(let g=0;g<i.length;g++){const m=i[g];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,h=ql(n,e,i.length,null);for(let g=0;g<i.length;g++){const m=i[g];t.mergedAttrs=d0(t.mergedAttrs,m.hostAttrs),Oy(n,t,e,h,m),e$(h,m,o),null!==m.contentQueries&&(t.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(t.flags|=128);const M=m.type.prototype;!c&&(M.ngOnChanges||M.ngOnInit||M.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),c=!0),!u&&(M.ngOnChanges||M.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),u=!0),h++}Gf(n,t)}o&&function PO(n,e,t){if(e){const r=n.localNames=[];for(let s=0;s<e.length;s+=2){const i=t[e[s+1]];if(null==i)throw new Ae(-301,!1);r.push(e[s],i)}}}(t,r,o)}return t.mergedAttrs=d0(t.mergedAttrs,t.attrs),s}function qf(n,e,t,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~e.index;(function EO(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function SO(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Fp(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function e$(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;vs(e)&&(t[""]=n)}}function by(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function Oy(n,e,t,r,s){n.data[r]=s;const i=s.factory||(s.factory=Aa(s.type)),o=new fu(i,vs(s),Q);n.blueprint[r]=o,t[r]=o,qf(n,e,0,r,ql(n,t,s.hostVars,mn),s)}function TO(n,e,t){const r=c2(e,n),s=My(t),i=n[10],o=Wf(n,Vf(n,s,null,t.onPush?32:16,r,e,i,i.createRenderer(r,t),null,null,null));n[e.index]=o}function Mc(n,e,t,r,s,i){const o=c2(n,e);Bp(e[11],o,i,n.value,t,r,s)}function Bp(n,e,t,r,s,i,o){if(null==i)n.removeAttribute(e,s,t);else{const c=null==o?on(i):o(i,r||"",s);n.setAttribute(e,s,c,t)}}function t$(n,e,t,r,s,i){const o=i[e];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const h=o[u++],g=o[u++],m=o[u++];null!==c?r.setInput(t,m,h,g):t[g]=m}}}function wO(n,e){let t=null,r=0;for(;r<e.length;){const s=e[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===t&&(t=[]),t.push(s,n[s],e[r+1])),r+=2}else r+=2;else r+=4}return t}function Ay(n,e,t,r){return new Array(n,!0,!1,e,null,0,r,t,null,null)}function OO(n,e){const t=Ai(e,n);if(c0(t)){const r=t[1];48&t[2]?$f(r,t,r.template,t[8]):t[5]>0&&$p(t)}}function $p(n){for(let r=ap(n);null!==r;r=cp(r))for(let s=10;s<r.length;s++){const i=r[s];if(c0(i))if(512&i[2]){const o=i[1];$f(o,i,o.template,i[8])}else i[5]>0&&$p(i)}const t=n[1].components;if(null!==t)for(let r=0;r<t.length;r++){const s=Ai(t[r],n);c0(s)&&s[5]>0&&$p(s)}}function r$(n,e){const t=Ai(e,n),r=t[1];(function AO(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(r,t),Bf(r,t,t[8])}function Wf(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function Ny(n){for(;n;){n[2]|=32;const e=zu(n);if(s0(n)&&!e)return n;n=e}return null}function jf(n,e,t,r=!0){const s=e[10];s.begin&&s.begin();try{$f(n,e,n.template,t)}catch(o){throw r&&Ry(e,o),o}finally{s.end&&s.end()}}function Gp(n,e,t){ou(0),e(n,t)}function xy(n){return n[7]||(n[7]=[])}function ky(n){return n.cleanup||(n.cleanup=[])}function Ry(n,e){const t=n[9],r=t?t.get(I0,null):null;r&&r.handleError(e)}function Zf(n,e,t,r,s){for(let i=0;i<t.length;){const o=t[i++],c=t[i++],u=e[o],h=n.data[o];null!==h.setInput?h.setInput(u,s,r,c):u[c]=s}}function P3(n,e,t){const r=su(e,n);DC(n[11],r,t)}function Gu(n,e,t){let r=t?n.styles:null,s=t?n.classes:null,i=0;if(null!==e)for(let o=0;o<e.length;o++){const c=e[o];"number"==typeof c?i=c:1==i?s=K8(s,c):2==i&&(r=K8(r,c+": "+e[++o]+";"))}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=s:n.classesWithoutHost=s}function Yf(n,e,t,r,s=!1){for(;null!==t;){const i=e[t.index];if(null!==i&&r.push(Cr(i)),vr(i))for(let c=10;c<i.length;c++){const u=i[c],h=u[1].firstChild;null!==h&&Yf(u[1],u,h,r)}const o=t.type;if(8&o)Yf(n,e,t.child,r);else if(32&o){const c=op(t,e);let u;for(;u=c();)r.push(u)}else if(16&o){const c=$l(e,t);if(Array.isArray(c))r.push(...c);else{const u=zu(e[16]);Yf(u[1],u,c,r,!0)}}t=s?t.projectionNext:t.next}return r}class Kf{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Yf(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(vr(e)){const t=e[8],r=t?t.indexOf(this):-1;r>-1&&(fp(e,r),y0(t,r))}this._attachedToViewContainer=!1}HC(this._lView[1],this._lView)}onDestroy(e){yO(this._lView[1],this._lView,null,e)}markForCheck(){Ny(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){jf(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ae(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Rb(n,e){L0(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Ae(902,!1);this._appRef=e}}class IO extends Kf{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;jf(e[1],e,e[8],!1)}checkNoChanges(){}get context(){return null}}class Up extends b0{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=b1(e);return new Uu(t,this.ngModule)}}function xO(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class zy{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){const s=this.injector.get(e,Jd,r);return s!==Jd||t===Jd?s:this.parentInjector.get(e,t,r)}}class Uu extends yC{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Wb(n){return n.map(qb).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return xO(this.componentDef.inputs)}get outputs(){return xO(this.componentDef.outputs)}create(e,t,r,s){let i=(s=s||this.ngModule)instanceof Ra?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new zy(e,i):e,c=o.get(A0,null);if(null===c)throw new Ae(407,!1);const u=o.get(SB,null),h=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",m=r?function CO(n,e,t){return n.selectRootElement(e,t===V1.ShadowDom)}(h,r,this.componentDef.encapsulation):up(h,g,function Dy(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(g)),M=this.componentDef.onPush?288:272,b=Sy(0,null,null,1,0,null,null,null,null,null),L=Vf(null,b,null,M,null,null,c,h,u,o,null);let G,j;bl(L);try{const ie=function LO(n,e,t,r,s,i){const o=t[1];t[22]=n;const u=D0(o,22,2,"#host",null),h=u.mergedAttrs=e.hostAttrs;null!==h&&(Gu(u,h,!0),null!==n&&(_c(s,n,h),null!==u.classes&&Af(s,n,u.classes),null!==u.styles&&Fu(s,n,u.styles)));const g=r.createRenderer(n,e),m=Vf(t,My(e),null,e.onPush?32:16,t[22],u,r,g,i||null,null,null);return o.firstCreatePass&&(p0(X7(u,t),o,e.type),Fp(o,u),by(u,t.length,1)),Wf(t,m),t[22]=m}(m,this.componentDef,L,c,h);if(m)if(r)_c(h,m,["ng-version",EC.full]);else{const{attrs:ye,classes:te}=function ny(n){const e=[],t=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&e.push(i,n[++r]):8===s&&t.push(i);else{if(!za(s))break;s=i}r++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);ye&&_c(h,m,ye),te&&te.length>0&&Af(h,m,te.join(" "))}if(j=ld(b,22),void 0!==t){const ye=j.projection=[];for(let te=0;te<this.ngContentSelectors.length;te++){const xe=t[te];ye.push(null!=xe?Array.from(xe):null)}}G=function Vy(n,e,t,r){const s=t[1],i=function JB(n,e,t){const r=xr();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),Oy(n,r,e,ql(n,e,1,null),t),Gf(n,r));const s=Ds(e,n,r.directiveStart,r);Li(s,e);const i=c2(r,e);return i&&Li(i,e),s}(s,t,e);if(n[8]=t[8]=i,null!==r)for(const c of r)c(i,e);if(e.contentQueries){const c=xr();e.contentQueries(1,i,c.directiveStart)}const o=xr();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(f3(o.index),qf(t[1],o,0,o.directiveStart,o.directiveEnd,e),SO(e,i)),i}(ie,this.componentDef,L,[d]),Bf(b,L,null)}finally{Ol()}return new kO(this.componentType,G,O0(j,L),L,j)}}class kO extends class eb{}{constructor(e,t,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=t,this.hostView=this.changeDetectorRef=new IO(s),this.componentType=e}setInput(e,t){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[e])){const i=this._rootLView;Zf(i[1],i,s,e,t),Py(i,this._tNode.index)}}get injector(){return new g0(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function d(){const n=xr();p3(Le()[1],n)}function l(n){let e=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const r=[n];for(;e;){let s;if(vs(n))s=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Ae(903,!1);s=e.\u0275dir}if(s){if(t){r.push(s);const o=n;o.inputs=p(n.inputs),o.declaredInputs=p(n.declaredInputs),o.outputs=p(n.outputs);const c=s.hostBindings;c&&N(n,c);const u=s.viewQuery,h=s.contentQueries;if(u&&_(n,u),h&&E(n,h),j9(n.inputs,s.inputs),j9(n.declaredInputs,s.declaredInputs),j9(n.outputs,s.outputs),vs(s)&&s.data.animation){const g=n.data;g.animation=(g.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(t=!1)}}e=Object.getPrototypeOf(e)}!function f(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=e+=s.hostVars,s.hostAttrs=d0(s.hostAttrs,t=d0(t,s.hostAttrs))}}(r)}function p(n){return n===K?{}:n===E1?[]:n}function _(n,e){const t=n.viewQuery;n.viewQuery=t?(r,s)=>{e(r,s),t(r,s)}:e}function E(n,e){const t=n.contentQueries;n.contentQueries=t?(r,s,i)=>{e(r,s,i),t(r,s,i)}:e}function N(n,e){const t=n.hostBindings;n.hostBindings=t?(r,s)=>{e(r,s),t(r,s)}:e}let se=null;function Te(){if(!se){const n=j1.Symbol;if(n&&n.iterator)se=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const r=e[t];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(se=r)}}}return se}function He(n){return!!yt(n)&&(Array.isArray(n)||!(n instanceof Map)&&Te()in n)}function yt(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function yn(n,e,t){return n[e]=t}function L1(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function v2(n,e,t,r){const s=L1(n,e,t);return L1(n,e+1,r)||s}function z(n,e,t,r){const s=Le();return L1(s,u0(),e)&&(Qn(),Mc(O1(),s,n,e,t,r)),z}function f1(n,e,t,r){return L1(n,u0(),t)?e+on(t)+r:mn}function zs(n,e,t,r,s,i){const c=v2(n,mc(),t,s);return ta(2),c?e+on(t)+r+on(s)+i:mn}function oa(n,e,t,r,s,i,o,c){const h=function Fa(n,e,t,r,s){const i=v2(n,e,t,r);return L1(n,e+2,s)||i}(n,mc(),t,s,o);return ta(3),h?e+on(t)+r+on(s)+i+on(o)+c:mn}function qu(n,e,t,r,s,i){const o=Le(),c=f1(o,e,t,r);return c!==mn&&Mc(O1(),o,n,c,s,i),qu}function x(n,e,t,r,s,i,o,c){const u=Le(),h=Qn(),g=n+22,m=h.firstCreatePass?function dle(n,e,t,r,s,i,o,c,u){const h=e.consts,g=D0(e,n,4,o||null,l3(h,c));Wl(e,t,g,l3(h,u)),p3(e,g);const m=g.tViews=Sy(2,g,r,s,i,e.directiveRegistry,e.pipeRegistry,null,e.schemas,h);return null!==e.queries&&(e.queries.template(e,g),m.queries=e.queries.embeddedTView(g)),g}(g,h,u,e,t,r,s,i,o):h.data[g];gc(m,!1);const M=u[11].createComment("");Hu(h,u,M,m),Li(M,u),Wf(u,u[g]=Ay(M,u,M,m)),Jo(m)&&Vp(h,u,m),null!=o&&z0(u,m,c)}function Hn(n){return Tl(function W7(){return un.lFrame.contextLView}(),22+n)}function w(n,e,t){const r=Le();return L1(r,u0(),e)&&Po(Qn(),O1(),r,n,e,r[11],t,!1),w}function RO(n,e,t,r,s){const o=s?"class":"style";Zf(n,t,e.inputs[o],o,r)}function O(n,e,t,r){const s=Le(),i=Qn(),o=22+n,c=s[11],u=s[o]=up(c,e,function d3(){return un.lFrame.currentNamespace}()),h=i.firstCreatePass?function gle(n,e,t,r,s,i,o){const c=e.consts,h=D0(e,n,2,s,l3(c,i));return Wl(e,t,h,l3(c,o)),null!==h.attrs&&Gu(h,h.attrs,!1),null!==h.mergedAttrs&&Gu(h,h.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,h),h}(o,i,s,0,e,t,r):i.data[o];gc(h,!0);const g=h.mergedAttrs;null!==g&&_c(c,u,g);const m=h.classes;null!==m&&Af(c,u,m);const M=h.styles;return null!==M&&Fu(c,u,M),64!=(64&h.flags)&&Hu(i,s,u,h),0===function dw(){return un.lFrame.elementDepthCount}()&&Li(u,s),function pw(){un.lFrame.elementDepthCount++}(),Jo(h)&&(Vp(i,s,h),Ey(i,h,s)),null!==r&&z0(s,h),O}function A(){let n=xr();Gr()?hd():(n=n.parent,gc(n,!1));const e=n;!function gw(){un.lFrame.elementDepthCount--}();const t=Qn();return t.firstCreatePass&&(p3(t,n),q2(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function vd(n){return 0!=(16&n.flags)}(e)&&RO(t,e,Le(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function hu(n){return 0!=(32&n.flags)}(e)&&RO(t,e,Le(),e.stylesWithoutHost,!1),A}function X(n,e,t,r){return O(n,e,t,r),A(),X}function dn(n,e,t){const r=Le(),s=Qn(),i=n+22,o=s.firstCreatePass?function mle(n,e,t,r,s){const i=e.consts,o=l3(i,r),c=D0(e,n,8,"ng-container",o);return null!==o&&Gu(c,o,!0),Wl(e,t,c,l3(i,s)),null!==e.queries&&e.queries.elementStart(e,c),c}(i,s,r,e,t):s.data[i];gc(o,!0);const c=r[i]=r[11].createComment("");return Hu(s,r,c,o),Li(c,r),Jo(o)&&(Vp(s,r,o),Ey(s,o,r)),null!=t&&z0(r,o),dn}function pn(){let n=xr();const e=Qn();return Gr()?hd():(n=n.parent,gc(n,!1)),e.firstCreatePass&&(p3(e,n),q2(n)&&e.queries.elementEnd(n)),pn}function Oe(){return Le()}function qp(n){return!!n&&"function"==typeof n.then}const DO=function g$(n){return!!n&&"function"==typeof n.subscribe};function J(n,e,t,r){const s=Le(),i=Qn(),o=xr();return function _$(n,e,t,r,s,i,o,c){const u=Jo(r),g=n.firstCreatePass&&ky(n),m=e[8],M=xy(e);let b=!0;if(3&r.type||c){const j=c2(r,e),ie=c?c(j):j,ye=M.length,te=c?$e=>c(Cr($e[r.index])):r.index;let xe=null;if(!c&&u&&(xe=function _le(n,e,t,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===t&&s[i+1]===r){const c=e[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,e,s,r.index)),null!==xe)(xe.__ngLastListenerFn__||xe).__ngNextListenerFn__=i,xe.__ngLastListenerFn__=i,b=!1;else{i=C$(r,e,m,i,!1);const $e=t.listen(ie,s,i);M.push(i,$e),g&&g.push(s,te,ye,ye+1)}}else i=C$(r,e,m,i,!1);const L=r.outputs;let G;if(b&&null!==L&&(G=L[s])){const j=G.length;if(j)for(let ie=0;ie<j;ie+=2){const et=e[G[ie]][G[ie+1]].subscribe(i),Ft=M.length;M.push(i,et),g&&g.push(s,r.index,Ft,-(Ft+1))}}}(i,s,s[11],o,n,e,0,r),J}function v$(n,e,t,r){try{return!1!==t(r)}catch(s){return Ry(n,s),!1}}function C$(n,e,t,r,s){return function i(o){if(o===Function)return r;Ny(2&n.flags?Ai(n.index,e):e);let u=v$(e,0,r,o),h=i.__ngNextListenerFn__;for(;h;)u=v$(e,0,h,o)&&u,h=h.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function C(n=1){return function Y7(n){return(un.lFrame.contextLView=function cu(n,e){for(;n>0;)e=e[15],n--;return e}(n,un.lFrame.contextLView))[8]}(n)}function vle(n,e){let t=null;const r=function ey(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let s=0;s<e.length;s++){const i=e[s];if("*"!==i){if(null===r?JC(n,i,!0):ty(r,i))return s}else t=s}return t}function h1(n,e,t,r,s){const i=Le(),o=f1(i,e,t,r);return o!==mn&&Po(Qn(),O1(),i,n,o,i[11],s,!1),h1}function ke(n,e,t,r,s,i,o){const c=Le(),u=zs(c,e,t,r,s,i);return u!==mn&&Po(Qn(),O1(),c,n,u,c[11],o,!1),ke}function j2(n,e,t,r,s,i,o,c,u){const h=Le(),g=oa(h,e,t,r,s,i,o,c);return g!==mn&&Po(Qn(),O1(),h,n,g,h[11],u,!1),j2}function A$(n,e,t,r,s){const i=n[t+1],o=null===e;let c=r?Ha(i):Ec(i),u=!1;for(;0!==c&&(!1===u||o);){const g=n[c+1];Ele(n[c],e)&&(u=!0,n[c+1]=r?Ip(g):Np(g)),c=r?Ha(g):Ec(g)}u&&(n[t+1]=r?Np(i):Ip(i))}function Ele(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&d2(n,e)>=0}const oi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function N$(n){return n.substring(oi.key,oi.keyEnd)}function Mle(n){return n.substring(oi.value,oi.valueEnd)}function x$(n,e){const t=oi.textEnd;let r=oi.key=Xf(n,e,t);return t===r?-1:(r=oi.keyEnd=function wle(n,e,t){let r;for(;e<t&&(45===(r=n.charCodeAt(e))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)e++;return e}(n,r,t),r=L$(n,r,t),r=oi.value=Xf(n,r,t),r=oi.valueEnd=function ble(n,e,t){let r=-1,s=-1,i=-1,o=e,c=o;for(;o<t;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=R$(n,u,o,t):e===o-4&&85===i&&82===s&&76===r&&40===u?c=o=R$(n,41,o,t):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,t),L$(n,r,t))}function Xf(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function L$(n,e,t,r){return(e=Xf(n,e,t))<t&&e++,e}function R$(n,e,t,r){let s=-1,i=t;for(;i<r;){const o=n.charCodeAt(i++);if(o==e&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function Fy(n,e){return function T3(n,e,t,r){const s=Le(),i=Qn(),o=ta(2);i.firstUpdatePass&&H$(i,n,o,r),e!==mn&&L1(s,o,e)&&F$(i,i.data[u2()],s,s[11],n,s[o+1]=function Dle(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=U1(Co(n)))),n}(e,t),r,o)}(n,e,null,!0),Fy}function y2(n){!function w3(n,e,t,r){const s=Qn(),i=ta(2);s.firstUpdatePass&&H$(s,null,i,r);const o=Le();if(t!==mn&&L1(o,i,t)){const c=s.data[u2()];if($$(c,r)&&!z$(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(t=K8(u,t||"")),RO(s,c,o,t,r)}else!function Rle(n,e,t,r,s,i,o,c){s===mn&&(s=E1);let u=0,h=0,g=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==g||null!==m;){const M=u<s.length?s[u+1]:void 0,b=h<i.length?i[h+1]:void 0;let G,L=null;g===m?(u+=2,h+=2,M!==b&&(L=m,G=b)):null===m||null!==g&&g<m?(u+=2,L=g):(h+=2,L=m,G=b),null!==L&&F$(n,e,t,r,L,G,o,c),g=u<s.length?s[u]:null,m=h<i.length?i[h]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function Lle(n,e,t){if(null==t||""===t)return E1;const r=[],s=Co(t);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&e(r,s);return r}(n,e,t),r,i)}}(V$,Ole,n,!1)}function Ole(n,e){for(let t=function Ple(n){return function k$(n){oi.key=0,oi.keyEnd=0,oi.value=0,oi.valueEnd=0,oi.textEnd=n.length}(n),x$(n,Xf(n,0,oi.textEnd))}(e);t>=0;t=x$(e,t))V$(n,N$(e),Mle(e))}function z$(n,e){return e>=n.expandoStartIndex}function H$(n,e,t,r){const s=n.data;if(null===s[t+1]){const i=s[u2()],o=z$(n,t);$$(i,r)&&null===e&&!o&&(e=!1),e=function Nle(n,e,t,r){const s=function j7(n){const e=un.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let i=r?e.residualClasses:e.residualStyles;if(null===s)0===(r?e.classBindings:e.styleBindings)&&(t=Wp(t=zO(null,n,e,t,r),e.attrs,r),i=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==s)if(t=zO(s,n,e,t,r),null===i){let u=function Ile(n,e,t){const r=t?e.classBindings:e.styleBindings;if(0!==Ec(r))return n[Ha(r)]}(n,e,r);void 0!==u&&Array.isArray(u)&&(u=zO(null,n,e,u[1],r),u=Wp(u,e.attrs,r),function xle(n,e,t,r){n[Ha(t?e.classBindings:e.styleBindings)]=r}(n,e,r,u))}else i=function kle(n,e,t){let r;const s=e.directiveEnd;for(let i=1+e.directiveStylingLast;i<s;i++)r=Wp(r,n[i].hostAttrs,t);return Wp(r,e.attrs,t)}(n,e,r)}return void 0!==i&&(r?e.residualClasses=i:e.residualStyles=i),t}(s,i,e,r),function Cle(n,e,t,r,s,i){let o=i?e.classBindings:e.styleBindings,c=Ha(o),u=Ec(o);n[r]=t;let g,h=!1;if(Array.isArray(t)){const m=t;g=m[1],(null===g||d2(m,g)>0)&&(h=!0)}else g=t;if(s)if(0!==u){const M=Ha(n[c+1]);n[r+1]=Lf(M,c),0!==M&&(n[M+1]=Ul(n[M+1],r)),n[c+1]=function HB(n,e){return 131071&n|e<<17}(n[c+1],r)}else n[r+1]=Lf(c,0),0!==c&&(n[c+1]=Ul(n[c+1],r)),c=r;else n[r+1]=Lf(u,0),0===c?c=r:n[u+1]=Ul(n[u+1],r),u=r;h&&(n[r+1]=Np(n[r+1])),A$(n,g,r,!0),A$(n,g,r,!1),function yle(n,e,t,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof e&&d2(i,e)>=0&&(t[r+1]=Ip(t[r+1]))}(e,g,n,r,i),o=Lf(c,u),i?e.classBindings=o:e.styleBindings=o}(s,i,e,t,o,r)}}function zO(n,e,t,r,s){let i=null;const o=t.directiveEnd;let c=t.directiveStylingLast;for(-1===c?c=t.directiveStart:c++;c<o&&(i=e[c],r=Wp(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(t.directiveStylingLast=c),r}function Wp(n,e,t){const r=t?1:2;let s=-1;if(null!==e)for(let i=0;i<e.length;i++){const o=e[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),h2(n,o,!!t||e[++i]))}return void 0===n?null:n}function V$(n,e,t){h2(n,e,Co(t))}function F$(n,e,t,r,s,i,o,c){if(!(3&e.type))return;const u=n.data,h=u[c+1];By(function dy(n){return 1==(1&n)}(h)?B$(u,e,t,s,Ec(h),o):void 0)||(By(i)||function iO(n){return 2==(2&n)}(h)&&(i=B$(u,null,t,s,c,o)),function ZC(n,e,t,r,s){if(e)s?n.addClass(t,r):n.removeClass(t,r);else{let i=-1===r.indexOf("-")?void 0:_2.DashCase;null==s?n.removeStyle(t,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=_2.Important),n.setStyle(t,r,s,i))}}(r,o,su(u2(),t),s,i))}function B$(n,e,t,r,s,i){const o=null===e;let c;for(;s>0;){const u=n[s],h=Array.isArray(u),g=h?u[1]:u,m=null===g;let M=t[s+1];M===mn&&(M=m?E1:void 0);let b=m?ni(M,r):g===r?M:void 0;if(h&&!By(b)&&(b=ni(u,r)),By(b)&&(c=b,o))return c;const L=n[s+1];s=o?Ha(L):Ec(L)}if(null!==e){let u=i?e.residualClasses:e.residualStyles;null!=u&&(c=ni(u,r))}return c}function By(n){return void 0!==n}function $$(n,e){return 0!=(n.flags&(e?16:32))}function wt(n,e=""){const t=Le(),r=Qn(),s=n+22,i=r.firstCreatePass?D0(r,s,1,e,null):r.data[s],o=t[s]=lp(t[11],e);Hu(r,t,o,i),gc(i,!1)}function c1(n){return Ri("",n,""),c1}function Ri(n,e,t){const r=Le(),s=f1(r,n,e,t);return s!==mn&&P3(r,u2(),s),Ri}function HO(n,e,t,r,s){const i=Le(),o=zs(i,n,e,t,r,s);return o!==mn&&P3(i,u2(),o),HO}function VO(n,e,t,r,s,i,o){const c=Le(),u=oa(c,n,e,t,r,s,i,o);return u!==mn&&P3(c,u2(),u),VO}function FO(n,e,t){const r=Le();return L1(r,u0(),e)&&Po(Qn(),O1(),r,n,e,r[11],t,!0),FO}const Wu=void 0;var n6e=["en",[["a","p"],["AM","PM"],Wu],[["AM","PM"],Wu,Wu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Wu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Wu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Wu,"{1} 'at' {0}",Wu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function t6e(n){const t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===r?1:5}];let Qf={};function bo(n){const e=function s6e(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=oG(e);if(t)return t;const r=e.split("-")[0];if(t=oG(r),t)return t;if("en"===r)return n6e;throw new Ae(701,!1)}function oG(n){return n in Qf||(Qf[n]=j1.ng&&j1.ng.common&&j1.ng.common.locales&&j1.ng.common.locales[n]),Qf[n]}var Ct=(()=>((Ct=Ct||{})[Ct.LocaleId=0]="LocaleId",Ct[Ct.DayPeriodsFormat=1]="DayPeriodsFormat",Ct[Ct.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ct[Ct.DaysFormat=3]="DaysFormat",Ct[Ct.DaysStandalone=4]="DaysStandalone",Ct[Ct.MonthsFormat=5]="MonthsFormat",Ct[Ct.MonthsStandalone=6]="MonthsStandalone",Ct[Ct.Eras=7]="Eras",Ct[Ct.FirstDayOfWeek=8]="FirstDayOfWeek",Ct[Ct.WeekendRange=9]="WeekendRange",Ct[Ct.DateFormat=10]="DateFormat",Ct[Ct.TimeFormat=11]="TimeFormat",Ct[Ct.DateTimeFormat=12]="DateTimeFormat",Ct[Ct.NumberSymbols=13]="NumberSymbols",Ct[Ct.NumberFormats=14]="NumberFormats",Ct[Ct.CurrencyCode=15]="CurrencyCode",Ct[Ct.CurrencySymbol=16]="CurrencySymbol",Ct[Ct.CurrencyName=17]="CurrencyName",Ct[Ct.Currencies=18]="Currencies",Ct[Ct.Directionality=19]="Directionality",Ct[Ct.PluralCase=20]="PluralCase",Ct[Ct.ExtraData=21]="ExtraData",Ct))();const i6e=["zero","one","two","few","many"],Jf="en-US",$y={marker:"element"},Gy={marker:"ICU"};var ss=(()=>((ss=ss||{})[ss.SHIFT=2]="SHIFT",ss[ss.APPEND_EAGERLY=1]="APPEND_EAGERLY",ss[ss.COMMENT=2]="COMMENT",ss))();let aG=Jf;function cG(n){(function go(n,e){null==n&&w1(e,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(aG=n.toLowerCase().replace(/_/g,"-"))}function lG(n,e,t){const r=e.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?UC(n,0,t):Cr(t[s])}function uG(n,e,t,r,s){const i=e.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&e.type||(c=o,o=s),null!==o&&0==(2&e.flags))for(let u=1;u<i.length;u++)E3(n,o,t[i[u]],c,!1)}}function fG(n,e){if(n.push(e),n.length>1)for(let t=n.length-2;t>=0;t--){const r=n[t];hG(r)||l6e(r,e)&&null===u6e(r)&&f6e(r,e.index)}}function hG(n){return!(64&n.type)}function l6e(n,e){return hG(e)||n.index>e.index}function u6e(n){const e=n.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function f6e(n,e){const t=n.insertBeforeIndex;Array.isArray(t)?t[0]=e:(Of(lG,uG),n.insertBeforeIndex=e)}function jp(n,e){const t=n.data[e];return null===t||"string"==typeof t?null:t.hasOwnProperty("currentCaseLViewIndex")?t:t.value}function p6e(n,e,t){const r=Ff(n,t,64,null,null);return fG(e,r),r}function Uy(n,e){const t=e[n.currentCaseLViewIndex];return null===t?t:t<0?~t:t}function dG(n){return n>>>17}function pG(n){return(131070&n)>>>1}let Zp=0,Yp=0;function mG(n,e,t,r){const s=t[11];let o,i=null;for(let c=0;c<e.length;c++){const u=e[c];if("string"==typeof u){const h=e[++c];null===t[h]&&(t[h]=lp(s,u))}else if("number"==typeof u)switch(1&u){case 0:const h=dG(u);let g,m;if(null===i&&(i=h,o=x0(s,r)),h===i?(g=r,m=o):(g=null,m=Cr(t[h])),null!==m){const G=pG(u);E3(s,m,t[G],g,!1);const ie=jp(n,G);if(null!==ie&&"object"==typeof ie){const ye=Uy(ie,t);null!==ye&&mG(n,ie.create[ye],t,t[ie.anchorIdx])}}break;case 1:const b=e[++c],L=e[++c];Bp(s,su(u>>>1,t),null,null,b,L,null)}else switch(u){case Gy:const h=e[++c],g=e[++c];null===t[g]&&Li(t[g]=xb(s,h),t);break;case $y:const m=e[++c],M=e[++c];null===t[M]&&Li(t[M]=up(s,m,null),t)}}}function _G(n,e,t,r,s){for(let i=0;i<t.length;i++){const o=t[i],c=t[++i];if(o&s){let u="";for(let h=i+1;h<=i+c;h++){const g=t[h];if("string"==typeof g)u+=g;else if("number"==typeof g)if(g<0)u+=on(e[r-g]);else{const m=g>>>2;switch(3&g){case 1:const M=t[++h],b=t[++h],L=n.data[m];"string"==typeof L?Bp(e[11],e[m],null,L,M,u,b):Po(n,L,e,M,u,e[11],b,!1);break;case 0:const G=e[m];null!==G&&DC(e[11],G,u);break;case 2:C6e(n,jp(n,m),e,u);break;case 3:vG(n,jp(n,m),r,e)}}}}else{const u=t[i+1];if(u>0&&3==(3&u)){const g=jp(n,u>>>2);e[g.currentCaseLViewIndex]<0&&vG(n,g,r,e)}}i+=c}}function vG(n,e,t,r){let s=r[e.currentCaseLViewIndex];if(null!==s){let i=Zp;s<0&&(s=r[e.currentCaseLViewIndex]=~s,i=-1),_G(n,r,e.update[s],t,i)}}function C6e(n,e,t,r){const s=function y6e(n,e){let t=n.cases.indexOf(e);if(-1===t)switch(n.type){case 1:{const r=function o6e(n,e){const t=function iG(n){return bo(n)[Ct.PluralCase]}(e)(parseInt(n,10)),r=i6e[t];return void 0!==r?r:"other"}(e,function c6e(){return aG}());t=n.cases.indexOf(r),-1===t&&"other"!==r&&(t=n.cases.indexOf("other"));break}case 0:t=n.cases.indexOf("other")}return-1===t?null:t}(e,r);if(Uy(e,t)!==s&&(CG(n,e,t),t[e.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=t[e.anchorIdx];o&&mG(n,e.create[s],t,o)}}function CG(n,e,t){let r=Uy(e,t);if(null!==r){const s=e.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=su(o,t);null!==c&&WC(t[11],c)}else CG(n,jp(n,~o),t)}}}function E6e(){const n=[];let t,r,e=-1;function i(c,u){e=0;const h=Uy(c,u);r=null!==h?c.remove[h]:E1}function o(){if(e<r.length){const c=r[e++];return c>0?t[c]:(n.push(e,r),i(t[1].data[~c],t),o())}return 0===n.length?null:(r=n.pop(),e=n.pop(),o())}return function s(c,u){for(t=u;n.length;)n.pop();return i(c.value,u),o}}const qy=/\ufffd(\d+):?\d*\ufffd/gi,S6e=/\ufffd(\d+)\ufffd/,EG=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,P6e=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,T6e=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,w6e=/\uE500/g;function MG(n,e,t,r,s,i,o){const c=ql(n,r,1,null);let u=c<<ss.SHIFT,h=wl();e===h&&(h=null),null===h&&(u|=ss.APPEND_EAGERLY),o&&(u|=ss.COMMENT,function LC(n){void 0===ip&&(ip=n())}(E6e)),s.push(u,null===i?"":i);const g=Ff(n,c,o?32:1,null===i?"":i,null);fG(t,g);const m=g.index;return gc(g,!1),null!==h&&e!==h&&function d6e(n,e){let t=n.insertBeforeIndex;null===t?(Of(lG,uG),t=n.insertBeforeIndex=[null,e]):(function u1(n,e,t){n!=e&&w1(t,n,e,"==")}(Array.isArray(t),!0,"Expecting array here"),t.push(e))}(h,m),g}function A6e(n,e,t,r,s,i,o){const c=o.match(qy),u=MG(n,e,t,i,r,c?null:o,!1);c&&Xp(s,o,u.index,null,0,null)}function Xp(n,e,t,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,h=e.split(qy);let g=0;for(let m=0;m<h.length;m++){const M=h[m];if(1&m){const b=s+parseInt(M,10);n.push(-1-b),g|=SG(b)}else""!==M&&n.push(M)}return n.push(t<<2|(r?1:0)),r&&n.push(r,i),n[o]=g,n[c]=n.length-u,g}function SG(n){return 1<<Math.min(n,31)}function PG(n){let e,i,t="",r=0,s=!1;for(;null!==(e=P6e.exec(n));)s?e[0]===`\ufffd/*${i}\ufffd`&&(r=e.index,s=!1):(t+=n.substring(r,e.index+e[0].length),i=e[1],s=!0);return t+=n.slice(r),t}function TG(n,e,t,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:ql(n,e,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function z6e(n,e,t){n.push(SG(e.mainBinding),2,-1-e.mainBinding,t<<2|2)})(t,s,i),function h6e(n,e,t){const r=n.data[e];null===r?n.data[e]=t:r.value=t}(n,i,c);const u=s.values;for(let h=0;h<u.length;h++){const g=u[h],m=[];for(let M=0;M<g.length;M++){const b=g[M];if("string"!=typeof b){const L=m.push(b)-1;g[M]=`\x3c!--\ufffd${L}\ufffd--\x3e`}}o=R6e(n,c,e,t,r,s.cases[h],g.join(""),m)|o}o&&function H6e(n,e,t){n.push(e,1,t<<2|3)}(t,o,i)}function L6e(n){const e=[],t=[];let r=1,s=0;const i=BO(n=n.replace(EG,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&e.push(c);const u=BO(i[o++]);e.length>t.length&&t.push(u)}return{type:r,mainBinding:s,cases:e,values:t}}function BO(n){if(!n)return[];let e=0;const t=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(t.pop(),0==t.length){const u=n.substring(e,c);EG.test(u)?r.push(L6e(u)):r.push(u),e=c+1}}else{if(0==t.length){const u=n.substring(e,c);r.push(u),e=c+1}t.push("{")}}const o=n.substring(e);return r.push(o),r}function R6e(n,e,t,r,s,i,o,c){const u=[],h=[],g=[];e.cases.push(i),e.create.push(u),e.remove.push(h),e.update.push(g);const M=nC(Yv()).getInertBodyElement(o),b=Eo(M)||M;return b?wG(n,e,t,r,u,h,g,b,s,c,0):0}function wG(n,e,t,r,s,i,o,c,u,h,g){let m=0,M=c.firstChild;for(;M;){const b=ql(n,t,1,null);switch(M.nodeType){case Node.ELEMENT_NODE:const L=M,G=L.tagName.toLowerCase();if(wu.hasOwnProperty(G)){$O(s,$y,G,u,b),n.data[b]=G;const te=L.attributes;for(let xe=0;xe<te.length;xe++){const $e=te.item(xe),et=$e.name.toLowerCase();$e.value.match(qy)?gf.hasOwnProperty(et)&&Xp(o,$e.value,b,$e.name,0,pf[et]?ia:null):V6e(s,b,$e)}m=wG(n,e,t,r,s,i,o,M,b,h,g+1)|m,bG(i,b,g)}break;case Node.TEXT_NODE:const j=M.textContent||"",ie=j.match(qy);$O(s,null,ie?"":j,u,b),bG(i,b,g),ie&&(m=Xp(o,j,b,null,0,null)|m);break;case Node.COMMENT_NODE:const ye=S6e.exec(M.textContent||"");if(ye){const xe=h[parseInt(ye[1],10)];$O(s,Gy,"",u,b),TG(n,t,r,u,xe,b),D6e(i,b,g)}}M=M.nextSibling}return m}function bG(n,e,t){0===t&&n.push(e)}function D6e(n,e,t){0===t&&(n.push(~e),n.push(e))}function $O(n,e,t,r,s){null!==e&&n.push(e),n.push(t,s,function g6e(n,e,t){return n|e<<17|t<<1}(0,r,s))}function V6e(n,e,t){n.push(e<<1|1,t.name,t.value)}function ca(n,e,t=-1){const r=Qn(),s=Le(),i=22+n,o=l3(r.consts,e),c=wl();r.firstCreatePass&&function O6e(n,e,t,r,s,i){const o=wl(),c=[],u=[],h=[[]];s=function k6e(n,e){if(function x6e(n){return-1===n}(e))return PG(n);{const t=n.indexOf(`:${e}\ufffd`)+2+e.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${e}\ufffd`));return PG(n.substring(t,r))}}(s,i);const g=function b6e(n){return n.replace(w6e," ")}(s).split(T6e);for(let m=0;m<g.length;m++){let M=g[m];if(0==(1&m)){const b=BO(M);for(let L=0;L<b.length;L++){let G=b[L];if(0==(1&L)){const j=G;""!==j&&A6e(n,o,h[0],c,u,t,j)}else{const j=G;if("object"!=typeof j)throw new Error(`Unable to parse ICU expression in "${s}" message.`);TG(n,t,u,e,j,MG(n,o,h[0],t,c,"",!0).index)}}}else{const b=47===M.charCodeAt(0),G=(M.charCodeAt(b?1:0),22+Number.parseInt(M.substring(b?2:1)));if(b)h.shift(),gc(wl(),!1);else{const j=p6e(n,h[0],G);h.unshift([]),gc(j,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,t);const u=r.data[i],g=pp(r,c===s[6]?null:c,s);(function v6e(n,e,t,r){const s=n[11];for(let i=0;i<e.length;i++){const o=e[i++],c=e[i],u=(o&ss.COMMENT)===ss.COMMENT,h=(o&ss.APPEND_EAGERLY)===ss.APPEND_EAGERLY,g=o>>>ss.SHIFT;let m=n[g];null===m&&(m=n[g]=u?s.createComment(c):lp(s,c)),h&&null!==t&&E3(s,t,m,r,!1)}})(s,u.create,g,c&&8&c.type?s[c.index]:null),l2(!0)}function la(){l2(!1)}function ve(n,e,t){ca(n,e,t),la()}function M1(n){return function m6e(n){n&&(Zp|=1<<Math.min(Yp,31)),Yp++}(L1(Le(),u0(),n)),M1}function A1(n){!function _6e(n,e,t){if(Yp>0){const r=n.data[t];_G(n,e,Array.isArray(r)?r:r.update,mc()-Yp-1,Zp)}Zp=0,Yp=0}(Qn(),Le(),n+22)}function GO(n,e,t,r,s){if(n=sn(n),Array.isArray(n))for(let i=0;i<n.length;i++)GO(n[i],e,t,r,s);else{const i=Qn(),o=Le();let c=Vl(n)?n:sn(n.provide),u=yf(n);const h=xr(),g=1048575&h.providerIndexes,m=h.directiveStart,M=h.providerIndexes>>20;if(Vl(n)||!n.multi){const b=new fu(u,s,Q),L=qO(c,e,s?g:g+M,m);-1===L?(p0(X7(h,o),i,c),UO(i,n,e.length),e.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),t.push(b),o.push(b)):(t[L]=b,o[L]=b)}else{const b=qO(c,e,g+M,m),L=qO(c,e,g,g+M),G=b>=0&&t[b],j=L>=0&&t[L];if(s&&!j||!s&&!G){p0(X7(h,o),i,c);const ie=function J6e(n,e,t,r,s){const i=new fu(n,t,Q);return i.multi=[],i.index=e,i.componentProviders=0,AG(i,s,r&&!t),i}(s?Q6e:X6e,t.length,s,r,u);!s&&j&&(t[L].providerFactory=ie),UO(i,n,e.length,0),e.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),t.push(ie),o.push(ie)}else UO(i,n,b>-1?b:L,AG(t[s?L:b],u,!s&&r));!s&&r&&j&&t[L].componentProviders++}}}function UO(n,e,t,r){const s=Vl(e),i=function Xw(n){return!!n.useClass}(e);if(s||i){const u=(i?sn(e.useClass):e).prototype.ngOnDestroy;if(u){const h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&e.multi){const g=h.indexOf(t);-1===g?h.push(t,[r,u]):h[g+1].push(r,u)}else h.push(t,u)}}}function AG(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function qO(n,e,t,r){for(let s=t;s<r;s++)if(e[s]===n)return s;return-1}function X6e(n,e,t,r){return WO(this.multi,[])}function Q6e(n,e,t,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Ds(t,t[1],this.providerFactory.index,r);i=c.slice(0,o),WO(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],WO(s,i);return i}function WO(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Lr(n,e=[]){return t=>{t.providersResolver=(r,s)=>function K6e(n,e,t){const r=Qn();if(r.firstCreatePass){const s=vs(n);GO(t,r.data,r.blueprint,s,!0),GO(e,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,e)}}class ju{}class NG{}class IG extends ju{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Up(this);const r=mo(e);this._bootstrapComponents=Da(r.bootstrap),this._r3Injector=oy(e,t,[{provide:ju,useValue:this},{provide:b0,useValue:this.componentFactoryResolver}],U1(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class jO extends NG{constructor(e){super(),this.moduleType=e}create(e){return new IG(this.moduleType,e)}}class t0e extends ju{constructor(e,t,r){super(),this.componentFactoryResolver=new Up(this),this.instance=null;const s=new Cf([...e,{provide:ju,useValue:this},{provide:b0,useValue:this.componentFactoryResolver}],t||y4(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Wy(n,e,t=null){return new t0e(n,e,t).injector}let n0e=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const r=jd(0,t.type),s=r.length>0?Wy([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,s)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=nt({token:n,providedIn:"environment",factory:()=>new n(De(Ra))}),n})();function xG(n){n.getStandaloneInjector=e=>e.get(n0e).getOrCreateStandaloneInjector(n)}function K1(n,e,t){const r=Ni()+n,s=Le();return s[r]===mn?yn(s,r,t?e.call(t):e()):function Y1(n,e){return n[e]}(s,r)}function b3(n,e,t,r){return VG(Le(),Ni(),n,e,t,r)}function Qp(n,e){const t=n[e];return t===mn?void 0:t}function VG(n,e,t,r,s,i){const o=e+t;return L1(n,o,s)?yn(n,o+1,i?r.call(i,s):r(s)):Qp(n,o+1)}function O3(n,e){const t=Qn();let r;const s=n+22;t.firstCreatePass?(r=function C0e(n,e){if(e)for(let t=e.length-1;t>=0;t--){const r=e[t];if(n===r.name)return r}}(e,t.pipeRegistry),t.data[s]=r,r.onDestroy&&(t.destroyHooks||(t.destroyHooks=[])).push(s,r.onDestroy)):r=t.data[s];const i=r.factory||(r.factory=Aa(r.type)),o=Zo(Q);try{const c=p4(!1),u=i();return p4(c),function ple(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}(t,Le(),s,u),u}finally{Zo(o)}}function b4(n,e,t){const r=n+22,s=Le(),i=Tl(s,r);return Jp(s,r)?VG(s,Ni(),e,i.transform,t,i):i.transform(t)}function UG(n,e,t,r){const s=n+22,i=Le(),o=Tl(i,s);return Jp(i,s)?function FG(n,e,t,r,s,i,o){const c=e+t;return v2(n,c,s,i)?yn(n,c+2,o?r.call(o,s,i):r(s,i)):Qp(n,c+2)}(i,Ni(),e,o.transform,t,r,o):o.transform(t,r)}function Jp(n,e){return n[1].data[e].pure}function YO(n){return e=>{setTimeout(n,void 0,e)}}const ur=class S0e extends F2{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,r){let s=e,i=t||(()=>null),o=r;if(e&&"object"==typeof e){const u=e;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=YO(i),s&&(s=YO(s)),o&&(o=YO(o)));const c=super.subscribe({next:s,error:i,complete:o});return e instanceof I1&&e.add(c),c}};function P0e(){return this._results[Te()]()}class KO{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Te(),r=KO.prototype;r[t]||(r[t]=P0e)}get changes(){return this._changes||(this._changes=new ur)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const r=this;r.dirty=!1;const s=f2(e);(this._changesDetected=!function bd(n,e,t){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=e[r];if(t&&(s=t(s),i=t(i)),i!==s)return!1}return!0}(r._results,s,t))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let jl=(()=>{class n{}return n.__NG_ELEMENT_ID__=b0e,n})();const T0e=jl,w0e=class extends T0e{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}createEmbeddedView(e,t){const r=this._declarationTContainer.tViews,s=Vf(this._declarationLView,r,e,16,null,r.declTNode,null,null,null,null,t||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),Bf(r,s,e),new Kf(s)}};function b0e(){return jy(xr(),Le())}function jy(n,e){return 4&n.type?new w0e(e,n,O0(n,e)):null}let Ba=(()=>{class n{}return n.__NG_ELEMENT_ID__=O0e,n})();function O0e(){return jG(xr(),Le())}const A0e=Ba,qG=class extends A0e{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return O0(this._hostTNode,this._hostLView)}get injector(){return new g0(this._hostTNode,this._hostLView)}get parentInjector(){const e=xa(this._hostTNode,this._hostLView);if(yd(e)){const t=Il(e,this._hostLView),r=Nl(e);return new g0(t[1].data[r+8],t)}return new g0(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=WG(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=e.createEmbeddedView(t||{},i);return this.insert(o,s),o}createComponent(e,t,r,s,i){const o=e&&!function Ii(n){return"function"==typeof n}(e);let c;if(o)c=t;else{const m=t||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?e:new Uu(b1(e)),h=r||this.parentInjector;if(!i&&null==u.ngModule){const M=(o?h:this.parentInjector).get(Ra,null);M&&(i=M)}const g=u.create(h,s,void 0,i);return this.insert(g.hostView,c),g}insert(e,t){const r=e._lView,s=r[1];if(function iu(n){return vr(n[3])}(r)){const g=this.indexOf(e);if(-1!==g)this.detach(g);else{const m=r[3],M=new qG(m,m[6],m[3]);M.detach(M.indexOf(e))}}const i=this._adjustIndex(t),o=this._lContainer;!function zb(n,e,t,r){const s=10+r,i=t.length;r>0&&(t[s-1][4]=e),r<i-10?(e[4]=t[s],m3(t,10+r,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function Hb(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const c=e[19];null!==c&&c.insertView(n),e[2]|=64}(s,r,o,i);const c=k0(i,o),u=r[11],h=x0(u,o[7]);return null!==h&&function Lb(n,e,t,r,s,i){r[0]=s,r[6]=e,L0(n,r,t,1,s,i)}(s,o[6],u,r,h,c),e.attachToViewContainerRef(),m3(XO(o),i,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=WG(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),r=fp(this._lContainer,t);r&&(y0(XO(this._lContainer),t),HC(r[1],r))}detach(e){const t=this._adjustIndex(e,-1),r=fp(this._lContainer,t);return r&&null!=y0(XO(this._lContainer),t)?new Kf(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function WG(n){return n[8]}function XO(n){return n[8]||(n[8]=[])}function jG(n,e){let t;const r=e[n.index];if(vr(r))t=r;else{let s;if(8&n.type)s=Cr(r);else{const i=e[11];s=i.createComment("");const o=c2(n,e);E3(i,x0(i,o),s,function $C(n,e){return n.nextSibling(e)}(i,o),!1)}e[n.index]=t=Ay(r,e,s,n),Wf(e,t)}return new qG(t,n,e)}class QO{constructor(e){this.queryList=e,this.matches=null}clone(){return new QO(this.queryList)}setDirty(){this.queryList.setDirty()}}class JO{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const r=null!==e.contentQueries?e.contentQueries[0]:t.length,s=[];for(let i=0;i<r;i++){const o=t.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new JO(s)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==QG(e,t).matches&&this.queries[t].setDirty()}}class ZG{constructor(e,t,r=null){this.predicate=e,this.flags=t,this.read=r}}class eA{constructor(e=[]){this.queries=e}elementStart(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let r=0;r<this.length;r++){const s=null!==t?t.length:0,i=this.getByIndex(r).embeddedTView(e,s);i&&(i.indexInDeclarationView=r,null!==t?t.push(i):t=[i])}return null!==t?new eA(t):null}template(e,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class tA{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new tA(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let r=e.parent;for(;null!==r&&8&r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(e,t,x0e(t,i)),this.matchTNodeWithReadOption(e,t,Ur(t,e,i,!1,!1))}else r===jl?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Ur(t,e,r,!1,!1))}matchTNodeWithReadOption(e,t,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===g2||s===Ba||s===jl&&4&t.type)this.addMatch(t.index,-2);else{const i=Ur(t,e,s,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,r)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function x0e(n,e){const t=n.localNames;if(null!==t)for(let r=0;r<t.length;r+=2)if(t[r]===e)return t[r+1];return null}function L0e(n,e,t,r){return-1===t?function k0e(n,e){return 11&n.type?O0(n,e):4&n.type?jy(n,e):null}(e,n):-2===t?function R0e(n,e,t){return t===g2?O0(e,n):t===jl?jy(e,n):t===Ba?jG(e,n):void 0}(n,e,r):Ds(n,n[1],t,e)}function YG(n,e,t,r){const s=e[19].queries[r];if(null===s.matches){const i=n.data,o=t.matches,c=[];for(let u=0;u<o.length;u+=2){const h=o[u];c.push(h<0?null:L0e(e,i[h],o[u+1],t.metadata.read))}s.matches=c}return s.matches}function nA(n,e,t,r){const s=n.queries.getByIndex(t),i=s.matches;if(null!==i){const o=YG(n,e,s,t);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const h=i[c+1],g=e[-u];for(let m=10;m<g.length;m++){const M=g[m];M[17]===M[3]&&nA(M[1],M,h,r)}if(null!==g[9]){const m=g[9];for(let M=0;M<m.length;M++){const b=m[M];nA(b[1],b,h,r)}}}}}return r}function O4(n){const e=Le(),t=Qn(),r=gd();ou(r+1);const s=QG(t,r);if(n.dirty&&function Tv(n){return 4==(4&n[2])}(e)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?nA(t,e,r,[]):YG(t,e,s,r);n.reset(i,Mf),n.notifyOnChanges()}return!0}return!1}function F0(n,e,t){const r=Qn();r.firstCreatePass&&(function XG(n,e,t){null===n.queries&&(n.queries=new eA),n.queries.track(new tA(e,t))}(r,new ZG(n,e,t),-1),2==(2&e)&&(r.staticViewQueries=!0)),function KG(n,e,t){const r=new KO(4==(4&t));yO(n,e,r,r.destroy),null===e[19]&&(e[19]=new JO),e[19].queries.push(new QO(r))}(r,Le(),e)}function A4(){return function D0e(n,e){return n[19].queries[e].queryList}(Le(),gd())}function QG(n,e){return n.queries.getByIndex(e)}function Un(n,e){return jy(n,e)}function Yy(...n){}const Ky=new Rt("Application Initializer");let Xy=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Yy,this.reject=Yy,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const t=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(qp(i))t.push(i);else if(DO(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});t.push(o)}}Promise.all(t).then(()=>{r()}).catch(s=>{this.reject(s)}),0===t.length&&r(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(De(Ky,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const tg=new Rt("AppId",{providedIn:"root",factory:function _U(){return`${cA()}${cA()}${cA()}`}});function cA(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const vU=new Rt("Platform Initializer"),ng=new Rt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),CU=new Rt("appBootstrapListener"),yU=new Rt("AnimationModuleType");let r8e=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const N4=new Rt("LocaleId",{providedIn:"root",factory:()=>kr(N4,Yt.Optional|Yt.SkipSelf)||function s8e(){return typeof $localize<"u"&&$localize.locale||Jf}()});class o8e{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let lA=(()=>{class n{compileModuleSync(t){return new jO(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),i=Da(mo(t).declarations).reduce((o,c)=>{const u=b1(c);return u&&o.push(new Uu(u)),o},[]);return new o8e(r,i)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const l8e=(()=>Promise.resolve(0))();function uA(n){typeof Zone>"u"?l8e.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Er{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ur(!1),this.onMicrotaskEmpty=new ur(!1),this.onStable=new ur(!1),this.onError=new ur(!1),typeof Zone>"u")throw new Ae(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&t,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function u8e(){let n=j1.requestAnimationFrame,e=j1.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function d8e(n){const e=()=>{!function h8e(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(j1,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,hA(n),n.isCheckStableRunning=!0,fA(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),hA(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,s,i,o,c)=>{try{return SU(n),t.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&e(),PU(n)}},onInvoke:(t,r,s,i,o,c,u)=>{try{return SU(n),t.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&e(),PU(n)}},onHasTask:(t,r,s,i)=>{t.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,hA(n),fA(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(t,r,s,i)=>(t.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Er.isInAngularZone())throw new Ae(909,!1)}static assertNotInAngularZone(){if(Er.isInAngularZone())throw new Ae(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,e,f8e,Yy,Yy);try{return i.runTask(o,t,r)}finally{i.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}}const f8e={};function fA(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function hA(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function SU(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function PU(n){n._nesting--,fA(n)}class p8e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ur,this.onMicrotaskEmpty=new ur,this.onStable=new ur,this.onError=new ur}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,s){return e.apply(t,r)}}const TU=new Rt(""),Qy=new Rt("");let gA,dA=(()=>{class n{constructor(t,r,s){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,gA||(function g8e(n){gA=n}(s),s.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Er.assertNotInAngularZone(),uA(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())uA(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:s})}whenStable(t,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,s){return[]}}return n.\u0275fac=function(t){return new(t||n)(De(Er),De(pA),De(Qy))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),pA=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return gA?.findTestabilityInTree(this,t,r)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),B0=null;const wU=new Rt("AllowMultipleToken"),mA=new Rt("PlatformDestroyListeners");class bU{constructor(e,t){this.name=e,this.token=t}}function AU(n,e,t=[]){const r=`Platform: ${e}`,s=new Rt(r);return(i=[])=>{let o=_A();if(!o||o.injector.get(wU,!1)){const c=[...t,...i,{provide:s,useValue:!0}];n?n(c):function v8e(n){if(B0&&!B0.get(wU,!1))throw new Ae(400,!1);B0=n;const e=n.get(IU);(function OU(n){const e=n.get(vU,null);e&&e.forEach(t=>t())})(n)}(function NU(n=[],e){return ii.create({name:e,providers:[{provide:Yd,useValue:"platform"},{provide:mA,useValue:new Set([()=>B0=null])},...n]})}(c,r))}return function y8e(n){const e=_A();if(!e)throw new Ae(401,!1);return e}()}}function _A(){return B0?.get(IU)??null}let IU=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const s=function kU(n,e){let t;return t="noop"===n?new p8e:("zone.js"===n?void 0:n)||new Er(e),t}(r?.ngZone,function xU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:Er,useValue:s}];return s.run(()=>{const o=ii.create({providers:i,parent:this.injector,name:t.moduleType.name}),c=t.create(o),u=c.injector.get(I0,null);if(!u)throw new Ae(402,!1);return s.runOutsideAngular(()=>{const h=s.onError.subscribe({next:g=>{u.handleError(g)}});c.onDestroy(()=>{Jy(this._modules,c),h.unsubscribe()})}),function LU(n,e,t){try{const r=t();return qp(r)?r.catch(s=>{throw e.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const h=c.injector.get(Xy);return h.runInitializers(),h.donePromise.then(()=>(cG(c.injector.get(N4,Jf)||Jf),this._moduleDoBootstrap(c),c))})})}bootstrapModule(t,r=[]){const s=RU({},r);return function m8e(n,e,t){const r=new jO(t);return Promise.resolve(r)}(0,0,t).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(t){const r=t.injector.get(rg);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!t.instance.ngDoBootstrap)throw new Ae(403,!1);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ae(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const t=this._injector.get(mA,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(De(ii))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function RU(n,e){return Array.isArray(e)?e.reduce(RU,n):{...n,...e}}let rg=(()=>{class n{constructor(t,r,s){this._zone=t,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new _r(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new _r(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Er.assertNotInAngularZone(),uA(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{Er.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function lv(...n){const e=i4(n),t=function O7(n,e){return"number"==typeof El(n)?n.pop():e}(n,1/0),r=n;return r.length?1===r.length?po(r[0]):yl(t)(rs(r,e)):dc}(i,o.pipe(function JT(n={}){const{connector:e=(()=>new F2),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,h=0,g=!1,m=!1;const M=()=>{c?.unsubscribe(),c=void 0},b=()=>{M(),o=u=void 0,g=m=!1},L=()=>{const G=o;b(),G?.unsubscribe()};return lr((G,j)=>{h++,!m&&!g&&M();const ie=u=u??e();j.add(()=>{h--,0===h&&!m&&!g&&(c=I7(L,s))}),ie.subscribe(j),!o&&h>0&&(o=new rr({next:ye=>ie.next(ye),error:ye=>{m=!0,M(),c=I7(b,t,ye),ie.error(ye)},complete:()=>{g=!0,M(),c=I7(b,r),ie.complete()}}),po(G).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){const s=t instanceof yC;if(!this._injector.get(Xy).done)throw!s&&function Pl(n){const e=b1(n)||n2(n)||r2(n);return null!==e&&e.standalone}(t),new Ae(405,false);let o;o=s?t:this._injector.get(b0).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const c=function _8e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(ju),h=o.create(ii.NULL,[],r||o.selector,c),g=h.location.nativeElement,m=h.injector.get(TU,null);return m?.registerApplication(g),h.onDestroy(()=>{this.detachView(h.hostView),Jy(this.components,h),m?.unregisterApplication(g)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Ae(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;Jy(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(CU,[]).concat(this._bootstrapListeners).forEach(s=>s(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Jy(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Ae(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(De(Er),De(Ra),De(I0))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Jy(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let zU=!0,Zu=(()=>{class n{}return n.__NG_ELEMENT_ID__=S8e,n})();function S8e(n){return function P8e(n,e,t){if(Qo(n)&&!t){const r=Ai(n.index,e);return new Kf(r,r)}return 47&n.type?new Kf(e[16],e):null}(xr(),Le(),16==(16&n))}class $U{constructor(){}supports(e){return He(e)}create(e){return new N8e(e)}}const A8e=(n,e)=>e;class N8e{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||A8e}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,s=0,i=null;for(;t||r;){const o=!r||t&&t.currentIndex<UU(r,s,i)?t:r,c=UU(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(t=t._next,null==o.previousIndex)s++;else{i||(i=[]);const h=c-s,g=u-s;if(h!=g){for(let M=0;M<h;M++){const b=M<i.length?i[M]:i[M]=0,L=b+M;g<=L&&L<h&&(i[M]=b+1)}i[o.previousIndex]=g-h}}c!==u&&e(o,c,u)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!He(e))throw new Ae(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let s,i,o,t=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let c=0;c<this.length;c++)i=e[c],o=this._trackByFn(c,i),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,i,o,c)),Object.is(t.item,i)||this._addIdentityChange(t,i)):(t=this._mismatch(t,i,o,c),r=!0),t=t._next}else s=0,function ot(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Te()]();let r;for(;!(r=t.next()).done;)e(r.value)}}(e,c=>{o=this._trackByFn(s,c),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,c,o,s)),Object.is(t.item,c)||this._addIdentityChange(t,c)):(t=this._mismatch(t,c,o,s),r=!0),t=t._next,s++}),this.length=s;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,s){let i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,s)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,s)):e=this._addAfter(new I8e(t,r),i,s),e}_verifyReinsertion(e,t,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?e=this._reinsertAfter(i,e._prev,s):e.currentIndex!=s&&(e.currentIndex=s,this._addToMoves(e,s)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const s=e._prevRemoved,i=e._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){const s=null===t?this._itHead:t._next;return e._next=s,e._prev=t,null===s?this._itTail=e:s._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new GU),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,r=e._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new GU),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class I8e{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class x8e{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const t=e._prevDup,r=e._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}class GU{constructor(){this.map=new Map}put(e){const t=e.trackById;let r=this.map.get(t);r||(r=new x8e,this.map.set(t,r)),r.add(e)}get(e,t){const s=this.map.get(e);return s?s.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function UU(n,e,t){const r=n.previousIndex;if(null===r)return r;let s=0;return t&&r<t.length&&(s=t[r]),r+e+s}class qU{constructor(){}supports(e){return e instanceof Map||yt(e)}create(){return new k8e}}class k8e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||yt(e)))throw new Ae(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,s)=>{if(t&&t.key===s)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{const i=this._getOrCreateRecordForKey(s,r);t=this._insertBeforeOrAppend(t,i)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const r=e._prev;return t._next=e,t._prev=r,e._prev=t,r&&(r._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const s=this._records.get(e);this._maybeAddToChanges(s,t);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new L8e(e);return this._records.set(e,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(r=>t(e[r],r))}}class L8e{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function WU(){return new nE([new $U])}let nE=(()=>{class n{constructor(t){this.factories=t}static create(t,r){if(null!=r){const s=r.factories.slice();t=t.concat(s)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||WU()),deps:[[n,new Mu,new si]]}}find(t){const r=this.factories.find(s=>s.supports(t));if(null!=r)return r;throw new Ae(901,!1)}}return n.\u0275prov=nt({token:n,providedIn:"root",factory:WU}),n})();function jU(){return new sg([new qU])}let sg=(()=>{class n{constructor(t){this.factories=t}static create(t,r){if(r){const s=r.factories.slice();t=t.concat(s)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||jU()),deps:[[n,new Mu,new si]]}}find(t){const r=this.factories.find(s=>s.supports(t));if(r)return r;throw new Ae(901,!1)}}return n.\u0275prov=nt({token:n,providedIn:"root",factory:jU}),n})();const z8e=AU(null,"core",[]);let H8e=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(De(rg))},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({}),n})();function Yl(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let rE=null;function I4(){return rE}const Hs=new Rt("DocumentToken");let MA=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:function(){return function $8e(){return De(ZU)}()},providedIn:"platform"}),n})();const G8e=new Rt("Location Initialized");let ZU=(()=>{class n extends MA{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return I4().getBaseHref(this._doc)}onPopState(t){const r=I4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=I4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,s){YU()?this._history.pushState(t,r,s):this.location.hash=s}replaceState(t,r,s){YU()?this._history.replaceState(t,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(De(Hs))},n.\u0275prov=nt({token:n,factory:function(){return function U8e(){return new ZU(De(Hs))}()},providedIn:"platform"}),n})();function YU(){return!!window.history.pushState}function SA(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function KU(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Kl(n){return n&&"?"!==n[0]?"?"+n:n}let Ku=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:function(){return kr(QU)},providedIn:"root"}),n})();const XU=new Rt("appBaseHref");let QU=(()=>{class n extends Ku{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??kr(Hs).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return SA(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Kl(this._platformLocation.search),s=this._platformLocation.hash;return s&&t?`${r}${s}`:r}pushState(t,r,s,i){const o=this.prepareExternalUrl(s+Kl(i));this._platformLocation.pushState(t,r,o)}replaceState(t,r,s,i){const o=this.prepareExternalUrl(s+Kl(i));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(De(MA),De(XU,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),q8e=(()=>{class n extends Ku{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=SA(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,s,i){let o=this.prepareExternalUrl(s+Kl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,r,o)}replaceState(t,r,s,i){let o=this.prepareExternalUrl(s+Kl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(De(MA),De(XU,8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),PA=(()=>{class n{constructor(t){this._subject=new ur,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._baseHref=KU(JU(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Kl(r))}normalize(t){return n.stripTrailingSlash(function j8e(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,JU(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",s=null){this._locationStrategy.pushState(s,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Kl(r)),s)}replaceState(t,r="",s=null){this._locationStrategy.replaceState(s,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Kl(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(s=>s(t,r))}subscribe(t,r,s){return this._subject.subscribe({next:t,error:r,complete:s})}}return n.normalizeQueryParams=Kl,n.joinWithSlash=SA,n.stripTrailingSlash=KU,n.\u0275fac=function(t){return new(t||n)(De(Ku))},n.\u0275prov=nt({token:n,factory:function(){return function W8e(){return new PA(De(Ku))}()},providedIn:"root"}),n})();function JU(n){return n.replace(/\/index.html$/,"")}var ua=(()=>((ua=ua||{})[ua.Decimal=0]="Decimal",ua[ua.Percent=1]="Percent",ua[ua.Currency=2]="Currency",ua[ua.Scientific=3]="Scientific",ua))(),ys=(()=>((ys=ys||{})[ys.Format=0]="Format",ys[ys.Standalone=1]="Standalone",ys))(),Jn=(()=>((Jn=Jn||{})[Jn.Narrow=0]="Narrow",Jn[Jn.Abbreviated=1]="Abbreviated",Jn[Jn.Wide=2]="Wide",Jn[Jn.Short=3]="Short",Jn))(),Wr=(()=>((Wr=Wr||{})[Wr.Short=0]="Short",Wr[Wr.Medium=1]="Medium",Wr[Wr.Long=2]="Long",Wr[Wr.Full=3]="Full",Wr))(),nn=(()=>((nn=nn||{})[nn.Decimal=0]="Decimal",nn[nn.Group=1]="Group",nn[nn.List=2]="List",nn[nn.PercentSign=3]="PercentSign",nn[nn.PlusSign=4]="PlusSign",nn[nn.MinusSign=5]="MinusSign",nn[nn.Exponential=6]="Exponential",nn[nn.SuperscriptingExponent=7]="SuperscriptingExponent",nn[nn.PerMille=8]="PerMille",nn[nn.Infinity=9]="Infinity",nn[nn.NaN=10]="NaN",nn[nn.TimeSeparator=11]="TimeSeparator",nn[nn.CurrencyDecimal=12]="CurrencyDecimal",nn[nn.CurrencyGroup=13]="CurrencyGroup",nn))();function sE(n,e){return Pc(bo(n)[Ct.DateFormat],e)}function iE(n,e){return Pc(bo(n)[Ct.TimeFormat],e)}function oE(n,e){return Pc(bo(n)[Ct.DateTimeFormat],e)}function Sc(n,e){const t=bo(n),r=t[Ct.NumberSymbols][e];if(typeof r>"u"){if(e===nn.CurrencyDecimal)return t[Ct.NumberSymbols][nn.Decimal];if(e===nn.CurrencyGroup)return t[Ct.NumberSymbols][nn.Group]}return r}function tq(n){if(!n[Ct.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Ct.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Pc(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function wA(n){const[e,t]=n.split(":");return{hours:+e,minutes:+t}}const oue=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ig={},aue=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var ai=(()=>((ai=ai||{})[ai.Short=0]="Short",ai[ai.ShortGMT=1]="ShortGMT",ai[ai.Long=2]="Long",ai[ai.Extended=3]="Extended",ai))(),fn=(()=>((fn=fn||{})[fn.FullYear=0]="FullYear",fn[fn.Month=1]="Month",fn[fn.Date=2]="Date",fn[fn.Hours=3]="Hours",fn[fn.Minutes=4]="Minutes",fn[fn.Seconds=5]="Seconds",fn[fn.FractionalSeconds=6]="FractionalSeconds",fn[fn.Day=7]="Day",fn))(),Dn=(()=>((Dn=Dn||{})[Dn.DayPeriods=0]="DayPeriods",Dn[Dn.Days=1]="Days",Dn[Dn.Months=2]="Months",Dn[Dn.Eras=3]="Eras",Dn))();function nq(n,e,t,r){let s=function mue(n){if(iq(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return aE(s,i-1,o)}const t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(oue))return function _ue(n){const e=new Date(0);let t=0,r=0;const s=n[8]?e.setUTCFullYear:e.setFullYear,i=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-t,c=Number(n[5]||0)-r,u=Number(n[6]||0),h=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(e,o,c,u,h),e}(r)}const e=new Date(n);if(!iq(e))throw new Error(`Unable to convert "${n}" into a date`);return e}(n);e=Xl(t,e)||e;let c,o=[];for(;e;){if(c=aue.exec(e),!c){o.push(e);break}{o=o.concat(c.slice(1));const g=o.pop();if(!g)break;e=g}}let u=s.getTimezoneOffset();r&&(u=sq(r,u),s=function gue(n,e,t){const r=t?-1:1,s=n.getTimezoneOffset();return function pue(n,e){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+e),n}(n,r*(sq(e,s)-s))}(s,r,!0));let h="";return o.forEach(g=>{const m=function due(n){if(OA[n])return OA[n];let e;switch(n){case"G":case"GG":case"GGG":e=fr(Dn.Eras,Jn.Abbreviated);break;case"GGGG":e=fr(Dn.Eras,Jn.Wide);break;case"GGGGG":e=fr(Dn.Eras,Jn.Narrow);break;case"y":e=Fs(fn.FullYear,1,0,!1,!0);break;case"yy":e=Fs(fn.FullYear,2,0,!0,!0);break;case"yyy":e=Fs(fn.FullYear,3,0,!1,!0);break;case"yyyy":e=Fs(fn.FullYear,4,0,!1,!0);break;case"Y":e=fE(1);break;case"YY":e=fE(2,!0);break;case"YYY":e=fE(3);break;case"YYYY":e=fE(4);break;case"M":case"L":e=Fs(fn.Month,1,1);break;case"MM":case"LL":e=Fs(fn.Month,2,1);break;case"MMM":e=fr(Dn.Months,Jn.Abbreviated);break;case"MMMM":e=fr(Dn.Months,Jn.Wide);break;case"MMMMM":e=fr(Dn.Months,Jn.Narrow);break;case"LLL":e=fr(Dn.Months,Jn.Abbreviated,ys.Standalone);break;case"LLLL":e=fr(Dn.Months,Jn.Wide,ys.Standalone);break;case"LLLLL":e=fr(Dn.Months,Jn.Narrow,ys.Standalone);break;case"w":e=bA(1);break;case"ww":e=bA(2);break;case"W":e=bA(1,!0);break;case"d":e=Fs(fn.Date,1);break;case"dd":e=Fs(fn.Date,2);break;case"c":case"cc":e=Fs(fn.Day,1);break;case"ccc":e=fr(Dn.Days,Jn.Abbreviated,ys.Standalone);break;case"cccc":e=fr(Dn.Days,Jn.Wide,ys.Standalone);break;case"ccccc":e=fr(Dn.Days,Jn.Narrow,ys.Standalone);break;case"cccccc":e=fr(Dn.Days,Jn.Short,ys.Standalone);break;case"E":case"EE":case"EEE":e=fr(Dn.Days,Jn.Abbreviated);break;case"EEEE":e=fr(Dn.Days,Jn.Wide);break;case"EEEEE":e=fr(Dn.Days,Jn.Narrow);break;case"EEEEEE":e=fr(Dn.Days,Jn.Short);break;case"a":case"aa":case"aaa":e=fr(Dn.DayPeriods,Jn.Abbreviated);break;case"aaaa":e=fr(Dn.DayPeriods,Jn.Wide);break;case"aaaaa":e=fr(Dn.DayPeriods,Jn.Narrow);break;case"b":case"bb":case"bbb":e=fr(Dn.DayPeriods,Jn.Abbreviated,ys.Standalone,!0);break;case"bbbb":e=fr(Dn.DayPeriods,Jn.Wide,ys.Standalone,!0);break;case"bbbbb":e=fr(Dn.DayPeriods,Jn.Narrow,ys.Standalone,!0);break;case"B":case"BB":case"BBB":e=fr(Dn.DayPeriods,Jn.Abbreviated,ys.Format,!0);break;case"BBBB":e=fr(Dn.DayPeriods,Jn.Wide,ys.Format,!0);break;case"BBBBB":e=fr(Dn.DayPeriods,Jn.Narrow,ys.Format,!0);break;case"h":e=Fs(fn.Hours,1,-12);break;case"hh":e=Fs(fn.Hours,2,-12);break;case"H":e=Fs(fn.Hours,1);break;case"HH":e=Fs(fn.Hours,2);break;case"m":e=Fs(fn.Minutes,1);break;case"mm":e=Fs(fn.Minutes,2);break;case"s":e=Fs(fn.Seconds,1);break;case"ss":e=Fs(fn.Seconds,2);break;case"S":e=Fs(fn.FractionalSeconds,1);break;case"SS":e=Fs(fn.FractionalSeconds,2);break;case"SSS":e=Fs(fn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=lE(ai.Short);break;case"ZZZZZ":e=lE(ai.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=lE(ai.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=lE(ai.Long);break;default:return null}return OA[n]=e,e}(g);h+=m?m(s,t,u):"''"===g?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function aE(n,e,t){const r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function Xl(n,e){const t=function Z8e(n){return bo(n)[Ct.LocaleId]}(n);if(ig[t]=ig[t]||{},ig[t][e])return ig[t][e];let r="";switch(e){case"shortDate":r=sE(n,Wr.Short);break;case"mediumDate":r=sE(n,Wr.Medium);break;case"longDate":r=sE(n,Wr.Long);break;case"fullDate":r=sE(n,Wr.Full);break;case"shortTime":r=iE(n,Wr.Short);break;case"mediumTime":r=iE(n,Wr.Medium);break;case"longTime":r=iE(n,Wr.Long);break;case"fullTime":r=iE(n,Wr.Full);break;case"short":const s=Xl(n,"shortTime"),i=Xl(n,"shortDate");r=cE(oE(n,Wr.Short),[s,i]);break;case"medium":const o=Xl(n,"mediumTime"),c=Xl(n,"mediumDate");r=cE(oE(n,Wr.Medium),[o,c]);break;case"long":const u=Xl(n,"longTime"),h=Xl(n,"longDate");r=cE(oE(n,Wr.Long),[u,h]);break;case"full":const g=Xl(n,"fullTime"),m=Xl(n,"fullDate");r=cE(oE(n,Wr.Full),[g,m])}return r&&(ig[t][e]=r),r}function cE(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return null!=e&&r in e?e[r]:t})),n}function N3(n,e,t="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=t));let o=String(n);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),i+o}function Fs(n,e,t=0,r=!1,s=!1){return function(i,o){let c=function lue(n,e){switch(n){case fn.FullYear:return e.getFullYear();case fn.Month:return e.getMonth();case fn.Date:return e.getDate();case fn.Hours:return e.getHours();case fn.Minutes:return e.getMinutes();case fn.Seconds:return e.getSeconds();case fn.FractionalSeconds:return e.getMilliseconds();case fn.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((t>0||c>-t)&&(c+=t),n===fn.Hours)0===c&&-12===t&&(c=12);else if(n===fn.FractionalSeconds)return function cue(n,e){return N3(n,3).substring(0,e)}(c,e);const u=Sc(o,nn.MinusSign);return N3(c,e,u,r,s)}}function fr(n,e,t=ys.Format,r=!1){return function(s,i){return function uue(n,e,t,r,s,i){switch(t){case Dn.Months:return function X8e(n,e,t){const r=bo(n),i=Pc([r[Ct.MonthsFormat],r[Ct.MonthsStandalone]],e);return Pc(i,t)}(e,s,r)[n.getMonth()];case Dn.Days:return function K8e(n,e,t){const r=bo(n),i=Pc([r[Ct.DaysFormat],r[Ct.DaysStandalone]],e);return Pc(i,t)}(e,s,r)[n.getDay()];case Dn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const h=function tue(n){const e=bo(n);return tq(e),(e[Ct.ExtraData][2]||[]).map(r=>"string"==typeof r?wA(r):[wA(r[0]),wA(r[1])])}(e),g=function nue(n,e,t){const r=bo(n);tq(r);const i=Pc([r[Ct.ExtraData][0],r[Ct.ExtraData][1]],e)||[];return Pc(i,t)||[]}(e,s,r),m=h.findIndex(M=>{if(Array.isArray(M)){const[b,L]=M,G=o>=b.hours&&c>=b.minutes,j=o<L.hours||o===L.hours&&c<L.minutes;if(b.hours<L.hours){if(G&&j)return!0}else if(G||j)return!0}else if(M.hours===o&&M.minutes===c)return!0;return!1});if(-1!==m)return g[m]}return function Y8e(n,e,t){const r=bo(n),i=Pc([r[Ct.DayPeriodsFormat],r[Ct.DayPeriodsStandalone]],e);return Pc(i,t)}(e,s,r)[o<12?0:1];case Dn.Eras:return function Q8e(n,e){return Pc(bo(n)[Ct.Eras],e)}(e,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(s,i,n,e,t,r)}}function lE(n){return function(e,t,r){const s=-1*r,i=Sc(t,nn.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case ai.Short:return(s>=0?"+":"")+N3(o,2,i)+N3(Math.abs(s%60),2,i);case ai.ShortGMT:return"GMT"+(s>=0?"+":"")+N3(o,1,i);case ai.Long:return"GMT"+(s>=0?"+":"")+N3(o,2,i)+":"+N3(Math.abs(s%60),2,i);case ai.Extended:return 0===r?"Z":(s>=0?"+":"")+N3(o,2,i)+":"+N3(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function rq(n){return aE(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function bA(n,e=!1){return function(t,r){let s;if(e){const i=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();s=1+Math.floor((o+i)/7)}else{const i=rq(t),o=function hue(n){const e=aE(n,0,1).getDay();return aE(n,0,1+(e<=4?4:11)-e)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return N3(s,n,Sc(r,nn.MinusSign))}}function fE(n,e=!1){return function(t,r){return N3(rq(t).getFullYear(),n,Sc(r,nn.MinusSign),e)}}const OA={};function sq(n,e){n=n.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function iq(n){return n instanceof Date&&!isNaN(n.valueOf())}const vue=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function xA(n){const e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}function lq(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[s,i]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(s.trim()===e)return decodeURIComponent(i)}return null}let hn=(()=>{class n{constructor(t,r,s,i){this._iterableDiffers=t,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(He(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),t.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),t.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${U1(r.item)}`);this._toggleClass(r.item,!0)}),t.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(r=>this._toggleClass(r,!0)):Object.keys(t).forEach(r=>this._toggleClass(r,!!t[r])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(r=>this._toggleClass(r,!1)):Object.keys(t).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(t,r){(t=t.trim())&&t.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(t){return new(t||n)(Q(nE),Q(sg),Q(g2),Q(So))},n.\u0275dir=Ut({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class Iue{constructor(e,t,r,s){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let En=(()=>{class n{constructor(t,r,s){this._viewContainer=t,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new Iue(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),hq(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}t.forEachIdentityChange(s=>{hq(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(Q(Ba),Q(jl),Q(nE))},n.\u0275dir=Ut({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function hq(n,e){n.context.$implicit=e.item}let Kt=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new kue,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){dq("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){dq("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(Q(Ba),Q(jl))},n.\u0275dir=Ut({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class kue{constructor(){this.$implicit=null,this.ngIf=null}}function dq(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${U1(e)}'.`)}let mq=(()=>{class n{constructor(t){this._locale=t}transform(t,r,s){if(!function DA(n){return!(null==n||""===n||n!=n)}(t))return null;s=s||this._locale;try{return function Pue(n,e,t){return function NA(n,e,t,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let h=function wue(n){let r,s,i,o,c,e=Math.abs(n)+"",t=0;for((s=e.indexOf("."))>-1&&(e=e.replace(".","")),(i=e.search(/e/i))>0?(s<0&&(s=i),s+=+e.slice(i+1),e=e.substring(0,i)):s<0&&(s=e.length),i=0;"0"===e.charAt(i);i++);if(i===(c=e.length))r=[0],s=1;else{for(c--;"0"===e.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(e.charAt(i))}return s>22&&(r=r.splice(0,21),t=s-1,s=1),{digits:r,exponent:t,integerLen:s}}(n);o&&(h=function Tue(n){if(0===n.digits[0])return n;const e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===e?n.digits.push(0,0):1===e&&n.digits.push(0),n.integerLen+=2),n}(h));let g=e.minInt,m=e.minFrac,M=e.maxFrac;if(i){const ye=i.match(vue);if(null===ye)throw new Error(`${i} is not a valid digit info`);const te=ye[1],xe=ye[3],$e=ye[5];null!=te&&(g=xA(te)),null!=xe&&(m=xA(xe)),null!=$e?M=xA($e):null!=xe&&m>M&&(M=m)}!function bue(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(e,s),t);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const h=e+n.integerLen,g=r.reduceRight(function(m,M,b,L){return L[b]=(M+=m)<10?M:M-10,u&&(0===L[b]&&b>=h?L.pop():u=!1),M>=10?1:0},0);g&&(r.unshift(g),n.integerLen++)}(h,m,M);let b=h.digits,L=h.integerLen;const G=h.exponent;let j=[];for(u=b.every(ye=>!ye);L<g;L++)b.unshift(0);for(;L<0;L++)b.unshift(0);L>0?j=b.splice(L,b.length):(j=b,b=[0]);const ie=[];for(b.length>=e.lgSize&&ie.unshift(b.splice(-e.lgSize,b.length).join(""));b.length>e.gSize;)ie.unshift(b.splice(-e.gSize,b.length).join(""));b.length&&ie.unshift(b.join("")),c=ie.join(Sc(t,r)),j.length&&(c+=Sc(t,s)+j.join("")),G&&(c+=Sc(t,nn.Exponential)+"+"+G)}else c=Sc(t,nn.Infinity);return c=n<0&&!u?e.negPre+c+e.negSuf:e.posPre+c+e.posSuf,c}(n,function IA(n,e="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";t.posPre=c.substring(0,c.indexOf("#"));for(let g=0;g<u.length;g++){const m=u.charAt(g);"0"===m?t.minFrac=t.maxFrac=g+1:"#"===m?t.maxFrac=g+1:t.posSuf+=m}const h=c.split(",");if(t.gSize=h[1]?h[1].length:0,t.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const g=s.length-t.posPre.length-t.posSuf.length,m=i.indexOf("#");t.negPre=i.substring(0,m).replace(/'/g,""),t.negSuf=i.slice(m+g).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}(function TA(n,e){return bo(n)[Ct.NumberFormats][e]}(e,ua.Decimal),Sc(e,nn.MinusSign)),e,nn.Group,nn.Decimal,t)}(function zA(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(t),s,r)}catch(i){throw function I3(n,e){return new Ae(2100,!1)}()}}}return n.\u0275fac=function(t){return new(t||n)(Q(N4,16))},n.\u0275pipe=ti({name:"number",type:n,pure:!0,standalone:!0}),n})();let i5e=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({}),n})();let l5e=(()=>{class n{}return n.\u0275prov=nt({token:n,providedIn:"root",factory:()=>new u5e(De(Hs),window)}),n})();class u5e{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function f5e(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(e)||i.querySelector(`[name="${e}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,s=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=vq(this.window.history)||vq(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function vq(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class Cq{}class FA extends class A5e extends class B8e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function F8e(n){rE||(rE=n)}(new FA)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function N5e(){return cg=cg||document.querySelector("base"),cg?cg.getAttribute("href"):null}();return null==t?null:function I5e(n){pE=pE||document.createElement("a"),pE.setAttribute("href",n);const e=pE.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){cg=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return lq(document.cookie,e)}}let pE,cg=null;const Sq=new Rt("TRANSITION_ID"),k5e=[{provide:Ky,useFactory:function x5e(n,e,t){return()=>{t.get(Xy).donePromise.then(()=>{const r=I4(),s=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[Sq,Hs,ii],multi:!0}];let R5e=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const gE=new Rt("EventManagerPlugins");let mE=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(s=>s.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,s){return this._findPluginFor(r).addEventListener(t,r,s)}addGlobalEventListener(t,r,s){return this._findPluginFor(r).addGlobalEventListener(t,r,s)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(De(gE),De(Er))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class Pq{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const s=I4().getGlobalEventTarget(this._doc,e);if(!s)throw new Error(`Unsupported event target ${s} for event ${t}`);return this.addEventListener(s,t,r)}}let Tq=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),lg=(()=>{class n extends Tq{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,s){t.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(wq),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(t,s,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(wq))}}return n.\u0275fac=function(t){return new(t||n)(De(Hs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();function wq(n){I4().remove(n)}const BA={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},$A=/%COMP%/g;function _E(n,e,t){for(let r=0;r<e.length;r++){let s=e[r];Array.isArray(s)?_E(n,s,t):(s=s.replace($A,n),t.push(s))}return t}function Aq(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let vE=(()=>{class n{constructor(t,r,s){this.eventManager=t,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new GA(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case V1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new B5e(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(t),s}case 1:case V1.ShadowDom:return new $5e(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const s=_E(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(De(mE),De(lg),De(tg))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class GA{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(BA[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(Iq(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Iq(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,s){if(s){t=s+":"+t;const i=BA[s];i?e.setAttributeNS(i,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const s=BA[r];s?e.removeAttributeNS(s,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,s){s&(_2.DashCase|_2.Important)?e.style.setProperty(t,r,s&_2.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&_2.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Aq(r)):this.eventManager.addEventListener(e,t,Aq(r))}}function Iq(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class B5e extends GA{constructor(e,t,r,s){super(e),this.component=r;const i=_E(s+"-"+r.id,r.styles,[]);t.addStyles(i),this.contentAttr=function H5e(n){return"_ngcontent-%COMP%".replace($A,n)}(s+"-"+r.id),this.hostAttr=function V5e(n){return"_nghost-%COMP%".replace($A,n)}(s+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class $5e extends GA{constructor(e,t,r,s){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=_E(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let G5e=(()=>{class n extends Pq{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,s){return t.addEventListener(r,s,!1),()=>this.removeEventListener(t,r,s)}removeEventListener(t,r,s){return t.removeEventListener(r,s)}}return n.\u0275fac=function(t){return new(t||n)(De(Hs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const xq=["alt","control","meta","shift"],U5e={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},q5e={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let W5e=(()=>{class n extends Pq{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>I4().onAndCancel(t,i.domEventName,o))}static parseEventName(t){const r=t.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),xq.forEach(h=>{const g=r.indexOf(h);g>-1&&(r.splice(g,1),o+=h+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(t,r){let s=U5e[t.key]||t.key,i="";return r.indexOf("code.")>-1&&(s=t.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),xq.forEach(o=>{o!==s&&(0,q5e[o])(t)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(t,r,s){return i=>{n.matchEventFullKeyCode(i,t)&&s.runGuarded(()=>r(i))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(De(Hs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const Lq=[{provide:ng,useValue:"browser"},{provide:vU,useValue:function j5e(){FA.makeCurrent()},multi:!0},{provide:Hs,useFactory:function Y5e(){return function Dw(n){Bd=n}(document),document},deps:[]}],K5e=AU(z8e,"browser",Lq),Rq=new Rt(""),Dq=[{provide:Qy,useClass:class L5e{addToWindow(e){j1.getAngularTestability=(r,s=!0)=>{const i=e.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},j1.getAllAngularTestabilities=()=>e.getAllTestabilities(),j1.getAllAngularRootElements=()=>e.getAllRootElements(),j1.frameworkStabilizers||(j1.frameworkStabilizers=[]),j1.frameworkStabilizers.push(r=>{const s=j1.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?I4().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:TU,useClass:dA,deps:[Er,pA,Qy]},{provide:dA,useClass:dA,deps:[Er,pA,Qy]}],zq=[{provide:Yd,useValue:"root"},{provide:I0,useFactory:function Z5e(){return new I0},deps:[]},{provide:gE,useClass:G5e,multi:!0,deps:[Hs,Er,ng]},{provide:gE,useClass:W5e,multi:!0,deps:[Hs]},{provide:vE,useClass:vE,deps:[mE,lg,tg]},{provide:A0,useExisting:vE},{provide:Tq,useExisting:lg},{provide:lg,useClass:lg,deps:[Hs]},{provide:mE,useClass:mE,deps:[gE,Er]},{provide:Cq,useClass:R5e,deps:[]},[]];let Hq=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:tg,useValue:t.appId},{provide:Sq,useExisting:tg},k5e]}}}return n.\u0275fac=function(t){return new(t||n)(De(Rq,12))},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({providers:[...zq,...Dq],imports:[i5e,H8e]}),n})(),Vq=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(De(Hs))},n.\u0275prov=nt({token:n,factory:function(t){let r=null;return r=t?new t:function Q5e(){return new Vq(De(Hs))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let $q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:function(t){let r=null;return r=t?new(t||n):De(Gq),r},providedIn:"root"}),n})(),Gq=(()=>{class n extends $q{constructor(t){super(),this._doc=t}sanitize(t,r){if(null==r)return null;switch(t){case Z1.NONE:return r;case Z1.HTML:return yo(r,"HTML")?Co(r):qd(this._doc,String(r)).toString();case Z1.STYLE:return yo(r,"Style")?Co(r):r;case Z1.SCRIPT:if(yo(r,"Script"))return Co(r);throw new Error("unsafe value used in a script context");case Z1.URL:return yo(r,"URL")?Co(r):ia(String(r));case Z1.RESOURCE_URL:if(yo(r,"ResourceURL"))return Co(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function eC(n){return new Vw(n)}(t)}bypassSecurityTrustStyle(t){return function tC(n){return new Fw(n)}(t)}bypassSecurityTrustScript(t){return function $w(n){return new Bw(n)}(t)}bypassSecurityTrustUrl(t){return function Gw(n){return new Xv(n)}(t)}bypassSecurityTrustResourceUrl(t){return function Uw(n){return new Qv(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(De(Hs))},n.\u0275prov=nt({token:n,factory:function(t){let r=null;return r=t?new t:function i7e(n){return new Gq(n.get(Hs))}(De(ii)),r},providedIn:"root"}),n})();const{isArray:o7e}=Array,{getPrototypeOf:a7e,prototype:c7e,keys:l7e}=Object;function Uq(n){if(1===n.length){const e=n[0];if(o7e(e))return{args:e,keys:null};if(function u7e(n){return n&&"object"==typeof n&&a7e(n)===c7e}(e)){const t=l7e(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}const{isArray:f7e}=Array;function qq(n){return Cn(e=>function h7e(n,e){return f7e(e)?n(...e):n(e)}(n,e))}function Wq(n,e){return n.reduce((t,r,s)=>(t[r]=e[s],t),{})}let jq=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(Q(So),Q(g2))},n.\u0275dir=Ut({type:n}),n})(),Xu=(()=>{class n extends jq{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,features:[l]}),n})();const x4=new Rt("NgValueAccessor"),p7e={provide:x4,useExisting:T1(()=>WA),multi:!0};let WA=(()=>{class n extends Xu{writeValue(t){this.setProperty("checked",t)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,r){1&t&&J("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[Lr([p7e]),l]}),n})();const g7e={provide:x4,useExisting:T1(()=>k4),multi:!0},_7e=new Rt("CompositionEventMode");let k4=(()=>{class n extends jq{constructor(t,r,s){super(t,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function m7e(){const n=I4()?I4().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(Q(So),Q(g2),Q(_7e,8))},n.\u0275dir=Ut({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&J("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[Lr([g7e]),l]}),n})();function G0(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function Zq(n){return null!=n&&"number"==typeof n.length}const Y2=new Rt("NgValidators"),U0=new Rt("NgAsyncValidators"),C7e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ug{static min(e){return function Yq(n){return e=>{if(G0(e.value)||G0(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function Kq(n){return e=>{if(G0(e.value)||G0(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return Xq(e)}static requiredTrue(e){return function Qq(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function Jq(n){return G0(n.value)||C7e.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function eW(n){return e=>G0(e.value)||!Zq(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return tW(e)}static pattern(e){return function nW(n){if(!n)return CE;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(G0(r.value))return null;const s=r.value;return e.test(s)?null:{pattern:{requiredPattern:t,actualValue:s}}}}(e)}static nullValidator(e){return null}static compose(e){return cW(e)}static composeAsync(e){return lW(e)}}function Xq(n){return G0(n.value)?{required:!0}:null}function tW(n){return e=>Zq(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}function CE(n){return null}function rW(n){return null!=n}function sW(n){return qp(n)?rs(n):n}function iW(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function oW(n,e){return e.map(t=>t(n))}function aW(n){return n.map(e=>function y7e(n){return!n.validate}(e)?e:t=>e.validate(t))}function cW(n){if(!n)return null;const e=n.filter(rW);return 0==e.length?null:function(t){return iW(oW(t,e))}}function jA(n){return null!=n?cW(aW(n)):null}function lW(n){if(!n)return null;const e=n.filter(rW);return 0==e.length?null:function(t){return function d7e(...n){const e=tn(n),{args:t,keys:r}=Uq(n),s=new _r(i=>{const{length:o}=t;if(!o)return void i.complete();const c=new Array(o);let u=o,h=o;for(let g=0;g<o;g++){let m=!1;po(t[g]).subscribe(ns(i,M=>{m||(m=!0,h--),c[g]=M},()=>u--,void 0,()=>{(!u||!m)&&(h||i.next(r?Wq(r,c):c),i.complete())}))}});return e?s.pipe(qq(e)):s}(oW(t,e).map(sW)).pipe(Cn(iW))}}function ZA(n){return null!=n?lW(aW(n)):null}function uW(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function fW(n){return n._rawValidators}function hW(n){return n._rawAsyncValidators}function YA(n){return n?Array.isArray(n)?n:[n]:[]}function yE(n,e){return Array.isArray(n)?n.includes(e):n===e}function dW(n,e){const t=YA(e);return YA(n).forEach(s=>{yE(t,s)||t.push(s)}),t}function pW(n,e){return YA(e).filter(t=>!yE(n,t))}class gW{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=jA(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=ZA(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Ao extends gW{get formDirective(){return null}get path(){return null}}class q0 extends gW{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class mW{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Ql=(()=>{class n extends mW{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(Q(q0,2))},n.\u0275dir=Ut({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&Fy("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),Qu=(()=>{class n extends mW{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(Q(Ao,10))},n.\u0275dir=Ut({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){2&t&&Fy("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const fg="VALID",ME="INVALID",nh="PENDING",hg="DISABLED";function JA(n){return(SE(n)?n.validators:n)||null}function vW(n){return Array.isArray(n)?jA(n):n||null}function eN(n,e){return(SE(e)?e.asyncValidators:n)||null}function CW(n){return Array.isArray(n)?ZA(n):n||null}function SE(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function yW(n,e,t){const r=n.controls;if(!(e?Object.keys(r):r).length)throw new Ae(1e3,"");if(!r[t])throw new Ae(1001,"")}function EW(n,e,t){n._forEachChild((r,s)=>{if(void 0===t[s])throw new Ae(1002,"")})}class PE{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=vW(this._rawValidators),this._composedAsyncValidatorFn=CW(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===fg}get invalid(){return this.status===ME}get pending(){return this.status==nh}get disabled(){return this.status===hg}get enabled(){return this.status!==hg}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=vW(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=CW(e)}addValidators(e){this.setValidators(dW(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(dW(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(pW(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(pW(e,this._rawAsyncValidators))}hasValidator(e){return yE(this._rawValidators,e)}hasAsyncValidator(e){return yE(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=nh,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=hg,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=fg,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===fg||this.status===nh)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?hg:fg}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=nh,this._hasOwnPendingAsyncValidator=!0;const t=sW(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,s)=>r&&r._find(s),this)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ur,this.statusChanges=new ur}_calculateStatus(){return this._allControlsDisabled()?hg:this.errors?ME:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(nh)?nh:this._anyControlsHaveStatus(ME)?ME:fg}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){SE(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}}class W0 extends PE{constructor(e,t,r){super(JA(t),eN(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){EW(this,0,e),Object.keys(e).forEach(r=>{yW(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{const s=this.controls[r];s&&s.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,s)=>{r.reset(e[s],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,s)=>((r.enabled||this.disabled)&&(t[s]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((s,i)=>{r=t(r,s,i)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}class MW extends W0{}function TE(n,e){return[...e.path,n]}function dg(n,e){tN(n,e),e.valueAccessor.writeValue(n.value),n.disabled&&e.valueAccessor.setDisabledState?.(!0),function O7e(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&SW(n,e)})}(n,e),function N7e(n,e){const t=(r,s)=>{e.valueAccessor.writeValue(r),s&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function A7e(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&SW(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function b7e(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function wE(n,e,t=!0){const r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),OE(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function bE(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function tN(n,e){const t=fW(n);null!==e.validator?n.setValidators(uW(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=hW(n);null!==e.asyncValidator?n.setAsyncValidators(uW(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();bE(e._rawValidators,s),bE(e._rawAsyncValidators,s)}function OE(n,e){let t=!1;if(null!==n){if(null!==e.validator){const s=fW(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==e.validator);i.length!==s.length&&(t=!0,n.setValidators(i))}}if(null!==e.asyncValidator){const s=hW(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==e.asyncValidator);i.length!==s.length&&(t=!0,n.setAsyncValidators(i))}}}const r=()=>{};return bE(e._rawValidators,r),bE(e._rawAsyncValidators,r),t}function SW(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function PW(n,e){tN(n,e)}function nN(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function wW(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function rN(n,e){if(!e)return null;let t,r,s;return Array.isArray(e),e.forEach(i=>{i.constructor===k4?t=i:function k7e(n){return Object.getPrototypeOf(n.constructor)===Xu}(i)?r=i:s=i}),s||r||t||null}const R7e={provide:Ao,useExisting:T1(()=>gg)},pg=(()=>Promise.resolve())();let gg=(()=>{class n extends Ao{constructor(t,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new ur,this.form=new W0({},jA(t),ZA(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){pg.then(()=>{const r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),dg(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){pg.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){pg.then(()=>{const r=this._findContainer(t.path),s=new W0({});PW(s,t),r.registerControl(t.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){pg.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){pg.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,wW(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return n.\u0275fac=function(t){return new(t||n)(Q(Y2,10),Q(U0,10))},n.\u0275dir=Ut({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,r){1&t&&J("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Lr([R7e]),l]}),n})();function bW(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function OW(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const $a=class extends PE{constructor(e=null,t,r){super(JA(t),eN(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),SE(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=OW(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){bW(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){bW(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){OW(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},H7e={provide:q0,useExisting:T1(()=>mg)},IW=(()=>Promise.resolve())();let mg=(()=>{class n extends q0{constructor(t,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new $a,this._registered=!1,this.update=new ur,this._parent=t,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=rN(0,i)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),nN(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){dg(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){IW.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,s=0!==r&&Yl(r);IW.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?TE(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(Q(Ao,9),Q(Y2,10),Q(U0,10),Q(x4,10),Q(Zu,8))},n.\u0275dir=Ut({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Lr([H7e]),l,a2]}),n})(),Ju=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ut({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),kW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({}),n})();const $7e={provide:x4,useExisting:T1(()=>AE),multi:!0};let AE=(()=>{class n extends Xu{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=r=>{t(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,r){1&t&&J("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[Lr([$7e]),l]}),n})();const sN=new Rt("NgModelWithFormControlWarning"),G7e={provide:q0,useExisting:T1(()=>iN)};let iN=(()=>{class n extends q0{constructor(t,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new ur,this._ngModelWarningSent=!1,this._setValidators(t),this._setAsyncValidators(r),this.valueAccessor=rN(0,s)}set isDisabled(t){}ngOnChanges(t){if(this._isControlChanged(t)){const r=t.form.previousValue;r&&wE(r,this,!1),dg(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}nN(t,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&wE(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_isControlChanged(t){return t.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(Q(Y2,10),Q(U0,10),Q(x4,10),Q(sN,8))},n.\u0275dir=Ut({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Lr([G7e]),l,a2]}),n})();const U7e={provide:Ao,useExisting:T1(()=>e5)};let e5=(()=>{class n extends Ao{constructor(t,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new ur,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(OE(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const r=this.form.get(t.path);return dg(r,t),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){wE(t.control||null,t,!1),function L7e(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this.submitted=!0,wW(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const r=t.control,s=this.form.get(t.path);r!==s&&(wE(r||null,t),(n=>n instanceof $a)(s)&&(dg(s,t),t.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const r=this.form.get(t.path);PW(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const r=this.form.get(t.path);r&&function I7e(n,e){return OE(n,e)}(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){tN(this.form,this),this._oldForm&&OE(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(Q(Y2,10),Q(U0,10))},n.\u0275dir=Ut({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,r){1&t&&J("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Lr([U7e]),l,a2]}),n})();const j7e={provide:q0,useExisting:T1(()=>rh)};let rh=(()=>{class n extends q0{constructor(t,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new ur,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=rN(0,i)}set isDisabled(t){}ngOnChanges(t){this._added||this._setUpControl(),nN(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return TE(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(Q(Ao,13),Q(Y2,10),Q(U0,10),Q(x4,10),Q(sN,8))},n.\u0275dir=Ut({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Lr([j7e]),l,a2]}),n})();const Z7e={provide:x4,useExisting:T1(()=>NE),multi:!0};function DW(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let NE=(()=>{class n extends Xu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const s=DW(this._getOptionId(t),t);this.setProperty("value",s)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){const r=function Y7e(n){return n.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r):t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,r){1&t&&J("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Lr([Z7e]),l]}),n})(),_g=(()=>{class n{constructor(t,r,s){this._element=t,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(DW(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(Q(g2),Q(So),Q(NE,9))},n.\u0275dir=Ut({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const K7e={provide:x4,useExisting:T1(()=>cN),multi:!0};function zW(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let cN=(()=>{class n extends Xu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let r;if(this.value=t,Array.isArray(t)){const s=t.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const h=this._getOptionValue(o[c].value);s.push(h)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const h=this._getOptionValue(u.value);s.push(h)}}}this.value=s,t(s)}}_registerOption(t){const r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){const r=function X7e(n){return n.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,r){1&t&&J("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Lr([K7e]),l]}),n})(),vg=(()=>{class n{constructor(t,r,s){this._element=t,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(zW(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(zW(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(Q(g2),Q(So),Q(cN,9))},n.\u0275dir=Ut({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let t5=(()=>{class n{constructor(){this._validator=CE}ngOnChanges(t){if(this.inputName in t){const r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):CE,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ut({type:n,features:[a2]}),n})();const efe={provide:Y2,useExisting:T1(()=>n5),multi:!0};let n5=(()=>{class n extends t5{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Yl,this.createValidator=t=>Xq}enabled(t){return t}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,r){2&t&&z("required",r._enabled?"":null)},inputs:{required:"required"},features:[Lr([efe]),l]}),n})();const sfe={provide:Y2,useExisting:T1(()=>lN),multi:!0};let lN=(()=>{class n extends t5{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=t=>function HW(n){return"number"==typeof n?n:parseInt(n,10)}(t),this.createValidator=t=>tW(t)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275dir=Ut({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(t,r){2&t&&z("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Lr([sfe]),l]}),n})(),WW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({imports:[kW]}),n})(),ofe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({imports:[WW]}),n})(),jW=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:sN,useValue:t.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({imports:[WW]}),n})();class ZW extends PE{constructor(e,t,r){super(JA(t),eN(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,r={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,t={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,r={}){let s=this._adjustIndex(e);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),t&&(this.controls.splice(s,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){EW(this,0,e),e.forEach((r,s)=>{yW(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((r,s)=>{r.reset(e[s],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((t,r)=>!!r._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,r)=>{e(t,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}}function YW(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let afe=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const t=new n;return t.useNonNullable=!0,t}group(t,r=null){const s=this._reduceControls(t);let i={};return YW(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new W0(s,i)}record(t,r=null){const s=this._reduceControls(t);return new MW(s,r)}control(t,r,s){let i={};return this.useNonNullable?(YW(r)?i=r:(i.validators=r,i.asyncValidators=s),new $a(t,{...i,nonNullable:!0})):new $a(t,r,s)}array(t,r,s){const i=t.map(o=>this._createControl(o));return new ZW(i,r,s)}_reduceControls(t){const r={};return Object.keys(t).forEach(s=>{r[s]=this._createControl(t[s])}),r}_createControl(t){return t instanceof $a||t instanceof PE?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:jW}),n})();function Xt(...n){return rs(n,i4(n))}function j0(n,e){return ln(e)?ze(n,e,1):ze(n,1)}function Jl(n,e){return lr((t,r)=>{let s=0;t.subscribe(ns(r,i=>n.call(e,i,s++)&&r.next(i)))})}class KW{}class XW{}class e6{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const s=t.slice(0,r),i=s.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let r=e[t];const s=t.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(t,s))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof e6?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new e6;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof e6?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const s=("a"===e.op?this.headers.get(t):void 0)||[];s.push(...r),this.headers.set(t,s);break;case"d":const i=e.value;if(i){let o=this.headers.get(t);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class cfe{encodeKey(e){return QW(e)}encodeValue(e){return QW(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const ufe=/%(\d[a-f0-9])/gi,ffe={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function QW(n){return encodeURIComponent(n).replace(ufe,(e,t)=>ffe[t]??e)}function IE(n){return`${n}`}class Z0{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new cfe,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function lfe(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[e.decodeKey(s),""]:[e.decodeKey(s.slice(0,i)),e.decodeValue(s.slice(i+1))],u=t.get(o)||[];u.push(c),t.set(o,u)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t],s=Array.isArray(r)?r.map(IE):[IE(r)];this.map.set(t,s)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const s=e[r];Array.isArray(s)?s.forEach(i=>{t.push({param:r,value:i,op:"a"})}):t.push({param:r,value:s,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Z0({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(IE(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const s=r.indexOf(IE(e.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class hfe{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function JW(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function ej(n){return typeof Blob<"u"&&n instanceof Blob}function tj(n){return typeof FormData<"u"&&n instanceof FormData}class Cg{constructor(e,t,r,s){let i;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function dfe(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new e6),this.context||(this.context=new hfe),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const c=t.indexOf("?");this.urlWithParams=t+(-1===c?"?":c<t.length-1?"&":"")+o}}else this.params=new Z0,this.urlWithParams=t}serializeBody(){return null===this.body?null:JW(this.body)||ej(this.body)||tj(this.body)||function pfe(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Z0?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||tj(this.body)?null:ej(this.body)?this.body.type||null:JW(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Z0?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,i=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,c=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let u=e.headers||this.headers,h=e.params||this.params;const g=e.context??this.context;return void 0!==e.setHeaders&&(u=Object.keys(e.setHeaders).reduce((m,M)=>m.set(M,e.setHeaders[M]),u)),e.setParams&&(h=Object.keys(e.setParams).reduce((m,M)=>m.set(M,e.setParams[M]),h)),new Cg(t,r,i,{params:h,headers:u,context:g,reportProgress:c,responseType:s,withCredentials:o})}}var Bs=(()=>((Bs=Bs||{})[Bs.Sent=0]="Sent",Bs[Bs.UploadProgress=1]="UploadProgress",Bs[Bs.ResponseHeader=2]="ResponseHeader",Bs[Bs.DownloadProgress=3]="DownloadProgress",Bs[Bs.Response=4]="Response",Bs[Bs.User=5]="User",Bs))();class uN{constructor(e,t=200,r="OK"){this.headers=e.headers||new e6,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class fN extends uN{constructor(e={}){super(e),this.type=Bs.ResponseHeader}clone(e={}){return new fN({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class xE extends uN{constructor(e={}){super(e),this.type=Bs.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new xE({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class nj extends uN{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function hN(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let gfe=(()=>{class n{constructor(t){this.handler=t}request(t,r,s={}){let i;if(t instanceof Cg)i=t;else{let u,h;u=s.headers instanceof e6?s.headers:new e6(s.headers),s.params&&(h=s.params instanceof Z0?s.params:new Z0({fromObject:s.params})),i=new Cg(t,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=Xt(i).pipe(j0(u=>this.handler.handle(u)));if(t instanceof Cg||"events"===s.observe)return o;const c=o.pipe(Jl(u=>u instanceof xE));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(Cn(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(Cn(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(Cn(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(Cn(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new Z0).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,s={}){return this.request("PATCH",t,hN(s,r))}post(t,r,s={}){return this.request("POST",t,hN(s,r))}put(t,r,s={}){return this.request("PUT",t,hN(s,r))}}return n.\u0275fac=function(t){return new(t||n)(De(KW))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class rj{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const sj=new Rt("HTTP_INTERCEPTORS");let mfe=(()=>{class n{intercept(t,r){return r.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const _fe=/^\)\]\}',?\n/;let ij=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new _r(r=>{const s=this.xhrFactory.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((b,L)=>s.setRequestHeader(b,L.join(","))),t.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const b=t.detectContentTypeHeader();null!==b&&s.setRequestHeader("Content-Type",b)}if(t.responseType){const b=t.responseType.toLowerCase();s.responseType="json"!==b?b:"text"}const i=t.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const b=s.statusText||"OK",L=new e6(s.getAllResponseHeaders()),G=function vfe(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||t.url;return o=new fN({headers:L,status:s.status,statusText:b,url:G}),o},u=()=>{let{headers:b,status:L,statusText:G,url:j}=c(),ie=null;204!==L&&(ie=typeof s.response>"u"?s.responseText:s.response),0===L&&(L=ie?200:0);let ye=L>=200&&L<300;if("json"===t.responseType&&"string"==typeof ie){const te=ie;ie=ie.replace(_fe,"");try{ie=""!==ie?JSON.parse(ie):null}catch(xe){ie=te,ye&&(ye=!1,ie={error:xe,text:ie})}}ye?(r.next(new xE({body:ie,headers:b,status:L,statusText:G,url:j||void 0})),r.complete()):r.error(new nj({error:ie,headers:b,status:L,statusText:G,url:j||void 0}))},h=b=>{const{url:L}=c(),G=new nj({error:b,status:s.status||0,statusText:s.statusText||"Unknown Error",url:L||void 0});r.error(G)};let g=!1;const m=b=>{g||(r.next(c()),g=!0);let L={type:Bs.DownloadProgress,loaded:b.loaded};b.lengthComputable&&(L.total=b.total),"text"===t.responseType&&!!s.responseText&&(L.partialText=s.responseText),r.next(L)},M=b=>{let L={type:Bs.UploadProgress,loaded:b.loaded};b.lengthComputable&&(L.total=b.total),r.next(L)};return s.addEventListener("load",u),s.addEventListener("error",h),s.addEventListener("timeout",h),s.addEventListener("abort",h),t.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",M)),s.send(i),r.next({type:Bs.Sent}),()=>{s.removeEventListener("error",h),s.removeEventListener("abort",h),s.removeEventListener("load",u),s.removeEventListener("timeout",h),t.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",M)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(De(Cq))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const dN=new Rt("XSRF_COOKIE_NAME"),pN=new Rt("XSRF_HEADER_NAME");class oj{}let Cfe=(()=>{class n{constructor(t,r,s){this.doc=t,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=lq(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(De(Hs),De(ng),De(dN))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),gN=(()=>{class n{constructor(t,r){this.tokenService=t,this.headerName=r}intercept(t,r){const s=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(t);const i=this.tokenService.getToken();return null!==i&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,i)})),r.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(De(oj),De(pN))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),yfe=(()=>{class n{constructor(t,r){this.backend=t,this.injector=r,this.chain=null}handle(t){if(null===this.chain){const r=this.injector.get(sj,[]);this.chain=r.reduceRight((s,i)=>new rj(s,i),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(De(XW),De(ii))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),Efe=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:gN,useClass:mfe}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:dN,useValue:t.cookieName}:[],t.headerName?{provide:pN,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({providers:[gN,{provide:sj,useExisting:gN,multi:!0},{provide:oj,useClass:Cfe},{provide:dN,useValue:"XSRF-TOKEN"},{provide:pN,useValue:"X-XSRF-TOKEN"}]}),n})(),Mfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({providers:[gfe,{provide:KW,useClass:yfe},ij,{provide:XW,useExisting:ij}],imports:[Efe.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class x3 extends F2{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const kE=ts(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function aj(...n){const e=i4(n),t=tn(n),{args:r,keys:s}=Uq(n);if(0===r.length)return rs([],e);const i=new _r(function Sfe(n,e,t=_l){return r=>{cj(e,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)cj(e,()=>{const h=rs(n[u],e);let g=!1;h.subscribe(ns(r,m=>{i[u]=m,g||(g=!0,c--),c||r.next(t(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,s?o=>Wq(s,o):_l));return t?i.pipe(qq(t)):i}function cj(n,e,t){n?Rs(t,n,e):e()}function mN(...n){return function Pfe(){return yl(1)}()(rs(n,i4(n)))}function lj(n){return new _r(e=>{po(n()).subscribe(e)})}function yg(n,e){const t=ln(n)?n:()=>n,r=s=>s.error(t());return new _r(e?s=>e.schedule(r,0,s):r)}function _N(){return lr((n,e)=>{let t=null;n._refCount++;const r=ns(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const s=n._connection,i=t;t=null,s&&(!i||s===i)&&s.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class uj extends _r{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,X_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new I1;const t=this.getSubject();e.add(this.source.subscribe(ns(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=I1.EMPTY)}return e}refCount(){return _N()(this)}}function L4(n,e){return lr((t,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();t.subscribe(ns(r,u=>{s?.unsubscribe();let h=0;const g=i++;po(n(u,g)).subscribe(s=ns(r,m=>r.next(e?e(u,m,g,h++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function Eg(n){return n<=0?()=>dc:lr((e,t)=>{let r=0;e.subscribe(ns(t,s=>{++r<=n&&(t.next(s),n<=r&&t.complete())}))})}function LE(n){return lr((e,t)=>{let r=!1;e.subscribe(ns(t,s=>{r=!0,t.next(s)},()=>{r||t.next(n),t.complete()}))})}function fj(n=wfe){return lr((e,t)=>{let r=!1;e.subscribe(ns(t,s=>{r=!0,t.next(s)},()=>r?t.complete():t.error(n())))})}function wfe(){return new kE}function Y0(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Jl((s,i)=>n(s,i,r)):_l,Eg(1),t?LE(e):fj(()=>new kE))}function E2(n,e,t){const r=ln(n)||e||t?{next:n,error:e,complete:t}:n;return r?lr((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(ns(i,u=>{var h;null===(h=r.next)||void 0===h||h.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var h;c=!1,null===(h=r.error)||void 0===h||h.call(r,u),i.error(u)},()=>{var u,h;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):_l}function K0(n){return lr((e,t)=>{let i,r=null,s=!1;r=e.subscribe(ns(t,void 0,void 0,o=>{i=po(n(o,K0(n)(e))),r?(r.unsubscribe(),r=null,i.subscribe(t)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(t))})}function bfe(n,e,t,r,s){return(i,o)=>{let c=t,u=e,h=0;i.subscribe(ns(o,g=>{const m=h++;u=c?n(u,g,m):(c=!0,g),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function hj(n,e){return lr(bfe(n,e,arguments.length>=2,!0))}function vN(n){return n<=0?()=>dc:lr((e,t)=>{let r=[];e.subscribe(ns(t,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)t.next(s);t.complete()},void 0,()=>{r=null}))})}function dj(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Jl((s,i)=>n(s,i,r)):_l,vN(1),t?LE(e):fj(()=>new kE))}function CN(n){return lr((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const qn="primary",Mg=Symbol("RouteTitle");class Nfe{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function sh(n){return new Nfe(n)}function Ife(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function R4(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let s;for(let i=0;i<t.length;i++)if(s=t[i],!pj(n[s],e[s]))return!1;return!0}function pj(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((s,i)=>r[i]===s)}return n===e}function gj(n){return Array.prototype.concat.apply([],n)}function mj(n){return n.length>0?n[n.length-1]:null}function M2(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function X0(n){return DO(n)?n:qp(n)?rs(Promise.resolve(n)):Xt(n)}const Lfe={exact:function Cj(n,e,t){if(!s5(n.segments,e.segments)||!RE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!Cj(n.children[r],e.children[r],t))return!1;return!0},subset:yj},_j={exact:function Rfe(n,e){return R4(n,e)},subset:function Dfe(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>pj(n[t],e[t]))},ignored:()=>!0};function vj(n,e,t){return Lfe[t.paths](n.root,e.root,t.matrixParams)&&_j[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function yj(n,e,t){return Ej(n,e,e.segments,t)}function Ej(n,e,t,r){if(n.segments.length>t.length){const s=n.segments.slice(0,t.length);return!(!s5(s,t)||e.hasChildren()||!RE(s,t,r))}if(n.segments.length===t.length){if(!s5(n.segments,t)||!RE(n.segments,t,r))return!1;for(const s in e.children)if(!n.children[s]||!yj(n.children[s],e.children[s],r))return!1;return!0}{const s=t.slice(0,n.segments.length),i=t.slice(n.segments.length);return!!(s5(n.segments,s)&&RE(n.segments,s,r)&&n.children[qn])&&Ej(n.children[qn],e,i,r)}}function RE(n,e,t){return e.every((r,s)=>_j[t](n[s].parameters,r.parameters))}class r5{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=sh(this.queryParams)),this._queryParamMap}toString(){return Vfe.serialize(this)}}class Yn{constructor(e,t){this.segments=e,this.children=t,this.parent=null,M2(t,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return DE(this)}}class Sg{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=sh(this.parameters)),this._parameterMap}toString(){return Tj(this)}}function s5(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let Mj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:function(){return new EN},providedIn:"root"}),n})();class EN{parse(e){const t=new Zfe(e);return new r5(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Pg(e.root,!0)}`,r=function $fe(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(s=>`${zE(t)}=${zE(s)}`).join("&"):`${zE(t)}=${zE(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Ffe(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Vfe=new EN;function DE(n){return n.segments.map(e=>Tj(e)).join("/")}function Pg(n,e){if(!n.hasChildren())return DE(n);if(e){const t=n.children[qn]?Pg(n.children[qn],!1):"",r=[];return M2(n.children,(s,i)=>{i!==qn&&r.push(`${i}:${Pg(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function Hfe(n,e){let t=[];return M2(n.children,(r,s)=>{s===qn&&(t=t.concat(e(r,s)))}),M2(n.children,(r,s)=>{s!==qn&&(t=t.concat(e(r,s)))}),t}(n,(r,s)=>s===qn?[Pg(n.children[qn],!1)]:[`${s}:${Pg(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[qn]?`${DE(n)}/${t[0]}`:`${DE(n)}/(${t.join("//")})`}}function Sj(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function zE(n){return Sj(n).replace(/%3B/gi,";")}function MN(n){return Sj(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function HE(n){return decodeURIComponent(n)}function Pj(n){return HE(n.replace(/\+/g,"%20"))}function Tj(n){return`${MN(n.path)}${function Bfe(n){return Object.keys(n).map(e=>`;${MN(e)}=${MN(n[e])}`).join("")}(n.parameters)}`}const Gfe=/^[^\/()?;=#]+/;function VE(n){const e=n.match(Gfe);return e?e[0]:""}const Ufe=/^[^=?&#]+/,Wfe=/^[^&#]+/;class Zfe{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Yn([],{}):new Yn([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[qn]=new Yn(e,t)),r}parseSegment(){const e=VE(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Ae(4009,!1);return this.capture(e),new Sg(HE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=VE(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const s=VE(this.remaining);s&&(r=s,this.capture(r))}e[HE(t)]=HE(r)}parseQueryParam(e){const t=function qfe(n){const e=n.match(Ufe);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const o=function jfe(n){const e=n.match(Wfe);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=Pj(t),i=Pj(r);if(e.hasOwnProperty(s)){let o=e[s];Array.isArray(o)||(o=[o],e[s]=o),o.push(i)}else e[s]=i}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=VE(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Ae(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=qn);const o=this.parseChildren();t[i]=1===Object.keys(o).length?o[qn]:new Yn([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Ae(4011,!1)}}function SN(n){return n.segments.length>0?new Yn([],{[qn]:n}):n}function FE(n){const e={};for(const r of Object.keys(n.children)){const i=FE(n.children[r]);(i.segments.length>0||i.hasChildren())&&(e[r]=i)}return function Yfe(n){if(1===n.numberOfChildren&&n.children[qn]){const e=n.children[qn];return new Yn(n.segments.concat(e.segments),e.children)}return n}(new Yn(n.segments,e))}function i5(n){return n instanceof r5}function Qfe(n,e,t,r,s){if(0===t.length)return ih(e.root,e.root,e.root,r,s);const i=function Oj(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new bj(!0,0,n);let e=0,t=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return M2(i.outlets,(u,h)=>{c[h]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?t=!0:".."===c?e++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new bj(t,e,r)}(t);return i.toRoot()?ih(e.root,e.root,new Yn([],{}),r,s):function o(u){const h=function ehe(n,e,t,r){if(n.isAbsolute)return new oh(e.root,!0,0);if(-1===r)return new oh(t,t===e.root,0);return function Aj(n,e,t){let r=n,s=e,i=t;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Ae(4005,!1);s=r.segments.length}return new oh(r,!1,s-i)}(t,r+(Tg(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,e,n.snapshot?._urlSegment,u),g=h.processChildren?bg(h.segmentGroup,h.index,i.commands):TN(h.segmentGroup,h.index,i.commands);return ih(e.root,h.segmentGroup,g,r,s)}(n.snapshot?._lastPathIndex)}function Tg(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function wg(n){return"object"==typeof n&&null!=n&&n.outlets}function ih(n,e,t,r,s){let o,i={};r&&M2(r,(u,h)=>{i[h]=Array.isArray(u)?u.map(g=>`${g}`):`${u}`}),o=n===e?t:wj(n,e,t);const c=SN(FE(o));return new r5(c,i,s)}function wj(n,e,t){const r={};return M2(n.children,(s,i)=>{r[i]=s===e?t:wj(s,e,t)}),new Yn(n.segments,r)}class bj{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Tg(r[0]))throw new Ae(4003,!1);const s=r.find(wg);if(s&&s!==mj(r))throw new Ae(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class oh{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function TN(n,e,t){if(n||(n=new Yn([],{})),0===n.segments.length&&n.hasChildren())return bg(n,e,t);const r=function nhe(n,e,t){let r=0,s=e;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=t.length)return i;const o=n.segments[s],c=t[r];if(wg(c))break;const u=`${c}`,h=r<t.length-1?t[r+1]:null;if(s>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!Ij(u,h,o))return i;r+=2}else{if(!Ij(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,e,t),s=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new Yn(n.segments.slice(0,r.pathIndex),{});return i.children[qn]=new Yn(n.segments.slice(r.pathIndex),n.children),bg(i,0,s)}return r.match&&0===s.length?new Yn(n.segments,{}):r.match&&!n.hasChildren()?wN(n,e,t):r.match?bg(n,0,s):wN(n,e,t)}function bg(n,e,t){if(0===t.length)return new Yn(n.segments,{});{const r=function the(n){return wg(n[0])?n[0].outlets:{[qn]:n}}(t),s={};return M2(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=TN(n.children[o],e,i))}),M2(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new Yn(n.segments,s)}}function wN(n,e,t){const r=n.segments.slice(0,e);let s=0;for(;s<t.length;){const i=t[s];if(wg(i)){const u=rhe(i.outlets);return new Yn(r,u)}if(0===s&&Tg(t[0])){r.push(new Sg(n.segments[e].path,Nj(t[0]))),s++;continue}const o=wg(i)?i.outlets[qn]:`${i}`,c=s<t.length-1?t[s+1]:null;o&&c&&Tg(c)?(r.push(new Sg(o,Nj(c))),s+=2):(r.push(new Sg(o,{})),s++)}return new Yn(r,{})}function rhe(n){const e={};return M2(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=wN(new Yn([],{}),0,t))}),e}function Nj(n){const e={};return M2(n,(t,r)=>e[r]=`${t}`),e}function Ij(n,e,t){return n==t.path&&R4(e,t.parameters)}class t6{constructor(e,t){this.id=e,this.url=t}}class bN extends t6{constructor(e,t,r="imperative",s=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Q0 extends t6{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class BE extends t6{constructor(e,t,r,s){super(e,t),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class xj extends t6{constructor(e,t,r,s){super(e,t),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class she extends t6{constructor(e,t,r,s){super(e,t),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ihe extends t6{constructor(e,t,r,s){super(e,t),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ohe extends t6{constructor(e,t,r,s,i){super(e,t),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ahe extends t6{constructor(e,t,r,s){super(e,t),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class che extends t6{constructor(e,t,r,s){super(e,t),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class lhe{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class uhe{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class fhe{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hhe{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dhe{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class phe{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kj{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Lj{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=ON(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=ON(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=AN(e,this._root);return t.length<2?[]:t[t.length-2].children.map(s=>s.value).filter(s=>s!==e)}pathFromRoot(e){return AN(e,this._root).map(t=>t.value)}}function ON(n,e){if(n===e.value)return e;for(const t of e.children){const r=ON(n,t);if(r)return r}return null}function AN(n,e){if(n===e.value)return[e];for(const t of e.children){const r=AN(n,t);if(r.length)return r.unshift(e),r}return[]}class n6{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function ah(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class Rj extends Lj{constructor(e,t){super(e),this.snapshot=t,NN(this,e)}toString(){return this.snapshot.toString()}}function Dj(n,e){const t=function mhe(n,e){const o=new $E([],{},{},"",{},qn,e,null,n.root,-1,{});return new Hj("",new n6(o,[]))}(n,e),r=new x3([new Sg("",{})]),s=new x3({}),i=new x3({}),o=new x3({}),c=new x3(""),u=new No(r,s,o,c,i,qn,e,t.root);return u.snapshot=t.root,new Rj(new n6(u,[]),t)}class No{constructor(e,t,r,s,i,o,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(Cn(h=>h[Mg]))??Xt(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(Cn(e=>sh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Cn(e=>sh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function zj(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const s=t[r],i=t[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function _he(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class $E{constructor(e,t,r,s,i,o,c,u,h,g,m,M){this.url=e,this.params=t,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[Mg],this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=g,this._correctedLastPathIndex=M??g,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=sh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=sh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Hj extends Lj{constructor(e,t){super(t),this.url=e,NN(this,t)}toString(){return Vj(this._root)}}function NN(n,e){e.value._routerState=n,e.children.forEach(t=>NN(n,t))}function Vj(n){const e=n.children.length>0?` { ${n.children.map(Vj).join(", ")} } `:"";return`${n.value}${e}`}function IN(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,R4(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),R4(e.params,t.params)||n.params.next(t.params),function xfe(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!R4(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),R4(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function xN(n,e){const t=R4(n.params,e.params)&&function zfe(n,e){return s5(n,e)&&n.every((t,r)=>R4(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||xN(n.parent,e.parent))}function Og(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const s=function Che(n,e,t){return e.children.map(r=>{for(const s of t.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return Og(n,r,s);return Og(n,r)})}(n,e,t);return new n6(r,s)}{if(n.shouldAttach(e.value)){const i=n.retrieve(e.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(c=>Og(n,c)),o}}const r=function yhe(n){return new No(new x3(n.url),new x3(n.params),new x3(n.queryParams),new x3(n.fragment),new x3(n.data),n.outlet,n.component,n)}(e.value),s=e.children.map(i=>Og(n,i));return new n6(r,s)}}const kN="ngNavigationCancelingError";function Fj(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=i5(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,s=Bj(!1,0,e);return s.url=t,s.navigationBehaviorOptions=r,s}function Bj(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[kN]=!0,r.cancellationCode=e,t&&(r.url=t),r}function $j(n){return Gj(n)&&i5(n.url)}function Gj(n){return n&&n[kN]}class Ehe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ag,this.attachRef=null}}let Ag=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const s=this.getOrCreateContext(t);s.outlet=r,this.contexts.set(t,s)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Ehe,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const GE=!1;let LN=(()=>{class n{constructor(t,r,s,i,o){this.parentContexts=t,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new ur,this.deactivateEvents=new ur,this.attachEvents=new ur,this.detachEvents=new ur,this.name=s||qn,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ae(4012,GE);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ae(4012,GE);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ae(4012,GE);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Ae(4013,GE);this._activatedRoute=t;const s=this.location,o=t._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Mhe(t,c,s.injector);if(r&&function She(n){return!!n.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(o);this.activated=s.createComponent(h,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(Q(Ag),Q(Ba),gu("name"),Q(Zu),Q(Ra))},n.\u0275dir=Ut({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class Mhe{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===No?this.route:e===Ag?this.childContexts:this.parent.get(e,t)}}let RN=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],standalone:!0,features:[xG],decls:1,vars:0,template:function(t,r){1&t&&X(0,"router-outlet")},dependencies:[LN],encapsulation:2}),n})();function Uj(n,e){return n.providers&&!n._injector&&(n._injector=Wy(n.providers,e,`Route: ${n.path}`)),n._injector??e}function zN(n){const e=n.children&&n.children.map(zN),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==qn&&(t.component=RN),t}function Tc(n){return n.outlet||qn}function qj(n,e){const t=n.filter(r=>Tc(r)===e);return t.push(...n.filter(r=>Tc(r)!==e)),t}function Ng(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class Ohe{constructor(e,t,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=s}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),IN(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const s=ah(t);e.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),M2(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(e,t,r){const s=e.value,i=t?t.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else i&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),s=r&&e.value.component?r.children:t,i=ah(e);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),s=r&&e.value.component?r.children:t,i=ah(e);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const s=ah(t);e.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new phe(i.value.snapshot))}),e.children.length&&this.forwardEvent(new hhe(e.value.snapshot))}activateRoutes(e,t,r){const s=e.value,i=t?t.value:null;if(IN(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),IN(c.route.value),this.activateChildRoutes(e,null,o.children)}else{const c=Ng(s.snapshot),u=c?.get(b0)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class Wj{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class UE{constructor(e,t){this.component=e,this.route=t}}function Ahe(n,e,t){const r=n._root;return Ig(r,e?e._root:null,t,[r.value])}function ch(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||function $2(n){return null!==Ln(n)}(n)?e.get(n):n:r}function Ig(n,e,t,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=ah(e);return n.children.forEach(o=>{(function Ihe(n,e,t,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function xhe(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!s5(n.url,e.url);case"pathParamsOrQueryParamsChange":return!s5(n.url,e.url)||!R4(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xN(n,e)||!R4(n.queryParams,e.queryParams);default:return!xN(n,e)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new Wj(r)):(i.data=o.data,i._resolvedData=o._resolvedData),Ig(n,e,i.component?c?c.children:null:t,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new UE(c.outlet.component,o))}else o&&xg(e,c,s),s.canActivateChecks.push(new Wj(r)),Ig(n,null,i.component?c?c.children:null:t,r,s)})(o,i[o.value.outlet],t,r.concat([o.value]),s),delete i[o.value.outlet]}),M2(i,(o,c)=>xg(o,t.getContext(c),s)),s}function xg(n,e,t){const r=ah(n),s=n.value;M2(r,(i,o)=>{xg(i,s.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new UE(s.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,s))}function kg(n){return"function"==typeof n}function HN(n){return n instanceof kE||"EmptyError"===n?.name}const qE=Symbol("INITIAL_VALUE");function lh(){return L4(n=>aj(n.map(e=>e.pipe(Eg(1),function Tfe(...n){const e=i4(n);return lr((t,r)=>{(e?mN(n,t,e):mN(n,t)).subscribe(r)})}(qE)))).pipe(Cn(e=>{for(const t of e)if(!0!==t){if(t===qE)return qE;if(!1===t||t instanceof r5)return t}return!0}),Jl(e=>e!==qE),Eg(1)))}function jj(n){return function BT(...n){return K_(n)}(E2(e=>{if(i5(e))throw Fj(0,e)}),Cn(e=>!0===e))}const VN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Zj(n,e,t,r,s){const i=FN(n,e,t);return i.matched?function Yhe(n,e,t,r){const s=e.canMatch;return s&&0!==s.length?Xt(s.map(o=>{const c=ch(o,n);return X0(function Hhe(n){return n&&kg(n.canMatch)}(c)?c.canMatch(e,t):n.runInContext(()=>c(e,t)))})).pipe(lh(),jj()):Xt(!0)}(r=Uj(e,r),e,t).pipe(Cn(o=>!0===o?i:{...VN})):Xt(i)}function FN(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...VN}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||Ife)(t,n,e);if(!s)return{...VN};const i={};M2(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function WE(n,e,t,r,s="corrected"){if(t.length>0&&function Qhe(n,e,t){return t.some(r=>jE(n,e,r)&&Tc(r)!==qn)}(n,t,r)){const o=new Yn(e,function Xhe(n,e,t,r){const s={};s[qn]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const i of t)if(""===i.path&&Tc(i)!==qn){const o=new Yn([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,s[Tc(i)]=o}return s}(n,e,r,new Yn(t,n.children)));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function Jhe(n,e,t){return t.some(r=>jE(n,e,r))}(n,t,r)){const o=new Yn(n.segments,function Khe(n,e,t,r,s,i){const o={};for(const c of r)if(jE(n,t,c)&&!s[Tc(c)]){const u=new Yn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:e.length,o[Tc(c)]=u}return{...s,...o}}(n,e,t,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const i=new Yn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:t}}function jE(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function Yj(n,e,t,r){return!!(Tc(n)===r||r!==qn&&jE(e,t,n))&&("**"===n.path||FN(e,n,t).matched)}function Kj(n,e,t){return 0===e.length&&!n.children[t]}const ZE=!1;class YE{constructor(e){this.segmentGroup=e||null}}class Xj{constructor(e){this.urlTree=e}}function Lg(n){return yg(new YE(n))}function Qj(n){return yg(new Xj(n))}class r9e{constructor(e,t,r,s,i){this.injector=e,this.configLoader=t,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const e=WE(this.urlTree.root,[],[],this.config).segmentGroup,t=new Yn(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,qn).pipe(Cn(i=>this.createUrlTree(FE(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(K0(i=>{if(i instanceof Xj)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof YE?this.noMatchError(i):i}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,qn).pipe(Cn(s=>this.createUrlTree(FE(s),e.queryParams,e.fragment))).pipe(K0(s=>{throw s instanceof YE?this.noMatchError(s):s}))}noMatchError(e){return new Ae(4002,ZE)}createUrlTree(e,t,r){const s=SN(e);return new r5(s,t,r)}expandSegmentGroup(e,t,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe(Cn(i=>new Yn([],i))):this.expandSegment(e,r,t,r.segments,s,!0)}expandChildren(e,t,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return rs(s).pipe(j0(i=>{const o=r.children[i],c=qj(t,i);return this.expandSegmentGroup(e,c,o,i).pipe(Cn(u=>({segment:u,outlet:i})))}),hj((i,o)=>(i[o.outlet]=o.segment,i),{}),dj())}expandSegment(e,t,r,s,i,o){return rs(r).pipe(j0(c=>this.expandSegmentAgainstRoute(e,t,r,c,s,i,o).pipe(K0(h=>{if(h instanceof YE)return Xt(null);throw h}))),Y0(c=>!!c),K0((c,u)=>{if(HN(c))return Kj(t,s,i)?Xt(new Yn([],{})):Lg(t);throw c}))}expandSegmentAgainstRoute(e,t,r,s,i,o,c){return Yj(s,t,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(e,t,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,s,i,o):Lg(t):Lg(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Qj(i):this.lineralizeSegments(r,i).pipe(ze(o=>{const c=new Yn(o,{});return this.expandSegment(e,c,t,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:h,positionalParamSegments:g}=FN(t,s,i);if(!c)return Lg(t);const m=this.applyRedirectCommands(u,s.redirectTo,g);return s.redirectTo.startsWith("/")?Qj(m):this.lineralizeSegments(s,m).pipe(ze(M=>this.expandSegment(e,t,r,M.concat(h),o,!1)))}matchSegmentAgainstRoute(e,t,r,s,i){return"**"===r.path?(e=Uj(r,e),r.loadChildren?(r._loadedRoutes?Xt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe(Cn(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new Yn(s,{})))):Xt(new Yn(s,{}))):Zj(t,r,s,e).pipe(L4(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(e=r._injector??e,r,s).pipe(ze(g=>{const m=g.injector??e,M=g.routes,{segmentGroup:b,slicedSegments:L}=WE(t,c,u,M),G=new Yn(b.segments,b.children);if(0===L.length&&G.hasChildren())return this.expandChildren(m,M,G).pipe(Cn(te=>new Yn(c,te)));if(0===M.length&&0===L.length)return Xt(new Yn(c,{}));const j=Tc(r)===i;return this.expandSegment(m,G,M,L,j?qn:i,!0).pipe(Cn(ye=>new Yn(c.concat(ye.segments),ye.children)))})):Lg(t)))}getChildConfig(e,t,r){return t.children?Xt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Xt({routes:t._loadedRoutes,injector:t._loadedInjector}):function Zhe(n,e,t,r){const s=e.canLoad;return void 0===s||0===s.length?Xt(!0):Xt(s.map(o=>{const c=ch(o,n);return X0(function Lhe(n){return n&&kg(n.canLoad)}(c)?c.canLoad(e,t):n.runInContext(()=>c(e,t)))})).pipe(lh(),jj())}(e,t,r).pipe(ze(s=>s?this.configLoader.loadChildren(e,t).pipe(E2(i=>{t._loadedRoutes=i.routes,t._loadedInjector=i.injector})):function t9e(n){return yg(Bj(ZE,3))}())):Xt({routes:[],injector:e})}lineralizeSegments(e,t){let r=[],s=t.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return Xt(r);if(s.numberOfChildren>1||!s.children[qn])return yg(new Ae(4e3,ZE));s=s.children[qn]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,s){const i=this.createSegmentGroup(e,t.root,r,s);return new r5(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return M2(e,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,s){const i=this.createSegments(e,t.segments,r,s);let o={};return M2(t.children,(c,u)=>{o[u]=this.createSegmentGroup(e,c,r,s)}),new Yn(i,o)}createSegments(e,t,r,s){return t.map(i=>i.path.startsWith(":")?this.findPosParam(e,i,s):this.findOrReturn(i,r))}findPosParam(e,t,r){const s=r[t.path.substring(1)];if(!s)throw new Ae(4001,ZE);return s}findOrReturn(e,t){let r=0;for(const s of t){if(s.path===e.path)return t.splice(r),s;r++}return e}}class i9e{}class c9e{constructor(e,t,r,s,i,o,c,u){this.injector=e,this.rootComponentType=t,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const e=WE(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,qn).pipe(Cn(t=>{if(null===t)return null;const r=new $E([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},qn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new n6(r,t),i=new Hj(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(e){const t=e.value,r=zj(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(e,t,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,s)}processChildren(e,t,r){return rs(Object.keys(r.children)).pipe(j0(s=>{const i=r.children[s],o=qj(t,s);return this.processSegmentGroup(e,o,i,s)}),hj((s,i)=>s&&i?(s.push(...i),s):null),function Ofe(n,e=!1){return lr((t,r)=>{let s=0;t.subscribe(ns(r,i=>{const o=n(i,s++);(o||e)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),LE(null),dj(),Cn(s=>{if(null===s)return null;const i=Jj(s);return function l9e(n){n.sort((e,t)=>e.value.outlet===qn?-1:t.value.outlet===qn?1:e.value.outlet.localeCompare(t.value.outlet))}(i),i}))}processSegment(e,t,r,s,i){return rs(t).pipe(j0(o=>this.processSegmentAgainstRoute(o._injector??e,o,r,s,i)),Y0(o=>!!o),K0(o=>{if(HN(o))return Kj(r,s,i)?Xt([]):Xt(null);throw o}))}processSegmentAgainstRoute(e,t,r,s,i){if(t.redirectTo||!Yj(t,r,s,i))return Xt(null);let o;if("**"===t.path){const c=s.length>0?mj(s).parameters:{},u=tZ(r)+s.length;o=Xt({snapshot:new $E(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,rZ(t),Tc(t),t.component??t._loadedComponent??null,t,eZ(r),u,sZ(t),u),consumedSegments:[],remainingSegments:[]})}else o=Zj(r,t,s,e).pipe(Cn(({matched:c,consumedSegments:u,remainingSegments:h,parameters:g})=>{if(!c)return null;const m=tZ(r)+u.length;return{snapshot:new $E(u,g,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,rZ(t),Tc(t),t.component??t._loadedComponent??null,t,eZ(r),m,sZ(t),m),consumedSegments:u,remainingSegments:h}}));return o.pipe(L4(c=>{if(null===c)return Xt(null);const{snapshot:u,consumedSegments:h,remainingSegments:g}=c;e=t._injector??e;const m=t._loadedInjector??e,M=function u9e(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:b,slicedSegments:L}=WE(r,h,g,M.filter(j=>void 0===j.redirectTo),this.relativeLinkResolution);if(0===L.length&&b.hasChildren())return this.processChildren(m,M,b).pipe(Cn(j=>null===j?null:[new n6(u,j)]));if(0===M.length&&0===L.length)return Xt([new n6(u,[])]);const G=Tc(t)===i;return this.processSegment(m,M,b,L,G?qn:i).pipe(Cn(j=>null===j?null:[new n6(u,j)]))}))}}function f9e(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function Jj(n){const e=[],t=new Set;for(const r of n){if(!f9e(r)){e.push(r);continue}const s=e.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),t.add(s)):e.push(r)}for(const r of t){const s=Jj(r.children);e.push(new n6(r.value,s))}return e.filter(r=>!t.has(r))}function eZ(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function tZ(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function rZ(n){return n.data||{}}function sZ(n){return n.resolve||{}}function iZ(n){return"string"==typeof n.title||null===n.title}function BN(n){return L4(e=>{const t=n(e);return t?rs(t).pipe(Cn(()=>e)):Xt(e)})}let oZ=(()=>{class n{buildTitle(t){let r,s=t.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===qn);return r}getResolvedTitleForRoute(t){return t.data[Mg]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:function(){return kr(aZ)},providedIn:"root"}),n})(),aZ=(()=>{class n extends oZ{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(De(Vq))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class C9e{}class E9e extends class y9e{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const XE=new Rt("",{providedIn:"root",factory:()=>({})}),$N=new Rt("ROUTES");let GN=(()=>{class n{constructor(t,r){this.injector=t,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Xt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=X0(t.loadComponent()).pipe(E2(i=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=i}),CN(()=>{this.componentLoaders.delete(t)})),s=new uj(r,()=>new F2).pipe(_N());return this.componentLoaders.set(t,s),s}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Xt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(Cn(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,h,g=!1;Array.isArray(c)?h=c:(u=c.create(t).injector,h=gj(u.get($N,[],Yt.Self|Yt.Optional)));return{routes:h.map(zN),injector:u}}),CN(()=>{this.childrenLoaders.delete(r)})),o=new uj(i,()=>new F2).pipe(_N());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(t){return X0(t()).pipe(ze(r=>r instanceof NG||Array.isArray(r)?Xt(r):rs(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(De(ii),De(lA))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class S9e{}class P9e{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function T9e(n){throw n}function w9e(n,e,t){return e.parse("/")}const b9e={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},O9e={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function lZ(){const n=kr(Mj),e=kr(Ag),t=kr(PA),r=kr(ii),s=kr(lA),i=kr($N,{optional:!0})??[],o=kr(XE,{optional:!0})??{},c=kr(aZ),u=kr(oZ,{optional:!0}),h=kr(S9e,{optional:!0}),g=kr(C9e,{optional:!0}),m=new Kn(null,n,e,t,r,s,gj(i));return h&&(m.urlHandlingStrategy=h),g&&(m.routeReuseStrategy=g),m.titleStrategy=u??c,function A9e(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let Kn=(()=>{class n{constructor(t,r,s,i,o,c,u){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new F2,this.errorHandler=T9e,this.malformedUriErrorHandler=w9e,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Xt(void 0),this.urlHandlingStrategy=new P9e,this.routeReuseStrategy=new E9e,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(GN),this.configLoader.onLoadEndListener=M=>this.triggerEvent(new uhe(M)),this.configLoader.onLoadStartListener=M=>this.triggerEvent(new lhe(M)),this.ngModule=o.get(ju),this.console=o.get(r8e);const m=o.get(Er);this.isNgZoneEnabled=m instanceof Er&&Er.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function kfe(){return new r5(new Yn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Dj(this.currentUrlTree,this.rootComponentType),this.transitions=new x3({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(Jl(s=>0!==s.id),Cn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),L4(s=>{let i=!1,o=!1;return Xt(s).pipe(E2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),L4(c=>{const u=this.browserUrlTree.toString(),h=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return uZ(c.source)&&(this.browserUrlTree=c.extractedUrl),Xt(c).pipe(L4(m=>{const M=this.transitions.getValue();return r.next(new bN(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),M!==this.transitions.getValue()?dc:Promise.resolve(m)}),function s9e(n,e,t,r){return L4(s=>function n9e(n,e,t,r,s){return new r9e(n,e,t,r,s).apply()}(n,e,t,s.extractedUrl,r).pipe(Cn(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),E2(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function d9e(n,e,t,r,s,i){return ze(o=>function a9e(n,e,t,r,s,i,o="emptyOnly",c="legacy"){return new c9e(n,e,t,r,s,o,c,i).recognize().pipe(L4(u=>null===u?function o9e(n){return new _r(e=>e.error(n))}(new i9e):Xt(u)))}(n,e,t,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(Cn(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),E2(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const b=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(b,m)}this.browserUrlTree=m.urlAfterRedirects}const M=new she(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(M)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:M,extractedUrl:b,source:L,restoredState:G,extras:j}=c,ie=new bN(M,this.serializeUrl(b),L,G);r.next(ie);const ye=Dj(b,this.rootComponentType).snapshot;return Xt(s={...c,targetSnapshot:ye,urlAfterRedirects:b,extras:{...j,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),dc}),E2(c=>{const u=new ihe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),Cn(c=>s={...c,guards:Ahe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function Fhe(n,e){return ze(t=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=t;return 0===o.length&&0===i.length?Xt({...t,guardsResult:!0}):function Bhe(n,e,t,r){return rs(n).pipe(ze(s=>function jhe(n,e,t,r,s){const i=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return i&&0!==i.length?Xt(i.map(c=>{const u=Ng(e)??s,h=ch(c,u);return X0(function zhe(n){return n&&kg(n.canDeactivate)}(h)?h.canDeactivate(n,e,t,r):u.runInContext(()=>h(n,e,t,r))).pipe(Y0())})).pipe(lh()):Xt(!0)}(s.component,s.route,t,e,r)),Y0(s=>!0!==s,!0))}(o,r,s,n).pipe(ze(c=>c&&function khe(n){return"boolean"==typeof n}(c)?function $he(n,e,t,r){return rs(e).pipe(j0(s=>mN(function Uhe(n,e){return null!==n&&e&&e(new fhe(n)),Xt(!0)}(s.route.parent,r),function Ghe(n,e){return null!==n&&e&&e(new dhe(n)),Xt(!0)}(s.route,r),function Whe(n,e,t){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(o=>function Nhe(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>lj(()=>Xt(o.guards.map(u=>{const h=Ng(o.node)??t,g=ch(u,h);return X0(function Dhe(n){return n&&kg(n.canActivateChild)}(g)?g.canActivateChild(r,n):h.runInContext(()=>g(r,n))).pipe(Y0())})).pipe(lh())));return Xt(i).pipe(lh())}(n,s.path,t),function qhe(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return Xt(!0);const s=r.map(i=>lj(()=>{const o=Ng(e)??t,c=ch(i,o);return X0(function Rhe(n){return n&&kg(n.canActivate)}(c)?c.canActivate(e,n):o.runInContext(()=>c(e,n))).pipe(Y0())}));return Xt(s).pipe(lh())}(n,s.route,t))),Y0(s=>!0!==s,!0))}(r,i,n,e):Xt(c)),Cn(c=>({...t,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),E2(c=>{if(s.guardsResult=c.guardsResult,i5(c.guardsResult))throw Fj(0,c.guardsResult);const u=new ohe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),Jl(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),BN(c=>{if(c.guards.canActivateChecks.length)return Xt(c).pipe(E2(u=>{const h=new ahe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),L4(u=>{let h=!1;return Xt(u).pipe(function p9e(n,e){return ze(t=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=t;if(!s.length)return Xt(t);let i=0;return rs(s).pipe(j0(o=>function g9e(n,e,t,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!iZ(s)&&(i[Mg]=s.title),function m9e(n,e,t,r){const s=function _9e(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Xt({});const i={};return rs(s).pipe(ze(o=>function v9e(n,e,t,r){const s=Ng(e)??r,i=ch(n,s);return X0(i.resolve?i.resolve(e,t):s.runInContext(()=>i(e,t)))}(n[o],e,t,r).pipe(Y0(),E2(c=>{i[o]=c}))),vN(1),function Afe(n){return Cn(()=>n)}(i),K0(o=>HN(o)?dc:yg(o)))}(i,n,e,r).pipe(Cn(o=>(n._resolvedData=o,n.data=zj(n,t).resolve,s&&iZ(s)&&(n.data[Mg]=s.title),null)))}(o.route,r,n,e)),E2(()=>i++),vN(1),ze(o=>i===s.length?Xt(t):dc))})}(this.paramsInheritanceStrategy,this.ngModule.injector),E2({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),E2(u=>{const h=new che(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),BN(c=>{const u=h=>{const g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe(E2(m=>{h.component=m}),Cn(()=>{})));for(const m of h.children)g.push(...u(m));return g};return aj(u(c.targetSnapshot.root)).pipe(LE(),Eg(1))}),BN(()=>this.afterPreactivation()),Cn(c=>{const u=function vhe(n,e,t){const r=Og(n,e._root,t?t._root:void 0);return new Rj(r,e)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),E2(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,e,t)=>Cn(r=>(new Ohe(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),E2({next(){i=!0},complete(){i=!0}}),CN(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),K0(c=>{if(o=!0,Gj(c)){$j(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new BE(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),$j(c)){const h=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),g={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||uZ(s.source)};this.scheduleNavigation(h,"imperative",null,g,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new xj(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(h){s.reject(h)}}return dc}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=t.state?.navigationId?t.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(t.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(zN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=s||this.routerState.root,g=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),Qfe(h,this.currentUrlTree,t,m,g??null)}navigateByUrl(t,r={skipLocationChange:!1}){const s=i5(t)?t:this.parseUrl(t),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function N9e(n){for(let e=0;e<n.length;e++){if(null==n[e])throw new Ae(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,t)}return r}isActive(t,r){let s;if(s=!0===r?{...b9e}:!1===r?{...O9e}:r,i5(t))return vj(this.currentUrlTree,t,s);const i=this.parseUrl(t);return vj(this.currentUrlTree,i,s)}removeEmptyProps(t){return Object.keys(t).reduce((r,s)=>{const i=t[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Q0(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((M,b)=>{c=M,u=b});const g=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:g,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:i,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(M=>Promise.reject(M))}setBrowserUrl(t,r){const s=this.urlSerializer.serialize(t),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r,s){const i=new BE(t.id,this.serializeUrl(t.extractedUrl),r,s);this.triggerEvent(i),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){kf()},n.\u0275prov=nt({token:n,factory:function(){return lZ()},providedIn:"root"}),n})();function uZ(n){return"imperative"!==n}let uh=(()=>{class n{constructor(t,r,s,i,o){this.router=t,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new F2,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=Yl(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=Yl(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=Yl(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==t?r.setAttribute(s,"tabindex",t):r.removeAttribute(s,"tabindex")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn),Q(No),gu("tabindex"),Q(So),Q(g2))},n.\u0275dir=Ut({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,r){1&t&&J("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[a2]}),n})(),o5=(()=>{class n{constructor(t,r,s){this.router=t,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new F2,this.subscription=t.events.subscribe(i=>{i instanceof Q0&&this.updateTargetUrlAndHref()})}set preserveFragment(t){this._preserveFragment=Yl(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=Yl(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=Yl(t)}get replaceUrl(){return this._replaceUrl}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:null}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,r,s,i,o){return!!(0!==t||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn),Q(No),Q(Ku))},n.\u0275dir=Ut({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,r){1&t&&J("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&t&&z("target",r.target)("href",r.href,_3)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[a2]}),n})();class fZ{}let k9e=(()=>{class n{constructor(t,r,s,i,o){this.router=t,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Jl(t=>t instanceof Q0),j0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=Wy(i.providers,t,`Route: ${i.path}`));const o=i._injector??t,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return rs(s).pipe(yl())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):Xt(null);const i=s.pipe(ze(o=>null===o?Xt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return r.loadComponent&&!r._loadedComponent?rs([i,this.loader.loadComponent(r)]).pipe(yl()):i})}}return n.\u0275fac=function(t){return new(t||n)(De(Kn),De(lA),De(Ra),De(fZ),De(GN))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const UN=new Rt("");let hZ=(()=>{class n{constructor(t,r,s={}){this.router=t,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof bN?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Q0&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof kj&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new kj(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){kf()},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();function fh(n,e){return{\u0275kind:n,\u0275providers:e}}function qN(n){return[{provide:$N,multi:!0,useValue:n}]}function pZ(){const n=kr(ii);return e=>{const t=n.get(rg);if(e!==t.components[0])return;const r=n.get(Kn),s=n.get(gZ);1===n.get(WN)&&r.initialNavigation(),n.get(mZ,null,Yt.Optional)?.setUpPreloading(),n.get(UN,null,Yt.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),s.next(),s.complete()}}const gZ=new Rt("",{factory:()=>new F2}),WN=new Rt("",{providedIn:"root",factory:()=>1});const mZ=new Rt("");function z9e(n){return fh(0,[{provide:mZ,useExisting:k9e},{provide:fZ,useExisting:n}])}const _Z=new Rt("ROUTER_FORROOT_GUARD"),H9e=[PA,{provide:Mj,useClass:EN},{provide:Kn,useFactory:lZ},Ag,{provide:No,useFactory:function dZ(n){return n.routerState.root},deps:[Kn]},GN];function V9e(){return new bU("Router",Kn)}let F9e=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[H9e,[],qN(t),{provide:_Z,useFactory:U9e,deps:[[Kn,new si,new Mu]]},{provide:XE,useValue:r||{}},r?.useHash?{provide:Ku,useClass:q8e}:{provide:Ku,useClass:QU},{provide:UN,useFactory:()=>{const n=kr(Kn),e=kr(l5e),t=kr(XE);return t.scrollOffset&&e.setOffset(t.scrollOffset),new hZ(n,e,t)}},r?.preloadingStrategy?z9e(r.preloadingStrategy).\u0275providers:[],{provide:bU,multi:!0,useFactory:V9e},r?.initialNavigation?q9e(r):[],[{provide:vZ,useFactory:pZ},{provide:CU,multi:!0,useExisting:vZ}]]}}static forChild(t){return{ngModule:n,providers:[qN(t)]}}}return n.\u0275fac=function(t){return new(t||n)(De(_Z,8))},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({imports:[RN]}),n})();function U9e(n){return"guarded"}function q9e(n){return["disabled"===n.initialNavigation?fh(3,[{provide:Ky,multi:!0,useFactory:()=>{const e=kr(Kn);return()=>{e.setUpLocationChangeListener()}}},{provide:WN,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?fh(2,[{provide:WN,useValue:0},{provide:Ky,multi:!0,deps:[ii],useFactory:e=>{const t=e.get(G8e,Promise.resolve());let r=!1;return()=>t.then(()=>new Promise(i=>{const o=e.get(Kn),c=e.get(gZ);(function s(i){e.get(Kn).events.pipe(Jl(c=>c instanceof Q0||c instanceof BE||c instanceof xj),Cn(c=>c instanceof Q0||c instanceof BE&&(0===c.code||1===c.code)&&null),Jl(c=>null!==c),Eg(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?Xt(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const vZ=new Rt("");class CZ{}const r6="*";function yZ(n,e=null){return{type:2,steps:n,options:e}}function EZ(n){return{type:6,styles:n,offset:null}}function MZ(n){Promise.resolve().then(n)}class Rg{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){MZ(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class SZ{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,r=0,s=0;const i=this.players.length;0==i?MZ(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,t/r.totalTime):1;r.setPosition(s)})}getPosition(){const e=this.players.reduce((t,r)=>null===t||r.totalTime>t.totalTime?r:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}function PZ(n){return new Ae(3e3,!1)}function Ode(){return typeof window<"u"&&typeof window.document<"u"}function ZN(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function J0(n){switch(n.length){case 0:return new Rg;case 1:return n[0];default:return new SZ(n)}}function TZ(n,e,t,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,h=null;if(r.forEach(g=>{const m=g.get("offset"),M=m==u,b=M&&h||new Map;g.forEach((L,G)=>{let j=G,ie=L;if("offset"!==G)switch(j=e.normalizePropertyName(j,o),ie){case"!":ie=s.get(G);break;case r6:ie=i.get(G);break;default:ie=e.normalizeStyleValue(G,j,ie,o)}b.set(j,ie)}),M||c.push(b),h=b,u=m}),o.length)throw function mde(n){return new Ae(3502,!1)}();return c}function YN(n,e,t,r){switch(e){case"start":n.onStart(()=>r(t&&KN(t,"start",n)));break;case"done":n.onDone(()=>r(t&&KN(t,"done",n)));break;case"destroy":n.onDestroy(()=>r(t&&KN(t,"destroy",n)))}}function KN(n,e,t){const i=XN(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),o=n._data;return null!=o&&(i._data=o),i}function XN(n,e,t,r,s="",i=0,o){return{element:n,triggerName:e,fromState:t,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function Ga(n,e,t){let r=n.get(e);return r||n.set(e,r=t),r}function wZ(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let QN=(n,e)=>!1,bZ=(n,e,t)=>[],OZ=null;function JN(n){const e=n.parentNode||n.host;return e===OZ?null:e}(ZN()||typeof Element<"u")&&(Ode()?(OZ=(()=>document.documentElement)(),QN=(n,e)=>{for(;e;){if(e===n)return!0;e=JN(e)}return!1}):QN=(n,e)=>n.contains(e),bZ=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const r=n.querySelector(e);return r?[r]:[]});let a5=null,AZ=!1;const NZ=QN,IZ=bZ;let xZ=(()=>{class n{validateStyleProperty(t){return function Nde(n){a5||(a5=function Ide(){return typeof document<"u"?document.body:null}()||{},AZ=!!a5.style&&"WebkitAppearance"in a5.style);let e=!0;return a5.style&&!function Ade(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in a5.style,!e&&AZ&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in a5.style)),e}(t)}matchesElement(t,r){return!1}containsElement(t,r){return NZ(t,r)}getParentElement(t){return JN(t)}query(t,r,s){return IZ(t,r,s)}computeStyle(t,r,s){return s||""}animate(t,r,s,i,o,c=[],u){return new Rg(s,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})(),eI=(()=>{class n{}return n.NOOP=new xZ,n})();const tI="ng-enter",tM="ng-leave",nM="ng-trigger",rM=".ng-trigger",LZ="ng-animating",nI=".ng-animating";function s6(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:rI(parseFloat(e[1]),e[2])}function rI(n,e){return"s"===e?1e3*n:n}function sM(n,e,t){return n.hasOwnProperty("duration")?n:function Lde(n,e,t){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return e.push(PZ()),{duration:0,delay:0,easing:""};s=rI(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=rI(parseFloat(u),c[4]));const h=c[5];h&&(o=h)}else s=n;if(!t){let c=!1,u=e.length;s<0&&(e.push(function Z9e(){return new Ae(3100,!1)}()),c=!0),i<0&&(e.push(function Y9e(){return new Ae(3101,!1)}()),c=!0),c&&e.splice(u,0,PZ())}return{duration:s,delay:i,easing:o}}(n,e,t)}function Dg(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function RZ(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function e8(n,e=new Map,t){if(t)for(let[r,s]of t)e.set(r,s);for(let[r,s]of n)e.set(r,s);return e}function zZ(n,e,t){return t?e+":"+t+";":""}function HZ(n){let e="";for(let t=0;t<n.style.length;t++){const r=n.style.item(t);e+=zZ(0,r,n.style.getPropertyValue(r))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=zZ(0,Hde(t),n.style[t]));n.setAttribute("style",e)}function D4(n,e,t){n.style&&(e.forEach((r,s)=>{const i=iI(s);t&&!t.has(s)&&t.set(s,n.style[i]),n.style[i]=r}),ZN()&&HZ(n))}function c5(n,e){n.style&&(e.forEach((t,r)=>{const s=iI(r);n.style[s]=""}),ZN()&&HZ(n))}function zg(n){return Array.isArray(n)?1==n.length?n[0]:yZ(n):n}const sI=new RegExp("{{\\s*(.+?)\\s*}}","g");function VZ(n){let e=[];if("string"==typeof n){let t;for(;t=sI.exec(n);)e.push(t[1]);sI.lastIndex=0}return e}function Hg(n,e,t){const r=n.toString(),s=r.replace(sI,(i,o)=>{let c=e[o];return null==c&&(t.push(function X9e(n){return new Ae(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function iM(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const zde=/-+([a-z0-9])/g;function iI(n){return n.replace(zde,(...e)=>e[1].toUpperCase())}function Hde(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ua(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Q9e(n){return new Ae(3004,!1)}()}}function FZ(n,e){return window.getComputedStyle(n)[e]}function Ude(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function qde(n,e,t){if(":"==n[0]){const u=function Wde(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,r)=>parseFloat(r)>parseFloat(t);case":decrement":return(t,r)=>parseFloat(r)<parseFloat(t);default:return e.push(function hde(n){return new Ae(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof u)return void e.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return t.push(function fde(n){return new Ae(3015,!1)}()),e;const s=r[1],i=r[2],o=r[3];e.push(BZ(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&e.push(BZ(o,s))}(r,t,e)):t.push(n),t}const lM=new Set(["true","1"]),uM=new Set(["false","0"]);function BZ(n,e){const t=lM.has(n)||uM.has(n),r=lM.has(e)||uM.has(e);return(s,i)=>{let o="*"==n||n==s,c="*"==e||e==i;return!o&&t&&"boolean"==typeof s&&(o=s?lM.has(n):uM.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?lM.has(e):uM.has(e)),o&&c}}const jde=new RegExp("s*:selfs*,?","g");function oI(n,e,t,r){return new Zde(n).build(e,t,r)}class Zde{constructor(e){this._driver=e}build(e,t,r){const s=new Xde(t);return this._resetContextStyleTimingState(s),Ua(this,zg(e),s)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let r=t.queryCount=0,s=t.depCount=0;const i=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function ede(){return new Ae(3006,!1)}()),e.definitions.forEach(c=>{if(this._resetContextStyleTimingState(t),0==c.type){const u=c,h=u.name;h.toString().split(/\s*,\s*/).forEach(g=>{u.name=g,i.push(this.visitState(u,t))}),u.name=h}else if(1==c.type){const u=this.visitTransition(c,t);r+=u.queryCount,s+=u.depCount,o.push(u)}else t.errors.push(function tde(){return new Ae(3007,!1)}())}),{type:7,name:e.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(e,t){const r=this.visitStyle(e.styles,t),s=e.options&&e.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{VZ(u).forEach(h=>{o.hasOwnProperty(h)||i.add(h)})})}),i.size&&(iM(i.values()),t.errors.push(function nde(n,e){return new Ae(3008,!1)}()))}return{type:0,name:e.name,style:r,options:s?{params:s}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const r=Ua(this,zg(e.animation),t);return{type:1,matchers:Ude(e.expr,t.errors),animation:r,queryCount:t.queryCount,depCount:t.depCount,options:l5(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(r=>Ua(this,r,t)),options:l5(e.options)}}visitGroup(e,t){const r=t.currentTime;let s=0;const i=e.steps.map(o=>{t.currentTime=r;const c=Ua(this,o,t);return s=Math.max(s,t.currentTime),c});return t.currentTime=s,{type:3,steps:i,options:l5(e.options)}}visitAnimate(e,t){const r=function Jde(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return aI(sM(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=aI(0,0,"");return i.dynamic=!0,i.strValue=t,i}const s=sM(t,e);return aI(s.duration,s.delay,s.easing)}(e.timings,t.errors);t.currentAnimateTimings=r;let s,i=e.styles?e.styles:EZ({});if(5==i.type)s=this.visitKeyframes(i,t);else{let o=e.styles,c=!1;if(!o){c=!0;const h={};r.easing&&(h.easing=r.easing),o=EZ(h)}t.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,t);u.isEmptyStep=c,s=u}return t.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(e,t){const r=this._makeStyleAst(e,t);return this._validateStyleAst(r,t),r}_makeStyleAst(e,t){const r=[],s=Array.isArray(e.styles)?e.styles:[e.styles];for(let c of s)"string"==typeof c?c===r6?r.push(c):t.errors.push(new Ae(3002,!1)):r.push(RZ(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:e.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(e,t){const r=t.currentAnimateTimings;let s=t.currentTime,i=t.currentTime;r&&i>0&&(i-=r.duration+r.delay),e.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const h=t.collectedStyles.get(t.currentQuerySelector),g=h.get(u);let m=!0;g&&(i!=s&&i>=g.startTime&&s<=g.endTime&&(t.errors.push(function sde(n,e,t,r,s){return new Ae(3010,!1)}()),m=!1),i=g.startTime),m&&h.set(u,{startTime:i,endTime:s}),t.options&&function Dde(n,e,t){const r=e.params||{},s=VZ(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||t.push(function K9e(n){return new Ae(3001,!1)}())})}(c,t.options,t.errors)})})}visitKeyframes(e,t){const r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function ide(){return new Ae(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,h=0;const g=e.steps.map(ie=>{const ye=this._makeStyleAst(ie,t);let te=null!=ye.offset?ye.offset:function Qde(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const r=t;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(ye.styles),xe=0;return null!=te&&(i++,xe=ye.offset=te),u=u||xe<0||xe>1,c=c||xe<h,h=xe,o.push(xe),ye});u&&t.errors.push(function ode(){return new Ae(3012,!1)}()),c&&t.errors.push(function ade(){return new Ae(3200,!1)}());const m=e.steps.length;let M=0;i>0&&i<m?t.errors.push(function cde(){return new Ae(3202,!1)}()):0==i&&(M=1/(m-1));const b=m-1,L=t.currentTime,G=t.currentAnimateTimings,j=G.duration;return g.forEach((ie,ye)=>{const te=M>0?ye==b?1:M*ye:o[ye],xe=te*j;t.currentTime=L+G.delay+xe,G.duration=xe,this._validateStyleAst(ie,t),ie.offset=te,r.styles.push(ie)}),r}visitReference(e,t){return{type:8,animation:Ua(this,zg(e.animation),t),options:l5(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:l5(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:l5(e.options)}}visitQuery(e,t){const r=t.currentQuerySelector,s=e.options||{};t.queryCount++,t.currentQuery=e;const[i,o]=function Yde(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(jde,"")),n=n.replace(/@\*/g,rM).replace(/@\w+/g,t=>rM+"-"+t.slice(1)).replace(/:animating/g,nI),[n,e]}(e.selector);t.currentQuerySelector=r.length?r+" "+i:i,Ga(t.collectedStyles,t.currentQuerySelector,new Map);const c=Ua(this,zg(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:e.selector,options:l5(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function lde(){return new Ae(3013,!1)}());const r="full"===e.timings?{duration:0,delay:0,easing:"full"}:sM(e.timings,t.errors,!0);return{type:12,animation:Ua(this,zg(e.animation),t),timings:r,options:null}}}class Xde{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function l5(n){return n?(n=Dg(n)).params&&(n.params=function Kde(n){return n?Dg(n):null}(n.params)):n={},n}function aI(n,e,t){return{duration:n,delay:e,easing:t}}function cI(n,e,t,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class fM{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const npe=new RegExp(":enter","g"),spe=new RegExp(":leave","g");function lI(n,e,t,r,s,i=new Map,o=new Map,c,u,h=[]){return(new ipe).buildKeyframes(n,e,t,r,s,i,o,c,u,h)}class ipe{buildKeyframes(e,t,r,s,i,o,c,u,h,g=[]){h=h||new fM;const m=new uI(e,t,h,s,i,g,[]);m.options=u;const M=u.delay?s6(u.delay):0;m.currentTimeline.delayNextStep(M),m.currentTimeline.setStyles([o],null,m.errors,u),Ua(this,r,m);const b=m.timelines.filter(L=>L.containsAnimation());if(b.length&&c.size){let L;for(let G=b.length-1;G>=0;G--){const j=b[G];if(j.element===t){L=j;break}}L&&!L.allowOnlyTimelineStyles()&&L.setStyles([c],null,m.errors,u)}return b.length?b.map(L=>L.buildKeyframes()):[cI(t,[],[],[],0,M,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const r=t.subInstructions.get(t.element);if(r){const s=t.createSubContext(e.options),i=t.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const r=t.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,r),this.visitReference(e.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,r){for(const s of e){const i=s?.delay;if(i){const o="number"==typeof i?i:s6(Hg(i,s?.params??{},t.errors));r.delayNextStep(o)}}}_visitSubInstructions(e,t,r){let i=t.currentTimeline.currentTime;const o=null!=r.duration?s6(r.duration):null,c=null!=r.delay?s6(r.delay):null;return 0!==o&&e.forEach(u=>{const h=t.appendInstructionToTimeline(u,o,c);i=Math.max(i,h.duration+h.delay)}),i}visitReference(e,t){t.updateOptions(e.options,!0),Ua(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const r=t.subContextCount;let s=t;const i=e.options;if(i&&(i.params||i.delay)&&(s=t.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=hM);const o=s6(i.delay);s.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Ua(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const r=[];let s=t.currentTimeline.currentTime;const i=e.options&&e.options.delay?s6(e.options.delay):0;e.steps.forEach(o=>{const c=t.createSubContext(e.options);i&&c.delayNextStep(i),Ua(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(s),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const r=e.strValue;return sM(t.params?Hg(r,t.params,t.errors):r,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const r=t.currentAnimateTimings=this._visitTiming(e.timings,t),s=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),s.snapshotCurrentStyles());const i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(r.duration),this.visitStyle(i,t),s.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const r=t.currentTimeline,s=t.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(i):r.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const r=t.currentAnimateTimings,s=t.currentTimeline.duration,i=r.duration,c=t.createSubContext().currentTimeline;c.easing=r.easing,e.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,t.errors,t.options),c.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(c),t.transformIntoNewTimeline(s+i),t.previousNode=e}visitQuery(e,t){const r=t.currentTimeline.currentTime,s=e.options||{},i=s.delay?s6(s.delay):0;i&&(6===t.previousNode.type||0==r&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=hM);let o=r;const c=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!s.optional,t.errors);t.currentQueryTotal=c.length;let u=null;c.forEach((h,g)=>{t.currentQueryIndex=g;const m=t.createSubContext(e.options,h);i&&m.delayNextStep(i),h===t.element&&(u=m.currentTimeline),Ua(this,e.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const r=t.parentContext,s=t.currentTimeline,i=e.timings,o=Math.abs(i.duration),c=o*(t.currentQueryTotal-1);let u=o*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const g=t.currentTimeline;u&&g.delayNextStep(u);const m=g.currentTime;Ua(this,e.animation,t),t.previousNode=e,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const hM={};class uI{constructor(e,t,r,s,i,o,c,u){this._driver=e,this.element=t,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=hM,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new dM(this._driver,t,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const r=e;let s=this.options;null!=r.duration&&(s.duration=s6(r.duration)),null!=r.delay&&(s.delay=s6(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!t||!o.hasOwnProperty(c))&&(o[c]=Hg(i[c],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const r=e.params={};Object.keys(t).forEach(s=>{r[s]=t[s]})}}return e}createSubContext(e=null,t,r){const s=t||this.element,i=new uI(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(e),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(e){return this.previousNode=hM,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,r){const s={duration:t??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},i=new ope(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,s,e.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,r,s,i,o){let c=[];if(s&&c.push(this.element),e.length>0){e=(e=e.replace(npe,"."+this._enterClassName)).replace(spe,"."+this._leaveClassName);let h=this._driver.query(this.element,e,1!=r);0!==r&&(h=r<0?h.slice(h.length+r,h.length):h.slice(0,r)),c.push(...h)}return!i&&0==c.length&&o.push(function ude(n){return new Ae(3014,!1)}()),c}}class dM{constructor(e,t,r,s){this._driver=e,this.element=t,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new dM(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,r]of this._globalTimelineStyles)this._backFill.set(t,r||r6),this._currentKeyframe.set(t,r6);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,r,s){t&&this._previousKeyframe.set("easing",t);const i=s&&s.params||{},o=function ape(n,e){const t=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||e.keys();for(let i of r)t.set(i,r6)}else e8(s,t)}),t}(e,this._globalTimelineStyles);for(let[c,u]of o){const h=Hg(u,i,r);this._pendingStyles.set(c,h),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??r6),this._updateStyle(c,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,r)=>{const s=this._styleSummary.get(r);(!s||t.time>s.time)&&this._updateStyle(r,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const h=e8(c,new Map,this._backFill);h.forEach((g,m)=>{"!"===g?e.add(m):g===r6&&t.add(m)}),r||h.set("offset",u/this.duration),s.push(h)});const i=e.size?iM(e.values()):[],o=t.size?iM(t.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return cI(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class ope extends dM{constructor(e,t,r,s,i,o,c=!1){super(e,t,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&t){const i=[],o=r+t,c=t/o,u=e8(e[0]);u.set("offset",0),i.push(u);const h=e8(e[0]);h.set("offset",UZ(c)),i.push(h);const g=e.length-1;for(let m=1;m<=g;m++){let M=e8(e[m]);const b=M.get("offset");M.set("offset",UZ((t+b*r)/o)),i.push(M)}r=o,t=0,s="",e=i}return cI(this.element,e,this.preStyleProps,this.postStyleProps,r,t,s,!0)}}function UZ(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class fI{}const cpe=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class lpe extends fI{normalizePropertyName(e,t){return iI(e)}normalizeStyleValue(e,t,r,s){let i="";const o=r.toString().trim();if(cpe.has(t)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function J9e(n,e){return new Ae(3005,!1)}())}return o+i}}function qZ(n,e,t,r,s,i,o,c,u,h,g,m,M){return{type:0,element:n,triggerName:e,isRemovalTransition:s,fromState:t,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:h,postStyleProps:g,totalTime:m,errors:M}}const hI={};class WZ{constructor(e,t,r){this._triggerName=e,this.ast=t,this._stateStyles=r}match(e,t,r,s){return function upe(n,e,t,r,s){return n.some(i=>i(e,t,r,s))}(this.ast.matchers,e,t,r,s)}buildStyles(e,t,r){let s=this._stateStyles.get("*");return void 0!==e&&(s=this._stateStyles.get(e?.toString())||s),s?s.buildStyles(t,r):new Map}build(e,t,r,s,i,o,c,u,h,g){const m=[],M=this.ast.options&&this.ast.options.params||hI,L=this.buildStyles(r,c&&c.params||hI,m),G=u&&u.params||hI,j=this.buildStyles(s,G,m),ie=new Set,ye=new Map,te=new Map,xe="void"===s,$e={params:fpe(G,M),delay:this.ast.options?.delay},et=g?[]:lI(e,t,this.ast.animation,i,o,L,j,$e,h,m);let Ft=0;if(et.forEach(jt=>{Ft=Math.max(jt.duration+jt.delay,Ft)}),m.length)return qZ(t,this._triggerName,r,s,xe,L,j,[],[],ye,te,Ft,m);et.forEach(jt=>{const Ys=jt.element,G6=Ga(ye,Ys,new Set);jt.preStyleProps.forEach(wa=>G6.add(wa));const Jc=Ga(te,Ys,new Set);jt.postStyleProps.forEach(wa=>Jc.add(wa)),Ys!==t&&ie.add(Ys)});const H1=iM(ie.values());return qZ(t,this._triggerName,r,s,xe,L,j,et,H1,ye,te,Ft)}}function fpe(n,e){const t=Dg(e);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(t[r]=n[r]);return t}class hpe{constructor(e,t,r){this.styles=e,this.defaultParams=t,this.normalizer=r}buildStyles(e,t){const r=new Map,s=Dg(this.defaultParams);return Object.keys(e).forEach(i=>{const o=e[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=Hg(o,s,t));const u=this.normalizer.normalizePropertyName(c,t);o=this.normalizer.normalizeStyleValue(c,u,o,t),r.set(u,o)})}),r}}class ppe{constructor(e,t,r){this.name=e,this.ast=t,this._normalizer=r,this.transitionFactories=[],this.states=new Map,t.states.forEach(s=>{this.states.set(s.name,new hpe(s.style,s.options&&s.options.params||{},r))}),jZ(this.states,"true","1"),jZ(this.states,"false","0"),t.transitions.forEach(s=>{this.transitionFactories.push(new WZ(e,s,this.states))}),this.fallbackTransition=function gpe(n,e,t){return new WZ(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,r,s){return this.transitionFactories.find(o=>o.match(e,t,r,s))||null}matchStyles(e,t,r){return this.fallbackTransition.buildStyles(e,t,r)}}function jZ(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const mpe=new fM;class _pe{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const r=[],i=oI(this._driver,t,r,[]);if(r.length)throw function _de(n){return new Ae(3503,!1)}();this._animations.set(e,i)}_buildPlayer(e,t,r){const s=e.element,i=TZ(0,this._normalizer,0,e.keyframes,t,r);return this._driver.animate(s,i,e.duration,e.delay,e.easing,[],!0)}create(e,t,r={}){const s=[],i=this._animations.get(e);let o;const c=new Map;if(i?(o=lI(this._driver,t,i,tI,tM,new Map,new Map,r,mpe,s),o.forEach(g=>{const m=Ga(c,g.element,new Map);g.postStyleProps.forEach(M=>m.set(M,null))})):(s.push(function vde(){return new Ae(3300,!1)}()),o=[]),s.length)throw function Cde(n){return new Ae(3504,!1)}();c.forEach((g,m)=>{g.forEach((M,b)=>{g.set(b,this._driver.computeStyle(m,b,r6))})});const h=J0(o.map(g=>{const m=c.get(g.element);return this._buildPlayer(g,new Map,m)}));return this._playersById.set(e,h),h.onDestroy(()=>this.destroy(e)),this.players.push(h),h}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function yde(n){return new Ae(3301,!1)}();return t}listen(e,t,r,s){const i=XN(t,"","","");return YN(this._getPlayer(e),r,i,s),()=>{}}command(e,t,r,s){if("register"==r)return void this.register(e,s[0]);if("create"==r)return void this.create(e,t,s[0]||{});const i=this._getPlayer(e);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(e)}}}const ZZ="ng-animate-queued",dI="ng-animate-disabled",Mpe=[],YZ={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Spe={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},wc="__ng_removed";class pI{constructor(e,t=""){this.namespaceId=t;const r=e&&e.hasOwnProperty("value");if(this.value=function bpe(n){return n??null}(r?e.value:e),r){const i=Dg(e);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const r=this.options.params;Object.keys(t).forEach(s=>{null==r[s]&&(r[s]=t[s])})}}}const Vg="void",gI=new pI(Vg);class Ppe{constructor(e,t,r){this.id=e,this.hostElement=t,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,bc(t,this._hostClassName)}listen(e,t,r,s){if(!this._triggers.has(t))throw function Ede(n,e){return new Ae(3302,!1)}();if(null==r||0==r.length)throw function Mde(n){return new Ae(3303,!1)}();if(!function Ope(n){return"start"==n||"done"==n}(r))throw function Sde(n,e){return new Ae(3400,!1)}();const i=Ga(this._elementListeners,e,[]),o={name:t,phase:r,callback:s};i.push(o);const c=Ga(this._engine.statesByElement,e,new Map);return c.has(t)||(bc(e,nM),bc(e,nM+"-"+t),c.set(t,gI)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(t)||c.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function Pde(n){return new Ae(3401,!1)}();return t}trigger(e,t,r,s=!0){const i=this._getTrigger(t),o=new mI(this.id,t,e);let c=this._engine.statesByElement.get(e);c||(bc(e,nM),bc(e,nM+"-"+t),this._engine.statesByElement.set(e,c=new Map));let u=c.get(t);const h=new pI(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),c.set(t,h),u||(u=gI),h.value!==Vg&&u.value===h.value){if(!function Ipe(n,e){const t=Object.keys(n),r=Object.keys(e);if(t.length!=r.length)return!1;for(let s=0;s<t.length;s++){const i=t[s];if(!e.hasOwnProperty(i)||n[i]!==e[i])return!1}return!0}(u.params,h.params)){const G=[],j=i.matchStyles(u.value,u.params,G),ie=i.matchStyles(h.value,h.params,G);G.length?this._engine.reportError(G):this._engine.afterFlush(()=>{c5(e,j),D4(e,ie)})}return}const M=Ga(this._engine.playersByElement,e,[]);M.forEach(G=>{G.namespaceId==this.id&&G.triggerName==t&&G.queued&&G.destroy()});let b=i.matchTransition(u.value,h.value,e,h.params),L=!1;if(!b){if(!s)return;b=i.fallbackTransition,L=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:b,fromState:u,toState:h,player:o,isFallbackTransition:L}),L||(bc(e,ZZ),o.onStart(()=>{hh(e,ZZ)})),o.onDone(()=>{let G=this.players.indexOf(o);G>=0&&this.players.splice(G,1);const j=this._engine.playersByElement.get(e);if(j){let ie=j.indexOf(o);ie>=0&&j.splice(ie,1)}}),this.players.push(o),M.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,r)=>{this._elementListeners.set(r,t.filter(s=>s.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const r=this._engine.driver.query(e,rM,!0);r.forEach(s=>{if(s[wc])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,t,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(e,t,r,s){const i=this._engine.statesByElement.get(e),o=new Map;if(i){const c=[];if(i.forEach((u,h)=>{if(o.set(h,u.value),this._triggers.has(h)){const g=this.trigger(e,h,Vg,s);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),r&&J0(c).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(t&&r){const s=new Set;t.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,h=r.get(o)||gI,g=new pI(Vg),m=new mI(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:u,fromState:h,toState:g,player:m,isFallbackTransition:!0})})}}removeNode(e,t){const r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(e):[];if(i&&i.length)s=!0;else{let o=e;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(e),s)r.markElementAsRemoved(this.id,e,!1,t);else{const i=e[wc];(!i||i===YZ)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}insertNode(e,t){bc(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=XN(i,r.triggerName,r.fromState.value,r.toState.value);u._data=e,YN(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):t.push(r)}),this._queue=[],t.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(r=>r.element===e)||t,t}}class Tpe{constructor(e,t,r){this.bodyNode=e,this.driver=t,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,t){const r=new Ppe(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,t){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(t);for(;c;){const u=s.get(c);if(u){const h=r.indexOf(u);r.splice(h+1,0,e),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(e)}else r.push(e);return s.set(t,e),e}register(e,t){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,t)),r}registerTrigger(e,t,r){let s=this._namespaceLookup[e];s&&s.register(t,r)&&this.totalAnimations++}destroy(e,t){if(!e)return;const r=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[e];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,r=this.statesByElement.get(e);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&t.add(i)}return t}trigger(e,t,r,s){if(pM(t)){const i=this._fetchNamespace(e);if(i)return i.trigger(t,r,s),!0}return!1}insertNode(e,t,r,s){if(!pM(t))return;const i=t[wc];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,r)}s&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),bc(e,dI)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),hh(e,dI))}removeNode(e,t,r,s){if(pM(t)){const i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,s):this.markElementAsRemoved(e,t,!1,s),r){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,s)}}else this._onRemovalComplete(t,s)}markElementAsRemoved(e,t,r,s,i){this.collectedLeaveElements.push(t),t[wc]={namespaceId:e,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(e,t,r,s,i){return pM(t)?this._fetchNamespace(e).listen(t,r,s,i):()=>{}}_buildInstruction(e,t,r,s,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,s,e.fromState.options,e.toState.options,t,i)}destroyInnerAnimations(e){let t=this.driver.query(e,rM,!0);t.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,nI,!0),t.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return J0(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[wc];if(t&&t.setForRemoval){if(e[wc]=YZ,t.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(t.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(dI)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)bc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{t=this._flushAnimations(r,e)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],t.length?J0(t).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(e){throw function Tde(n){return new Ae(3402,!1)}()}_flushAnimations(e,t){const r=new fM,s=[],i=new Map,o=[],c=new Map,u=new Map,h=new Map,g=new Set;this.disabledNodes.forEach(St=>{g.add(St);const qt=this.driver.query(St,".ng-animate-queued",!0);for(let en=0;en<qt.length;en++)g.add(qt[en])});const m=this.bodyNode,M=Array.from(this.statesByElement.keys()),b=QZ(M,this.collectedEnterElements),L=new Map;let G=0;b.forEach((St,qt)=>{const en=tI+G++;L.set(qt,en),St.forEach(i1=>bc(i1,en))});const j=[],ie=new Set,ye=new Set;for(let St=0;St<this.collectedLeaveElements.length;St++){const qt=this.collectedLeaveElements[St],en=qt[wc];en&&en.setForRemoval&&(j.push(qt),ie.add(qt),en.hasAnimation?this.driver.query(qt,".ng-star-inserted",!0).forEach(i1=>ie.add(i1)):ye.add(qt))}const te=new Map,xe=QZ(M,Array.from(ie));xe.forEach((St,qt)=>{const en=tM+G++;te.set(qt,en),St.forEach(i1=>bc(i1,en))}),e.push(()=>{b.forEach((St,qt)=>{const en=L.get(qt);St.forEach(i1=>hh(i1,en))}),xe.forEach((St,qt)=>{const en=te.get(qt);St.forEach(i1=>hh(i1,en))}),j.forEach(St=>{this.processLeaveNode(St)})});const $e=[],et=[];for(let St=this._namespaceList.length-1;St>=0;St--)this._namespaceList[St].drainQueuedTransitions(t).forEach(en=>{const i1=en.player,Zt=en.element;if($e.push(i1),this.collectedEnterElements.length){const fo=Zt[wc];if(fo&&fo.setForMove){if(fo.previousTriggersValues&&fo.previousTriggersValues.has(en.triggerName)){const E7=fo.previousTriggersValues.get(en.triggerName),e3=this.statesByElement.get(en.element);if(e3&&e3.has(en.triggerName)){const FT=e3.get(en.triggerName);FT.value=E7,e3.set(en.triggerName,FT)}}return void i1.destroy()}}const gl=!m||!this.driver.containsElement(m,Zt),cc=te.get(Zt),q8=L.get(Zt),es=this._buildInstruction(en,r,q8,cc,gl);if(es.errors&&es.errors.length)return void et.push(es);if(gl)return i1.onStart(()=>c5(Zt,es.fromStyles)),i1.onDestroy(()=>D4(Zt,es.toStyles)),void s.push(i1);if(en.isFallbackTransition)return i1.onStart(()=>c5(Zt,es.fromStyles)),i1.onDestroy(()=>D4(Zt,es.toStyles)),void s.push(i1);const sle=[];es.timelines.forEach(fo=>{fo.stretchStartingKeyframe=!0,this.disabledNodes.has(fo.element)||sle.push(fo)}),es.timelines=sle,r.append(Zt,es.timelines),o.push({instruction:es,player:i1,element:Zt}),es.queriedElements.forEach(fo=>Ga(c,fo,[]).push(i1)),es.preStyleProps.forEach((fo,E7)=>{if(fo.size){let e3=u.get(E7);e3||u.set(E7,e3=new Set),fo.forEach((FT,qF)=>e3.add(qF))}}),es.postStyleProps.forEach((fo,E7)=>{let e3=h.get(E7);e3||h.set(E7,e3=new Set),fo.forEach((FT,qF)=>e3.add(qF))})});if(et.length){const St=[];et.forEach(qt=>{St.push(function wde(n,e){return new Ae(3505,!1)}())}),$e.forEach(qt=>qt.destroy()),this.reportError(St)}const Ft=new Map,H1=new Map;o.forEach(St=>{const qt=St.element;r.has(qt)&&(H1.set(qt,qt),this._beforeAnimationBuild(St.player.namespaceId,St.instruction,Ft))}),s.forEach(St=>{const qt=St.element;this._getPreviousPlayers(qt,!1,St.namespaceId,St.triggerName,null).forEach(i1=>{Ga(Ft,qt,[]).push(i1),i1.destroy()})});const jt=j.filter(St=>eY(St,u,h)),Ys=new Map;XZ(Ys,this.driver,ye,h,r6).forEach(St=>{eY(St,u,h)&&jt.push(St)});const Jc=new Map;b.forEach((St,qt)=>{XZ(Jc,this.driver,new Set(St),u,"!")}),jt.forEach(St=>{const qt=Ys.get(St),en=Jc.get(St);Ys.set(St,new Map([...Array.from(qt?.entries()??[]),...Array.from(en?.entries()??[])]))});const wa=[],U6=[],q6={};o.forEach(St=>{const{element:qt,player:en,instruction:i1}=St;if(r.has(qt)){if(g.has(qt))return en.onDestroy(()=>D4(qt,i1.toStyles)),en.disabled=!0,en.overrideTotalTime(i1.totalTime),void s.push(en);let Zt=q6;if(H1.size>1){let cc=qt;const q8=[];for(;cc=cc.parentNode;){const es=H1.get(cc);if(es){Zt=es;break}q8.push(cc)}q8.forEach(es=>H1.set(es,Zt))}const gl=this._buildAnimation(en.namespaceId,i1,Ft,i,Jc,Ys);if(en.setRealPlayer(gl),Zt===q6)wa.push(en);else{const cc=this.playersByElement.get(Zt);cc&&cc.length&&(en.parentPlayer=J0(cc)),s.push(en)}}else c5(qt,i1.fromStyles),en.onDestroy(()=>D4(qt,i1.toStyles)),U6.push(en),g.has(qt)&&s.push(en)}),U6.forEach(St=>{const qt=i.get(St.element);if(qt&&qt.length){const en=J0(qt);St.setRealPlayer(en)}}),s.forEach(St=>{St.parentPlayer?St.syncPlayerEvents(St.parentPlayer):St.destroy()});for(let St=0;St<j.length;St++){const qt=j[St],en=qt[wc];if(hh(qt,tM),en&&en.hasAnimation)continue;let i1=[];if(c.size){let gl=c.get(qt);gl&&gl.length&&i1.push(...gl);let cc=this.driver.query(qt,nI,!0);for(let q8=0;q8<cc.length;q8++){let es=c.get(cc[q8]);es&&es.length&&i1.push(...es)}}const Zt=i1.filter(gl=>!gl.destroyed);Zt.length?Ape(this,qt,Zt):this.processLeaveNode(qt)}return j.length=0,wa.forEach(St=>{this.players.push(St),St.onDone(()=>{St.destroy();const qt=this.players.indexOf(St);this.players.splice(qt,1)}),St.play()}),wa}elementContainsData(e,t){let r=!1;const s=t[wc];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(t)&&(r=!0),this.playersByQueriedElement.has(t)&&(r=!0),this.statesByElement.has(t)&&(r=!0),this._fetchNamespace(e).elementContainsData(t)||r}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,r,s,i){let o=[];if(t){const c=this.playersByQueriedElement.get(e);c&&(o=c)}else{const c=this.playersByElement.get(e);if(c){const u=!i||i==Vg;c.forEach(h=>{h.queued||!u&&h.triggerName!=s||o.push(h)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(e,t,r){const i=t.element,o=t.isRemovalTransition?void 0:e,c=t.isRemovalTransition?void 0:t.triggerName;for(const u of t.timelines){const h=u.element,g=h!==i,m=Ga(r,h,[]);this._getPreviousPlayers(h,g,o,c,t.toState).forEach(b=>{const L=b.getRealPlayer();L.beforeDestroy&&L.beforeDestroy(),b.destroy(),m.push(b)})}c5(i,t.fromStyles)}_buildAnimation(e,t,r,s,i,o){const c=t.triggerName,u=t.element,h=[],g=new Set,m=new Set,M=t.timelines.map(L=>{const G=L.element;g.add(G);const j=G[wc];if(j&&j.removedBeforeQueried)return new Rg(L.duration,L.delay);const ie=G!==u,ye=function Npe(n){const e=[];return JZ(n,e),e}((r.get(G)||Mpe).map(Ft=>Ft.getRealPlayer())).filter(Ft=>!!Ft.element&&Ft.element===G),te=i.get(G),xe=o.get(G),$e=TZ(0,this._normalizer,0,L.keyframes,te,xe),et=this._buildPlayer(L,$e,ye);if(L.subTimeline&&s&&m.add(G),ie){const Ft=new mI(e,c,G);Ft.setRealPlayer(et),h.push(Ft)}return et});h.forEach(L=>{Ga(this.playersByQueriedElement,L.element,[]).push(L),L.onDone(()=>function wpe(n,e,t){let r=n.get(e);if(r){if(r.length){const s=r.indexOf(t);r.splice(s,1)}0==r.length&&n.delete(e)}return r}(this.playersByQueriedElement,L.element,L))}),g.forEach(L=>bc(L,LZ));const b=J0(M);return b.onDestroy(()=>{g.forEach(L=>hh(L,LZ)),D4(u,t.toStyles)}),m.forEach(L=>{Ga(s,L,[]).push(b)}),b}_buildPlayer(e,t,r){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,r):new Rg(e.duration,e.delay)}}class mI{constructor(e,t,r){this.namespaceId=e,this.triggerName=t,this.element=r,this._player=new Rg,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,r)=>{t.forEach(s=>YN(e,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Ga(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function pM(n){return n&&1===n.nodeType}function KZ(n,e){const t=n.style.display;return n.style.display=e??"none",t}function XZ(n,e,t,r,s){const i=[];t.forEach(u=>i.push(KZ(u)));const o=[];r.forEach((u,h)=>{const g=new Map;u.forEach(m=>{const M=e.computeStyle(h,m,s);g.set(m,M),(!M||0==M.length)&&(h[wc]=Spe,o.push(h))}),n.set(h,g)});let c=0;return t.forEach(u=>KZ(u,i[c++])),o}function QZ(n,e){const t=new Map;if(n.forEach(c=>t.set(c,[])),0==e.length)return t;const s=new Set(e),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const h=c.parentNode;return u=t.has(h)?h:s.has(h)?1:o(h),i.set(c,u),u}return e.forEach(c=>{const u=o(c);1!==u&&t.get(u).push(c)}),t}function bc(n,e){n.classList?.add(e)}function hh(n,e){n.classList?.remove(e)}function Ape(n,e,t){J0(t).onDone(()=>n.processLeaveNode(e))}function JZ(n,e){for(let t=0;t<n.length;t++){const r=n[t];r instanceof SZ?JZ(r.players,e):e.push(r)}}function eY(n,e,t){const r=t.get(n);if(!r)return!1;let s=e.get(n);return s?r.forEach(i=>s.add(i)):e.set(n,r),t.delete(n),!0}class gM{constructor(e,t,r){this.bodyNode=e,this._driver=t,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new Tpe(e,t,r),this._timelineEngine=new _pe(e,t,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(e,t,r,s,i){const o=e+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],g=oI(this._driver,i,u,[]);if(u.length)throw function gde(n,e){return new Ae(3404,!1)}();c=function dpe(n,e,t){return new ppe(n,e,t)}(s,g,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(t,s,c)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,r,s){this._transitionEngine.insertNode(e,t,r,s)}onRemove(e,t,r,s){this._transitionEngine.removeNode(e,t,s||!1,r)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,r,s){if("@"==r.charAt(0)){const[i,o]=wZ(r);this._timelineEngine.command(i,t,o,s)}else this._transitionEngine.trigger(e,t,r,s)}listen(e,t,r,s,i){if("@"==r.charAt(0)){const[o,c]=wZ(r);return this._timelineEngine.listen(o,t,c,i)}return this._transitionEngine.listen(e,t,r,s,i)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let kpe=(()=>{class n{constructor(t,r,s){this._element=t,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(t);i||n.initialStylesByElement.set(t,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&D4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(D4(this._element,this._initialStyles),this._endStyles&&(D4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(c5(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(c5(this._element,this._endStyles),this._endStyles=null),D4(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function _I(n){let e=null;return n.forEach((t,r)=>{(function Lpe(n){return"display"===n||"position"===n})(r)&&(e=e||new Map,e.set(r,t))}),e}class tY{constructor(e,t,r,s){this.element=e,this.keyframes=t,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(r=>{t.push(Object.fromEntries(r))}),t}_triggerWebAnimation(e,t,r){return e.animate(this._convertKeyframesToObject(t),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&e.set(s,this._finished?r:FZ(this.element,s))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(r=>r()),t.length=0}}class Rpe{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return NZ(e,t)}getParentElement(e){return JN(e)}query(e,t,r){return IZ(e,t,r)}computeStyle(e,t,r){return window.getComputedStyle(e)[t]}animate(e,t,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const h=new Map,g=o.filter(b=>b instanceof tY);(function Vde(n,e){return 0===n||0===e})(r,s)&&g.forEach(b=>{b.currentSnapshot.forEach((L,G)=>h.set(G,L))});let m=function Rde(n){return n.length?n[0]instanceof Map?n:n.map(e=>RZ(e)):[]}(t).map(b=>e8(b));m=function Fde(n,e,t){if(t.size&&e.length){let r=e[0],s=[];if(t.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<e.length;i++){let o=e[i];s.forEach(c=>o.set(c,FZ(n,c)))}}return e}(e,m,h);const M=function xpe(n,e){let t=null,r=null;return Array.isArray(e)&&e.length?(t=_I(e[0]),e.length>1&&(r=_I(e[e.length-1]))):e instanceof Map&&(t=_I(e)),t||r?new kpe(n,t,r):null}(e,m);return new tY(e,m,u,M)}}let Dpe=(()=>{class n extends CZ{constructor(t,r){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(r.body,{id:"0",encapsulation:V1.None,styles:[],data:{animation:[]}})}build(t){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(t)?yZ(t):t;return nY(this._renderer,null,r,"register",[s]),new zpe(r,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(De(A0),De(Hs))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class zpe extends class j9e{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Hpe(this._id,e,t||{},this._renderer)}}class Hpe{constructor(e,t,r,s){this.id=e,this.element=t,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return nY(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function nY(n,e,t,r,s){return n.setProperty(e,`@@${t}:${r}`,s)}const rY="@.disabled";let Vpe=(()=>{class n{constructor(t,r,s){this.delegate=t,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(t,r){const i=this.delegate.createRenderer(t,r);if(!(t&&r&&r.data&&r.data.animation)){let g=this._rendererCache.get(i);return g||(g=new sY("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,g)),g}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,t);const u=g=>{Array.isArray(g)?g.forEach(u):this.engine.registerTrigger(o,c,t,g.name,g)};return r.data.animation.forEach(u),new Fpe(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,r,s){t>=0&&t<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(De(A0),De(gM),De(Er))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();class sY{constructor(e,t,r,s){this.namespaceId=e,this.delegate=t,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>t.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,r,s=!0){this.delegate.insertBefore(e,t,r),this.engine.onInsert(this.namespaceId,t,e,s)}removeChild(e,t,r){this.engine.onRemove(this.namespaceId,t,this.delegate,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,s){this.delegate.setAttribute(e,t,r,s)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,s){this.delegate.setStyle(e,t,r,s)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){"@"==t.charAt(0)&&t==rY?this.disableAnimations(e,!!r):this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.delegate.listen(e,t,r)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Fpe extends sY{constructor(e,t,r,s,i){super(t,r,s,i),this.factory=e,this.namespaceId=t}setProperty(e,t,r){"@"==t.charAt(0)?"."==t.charAt(1)&&t==rY?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,t.slice(1),r):this.delegate.setProperty(e,t,r)}listen(e,t,r){if("@"==t.charAt(0)){const s=function Bpe(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let i=t.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function $pe(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(e,t,r)}}let Gpe=(()=>{class n extends gM{constructor(t,r,s,i){super(t.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(De(Hs),De(eI),De(fI),De(rg))},n.\u0275prov=nt({token:n,factory:n.\u0275fac}),n})();const iY=[{provide:CZ,useClass:Dpe},{provide:fI,useFactory:function Upe(){return new lpe}},{provide:gM,useClass:Gpe},{provide:A0,useFactory:function qpe(n,e,t){return new Vpe(n,e,t)},deps:[vE,gM,Er]}],vI=[{provide:eI,useFactory:()=>new Rpe},{provide:yU,useValue:"BrowserAnimations"},...iY],oY=[{provide:eI,useClass:xZ},{provide:yU,useValue:"NoopAnimations"},...iY];let Wpe=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?oY:vI}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({providers:vI,imports:[Hq]}),n})();const Es=void 0,Zpe=["fr",[["AM","PM"],Es,Es],Es,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Es,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Es,[["av. J.-C.","ap. J.-C."],Es,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Es],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Es,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Es,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Es,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Es,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Es,"\xa5"],KMF:[Es,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Es,"$C"],NZD:["$NZ","$"],PHP:[Es,"\u20b1"],RHD:["$RH"],RON:[Es,"L"],RWF:[Es,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Es,"$T"],TTD:["$TT","$"],TWD:[Es,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Es,"$"],XPF:["FCFP"],ZMW:[Es,"Kw"]},"ltr",function jpe(n){const t=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===t||1===t?1:0===s&&0!==t&&t%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function aY(n,e,t,r,s,i,o){try{var c=n[i](o),u=c.value}catch(h){return void t(h)}c.done?e(u):Promise.resolve(u).then(r,s)}function I(n){return function(){var e=this,t=arguments;return new Promise(function(r,s){var i=n.apply(e,t);function o(u){aY(i,r,s,o,c,"next",u)}function c(u){aY(i,r,s,o,c,"throw",u)}o(void 0)})}}const cY=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=63&s|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=63&s|128)}return e},yI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,h=u?n[s+2]:0;let M=(15&c)<<2|h>>6,b=63&h;u||(b=64,o||(M=64)),r.push(t[i>>2],t[(3&i)<<4|c>>4],t[M],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(cY(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],c=s<n.length?t[n.charAt(s)]:0;++s;const h=s<n.length?t[n.charAt(s)]:64;++s;const m=s<n.length?t[n.charAt(s)]:64;if(++s,null==i||null==c||null==h||null==m)throw Error();r.push(i<<2|c>>4),64!==h&&(r.push(c<<4&240|h>>2),64!==m&&r.push(h<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},_M=function(n){return function(n){const e=cY(n);return yI.encodeByteArray(e,!0)}(n).replace(/\./g,"")},vM=function(n){try{return yI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Di(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function EI(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function u5(){return"object"==typeof indexedDB}function Fg(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(t){e(t)}})}function MI(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const SI=()=>{try{return function sge(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&vM(n[1]);return e&&JSON.parse(e)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},uY=n=>{var e,t;return null===(t=null===(e=SI())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[n]},fY=n=>{var e;return null===(e=SI())||void 0===e?void 0:e[`_${n}`]};class CM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}class Oc extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Oc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,z4.prototype.create)}}class z4{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?function hge(n,e){return n.replace(dge,(t,r)=>{const s=e[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new Oc(s,`${this.serviceName}: ${o} (${s}).`,r)}}const dge=/\{\$([^}]+)}/g;function EM(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(dY(i)&&dY(o)){if(!EM(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function dY(n){return null!==n&&"object"==typeof n}function Bg(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function $g(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Gg(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}class mge{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");s=function _ge(n,e){if("object"!=typeof n||null===n)return!1;for(const t of e)if(t in n&&"function"==typeof n[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r},void 0===s.next&&(s.next=PI),void 0===s.error&&(s.error=PI),void 0===s.complete&&(s.complete=PI);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function PI(){}function wI(n,e=1e3,t=2){const r=e*Math.pow(t,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function jr(n){return n&&n._delegate?n._delegate:n}class K2{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const f5="[DEFAULT]";class Sge{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new CM;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e?.identifier),s=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function Tge(n){return"EAGER"===n.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:f5})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=f5){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return I(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=f5){return this.instances.has(e)}getOptions(e=f5){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=e,n===f5?void 0:n),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(e=f5){return this.component?this.component.multipleInstances?e:f5:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class wge{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Sge(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const bI=[];var d1=(()=>{return(n=d1||(d1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",d1;var n})();const pY={debug:d1.DEBUG,verbose:d1.VERBOSE,info:d1.INFO,warn:d1.WARN,error:d1.ERROR,silent:d1.SILENT},bge=d1.INFO,Oge={[d1.DEBUG]:"log",[d1.VERBOSE]:"log",[d1.INFO]:"info",[d1.WARN]:"warn",[d1.ERROR]:"error"},Age=(n,e,...t)=>{if(e<n.logLevel)return;const r=(new Date).toISOString(),s=Oge[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${r}]  ${n.name}:`,...t)};class dh{constructor(e){this.name=e,this._logLevel=bge,this._logHandler=Age,this._userLogHandler=null,bI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in d1))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?pY[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,d1.DEBUG,...e),this._logHandler(this,d1.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,d1.VERBOSE,...e),this._logHandler(this,d1.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,d1.INFO,...e),this._logHandler(this,d1.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,d1.WARN,...e),this._logHandler(this,d1.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,d1.ERROR,...e),this._logHandler(this,d1.ERROR,...e)}}let gY,mY;const _Y=new WeakMap,OI=new WeakMap,vY=new WeakMap,AI=new WeakMap,NI=new WeakMap;let II={get(n,e,t){if(n instanceof IDBTransaction){if("done"===e)return OI.get(n);if("objectStoreNames"===e)return n.objectStoreNames||vY.get(n);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return i6(n[e])},set:(n,e,t)=>(n[e]=t,!0),has:(n,e)=>n instanceof IDBTransaction&&("done"===e||"store"===e)||e in n};function zge(n){return"function"==typeof n?function Dge(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function xge(){return mY||(mY=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...e){return n.apply(xI(this),e),i6(_Y.get(this))}:function(...e){return i6(n.apply(xI(this),e))}:function(e,...t){const r=n.call(xI(this),e,...t);return vY.set(r,e.sort?e.sort():[e]),i6(r)}}(n):(n instanceof IDBTransaction&&function Lge(n){if(OI.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});OI.set(n,e)}(n),((n,e)=>e.some(t=>n instanceof t))(n,function Ige(){return gY||(gY=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,II):n)}function i6(n){if(n instanceof IDBRequest)return function kge(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(i6(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&_Y.set(t,n)}).catch(()=>{}),NI.set(e,n),e}(n);if(AI.has(n))return AI.get(n);const e=zge(n);return e!==n&&(AI.set(n,e),NI.set(e,n)),e}const xI=n=>NI.get(n);function MM(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),c=i6(o);return r&&o.addEventListener("upgradeneeded",u=>{r(i6(o.result),u.oldVersion,u.newVersion,i6(o.transaction))}),t&&o.addEventListener("blocked",()=>t()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function kI(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",()=>e()),i6(t).then(()=>{})}const Hge=["get","getKey","getAll","getAllKeys","count"],Vge=["put","add","delete","clear"],LI=new Map;function CY(n,e){if(!(n instanceof IDBDatabase)||e in n||"string"!=typeof e)return;if(LI.get(e))return LI.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Vge.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!Hge.includes(t))return;const i=function(){var o=I(function*(c,...u){const h=this.transaction(c,s?"readwrite":"readonly");let g=h.store;return r&&(g=g.index(u.shift())),(yield Promise.all([g[t](...u),s&&h.done]))[0]});return function(u){return o.apply(this,arguments)}}();return LI.set(e,i),i}!function Rge(n){II=n(II)}(n=>({...n,get:(e,t,r)=>CY(e,t)||n.get(e,t,r),has:(e,t)=>!!CY(e,t)||n.has(e,t)}));class Fge{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function Bge(n){return"VERSION"===n.getComponent()?.type}(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}return null}).filter(t=>t).join(" ")}}const RI="@firebase/app",h5=new dh("@firebase/app"),SM="[DEFAULT]",dme={[RI]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},d5=new Map,PM=new Map;function pme(n,e){try{n.container.addComponent(e)}catch(t){h5.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Io(n){const e=n.name;if(PM.has(e))return h5.debug(`There were multiple attempts to register component ${e}.`),!1;PM.set(e,n);for(const t of d5.values())pme(t,n);return!0}function ph(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}const o6=new z4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class mme{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new K2("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw o6.create("app-deleted",{appName:this._name})}}const gh="9.14.0";function EY(n,e={}){let t=n;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:SM,automaticDataCollectionEnabled:!1},e),s=r.name;if("string"!=typeof s||!s)throw o6.create("bad-app-name",{appName:String(s)});if(t||(t=(()=>{var n;return null===(n=SI())||void 0===n?void 0:n.config})()),!t)throw o6.create("no-options");const i=d5.get(s);if(i){if(EM(t,i.options)&&EM(r,i.config))return i;throw o6.create("duplicate-app",{appName:s})}const o=new wge(s);for(const u of PM.values())o.addComponent(u);const c=new mme(t,r,o);return d5.set(s,c),c}function DI(n=SM){const e=d5.get(n);if(!e&&n===SM)return EY();if(!e)throw o6.create("no-app",{appName:n});return e}function MY(){return Array.from(d5.values())}function is(n,e,t){var r;let s=null!==(r=dme[n])&&void 0!==r?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${e}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void h5.warn(c.join(" "))}Io(new K2(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}const Ug="firebase-heartbeat-store";let HI=null;function SY(){return HI||(HI=MM("firebase-heartbeat-database",1,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Ug)}}).catch(n=>{throw o6.create("idb-open",{originalErrorMessage:n.message})})),HI}function VI(){return(VI=I(function*(n){var e;try{return(yield SY()).transaction(Ug).objectStore(Ug).get(TY(n))}catch(t){if(t instanceof Oc)h5.warn(t.message);else{const r=o6.create("idb-get",{originalErrorMessage:null===(e=t)||void 0===e?void 0:e.message});h5.warn(r.message)}}})).apply(this,arguments)}function PY(n,e){return FI.apply(this,arguments)}function FI(){return(FI=I(function*(n,e){var t;try{const s=(yield SY()).transaction(Ug,"readwrite");return yield s.objectStore(Ug).put(e,TY(n)),s.done}catch(r){if(r instanceof Oc)h5.warn(r.message);else{const s=o6.create("idb-set",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message});h5.warn(s.message)}}})).apply(this,arguments)}function TY(n){return`${n.name}!${n.options.appId}`}class Mme{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Pme(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var e=this;return I(function*(){const r=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=wY();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==s&&!e._heartbeatsCache.heartbeats.some(i=>i.date===s))return e._heartbeatsCache.heartbeats.push({date:s,agent:r}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return I(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=wY(),{heartbeatsToSend:r,unsentEntries:s}=function Sme(n,e=1024){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),bY(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),bY(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}(e._heartbeatsCache.heartbeats),i=_M(JSON.stringify({version:2,heartbeats:r}));return e._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(e._heartbeatsCache.heartbeats=s,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),i})()}}function wY(){return(new Date).toISOString().substring(0,10)}class Pme{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return I(function*(){return!!u5()&&Fg().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return I(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function Cme(n){return VI.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return I(function*(){var r;if(yield t._canUseIndexedDBPromise){const i=yield t.read();return PY(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return I(function*(){var r;if(yield t._canUseIndexedDBPromise){const i=yield t.read();return PY(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}})()}}function bY(n){return _M(JSON.stringify({version:2,heartbeats:n})).length}!function Tme(n){Io(new K2("platform-logger",e=>new Fge(e),"PRIVATE")),Io(new K2("heartbeat",e=>new Mme(e),"PRIVATE")),is(RI,"0.8.4",n),is(RI,"0.8.4","esm2017"),is("fire-js","")}("");var It,wme=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a6={},BI=BI||{},Mn=wme||self;function TM(){}function wM(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function qg(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var $I="closure_uid_"+(1e9*Math.random()>>>0),Ome=0;function Ame(n,e,t){return n.call.apply(n.bind,arguments)}function Nme(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(e,s)}}return function(){return n.apply(e,arguments)}}function X2(n,e,t){return(X2=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ame:Nme).apply(null,arguments)}function bM(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function S2(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return e.prototype[s].apply(r,o)}}function t8(){this.s=this.s,this.o=this.o}t8.prototype.s=!1,t8.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function bme(n){Object.prototype.hasOwnProperty.call(n,$I)&&n[$I]||(n[$I]=++Ome)}(this)},t8.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const OY=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function GI(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function AY(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(wM(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function Q2(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Q2.prototype.h=function(){this.defaultPrevented=!0};var xme=function(){if(!Mn.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Mn.addEventListener("test",TM,e),Mn.removeEventListener("test",TM,e)}catch{}return n}();function OM(n){return/^[\s\xa0]*$/.test(n)}var NY=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function UI(n,e){return n<e?-1:n>e?1:0}function AM(){var n=Mn.navigator;return n&&(n=n.userAgent)?n:""}function H4(n){return-1!=AM().indexOf(n)}function qI(n){return qI[" "](n),n}qI[" "]=TM;var NM,n,Lme=H4("Opera"),mh=H4("Trident")||H4("MSIE"),IY=H4("Edge"),WI=IY||mh,xY=H4("Gecko")&&!(-1!=AM().toLowerCase().indexOf("webkit")&&!H4("Edge"))&&!(H4("Trident")||H4("MSIE"))&&!H4("Edge"),Rme=-1!=AM().toLowerCase().indexOf("webkit")&&!H4("Edge");function kY(){var n=Mn.document;return n?n.documentMode:void 0}e:{var jI="",ZI=(n=AM(),xY?/rv:([^\);]+)(\)|;)/.exec(n):IY?/Edge\/([\d\.]+)/.exec(n):mh?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Rme?/WebKit\/(\S+)/.exec(n):Lme?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(ZI&&(jI=ZI?ZI[1]:""),mh){var YI=kY();if(null!=YI&&YI>parseFloat(jI)){NM=String(YI);break e}}NM=jI}var Dme={};var Hme=Mn.document&&mh&&(kY()||parseInt(NM,10))||void 0;function Wg(n,e){if(Q2.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(xY){e:{try{qI(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Vme[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Wg.X.h.call(this)}}S2(Wg,Q2);var Vme={2:"touch",3:"pen",4:"mouse"};Wg.prototype.h=function(){Wg.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var jg="closure_listenable_"+(1e6*Math.random()|0),Fme=0;function Bme(n,e,t,r,s){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=s,this.key=++Fme,this.ba=this.ea=!1}function IM(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function XI(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function RY(n){const e={};for(const t in n)e[t]=n[t];return e}const DY="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zY(n,e){let t,r;for(let s=1;s<arguments.length;s++){for(t in r=arguments[s],r)n[t]=r[t];for(let i=0;i<DY.length;i++)t=DY[i],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function xM(n){this.src=n,this.g={},this.h=0}function QI(n,e){var t=e.type;if(t in n.g){var i,r=n.g[t],s=OY(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(IM(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function JI(n,e,t,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==e&&i.capture==!!t&&i.ha==r)return s}return-1}xM.prototype.add=function(n,e,t,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=JI(n,e,r,s);return-1<o?(e=n[o],t||(e.ea=!1)):((e=new Bme(e,this.src,i,!!r,s)).ea=t,n.push(e)),e};var ex="closure_lm_"+(1e6*Math.random()|0),tx={};function HY(n,e,t,r,s){if(r&&r.once)return FY(n,e,t,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)HY(n,e[i],t,r,s);return null}return t=ix(t),n&&n[jg]?n.N(e,t,qg(r)?!!r.capture:!!r,s):VY(n,e,t,!1,r,s)}function VY(n,e,t,r,s,i){if(!e)throw Error("Invalid event type");var o=qg(s)?!!s.capture:!!s,c=rx(n);if(c||(n[ex]=c=new xM(n)),(t=c.add(e,t,r,o,i)).proxy)return t;if(r=function $me(){const e=Gme;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)xme||(s=o),void 0===s&&(s=!1),n.addEventListener(e.toString(),r,s);else if(n.attachEvent)n.attachEvent($Y(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function FY(n,e,t,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)FY(n,e[i],t,r,s);return null}return t=ix(t),n&&n[jg]?n.O(e,t,qg(r)?!!r.capture:!!r,s):VY(n,e,t,!0,r,s)}function BY(n,e,t,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)BY(n,e[i],t,r,s);else r=qg(r)?!!r.capture:!!r,t=ix(t),n&&n[jg]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=JI(i=n.g[e],t,r,s))&&(IM(i[t]),Array.prototype.splice.call(i,t,1),0==i.length&&(delete n.g[e],n.h--))):n&&(n=rx(n))&&(e=n.g[e.toString()],n=-1,e&&(n=JI(e,t,r,s)),(t=-1<n?e[n]:null)&&nx(t))}function nx(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[jg])QI(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent($Y(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=rx(e))?(QI(t,n),0==t.h&&(t.src=null,e[ex]=null)):IM(n)}}}function $Y(n){return n in tx?tx[n]:tx[n]="on"+n}function Gme(n,e){if(n.ba)n=!0;else{e=new Wg(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&nx(n),n=t.call(r,e)}return n}function rx(n){return(n=n[ex])instanceof xM?n:null}var sx="__closure_events_fn_"+(1e9*Math.random()>>>0);function ix(n){return"function"==typeof n?n:(n[sx]||(n[sx]=function(e){return n.handleEvent(e)}),n[sx])}function zi(){t8.call(this),this.i=new xM(this),this.P=this,this.I=null}function P2(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new Q2(e,n);else if(e instanceof Q2)e.target=e.target||n;else{var s=e;zY(e=new Q2(r,n),s)}if(s=!0,t)for(var i=t.length-1;0<=i;i--){var o=e.g=t[i];s=kM(o,r,!0,e)&&s}if(s=kM(o=e.g=n,r,!0,e)&&s,s=kM(o,r,!1,e)&&s,t)for(i=0;i<t.length;i++)s=kM(o=e.g=t[i],r,!1,e)&&s}function kM(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ba&&o.capture==t){var c=o.listener,u=o.ha||o.src;o.ea&&QI(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}S2(zi,t8),zi.prototype[jg]=!0,zi.prototype.removeEventListener=function(n,e,t,r){BY(this,n,e,t,r)},zi.prototype.M=function(){if(zi.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)IM(t[r]);delete n.g[e],n.h--}}this.I=null},zi.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},zi.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var ox=Mn.JSON.stringify;function Ume(){var n=qY;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var ax,GY=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Wme,n=>n.reset());class Wme{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function jme(n){Mn.setTimeout(()=>{throw n},0)}function UY(n,e){ax||function Zme(){var n=Mn.Promise.resolve(void 0);ax=function(){n.then(Yme)}}(),cx||(ax(),cx=!0),qY.add(n,e)}var cx=!1,qY=new class qme{constructor(){this.h=this.g=null}add(e,t){const r=GY.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function Yme(){for(var n;n=Ume();){try{n.h.call(n.g)}catch(t){jme(t)}var e=GY;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}cx=!1}function LM(n,e){zi.call(this),this.h=n||1,this.g=e||Mn,this.j=X2(this.lb,this),this.l=Date.now()}function lx(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function ux(n,e,t){if("function"==typeof n)t&&(n=X2(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=X2(n.handleEvent,n)}return 2147483647<Number(e)?-1:Mn.setTimeout(n,e||0)}function WY(n){n.g=ux(()=>{n.g=null,n.i&&(n.i=!1,WY(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}S2(LM,zi),(It=LM.prototype).ca=!1,It.R=null,It.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),P2(this,"tick"),this.ca&&(lx(this),this.start()))}},It.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},It.M=function(){LM.X.M.call(this),lx(this),delete this.g};class Kme extends t8{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:WY(this)}M(){super.M(),this.g&&(Mn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zg(n){t8.call(this),this.h=n,this.g={}}S2(Zg,t8);var jY=[];function ZY(n,e,t,r){Array.isArray(t)||(t&&(jY[0]=t.toString()),t=jY);for(var s=0;s<t.length;s++){var i=HY(e,t[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function YY(n){XI(n.g,function(e,t){this.g.hasOwnProperty(t)&&nx(e)},n),n.g={}}function RM(){this.g=!0}function _h(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function e_e(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return ox(t)}catch{return e}}(n,t)+(r?" "+r:"")})}Zg.prototype.M=function(){Zg.X.M.call(this),YY(this)},Zg.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},RM.prototype.Aa=function(){this.g=!1},RM.prototype.info=function(){};var p5={},KY=null;function DM(){return KY=KY||new zi}function XY(n){Q2.call(this,p5.Pa,n)}function Yg(n){const e=DM();P2(e,new XY(e))}function QY(n,e){Q2.call(this,p5.STAT_EVENT,n),this.stat=e}function xo(n){const e=DM();P2(e,new QY(e,n))}function JY(n,e){Q2.call(this,p5.Qa,n),this.size=e}function Kg(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Mn.setTimeout(function(){n()},e)}p5.Pa="serverreachability",S2(XY,Q2),p5.STAT_EVENT="statevent",S2(QY,Q2),p5.Qa="timingevent",S2(JY,Q2);var zM={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},eK={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function fx(){}function nK(){}fx.prototype.h=null;var px,Xg={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function hx(){Q2.call(this,"d")}function dx(){Q2.call(this,"c")}function HM(){}function Qg(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new Zg(this),this.O=t_e,this.T=new LM(n=WI?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new rK}function rK(){this.i=null,this.g="",this.h=!1}S2(hx,Q2),S2(dx,Q2),S2(HM,fx),HM.prototype.g=function(){return new XMLHttpRequest},HM.prototype.i=function(){return{}},px=new HM;var t_e=45e3,gx={},VM={};function mx(n,e,t){n.K=1,n.v=GM(c6(e)),n.s=t,n.P=!0,sK(n,null)}function sK(n,e){n.F=Date.now(),Jg(n),n.A=c6(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),pK(t.i,"t",r),n.C=0,t=n.l.H,n.h=new rK,n.g=HK(n.l,t?e:null,!n.s),0<n.N&&(n.L=new Kme(X2(n.La,n,n.g),n.N)),ZY(n.S,n.g,"readystatechange",n.ib),e=n.H?RY(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Yg(),function Xme(n,e,t,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var h=c[u].split("=");if(1<h.length){var g=h[0];h=h[1];var m=g.split("_");o=2<=m.length&&"type"==m[1]?o+(g+"=")+h+"&":o+(g+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function iK(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function oK(n,e,t){let s,r=!0;for(;!n.I&&n.C<t.length;){if(s=n_e(n,t),s==VM){4==e&&(n.o=4,xo(14),r=!1),_h(n.j,n.m,null,"[Incomplete Response]");break}if(s==gx){n.o=4,xo(15),_h(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}_h(n.j,n.m,s,null),_x(n,s)}iK(n)&&s!=VM&&s!=gx&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,xo(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),Tx(e),e.K=!0,xo(11))):(_h(n.j,n.m,t,"[Invalid Chunked Response]"),g5(n),em(n))}function n_e(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?VM:(t=Number(e.substring(t,r)),isNaN(t)?gx:(r+=1)+t>e.length?VM:(e=e.substr(r,t),n.C=r+t,e))}function Jg(n){n.V=Date.now()+n.O,aK(n,n.O)}function aK(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Kg(X2(n.gb,n),e)}function FM(n){n.B&&(Mn.clearTimeout(n.B),n.B=null)}function em(n){0==n.l.G||n.I||LK(n.l,n)}function g5(n){FM(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,lx(n.T),YY(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function _x(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||vx(t.h,n)))if(!n.J&&vx(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;YM(t),jM(t)}Px(t),xo(18)}}else t.Ba=s[1],0<t.Ba-t.T&&37500>s[2]&&t.L&&0==t.A&&!t.v&&(t.v=Kg(X2(t.cb,t),6e3));if(1>=_K(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else _5(t,11)}else if((n.J||t.g==n)&&YM(t),!OM(e))for(s=t.Fa.g.parse(e),e=0;e<s.length;e++){let h=s[e];if(t.T=h[0],h=h[1],2==t.G)if("c"==h[0]){t.I=h[1],t.ka=h[2];const g=h[3];null!=g&&(t.ma=g,t.j.info("VER="+t.ma));const m=h[4];null!=m&&(t.Ca=m,t.j.info("SVER="+t.Ca));const M=h[5];null!=M&&"number"==typeof M&&0<M&&(t.J=r=1.5*M,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const b=n.g;if(b){const L=b.g?b.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(L){var i=r.h;i.g||-1==L.indexOf("spdy")&&-1==L.indexOf("quic")&&-1==L.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(Cx(i,i.h),i.h=null))}if(r.D){const G=b.g?b.g.getResponseHeader("X-HTTP-Session-Id"):null;G&&(r.za=G,Rr(r.F,r.D,G))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var o=n;if((r=t).sa=zK(r,r.H?r.ka:null,r.V),o.J){vK(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(FM(c),Jg(c)),r.g=o}else xK(r);0<t.i.length&&ZM(t)}else"stop"!=h[0]&&"close"!=h[0]||_5(t,7);else 3==t.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?_5(t,7):Sx(t):"noop"!=h[0]&&t.l&&t.l.wa(h),t.A=0)}Yg()}catch{}}function cK(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(wM(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function s_e(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(wM(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function r_e(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(wM(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],t&&t[i],n)}(It=Qg.prototype).setTimeout=function(n){this.O=n},It.ib=function(n){n=n.target;const e=this.L;e&&3==l6(n)?e.l():this.La(n)},It.La=function(n){try{if(n==this.g)e:{const g=l6(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>g)&&(3!=g||WI||this.g&&(this.h.h||this.g.fa()||wK(this.g)))){this.I||4!=g||7==e||Yg(),FM(this);var t=this.g.aa();this.Y=t;t:if(iK(this)){var r=wK(this.g);n="";var s=r.length,i=4==l6(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){g5(this),em(this);var o="";break t}this.h.i=new Mn.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==t,function Qme(n,e,t,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+"\n"+t+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,g,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!OM(c)){var h=c;break t}}h=null}if(!(t=h)){this.i=!1,this.o=3,xo(12),g5(this),em(this);break e}_h(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,_x(this,t)}this.P?(oK(this,g,o),WI&&this.i&&3==g&&(ZY(this.S,this.T,"tick",this.hb),this.T.start())):(_h(this.j,this.m,o,null),_x(this,o)),4==g&&g5(this),this.i&&!this.I&&(4==g?LK(this.l,this):(this.i=!1,Jg(this)))}else 400==t&&0<o.indexOf("Unknown SID")?(this.o=3,xo(12)):(this.o=0,xo(13)),g5(this),em(this)}}}catch{}},It.hb=function(){if(this.g){var n=l6(this.g),e=this.g.fa();this.C<e.length&&(FM(this),oK(this,n,e),this.i&&4!=n&&Jg(this))}},It.cancel=function(){this.I=!0,g5(this)},It.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function Jme(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Yg(),xo(17)),g5(this),this.o=2,em(this)):aK(this,this.V-n)};var lK=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function m5(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof m5){this.h=void 0!==e?e:n.h,BM(this,n.j),this.s=n.s,this.g=n.g,$M(this,n.m),this.l=n.l,e=n.i;var t=new rm;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),uK(this,t),this.o=n.o}else n&&(t=String(n).match(lK))?(this.h=!!e,BM(this,t[1]||"",!0),this.s=tm(t[2]||""),this.g=tm(t[3]||"",!0),$M(this,t[4]),this.l=tm(t[5]||"",!0),uK(this,t[6]||"",!0),this.o=tm(t[7]||"")):(this.h=!!e,this.i=new rm(null,this.h))}function c6(n){return new m5(n)}function BM(n,e,t){n.j=t?tm(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function $M(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function uK(n,e,t){e instanceof rm?(n.i=e,function f_e(n,e){e&&!n.j&&(n8(n),n.i=null,n.g.forEach(function(t,r){var s=r.toLowerCase();r!=s&&(hK(this,r),pK(this,s,t))},n)),n.j=e}(n.i,n.h)):(t||(e=nm(e,l_e)),n.i=new rm(e,n.h))}function Rr(n,e,t){n.i.set(e,t)}function GM(n){return Rr(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function tm(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function nm(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,o_e),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function o_e(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}m5.prototype.toString=function(){var n=[],e=this.j;e&&n.push(nm(e,fK,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(nm(e,fK,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(nm(t,"/"==t.charAt(0)?c_e:a_e,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",nm(t,u_e)),n.join("")};var fK=/[#\/\?@]/g,a_e=/[#\?:]/g,c_e=/[#\?]/g,l_e=/[#\?@]/g,u_e=/#/g;function rm(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function n8(n){n.g||(n.g=new Map,n.h=0,n.i&&function i_e(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),s=null;if(0<=r){var i=n[t].substring(0,r);s=n[t].substring(r+1)}else i=n[t];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function hK(n,e){n8(n),e=vh(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function dK(n,e){return n8(n),e=vh(n,e),n.g.has(e)}function pK(n,e,t){hK(n,e),0<t.length&&(n.i=null,n.g.set(vh(n,e),GI(t)),n.h+=t.length)}function vh(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function gK(n){this.l=n||d_e,n=Mn.PerformanceNavigationTiming?0<(n=Mn.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Mn.g&&Mn.g.Ga&&Mn.g.Ga()&&Mn.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(It=rm.prototype).add=function(n,e){n8(this),this.i=null,n=vh(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},It.forEach=function(n,e){n8(this),this.g.forEach(function(t,r){t.forEach(function(s){n.call(e,s,r,this)},this)},this)},It.oa=function(){n8(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const s=n[r];for(let i=0;i<s.length;i++)t.push(e[r])}return t},It.W=function(n){n8(this);let e=[];if("string"==typeof n)dK(this,n)&&(e=e.concat(this.g.get(vh(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},It.set=function(n,e){return n8(this),this.i=null,dK(this,n=vh(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},It.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},It.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var d_e=10;function mK(n){return!!n.h||!!n.g&&n.g.size>=n.j}function _K(n){return n.h?1:n.g?n.g.size:0}function vx(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function Cx(n,e){n.g?n.g.add(e):n.h=e}function vK(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function CK(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return GI(n.i)}function yx(){}function p_e(){this.g=new yx}function g_e(n,e,t){const r=t||"";try{cK(n,function(s,i){let o=s;qg(s)&&(o=ox(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function UM(n,e,t,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function sm(n){this.l=n.ac||null,this.j=n.jb||!1}function qM(n,e){zi.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=Ex,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}gK.prototype.cancel=function(){if(this.i=CK(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},yx.prototype.stringify=function(n){return Mn.JSON.stringify(n,void 0)},yx.prototype.parse=function(n){return Mn.JSON.parse(n,void 0)},S2(sm,fx),sm.prototype.g=function(){return new qM(this.l,this.j)},sm.prototype.i=function(n){return function(){return n}}({}),S2(qM,zi);var Ex=0;function yK(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function im(n){n.readyState=4,n.l=null,n.j=null,n.A=null,om(n)}function om(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(It=qM.prototype).open=function(n,e){if(this.readyState!=Ex)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,om(this)},It.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||Mn).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},It.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,im(this)),this.readyState=Ex},It.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,om(this)),this.g&&(this.readyState=3,om(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof Mn.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;yK(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},It.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?im(this):om(this),3==this.readyState&&yK(this)}},It.Va=function(n){this.g&&(this.response=this.responseText=n,im(this))},It.Ua=function(n){this.g&&(this.response=n,im(this))},It.ga=function(){this.g&&im(this)},It.setRequestHeader=function(n,e){this.v.append(n,e)},It.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},It.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(qM.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var __e=Mn.JSON.parse;function os(n){zi.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=EK,this.K=this.L=!1}S2(os,zi);var EK="",v_e=/^https?$/i,C_e=["POST","PUT"];function MK(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,SK(n),WM(n)}function SK(n){n.D||(n.D=!0,P2(n,"complete"),P2(n,"error"))}function PK(n){if(n.h&&typeof BI<"u"&&(!n.C[1]||4!=l6(n)||2!=n.aa()))if(n.v&&4==l6(n))ux(n.Ha,0,n);else if(P2(n,"readystatechange"),4==l6(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===c){var s=String(n.H).match(lK)[1]||null;if(!s&&Mn.self&&Mn.self.location){var i=Mn.self.location.protocol;s=i.substr(0,i.length-1)}r=!v_e.test(s?s.toLowerCase():"")}t=r}if(t)P2(n,"complete"),P2(n,"success");else{n.m=6;try{var o=2<l6(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",SK(n)}}finally{WM(n)}}}function WM(n,e){if(n.g){TK(n);const t=n.g,r=n.C[0]?TM:null;n.g=null,n.C=null,e||P2(n,"ready");try{t.onreadystatechange=r}catch{}}}function TK(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Mn.clearTimeout(n.A),n.A=null)}function l6(n){return n.g?n.g.readyState:0}function wK(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case EK:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function bK(n){let e="";return XI(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function Mx(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=bK(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Rr(n,e,t))}function am(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function OK(n){this.Ca=0,this.i=[],this.j=new RM,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=am("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=am("baseRetryDelayMs",5e3,n),this.bb=am("retryDelaySeedMs",1e4,n),this.$a=am("forwardChannelMaxRetries",2,n),this.ta=am("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new gK(n&&n.concurrentRequestLimit),this.Fa=new p_e,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Sx(n){if(AK(n),3==n.G){var e=n.U++,t=c6(n.F);Rr(t,"SID",n.I),Rr(t,"RID",e),Rr(t,"TYPE","terminate"),cm(n,t),(e=new Qg(n,n.j,e,void 0)).K=2,e.v=GM(c6(t)),t=!1,Mn.navigator&&Mn.navigator.sendBeacon&&(t=Mn.navigator.sendBeacon(e.v.toString(),"")),!t&&Mn.Image&&((new Image).src=e.v,t=!0),t||(e.g=HK(e.l,null),e.g.da(e.v)),e.F=Date.now(),Jg(e)}DK(n)}function jM(n){n.g&&(Tx(n),n.g.cancel(),n.g=null)}function AK(n){jM(n),n.u&&(Mn.clearTimeout(n.u),n.u=null),YM(n),n.h.cancel(),n.m&&("number"==typeof n.m&&Mn.clearTimeout(n.m),n.m=null)}function ZM(n){mK(n.h)||n.m||(n.m=!0,UY(n.Ja,n),n.C=0)}function NK(n,e){var t;t=e?e.m:n.U++;const r=c6(n.F);Rr(r,"SID",n.I),Rr(r,"RID",t),Rr(r,"AID",n.T),cm(n,r),n.o&&n.s&&Mx(r,n.o,n.s),t=new Qg(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=IK(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),Cx(n.h,t),mx(t,r,e)}function cm(n,e){n.ia&&XI(n.ia,function(t,r){Rr(e,r,t)}),n.l&&cK({},function(t,r){Rr(e,r,t)})}function IK(n,e,t){t=Math.min(n.i.length,t);var r=n.l?X2(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+t];-1==i?0<t?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<t;u++){let h=s[u].h;const g=s[u].g;if(h-=i,0>h)i=Math.max(0,s[u].h-100),c=!1;else try{g_e(g,o,"req"+h+"_")}catch{r&&r(g)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function xK(n){n.g||n.u||(n.Z=1,UY(n.Ia,n),n.A=0)}function Px(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Kg(X2(n.Ia,n),RK(n,n.A)),n.A++,0))}function Tx(n){null!=n.B&&(Mn.clearTimeout(n.B),n.B=null)}function kK(n){n.g=new Qg(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=c6(n.sa);Rr(e,"RID","rpc"),Rr(e,"SID",n.I),Rr(e,"CI",n.L?"0":"1"),Rr(e,"AID",n.T),Rr(e,"TYPE","xmlhttp"),cm(n,e),n.o&&n.s&&Mx(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=GM(c6(e)),t.s=null,t.P=!0,sK(t,n)}function YM(n){null!=n.v&&(Mn.clearTimeout(n.v),n.v=null)}function LK(n,e){var t=null;if(n.g==e){YM(n),Tx(n),n.g=null;var r=2}else{if(!vx(n.h,e))return;t=e.D,vK(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var s=n.C;P2(r=DM(),new JY(r,t)),ZM(n)}else xK(n);else if(3==(s=e.o)||0==s&&0<n.pa||!(1==r&&function E_e(n,e){return!(_K(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Kg(X2(n.Ja,n,e),RK(n,n.C)),n.C++,0)))}(n,e)||2==r&&Px(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),s){case 1:_5(n,5);break;case 4:_5(n,10);break;case 3:_5(n,6);break;default:_5(n,2)}}function RK(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function _5(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=X2(n.kb,n);t||(t=new m5("//www.google.com/images/cleardot.gif"),Mn.location&&"http"==Mn.location.protocol||BM(t,"https"),GM(t)),function m_e(n,e){const t=new RM;if(Mn.Image){const r=new Image;r.onload=bM(UM,t,r,"TestLoadImage: loaded",!0,e),r.onerror=bM(UM,t,r,"TestLoadImage: error",!1,e),r.onabort=bM(UM,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=bM(UM,t,r,"TestLoadImage: timeout",!1,e),Mn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else xo(2);n.G=0,n.l&&n.l.va(e),DK(n),AK(n)}function DK(n){if(n.G=0,n.la=[],n.l){const e=CK(n.h);(0!=e.length||0!=n.i.length)&&(AY(n.la,e),AY(n.la,n.i),n.h.i.length=0,GI(n.i),n.i.length=0),n.l.ua()}}function zK(n,e,t){var r=t instanceof m5?c6(t):new m5(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),$M(r,r.m);else{var s=Mn.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new m5(null,void 0);r&&BM(i,r),e&&(i.g=e),s&&$M(i,s),t&&(i.l=t),r=i}return e=n.za,(t=n.D)&&e&&Rr(r,t,e),Rr(r,"VER",n.ma),cm(n,r),r}function HK(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new os(t&&n.Da&&!n.ra?new sm({jb:!0}):n.ra)).Ka(n.H),e}function VK(){}function KM(){if(mh&&!(10<=Number(Hme)))throw Error("Environmental error: no available transport.")}function qa(n,e){zi.call(this),this.g=new OK(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!OM(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!OM(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Ch(this)}function FK(n){hx.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function BK(){dx.call(this),this.status=1}function Ch(n){this.g=n}(It=os.prototype).Ka=function(n){this.L=n},It.da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():px.g(),this.C=function tK(n){return n.h||(n.h=n.i())}(this.u?this.u:px),this.g.onreadystatechange=X2(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(i){return void MK(this,i)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)t.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())t.set(i,r.get(i))}r=Array.from(t.keys()).find(i=>"content-type"==i.toLowerCase()),s=Mn.FormData&&n instanceof Mn.FormData,!(0<=OY(C_e,e))||r||s||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of t)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{TK(this),0<this.B&&((this.K=function y_e(n){return mh&&function zme(){return function kme(n){var e=Dme;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=NY(String(NM)).split("."),t=NY("9").split("."),r=Math.max(e.length,t.length);for(let o=0;0==n&&o<r;o++){var s=e[o]||"",i=t[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=UI(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||UI(0==s[2].length,0==i[2].length)||UI(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=X2(this.qa,this)):this.A=ux(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){MK(this,i)}},It.qa=function(){typeof BI<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,P2(this,"timeout"),this.abort(8))},It.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,P2(this,"complete"),P2(this,"abort"),WM(this))},It.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),WM(this,!0)),os.X.M.call(this)},It.Ha=function(){this.s||(this.F||this.v||this.l?PK(this):this.fb())},It.fb=function(){PK(this)},It.aa=function(){try{return 2<l6(this)?this.g.status:-1}catch{return-1}},It.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},It.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),__e(e)}},It.Ea=function(){return this.m},It.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(It=OK.prototype).ma=8,It.G=1,It.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new Qg(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=RY(i),zY(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=IK(this,s,e),Rr(t=c6(this.F),"RID",n),Rr(t,"CVER",22),this.D&&Rr(t,"X-HTTP-Session-Id",this.D),cm(this,t),i&&(this.N?e="headers="+encodeURIComponent(String(bK(i)))+"&"+e:this.o&&Mx(t,this.o,i)),Cx(this.h,s),this.Ya&&Rr(t,"TYPE","init"),this.O?(Rr(t,"$req",e),Rr(t,"SID","null"),s.Z=!0,mx(s,t,null)):mx(s,t,e),this.G=2}}else 3==this.G&&(n?NK(this,n):0==this.i.length||mK(this.h)||NK(this))},It.Ia=function(){if(this.u=null,kK(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Kg(X2(this.eb,this),n)}},It.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,xo(10),jM(this),kK(this))},It.cb=function(){null!=this.v&&(this.v=null,jM(this),Px(this),xo(19))},It.kb=function(n){n?(this.j.info("Successfully pinged google.com"),xo(2)):(this.j.info("Failed to ping google.com"),xo(1))},(It=VK.prototype).xa=function(){},It.wa=function(){},It.va=function(){},It.ua=function(){},It.Ra=function(){},KM.prototype.g=function(n,e){return new qa(n,e)},S2(qa,zi),qa.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;xo(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=zK(n,null,n.V),ZM(n)},qa.prototype.close=function(){Sx(this.g)},qa.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=ox(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&ZM(e)},qa.prototype.M=function(){this.g.l=null,delete this.j,Sx(this.g),delete this.g,qa.X.M.call(this)},S2(FK,hx),S2(BK,dx),S2(Ch,VK),Ch.prototype.xa=function(){P2(this.g,"a")},Ch.prototype.wa=function(n){P2(this.g,new FK(n))},Ch.prototype.va=function(n){P2(this.g,new BK)},Ch.prototype.ua=function(){P2(this.g,"b")},KM.prototype.createWebChannel=KM.prototype.g,qa.prototype.send=qa.prototype.u,qa.prototype.open=qa.prototype.m,qa.prototype.close=qa.prototype.close,zM.NO_ERROR=0,zM.TIMEOUT=8,zM.HTTP_ERROR=6,eK.COMPLETE="complete",nK.EventType=Xg,Xg.OPEN="a",Xg.CLOSE="b",Xg.ERROR="c",Xg.MESSAGE="d",zi.prototype.listen=zi.prototype.N,os.prototype.listenOnce=os.prototype.O,os.prototype.getLastError=os.prototype.Oa,os.prototype.getLastErrorCode=os.prototype.Ea,os.prototype.getStatus=os.prototype.aa,os.prototype.getResponseJson=os.prototype.Sa,os.prototype.getResponseText=os.prototype.fa,os.prototype.send=os.prototype.da,os.prototype.setWithCredentials=os.prototype.Ka;var M_e=a6.createWebChannelTransport=function(){return new KM},S_e=a6.getStatEventTarget=function(){return DM()},wx=a6.ErrorCode=zM,P_e=a6.EventType=eK,T_e=a6.Event=p5,$K=a6.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},w_e=a6.FetchXmlHttpFactory=sm,XM=a6.WebChannel=nK,b_e=a6.XhrIo=os;const GK="@firebase/firestore";class Hi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Hi.UNAUTHENTICATED=new Hi(null),Hi.GOOGLE_CREDENTIALS=new Hi("google-credentials-uid"),Hi.FIRST_PARTY=new Hi("first-party-uid"),Hi.MOCK_USER=new Hi("mock-user");let yh="9.14.0";const r8=new dh("@firebase/firestore");function bx(){return r8.logLevel}function Ue(n,...e){if(r8.logLevel<=d1.DEBUG){const t=e.map(Ox);r8.debug(`Firestore (${yh}): ${n}`,...t)}}function Ms(n,...e){if(r8.logLevel<=d1.ERROR){const t=e.map(Ox);r8.error(`Firestore (${yh}): ${n}`,...t)}}function Eh(n,...e){if(r8.logLevel<=d1.WARN){const t=e.map(Ox);r8.warn(`Firestore (${yh}): ${n}`,...t)}}function Ox(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function bt(n="Unexpected state"){const e=`FIRESTORE (${yh}) INTERNAL ASSERTION FAILED: `+n;throw Ms(e),new Error(e)}function an(n,e){n||bt()}function ht(n,e){return n}const we={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Be extends Oc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ci{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class UK{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class O_e{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Hi.UNAUTHENTICATED))}shutdown(){}}class A_e{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class N_e{constructor(e){this.t=e,this.currentUser=Hi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,t(h)):Promise.resolve();let o=new ci;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ci,e.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;e.enqueueRetryable(I(function*(){yield h.promise,yield i(r.currentUser)}))},u=h=>{Ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(Ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ci)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(an("string"==typeof r.accessToken),new UK(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return an(null===e||"string"==typeof e),new Hi(e)}}class I_e{constructor(e,t,r,s){this.h=e,this.l=t,this.m=r,this.g=s,this.type="FirstParty",this.user=Hi.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(an(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class x_e{constructor(e,t,r,s){this.h=e,this.l=t,this.m=r,this.g=s}getToken(){return Promise.resolve(new I_e(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(Hi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class qK{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class k_e{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=i=>{null!=i.error&&Ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,Ue("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):Ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(an("string"==typeof t.token),this.A=t.token,new qK(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function L_e(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class WK{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=L_e(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function Sn(n,e){return n<e?-1:n>e?1:0}function Mh(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}class Zr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Be(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Be(we.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Be(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Be(we.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Zr.fromMillis(Date.now())}static fromDate(e){return Zr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Zr(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Sn(this.nanoseconds,e.nanoseconds):Sn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class cn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new cn(e)}static min(){return new cn(new Zr(0,0))}static max(){return new cn(new Zr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class lm{constructor(e,t,r){void 0===t?t=0:t>e.length&&bt(),void 0===r?r=e.length-t:r>e.length-t&&bt(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===lm.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof lm?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class p1 extends lm{construct(e,t,r){return new p1(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Be(we.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new p1(t)}static emptyPath(){return new p1([])}}const R_e=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ss extends lm{construct(e,t,r){return new Ss(e,t,r)}static isValidIdentifier(e){return R_e.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ss.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ss(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(0===r.length)throw new Be(we.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if("\\"===c){if(s+1===e.length)throw new Be(we.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Be(we.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Be(we.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ss(t)}static emptyPath(){return new Ss([])}}class lt{constructor(e){this.path=e}static fromPath(e){return new lt(p1.fromString(e))}static fromName(e){return new lt(p1.fromString(e).popFirst(5))}static empty(){return new lt(p1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===p1.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return p1.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new lt(new p1(e.slice()))}}function YK(n){return new Wa(n.readTime,n.key,-1)}class Wa{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Wa(cn.min(),lt.empty(),-1)}static max(){return new Wa(cn.max(),lt.empty(),-1)}}function Nx(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=lt.comparator(n.documentKey,e.documentKey),0!==t?t:Sn(n.largestBatchId,e.largestBatchId))}const KK="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function s8(n){return Ix.apply(this,arguments)}function Ix(){return Ix=I(function*(n){if(n.code!==we.FAILED_PRECONDITION||n.message!==KK)throw n;Ue("LocalStore","Unexpectedly lost primary lease")}),Ix.apply(this,arguments)}class Me{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&bt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Me((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Me?t:Me.resolve(t)}catch(t){return Me.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Me.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Me.reject(t)}static resolve(e){return new Me((t,r)=>{t(e)})}static reject(e){return new Me((t,r)=>{r(e)})}static waitFor(e){return new Me((t,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&t()},u=>r(u))}),o=!0,i===s&&t()})}static or(e){let t=Me.resolve(!1);for(const r of e)t=t.next(s=>s?Me.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new Me((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;t(e[h]).next(g=>{o[h]=g,++c,c===i&&r(o)},g=>s(g))}})}static doWhile(e,t){return new Me((r,s)=>{const i=()=>{!0===e()?t().next(()=>{i()},s):r()};i()})}}function i8(n){return"IndexedDbTransactionError"===n.name}class fa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>t.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function QK(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function y5(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function JK(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}fa.at=-1;class as{constructor(e,t){this.comparator=e,this.root=t||T2.EMPTY}insert(e,t){return new as(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,T2.BLACK,null,null))}remove(e){return new as(this.comparator,this.root.remove(e,this.comparator).copy(null,null,T2.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(0===s)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new tS(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new tS(this.root,e,this.comparator,!1)}getReverseIterator(){return new tS(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new tS(this.root,e,this.comparator,!0)}}class tS{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class T2{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??T2.RED,this.left=s??T2.EMPTY,this.right=i??T2.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new T2(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):0===i?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return T2.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===t(e,s.key)){if(s.right.isEmpty())return T2.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,T2.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,T2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw bt();const e=this.left.check();if(e!==this.right.check())throw bt();return e+(this.isRed()?0:1)}}T2.EMPTY=null,T2.RED=!0,T2.BLACK=!1,T2.EMPTY=new class{constructor(){this.size=0}get key(){throw bt()}get value(){throw bt()}get color(){throw bt()}get left(){throw bt()}get right(){throw bt()}copy(n,e,t,r,s){return this}insert(n,e,t){return new T2(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class X1{constructor(e){this.comparator=e,this.data=new as(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new eX(this.data.getIterator())}getIteratorFrom(e){return new eX(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof X1)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new X1(this.comparator);return t.data=e,t}}class eX{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ja{constructor(e){this.fields=e,e.sort(Ss.comparator)}static empty(){return new ja([])}unionWith(e){let t=new X1(Ss.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ja(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Mh(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class li{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new li(t)}static fromUint8Array(e){const t=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new li(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Sn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}li.EMPTY_BYTE_STRING=new li("");const G_e=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function o8(n){if(an(!!n),"string"==typeof n){let e=0;const t=G_e.exec(n);if(an(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:cs(n.seconds),nanos:cs(n.nanos)}}function cs(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function E5(n){return"string"==typeof n?li.fromBase64String(n):li.fromUint8Array(n)}function kx(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function tX(n){const e=n.mapValue.fields.__previous_value__;return kx(e)?tX(e):e}function hm(n){const e=o8(n.mapValue.fields.__local_write_time__.timestampValue);return new Zr(e.seconds,e.nanos)}class U_e{constructor(e,t,r,s,i,o,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class M5{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new M5("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof M5&&e.projectId===this.projectId&&e.database===this.database}}function dm(n){return null==n}function pm(n){return 0===n&&1/n==-1/0}const a8_mapValue={fields:{__type__:{stringValue:"__max__"}}};function S5(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?kx(n)?4:oX(n)?9007199254740991:10:bt()}function V4(n,e){if(n===e)return!0;const t=S5(n);if(t!==S5(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return hm(n).isEqual(hm(e));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=o8(r.timestampValue),o=o8(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,E5(n.bytesValue).isEqual(E5(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,s){return cs(r.geoPointValue.latitude)===cs(s.geoPointValue.latitude)&&cs(r.geoPointValue.longitude)===cs(s.geoPointValue.longitude)}(n,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return cs(r.integerValue)===cs(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=cs(r.doubleValue),o=cs(s.doubleValue);return i===o?pm(i)===pm(o):isNaN(i)&&isNaN(o)}return!1}(n,e);case 9:return Mh(n.arrayValue.values||[],e.arrayValue.values||[],V4);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(QK(i)!==QK(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!V4(i[c],o[c])))return!1;return!0}(n,e);default:return bt()}var s}function gm(n,e){return void 0!==(n.values||[]).find(t=>V4(t,e))}function c8(n,e){if(n===e)return 0;const t=S5(n),r=S5(e);if(t!==r)return Sn(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Sn(n.booleanValue,e.booleanValue);case 2:return function(s,i){const o=cs(s.integerValue||s.doubleValue),c=cs(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,e);case 3:return rX(n.timestampValue,e.timestampValue);case 4:return rX(hm(n),hm(e));case 5:return Sn(n.stringValue,e.stringValue);case 6:return function(s,i){const o=E5(s),c=E5(i);return o.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const h=Sn(o[u],c[u]);if(0!==h)return h}return Sn(o.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,i){const o=Sn(cs(s.latitude),cs(i.latitude));return 0!==o?o:Sn(cs(s.longitude),cs(i.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const h=c8(o[u],c[u]);if(h)return h}return Sn(o.length,c.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===a8_mapValue&&i===a8_mapValue)return 0;if(s===a8_mapValue)return 1;if(i===a8_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let g=0;g<c.length&&g<h.length;++g){const m=Sn(c[g],h[g]);if(0!==m)return m;const M=c8(o[c[g]],u[h[g]]);if(0!==M)return M}return Sn(c.length,h.length)}(n.mapValue,e.mapValue);default:throw bt()}}function rX(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Sn(n,e);const t=o8(n),r=o8(e),s=Sn(t.seconds,r.seconds);return 0!==s?s:Sn(t.nanos,r.nanos)}function Ph(n){return Lx(n)}function Lx(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=o8(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?E5(n.bytesValue).toBase64():"referenceValue"in n?lt.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=Lx(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${Lx(r.fields[c])}`;return i+"}"}(n.mapValue):bt();var e}function P5(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Rx(n){return!!n&&"integerValue"in n}function mm(n){return!!n&&"arrayValue"in n}function sX(n){return!!n&&"nullValue"in n}function iX(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function rS(n){return!!n&&"mapValue"in n}function _m(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return y5(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=_m(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_m(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oX(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class w2{constructor(e){this.value=e}static empty(){return new w2({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!rS(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_m(t)}setAll(e){let t=Ss.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!t.isImmediateParentOf(c)){const u=this.getFieldsMap(t);this.applyChanges(u,r,s),r={},s=[],t=c.popLast()}o?r[c.lastSegment()]=_m(o):s.push(c.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());rS(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return V4(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];rS(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){y5(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new w2(_m(this.value))}}function lX(n){const e=[];return y5(n.fields,(t,r)=>{const s=new Ss([t]);if(rS(r)){const i=lX(r.mapValue).fields;if(0===i.length)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new ja(e)}class hr{constructor(e,t,r,s,i,o){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new hr(e,0,cn.min(),cn.min(),w2.empty(),0)}static newFoundDocument(e,t,r){return new hr(e,1,t,cn.min(),r,0)}static newNoDocument(e,t){return new hr(e,2,t,cn.min(),w2.empty(),0)}static newUnknownDocument(e,t){return new hr(e,3,t,cn.min(),w2.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=w2.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=w2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=cn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof hr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new hr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class j_e{constructor(e,t=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function uX(n,e=null,t=[],r=[],s=null,i=null,o=null){return new j_e(n,e,t,r,s,i,o)}function T5(n){const e=ht(n);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+Ph(s.value);var s}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),dm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ph(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ph(r)).join(",")),e.ht=t}return e.ht}function vm(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!nve(n.orderBy[s],e.orderBy[s]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((t=n.filters[s]).op!==(r=e.filters[s]).op||!t.field.isEqual(r.field)||!V4(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gX(n.startAt,e.startAt)&&gX(n.endAt,e.endAt)}function sS(n){return lt.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class b2 extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,r):new Y_e(e,t,r):"array-contains"===t?new Q_e(e,r):"in"===t?new J_e(e,r):"not-in"===t?new eve(e,r):"array-contains-any"===t?new tve(e,r):new b2(e,t,r)}static lt(e,t,r){return"in"===t?new K_e(e,r):new X_e(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(c8(t,this.value)):null!==t&&S5(this.value)===S5(t)&&this.ft(c8(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return bt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Y_e extends b2{constructor(e,t,r){super(e,t,r),this.key=lt.fromName(r.referenceValue)}matches(e){const t=lt.comparator(e.key,this.key);return this.ft(t)}}class K_e extends b2{constructor(e,t){super(e,"in",t),this.keys=dX(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class X_e extends b2{constructor(e,t){super(e,"not-in",t),this.keys=dX(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function dX(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>lt.fromName(r.referenceValue))}class Q_e extends b2{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return mm(t)&&gm(t.arrayValue,this.value)}}class J_e extends b2{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&gm(this.value.arrayValue,t)}}class eve extends b2{constructor(e,t){super(e,"not-in",t)}matches(e){if(gm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!gm(this.value.arrayValue,t)}}class tve extends b2{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!mm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>gm(this.value.arrayValue,r))}}class l8{constructor(e,t){this.position=e,this.inclusive=t}}class Th{constructor(e,t="asc"){this.field=e,this.dir=t}}function nve(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function pX(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(r=i.field.isKeyField()?lt.comparator(lt.fromName(o.referenceValue),t.key):c8(o,t.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function gX(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!V4(n.position[t],e.position[t]))return!1;return!0}class u6{constructor(e,t=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function wh(n){return new u6(n)}function _X(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function Dx(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function zx(n){for(const e of n.filters)if(e.dt())return e.field;return null}function Hx(n){return null!==n.collectionGroup}function bh(n){const e=ht(n);if(null===e._t){e._t=[];const t=zx(e),r=Dx(e);if(null!==t&&null===r)t.isKeyField()||e._t.push(new Th(t)),e._t.push(new Th(Ss.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new Th(Ss.keyField(),i))}}}return e._t}function ko(n){const e=ht(n);if(!e.wt)if("F"===e.limitType)e.wt=uX(e.path,e.collectionGroup,bh(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const i of bh(e))t.push(new Th(i.field,"desc"===i.dir?"asc":"desc"));const r=e.endAt?new l8(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new l8(e.startAt.position,e.startAt.inclusive):null;e.wt=uX(e.path,e.collectionGroup,t,e.filters,e.limit,r,s)}return e.wt}function oS(n,e,t){return new u6(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Cm(n,e){return vm(ko(n),ko(e))&&n.limitType===e.limitType}function vX(n){return`${T5(ko(n))}|lt:${n.limitType}`}function Vx(n){return`Query(target=${function Z_e(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${Ph(r.value)}`;var r}).join(", ")}]`),dm(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>Ph(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>Ph(t)).join(",")),`Target(${e})`}(ko(n))}; limitType=${n.limitType})`}function Fx(n,e){return e.isFoundDocument()&&function(t,r){const s=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(s):lt.isDocumentKey(t.path)?t.path.isEqual(s):t.path.isImmediateParentOf(s)}(n,e)&&function(t,r){for(const s of t.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,e)&&function(t,r){for(const s of t.filters)if(!s.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(s,i,o){const c=pX(s,i,o);return s.inclusive?c<=0:c<0}(t.startAt,bh(t),r)||t.endAt&&!function(s,i,o){const c=pX(s,i,o);return s.inclusive?c>=0:c>0}(t.endAt,bh(t),r)));var t,r}function yX(n){return(e,t)=>{let r=!1;for(const s of bh(n)){const i=rve(s,e,t);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function rve(n,e,t){const r=n.field.isKeyField()?lt.comparator(e.key,t.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?c8(c,u):bt()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return bt()}}function EX(n,e){if(n.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pm(e)?"-0":e}}function MX(n){return{integerValue:""+n}}function SX(n,e){return function nX(n){return"number"==typeof n&&Number.isInteger(n)&&!pm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(e)?MX(e):EX(n,e)}class aS{constructor(){this._=void 0}}function sve(n,e,t){return n instanceof Oh?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(t,e):n instanceof w5?TX(n,e):n instanceof b5?wX(n,e):function(r,s){const i=PX(r,s),o=bX(i)+bX(r.yt);return Rx(i)&&Rx(r.yt)?MX(o):EX(r.It,o)}(n,e)}function ive(n,e,t){return n instanceof w5?TX(n,e):n instanceof b5?wX(n,e):t}function PX(n,e){return n instanceof Ah?Rx(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class Oh extends aS{}class w5 extends aS{constructor(e){super(),this.elements=e}}function TX(n,e){const t=OX(e);for(const r of n.elements)t.some(s=>V4(s,r))||t.push(r);return{arrayValue:{values:t}}}class b5 extends aS{constructor(e){super(),this.elements=e}}function wX(n,e){let t=OX(e);for(const r of n.elements)t=t.filter(s=>!V4(s,r));return{arrayValue:{values:t}}}class Ah extends aS{constructor(e,t){super(),this.It=e,this.yt=t}}function bX(n){return cs(n.integerValue||n.doubleValue)}function OX(n){return mm(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class ym{constructor(e,t){this.field=e,this.transform=t}}class ave{constructor(e,t){this.version=e,this.transformResults=t}}class Dr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Dr}static exists(e){return new Dr(void 0,e)}static updateTime(e){return new Dr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cS(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class lS{}function AX(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Ih(n.key,Dr.none()):new Nh(n.key,n.data,Dr.none());{const t=n.data,r=w2.empty();let s=new X1(Ss.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);null===o&&i.length>1&&(i=i.popLast(),o=t.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new f6(n.key,r,new ja(s.toArray()),Dr.none())}}function cve(n,e,t){n instanceof Nh?function(r,s,i){const o=r.value.clone(),c=xX(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,e,t):n instanceof f6?function(r,s,i){if(!cS(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=xX(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(IX(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Em(n,e,t,r){return n instanceof Nh?function(s,i,o,c){if(!cS(s.precondition,i))return o;const u=s.value.clone(),h=kX(s.fieldTransforms,c,i);return u.setAll(h),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof f6?function(s,i,o,c){if(!cS(s.precondition,i))return o;const u=kX(s.fieldTransforms,c,i),h=i.data;return h.setAll(IX(s)),h.setAll(u),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))}(n,e,t,r):(o=t,cS(n.precondition,i=e)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function lve(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=PX(r.transform,s||null);null!=i&&(null===t&&(t=w2.empty()),t.set(r.field,i))}return t||null}function NX(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Mh(t,r,(s,i)=>function ove(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof w5&&r instanceof w5||t instanceof b5&&r instanceof b5?Mh(t.elements,r.elements,V4):t instanceof Ah&&r instanceof Ah?V4(t.yt,r.yt):t instanceof Oh&&r instanceof Oh);var t,r}(s,i))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class Nh extends lS{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class f6 extends lS{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function IX(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function xX(n,e,t){const r=new Map;an(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,ive(o,c,t[s]))}return r}function kX(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,sve(i,o,e))}return r}class Ih extends lS{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bx extends lS{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class uve{constructor(e){this.count=e}}var $s,g1;function LX(n){switch(n){default:return bt();case we.CANCELLED:case we.UNKNOWN:case we.DEADLINE_EXCEEDED:case we.RESOURCE_EXHAUSTED:case we.INTERNAL:case we.UNAVAILABLE:case we.UNAUTHENTICATED:return!1;case we.INVALID_ARGUMENT:case we.NOT_FOUND:case we.ALREADY_EXISTS:case we.PERMISSION_DENIED:case we.FAILED_PRECONDITION:case we.ABORTED:case we.OUT_OF_RANGE:case we.UNIMPLEMENTED:case we.DATA_LOSS:return!0}}function RX(n){if(void 0===n)return Ms("GRPC error has no .code"),we.UNKNOWN;switch(n){case $s.OK:return we.OK;case $s.CANCELLED:return we.CANCELLED;case $s.UNKNOWN:return we.UNKNOWN;case $s.DEADLINE_EXCEEDED:return we.DEADLINE_EXCEEDED;case $s.RESOURCE_EXHAUSTED:return we.RESOURCE_EXHAUSTED;case $s.INTERNAL:return we.INTERNAL;case $s.UNAVAILABLE:return we.UNAVAILABLE;case $s.UNAUTHENTICATED:return we.UNAUTHENTICATED;case $s.INVALID_ARGUMENT:return we.INVALID_ARGUMENT;case $s.NOT_FOUND:return we.NOT_FOUND;case $s.ALREADY_EXISTS:return we.ALREADY_EXISTS;case $s.PERMISSION_DENIED:return we.PERMISSION_DENIED;case $s.FAILED_PRECONDITION:return we.FAILED_PRECONDITION;case $s.ABORTED:return we.ABORTED;case $s.OUT_OF_RANGE:return we.OUT_OF_RANGE;case $s.UNIMPLEMENTED:return we.UNIMPLEMENTED;case $s.DATA_LOSS:return we.DATA_LOSS;default:return bt()}}(g1=$s||($s={}))[g1.OK=0]="OK",g1[g1.CANCELLED=1]="CANCELLED",g1[g1.UNKNOWN=2]="UNKNOWN",g1[g1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",g1[g1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",g1[g1.NOT_FOUND=5]="NOT_FOUND",g1[g1.ALREADY_EXISTS=6]="ALREADY_EXISTS",g1[g1.PERMISSION_DENIED=7]="PERMISSION_DENIED",g1[g1.UNAUTHENTICATED=16]="UNAUTHENTICATED",g1[g1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",g1[g1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",g1[g1.ABORTED=10]="ABORTED",g1[g1.OUT_OF_RANGE=11]="OUT_OF_RANGE",g1[g1.UNIMPLEMENTED=12]="UNIMPLEMENTED",g1[g1.INTERNAL=13]="INTERNAL",g1[g1.UNAVAILABLE=14]="UNAVAILABLE",g1[g1.DATA_LOSS=15]="DATA_LOSS";class u8{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(void 0===s)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return 1===r.length?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){y5(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return JK(this.inner)}size(){return this.innerSize}}const fve=new as(lt.comparator);function ha(){return fve}const DX=new as(lt.comparator);function Mm(...n){let e=DX;for(const t of n)e=e.insert(t.key,t);return e}function zX(n){let e=DX;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function F4(){return Sm()}function HX(){return Sm()}function Sm(){return new u8(n=>n.toString(),(n,e)=>n.isEqual(e))}const hve=new as(lt.comparator),dve=new X1(lt.comparator);function xn(...n){let e=dve;for(const t of n)e=e.add(t);return e}const pve=new X1(Sn);function uS(){return pve}class Pm{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Tm.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Pm(cn.min(),s,uS(),ha(),xn())}}class Tm{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Tm(r,t,xn(),xn(),xn())}}class fS{constructor(e,t,r,s){this.Tt=e,this.removedTargetIds=t,this.key=r,this.Et=s}}class VX{constructor(e,t){this.targetId=e,this.At=t}}class FX{constructor(e,t,r=li.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class BX{constructor(){this.Rt=0,this.bt=GX(),this.Pt=li.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=xn(),t=xn(),r=xn();return this.bt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:bt()}}),new Tm(this.Pt,this.vt,e,t,r)}Nt(){this.Vt=!1,this.bt=GX()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Ot(e){this.Vt=!0,this.bt=this.bt.remove(e)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class gve{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=ha(),this.qt=$X(),this.Kt=new X1(Sn)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,t=>{const r=this.zt(t);switch(e.state){case 0:this.Ht(t)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),r.Ct(e.resumeToken));break;default:bt()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((r,s)=>{this.Ht(s)&&t(s)})}Yt(e){const t=e.targetId,r=e.At.count,s=this.Xt(t);if(s){const i=s.target;if(sS(i))if(0===r){const o=new lt(i.path);this.jt(t,o,hr.newNoDocument(o,cn.min()))}else an(1===r);else this.Zt(t)!==r&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&sS(c.target)){const u=new lt(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,hr.newNoDocument(u,e))}i.Dt&&(t.set(o,i.xt()),i.Nt())}});let r=xn();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Xt(u);return!h||2===h.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(e));const s=new Pm(e,t,this.Kt,this.Ut,r);return this.Ut=ha(),this.qt=$X(),this.Kt=new X1(Sn),s}Qt(e,t){if(!this.Ht(e))return;const r=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,r){if(!this.Ht(e))return;const s=this.zt(e);this.ee(e,t)?s.kt(t,1):s.Ot(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Mt(e){this.zt(e).Mt()}zt(e){let t=this.Lt.get(e);return t||(t=new BX,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new X1(Sn),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||Ue("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new BX),this.Bt.getRemoteKeysForTarget(e).forEach(t=>{this.jt(e,t,null)})}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function $X(){return new as(lt.comparator)}function GX(){return new as(lt.comparator)}const mve={asc:"ASCENDING",desc:"DESCENDING"},_ve={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class vve{constructor(e,t){this.databaseId=e,this.gt=t}}function wm(n,e){return n.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function UX(n,e){return n.gt?e.toBase64():e.toUint8Array()}function Cve(n,e){return wm(n,e.toTimestamp())}function Vi(n){return an(!!n),cn.fromTimestamp(function(e){const t=o8(e);return new Zr(t.seconds,t.nanos)}(n))}function $x(n,e){return(t=n,new p1(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function qX(n){const e=p1.fromString(n);return an(JX(e)),e}function bm(n,e){return $x(n.databaseId,e.path)}function B4(n,e){const t=qX(e);if(t.get(1)!==n.databaseId.projectId)throw new Be(we.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Be(we.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new lt(jX(t))}function Gx(n,e){return $x(n.databaseId,e)}function Om(n){return new p1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function jX(n){return an(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function ZX(n,e,t){return{name:bm(n,e),fields:t.value.mapValue.fields}}function KX(n,e){return{documents:[Gx(n,e.path)]}}function qx(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=Gx(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Gx(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const h=u.map(g=>function(m){if("=="===m.op){if(iX(m.value))return{unaryFilter:{field:xh(m.field),op:"IS_NAN"}};if(sX(m.value))return{unaryFilter:{field:xh(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(iX(m.value))return{unaryFilter:{field:xh(m.field),op:"IS_NOT_NAN"}};if(sX(m.value))return{unaryFilter:{field:xh(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xh(m.field),op:Tve(m.op),value:m.value}}}(g));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(e.filters);s&&(t.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(h=>{return{field:xh((g=h).field),direction:Pve(g.dir)};var g})}(e.orderBy);i&&(t.structuredQuery.orderBy=i);const o=(h=e.limit,n.gt||dm(h)?h:{value:h});var h,c,u;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(c=e.startAt).inclusive,values:c.position}),e.endAt&&(t.structuredQuery.endAt={before:!(u=e.endAt).inclusive,values:u.position}),t}function XX(n){let e=function WX(n){const e=qX(n);return 4===e.length?p1.emptyPath():jX(e)}(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){an(1===r);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let i=[];t.where&&(i=QX(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(g=>{return new Th(kh((m=g).field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;t.limit&&(c=function(g){let m;return m="object"==typeof g?g.value:g,dm(m)?null:m}(t.limit));let u=null;var g;t.startAt&&(u=new l8((g=t.startAt).values||[],!!g.before));let h=null;return t.endAt&&(h=function(g){return new l8(g.values||[],!g.before)}(t.endAt)),function mX(n,e,t,r,s,i,o,c){return new u6(n,e,t,r,s,i,o,c)}(e,s,o,i,c,"F",u,h)}function QX(n){return n?void 0!==n.unaryFilter?[bve(n)]:void 0!==n.fieldFilter?[wve(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>QX(e)).reduce((e,t)=>e.concat(t)):bt():[]}function Pve(n){return mve[n]}function Tve(n){return _ve[n]}function xh(n){return{fieldPath:n.canonicalString()}}function kh(n){return Ss.fromServerFormat(n.fieldPath)}function wve(n){return b2.create(kh(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return bt()}}(n.fieldFilter.op),n.fieldFilter.value)}function bve(n){switch(n.unaryFilter.op){case"IS_NAN":const e=kh(n.unaryFilter.field);return b2.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=kh(n.unaryFilter.field);return b2.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=kh(n.unaryFilter.field);return b2.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=kh(n.unaryFilter.field);return b2.create(s,"!=",{nullValue:"NULL_VALUE"});default:return bt()}}function Ove(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function JX(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class jx{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&cve(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Em(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Em(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=HX();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=t.has(s.key)?null:c;const u=AX(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(cn.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),xn())}isEqual(e){return this.batchId===e.batchId&&Mh(this.mutations,e.mutations,(t,r)=>NX(t,r))&&Mh(this.baseMutations,e.baseMutations,(t,r)=>NX(t,r))}}class Zx{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){an(e.mutations.length===r.length);let s=hve;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Zx(e,t,r,s)}}class Yx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class f8{constructor(e,t,r,s,i=cn.min(),o=cn.min(),c=li.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(e){return new f8(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new f8(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new f8(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class oQ{constructor(e){this.re=e}}function Kx(n){const e=XX({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?oS(e,e.limit,"L"):e}class I5{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(cs(e.integerValue));else if("doubleValue"in e){const r=cs(e.doubleValue);isNaN(r)?this.le(t,13):(this.le(t,15),pm(r)?t.fe(0):t.fe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de(`${r.seconds||""}`),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(E5(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.le(t,45),t.fe(r.latitude||0),t.fe(r.longitude||0)}else"mapValue"in e?oX(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):bt()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const r=e.fields||{};this.le(t,55);for(const s of Object.keys(r))this._e(s,t),this.ae(r[s],t)}pe(e,t){const r=e.values||[];this.le(t,50);for(const s of r)this.ae(s,t)}ge(e,t){this.le(t,37),lt.fromName(e).path.forEach(r=>{this.le(t,60),this.Ie(r,t)})}le(e,t){e.fe(t)}we(e){e.fe(2)}}I5.Te=new I5;class eCe{constructor(){this.Ye=new Qx}addToCollectionParentIndex(e,t){return this.Ye.add(t),Me.resolve()}getCollectionParents(e,t){return Me.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return Me.resolve()}deleteFieldIndex(e,t){return Me.resolve()}getDocumentsMatchingTarget(e,t){return Me.resolve(null)}getIndexType(e,t){return Me.resolve(0)}getFieldIndexes(e,t){return Me.resolve([])}getNextCollectionGroupToUpdate(e){return Me.resolve(null)}getMinOffset(e,t){return Me.resolve(Wa.min())}getMinOffsetFromCollectionGroup(e,t){return Me.resolve(Wa.min())}updateCollectionGroup(e,t,r){return Me.resolve()}updateIndexEntries(e,t){return Me.resolve()}}class Qx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new X1(p1.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new X1(p1.comparator)).toArray()}}new Uint8Array(0);class da{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new da(e,da.DEFAULT_COLLECTION_PERCENTILE,da.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}da.DEFAULT_COLLECTION_PERCENTILE=10,da.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,da.DEFAULT=new da(41943040,da.DEFAULT_COLLECTION_PERCENTILE,da.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),da.DISABLED=new da(-1,0,0);class L5{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new L5(0)}static vn(){return new L5(-1)}}class uCe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class bQ{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.getBaseDocument(e,t,r))).next(s=>(null!==r&&Em(r.mutation,s,ja.empty(),Zr.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,xn()).next(()=>r))}getLocalViewOfDocuments(e,t,r=xn()){const s=F4();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Mm();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=F4();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,xn()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{t.set(o,c)})})}computeViews(e,t,r,s){let i=ha();const o=Sm(),c=Sm();return t.forEach((u,h)=>{const g=r.get(h.key);s.has(h.key)&&(void 0===g||g.mutation instanceof f6)?i=i.insert(h.key,h):void 0!==g&&(o.set(h.key,g.mutation.getFieldMask()),Em(g.mutation,h,g.mutation.getFieldMask(),Zr.now()))}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((h,g)=>o.set(h,g)),t.forEach((h,g)=>{var m;return c.set(h,new uCe(g,null!==(m=o.get(h))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(e,t){const r=Sm();let s=new as((o,c)=>o-c),i=xn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=t.get(u);if(null===h)return;let g=r.get(u)||ja.empty();g=c.applyToLocalView(h,g),r.set(u,g);const m=(s.get(c.batchId)||xn()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,g=u.value,m=HX();g.forEach(M=>{if(!i.has(M)){const b=AX(t.get(M),r.get(M));null!==b&&m.set(M,b),i=i.add(M)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return Me.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return lt.isDocumentKey((s=t).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Hx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var s}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):Me.resolve(F4());let c=-1,u=i;return o.next(h=>Me.forEach(h,(g,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(g)?Me.resolve():this.getBaseDocument(e,g,m).next(M=>{u=u.insert(g,M)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,u,h,xn())).next(g=>({batchId:c,changes:zX(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new lt(t)).next(r=>{let s=Mm();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const s=t.collectionGroup;let i=Mm();return this.indexManager.getCollectionParents(e,s).next(o=>Me.forEach(o,c=>{const u=(h=t,g=c.child(s),new u6(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,g;return this.getDocumentsMatchingCollectionQuery(e,u,r).next(h=>{h.forEach((g,m)=>{i=i.insert(g,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,r){let s;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const h=u.getKey();null===s.get(h)&&(s=s.insert(h,hr.newInvalidDocument(h)))});let o=Mm();return s.forEach((c,u)=>{const h=i.get(c);void 0!==h&&Em(h.mutation,u,ja.empty(),Zr.now()),Fx(t,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):Me.resolve(hr.newInvalidDocument(t))}}class fCe{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return Me.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var r;return this.Zn.set(t.id,{id:(r=t).id,version:r.version,createTime:Vi(r.createTime)}),Me.resolve()}getNamedQuery(e,t){return Me.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(r=t).name,query:Kx(r.bundledQuery),readTime:Vi(r.readTime)}),Me.resolve();var r}}class hCe{constructor(){this.overlays=new as(lt.comparator),this.es=new Map}getOverlay(e,t){return Me.resolve(this.overlays.get(t))}getOverlays(e,t){const r=F4();return Me.forEach(t,s=>this.getOverlay(e,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ue(e,t,i)}),Me.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),Me.resolve()}getOverlaysForCollection(e,t,r){const s=F4(),i=t.length+1,o=new lt(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Me.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new as((h,g)=>h-g);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let g=i.get(h.largestBatchId);null===g&&(g=F4(),i=i.insert(h.largestBatchId,g)),g.set(h.getKey(),h)}}const c=F4(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,g)=>c.set(h,g)),!(c.size()>=s)););return Me.resolve(c)}ue(e,t,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Yx(t,r));let i=this.es.get(t);void 0===i&&(i=xn(),this.es.set(t,i)),this.es.set(t,i.add(r.key))}}class Jx{constructor(){this.ns=new X1(Bi.ss),this.rs=new X1(Bi.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const r=new Bi(e,t);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.cs(new Bi(e,t))}hs(e,t){e.forEach(r=>this.removeReference(r,t))}ls(e){const t=new lt(new p1([])),r=new Bi(t,e),s=new Bi(t,e+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new lt(new p1([])),r=new Bi(t,e),s=new Bi(t,e+1);let i=xn();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Bi(e,0),r=this.ns.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Bi{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return lt.comparator(e.key,t.key)||Sn(e._s,t._s)}static os(e,t){return Sn(e._s,t._s)||lt.comparator(e.key,t.key)}}class dCe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new X1(Bi.ss)}checkEmpty(e){return Me.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,s){const i=this.ws;this.ws++;const o=new jx(i,t,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new Bi(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Me.resolve(o)}lookupMutationBatch(e,t){return Me.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const s=this.ps(t+1),i=s<0?0:s;return Me.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Me.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return Me.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Bi(t,0),s=new Bi(t,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),Me.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new X1(Sn);return t.forEach(s=>{const i=new Bi(s,0),o=new Bi(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),Me.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;lt.isDocumentKey(i)||(i=i.child(""));const o=new Bi(new lt(i),0);let c=new X1(Sn);return this.gs.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u._s)),!0)},o),Me.resolve(this.Is(c))}Is(e){const t=[];return e.forEach(r=>{const s=this.ys(r);null!==s&&t.push(s)}),t}removeMutationBatch(e,t){an(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return Me.forEach(t.mutations,s=>{const i=new Bi(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,t){const r=new Bi(t,0),s=this.gs.firstAfterOrEqual(r);return Me.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return Me.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class pCe{constructor(e){this.Es=e,this.docs=new as(lt.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Me.resolve(r?r.document.mutableCopy():hr.newInvalidDocument(t))}getEntries(e,t){let r=ha();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():hr.newInvalidDocument(s))}),Me.resolve(r)}getAllFromCollection(e,t,r){let s=ha();const i=new lt(t.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!t.isPrefixOf(c.path))break;c.path.length>t.length+1||Nx(YK(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return Me.resolve(s)}getAllFromCollectionGroup(e,t,r,s){bt()}As(e,t){return Me.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new gCe(this)}getSize(e){return Me.resolve(this.size)}}class gCe extends class aCe{constructor(){this.changes=new u8(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,hr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?Me.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Yn.addEntry(e,s)):this.Yn.removeEntry(r)}),Me.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class mCe{constructor(e){this.persistence=e,this.Rs=new u8(t=>T5(t),vm),this.lastRemoteSnapshotVersion=cn.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Jx,this.targetCount=0,this.vs=L5.Pn()}forEachTarget(e,t){return this.Rs.forEach((r,s)=>t(s)),Me.resolve()}getLastRemoteSnapshotVersion(e){return Me.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Me.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),Me.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),Me.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new L5(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,Me.resolve()}updateTargetData(e,t){return this.Dn(t),Me.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,Me.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=t&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),Me.waitFor(i).next(()=>s)}getTargetCount(e){return Me.resolve(this.targetCount)}getTargetData(e,t){const r=this.Rs.get(t)||null;return Me.resolve(r)}addMatchingKeys(e,t,r){return this.Ps.us(t,r),Me.resolve()}removeMatchingKeys(e,t,r){this.Ps.hs(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),Me.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),Me.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ps.ds(t);return Me.resolve(r)}containsKey(e,t){return Me.resolve(this.Ps.containsKey(t))}}class OQ{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new fa(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new mCe(this),this.indexManager=new eCe,this.remoteDocumentCache=new pCe(r=>this.referenceDelegate.xs(r)),this.It=new oQ(t),this.Ns=new fCe(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hCe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Vs[e.toKey()];return r||(r=new dCe(t,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,r){Ue("MemoryPersistence","Starting transaction:",e);const s=new _Ce(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(e,t){return Me.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,t)))}}class _Ce extends class H_e{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}{constructor(e){super(),this.currentSequenceNumber=e}}class yS{constructor(e){this.persistence=e,this.Fs=new Jx,this.$s=null}static Bs(e){return new yS(e)}get Ls(){if(this.$s)return this.$s;throw bt()}addReference(e,t,r){return this.Fs.addReference(r,t),this.Ls.delete(r.toString()),Me.resolve()}removeReference(e,t,r){return this.Fs.removeReference(r,t),this.Ls.add(r.toString()),Me.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),Me.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Me.forEach(this.Ls,r=>{const s=lt.fromPath(r);return this.Us(e,s).next(i=>{i||t.removeEntry(s,cn.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.Us(e,t).next(r=>{r?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}Us(e,t){return Me.or([()=>Me.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class rk{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Si=r,this.Di=s}static Ci(e,t){let r=xn(),s=xn();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new rk(e,t.fromCache,r,s)}}class NQ{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,r,s){return this.ki(e,t).next(i=>i||this.Oi(e,t,s,r)).next(i=>i||this.Mi(e,t))}ki(e,t){if(_X(t))return Me.resolve(null);let r=ko(t);return this.indexManager.getIndexType(e,r).next(s=>0===s?null:(null!==t.limit&&1===s&&(t=oS(t,null,"F"),r=ko(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=xn(...i);return this.Ni.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const h=this.Fi(t,c);return this.$i(t,h,o,u.readTime)?this.ki(e,oS(t,null,"F")):this.Bi(e,h,t,u)}))})))}Oi(e,t,r,s){return _X(t)||s.isEqual(cn.min())?this.Mi(e,t):this.Ni.getDocuments(e,r).next(i=>{const o=this.Fi(t,i);return this.$i(t,o,r,s)?this.Mi(e,t):(bx()<=d1.DEBUG&&Ue("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Vx(t)),this.Bi(e,o,t,function ZK(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=cn.fromTimestamp(1e9===r?new Zr(t+1,0):new Zr(t,r));return new Wa(s,lt.empty(),e)}(s,-1)))})}Fi(e,t){let r=new X1(yX(e));return t.forEach((s,i)=>{Fx(e,i)&&(r=r.add(i))}),r}$i(e,t,r,s){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(e,t){return bx()<=d1.DEBUG&&Ue("QueryEngine","Using full collection scan to execute query:",Vx(t)),this.Ni.getDocumentsMatchingQuery(e,t,Wa.min())}Bi(e,t,r,s){return this.Ni.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}class CCe{constructor(e,t,r,s){this.persistence=e,this.Li=t,this.It=s,this.Ui=new as(Sn),this.qi=new u8(i=>T5(i),vm),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bQ(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ui))}}function xQ(n,e){return sk.apply(this,arguments)}function sk(){return sk=I(function*(n,e){const t=ht(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.Qi(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=xn();for(const h of s){o.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}for(const h of i){c.push(h.batchId);for(const g of h.mutations)u=u.add(g.key)}return t.localDocuments.getDocuments(r,u).next(h=>({ji:h,removedBatchIds:o,addedBatchIds:c}))})})}),sk.apply(this,arguments)}function yCe(n,e){const t=ht(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,h){const g=u.batch,m=g.keys();let M=Me.resolve();return m.forEach(b=>{M=M.next(()=>h.getEntry(c,b)).next(L=>{const G=u.docVersions.get(b);an(null!==G),L.version.compareTo(G)<0&&(g.applyToRemoteDocument(L,u),L.isValidDocument()&&(L.setReadTime(u.commitVersion),h.addEntry(L)))})}),M.next(()=>o.mutationQueue.removeMutationBatch(c,g))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=xn();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function kQ(n){const e=ht(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function ECe(n,e){const t=ht(n),r=e.snapshotVersion;let s=t.Ui;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Gi.newChangeBuffer({trackRemovals:!0});s=t.Ui;const c=[];e.targetChanges.forEach((g,m)=>{const M=s.get(m);if(!M)return;c.push(t.Cs.removeMatchingKeys(i,g.removedDocuments,m).next(()=>t.Cs.addMatchingKeys(i,g.addedDocuments,m)));let b=M.withSequenceNumber(i.currentSequenceNumber);var L,G,j;e.targetMismatches.has(m)?b=b.withResumeToken(li.EMPTY_BYTE_STRING,cn.min()).withLastLimboFreeSnapshotVersion(cn.min()):g.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(g.resumeToken,r)),s=s.insert(m,b),G=b,j=g,(0===(L=M).resumeToken.approximateByteSize()||G.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=3e8||j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0)&&c.push(t.Cs.updateTargetData(i,b))});let u=ha(),h=xn();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(i,g))}),c.push(function LQ(n,e,t){let r=xn(),s=xn();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=ha();return t.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(cn.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||0===u.version.compareTo(h.version)&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ue("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,e.documentUpdates).next(g=>{u=g.Wi,h=g.zi})),!r.isEqual(cn.min())){const g=t.Cs.getLastRemoteSnapshotVersion(i).next(m=>t.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(g)}return Me.waitFor(c).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(t.Ui=s,i))}function MCe(n,e){const t=ht(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Dh(n,e){const t=ht(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Cs.getTargetData(r,e).next(i=>i?(s=i,Me.resolve(s)):t.Cs.allocateTargetId(r).next(o=>(s=new f8(e,o,0,r.currentSequenceNumber),t.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ui=t.Ui.insert(r.targetId,r),t.qi.set(e,r.targetId)),r})}function zh(n,e,t){return ik.apply(this,arguments)}function ik(){return ik=I(function*(n,e,t){const r=ht(n),s=r.Ui.get(e),i=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!i8(o))throw o;Ue("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ui=r.Ui.remove(e),r.qi.delete(s.target)}),ik.apply(this,arguments)}function MS(n,e,t){const r=ht(n);let s=cn.min(),i=xn();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,h){const g=ht(c),m=g.qi.get(h);return void 0!==m?Me.resolve(g.Ui.get(m)):g.Cs.getTargetData(u,h)}(r,o,ko(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,e,t?s:cn.min(),t?i:xn())).next(c=>(function zQ(n,e,t){let r=n.Ki.get(e)||cn.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(e,r)}(r,function CX(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(e),c),{documents:c,Hi:i})))}class uk{constructor(){this.activeTargetIds=uS()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class FQ{constructor(){this.Lr=new uk,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,r){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new uk,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class TCe{qr(e){}shutdown(){}}class BQ{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Ue("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){Ue("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const wCe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class bCe{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class OCe extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,r,s,i){const o=this.ho(e,t);Ue("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(e,o,c,r).then(u=>(Ue("RestConnection","Received: ",u),u),u=>{throw Eh("RestConnection",`${e} failed with error: `,u,"url: ",o,"request:",r),u})}_o(e,t,r,s,i,o){return this.ao(e,t,r,s,i)}lo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+yh,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}ho(e,t){return`${this.oo}/v1/${t}:${wCe[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,r,s){return new Promise((i,o)=>{const c=new b_e;c.setWithCredentials(!0),c.listenOnce(P_e.COMPLETE,()=>{var h;try{switch(c.getLastErrorCode()){case wx.NO_ERROR:const g=c.getResponseJson();Ue("Connection","XHR received:",JSON.stringify(g)),i(g);break;case wx.TIMEOUT:Ue("Connection",'RPC "'+e+'" timed out'),o(new Be(we.DEADLINE_EXCEEDED,"Request time out"));break;case wx.HTTP_ERROR:const m=c.getStatus();if(Ue("Connection",'RPC "'+e+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let M=c.getResponseJson();Array.isArray(M)&&(M=M[0]);const b=null===(h=M)||void 0===h?void 0:h.error;if(b&&b.status&&b.message){const L=function(G){const j=G.toLowerCase().replace(/_/g,"-");return Object.values(we).indexOf(j)>=0?j:we.UNKNOWN}(b.status);o(new Be(L,b.message))}else o(new Be(we.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Be(we.UNAVAILABLE,"Connection failed."));break;default:bt()}}finally{Ue("Connection",'RPC "'+e+'" completed.')}});const u=JSON.stringify(s);c.send(t,"POST",u,r,15)})}wo(e,t,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=M_e(),o=S_e(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new w_e({})),this.lo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;const u=s.join("");Ue("Connection","Creating WebChannel: "+u,c);const h=i.createWebChannel(u,c);let g=!1,m=!1;const M=new bCe({Hr:L=>{m?Ue("Connection","Not sending because WebChannel is closed:",L):(g||(Ue("Connection","Opening WebChannel transport."),h.open(),g=!0),Ue("Connection","WebChannel sending:",L),h.send(L))},Jr:()=>h.close()}),b=(L,G,j)=>{L.listen(G,ie=>{try{j(ie)}catch(ye){setTimeout(()=>{throw ye},0)}})};return b(h,XM.EventType.OPEN,()=>{m||Ue("Connection","WebChannel transport opened.")}),b(h,XM.EventType.CLOSE,()=>{m||(m=!0,Ue("Connection","WebChannel transport closed"),M.io())}),b(h,XM.EventType.ERROR,L=>{m||(m=!0,Eh("Connection","WebChannel transport errored:",L),M.io(new Be(we.UNAVAILABLE,"The operation could not be completed")))}),b(h,XM.EventType.MESSAGE,L=>{var G;if(!m){const j=L.data[0];an(!!j);const ie=j,ye=ie.error||(null===(G=ie[0])||void 0===G?void 0:G.error);if(ye){Ue("Connection","WebChannel received error:",ye);const te=ye.status;let xe=function(et){const Ft=$s[et];if(void 0!==Ft)return RX(Ft)}(te),$e=ye.message;void 0===xe&&(xe=we.INTERNAL,$e="Unknown error status: "+te+" with message "+ye.message),m=!0,M.io(new Be(xe,$e)),h.close()}else Ue("Connection","WebChannel received:",j),M.ro(j)}}),b(o,T_e.STAT_EVENT,L=>{L.stat===$K.PROXY?Ue("Connection","Detected buffering proxy"):L.stat===$K.NOPROXY&&Ue("Connection","Detected no buffering proxy")}),setTimeout(()=>{M.so()},0),M}}function TS(){return typeof document<"u"?document:null}function Hm(n){return new vve(n,!0)}class hk{constructor(e,t,r=1e3,s=1.5,i=6e4){this.Hs=e,this.timerId=t,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,t-r);s>0&&Ue("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class GQ{constructor(e,t,r,s,i,o,c,u){this.Hs=e,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new hk(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return I(function*(){e.No()&&(yield e.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return I(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var r=this;return I(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==e?r.xo.reset():t&&t.code===we.RESOURCE_EXHAUSTED?(Ms(t.toString()),Ms("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):t&&t.code===we.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(t)})()}qo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===t&&this.Go(r,s)},r=>{e(()=>{const s=new Be(we.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(e,t){const r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var e=this;this.state=5,this.xo.Ro(I(function*(){e.state=0,e.start()}))}Qo(e){return Ue("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(Ue("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ACe extends GQ{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.It=i}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function Eve(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:bt(),s=e.targetChange.targetIds||[],i=function(u,h){return u.gt?(an(void 0===h||"string"==typeof h),li.fromBase64String(h||"")):(an(void 0===h||h instanceof Uint8Array),li.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(u){const h=void 0===u.code?we.UNKNOWN:RX(u.code);return new Be(h,u.message||"")}(o);t=new FX(r,s,i,c||null)}else if("documentChange"in e){const r=e.documentChange,s=B4(n,r.document.name),i=Vi(r.document.updateTime),o=new w2({mapValue:{fields:r.document.fields}}),c=hr.newFoundDocument(s,i,o);t=new fS(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const r=e.documentDelete,s=B4(n,r.document),i=r.readTime?Vi(r.readTime):cn.min(),o=hr.newNoDocument(s,i);t=new fS([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,s=B4(n,r.document);t=new fS([],r.removedTargetIds||[],s,null)}else{if(!("filter"in e))return bt();{const r=e.filter,i=new uve(r.count||0);t=new VX(r.targetId,i)}}var u;return t}(this.It,e),r=function(s){if(!("targetChange"in s))return cn.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?cn.min():i.readTime?Vi(i.readTime):cn.min()}(e);return this.listener.Wo(t,r)}zo(e){const t={};t.database=Om(this.It),t.addTarget=function(s,i){let o;const c=i.target;return o=sS(c)?{documents:KX(s,c)}:{query:qx(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=UX(s,i.resumeToken):i.snapshotVersion.compareTo(cn.min())>0&&(o.readTime=wm(s,i.snapshotVersion.toTimestamp())),o}(this.It,e);const r=function Sve(n,e){const t=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return bt()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Bo(t)}Ho(e){const t={};t.database=Om(this.It),t.removeTarget=e,this.Bo(t)}}class NCe extends GQ{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(an(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function Mve(n,e){return n&&n.length>0?(an(void 0!==e),n.map(t=>function(r,s){let i=Vi(r.updateTime?r.updateTime:s);return i.isEqual(cn.min())&&(i=Vi(s)),new ave(i,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Vi(e.commitTime);return this.listener.Zo(r,t)}return an(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Om(this.It),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>function Am(n,e){let t;if(e instanceof Nh)t={update:ZX(n,e.key,e.value)};else if(e instanceof Ih)t={delete:bm(n,e.key)};else if(e instanceof f6)t={update:ZX(n,e.key,e.data),updateMask:Ove(e.fieldMask)};else{if(!(e instanceof Bx))return bt();t={verify:bm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Oh)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof w5)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof b5)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Ah)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw bt()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Cve(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:bt()),t;var s}(this.It,r))};this.Bo(t)}}class ICe extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new Be(we.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(e,t,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Be(we.UNKNOWN,s.toString())})}_o(e,t,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(e,t,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===we.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Be(we.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class kCe{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Ms(t),this.ou=!1):Ue("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class LCe{constructor(e,t,r,s,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(I(function*(){var u;h6(o)&&(Ue("RemoteStore","Restarting streams for network reachability change."),yield(u=I(function*(h){const g=ht(h);g._u.add(4),yield Hh(g),g.gu.set("Unknown"),g._u.delete(4),yield Vm(g)}),function(h){return u.apply(this,arguments)})(o))}))}),this.gu=new kCe(r,s)}}function Vm(n){return pk.apply(this,arguments)}function pk(){return pk=I(function*(n){if(h6(n))for(const e of n.wu)yield e(!0)}),pk.apply(this,arguments)}function Hh(n){return gk.apply(this,arguments)}function gk(){return gk=I(function*(n){for(const e of n.wu)yield e(!1)}),gk.apply(this,arguments)}function wS(n,e){const t=ht(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),vk(t)?_k(t):Fh(t).ko()&&mk(t,e))}function Fm(n,e){const t=ht(n),r=Fh(t);t.du.delete(e),r.ko()&&UQ(t,e),0===t.du.size&&(r.ko()?r.Fo():h6(t)&&t.gu.set("Unknown"))}function mk(n,e){n.yu.Mt(e.targetId),Fh(n).zo(e)}function UQ(n,e){n.yu.Mt(e),Fh(n).Ho(e)}function _k(n){n.yu=new gve({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),se:e=>n.du.get(e)||null}),Fh(n).start(),n.gu.uu()}function vk(n){return h6(n)&&!Fh(n).No()&&n.du.size>0}function h6(n){return 0===ht(n)._u.size}function qQ(n){n.yu=void 0}function RCe(n){return Ck.apply(this,arguments)}function Ck(){return Ck=I(function*(n){n.du.forEach((e,t)=>{mk(n,e)})}),Ck.apply(this,arguments)}function DCe(n,e){return yk.apply(this,arguments)}function yk(){return yk=I(function*(n,e){qQ(n),vk(n)?(n.gu.hu(e),_k(n)):n.gu.set("Unknown")}),yk.apply(this,arguments)}function zCe(n,e,t){return Ek.apply(this,arguments)}function Ek(){return Ek=I(function*(n,e,t){if(n.gu.set("Online"),e instanceof FX&&2===e.state&&e.cause)try{yield(r=I(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,e)}catch(r){Ue("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield bS(n,r)}else if(e instanceof fS?n.yu.Gt(e):e instanceof VX?n.yu.Yt(e):n.yu.Wt(e),!t.isEqual(cn.min()))try{const r=yield kQ(n.localStore);t.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.du.get(u);h&&s.du.set(u,h.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(li.EMPTY_BYTE_STRING,u.snapshotVersion)),UQ(s,c);const h=new f8(u.target,c,1,u.sequenceNumber);mk(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,t))}catch(r){Ue("RemoteStore","Failed to raise snapshot:",r),yield bS(n,r)}var r}),Ek.apply(this,arguments)}function bS(n,e,t){return Mk.apply(this,arguments)}function Mk(){return Mk=I(function*(n,e,t){if(!i8(e))throw e;n._u.add(1),yield Hh(n),n.gu.set("Offline"),t||(t=()=>kQ(n.localStore)),n.asyncQueue.enqueueRetryable(I(function*(){Ue("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield Vm(n)}))}),Mk.apply(this,arguments)}function WQ(n,e){return e().catch(t=>bS(n,t,e))}function Vh(n){return Sk.apply(this,arguments)}function Sk(){return Sk=I(function*(n){const e=ht(n),t=p8(e);let r=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;HCe(e);)try{const s=yield MCe(e.localStore,r);if(null===s){0===e.fu.length&&t.Fo();break}r=s.batchId,VCe(e,s)}catch(s){yield bS(e,s)}jQ(e)&&ZQ(e)}),Sk.apply(this,arguments)}function HCe(n){return h6(n)&&n.fu.length<10}function VCe(n,e){n.fu.push(e);const t=p8(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function jQ(n){return h6(n)&&!p8(n).No()&&n.fu.length>0}function ZQ(n){p8(n).start()}function FCe(n){return Pk.apply(this,arguments)}function Pk(){return Pk=I(function*(n){p8(n).eu()}),Pk.apply(this,arguments)}function BCe(n){return Tk.apply(this,arguments)}function Tk(){return Tk=I(function*(n){const e=p8(n);for(const t of n.fu)e.Xo(t.mutations)}),Tk.apply(this,arguments)}function $Ce(n,e,t){return wk.apply(this,arguments)}function wk(){return wk=I(function*(n,e,t){const r=n.fu.shift(),s=Zx.from(r,e,t);yield WQ(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield Vh(n)}),wk.apply(this,arguments)}function GCe(n,e){return bk.apply(this,arguments)}function bk(){return bk=I(function*(n,e){var t;e&&p8(n).Yo&&(yield(t=I(function*(r,s){if(LX(i=s.code)&&i!==we.ABORTED){const o=r.fu.shift();p8(r).Mo(),yield WQ(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Vh(r)}var i}),function(r,s){return t.apply(this,arguments)})(n,e)),jQ(n)&&ZQ(n)}),bk.apply(this,arguments)}function YQ(n,e){return Ok.apply(this,arguments)}function Ok(){return Ok=I(function*(n,e){const t=ht(n);t.asyncQueue.verifyOperationInProgress(),Ue("RemoteStore","RemoteStore received new credentials");const r=h6(t);t._u.add(3),yield Hh(t),r&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield Vm(t)}),Ok.apply(this,arguments)}function Nk(){return Nk=I(function*(n,e){const t=ht(n);e?(t._u.delete(2),yield Vm(t)):e||(t._u.add(2),yield Hh(t),t.gu.set("Unknown"))}),Nk.apply(this,arguments)}function Fh(n){return n.pu||(n.pu=function(e,t,r){const s=ht(e);return s.su(),new ACe(t,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:RCe.bind(null,n),Zr:DCe.bind(null,n),Wo:zCe.bind(null,n)}),n.wu.push(function(){var e=I(function*(t){t?(n.pu.Mo(),vk(n)?_k(n):n.gu.set("Unknown")):(yield n.pu.stop(),qQ(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function p8(n){return n.Iu||(n.Iu=function(e,t,r){const s=ht(e);return s.su(),new NCe(t,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:FCe.bind(null,n),Zr:GCe.bind(null,n),tu:BCe.bind(null,n),Zo:$Ce.bind(null,n)}),n.wu.push(function(){var e=I(function*(t){t?(n.Iu.Mo(),yield Vh(n)):(yield n.Iu.stop(),n.fu.length>0&&(Ue("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class Ik{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,c=new Ik(e,t,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Be(we.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bh(n,e){if(Ms("AsyncQueue",`${e}: ${n}`),i8(n))return new Be(we.UNAVAILABLE,`${e}: ${n}`);throw n}class $h{constructor(e){this.comparator=e?(t,r)=>e(t,r)||lt.comparator(t.key,r.key):(t,r)=>lt.comparator(t.key,r.key),this.keyedMap=Mm(),this.sortedSet=new as(this.comparator)}static emptySet(e){return new $h(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $h)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new $h;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class KQ{constructor(){this.Tu=new as(lt.comparator)}track(e){const t=e.doc.key,r=this.Tu.get(t);r?0!==e.type&&3===r.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==r.type?this.Tu=this.Tu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Tu=this.Tu.remove(t):1===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):bt():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,r)=>{e.push(r)}),e}}class Gh{constructor(e,t,r,s,i,o,c,u,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(c=>{o.push({type:0,doc:c})}),new Gh(e,t,$h.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}class UCe{constructor(){this.Au=void 0,this.listeners=[]}}class qCe{constructor(){this.queries=new u8(e=>vX(e),Cm),this.onlineState="Unknown",this.Ru=new Set}}function xk(n,e){return kk.apply(this,arguments)}function kk(){return kk=I(function*(n,e){const t=ht(n),r=e.query;let s=!1,i=t.queries.get(r);if(i||(s=!0,i=new UCe),s)try{i.Au=yield t.onListen(r)}catch(o){const c=Bh(o,`Initialization of query '${Vx(e.query)}' failed`);return void e.onError(c)}t.queries.set(r,i),i.listeners.push(e),e.bu(t.onlineState),i.Au&&e.Pu(i.Au)&&Dk(t)}),kk.apply(this,arguments)}function Lk(n,e){return Rk.apply(this,arguments)}function Rk(){return Rk=I(function*(n,e){const t=ht(n),r=e.query;let s=!1;const i=t.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return t.queries.delete(r),t.onUnlisten(r)}),Rk.apply(this,arguments)}function WCe(n,e){const t=ht(n);let r=!1;for(const s of e){const o=t.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&Dk(t)}function jCe(n,e,t){const r=ht(n),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(t);r.queries.delete(e)}function Dk(n){n.Ru.forEach(e=>{e.next()})}class zk{constructor(e,t,r){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)3!==s.type&&r.push(s);e=new Gh(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||(!this.options.Nu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=Gh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class JQ{constructor(e){this.key=e}}class eJ{constructor(e){this.key=e}}class tJ{constructor(e,t){this.query=e,this.Uu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=xn(),this.mutatedKeys=xn(),this.Gu=yX(e),this.Qu=new $h(this.Gu)}get ju(){return this.Uu}Wu(e,t){const r=t?t.zu:new KQ,s=t?t.Qu:this.Qu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((g,m)=>{const M=s.get(g),b=Fx(this.query,m)?m:null,L=!!M&&this.mutatedKeys.has(M.key),G=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let j=!1;M&&b?M.data.isEqual(b.data)?L!==G&&(r.track({type:3,doc:b}),j=!0):this.Hu(M,b)||(r.track({type:2,doc:b}),j=!0,(u&&this.Gu(b,u)>0||h&&this.Gu(b,h)<0)&&(c=!0)):!M&&b?(r.track({type:0,doc:b}),j=!0):M&&!b&&(r.track({type:1,doc:M}),j=!0,(u||h)&&(c=!0)),j&&(b?(o=o.add(b),i=G?i.add(g):i.delete(g)):(o=o.delete(g),i=i.delete(g)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const g="F"===this.query.limitType?o.last():o.first();o=o.delete(g.key),i=i.delete(g.key),r.track({type:1,doc:g})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const s=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const i=e.zu.Eu();i.sort((h,g)=>function(m,M){const b=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return bt()}};return b(m)-b(M)}(h.type,g.type)||this.Gu(h.doc,g.doc)),this.Ju(r);const o=t?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new Gh(this.query,e.Qu,s,i,e.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new KQ,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.Uu=this.Uu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Uu=this.Uu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=xn(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const t=[];return e.forEach(r=>{this.Ku.has(r)||t.push(new eJ(r))}),this.Ku.forEach(r=>{e.has(r)||t.push(new JQ(r))}),t}tc(e){this.Uu=e.Hi,this.Ku=xn();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return Gh.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class KCe{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class XCe{constructor(e){this.key=e,this.nc=!1}}class QCe{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new u8(c=>vX(c),Cm),this.rc=new Map,this.oc=new Set,this.uc=new as(lt.comparator),this.cc=new Map,this.ac=new Jx,this.hc={},this.lc=new Map,this.fc=L5.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function JCe(n,e){return Hk.apply(this,arguments)}function Hk(){return Hk=I(function*(n,e){const t=aL(n);let r,s;const i=t.ic.get(e);if(i)r=i.targetId,t.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield Dh(t.localStore,ko(e));t.isPrimaryClient&&wS(t.remoteStore,o);const c=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield Vk(t,e,r,"current"===c,o.resumeToken)}return s}),Hk.apply(this,arguments)}function Vk(n,e,t,r,s){return Fk.apply(this,arguments)}function Fk(){return Fk=I(function*(n,e,t,r,s){n._c=(m,M,b)=>{return(L=I(function*(G,j,ie,ye){let te=j.view.Wu(ie);te.$i&&(te=yield MS(G.localStore,j.query,!1).then(({documents:et})=>j.view.Wu(et,te)));const xe=ye&&ye.targetChanges.get(j.targetId),$e=j.view.applyChanges(te,G.isPrimaryClient,xe);return Kk(G,j.targetId,$e.Xu),$e.snapshot}),function(G,j,ie,ye){return L.apply(this,arguments)})(n,m,M,b);var L};const i=yield MS(n.localStore,e,!0),o=new tJ(e,i.Hi),c=o.Wu(i.documents),u=Tm.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(c,n.isPrimaryClient,u);Kk(n,t,h.Xu);const g=new KCe(e,t,o);return n.ic.set(e,g),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),h.snapshot}),Fk.apply(this,arguments)}function eye(n,e){return Bk.apply(this,arguments)}function Bk(){return Bk=I(function*(n,e){const t=ht(n),r=t.ic.get(e),s=t.rc.get(r.targetId);if(s.length>1)return t.rc.set(r.targetId,s.filter(i=>!Cm(i,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield zh(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),Fm(t.remoteStore,r.targetId),Uh(t,r.targetId)}).catch(s8))):(Uh(t,r.targetId),yield zh(t.localStore,r.targetId,!0))}),Bk.apply(this,arguments)}function $k(){return $k=I(function*(n,e,t){const r=cL(n);try{const s=yield function(i,o){const c=ht(i),u=Zr.now(),h=o.reduce((M,b)=>M.add(b.key),xn());let g,m;return c.persistence.runTransaction("Locally write mutations","readwrite",M=>{let b=ha(),L=xn();return c.Gi.getEntries(M,h).next(G=>{b=G,b.forEach((j,ie)=>{ie.isValidDocument()||(L=L.add(j))})}).next(()=>c.localDocuments.getOverlayedDocuments(M,b)).next(G=>{g=G;const j=[];for(const ie of o){const ye=lve(ie,g.get(ie.key).overlayedDocument);null!=ye&&j.push(new f6(ie.key,ye,lX(ye.value.mapValue),Dr.exists(!0)))}return c.mutationQueue.addMutationBatch(M,u,j,o)}).next(G=>{m=G;const j=G.applyToLocalDocumentSet(g,L);return c.documentOverlayCache.saveOverlays(M,G.batchId,j)})}).then(()=>({batchId:m.batchId,changes:zX(g)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new as(Sn)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,t),yield d6(r,s.changes),yield Vh(r.remoteStore)}catch(s){const i=Bh(s,"Failed to persist write");t.reject(i)}}),$k.apply(this,arguments)}function nJ(n,e){return Gk.apply(this,arguments)}function Gk(){return Gk=I(function*(n,e){const t=ht(n);try{const r=yield ECe(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.cc.get(i);o&&(an(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?an(o.nc):s.removedDocuments.size>0&&(an(o.nc),o.nc=!1))}),yield d6(t,r,e)}catch(r){yield s8(r)}}),Gk.apply(this,arguments)}function rJ(n,e,t){const r=ht(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(e);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=ht(i);c.onlineState=o;let u=!1;c.queries.forEach((h,g)=>{for(const m of g.listeners)m.bu(o)&&(u=!0)}),u&&Dk(c)}(r.eventManager,e),s.length&&r.sc.Wo(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function nye(n,e,t){return Uk.apply(this,arguments)}function Uk(){return Uk=I(function*(n,e,t){const r=ht(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.cc.get(e),i=s&&s.key;if(i){let o=new as(lt.comparator);o=o.insert(i,hr.newNoDocument(i,cn.min()));const c=xn().add(i),u=new Pm(cn.min(),new Map,new X1(Sn),o,c);yield nJ(r,u),r.uc=r.uc.remove(i),r.cc.delete(e),Xk(r)}else yield zh(r.localStore,e,!1).then(()=>Uh(r,e,t)).catch(s8)}),Uk.apply(this,arguments)}function rye(n,e){return qk.apply(this,arguments)}function qk(){return qk=I(function*(n,e){const t=ht(n),r=e.batch.batchId;try{const s=yield yCe(t.localStore,e);Yk(t,r,null),Zk(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield d6(t,s)}catch(s){yield s8(s)}}),qk.apply(this,arguments)}function sye(n,e,t){return Wk.apply(this,arguments)}function Wk(){return Wk=I(function*(n,e,t){const r=ht(n);try{const s=yield function(i,o){const c=ht(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,o).next(g=>(an(null!==g),h=g.keys(),c.mutationQueue.removeMutationBatch(u,g))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,e);Yk(r,e,t),Zk(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield d6(r,s)}catch(s){yield s8(s)}}),Wk.apply(this,arguments)}function Zk(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function Yk(n,e,t){const r=ht(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.hc[r.currentUser.toKey()]=s}}function Uh(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.rc.get(e))n.ic.delete(r),t&&n.sc.wc(r,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(r=>{n.ac.containsKey(r)||sJ(n,r)})}function sJ(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);null!==t&&(Fm(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),Xk(n))}function Kk(n,e,t){for(const r of t)r instanceof JQ?(n.ac.addReference(r.key,e),oye(n,r)):r instanceof eJ?(Ue("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,e),n.ac.containsKey(r.key)||sJ(n,r.key)):bt()}function oye(n,e){const t=e.key,r=t.path.canonicalString();n.uc.get(t)||n.oc.has(r)||(Ue("SyncEngine","New document in limbo: "+t),n.oc.add(r),Xk(n))}function Xk(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new lt(p1.fromString(e)),r=n.fc.next();n.cc.set(r,new XCe(t)),n.uc=n.uc.insert(t,r),wS(n.remoteStore,new f8(ko(wh(t.path)),r,2,fa.at))}}function d6(n,e,t){return Qk.apply(this,arguments)}function Qk(){return Qk=I(function*(n,e,t){const r=ht(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,e,t).then(h=>{if((h||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const g=rk.Ci(u.targetId,h);i.push(g)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=I(function*(u,h){const g=ht(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Me.forEach(h,M=>Me.forEach(M.Si,b=>g.persistence.referenceDelegate.addReference(m,M.targetId,b)).next(()=>Me.forEach(M.Di,b=>g.persistence.referenceDelegate.removeReference(m,M.targetId,b)))))}catch(m){if(!i8(m))throw m;Ue("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const M=m.targetId;if(!m.fromCache){const b=g.Ui.get(M),G=b.withLastLimboFreeSnapshotVersion(b.snapshotVersion);g.Ui=g.Ui.insert(M,G)}}}),function(u,h){return c.apply(this,arguments)})(r.localStore,i))}),Qk.apply(this,arguments)}function aye(n,e){return Jk.apply(this,arguments)}function Jk(){return Jk=I(function*(n,e){const t=ht(n);if(!t.currentUser.isEqual(e)){Ue("SyncEngine","User change. New user:",e.toKey());const r=yield xQ(t.localStore,e);t.currentUser=e,(s=t).lc.forEach(o=>{o.forEach(c=>{c.reject(new Be(we.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield d6(t,r.ji)}var s}),Jk.apply(this,arguments)}function cye(n,e){const t=ht(n),r=t.cc.get(e);if(r&&r.nc)return xn().add(r.key);{let s=xn();const i=t.rc.get(e);if(!i)return s;for(const o of i){const c=t.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function aL(n){const e=ht(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=nJ.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=cye.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nye.bind(null,e),e.sc.Wo=WCe.bind(null,e.eventManager),e.sc.wc=jCe.bind(null,e.eventManager),e}function cL(n){const e=ht(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=rye.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=sye.bind(null,e),e}class _ye{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return I(function*(){t.It=Hm(e.databaseInfo.databaseId),t.sharedClientState=t.gc(e),t.persistence=t.yc(e),yield t.persistence.start(),t.localStore=t.Ic(e),t.gcScheduler=t.Tc(e,t.localStore),t.indexBackfillerScheduler=t.Ec(e,t.localStore)})()}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return function IQ(n,e,t,r){return new CCe(n,e,t,r)}(this.persistence,new NQ,e.initialUser,this.It)}yc(e){return new OQ(yS.Bs,this.It)}gc(e){return new FQ}terminate(){var e=this;return I(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class lL{initialize(e,t){var r=this;return I(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>rJ(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=aye.bind(null,r.syncEngine),yield function Ak(n,e){return Nk.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new qCe}createDatastore(e){const t=Hm(e.databaseInfo.databaseId),r=new OCe(e.databaseInfo);return new ICe(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,s=e.asyncQueue,i=c=>rJ(this.syncEngine,c,0),o=BQ.C()?new BQ:new TCe,new LCe(t,r,s,i,o);var t,r,s,i,o}createSyncEngine(e,t){return function(r,s,i,o,c,u,h){const g=new QCe(r,s,i,o,c,u);return h&&(g.dc=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=I(function*(t){const r=ht(t);Ue("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield Hh(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function uL(n,e,t){if(!t)throw new Be(we.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function aJ(n){if(!lt.isDocumentKey(n))throw new Be(we.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cJ(n){if(lt.isDocumentKey(n))throw new Be(we.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function OS(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":bt()}function l1(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Be(we.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=OS(n);throw new Be(we.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}const uJ=new Map;class fJ{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Be(we.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Be(we.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function yye(n,e,t,r){if(!0===e&&!0===r)throw new Be(we.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bm{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fJ({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Be(we.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Be(we.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fJ(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new O_e;switch(t.type){case"gapi":return new x_e(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Be(we.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=uJ.get(e);t&&(Ue("ComponentProvider","Removing Datastore"),uJ.delete(e),t.terminate())}(this),Promise.resolve()}}function hJ(n,e,t,r={}){var s;const i=(n=l1(n,Bm))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==e&&Eh("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=Hi.MOCK_USER;else{o=function uge(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[_M(JSON.stringify({alg:"none",type:"JWT"})),_M(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Be(we.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Hi(u)}n._authCredentials=new A_e(new UK(o,c))}}class Ps{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new G4(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ps(this.firestore,e,this._key)}}class J2{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new J2(this.firestore,e,this._query)}}class G4 extends J2{constructor(e,t,r){super(e,t,wh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ps(this.firestore,null,new lt(e))}withConverter(e){return new G4(this.firestore,e,this._path)}}function Eye(n,e,...t){if(n=jr(n),uL("collection","path",e),n instanceof Bm){const r=p1.fromString(e,...t);return cJ(r),new G4(n,null,r)}{if(!(n instanceof Ps||n instanceof G4))throw new Be(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(p1.fromString(e,...t));return cJ(r),new G4(n.firestore,null,r)}}function dJ(n,e,...t){if(n=jr(n),1===arguments.length&&(e=WK.R()),uL("doc","path",e),n instanceof Bm){const r=p1.fromString(e,...t);return aJ(r),new Ps(n,null,new lt(r))}{if(!(n instanceof Ps||n instanceof G4))throw new Be(we.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(p1.fromString(e,...t));return aJ(r),new Ps(n.firestore,n instanceof G4?n.converter:null,new lt(r))}}class AS{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Ms("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class bye{constructor(e,t,r,s){var i=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Hi.UNAUTHENTICATED,this.clientId=WK.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=I(function*(c){Ue("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(Ue("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var e=this;return I(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Be(we.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(I(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const s=Bh(r,"Failed to shutdown persistence");t.reject(s)}})),t.promise}}function mJ(n,e){return fL.apply(this,arguments)}function fL(){return fL=I(function*(n,e){n.asyncQueue.verifyOperationInProgress(),Ue("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var s=I(function*(i){r.isEqual(i)||(yield xQ(e.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),fL.apply(this,arguments)}function _J(n,e){return hL.apply(this,arguments)}function hL(){return hL=I(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield dL(n);Ue("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(s=>YQ(e.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>YQ(e.remoteStore,i)),n.onlineComponents=e}),hL.apply(this,arguments)}function dL(n){return pL.apply(this,arguments)}function pL(){return pL=I(function*(n){return n.offlineComponents||(Ue("FirestoreClient","Using default OfflineComponentProvider"),yield mJ(n,new _ye)),n.offlineComponents}),pL.apply(this,arguments)}function NS(n){return gL.apply(this,arguments)}function gL(){return gL=I(function*(n){return n.onlineComponents||(Ue("FirestoreClient","Using default OnlineComponentProvider"),yield _J(n,new lL)),n.onlineComponents}),gL.apply(this,arguments)}function qh(n){return vL.apply(this,arguments)}function vL(){return vL=I(function*(n){const e=yield NS(n),t=e.eventManager;return t.onListen=JCe.bind(null,e.syncEngine),t.onUnlisten=eye.bind(null,e.syncEngine),t}),vL.apply(this,arguments)}class Rye{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new hk(this,"async_queue_retry"),this.Wc=()=>{const t=TS();t&&Ue("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const e=TS();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;const t=TS();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.Uc)return new Promise(()=>{});const t=new ci;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}Jc(){var e=this;return I(function*(){if(0!==e.Lc.length){try{yield e.Lc[0](),e.Lc.shift(),e.xo.reset()}catch(t){if(!i8(t))throw t;Ue("AsyncQueue","Operation failed with retryable error: "+t)}e.Lc.length>0&&e.xo.Ro(()=>e.Jc())}})()}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(r=>{throw this.Kc=r,this.Gc=!1,Ms("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=t,t}enqueueAfterDelay(e,t,r){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const s=Ik.createAndSchedule(this,e,t,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&bt()}verifyOperationInProgress(){}Xc(){var e=this;return I(function*(){let t;do{t=e.Bc,yield t}while(t!==e.Bc)})()}Zc(e){for(const t of this.qc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.qc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.qc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.qc.indexOf(e);this.qc.splice(t,1)}}function CL(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Mr extends Bm{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new Rye,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||MJ(this),this._firestoreClient.terminate()}}function zye(n,e){const r="string"==typeof n?n:e||"(default)",s=ph("object"==typeof n?n:DI(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const e=uY("firestore");if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),r]:[e.substring(0,t),r]})();i&&hJ(s,...i)}return s}function Gs(n){return n._firestoreClient||MJ(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function MJ(n){var e;const t=n._freezeSettings(),r=(i=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new U_e(n._databaseId,i,n._persistenceKey,(c=t).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new bye(n._authCredentials,n._appCheckCredentials,n._queue,r)}class D5{constructor(e){this._byteString=e}static fromBase64String(e){try{return new D5(li.fromBase64String(e))}catch(t){throw new Be(we.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new D5(li.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Wh{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Be(we.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ss(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class xS{constructor(e){this._methodName=e}}class yL{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Be(we.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Be(we.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Sn(this._lat,e._lat)||Sn(this._long,e._long)}}const Hye=/^__.*__$/;class Vye{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new f6(e,this.data,this.fieldMask,t,this.fieldTransforms):new Nh(e,this.data,t,this.fieldTransforms)}}class TJ{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new f6(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wJ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw bt()}}class kS{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new kS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.ia({path:r,oa:!1});return s.ua(e),s}ca(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.ia({path:r,oa:!1});return s.na(),s}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return RS(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(wJ(this.sa)&&Hye.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class Fye{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=r||Hm(e)}da(e,t,r,s=!1){return new kS({sa:e,methodName:t,fa:r,path:Ss.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function jh(n){const e=n._freezeSettings(),t=Hm(n._databaseId);return new Fye(n._databaseId,!!e.ignoreUndefinedProperties,t)}function EL(n,e,t,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,e,t,s);SL("Data must be an object, but it was:",o,r);const c=IJ(r,o);let u,h;if(i.merge)u=new ja(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const g=[];for(const m of i.mergeFields){const M=PL(e,m,t);if(!o.contains(M))throw new Be(we.INVALID_ARGUMENT,`Field '${M}' is specified in your field mask but missing from your input data.`);kJ(g,M)||g.push(M)}u=new ja(g),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new Vye(new w2(c),u,h)}class $m extends xS{_toFieldTransform(e){if(2!==e.sa)throw e.ha(1===e.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof $m}}class ML extends xS{_toFieldTransform(e){return new ym(e.path,new Oh)}isEqual(e){return e instanceof ML}}function z5(n,e){if(xJ(n=jr(n)))return SL("Unsupported field value:",e,n),IJ(n,e);if(n instanceof xS)return function(t,r){if(!wJ(r.sa))throw r.ha(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${t._methodName}() is not currently supported inside arrays`);const s=t._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,r){const s=[];let i=0;for(const o of t){let c=z5(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,e)}return function(t,r){if(null===(t=jr(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return SX(r.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const s=Zr.fromDate(t);return{timestampValue:wm(r.It,s)}}if(t instanceof Zr){const s=new Zr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:wm(r.It,s)}}if(t instanceof yL)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof D5)return{bytesValue:UX(r.It,t._byteString)};if(t instanceof Ps){const s=r.databaseId,i=t.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:$x(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.ha(`Unsupported field value: ${OS(t)}`)}(n,e)}function IJ(n,e){const t={};return JK(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):y5(n,(r,s)=>{const i=z5(s,e.ra(r));null!=i&&(t[r]=i)}),{mapValue:{fields:t}}}function xJ(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Zr||n instanceof yL||n instanceof D5||n instanceof Ps||n instanceof xS)}function SL(n,e,t){if(!xJ(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=OS(t);throw e.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function PL(n,e,t){if((e=jr(e))instanceof Wh)return e._internalPath;if("string"==typeof e)return LS(n,e);throw RS("Field path arguments must be of type string or ",n,!1,void 0,t)}const Uye=new RegExp("[~\\*/\\[\\]]");function LS(n,e,t){if(e.search(Uye)>=0)throw RS(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Wh(...e.split("."))._internalPath}catch{throw RS(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function RS(n,e,t,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Be(we.INVALID_ARGUMENT,c+n+u)}function kJ(n,e){return n.some(t=>t.isEqual(e))}class TL{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ps(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new qye(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(DS("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class qye extends TL{data(){return super.data()}}function DS(n,e){return"string"==typeof e?LS(n,e):e instanceof Wh?e._internalPath:e._delegate._internalPath}function LJ(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Be(we.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wL{}function Wye(n,...e){for(const t of e)n=t._apply(n);return n}class jye extends wL{constructor(e,t,r){super(),this.ma=e,this.ga=t,this.ya=r,this.type="where"}_apply(e){const t=jh(e.firestore),r=function(s,i,o,c,u,h,g){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new Be(we.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){FJ(g,h);const b=[];for(const L of g)b.push(VJ(c,s,L));m={arrayValue:{values:b}}}else m=VJ(c,s,g)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||FJ(g,h),m=function NJ(n,e,t,r=!1){return z5(t,n.da(r?4:3,e))}(o,"where",g,"in"===h||"not-in"===h);const M=b2.create(u,h,m);return function(b,L){if(L.dt()){const j=zx(b);if(null!==j&&!j.isEqual(L.field))throw new Be(we.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${j.toString()}' and '${L.field.toString()}'`);const ie=Dx(b);null!==ie&&BJ(0,L.field,ie)}const G=function(j,ie){for(const ye of j.filters)if(ie.indexOf(ye.op)>=0)return ye.op;return null}(b,function(j){switch(j){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(L.op));if(null!==G)throw new Be(we.INVALID_ARGUMENT,G===L.op?`Invalid query. You cannot use more than one '${L.op.toString()}' filter.`:`Invalid query. You cannot use '${L.op.toString()}' filters with '${G.toString()}' filters.`)}(s,M),M}(e._query,0,t,e.firestore._databaseId,this.ma,this.ga,this.ya);return new J2(e.firestore,e.converter,function(s,i){const o=s.filters.concat([i]);return new u6(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function Zye(n,e,t){const r=e,s=DS("where",n);return new jye(s,r,t)}class Yye extends wL{constructor(e,t){super(),this.ma=e,this.pa=t,this.type="orderBy"}_apply(e){const t=function(r,s,i){if(null!==r.startAt)throw new Be(we.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Be(we.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Th(s,i);return function(c,u){if(null===Dx(c)){const h=zx(c);null!==h&&BJ(0,h,u.field)}}(r,o),o}(e._query,this.ma,this.pa);return new J2(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new u6(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}function Kye(n,e="asc"){const t=e,r=DS("orderBy",n);return new Yye(r,t)}class RJ extends wL{constructor(e,t,r){super(),this.type=e,this.Ia=t,this.Ta=r}_apply(e){return new J2(e.firestore,e.converter,oS(e._query,this.Ia,this.Ta))}}function Xye(n){return function lJ(n,e){if(e<=0)throw new Be(we.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}("limit",n),new RJ("limit",n,"F")}function VJ(n,e,t){if("string"==typeof(t=jr(t))){if(""===t)throw new Be(we.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Hx(e)&&-1!==t.indexOf("/"))throw new Be(we.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(p1.fromString(t));if(!lt.isDocumentKey(r))throw new Be(we.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return P5(n,new lt(r))}if(t instanceof Ps)return P5(n,t._key);throw new Be(we.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${OS(t)}.`)}function FJ(n,e){if(!Array.isArray(n)||0===n.length)throw new Be(we.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Be(we.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function BJ(n,e,t){if(!t.isEqual(e))throw new Be(we.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}function bL(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class H5{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zh extends TL{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new zS(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(DS("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class zS extends Zh{data(e={}){return super.data(e)}}class Yh{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new H5(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new zS(this._firestore,this._userDataWriter,r.key,r,new H5(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Be(we.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new zS(r._firestore,r._userDataWriter,o.doc.key,o.doc,new H5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new zS(r._firestore,r._userDataWriter,o.doc.key,o.doc,new H5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:Jye(o.type),doc:c,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Jye(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return bt()}}function eEe(n){n=l1(n,Ps);const e=l1(n.firestore,Mr);return function yJ(n,e,t={}){const r=new ci;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const h=new AS({next:m=>{i.enqueueAndForget(()=>Lk(s,g));const M=m.docs.has(o);!M&&m.fromCache?u.reject(new Be(we.UNAVAILABLE,"Failed to get document because the client is offline.")):M&&m.fromCache&&c&&"server"===c.source?u.reject(new Be(we.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new zk(wh(o.path),h,{includeMetadataChanges:!0,Nu:!0});return xk(s,g)}(yield qh(n),n.asyncQueue,e,t,r)})),r.promise}(Gs(e),n._key).then(t=>OL(e,n,t))}class g8 extends class Qye{convertValue(e,t="none"){switch(S5(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cs(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(E5(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw bt()}}convertObject(e,t){const r={};return y5(e.fields,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertGeoPoint(e){return new yL(cs(e.latitude),cs(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=tX(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(hm(e));default:return null}}convertTimestamp(e){const t=o8(e);return new Zr(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=p1.fromString(e);an(JX(r));const s=new M5(r.get(1),r.get(3)),i=new lt(r.popFirst(5));return s.isEqual(t)||Ms(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}{constructor(e){super(),this.firestore=e}convertBytes(e){return new D5(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ps(this.firestore,null,t)}}function tEe(n){n=l1(n,J2);const e=l1(n.firestore,Mr),t=Gs(e),r=new g8(e);return LJ(n._query),function EJ(n,e,t={}){const r=new ci;return n.asyncQueue.enqueueAndForget(I(function*(){return function(s,i,o,c,u){const h=new AS({next:m=>{i.enqueueAndForget(()=>Lk(s,g)),m.fromCache&&"server"===c.source?u.reject(new Be(we.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),g=new zk(o,h,{includeMetadataChanges:!0,Nu:!0});return xk(s,g)}(yield qh(n),n.asyncQueue,e,t,r)})),r.promise}(t,n._query).then(s=>new Yh(e,r,n,s))}function nEe(n,e,t){n=l1(n,Ps);const r=l1(n.firestore,Mr),s=bL(n.converter,e,t);return Gm(r,[EL(jh(r),"setDoc",n._key,s,null!==n.converter,t).toMutation(n._key,Dr.none())])}function rEe(n,e,t,...r){n=l1(n,Ps);const s=l1(n.firestore,Mr),i=jh(s);let o;return o="string"==typeof(e=jr(e))||e instanceof Wh?function AJ(n,e,t,r,s,i){const o=n.da(1,e,t),c=[PL(e,r,t)],u=[s];if(i.length%2!=0)throw new Be(we.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let M=0;M<i.length;M+=2)c.push(PL(e,i[M])),u.push(i[M+1]);const h=[],g=w2.empty();for(let M=c.length-1;M>=0;--M)if(!kJ(h,c[M])){const b=c[M];let L=u[M];L=jr(L);const G=o.ca(b);if(L instanceof $m)h.push(b);else{const j=z5(L,G);null!=j&&(h.push(b),g.set(b,j))}}const m=new ja(h);return new TJ(g,m,o.fieldTransforms)}(i,"updateDoc",n._key,e,t,r):function OJ(n,e,t,r){const s=n.da(1,e,t);SL("Data must be an object, but it was:",s,r);const i=[],o=w2.empty();y5(r,(u,h)=>{const g=LS(e,u,t);h=jr(h);const m=s.ca(g);if(h instanceof $m)i.push(g);else{const M=z5(h,m);null!=M&&(i.push(g),o.set(g,M))}});const c=new ja(i);return new TJ(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,e),Gm(s,[o.toMutation(n._key,Dr.exists(!0))])}function sEe(n){return Gm(l1(n.firestore,Mr),[new Ih(n._key,Dr.none())])}function iEe(n,e){const t=l1(n.firestore,Mr),r=dJ(n),s=bL(n.converter,e);return Gm(t,[EL(jh(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,Dr.exists(!1))]).then(()=>r)}function oEe(n,...e){var t,r,s;n=jr(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||CL(e[o])||(i=e[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(CL(e[o])){const m=e[o];e[o]=null===(t=m.next)||void 0===t?void 0:t.bind(m),e[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),e[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,h,g;if(n instanceof Ps)h=l1(n.firestore,Mr),g=wh(n._key.path),u={next:m=>{e[o]&&e[o](OL(h,n,m))},error:e[o+1],complete:e[o+2]};else{const m=l1(n,J2);h=l1(m.firestore,Mr),g=m._query;const M=new g8(h);u={next:b=>{e[o]&&e[o](new Yh(h,M,m,b))},error:e[o+1],complete:e[o+2]},LJ(n._query)}return function(m,M,b,L){const G=new AS(L),j=new zk(M,G,b);return m.asyncQueue.enqueueAndForget(I(function*(){return xk(yield qh(m),j)})),()=>{G.bc(),m.asyncQueue.enqueueAndForget(I(function*(){return Lk(yield qh(m),j)}))}}(Gs(h),g,c,u)}function Gm(n,e){return function(t,r){const s=new ci;return t.asyncQueue.enqueueAndForget(I(function*(){return function tye(n,e,t){return $k.apply(this,arguments)}(yield function _L(n){return NS(n).then(e=>e.syncEngine)}(t),r,s)})),s.promise}(Gs(n),e)}function OL(n,e,t){const r=t.docs.get(e._key),s=new g8(n);return new Zh(n,s,e._key,r,new H5(t.hasPendingWrites,t.fromCache),e.converter)}function U4(){return new ML("serverTimestamp")}function GJ(n,e){if(null!=n&&null!=e&&"object"==typeof n){if(null!=n.equals)return n.equals(e);{const t=n,r=e;for(const s of Object.keys(t)){if(!(s in r))return!1;if(!1===GJ(t[s],r[s]))return!1}return!0}}return n===e}function AL(n){return null==n||function uEe(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function EOe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function fEe(n){if("object"==typeof n){for(const e in n)if(null!=n[e]&&!1===AL(n[e]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function Ac(n,e){if(AL(n)&&AL(e))return GJ(n,e);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${e.constructor.name}`)}!function(n,e=!0){yh="9.14.0",Io(new K2("firestore",(t,{instanceIdentifier:r,options:s})=>{const i=t.getProvider("app").getImmediate(),o=new Mr(new N_e(t.getProvider("auth-internal")),new k_e(t.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Be(we.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new M5(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),is(GK,"3.7.3",n),is(GK,"3.7.3","esm2017")}();class Ye{static fromFunctions(e,t){return new class extends Ye{encode(r){return e(r)}decode(r){return t(r)}}}static identity(){function e(t){return t}return Ye.fromFunctions(e,e)}static constant(e,t){return new class extends Ye{encode(r){return e}decode(r){return t}}}static tuple(e,t,r){return new class extends Ye{encode(s){const i=t(s),o={};return Object.keys(i).forEach(c=>{o[c]=e[c].encode(i[c])}),o}decode(s){const i={};return Object.keys(e).reverse().forEach(o=>{i[o]=e[o].decode(s[o])}),r(Object.values(i))}}}static disjunction(e,t){return pe.assert(e.length===t.length,"typePredicates and encoders should have same length"),new class extends Ye{encode(r){let s=0;for(const i of e){if(!0===i(r))return{type:s,encoded:t[s].encode(r)};s++}}decode(r){const s=pe.getNonNullable(r).type,i=pe.getNonNullable(r).encoded;return t[s].decode(i)}}}static list(e){return new class extends Ye{encode(t){return t.map(r=>{const s=e.encode(r);return pe.assert(!1===Array.isArray(s),"This encoder should not encode as array"),s})}decode(t){return t.map(e.decode)}}}}class y{constructor(e){this.value=e}static of(e){return new y(e)}static ofNullable(e){return null==e?y.empty():y.of(e)}static empty(){return new y(null)}static getEncoder(e){return new class extends Ye{encode(t){return t.isPresent()?e.encode(t.get()):null}decode(t){return null===t?y.empty():y.of(e.decode(t))}}}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(e){return this.isPresent()?this.value:e}equals(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&Ac(this.value,e.value)}equalsValue(e){return this.equals(y.of(e))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(e){return this.isPresent()?y.of(e(this.get())):y.empty()}}class _e{static success(e){return new hEe(e)}static failure(e){return new dEe(e)}constructor(){}equals(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&Ac(this.get(),e.get())}}class hEe extends _e{constructor(e){super(),this.value=e}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(e){return e}toOptional(){return y.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class dEe extends _e{constructor(e){super(),this.reason=e}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(e){return this.getReason()}toOptional(){return y.empty()}toString(){return`MGPFallible.failure(${this.reason})`}toOtherFallible(){return _e.failure(this.reason)}}var R;!function(n){n.SUCCESS=_e.success(void 0),n.ofFallible=function e(r){return r.isSuccess()?n.SUCCESS:n.failure(r.getReason())},n.failure=function t(r){return _e.failure(r)}}(R||(R={})),is("firebase","9.14.0","app");const UJ="@firebase/installations",NL="0.5.16",WJ=`w:${NL}`,jJ="FIS_v2",p6=new z4("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ZJ(n){return n instanceof Oc&&n.code.includes("request-failed")}function IL({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function YJ(n){return{token:n.token,requestStatus:2,expiresIn:EEe(n.expiresIn),creationTime:Date.now()}}function xL(n,e){return kL.apply(this,arguments)}function kL(){return kL=I(function*(n,e){const r=(yield e.json()).error;return p6.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),kL.apply(this,arguments)}function KJ({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function XJ(n,{refreshToken:e}){const t=KJ(n);return t.append("Authorization",function MEe(n){return`${jJ} ${n}`}(e)),t}function LL(n){return RL.apply(this,arguments)}function RL(){return RL=I(function*(n){const e=yield n();return e.status>=500&&e.status<600?n():e}),RL.apply(this,arguments)}function EEe(n){return Number(n.replace("s","000"))}function SEe(n,e){return DL.apply(this,arguments)}function DL(){return DL=I(function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=IL(n),s=KJ(n),i=e.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({fid:t,authVersion:jJ,appId:n.appId,sdkVersion:WJ})},u=yield LL(()=>fetch(r,c));if(u.ok){const h=yield u.json();return{fid:h.fid||t,registrationStatus:2,refreshToken:h.refreshToken,authToken:YJ(h.authToken)}}throw yield xL("Create Installation",u)}),DL.apply(this,arguments)}function QJ(n){return new Promise(e=>{setTimeout(e,n)})}const TEe=/^[cdef][\w-]{21}$/;function wEe(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=function bEe(n){return function PEe(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return TEe.test(t)?t:""}catch{return""}}function Kh(n){return`${n.appName}!${n.appId}`}const Xh=new Map;function JJ(n,e){const t=Kh(n);eee(t,e),function NEe(n,e){const t=function tee(){return!V5&&"BroadcastChannel"in self&&(V5=new BroadcastChannel("[Firebase] FID Change"),V5.onmessage=n=>{eee(n.data.key,n.data.fid)}),V5}();t&&t.postMessage({key:n,fid:e}),function nee(){0===Xh.size&&V5&&(V5.close(),V5=null)}()}(t,e)}function eee(n,e){const t=Xh.get(n);if(t)for(const r of t)r(e)}let V5=null;const F5="firebase-installations-store";let HL=null;function VL(){return HL||(HL=MM("firebase-installations-database",1,{upgrade:(n,e)=>{0===e&&n.createObjectStore(F5)}})),HL}function VS(n,e){return FL.apply(this,arguments)}function FL(){return FL=I(function*(n,e){const t=Kh(n),s=(yield VL()).transaction(F5,"readwrite"),i=s.objectStore(F5),o=yield i.get(t);return yield i.put(e,t),yield s.done,(!o||o.fid!==e.fid)&&JJ(n,e.fid),e}),FL.apply(this,arguments)}function BL(n){return $L.apply(this,arguments)}function $L(){return $L=I(function*(n){const e=Kh(n),r=(yield VL()).transaction(F5,"readwrite");yield r.objectStore(F5).delete(e),yield r.done}),$L.apply(this,arguments)}function Um(n,e){return GL.apply(this,arguments)}function GL(){return GL=I(function*(n,e){const t=Kh(n),s=(yield VL()).transaction(F5,"readwrite"),i=s.objectStore(F5),o=yield i.get(t),c=e(o);return void 0===c?yield i.delete(t):yield i.put(c,t),yield s.done,c&&(!o||o.fid!==c.fid)&&JJ(n,c.fid),c}),GL.apply(this,arguments)}function UL(n){return qL.apply(this,arguments)}function qL(){return qL=I(function*(n){let e;const t=yield Um(n.appConfig,r=>{const s=kEe(r),i=LEe(n,s);return e=i.registrationPromise,i.installationEntry});return""===t.fid?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),qL.apply(this,arguments)}function kEe(n){return see(n||{fid:wEe(),registrationStatus:0})}function LEe(n,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(p6.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=function REe(n,e){return WL.apply(this,arguments)}(n,t);return{installationEntry:t,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:DEe(n)}:{installationEntry:e}}function WL(){return WL=I(function*(n,e){try{const t=yield SEe(n,e);return VS(n.appConfig,t)}catch(t){throw ZJ(t)&&409===t.customData.serverCode?yield BL(n.appConfig):yield VS(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}),WL.apply(this,arguments)}function DEe(n){return jL.apply(this,arguments)}function jL(){return jL=I(function*(n){let e=yield ree(n.appConfig);for(;1===e.registrationStatus;)yield QJ(100),e=yield ree(n.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:r}=yield UL(n);return r||t}return e}),jL.apply(this,arguments)}function ree(n){return Um(n,e=>{if(!e)throw p6.create("installation-not-found");return see(e)})}function see(n){return function zEe(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function HEe(n,e){return ZL.apply(this,arguments)}function ZL(){return ZL=I(function*({appConfig:n,heartbeatServiceProvider:e},t){const r=VEe(n,t),s=XJ(n,t),i=e.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:WJ,appId:n.appId}})},u=yield LL(()=>fetch(r,c));if(u.ok)return YJ(yield u.json());throw yield xL("Generate Auth Token",u)}),ZL.apply(this,arguments)}function VEe(n,{fid:e}){return`${IL(n)}/${e}/authTokens:generate`}function YL(n){return KL.apply(this,arguments)}function KL(){return KL=I(function*(n,e=!1){let t;const r=yield Um(n.appConfig,i=>{if(!oee(i))throw p6.create("not-registered");const o=i.authToken;if(!e&&$Ee(o))return i;if(1===o.requestStatus)return t=FEe(n,e),i;{if(!navigator.onLine)throw p6.create("app-offline");const c=UEe(i);return t=BEe(n,c),c}});return t?yield t:r.authToken}),KL.apply(this,arguments)}function FEe(n,e){return XL.apply(this,arguments)}function XL(){return XL=I(function*(n,e){let t=yield iee(n.appConfig);for(;1===t.authToken.requestStatus;)yield QJ(100),t=yield iee(n.appConfig);const r=t.authToken;return 0===r.requestStatus?YL(n,e):r}),XL.apply(this,arguments)}function iee(n){return Um(n,e=>{if(!oee(e))throw p6.create("not-registered");return function qEe(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function BEe(n,e){return QL.apply(this,arguments)}function QL(){return QL=I(function*(n,e){try{const t=yield HEe(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return yield VS(n.appConfig,r),t}catch(t){if(!ZJ(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield VS(n.appConfig,r)}else yield BL(n.appConfig);throw t}}),QL.apply(this,arguments)}function oee(n){return void 0!==n&&2===n.registrationStatus}function $Ee(n){return 2===n.requestStatus&&!function GEe(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+36e5}(n)}function UEe(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function JL(){return JL=I(function*(n){const e=n,{installationEntry:t,registrationPromise:r}=yield UL(e);return r?r.catch(console.error):YL(e).catch(console.error),t.fid}),JL.apply(this,arguments)}function eR(){return eR=I(function*(n,e=!1){const t=n;return yield ZEe(t),(yield YL(t,e)).token}),eR.apply(this,arguments)}function ZEe(n){return tR.apply(this,arguments)}function tR(){return tR=I(function*(n){const{registrationPromise:e}=yield UL(n);e&&(yield e)}),tR.apply(this,arguments)}function sR(n){return p6.create("missing-app-config-values",{valueName:n})}const aee="installations",JEe=n=>{const e=n.getProvider("app").getImmediate(),t=function XEe(n){if(!n||!n.options)throw sR("App Configuration");if(!n.name)throw sR("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw sR(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:ph(e,"heartbeat"),_delete:()=>Promise.resolve()}},eMe=n=>{const t=ph(n.getProvider("app").getImmediate(),aee).getImmediate();return{getId:()=>function WEe(n){return JL.apply(this,arguments)}(t),getToken:s=>function jEe(n){return eR.apply(this,arguments)}(t,s)}};(function tMe(){Io(new K2(aee,JEe,"PUBLIC")),Io(new K2("installations-internal",eMe,"PRIVATE"))})(),is(UJ,NL),is(UJ,NL,"esm2017");const iR="@firebase/remote-config",pa=new z4("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class hMe{constructor(e,t,r,s){this.client=e,this.storage=t,this.storageCache=r,this.logger=s}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-t,s=r<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${s}.`),s}fetch(e){var t=this;return I(function*(){const[r,s]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(s&&t.isCachedDataFresh(e.cacheMaxAgeMillis,r))return s;e.eTag=s&&s.eTag;const i=yield t.client.fetch(e),o=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(t.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function dMe(n=navigator){return n.languages&&n.languages[0]||n.language}class pMe{constructor(e,t,r,s,i,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(e){var t=this;return I(function*(){var r,s,i;const[o,c]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),h=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,g={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},m={sdk_version:t.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:t.appId,language_code:dMe()},M={method:"POST",headers:g,body:JSON.stringify(m)},b=fetch(h,M),L=new Promise((xe,$e)=>{e.signal.addEventListener(()=>{const et=new Error("The operation was aborted.");et.name="AbortError",$e(et)})});let G;try{yield Promise.race([b,L]),G=yield b}catch(xe){let $e="fetch-client-network";throw"AbortError"===(null===(r=xe)||void 0===r?void 0:r.name)&&($e="fetch-timeout"),pa.create($e,{originalErrorMessage:null===(s=xe)||void 0===s?void 0:s.message})}let j=G.status;const ie=G.headers.get("ETag")||void 0;let ye,te;if(200===G.status){let xe;try{xe=yield G.json()}catch($e){throw pa.create("fetch-client-parse",{originalErrorMessage:null===(i=$e)||void 0===i?void 0:i.message})}ye=xe.entries,te=xe.state}if("INSTANCE_STATE_UNSPECIFIED"===te?j=500:"NO_CHANGE"===te?j=304:("NO_TEMPLATE"===te||"EMPTY_CONFIG"===te)&&(ye={}),304!==j&&200!==j)throw pa.create("fetch-status",{httpStatus:j});return{status:j,eTag:ie,config:ye}})()}}class _Me{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return I(function*(){const r=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,r)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:r}){var s=this;return I(function*(){yield function gMe(n,e){return new Promise((t,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(i),r(pa.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const i=yield s.client.fetch(e);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function mMe(n){if(!(n instanceof Oc&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i))throw i;const o={throttleEndTimeMillis:Date.now()+wI(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(e,o)}})()}}class yMe{constructor(e,t,r,s,i){this.app=e,this._client=t,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function BS(n,e){var t;const r=n.target.error||void 0;return pa.create(e,{originalErrorMessage:r&&(null===(t=r)||void 0===t?void 0:t.message)})}const B5="app_namespace_store";class PMe{constructor(e,t,r,s=function SMe(){return new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{e(BS(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(B5,{keyPath:"compositeKey"})}}catch(r){e(pa.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}})}()){this.appId=e,this.appName=t,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return I(function*(){const r=yield t.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([B5],"readonly").objectStore(B5),h=t.createCompositeKey(e);try{const g=u.get(h);g.onerror=m=>{i(BS(m,"storage-get"))},g.onsuccess=m=>{const M=m.target.result;s(M?M.value:void 0)}}catch(g){i(pa.create("storage-get",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}set(e,t){var r=this;return I(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const h=s.transaction([B5],"readwrite").objectStore(B5),g=r.createCompositeKey(e);try{const m=h.put({compositeKey:g,value:t});m.onerror=M=>{o(BS(M,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(pa.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(e){var t=this;return I(function*(){const r=yield t.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([B5],"readwrite").objectStore(B5),h=t.createCompositeKey(e);try{const g=u.delete(h);g.onerror=m=>{i(BS(m,"storage-delete"))},g.onsuccess=()=>{s()}}catch(g){i(pa.create("storage-delete",{originalErrorMessage:null===(o=g)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class TMe{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return I(function*(){const t=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),s=e.storage.getActiveConfig(),i=yield t;i&&(e.lastFetchStatus=i);const o=yield r;o&&(e.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(e.activeConfig=c)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function bMe(){return uR.apply(this,arguments)}function uR(){return(uR=I(function*(){if(!u5())return!1;try{return yield Fg()}catch{return!1}})).apply(this,arguments)}!function wMe(){Io(new K2("remote-config",function n(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw pa.create("registration-window");if(!u5())throw pa.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw pa.create("registration-project-id");if(!o)throw pa.create("registration-api-key");if(!c)throw pa.create("registration-app-id");const u=new PMe(c,r.name,t=t||"firebase"),h=new TMe(u),g=new dh(iR);g.logLevel=d1.ERROR;const m=new pMe(s,gh,t,i,o,c),M=new _Me(m,u),b=new hMe(M,u,h,g),L=new yMe(r,b,h,u,g);return function lMe(n){const e=jr(n);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(L),L},"PUBLIC").setMultipleInstances(!0)),is(iR,"0.3.15"),is(iR,"0.3.15","esm2017")}();const OMe="/firebase-messaging-sw.js",AMe="/firebase-cloud-messaging-push-scope",fee="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",hee="google.c.a.c_id",IMe="google.c.a.c_l",xMe="google.c.a.ts",kMe="google.c.a.e";var Qh=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(Qh||(Qh={})),Qh))();function g6(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function LMe(n){const t=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const fR="fcm_token_details_db",dee="fcm_token_object_Store";function DMe(n){return hR.apply(this,arguments)}function hR(){return hR=I(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(fR))return null;let e=null;return(yield MM(fR,5,{upgrade:(r=I(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(dee))return;const h=c.objectStore(dee),g=yield h.index("fcmSenderId").get(n);if(yield h.clear(),g)if(2===i){const m=g;if(!m.auth||!m.p256dh||!m.endpoint)return;e={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:g6(m.vapidKey)}}}else if(3===i){const m=g;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:g6(m.auth),p256dh:g6(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:g6(m.vapidKey)}}}else if(4===i){const m=g;e={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:g6(m.auth),p256dh:g6(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:g6(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield kI(fR),yield kI("fcm_vapid_details_db"),yield kI("undefined"),zMe(e)?e:null;var r}),hR.apply(this,arguments)}function zMe(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}const $5="firebase-messaging-store";let dR=null;function pR(){return dR||(dR=MM("firebase-messaging-database",1,{upgrade:(n,e)=>{0===e&&n.createObjectStore($5)}})),dR}function pee(n){return gR.apply(this,arguments)}function gR(){return gR=I(function*(n){const e=CR(n),r=yield(yield pR()).transaction($5).objectStore($5).get(e);if(r)return r;{const s=yield DMe(n.appConfig.senderId);if(s)return yield mR(n,s),s}}),gR.apply(this,arguments)}function mR(n,e){return _R.apply(this,arguments)}function _R(){return _R=I(function*(n,e){const t=CR(n),s=(yield pR()).transaction($5,"readwrite");return yield s.objectStore($5).put(e,t),yield s.done,e}),_R.apply(this,arguments)}function FMe(n){return vR.apply(this,arguments)}function vR(){return vR=I(function*(n){const e=CR(n),r=(yield pR()).transaction($5,"readwrite");yield r.objectStore($5).delete(e),yield r.done}),vR.apply(this,arguments)}function CR({appConfig:n}){return n.appId}const O2=new z4("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function $Me(n,e){return yR.apply(this,arguments)}function yR(){return yR=I(function*(n,e){var t;const r=yield PR(n),s=mee(e),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(SR(n.appConfig),i)).json()}catch(c){throw O2.create("token-subscribe-failed",{errorInfo:null===(t=c)||void 0===t?void 0:t.toString()})}if(o.error)throw O2.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw O2.create("token-subscribe-no-token");return o.token}),yR.apply(this,arguments)}function GMe(n,e){return ER.apply(this,arguments)}function ER(){return ER=I(function*(n,e){var t;const r=yield PR(n),s=mee(e.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${SR(n.appConfig)}/${e.token}`,i)).json()}catch(c){throw O2.create("token-update-failed",{errorInfo:null===(t=c)||void 0===t?void 0:t.toString()})}if(o.error)throw O2.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw O2.create("token-update-no-token");return o.token}),ER.apply(this,arguments)}function gee(n,e){return MR.apply(this,arguments)}function MR(){return MR=I(function*(n,e){var t;const s={method:"DELETE",headers:yield PR(n)};try{const o=yield(yield fetch(`${SR(n.appConfig)}/${e}`,s)).json();if(o.error)throw O2.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw O2.create("token-unsubscribe-failed",{errorInfo:null===(t=i)||void 0===t?void 0:t.toString()})}}),MR.apply(this,arguments)}function SR({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function PR(n){return TR.apply(this,arguments)}function TR(){return TR=I(function*({appConfig:n,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})}),TR.apply(this,arguments)}function mee({p256dh:n,auth:e,endpoint:t,vapidKey:r}){const s={web:{endpoint:t,auth:e,p256dh:n}};return r!==fee&&(s.web.applicationPubKey=r),s}function qMe(n){return wR.apply(this,arguments)}function wR(){return wR=I(function*(n){const e=yield jMe(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:g6(e.getKey("auth")),p256dh:g6(e.getKey("p256dh"))},r=yield pee(n.firebaseDependencies);if(r){if(ZMe(r.subscriptionOptions,t))return Date.now()>=r.createTime+6048e5?WMe(n,{token:r.token,createTime:Date.now(),subscriptionOptions:t}):r.token;try{yield gee(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return vee(n.firebaseDependencies,t)}return vee(n.firebaseDependencies,t)}),wR.apply(this,arguments)}function _ee(n){return bR.apply(this,arguments)}function bR(){return bR=I(function*(n){const e=yield pee(n.firebaseDependencies);e&&(yield gee(n.firebaseDependencies,e.token),yield FMe(n.firebaseDependencies));const t=yield n.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),bR.apply(this,arguments)}function WMe(n,e){return OR.apply(this,arguments)}function OR(){return OR=I(function*(n,e){try{const t=yield GMe(n.firebaseDependencies,e),r=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield mR(n.firebaseDependencies,r),t}catch(t){throw yield _ee(n),t}}),OR.apply(this,arguments)}function vee(n,e){return AR.apply(this,arguments)}function AR(){return AR=I(function*(n,e){const r={token:yield $Me(n,e),createTime:Date.now(),subscriptionOptions:e};return yield mR(n,r),r.token}),AR.apply(this,arguments)}function jMe(n,e){return NR.apply(this,arguments)}function NR(){return NR=I(function*(n,e){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:LMe(e)})}),NR.apply(this,arguments)}function ZMe(n,e){return e.vapidKey===n.vapidKey&&e.endpoint===n.endpoint&&e.auth===n.auth&&e.p256dh===n.p256dh}function Cee(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function YMe(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const r=e.notification.body;r&&(n.notification.body=r);const s=e.notification.image;s&&(n.notification.image=s);const i=e.notification.icon;i&&(n.notification.icon=i)}(e,n),function KMe(n,e){!e.data||(n.data=e.data)}(e,n),function XMe(n,e){var t,r,s,i,o;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=e.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=e.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=e.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(e,n),e}function QMe(n){return"object"==typeof n&&!!n&&hee in n}function yee(n,e){const t=[];for(let r=0;r<n.length;r++)t.push(n.charAt(r)),r<e.length&&t.push(e.charAt(r));return t.join("")}function IR(n){return O2.create("missing-app-config-values",{valueName:n})}yee("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),yee("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class eSe{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function JMe(n){if(!n||!n.options)throw IR("App Configuration Object");if(!n.name)throw IR("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const r of e)if(!t[r])throw IR(r);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:s,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}function Eee(n){return xR.apply(this,arguments)}function xR(){return xR=I(function*(n){var e;try{n.swRegistration=yield navigator.serviceWorker.register(OMe,{scope:AMe}),n.swRegistration.update().catch(()=>{})}catch(t){throw O2.create("failed-service-worker-registration",{browserErrorMessage:null===(e=t)||void 0===e?void 0:e.message})}}),xR.apply(this,arguments)}function tSe(n,e){return kR.apply(this,arguments)}function kR(){return kR=I(function*(n,e){if(!e&&!n.swRegistration&&(yield Eee(n)),e||!n.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw O2.create("invalid-sw-registration");n.swRegistration=e}}),kR.apply(this,arguments)}function nSe(n,e){return LR.apply(this,arguments)}function LR(){return LR=I(function*(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=fee)}),LR.apply(this,arguments)}function RR(){return RR=I(function*(n,e){if(!navigator)throw O2.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw O2.create("permission-blocked");return yield nSe(n,e?.vapidKey),yield tSe(n,e?.serviceWorkerRegistration),qMe(n)}),RR.apply(this,arguments)}function rSe(n,e,t){return DR.apply(this,arguments)}function DR(){return DR=I(function*(n,e,t){const r=sSe(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:t[hee],message_name:t[IMe],message_time:t[xMe],message_device_time:Math.floor(Date.now()/1e3)})}),DR.apply(this,arguments)}function sSe(n){switch(n){case Qh.NOTIFICATION_CLICKED:return"notification_open";case Qh.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function zR(){return zR=I(function*(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===Qh.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(Cee(t)):n.onMessageHandler.next(Cee(t)));const r=t.data;QMe(r)&&"1"===r[kMe]&&(yield rSe(n,t.messageType,r))}),zR.apply(this,arguments)}const See="@firebase/messaging",oSe=n=>{const e=new eSe(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function iSe(n,e){return zR.apply(this,arguments)}(e,t)),e},aSe=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:r=>function Mee(n,e){return RR.apply(this,arguments)}(e,r)}};function Tee(){return HR.apply(this,arguments)}function HR(){return(HR=I(function*(){try{yield Fg()}catch{return!1}return typeof window<"u"&&u5()&&MI()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function cSe(){Io(new K2("messaging",oSe,"PUBLIC")),Io(new K2("messaging-internal",aSe,"PRIVATE")),is(See,"0.11.0"),is(See,"0.11.0","esm2017")}();const $S="analytics",fSe="firebase_id",pSe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",wee="https://www.googletagmanager.com/gtag/js",A2=new dh("@firebase/analytics");function bee(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function gSe(n,e){const t=document.createElement("script");t.src=`${wee}?l=${n}&id=${e}`,t.async=!0,document.head.appendChild(t)}function _Se(n,e,t,r,s,i){return BR.apply(this,arguments)}function BR(){return BR=I(function*(n,e,t,r,s,i){const o=r[s];try{if(o)yield e[o];else{const u=(yield bee(t)).find(h=>h.measurementId===s);u&&(yield e[u.appId])}}catch(c){A2.error(c)}n("config",s,i)}),BR.apply(this,arguments)}function vSe(n,e,t,r,s){return $R.apply(this,arguments)}function $R(){return $R=I(function*(n,e,t,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield bee(t);for(const u of o){const h=c.find(m=>m.measurementId===u),g=h&&e[h.appId];if(!g){i=[];break}i.push(g)}}0===i.length&&(i=Object.values(e)),yield Promise.all(i),n("event",r,s||{})}catch(i){A2.error(i)}}),$R.apply(this,arguments)}function ESe(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(wee)&&t.src.includes(n))return t;return null}const Za=new z4("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Oee=new class TSe{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function wSe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function bSe(n){return GR.apply(this,arguments)}function GR(){return GR=I(function*(n){var e;const{appId:t,apiKey:r}=n,s={method:"GET",headers:wSe(r)},i=pSe.replace("{app-id}",t),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(e=u.error)&&void 0!==e&&e.message&&(c=u.error.message)}catch{}throw Za.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),GR.apply(this,arguments)}function OSe(n){return UR.apply(this,arguments)}function UR(){return UR=I(function*(n,e=Oee,t){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw Za.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Za.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new ISe;return setTimeout(I(function*(){c.abort()}),void 0!==t?t:6e4),Aee({appId:r,apiKey:s,measurementId:i},o,c,e)}),UR.apply(this,arguments)}function Aee(n,e,t){return qR.apply(this,arguments)}function qR(){return qR=I(function*(n,{throttleEndTimeMillis:e,backoffCount:t},r,s=Oee){var i,o;const{appId:c,measurementId:u}=n;try{yield ASe(r,e)}catch(h){if(u)return A2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=h)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw h}try{const h=yield bSe(n);return s.deleteThrottleMetadata(c),h}catch(h){const g=h;if(!NSe(g)){if(s.deleteThrottleMetadata(c),u)return A2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${g?.message}]`),{appId:c,measurementId:u};throw h}const m=503===Number(null===(o=g?.customData)||void 0===o?void 0:o.httpStatus)?wI(t,s.intervalMillis,30):wI(t,s.intervalMillis),M={throttleEndTimeMillis:Date.now()+m,backoffCount:t+1};return s.setThrottleMetadata(c,M),A2.debug(`Calling attemptFetch again in ${m} millis`),Aee(n,M,r,s)}}),qR.apply(this,arguments)}function ASe(n,e){return new Promise((t,r)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(i),r(Za.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function NSe(n){if(!(n instanceof Oc&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}class ISe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let WR,QR;function jR(){return jR=I(function*(n,e,t,r,s){if(s&&s.global)n("event",t,r);else{const i=yield e;n("event",t,Object.assign(Object.assign({},r),{send_to:i}))}}),jR.apply(this,arguments)}function Nee(n){QR=n}function Iee(n){WR=n}function zSe(){return JR.apply(this,arguments)}function JR(){return JR=I(function*(){var n;if(!u5())return A2.warn(Za.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield Fg()}catch(e){return A2.warn(Za.create("indexeddb-unavailable",{errorInfo:null===(n=e)||void 0===n?void 0:n.toString()}).message),!1}return!0}),JR.apply(this,arguments)}function eD(){return eD=I(function*(n,e,t,r,s,i,o){var c;const u=OSe(n);u.then(b=>{t[b.measurementId]=b.appId,n.options.measurementId&&b.measurementId!==n.options.measurementId&&A2.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${b.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(b=>A2.error(b)),e.push(u);const h=zSe().then(b=>{if(b)return r.getId()}),[g,m]=yield Promise.all([u,h]);ESe(i)||gSe(i,g.measurementId),QR&&(s("consent","default",QR),Nee(void 0)),s("js",new Date);const M=null!==(c=o?.config)&&void 0!==c?c:{};return M.origin="firebase",M.update=!0,null!=m&&(M[fSe]=m),s("config",g.measurementId,M),WR&&(s("set",WR),Iee(void 0)),g.measurementId}),eD.apply(this,arguments)}class VSe{constructor(e){this.app=e}_delete(){return delete m6[this.app.options.appId],Promise.resolve()}}let m6={},xee=[];const kee={};let Ree,_6,GS="dataLayer",tD=!1;function BSe(n,e,t){!function FSe(){const n=[];if(EI()&&n.push("This is a browser extension environment."),MI()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),t=Za.create("invalid-analytics-context",{errorInfo:e});A2.warn(t.message)}}();const r=n.options.appId;if(!r)throw Za.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw Za.create("no-api-key");A2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=m6[r])throw Za.create("already-exists",{id:r});if(!tD){!function mSe(n){let e=[];Array.isArray(window[n])?e=window[n]:window[n]=e}(GS);const{wrappedGtag:i,gtagCore:o}=function ySe(n,e,t,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function CSe(n,e,t,r){function i(){return(i=I(function*(o,c,u){try{"event"===o?yield vSe(n,e,t,c,u):"config"===o?yield _Se(n,e,t,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(h){A2.error(h)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,e,t),{gtagCore:i,wrappedGtag:window[s]}}(m6,xee,kee,GS,"gtag");_6=i,Ree=o,tD=!0}return m6[r]=function HSe(n,e,t,r,s,i,o){return eD.apply(this,arguments)}(n,xee,kee,e,Ree,GS,t),new VSe(n)}function GSe(){return nD.apply(this,arguments)}function nD(){return(nD=I(function*(){if(EI()||!MI()||!u5())return!1;try{return yield Fg()}catch{return!1}})).apply(this,arguments)}const Dee="@firebase/analytics";!function qSe(){Io(new K2($S,(e,{options:t})=>BSe(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),Io(new K2("analytics-internal",function n(e){try{const t=e.getProvider($S).getImmediate();return{logEvent:(r,s,i)=>function USe(n,e,t,r){n=jr(n),function xSe(n,e,t,r,s){return jR.apply(this,arguments)}(_6,m6[n.app.options.appId],e,t,r).catch(s=>A2.error(s))}(t,r,s,i)}}catch(t){throw Za.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),is(Dee,"0.8.4"),is(Dee,"0.8.4","esm2017")}();class WSe extends I1{constructor(e,t){super()}schedule(e,t=0){return this}}const US={setInterval(n,e,...t){const{delegate:r}=US;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=US;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class Hee extends WSe{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,t),this}requestAsyncId(e,t,r=0){return US.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&US.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let s,r=!1;try{this.work(e)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,t3(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const rD={now:()=>(rD.delegate||Date).now(),delegate:void 0};class qm{constructor(e,t=qm.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}}qm.now=rD.now;class Vee extends qm{constructor(e,t=qm.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}const YSe=new class ZSe extends Vee{}(class jSe extends Hee{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}}),KSe=new Vee(Hee),qS=new N0("7.4.1"),sD="__angularfire_symbol__analyticsIsSupportedValue",iD="__angularfire_symbol__analyticsIsSupported",oD="__angularfire_symbol__remoteConfigIsSupportedValue",aD="__angularfire_symbol__remoteConfigIsSupported",cD="__angularfire_symbol__messagingIsSupportedValue",lD="__angularfire_symbol__messagingIsSupported";function fD(n,e,t){if(e){if(1===e.length)return e[0];const i=e.filter(o=>o.app===t);if(1===i.length)return i[0]}return t.container.getProvider(n).getImmediate({optional:!0})}globalThis[iD]||(globalThis[iD]=GSe().then(n=>globalThis[sD]=n).catch(()=>globalThis[sD]=!1)),globalThis[lD]||(globalThis[lD]=Tee().then(n=>globalThis[cD]=n).catch(()=>globalThis[cD]=!1)),globalThis[aD]||(globalThis[aD]=bMe().then(n=>globalThis[oD]=n).catch(()=>globalThis[oD]=!1));const hD=(n,e)=>{const t=e?[e]:MY(),r=[];return t.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function Jh(){}class Fee{constructor(e,t=YSe){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{e.apply(this,[o])})},t,r)}}class XSe{constructor(e){this.zone=e,this.task=null}call(e,t){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Jh,{},Jh,Jh)),t.pipe(E2({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let dD=(()=>{class n{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Fee(Zone.current)),this.insideAngular=t.run(()=>new Fee(Zone.current,KSe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(t){return new(t||n)(De(Er))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function G5(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function QSe(n){return G5().ngZone.runOutsideAngular(()=>n())}function U5(n){return G5().ngZone.run(()=>n())}function JSe(n){return G5(),function ePe(n){return function(t){return(t=t.lift(new XSe(n.ngZone))).pipe(pc(n.outsideAngular),Ml(n.insideAngular))}}(G5())(n)}const tPe=(n,e)=>function(){const r=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),U5(()=>n.apply(void 0,r))},Sr=(n,e)=>function(){let t;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(e&&(t||(t=U5(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Jh,{},Jh,Jh)))),r[i]=tPe(r[i],t));const s=QSe(()=>n.apply(this,r));if(!e){if(s instanceof _r){const i=G5();return s.pipe(pc(i.outsideAngular),Ml(i.insideAngular))}return U5(()=>s)}return s instanceof _r?s.pipe(JSe):s instanceof Promise?U5(()=>new Promise((i,o)=>s.then(c=>U5(()=>i(c)),c=>U5(()=>o(c))))):"function"==typeof s&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),s.apply(this,arguments)}:U5(()=>s)};class e9{constructor(e){return e}}class pD{constructor(){return MY()}}const gD=new Rt("angularfire2._apps"),rPe={provide:e9,useFactory:function nPe(n){return n&&1===n.length?n[0]:new e9(DI())},deps:[[new si,gD]]},sPe={provide:pD,deps:[[new si,gD]]};function iPe(n){return(e,t)=>{const r=e.runOutsideAngular(()=>n(t));return new e9(r)}}let oPe=(()=>{class n{constructor(t){is("angularfire",qS.full,"core"),is("angularfire",qS.full,"app"),is("angular",EC.full,t.toString())}}return n.\u0275fac=function(t){return new(t||n)(De(ng))},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({providers:[rPe,sPe]}),n})();const cPe=Sr(EY,!0),mD=new Map,Bee={activated:!1,tokenObservers:[]},lPe={initialized:!1,enabled:!1};function N2(n){return mD.get(n)||Object.assign({},Bee)}function WS(){return lPe}class gPe{constructor(e,t,r,s,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return I(function*(){t.stop();try{t.pending=new CM,yield function mPe(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new CM,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Ro=new z4("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function Gee(n){if(!N2(n).activated)throw Ro.create("use-before-activation",{appName:n.name})}function CD(n,e){return yD.apply(this,arguments)}function yD(){return yD=I(function*({url:n,body:e},t){var r,s;const i={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){const b=yield o.getHeartbeatsHeader();b&&(i["X-Firebase-Client"]=b)}const c={method:"POST",body:JSON.stringify(e),headers:i};let u,h;try{u=yield fetch(n,c)}catch(b){throw Ro.create("fetch-network-error",{originalErrorMessage:null===(r=b)||void 0===r?void 0:r.message})}if(200!==u.status)throw Ro.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(b){throw Ro.create("fetch-parse-error",{originalErrorMessage:null===(s=b)||void 0===s?void 0:s.message})}const g=h.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw Ro.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(g[1]),M=Date.now();return{token:h.token,expireTimeMillis:M+m,issuedAtTimeMillis:M}}),yD.apply(this,arguments)}function yPe(n,e){const{projectId:t,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:e}}}const Wm="firebase-app-check-store";let YS=null;function qee(){return YS||(YS=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;e(Ro.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(Wm,{keyPath:"compositeKey"})}}catch(r){e(Ro.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),YS)}function ED(){return ED=I(function*(n,e){const r=(yield qee()).transaction(Wm,"readwrite"),i=r.objectStore(Wm).put({compositeKey:n,value:e});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var h;c(Ro.create("storage-set",{originalErrorMessage:null===(h=u.target.error)||void 0===h?void 0:h.message}))}})}),ED.apply(this,arguments)}const jm=new dh("@firebase/app-check");function PD(n,e){return u5()?function PPe(n,e){return function Wee(n,e){return ED.apply(this,arguments)}(function Zee(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{jm.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Yee(){return WS().enabled}function Kee(){return wD.apply(this,arguments)}function wD(){return wD=I(function*(){const n=WS();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),wD.apply(this,arguments)}const NPe={error:"UNKNOWN_ERROR"};function IPe(n){return yI.encodeString(JSON.stringify(n),!1)}function KS(n){return bD.apply(this,arguments)}function bD(){return bD=I(function*(n,e=!1){const t=n.app;Gee(t);const r=N2(t);let i,s=r.token;if(s&&!t9(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(t9(u)?s=u:yield PD(t,void 0))}if(!e&&s&&t9(s))return{token:s.token};let c,o=!1;if(Yee()){r.exchangeTokenPromise||(r.exchangeTokenPromise=CD(yPe(t,yield Kee()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield PD(t,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield N2(t).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?jm.warn(u.message):jm.error(u),i=u}return s?i?c=t9(s)?{token:s.token,internalError:i}:Jee(i):(c={token:s.token},r.token=s,yield PD(t,s)):c=Jee(i),o&&Qee(t,c),c}),bD.apply(this,arguments)}function AD(n,e){const t=N2(n),r=t.tokenObservers.filter(s=>s.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function Xee(n){const{app:e}=n,t=N2(e);let r=t.tokenRefresher;r||(r=function xPe(n){const{app:e}=n;return new gPe(I(function*(){let r;if(r=N2(e).token?yield KS(n,!0):yield KS(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=N2(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Qee(n,e){const t=N2(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function t9(n){return n.expireTimeMillis-Date.now()>0}function Jee(n){return{token:IPe(NPe),error:n}}class kPe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=N2(this.app);for(const t of e)AD(this.app,t.next);return Promise.resolve()}}const ate="app-check-internal";!function jPe(){Io(new K2("app-check",n=>function LPe(n,e){return new kPe(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(ate).initialize()})),Io(new K2(ate,n=>function RPe(n){return{getToken:e=>KS(n,e),addTokenListener:e=>function OD(n,e,t,r){const{app:s}=n,i=N2(s);if(i.tokenObservers=[...i.tokenObservers,{next:t,error:r,type:e}],i.token&&t9(i.token)){const c=i.token;Promise.resolve().then(()=>{t({token:c.token}),Xee(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>Xee(n))}(n,"INTERNAL",e),removeTokenListener:e=>AD(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),is("@firebase/app-check","0.5.17")}();class kD{constructor(){return hD("app-check")}}typeof window<"u"&&window;const QPe=function lte(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ute=new z4("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),fte=new dh("@firebase/auth");function QS(n,...e){fte.logLevel<=d1.ERROR&&fte.error(`Auth (${gh}): ${n}`,...e)}function ga(n,...e){throw RD(n,...e)}function Ya(n,...e){return RD(n,...e)}function hte(n,e,t){const r=Object.assign(Object.assign({},QPe()),{[e]:t});return new z4("auth","Firebase",r).create(e,{appName:n.name})}function n9(n,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&ga(n,"argument-error"),hte(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function RD(n,...e){if("string"!=typeof n){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ute.create(n,...e)}function st(n,e,...t){if(!n)throw RD(e,...t)}function q4(n){const e="INTERNAL ASSERTION FAILED: "+n;throw QS(e),new Error(e)}function v6(n,e){n||q4(e)}const dte=new Map;function C6(n){v6(n instanceof Function,"Expected a class definition");let e=dte.get(n);return e?(v6(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,dte.set(n,e),e)}function Zm(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function pte(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class Ym{constructor(e,t){this.shortDelay=e,this.longDelay=t,v6(t>e,"Short delay should be less than long delay!"),this.isMobile=function ege(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Di())}()||function nge(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function tTe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function DD(){return"http:"===pte()||"https:"===pte()}()||EI()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function zD(n,e){v6(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class gte{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void q4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void q4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void q4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const rTe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},sTe=new Ym(3e4,6e4);function ui(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function $i(n,e,t,r){return HD.apply(this,arguments)}function HD(){return HD=I(function*(n,e,t,r,s={}){return mte(n,s,I(function*(){let i={},o={};r&&("GET"===e?o=r:i={body:JSON.stringify(r)});const c=Bg(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),gte.fetch()(_te(n,n.config.apiHost,t,c),Object.assign({method:e,headers:u,referrerPolicy:"no-referrer"},i))}))}),HD.apply(this,arguments)}function mte(n,e,t){return VD.apply(this,arguments)}function VD(){return VD=I(function*(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},rTe),e);try{const s=new iTe(n),i=yield Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw Km(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw Km(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw Km(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw Km(n,"user-disabled",o);const g=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw hte(n,g,h);ga(n,g)}}catch(s){if(s instanceof Oc)throw s;ga(n,"network-request-failed")}}),VD.apply(this,arguments)}function y6(n,e,t,r){return FD.apply(this,arguments)}function FD(){return FD=I(function*(n,e,t,r,s={}){const i=yield $i(n,e,t,r,s);return"mfaPendingCredential"in i&&ga(n,"multi-factor-auth-required",{_serverResponse:i}),i}),FD.apply(this,arguments)}function _te(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?zD(n.config,s):`${n.config.apiScheme}://${s}`}class iTe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ya(this.auth,"network-request-failed")),sTe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Km(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Ya(n,e,r);return s.customData._tokenResponse=t,s}function BD(){return BD=I(function*(n,e){return $i(n,"POST","/v1/accounts:delete",e)}),BD.apply(this,arguments)}function cTe(n,e){return GD.apply(this,arguments)}function GD(){return GD=I(function*(n,e){return $i(n,"POST","/v1/accounts:lookup",e)}),GD.apply(this,arguments)}function Xm(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function UD(){return UD=I(function*(n,e=!1){const t=jr(n),r=yield t.getIdToken(e),s=JS(r);st(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:Xm(qD(s.auth_time)),issuedAtTime:Xm(qD(s.iat)),expirationTime:Xm(qD(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),UD.apply(this,arguments)}function qD(n){return 1e3*Number(n)}function JS(n){var e;const[t,r,s]=n.split(".");if(void 0===t||void 0===r||void 0===s)return QS("JWT malformed, contained fewer than 3 sections"),null;try{const i=vM(r);return i?JSON.parse(i):(QS("Failed to decode base64 JWT payload"),null)}catch(i){return QS("Caught error parsing JWT payload as JSON",null===(e=i)||void 0===e?void 0:e.toString()),null}}function E6(n,e){return WD.apply(this,arguments)}function WD(){return WD=I(function*(n,e,t=!1){if(t)return e;try{return yield e}catch(r){throw r instanceof Oc&&fTe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),WD.apply(this,arguments)}function fTe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class hTe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(I(function*(){yield t.iteration()}),r)}iteration(){var e=this;return I(function*(){var t;try{yield e.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(t=r)||void 0===t?void 0:t.code)&&e.schedule(!0))}e.schedule()})()}}class vte{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xm(this.lastLoginAt),this.creationTime=Xm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Qm(n){return jD.apply(this,arguments)}function jD(){return jD=I(function*(n){var e;const t=n.auth,r=yield n.getIdToken(),s=yield E6(n,cTe(t,{idToken:r}));st(s?.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(e=i.providerUserInfo)&&void 0!==e&&e.length?gTe(i.providerUserInfo):[],c=pTe(n.providerData,o),g=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new vte(i.createdAt,i.lastLoginAt),isAnonymous:g};Object.assign(n,m)}),jD.apply(this,arguments)}function ZD(){return ZD=I(function*(n){const e=jr(n);yield Qm(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}),ZD.apply(this,arguments)}function pTe(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function gTe(n){return n.map(e=>{var{providerId:t}=e,r=b7(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function YD(){return YD=I(function*(n,e){const t=yield mte(n,{},I(function*(){const r=Bg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=_te(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",gte.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}),YD.apply(this,arguments)}class Jm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){st(e.idToken,"internal-error"),st(typeof e.idToken<"u","internal-error"),st(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function uTe(n){const e=JS(n);return st(e,"internal-error"),st(typeof e.exp<"u","internal-error"),st(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var r=this;return I(function*(){return st(!r.accessToken||r.refreshToken,e,"user-token-expired"),t||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(e,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var r=this;return I(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function mTe(n,e){return YD.apply(this,arguments)}(e,t);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Jm;return r&&(st("string"==typeof r,"internal-error",{appName:e}),o.refreshToken=r),s&&(st("string"==typeof s,"internal-error",{appName:e}),o.accessToken=s),i&&(st("number"==typeof i,"internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Jm,this.toJSON())}_performRefresh(){return q4("not implemented")}}function m8(n,e){st("string"==typeof n||typeof n>"u","internal-error",{appName:e})}class q5{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=b7(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new hTe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new vte(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(e){var t=this;return I(function*(){const r=yield E6(t,t.stsTokenManager.getToken(t.auth,e));return st(r,t.auth,"internal-error"),t.accessToken!==r&&(t.accessToken=r,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),r})()}getIdTokenResult(e){return function lTe(n){return UD.apply(this,arguments)}(this,e)}reload(){return function dTe(n){return ZD.apply(this,arguments)}(this)}_assign(e){this!==e&&(st(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new q5(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){st(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var r=this;return I(function*(){let s=!1;e.idToken&&e.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(e),s=!0),t&&(yield Qm(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var e=this;return I(function*(){const t=yield e.getIdToken();return yield E6(e,function oTe(n,e){return BD.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,c,u,h,g;const m=null!==(r=t.displayName)&&void 0!==r?r:void 0,M=null!==(s=t.email)&&void 0!==s?s:void 0,b=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,L=null!==(o=t.photoURL)&&void 0!==o?o:void 0,G=null!==(c=t.tenantId)&&void 0!==c?c:void 0,j=null!==(u=t._redirectEventId)&&void 0!==u?u:void 0,ie=null!==(h=t.createdAt)&&void 0!==h?h:void 0,ye=null!==(g=t.lastLoginAt)&&void 0!==g?g:void 0,{uid:te,emailVerified:xe,isAnonymous:$e,providerData:et,stsTokenManager:Ft}=t;st(te&&Ft,e,"internal-error");const H1=Jm.fromJSON(this.name,Ft);st("string"==typeof te,e,"internal-error"),m8(m,e.name),m8(M,e.name),st("boolean"==typeof xe,e,"internal-error"),st("boolean"==typeof $e,e,"internal-error"),m8(b,e.name),m8(L,e.name),m8(G,e.name),m8(j,e.name),m8(ie,e.name),m8(ye,e.name);const jt=new q5({uid:te,auth:e,email:M,emailVerified:xe,displayName:m,isAnonymous:$e,photoURL:L,phoneNumber:b,tenantId:G,stsTokenManager:H1,createdAt:ie,lastLoginAt:ye});return et&&Array.isArray(et)&&(jt.providerData=et.map(Ys=>Object.assign({},Ys))),j&&(jt._redirectEventId=j),jt}static _fromIdTokenResponse(e,t,r=!1){return I(function*(){const s=new Jm;s.updateFromServerResponse(t);const i=new q5({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return yield Qm(i),i})()}}const Cte=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return I(function*(){return!0})()}_set(t,r){var s=this;return I(function*(){s.storage[t]=r})()}_get(t){var r=this;return I(function*(){const s=r.storage[t];return void 0===s?null:s})()}_remove(t){var r=this;return I(function*(){delete r.storage[t]})()}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})();function eP(n,e,t){return`firebase:${n}:${e}:${t}`}class r9{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=eP(this.userKey,s.apiKey,i),this.fullPersistenceKey=eP("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return I(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?q5._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return I(function*(){if(t.persistence===e)return;const r=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,r?t.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return I(function*(){if(!t.length)return new r9(C6(Cte),e,r);const s=(yield Promise.all(t.map(function(){var h=I(function*(g){if(yield g._isAvailable())return g});return function(g){return h.apply(this,arguments)}}()))).filter(h=>h);let i=s[0]||C6(Cte);const o=eP(r,e.config.apiKey,e.name);let c=null;for(const h of t)try{const g=yield h._get(o);if(g){const m=q5._fromJSON(e,g);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(t.map(function(){var h=I(function*(g){if(g!==i)try{yield g._remove(o)}catch{}});return function(g){return h.apply(this,arguments)}}())),new r9(i,e,r)):new r9(i,e,r)})()}}function yte(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ste(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ete(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Tte(e))return"Blackberry";if(wte(e))return"Webos";if(KD(e))return"Safari";if((e.includes("chrome/")||Mte(e))&&!e.includes("edge/"))return"Chrome";if(Pte(e))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function Ete(n=Di()){return/firefox\//i.test(n)}function KD(n=Di()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mte(n=Di()){return/crios\//i.test(n)}function Ste(n=Di()){return/iemobile/i.test(n)}function Pte(n=Di()){return/android/i.test(n)}function Tte(n=Di()){return/blackberry/i.test(n)}function wte(n=Di()){return/webos/i.test(n)}function tP(n=Di()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function bte(n=Di()){return tP(n)||Pte(n)||wte(n)||Tte(n)||/windows phone/i.test(n)||Ste(n)}function Ote(n,e=[]){let t;switch(n){case"Browser":t=yte(Di());break;case"Worker":t=`${yte(Di())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${gh}/${r}`}class yTe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,c)=>{try{o(e(i))}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return I(function*(){var r;if(t.auth.currentUser===e)return;const s=[];try{for(const i of t.queue)yield i(e),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class ETe{constructor(e,t,r){this.app=e,this.heartbeatServiceProvider=t,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ate(this),this.idTokenSubscription=new Ate(this),this.beforeStateQueue=new yTe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ute,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){var r=this;return t&&(this._popupRedirectResolver=C6(t)),this._initializationPromise=this.queue(I(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield r9.create(r,e),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(t),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return I(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return I(function*(){var r;const s=yield t.assertedPersistence.getCurrentUser();let i=s,o=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const c=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,h=yield t.tryRedirectSignIn(e);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return t.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield t.beforeStateQueue.runMiddleware(i)}catch(c){i=s,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(c))}return i?t.reloadAndSetCurrentUserOrClear(i):t.directlySetCurrentUser(null)}return st(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===i._redirectEventId?t.directlySetCurrentUser(i):t.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(e){var t=this;return I(function*(){let r=null;try{r=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(e){var t=this;return I(function*(){var r;try{yield Qm(e)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function nTe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var e=this;return I(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return I(function*(){const r=e?jr(e):null;return r&&st(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))})()}_updateCurrentUser(e,t=!1){var r=this;return I(function*(){if(!r._deleted)return e&&st(r.tenantId===e.tenantId,r,"tenant-id-mismatch"),t||(yield r.beforeStateQueue.runMiddleware(e)),r.queue(I(function*(){yield r.directlySetCurrentUser(e),r.notifyAuthListeners()}))})()}signOut(){var e=this;return I(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(I(function*(){yield t.assertedPersistence.setPersistence(C6(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new z4("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var r=this;return I(function*(){const s=yield r.getOrInitRedirectPersistenceManager(t);return null===e?s.removeCurrentUser():s.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return I(function*(){if(!t.redirectPersistenceManager){const r=e&&C6(e)||t._popupRedirectResolver;st(r,t,"argument-error"),t.redirectPersistenceManager=yield r9.create(t,[C6(r._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return I(function*(){var r,s;return t._isInitialized&&(yield t.queue(I(function*(){}))),(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(s=t.redirectUser)||void 0===s?void 0:s._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return I(function*(){if(e===t.currentUser)return t.queue(I(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return st(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof t?e.addObserver(t,r,s):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return I(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return st(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ote(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return I(function*(){var t;const r={"X-Client-Version":e.clientVersion};e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId);const s=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function ma(n){return jr(n)}class Ate{constructor(e){this.auth=e,this.observer=null,this.addObserver=function gge(n,e){const t=new mge(n,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return st(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Nte(n,e,t){const r=ma(n);st(r._canInitEmulator,r,"emulator-config-failed"),st(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!t?.disableWarnings,i=Ite(e),{host:o,port:c}=function MTe(n){const e=Ite(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:xte(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:xte(o)}}}(e);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function STe(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function Ite(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function xte(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}class XD{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return q4("not implemented")}_getIdTokenResponse(e){return q4("not implemented")}_linkToIdToken(e,t){return q4("not implemented")}_getReauthenticationResolver(e){return q4("not implemented")}}function JD(){return JD=I(function*(n,e){return $i(n,"POST","/v1/accounts:update",e)}),JD.apply(this,arguments)}function tz(){return tz=I(function*(n,e){return y6(n,"POST","/v1/accounts:signInWithPassword",ui(n,e))}),tz.apply(this,arguments)}function nP(n,e){return nz.apply(this,arguments)}function nz(){return nz=I(function*(n,e){return $i(n,"POST","/v1/accounts:sendOobCode",ui(n,e))}),nz.apply(this,arguments)}function wTe(n,e){return rz.apply(this,arguments)}function rz(){return rz=I(function*(n,e){return nP(n,e)}),rz.apply(this,arguments)}function bTe(n,e){return sz.apply(this,arguments)}function sz(){return sz=I(function*(n,e){return nP(n,e)}),sz.apply(this,arguments)}function az(){return az=I(function*(n,e){return y6(n,"POST","/v1/accounts:signInWithEmailLink",ui(n,e))}),az.apply(this,arguments)}function cz(){return cz=I(function*(n,e){return y6(n,"POST","/v1/accounts:signInWithEmailLink",ui(n,e))}),cz.apply(this,arguments)}class e_ extends XD{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new e_(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new e_(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return I(function*(){switch(t.signInMethod){case"password":return function TTe(n,e){return tz.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password});case"emailLink":return function NTe(n,e){return az.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:ga(e,"internal-error")}})()}_linkToIdToken(e,t){var r=this;return I(function*(){switch(r.signInMethod){case"password":return function Lte(n,e){return JD.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function ITe(n,e){return cz.apply(this,arguments)}(e,{idToken:t,email:r._email,oobCode:r._password});default:ga(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function M6(n,e){return lz.apply(this,arguments)}function lz(){return lz=I(function*(n,e){return y6(n,"POST","/v1/accounts:signInWithIdp",ui(n,e))}),lz.apply(this,arguments)}class s9 extends XD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new s9(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ga("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=b7(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new s9(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){return M6(e,this.buildRequest())}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,M6(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,M6(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bg(t)}return e}}class n_{constructor(e){var t,r,s,i,o,c;const u=$g(Gg(e)),h=null!==(t=u.apiKey)&&void 0!==t?t:null,g=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function HTe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);st(h&&g&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=g,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(e){const t=function VTe(n){const e=$g(Gg(n)).link,t=e?$g(Gg(e)).deep_link_id:null,r=$g(Gg(n)).deep_link_id;return(r?$g(Gg(r)).link:null)||r||t||e||n}(e);try{return new n_(t)}catch{return null}}}let Rte=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return e_._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){const s=n_.parseLink(r);return st(s,"argument-error"),e_._fromEmailAndCode(t,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class _8{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Dte extends _8{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let FTe=(()=>{class n extends Dte{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return s9._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:r,oauthAccessToken:s}=t;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function zte(n,e){return gz.apply(this,arguments)}function gz(){return gz=I(function*(n,e){return y6(n,"POST","/v1/accounts:signUp",ui(n,e))}),gz.apply(this,arguments)}class Nc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,s=!1){return I(function*(){const i=yield q5._fromIdTokenResponse(e,r,s),o=Hte(r);return new Nc({user:i,providerId:o,_tokenResponse:r,operationType:t})})()}static _forOperation(e,t,r){return I(function*(){yield e._updateTokensIfNecessary(r,!0);const s=Hte(r);return new Nc({user:e,providerId:s,_tokenResponse:r,operationType:t})})()}}function Hte(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class sP extends Oc{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,sP.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new sP(e,t,r,s)}}function Vte(n,e,t,r){return("reauthenticate"===e?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?sP._fromErrorAndOperation(n,i,e,r):i})}function vz(n,e){return Cz.apply(this,arguments)}function Cz(){return Cz=I(function*(n,e,t=!1){const r=yield E6(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Nc._forOperation(n,"link",r)}),Cz.apply(this,arguments)}function Ez(){return Ez=I(function*(n,e,t=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield E6(n,Vte(s,i,e,n),t);st(o.idToken,s,"internal-error");const c=JS(o.idToken);st(c,s,"internal-error");const{sub:u}=c;return st(n.uid===u,s,"user-mismatch"),Nc._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&ga(s,"user-mismatch"),o}}),Ez.apply(this,arguments)}function $te(n,e){return Mz.apply(this,arguments)}function Mz(){return Mz=I(function*(n,e,t=!1){const r="signIn",s=yield Vte(n,r,e),i=yield Nc._fromIdTokenResponse(n,r,s);return t||(yield n._updateCurrentUser(i.user)),i}),Mz.apply(this,arguments)}function Pz(){return Pz=I(function*(n,e){return $te(ma(n),e)}),Pz.apply(this,arguments)}function oP(n,e,t){var r;st((null===(r=t.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),st(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(st(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(st(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}function WTe(n,e,t){return Iz.apply(this,arguments)}function Iz(){return Iz=I(function*(n,e,t){const r=jr(n),s={requestType:"PASSWORD_RESET",email:e};t&&oP(r,s,t),yield bTe(r,s)}),Iz.apply(this,arguments)}function ZTe(n,e,t){return Dz.apply(this,arguments)}function Dz(){return Dz=I(function*(n,e,t){const r=ma(n),s=yield zte(r,{returnSecureToken:!0,email:e,password:t}),i=yield Nc._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),Dz.apply(this,arguments)}function YTe(n,e,t){return function Sz(n,e){return Pz.apply(this,arguments)}(jr(n),Rte.credential(e,t))}function XTe(n,e){return Bz.apply(this,arguments)}function Bz(){return Bz=I(function*(n,e){const t=jr(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};e&&oP(t.auth,s,e);const{email:i}=yield wTe(t.auth,s);i!==n.email&&(yield n.reload())}),Bz.apply(this,arguments)}function QTe(n,e){return Gz.apply(this,arguments)}function Gz(){return Gz=I(function*(n,e){return $i(n,"POST","/v1/accounts:update",e)}),Gz.apply(this,arguments)}function JTe(n,e){return Uz.apply(this,arguments)}function Uz(){return Uz=I(function*(n,{displayName:e,photoURL:t}){if(void 0===e&&void 0===t)return;const r=jr(n),i={idToken:yield r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=yield E6(r,QTe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),Uz.apply(this,arguments)}function awe(n,e,t,r){return jr(n).onAuthStateChanged(e,t,r)}const aP="__sak";class Ute{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(aP,"1"),this.storage.removeItem(aP),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const pwe=(()=>{class n extends Ute{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function fwe(){const n=Di();return KD(n)||tP(n)}()&&function CTe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=bte(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&t(r,i,s)}}onStorageEvent(t,r=!1){if(!t.key)return void this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});const s=t.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(t.newValue!==c)null!==t.newValue?this.storage.setItem(s,t.newValue):this.storage.removeItem(s);else if(this.localCache[s]===t.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function vTe(){return function rge(){const n=Di();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,r){this.localCache[t]=r;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,r){var s=()=>super._set,i=this;return I(function*(){yield s().call(i,t,r),i.localCache[t]=JSON.stringify(r)})()}_get(t){var r=()=>super._get,s=this;return I(function*(){const i=yield r().call(s,t);return s.localCache[t]=JSON.stringify(i),i})()}_remove(t){var r=()=>super._remove,s=this;return I(function*(){yield r().call(s,t),delete s.localCache[t]})()}}return n.type="LOCAL",n})(),qte=(()=>{class n extends Ute{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})();let mwe=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const r=this.receivers.find(i=>i.isListeningto(t));if(r)return r;const s=new n(t);return this.receivers.push(s),s}isListeningto(t){return this.eventTarget===t}handleEvent(t){var r=this;return I(function*(){const s=t,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const h=Array.from(u).map(function(){var m=I(function*(M){return M(s.origin,c)});return function(M){return m.apply(this,arguments)}}()),g=yield function gwe(n){return Promise.all(n.map(function(){var e=I(function*(t){try{return{fulfilled:!0,value:yield t}}catch(r){return{fulfilled:!1,reason:r}}});return function(t){return e.apply(this,arguments)}}()))}(h);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:g})})()}_subscribe(t,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function cP(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(10*Math.random());return n+t}class _we{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){var s=this;return I(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const g=cP("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(M){const b=M;if(b.data.eventId===g)switch(b.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(b.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:e,eventId:g,data:t},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function fi(){return window}function Xz(){return typeof fi().WorkerGlobalScope<"u"&&"function"==typeof fi().importScripts}function Qz(){return(Qz=I(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Wte="firebaseLocalStorageDb",lP="firebaseLocalStorage",jte="fbase_key";class s_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function uP(n,e){return n.transaction([lP],e?"readwrite":"readonly").objectStore(lP)}function Jz(){const n=indexedDB.open(Wte,1);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(lP,{keyPath:jte})}catch(s){t(s)}}),n.addEventListener("success",I(function*(){const r=n.result;r.objectStoreNames.contains(lP)?e(r):(r.close(),yield function Swe(){const n=indexedDB.deleteDatabase(Wte);return new s_(n).toPromise()}(),e(yield Jz()))}))})}function Zte(n,e,t){return eH.apply(this,arguments)}function eH(){return eH=I(function*(n,e,t){const r=uP(n,!0).put({[jte]:e,value:t});return new s_(r).toPromise()}),eH.apply(this,arguments)}function tH(){return tH=I(function*(n,e){const t=uP(n,!1).get(e),r=yield new s_(t).toPromise();return void 0===r?null:r.value}),tH.apply(this,arguments)}function Yte(n,e){const t=uP(n,!0).delete(e);return new s_(t).toPromise()}const bwe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return I(function*(){return t.db||(t.db=yield Jz()),t.db})()}_withRetries(t){var r=this;return I(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield t(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return I(function*(){return Xz()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return I(function*(){t.receiver=mwe._getInstance(function Ewe(){return Xz()?self:null}()),t.receiver._subscribe("keyChanged",function(){var r=I(function*(s,i){return{keyProcessed:(yield t._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var r=I(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var t=this;return I(function*(){var r,s;if(t.activeServiceWorker=yield function Cwe(){return Qz.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new _we(t.activeServiceWorker);const i=yield t.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var r=this;return I(function*(){if(r.sender&&r.activeServiceWorker&&function ywe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:t},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return I(function*(){try{if(!indexedDB)return!1;const t=yield Jz();return yield Zte(t,aP,"1"),yield Yte(t,aP),!0}catch{}return!1})()}_withPendingWrite(t){var r=this;return I(function*(){r.pendingWrites++;try{yield t()}finally{r.pendingWrites--}})()}_set(t,r){var s=this;return I(function*(){return s._withPendingWrite(I(function*(){return yield s._withRetries(i=>Zte(i,t,r)),s.localCache[t]=r,s.notifyServiceWorker(t)}))})()}_get(t){var r=this;return I(function*(){const s=yield r._withRetries(i=>function Pwe(n,e){return tH.apply(this,arguments)}(i,t));return r.localCache[t]=s,s})()}_remove(t){var r=this;return I(function*(){return r._withPendingWrite(I(function*(){return yield r._withRetries(s=>Yte(s,t)),delete r.localCache[t],r.notifyServiceWorker(t)}))})()}_poll(){var t=this;return I(function*(){const r=yield t._withRetries(o=>{const c=uP(o,!1).getAll();return new s_(c).toPromise()});if(!r)return[];if(0!==t.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(t.localCache[o])!==JSON.stringify(c)&&(t.notifyListeners(o,c),s.push(o));for(const o of Object.keys(t.localCache))t.localCache[o]&&!i.has(o)&&(t.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(t,r){this.localCache[t]=r;const s=this.listeners[t];if(s)for(const i of Array.from(s))i(r)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(I(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function Xte(n){return`__${n}${Math.floor(1e6*Math.random())}`}function j5(n,e){return e?C6(e):(st(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}Xte("rcb"),new Ym(3e4,6e4);class fH extends XD{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return M6(e,this._buildIdpRequest())}_linkToIdToken(e,t){return M6(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return M6(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Uwe(n){return $te(n.auth,new fH(n),n.bypassAuthState)}function qwe(n){const{auth:e,user:t}=n;return st(t,e,"internal-error"),function Bte(n,e){return Ez.apply(this,arguments)}(t,new fH(n),n.bypassAuthState)}function Wwe(n){return hH.apply(this,arguments)}function hH(){return hH=I(function*(n){const{auth:e,user:t}=n;return st(t,e,"internal-error"),vz(t,new fH(n),n.bypassAuthState)}),hH.apply(this,arguments)}class Jte{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=I(function*(r,s){e.pendingPromise={resolve:r,reject:s};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(i){e.reject(i)}});return function(r,s){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return I(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=e;if(c)return void t.reject(c);const h={auth:t.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(u)(h))}catch(g){t.reject(g)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Uwe;case"linkViaPopup":case"linkViaRedirect":return Wwe;case"reauthViaPopup":case"reauthViaRedirect":return qwe;default:ga(this.auth,"internal-error")}}resolve(e){v6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){v6(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const jwe=new Ym(2e3,1e4);function Zwe(n,e,t){return dH.apply(this,arguments)}function dH(){return dH=I(function*(n,e,t){const r=ma(n);n9(n,e,_8);const s=j5(r,t);return new mH(r,"signInViaPopup",e,s).executeNotNull()}),dH.apply(this,arguments)}let mH=(()=>{class n extends Jte{constructor(t,r,s,i,o){super(t,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var t=this;return I(function*(){const r=yield t.execute();return st(r,t.auth,"internal-error"),r})()}onExecution(){var t=this;return I(function*(){v6(1===t.filter.length,"Popup operations only handle one event");const r=cP();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],r),t.authWindow.associatedEvent=r,t.resolver._originValidation(t.auth).catch(s=>{t.reject(s)}),t.resolver._isIframeWebStorageSupported(t.auth,s=>{s||t.reject(Ya(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Ya(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const t=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Ya(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,jwe.get())};t()}}return n.currentPopupAction=null,n})();const i_=new Map;class Kwe extends Jte{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){var e=()=>super.execute,t=this;return I(function*(){let r=i_.get(t.auth._key());if(!r){try{const i=(yield function Xwe(n,e){return _H.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}i_.set(t.auth._key(),r)}return t.bypassAuthState||i_.set(t.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,r=this;return I(function*(){if("signInViaRedirect"===e.type)return t().call(r,e);if("unknown"!==e.type){if(e.eventId){const s=yield r.auth._redirectUserForId(e.eventId);if(s)return r.user=s,t().call(r,e);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return I(function*(){})()}cleanUp(){}}function _H(){return _H=I(function*(n,e){const t=tne(e),r=ene(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(t));return yield r._remove(t),s}),_H.apply(this,arguments)}function Qwe(n,e){i_.set(n._key(),e)}function ene(n){return C6(n._redirectPersistence)}function tne(n){return eP("pendingRedirect",n.config.apiKey,n.name)}function nne(n,e){return PH.apply(this,arguments)}function PH(){return PH=I(function*(n,e,t=!1){const r=ma(n),s=j5(r,e),o=yield new Kwe(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,e)),o}),PH.apply(this,arguments)}class rbe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function sbe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ine(n);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!ine(e)){const s=(null===(r=e.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ya(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(sne(e))}saveEventToCache(e){this.cachedEventUids.add(sne(e)),this.lastProcessedEventTime=Date.now()}}function sne(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ine({type:n,error:e}){return"unknown"===n&&"auth/no-auth-event"===e?.code}function ibe(n){return wH.apply(this,arguments)}function wH(){return wH=I(function*(n,e={}){return $i(n,"GET","/v1/projects",e)}),wH.apply(this,arguments)}const obe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,abe=/^https?/;function bH(){return bH=I(function*(n){if(n.config.emulator)return;const{authorizedDomains:e}=yield ibe(n);for(const t of e)try{if(lbe(t))return}catch{}ga(n,"unauthorized-domain")}),bH.apply(this,arguments)}function lbe(n){const e=Zm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===t&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&o.hostname===r}if(!abe.test(t))return!1;if(obe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const ube=new Ym(3e4,6e4);function one(){const n=fi().___jsl;if(n?.H)for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}let hP=null;function hbe(n){return hP=hP||function fbe(n){return new Promise((e,t)=>{var r,s,i;function o(){one(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{one(),t(Ya(n,"network-request-failed"))},timeout:ube.get()})}if(null!==(s=null===(r=fi().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)e(gapi.iframes.getContext());else{if(null===(i=fi().gapi)||void 0===i||!i.load){const c=Xte("iframefcb");return fi()[c]=()=>{gapi.load?o():t(Ya(n,"network-request-failed"))},function Kte(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Ya("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",function Iwe(){var n,e;return null!==(e=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==e?e:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>t(u))}o()}}).catch(e=>{throw hP=null,e})}(n),hP}const dbe=new Ym(5e3,15e3),mbe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_be=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vbe(n){const e=n.config;st(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?zD(e,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:e.apiKey,appName:n.name,v:gh},s=_be.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Bg(r).slice(1)}`}function OH(){return OH=I(function*(n){const e=yield hbe(n),t=fi().gapi;return st(t,n,"internal-error"),e.open({where:document.body,url:vbe(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:mbe,dontclear:!0},r=>new Promise(function(){var s=I(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=Ya(n,"network-request-failed"),u=fi().setTimeout(()=>{o(c)},dbe.get());function h(){fi().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),OH.apply(this,arguments)}const ybe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ane{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function cne(n,e,t,r,s,i){st(n.config.authDomain,n,"auth-domain-config-required"),st(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:gh,eventId:s};if(e instanceof _8){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",function pge(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries(i||{}))o[u]=h}if(e instanceof Dte){const u=e.getScopes().filter(h=>""!==h);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function Abe({config:n}){return n.emulator?zD(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${Bg(c).slice(1)}`}const AH="webStorageSupport",Ibe=class Nbe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qte,this._completeRedirectFn=nne,this._overrideRedirectResult=Qwe}_openPopup(e,t,r,s){var i=this;return I(function*(){var o;v6(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=cne(e,t,r,Zm(),s);return function Tbe(n,e,t,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},ybe),{width:r.toString(),height:s.toString(),top:i,left:o}),h=Di().toLowerCase();t&&(c=Mte(h)?"_blank":t),Ete(h)&&(e=e||"http://localhost",u.scrollbars="yes");const g=Object.entries(u).reduce((M,[b,L])=>`${M}${b}=${L},`,"");if(function _Te(n=Di()){var e;return tP(n)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(h)&&"_self"!==c)return function wbe(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}(e||"",c),new ane(null);const m=window.open(e||"",c,g);st(m,n,"popup-blocked");try{m.focus()}catch{}return new ane(m)}(e,c,cP())})()}_openRedirect(e,t,r,s){var i=this;return I(function*(){return yield i._originValidation(e),function vwe(n){fi().location.href=n}(cne(e,t,r,Zm(),s)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(v6(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){var t=this;return I(function*(){const r=yield function Cbe(n){return OH.apply(this,arguments)}(e),s=new rbe(e);return r.register("authEvent",i=>(st(i?.authEvent,e,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:s},t.iframes[e._key()]=r,s})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(AH,{type:AH},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[AH];void 0!==o&&t(!!o),ga(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function cbe(n){return bH.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return bte()||KD()||tP()}};var une="@firebase/auth";class xbe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return I(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{var s;e((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){st(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Dbe=fY("authIdTokenMaxAge")||300;let hne=null;const zbe=n=>function(){var e=I(function*(t){const r=t&&(yield t.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>Dbe)return;const i=r?.token;hne!==i&&(hne=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function Hbe(n=DI()){const e=ph(n,"auth");if(e.isInitialized())return e.getImmediate();const t=function JPe(n,e){const t=ph(n,"auth");if(t.isInitialized()){const s=t.getImmediate();if(EM(t.getOptions(),e??{}))return s;ga(s,"already-initialized")}return t.initialize({options:e})}(n,{popupRedirectResolver:Ibe,persistence:[bwe,pwe,qte]}),r=fY("authTokenSyncURL");if(r){const i=zbe(r);(function owe(n,e,t){jr(n).beforeAuthStateChanged(e,t)})(t,i,()=>i(t.currentUser)),function iwe(n,e,t,r){jr(n).onIdTokenChanged(e,t,r)}(t,o=>i(o))}const s=uY("auth");return s&&Nte(t,`http://${s}`),t}!function Lbe(n){Io(new K2("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{st(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),st(!o?.includes(":"),"argument-error",{appName:c.name});const h={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ote(n)},g=new ETe(c,u,h);return function eTe(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(C6);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}(g,t),g})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Io(new K2("auth-internal",e=>{const t=ma(e.getProvider("auth").getImmediate());return new xbe(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),is(une,"0.20.11",function kbe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),is(une,"0.20.11","esm2017")}("Browser");class dP{constructor(e){return e}}class pne{constructor(){return hD("auth")}}const NH=new Rt("angularfire2.auth-instances");function Fbe(n){return(e,t)=>{const r=e.runOutsideAngular(()=>n(t));return new dP(r)}}const Bbe={provide:pne,deps:[[new si,NH]]},$be={provide:dP,useFactory:function Vbe(n,e){const t=fD("auth",n,e);return t&&new dP(t)},deps:[[new si,NH],e9]};let Gbe=(()=>{class n{constructor(){is("angularfire",qS.full,"auth")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({providers:[$be,Bbe]}),n})();const Wbe=Sr(ZTe,!0),jbe=Sr(Hbe,!0),Zbe=Sr(awe,!0),Ybe=Sr(XTe,!0),Kbe=Sr(WTe,!0),Xbe=Sr(YTe,!0),Qbe=Sr(Zwe,!0),Jbe=Sr(JTe,!0);class v8{constructor(e){return e}}const IH=new Rt("angularfire2.firestore-instances");function nOe(n){return(e,t)=>{const r=e.runOutsideAngular(()=>n(t));return new v8(r)}}const rOe={provide:class eOe{constructor(){return hD("firestore")}},deps:[[new si,IH]]},sOe={provide:v8,useFactory:function tOe(n,e){const t=fD("firestore",n,e);return t&&new v8(t)},deps:[[new si,IH],e9]};let iOe=(()=>{class n{constructor(){is("angularfire",qS.full,"fst")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({providers:[sOe,rOe]}),n})();const aOe=Sr(iEe,!0),cOe=Sr(Eye,!0),uOe=Sr(sEe,!0),o_=Sr(dJ,!0),fOe=Sr(eEe,!0),hOe=Sr(tEe,!0),dOe=Sr(zye,!0),pOe=Sr(Xye,!0),mne=Sr(oEe,!0),gOe=Sr(Kye,!0),pP=Sr(Wye,!0),mOe=Sr(nEe,!0),_Oe=Sr(rEe,!0),vOe=Sr(Zye,!0);class Z5{constructor(e,t){this.collectionName=e,this.firestore=t,this.subDAOs={};this.collection=cOe(t,this.collectionName).withConverter({fromFirestore:s=>s.data(),toFirestore:s=>s})}create(e){var t=this;return I(function*(){return(yield aOe(t.collection,e)).id})()}read(e){var t=this;return I(function*(){const r=yield fOe(o_(t.collection,e));return r.exists()?y.of(pe.getNonNullable(r.data())):y.empty()})()}exists(e){var t=this;return I(function*(){return(yield t.read(e)).isPresent()})()}update(e,t){var r=this;return I(function*(){return _Oe(o_(r.collection,e),t)})()}delete(e){return uOe(o_(this.collection,e))}set(e,t){return mOe(o_(this.collection,e),t)}subscribeToChanges(e,t){return new I1(mne(o_(this.collection,e),r=>{t(y.ofNullable(r.data()))}))}findWhere(e,t,r){var s=this;return I(function*(){const i=s.constructQuery(e,t,r);return(yield hOe(i)).docs.map(c=>({id:c.id,data:c.data()}))})()}observingWhere(e,t,r){const s=this.constructQuery(e,r);return new I1(mne(s,i=>{const o=[],c=[],u=[];i.docChanges().forEach(h=>{const g={id:h.doc.id,data:h.doc.data()};switch(h.type){case"added":o.push(g);break;case"modified":c.push(g);break;case"removed":u.push(g)}}),o.length>0&&(We.display("FirestoreDAO","subscription","firebase gave us "+o.length+" NEW "+this.collectionName),t.onDocumentCreated(o)),c.length>0&&(We.display("FirestoreDAO","subscription","firebase gave us "+c.length+" MODIFIED "+this.collectionName),t.onDocumentModified(c)),u.length>0&&(We.display("FirestoreDAO","subscription","firebase gave us "+u.length+" DELETED "+this.collectionName),t.onDocumentDeleted(u))}))}constructQuery(e,t,r){let s=pP(this.collection);null!=t&&(s=pP(s,gOe(t))),null!=r&&(s=pP(s,pOe(r)));for(const i of e)s=pP(s,vOe(i[0],i[1],i[2]));return s}subCollectionDAO(e,t){const r=`${this.collection.path}/${e}/${t}`;if(r in this.subDAOs)return this.subDAOs[r];{const s=new class extends Z5{constructor(i){super(r,i)}}(this.firestore);return this.subDAOs[r]=s,s}}}let COe=(()=>{class n extends Z5{constructor(t){super("errors",t)}}return n.\u0275fac=function(t){return new(t||n)(De(v8))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var yOe=lc(2486);let _n=(()=>{class n{infoMessage(t){this.message(t,"is-info")}gameMessage(t){this.message(t,"is-warning")}criticalMessage(t){this.message(t,"is-danger")}message(t,r){const s=this.getDuration(t);this.toast(t,r,s)}toast(t,r,s){(0,yOe.toast)({message:t,duration:s,type:r,position:"top-center",closeOnClick:!0,dismissible:!0})}getDuration(t){const r=t.split(" ").length;return Math.max(60*r*1e3/150,3e3)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ts{constructor(e,t,r){this.errorDAO=e,this.router=t,this.messageDisplayer=r,Ts.setSingletonInstance(this)}static setSingletonInstance(e){Ts.singleton=y.of(e)}static logErrorAndFail(e,t,r){throw Ts.logError(e,t,r),new Error(`${e}: ${t} (extra data: ${JSON.stringify(r)})`)}static logError(e,t,r){if(this.singleton.isAbsent())throw new Error(`${e}: ${t} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(e,t,r),R.failure(e+": "+t)}findErrors(e,t,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",e],["route","==",t],["message","==",r]]:[["component","==",e],["route","==",t],["message","==",r],["data","==",s]])}logError(e,t,r){var s=this;return I(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(e,i,t,r);if(0===o.length){const c={component:e,route:i,message:t,firstEncounter:U4(),lastEncounter:U4(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:U4(),occurences:u.occurences+1})}})()}}Ts.singleton=y.empty(),Ts.\u0275fac=function(e){return new(e||Ts)(De(COe),De(Kn),De(_n))},Ts.\u0275prov=nt({token:Ts,factory:Ts.\u0275fac,providedIn:"root"});class We{static enableLog(e,t,r){const s=localStorage.getItem("verbosity");let i={};null!=s&&(i=JSON.parse(s)),r?i[t+"."+r]=e:i[t]=e,localStorage.setItem("verbosity",JSON.stringify(i))}static isVerbose(e){const t=localStorage.getItem("verbosity");if(null==t)return[!1,!1];const r=JSON.parse(t);return null==r[e]?[!1,!1]:(pe.assert(Array.isArray(r[e]),`malformed verbosity levels: ${r[e]}`),r[e])}static isMethodVerboseEntry(e,t){return We.isVerbose(e)[0]||We.isVerbose(e+"."+t)[0]}static isMethodVerboseExit(e,t){return We.isVerbose(e)[1]||We.isVerbose(e+"."+t)[1]}static display(e,t,r){We.isMethodVerboseEntry(e,t)&&console.log(`${e}.${t}: ${r}`)}static log(e){const t=e.name;for(const r of Object.getOwnPropertyNames(e.prototype)){const s=Object.getOwnPropertyDescriptor(e.prototype,r),i=pe.getNonNullable(s);pe.assert(i.value instanceof Function,"cannot add logging to properties that are not methods!");const c=i.value;i.value=function(...u){if(We.isMethodVerboseEntry(t,r)){const g=Array.from(u).map(m=>JSON.stringify(m)).join(", ");console.log(`> ${t}.${r}(${g})`)}const h=c.apply(this,u);return We.isMethodVerboseExit(t,r)&&console.log(`< ${t}.${r} -> ${JSON.stringify(h)}`),h},Object.defineProperty(e.prototype,r,i)}}}window.enableLog=We.enableLog;class pe{static expectToBe(e,t,r){if(e!==t)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${t}, but got ${e} instead.`)}static expectToBeMultiple(e,t){let r=!1;for(const s of t)if(e===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${t}, but got ${e} instead.`)}static getNonNullable(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}static assert(e,t){if(!1===e)throw Ts.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}static identity(e){return e}}let C8=class extends Z5{constructor(e){super("chats",e)}};C8.\u0275fac=function(e){return new(e||C8)(De(v8))},C8.\u0275prov=nt({token:C8,factory:C8.\u0275fac,providedIn:"root"}),C8=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],C8);let _ne=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),L3=class{constructor(e){this.chatDAO=e}addMessage(e,t){var r=this;return I(function*(){return r.chatDAO.subCollectionDAO(e,"messages").create(t)})()}getLastMessages(e,t){var r=this;return I(function*(){return r.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t)})()}subscribeToMessages(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}deleteChat(e){var t=this;return I(function*(){return t.chatDAO.delete(e)})()}createNewChat(e){var t=this;return I(function*(){return t.chatDAO.set(e,{})})()}sendMessage(e,t,r,s){var i=this;return I(function*(){if(!1===i.userCanSendMessage(t.name,e))return R.failure(_ne.CANNOT_SEND_MESSAGE());if(i.isForbiddenMessage(r))return R.failure(_ne.FORBIDDEN_MESSAGE());const o={content:r,sender:t,postedTime:U4(),currentTurn:s};return yield i.addMessage(e,o),R.SUCCESS})()}userCanSendMessage(e,t){return""!==e}isForbiddenMessage(e){return""===e}};function qe(n,e,t){if(!1===n)throw void 0!==t&&console.log(t),Ts.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}var xH;L3.\u0275fac=function(e){return new(e||L3)(De(C8))},L3.\u0275prov=nt({token:L3,factory:L3.\u0275fac,providedIn:"root"}),L3=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],L3);let R3=xH=class extends Z5{constructor(e){super(xH.COLLECTION_NAME,e)}};R3.COLLECTION_NAME="users",R3.\u0275fac=function(e){return new(e||R3)(De(v8))},R3.\u0275prov=nt({token:R3,factory:R3.\u0275fac,providedIn:"root"}),R3=xH=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],R3);let i9=(()=>{class n{constructor(t){this.userDAO=t}usernameIsAvailable(t){var r=this;return I(function*(){return 0===(yield r.userDAO.findWhere([["username","==",t]])).length})()}setUsername(t,r){var s=this;return I(function*(){yield s.userDAO.update(t,{username:r})})()}markAsVerified(t){var r=this;return I(function*(){yield r.userDAO.update(t,{verified:!0})})()}observeUserOnServer(t,r){return this.userDAO.subscribeToChanges(t,s=>{s.isPresent()&&null===s.get().lastUpdateTime||r(s)})}getUserLastUpdateTime(t){var r=this;return I(function*(){const s=yield r.userDAO.read(t);if(s.isAbsent())return y.empty();{const i=s.get().lastUpdateTime;return qe(null!=i,"should not receive a lastUpdateTime equal to null"),y.of(i)}})()}updatePresenceToken(t){return this.userDAO.update(t,{lastUpdateTime:U4()})}getServerTime(t){var r=this;return I(function*(){return new Promise(s=>{let i=!1;const c=r.userDAO.subscribeToChanges(t,u=>{null==u.get().lastUpdateTime?i=!0:i&&(c.unsubscribe(),s(u.get().lastUpdateTime))});r.updatePresenceToken(t)})})()}}return n.\u0275fac=function(t){return new(t||n)(De(R3))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class vne extends F2{constructor(e=1/0,t=1/0,r=rD){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;t||(r.push(e),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!e.closed;o+=r?1:2)e.next(i[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*e;if(e<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=t.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let a_=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class y8{static createUserWithEmailAndPassword(e,t,r){return Wbe(e,t,r)}static sendEmailVerification(e){return Ybe(e)}static sendPasswordResetEmail(e,t){return Kbe(e,t)}static signInWithEmailAndPassword(e,t,r){return I(function*(){return(yield Xbe(e,t,r)).user})()}static signInWithPopup(e,t){return I(function*(){return(yield Qbe(e,t)).user})()}static updateProfile(e,t){return Jbe(e,t)}}class Y5{constructor(e,t,r,s){this.id=e,this.email=t,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(e){return this.id===e.id&&this.email.equals(e.email)&&this.username.equals(e.username)&&this.verified===e.verified}}Y5.NOT_CONNECTED=new Y5("",y.empty(),y.empty(),!1);let Q1=class{constructor(e,t,r){var s=this;this.userDAO=e,this.userService=t,this.auth=r,this.user=y.empty(),this.userSubscription=new I1,this.userRS=new vne(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new I1(Zbe(this.auth,function(){var i=I(function*(o){null==o?(We.display("ConnectedUserService","subscription","User is not connected"),s.userSubscription.unsubscribe(),s.userRS.next(Y5.NOT_CONNECTED),s.user=y.empty()):(qe(s.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),s.userSubscription=s.userDAO.subscribeToChanges(o.uid,c=>{if(c.isPresent()){const u=c.get(),h=u.username;We.display("ConnectedUserService","subscription",`User ${h} is connected, and the verified status is ${s.emailVerified(o)}`);const g=!0===s.emailVerified(o)&&null!=h;if(!0===g&&!1===u.verified)return s.userService.markAsVerified(o.uid);const m=new Y5(o.uid,y.ofNullable(o.email),y.ofNullable(h),g);!1===s.user.equalsValue(m)&&(s.user=y.of(m),s.userRS.next(m))}}))});return function(o){return i.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var t=this;return I(function*(){try{return yield y8.sendPasswordResetEmail(t.auth,e),R.SUCCESS}catch(r){return R.failure(t.mapFirebaseError(r))}})()}doRegister(e,t,r){var s=this;return I(function*(){return(yield s.userService.usernameIsAvailable(e))?s.registerAfterUsernameCheck(e,t,r):_e.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,t,r){var s=this;return I(function*(){try{const i=yield y8.createUserWithEmailAndPassword(s.auth,t,r);yield y8.signInWithEmailAndPassword(s.auth,t,r);const o=pe.getNonNullable(i.user);return yield s.createUser(o.uid,e),_e.success(o)}catch(i){return _e.failure(s.mapFirebaseError(i))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return Ts.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return I(function*(){const t=y.ofNullable(e.auth.currentUser);if(!t.isPresent())return Ts.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(t.get()))return Ts.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield y8.sendEmailVerification(t.get()),R.SUCCESS}catch(r){return R.failure(e.mapFirebaseError(r))}})()}doEmailLogin(e,t){var r=this;return I(function*(){try{return yield y8.signInWithEmailAndPassword(r.auth,e,t),R.SUCCESS}catch(s){return R.failure(r.mapFirebaseError(s))}})()}createUser(e,t){var r=this;return I(function*(){null==t?yield r.userDAO.set(e,{verified:!1,currentGame:null}):yield r.userDAO.set(e,{username:t,verified:!1,currentGame:null})})()}doGoogleLogin(){var e=this;return I(function*(){return R.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return I(function*(){try{const t=new FTe;t.addScope("profile"),t.addScope("email");const r=yield y8.signInWithPopup(e.auth,t);return!1===(yield e.userDAO.exists(r.uid))&&(yield e.createUser(r.uid)),_e.success(r)}catch(t){return _e.failure(e.mapFirebaseError(t))}})()}disconnect(){var e=this;return I(function*(){return y.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),R.SUCCESS):R.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var t=this;return I(function*(){if(""===e)return R.failure($localize`Your username may not be empty.`);try{if(!1===(yield t.userService.usernameIsAvailable(e)))return R.failure($localize`This username is already in use, please select a different one.`);const s=pe.getNonNullable(t.auth.currentUser);return yield y8.updateProfile(s,{displayName:e}),yield t.userService.setUsername(s.uid,e),yield t.userService.markAsVerified(s.uid),yield t.reloadUser(),R.SUCCESS}catch(r){return R.failure(t.mapFirebaseError(r))}})()}setPicture(e){var t=this;return I(function*(){try{const r=pe.getNonNullable(t.auth.currentUser);return yield y8.updateProfile(r,{photoURL:e}),R.SUCCESS}catch(r){return R.failure(t.mapFirebaseError(r))}})()}reloadUser(){var e=this;return I(function*(){const t=pe.getNonNullable(e.auth.currentUser);yield t.getIdToken(!0),yield t.reload()})()}sendPresenceToken(){return qe(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}};Q1.\u0275fac=function(e){return new(e||Q1)(De(R3),De(i9),De(dP))},Q1.\u0275prov=nt({token:Q1,factory:Q1.\u0275fac,providedIn:"root"}),Q1=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],Q1);class S1{constructor(e){this.value=e}}S1.HARD_DRAW=new S1(0),S1.RESIGN=new S1(1),S1.ESCAPE=new S1(2),S1.VICTORY=new S1(3),S1.TIMEOUT=new S1(4),S1.UNACHIEVED=new S1(5),S1.AGREED_DRAW_BY_ZERO=new S1(6),S1.AGREED_DRAW_BY_ONE=new S1(7);class gP{constructor(e,t){this.id=e,this.data=t}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===S1.HARD_DRAW.value}isAgreedDraw(){return this.data.result===S1.AGREED_DRAW_BY_ZERO.value||this.data.result===S1.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===S1.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(qe(this.data.result===S1.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),pe.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===S1.VICTORY.value}isTimeout(){return this.data.result===S1.TIMEOUT.value}isResign(){return this.data.result===S1.RESIGN.value}getWinner(){return y.ofNullable(this.data.winner)}getLoser(){return y.ofNullable(this.data.loser)}setWinnerAndLoser(e,t){return new gP(this.id,{...this.data,winner:e,loser:t})}}class Us{constructor(e){this.value=e}static of(e){switch(e){case"CREATOR":return Us.CREATOR;case"RANDOM":return Us.RANDOM;default:return qe("CHOSEN_PLAYER"===e,"Invalid value for FirstPlayer: "+e+"."),Us.CHOSEN_PLAYER}}}Us.CREATOR=new Us("CREATOR"),Us.RANDOM=new Us("RANDOM"),Us.CHOSEN_PLAYER=new Us("CHOSEN_PLAYER");class Pr{constructor(e){this.value=e}static of(e){switch(e){case"STANDARD":return Pr.STANDARD;case"BLITZ":return Pr.BLITZ;case"CUSTOM":return Pr.CUSTOM;default:throw new Error("Invalid part type: "+e+".")}}}Pr.STANDARD=new Pr("STANDARD"),Pr.BLITZ=new Pr("BLITZ"),Pr.CUSTOM=new Pr("CUSTOM"),Pr.NORMAL_MOVE_DURATION=120,Pr.NORMAL_PART_DURATION=1800,Pr.BLITZ_MOVE_DURATION=30,Pr.BLITZ_PART_DURATION=900;class qs{constructor(e){this.value=e}}qs.PART_CREATED=new qs(0),qs.CONFIG_PROPOSED=new qs(2),qs.PART_STARTED=new qs(3),qs.PART_FINISHED=new qs(4);class kH{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(e){return this===e}}kH.NONE=new kH;class B{constructor(e){this.value=e}static of(e){return 0===e?B.ZERO:(pe.expectToBe(e,1),B.ONE)}static ofTurn(e){return e%2==0?B.ZERO:B.ONE}isPlayer(){return!0}toString(){return this===B.ZERO?"PLAYER_ZERO":(pe.expectToBe(this,B.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(e){return this===e}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===B.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===B.ZERO?B.ONE:(pe.expectToBe(this,B.ONE),B.ZERO)}}var le;B.encoder=Ye.tuple([Ye.identity()],n=>[n.value],n=>B.of(n[0])),B.ZERO=new B(0),B.ONE=new B(1),B.PLAYERS=[B.ZERO,B.ONE],function(n){n.ZERO=B.ZERO,n.ONE=B.ONE,n.NONE=kH.NONE,n.encoder=new class extends Ye{encode(e){return e.value}decode(e){return 2===e?n.NONE:(pe.assert(0===e||1===e,"Invalid encoded player: "+e),B.of(e))}}}(le||(le={}));let W4=class extends Z5{constructor(e){super("parts",e)}};W4.\u0275fac=function(e){return new(e||W4)(De(v8))},W4.\u0275prov=nt({token:W4,factory:W4.\u0275fac,providedIn:"root"}),W4=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],W4);class mP{constructor(e,t,r){this.onDocumentCreated=e,this.onDocumentModified=t,this.onDocumentDeleted=r}}let LH=(()=>{class n{constructor(t){this.partDAO=t}eventsCollection(t){return this.partDAO.subCollectionDAO(t,"events")}addEvent(t,r){return this.eventsCollection(t).create(r)}addMove(t,r,s){return this.addEvent(t,{eventType:"Move",time:U4(),player:r.value,move:s})}addRequest(t,r,s){return this.addEvent(t,{eventType:"Request",time:U4(),player:r.value,requestType:s})}addReply(t,r,s,i,o=null){return this.addEvent(t,{eventType:"Reply",time:U4(),player:r.value,reply:s,requestType:i,data:o})}startGame(t,r){return this.addAction(t,r,"StartGame")}addAction(t,r,s){return this.addEvent(t,{eventType:"Action",time:U4(),player:r.value,action:s})}subscribeToEvents(t,r){const s=new mP(i=>{const o=i.map(c=>c.data).filter(c=>null!=c.time);o.length>0&&r(o)},i=>{r(i.map(o=>o.data))},()=>{});return this.eventsCollection(t).observingWhere([],s,"time")}}return n.\u0275fac=function(t){return new(t||n)(De(W4))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),E8=class extends Z5{constructor(e){super("config-room",e)}};var RH;E8.\u0275fac=function(e){return new(e||E8)(De(v8))},E8.\u0275prov=nt({token:E8,factory:E8.\u0275fac,providedIn:"root"}),E8=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],E8);let D3=RH=class{constructor(e,t){this.configRoomDAO=e,this.connectedUserService=t}addCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}removeCandidate(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}subscribeToChanges(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}subscribeToCandidates(e,t){let r=[];const s=new mP(o=>{for(const c of o)r.push(c.data);t(r)},o=>{for(const c of o)r=r.map(u=>u.id===c.data.id?c.data:u);t(r)},o=>{for(const c of o)r=r.filter(u=>u.id!==c.data.id);t(r)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],s)}createInitialConfigRoom(e){var t=this;return I(function*(){const r=t.connectedUserService.user.get().toMinimalUser();return t.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:Us.RANDOM.value,partType:Pr.STANDARD.value,partStatus:qs.PART_CREATED.value,maximalMoveDuration:Pr.NORMAL_MOVE_DURATION,totalPartDuration:Pr.NORMAL_PART_DURATION,creator:r})})()}joinGame(e){var t=this;return I(function*(){const r=t.connectedUserService.user.get().toMinimalUser(),s=yield t.configRoomDAO.read(e);return s.isAbsent()?R.failure(RH.GAME_DOES_NOT_EXIST()):(s.get().creator.id!==r.id&&(yield t.addCandidate(e,r)),R.SUCCESS)})()}cancelJoining(e){var t=this;return I(function*(){const r=t.connectedUserService.user.get().toMinimalUser(),s=yield t.configRoomDAO.read(e);if(!s.isAbsent()){const i=s.get(),o=[t.removeCandidate(e,r)];i.chosenOpponent?.id===r.id&&o.push(t.configRoomDAO.update(e,{chosenOpponent:null,partStatus:qs.PART_CREATED.value})),yield Promise.all(o)}})()}deleteConfigRoom(e,t){var r=this;return I(function*(){yield Promise.all(t.map(s=>r.removeCandidate(e,s))),yield r.configRoomDAO.delete(e)})()}proposeConfig(e,t,r,s,i,o){var c=this;return I(function*(){return c.configRoomDAO.update(e,{partStatus:qs.CONFIG_PROPOSED.value,chosenOpponent:t,partType:r.value,maximalMoveDuration:s,totalPartDuration:o,firstPlayer:i.value})})()}setChosenOpponent(e,t){return this.configRoomDAO.update(e,{chosenOpponent:t})}reviewConfig(e){var t=this;return I(function*(){return t.configRoomDAO.update(e,{partStatus:qs.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var t=this;return I(function*(){return t.configRoomDAO.update(e,{partStatus:qs.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return this.configRoomDAO.update(e,{partStatus:qs.PART_STARTED.value})}createConfigRoom(e,t){var r=this;return I(function*(){return r.configRoomDAO.set(e,t)})()}readConfigRoomById(e){var t=this;return I(function*(){return(yield t.configRoomDAO.read(e)).get()})()}};D3.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,D3.\u0275fac=function(e){return new(e||D3)(De(E8),De(Q1))},D3.\u0275prov=nt({token:D3,factory:D3.\u0275fac,providedIn:"root"}),D3=RH=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],D3);let z3=class{constructor(e,t,r,s,i){this.partDAO=e,this.gameEventService=t,this.connectedUserService=r,this.configRoomService=s,this.chatService=i}update(e,t){var r=this;return I(function*(){return r.partDAO.update(e,t)})()}getPartValidity(e,t){var r=this;return I(function*(){const s=yield r.partDAO.read(e);return s.isAbsent()?R.failure("NONEXISTENT_PART"):s.get().typeGame===t?R.SUCCESS:R.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){const t=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({typeGame:e,playerZero:t,turn:-1,result:S1.UNACHIEVED.value})}createChat(e){return this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var t=this;return I(function*(){const r=yield t.createUnstartedPart(e);return yield t.configRoomService.createInitialConfigRoom(r),yield t.createChat(r),r})()}getStartingConfig(e){let r,s,t=Us.of(e.firstPlayer);return t===Us.RANDOM&&(t=Math.random()<.5?Us.CREATOR:Us.CHOSEN_PLAYER),t===Us.CREATOR?(r=e.creator,s=pe.getNonNullable(e.chosenOpponent)):(r=pe.getNonNullable(e.chosenOpponent),s=e.creator),{playerZero:r,playerOne:s,turn:0,beginning:U4()}}deletePart(e){return this.partDAO.delete(e)}acceptConfig(e,t){var r=this;return I(function*(){yield r.configRoomService.acceptConfig(e);const s=r.getStartingConfig(t);let i;i=s.playerZero===t.creator?B.ONE:B.ZERO,yield r.partDAO.update(e,s),yield r.gameEventService.startGame(e,i)})()}getPart(e){return this.partDAO.read(e)}subscribeToChanges(e,t){return this.partDAO.subscribeToChanges(e,t)}resign(e,t,r,s){var i=this;return I(function*(){const o={winner:r,loser:s,result:S1.RESIGN.value};yield i.partDAO.update(e,o),yield i.gameEventService.addAction(e,t,"EndGame")})()}notifyTimeout(e,t,r,s){var i=this;return I(function*(){const o={winner:r,loser:s,result:S1.TIMEOUT.value};yield i.partDAO.update(e,o),yield i.gameEventService.addAction(e,t,"EndGame")})()}proposeDraw(e,t){var r=this;return I(function*(){yield r.gameEventService.addRequest(e,t,"Draw")})()}acceptDraw(e,t){var r=this;return I(function*(){yield r.gameEventService.addReply(e,t,"Accept","Draw");const i={result:(t===B.ZERO?S1.AGREED_DRAW_BY_ZERO:S1.AGREED_DRAW_BY_ONE).value};yield r.partDAO.update(e,i),yield r.gameEventService.addAction(e,t,"EndGame")})()}refuseDraw(e,t){var r=this;return I(function*(){yield r.gameEventService.addReply(e,t,"Reject","Draw")})()}proposeRematch(e,t){var r=this;return I(function*(){yield r.gameEventService.addRequest(e,t,"Rematch")})()}rejectRematch(e,t){var r=this;return I(function*(){yield r.gameEventService.addReply(e,t,"Reject","Rematch")})()}acceptRematch(e,t){var r=this;return I(function*(){const s=pe.getNonNullable(e.data),i=yield r.configRoomService.readConfigRoomById(e.id);let o;const c=r.connectedUserService.user.get().toMinimalUser();let u;s.playerZero.id===c.id?(u=pe.getNonNullable(s.playerOne),o=Us.CHOSEN_PLAYER):(u=s.playerZero,o=Us.CREATOR);const h={...i,firstPlayer:o.value,creator:c,chosenOpponent:u,partStatus:qs.PART_STARTED.value},g=r.getStartingConfig(h),m={typeGame:s.typeGame,result:S1.UNACHIEVED.value,...g},M=yield r.partDAO.create(m);yield r.configRoomService.createConfigRoom(M,h),yield r.createChat(M),yield r.gameEventService.addReply(e.id,t,"Accept","Rematch",M),yield r.gameEventService.startGame(M,t.getOpponent())})()}askTakeBack(e,t){var r=this;return I(function*(){yield r.gameEventService.addRequest(e,t,"TakeBack")})()}acceptTakeBack(e,t,r){var s=this;return I(function*(){let i=t-1;i%2===r.value&&i--;const o={turn:i};return yield s.gameEventService.addReply(e,r,"Accept","TakeBack"),yield s.partDAO.update(e,o)})()}refuseTakeBack(e,t){var r=this;return I(function*(){yield r.gameEventService.addReply(e,t,"Reject","TakeBack")})()}addGlobalTime(e,t){var r=this;return I(function*(){yield r.gameEventService.addAction(e,t,"AddGlobalTime")})()}addTurnTime(e,t){var r=this;return I(function*(){yield r.gameEventService.addAction(e,t,"AddTurnTime")})()}preparePartUpdate(e,t){var r=this;return I(function*(){let o={turn:(yield r.partDAO.read(e)).get().turn+1};return o=r.updateScore(o,t),o})()}updatePart(e,t){var r=this;return I(function*(){const s=yield r.preparePartUpdate(e,t);yield r.update(e,s)})()}drawPart(e,t,r){var s=this;return I(function*(){let i=yield s.preparePartUpdate(e,r);i={...i,result:S1.HARD_DRAW.value},yield s.update(e,i),yield s.gameEventService.addAction(e,t,"EndGame")})()}endPartWithVictory(e,t,r,s,i){var o=this;return I(function*(){let c=yield o.preparePartUpdate(e,i);c={...c,winner:r,loser:s,result:S1.VICTORY.value},yield o.update(e,c),yield o.gameEventService.addAction(e,t,"EndGame")})()}addMove(e,t,r){var s=this;return I(function*(){yield s.gameEventService.addMove(e,t,r)})()}updateScore(e,t){return t.isPresent()?{...e,scorePlayerZero:t.get()[0],scorePlayerOne:t.get()[1]}:e}};z3.\u0275fac=function(e){return new(e||z3)(De(W4),De(LH),De(Q1),De(D3),De(L3))},z3.\u0275prov=nt({token:z3,factory:z3.\u0275fac,providedIn:"root"}),z3=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],z3);var $ne={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},Zne={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Yne={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class c_{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??c_.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let e1e=(()=>{class n{changeTheme(t){localStorage.setItem("theme",t)}getTheme(){return y.ofNullable(localStorage.getItem("theme"))}changeLanguage(t){localStorage.setItem("locale",t.toLowerCase())}getLanguage(){return c_.getLocale()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),_P=(()=>{class n{constructor(t,r){this.document=t,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const t=this.userSettingsService.getTheme();if(t.isPresent()){const r=t.get();if(this.availableThemes.some(s=>s===r))return y.of(r)}return y.empty()}loadTheme(t){this.loadStyle(t+".css"),this.theme=t}loadStyle(t){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=t;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${t}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(t){return new(t||n)(De(Hs),De(e1e))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function t1e(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function Pt(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?t1e(Object(t),!0).forEach(function(r){hi(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):t1e(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function vP(n){return(vP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function n1e(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function hi(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zH(n,e){return function fze(n){if(Array.isArray(n))return n}(n)||function dze(n,e){var t=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var o,c,r=[],s=!0,i=!1;try{for(t=t.call(n);!(s=(o=t.next()).done)&&(r.push(o.value),!e||r.length!==e);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=t.return&&t.return()}finally{if(i)throw c}}return r}}(n,e)||r1e(n,e)||function gze(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u_(n){return function uze(n){if(Array.isArray(n))return HH(n)}(n)||function hze(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||r1e(n)||function pze(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r1e(n,e){if(n){if("string"==typeof n)return HH(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if("Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t)return Array.from(n);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return HH(n,e)}}function HH(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var s1e=function(){},VH={},i1e={},o1e=null,a1e={mark:s1e,measure:s1e};try{typeof window<"u"&&(VH=window),typeof document<"u"&&(i1e=document),typeof MutationObserver<"u"&&(o1e=MutationObserver),typeof performance<"u"&&(a1e=performance)}catch{}var EP,MP,SP,PP,TP,c1e=(VH.navigator||{}).userAgent,l1e=void 0===c1e?"":c1e,M8=VH,Tr=i1e,u1e=o1e,yP=a1e,S6=!!Tr.documentElement&&!!Tr.head&&"function"==typeof Tr.addEventListener&&"function"==typeof Tr.createElement,f1e=~l1e.indexOf("MSIE")||~l1e.indexOf("Trident/"),P6="___FONT_AWESOME___",d1e="svg-inline--fa",K5="data-fa-i2svg",BH="data-fa-pseudo-element",$H="data-prefix",GH="data-icon",p1e="fontawesome-i2svg",Cze=["HTML","HEAD","STYLE","SCRIPT"],g1e=function(){try{return!0}catch{return!1}}(),wr="classic",ls="sharp",UH=[wr,ls];function f_(n){return new Proxy(n,{get:function(t,r){return r in t?t[r]:t[wr]}})}var h_=f_((hi(EP={},wr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),hi(EP,ls,{fa:"solid",fass:"solid","fa-solid":"solid"}),EP)),d_=f_((hi(MP={},wr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),hi(MP,ls,{solid:"fass"}),MP)),p_=f_((hi(SP={},wr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),hi(SP,ls,{fass:"fa-solid"}),SP)),yze=f_((hi(PP={},wr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),hi(PP,ls,{"fa-solid":"fass"}),PP)),Eze=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,m1e="fa-layers-text",Mze=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,Sze=f_((hi(TP={},wr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),hi(TP,ls,{900:"fass"}),TP)),_1e=[1,2,3,4,5,6,7,8,9,10],Pze=_1e.concat([11,12,13,14,15,16,17,18,19,20]),Tze=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],g_=new Set;Object.keys(d_[wr]).map(g_.add.bind(g_)),Object.keys(d_[ls]).map(g_.add.bind(g_));var wze=[].concat(UH,u_(g_),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(_1e.map(function(n){return"".concat(n,"x")})).concat(Pze.map(function(n){return"w-".concat(n)})),m_=M8.FontAwesomeConfig||{};Tr&&"function"==typeof Tr.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var e=zH(n,2),r=e[1],s=function Oze(n){return""===n||"false"!==n&&("true"===n||n)}(function bze(n){var e=Tr.querySelector("script["+n+"]");if(e)return e.getAttribute(n)}(e[0]));null!=s&&(m_[r]=s)});var v1e={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:d1e,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};m_.familyPrefix&&(m_.cssPrefix=m_.familyPrefix);var o9=Pt(Pt({},v1e),m_);o9.autoReplaceSvg||(o9.observeMutations=!1);var xt={};Object.keys(v1e).forEach(function(n){Object.defineProperty(xt,n,{enumerable:!0,set:function(t){o9[n]=t,__.forEach(function(r){return r(xt)})},get:function(){return o9[n]}})}),Object.defineProperty(xt,"familyPrefix",{enumerable:!0,set:function(e){o9.cssPrefix=e,__.forEach(function(t){return t(xt)})},get:function(){return o9.cssPrefix}}),M8.FontAwesomeConfig=xt;var __=[],j4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function v_(){for(var n=12,e="";n-- >0;)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return e}function a9(n){for(var e=[],t=(n||[]).length>>>0;t--;)e[t]=n[t];return e}function qH(n){return n.classList?a9(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(e){return e})}function C1e(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function wP(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,": ").concat(n[t].trim(),";")},"")}function WH(n){return n.size!==j4.size||n.x!==j4.x||n.y!==j4.y||n.rotate!==j4.rotate||n.flipX||n.flipY}function y1e(){var n="fa",e=d1e,t=xt.cssPrefix,r=xt.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(t!==n||r!==e){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(e),"g");s=s.replace(i,".".concat(t,"-")).replace(o,"--".concat(t,"-")).replace(c,".".concat(r))}return s}var E1e=!1;function jH(){xt.autoAddCss&&!E1e&&(function Ize(n){if(n&&S6){var e=Tr.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=n;for(var t=Tr.head.childNodes,r=null,s=t.length-1;s>-1;s--){var i=t[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}Tr.head.insertBefore(e,r)}}(y1e()),E1e=!0)}var zze={mixout:function(){return{dom:{css:y1e,insertCss:jH}}},hooks:function(){return{beforeDOMElementCreation:function(){jH()},beforeI2svg:function(){jH()}}}},T6=M8||{};T6[P6]||(T6[P6]={}),T6[P6].styles||(T6[P6].styles={}),T6[P6].hooks||(T6[P6].hooks={}),T6[P6].shims||(T6[P6].shims=[]);var H3=T6[P6],M1e=[],bP=!1;function Vze(n){!S6||(bP?setTimeout(n,0):M1e.push(n))}function C_(n){var e=n.tag,t=n.attributes,r=void 0===t?{}:t,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?C1e(n):"<".concat(e," ").concat(function kze(n){return Object.keys(n||{}).reduce(function(e,t){return e+"".concat(t,'="').concat(C1e(n[t]),'" ')},"").trim()}(r),">").concat(i.map(C_).join(""),"</").concat(e,">")}function S1e(n,e,t){if(n&&n[e]&&n[e][t])return{prefix:e,iconName:t,icon:n[e][t]}}S6&&((bP=(Tr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Tr.readyState))||Tr.addEventListener("DOMContentLoaded",function n(){Tr.removeEventListener("DOMContentLoaded",n),bP=1,M1e.map(function(e){return e()})}));var ZH=function(e,t,r,s){var u,h,g,i=Object.keys(e),o=i.length,c=void 0!==s?function(e,t){return function(r,s,i,o){return e.call(t,r,s,i,o)}}(t,s):t;for(void 0===r?(u=1,g=e[i[0]]):(u=0,g=r);u<o;u++)g=c(g,e[h=i[u]],h,e);return g};function YH(n){var e=function Bze(n){for(var e=[],t=0,r=n.length;t<r;){var s=n.charCodeAt(t++);if(s>=55296&&s<=56319&&t<r){var i=n.charCodeAt(t++);56320==(64512&i)?e.push(((1023&s)<<10)+(1023&i)+65536):(e.push(s),t--)}else e.push(s)}return e}(n);return 1===e.length?e[0].toString(16):null}function P1e(n){return Object.keys(n).reduce(function(e,t){var r=n[t];return r.icon?e[r.iconName]=r.icon:e[t]=r,e},{})}function KH(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.skipHooks,s=void 0!==r&&r,i=P1e(e);"function"!=typeof H3.hooks.addPack||s?H3.styles[n]=Pt(Pt({},H3.styles[n]||{}),i):H3.hooks.addPack(n,P1e(e)),"fas"===n&&KH("fa",e)}var OP,AP,NP,c9=H3.styles,Gze=H3.shims,Uze=(hi(OP={},wr,Object.values(p_[wr])),hi(OP,ls,Object.values(p_[ls])),OP),XH=null,T1e={},w1e={},b1e={},O1e={},A1e={},qze=(hi(AP={},wr,Object.keys(h_[wr])),hi(AP,ls,Object.keys(h_[ls])),AP);function jze(n,e){var t=e.split("-"),r=t[0],s=t.slice(1).join("-");return r!==n||""===s||function Wze(n){return~wze.indexOf(n)}(s)?null:s}var N1e=function(){var e=function(i){return ZH(c9,function(o,c,u){return o[u]=ZH(c,i,{}),o},{})};T1e=e(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),w1e=e(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),A1e=e(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var t="far"in c9||xt.autoFetchSvg,r=ZH(Gze,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!t&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});b1e=r.names,O1e=r.unicodes,XH=IP(xt.styleDefault,{family:xt.familyDefault})};function QH(n,e){return(T1e[n]||{})[e]}function Q5(n,e){return(A1e[n]||{})[e]}function I1e(n){return b1e[n]||{prefix:null,iconName:null}}function P8(){return XH}function IP(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.family,r=void 0===t?wr:t,s=h_[r][n],i=d_[r][n]||d_[r][s],o=n in H3.styles?n:null;return i||o||null}(function Nze(n){__.push(n)})(function(n){XH=IP(n.styleDefault,{family:xt.familyDefault})}),N1e();var x1e=(hi(NP={},wr,Object.keys(p_[wr])),hi(NP,ls,Object.keys(p_[ls])),NP);function xP(n){var e,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.skipLookups,s=void 0!==r&&r,i=(hi(e={},wr,"".concat(xt.cssPrefix,"-").concat(wr)),hi(e,ls,"".concat(xt.cssPrefix,"-").concat(ls)),e),o=null,c=wr;(n.includes(i[wr])||n.some(function(h){return x1e[wr].includes(h)}))&&(c=wr),(n.includes(i[ls])||n.some(function(h){return x1e[ls].includes(h)}))&&(c=ls);var u=n.reduce(function(h,g){var m=jze(xt.cssPrefix,g);if(c9[g]?(g=Uze[c].includes(g)?yze[c][g]:g,o=g,h.prefix=g):qze[c].indexOf(g)>-1?(o=g,h.prefix=IP(g,{family:c})):m?h.iconName=m:g!==xt.replacementClass&&g!==i[wr]&&g!==i[ls]&&h.rest.push(g),!s&&h.prefix&&h.iconName){var M="fa"===o?I1e(h.iconName):{},b=Q5(h.prefix,h.iconName);M.prefix&&(o=null),h.iconName=M.iconName||b||h.iconName,h.prefix=M.prefix||h.prefix,"far"===h.prefix&&!c9.far&&c9.fas&&!xt.autoFetchSvg&&(h.prefix="fas")}return h},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===ls&&(c9.fass||xt.autoFetchSvg)&&(u.prefix="fass",u.iconName=Q5(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=P8()||"fas"),u}var Kze=function(){function n(){(function aze(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function cze(n,e,t){e&&n1e(n.prototype,e),t&&n1e(n,t),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var t=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){t.definitions[c]=Pt(Pt({},t.definitions[c]||{}),o[c]),KH(c,o[c]);var u=p_[wr][c];u&&KH(u,o[c]),N1e()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,h=o.icon,g=h[2];t[c]||(t[c]={}),g.length>0&&g.forEach(function(m){"string"==typeof m&&(t[c][m]=h)}),t[c][u]=h}),t}}]),n}(),k1e=[],l9={},u9={},Xze=Object.keys(u9);function eV(n,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),s=2;s<t;s++)r[s-2]=arguments[s];var i=l9[n]||[];return i.forEach(function(o){e=o.apply(null,[e].concat(r))}),e}function J5(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];var s=l9[n]||[];s.forEach(function(i){i.apply(null,t)})}function w6(){var n=arguments[0],e=Array.prototype.slice.call(arguments,1);return u9[n]?u9[n].apply(null,e):void 0}function tV(n){"fa"===n.prefix&&(n.prefix="fas");var e=n.iconName,t=n.prefix||P8();if(e)return e=Q5(t,e)||e,S1e(L1e.definitions,t,e)||S1e(H3.styles,t,e)}var L1e=new Kze,eHe={i2svg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return S6?(J5("beforeI2svg",e),w6("pseudoElements2svg",e),w6("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot;!1===xt.autoReplaceSvg&&(xt.autoReplaceSvg=!0),xt.observeMutations=!0,Vze(function(){nHe({autoReplaceSvgRoot:t}),J5("watch",e)})}},Ka={noAuto:function(){xt.autoReplaceSvg=!1,xt.observeMutations=!1,J5("noAuto")},config:xt,dom:eHe,parse:{icon:function(e){if(null===e)return null;if("object"===vP(e)&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:Q5(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){var t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],r=IP(e[0]);return{prefix:r,iconName:Q5(r,t)||t}}if("string"==typeof e&&(e.indexOf("".concat(xt.cssPrefix,"-"))>-1||e.match(Eze))){var s=xP(e.split(" "),{skipLookups:!0});return{prefix:s.prefix||P8(),iconName:Q5(s.prefix,s.iconName)||s.iconName}}if("string"==typeof e){var i=P8();return{prefix:i,iconName:Q5(i,e)||e}}}},library:L1e,findIconDefinition:tV,toHtml:C_},nHe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.autoReplaceSvgRoot,r=void 0===t?Tr:t;(Object.keys(H3.styles).length>0||xt.autoFetchSvg)&&S6&&xt.autoReplaceSvg&&Ka.dom.i2svg({node:r})};function kP(n,e){return Object.defineProperty(n,"abstract",{get:e}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return C_(r)})}}),Object.defineProperty(n,"node",{get:function(){if(S6){var r=Tr.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function nV(n){var e=n.icons,t=e.main,r=e.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,h=n.maskId,g=n.titleId,m=n.extra,M=n.watchable,b=void 0!==M&&M,L=r.found?r:t,G=L.width,j=L.height,ie="fak"===s,ye=[xt.replacementClass,i?"".concat(xt.cssPrefix,"-").concat(i):""].filter(function(jt){return-1===m.classes.indexOf(jt)}).filter(function(jt){return""!==jt||!!jt}).concat(m.classes).join(" "),te={children:[],attributes:Pt(Pt({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:ye,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(G," ").concat(j)})},xe=ie&&!~m.classes.indexOf("fa-fw")?{width:"".concat(G/j*16*.0625,"em")}:{};b&&(te.attributes[K5]=""),u&&(te.children.push({tag:"title",attributes:{id:te.attributes["aria-labelledby"]||"title-".concat(g||v_())},children:[u]}),delete te.attributes.title);var $e=Pt(Pt({},te),{},{prefix:s,iconName:i,main:t,mask:r,maskId:h,transform:o,symbol:c,styles:Pt(Pt({},xe),m.styles)}),et=r.found&&t.found?w6("generateAbstractMask",$e)||{children:[],attributes:{}}:w6("generateAbstractIcon",$e)||{children:[],attributes:{}},H1=et.attributes;return $e.children=et.children,$e.attributes=H1,c?function sHe(n){var t=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(xt.cssPrefix,"-").concat(t):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Pt(Pt({},s),{},{id:o}),children:r}]}]}($e):function rHe(n){var e=n.children,t=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(WH(o)&&t.found&&!r.found){var h={x:t.width/t.height/2,y:.5};s.style=wP(Pt(Pt({},i),{},{"transform-origin":"".concat(h.x+o.x/16,"em ").concat(h.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:e}]}($e)}function R1e(n){var e=n.content,t=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,h=Pt(Pt(Pt({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(h[K5]="");var g=Pt({},o.styles);WH(s)&&(g.transform=function Rze(n){var e=n.transform,t=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&f1e?"translate(".concat(e.x/16-(void 0===t?16:t)/2,"em, ").concat(e.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(e.x/16,"em), calc(-50% + ").concat(e.y/16,"em)) "):"translate(".concat(e.x/16,"em, ").concat(e.y/16,"em) "),(u+="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "))+"rotate(".concat(e.rotate,"deg) ")}({transform:s,startCentered:!0,width:t,height:r}),g["-webkit-transform"]=g.transform);var m=wP(g);m.length>0&&(h.style=m);var M=[];return M.push({tag:"span",attributes:h,children:[e]}),i&&M.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),M}function iHe(n){var e=n.content,t=n.title,r=n.extra,s=Pt(Pt(Pt({},r.attributes),t?{title:t}:{}),{},{class:r.classes.join(" ")}),i=wP(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[e]}),t&&o.push({tag:"span",attributes:{class:"sr-only"},children:[t]}),o}var rV=H3.styles;function sV(n){var e=n[0],t=n[1],i=zH(n.slice(4),1)[0];return{found:!0,width:e,height:t,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(xt.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(xt.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(xt.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var oHe={found:!1,width:512,height:512};function iV(n,e){var t=e;return"fa"===e&&null!==xt.styleDefault&&(e=P8()),new Promise(function(r,s){if(w6("missingIconAbstract"),"fa"===t){var o=I1e(n)||{};n=o.iconName||n,e=o.prefix||e}if(n&&e&&rV[e]&&rV[e][n])return r(sV(rV[e][n]));(function aHe(n,e){!g1e&&!xt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(e,'" is missing.'))})(n,e),r(Pt(Pt({},oHe),{},{icon:xt.showMissingIcons&&n&&w6("missingIconAbstract")||{}}))})}var D1e=function(){},oV=xt.measurePerformance&&yP&&yP.mark&&yP.measure?yP:{mark:D1e,measure:D1e},y_='FA "6.2.1"',aV_begin=function(e){return oV.mark("".concat(y_," ").concat(e," begins")),function(){return function(e){oV.mark("".concat(y_," ").concat(e," ends")),oV.measure("".concat(y_," ").concat(e),"".concat(y_," ").concat(e," begins"),"".concat(y_," ").concat(e," ends"))}(e)}},LP=function(){};function H1e(n){return"string"==typeof(n.getAttribute?n.getAttribute(K5):null)}function hHe(n){return Tr.createElementNS("http://www.w3.org/2000/svg",n)}function dHe(n){return Tr.createElement(n)}function V1e(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.ceFn,r=void 0===t?"svg"===n.tag?hHe:dHe:t;if("string"==typeof n)return Tr.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(V1e(o,{ceFn:r}))}),s}var RP={replace:function(e){var t=e[0];if(t.parentNode)if(e[1].forEach(function(s){t.parentNode.insertBefore(V1e(s),t)}),null===t.getAttribute(K5)&&xt.keepOriginalSource){var r=Tr.createComment(function pHe(n){var e=" ".concat(n.outerHTML," ");return"".concat(e,"Font Awesome fontawesome.com ")}(t));t.parentNode.replaceChild(r,t)}else t.remove()},nest:function(e){var t=e[0],r=e[1];if(~qH(t).indexOf(xt.replacementClass))return RP.replace(e);var s=new RegExp("".concat(xt.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===xt.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?t.removeAttribute("class"):t.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return C_(c)}).join("\n");t.setAttribute(K5,""),t.innerHTML=o}};function F1e(n){n()}function B1e(n,e){var t="function"==typeof e?e:LP;if(0===n.length)t();else{var r=F1e;"async"===xt.mutateApproach&&(r=M8.requestAnimationFrame||F1e),r(function(){var s=function fHe(){return!0===xt.autoReplaceSvg?RP.replace:RP[xt.autoReplaceSvg]||RP.replace}(),i=aV_begin("mutate");n.map(s),i(),t()})}}var cV=!1;function $1e(){cV=!0}function lV(){cV=!1}var DP=null;function G1e(n){if(u1e&&xt.observeMutations){var e=n.treeCallback,t=void 0===e?LP:e,r=n.nodeCallback,s=void 0===r?LP:r,i=n.pseudoElementsCallback,o=void 0===i?LP:i,c=n.observeMutationsRoot,u=void 0===c?Tr:c;DP=new u1e(function(h){if(!cV){var g=P8();a9(h).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!H1e(m.addedNodes[0])&&(xt.searchPseudoElements&&o(m.target),t(m.target)),"attributes"===m.type&&m.target.parentNode&&xt.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&H1e(m.target)&&~Tze.indexOf(m.attributeName))if("class"===m.attributeName&&function lHe(n){var e=n.getAttribute?n.getAttribute($H):null,t=n.getAttribute?n.getAttribute(GH):null;return e&&t}(m.target)){var M=xP(qH(m.target)),L=M.iconName;m.target.setAttribute($H,M.prefix||g),L&&m.target.setAttribute(GH,L)}else(function uHe(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(xt.replacementClass)})(m.target)&&s(m.target)})}}),S6&&DP.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function mHe(n){var e=n.getAttribute("style"),t=[];return e&&(t=e.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),t}function _He(n){var e=n.getAttribute("data-prefix"),t=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=xP(qH(n));return s.prefix||(s.prefix=P8()),e&&t&&(s.prefix=e,s.iconName=t),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function Zze(n,e){return(w1e[n]||{})[e]}(s.prefix,n.innerText)||QH(s.prefix,YH(n.innerText))),!s.iconName&&xt.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function vHe(n){var e=a9(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),t=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return xt.autoA11y&&(t?e["aria-labelledby"]="".concat(xt.replacementClass,"-title-").concat(r||v_()):(e["aria-hidden"]="true",e.focusable="false")),e}function U1e(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},t=_He(n),r=t.iconName,s=t.prefix,i=t.rest,o=vHe(n),c=eV("parseNodeAttributes",{},n),u=e.styleParser?mHe(n):[];return Pt({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:j4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var yHe=H3.styles;function q1e(n){var e="nest"===xt.autoReplaceSvg?U1e(n,{styleParser:!1}):U1e(n);return~e.extra.classes.indexOf(m1e)?w6("generateLayersText",n,e):w6("generateSvgReplacementMutation",n,e)}var T8=new Set;function W1e(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!S6)return Promise.resolve();var t=Tr.documentElement.classList,r=function(m){return t.add("".concat(p1e,"-").concat(m))},s=function(m){return t.remove("".concat(p1e,"-").concat(m))},i=xt.autoFetchSvg?T8:UH.map(function(g){return"fa-".concat(g)}).concat(Object.keys(yHe));i.includes("fa")||i.push("fa");var o=[".".concat(m1e,":not([").concat(K5,"])")].concat(i.map(function(g){return".".concat(g,":not([").concat(K5,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=a9(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=aV_begin("onTree"),h=c.reduce(function(g,m){try{var M=q1e(m);M&&g.push(M)}catch(b){g1e||"MissingIcon"===b.name&&console.error(b)}return g},[]);return new Promise(function(g,m){Promise.all(h).then(function(M){B1e(M,function(){r("active"),r("complete"),s("pending"),"function"==typeof e&&e(),u(),g()})}).catch(function(M){u(),m(M)})})}function EHe(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;q1e(n).then(function(t){t&&B1e([t],e)})}function MHe(n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(e||{}).icon?e:tV(e||{}),s=t.mask;return s&&(s=(s||{}).icon?s:tV(s||{})),n(r,Pt(Pt({},t),{},{mask:s}))}}UH.map(function(n){T8.add("fa-".concat(n))}),Object.keys(h_[wr]).map(T8.add.bind(T8)),Object.keys(h_[ls]).map(T8.add.bind(T8)),T8=u_(T8);var SHe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.transform,s=void 0===r?j4:r,i=t.symbol,o=void 0!==i&&i,c=t.mask,u=void 0===c?null:c,h=t.maskId,g=void 0===h?null:h,m=t.title,M=void 0===m?null:m,b=t.titleId,L=void 0===b?null:b,G=t.classes,j=void 0===G?[]:G,ie=t.attributes,ye=void 0===ie?{}:ie,te=t.styles,xe=void 0===te?{}:te;if(e){var $e=e.prefix,et=e.iconName,Ft=e.icon;return kP(Pt({type:"icon"},e),function(){return J5("beforeDOMElementCreation",{iconDefinition:e,params:t}),xt.autoA11y&&(M?ye["aria-labelledby"]="".concat(xt.replacementClass,"-title-").concat(L||v_()):(ye["aria-hidden"]="true",ye.focusable="false")),nV({icons:{main:sV(Ft),mask:u?sV(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:$e,iconName:et,transform:Pt(Pt({},j4),s),symbol:o,title:M,maskId:g,titleId:L,extra:{attributes:ye,styles:xe,classes:j}})})}},PHe={mixout:function(){return{icon:MHe(SHe)}},hooks:function(){return{mutationObserverCallbacks:function(t){return t.treeCallback=W1e,t.nodeCallback=EHe,t}}},provides:function(e){e.i2svg=function(t){var r=t.node,i=t.callback;return W1e(void 0===r?Tr:r,void 0===i?function(){}:i)},e.generateSvgReplacementMutation=function(t,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,h=r.symbol,g=r.mask,m=r.maskId,M=r.extra;return new Promise(function(b,L){Promise.all([iV(s,c),g.iconName?iV(g.iconName,g.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(G){var j=zH(G,2);b([t,nV({icons:{main:j[0],mask:j[1]},prefix:c,iconName:s,transform:u,symbol:h,maskId:m,title:i,titleId:o,extra:M,watchable:!0})])}).catch(L)})},e.generateAbstractIcon=function(t){var h,r=t.children,s=t.attributes,i=t.main,o=t.transform,u=wP(t.styles);return u.length>0&&(s.style=u),WH(o)&&(h=w6("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(h||i.icon),{children:r,attributes:s}}}},THe={mixout:function(){return{layer:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return kP({type:"layer"},function(){J5("beforeDOMElementCreation",{assembler:t,params:r});var o=[];return t(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(xt.cssPrefix,"-layers")].concat(u_(i)).join(" ")},children:o}]})}}}},wHe={mixout:function(){return{counter:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,h=void 0===u?{}:u,g=r.styles,m=void 0===g?{}:g;return kP({type:"counter",content:t},function(){return J5("beforeDOMElementCreation",{content:t,params:r}),iHe({content:t.toString(),title:i,extra:{attributes:h,styles:m,classes:["".concat(xt.cssPrefix,"-layers-counter")].concat(u_(c))}})})}}}},bHe={mixout:function(){return{text:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?j4:s,o=r.title,c=void 0===o?null:o,u=r.classes,h=void 0===u?[]:u,g=r.attributes,m=void 0===g?{}:g,M=r.styles,b=void 0===M?{}:M;return kP({type:"text",content:t},function(){return J5("beforeDOMElementCreation",{content:t,params:r}),R1e({content:t,transform:Pt(Pt({},j4),i),title:c,extra:{attributes:m,styles:b,classes:["".concat(xt.cssPrefix,"-layers-text")].concat(u_(h))}})})}}},provides:function(e){e.generateLayersText=function(t,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(f1e){var h=parseInt(getComputedStyle(t).fontSize,10),g=t.getBoundingClientRect();c=g.width/h,u=g.height/h}return xt.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([t,R1e({content:t.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},OHe=new RegExp('"',"ug"),j1e=[1105920,1112319];function Z1e(n,e){var t="".concat("data-fa-pseudo-element-pending").concat(e.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(t))return r();var o=a9(n.children).filter(function(Ft){return Ft.getAttribute(BH)===e})[0],c=M8.getComputedStyle(n,e),u=c.getPropertyValue("font-family").match(Mze),h=c.getPropertyValue("font-weight"),g=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==g&&""!==g){var m=c.getPropertyValue("content"),M=~["Sharp"].indexOf(u[2])?ls:wr,b=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?d_[M][u[2].toLowerCase()]:Sze[M][h],L=function AHe(n){var e=n.replace(OHe,""),t=function $ze(n,e){var s,t=n.length,r=n.charCodeAt(e);return r>=55296&&r<=56319&&t>e+1&&(s=n.charCodeAt(e+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(e,0),r=t>=j1e[0]&&t<=j1e[1],s=2===e.length&&e[0]===e[1];return{value:YH(s?e[0]:e),isSecondary:r||s}}(m),G=L.value,j=L.isSecondary,ie=u[0].startsWith("FontAwesome"),ye=QH(b,G),te=ye;if(ie){var xe=function Yze(n){var e=O1e[n],t=QH("fas",n);return e||(t?{prefix:"fas",iconName:t}:null)||{prefix:null,iconName:null}}(G);xe.iconName&&xe.prefix&&(ye=xe.iconName,b=xe.prefix)}if(!ye||j||o&&o.getAttribute($H)===b&&o.getAttribute(GH)===te)r();else{n.setAttribute(t,te),o&&n.removeChild(o);var $e=function CHe(){return{iconName:null,title:null,titleId:null,prefix:null,transform:j4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),et=$e.extra;et.attributes[BH]=e,iV(ye,b).then(function(Ft){var H1=nV(Pt(Pt({},$e),{},{icons:{main:Ft,mask:{prefix:null,iconName:null,rest:[]}},prefix:b,iconName:te,extra:et,watchable:!0})),jt=Tr.createElement("svg");"::before"===e?n.insertBefore(jt,n.firstChild):n.appendChild(jt),jt.outerHTML=H1.map(function(Ys){return C_(Ys)}).join("\n"),n.removeAttribute(t),r()}).catch(s)}}else r()})}function NHe(n){return Promise.all([Z1e(n,"::before"),Z1e(n,"::after")])}function IHe(n){return!(n.parentNode===document.head||~Cze.indexOf(n.tagName.toUpperCase())||n.getAttribute(BH)||n.parentNode&&"svg"===n.parentNode.tagName)}function Y1e(n){if(S6)return new Promise(function(e,t){var r=a9(n.querySelectorAll("*")).filter(IHe).map(NHe),s=aV_begin("searchPseudoElements");$1e(),Promise.all(r).then(function(){s(),lV(),e()}).catch(function(){s(),lV(),t()})})}var K1e=!1,X1e=function(e){return e.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},uV={x:0,y:0,width:"100%",height:"100%"};function Q1e(n){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||e)&&(n.attributes.fill="black"),n}function RHe(n){return"g"===n.tag?n.children:[n]}var DHe={hooks:function(){return{parseNodeAttributes:function(t,r){var s=r.getAttribute("data-fa-mask"),i=s?xP(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=P8()),t.mask=i,t.maskId=r.getAttribute("data-fa-mask-id"),t}}},provides:function(e){e.generateAbstractMask=function(t){var r=t.children,s=t.attributes,i=t.main,o=t.mask,c=t.maskId,g=i.icon,M=o.icon,b=function Lze(n){var e=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*e.x,", ").concat(32*e.y,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),c="rotate(".concat(e.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:t.transform,containerWidth:o.width,iconWidth:i.width}),L={tag:"rect",attributes:Pt(Pt({},uV),{},{fill:"white"})},G=g.children?{children:g.children.map(Q1e)}:{},j={tag:"g",attributes:Pt({},b.inner),children:[Q1e(Pt({tag:g.tag,attributes:Pt(Pt({},g.attributes),b.path)},G))]},ie={tag:"g",attributes:Pt({},b.outer),children:[j]},ye="mask-".concat(c||v_()),te="clip-".concat(c||v_()),xe={tag:"mask",attributes:Pt(Pt({},uV),{},{id:ye,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[L,ie]},$e={tag:"defs",children:[{tag:"clipPath",attributes:{id:te},children:RHe(M)},xe]};return r.push($e,{tag:"rect",attributes:Pt({fill:"currentColor","clip-path":"url(#".concat(te,")"),mask:"url(#".concat(ye,")")},uV)}),{children:r,attributes:s}}}};!function Qze(n,e){var t=e.mixoutsTo;k1e=n,l9={},Object.keys(u9).forEach(function(r){-1===Xze.indexOf(r)&&delete u9[r]}),k1e.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(t[o]=s[o]),"object"===vP(s[o])&&Object.keys(s[o]).forEach(function(c){t[o]||(t[o]={}),t[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){l9[o]||(l9[o]=[]),l9[o].push(i[o])})}r.provides&&r.provides(u9)})}([zze,PHe,THe,wHe,bHe,{hooks:function(){return{mutationObserverCallbacks:function(t){return t.pseudoElementsCallback=Y1e,t}}},provides:function(e){e.pseudoElements2svg=function(t){var r=t.node;xt.searchPseudoElements&&Y1e(void 0===r?Tr:r)}}},{mixout:function(){return{dom:{unwatch:function(){$1e(),K1e=!0}}}},hooks:function(){return{bootstrap:function(){G1e(eV("mutationObserverCallbacks",{}))},noAuto:function(){!function gHe(){!DP||DP.disconnect()}()},watch:function(t){var r=t.observeMutationsRoot;K1e?lV():G1e(eV("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(t){return X1e(t)}}}},hooks:function(){return{parseNodeAttributes:function(t,r){var s=r.getAttribute("data-fa-transform");return s&&(t.transform=X1e(s)),t}}},provides:function(e){e.generateAbstractTransformGrouping=function(t){var r=t.main,s=t.transform,o=t.iconWidth,c={transform:"translate(".concat(t.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),h="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),g="rotate(".concat(s.rotate," 0 0)"),b={outer:c,inner:{transform:"".concat(u," ").concat(h," ").concat(g)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:Pt({},b.outer),children:[{tag:"g",attributes:Pt({},b.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:Pt(Pt({},r.icon.attributes),b.path)}]}]}}}},DHe,{provides:function(e){var t=!1;M8.matchMedia&&(t=M8.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:Pt(Pt({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=Pt(Pt({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:Pt(Pt({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return t||c.children.push({tag:"animate",attributes:Pt(Pt({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Pt(Pt({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:Pt(Pt({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:t?[]:[{tag:"animate",attributes:Pt(Pt({},o),{},{values:"1;0;0;0;0;1;"})}]}),t||r.push({tag:"path",attributes:Pt(Pt({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Pt(Pt({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(t,r){var s=r.getAttribute("data-fa-symbol");return t.symbol=null!==s&&(""===s||s),t}}}}],{mixoutsTo:Ka});var FHe=Ka.parse,BHe=Ka.icon;const $He=["*"],qHe=n=>{const e={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(e).map(t=>e[t]?t:null).filter(t=>t)};let ZHe=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),YHe=(()=>{class n{constructor(){this.definitions={}}addIcons(...t){for(const r of t){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...t){for(const r of t){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(t,r){return t in this.definitions&&r in this.definitions[t]?this.definitions[t][r]:null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),KHe=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(t){if("size"in t)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Ut({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[a2]}),n})(),XHe=(()=>{class n{constructor(t,r){this.renderer=t,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(t){"size"in t&&(null!=t.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${t.size.currentValue}`),null!=t.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${t.size.previousValue}`))}}return n.\u0275fac=function(t){return new(t||n)(Q(So),Q(g2))},n.\u0275cmp=ct({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[a2],ngContentSelectors:$He,decls:1,vars:0,template:function(t,r){1&t&&(function y$(n){const e=Le()[16][6];if(!e.projection){const r=e.projection=Rl(n?n.length:1,null),s=r.slice();let i=e.child;for(;null!==i;){const o=n?vle(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function E$(n,e=0,t){const r=Le(),s=Qn(),i=D0(s,22+n,16,null,t||null);null===i.projection&&(i.projection=e),hd(),64!=(64&i.flags)&&function Fb(n,e,t){jC(e[11],0,e,t,VC(n,t,e),GC(t.parent||e[6],t,e))}(s,r,i)}(0))},encapsulation:2}),n})(),e7=(()=>{class n{constructor(t,r,s,i,o){this.sanitizer=t,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(t){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,t){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(t){const r=((n,e)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:e,iconName:n}:void 0)(t,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const t={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?FHe.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...qHe(t),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(t,r){const s=BHe(t,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(t){return new(t||n)(Q($q),Q(ZHe),Q(YHe),Q(KHe,8),Q(XHe,8))},n.\u0275cmp=ct({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(t,r){2&t&&(FO("innerHTML",r.renderedIconHTML,Ou),z("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[a2],decls:0,vars:0,template:function(t,r){},encapsulation:2}),n})(),QHe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n}),n.\u0275inj=$r({}),n})();var pV={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},tse={prefix:"fas",iconName:"flag",icon:[448,512,[127988,61725],"f024","M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"]},Dse={prefix:"fas",iconName:"repeat",icon:[512,512,[128257],"f363","M0 224c0 17.7 14.3 32 32 32s32-14.3 32-32c0-53 43-96 96-96H320v32c0 12.9 7.8 24.6 19.8 29.6s25.7 2.2 34.9-6.9l64-64c12.5-12.5 12.5-32.8 0-45.3l-64-64c-9.2-9.2-22.9-11.9-34.9-6.9S320 19.1 320 32V64H160C71.6 64 0 135.6 0 224zm512 64c0-17.7-14.3-32-32-32s-32 14.3-32 32c0 53-43 96-96 96H192V352c0-12.9-7.8-24.6-19.8-29.6s-25.7-2.2-34.9 6.9l-64 64c-12.5 12.5-12.5 32.8 0 45.3l64 64c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V448H352c88.4 0 160-71.6 160-160z"]},AV={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},$oe={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},zV={prefix:"fas",iconName:"backward-step",icon:[320,512,["step-backward"],"f048","M267.5 440.6c9.5 7.9 22.8 9.7 34.1 4.4s18.4-16.6 18.4-29V96c0-12.4-7.2-23.7-18.4-29s-24.5-3.6-34.1 4.4l-192 160L64 241V96c0-17.7-14.3-32-32-32S0 78.3 0 96V416c0 17.7 14.3 32 32 32s32-14.3 32-32V271l11.5 9.6 192 160z"]},Qoe={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},vce={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},JV={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},e3e={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class O3e{static toComparableObjectSet(e){const t=[];return e.forEach(r=>{t.some(s=>s.equals(r))||t.push(r)}),t}static toComparableSet(e){const t=[];return e.forEach(r=>{t.some(s=>Ac(s,r))||t.push(r)}),t}}class Ot{constructor(e){this.values=void 0===e?[]:O3e.toComparableSet(e)}equals(e){if(e.size()!==this.size())return!1;for(const t of this)if(!1===e.contains(t))return!1;return!0}toString(){let e="";for(const t of this)e+=null==t?"null, ":t.toString()+", ";return"["+e.slice(0,-2)+"]"}add(e){return!this.contains(e)&&(this.values.push(e),!0)}remove(e){for(let t=0;t<this.values.length;t++)if(Ac(this.values[t],e))return this.values.splice(t,1),!0;return!1}addAll(e){for(const t of e)this.add(t)}union(e){const t=new Ot(this.toList());return t.addAll(e),t}contains(e){for(const t of this.values)if(Ac(t,e))return!0;return!1}size(){return this.values.length}toList(){const e=[];for(const t of this)e.push(t);return e}getAnyElement(){return this.size()>0?y.of(this.values[0]):y.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(e){const t=[];for(const r of this.values)t.push(e(r));return new Ot(t)}flatMap(e){const t=new Ot;for(const r of this)t.addAll(e(r));return t}filter(e){const t=new Ot;for(const r of this)e(r)&&t.add(r);return t}findAnyCommonElement(e){for(const t of e)if(this.contains(t))return y.of(t);return y.empty()}intersection(e){const t=new Ot;for(const r of e)this.contains(r)&&t.add(r);return t}[Symbol.iterator](){return this.values.values()}}class Wn{constructor(e=[],t=!1){this.map=e,this.isImmutable=t}static from(e){const t=Object.keys(e),r=new Wn;for(const s of t)r.set(s,e[s]);return r}makeImmutable(){this.isImmutable=!0}get(e){for(const t of this.map)if(Ac(t.key,e))return y.of(t.value);return y.empty()}getAnyPair(){return this.size()>0?y.of(this.map[0]):y.empty()}forEach(e){for(const t of this.map)e(t)}putAll(e){this.checkImmutability("putAll");for(const t of e.map)this.put(t.key,t.value)}checkImmutability(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}put(e,t){this.checkImmutability("put");for(const r of this.map)if(Ac(r.key,e)){const s=r.value;return r.value=t,y.of(s)}return this.map.push({key:e,value:t}),y.empty()}containsKey(e){return this.map.some(t=>Ac(t.key,e))}size(){return this.map.length}listKeys(){return this.map.map(e=>e.key)}getKeySet(){return new Ot(this.listKeys())}filter(e){const t=new Wn;for(const r of this.map)e(r.key,r.value)&&t.set(r.key,r.value);return t}replace(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}set(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}delete(e){this.checkImmutability("delete");for(let t=0;t<this.map.length;t++)if(Ac(this.map[t].key,e)){const s=this.map[t].value,i=this.map.slice(0,t),o=this.map.slice(t+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+e.toString()+'"!')}getCopy(){const e=new this.constructor;for(const t of this.listKeys())e.set(t,this.get(t).get());return e}equals(e){const t=this.getKeySet(),r=e.getKeySet();if(!1===t.equals(r))return!1;for(const s of t){const i=this.get(s).get(),o=e.get(s);if(qe(o.isPresent(),"value is absent in a map even though its key is present!"),!1===Ac(i,o.get()))return!1}return!0}}class w_ extends Wn{reverse(){const e=new w_;for(const t of this.listKeys()){const r=this.get(t).get();if(e.containsKey(r))e.get(r).get().add(t);else{const s=new Ot;s.add(t),e.set(r,s)}}return e}}class I2{constructor(e,t,r){var s=this;this.userDAO=e,this.userService=t,this.connectedUserService=r,this.userSubscription=new I1,this.currentGame=y.empty(),this.currentGameRS=new vne(1),this.currentGameObs=this.currentGameRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(function(){var i=I(function*(o){yield s.onUserUpdate(o)});return function(o){return i.apply(this,arguments)}}())}onUserUpdate(e){var t=this;return I(function*(){if(e===Y5.NOT_CONNECTED)t.userSubscription.unsubscribe(),t.currentGame=y.empty(),t.currentGameRS.next(y.empty());else{t.userSubscription=t.userService.observeUserOnServer(e.id,s=>{qe(s.isPresent(),"Observing part service expected user to already have a document!");const i=s.get();t.onCurrentGameUpdate(i.currentGame)});const r=yield t.userDAO.read(e.id);t.currentGame=y.ofNullable(r.get().currentGame),t.currentGameRS.next(t.currentGame)}})()}onCurrentGameUpdate(e){const t=this.currentGame,r=null==e&&t.isAbsent(),s=null!=e&&t.equalsValue(e);!1===r&&!1===s&&(this.currentGame=y.ofNullable(e),this.currentGameRS.next(this.currentGame))}updateCurrentGame(e){if(qe(this.connectedUserService.user.isPresent(),"Should not call updateCurrentGame when not connected"),this.currentGame.isPresent()){const r={...this.currentGame.get(),...e};return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)qe(null!=e[s],"field "+s+" should be set before updating currentGame");return this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:e})}}removeCurrentGame(){return qe(this.connectedUserService.user.isPresent(),"Should not call removeCurrentGame when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{currentGame:null})}subscribeToCurrentGame(e){return this.currentGameObs.subscribe(e)}canUserCreate(){if(this.currentGame.isAbsent())return R.SUCCESS;{const e=I2.roleToMessage.get(this.currentGame.get().role).get()();return R.failure(e)}}canUserJoin(e,t){if(this.currentGame.isAbsent()||this.currentGame.get().id===e)return R.SUCCESS;if(t&&"Observer"===this.currentGame.get().role)return R.SUCCESS;{const r=I2.roleToMessage.get(this.currentGame.get().role).get()();return R.failure(r)}}getCurrentGame(){return new Promise(e=>{let t=new I1;t=this.currentGameObs.subscribe(r=>{e(r),t.unsubscribe()})})}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function C4t(n,e){if(1&n&&(dn(0),ve(1,31),pn()),2&n){const t=C(2);T(1),M1(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),A1(1)}}function y4t(n,e){if(1&n&&(dn(0),ve(1,33),pn()),2&n){const t=C(3);T(1),M1(t.currentGame.get().typeGame)(null==t.currentGame.get().opponent?null:t.currentGame.get().opponent.name),A1(1)}}function E4t(n,e){if(1&n&&(dn(0),ve(1,34),pn()),2&n){const t=C(3);T(1),M1(t.currentGame.get().typeGame),A1(1)}}function M4t(n,e){if(1&n&&(x(0,y4t,2,2,"ng-container",27),x(1,E4t,2,1,"ng-template",null,32,Un)),2&n){const t=Hn(2);w("ngIf",C(2).currentGame.get().opponent)("ngIfElse",t)}}function S4t(n,e){if(1&n){const t=Oe();O(0,"a",29),J("click",function(){return he(t),ce(C().navigateToPart())}),x(1,C4t,2,2,"ng-container",27),x(2,M4t,3,2,"ng-template",null,30,Un),A()}if(2&n){const t=Hn(3),r=C();T(1),w("ngIf","Observer"===r.currentGame.get().role||"Candidate"===r.currentGame.get().role)("ngIfElse",t)}}function P4t(n,e){if(1&n&&(dn(0),X(1,"fa-icon",35),pn()),2&n){const t=C();T(1),w("icon",t.faSpinner)}}function T4t(n,e){if(1&n){const t=Oe();dn(0),O(1,"div",10)(2,"a",37),wt(3),A(),O(4,"div",13)(5,"a",38),ve(6,39),A(),O(7,"a",40),J("click",function(){return he(t),ce(C(2).logout())}),ve(8,41),A()()(),pn()}if(2&n){const t=C(2);T(3),c1(t.username.get())}}I2.roleToMessage=new Wn([{key:"Candidate",value:a_.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:a_.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:a_.YOU_ARE_ALREADY_CREATING},{key:"Player",value:a_.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:a_.YOU_ARE_ALREADY_OBSERVING}]),I2.\u0275fac=function(e){return new(e||I2)(De(R3),De(i9),De(Q1))},I2.\u0275prov=nt({token:I2,factory:I2.\u0275fac,providedIn:"root"});const w4t=function(){return["/register"]},b4t=function(){return["/login"]};function O4t(n,e){1&n&&(O(0,"div",42)(1,"a",43)(2,"strong"),ve(3,44),A()(),O(4,"a",45),ve(5,46),A()()),2&n&&(T(1),w("routerLink",K1(2,w4t)),T(3),w("routerLink",K1(3,b4t)))}function A4t(n,e){if(1&n&&(x(0,T4t,9,1,"ng-container",27),x(1,O4t,6,4,"ng-template",null,36,Un)),2&n){const t=Hn(2);w("ngIf",C().username.isPresent())("ngIfElse",t)}}const A3e=function(){return["/"]},N4t=function(){return["/play"]},I4t=function(){return["/lobby"]},x4t=function(){return["/local"]},k4t=function(){return["/tutorial"]},L4t=function(){return["/settings"]};let R4t=(()=>{class n{constructor(t,r,s,i){this.router=t,this.connectedUserService=r,this.currentGameService=s,this.userService=i,this.loading=!0,this.username=y.empty(),this.faCog=$oe,this.faSpinner=vce,this.showMenu=!1,this.currentGame=y.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(t=>{this.loading=!1,this.username=t.username.isPresent()?t.username:t.email}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(t=>{this.currentGame=t})}logout(){var t=this;return I(function*(){yield t.connectedUserService.disconnect(),yield t.router.navigate(["/"])})()}navigateToPart(){var t=this;return I(function*(){return t.router.navigate(["/play",t.currentGame.get().typeGame,t.currentGame.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn),Q(Q1),Q(I2),Q(i9))},n.\u0275cmp=ct({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let e,t,r,s,i,o,c,u,h,g,m,M,b,L,G;return e=$localize`Home`,t=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,g=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,M=$localize`Account`,b=$localize`Log out`,L=$localize`Register`,G=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],e,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],t,[1,"navbar-dropdown"],r,s,["id","playOffline",1,"navbar-link"],i,["id","playLocally",1,"navbar-item",3,"routerLink"],o,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","currentGameLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","currentGameLink",1,"navbar-item",3,"click"],["activeUser",""],h,["waitingForOpponent",""],g,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","account","routerLink","/account",1,"navbar-item"],M,["id","logout",1,"navbar-item",3,"click"],b,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],L,["id","login",1,"button","is-light",3,"routerLink"],G]},template:function(t,r){if(1&t&&(O(0,"nav",0)(1,"div",1)(2,"a",2),X(3,"img",3),A(),O(4,"a",4),J("click",function(){return r.showMenu=!r.showMenu}),X(5,"span",5)(6,"span",5)(7,"span",5),A()(),O(8,"div",6),J("click",function(){return r.showMenu=!r.showMenu}),O(9,"div",7)(10,"a",8),ve(11,9),A(),O(12,"div",10)(13,"a",11),ve(14,12),A(),O(15,"div",13)(16,"a",2),ve(17,14),A(),O(18,"a",2),ve(19,15),A()()(),O(20,"div",10)(21,"a",16),ve(22,17),A(),O(23,"div",13)(24,"a",18),ve(25,19),A(),O(26,"a",20),ve(27,21),A()()()(),O(28,"div",22),x(29,S4t,4,2,"a",23),O(30,"a",24),X(31,"fa-icon",25),A(),O(32,"div",26),x(33,P4t,2,1,"ng-container",27),x(34,A4t,3,2,"ng-template",null,28,Un),A()()()()),2&t){const s=Hn(35);T(2),w("routerLink",K1(13,A3e)),T(2),w("ngClass",r.showMenu?"is-active":""),T(4),w("ngClass",r.showMenu?"is-active":""),T(2),w("routerLink",K1(14,A3e)),T(6),w("routerLink",K1(15,N4t)),T(2),w("routerLink",K1(16,I4t)),T(6),w("routerLink",K1(17,x4t)),T(2),w("routerLink",K1(18,k4t)),T(3),w("ngIf",r.currentGame.isPresent()),T(1),w("routerLink",K1(19,L4t)),T(1),w("icon",r.faCog),T(2),w("ngIf",r.loading)("ngIfElse",s)}},dependencies:[hn,Kt,o5,e7],encapsulation:2}),n})(),D4t=(()=>{class n{constructor(t,r){this._themeService=t,this._errorLoggerService=r,this.faTwitter=Yne,this.faFacebook=$ne,this.faGithub=Zne}}return n.\u0275fac=function(t){return new(t||n)(Q(_P),Q(Ts))},n.\u0275cmp=ct({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let e;return e=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],e,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(t,r){1&t&&(X(0,"app-header"),O(1,"main",0),X(2,"router-outlet"),A(),O(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),ca(7,3),X(8,"strong"),la(),A(),wt(9," \xa0 "),O(10,"a",4),X(11,"fa-icon",5),A(),wt(12,"\xa0 "),O(13,"a",6),X(14,"fa-icon",5),A(),wt(15,"\xa0 "),O(16,"a",7),X(17,"fa-icon",5),A()()()()),2&t&&(T(11),w("icon",r.faGithub),T(3),w("icon",r.faTwitter),T(3),w("icon",r.faFacebook))},dependencies:[LN,e7,R4t],encapsulation:2}),n})();class eo{}class gn{constructor(e){this.x=e}static of(e){switch(e){case 0:return gn.ZERO;case 1:return gn.ONE;case 2:return gn.TWO;default:return qe(3===e,"Invalid Apagos Coord "+e),gn.THREE}}equals(e){return this.x===e.x}}gn.encoder=Ye.tuple([Ye.identity()],n=>[n.x],n=>gn.of(n[0])),gn.ZERO=new gn(0),gn.ONE=new gn(1),gn.TWO=new gn(2),gn.THREE=new gn(3);let f9=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class or extends eo{constructor(e,t,r){super(),this.landing=e,this.piece=t,this.starting=r}static drop(e,t){return pe.getNonNullable(or.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equalsValue(t)&&s.starting.equals(y.empty())))}static transfer(e,t){if(e.x<=t.x)return _e.failure(f9.PIECE_SHOULD_MOVE_DOWNWARD());const r=pe.getNonNullable(or.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equals(y.empty())&&s.starting.equals(y.of(e))));return _e.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}or.ALL_MOVES=[new or(gn.ZERO,y.of(B.ZERO),y.empty()),new or(gn.ONE,y.of(B.ZERO),y.empty()),new or(gn.TWO,y.of(B.ZERO),y.empty()),new or(gn.THREE,y.of(B.ZERO),y.empty()),new or(gn.ZERO,y.of(B.ONE),y.empty()),new or(gn.ONE,y.of(B.ONE),y.empty()),new or(gn.TWO,y.of(B.ONE),y.empty()),new or(gn.THREE,y.of(B.ONE),y.empty()),new or(gn.TWO,y.empty(),y.of(gn.THREE)),new or(gn.ONE,y.empty(),y.of(gn.THREE)),new or(gn.ZERO,y.empty(),y.of(gn.THREE)),new or(gn.ONE,y.empty(),y.of(gn.TWO)),new or(gn.ZERO,y.empty(),y.of(gn.TWO)),new or(gn.ZERO,y.empty(),y.of(gn.ONE))],or.encoder=Ye.tuple([gn.encoder,y.getEncoder(B.encoder),y.getEncoder(gn.encoder)],n=>[n.landing,n.piece,n.starting],n=>new or(n[0],n[1],n[2]));class JP{constructor(e){this.turn=e}getCurrentPlayer(){return B.ofTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?B.ZERO:B.ONE}}class Je{static mapBiArray(e,t){const r=[];let s=0;for(;s<e.length;){r[s]=[];let i=0;for(;i<e[s].length;)r[s][i]=t(e[s][i]),i++;s++}return r}static create3DTable(e,t,r,s){const i=[];for(let o=0;o<e;o++)i.push(Je.createTable(t,r,s));return i}static createTable(e,t,r){const s=[];for(let i=0;i<t;i++)s.push(Je.createArray(e,r));return s}static createArray(e,t){const r=[];for(let s=0;s<e;s++)r.push(t);return r}static copyBiArray(e){const t=[];let r=0;for(;r<e.length;)t[r]=Je.copyImmutableArray(e[r]),r++;return t}static copyImmutableArray(e){const t=[];let r=0;for(;r<e.length;)t[r]=e[r],r++;return t}static sortByDescending(e,t){e.sort((r,s)=>{const i=t(r),o=t(s);return i<o?1:i>o?-1:0})}static compareArray(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!1===Ac(e[r],t[r]))return!1;return!0}static compareTable(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!1===Je.compareArray(e[r],t[r]))return!1;return!0}static isPrefix(e,t){return!(e.length>t.length)&&Je.compareArray(e,t.slice(0,e.length))}static range(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t}static smallerFirst(e,t){return e-t}}class N3e{constructor(){this.content=new Wn}get(e){const t=this.content.get(e.y);return t.isAbsent()?y.empty():t.get().get(e.x)}set(e,t){const r=this.content.get(e.y);let s;r.isPresent()?s=r.get():(s=new Wn,this.content.set(e.y,s)),s.set(e.x,t)}[Symbol.iterator](){const e=[],t=this.content.getKeySet().toList();t.sort(Je.smallerFirst);for(const r of t){const s=this.content.get(r).get(),i=s.getKeySet().toList();i.sort(Je.smallerFirst);for(const o of i){const c=s.get(o).get();e.push({x:o,y:r,content:c})}}return e.values()}}class b_{constructor(e){this.containing=e}static from(e,t,r){if(e+t>r)return _e.failure("invalid starting space");const s=new Wn([{key:B.ZERO,value:e},{key:B.ONE,value:t},{key:le.NONE,value:r}]);s.makeImmutable();const i=new b_(s);return _e.success(i)}isFull(){return this.count(B.ZERO)+this.count(B.ONE)>=this.count(le.NONE)}count(e){return this.containing.get(e).get()}addPiece(e){let t=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(le.NONE);return e===B.ZERO?t++:r++,b_.from(t,r,s).get()}substractPiece(e){let t=this.count(B.ZERO),r=this.count(B.ONE);const s=this.count(le.NONE);return e===B.ZERO?t--:r--,b_.from(t,r,s).get()}getDominatingPlayer(){const e=this.count(B.ZERO),t=this.count(B.ONE);return e>t?B.ZERO:t>e?B.ONE:le.NONE}equals(e){return this.containing.equals(e.containing)}}let w8=(()=>{class n extends JP{constructor(t,r,s){super(t),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(t,r,s,i){const o=[];for(let u=0;u<4;u++){const M=b_.from(r[0][u],r[1][u],r[2][u]).get();o.push(M)}const c=new Wn;return c.set(B.ZERO,s),c.set(B.ONE,i),new n(t,o,c)}getPieceAt(t){return this.board[t.x]}updateAt(t,r){const s=[];for(let o=0;o<4;o++)s.push(t.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(t){return this.remaining.get(t).get()}equals(t){return this.turn===t.turn&&Je.compareArray(t.board,this.board)&&this.remaining.equals(t.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class ee{constructor(e,t,r){this.title=e,this.instruction=t,this.state=r,this.previousMove=y.empty()}static fromMove(e,t,r,s,i,o){return new z4t(e,t,r,s,i,o)}static forClick(e,t,r,s,i,o){return new V4t(e,t,r,s,i,o)}static anyMove(e,t,r,s,i){return new H4t(e,t,r,s,i)}static fromPredicate(e,t,r,s,i,o){return new F4t(e,t,r,s,i,o)}static informational(e,t,r){return new B4t(e,t,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(e){return this.previousMove=y.of(e),this}}class eT extends ee{constructor(e,t,r,s){super(e,t,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class z4t extends eT{constructor(e,t,r,s,i,o){super(e,t,r,i),this.acceptedMoves=s,this.failureMessage=o,qe(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class H4t extends eT{constructor(e,t,r,s,i){super(e,t,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class V4t extends eT{constructor(e,t,r,s,i,o){super(e,t,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class F4t extends eT{constructor(e,t,r,s,i,o){super(e,t,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class B4t extends ee{isInformation(){return!0}}class R1{}class I3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Initial board and object of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,w8.getInitialState()),ee.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,w8.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),or.drop(gn.ZERO,B.ZERO),$localize`Congratulations!`),ee.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,w8.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),or.transfer(gn.TWO,gn.ZERO).get(),(e,t,r)=>e.isDrop()?R.failure($localize`This move is a drop, please do a transfer!`):R.SUCCESS,$localize`Congratulations!`),ee.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,w8.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),or.drop(gn.TWO,B.ONE),(e,t,r)=>e.isDrop()?e.piece.equalsValue(B.ONE)?R.SUCCESS:R.failure($localize`You actively made your opponent win!`):R.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}class Vn{constructor(e){this.value=e}static fromWinner(e){return e.isPlayer()?new Vn(e.getVictoryValue()):new Vn(0)}static of(e,t){return e*=B.ZERO.getScoreModifier(),t*=B.ONE.getScoreModifier(),new Vn(e+t)}toString(){return""+this.value}}Vn.VICTORIES=[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER];class Ne{constructor(e,t){this.isEndGame=e,this.winner=t}static getVictory(e){return e===B.ZERO?Ne.ZERO_WON:Ne.ONE_WON}static getDefeat(e){return e===B.ZERO?Ne.ONE_WON:Ne.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?new Vn(this.winner.getVictoryValue()):new Vn(0)}}Ne.ZERO_WON=new Ne(!0,B.ZERO),Ne.ONE_WON=new Ne(!0,B.ONE),Ne.DRAW=new Ne(!0,le.NONE),Ne.ONGOING=new Ne(!1,le.NONE);var aF,Pn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(Pn||(Pn={})),Pn))();let tT=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})(),x2=aF=class{constructor(e,t=y.empty(),r=y.empty(),s){if(this.gameState=e,this.mother=t,this.move=r,this.minimaxCreator=s,this.childs=y.empty(),this.hopedValue=new Wn,this.ownValue=new Wn,this.possibleMoves=new Wn,this.ownValue=new Wn,null!=s){const i=s.getBoardValue(this);this.ownValue.set(s.name,i),this.hopedValue.set(s.name,i.value)}tT.createdNodes++}static getScoreStatus(e){return e===Number.MAX_SAFE_INTEGER||e===Number.MIN_SAFE_INTEGER?(We.display("MGPNode","getScoreStatus","VICTORY"),Pn.VICTORY):e===Number.MIN_SAFE_INTEGER+1?(We.display("MGPNode","getScoreStatus","PRE_VICTORY_MIN"),Pn.PRE_VICTORY):e===Number.MAX_SAFE_INTEGER-1?(We.display("MGPNode","getScoreStatus","PRE_VICTORY_MAX"),Pn.PRE_VICTORY):(We.display("MGPNode","getScoreStatus","DEFAULT"),Pn.DEFAULT)}findBestMove(e,t,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),e--;return tT.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(e,t,r,s,i,o){if(e<1)return We.display("MGPNode","alphaBeta","isLeaf-Calculation : "+this.myToString()+" at depth "+e),this;if(s.ruler.getGameStatus(this).isEndGame)return We.display("MGPNode","alphaBeta","isLeaf-EndGame("+s.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+e),this;const c=this.getPossibleMoves(s);qe(c.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=y.of([]));const u=this.getBestChilds(c,e,t,r,s,i,o),h=this.getBestChildAmongst(u,i),g=h.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),g),h}getPossibleMoves(e){const t=this.possibleMoves.get(e.name);if(t.isAbsent()){const r=e.getListMoves(this);return this.possibleMoves.set(e.name,new Ot(r)),new Ot(r)}return t.get()}getBestChilds(e,t,r,s,i,o,c){let u=[];const h=this.gameState.getCurrentPlayer();let g=h===B.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=h===B.ZERO?(M,b)=>M<b:(M,b)=>b<M;for(const M of e){const L=this.getOrCreateChild(M,i).alphaBeta(t-1,r,s,i,o,c),G=L.getHopedValue(i);if(m(G,g)||0===u.length?(g=G,u=[L]):G===g&&u.push(L),c&&m(g,h===B.ZERO?r:s))break;h===B.ZERO?s=Math.min(g,s):r=Math.max(g,r)}return u}getBestChildAmongst(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}getOrCreateChild(e,t){let r=this.getSonByMove(e);if(r.isAbsent()){const s=t.ruler.isLegal(e,this.gameState),i=e.toString();qe(s.isSuccess(),'The minimax "'+t.name+'" has proposed an illegal move ('+i+"), refusal reason: "+s.getReasonOr("")+" this should not happen.");const o=t.ruler.applyLegalMove(e,this.gameState,s.get());r=y.of(new aF(o,y.of(this),y.of(e),t)),this.childs.get().push(r.get())}return r.get()}getSonByMove(e){qe(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const t of this.childs.get())if(t.move.isPresent()&&t.move.equalsValue(e))return y.of(t);return y.empty()}getHopedValue(e){return this.hopedValue.get(e.name).get()}getOwnValue(e){const t=this.ownValue.get(e.name);if(t.isAbsent()){const r=e.getBoardValue(this);return this.ownValue.set(e.name,r),r}return t.get()}myToString(){let e="",t=this;if(t.mother.isAbsent())return"InitialNode: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let e=this.childs.get().length;for(const t of this.childs.get())e+=t.countDescendants();return e}};x2.minimaxes=new Wn,x2=aF=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],x2);class N1{constructor(e){this.stateType=e}choose(e,t){We.display("Rules","choose",t.toString()+" was proposed");const r=this.isLegal(t,e.gameState);if(e.hasMoves()){We.display("Rules","choose","current node has moves");const o=e.getSonByMove(t);if(o.isPresent())return qe(r.isSuccess(),"Rules.choose: Move is illegal: "+r.getReasonOr("")),We.display("Rules","choose","and this proposed move is found in the list, so it is legal"),y.of(o.get())}if(We.display("Rules","choose","current node has no moves or is pruned, let's verify ourselves"),r.isFailure())return We.display("Rules","choose","Move is illegal: "+r.getReason()),y.empty();We.display("Rules","choose","Move is legal, let's apply it");const s=this.applyLegalMove(t,e.gameState,r.get()),i=new x2(s,y.of(e),y.of(t));return y.of(i)}getInitialNode(){const e=this.stateType.getInitialState();return new x2(e)}}class b6 extends N1{constructor(){super(w8)}static get(){return b6.singleton.isAbsent()&&(b6.singleton=y.of(new b6)),b6.singleton.get()}applyLegalMove(e,t,r){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}applyLegalDrop(e,t){const r=t.getRemainingCopy(),s=r.get(e.piece.get()).get();r.put(e.piece.get(),s-1);const i=new w8(t.turn+1,t.board,r),o=e.piece.get(),c=i.getPieceAt(e.landing).addPiece(o);if(e.landing===gn.THREE)return i.updateAt(e.landing,c);{const u=gn.of(e.landing.x+1),h=i.getPieceAt(u);return i.updateAt(e.landing,h).updateAt(u,c)}}applyLegalTransfer(e,t){const r=t.getCurrentPlayer(),s=e.starting.get(),i=t.getPieceAt(s).substractPiece(r),o=t.getPieceAt(e.landing).addPiece(r);let c=t.updateAt(s,i);return c=c.updateAt(e.landing,o),new w8(c.turn+1,c.board,c.remaining)}isLegal(e,t){return t.getPieceAt(e.landing).isFull()?R.failure(f9.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}isLegalDrop(e,t){return t.getRemaining(e.piece.get())<=0?R.failure(f9.NO_PIECE_REMAINING_TO_DROP()):R.SUCCESS}isLegalSlideDown(e,t){const r=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(r)?R.failure(f9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):R.SUCCESS}getGameStatus(e){const t=e.gameState;for(let s=0;s<4;s++)if(!1===t.getPieceAt(gn.of(s)).isFull())return Ne.ONGOING;const r=t.getPieceAt(gn.THREE).getDominatingPlayer();return qe(r.isPlayer(),"winner can only be a player if the game is finished"),Ne.getVictory(r)}}b6.singleton=y.empty();class cF{static gcd(e,t){return 0===t?Math.abs(e):cF.gcd(t,e%t)}}class Bt{constructor(e,t){this.x=e,this.y=t}equals(e){return this.x===e.x&&this.y===e.y}isDiagonalOfLength(e){return Math.abs(this.x)===e&&Math.abs(this.y)===e}toMinimalVector(){const e=cF.gcd(this.x,this.y);return new Bt(this.x/e,this.y/e)}combine(e,t=1){return new Bt(this.x+t*e.x,this.y+t*e.y)}toString(){return"("+this.x+", "+this.y+")"}}class lF extends Bt{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class uF{from(e,t){for(const r of this.all)if(r.x===e&&r.y===t)return _e.success(r);return _e.failure("Invalid x and y in direction construction")}fromDelta(e,t){return 0===e&&0===t?_e.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.from(Math.sign(e),Math.sign(t)):_e.failure(G4t.DIRECTION_MUST_BE_LINEAR())}fromMove(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}fromString(e){switch(e){case"UP":return this.from(0,-1);case"RIGHT":return this.from(1,0);case"DOWN":return this.from(0,1);case"LEFT":return this.from(-1,0);case"UP_LEFT":return this.from(-1,-1);case"UP_RIGHT":return this.from(1,-1);case"DOWN_LEFT":return this.from(-1,1);case"DOWN_RIGHT":return this.from(1,1);default:return _e.failure(`Invalid direction string ${e}`)}}fromInt(e){switch(e){case 0:return this.from(0,-1);case 1:return this.from(1,0);case 2:return this.from(0,1);case 3:return this.from(-1,0);case 4:return this.from(-1,-1);case 5:return this.from(1,-1);case 6:return this.from(-1,1);case 7:return this.from(1,1);default:return _e.failure(`Invalid int direction: ${e}`)}}}class be extends lF{constructor(e,t){super(e,t)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return be.factory.from(-this.x,-this.y).get()}}be.UP=new be(0,-1),be.UP_RIGHT=new be(1,-1),be.RIGHT=new be(1,0),be.DOWN_RIGHT=new be(1,1),be.DOWN=new be(0,1),be.DOWN_LEFT=new be(-1,1),be.LEFT=new be(-1,0),be.UP_LEFT=new be(-1,-1),be.factory=new class extends uF{constructor(){super(...arguments),this.all=[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT,be.DOWN,be.DOWN_LEFT,be.LEFT,be.UP_LEFT]}},be.DIRECTIONS=be.factory.all,be.DIAGONALS=[be.UP_RIGHT,be.DOWN_RIGHT,be.DOWN_LEFT,be.UP_LEFT],be.ORTHOGONALS=[be.UP,be.RIGHT,be.DOWN,be.LEFT],be.encoder=Ye.fromFunctions(n=>n.toString(),n=>(qe("string"==typeof n,"Invalid encoded direction"),be.factory.fromString(n).get()));class Fe extends lF{constructor(e,t){super(e,t)}getOpposite(){return Fe.factory.from(-this.x,-this.y).get()}rotateClockwise(){return Fe.factory.from(-this.y,this.x).get()}}Fe.UP=new Fe(0,-1),Fe.RIGHT=new Fe(1,0),Fe.DOWN=new Fe(0,1),Fe.LEFT=new Fe(-1,0),Fe.factory=new class extends uF{constructor(){super(...arguments),this.all=[Fe.UP,Fe.RIGHT,Fe.DOWN,Fe.LEFT]}from(n,e){return 0===n&&-1===e?_e.success(Fe.UP):1===n&&0===e?_e.success(Fe.RIGHT):0===n&&1===e?_e.success(Fe.DOWN):-1===n&&0===e?_e.success(Fe.LEFT):_e.failure("Invalid orthogonal from x and y")}},Fe.ORTHOGONALS=Fe.factory.all,Fe.encoder=Ye.fromFunctions(n=>n.toString(),n=>(qe("string"==typeof n,"Invalid encoded orthogonal"),Fe.factory.fromString(n).get()));let G4t=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})(),h9=(()=>{class n{}return n.OUT_OF_RANGE=e=>`The coordinate ${e.toString()} is not on the board`,n})();class S extends Bt{constructor(e,t){super(e,t)}static getEncoder(e){return Ye.tuple([Ye.identity(),Ye.identity()],t=>[t.x,t.y],t=>e(t[0],t[1]))}getNext(e,t){const r=this.combine(e,t);return new S(r.x,r.y)}getPrevious(e,t){return this.getNext(e,-(t=t??1))}getLeft(e){return new S(this.x+e.y,this.y+-e.x)}getRight(e){return new S(this.x+-e.y,this.y+e.x)}isInRange(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}isNotInRange(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}getDirectionToward(e){return be.factory.fromMove(this,e)}getOrthogonalDistance(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}getDistance(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const t=Math.abs(e.x-this.x),r=Math.abs(e.y-this.y);return Math.max(t,r)}isHexagonallyAlignedWith(e){const t=this.x-e.x,r=this.y-e.y;return t!==r&&(t===-r||t*r==0)}isAlignedWith(e){const t=Math.abs(this.x-e.x),r=Math.abs(this.y-e.y);return t===r||t*r==0}getVectorToward(e){return new Bt(e.x-this.x,e.y-this.y)}toVector(){return new Bt(this.x,this.y)}getCoordsToward(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];const t=this.getDirectionToward(e).get();let r=this.getNext(t,1);const s=[];for(;!1===r.equals(e);)s.push(r),r=r.getNext(t,1);return s}getUntil(e){const t=[],r=this.getDirectionToward(e).get();let s=this.getNext(r);for(;!1===s.equals(e);)t.push(s),s=s.getNext(r);return t}equals(e){return this===e||e.x===this.x&&e.y===this.y}compareTo(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}toSVGPoint(){return this.x+","+this.y}}S.encoder=S.getEncoder((n,e)=>new S(n,e));class x3e{constructor(){this.ArrayUtils=Je}getPlayerClass(e){switch(e){case B.ZERO:return"player0-fill";case B.ONE:return"player1-fill";default:return pe.expectToBe(e,le.NONE),""}}}let b8=(()=>{class n extends x3e{constructor(t){super(),this.messageDisplayer=t,this.Player=B,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.canPass=!1,this.scores=y.empty(),this.imagesLocation="assets/images/",this.hasAsymmetricBoard=!1,this.rotation=""}message(t){this.messageDisplayer.gameMessage(t)}cancelMove(t){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(t),null==t?R.SUCCESS:(this.messageDisplayer.gameMessage(t),R.failure(t))}cancelMoveAttempt(){}pass(){var t=this;return I(function*(){return Ts.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:t.constructor.name})})()}getTurn(){return this.node.gameState.turn}getCurrentPlayer(){return this.node.gameState.getCurrentPlayer()}getState(){return this.node.gameState}getPreviousState(){return this.node.mother.get().gameState}showLastMove(t){}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(t,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),d9=(()=>{class n extends b8{getHexaPointsAtXY(t,r){const s=new S(t,r);return this.getHexaPointsAt(s)}getHexaPointsAt(t){return this.hexaLayout.getHexaPointsAt(t)}getCenterAtXY(t,r){const s=new S(t,r);return this.getCenterAt(s)}getCenterAt(t){return this.hexaLayout.getCenterAt(t)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(t,r){},encapsulation:2}),n})();class Ie{constructor(e){this.value=e}static of(e){switch(e){case Ie.ZERO.value:return Ie.ZERO;case Ie.ONE.value:return Ie.ONE;case Ie.EMPTY.value:return Ie.EMPTY;case Ie.UNREACHABLE.value:return Ie.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+e)}}static ofPlayer(e){return e===B.ZERO?Ie.ZERO:(pe.expectToBe(e,B.ONE),Ie.ONE)}equals(e){return this===e}is(e){return this.value===e.value}isPlayer(){return this===Ie.ZERO||this===Ie.ONE}}Ie.ZERO=new Ie(B.ZERO.value),Ie.ONE=new Ie(B.ONE.value),Ie.EMPTY=new Ie(le.NONE.value),Ie.UNREACHABLE=new Ie(3);class Re extends lF{constructor(e,t){super(e,t)}static getAngle(e){switch(e){case Re.UP:return 0;case Re.UP_RIGHT:return 60;case Re.RIGHT:return 120;case Re.DOWN:return 180;case Re.DOWN_LEFT:return 240;default:return pe.expectToBe(e,Re.LEFT),300}}getOpposite(){return Re.factory.from(-this.x,-this.y).get()}}Re.UP=new Re(0,-1),Re.LEFT=new Re(-1,0),Re.UP_RIGHT=new Re(1,-1),Re.DOWN_LEFT=new Re(-1,1),Re.RIGHT=new Re(1,0),Re.DOWN=new Re(0,1),Re.factory=new class extends uF{constructor(){super(...arguments),this.all=[Re.UP,Re.UP_RIGHT,Re.RIGHT,Re.DOWN,Re.DOWN_LEFT,Re.LEFT]}},Re.encoder=Ye.fromFunctions(n=>{switch(n){case Re.UP:return 0;case Re.UP_RIGHT:return 1;case Re.RIGHT:return 2;case Re.DOWN:return 3;case Re.DOWN_LEFT:return 4;default:return 5}},n=>(pe.assert(0<=n&&n<=5,"Invalid encoded number for HexaDirection "+n),Re.factory.all[n]));class k3e{}class nT extends k3e{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}nT.INSTANCE=new nT;class ws extends k3e{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}isOnTopRightBorder(e,t){return 0===t.y}isOnRightBorder(e,t){return t.x===e.width-1}isOnLeftBorder(e,t){return 0===t.x}isOnBottomLeftBorder(e,t){return t.y===e.height-1}isOnTopLeftBorder(e,t){return null!=e.excludedSpaces[t.y]?t.x===e.excludedSpaces[t.y]:t.y===e.excludedSpaces.length&&0===t.x}isOnBottomRightBorder(e,t){return null!=e.excludedSpaces[e.height-1-t.y]?e.width-1-t.x===e.excludedSpaces[e.height-1-t.y]:e.height-1-t.y===e.excludedSpaces.length&&t.x===e.width-1}getAllBorders(e){const t=[];return e.forEachCoord((r,s)=>{this.isOnBorder(e,r)&&t.push(r)}),t}isTopCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}isTopLeftCorner(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isTopRightCorner(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}isBottomCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}isBottomLeftCorner(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}isBottomRightCorner(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}ws.INSTANCE=new ws;class p9{constructor(e,t,r){this.size=e,this.origin=t,this.orientation=r}getCenterAt(e){const t=this.orientation.conversionMatrix;return new S(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}getCornerOffset(e){const t=2*Math.PI*(this.orientation.startAngle+e)/6;return new S(this.size*Math.cos(t),this.size*Math.sin(t))}getHexaPointsListAt(e){const t=this.getCenterAt(e),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new S(t.x+i.x,t.y+i.y))}return r}getHexaPointsAt(e){return this.getHexaPointsListAt(e).map(r=>r.toSVGPoint()).join(" ")}getIsoPoints(e,t){pe.assert(this.orientation===ws.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const r=this.getCenterAt(e),s=this.getCornerOffset(0),i=this.getCornerOffset(1),o=this.getCornerOffset(2),c=this.getCornerOffset(3);return[[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+t),new S(r.x+o.x,r.y+o.y+t),new S(r.x+o.x,r.y+o.y)],[new S(r.x+s.x,r.y+s.y),new S(r.x+s.x,r.y+s.y+t),new S(r.x+i.x,r.y+i.y+t),new S(r.x+o.x,r.y+o.y+t),new S(r.x+o.x,r.y+o.y),new S(r.x+i.x,r.y+i.y)],[new S(r.x+c.x,r.y+c.y),new S(r.x+c.x,r.y+c.y+t),new S(r.x+o.x,r.y+o.y+t),new S(r.x+i.x,r.y+i.y+t),new S(r.x+s.x,r.y+s.y+t),new S(r.x+s.x,r.y+s.y),new S(r.x+i.x,r.y+i.y),new S(r.x+o.x,r.y+o.y)]]}}let Xe=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class Xa{constructor(e,t){this.ruler=e,this.name=t}toString(){return this.name}}class bs extends Xa{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return Vn.fromWinner(t.winner);{const r=this.getMetrics(e);return Vn.of(r[0],r[1])}}}class br extends JP{constructor(e,t){super(t),this.board=e}getPieceAt(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}tryToGetPieceAt(e){return this.isOnBoard(e)?y.of(this.board[e.y][e.x]):y.empty()}isOnBoard(e){return e.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(e,t){return this.getPieceAt(new S(e,t))}forEachCoord(e){for(const{coord:t,content:r}of this.getCoordsAndContents())e(t,r)}getCoordsAndContents(){const e=[];for(let t=0;t<this.board.length;t++)for(let r=0;r<this.board[t].length;r++){const s=new S(r,t);this.isOnBoard(s)&&e.push({coord:s,content:this.getPieceAt(s)})}return e}getCopiedBoard(){return Je.copyBiArray(this.board)}toMap(){const e=[];for(let t=0;t<this.board.length;t++)for(let r=0;r<this.board[0].length;r++){const s=new S(r,t);e.push({key:s,value:this.getPieceAt(s)})}return e}[Symbol.iterator](){const e=[];for(const t of this.board)e.push(...t);return e.values()}}class O8 extends br{static getInitialState(){const e=Ie.EMPTY,t=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new O8([[t,t,t,t,s,s,s,s,s],[t,t,t,s,s,s,s,s,s],[t,t,e,e,s,s,s,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}isInBoard(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==Ie.UNREACHABLE}isPiece(e){return this.getPieceAt(e).isPlayer()}getScores(){const e=[14,14];for(let t=0;t<9;t++)for(let r=0;r<9;r++)this.getPieceAtXY(r,t)===Ie.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(r,t)===Ie.ONE&&(e[0]=e[0]-1);return e}}class us extends eo{constructor(e,t){super(),this.coord=new S(e,t)}static getFallibleEncoder(e){return Ye.tuple([S.encoder],t=>[t.coord],t=>e(t[0]).get())}static getEncoder(e){return Ye.tuple([S.encoder],t=>[t.coord],t=>e(t[0]))}equals(e){return this===e||this.coord.equals(e.coord)}}class Gi extends us{constructor(e,t,r){if(super(e.x,e.y),this.dir=t,this.lastPiece=r,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!")}static fromSingleCoord(e,t){try{return _e.success(new Gi(e,t,y.empty()))}catch(r){return _e.failure(r.message)}}static fromDoubleCoord(e,t,r){const s=[e,t];Je.sortByDescending(s,Gi.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=Re.factory.fromDelta(i.x,i.y);if(o.isFailure())return _e.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?_e.failure("Distance between first coord and last coord is too big"):c.equals(r)?Gi.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?Gi.fromSingleCoord(s[0],r):_e.success(new Gi(s[1],r,y.of(s[0])))}static sortCoord(e){return 9*e.y+e.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}Gi.encoder=Ye.tuple([S.encoder,Re.encoder,y.getEncoder(S.encoder)],n=>[n.coord,n.dir,n.lastPiece],n=>new Gi(n[0],n[1],n[2]));let A8=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class Do extends N1{constructor(){super(O8)}static get(){return Do.singleton.isAbsent()&&(Do.singleton=y.of(new Do)),Do.singleton.get()}static isLegal(e,t){const r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toOtherFallible():e.isSingleCoord()?Do.isLegalPush(e,t):Do.isLegalSideStep(e,t)}static getFirstPieceValidity(e,t){const r=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===Ie.ofPlayer(t.getCurrentOpponent())?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):R.SUCCESS}static isLegalPush(e,t){let r=1,s=e.coord.getNext(e.dir);const i=Ie.ofPlayer(t.getCurrentPlayer()),o=Ie.EMPTY,c=t.getCopiedBoard();for(c[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(s)&&t.getPieceAt(s)===i;)r++,s=s.getNext(e.dir);return r>3?_e.failure(A8.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(s)||(c[s.y][s.x]=i,t.getPieceAt(s)===o)?_e.success(c):Do.isLegalRealPush(s,e,t,r,c)}static isLegalRealPush(e,t,r,s,i){let o=0;const c=Ie.ofPlayer(r.getCurrentOpponent()),u=Ie.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(e)&&r.getPieceAt(e)===c;)o++,e=e.getNext(t.dir);return o>=s?_e.failure(A8.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(r.getPieceAt(e)===Ie.EMPTY&&(i[e.y][e.x]=c),r.getPieceAt(e)===u)?_e.failure(A8.CANNOT_PUSH_YOUR_OWN_PIECES()):_e.success(i)}static isLegalSideStep(e,t){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;const o=Ie.ofPlayer(t.getCurrentPlayer()),c=t.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==o)return _e.failure(A8.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(e.dir);if(c[i.y][i.x]=Ie.EMPTY,u.isInRange(9,9)){if(t.isPiece(u))return _e.failure(A8.TRANSLATION_IMPOSSIBLE());t.getPieceAt(u)===Ie.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return _e.success(c)}static getGameStatus(e){const t=e.gameState.getScores();return t[0]>5?Ne.ZERO_WON:t[1]>5?Ne.ONE_WON:Ne.ONGOING}applyLegalMove(e,t,r){return new O8(r,t.turn+1)}isLegal(e,t){return Do.isLegal(e,t)}getGameStatus(e){return Do.getGameStatus(e)}}Do.singleton=y.empty();class U4t extends bs{getListMoves(e){const t=[],r=e.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new S(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of Re.factory.all){const h=Gi.fromSingleCoord(c,u).get();if(this.isAcceptablePush(h,r)){t.push(h);for(const g of Re.factory.all)for(let m=1;m<=2&&!g.equals(u);m++){const M=c.getNext(g,m);if(!M.isInRange(9,9))break;{const b=Gi.fromDoubleCoord(c,M,u).get();Do.isLegal(b,r).isSuccess()&&t.push(b)}}}}}return new Ot(t).toList()}isAcceptablePush(e,t){const r=t.getScores(),s=Do.isLegal(e,t);if(s.isSuccess()){const i=t.getCurrentOpponent().value;return!(new O8(s.get(),t.turn+1).getScores()[i]>r[i])}return!1}getMetrics(e){return e.gameState.getScores()}}const Nn=Ie.EMPTY,Ws=Ie.UNREACHABLE,Ic=Ie.ZERO,g9=Ie.ONE;class L3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Initial board and object of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,O8.getInitialState()),ee.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,O8.getInitialState(),Gi.fromSingleCoord(new S(2,6),Re.UP).get(),$localize`Congratulations!`),ee.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new O8([[Ws,Ws,Ws,Ws,Nn,Ic,Ic,g9,g9],[Ws,Ws,Ws,Nn,Nn,Nn,Nn,Nn,Nn],[Ws,Ws,Nn,Ic,Ic,Ic,g9,Ic,Nn],[Ws,Nn,Nn,Nn,Nn,Nn,Nn,Nn,Nn],[Nn,Nn,Nn,Nn,Ic,Ic,Ic,g9,g9],[Nn,Nn,Nn,Nn,Nn,Nn,Nn,Nn,Ws],[Nn,Nn,Nn,Nn,Ic,g9,Nn,Ws,Ws],[Nn,Nn,Nn,Ic,Nn,Nn,Ws,Ws,Ws],[Nn,Nn,Ic,Nn,Nn,Ws,Ws,Ws,Ws]],0),[Gi.fromSingleCoord(new S(4,4),Re.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)]}}function q4t(n,e){if(1&n){const t=Oe();V(),O(0,"circle",6),J("click",function(){he(t);const s=C(2).index,i=C().index;return ce(C().onPieceClick(s,i))}),A()}if(2&n){const t=C(2).index,r=C().index,s=C();ke("id","piece_",t,"_",r,""),w("ngClass",s.getPieceClasses(t,r)),z("cx",s.getCenterAtXY(t,r).x)("cy",s.getCenterAtXY(t,r).y)("r",.5*s.SPACE_SIZE)}}function W4t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"polygon",4),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().onSpaceClick(s,i))}),A(),x(2,q4t,1,6,"circle",5),A()}if(2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C();T(1),ke("id","space_",r,"_",i,""),w("ngClass",o.getSquareClasses(r,i)),z("points",o.getHexaPointsAtXY(r,i)),T(1),w("ngIf",o.isPiece(s))}}function j4t(n,e){if(1&n&&(V(),O(0,"g"),x(1,W4t,3,5,"g",3),A()),2&n){const t=e.$implicit,r=C(2);T(1),w("ngIf",r.isBoard(t))}}function Z4t(n,e){if(1&n&&(V(),O(0,"g"),x(1,j4t,2,1,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Y4t(n,e){1&n&&(V(),O(0,"marker",7),X(1,"polygon",8),A()),2&n&&h1("id","arrowhead_",e.$implicit.dir.toString(),"")}function K4t(n,e){if(1&n){const t=Oe();V(),O(0,"g"),X(1,"line",9),O(2,"line",10),J("click",function(){const i=he(t).$implicit;return ce(C().chooseDirection(i.dir))}),A(),O(3,"polygon",11),J("click",function(){const i=he(t).$implicit;return ce(C().chooseDirection(i.dir))}),A()()}if(2&n){const t=e.$implicit;T(1),h1("id","line_start_",t.dir.toString(),""),z("x1",t.startCenter.x)("y1",t.startCenter.y)("x2",t.middle.x)("y2",t.middle.y),T(1),h1("id","line_end_",t.dir.toString(),""),z("x1",t.middle.x)("y1",t.middle.y)("x2",t.landingCenter.x)("y2",t.landingCenter.y),T(1),h1("id","direction_",t.dir.toString(),""),z("transform",t.transformation)}}class X4t{constructor(e,t,r,s,i,o){this.startCenter=e,this.middle=t,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let Q4t=(()=>{class n extends d9{constructor(t){super(t),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=Do.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new U4t(this.rules,"Dummy")],this.encoder=Gi.encoder,this.tutorial=(new L3e).tutorial,this.scores=y.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new p9(this.SPACE_SIZE,new S(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),nT.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=y.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showLastMove(t){t.isSingleCoord()?this.showPushingMove(t):this.showSideStepMove(t)}showPushingMove(t){const r=this.getPreviousState();let s=t.coord;for(this.moveds=[s],s=s.getNext(t.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(t.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(t){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(t.dir)),i=i.getNext(s)}onPieceClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#piece_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][t].is(o)?s.opponentClick(t,r):0===s.selecteds.length?s.firstClick(t,r):1===s.selecteds.length?s.secondClick(t,r):s.thirdClick(t,r)})()}opponentClick(t,r){var s=this;return I(function*(){return(yield s.tryChoosingDirection(t,r)).isSuccess()?R.SUCCESS:s.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(t,r){var s=this;return I(function*(){return s.selecteds=[new S(t,r)],s.showPossibleDirections(),R.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(t){const r=this.getState(),s=Ie.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of Re.factory.all){let h,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(t)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(h=t?Gi.fromSingleCoord(i,c).get():Gi.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(h,r).isSuccess()){const m=this.getCenterAt(i),M=this.getCenterAt(u),b=this.getMiddleOfArrow(c,u,M),L=M.x+" "+M.y,G=Re.getAngle(c)+150,te=new X4t(m,b,M,u,c,"rotate("+G+" "+L+") translate("+L+")");this.directions.push(te)}}}getMiddleOfArrow(t,r,s){const i=r.getPrevious(t),o=this.getCenterAt(i);return new S(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(t){return t!==Ie.UNREACHABLE}isPiece(t){return t!==Ie.EMPTY}secondClick(t,r){var s=this;return I(function*(){const i=s.selecteds[0],o=new S(t,r);if(o.equals(i))return s.cancelMoveAttempt(),R.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(t,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(A8.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let h=0;h<c;h++)s.selecteds.push(i.getNext(u,h+1));if(3===s.selecteds.length){const h=s.selecteds[1],g=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[h.y][h.x].is(g))return s.cancelMoveAttempt(),s.firstClick(t,r)}return s.showPossibleDirections(),R.SUCCESS})()}thirdClick(t,r){var s=this;return I(function*(){const i=new S(t,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),R.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(t,r,s){var i=this;return I(function*(){const o=be.factory.fromMove(r,t);if(o.isSuccess()){const u=be.factory.fromMove(s,t);if(o.equals(u)){const h=r.getDistance(t),g=s.getDistance(t);return 2===Math.max(h,g)?(i.selecteds.push(t),Je.sortByDescending(i.selecteds,Gi.sortCoord),i.showPossibleDirections(),R.SUCCESS):i.cancelMove(A8.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(A8.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(t.x,t.y),c})()}deselectExtremity(t){var r=this;return I(function*(){return r.selecteds=r.selecteds.slice(t?1:0,t?void 0:-1),r.showPossibleDirections(),R.SUCCESS})()}chooseDirection(t){var r=this;return I(function*(){const s=r.canUserPlay("#direction_"+t.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(t)})()}_chooseDirection(t){var r=this;return I(function*(){const s=r.selecteds[0];if(1===r.selecteds.length){const i=Gi.fromSingleCoord(s,t).get();return r.chooseMove(i)}{const o=Gi.fromDoubleCoord(s,r.selecteds[r.selecteds.length-1],t).get();return r.chooseMove(o)}})()}onSpaceClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#space_"+t+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(t,r)})()}tryChoosingDirection(t,r){var s=this;return I(function*(){const i=new S(t,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return R.failure("not a direction")})()}getSquareClasses(t,r){const s=new S(t,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(t,r){const s=new S(t,r),i=B.of(this.hexaBoard[r][t].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,Z4t,2,1,"g",1),O(2,"defs"),x(3,Y4t,2,1,"marker",2),A(),x(4,K4t,4,12,"g",1),A()),2&t&&(T(1),w("ngForOf",r.hexaBoard),T(2),w("ngForOf",r.directions),T(1),w("ngForOf",r.directions))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class J4t extends bs{getListMoves(e){const t=e.gameState;return or.ALL_MOVES.filter(function r(s){return b6.get().isLegal(s,t).isSuccess()})}getMetrics(e){const t=e.gameState.board[3].getDominatingPlayer(),r=[0,0];return t.isPlayer()&&(r[t.value]=1),r}}function elt(n,e){if(1&n&&(V(),X(0,"circle",5)),2&n){const t=e.$implicit,r=C();z("cx",r.getRemainingPieceCx(t))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function tlt(n,e){if(1&n&&(V(),X(0,"circle",6)),2&n){const t=e.$implicit,r=C();z("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(t))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function nlt(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",9),J("click",function(){he(t);const s=C().index,i=C();return ce(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),A()}if(2&n){const t=C().index,r=C();h1("id","dropArrow_zero_",t,""),w("ngClass",r.getArrowClasses(t,r.PlayerOrNone.ZERO)),z("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function rlt(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",9),J("click",function(){he(t);const s=C().index,i=C();return ce(i.onArrowClick(s,i.PlayerOrNone.ONE))}),A()}if(2&n){const t=C().index,r=C();h1("id","dropArrow_one_",t,""),w("ngClass",r.getArrowClasses(t,r.PlayerOrNone.ONE)),z("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function slt(n,e){if(1&n){const t=Oe();V(),dn(0),O(1,"circle",10),J("click",function(){he(t);const s=C().index;return ce(C().onSquareClick(s))}),A(),pn()}if(2&n){const t=e.$implicit,r=C(),s=r.index,i=r.$implicit,o=C();T(1),j2("id","square_",s,"_piece_",t,"_out_of_",i.count(o.PlayerOrNone.NONE),""),w("ngClass",o.getPieceClasses(s,t,i)),z("cx",o.getCircleCenter(s,t,i).x)("cy",o.getCircleCenter(s,t,i).y)}}function ilt(n,e){if(1&n){const t=Oe();V(),O(0,"g"),x(1,nlt,1,4,"polygon",7),x(2,rlt,1,4,"polygon",7),O(3,"rect",8),J("click",function(){const i=he(t).index;return ce(C().onSquareClick(i))}),A(),x(4,slt,2,6,"ng-container",4),A()}if(2&n){const t=e.$implicit,r=e.index,s=C();z("transform",s.getBlockTransform(r)),T(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),T(1),w("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),T(1),h1("id","square_",r,""),w("ngClass",s.getSquareClasses(r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngForOf",s.ArrayUtils.range(t.count(s.PlayerOrNone.NONE)))}}let olt=(()=>{class n extends b8{constructor(t){super(t),this.PlayerOrNone=le,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=w8.PIECES_PER_PLAYER,this.selectedPiece=y.empty(),this.leftPiece=y.empty(),this.droppedPiece=y.empty(),this.displayableArrow=[],this.rules=b6.get(),this.node=this.rules.getInitialNode(),this.hasAsymmetricBoard=!0,this.availableMinimaxes=[new J4t(this.rules,"ApagosDummyMinimax")],this.encoder=or.encoder,this.tutorial=(new I3e).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=y.empty(),this.showPossibleDrops()}updateBoard(){const t=this.getState();this.board=t.board,this.remainingZero=t.remaining.get(B.ZERO).get(),this.remainingOne=t.remaining.get(B.ONE).get(),this.hideLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=y.empty(),this.leftPiece=y.empty(),this.selectedPiece=y.empty()}showLastMove(t){t.isDrop()?this.showLastDrop(t):this.showLastTransfer(t)}showLastDrop(t){const r=t.piece.get();let s=t.landing.x;this.movedSquare=[s],3!==t.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=y.of({square:s,piece:o})}getLowestPlayerPiece(t,r){const s=t.count(r);return r===B.ZERO?s-1:t.count(le.NONE)-s}showLastTransfer(t){const r=this.getPreviousState(),s=r.getCurrentPlayer(),i=t.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=y.of({square:i,piece:c});const u=t.landing.x,g=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=y.of({square:u,piece:g})}showPossibleDrops(){this.displayableArrow=[];const t=this.getState();for(let r=0;r<4;r++)!1===t.board[r].isFull()&&(t.remaining.get(B.ZERO).get()>0&&this.displayableArrow.push({x:r,player:B.ZERO}),t.remaining.get(B.ONE).get()>0&&this.displayableArrow.push({x:r,player:B.ONE}))}getCircleCenter(t,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(le.NONE))return new S(i,o);const c=s.count(le.NONE),u=2*r*Math.PI/c-Math.PI/2,h=.3*this.SPACE_SIZE,g=h*Math.cos(u),m=h*Math.sin(u);return new S(i+g,o+m)}canDisplayArrow(t,r){return this.displayableArrow.some(s=>s.x===t&&s.player.equals(r))}getArrowClasses(t,r){return[this.getPlayerClass(r)]}getBlockTransform(t){return"translate("+t*this.SPACE_SIZE+", "+((3-t)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(t){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===t?r.push("selected-stroke"):this.movedSquare.includes(t)&&r.push("last-move-stroke"),r}onArrowClick(t,r){var s=this;return I(function*(){const o=s.canUserPlay("#dropArrow_"+(r===B.ZERO?"zero":"one")+"_"+t);if(o.isFailure())return s.cancelMove(o.getReason());const c=gn.of(t);if(s.selectedPiece.isPresent()){const u=s.selectedPiece.get().square,h=or.transfer(gn.of(u),c).get();return s.chooseMove(h)}{const u=or.drop(c,r);return s.chooseMove(u)}})()}getPieceClasses(t,r,s){const i={square:t,piece:r},o=[];let c=s.count(B.ZERO),u=s.count(B.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===t){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===B.ZERO?c++:u++}const h=s.count(le.NONE)-(u+c),g=this.getPieceColor(r,c,h);return""!==g&&o.push(g),o}getPieceColor(t,r,s){return t<r?"player0-fill":t>=r+s?"player1-fill":""}onSquareClick(t){var r=this;return I(function*(){const s=r.canUserPlay("#square_"+t);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===t)return r.cancelMoveAttempt(),R.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[t];return o.count(i)<=0?r.cancelMove(f9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=y.of({square:t,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(f9.NO_POSSIBLE_TRANSFER_REMAINS()):R.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let t=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=t;)!1===this.board[t].isFull()&&this.displayableArrow.push({x:t,player:r}),t--;return this.displayableArrow}getRemainingPieceCx(t){return(t+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"g"),x(2,elt,1,3,"circle",1),x(3,tlt,1,3,"circle",2),A(),O(4,"g",3),x(5,ilt,5,8,"g",4),A()()),2&t&&(z("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),T(1),z("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),T(1),w("ngForOf",r.ArrayUtils.range(r.remainingOne)),T(1),w("ngForOf",r.ArrayUtils.range(r.remainingZero)),T(2),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),to=(()=>{class n extends b8{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(t,r){},encapsulation:2}),n})();class zo extends br{constructor(e,t,r){super(e,t),this.captured=r}static getInitialState(){const e=Je.createTable(6,2,4);return new zo(e,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let fF=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})();var di;let xc=di=class extends N1{constructor(){super(zo)}static get(){return di.singleton.isAbsent()&&(di.singleton=y.of(new di)),di.singleton.get()}applyLegalMove(e,t,r){const s=e.x,i=t.getCurrentPlayer(),c=t.getCurrentOpponent().value,u=t.getCopiedBoard(),h=di.distribute(s,c,u),g=h[h.length-1];return g.y===c?new zo(u,t.turn+1,t.captured):this.applyPotentialCapture(i,g,u,t)}applyPotentialCapture(e,t,r,s){const i=s.getCurrentOpponent(),o=[s.captured[0],s.captured[1]],c=di.captureIfLegal(t.x,t.y,e,r);o[e.value]+=c.capturedSum;const u=c.resultingBoard;if(di.mustMansoon(e,u)){const h=di.mansoon(i,u);return o[i.value]+=h.capturedSum,new zo(h.resultingBoard,s.turn+1,o)}return new zo(u,s.turn+1,o)}static mustMansoon(e,t){return di.isStarving(e,t)&&!1===di.canDistribute(e.getOpponent(),t)}static mansoon(e,t){const r=Je.copyBiArray(t);let s=0;const i=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let o=0;const c=e.getOpponent().value;do{s+=r[c][o],i[c][o]=r[c][o],r[c][o]=0,o++}while(o<6);return{capturedSum:s,captureMap:i,resultingBoard:r}}static isLegal(e,t){const r=t.getCurrentOpponent(),s=r.value,i=e.x;if(0===t.getPieceAtXY(i,s))return R.failure(fF.MUST_CHOOSE_NON_EMPTY_HOUSE());const o=di.isStarving(r,t.board),c=!1===di.doesDistribute(i,s,t.board);return o&&c?R.failure(fF.SHOULD_DISTRIBUTE()):R.SUCCESS}isLegal(e,t){return di.isLegal(e,t)}static doesDistribute(e,t,r){return 0===t?r[t][e]>5-e:r[t][e]>e}static canDistribute(e,t){for(let r=0;r<6;r++)if(di.doesDistribute(r,e.getOpponent().value,t))return!0;return!1}static isStarving(e,t){let r=0;const s=e.getOpponent().value;do{if(t[s][r++]>0)return!1}while(r<6);return!0}static distribute(e,t,r){const s=e,i=t;let o=r[t][e];const c=[];for(r[t][e]=0;o>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==s||t!==i)&&(r[t][e]+=1,c.push(new S(e,t)),o--);return c}static capture(e,t,r,s){const i=Je.copyBiArray(s);qe(t!==r.getOpponent().value,"AwaleRules.capture cannot capture the players house");let c=i[t][e],u=0;const h=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(c<2||c>3)return{capturedSum:0,captureMap:h,resultingBoard:i};let g=-1,m=-1;r===B.ONE&&(g=1,m=6);do{h[t][e]=c,u+=c,i[t][e]=0,c=i[t][e+=g]}while(e!==m&&(2===c||3===c));return{capturedSum:u,captureMap:h,resultingBoard:i}}static captureIfLegal(e,t,r,s){const i=Je.copyBiArray(s),o=di.capture(e,t,r,s),c=di.isStarving(r.getOpponent(),o.resultingBoard);return o.capturedSum>0&&c?{capturedSum:0,resultingBoard:i,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:o}static getGameStatus(e){const t=e.gameState;return t.captured[0]>24?Ne.ZERO_WON:t.captured[1]>24?Ne.ONE_WON:24===t.captured[0]&&24===t.captured[1]?Ne.DRAW:Ne.ONGOING}getGameStatus(e){return di.getGameStatus(e)}};xc.singleton=y.empty(),xc=di=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],xc);class m1 extends eo{constructor(e){super(),this.x=e}static of(e){switch(e){case 0:return m1.ZERO;case 1:return m1.ONE;case 2:return m1.TWO;case 3:return m1.THREE;case 4:return m1.FOUR;default:return pe.expectToBe(e,5,"Invalid x for AwaleMove: "+e),m1.FIVE}}equals(e){return e===this||e.x===this.x}toString(){return"AwaleMove("+this.x+")"}}m1.ZERO=new m1(0),m1.ONE=new m1(1),m1.TWO=new m1(2),m1.THREE=new m1(3),m1.FOUR=new m1(4),m1.FIVE=new m1(5),m1.encoder=Ye.tuple([Ye.identity()],n=>[n.x],n=>m1.of(n[0]));class clt extends bs{getListMoves(e){const t=[],r=e.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=m1.of(c),xc.isLegal(o,r).isSuccess()&&(o=m1.of(c),t.push(o))),c++}while(c<6);return this.orderMoves(e,t)}orderMoves(e,t){const r=e.gameState.getCurrentPlayer(),s=e.gameState.getCurrentOpponent().value,i=r.value;return Je.sortByDescending(t,o=>{const c=e.gameState.getCopiedBoard(),u=c[s][o.x],h=xc.distribute(o.x,s,c),g=h[h.length-1];let m,M=0;return g.y===s?(m=0,u<=6&&(M=10)):m=xc.captureIfLegal(g.x,i,r,c).capturedSum,100*m+M-u}),t}getMetrics(e){const t=e.gameState.getCapturedCopy();return[t[0],t[1]]}}class R3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.anyMove($localize`Sowing`,$localize`Awalé is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awalé are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,zo.getInitialState(),m1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),ee.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new zo([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),m1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),ee.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new zo([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),ee.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new zo([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),ee.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new zo([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[m1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),ee.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new zo([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[m1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),ee.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new zo([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[m1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),ee.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new zo([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),m1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),ee.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new zo([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),m1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function llt(n,e){if(1&n){const t=Oe();V(),O(0,"text",7),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().onClick(s,i))}),wt(1),A()}if(2&n){const t=C().index,r=C().index,s=C();ke("id","captured_",t,"_",r,""),z("x",65+100*t)("y",81+120*r)("transform",s.getPieceRotation(t,r)),T(1),Ri(" ",-s.captured[r][t]," ")}}function ult(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"circle",4),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),A(),O(2,"text",5),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),wt(3),A(),x(4,llt,2,6,"text",6),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","click_",r,"_",s,""),w("ngClass",i.getSpaceClasses(r,s)),z("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),T(1),ke("id","number_",r,"__",s,""),z("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),T(1),Ri(" ",t," "),T(1),w("ngIf",i.captured[s][r]>0)}}function flt(n,e){if(1&n&&(V(),O(0,"g"),x(1,ult,5,12,"g",2),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}let hlt=(()=>{class n extends to{constructor(t){super(t),this.last=y.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymmetricBoard=!0,this.scores=y.of([0,0]),this.rules=xc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new clt(this.rules,"AwaleMinimax")],this.encoder=m1.encoder,this.tutorial=(new R3e).tutorial,this.updateBoard()}updateBoard(){const t=this.getState();this.scores=y.of(t.getCapturedCopy()),this.hidePreviousMove(),this.board=t.getCopiedBoard(),this.last=y.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showLastMove(t){const r=this.getState().getCurrentPlayer().value;this.last=y.of(new S(t.x,r));const s=this.getPreviousState(),i=Je.copyBiArray(s.board),o=s.getCurrentOpponent().value;this.filledCoords=xc.distribute(t.x,o,i);const c=this.filledCoords[this.filledCoords.length-1];if(c.y!==o){const u=xc.captureIfLegal(c.x,c.y,s.getCurrentPlayer(),i);this.captured=u.captureMap;const h=this.getState().getCurrentPlayer();xc.mustMansoon(h.getOpponent(),u.resultingBoard)&&(this.captured=xc.mansoon(h,u.resultingBoard).captureMap)}}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(fF.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=y.empty();const o=m1.of(t);return s.chooseMove(o)})()}getSpaceClasses(t,r){const s=new S(t,r),i="player"+(r+1)%2+"-fill";return this.captured[r][t]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(t){return 50+100*t}getPieceCy(t){return 50+120*t}getPieceRotation(t,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(t)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),X(1,"rect",1),x(2,flt,2,1,"g",2),X(3,"line",3),A()),2&t&&(z("transform",r.rotation),T(2),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class _a extends eo{constructor(e,t){super(),this.first=e,this.second=t}static getFallibleEncoder(e){return Ye.tuple([S.encoder,S.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]).get())}static getEncoder(e){return Ye.tuple([S.encoder,S.encoder],t=>[t.first,t.second],t=>e(t[0],t[1]))}getFirst(){return this.first}getSecond(){return this.second}}class kc extends _a{constructor(e,t){if(super(e,t),e.equals(t))throw new Error(Xe.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return be.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}equals(e){return this===e||!1!==this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}let rT=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class hF extends kc{constructor(e,t){if(super(e,t),e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+t.toString()+".");const r=e.getDirectionToward(t);if(r.isFailure()||r.get().isDiagonal())throw new Error(rT.MOVE_MUST_BE_ORTHOGONAL())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class Ho extends hF{static of(e,t){return new Ho(e,t)}static from(e,t){try{const r=new Ho(e,t);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 7}}Ho.encoder=_a.getFallibleEncoder(Ho.from);const dlt={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:B.ZERO};class Tn{constructor(e,t){this.owner=e,this.king=t}isKing(){return this.king}getOwner(){return this.owner}}Tn.UNOCCUPIED=new Tn(le.NONE,!1),Tn.PLAYER_ONE_KING=new Tn(le.ONE,!0),Tn.INVADERS=new Tn(le.ZERO,!1),Tn.DEFENDERS=new Tn(le.ONE,!1);class q1{constructor(e){this.value=e}}q1.NONE=new q1("NONE"),q1.OPPONENT=new q1("OPPONENT"),q1.PLAYER=new q1("PLAYER");class dF extends br{isCentralThrone(e){return e.equals(this.getCentralThrone())}getCentralThrone(){const e=(this.board.length-1)/2;return new S(e,e)}getRelativeOwner(e,t){const r=this.getAbsoluteOwner(t);let s;return s=r===le.NONE?q1.NONE:e===r?q1.PLAYER:q1.OPPONENT,s}getAbsoluteOwner(e){return this.getPieceAt(e).getOwner()}}class V3 extends dF{static getInitialState(){const e=Tn.UNOCCUPIED,t=Tn.INVADERS,r=Tn.DEFENDERS;return new V3([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Tn.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}of(e,t){return new V3(e,t)}}class pF extends N1{constructor(e,t,r){super(e),this.config=t,this.generateMove=r}isLegal(e,t){const r=t.getCurrentPlayer(),s=this.getMoveValidity(r,e,t);return s.isFailure()?R.failure(s.getReason()):R.SUCCESS}getMoveValidity(e,t,r){const s=r.getRelativeOwner(e,t.getStart());if(s===q1.NONE)return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(s===q1.OPPONENT)return R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());if(r.getRelativeOwner(e,t.getEnd())!==q1.NONE)return R.failure(rT.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(r,t.getEnd())){if(!r.getPieceAt(t.getStart()).isKing())return R.failure(rT.SOLDIERS_CANNOT_SIT_ON_THRONE());if(r.isCentralThrone(t.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return R.failure(rT.THRONE_IS_LEFT_FOR_GOOD())}const o=t.getStart().getDirectionToward(t.getEnd()).get(),c=t.getStart().getOrthogonalDistance(t.getEnd());let u=t.getStart().getNext(o);for(let h=1;h<c;h++){if(r.getPieceAt(u)!==Tn.UNOCCUPIED)return R.failure(Xe.SOMETHING_IN_THE_WAY());u=u.getNext(o)}return R.SUCCESS}isThrone(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}isExternalThrone(e){const t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}tryCapture(e,t,r,s){const i=t.getNext(r);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&s.getRelativeOwner(e,i)===q1.OPPONENT?s.getPieceAt(i).isKing()?this.captureKing(e,t,r,s):this.capturePawn(e,t,r,s):y.empty()}captureKing(e,t,r,s){const i=t.getNext(r),{backCoord:o,back:c,backInRange:u,left:h,leftCoord:g,right:m,rightCoord:M}=this.getSurroundings(i,r,e,s);return!1===u?this.captureKingAgainstTheWall(h,m,i):c===q1.NONE&&this.isThrone(s,o)?this.captureKingAgainstThrone(o,i,h,m):c===q1.PLAYER?this.captureKingWithAtLeastASandwich(s,i,h,g,m,M):y.empty()}getSurroundings(e,t,r,s){const i=e.getNext(t),o=i.isInRange(this.config.WIDTH,this.config.WIDTH),c=o?s.getRelativeOwner(r,i):q1.NONE,u=e.getLeft(t),g=u.isInRange(this.config.WIDTH,this.config.WIDTH)?s.getRelativeOwner(r,u):q1.NONE,m=e.getRight(t),b=m.isInRange(this.config.WIDTH,this.config.WIDTH)?s.getRelativeOwner(r,m):q1.NONE;return{backCoord:i,back:c,backInRange:o,leftCoord:u,left:g,rightCoord:m,right:b}}captureKingAgainstTheWall(e,t,r){let s=e===q1.PLAYER?1:0;return s+=t===q1.PLAYER?1:0,2===s&&this.config.BORDER_CAN_SURROUND_KING?y.of(r):y.empty()}captureKingAgainstThrone(e,t,r,s){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return y.of(t)}else{const o=s===q1.PLAYER,c=r===q1.PLAYER||o;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&c)return y.of(t)}return y.empty()}capturePawn(e,t,r,s){const i=t.getNext(r),o=i.getNext(r);let c=q1.NONE;return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&(c=s.getRelativeOwner(e,o)),c===q1.NONE?!1===this.isThrone(s,o)?(We.display("TaflRules","capturePawn","cannot capture a pawn without an ally; "+i+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),y.empty()):(We.display("TaflRules","capturePawn","pawn captured by 1 opponent and 1 throne; "+i+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+r.x+", "+r.y+")"),y.of(i)):c===q1.PLAYER?(We.display("TaflRules","capturePawn","pawn captured by 2 opponents; "+i+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+r.x+", "+r.y+")"),y.of(i)):(We.display("TaflRules","capturePawn","no captures; "+i+"threatened by "+e+"'s pawn in "+t+" coming from this direction ("+r.x+", "+r.y+")"),y.empty())}captureKingWithAtLeastASandwich(e,t,r,s,i,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return y.of(t);const c=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,s),h=r===q1.PLAYER||u&&c,g=this.isThrone(e,o);return h&&(i===q1.PLAYER||g&&c)?y.of(t):y.empty()}kingTouchCentralThrone(e,t){const r=e.getCentralThrone();return t.getOrthogonalDistance(r)<=1}applyLegalMove(e,t,r){const s=t.turn,i=t.getCopiedBoard(),o=t.getCurrentPlayer(),c=e.getStart(),u=e.getEnd();i[u.y][u.x]=i[c.y][c.x],i[c.y][c.x]=Tn.UNOCCUPIED;for(const h of Fe.ORTHOGONALS){const g=this.tryCapture(o,e.getEnd(),h,t);g.isPresent()&&(i[g.get().y][g.get().x]=Tn.UNOCCUPIED)}return t.of(i,s+1)}getGameStatus(e){const r=this.getWinner(e.gameState);return r.isPresent()?Ne.getVictory(r.get()):Ne.ONGOING}getWinner(e){const t=this.getKingCoord(e);if(t.isAbsent())return We.display("TaflRules","getWinner","The king is dead, victory to invader"),y.of(this.getInvader());const r=t.get();return this.isExternalThrone(r)?(We.display("TaflRules","getWinner","The king escape, victory to defender"),y.of(this.getDefender())):this.isPlayerImmobilized(B.ZERO,e)?(We.display("TaflRules","getWinner","Zero has no move, victory to one"),y.of(B.ONE)):this.isPlayerImmobilized(B.ONE,e)?(We.display("TaflRules","getWinner","One has no move, victory to zero"),y.of(B.ZERO)):(We.display("TaflRules","getWinner","no victory"),y.empty())}getKingCoord(e){for(let t=0;t<this.config.WIDTH;t++)for(let r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return y.of(new S(r,t));return y.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,t){return 0===this.getPlayerListMoves(e,t).length}getPlayerListMoves(e,t){const r=[],s=this.getPlayerListPawns(e,t);for(const i of s){const o=this.getPossibleDestinations(i,t);for(const c of o){const u=this.generateMove(i,c).get();r.push(u)}}return r}getPlayerListPawns(e,t){const r=[];for(let s=0;s<this.config.WIDTH;s++)for(let i=0;i<this.config.WIDTH;i++){const o=new S(i,s);t.getAbsoluteOwner(o)===e&&r.push(o)}return r}getPossibleDestinations(e,t){const r=[];let s;for(const i of Fe.ORTHOGONALS){s=e.getNext(i,1);let o=!1;for(;s.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===o;)t.getAbsoluteOwner(s)===le.NONE?this.isExternalThrone(s)?t.getPieceAt(e).isKing()&&r.push(s):t.isCentralThrone(s)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&r.push(s):r.push(s):o=!0,s=s.getNext(i,1)}return r}}class N8 extends pF{constructor(){super(V3,dlt,Ho.from)}static get(){return N8.singleton.isAbsent()&&(N8.singleton=y.of(new N8)),N8.singleton.get()}}N8.singleton=y.empty();class gF extends to{constructor(e,t){super(e),this.generateMove=t,this.viewInfo={pieceClasses:[]},this.EMPTY=Tn.UNOCCUPIED,this.capturedCoords=[],this.chosen=y.empty(),this.lastMove=y.empty()}getViewBox(){const e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}updateBoard(){this.board=this.getState().getCopiedBoard(),this.capturedCoords=[],this.updateViewInfo(),this.lastMove=this.node.move}showLastMove(e){const t=this.getPreviousState(),r=this.getState().getCurrentOpponent();for(const s of Fe.ORTHOGONALS){const i=this.lastMove.get().getEnd().getNext(s,1);if(i.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const c=t.getRelativeOwner(r,i)===q1.OPPONENT,h=this.getState().getPieceAt(i)===Tn.UNOCCUPIED;c&&h&&this.capturedCoords.push(i)}}}updateViewInfo(){const e=[];this.board=this.getState().getCopiedBoard();for(let t=0;t<this.board.length;t++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[t][s].getOwner()===le.NONE?[""]:this.getPieceClasses(s,t),r.push(i)}e.push(r)}this.viewInfo={pieceClasses:e}}onClick(e,t){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e+"_"+t);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(e,t);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),R.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(e,t)})()}chooseDestination(e,t){var r=this;return I(function*(){const s=r.chosen.get(),i=new S(e,t),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get()):r.cancelMove(o.getReason())})()}choosePiece(e){return this.board[e.y][e.x]===Tn.UNOCCUPIED?this.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e)?(this.chosen=y.of(e),this.updateViewInfo(),R.SUCCESS):this.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(e){const t=this.getState(),r=t.getCurrentPlayer();return t.getRelativeOwner(r,e)===q1.PLAYER}cancelMoveAttempt(){this.chosen=y.empty(),this.updateViewInfo()}isThrone(e,t){const r=this.getState();return this.rules.isThrone(r,new S(e,t))}isCentralThrone(e,t){return this.getState().isCentralThrone(new S(e,t))}getPieceClasses(e,t){const r=[],s=new S(e,t),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(e,t){const r=[],s=new S(e,t);if(this.capturedCoords.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const e=[];for(let t=0;t<this.board.length;t++)for(let r=0;r<this.board[t].length;r++){const s=new S(r,t);this.isClickable(s)&&e.push(s)}return e}isClickable(e){return this.pieceBelongToCurrentPlayer(e)}isInvader(e,t){return this.board[t][e]===Tn.INVADERS}isKing(e,t){return this.board[t][e].isKing()}}let m9=class extends bs{getListMoves(e){const t=e.gameState,r=t.getCurrentPlayer(),s=this.ruler.getPlayerListMoves(r,t);return this.orderMoves(t,s)}orderMoves(e,t){const r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?Je.sortByDescending(t,s=>-s.getEnd().getOrthogonalDistance(r)):Je.sortByDescending(t,s=>s.getStart().equals(r)?this.ruler.isExternalThrone(s.getEnd())?2:1:0),t}getMetrics(e){const t=e.gameState,r=this.ruler.getPlayerListPawns(B.ZERO,t).length,s=this.ruler.getPlayerListPawns(B.ONE,t).length;return[r*[1,2][this.ruler.config.INVADER.value],s*[2,1][this.ruler.config.INVADER.value]]}};m9=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],m9);class sT{constructor(e,t){this.directThreats=e,this.mover=t}equals(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}class D3e extends sT{constructor(e,t){super(new Ot([e]),t),this.directThreat=e}}class glt extends Ot{constructor(e){if(super(),this.valueMap=[],this.values=[],void 0!==e)for(const t of e)this.add(t)}add(e){const t=this.toFields(e);let r=this.valueMap;for(const i of t[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=t[1];return void 0===r[s]&&(r[s]=!0,this.values.push(e),!0)}contains(e){const t=this.toFields(e);let r=this.valueMap;for(const i of t[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[t[1]]}[Symbol.iterator](){return this.values.values()}}class Or extends glt{toFields(e){return[[e.y],e.x]}}class iT extends m9{constructor(e,t){super(e,t),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const r=e.gameState,s=Tn.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const h of B.PLAYERS)for(const g of o.get(h).get())if(u.get(g).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const M of Fe.ORTHOGONALS){let b=g.getNext(M,1);for(;b.isInRange(this.width,this.width)&&r.getPieceAt(b)===s;)m++,b=b.getNext(M,1)}i+=m*h.getScoreModifier()}return new Vn(i)}getPiecesMap(e){const t=Tn.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new S(c,o);e.getPieceAt(u)!==t&&(e.getAbsoluteOwner(u)===B.ZERO?r.push(u):s.push(u))}return new Wn([{key:B.ZERO,value:new Or(r)},{key:B.ONE,value:new Or(s)}])}getThreatMap(e,t){const r=new Wn;for(const s of B.PLAYERS)for(const i of t.get(s).get()){const o=this.getThreats(i,e);this.isThreatReal(i,e,o)&&r.set(i,new Ot(o))}return r}getThreats(e,t){const r=t.getAbsoluteOwner(e);qe(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of Fe.ORTHOGONALS){const c=e.getPrevious(o,1);if(this.isAThreat(c,t,s)){const u=[];for(const h of Fe.ORTHOGONALS){if(h===o.getOpposite())continue;let g=e.getNext(o,1);for(;g.isInRange(this.width,this.width)&&t.getPieceAt(g)===Tn.UNOCCUPIED;)g=g.getNext(h);g.isInRange(this.width,this.width)&&t.getAbsoluteOwner(g)===s&&!1===e.getNext(o,1).equals(g)&&u.push(g)}i.push(new D3e(c,new Or(u)))}}return i}isAThreat(e,t,r){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==r&&(!this.ruler.isThrone(t,e)||r!==B.ONE&&t.getPieceAt(e)!==Tn.UNOCCUPIED))}isThreatReal(e,t,r){if(0===r.length)return!1;if(t.getPieceAt(e).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(e,t){const r=new Wn,s=e.listKeys(),i=s.filter(c=>t.getAbsoluteOwner(c)===t.getCurrentPlayer()),o=new Or(s.filter(c=>t.getAbsoluteOwner(c)===t.getCurrentOpponent()));for(const c of i){const u=e.get(c).get(),h=[];for(const g of u)if(!1===o.contains(g.directThreat)){const m=[];for(const M of g.mover)!1===o.contains(M)&&m.push(M);m.length>0&&h.push(new D3e(g.directThreat,new Or(m)))}h.length>0&&r.set(c,new Ot(h))}for(const c of o){const u=e.get(c).get();r.set(c,u)}return r}}class oT extends iT{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const r=e.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r);let o=i.controlScore;o+=i.safeScore*this.getScoreBySafePiece(r);const c=this.getScoreByThreatenedPiece(r);return o+=i.threatenedScore*c,qe(i.controlScore<=c,"Control Score should be below "+c+", got "+i.controlScore),qe(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),qe(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new Vn(o)}getControlScoreAndPieceScores(e,t){const r=this.getPiecesMap(t),s=this.getThreatMap(t,r),i=this.filterThreatMap(s,t),o={safeScore:0,threatenedScore:0,controlScore:0};for(const c of B.PLAYERS){const u=new Or;for(const h of r.get(c).get())if(i.get(h).isPresent())o.threatenedScore+=c.getScoreModifier();else{o.safeScore+=c.getScoreModifier();for(const g of Fe.ORTHOGONALS){let m=h.getNext(g,1);for(;m.isInRange(e,e)&&t.getPieceAt(m)===Tn.UNOCCUPIED;)u.add(m),m=m.getNext(g,1)}}for(const h of u){const g=this.getControlledPieceValue(h.x,h.y,e);o.controlScore+=c.getScoreModifier()*g}}return o}getControlledPieceValue(e,t,r){let s=1;return(0===e||e===r-1)&&(s*=r),(0===t||t===r-1)&&(s*=r),s}getScoreByThreatenedPiece(e){const t=e.board.length,r=t-2;return 4*t*t+4*r*t+r*r}getScoreBySafePiece(e){return 16*this.getScoreByThreatenedPiece(e)+1}}class mF extends oT{getBoardValue(e){const t=this.ruler.getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const r=e.gameState,i=this.getControlScoreAndPieceScores(this.ruler.config.WIDTH,r),o=r.getPieceAt(this.ruler.getKingCoord(r).get()).getOwner(),c=this.getStepForEscape(r)*o.getScoreModifier();if(-1===c)return new Vn(o.getOpponent().getPreVictory());const u=this.getScoreByThreatenedPiece(r);return pe.assert(i.controlScore<=u,"Control Score should be below "+u+", got "+i.controlScore),pe.assert(i.threatenedScore<=16,"Threatened Score should be below 16, got "+i.threatenedScore),pe.assert(i.safeScore<=16,"Safe Score should be below 16, got "+i.threatenedScore),new Vn(-1*c*(u+1)*17*17+i.safeScore*(u+1)*17+i.threatenedScore*(u+1)+i.controlScore)}getStepForEscape(e){const t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(-1)}_getStepForEscape(e,t,r,s){const i=this.getNextGen(e,r,s);return 0===i.length?y.empty():i.some(o=>this.ruler.isExternalThrone(o))?y.of(t):(t++,s.push(...i),this._getStepForEscape(e,t,i,s))}getNextGen(e,t,r){const s=[];for(const i of t)for(const o of Fe.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&e.getPieceAt(c)===Tn.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}const ne=Tn.UNOCCUPIED,W1=Tn.INVADERS,va=Tn.DEFENDERS,O_=Tn.PLAYER_ONE_KING;class z3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,V3.getInitialState()),ee.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,V3.getInitialState(),Ho.of(new S(3,1),new S(1,1)),$localize`Congratulations!`),ee.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new V3([[ne,ne,ne,W1,ne,ne,ne],[ne,ne,ne,W1,ne,ne,ne],[W1,ne,ne,va,ne,ne,ne],[ne,ne,va,O_,va,W1,W1],[ne,ne,W1,ne,ne,ne,ne],[ne,ne,ne,va,ne,W1,ne],[ne,ne,ne,W1,ne,ne,ne]],1),[Ho.of(new S(3,5),new S(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ee.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new V3([[ne,ne,ne,W1,ne,ne,ne],[ne,ne,W1,ne,ne,ne,ne],[ne,ne,ne,va,ne,ne,ne],[W1,va,ne,ne,va,W1,W1],[ne,va,ne,ne,ne,ne,ne],[ne,W1,ne,O_,ne,W1,ne],[ne,ne,ne,W1,ne,ne,ne]],12),[Ho.of(new S(2,1),new S(3,1)),Ho.of(new S(3,0),new S(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ee.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new V3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,va,ne,ne,ne],[ne,ne,ne,W1,ne,ne,ne],[ne,W1,ne,O_,W1,ne,ne],[ne,ne,ne,W1,ne,ne,ne],[ne,va,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Ho.of(new S(1,3),new S(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ee.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new V3([[ne,ne,W1,ne,ne,ne,ne],[ne,ne,ne,W1,ne,ne,ne],[ne,ne,ne,O_,W1,ne,ne],[ne,W1,va,ne,va,ne,ne],[ne,ne,ne,W1,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Ho.of(new S(2,0),new S(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),ee.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new V3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,W1,ne,W1,ne,ne,ne],[W1,ne,ne,ne,va,ne,ne],[ne,ne,ne,va,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,O_,ne,W1,ne,ne,ne]],72),[Ho.of(new S(3,6),new S(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function mlt(n,e){1&n&&(V(),X(0,"polygon",8))}function _lt(n,e){1&n&&(V(),X(0,"rect",9))}function vlt(n,e){if(1&n&&(V(),O(0,"g"),x(1,mlt,1,0,"polygon",6),x(2,_lt,1,0,"ng-template",null,7,Un),A()),2&n){const t=Hn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",t)}}function Clt(n,e){if(1&n&&(V(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const t=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function ylt(n,e){if(1&n&&(V(),X(0,"polyline",16)),2&n){const t=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][t])}}function Elt(n,e){if(1&n&&(V(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const t=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function Mlt(n,e){if(1&n&&(V(),x(0,ylt,1,1,"polyline",14),x(1,Elt,4,20,"ng-template",null,15,Un)),2&n){const t=Hn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",t)}}function Slt(n,e){if(1&n&&(V(),O(0,"g"),X(1,"circle",10),x(2,Clt,6,25,"g",11),x(3,Mlt,3,2,"ng-template",null,12,Un),A()),2&n){const t=Hn(4),r=C().index,s=C().index,i=C();T(1),ke("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",t)}}function Plt(n,e){if(1&n){const t=Oe();V(),O(0,"g",3),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",4),x(2,vlt,4,2,"g",5),x(3,Slt,5,8,"g",5),A()}if(2&n){const t=e.index,r=C().index,s=C();ke("id","click_",t,"_",r,""),z("transform","translate("+s.SPACE_SIZE*t+", "+s.SPACE_SIZE*r+")"),T(1),ke("id","space_",t,"_",r,""),w("ngClass",s.getRectClasses(t,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][t]===s.EMPTY&&s.isThrone(t,r)),T(1),w("ngIf",s.board[r][t]!==s.EMPTY)}}function Tlt(n,e){if(1&n&&(V(),O(0,"g"),x(1,Plt,4,10,"g",2),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function wlt(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",17),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C();T(1),ke("id","click_",t.x,"_",t.y,""),z("x",r.SPACE_SIZE*t.x)("y",r.SPACE_SIZE*t.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let blt=(()=>{class n extends gF{constructor(t){super(t,Ho.from),this.rules=N8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new m9(this.rules,"DummyBot"),new iT(this.rules,"Piece > Influence"),new oT(this.rules,"Piece > Control"),new mF(this.rules,"Escape > Piece > Control")],this.encoder=Ho.encoder,this.tutorial=(new z3e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,Tlt,2,1,"g",1),x(2,wlt,2,6,"g",1),A()),2&t&&(z("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),pi=(()=>{class n extends br{static getInitialState(){const t=Je.createTable(n.WIDTH,n.HEIGHT,le.NONE);return new n(t,0)}}return n.WIDTH=19,n.HEIGHT=19,n})();class Qa extends us{constructor(e,t){super(e,t)}static isInRange(e){return e.isInRange(pi.WIDTH,pi.HEIGHT)}static of(e){return pe.assert(Qa.isInRange(e),"FIRST_COORD_IS_OUT_OF_RANGE"),new Qa(e.x,e.y)}toString(){return"ConnectSixFirstMove("+this.coord.x+", "+this.coord.y+")"}}Qa.encoder=us.getEncoder(Qa.of);class F3 extends _a{static of(e,t){return pe.assert(e.isInRange(pi.WIDTH,pi.HEIGHT),"FIRST_COORD_IS_OUT_OF_RANGE"),pe.assert(t.isInRange(pi.WIDTH,pi.HEIGHT),"SECOND_COORD_IS_OUT_OF_RANGE"),pe.assert(!1===e.equals(t),"COORDS_SHOULD_BE_DIFFERENT"),new F3(e,t)}toString(){return"ConnectSixDrops("+this.getFirst().toString()+", "+this.getSecond().toString()+")"}equals(e){const t=this.getFirst(),r=e.getFirst(),s=this.getSecond(),i=e.getSecond();return!(!t.equals(r)||!s.equals(i))||!(!t.equals(i)||!s.equals(r))}}var _F;F3.encoder=_a.getEncoder(F3.of),function(n){n.isFirstMove=function e(r){return r instanceof Qa},n.isDrop=function t(r){return r instanceof F3},n.encoder=Ye.disjunction([n.isFirstMove,n.isDrop],[Qa.encoder,F3.encoder])}(_F||(_F={}));class _9{constructor(e,t,r){this.isInRange=e,this.getOwner=t,this.N=r}getBoardValue(e){let t=0;for(const r of e.getCoordsAndContents()){const i=r.coord;if(this.getOwner(r.content,e).isPlayer()){const o=this.getSquareScore(e,i);if(Vn.VICTORIES.some(c=>c===o))return new Vn(o);t+=o}}return new Vn(t)}getSquareScore(e,t){const r=e.getPieceAt(t),s=this.getOwner(r,e);qe(s.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const i=new Wn,o=new Wn;for(const u of be.DIRECTIONS){const h=this.getNumberOfFreeSpacesAndAllies(e,t,u,s);i.set(u,h[0]),o.set(u,h[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,i)*s.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(e,t){let r=0;for(const s of[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT]){const i=e.get(s).get(),o=e.get(s.getOpposite()).get();if(this.N<=i+o+1)return Number.MAX_SAFE_INTEGER;const g=t.get(s).get()+t.get(s.getOpposite()).get();this.N<=g+1&&(r+=2+g-this.N)}return r}getNumberOfFreeSpacesAndAllies(e,t,r,s){let i=0,o=0,c=!0,u=new S(t.x+r.x,t.y+r.y),h=1;const g=s.getOpponent();for(;this.isInRange(u)&&h<this.N;){const m=e.getPieceAt(u);if(this.getOwner(m,e)===g)return[i,o];this.getOwner(m,e)===s&&c?o++:c=!1,m!==g&&m!==s&&i++,u=u.getNext(r),h++}return[i,o]}getVictoriousCoord(e){const t=[];for(const r of e.getCoordsAndContents())if(this.getOwner(r.content,e).isPlayer()){const s=r.coord,i=this.getSquareScore(e,s);x2.getScoreStatus(i)===Pn.VICTORY&&(i===B.ZERO.getVictoryValue()||i===B.ONE.getVictoryValue())&&t.push(s)}return t}}class Ja extends N1{constructor(){super(pi)}static get(){return Ja.singleton.isAbsent()&&(Ja.singleton=y.of(new Ja)),Ja.singleton.get()}static getVictoriousCoords(e){return Ja.CONNECT_SIX_HELPER.getVictoriousCoord(e)}applyLegalMove(e,t,r){return e instanceof F3?this.applyLegalDrops(e,t):this.applyLegalFirstMove(e,t)}applyLegalDrops(e,t){const r=t.getCurrentPlayer(),s=e.getFirst(),i=e.getSecond(),o=t.getCopiedBoard();return o[s.y][s.x]=r,o[i.y][i.x]=r,new pi(o,t.turn+1)}applyLegalFirstMove(e,t){const r=t.getCurrentPlayer(),s=t.getCopiedBoard();return s[e.coord.y][e.coord.x]=r,new pi(s,t.turn+1)}isLegal(e,t){return 0===t.turn?(pe.assert(e instanceof Qa,"First move should be instance of ConnectSixFirstMove"),R.SUCCESS):(pe.assert(e instanceof F3,"non-firsts moves should be instance of ConnectSixDrops"),this.isLegalDrops(e,t))}isLegalDrops(e,t){return t.getPieceAt(e.getFirst()).isPlayer()||t.getPieceAt(e.getSecond()).isPlayer()?R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}getGameStatus(e){const t=e.gameState;return Ja.CONNECT_SIX_HELPER.getVictoriousCoord(t).length>0?Ne.getVictory(t.getCurrentOpponent()):181===t.turn?Ne.DRAW:Ne.ONGOING}}Ja.singleton=y.empty(),Ja.CONNECT_SIX_HELPER=new _9(Qa.isInRange,pe.identity,6);const U=le.NONE,k2=le.ZERO,Ui=le.ONE;class H3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Initial board and object of the game`,$localize`Connect Six is played on a 19x19 board, on which stones are put on the intersections. The aim of the game is to align 6 of your pieces.`,pi.getInitialState()),ee.anyMove($localize`First turn`,$localize`On the first turn, the first player plays only one piece.<br/><br/>You're playing Dark, place your first piece by clicking on an intersection.`,pi.getInitialState(),Qa.of(new S(9,9)),$localize`Congratulations!`),ee.anyMove($localize`Next turns`,$localize`On all following turns, the players play two pieces.<br/><br/>You're playing Light, do the winning move.`,new pi([[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,Ui,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,k2,U,Ui,k2,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,k2,k2,U,U,Ui,U,U,U,U,U,U],[U,U,U,U,U,U,U,Ui,k2,k2,k2,k2,Ui,U,U,U,U,U,U],[U,U,U,U,U,U,Ui,k2,k2,k2,k2,Ui,U,U,U,U,U,U,U],[U,U,U,U,U,U,Ui,U,Ui,k2,Ui,Ui,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,k2,Ui,k2,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,Ui,U,Ui,U,k2,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,Ui,Ui,U,Ui,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,Ui,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,k2,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U],[U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U,U]],20),F3.of(new S(4,11),new S(5,10)),$localize`Congratulations!`)]}}let vF=(()=>{class n extends to{constructor(){super(...arguments),this.hoshis=[]}createHoshis(){const t=this.board.length,r=Math.floor(t/2),s=t<12?2:3,i=t-(s+1);18<t&&this.hoshis.push(new S(s,r),new S(r,s),new S(r,i),new S(i,r)),this.hoshis.push(new S(r,r),new S(s,s),new S(s,i),new S(i,s),new S(i,i))}isHoshi(t,r){return this.hoshis.some(s=>s.x===t&&s.y===r)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(t,r){},encapsulation:2}),n})();class Olt extends Xa{getListMoves(e){return 0===e.gameState.turn?this.getFirstMove():this.getListDrops(e)}getFirstMove(){const t=pi.HEIGHT,r=Math.floor(pi.WIDTH/2),s=Math.floor(t/2);return[Qa.of(new S(r,s))]}getListDrops(e){const t=this.getAvailableCoords(e.gameState),r=[];for(const s of t){const i=e.gameState.getCopiedBoard();i[s.y][s.x]=e.gameState.getCurrentPlayer();const o=new pi(i,e.gameState.turn),c=this.getAvailableCoords(o);for(const u of c){const h=F3.of(s,u);r.push(h)}}return new Ot(r).toList()}getAvailableCoords(e){const t=this.getUsefulCoordsMap(e),r=[];for(const s of e.getCoordsAndContents()){const i=s.coord;!0===t[i.y][i.x]&&!1===s.content.isPlayer()&&r.push(i)}return r}getUsefulCoordsMap(e){const t=Je.createTable(pi.WIDTH,pi.HEIGHT,!1);for(const r of e.getCoordsAndContents())r.content.isPlayer()&&this.addNeighboringCoord(t,r.coord);return t}addNeighboringCoord(e,t){const s=Math.max(0,t.x-1),i=Math.max(0,t.y-1),o=Math.min(pi.WIDTH-1,t.x+1),c=Math.min(pi.HEIGHT-1,t.y+1);for(let u=i;u<=c;u++)for(let h=s;h<=o;h++)e[u][h]=!0}getBoardValue(e){const t=e.gameState;let r=0;for(const s of t.getCoordsAndContents())if(s.content.isPlayer()){const i=Ja.CONNECT_SIX_HELPER.getSquareScore(t,s.coord);if(x2.getScoreStatus(i)===Pn.VICTORY)return new Vn(i);r+=i}return new Vn(r)}}function Alt(n,e){if(1&n&&(V(),X(0,"circle",8)),2&n){const t=C().index,r=C().index,s=C();ke("id","piece_",t,"_",r,""),w("ngClass",s.getSpaceClass(t,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function Nlt(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=C(2).index,r=C().index,s=C();ke("id","hoshi_",t,"_",r,""),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function Ilt(n,e){if(1&n&&(V(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,Nlt,1,5,"circle",11)),2&n){const t=C().index,r=C().index,s=C();z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*t)("y",.5*s.SPACE_SIZE*r),T(1),z("x1",.5*s.SPACE_SIZE*t)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),w("ngIf",s.isHoshi(t,r))}}function xlt(n,e){if(1&n){const t=Oe();V(),O(0,"g",5),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),x(1,Alt,1,6,"circle",6),x(2,Ilt,4,13,"ng-template",null,7,Un),A()}if(2&n){const t=e.$implicit,r=e.index,s=Hn(3);ke("id","click_",r,"_",C().index,""),T(1),w("ngIf",t.isPlayer())("ngIfElse",s)}}function klt(n,e){if(1&n&&(V(),O(0,"g"),x(1,xlt,4,4,"g",4),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Llt(n,e){if(1&n){const t=Oe();V(),O(0,"circle",13),J("click",function(){he(t);const s=C();return ce(s.onClick(s.droppedCoord.get().x,s.droppedCoord.get().y))}),A()}if(2&n){const t=C();w("ngClass",t.getSpaceClass(t.droppedCoord.get().x,t.droppedCoord.get().y)),z("cx",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().x)("cy",.25*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.droppedCoord.get().y)("r",.22*t.SPACE_SIZE)}}let Rlt=(()=>{class n extends vF{constructor(t){super(t),this.droppedCoord=y.empty(),this.lastMoved=[],this.victoryCoords=[],this.rules=Ja.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Olt(this.rules,"Minimax")],this.encoder=_F.encoder,this.tutorial=(new H3e).tutorial}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.victoryCoords=Ja.getVictoriousCoords(t),this.createHoshis()}showLastMove(t){this.lastMoved=t instanceof Qa?[t.coord]:[t.getFirst(),t.getSecond()]}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r);if(0===s.getState().turn){const c=Qa.of(o);return s.chooseMove(c)}if(s.getState().getPieceAt(o).isPlayer())return s.cancelMove(Xe.MUST_CLICK_ON_EMPTY_SQUARE());if(s.droppedCoord.isPresent()){if(s.droppedCoord.equalsValue(o))return s.droppedCoord=y.empty(),R.SUCCESS;{const c=F3.of(s.droppedCoord.get(),o);return s.chooseMove(c)}}return s.droppedCoord=y.of(o),R.SUCCESS})()}getSpaceClass(t,r){const s=new S(t,r),i=this.getState().getPieceAt(s),o=[];return this.droppedCoord.equalsValue(s)?(o.push(this.getPlayerClass(this.getState().getCurrentPlayer())),o.push("highlighted-stroke")):(o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.some(c=>c.equals(s))&&o.push("last-move-stroke")),o}cancelMoveAttempt(){this.droppedCoord=y.empty()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-connect-six"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["id","dropped","class","base mid-stroke moved-stroke",3,"ngClass","click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],["id","dropped",1,"base","mid-stroke","moved-stroke",3,"ngClass","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),X(1,"rect",1),x(2,klt,2,1,"g",2),x(3,Llt,1,4,"circle",3),A()),2&t&&(z("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),T(1),z("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.droppedCoord.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),O6=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class Wt extends br{static getInitialState(){const e=Je.createTable(Wt.WIDTH,Wt.HEIGHT,le.NONE);return new Wt(e,0)}isShelter(e){return 0===e.x||e.x===Wt.WIDTH-1?Wt.SHELTERS_INDICES.some(t=>e.y===t):(0===e.y||e.y===Wt.HEIGHT-1)&&Wt.SHELTERS_INDICES.some(t=>e.x===t)}isCentralZone(e){return e.x>=Wt.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=Wt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=Wt.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=Wt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}Wt.WIDTH=17,Wt.HEIGHT=17,Wt.CENTRAL_ZONE_TOP_LEFT=new S(4,6),Wt.CENTRAL_ZONE_BOTTOM_RIGHT=new S(12,10),Wt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Wt.ALL_SHELTERS=new Ot(Wt.SHELTERS_INDICES.flatMap(n=>[new S(n,0),new S(n,Wt.HEIGHT-1),new S(0,n),new S(Wt.WIDTH-1,n)])).toList();class A6 extends us{constructor(e){super(e.x,e.y)}static of(e){return pe.assert(e.isInRange(Wt.WIDTH,Wt.HEIGHT),"Move out of board"),new A6(e)}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(e){return!!gi.isDrop(e)&&this.coord.equals(e.coord)}}A6.encoder=us.getEncoder(A6.of);class N6 extends kc{constructor(e,t){super(e,t)}static from(e,t){const r=e.isInRange(Wt.WIDTH,Wt.HEIGHT),s=t.isInRange(Wt.WIDTH,Wt.HEIGHT);return pe.assert(r&&s,"Move out of board"),e.isAlignedWith(t)&&1===e.getDistance(t)?_e.success(new N6(e,t)):_e.failure(O6.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP())}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!!gi.isSimple(e)&&super.equals(e)}}N6.encoder=_a.getFallibleEncoder(N6.from);class Lc extends eo{constructor(e){super(),this.coords=e}static from(e){if(e.length<2)return _e.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of e)if(r.isNotInRange(Wt.WIDTH,Wt.HEIGHT))return _e.failure("Move out of board");for(let r=1;r<e.length;r++)if(e[r-1].getDirectionToward(e[r]).isFailure()||2!==e[r-1].getDistance(e[r]))return _e.failure(O6.INVALID_JUMP());return new Or(e).size()===e.length?_e.success(new Lc(e)):_e.failure(O6.SAME_LOCATION_VISITED_IN_JUMP())}addJump(e){const t=Je.copyImmutableArray(this.coords);return t.push(e),Lc.from(t)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const e=[];for(let t=1;t<this.coords.length;t++){const r=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(r,1))}return e}toString(){return`ConspirateursMoveJump(${this.coords.map(t=>t.toString()).reduce((t,r)=>t+" -> "+r)})`}equals(e){return!(gi.isSimple(e)||gi.isDrop(e)||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}}var gi;Lc.encoder=Ye.tuple([Ye.list(S.encoder)],n=>[Je.copyImmutableArray(n.coords)],n=>Lc.from(n[0]).get()),function(n){n.isDrop=function e(s){return s instanceof A6},n.isSimple=function t(s){return s instanceof N6},n.isJump=function r(s){return s instanceof Lc},n.encoder=Ye.disjunction([n.isDrop,n.isSimple,n.isJump],[A6.encoder,N6.encoder,Lc.encoder])}(gi||(gi={}));const P=le.NONE,kt=le.ZERO,Nt=le.ONE;class V3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Wt.getInitialState()),ee.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Wt.getInitialState(),A6.of(new S(7,7)),$localize`Congratulations!`),ee.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Wt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,kt,kt,Nt,Nt,kt,kt,Nt,kt,Nt,P,P,P,P],[P,P,P,P,kt,Nt,kt,Nt,kt,kt,kt,kt,Nt,P,P,P,P],[P,P,P,P,kt,Nt,P,P,P,P,P,Nt,kt,P,P,P,P],[P,P,P,P,Nt,kt,kt,Nt,Nt,Nt,kt,kt,kt,P,P,P,P],[P,P,P,P,Nt,kt,Nt,Nt,Nt,Nt,Nt,Nt,kt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),N6.from(new S(4,6),new S(3,5)).get(),(e,t,r)=>gi.isSimple(e)?R.SUCCESS:R.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),ee.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Wt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,kt,kt,Nt,Nt,kt,kt,Nt,kt,Nt,P,P,P,P],[P,P,P,P,kt,Nt,kt,Nt,kt,kt,kt,kt,Nt,P,P,P,P],[P,P,P,P,kt,Nt,P,P,P,P,P,Nt,kt,P,P,P,P],[P,P,P,P,Nt,kt,kt,Nt,Nt,Nt,kt,kt,kt,P,P,P,P],[P,P,P,P,Nt,kt,Nt,Nt,Nt,Nt,Nt,Nt,kt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),Lc.from([new S(6,7),new S(6,5)]).get(),(e,t,r)=>gi.isJump(e)?R.SUCCESS:R.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),ee.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Wt([[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,Nt,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,Nt,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,Nt,P,P,P,P,P,P,P,P,P],[P,P,P,P,kt,kt,P,Nt,kt,kt,Nt,kt,Nt,P,P,P,P],[P,P,P,P,kt,P,kt,Nt,kt,kt,kt,kt,Nt,P,P,P,P],[P,P,P,P,kt,Nt,P,P,P,P,P,Nt,kt,P,P,P,P],[P,P,P,P,Nt,kt,kt,Nt,Nt,Nt,kt,kt,kt,P,P,P,P],[P,P,P,P,Nt,kt,Nt,Nt,Nt,Nt,Nt,Nt,kt,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P],[P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P,P]],40),[Lc.from([new S(8,6),new S(6,4),new S(6,2),new S(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}class ec extends N1{constructor(){super(Wt)}static get(){return ec.singleton.isAbsent()&&(ec.singleton=y.of(new ec)),ec.singleton.get()}applyLegalMove(e,t,r){const s=t.getCopiedBoard();if(gi.isDrop(e))s[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(gi.isSimple(e))s[e.getStart().y][e.getStart().x]=le.NONE,s[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer();else{const i=e.getStartingCoord(),o=e.getEndingCoord();s[i.y][i.x]=le.NONE,s[o.y][o.x]=t.getCurrentPlayer()}return new Wt(s,t.turn+1)}isLegal(e,t){return gi.isDrop(e)?this.dropLegality(e,t):gi.isSimple(e)?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}dropLegality(e,t){return t.turn>=40?R.failure(O6.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?R.failure(O6.MUST_DROP_IN_CENTRAL_ZONE()):R.SUCCESS}simpleMoveLegality(e,t){return t.turn<40?R.failure(O6.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.getEnd()).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}jumpLegality(e,t){if(t.turn<40)return R.failure(O6.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());for(const r of e.getJumpedOverCoords())if(t.getPieceAt(r)===le.NONE)return R.failure(O6.MUST_JUMP_OVER_PIECES());for(const r of e.getLandingCoords())if(t.getPieceAt(r).isPlayer())return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());return R.SUCCESS}jumpTargetsFrom(e){const t=[new S(e.x+2,e.y),new S(e.x-2,e.y),new S(e.x,e.y+2),new S(e.x,e.y-2),new S(e.x+2,e.y+2),new S(e.x+2,e.y-2),new S(e.x-2,e.y+2),new S(e.x-2,e.y-2)],r=[];for(const s of t)Lc.from([e,s]).isSuccess()&&r.push(s);return r}nextJumps(e,t){const r=e.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=e.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),t).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(e,t){return this.nextJumps(e,t).length>0}getGameStatus(e){const t=e.gameState,r=[0,0];for(const s of Wt.ALL_SHELTERS){const i=t.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return Ne.getVictory(i)}return Ne.ONGOING}}ec.singleton=y.empty();let A_=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})();class wn{constructor(e,t){this.owner=e,this.otherPieceType=t}static of(e,t){return e===B.ZERO?t?wn.ZERO_SECOND:wn.ZERO_FIRST:e===B.ONE?t?wn.ONE_SECOND:wn.ONE_FIRST:wn.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}equals(e){return this===e}}wn.encoder=Ye.tuple([le.encoder,Ye.identity()],n=>[n.owner,n.otherPieceType],n=>wn.of(n[0],n[1])),wn.EMPTY=new wn(le.NONE,!1),wn.ZERO_FIRST=new wn(B.ZERO,!1),wn.ZERO_SECOND=new wn(B.ZERO,!0),wn.ONE_FIRST=new wn(B.ONE,!1),wn.ONE_SECOND=new wn(B.ONE,!0),wn.PLAYER_PIECES=[wn.ZERO_FIRST,wn.ZERO_SECOND,wn.ONE_FIRST,wn.ONE_SECOND];class F3e extends eo{isDrop(){return this instanceof I6}isShift(){return this instanceof qi}}class I6 extends F3e{constructor(e,t){if(super(),this.target=e,this.piece=t,t===wn.EMPTY)throw new Error("Cannot drop an empty piece")}getTarget(){return this.target}equals(e){return e instanceof I6&&!(this.target!==e.target||this.piece!==e.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}I6.encoder=Ye.tuple([Ye.identity(),wn.encoder],n=>[n.target,n.piece],n=>new I6(n[0],n[1]));class qi extends F3e{constructor(e,t){super(),this.start=e,this.moveDirection=t}static ofRepresentation(e,t){return new qi(new S(e.x,3-e.y),t)}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(e){return e instanceof qi&&!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}qi.encoder=Ye.tuple([S.encoder,Ye.identity()],n=>[n.start,"clockwise"===n.moveDirection],n=>new qi(n[0],n[1]?"clockwise":"counterclockwise"));const Dlt=Ye.disjunction([n=>n.isDrop(),n=>n.isShift()],[I6.encoder,qi.encoder]);let zr=(()=>{class n extends br{constructor(t,r,s){super(t,s),this.remainingPieces=r}static getInitialState(){const t=wn.EMPTY;return new n([[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t]],[4,4,4,4],0)}static ofRepresentation(t,r){const s=t.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==wn.EMPTY&&i[n.pieceIndex(u)]--}return qe(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(t){switch(t){case wn.ZERO_FIRST:return 0;case wn.ZERO_SECOND:return 1;case wn.ONE_FIRST:return 2;default:return pe.expectToBe(t,wn.ONE_SECOND),3}}getRemainingPiecesOf(t){return this.remainingPieces[n.pieceIndex(t)]}getStackHeight(t){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(t,s)!==wn.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class Z4 extends N1{constructor(){super(zr)}static get(){return Z4.singleton.isAbsent()&&(Z4.singleton=y.of(new Z4)),Z4.singleton.get()}applyLegalMove(e,t,r){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}applyLegalDrop(e,t){const r=Je.copyBiArray(t.board);r[t.getStackHeight(e.target)][e.target]=e.piece;const s=Je.copyImmutableArray(t.remainingPieces);return s[zr.pieceIndex(e.piece)]-=1,new zr(r,s,t.turn+1)}applyLegalShift(e,t){const r=Je.copyBiArray(t.board),s=e.getTarget();let i=t.getStackHeight(s),o=e.start.y;for(;o<zr.HEIGHT&&t.getPieceAtXY(e.start.x,o)!==wn.EMPTY;)r[i][s]=t.getPieceAtXY(e.start.x,o),r[o][e.start.x]=wn.EMPTY,i++,o++;return new zr(r,t.remainingPieces,t.turn+1)}isLegal(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}isDropLegal(e,t){return e.piece.owner!==t.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?R.failure(A_.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}dropHeightValidity(e,t){return t.getStackHeight(e.target)===zr.HEIGHT?R.failure(A_.SPACE_IS_FULL()):R.SUCCESS}isShiftLegal(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}shiftHeightValidity(e,t){const r=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+r>zr.HEIGHT?R.failure(A_.TARGET_STACK_TOO_HIGH()):R.SUCCESS}getGameStatus(e){const t=this.findHighestAlignment(e.gameState);if(t.isPresent()){const r=e.gameState.getPieceAt(t.get());return qe(r.owner.isPlayer(),"highest alignment is owned by a player"),Ne.getVictory(r.owner)}return Ne.ONGOING}findHighestAlignment(e){for(let t=0;t<zr.WIDTH/2;t++)for(let r=zr.HEIGHT-1;r>0;r--){const s=e.getPieceAtXY(t,r),i=e.getPieceAtXY(t+zr.WIDTH/2,r);if(s!==wn.EMPTY&&s===i)return y.of(new S(t,r))}return y.empty()}pieceCanMove(e,t){return!!this.isShiftLegal(new qi(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new qi(t,"counterclockwise"),e).isSuccess()}}Z4.singleton=y.empty();const it=wn.EMPTY,v9=wn.ZERO_FIRST,B3e=wn.ZERO_SECOND,aT=wn.ONE_FIRST,CF=wn.ONE_SECOND;class $3e{constructor(){this.tutorial=[ee.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,zr.getInitialState()),ee.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,zr.ofRepresentation([[it,it,it,it,it,it,it,it],[it,it,it,it,it,it,it,it],[it,it,it,it,aT,it,it,it],[v9,it,it,it,v9,it,it,it]],3),[new I6(0,wn.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),ee.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,zr.ofRepresentation([[it,it,it,it,it,it,it,it],[it,it,it,it,CF,it,it,it],[it,it,it,it,v9,it,it,it],[aT,it,it,it,B3e,it,it,it]],4),[qi.ofRepresentation(new S(4,3),"counterclockwise"),qi.ofRepresentation(new S(4,3),"clockwise"),qi.ofRepresentation(new S(4,2),"counterclockwise"),qi.ofRepresentation(new S(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),ee.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,zr.ofRepresentation([[it,it,it,it,v9,it,it,it],[it,it,it,it,CF,it,it,v9],[it,it,it,it,v9,it,it,CF],[it,aT,it,it,B3e,it,it,aT]],8),[qi.ofRepresentation(new S(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}let G3e=(()=>{class n extends b8{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(t,r){return(t+r)%2==1?this.getDownwardCoordinate(t,r):this.getUpwardCoordinate(t,r)}getTriangleCoordinate(t,r){return this.getTriangleCornerCoords(t,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(t,r){const i=.5*this.SPACE_SIZE*(t+1),o=.5*this.SPACE_SIZE*(t+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new S(.5*this.SPACE_SIZE*t,c);return[h,new S(i,u),new S(o,c),h]}getUpwardCoordinate(t,r){const i=.5*this.SPACE_SIZE*(t+1),o=.5*this.SPACE_SIZE*(t+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new S(.5*this.SPACE_SIZE*t,u);return[h,new S(i,c),new S(o,u),h]}getPyramidCoordinate(t,r){return(t+r)%2==1?this.getDownwardPyramidCoordinate(t,r):this.getUpwardPyramidCoordinate(t,r)}getDownwardPyramidCoordinate(t,r){const s=this.SPACE_SIZE*t/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}getUpwardPyramidCoordinate(t,r){const s=this.SPACE_SIZE*t/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(t,r){},encapsulation:2}),n})(),N_=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n})();class dr{constructor(e,t){this.direction=e,this.str=t}static ofCoords(e,t){const r=e.getVectorToward(t),s=dr.STEPS.findIndex(i=>i.direction.equals(r));return pe.assert(-1!==s,N_.INVALID_DISTANCE()),dr.STEPS[s]}}dr.LEFT=new dr(new Bt(-2,0),"LEFT"),dr.UP_LEFT=new dr(be.UP_LEFT,"UP_LEFT"),dr.UP_RIGHT=new dr(be.UP_RIGHT,"UP_RIGHT"),dr.RIGHT=new dr(new Bt(2,0),"RIGHT"),dr.DOWN_LEFT=new dr(be.DOWN_LEFT,"DOWN_LEFT"),dr.DOWN_RIGHT=new dr(be.DOWN_RIGHT,"DOWN_RIGHT"),dr.STEPS=[dr.LEFT,dr.UP_LEFT,dr.UP_RIGHT,dr.RIGHT,dr.DOWN_LEFT,dr.DOWN_RIGHT];class Wi extends kc{constructor(e,t){super(e,t)}static of(e,t){const r=dr.ofCoords(e,t);return Wi.ofMovement(e,r)}static ofMovement(e,t){pe.assert(e.isInRange(15,10),"Starting coord cannot be out of range (width: 15, height: 10).");const r=new S(e.x+t.direction.x,e.y+t.direction.y);return pe.assert(r.isInRange(15,10),"Landing coord cannot be out of range (width: 15, height: 10)."),new Wi(e,r)}toString(){return"CoerceoRegularMove("+this.getStart().toString()+" > "+this.getEnd().toString()+")"}equals(e){return!I8.isTileExchange(e)&&super.equals(e)}}Wi.encoder=kc.getEncoder(Wi.of);class x6 extends us{constructor(e){super(e.x,e.y)}static of(e){return pe.assert(e.isInRange(15,10),"Captured coord cannot be out of range (width: 15, height: 10)."),new x6(e)}toString(){return"CoerceoTileExchangeMove("+this.coord.x+", "+this.coord.y+")"}equals(e){return!!I8.isTileExchange(e)&&e.coord.equals(this.coord)}}var I8,Y4;x6.encoder=us.getEncoder(x6.of),function(n){n.isNormalMove=function e(r){return r instanceof Wi},n.isTileExchange=function t(r){return r instanceof x6},n.encoder=Ye.disjunction([n.isNormalMove,n.isTileExchange],[Wi.encoder,x6.encoder])}(I8||(I8={}));class Rc{static getNeighbors(e){let t;const r=new S(e.x-1,e.y),s=new S(e.x+1,e.y);return t=(e.x+e.y)%2==1?[r,s,new S(e.x,e.y-1)]:[r,s,new S(e.x,e.y+1)],t}static getFakeNeighbors(e){return new S(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}static getCommonNeighbor(e,t){const r=Rc.getNeighbors(e),s=Rc.getNeighbors(t);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return y.of(o);c++}i++}return y.empty()}static isSpaceDark(e){return(e.x+e.y)%2==0}}class t7 extends br{static getEmptyNeighbors(e,t,r){const s=[];for(const i of Rc.getNeighbors(t))i.isInRange(e[0].length,e.length)&&e[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(e,t){return t7.getEmptyNeighbors(this.board,e,t)}}let ji=Y4=class extends t7{constructor(e,t,r,s){super(e,t),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(e){const t=e.x-e.x%3;let r=e.y;return r-=t%2==0?e.y%2:(e.y+1)%2,new S(t,r)}static getPresentNeighborEntrances(e){return[new S(e.x+1,e.y-1),new S(e.x+3,e.y+0),new S(e.x+3,e.y+1),new S(e.x+1,e.y+2),new S(e.x-1,e.y+1),new S(e.x-1,e.y+0)].filter(Y4.isInRange)}static getInitialState(){const e=Ie.EMPTY,t=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new Y4([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,s,e,s,e,e,r,e,r,e,e,s,e,s,e],[s,e,e,e,s,e,e,e,e,e,s,e,e,e,s],[e,s,e,s,e,e,e,e,e,e,e,s,e,s,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,s,e,s,e,e,r,e,r,e],[t,t,t,e,e,s,e,e,e,s,e,e,t,t,t],[t,t,t,t,t,t,s,e,s,t,t,t,t,t,t]],0,[0,0],[0,0])}applyLegalMovement(e){const t=e.getStart(),r=e.getEnd(),s=this.getCopiedBoard();return s[r.y][r.x]=Ie.ofPlayer(this.getCurrentPlayer()),s[t.y][t.x]=Ie.EMPTY,new Y4(s,this.turn,this.tiles,this.captures)}doMovementCaptures(e){const t=this.getCapturedNeighbors(e.getEnd());let r=this;for(const s of t)r=r.capture(s);return r}getCapturedNeighbors(e){const t=this.getCurrentOpponent();return Rc.getNeighbors(e).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(t)&&this.isSurrounded(s))}isSurrounded(e){return 0===this.getEmptyNeighbors(e,Ie.EMPTY).length}capture(e){const t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return t[e.y][e.x]=Ie.EMPTY,r[this.getCurrentPlayer().value]+=1,new Y4(t,this.turn,this.tiles,r)}removeTilesIfNeeded(e,t){let r=this;const s=Y4.getTilesUpperLeftCoord(e);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,t);const i=Y4.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===Ie.EMPTY?r=r.removeTilesIfNeeded(o,t):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(e){qe(this.getPieceAt(e)!==Ie.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let t=0;t<2;t++)for(let r=0;r<3;r++){const s=e.getNext(new Bt(r,t),1);if(this.getPieceAt(s)!==Ie.EMPTY)return!1}return!0}isDeconnectable(e){const t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;let r=0;for(let s=1;s<t.length;s++)!1===this.areNeighbor(t[s-1],t[s])&&(r+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(r+=1),r<=1}areNeighbor(e,t){return e+1===t||0===e&&5===t}getPresentNeighborTilesRelativeIndexes(e){const t=[];let r=y.empty();for(let s=0;s<6;s++){const o=e.getNext(Y4.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==Ie.UNREACHABLE&&(r.isAbsent()&&(r=y.of(s)),t.push(s-r.get()))}return t}deconnectTile(e,t){const r=this.getCopiedBoard(),s=e.x,i=e.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=Ie.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return t&&(o[this.getCurrentPlayer().value]+=1),new Y4(r,this.turn,o,this.captures)}getLegalLandings(e){const t=[];for(const r of dr.STEPS){const s=e.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===Ie.EMPTY&&t.push(s)}return t}getPiecesByFreedom(){const e=[[0,0,0,0],[0,0,0,0]];for(let t=0;t<10;t++)for(let r=0;r<15;r++){const s=this.board[t][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new S(r,t),Ie.EMPTY).length;e[s.value][i]=e[s.value][i]+1}}return e}};var n7;ji.NEIGHBORS_TILES_DIRECTIONS=[new Bt(0,-2),new Bt(3,-1),new Bt(3,1),new Bt(0,2),new Bt(-3,1),new Bt(-3,-1)],ji.isInRange=n=>n.isInRange(15,10),ji=Y4=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],ji);let I_=n7=class extends N1{constructor(){super(ji)}static get(){return n7.singleton.isAbsent()&&(n7.singleton=y.of(new n7)),n7.singleton.get()}applyLegalMove(e,t,r){return I8.isTileExchange(e)?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}applyLegalTileExchange(e,t){const r=t.getCopiedBoard(),s=e.coord;r[s.y][s.x]=Ie.EMPTY;const i=[t.captures[0],t.captures[1]];i[t.getCurrentPlayer().value]+=1;const o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;const u=new ji(r,t.turn,o,i).removeTilesIfNeeded(s,!1);return new ji(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures)}applyLegalMovement(e,t){const i=t.applyLegalMovement(e).removeTilesIfNeeded(e.getStart(),!0).doMovementCaptures(e);return new ji(i.board,t.turn+1,i.tiles,i.captures)}isLegal(e,t){return I8.isTileExchange(e)?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}isLegalTileExchange(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return R.failure(N_.NOT_ENOUGH_TILES_TO_EXCHANGE());const r=t.getPieceAt(e.coord);return r===Ie.UNREACHABLE||r===Ie.EMPTY?R.failure(N_.CANNOT_CAPTURE_FROM_EMPTY()):r.is(t.getCurrentPlayer())?R.failure(Xe.CANNOT_SELF_CAPTURE()):R.SUCCESS}isLegalMovement(e,t){pe.assert(t.getPieceAt(e.getStart())!==Ie.UNREACHABLE,"Cannot start with a coord outside the board "+e.getStart().toString()+"."),pe.assert(t.getPieceAt(e.getEnd())!==Ie.UNREACHABLE,"Cannot end with a coord outside the board "+e.getEnd().toString()+".");const r=t.getPieceAt(e.getStart());return r===Ie.EMPTY?R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.is(t.getCurrentOpponent())?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.getEnd()).is(t.getCurrentPlayer())?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}static getGameStatus(e){const t=e.gameState;return t.captures[0]>=18?Ne.ZERO_WON:t.captures[1]>=18?Ne.ONE_WON:Ne.ONGOING}getGameStatus(e){return n7.getGameStatus(e)}};I_.singleton=y.empty(),I_=n7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],I_);class U3e extends bs{getListMoves(e){let t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}getListExchanges(e){const t=[],r=e.gameState,s=r.getCurrentPlayer().value,i=Ie.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return t;for(const o of r.getCoordsAndContents())if(o.content===i){const c=x6.of(o.coord);t.push(c)}return t}getListMovement(e){const t=[],r=e.gameState,s=r.getCurrentPlayer();for(const i of r.getCoordsAndContents()){const o=i.coord;if(i.content.is(s)){const c=r.getLegalLandings(o);for(const u of c){const h=Wi.of(o,u);t.push(h)}}}return t}getMetrics(e){const t=e.gameState,r=t.getPiecesByFreedom(),s=this.getPiecesScore(r);return[2*t.captures[0]+s[0],2*t.captures[1]+s[1]]}getPiecesScore(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}getPlayerPiecesScore(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}putCaptureFirst(e,t){return Je.sortByDescending(t,r=>this.moveCapturesList(e,r).length),t}moveCapturesList(e,t){return I8.isTileExchange(t)?[t.coord]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.getStart(),!0).getCapturedNeighbors(t.getEnd())}}let Vlt=(()=>{class n extends U3e{getMetrics(t){const r=t.gameState,s=this.getPiecesMap(r),i=this.getThreatMap(r,s),o=this.filterThreatMap(i,r),c=[0,0];for(const u of B.PLAYERS){for(const h of s.get(u).get())o.get(h).isPresent()?c[u.value]+=n.SCORE_BY_THREATENED_PIECE:c[u.value]+=n.SCORE_BY_SAFE_PIECE;c[u.value]+=r.tiles[u.value]}return c}getPiecesMap(t){const r=new Wn,s=[],i=[];for(const o of t.getCoordsAndContents()){const c=o.coord,u=t.getPieceAt(c);u===Ie.ZERO?s.push(c):u===Ie.ONE&&i.push(c)}return r.set(B.ZERO,new Or(s)),r.set(B.ONE,new Or(i)),r}getThreatMap(t,r){const s=new Wn;for(const i of B.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,t);c.isPresent()&&s.set(o,c.get())}return s}getThreat(t,r){const i=B.of(r.getPieceAt(t).value).getOpponent();let o=y.empty(),c=y.empty(),u=[];const h=Rc.getNeighbors(t).filter(g=>g.isInRange(15,10));for(const g of h){const m=r.getPieceAt(g);if(m.is(i))u.push(g),this.tileCouldBeRemovedThisTurn(g,r,i)&&(c=y.of(g));else if(m===Ie.EMPTY){if(o.isPresent())return y.empty();o=y.of(g)}}if(o.isPresent()){const g=[];for(const m of dr.STEPS){const M=o.get().getNext(m.direction,1);M.isInRange(15,10)&&r.getPieceAt(M).is(i)&&!1===u.some(b=>b.equals(M))&&g.push(M)}if(g.length>0)return y.of(new sT(new Or(u),new Or(g)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const g=new Or(u);return y.of(new sT(g,new Or([c.get()])))}return y.empty()}tileCouldBeRemovedThisTurn(t,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(t))return!1;let c=y.empty();const u=ji.getTilesUpperLeftCoord(t);for(let h=0;h<2;h++)for(let g=0;g<3;g++){const m=u.getNext(new Bt(g,h),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=y.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(t,r){const s=ji.getTilesUpperLeftCoord(t);for(const i of dr.STEPS){const o=t.getNext(i.direction,1),c=ji.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&ji.isInRange(o)&&r.getPieceAt(o)===Ie.EMPTY)return!0}return!1}filterThreatMap(t,r){const s=new Wn,i=t.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new Or(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const h=t.get(u).get();let g=y.empty();for(const m of h.directThreats)if(!1===c.contains(m)){const M=[];for(const b of h.mover)!1===c.contains(b)&&M.push(b);M.length>0&&(g=y.of(new sT(h.directThreats,new Or(M))))}g.isPresent()&&s.set(u,g.get())}for(const u of c){const h=t.get(u).get();s.set(u,h)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const de=Ie.EMPTY,$=Ie.UNREACHABLE,$1=Ie.ZERO,e1=Ie.ONE;class q3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,ji.getInitialState()),ee.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,ji.getInitialState(),Wi.of(new S(3,5),new S(5,5)),$localize`Congratulations! Let's see captures now.`),ee.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new ji([[$,$,$,$,$,$,$1,de,$1,$,$,$,$,$,$],[$,$,$,$1,de,de,de,de,de,$1,de,de,$,$,$],[de,e1,de,e1,$1,e1,de,de,$1,de,de,e1,de,e1,de],[e1,de,de,de,de,de,de,de,de,de,e1,de,de,de,e1],[de,e1,de,e1,de,de,de,de,de,de,de,e1,de,e1,de],[de,$1,de,$1,de,de,de,de,de,de,de,$1,de,$1,de],[$1,de,de,de,$1,de,de,de,de,de,$1,de,de,de,$1],[de,$1,de,$1,de,de,e1,de,e1,de,de,$1,de,$1,de],[$,$,$,de,de,e1,de,de,de,e1,de,de,$,$,$],[$,$,$,$,$,$,e1,de,e1,$,$,$,$,$,$]],3,[0,0],[0,0]),[Wi.of(new S(5,2),new S(4,1)),Wi.of(new S(3,4),new S(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),ee.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new ji([[$,$,$,$,$,$,de,de,de,$,$,$,$,$,$],[$,$,$,$,$,$,e1,de,de,$,$,$,$,$,$],[de,de,de,$,$,$,de,de,de,$,$,$,$,$,$],[de,de,e1,de,de,de,de,$1,de,$,$,$,$,$,$],[de,de,de,e1,de,de,de,de,de,$,$,$,$,$,$],[de,de,de,de,de,de,de,de,de,de,de,$1,$,$,$],[de,de,$1,de,de,e1,de,de,de,de,$1,de,de,de,$1],[de,de,de,de,de,de,e1,de,e1,de,de,$1,de,$1,de],[$,$,$,de,de,e1,de,de,de,e1,de,de,$,$,$],[$,$,$,$,$,$,e1,de,e1,$,$,$,$,$,$]],2,[0,0],[0,0]),[Wi.of(new S(2,6),new S(4,6)),Wi.of(new S(2,6),new S(3,5)),Wi.of(new S(2,6),new S(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),ee.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new ji([[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,de,de,$1,$,$,$,$,$,$,$,$,$],[$,$,$,de,de,de,de,de,de,$,$,$,$,$,$],[$,$,$,de,de,de,e1,de,e1,$,$,$,$,$,$],[$,$,$,de,de,e1,de,de,de,$,$,$,$,$,$],[$,$,$,$,$,$,e1,de,e1,$,$,$,$,$,$]],1,[0,2],[0,0]),[x6.of(new S(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),ee.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new ji([[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,de,de,$1,$,$,$,$,$,$],[$,$,$,de,de,$1,de,de,de,$,$,$,$,$,$],[$,$,$,de,$1,e1,de,e1,de,$,$,$,$,$,$],[$,$,$,de,e1,$1,de,de,de,$,$,$,$,$,$],[$,$,$,de,de,e1,$,$,$,$,$,$,$,$,$],[$,$,$,$,$,$,$,$,$,$,$,$,$,$,$]],1,[0,0],[0,0]),[Wi.of(new S(7,6),new S(6,5)),Wi.of(new S(7,6),new S(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)]}}function Flt(n,e){if(1&n&&(V(),X(0,"polygon",9)),2&n){const t=C().index,r=C().index,s=C();ke("id","pyramid_",t,"_",r,""),w("ngClass",s.getPyramidClass(t,r)),z("points",s.getPyramidCoordinate(t,r))}}function Blt(n,e){if(1&n&&(V(),X(0,"polygon",11)),2&n){const t=C(2).index,r=C().index,s=C();ke("id","empty_",t,"_",r,""),w("ngClass",s.getEmptyClass(t,r)),z("points",s.getTriangleCoordinate(t,r))}}function $lt(n,e){if(1&n&&(V(),x(0,Blt,1,4,"polygon",10)),2&n){const t=C().index,r=C().index;w("ngIf",C().isEmptySpace(t,r))}}function Glt(n,e){if(1&n&&(V(),O(0,"g"),X(1,"polygon",12)(2,"polygon",13),A()),2&n){const t=C().index,r=C().index,s=C();T(1),ke("id","base_line_",t,"_",r,""),z("points",s.getLineCoordinate(t,r)),T(1),ke("id","white_stroke_line_",t,"_",r,""),z("points",s.getLineCoordinate(t,r))}}function Ult(n,e){if(1&n){const t=Oe();V(),O(0,"g",5),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),x(1,Flt,1,4,"polygon",6),x(2,$lt,1,1,"ng-template",null,7,Un),x(4,Glt,3,6,"g",8),A()}if(2&n){const t=e.$implicit,r=e.index,s=Hn(3),i=C().index,o=C();ke("id","click_",r,"_",i,""),T(1),w("ngIf",o.isPyramid(r,i))("ngIfElse",s),T(3),w("ngIf",t!==o.NONE)}}function qlt(n,e){if(1&n&&(V(),O(0,"g"),x(1,Ult,5,5,"g",4),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Wlt(n,e){if(1&n&&(V(),X(0,"polygon",16)),2&n){const t=e.$implicit;z("points",C(2).getTriangleCoordinate(t.x,t.y))}}function jlt(n,e){if(1&n&&(V(),O(0,"g"),X(1,"polygon",14),x(2,Wlt,1,1,"polygon",15),A()),2&n){const t=C();T(1),ke("id","selected_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),z("points",t.getTriangleCoordinate(t.chosenCoord.get().x,t.chosenCoord.get().y)),T(1),w("ngForOf",t.possibleLandings)}}function Zlt(n,e){if(1&n&&(V(),X(0,"polygon",18)),2&n){const t=C(2);ke("id","last_start_",t.lastStart.get().x,"_",t.lastStart.get().y,""),z("points",t.getTriangleCoordinate(t.lastStart.get().x,t.lastStart.get().y))}}function Ylt(n,e){if(1&n&&(V(),X(0,"polygon",18)),2&n){const t=C(2);ke("id","last_end_",t.lastEnd.get().x,"_",t.lastEnd.get().y,""),z("points",t.getTriangleCoordinate(t.lastEnd.get().x,t.lastEnd.get().y))}}function Klt(n,e){if(1&n&&(V(),x(0,Zlt,1,3,"polygon",17),x(1,Ylt,1,3,"polygon",17)),2&n){const t=C();w("ngIf",t.lastStart.isPresent()),T(1),w("ngIf",t.lastEnd.isPresent())}}const Xlt=function(n){return["base",n]};function Qlt(n,e){if(1&n&&(V(),O(0,"g",20),X(1,"polygon",21),O(2,"text",22),wt(3),A()()),2&n){const t=C().$implicit,r=C();w("id","tilesCount"+t),T(1),w("ngClass",b3(8,Xlt,"player"+t+"-fill")),z("points",r.getTilesCountCoordinate(0===t?0:4.5,0===t?0:6))("stroke",r.lastTurnWasTilesExchange(t)?"yellow":"black"),T(1),z("x",r.SPACE_SIZE/2+r.SPACE_SIZE*(0===t?0:6.4))("y",16+r.SPACE_SIZE/2+r.SPACE_SIZE*(0===t?0:8.5))("font-size",r.SPACE_SIZE/2),T(1),c1(r.tiles[t])}}function Jlt(n,e){if(1&n&&(V(),O(0,"g"),x(1,Qlt,4,10,"g",19),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngIf",r.mustShowTilesOf(t))}}const e6t=function(){return[0,1]};let t6t=(()=>{class n extends G3e{constructor(t){super(t),this.tiles=[0,0],this.NONE=Ie.UNREACHABLE,this.chosenCoord=y.empty(),this.lastStart=y.empty(),this.lastEnd=y.empty(),this.possibleLandings=[],this.scores=y.of([0,0]),this.rules=I_.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new U3e(this.rules,"Normal"),new Vlt(this.rules,"Piece > Threat > Tiles")],this.encoder=I8.encoder,this.tutorial=(new q3e).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=y.empty(),this.state=this.getState(),this.scores=y.of(this.state.captures),this.tiles=this.state.tiles,this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=y.empty(),this.possibleLandings=[]}showLastMove(t){t instanceof Wi?(this.lastStart=y.of(t.getStart()),this.lastEnd=y.of(t.getEnd())):(this.lastStart=y.empty(),this.lastEnd=y.empty())}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),R.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(t){var r=this;return I(function*(){const s=r.state.getPieceAt(t);if(s.is(r.state.getCurrentOpponent())){const i=x6.of(t);return r.chooseMove(i)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=y.of(t),r.showHighlight(),R.SUCCESS):r.cancelMove(N_.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(t){var r=this;return I(function*(){if(r.possibleLandings.some(s=>s.equals(t))){const s=Wi.of(r.chosenCoord.get(),t);return r.chooseMove(s)}return r.cancelMove(N_.INVALID_DISTANCE())})()}isPyramid(t,r){return this.board[r][t].isPlayer()||this.wasOpponent(t,r)}wasOpponent(t,r){const s=this.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(t,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(t,r){const s=this.board[r][t];return s===Ie.ZERO?this.getPlayerClass(B.ZERO):s===Ie.ONE?this.getPlayerClass(B.ONE):"captured-fill"}isEmptySpace(t,r){return this.board[r][t]===Ie.EMPTY||this.wasRemoved(t,r)}wasRemoved(t,r){const i=this.node.mother;if(this.board[r][t]===Ie.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(t,r);return o===Ie.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(t,r){return this.board[r][t]===Ie.EMPTY?(t+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(t,r){const s=100*t,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(t,r){const s=this.getTriangleCornerCoords(t,r);return t%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:t%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(t){return this.tiles[t]>0||this.lastTurnWasTilesExchange(t)}lastTurnWasTilesExchange(t){return!this.node.mother.isAbsent()&&this.getPreviousState().tiles[t]>this.tiles[t]}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-coerceo"]],features:[l],decls:6,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],[4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"id","ngClass"],["class","base small-stroke","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"id","ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selected-stroke",3,"id"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],[1,"base","no-fill","selectable-stroke"],["class","base no-fill last-move-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","last-move-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount",1,"text-giant"]],template:function(t,r){if(1&t&&(V(),O(0,"svg",0),x(1,qlt,2,1,"g",1),x(2,jlt,3,4,"g",2),x(3,Klt,2,2,"ng-template",null,3,Un),x(5,Jlt,2,1,"g",1),A()),2&t){const s=Hn(4);z("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s),T(3),w("ngForOf",K1(5,e6t))}},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class n6t extends bs{getListMoves(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}sortByNumberOfJump(e){return e.sort((t,r)=>{const s=gi.isDrop(t)?1:gi.isSimple(t)?2:t.coords.length;return(gi.isDrop(r)?1:gi.isSimple(r)?2:r.coords.length)-s})}getListMovesDrop(e){const t=[],r=Wt.CENTRAL_ZONE_TOP_LEFT,s=Wt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)e.getPieceAtXY(o,i)===le.NONE&&t.push(A6.of(new S(o,i)));return t}getListMovesAfterDrop(e){let t=[];const r=e.getCurrentPlayer();for(let s=0;s<Wt.HEIGHT;s++)for(let i=0;i<Wt.WIDTH;i++){const o=new S(i,s);e.getPieceAt(o)===r&&(t=t.concat(this.getListSimpleMoves(e,o)),t=t.concat(this.getListJumps(e,o)))}return t}getListSimpleMoves(e,t){const r=[],s=[new S(t.x+1,t.y),new S(t.x-1,t.y),new S(t.x,t.y+1),new S(t.x,t.y-1),new S(t.x+1,t.y+1),new S(t.x+1,t.y-1),new S(t.x-1,t.y+1),new S(t.x-1,t.y-1)];for(const i of s){const o=N6.from(t,i);o.isSuccess()&&ec.get().simpleMoveLegality(o.get(),e).isSuccess()&&r.push(o.get())}return r}getListJumps(e,t){const r=new Ot;for(const s of ec.get().jumpTargetsFrom(t)){const i=Lc.from([t,s]).get();ec.get().jumpLegality(i,e).isSuccess()&&(r.add(i),r.addAll(this.getListJumpStartingFrom(e,i)))}return r.toList()}getListJumpStartingFrom(e,t){const r=ec.get().nextJumps(t,e),s=new Ot(r);for(const i of r)s.addAll(this.getListJumpStartingFrom(e,i));return s}getMetrics(e){const t=e.gameState,r=[0,0];for(let s=0;s<Wt.HEIGHT;s++)for(let i=0;i<Wt.WIDTH;i++){const o=new S(i,s),c=t.getPieceAt(o);if(c.isPlayer())if(t.isShelter(o))r[c.value]+=20;else{let u=100;for(const h of Wt.ALL_SHELTERS)if(t.getPieceAt(h)===le.NONE){const g=o.getOrthogonalDistance(h);u=Math.min(u,g)}r[c.value]-=u}}return r}}function r6t(n,e){if(1&n){const t=Oe();V(),O(0,"rect",9),J("click",function(){he(t);const s=C().$implicit;return ce(C(2).onClick(s.coord))}),A()}if(2&n){const t=C().$implicit,r=C(2);z("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*t.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*t.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function s6t(n,e){if(1&n){const t=Oe();V(),O(0,"circle",6),J("click",function(){he(t);const s=C().$implicit;return ce(C(2).onClick(s.coord))}),A()}if(2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C();ke("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function i6t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",6),J("click",function(){const i=he(t).$implicit;return ce(C(2).onClick(i.coord))}),A(),x(2,r6t,1,4,"rect",7),x(3,s6t,1,6,"circle",8),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","click_",r,"_",s,""),w("ngClass",t.squareClasses),z("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t.isShelter),T(1),w("ngIf",t.hasPiece)}}function o6t(n,e){if(1&n&&(V(),O(0,"g"),x(1,i6t,4,9,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function a6t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",10),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i))}),A()()}if(2&n){const t=e.$implicit,r=C();T(1),w("ngClass",r.viewInfo.boardInfo[t.y][t.x].shelterClasses),z("x",r.SPACE_SIZE*t.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*t.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function c6t(n,e){if(1&n&&(V(),X(0,"circle",11)),2&n){const t=e.$implicit,r=C();h1("id","sidePiece_0_",t,""),z("cx",-r.PIECE_RADIUS)("cy",1670-t*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function l6t(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=e.$implicit,r=C();h1("id","sidePiece_1_",t,""),z("cx",1715+r.PIECE_RADIUS)("cy",1670-t*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function u6t(n,e){if(1&n&&(V(),X(0,"rect",13)),2&n){const t=C();z("x",t.SPACE_SIZE*t.CENTRAL_ZONE_START.x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.CENTRAL_ZONE_START.y+t.STROKE_WIDTH)("width",t.CENTRAL_ZONE_SIZE.x*t.SPACE_SIZE)("height",t.CENTRAL_ZONE_SIZE.y*t.SPACE_SIZE)}}let f6t=(()=>{class n extends b8{constructor(t){super(t),this.ALL_SHELTERS=Wt.ALL_SHELTERS,this.CENTRAL_ZONE_START=Wt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new Bt(Wt.CENTRAL_ZONE_BOTTOM_RIGHT.x-Wt.CENTRAL_ZONE_TOP_LEFT.x+1,Wt.CENTRAL_ZONE_BOTTOM_RIGHT.y-Wt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=y.empty(),this.jumpInConstruction=y.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=ec.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new n6t(this.rules,"ConspirateursMinimax")],this.encoder=gi.encoder,this.tutorial=(new V3e).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo()}updateViewInfo(){const t=this.getState();this.viewInfo.dropPhase=t.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<Wt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<Wt.WIDTH;s++){const i=new S(s,r),o=t.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=t.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const t of Wt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[t.y][t.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const t=this.jumpInConstruction.get(),r=t.getStartingCoord(),s=t.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of t.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const t=this.selected.get();this.viewInfo.boardInfo[t.y][t.x].pieceClasses.push("selected-stroke")}}updateVictory(){const t=this.getState(),r=ec.get().getGameStatus(this.node);if(!0===r.isEndGame)for(const s of Wt.ALL_SHELTERS)t.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(t){if(gi.isDrop(t))this.viewInfo.boardInfo[t.coord.y][t.coord.x].squareClasses.push("moved-fill");else if(gi.isSimple(t))this.viewInfo.boardInfo[t.getStart().y][t.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[t.getEnd().y][t.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of t.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=y.empty(),this.selected=y.empty(),this.updateBoard()}onClick(t){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+t.x+"_"+t.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(t)===r.getCurrentPlayer())return r.selected.equalsValue(t)?r.cancelMoveAttempt():(r.selected=y.of(t),r.jumpInConstruction=y.empty()),r.updateViewInfo(),R.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(t);if(r.selected.isPresent())return r.selectNextCoord(t);if(i.isDropPhase()){const o=A6.of(t);return r.chooseMove(o)}return r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(t){var r=this;return I(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(t.equals(s.getEndingCoord()))return r.chooseMove(s);{const o=s.addJump(t);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(t){var r=this;return I(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(t,s)?(r.jumpInConstruction=y.of(t),r.updateViewInfo(),R.SUCCESS):r.chooseMove(t)})()}selectNextCoord(t){var r=this;return I(function*(){const s=r.selected.get(),i=N6.from(s,t);if(i.isSuccess())return r.chooseMove(i.get());{const o=Lc.from([s,t]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,o6t,2,1,"g",1),x(2,a6t,2,5,"g",1),x(3,c6t,1,4,"circle",2),x(4,l6t,1,4,"circle",3),x(5,u6t,1,4,"rect",4),X(6,"polyline",5),A()),2&t&&(T(1),w("ngForOf",r.viewInfo.boardInfo),T(1),w("ngForOf",r.ALL_SHELTERS),T(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[0])),T(1),w("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[1])),T(1),w("ngIf",r.viewInfo.dropPhase),T(1),z("points",r.viewInfo.lastMoveArrow))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class h6t extends bs{getListMoves(e){const t=e.gameState,r=this.getListDrops(t),s=this.getListShifts(t);return r.concat(s)}getListShifts(e){const t=[],r=this.getShiftSources(e);for(const s of r)for(const i of[new qi(s,"clockwise"),new qi(s,"counterclockwise")])Z4.get().shiftHeightValidity(i,e).isSuccess()&&t.push(i);return t}getListDrops(e){const t=this.getRemainingPiecesForCurrentPlayer(e),r=[];for(let s=0;s<zr.WIDTH;s++)for(const i of t){const o=new I6(s,i);Z4.get().dropHeightValidity(o,e).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(e){const t=[];for(const r of wn.PLAYER_PIECES)this.currentPlayerCanDropPiece(e,r)&&t.push(r);return t}currentPlayerCanDropPiece(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}getShiftSources(e){const t=[],r=e.getCurrentPlayer();for(let s=0;s<zr.HEIGHT;s++)for(let i=0;i<zr.WIDTH;i++)e.getPieceAtXY(i,s).owner===r&&t.push(new S(i,s));return t}getMetrics(e){return[0,0]}}function d6t(n,e){if(1&n){const t=Oe();V(),O(0,"g",6)(1,"path",7),J("click",function(){const i=he(t).$implicit;return ce(C().onSpaceClick(i))}),A(),O(2,"path",8),J("click",function(){const i=he(t).$implicit;return ce(C().onSpaceClick(i))}),A()()}if(2&n){const t=e.$implicit,r=C();h1("id","board_space_",t,""),T(1),h1("id","click_",t,""),w("ngClass",r.viewInfo.boardInfo[t].spaceClasses),z("d",r.BOARD_PATHS[t]),T(1),w("ngClass",r.viewInfo.boardInfo[t].spaceClasses),z("d",r.DECORATION_PATHS[t])}}function p6t(n,e){if(1&n){const t=Oe();V(),O(0,"g",10),J("click",function(){const i=he(t).$implicit,o=C().$implicit;return ce(C().onPieceInGameClick(o,i.y))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const t=e.$implicit;ke("id","click_",C().$implicit,"_",t.y,""),w("ngClass",t.foregroundClasses),T(1),w("ngClass",t.backgroundClasses),z("x",t.drawPosition.x)("y",t.drawPosition.y),T(1),z("x",t.drawPosition.x)("y",t.drawPosition.y)}}function g6t(n,e){if(1&n&&(V(),O(0,"g"),x(1,p6t,3,8,"g",9),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngForOf",r.viewInfo.boardInfo[t].pieces)}}function m6t(n,e){if(1&n){const t=Oe();V(),O(0,"g",14),J("click",function(){const s=he(t),i=s.$implicit,o=s.index;return ce(C(2).onRemainingPieceClick(i.actualPiece,o))}),X(1,"use",11)(2,"use",12),A()}if(2&n){const t=e.$implicit,r=e.index;j2("id","piece_",t.actualPiece.owner.toString(),"_",t.actualPiece.otherPieceType?1:0,"_",r,""),w("ngClass",t.foregroundClasses),T(1),w("ngClass",t.backgroundClasses),z("x",t.drawPosition.x)("y",t.drawPosition.y),T(1),z("x",t.drawPosition.x)("y",t.drawPosition.y)}}function _6t(n,e){if(1&n&&(V(),O(0,"g"),x(1,m6t,3,9,"g",13),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngForOf",r.viewInfo.remainingPieces.get(t).get())}}const v6t=function(){return[0,1,2,3,4,5,6,7]},C6t=function(){return[2,1,3,0,4,7,5,6]};class B3 extends b8{constructor(e){super(e),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=y.empty(),this.viewInfo={boardInfo:[],remainingPieces:new Wn([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}])},this.rules=Z4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new h6t(this.rules,"DiamDummyMinimax")],this.encoder=Dlt,this.tutorial=(new $3e).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(e){var t=this;return I(function*(){const r=t.canUserPlay("#click_"+e);return r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e)})()}onSpaceClickAfterCheck(e){var t=this;return I(function*(){if(t.selected.isPresent()){const r=t.selected.get();let s;if("pieceFromReserve"===r.type)s=new I6(e,r.piece);else if((r.position.x+1)%zr.WIDTH===e)s=new qi(r.position,"clockwise");else{if((r.position.x+(zr.WIDTH-1))%zr.WIDTH!==e)return t.cancelMove(A_.MUST_SHIFT_TO_NEIGHBOR());s=new qi(r.position,"counterclockwise")}return t.chooseMove(s)}return t.cancelMove(A_.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(e,t){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e+"_"+t);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(e,t);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=y.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),R.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(e):r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(e,t){var r=this;return I(function*(){const s=r.canUserPlay(r.getPieceId(e,t));return s.isFailure()?r.cancelMove(s.getReason()):e.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(e)?y.empty():y.of({type:"pieceFromReserve",piece:e}),r.updateViewInfo(),R.SUCCESS):r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}isSelected(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}updateBoard(){this.updateViewInfo()}getLastMovedFromDrop(e,t){const r=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),s=e.getTarget(),i=t.getStackHeight(e.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new S(s,i);return[{start:y.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(e,t){const r=e.start.x,s=e.getTarget();let i=t.getStackHeight(s);const o=[];for(let c=e.start.y;c<zr.HEIGHT&&t.getPieceAtXY(r,c)!==wn.EMPTY;c++,i++)o.push({start:y.of(new S(r,c)),end:new S(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let e=0;e<zr.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}showLastMove(e){this.showLastMoveOnSpaces(e),this.showLastMoveOnPieces(e)}showLastMoveOnSpaces(e){for(let t=0;t<zr.WIDTH;t++){const r=[];if(e.isDrop())e.getTarget()===t&&r.push("moved-fill");else{const s=e;(s.getTarget()===t||s.start.x===t)&&r.push("moved-fill")}this.viewInfo.boardInfo[t].spaceClasses=r}}showLastMoveOnPieces(e){const t=this.getPreviousState();let r=[];r=e.isDrop()?this.getLastMovedFromDrop(e,t):this.getLastMovedFromShift(e,t);for(const s of r)this.viewInfo.boardInfo[s.end.x].pieces[s.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Wn([{key:B.ZERO,value:[]},{key:B.ONE,value:[]}]);const t=this.isPlayerTurn();for(const r of wn.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),t&&i===s-1&&r.owner===e&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(e,t,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&e===t-1}return!1}getDrawPositionRemainingPiece(e,t){let r,s;return r=e.owner===B.ZERO?-100:600,s=e.otherPieceType?100:450,new S(r,s).getNext(new Bt(0,-t*B3.PIECE_HEIGHT))}getPieces(e){const t=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<zr.HEIGHT;i++){const o=this.getState().getPieceAtXY(e,i),c=new S(e,i);if(o!==wn.EMPTY){const u=[];this.pieceFromBoardIsSelected(e,i)&&u.push("selected-stroke"),this.isVictory(e,i,t)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(e,t){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===e&&r.position.y===t}return!1}isVictory(e,t,r){if(r.isPresent()){const s=r.get();return s.x%4==e%4&&s.y===t}return!1}getDrawPositionOnBoard(e,t){return B3.CENTER[e].getNext(new Bt(0,-t*B3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=y.empty(),this.updateBoard()}}B3.CENTER=[new S(40,160),new S(100,50),new S(255,2),new S(400,50),new S(460,160),new S(400,270),new S(255,320),new S(100,270)],B3.PIECE_HEIGHT=36,B3.\u0275fac=function(e){return new(e||B3)(Q(_n))},B3.\u0275cmp=ct({type:B3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(V(),O(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,d6t,3,6,"g",4),x(6,g6t,2,1,"g",5),x(7,_6t,2,1,"g",5),A()),2&e&&(T(5),w("ngForOf",K1(3,v6t)),T(1),w("ngForOf",K1(4,C6t)),T(1),w("ngForOf",t.Player.PLAYERS))},dependencies:[hn,En],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class tc{constructor(e,t){this.offset=e,this.constant=t}static fromTwoCoords(e,t){const r=e.x,s=t.x,i=e.y,o=t.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?y.of(tc.constantQ(r)):r!==s&&i===o&&c!==u?y.of(tc.constantR(i)):r!==s&&i!==o&&c===u?y.of(tc.constantS(c)):y.empty()}static constantQ(e){return new tc(e,"q")}static constantR(e){return new tc(e,"r")}static constantS(e){return new tc(e,"s")}static areOnSameLine(e){if(e.length<2)return!0;const t=tc.fromTwoCoords(e[0],e[1]);if(t.isAbsent())return!1;const r=t.get();for(const s of e.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}contains(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}getDirection(){switch(this.constant){case"q":return Re.DOWN;case"r":return Re.RIGHT;case"s":return Re.DOWN_LEFT}}}class yF extends br{constructor(e,t,r,s,i,o){super(t,e),this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,qe(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}equalsT(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedSpaces.length!==e.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==e.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===t(this.getPieceAt(r),e.getPieceAt(r)))return!1;return!0}allCoords(){const e=[];return this.forEachCoord(t=>{e.push(t)}),e}allLines(){const e=[];for(let t=0;t<this.width;t++)e.push(tc.constantQ(t));for(let t=0;t<this.height;t++)e.push(tc.constantR(t));for(let t=this.excludedSpaces.length;t<this.height+this.excludedSpaces.length;t++)e.push(tc.constantS(t));return e}getEntranceOnLine(e){let t,r;switch(e.constant){case"q":return r=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new S(e.offset,r));case"r":return t=null!=this.excludedSpaces[e.offset]?this.excludedSpaces[e.offset]:0,this.findEntranceFrom(e,new S(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new S(e.offset,0):new S(this.width-1,e.offset-this.width+1))}}findEntranceFrom(e,t){const r=e.getDirection();let s=t;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=Ts.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(i.getReason())}}class mi{static getNeighbors(e,t=1){const r=[];for(const s of Re.factory.all)r.push(e.getNext(s,t));return r}static areNeighbors(e,t){for(const r of Re.factory.all)if(e.getNext(r).equals(t))return!0;return!1}}class _1{constructor(e,t,r){this.owner=e,this.size=t,this.source=r}static append(e,t){return new _1(e.owner,e.size+t.size,e.source||t.source)}getOwner(){return this.owner}belongsTo(e){return this.owner===e}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}equals(e){return this.owner===e.owner&&this.size===e.size&&this.source===e.source}}_1.encoder=Ye.tuple([Ye.identity(),B.encoder,Ye.identity()],n=>[n.source,n.owner,n.size],n=>new _1(n[1],n[2],n[0])),_1.MAX_SIZE=49,_1.EMPTY=new _1(le.NONE,0,!1),_1.UNREACHABLE=new _1(le.NONE,-1,!1),_1.PLAYER_ZERO=new _1(B.ZERO,1,!1),_1.PLAYER_ONE=new _1(B.ONE,1,!1),_1.SOURCE=new _1(le.NONE,1,!0);let Dc=(()=>{class n extends yF{constructor(t,r,s){super(r,t,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,_1.EMPTY),this.alreadyPassed=s}static balancedBoard(){const t=_1.UNREACHABLE,r=_1.PLAYER_ZERO,s=_1.PLAYER_ONE,i=_1.SOURCE;return[[t,t,r,s,s,s,r,r,s,i,s],[t,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,t],[r,i,r,s,s,r,r,r,s,t,t]]}static isOnBoard(t){return!t.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[t.y][t.x]!==_1.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const t=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new S(s,r);this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()&&t.push(i)}return t}numberOfNeighbors(t){return mi.getNeighbors(t,1).filter(i=>this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()).length}setAtUnsafe(t,r){const s=Je.copyBiArray(this.board);return s[t.y][t.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==_1.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})(),r7=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n.MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`A stack must move in a straight line.`,n})();class Hr extends kc{constructor(e,t){super(e,t)}static from(e,t){return-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y?_e.success(Hr.PASS):Dc.isOnBoard(e)?Dc.isOnBoard(t)?e.y===t.y||e.x===t.x||e.x+e.y===t.x+t.y?_e.success(new Hr(e,t)):_e.failure(r7.MUST_MOVE_IN_STRAIGHT_LINE()):_e.failure("End coord of DvonnMove must be on the board, not at "+e.toString()):_e.failure("Starting coord of DvonnMove must be on the board, not at "+e.toString())}toString(){return this===Hr.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}}Hr.PASS=new Hr(new S(-1,-1),new S(-2,-2)),Hr.encoder=_a.getFallibleEncoder(Hr.from);const me=_1.EMPTY,Vr=_1.UNREACHABLE,x8=_1.SOURCE,C9=_1.PLAYER_ZERO,y9=_1.PLAYER_ONE,y6t=new _1(B.ZERO,2,!1),EF=new _1(B.ONE,2,!1),W3e=new _1(B.ZERO,4,!1),E6t=new _1(B.ONE,4,!1);class j3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,Dc.getInitialState(),Hr.from(new S(2,0),new S(3,0)).get(),$localize`Congratulations!`),ee.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new Dc([[Vr,Vr,y9,x8,me,me,me,me,me,me,me],[Vr,me,C9,me,me,me,me,me,me,me,me],[me,me,E6t,me,me,me,me,y9,x8,me,me],[me,me,me,me,me,me,me,me,me,me,Vr],[me,me,me,me,me,me,me,me,me,Vr,Vr]],0,!1),Hr.from(new S(2,1),new S(2,0)).get(),(e,t,r)=>e.getEnd().equals(new S(3,0))?R.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(qe(e.getEnd().equals(new S(2,0)),"player made an impossible move"),R.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),ee.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new Dc([[Vr,Vr,x8,y9,me,me,me,me,me,me,me],[Vr,C9,C9,me,me,me,me,me,me,me,me],[me,y9,C9,y9,me,me,C9,EF,x8,me,me],[me,me,y9,me,me,me,me,me,me,me,Vr],[me,me,me,me,me,me,me,me,me,Vr,Vr]],0,!1),Hr.from(new S(2,1),new S(2,0)).get(),(e,t,r)=>e.getEnd().equals(new S(2,0))?R.SUCCESS:R.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),ee.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new Dc([[Vr,Vr,x8,me,me,me,me,me,me,me,me],[Vr,me,y6t,me,me,me,me,me,me,me,me],[me,me,EF,me,me,me,me,EF,x8,W3e,me],[me,me,me,me,me,me,me,me,me,me,Vr],[me,me,me,me,me,me,me,me,me,Vr,Vr]],0,!1)),ee.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new Dc([[Vr,Vr,x8,me,me,me,me,me,me,me,me],[Vr,me,C9,me,me,me,me,me,me,me,me],[me,me,me,me,me,me,me,me,x8,W3e,me],[me,me,me,me,me,me,me,me,me,me,Vr],[me,me,me,me,me,me,me,me,me,Vr,Vr]],0,!1),[Hr.from(new S(2,1),new S(2,0)).get()],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}class fs extends N1{constructor(){super(Dc)}static get(){return fs.singleton.isAbsent()&&(fs.singleton=y.of(new fs)),fs.singleton.get()}static getGameStatus(e){const t=e.gameState,r=fs.getScores(t);return 0===fs.getMovablePieces(t).length?r[0]>r[1]?Ne.ZERO_WON:r[0]<r[1]?Ne.ONE_WON:Ne.DRAW:Ne.ONGOING}static getMovablePieces(e){return fs.getFreePieces(e).filter(t=>fs.pieceHasTarget(e,t))}static getFreePieces(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6)}static pieceHasTarget(e,t){const r=e.getPieceAt(t).getSize();return void 0!==mi.getNeighbors(t,r).find(i=>e.isOnBoard(i)&&!e.getPieceAt(i).isEmpty())}static pieceTargets(e,t){const r=e.getPieceAt(t).getSize();return mi.getNeighbors(t,r).filter(i=>e.isOnBoard(i)&&e.getPieceAt(i).hasPieces())}static getScores(e){let t=0,r=0;return e.getAllPieces().map(s=>{const i=e.getPieceAt(s);i.belongsTo(B.ZERO)?t+=i.getSize():i.belongsTo(B.ONE)&&(r+=i.getSize())}),[t,r]}isMovablePiece(e,t){qe(e.isOnBoard(t),"piece is not on the board");const r=e.getPieceAt(t);return r.getSize()<1?R.failure(r7.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?R.failure(r7.TOO_MANY_NEIGHBORS()):fs.pieceHasTarget(e,t)?R.SUCCESS:R.failure(r7.CANT_REACH_TARGET()):R.failure(r7.NOT_PLAYER_PIECE())}canOnlyPass(e){return 0===fs.getMovablePieces(e).length}sourceCoords(e){return e.getAllPieces().filter(t=>e.getPieceAt(t).containsSource())}markPiecesConnectedTo(e,t,r){mi.getNeighbors(t,1).forEach(s=>{e.isOnBoard(s)&&!r[s.y][s.x]&&!e.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(e,s,r))})}removeDisconnectedPieces(e){const t=Je.createTable(Dc.WIDTH,Dc.HEIGHT,!1);this.sourceCoords(e).forEach(s=>{t[s.y][s.x]=!0,this.markPiecesConnectedTo(e,s,t)});let r=e;return r.getAllPieces().forEach(s=>{t[s.y][s.x]||(r=r.setAt(s,_1.EMPTY))}),r}applyLegalMove(e,t,r){if(e===Hr.PASS)return new Dc(t.board,t.turn+1,!0);{const s=t.getPieceAt(e.getStart()),i=t.getPieceAt(e.getEnd()),o=t.setAt(e.getStart(),_1.EMPTY).setAt(e.getEnd(),_1.append(s,i));return this.removeDisconnectedPieces(new Dc(o.board,t.turn+1,!1))}}isLegal(e,t){if(0===fs.getMovablePieces(t).length)return e!==Hr.PASS||t.alreadyPassed?R.failure(Xe.MUST_PASS()):R.SUCCESS;if(e===Hr.PASS)return R.failure(Xe.CANNOT_PASS());const r=this.isMovablePiece(t,e.getStart());if(r.isFailure())return r;const s=t.getPieceAt(e.getStart());return e.length()!==s.getSize()?_e.failure(r7.INVALID_MOVE_LENGTH()):t.getPieceAt(e.getEnd()).isEmpty()?_e.failure(r7.EMPTY_TARGET_STACK()):_e.success(void 0)}getGameStatus(e){return fs.getGameStatus(e)}}fs.singleton=y.empty();class Z3e extends bs{getListMoves(e){const t=e.move,r=e.gameState,s=[];return fs.getMovablePieces(r).forEach(i=>fs.pieceTargets(r,i).forEach(o=>{const c=Hr.from(i,o).get();s.push(c)})),0===s.length&&!1===t.equalsValue(Hr.PASS)&&s.push(Hr.PASS),s}getMetrics(e){return fs.getScores(e.gameState)}}class M6t extends Z3e{getListMoves(e){const t=e.gameState,r=super.getListMoves(e),s=t.getCurrentPlayer().getOpponent();return Je.sortByDescending(r,i=>{qe(i!==Hr.PASS,"Cannot sort with DvonnMove.PASS");const o=t.getPieceAt(i.getEnd());return o.belongsTo(s)?o.getSize():0}),r}getMetrics(e){const t=e.gameState,r=fs.getScores(t),s=t.getAllPieces(),i=s.length;for(const o of B.PLAYERS){const c=s.filter(u=>t.getPieceAt(u).belongsTo(o)).length;r[o.value]=r[o.value]*c/i}return r}}function S6t(n,e){if(1&n&&(V(),X(0,"circle",11)),2&n){const t=C().$implicit,r=C().$implicit,s=C();ke("id","piece_",r.x,"_",r.y,""),w("ngClass",s.getPieceClasses(t)),z("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function P6t(n,e){if(1&n&&(V(),X(0,"polygon",12)),2&n){const t=C().$implicit,r=C().$implicit,s=C();z("transform",1===t.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function T6t(n,e){if(1&n){const t=Oe();V(),O(0,"text",13),J("click",function(){he(t);const s=C(2).$implicit;return ce(C().onClick(s.x,s.y))}),wt(1),A()}if(2&n){const t=C().$implicit,r=C().$implicit,s=C();z("x",t.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),T(1),c1(t.getSize())}}function w6t(n,e){if(1&n){const t=Oe();V(),O(0,"g",6),J("click",function(){he(t);const s=C().$implicit;return ce(C().onClick(s.x,s.y))}),X(1,"polygon",7),x(2,S6t,1,6,"circle",8),x(3,P6t,1,1,"polygon",9),x(4,T6t,2,3,"text",10),A()}if(2&n){const t=e.$implicit,r=C().$implicit,s=C();ke("id","click_",r.x,"_",r.y,""),T(1),z("points",s.getHexaPointsAt(r)),T(1),w("ngIf",t.getSize()>0),T(1),w("ngIf",t.containsSource()),T(1),w("ngIf",t.getSize()>1)}}const b6t=function(n){return[n]};function O6t(n,e){if(1&n&&(V(),O(0,"g"),x(1,w6t,5,6,"g",5),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngForOf",b3(1,b6t,r.state.getPieceAt(t)))}}function A6t(n,e){if(1&n&&(V(),O(0,"text",18),wt(1),A()),2&n){const t=C().$implicit,r=C();z("x",r.getCenterAt(t.coord).x)("y",r.getCenterAt(t.coord).y),T(1),c1(t.spaceContent.getSize())}}function N6t(n,e){if(1&n&&(V(),O(0,"g",14),X(1,"polygon",15)(2,"circle",16),x(3,A6t,2,3,"text",17),A()),2&n){const t=e.$implicit,r=C();ke("id","disconnected_",t.coord.x,"_",t.coord.y,""),T(1),z("points",r.getHexaPointsAt(t.coord)),T(1),ke("id","captured_",t.coord.x,"_",t.coord.y,""),w("ngClass",r.getPieceClasses(t.spaceContent)),z("cx",r.getCenterAt(t.coord).x)("cy",r.getCenterAt(t.coord).y)("r",r.SPACE_SIZE),T(1),w("ngIf",t.spaceContent.getSize()>1)}}function I6t(n,e){if(1&n&&(V(),dn(0),X(1,"polygon",19)(2,"polygon",19),pn()),2&n){const t=C();T(1),z("points",t.getHexaPointsAt(t.lastMove.get().getStart())),T(1),z("points",t.getHexaPointsAt(t.lastMove.get().getEnd()))}}function x6t(n,e){if(1&n&&(V(),X(0,"polygon",20)),2&n){const t=C();ke("id","chosen_",t.chosen.get().x,"_",t.chosen.get().y,""),z("points",t.getHexaPointsAt(t.chosen.get()))}}let k6t=(()=>{class n extends d9{constructor(t){super(t),this.lastMove=y.empty(),this.chosen=y.empty(),this.disconnecteds=[],this.rules=fs.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Z3e(this.rules,"DvonnMinimax"),new M6t(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=Hr.encoder,this.tutorial=(new j3e).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=y.of(fs.getScores(this.getState())),this.hexaLayout=new p9(1.5*this.SPACE_SIZE,new S(-this.SPACE_SIZE,2*this.SPACE_SIZE),nT.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=y.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.disconnecteds=[],this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=y.of(fs.getScores(this.state))}showLastMove(t){this.lastMove=y.of(t);const r=this.getPreviousState(),s=this.getState();for(let i=0;i<s.board.length;i++)for(let o=0;o<s.board[i].length;o++){const c=new S(o,i);if(!0===s.isOnBoard(c)&&!1===c.equals(this.lastMove.get().getStart())){const u=s.getPieceAt(c),h=r.getPieceAt(c);if(u.isEmpty()&&!h.isEmpty()){const m={coord:new S(o,i),spaceContent:h};this.disconnecteds.push(m)}}}}cancelMoveAttempt(){this.chosen=y.empty()}pass(){var t=this;return I(function*(){return qe(t.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield t.chooseMove(Hr.PASS)})()}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(t,r):s.chosen.equalsValue(new S(t,r))?(s.cancelMoveAttempt(),R.SUCCESS):yield s.chooseDestination(t,r)})()}choosePiece(t,r){const s=new S(t,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=y.of(s),R.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(t,r){var s=this;return I(function*(){const i=s.getState(),o=s.chosen.get(),c=new S(t,r),u=Hr.from(o,c);return u.isFailure()?s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(t,r):s.cancelMove(u.getReason()):s.rules.isLegal(u.get(),i).isFailure()&&s.rules.isMovablePiece(i,c).isSuccess()?s.choosePiece(t,r):s.chooseMove(u.get())})()}getPieceClasses(t){if(t.containsSource()&&1===t.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(t.getOwner());return t.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[3,"id"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-medium","dy","13",4,"ngIf"],["dy","13",1,"text-center","text-medium"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,O6t,2,3,"g",1),x(2,N6t,4,10,"g",2),x(3,I6t,3,2,"ng-container",3),x(4,x6t,1,3,"polygon",4),A()),2&t&&(T(1),w("ngForOf",r.state.allCoords()),T(1),w("ngForOf",r.disconnecteds),T(1),w("ngIf",r.lastMove.isPresent()),T(1),w("ngIf",r.chosen.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var J1=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(J1||(J1={})),J1))();class tt{constructor(e){this.value=e}static of(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}static ofSizeAndPlayer(e,t){return t===B.ZERO&&e===J1.BIG?tt.BIG_DARK:t===B.ZERO&&e===J1.MEDIUM?tt.MEDIUM_DARK:t===B.ZERO&&e===J1.SMALL?tt.SMALL_DARK:t===B.ONE&&e===J1.BIG?tt.BIG_LIGHT:t===B.ONE&&e===J1.MEDIUM?tt.MEDIUM_LIGHT:t===B.ONE&&e===J1.SMALL?tt.SMALL_LIGHT:tt.NONE}getPlayer(){switch(this){case tt.SMALL_DARK:case tt.MEDIUM_DARK:case tt.BIG_DARK:return B.ZERO;case tt.SMALL_LIGHT:case tt.MEDIUM_LIGHT:case tt.BIG_LIGHT:return B.ONE;default:return le.NONE}}getSize(){switch(this){case tt.BIG_DARK:case tt.BIG_LIGHT:return J1.BIG;case tt.MEDIUM_DARK:case tt.MEDIUM_LIGHT:return J1.MEDIUM;case tt.SMALL_DARK:case tt.SMALL_LIGHT:return J1.SMALL;default:return pe.expectToBe(this,tt.NONE),J1.NONE}}belongsTo(e){return this.getPlayer()===e}equals(e){return this===e}toString(){switch(this){case tt.BIG_DARK:return"BIG_DARK";case tt.BIG_LIGHT:return"BIG_LIGHT";case tt.MEDIUM_DARK:return"MEDIUM_DARK";case tt.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case tt.SMALL_DARK:return"SMALL_DARK";case tt.SMALL_LIGHT:return"SMALL_LIGHT";default:return pe.expectToBe(this,tt.NONE),"EMPTY"}}}tt.encoder=Ye.tuple([Ye.identity()],n=>[n.value],n=>tt.of(n[0])),tt.SMALL_DARK=new tt(0),tt.SMALL_LIGHT=new tt(1),tt.MEDIUM_DARK=new tt(2),tt.MEDIUM_LIGHT=new tt(3),tt.BIG_DARK=new tt(4),tt.BIG_LIGHT=new tt(5),tt.NONE=new tt(6);class k8 extends br{constructor(e,t,r){super(e,t),this.remainingPieces=r}static getInitialState(){const e=new Zi(le.NONE,le.NONE,le.NONE),t=Je.createTable(3,3,e);return new k8(t,0,[tt.BIG_DARK,tt.BIG_DARK,tt.BIG_LIGHT,tt.BIG_LIGHT,tt.MEDIUM_DARK,tt.MEDIUM_DARK,tt.MEDIUM_LIGHT,tt.MEDIUM_LIGHT,tt.SMALL_DARK,tt.SMALL_DARK,tt.SMALL_LIGHT,tt.SMALL_LIGHT])}getRemainingPieces(){return Je.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(e){return this.getRemainingPieces().filter(t=>t.getPlayer()===e)}pieceBelongsToCurrentPlayer(e){return e.belongsTo(this.getCurrentPlayer())}isDroppable(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}isInRemainingPieces(e){return this.remainingPieces.some(t=>t===e)}getPlayerRemainingPieces(){return this.remainingPieces.filter(e=>this.pieceBelongsToCurrentPlayer(e))}}class Zi{constructor(e,t,r){this.small=e,this.medium=t,this.big=r}isEmpty(){return this.small===le.NONE&&this.medium===le.NONE&&this.big===le.NONE}toList(){const e=[];return this.small.isPlayer()&&e.push(tt.ofSizeAndPlayer(J1.SMALL,this.small)),this.medium.isPlayer()&&e.push(tt.ofSizeAndPlayer(J1.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(tt.ofSizeAndPlayer(J1.BIG,this.big)),e}toOrderedPieceNames(){const e=tt.ofSizeAndPlayer(J1.SMALL,this.small),t=tt.ofSizeAndPlayer(J1.MEDIUM,this.medium),r=tt.ofSizeAndPlayer(J1.BIG,this.big);return[e.toString(),t.toString(),r.toString()]}getBiggest(){return this.big===B.ZERO?tt.BIG_DARK:this.big===B.ONE?tt.BIG_LIGHT:this.medium===B.ZERO?tt.MEDIUM_DARK:this.medium===B.ONE?tt.MEDIUM_LIGHT:this.small===B.ZERO?tt.SMALL_DARK:this.small===B.ONE?tt.SMALL_LIGHT:tt.NONE}tryToSuperposePiece(e){const t=this.getBiggest().getSize();if(e===tt.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?y.of(this.put(e)):y.empty()}removeBiggest(){const e=this.getBiggest();if(e===tt.NONE)throw new Error("Cannot removed piece from empty space");let t;const r=e.getSize();switch(r){case J1.BIG:t=new Zi(this.small,this.medium,le.NONE);break;case J1.MEDIUM:t=new Zi(this.small,le.NONE,le.NONE);break;default:pe.expectToBe(r,J1.SMALL),t=new Zi(le.NONE,le.NONE,le.NONE)}return{removedSpace:t,removedPiece:e}}put(e){if(e===tt.NONE)throw new Error("Cannot put NONE on space");const t=e.getPlayer(),r=e.getSize();switch(r){case J1.BIG:return new Zi(this.small,this.medium,t);case J1.MEDIUM:return qe(this.big===le.NONE,"Cannot put a piece on top of a bigger one"),new Zi(this.small,t,this.big);default:return pe.expectToBe(r,J1.SMALL),qe(this.big===le.NONE,"Cannot put a piece on top of a bigger one"),qe(this.medium===le.NONE,"Cannot put a piece on top of a bigger one"),new Zi(t,this.medium,this.big)}}belongsTo(e){return this.getBiggest().getPlayer()===e}toString(){const e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}Zi.EMPTY=new Zi(le.NONE,le.NONE,le.NONE);let x_=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();var $3;let L8=$3=class extends N1{constructor(){super(k8)}static get(){return $3.singleton.isAbsent()&&($3.singleton=y.of(new $3)),$3.singleton.get()}static isVictory(e){const t=e.getCopiedBoard();for(const r of $3.LINES){const i=$3.isVictoriousLine([t[r[0].y][r[0].x],t[r[1].y][r[1].x],t[r[2].y][r[2].x]]);if(i.isPresent())return i}return y.empty()}static isVictoriousLine(e){const r=e.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===le.NONE?y.empty():r[0]===r[1]&&r[1]===r[2]?y.of(r[0]):y.empty()}static isLegal(e,t){let r;if(e.isDropping()){if(r=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(r))return _e.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(r))return _e.failure(x_.PIECE_OUT_OF_STOCK())}else{const o=e.startingCoord.get();if(r=t.getPieceAt(o).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(r))return _e.failure(Xe.MUST_CHOOSE_PLAYER_PIECE())}const i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(r);return i.isPresent()?_e.success(i.get()):_e.failure(x_.INVALID_PLACEMENT())}isLegal(e,t){return $3.isLegal(e,t)}applyLegalMove(e,t,r){const s=t.getCopiedBoard();let i=t.getRemainingPieces();const o=t.turn+1;let c;if(s[e.landingCoord.y][e.landingCoord.x]=r,e.isDropping()){c=e.piece.get();const h=i.indexOf(c);i=i.slice(0,h).concat(i.slice(h+1))}else{const h=e.startingCoord.get(),m=s[h.y][h.x].removeBiggest();s[h.y][h.x]=m.removedSpace,c=m.removedPiece}return new k8(s,o,i)}static getGameStatus(e){const r=$3.isVictory(e.gameState);return r.isPresent()?Ne.getVictory(r.get()):Ne.ONGOING}getGameStatus(e){return $3.getGameStatus(e)}};L8.singleton=y.empty(),L8.LINES=[[new S(0,0),new S(0,1),new S(0,2)],[new S(1,0),new S(1,1),new S(1,2)],[new S(2,0),new S(2,1),new S(2,2)],[new S(0,0),new S(1,0),new S(2,0)],[new S(0,1),new S(1,1),new S(2,1)],[new S(0,2),new S(1,2),new S(2,2)],[new S(0,0),new S(1,1),new S(2,2)],[new S(0,2),new S(1,1),new S(2,0)]],L8=$3=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],L8);class _i extends eo{constructor(e,t,r){super(),this.startingCoord=e,this.landingCoord=t,this.piece=r}static ofMove(e,t){return pe.assert(!1===e.equals(t),"Starting coord and landing coord must be separate coords"),new _i(y.of(e),t,y.empty())}static ofDrop(e,t){return new _i(y.empty(),t,y.of(e))}isDropping(){return this.startingCoord.isAbsent()}equals(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}_i.encoder=Ye.tuple([y.getEncoder(S.encoder),S.encoder,y.getEncoder(tt.encoder)],n=>[n.startingCoord,n.landingCoord,n.piece],n=>new _i(n[0],n[1],n[2]));class R6t extends bs{getMetrics(e){return[0,0]}getListMoves(e){const t=[],r=e.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=O3e.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const h=new S(u,c);for(const g of o){const m=_i.ofDrop(g,h);L8.isLegal(m,r).isSuccess()&&t.push(m)}if(s[c][u].belongsTo(i))for(let g=0;g<3;g++)for(let m=0;m<3;m++){const M=new S(m,g);if(!M.equals(h)){const b=_i.ofMove(h,M);L8.isLegal(b,r).isSuccess()&&t.push(b)}}}return t}}const Vo=new Zi(le.NONE,le.NONE,le.NONE),Y3e=new Zi(B.ZERO,le.NONE,le.NONE),D6t=new Zi(le.NONE,B.ZERO,le.NONE),z6t=new Zi(le.NONE,le.NONE,B.ZERO),K3e=new Zi(B.ONE,le.NONE,le.NONE),cT=new Zi(le.NONE,le.NONE,B.ONE),H6t=new Zi(B.ONE,B.ZERO,le.NONE),V6t=new Zi(B.ZERO,B.ZERO,le.NONE);class X3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new k8([[Y3e,K3e,cT],[Vo,D6t,Vo],[Vo,Vo,z6t]],0,[tt.SMALL_DARK,tt.MEDIUM_DARK,tt.BIG_DARK,tt.SMALL_LIGHT,tt.MEDIUM_LIGHT,tt.MEDIUM_LIGHT,tt.BIG_LIGHT])),ee.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,k8.getInitialState(),_i.ofDrop(tt.SMALL_DARK,new S(1,1)),$localize`Congratulations!`),ee.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new k8([[Y3e,cT,Vo],[Vo,Vo,Vo],[Vo,Vo,Vo]],0,[]),[_i.ofMove(new S(0,0),new S(2,0)),_i.ofMove(new S(0,0),new S(0,1)),_i.ofMove(new S(0,0),new S(1,1)),_i.ofMove(new S(0,0),new S(2,1)),_i.ofMove(new S(0,0),new S(0,2)),_i.ofMove(new S(0,0),new S(1,2)),_i.ofMove(new S(0,0),new S(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new k8([[H6t,Vo,K3e],[V6t,cT,cT],[Vo,Vo,Vo]],0,[tt.MEDIUM_DARK,tt.BIG_DARK,tt.MEDIUM_LIGHT,tt.MEDIUM_LIGHT]),_i.ofMove(new S(0,1),new S(0,2)),(e,t,r)=>{if(e.landingCoord.equals(new S(0,2))){if(e.isDropping())return R.failure($localize`You won, but the exercise is to win while moving a piece!`);if(e.startingCoord.equalsValue(new S(0,1)))return R.SUCCESS}return R.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function F6t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"circle",5),J("click",function(){const s=he(t),i=s.$implicit,o=s.index,c=C().$implicit;return ce(C().onPieceClick(c.value,i,o))}),A()()}if(2&n){const t=e.$implicit,r=e.index,s=C().$implicit,i=C();T(1),j2("id","piece_",s.value,"_",t.toString(),"_",r,""),w("ngClass",i.getSidePieceClasses(t,r)),z("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(t))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function B6t(n,e){if(1&n&&(V(),O(0,"g",null,4),x(2,F6t,2,8,"g",1),A()),2&n){const t=e.$implicit,r=C();T(2),w("ngForOf",r.getRemainingPieces(t))}}function $6t(n,e){if(1&n){const t=Oe();V(),O(0,"circle",8),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().onBoardClick(s,i))}),A()}if(2&n){const t=e.$implicit,r=C().index,s=C().index,i=C();w("ngClass",i.getPieceClasses(t)),z("r",i.getPieceRadius(t))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function G6t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",6),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onBoardClick(i,o))}),A(),x(2,$6t,1,4,"circle",7),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","click_",r,"_",s,""),w("ngClass",i.getRectClasses(r,s)),z("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngForOf",i.getListPieces(t))}}function U6t(n,e){if(1&n&&(V(),O(0,"g"),x(1,G6t,3,8,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function q6t(n,e){if(1&n){const t=Oe();V(),O(0,"rect",9),J("click",function(){he(t);const s=C();return ce(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),A()}if(2&n){const t=C();ke("id","chosenCoord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),z("x",t.SPACE_SIZE*t.chosenCoord.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.chosenCoord.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}let W6t=(()=>{class n extends to{constructor(t){super(t),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty(),this.chosenCoord=y.empty(),this.chosenPiece=y.empty(),this.remainingPieceCenterCoords=new Wn,this.rules=L8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new R6t(this.rules,"EncapsuleMinimax")],this.encoder=_i.encoder,this.tutorial=(new X3e).tutorial,this.updateBoard()}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard();const r=this.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=y.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty())}getListPieces(t){return t.toList()}getRemainingPieces(t){return this.getState().getRemainingPiecesOfPlayer(t)}onBoardClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=y.of(o),s.chosenPiece.isPresent()){const u=_i.ofDrop(s.chosenPiece.get(),o);return s.chooseMove(u)}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(x_.INVALID_PIECE_SELECTED()):R.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;{const u=_i.ofMove(s.chosenCoord.get(),o);return s.chooseMove(u)}})()}cancelMoveAttempt(){this.chosenCoord=y.empty(),this.chosenPiece=y.empty(),this.chosenPieceIndex=y.empty()}onPieceClick(t,r,s){var i=this;return I(function*(){const o="#piece_"+t+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(x_.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=y.empty(),i.chosenPieceIndex=y.empty()):(i.chosenPiece=y.of(r),i.chosenPieceIndex=y.of(s)),R.SUCCESS):i.cancelMove(x_.END_YOUR_MOVE())})()}getRectClasses(t,r){return this.isSelected(t,r)?"moved-fill":""}isSelected(t,r){const s=new S(t,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(t){return[this.getPieceStrokeClass(t)]}getPieceCenter(t){return this.SPACE_SIZE*t+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(t){const r=t.getPlayer();return qe(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(t){switch(t.getSize()){case J1.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case J1.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return pe.expectToBe(t.getSize(),J1.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(t,r){const s=this.getPieceClasses(t);return this.isSelectedPiece(t)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(t){return this.chosenPiece.equalsValue(t)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new Wn;for(const t of B.PLAYERS){const r=[],s=this.getRemainingPieces(t);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new S(2-i,3),u=this.STROKE_WIDTH):(o=new S(-1,5-i),c=-this.STROKE_WIDTH);const h=this.getPieceCenter(o.x),g=this.getPieceCenter(o.y);r.push(new S(h+c,g+u))}this.remainingPieceCenterCoords.set(t,r)}}getRemainingPieceCenterCoord(t,r){return this.remainingPieceCenterCoords.get(t).get()[r]}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,B6t,3,1,"g",1),O(2,"g",null,2),x(4,U6t,2,1,"g",1),x(5,q6t,1,6,"rect",3),A()()),2&t&&(z("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),T(1),w("ngForOf",r.Player.PLAYERS),T(3),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class zc extends us{constructor(e,t,r,s,i){super(e,t),this.movedPieces=r,this.stepSize=s,this.direction=i,pe.assert(this.coord.isInRange(14,12),"Illegal coord outside of board "+this.coord.toString()+"."),pe.assert(r>0,"Must select minimum one piece (got "+r+")."),pe.assert(s>0,"Step size must be minimum one (got "+s+")."),pe.assert(s<=r,"Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}zc.encoder=Ye.tuple([S.encoder,Ye.identity(),Ye.identity(),be.encoder],n=>[n.coord,n.movedPieces,n.stepSize,n.direction],n=>new zc(n[0].x,n[0].y,n[1],n[2],n[3]));class K4 extends br{static getInitialState(){const e=le.NONE,t=le.ZERO,r=le.ONE;return new K4([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}count(e,t){let r=0;for(let s=0;s<14;s++)this.board[t][s]===e&&r++;return r}doesOwnPiece(e){for(let t=0;t<12;t++)for(let r=0;r<14;r++)if(this.board[t][r]===e)return!0;return!1}}let Hc=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class no extends N1{constructor(){super(K4)}static get(){return no.singleton.isAbsent()&&(no.singleton=y.of(new no)),no.singleton.get()}static isLegal(e,t){const r=this.getPhalanxValidity(t,e);if(r.isFailure())return _e.failure(r.getReason());const s=this.getLandingStatus(t,e);if(s.isFailure())return s;const i=Je.copyBiArray(s.get()),o=t.getCurrentOpponent(),c=no.getCaptureValidity(t,i,e,o);return c.isFailure()?c:_e.success(c.get())}static getPhalanxValidity(e,t){let r=t.coord,s=0;const i=e.getCurrentOpponent();for(;s<t.movedPieces;){if(r.isNotInRange(14,12))return R.failure(Hc.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=e.getPieceAt(r);if(o===le.NONE)return R.failure(Hc.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return R.failure(Hc.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(t.direction,1),s++}return R.SUCCESS}static getLandingStatus(e,t){const r=e.getCopiedBoard(),s=e.getCurrentPlayer();let i=t.coord,o=t.coord.getNext(t.direction,t.movedPieces),c=0;for(;c+1<t.stepSize;){if(r[i.y][i.x]=le.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return _e.failure(Hc.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(o).isPlayer())return _e.failure(Hc.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(t.direction,1),i=i.getNext(t.direction,1)}return o.isNotInRange(14,12)?_e.failure(Hc.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(o)===s?_e.failure(Xe.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(r[i.y][i.x]=le.NONE,r[o.y][o.x]=s,_e.success(r))}static getCaptureValidity(e,t,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&e.getPieceAt(i)===s;){if(o>0&&(t[i.y][i.x]=le.NONE),o++,o>=r.movedPieces)return _e.failure(Hc.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return _e.success(t)}isLegal(e,t){return no.isLegal(e,t)}applyLegalMove(e,t,r){return new K4(r,t.turn+1)}getGameStatus(e){const t=e.gameState,r=t.count(B.ZERO,0),s=t.count(B.ONE,11);if(t.turn%2==0){if(r>s)return Ne.ZERO_WON}else if(s>r)return Ne.ONE_WON;return!1===t.doesOwnPiece(B.ZERO)?Ne.ONE_WON:!1===t.doesOwnPiece(B.ONE)?Ne.ZERO_WON:Ne.ONGOING}}no.singleton=y.empty();class k_ extends Xa{static getListMoves(e){const t=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),s=le.NONE;let i=[];const o=e.gameState;let c;for(let u=0;u<12;u++)for(let h=0;h<14;h++){const g=new S(h,u);if(o.getPieceAt(g)===t)for(const m of be.DIRECTIONS){let M=1,b=g.getNext(m,1);for(;b.isInRange(14,12)&&o.getPieceAt(b)===t;)M+=1,b=b.getNext(m,1);let L=1;for(;b.isInRange(14,12)&&L<=M&&o.getPieceAt(b)===s;)c=new zc(h,u,M,L,m),i=this.addMove(i,c,o),L++,b=b.getNext(m,1);b.isInRange(14,12)&&L<=M&&o.getPieceAt(b)===r&&(c=new zc(h,u,M,L,m),i=this.addMove(i,c,o))}}return i}static addMove(e,t,r){return no.isLegal(t,r).isSuccess()&&e.push(t),e}getListMoves(e){const t=k_.getListMoves(e);return Je.sortByDescending(t,r=>r.stepSize),t}getBoardValue(e){const t=no.get().getGameStatus(e);return t.isEndGame?t.toBoardValue():new Vn(this.getPieceCountPlusRowDomination(e.gameState))}getPieceCountPlusRowDomination(e){let o=0;for(let c=0;c<12;c++){let u=0;const h=[0,0];for(let g=0;g<14;g++){const m=new S(g,c),M=e.getPieceAt(m);if(M.isPlayer()){const b=M.getScoreModifier();o+=2002*b,h[M.value]=b,u+=b;for(const L of[be.UP_LEFT,be.UP,be.UP_RIGHT]){let G=m.getNext(L,1);for(;G.isInRange(14,12)&&e.getPieceAt(G)===M;)o+=1*b,G=G.getNext(L,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*h.reduce((g,m)=>g+m)}return o}}class j6t extends Xa{getListMoves(e){const t=k_.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}orderMovesByPhalanxSizeAndFilter(e,t){return Je.sortByDescending(e,r=>r.movedPieces),e.length>40?e.filter(s=>!!this.moveIsCapture(s,t)||s.movedPieces*Math.random()>1):e}moveIsCapture(e,t){const r=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[r.y][r.x]===t.getCurrentOpponent()}getBoardValue(e){const t=no.get().getGameStatus(e);return t.isEndGame?t.toBoardValue():new Vn(this.getPieceCountThenSupportThenAdvancement(e.gameState))}getPieceCountThenSupportThenAdvancement(e){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const h=new S(u,c),g=e.getPieceAt(h);if(g.isPlayer()){let m,M;g===B.ZERO?(m=12-c,M=[be.UP_LEFT,be.UP,be.UP_RIGHT]):(m=c+1,M=[be.DOWN_LEFT,be.DOWN,be.DOWN_RIGHT]);const b=g.getScoreModifier();o+=m*b,o+=149629*b;for(const L of M){let G=h.getNext(L,1);for(;G.isInRange(14,12)&&e.getPieceAt(G)===g;)o+=337*b,G=G.getNext(L,1)}}}return o}}class Z6t extends k_{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(e){let t=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=e.getPieceAt(new S(s,r));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}getDefense(e){let t=0;for(let r=0;r<14;r++)e.getPieceAt(new S(r,11))===B.ZERO&&(t+=B.ZERO.getScoreModifier()),e.getPieceAt(new S(r,0))===B.ONE&&(t+=B.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}getTerritory(e){let t=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=e.getPieceAt(new S(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new S(s+o,r+c);if(u.isInRange(14,12)){const h=e.getPieceAt(u);(h===i||h===le.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}getOffense(e){let t=0;for(let r=0;r<14;r++)e.getPieceAt(new S(r,0))===B.ZERO&&(t+=B.ZERO.getScoreModifier()),e.getPieceAt(new S(r,11))===B.ONE&&(t+=B.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}getCenter(e){let t=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=e.getPieceAt(new S(s,r));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return t*this.CENTER_FACTOR}getMobility(e){let t=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new S(o,i),u=e.getPieceAt(c);if(u.isPlayer())for(const h of be.DIRECTIONS){let g=1,m=c.getNext(h,1);for(;m.isInRange(14,12)&&e.getPieceAt(m)===u;)g+=1,m=m.getNext(h,1);let M=1;for(;m.isInRange(14,12)&&M<=g&&e.getPieceAt(m)===le.NONE;)M++,m=m.getNext(h,1);t+=M*M*u.getScoreModifier(),u===B.ZERO?r=Math.max(r,M):u===B.ONE&&(s=Math.max(s,M))}}return(t+r*B.ZERO.getScoreModifier()+s*B.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(e){const t=e.gameState,r=no.get().getGameStatus(e);if(r.isEndGame)return r.toBoardValue();const s=this.getDominance(t),i=this.getDefense(t),o=this.getTerritory(t),c=this.getCenter(t),u=this.getOffense(t),h=this.getMobility(t);return new Vn(s+i+o+c+u+h)}}const k=le.NONE,Ar=le.ZERO,G1=le.ONE;class Q3e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,K4.getInitialState()),ee.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new K4([[k,k,k,k,k,Ar,k,k,G1,G1,G1,G1,G1,G1],[k,k,k,k,k,Ar,k,k,k,k,k,k,G1,G1],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,G1,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,Ar,Ar,Ar,Ar,k,k,k]],0)),ee.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new K4([[k,k,k,k,k,Ar,k,k,k,k,G1,G1,G1,G1],[k,k,k,k,k,Ar,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,G1,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,G1,G1,k,k,k,Ar,Ar,k,Ar,Ar,Ar,Ar]],1)),ee.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,K4.getInitialState(),new zc(0,10,1,1,be.UP),(e,t,r)=>1===e.movedPieces?R.SUCCESS:R.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),ee.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,K4.getInitialState(),new zc(0,11,2,1,be.UP),(e,t,r)=>e.movedPieces>1?R.SUCCESS:R.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),ee.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new K4([[k,k,k,k,k,k,k,k,G1,G1,G1,G1,G1,G1],[k,k,k,k,k,k,G1,k,k,k,k,k,k,k],[k,k,k,k,k,G1,k,k,k,k,k,k,k,k],[k,k,G1,k,G1,k,k,k,k,k,k,k,k,k],[k,k,G1,G1,k,k,k,k,k,k,k,k,k,k],[k,k,G1,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,Ar,k,k,k,k,k,k,k,k,k,k,k],[k,k,Ar,k,k,k,k,G1,k,k,k,k,k,k],[k,k,Ar,k,k,k,k,k,k,k,k,k,k,k],[k,k,Ar,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,Ar,Ar,Ar,Ar,Ar,Ar,Ar]],0),[new zc(2,10,4,2,be.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function Y6t(n,e){if(1&n){const t=Oe();V(),O(0,"circle",4),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().onClick(s,i))}),A()}if(2&n){const t=C().index,r=C().index,s=C();w("ngClass",s.getPieceClasses(t,r)),z("cx",s.SPACE_SIZE*t+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function K6t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",2),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),A(),x(2,Y6t,1,4,"circle",3),A()}if(2&n){const t=e.index,r=C().index,s=C();T(1),ke("id","click_",t,"_",r,""),w("ngClass",s.getRectClasses(t,r)),z("x",s.SPACE_SIZE*t+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][t]!==s.NONE)}}function X6t(n,e){if(1&n&&(V(),O(0,"g"),x(1,K6t,3,8,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Q6t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",5),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C();T(1),z("x",r.SPACE_SIZE*t.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*t.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let J6t=(()=>{class n extends to{constructor(t){super(t),this.NONE=le.NONE,this.firstPiece=y.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=y.empty(),this.phalanxDirection=y.empty(),this.phalanxMiddles=[],this.moveds=[],this.capturedCoords=[],this.hasAsymmetricBoard=!0,this.rules=no.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new k_(this.rules,"Normal"),new j6t(this.rules,"Positional"),new Z6t(this.rules,"Attack")],this.encoder=zc.encoder,this.tutorial=(new Q3e).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=y.empty(),this.lastPiece=y.empty(),this.hidePreviousMove(),this.board=this.getState().getCopiedBoard()}showLastMove(t){let r=t.coord;this.moveds=[r];for(let o=1;o<t.stepSize+t.movedPieces;o++)r=r.getNext(t.direction,1),this.moveds.push(r);const s=this.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.capturedCoords.push(r),r=r.getNext(t.direction,1)}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(t,r):s.lastPiece.isAbsent()?s.secondClick(t,r):s.thirdClick(t,r)})()}firstClick(t,r){var s=this;return I(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][t]){case o:return s.firstPiece=y.of(new S(t,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),R.SUCCESS;case i:return s.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());default:return pe.expectToBe(s.board[r][t],le.NONE),s.cancelMove(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(t){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(t):this.getFirstPieceExtensions(t)}getFirstPieceExtensions(t){const r=[];for(const s of be.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===t;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(t){let r=be.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,t);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,t);return i.concat(c)}getExtensionsToward(t,r,s){const i=[];for(;t.isInRange(14,12)&&this.board[t.y][t.x]===s;)i.push(t),t=t.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const t=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(t.x-r.x),i=Math.abs(t.y-r.y),o=Math.max(s,i)+1;let c=be.factory.fromMove(t,r).get();const u=r.getNext(c,1),h=this.getLandingsToward(u,c,o);c=c.getOpposite();const g=t.getNext(c,1);return this.getLandingsToward(g,c,o).concat(h)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const t=[];for(const r of be.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===le.NONE&&t.push(s)}return t}getLandingsToward(t,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;t.isInRange(14,12)&&c.length<s&&this.board[t.y][t.x]!==i;){if(this.board[t.y][t.x]===o)return this.getPhalanxLength(t,r,o)<s&&c.push(t),c;c.push(t),t=t.getNext(r,1)}return c}getPhalanxLength(t,r,s){let i=0;for(;t.isInRange(14,12)&&this.board[t.y][t.x]===s;)i++,t=t.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=y.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=y.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(t,r){var s=this;return I(function*(){const i=new S(t,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),R.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove(Hc.SQUARE_NOT_ALIGNED_WITH_SELECTED());const h=i.getDistance(o),g=o.getDirectionToward(i).get();switch(s.board[r][t]){case le.NONE:return 1===h?s.chooseMove(new zc(o.x,o.y,1,1,g)):s.cancelMove(Hc.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(Hc.SINGLE_PIECE_CANNOT_CAPTURE());default:pe.expectToBe(s.board[r][t],u);const m=new zc(o.x,o.y,h,1,g),M=s.getState(),b=no.getPhalanxValidity(M,m);return b.isFailure()?s.cancelMove(b.getReason()):(s.lastPiece=y.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=y.of(g),R.SUCCESS)}})()}thirdClick(t,r){var s=this;return I(function*(){const i=s.getState().getCurrentPlayer(),o=new S(t,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove(Hc.SQUARE_NOT_ALIGNED_WITH_PHALANX());let h=be.factory.fromMove(c,u).get();const g=be.factory.fromMove(c,o).get();if(h===g.getOpposite()&&(s.firstPiece=y.of(u),s.lastPiece=y.of(c),h=g),h!==g)return s.cancelMove(Hc.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][t]===i)return s.thirdClickOnPlayerPiece(o,h,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,M=s.lastPiece.get().getDistance(o),b=new zc(s.firstPiece.get().x,s.firstPiece.get().y,m,M,h);return s.chooseMove(b)}})()}thirdClickOnPlayerPiece(t,r,s){var i=this;return I(function*(){i.lastPiece=y.of(t);const o=i.firstPiece.get().getDistance(t)+1,c=new zc(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=no.getPhalanxValidity(i.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),R.SUCCESS)})()}moveFirstPiece(t){var r=this;return I(function*(){return r.firstPiece=y.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(t):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(t)),r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS})()}moveLastPiece(t){var r=this;return I(function*(){return r.lastPiece=y.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(t):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(t),r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS)})()}moveOnlyPiece(t){var r=this;return I(function*(){return r.lastPiece=y.empty(),r.validExtensions=r.getFirstPieceExtensions(t),r.phalanxDirection=y.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),R.SUCCESS})()}getPieceClasses(t,r){const s=this.getPlayerClass(this.board[r][t]);return this.getPieceStrokeClasses(t,r).concat([s])}getPieceStrokeClasses(t,r){const s=new S(t,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(t,r){const s=new S(t,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const t=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&t.push(new S(o,i));return t}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,X6t,2,1,"g",1),x(2,Q6t,2,4,"g",1),A()),2&t&&(z("transform",r.rotation),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getHighlightedCoords()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class vi{constructor(e){pe.assert(e.length>=4,"Cannot create a GipfCapture with less than 4 captured pieces"),pe.assert(tc.areOnSameLine(e),"Cannot create a GipfCapture with pieces that are not on the same line"),this.capturedSpaces=Je.copyImmutableArray(e).sort((r,s)=>r.x===s.x?(pe.assert(r.y!==s.y,"Cannot create a GipfCapture with duplicate coords"),r.y>s.y?1:-1):r.x>s.x?1:-1);let t=y.empty();for(const r of this.capturedSpaces)pe.assert(t.isAbsent()||1===t.get().getDistance(r),"Cannot create a GipfCapture with non-consecutive coords"),t=y.of(r)}toString(){let e="";for(const t of this.capturedSpaces)""!==e&&(e+=","),e+=t.toString();return e}size(){return this.capturedSpaces.length}forEach(e){this.capturedSpaces.forEach(e)}contains(e){for(let t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}intersectsWith(e){return this.capturedSpaces.some(t=>e.contains(t))}getLine(){return tc.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(let t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}vi.encoder=Ye.tuple([Ye.list(S.encoder)],n=>[n.capturedSpaces],n=>new vi(n[0])),vi.listEncoder=Ye.list(vi.encoder);class Vc{constructor(e,t){this.coord=e,this.direction=t}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}Vc.encoder=Ye.tuple([S.encoder,y.getEncoder(Re.encoder)],n=>[n.coord,n.direction],n=>new Vc(n[0],n[1]));class G3 extends eo{constructor(e,t,r){super(),this.placement=e,this.initialCaptures=t,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const r of e)""!==t&&(t+=","),t+="["+r.toString()+"]";return t}equals(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===Je.compareArray(this.initialCaptures,e.initialCaptures)||!1===Je.compareArray(this.finalCaptures,e.finalCaptures))}}G3.encoder=Ye.tuple([Vc.encoder,vi.listEncoder,vi.listEncoder],n=>[n.placement,n.initialCaptures,n.finalCaptures],n=>new G3(n[0],n[1],n[2]));class Fc extends yF{constructor(e,t,r,s){super(t,e,7,7,[3,2,1],Ie.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const e=Ie.EMPTY,t=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE;return new Fc([[t,t,t,s,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,s],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[s,e,e,r,t,t,t]],0,[12,12],[0,0])}equals(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&Je.compareTable(this.board,e.board)}getNumberOfPiecesToPlace(e){return this.sidePieces[e.value]}getNumberOfPiecesCaptured(e){return this.capturedPieces[e.value]}setAtUnsafe(e,t){const r=Je.copyBiArray(this.board);return r[e.y][e.x]=t,new Fc(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Ie.UNREACHABLE}}let Bc=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class On extends N1{constructor(){super(Fc)}static get(){return On.singleton.isAbsent()&&(On.singleton=y.of(new On)),On.singleton.get()}applyLegalMove(e,t,r){return new Fc(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(e,t){let r=t;return e.forEach(s=>{r=On.applyCapture(s,r)}),r}static applyCapture(e,t){const r=t.getCurrentPlayer();let s=t;const i=[t.sidePieces[0],t.sidePieces[1]],o=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(c=>{const u=t.getPieceAt(c);s=s.setAt(c,Ie.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new Fc(s.board,t.turn,i,o)}static getPlacements(e){const t=[];return ws.INSTANCE.getAllBorders(e).forEach(r=>{e.getPieceAt(r)===Ie.EMPTY?t.push(new Vc(r,y.empty())):On.getAllDirectionsForEntrance(e,r).forEach(s=>{!1===On.isLineComplete(e,r,s)&&t.push(new Vc(r,y.of(s)))})}),t}static isLineComplete(e,t,r){return On.nextGapInLine(e,t,r).isAbsent()}static nextGapInLine(e,t,r){for(let s=t;e.isOnBoard(s);s=s.getNext(r))if(e.getPieceAt(s)===Ie.EMPTY)return y.of(s);return y.empty()}static applyPlacement(e,t){const r=t.getCurrentPlayer();let s=t,i=Ie.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){const c=e.coord;if(t.getPieceAt(c)!==Ie.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=e.coord;s.isOnBoard(c)&&i!==Ie.EMPTY;c=c.getNext(e.direction.get())){const u=t.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[t.sidePieces[0],t.sidePieces[1]];return o[r.value]-=1,new Fc(s.board,t.turn,o,t.capturedPieces)}getPiecesMoved(e,t,r){const s=On.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==Ie.EMPTY;)o.push(c),c=c.getNext(i);return qe(s.isOnBoard(c)&&s.getPieceAt(c)===Ie.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(e,t){if(ws.INSTANCE.isTopLeftCorner(e,t))return[Re.RIGHT,Re.DOWN,Re.UP_RIGHT];if(ws.INSTANCE.isTopCorner(e,t))return[Re.DOWN,Re.DOWN_LEFT,Re.RIGHT];if(ws.INSTANCE.isTopRightCorner(e,t))return[Re.DOWN_LEFT,Re.DOWN,Re.LEFT];if(ws.INSTANCE.isBottomLeftCorner(e,t))return[Re.UP_RIGHT,Re.UP,Re.RIGHT];if(ws.INSTANCE.isBottomCorner(e,t))return[Re.UP,Re.LEFT,Re.UP_RIGHT];if(ws.INSTANCE.isBottomRightCorner(e,t))return[Re.LEFT,Re.UP,Re.DOWN_LEFT];if(ws.INSTANCE.isOnTopLeftBorder(e,t))return[Re.RIGHT,Re.DOWN];if(ws.INSTANCE.isOnLeftBorder(e,t))return[Re.UP_RIGHT,Re.RIGHT];if(ws.INSTANCE.isOnBottomLeftBorder(e,t))return[Re.UP,Re.UP_RIGHT];if(ws.INSTANCE.isOnBottomRightBorder(e,t))return[Re.LEFT,Re.UP];if(ws.INSTANCE.isOnRightBorder(e,t))return[Re.LEFT,Re.DOWN_LEFT];if(ws.INSTANCE.isOnTopRightBorder(e,t))return[Re.DOWN_LEFT,Re.DOWN];throw new Error("not a border")}isLegal(e,t){const r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=On.applyCaptures(e.initialCaptures,t),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toOtherFallible();const o=this.placementValidity(s,e.placement);if(o.isFailure())return o.toOtherFallible();const c=On.applyPlacement(e.placement,s),u=this.capturesValidity(c,e.finalCaptures);if(u.isFailure())return u.toOtherFallible();const h=On.applyCaptures(e.finalCaptures,c),g=this.noMoreCapturesValidity(h);return g.isFailure()?g.toOtherFallible():_e.success(h)}capturesValidity(e,t){let r=e;for(const s of t){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=On.applyCapture(s,r)}return R.SUCCESS}captureValidity(e,t){const r=e.getCurrentPlayer(),s=On.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(s.isAbsent())return R.failure(Bc.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return On.getCapturable(e,i).equals(t)?R.SUCCESS:R.failure(Bc.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(e,t){const r=[];return e.allLines().forEach(s=>{const i=On.getLinePortionWithFourPiecesOfPlayer(e,t,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(e,t,r){let s=0;const i=e.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;e.isOnBoard(u);u=u.getNext(o))if(e.getPieceAt(u).is(t)?(0===s&&(c=u),s+=1):s=0,4===s)return y.of({0:c,1:u,2:o});return y.empty()}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===On.getLinePortionsWithFourPiecesOfPlayer(e,t).length?R.SUCCESS:R.failure(Bc.MISSING_CAPTURES())}placementValidity(e,t){const r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==Ie.EMPTY){if(t.direction.isAbsent())return R.failure(Bc.PLACEMENT_WITHOUT_DIRECTION());if(On.isLineComplete(e,t.coord,t.direction.get()))return R.failure(Bc.PLACEMENT_ON_COMPLETE_LINE());for(const s of On.getAllDirectionsForEntrance(e,t.coord))if(s===t.direction.get())return R.SUCCESS;return R.failure(Bc.INVALID_PLACEMENT_DIRECTION())}return R.SUCCESS}placementCoordValidity(e,t){return ws.INSTANCE.isOnBorder(e,t)?R.SUCCESS:R.failure(Bc.PLACEMENT_NOT_ON_BORDER())}static getCapturable(e,t){const r=[],s=t[0],i=t[1],o=t[2],c=o.getOpposite();let u=s.getNext(c);for(;e.isOnBoard(u)&&e.getPieceAt(u)!==Ie.EMPTY;)r.push(u),u=u.getNext(c);for(let h=s;!h.equals(i);h=h.getNext(o))r.push(h);for(let h=i;e.isOnBoard(h)&&e.getPieceAt(h)!==Ie.EMPTY;h=h.getNext(o))r.push(h);return new vi(r)}static getPossibleCaptures(e){const t=e.getCurrentPlayer(),r=[];return On.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(s=>{r.push(On.getCapturable(e,s))}),r}static getPlayerScore(e,t){const r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===On.getPossibleCaptures(e).length)return y.empty();const s=e.getNumberOfPiecesCaptured(t);return y.of(r+3*s)}static isGameOver(e){const t=On.getPlayerScore(e,B.ZERO),r=On.getPlayerScore(e,B.ONE);return t.isAbsent()||r.isAbsent()}getGameStatus(e){const t=e.gameState,r=On.getPlayerScore(t,B.ZERO),s=On.getPlayerScore(t,B.ONE);return r.isAbsent()?Ne.ONE_WON:s.isAbsent()?Ne.ZERO_WON:Ne.ONGOING}}On.singleton=y.empty();class L_ extends bs{static getPossibleCaptureCombinationsFromPossibleCaptures(e){const t=L_.computeIntersections(e);let r=[[]];return e.forEach((s,i)=>{if(0===t[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=t[i].some(u=>u>i);for(const u of r)!0===u.some(g=>t[i].some(m=>g===m))?o.push(Je.copyImmutableArray(u)):c?(o.push(Je.copyImmutableArray(u)),u.push(i),o.push(Je.copyImmutableArray(u))):(u.push(i),o.push(Je.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>e[i]))}static computeIntersections(e){const t=[];return e.forEach((r,s)=>{t.push([]),e.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&t[s].push(o)})}),t}getMetrics(e){const t=e.gameState;return[On.getPlayerScore(t,B.ZERO).get(),On.getPlayerScore(t,B.ONE).get()]}getListMoves(e){return this.getListMoveFromState(e.gameState)}getListMoveFromState(e){const t=[];return On.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(r=>{const s=On.applyCaptures(r,e);On.getPlacements(s).forEach(i=>{const o=On.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new G3(i,r,c);t.push(u)})})}),t}getPossibleCaptureCombinations(e){const t=On.getPossibleCaptures(e);return L_.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}class J3e{constructor(e,t,r,s,i,o){this.source=e,this.destination=t,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const r1=Ie.UNREACHABLE,gt=Ie.EMPTY,Nr=Ie.ZERO,X4=Ie.ONE;class e4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Fc.getInitialState()),ee.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Fc.getInitialState(),new G3(new Vc(new S(3,0),y.of(Re.DOWN)),[],[]),$localize`Congratulations!`),ee.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Fc([[r1,r1,r1,Nr,X4,gt,gt],[r1,r1,gt,gt,gt,gt,gt],[r1,gt,gt,gt,gt,gt,gt],[Nr,Nr,Nr,gt,gt,gt,gt],[X4,gt,gt,gt,gt,gt,r1],[gt,gt,gt,X4,gt,r1,r1],[gt,gt,gt,X4,r1,r1,r1]],42,[8,8],[0,0]),[new G3(new Vc(new S(0,3),y.of(Re.RIGHT)),[],[new vi([new S(0,3),new S(1,3),new S(2,3),new S(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),ee.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Fc([[r1,r1,r1,gt,gt,gt,gt],[r1,r1,gt,X4,gt,gt,gt],[r1,gt,gt,Nr,gt,gt,gt],[Nr,Nr,Nr,X4,gt,gt,gt],[gt,gt,gt,Nr,gt,gt,r1],[gt,gt,gt,Nr,gt,r1,r1],[gt,gt,gt,X4,r1,r1,r1]],42,[8,4],[2,3]),[new G3(new Vc(new S(0,3),y.of(Re.RIGHT)),[],[new vi([new S(3,1),new S(3,2),new S(3,3),new S(3,4),new S(3,5),new S(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),ee.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Fc([[r1,r1,r1,Nr,gt,gt,Nr],[r1,r1,gt,Nr,gt,gt,Nr],[r1,Nr,Nr,gt,Nr,X4,Nr],[gt,gt,gt,Nr,gt,gt,Nr],[gt,gt,gt,Nr,gt,gt,r1],[Nr,Nr,Nr,X4,X4,r1,r1],[gt,gt,gt,Nr,r1,r1,r1]],42,[3,4],[2,3]),[new G3(new Vc(new S(3,6),y.of(Re.UP)),[new vi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new vi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new vi([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)])]),new G3(new Vc(new S(4,6),y.of(Re.UP)),[new vi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new vi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)]),new vi([new S(3,0),new S(3,1),new S(3,2),new S(3,3),new S(3,4)])]),new G3(new Vc(new S(3,6),y.of(Re.UP)),[new vi([new S(6,0),new S(6,1),new S(6,2),new S(6,3)])],[new vi([new S(1,2),new S(2,2),new S(3,2),new S(4,2),new S(5,2)]),new vi([new S(0,5),new S(1,5),new S(2,5),new S(3,5),new S(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function e0t(n,e){if(1&n&&(V(),X(0,"circle",13)),2&n){const t=C().$implicit,r=C();w("ngClass",r.getPieceClass(t)),z("cx",r.getCenterAt(t).x)("cy",r.getCenterAt(t).y)("r",r.SPACE_SIZE)}}function t0t(n,e){if(1&n){const t=Oe();V(),O(0,"g",10),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i))}),X(1,"polygon",11),x(2,e0t,1,4,"circle",12),A()}if(2&n){const t=e.$implicit,r=C();ke("id","click_",t.x,"_",t.y,""),T(1),ke("id","space_",t.x,"_",t.y,""),w("ngClass",r.getSpaceClass(t)),z("points",r.getHexaPointsAt(t)),T(1),w("ngIf",r.isPiece(t))}}function n0t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",16),J("click",function(){const i=he(t).$implicit;return ce(C(2).onClick(i))}),A()}if(2&n){const t=e.$implicit;z("points",C(2).getHexaPointsAt(t))}}function r0t(n,e){if(1&n&&(V(),O(0,"g",14),x(1,n0t,1,1,"polygon",15),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t.capturedSpaces)}}function s0t(n,e){if(1&n){const t=Oe();V(),O(0,"line",17),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.destination))}),A()}if(2&n){const t=e.$implicit;z("x1",t.x1)("y1",t.y1)("x2",t.x2)("y2",t.y2)}}function i0t(n,e){if(1&n&&(V(),O(0,"g"),X(1,"circle",18),A()),2&n){const t=e.$implicit,r=C().$implicit,s=C();T(1),ke("id","piece_",r.value,"_",t,""),w("ngClass",s.getPlayerClass(r)),z("cx",s.getRemainingPieceCx(r,t))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function o0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,i0t,2,6,"g",8),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngForOf",r.getPlayerSidePieces(t))}}function a0t(n,e){if(1&n&&(V(),X(0,"line",19)),2&n){const t=C();z("x1",t.inserted.get().x1)("y1",t.inserted.get().y1)("x2",t.inserted.get().x2)("y2",t.inserted.get().y2)}}let c0t=(()=>{class n extends d9{constructor(t){super(t),this.inserted=y.empty(),this.arrows=[],this.captured=[],this.moved=[],this.hexagonWidth=this.SPACE_SIZE,this.sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5,this.boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2,this.boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=y.empty(),this.placementEntrance=y.empty(),this.finalCaptures=[],this.hasAsymmetricBoard=!0,this.scores=y.of([0,0]),this.rules=On.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new L_(this.rules,"GipfMinimax")],this.encoder=G3.encoder,this.tutorial=(new e4e).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new p9(1.5*this.SPACE_SIZE,new S(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),ws.INSTANCE)}updateBoard(){this.cancelMoveAttempt()}showLastMove(t){if(this.inserted=y.empty(),t.placement.direction.isPresent()){const r=t.placement;this.inserted=y.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(t,r){const s=t.getNext(r.getOpposite()),i=this.getCenterAt(t),o=this.getCenterAt(s);return new J3e(s,t,o.x,o.y,i.x,i.y)}markCapture(t){t.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(t){const r=this.constructedState.getNumberOfPiecesToPlace(t),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(t){return this.getPiece(t)!==Ie.EMPTY}getPiece(t){return this.constructedState.getPieceAt(t)}onClick(t){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+t.x+"_"+t.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(t);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(t);default:return pe.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(t)}})()}selectCapture(t){var r=this;return I(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(t)&&s.push(o)}),s.length>1)return r.cancelMove(Bc.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove(Bc.MISSING_CAPTURES());const i=s[0];return r.constructedState=On.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=On.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():R.SUCCESS):(pe.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):R.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,R.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=On.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,R.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var t=this;return I(function*(){return t.possibleCaptures=On.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):(t.movePhase=n.PHASE_FINAL_CAPTURE,R.SUCCESS)})()}computeArrows(t){this.arrows=[];for(const r of On.getAllDirectionsForEntrance(this.constructedState,t))if(!1===On.isLineComplete(this.constructedState,t,r)){const s=t.getNext(r),i=this.getCenterAt(t),o=this.getCenterAt(s);this.arrows.push(new J3e(t,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(t){var r=this;return I(function*(){const s=r.rules.placementCoordValidity(r.constructedState,t);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(t)?(r.cancelMoveAttempt(),R.SUCCESS):(r.placementEntrance=y.of(t),r.constructedState.getPieceAt(t)===Ie.EMPTY?r.selectPlacementDirection(y.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(t),0===r.arrows.length&&r.cancelMove(Bc.NO_DIRECTIONS_AVAILABLE()),R.SUCCESS))})()}selectPlacementDirection(t){var r=this;return I(function*(){r.placement=y.of(new Vc(r.placementEntrance.get(),t));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=On.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(t){var r=this;return I(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(t)||1!==s.getDistance(t))return r.selectPlacementCoord(t);const i=Re.factory.fromMove(s,t);return r.selectPlacementDirection(i.toOptional())})()}tryMove(t,r,s){const i=new G3(r,t,s);return this.chooseMove(i)}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const t=this.node.move;if(t.isPresent()){const r=t.get(),s=this.getPreviousState();r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=y.empty(),this.placement=y.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(t){return this.captured.some(r=>r.equals(t))?"captured-fill":this.moved.some(r=>r.equals(t))?"moved-fill":""}getPieceClass(t){const r=this.getPiece(t);return this.getPlayerClass(B.of(r.value))}getRemainingPieceCy(t){return t===B.ONE?25:this.boardHeight-25}getRemainingPieceCx(t,r){const s=20+r*this.SPACE_SIZE*.5;return t===B.ONE?s:this.boardWidth-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A(),O(4,"marker",3),X(5,"polygon",4),A()(),x(6,t0t,3,7,"g",5),x(7,r0t,2,1,"g",6),x(8,s0t,1,4,"line",7),x(9,o0t,2,1,"g",8),x(10,a0t,1,4,"line",9),A()),2&t&&(z("viewBox",-r.STROKE_WIDTH+" 0 "+r.boardWidth+" "+r.boardHeight)("transform",r.rotation),T(6),w("ngForOf",r.getAllCoords()),T(1),w("ngForOf",r.possibleCaptures),T(1),w("ngForOf",r.arrows),T(1),w("ngForOf",r.Player.PLAYERS),T(1),w("ngIf",r.inserted.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class pr extends us{static of(e){return new pr(e.x,e.y)}toString(){return this===pr.PASS?"GoMove.PASS":this===pr.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}pr.PASS=new pr(-1,0),pr.ACCEPT=new pr(-2,0),pr.encoder=us.getEncoder(pr.of);class Ge{constructor(e,t){this.player=e,this.type=t}equals(e){return e===this}toString(){switch(this){case Ge.DARK:return"GoPiece.DARK";case Ge.LIGHT:return"GoPiece.LIGHT";case Ge.EMPTY:return"GoPiece.EMPTY";case Ge.DEAD_DARK:return"GoPiece.DEAD_DARK";case Ge.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case Ge.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return qe(this===Ge.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(e,t){return t===e.player&&"territory"!==e.type}static ofPlayer(e){return e===B.ZERO?Ge.DARK:Ge.LIGHT}isOccupied(){return[Ge.DARK,Ge.LIGHT,Ge.DEAD_DARK,Ge.DEAD_LIGHT].includes(this)}isEmpty(){return[Ge.DARK_TERRITORY,Ge.LIGHT_TERRITORY,Ge.EMPTY].includes(this)}isDead(){return[Ge.DEAD_DARK,Ge.DEAD_LIGHT].includes(this)}isTerritory(){return[Ge.DARK_TERRITORY,Ge.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return qe(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),Ge.EMPTY}}Ge.DARK=new Ge(B.ZERO,"alive"),Ge.LIGHT=new Ge(B.ONE,"alive"),Ge.EMPTY=new Ge(le.NONE,"empty"),Ge.DEAD_DARK=new Ge(B.ZERO,"dead"),Ge.DEAD_LIGHT=new Ge(B.ONE,"dead"),Ge.DARK_TERRITORY=new Ge(le.NONE,"territory"),Ge.LIGHT_TERRITORY=new Ge(le.NONE,"territory");var Fn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(Fn||(Fn={})),Fn))();let hs=(()=>{class n extends br{constructor(t,r,s,i,o){super(t,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const t=n.getStartingBoard();return new n(t,[0,0],0,y.empty(),Fn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Je.createTable(n.WIDTH,n.HEIGHT,Ge.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(t){return this.getPieceAt(t).isDead()}isTerritory(t){return this.getPieceAt(t).isTerritory()}}return n.WIDTH=19,n.HEIGHT=19,n})();const ut=Ge.LIGHT,rt=Ge.DARK,MF=Ge.DEAD_LIGHT,E9=Ge.LIGHT_TERRITORY,$c=Ge.DARK_TERRITORY,Ce=Ge.EMPTY;class t4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,hs.getInitialState()),ee.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new hs([[Ce,rt,Ce,Ce,ut,ut],[Ce,rt,Ce,Ce,ut,Ce],[Ce,rt,rt,ut,ut,Ce],[Ce,Ce,rt,ut,Ce,Ce],[Ce,Ce,rt,ut,Ce,Ce],[Ce,Ce,rt,ut,Ce,Ce]],[0,0],0,y.empty(),Fn.PLAYING)),ee.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new hs([[Ce,Ce,Ce,Ce,Ce],[Ce,Ce,rt,Ce,Ce],[Ce,rt,ut,Ce,Ce],[Ce,Ce,rt,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,y.empty(),Fn.PLAYING),[new pr(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),ee.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new hs([[Ce,rt,Ce,Ce,Ce],[rt,ut,Ce,Ce,Ce],[rt,ut,ut,rt,Ce],[Ce,rt,rt,Ce,Ce],[Ce,Ce,Ce,Ce,Ce]],[0,0],0,y.empty(),Fn.PLAYING),[new pr(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),ee.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new hs([[Ce,rt,Ce,Ce,Ce],[rt,Ce,Ce,Ce,Ce],[rt,Ce,Ce,Ce,ut],[ut,rt,Ce,ut,Ce],[Ce,ut,Ce,ut,rt]],[0,0],0,y.empty(),Fn.PLAYING)),ee.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new hs([[Ce,Ce,Ce,Ce,Ce],[rt,rt,rt,Ce,Ce],[ut,ut,rt,Ce,Ce],[Ce,ut,rt,Ce,Ce],[ut,ut,rt,Ce,Ce]],[0,0],0,y.empty(),Fn.PLAYING)),ee.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new hs([[Ce,rt,ut,Ce,Ce],[ut,rt,ut,Ce,Ce],[rt,rt,ut,Ce,Ce],[ut,rt,ut,Ce,Ce],[Ce,rt,ut,Ce,Ce]],[0,0],0,y.empty(),Fn.PLAYING)),ee.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new hs([[Ce,ut,rt,Ce,ut,rt,Ce],[Ce,ut,rt,rt,ut,rt,Ce],[Ce,ut,rt,rt,ut,rt,Ce],[Ce,ut,rt,rt,ut,rt,Ce],[Ce,ut,rt,ut,ut,rt,Ce],[Ce,ut,rt,ut,ut,rt,Ce],[Ce,ut,rt,Ce,ut,rt,Ce]],[0,0],0,y.empty(),Fn.PLAYING)),ee.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new hs([[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,rt,ut,Ce,Ce],[Ce,Ce,rt,ut,Ce,ut,Ce],[Ce,Ce,Ce,rt,ut,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce],[Ce,Ce,Ce,Ce,Ce,Ce,Ce]],[0,0],0,y.empty(),Fn.PLAYING),[new pr(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),ee.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new hs([[ut,rt,rt,rt,rt,rt,$c,$c,$c],[ut,ut,ut,ut,rt,rt,rt,$c,$c],[ut,E9,ut,ut,rt,MF,MF,rt,$c],[rt,ut,ut,ut,ut,rt,$c,$c,$c],[Ce,ut,E9,ut,rt,rt,MF,rt,$c],[ut,E9,ut,ut,rt,rt,rt,rt,rt],[ut,ut,rt,rt,rt,ut,ut,rt,ut],[rt,rt,rt,ut,ut,ut,E9,ut,ut],[$c,$c,rt,rt,rt,ut,ut,E9,E9]],[0,0],0,y.empty(),Fn.COUNTING),[new pr(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}let SF=class{getGroupDatas(e,t){const s=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,s)}_getGroupDatas(e,t,r){const s=t[e.y][e.x];if(r.addPawn(e,s),s===r.color)for(const i of this.getDirections()){const o=e.getNext(i);o.isInRange(t[0].length,t.length)&&(r.contains(o)||(r=this._getGroupDatas(o,t,r)))}return r}};SF=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],SF);class M9{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(r=>r.equals(e))}static insertAsEntryPoint(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}class f0t extends M9{constructor(e,t,r,s,i,o){super(e),this.emptyCoords=t,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===Ge.DARK?this.darkCoords:this.color===Ge.LIGHT?this.lightCoords:this.color===Ge.DEAD_DARK?this.deadDarkCoords:this.color===Ge.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(e))}addPawn(e,t){switch(qe(!1===this.contains(e),"This group already contains "+e.toString()),t){case Ge.DARK:this.darkCoords=M9.insertAsEntryPoint(this.darkCoords,e);break;case Ge.LIGHT:this.lightCoords=M9.insertAsEntryPoint(this.lightCoords,e);break;case Ge.DEAD_DARK:this.deadDarkCoords=M9.insertAsEntryPoint(this.deadDarkCoords,e);break;case Ge.DEAD_LIGHT:this.deadLightCoords=M9.insertAsEntryPoint(this.deadLightCoords,e);break;default:pe.expectToBeMultiple(t,[Ge.EMPTY,Ge.DARK_TERRITORY,Ge.LIGHT_TERRITORY]),this.emptyCoords=M9.insertAsEntryPoint(this.emptyCoords,e)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const e=new Wn;e.set(Ge.EMPTY,this.emptyCoords.length),e.set(Ge.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(Ge.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);const t=e.filter((r,s)=>s>0);if(1===t.size())return t.getAnyPair().get().key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const e=[];return this.color!==Ge.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==Ge.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==Ge.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==Ge.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==Ge.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}class R_ extends SF{getNewInstance(e){return new f0t(e,[],[],[],[],[])}getDirections(){return Fe.ORTHOGONALS}}let D_=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})();var t1;let Q4=t1=class extends N1{constructor(){super(hs)}static get(){return t1.singleton.isAbsent()&&(t1.singleton=y.of(new t1)),t1.singleton.get()}static isLegal(e,t){if(t1.isPass(e)){const r=t.phase===Fn.PLAYING,s=t.phase===Fn.PASSED;return We.display("GoRules","isLegal","at "+t.phase+(r||s?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),r||s?_e.success([]):_e.failure(D_.CANNOT_PASS_AFTER_PASSED_PHASE())}if(t1.isAccept(e)){const s=t.phase===Fn.ACCEPT;return t.phase===Fn.COUNTING||s?_e.success([]):_e.failure(D_.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return t1.isOccupied(e.coord,t.getCopiedBoard())?(We.display("GoRules","isLegal","move is marking"),t1.isLegalDeadMarking(e,t)?_e.success([]):_e.failure(D_.OCCUPIED_INTERSECTION())):(We.display("GoRules","isLegal","move is normal stuff: "+e.toString()),t1.isLegalNormalMove(e,t))}static getNewKo(e,t,r){if(1===r.length){const s=r[0],i=e.coord,o=t[i.y][i.x],u=(new R_).getGroupDatas(i,t),h=u.emptyCoords,g=Ge.pieceBelongTo(o,B.ZERO)?u.darkCoords:u.lightCoords;if(1===h.length&&h[0].equals(s)&&1===g.length)return y.of(s)}return y.empty()}static markTerritoryAndCount(e){const t=e.getCopiedBoard(),r=t1.getTerritoryLikeGroup(e),s=e.getCapturedCopy();for(const i of r){const o=i.getWrapper();if(o===Ge.LIGHT){s[1]+=i.emptyCoords.length;for(const c of i.getCoords())t[c.y][c.x]=Ge.LIGHT_TERRITORY}else{qe(o===Ge.DARK,"territory should be wrapped by dark or light, not by "+o.toString()),s[0]+=i.emptyCoords.length;for(const c of i.getCoords())t[c.y][c.x]=Ge.DARK_TERRITORY}}return new hs(t,s,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const t=e.getCopiedBoard(),r=e.getCapturedCopy();let s;for(let i=0;i<e.board.length;i++)for(let o=0;o<e.board[0].length;o++)s=t[i][o],s===Ge.DARK_TERRITORY?(t[i][o]=Ge.EMPTY,r[0]=r[0]-1):s===Ge.LIGHT_TERRITORY&&(t[i][o]=Ge.EMPTY,r[1]=r[1]-1);return new hs(t,r,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return t1.getGroupsDatasWhere(e.getCopiedBoard(),t=>t.isEmpty())}static getGroupsDatasWhere(e,t){const r=[];let s,i,o;const c=new R_;for(let u=0;u<e.length;u++)for(let h=0;h<e[0].length;h++)s=new S(h,u),o=e[u][h],t(o)&&(r.some(g=>g.selfContains(s))||(i=c.getGroupDatas(s,e),r.push(i)));return r}static addDeadToScore(e){const t=e.getCapturedCopy();let i,r=t[1],s=t[0];for(let o=0;o<e.board.length;o++)for(let c=0;c<e.board[0].length;c++)i=e.getPieceAtXY(c,o),i===Ge.DEAD_DARK?r++:i===Ge.DEAD_LIGHT&&s++;return[s,r]}static switchAliveness(e,t){const r=t.getCopiedBoard();qe(r[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const o=(new R_).getGroupDatas(e,r),c=t.getCapturedCopy();switch(o.color){case Ge.DEAD_DARK:c[1]-=2*o.deadDarkCoords.length;for(const u of o.deadDarkCoords)r[u.y][u.x]=Ge.DARK;break;case Ge.DEAD_LIGHT:c[0]-=2*o.deadLightCoords.length;for(const u of o.deadLightCoords)r[u.y][u.x]=Ge.LIGHT;break;case Ge.LIGHT:c[0]+=2*o.lightCoords.length;for(const u of o.lightCoords)r[u.y][u.x]=Ge.DEAD_LIGHT;break;default:pe.expectToBe(o.color,Ge.DARK),c[1]+=2*o.darkCoords.length;for(const u of o.darkCoords)r[u.y][u.x]=Ge.DEAD_DARK}return new hs(r,c,t.turn,t.koCoord,t.phase)}static getGameStatus(e){const t=e.gameState;return t.phase===Fn.FINISHED?t.captured[0]>t.captured[1]?Ne.ZERO_WON:t.captured[1]>t.captured[0]?Ne.ONE_WON:Ne.DRAW:Ne.ONGOING}static isPass(e){return e.equals(pr.PASS)}static isAccept(e){return e.equals(pr.ACCEPT)}static isLegalDeadMarking(e,t){return t1.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===Fn.COUNTING||t.phase===Fn.ACCEPT)}static isLegalNormalMove(e,t){const r=t.getCopiedBoard();if(t1.isKo(e,t))return _e.failure(D_.ILLEGAL_KO());[Fn.COUNTING,Fn.ACCEPT].includes(t.phase)&&(t=t1.resurrectStones(t));const s=t1.getCaptureState(e,t);if(r4e.isCapturing(s))return _e.success(s.capturedCoords);{r[e.coord.y][e.coord.x]=t.turn%2==0?Ge.DARK:Ge.LIGHT;const c=0===(new R_).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=Ge.EMPTY,c?_e.failure(D_.CANNOT_COMMIT_SUICIDE()):_e.success([])}}static isOccupied(e,t){return t[e.y][e.x].isOccupied()}static isKo(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}static getCaptureState(e,t){const r=new r4e;let s;for(const i of Fe.ORTHOGONALS)s=t1.getCapturedInDirection(e.coord,i,t),s.length>0&&r.capturedCoords.every(o=>!s[0].equals(o))&&(r.capturedCoords=r.capturedCoords.concat(s));return r}static getCapturedInDirection(e,t,r){const s=r.getCopiedBoard(),i=e.getNext(t);if(i.isInRange(r.board[0].length,r.board.length)&&s[i.y][i.x]===(r.turn%2==0?Ge.LIGHT:Ge.DARK)){We.display("GoRules","getCapturedInDirection","a group could be captured");const u=(new R_).getGroupDatas(i,s);if(t1.isCapturableGroup(u,r.koCoord))return We.display("GoRules","getCapturedInDirection",{neightbooringGroupCoord:u.getCoords(),message:"is capturable"}),u.getCoords()}return[]}static isCapturableGroup(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return t1.getEmptyZones(e).filter(r=>r.isMonoWrapped())}static applyPass(e){const t=e.getCopiedBoard(),r=e.getCapturedCopy(),s=e.turn;let i,o;return e.phase===Fn.PASSED?(i=Fn.COUNTING,o=new hs(t,r,s+1,y.empty(),i),o=t1.markTerritoryAndCount(o)):(qe(e.phase===Fn.PLAYING,"Cannot pass in counting phase!"),i=Fn.PASSED,o=new hs(t,r,s+1,y.empty(),i)),o}static applyLegalAccept(e){const t=e.getCopiedBoard();let r;return r=e.phase===Fn.COUNTING?Fn.ACCEPT:Fn.FINISHED,new hs(t,e.getCapturedCopy(),e.turn+1,y.empty(),r)}static applyNormalLegalMove(e,t,r){let s;s=[Fn.COUNTING,Fn.ACCEPT].includes(t.phase)?t1.resurrectStones(t):t.copy();const i=e.coord.x,o=e.coord.y,c=s.getCopiedBoard(),u=s.turn,h=Ge.ofPlayer(s.getCurrentPlayer()),g=u+1;c[o][i]=h;for(const b of r)c[b.y][b.x]=Ge.EMPTY;const m=t1.getNewKo(e,c,r),M=s.getCapturedCopy();return M[h.player.value]+=r.length,new hs(c,M,g,m,Fn.PLAYING)}static resurrectStones(e){for(let t=0;t<e.board.length;t++)for(let r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=t1.switchAliveness(new S(r,t),e));return t1.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,t){const r=t1.removeAndSubstractTerritory(t),s=t1.switchAliveness(e.coord,r),i=new hs(s.getCopiedBoard(),s.getCapturedCopy(),s.turn+1,y.empty(),Fn.COUNTING);return t1.markTerritoryAndCount(i)}isLegal(e,t){return t1.isLegal(e,t)}applyLegalMove(e,t,r){return t1.isPass(e)?(We.display("GoRules","applyLegalMove","isPass"),t1.applyPass(t)):t1.isAccept(e)?(We.display("GoRules","applyLegalMove","isAccept"),t1.applyLegalAccept(t)):t1.isLegalDeadMarking(e,t)?(We.display("GoRules","applyLegalMove","isDeadMarking"),t1.applyDeadMarkingMove(e,t)):(We.display("GoRules","applyLegalMove","else it is normal move"),t1.applyNormalLegalMove(e,t,r))}getGameStatus(e){return t1.getGameStatus(e)}};Q4.singleton=y.empty(),Q4=t1=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],Q4);class r4e{constructor(){this.capturedCoords=[]}static isCapturing(e){return e.capturedCoords.length>0}}let PF=class extends bs{getListMoves(e){const t=e.gameState,r=this.getPlayingMovesList(t);if(t.phase===Fn.PLAYING||t.phase===Fn.PASSED)return r.push(pr.PASS),r;{const s=this.getCountingMovesList(t);return 0===s.length?[pr.ACCEPT]:s}}getPlayingMovesList(e){const t=[];let r;for(let s=0;s<e.board.length;s++)for(let i=0;i<e.board[0].length;i++)r=new pr(i,s),e.getPieceAt(r.coord)===Ge.EMPTY&&Q4.isLegal(r,e).isSuccess()&&t.push(r);return t}getCountingMovesList(e){const t=[],r=this.getCorrectBoard(e).getCopiedBoard(),s=Q4.getGroupsDatasWhere(r,i=>i!==Ge.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(e.getPieceAt(o)!==c){const h=new pr(o.x,o.y);return t.push(h),t}}return t}getCorrectBoard(e){const r=this.mapBoard(e.getCopiedBoard(),o=>o===Ge.DARK?Ge.DEAD_DARK:o===Ge.LIGHT?Ge.DEAD_LIGHT:o.isTerritory()?Ge.EMPTY:o),s=new hs(r,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),i=Q4.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(e,t){const r=[];for(let s=0;s<e.length;s++){r[s]=[];for(let i=0;i<e[0].length;i++)r[s][i]=t(e[s][i])}return r}setAliveUniqueWrapper(e,t){let s,r=e.copy();for(const i of t){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=Q4.switchAliveness(o,r))}return r}getMetrics(e){const t=Q4.markTerritoryAndCount(e.gameState),r=t.getCapturedCopy(),s=this.getDeadStones(t);return[r[0]+2*s[1],r[1]+2*s[0]]}getDeadStones(e){const t=[0,0];for(let r=0;r<e.board.length;r++)for(let s=0;s<e.board[0].length;s++){const i=e.getPieceAtXY(s,r);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}};function g0t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",8),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),A(),O(2,"line",9),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),A(),O(3,"line",9),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),A()()}if(2&n){const t=e.index,r=C().index,s=C();T(1),ke("id","click_",t,"_",r,""),z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*t)("y",.5*s.SPACE_SIZE*r),T(1),z("x1",.5*s.SPACE_SIZE*t)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function m0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,g0t,4,14,"g",3),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function _0t(n,e){if(1&n){const t=Oe();V(),O(0,"circle",10),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const t=e.$implicit,r=C();ke("id","hoshi_",t.x,"_",t.y,""),z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*t.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*t.y)("r",.1*r.SPACE_SIZE)}}function v0t(n,e){if(1&n&&(V(),X(0,"circle",16)),2&n){const t=C(2).index,r=C().index,s=C();z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function C0t(n,e){if(1&n){const t=Oe();V(),O(0,"line",17),J("click",function(){he(t);const s=C(2).index,i=C().index;return ce(C().onClick(s,i))}),A()}if(2&n){const t=C(2).index,r=C().index,s=C();z("x1",.5*s.SPACE_SIZE*t)("y1",.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)}}function y0t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"circle",13),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().onClick(s,i))}),A(),x(2,v0t,1,3,"circle",14),x(3,C0t,1,4,"line",15),A()}if(2&n){const t=C().index,r=C().index,s=C();T(1),w("ngClass",s.getSpaceClass(t,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE),T(1),w("ngIf",s.isLastSpace(t,r)),T(1),w("ngIf",s.isDead(t,r))}}function E0t(n,e){if(1&n){const t=Oe();V(),O(0,"circle",19),J("click",function(){he(t);const s=C(2).index,i=C().index;return ce(C().onClick(s,i))}),A()}if(2&n){const t=C(2),r=t.index,s=t.$implicit,i=C().index,o=C();z("cx",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*r)("cy",.25*o.SPACE_SIZE+.5*o.SPACE_SIZE*i)("r",.1*o.SPACE_SIZE)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function M0t(n,e){if(1&n&&(V(),x(0,E0t,1,4,"circle",18)),2&n){const t=C().index,r=C().index;w("ngIf",C().isTerritory(t,r))}}function S0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,y0t,4,6,"g",11),x(2,M0t,1,1,"ng-template",null,12,Un),A()),2&n){const t=e.index,r=Hn(3),s=C().index,i=C();T(1),w("ngIf",i.spaceIsFull(t,s))("ngIfElse",r)}}function P0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,S0t,4,2,"g",3),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function T0t(n,e){if(1&n&&(V(),X(0,"rect",20)),2&n){const t=C();z("width",.25*t.SPACE_SIZE)("height",.25*t.SPACE_SIZE)("x",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().x)("y",.125*t.SPACE_SIZE+.5*t.SPACE_SIZE*t.ko.get().y)}}function w0t(n,e){if(1&n){const t=Oe();V(),O(0,"circle",21),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const t=e.$implicit,r=C();z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*t.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*t.y)("r",.07*r.SPACE_SIZE)}}PF=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],PF);let s7=class extends vF{constructor(e){super(e),this.ko=y.empty(),this.last=y.empty(),this.captures=[],this.GoPiece=Ge,this.boardHeight=hs.HEIGHT,this.boardWidth=hs.WIDTH,this.scores=y.of([0,0]),this.rules=Q4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new PF(this.rules,"GoMinimax")],this.encoder=pr.encoder,this.tutorial=(new t4e).tutorial,this.canPass=!0,this.boardHeight=this.getState().board.length,this.boardWidth=this.getState().board[0].length,this.updateBoard()}onClick(e,t){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+e+"_"+t);if(s.isFailure())return r.cancelMove(s.getReason());r.last=y.empty();const i=new pr(e,t);return r.chooseMove(i)})()}updateBoard(){const e=this.getState(),t=this.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=y.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(s=>s.coord),this.canPass=r!==Fn.FINISHED,this.createHoshis()}showCaptures(){const e=this.getPreviousState();this.captures=[];for(let t=0;t<this.board.length;t++)for(let r=0;r<this.board[0].length;r++){const s=new S(r,t),i=e.getPieceAt(s).isOccupied(),o=this.board[t][r]===Ge.EMPTY,c=!1===this.ko.equalsValue(s);i&&o&&c&&this.captures.push(s)}}pass(){var e=this;return I(function*(){const t=e.getState().phase;return t===Fn.PLAYING||t===Fn.PASSED?e.onClick(pr.PASS.coord.x,pr.PASS.coord.y):(qe(t===Fn.COUNTING||t===Fn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(pr.ACCEPT.coord.x,pr.ACCEPT.coord.y))})()}getSpaceClass(e,t){const r=this.getState().getPieceAtXY(e,t);return this.getPlayerClass(r.getOwner())}spaceIsFull(e,t){return this.getState().getPieceAtXY(e,t)!==Ge.EMPTY&&!this.isTerritory(e,t)}isLastSpace(e,t){if(this.last.isPresent()){const r=this.last.get();return e===r.x&&t===r.y}return!1}isDead(e,t){return this.getState().isDead(new S(e,t))}isTerritory(e,t){return this.getState().isTerritory(new S(e,t))}};s7.\u0275fac=function(e){return new(e||s7)(Q(_n))},s7.\u0275cmp=ct({type:s7,selectors:[["app-go"]],features:[l],decls:9,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],["id","blank_board"],[4,"ngFor","ngForOf"],["class","base-no-stroke",3,"id","click",4,"ngFor","ngForOf"],["id","piece_ko_territory_markers_and_dead_stones"],["class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],["fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[1,"base-no-stroke",3,"id","click"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],[1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,t){1&e&&(V(),O(0,"svg",0),X(1,"rect",1),O(2,"g",2),x(3,m0t,2,1,"g",3),x(4,_0t,1,5,"circle",4),A(),O(5,"g",5),x(6,P0t,2,1,"g",3),A(),x(7,T0t,1,4,"rect",6),x(8,w0t,1,3,"circle",7),A()),2&e&&(z("viewBox","0 -3 "+t.boardWidth*t.SPACE_SIZE*.5+" "+(6+t.boardHeight*t.SPACE_SIZE*.5)),T(1),z("width",t.boardWidth*t.SPACE_SIZE*.5)("height",t.boardHeight*t.SPACE_SIZE*.5),T(2),w("ngForOf",t.board),T(1),w("ngForOf",t.hoshis),T(2),w("ngForOf",t.board),T(1),w("ngIf",t.ko.isPresent()),T(1),w("ngForOf",t.captures))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),s7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],s7);class k6{constructor(e,t,r,s){this.left=e,this.up=t,this.width=r,this.height=s}static fromLimits(e,t,r,s){return new k6(e,r,t-e,s-r)}static fromHexa(e,t,r){const s=e.flatMap(g=>t.getHexaPointsListAt(g)),i=k6.getLimits(s);return new k6(i.minX-r/2,i.minY-r/2,r+i.maxX-i.minX,r+i.maxY-i.minY)}static getLimits(e){let t=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of e)s=Math.min(s,o.x),i=Math.min(i,o.y),t=Math.max(t,o.x),r=Math.max(r,o.y);return{minX:s,minY:i,maxX:t,maxY:r}}center(){return new S(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(e,t,r,s){return new k6(this.left-e,this.up-r,this.width+e+t,this.height+r+s)}containingAtLeast(e){const t=Math.min(this.left,e.left),r=Math.max(this.right(),e.right()),s=Math.min(this.up,e.up),i=Math.max(this.bottom(),e.bottom());return k6.fromLimits(t,r,s,i)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}let Yr=(()=>{class n{}return n.CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.",n.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`,n.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`,n.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`,n.GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`,n.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`,n.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`,n.SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`,n.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`,n.THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`,n.CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`,n.MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`,n.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`,n.CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`,n.MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`,n.MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`,n})();const O0t=Ye.fromFunctions(n=>n,n=>n);class js{constructor(e,t){this.owner=e,this.kind=t}toString(){return`${this.kind}_${this.owner.toString()}`}equals(e){return this.owner===e.owner&&this.kind===e.kind}}js.encoder=Ye.tuple([B.encoder,O0t],n=>[n.owner,n.kind],n=>new js(n[0],n[1]));class J4{constructor(e){this.pieces=e}equals(e){return this.size()===e.size()&&Je.compareArray(this.pieces,e.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(e){return new J4([e,...this.pieces])}topPiece(){return pe.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const e=[...this.pieces];return e.shift(),new J4(e)}size(){return this.pieces.length}}J4.EMPTY=new J4([]);class Gc extends us{constructor(e,t,r){super(t,r),this.piece=e}static of(e,t){return new Gc(e,t.x,t.y)}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(e){return e instanceof Gc&&this.piece.equals(e.piece)&&this.coord.equals(e.coord)}}Gc.encoder=Ye.tuple([js.encoder,S.encoder],n=>[n.piece,n.coord],n=>new Gc(n[0],n[1].x,n[1].y));class ro extends kc{constructor(e,t){super(e,t)}static from(e,t){return e.equals(t)?_e.failure(Xe.MOVE_CANNOT_BE_STATIC()):_e.success(new ro(e,t))}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(e){return!(e instanceof U3)&&e instanceof ro&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}ro.encoder=_a.getFallibleEncoder(ro.from);class U3 extends ro{constructor(e){super(e[0],e[3]),this.coords=e}static ofCoords(e){return new U3(e)}toString(){return`HiveMoveSpider(${this.coords.map(t=>t.toString()).join(", ")})`}equals(e){return e instanceof U3&&this.getStart().equals(e.getStart())&&this.getEnd().equals(e.getEnd())}}U3.encoder=Ye.tuple([S.encoder,S.encoder,S.encoder,S.encoder],n=>n.coords,n=>new U3(n));class i7 extends eo{toString(){return"HiveMovePass"}equals(e){return e instanceof i7}}function A0t(n){return n instanceof Gc}function N0t(n){return n instanceof U3}function I0t(n){return n instanceof ro}function x0t(n){return n instanceof i7}var Ci;i7.encoder=Ye.constant("HiveMovePass",new i7),function(n){n.PASS=new i7,n.drop=function e(s,i){return Gc.of(s,i)},n.move=function t(s,i){return ro.from(s,i)},n.spiderMove=function r(s){return U3.ofCoords(s)},n.encoder=Ye.disjunction([A0t,N0t,I0t,x0t],[Gc.encoder,U3.encoder,ro.encoder,i7.encoder])}(Ci||(Ci={}));class Uc{static of(e){return Uc.INSTANCES.isAbsent()&&(Uc.INSTANCES=y.of({QueenBee:lT.get(),Beetle:uT.get(),Grasshopper:fT.get(),Spider:z_.get(),SoldierAnt:hT.get()})),Uc.INSTANCES.get()[e.kind]}checkEmptyDestination(e,t){return t.getAt(e.getEnd()).hasPieces()?R.failure(Yr.THIS_PIECE_CANNOT_CLIMB()):R.SUCCESS}canSlideBetweenNeighbors(e,t,r){const s=new Ot(mi.getNeighbors(t)),i=new Ot(mi.getNeighbors(r)),o=s.intersection(i);for(const c of o)if(e.getAt(c).isEmpty())return!0;return!1}}Uc.INSTANCES=y.empty();class lT extends Uc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new lT)),this.INSTANCE.get()}moveValidity(e,t){return!1===mi.areNeighbors(e.getStart(),e.getEnd())?R.failure(Yr.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(t,e.getStart(),e.getEnd())?R.failure(Yr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const r=[];for(const s of mi.getNeighbors(e))t.getAt(s).isEmpty()&&r.push(ro.from(e,s).get());return r}}lT.INSTANCE=y.empty();class uT extends Uc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new uT)),this.INSTANCE.get()}moveValidity(e,t){return!1===mi.areNeighbors(e.getStart(),e.getEnd())?R.failure(Yr.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):R.SUCCESS}getPotentialMoves(e,t){const r=[];for(const s of mi.getNeighbors(e))r.push(ro.from(e,s).get());return r}}uT.INSTANCE=y.empty();class fT extends Uc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new fT)),this.INSTANCE.get()}moveValidity(e,t){if(Re.factory.fromMove(e.getStart(),e.getEnd()).isFailure())return R.failure(Yr.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const s=e.getStart().getCoordsToward(e.getEnd());if(0===s.length)return R.failure(Yr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const i of s)if(t.getAt(i).isEmpty())return R.failure(Yr.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const r=[];for(const s of Re.factory.all){const i=e.getNext(s);if(t.getAt(i).hasPieces()){let o=i;for(;t.getAt(o).hasPieces();)o=o.getNext(s);r.push(ro.from(e,o).get())}}return r}}fT.INSTANCE=y.empty();class z_ extends Uc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new z_)),this.INSTANCE.get()}prefixLegality(e,t){const r=new Ot,s=t.update().setAt(e[0],J4.EMPTY).increaseTurnAndFinalizeUpdate();for(let i=1;i<e.length;i++){if(s.getAt(e[i]).hasPieces())return R.failure(Yr.THIS_PIECE_CANNOT_CLIMB());if(!1===mi.areNeighbors(e[i-1],e[i]))return R.failure(Yr.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===s.haveCommonNeighbor(e[i],e[i-1]))return R.failure(Yr.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(s,e[i-1],e[i]))return R.failure(Yr.MUST_BE_ABLE_TO_SLIDE());if(r.contains(e[i]))return R.failure(Yr.SPIDER_CANNOT_BACKTRACK());r.add(e[i])}return R.SUCCESS}moveValidity(e,t){pe.assert(e instanceof U3,"HiveSpiderRules: move should be a spider move");const s=this.prefixLegality(e.coords,t);return s.isFailure()?s:this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const r=t.update().setAt(e,J4.EMPTY).increaseTurnAndFinalizeUpdate();let s=[[e]];for(let c=0;c<3;c++)s=s.flatMap(u=>this.nextMoveStep(r,u));return new Ot(s.map(function i(c){return U3.ofCoords(c)})).toList()}nextMoveStep(e,t){const r=t[t.length-1];return new Ot(mi.getNeighbors(r)).filter(function s(o){return!e.getAt(o).hasPieces()&&void 0===t.find(c=>o.equals(c))&&e.haveCommonNeighbor(o,r)}).toList().map(o=>[...t,o])}}z_.INSTANCE=y.empty();class hT extends Uc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=y.of(new hT)),this.INSTANCE.get()}pathExists(e,t,r){const s=new Ot,i=[t];for(;i.length>0;){const o=i.pop();if(!s.contains(o)){if(s.add(o),o.equals(r))return!0;for(const c of mi.getNeighbors(o)){const u=e.getAt(c).isEmpty(),h=e.getOccupiedNeighbors(c).size()>0,g=this.canSlideBetweenNeighbors(e,o,c);u&&h&&g&&i.push(c)}}}return!1}moveValidity(e,t){return!1===this.pathExists(t,e.getStart(),e.getEnd())?R.failure(Yr.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(e,t)}getPotentialMoves(e,t){const r=new Ot;for(const s of t.occupiedSpaces())if(!s.equals(e))for(const i of t.emptyNeighbors(s))r.add(ro.from(e,i).get());return r.toList()}}hT.INSTANCE=y.empty();class s4e extends JP{constructor(e,t){super(t),this.pieces=e;const r=this.computeScale();this.width=r.width,this.height=r.height,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const i of this.pieces.listKeys())e=Math.min(i.x,e),t=Math.max(i.x,t),r=Math.min(i.y,r),s=Math.max(i.y,s);return{width:t+1-e,height:s+1-r}}isOnBoard(e){return this.pieces.containsKey(e)}getOccupiedNeighbors(e){return new Ot(mi.getNeighbors(e)).filter(r=>this.pieces.get(r).isPresent())}getGroups(){const e=new Ot,t=new Ot;return this.pieces.forEach(r=>{if(!1===e.contains(r.key)){const s=new Ot,i=new Ot([r.key]);for(;i.hasElements();){const o=i.getAnyElement().get();i.remove(o),e.add(o),s.add(o),i.addAll(this.getOccupiedNeighbors(o).filter(c=>!1===e.contains(c)))}t.add(s)}}),t}}class dT{constructor(e){this.pieces=e}static getInitial(){const e=new Wn;for(const t of B.PLAYERS)e.set(new js(t,"QueenBee"),1),e.set(new js(t,"Beetle"),2),e.set(new js(t,"Spider"),2),e.set(new js(t,"Grasshopper"),3),e.set(new js(t,"SoldierAnt"),3);return e.makeImmutable(),new dT(e)}equals(e){return this.pieces.equals(e.pieces)}getQuantity(e){return this.pieces.get(e).get()}hasRemaining(e){return this.getQuantity(e)>0}getAny(e){for(const t of this.pieces.listKeys())if(t.owner===e&&this.hasRemaining(t))return y.of(t);return y.empty()}remove(e){const t=this.pieces.get(e).get();pe.assert(t>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const r=this.pieces.getCopy();return r.replace(e,t-1),new dT(r)}toListOfStacks(){const e=[];return this.pieces.forEach(t=>{const r=[];for(let s=0;s<t.value;s++)r.push(t.key);e.push(new J4(r))}),e}getPlayerPieces(e){const t=[];return this.pieces.forEach(r=>{r.key.owner===e&&r.value>0&&t.push(r.key)}),t}}class H_{constructor(e,t,r,s){this.pieces=e,this.remainingPieces=t,this.queenBees=r,this.turn=s}static of(e){return new H_(e.pieces,e.remainingPieces,e.queenBees,e.turn)}setAt(e,t){const r=this.queenBees.getCopy();for(const i of B.PLAYERS)r.get(i).equalsValue(e)&&r.delete(i);for(const i of t.pieces)"QueenBee"===i.kind&&r.put(i.owner,e);const s=this.pieces.getCopy();return t.isEmpty()?s.delete(e):s.put(e,t),new H_(s,this.remainingPieces,r,this.turn)}removeRemainingPiece(e){return new H_(this.pieces,this.remainingPieces.remove(e),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new L2(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class L2 extends s4e{constructor(e,t,r,s){super(e,s),this.remainingPieces=t,this.queenBees=r,this.queenBees=r.getCopy();for(const i of r.listKeys()){const o=r.get(i).get();this.queenBees.replace(i,o)}this.queenBees.makeImmutable()}static getInitialState(){return L2.fromRepresentation([],0)}static fromRepresentation(e,t,r=new Bt(0,0)){const s=new w_;let i=dT.getInitial();const o=new Wn;for(let c=0;c<e.length;c++)for(let u=0;u<e[0].length;u++)if(e[c][u].length>0){const h=new S(u,c).getNext(r,1);s.set(h,new J4(e[c][u]));const g=y.ofNullable(e[c][u].find(m=>"QueenBee"===m.kind));g.isPresent()&&o.set(g.get().owner,h);for(const m of e[c][u])i=i.remove(m)}return new L2(s,i,o,t)}update(){return H_.of(this)}equals(e){return this.pieces.equals(e.pieces)&&this.remainingPieces.equals(e.remainingPieces)&&this.queenBees.equals(e.queenBees)&&this.turn===e.turn}getAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():J4.EMPTY}queenBeeLocation(e){return this.queenBees.get(e)}hasQueenBeeOnBoard(e){return this.queenBeeLocation(e).isPresent()}numberOfNeighbors(e){let t=0;for(const r of mi.getNeighbors(e))this.getAt(r).hasPieces()&&(t+=1);return t}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(e){const t=[];for(const r of mi.getNeighbors(e))this.getAt(r).isEmpty()&&t.push(r);return t}haveCommonNeighbor(e,t){const r=this.getOccupiedNeighbors(e),s=this.getOccupiedNeighbors(t);return r.findAnyCommonElement(s).isPresent()}}class Yi extends N1{constructor(){super(L2)}static get(){return Yi.singleton.isAbsent()&&(Yi.singleton=y.of(new Yi)),Yi.singleton.get()}applyLegalMove(e,t,r){return e instanceof Gc?this.applyLegalDrop(e,t):e instanceof ro?this.applyLegalMoveCoordToCoord(e,t):t.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(e,t){const r=t.getAt(e.coord);return t.update().setAt(e.coord,r.add(e.piece)).removeRemainingPiece(e.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(e,t){const r=t.getAt(e.getStart()),s=t.getAt(e.getEnd());return t.update().setAt(e.getStart(),r.removeTopPiece()).setAt(e.getEnd(),s.add(r.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(e,t){return e instanceof Gc?this.isLegalDrop(e,t):e instanceof ro?this.isLegalMoveCoordToCoord(e,t):this.shouldPass(t)?R.SUCCESS:R.failure(Xe.CANNOT_PASS())}isLegalMoveCoordToCoord(e,t){if(!1===t.queenBeeLocation(t.getCurrentPlayer()).isPresent())return R.failure(Yr.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const r=t.getAt(e.getStart());if(r.isEmpty())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());const s=r.topPiece();if(s.owner===t.getCurrentOpponent())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());const i=Uc.of(s).moveValidity(e,t);if(i.isFailure())return i;const o=t.update().setAt(e.getStart(),r.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return R.failure(Yr.CANNOT_DISCONNECT_HIVE());const c=e.getEnd();return 0===o.numberOfNeighbors(c)?R.failure(Yr.CANNOT_DISCONNECT_HIVE()):R.SUCCESS}mustPlaceQueenBee(e){return e.turn>=6&&!1===e.hasQueenBeeOnBoard(e.getCurrentPlayer())}isLegalDrop(e,t){const r=t.getCurrentPlayer();if(e.piece.owner===r.getOpponent())return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.remainingPieces.hasRemaining(e.piece))return R.failure(Yr.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==e.piece.kind&&this.mustPlaceQueenBee(t))return R.failure(Yr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const s=this.checkNeighborValidity(e,t);return s.isFailure()?s:t.getAt(e.coord).hasPieces()?R.failure(Yr.MUST_DROP_ON_EMPTY_SPACE()):R.SUCCESS}checkNeighborValidity(e,t){const r=t.getCurrentPlayer();let s=!1;for(const i of mi.getNeighbors(e.coord)){const o=t.getAt(i);if(o.hasPieces()&&(s=!0,1!==t.turn&&o.topPiece().owner===r.getOpponent()))return R.failure(Yr.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==t.turn&&!1===s?R.failure(Yr.MUST_BE_CONNECTED_TO_HIVE()):R.SUCCESS}getPossibleDropLocations(e){const t=e.getCurrentPlayer();if(0===e.turn)return new Ot([new S(0,0)]);if(1===e.turn)return new Ot(mi.getNeighbors(new S(0,0)));const r=e.remainingPieces.getAny(t);if(r.isAbsent())return new Ot;const s=r.get(),i=new Ot;for(const o of e.occupiedSpaces())if(e.getAt(o).topPiece().owner===t)for(const c of e.emptyNeighbors(o)){const u=Gc.of(s,c);this.isLegalDrop(u,e).isSuccess()&&i.add(c)}return i}getPossibleMovesFrom(e,t){const r=e.getCurrentPlayer(),s=new Ot,i=e.getAt(t).topPiece();if(i.owner===r)for(const o of Uc.of(i).getPotentialMoves(t,e))this.isLegalMoveCoordToCoord(o,e).isSuccess()&&s.add(o);return s}getPossibleMovesOnBoard(e){const t=new Ot;for(const r of e.occupiedSpaces())t.addAll(this.getPossibleMovesFrom(e,r));return t}shouldPass(e){return 0===this.getPossibleDropLocations(e).size()&&0===this.getPossibleMovesOnBoard(e).size()}getGameStatus(e){const t=e.gameState,r=[0,0];for(const s of B.PLAYERS){const i=t.queenBeeLocation(s);i.isPresent()&&(r[s.value]=t.numberOfNeighbors(i.get()))}return 6===r[0]&&6===r[1]?Ne.DRAW:6===r[0]?Ne.getVictory(B.ONE):6===r[1]?Ne.getVictory(B.ZERO):Ne.ONGOING}}Yi.singleton=y.empty();class k0t extends bs{getListMoves(e){const t=this.getListDrops(e.gameState),r=this.getListOfOnBoardMoves(e.gameState),s=t.concat(r);return 0===s.length?[Ci.PASS]:s}getListOfOnBoardMoves(e){return Yi.get().getPossibleMovesOnBoard(e).toList()}getListDrops(e){const t=[],r=e.getCurrentPlayer(),s=new js(r,"QueenBee");for(const i of Yi.get().getPossibleDropLocations(e))if(Yi.get().mustPlaceQueenBee(e))t.push(Ci.drop(s,i));else for(const o of e.remainingPieces.getPlayerPieces(e.getCurrentPlayer()))t.push(Ci.drop(o,i));return t}getMetrics(e){return[this.queenBeeMobility(e.gameState,B.ZERO),this.queenBeeMobility(e.gameState,B.ONE)]}queenBeeMobility(e,t){const r=e.queenBeeLocation(t);return r.isPresent()?Yi.get().getPossibleMovesFrom(e,r.get()).size():0}}const el=new js(B.ZERO,"QueenBee"),o7=new js(B.ZERO,"Beetle"),S9=new js(B.ZERO,"Grasshopper"),pT=new js(B.ZERO,"Spider"),gT=new js(B.ZERO,"SoldierAnt"),a7=new js(B.ONE,"QueenBee"),nc=new js(B.ONE,"Beetle"),TF=new js(B.ONE,"Grasshopper"),wF=new js(B.ONE,"Spider"),V_=new js(B.ONE,"SoldierAnt");class i4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,L2.fromRepresentation([[[a7],[nc],[wF],[S9]],[[S9],[],[gT],[]],[[gT],[],[],[]]],8)),ee.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,L2.fromRepresentation([[[],[nc],[pT]],[[V_],[a7],[el]],[[S9],[o7],[]]],7)),ee.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,L2.getInitialState(),Ci.drop(o7,new S(0,0)),$localize`Congratulations!`),ee.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,L2.fromRepresentation([[[nc],[S9]]],2),Ci.drop(el,new S(2,0)),$localize`Congratulations!`),ee.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,L2.fromRepresentation([[[],[pT],[TF],[a7],[nc]],[[nc],[el],[o7],[],[]]],4),[Ci.move(new S(1,1),new S(0,2)).get(),Ci.move(new S(1,1),new S(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,L2.fromRepresentation([[[el],[a7],[o7]],[[nc],[],[]]],6),[Ci.move(new S(2,0),new S(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,L2.fromRepresentation([[[nc,el],[a7],[o7]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,L2.fromRepresentation([[[S9],[el],[nc],[V_]],[[TF],[],[],[]]],6),[Ci.move(new S(0,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,L2.fromRepresentation([[[],[gT],[a7]],[[],[el],[nc]],[[V_],[wF],[]]],6),Ci.move(new S(1,0),new S(3,1)).get(),(e,t,r)=>e.equals(Ci.move(new S(1,0),new S(0,1)).get())?R.failure($localize`You have not freed your queen, try again!`):R.SUCCESS,$localize`Congratulations!`),ee.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,L2.fromRepresentation([[[],[pT],[wF],[nc]],[[],[],[],[o7]],[[nc],[],[],[V_]],[[gT],[],[S9],[]],[[el],[TF],[],[]]],6),Ci.spiderMove([new S(1,0),new S(1,1),new S(2,1),new S(2,2)]),$localize`Congratulations!`),ee.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,L2.fromRepresentation([[[],[pT],[]],[[],[el],[nc]],[[V_],[],[]]],6)),ee.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,L2.fromRepresentation([[[nc,o7],[el],[a7]]],4))]}}const L0t=["app-hive-piece",""];function R0t(n,e){1&n&&(V(),X(0,"path",9))}function D0t(n,e){1&n&&(V(),X(0,"path",10))}function z0t(n,e){1&n&&(V(),X(0,"path",11))}function H0t(n,e){1&n&&(V(),X(0,"path",12))}function V0t(n,e){1&n&&(V(),X(0,"path",13))}let F0t=(()=>{class n extends x3e{constructor(){super(...arguments),this.hexaPoints="",this.pieceClass="",this.isoPointsLight="",this.isoPointsDark="",this.isoPointsStroke="",this.layerTransform="",this.hexaCenter=new S(0,0)}ngAfterContentChecked(){const t=new S(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(t),this.hexaCenter=this.hexaLayout.getCenterAt(t);const s=this.hexaLayout.getIsoPoints(t,this.pieceHeight).map(i=>i.map(o=>o.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[l],attrs:L0t,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(t,r){1&t&&(V(),O(0,"g"),X(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),O(5,"g"),x(6,R0t,1,0,"path",4),x(7,D0t,1,0,"path",5),x(8,z0t,1,0,"path",6),x(9,H0t,1,0,"path",7),x(10,V0t,1,0,"path",8),A()()),2&t&&(z("transform",r.layerTransform),T(1),w("ngClass",r.pieceClass),z("points",r.isoPointsLight),T(1),w("ngClass",r.pieceClass),z("points",r.isoPointsDark),T(1),z("points",r.isoPointsStroke),T(1),w("ngClass",r.pieceClass),z("points",r.hexaPoints),T(1),z("transform","translate("+r.hexaCenter.x+" "+r.hexaCenter.y+")"),T(1),w("ngIf","QueenBee"===r.piece.kind),T(1),w("ngIf","Beetle"===r.piece.kind),T(1),w("ngIf","Grasshopper"===r.piece.kind),T(1),w("ngIf","Spider"===r.piece.kind),T(1),w("ngIf","SoldierAnt"===r.piece.kind))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function B0t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"polygon",4),J("click",function(){const i=he(t).$implicit;return ce(C().selectSpace(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C();T(1),ke("id","space_",t.x,"_",t.y,""),w("ngClass",t.content.spaceClasses),z("points",r.getHexaPointsAtXY(t.x,t.y))}}function $0t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",6),J("click",function(){he(t);const s=C().$implicit;return ce(C().selectSpace(s.x,s.y))}),A()}if(2&n){const t=C().$implicit,r=C();ke("id","stroke_",t.x,"_",t.y,""),w("ngClass",t.content.strokeClasses),z("points",r.getHexaPointsAtXY(t.x,t.y))}}function G0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,$0t,1,4,"polygon",5),A()),2&n){const t=e.$implicit;T(1),w("ngIf",t.content.strokeClasses.length>0)}}function U0t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",8),J("click",function(){he(t);const s=C().$implicit;return ce(C().selectSpace(s.x,s.y))}),A()}if(2&n){const t=C().$implicit,r=C();ke("id","stroke_",t.x,"_",t.y,""),z("points",r.getHexaPointsAtXY(t.x,t.y))}}function q0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,U0t,1,3,"polygon",7),A()),2&n){const t=e.$implicit;T(1),w("ngIf",t.content.selected)}}function W0t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"g",9),J("click",function(){const i=he(t).$implicit;return ce(C(2).selectStack(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C().index,s=C();T(1),ke("id","piece_",t.x,"_",t.y,""),w("piece",t.content.piece)("x",t.x)("y",t.y)("pieceHeight",s.PIECE_HEIGHT)("hexaLayout",s.hexaLayout)("layer",r)}}function j0t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",6),J("click",function(){he(t);const s=C().$implicit;return ce(C(2).selectStack(s.x,s.y))}),A()}if(2&n){const t=C().$implicit,r=C().index,s=C();ke("id","stroke_",t.x,"_",t.y,""),w("ngClass",t.content.strokeClasses),z("transform","translate(0 "+-(r+1)*s.PIECE_HEIGHT+")")("points",s.getHexaPointsAtXY(t.x,t.y))}}function Z0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,j0t,1,5,"polygon",5),A()),2&n){const t=e.$implicit;T(1),w("ngIf",t.content.strokeClasses.length>0)}}function Y0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,W0t,2,8,"g",1),x(2,Z0t,2,1,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t),T(1),w("ngForOf",t)}}function K0t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"g",10),J("click",function(){const i=he(t).$implicit;return ce(C(2).selectRemaining(i))}),A()()}if(2&n){const t=e.$implicit,r=e.index,s=C(2);T(1),h1("id","remainingPiece_",t.toString(),""),w("piece",t)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("layer",r)("hexaLayout",s.hexaLayout),z("transform",s.getRemainingPieceTransform(t))}}function X0t(n,e){if(1&n&&(V(),O(0,"g"),x(1,K0t,2,8,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t.pieces)}}function Q0t(n,e){if(1&n&&(V(),X(0,"polygon",11)),2&n){const t=C();z("transform",t.getRemainingPieceHighlightTransform(t.selectedRemaining.get()))("points",t.getHexaPointsAt(t.ORIGIN))}}function J0t(n,e){if(1&n&&(V(),X(0,"g",13)),2&n){const t=e.$implicit,r=e.index,s=C(2);h1("id","inspectedStack_",r,""),w("piece",t)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",s.hexaLayout)("layer",6*r),z("transform",s.inspectedStackTransform)}}function e8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,J0t,1,8,"g",12),A()),2&n){const t=C();T(1),w("ngForOf",t.inspectedStack.get().pieces.slice().reverse())}}class o4e extends N3e{constructor(){super(...arguments),this.highlighted=[]}initialize(e){this.set(e,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(e,t){this.highlighted.push(e),this.get(e).map(r=>r.spaceClasses.push(t))}highlightStroke(e,t){this.highlighted.push(e),this.get(e).map(r=>r.strokeClasses.push(t))}select(e){this.highlighted.push(e),this.get(e).map(t=>t.selected=!0)}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[],t.spaceClasses=[],t.selected=!1});this.highlighted=[]}}class t8t extends N3e{constructor(){super(...arguments),this.highlighted=[]}initialize(e,t){this.set(e,{piece:t,strokeClasses:[]})}highlight(e,t){this.highlighted.push(e),this.get(e).map(r=>r.strokeClasses.push(t))}clearHighlights(){for(const e of this.highlighted)this.get(e).map(t=>{t.strokeClasses=[]});this.highlighted=[]}}let n8t=(()=>{class n extends d9{constructor(t){super(t),this.ORIGIN=new S(0,0),this.remainingStacks=[],this.layers=[],this.ground=new o4e,this.inspectedStack=y.empty(),this.inspectedStackCoord=y.empty(),this.selectedRemaining=y.empty(),this.selectedStart=y.empty(),this.selectedSpiderCoords=[],this.rules=Yi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new k0t(this.rules,"HiveMinimax")],this.encoder=Ci.encoder,this.tutorial=(new i4e).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new p9(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),ws.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const r of this.getState().occupiedSpaces()){const s=this.getState().getAt(r),i=r.x,o=r.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new t8t);const u=s.pieces[s.size()-1-c];this.layers[c].initialize(new S(i,o),u)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=Yi.get().shouldPass(this.getState());const t=Yi.get().getGameStatus(this.node);switch(t){case Ne.ONGOING:break;case Ne.DRAW:this.highlight(this.getState().queenBeeLocation(B.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(B.ONE).get(),"victory-stroke");break;default:const s=t.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}}highlight(t,r){const s=this.getState().getAt(t).size();s-1 in this.layers&&this.layers[s-1].highlight(t,r)}pass(){var t=this;return I(function*(){return pe.assert(t.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield t.chooseMove(Ci.PASS)})()}computeViewBox(){const t=this.getPieceCoords().union(this.getAllNeighbors()).toList();t.push(new S(0,0)),this.boardViewBox=k6.fromHexa(t,this.hexaLayout,this.STROKE_WIDTH);const r=new k6(this.getRemainingPieceTransformAsCoord(new js(B.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let i=0;this.getState().remainingPieces.getAny(B.ZERO).isPresent()&&(i=s);let o=0;this.getState().remainingPieces.getAny(B.ONE).isPresent()&&(o=s);const c=this.boardViewBox.containingAtLeast(r).expand(0,0,i,o);if(this.inspectedStack.isPresent()){const u=new S(c.right()+this.SPACE_SIZE,c.center().y),h=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${u.x} ${u.y+3*(h-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const t=new o4e;for(const r of this.getAllNeighbors())t.initialize(r);return t}getAllNeighbors(){const t=new Ot;for(const r of this.getPieceCoords())t.addAll(new Ot(this.getState().emptyNeighbors(r)));return t.isEmpty()&&t.add(new S(0,0)),t}clearHighlights(){for(const t of this.layers)t.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=y.empty(),this.selectedRemaining=y.empty(),this.selectedSpiderCoords=[],this.inspectedStack=y.empty(),this.computeViewBox()}showLastMove(t){for(const r of this.getLastMoveCoords(t))this.highlight(r,"last-move-stroke"),this.ground.highlightStroke(r,"last-move-stroke"),this.ground.highlightFill(r,"moved-fill")}getLastMoveCoords(t){let r=[];return t instanceof Gc?r=[t.coord]:t instanceof ro&&(r=[t.getStart(),t.getEnd()]),r}getRemainingPieceTransformAsCoord(t){const r=this.getRemainingPieceShift(t),s=this.boardViewBox.center().x+r*this.SPACE_SIZE*4;let i;return i=t.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new S(s,i)}getRemainingPieceTransform(t){const r=this.getRemainingPieceTransformAsCoord(t);return`translate(${r.x} ${r.y})`}getRemainingPieceHighlightTransform(t){const r=this.getRemainingPieceTransformAsCoord(t),s=this.getState().remainingPieces.getQuantity(t);return`translate(${r.x} ${r.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(t){switch(t.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return pe.expectToBe(t.kind,"SoldierAnt"),1.5}}selectRemaining(t){var r=this;return I(function*(){const s=r.canUserPlay(`#remainingPiece_${t.toString()}`);if(s.isFailure())return r.cancelMove(s.getReason());if(t.owner===r.getCurrentPlayer().getOpponent())return r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==t.kind&&Yi.get().mustPlaceQueenBee(r.getState()))return r.cancelMove(Yr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(r.selectedRemaining.equalsValue(t))r.cancelMoveAttempt();else{r.cancelMoveAttempt(),r.selectedRemaining=y.of(t),r.clearHighlights();const i=Yi.get().getPossibleDropLocations(r.getState()).toList();for(const o of i)r.ground.highlightStroke(o,"clickable-stroke")}return R.SUCCESS})()}selectStack(t,r){return this.select(new S(t,r),"piece")}selectSpace(t,r){return this.select(new S(t,r),"space")}select(t,r){var s=this;return I(function*(){const i=s.canUserPlay(`#${r}_${t.x}_${t.y}`);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState(),c=o.getAt(t);if(s.selectedRemaining.isPresent()){const u=Ci.drop(s.selectedRemaining.get(),t);return s.chooseMove(u)}if(s.selectedStart.isPresent()){const u=o.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(t)?s.cancelMove():s.selectTarget(t,u)}return 0===c.size()?s.cancelMove():s.selectStart(t,c)})()}selectTarget(t,r){var s=this;return I(function*(){if("Spider"===r.kind)return s.selectNextSpiderSpace(t);{const i=Ci.move(s.selectedStart.get(),t);return qe(i.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(i.get())}})()}selectStart(t,r){var s=this;return I(function*(){const i=s.getState(),o=r.topPiece();return o.owner===i.getCurrentPlayer().getOpponent()?1===r.size()?s.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),R.SUCCESS):(s.highlight(t,"selected-stroke"),s.inspectedStack=y.of(r),s.inspectedStackCoord=y.of(t),s.computeViewBox(),R.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==o.kind&&Yi.get().mustPlaceQueenBee(i)?s.cancelMove(Yr.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=y.of(t),s.highlight(t,"selected-stroke"),"Spider"===o.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),r.size()>1&&(s.inspectedStack=y.of(r),s.inspectedStackCoord=y.of(t),s.computeViewBox()),s.highlightNextPossibleCoords(t),R.SUCCESS))})()}highlightNextPossibleCoords(t){for(const r of this.getNextPossibleCoords(t))this.highlight(r,"clickable-stroke"),this.ground.highlightStroke(r,"clickable-stroke")}getNextPossibleCoords(t){const r=this.getState(),s=r.getAt(t).topPiece(),i=Yi.get().getPossibleMovesFrom(r,t);return"Spider"===s.kind?i.filter(c=>Je.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():i.map(o=>o.getEnd()).toList()}selectNextSpiderSpace(t){var r=this;return I(function*(){if(r.selectedSpiderCoords.push(t),4===r.selectedSpiderCoords.length){const i=Ci.spiderMove(r.selectedSpiderCoords);return r.chooseMove(i)}const s=z_.get().prefixLegality(r.selectedSpiderCoords,r.getState());if(s.isFailure())return r.cancelMove(s.getReason());r.clearHighlights(),r.highlight(r.selectedStart.get(),"selected-stroke");for(const i of r.selectedSpiderCoords)r.ground.select(i);return r.highlightNextPossibleCoords(r.selectedStart.get()),R.SUCCESS})()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-hive"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,B0t,2,4,"g",1),x(2,G0t,2,1,"g",1),x(3,q0t,2,1,"g",1),x(4,Y0t,3,2,"g",1),x(5,X0t,2,1,"g",1),x(6,Q0t,1,2,"polygon",2),x(7,e8t,2,1,"g",3),A()),2&t&&(z("viewBox",r.viewBox),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.ground),T(1),w("ngForOf",r.layers),T(1),w("ngForOf",r.remainingStacks),T(1),w("ngIf",r.selectedRemaining.isPresent()),T(1),w("ngIf",r.inspectedStack.isPresent()))},dependencies:[hn,En,Kt,F0t],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();const r8t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:B.ZERO};class tl extends dF{static getInitialState(){const e=Tn.UNOCCUPIED,t=Tn.INVADERS,r=Tn.DEFENDERS;return new tl([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,r,e,e,e,e,t],[t,e,e,e,r,r,r,e,e,e,t],[t,t,e,r,r,Tn.PLAYER_ONE_KING,r,r,e,t,t],[t,e,e,e,r,r,r,e,e,e,t],[t,e,e,e,e,r,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}of(e,t){return new tl(e,t)}}class Fo extends hF{static of(e,t){return new Fo(e,t)}static from(e,t){try{const r=new Fo(e,t);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 11}}Fo.encoder=_a.getFallibleEncoder(Fo.from);class R8 extends pF{constructor(){super(tl,r8t,Fo.from)}static get(){return R8.singleton.isAbsent()&&(R8.singleton=y.of(new R8)),R8.singleton.get()}}R8.singleton=y.empty();const H=Tn.UNOCCUPIED,Qt=Tn.INVADERS,Kr=Tn.DEFENDERS,mT=Tn.PLAYER_ONE_KING;class a4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,tl.getInitialState()),ee.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,tl.getInitialState(),Fo.of(new S(5,1),new S(1,1)),$localize`Congratulations!`),ee.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new tl([[H,H,H,H,Qt,Qt,Qt,Qt,H,H,H],[H,H,H,H,H,Qt,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[Qt,H,H,H,H,Kr,H,H,H,H,Qt],[Qt,H,H,Qt,Kr,Kr,Kr,H,H,H,Qt],[Qt,Qt,H,Kr,Kr,mT,Kr,Kr,H,Qt,Qt],[Qt,H,H,H,Kr,Kr,Kr,H,H,H,Qt],[Qt,H,H,H,H,Kr,H,H,H,H,Qt],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,Qt,H,H,H,H,H],[H,H,H,Qt,Qt,Qt,Qt,Qt,H,H,H]],1),[Fo.of(new S(5,3),new S(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(Fo.of(new S(3,0),new S(3,4))),ee.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new tl([[H,H,H,Qt,Qt,Qt,Qt,Qt,H,H,H],[H,Kr,H,H,H,Qt,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,Kr,H,H,H,H,Qt],[Qt,H,H,H,H,Kr,Kr,H,H,H,Qt],[Qt,Qt,mT,H,Kr,H,Kr,Kr,H,H,Qt],[H,H,Qt,H,H,Kr,Kr,H,H,H,Qt],[Qt,H,H,H,H,Kr,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,Qt,H,H,H,H,H,H,H,H,H],[H,H,H,Qt,Qt,Qt,Qt,H,Qt,H,H]],12),[Fo.of(new S(3,0),new S(3,5)),Fo.of(new S(3,10),new S(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ee.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new tl([[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,Qt,H,H,H,H,H,H,H,H,H],[Qt,mT,H,Qt,H,H,H,H,H,H,H],[H,Qt,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H]],72),[Fo.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ee.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new tl([[H,H,Qt,mT,Qt,H,H,H,H,H,H],[H,H,H,H,H,H,Kr,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,Qt,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H],[H,H,H,H,H,H,H,H,H,H,H]],72),[Fo.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function s8t(n,e){1&n&&(V(),X(0,"polygon",8))}function i8t(n,e){1&n&&(V(),X(0,"rect",9))}function o8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,s8t,1,0,"polygon",6),x(2,i8t,1,0,"ng-template",null,7,Un),A()),2&n){const t=Hn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",t)}}function a8t(n,e){if(1&n&&(V(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const t=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function c8t(n,e){if(1&n&&(V(),X(0,"polyline",16)),2&n){const t=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][t])}}function l8t(n,e){if(1&n&&(V(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const t=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function u8t(n,e){if(1&n&&(V(),x(0,c8t,1,1,"polyline",14),x(1,l8t,4,20,"ng-template",null,15,Un)),2&n){const t=Hn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",t)}}function f8t(n,e){if(1&n&&(V(),O(0,"g"),X(1,"circle",10),x(2,a8t,6,25,"g",11),x(3,u8t,3,2,"ng-template",null,12,Un),A()),2&n){const t=Hn(4),r=C().index,s=C().index,i=C();T(1),ke("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",t)}}function h8t(n,e){if(1&n){const t=Oe();V(),O(0,"g",3),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",4),x(2,o8t,4,2,"g",5),x(3,f8t,5,8,"g",5),A()}if(2&n){const t=e.index,r=C().index,s=C();ke("id","click_",t,"_",r,""),z("transform","translate("+s.SPACE_SIZE*t+", "+s.SPACE_SIZE*r+")"),T(1),ke("id","space_",t,"_",r,""),w("ngClass",s.getRectClasses(t,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][t]===s.EMPTY&&s.isThrone(t,r)),T(1),w("ngIf",s.board[r][t]!==s.EMPTY)}}function d8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,h8t,4,10,"g",2),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function p8t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",17),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C();T(1),ke("id","click_",t.x,"_",t.y,""),z("x",r.SPACE_SIZE*t.x)("y",r.SPACE_SIZE*t.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let g8t=(()=>{class n extends gF{constructor(t){super(t,Fo.from),this.rules=R8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new m9(this.rules,"DummyBot"),new iT(this.rules,"Piece > Influence"),new oT(this.rules,"Piece > Control"),new mF(this.rules,"Escape > Piece > Control")],this.encoder=Fo.encoder,this.tutorial=(new a4e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,d8t,2,1,"g",1),x(2,p8t,2,6,"g",1),A()),2&t&&(z("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class bn{constructor(e,t,r){this.value=e,this.name=t,this.rgb=r}static of(e){switch(e){case 0:return bn.ANY;case 1:return bn.ORANGE;case 2:return bn.BLUE;case 3:return bn.PURPLE;case 4:return bn.PINK;case 5:return bn.YELLOW;case 6:return bn.RED;case 7:return bn.GREEN;default:return pe.expectToBe(e,8,"Invalid value "+e+" for KamisadoColor"),bn.BROWN}}}bn.ANY=new bn(0,"any","#000"),bn.ORANGE=new bn(1,"orange","#d67421"),bn.BLUE=new bn(2,"blue","#006bac"),bn.PURPLE=new bn(3,"purple","#6f3787"),bn.PINK=new bn(4,"pink","#d2719e"),bn.YELLOW=new bn(5,"yellow","#e2c200"),bn.RED=new bn(6,"red","#d23339"),bn.GREEN=new bn(7,"green","#009157"),bn.BROWN=new bn(8,"brown","#562500");class Bn{constructor(e,t){this.player=e,this.color=t}static of(e,t){return new Bn(e,bn.of(t))}static createPlayerColors(e){return{ORANGE:new Bn(e,bn.ORANGE),BLUE:new Bn(e,bn.BLUE),PURPLE:new Bn(e,bn.PURPLE),PINK:new Bn(e,bn.PINK),YELLOW:new Bn(e,bn.YELLOW),RED:new Bn(e,bn.RED),GREEN:new Bn(e,bn.GREEN),BROWN:new Bn(e,bn.BROWN)}}equals(e){return e.player===this.player&&e.color===this.color}isEmpty(){return this.player.equals(le.NONE)}belongsTo(e){return this.player===e}}Bn.EMPTY=new Bn(le.NONE,bn.ANY),Bn.ZERO=Bn.createPlayerColors(B.ZERO),Bn.ONE=Bn.createPlayerColors(B.ONE);class yi{static getColorAt(e,t){return yi.COLORS[t][e]}static getInitialBoard(){const e=Bn.EMPTY;return[[1,2,3,4,5,6,7,8].map(t=>Bn.of(B.ONE,t)),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(t=>Bn.of(B.ZERO,t))]}static isEmptyAt(e,t){return e[t.y][t.x].equals(Bn.EMPTY)}static allPieceCoords(e){const t=[];for(let r=0;r<e.length;r++)for(let s=0;s<e[r].length;s++){const i=new S(s,r);yi.isEmptyAt(e,i)||t.push(i)}return t}}yi.INITIAL=yi.getInitialBoard(),yi.SIZE=8,yi.COLORS=Je.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],bn.of);class c7 extends eo{constructor(){super()}length(){return 0}equals(e){return this===e}toString(){return"KamisadoMove(PASS)"}}c7.PASS=new c7,c7.encoder=Ye.constant("PASS",c7.PASS);class l7 extends kc{constructor(e,t){super(e,t)}static of(e,t){return pe.assert(e.isInRange(yi.SIZE,yi.SIZE),"Starting coord of KamisadoMove must be on the board, not at "+e.toString()),pe.assert(t.isInRange(yi.SIZE,yi.SIZE),"End coord of KamisadoMove must be on the board, not at "+t.toString()),new l7(e,t)}equals(e){return e===this||!!Ei.isPiece(e)&&!1!==e.getStart().equals(this.getStart())&&e.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}function m8t(n){return n instanceof c7}var Ei;l7.encoder=_a.getEncoder(l7.of),function(n){n.PASS=c7.PASS,n.of=function e(r,s){return l7.of(r,s)},n.isPiece=function t(r){return r instanceof l7},n.encoder=Ye.disjunction([n.isPiece,m8t],[l7.encoder,c7.encoder])}(Ei||(Ei={}));class nl extends br{constructor(e,t,r,s,i){super(Je.copyBiArray(i),e),this.colorToPlay=t,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new nl(0,bn.ANY,y.empty(),!1,yi.INITIAL)}}let F_=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class Mi extends N1{constructor(){super(nl)}static get(){return Mi.singleton.isAbsent()&&(Mi.singleton=y.of(new Mi)),Mi.singleton.get()}static getColorMatchingPiece(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new S(0,7),new S(1,7),new S(2,7),new S(3,7),new S(4,7),new S(5,7),new S(6,7),new S(7,7)]}static getMovablePieces(e){return Mi.getColorMatchingPiece(e).filter(t=>{for(const r of this.playerDirections(e.getCurrentPlayer())){const s=t.getNext(r);if(e.isOnBoard(s)&&yi.isEmptyAt(e.board,s))return!0}return!1})}static playerDirections(e){return e===B.ONE?[be.DOWN,be.DOWN_LEFT,be.DOWN_RIGHT]:[be.UP,be.UP_LEFT,be.UP_RIGHT]}static directionAllowedForPlayer(e,t){return t===B.ZERO?e.y<0:e.y>0}static getListMovesFromState(e){const t=Mi.getMovablePieces(e);return 0===t.length?(qe(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[Ei.PASS]):Mi.getListMovesFromNonBlockedState(e,t)}static getListMovesFromNonBlockedState(e,t){const r=[],s=e.getCurrentPlayer();for(const i of t)for(const o of Mi.playerDirections(s))for(let c=1;c<yi.SIZE;c++){const u=i.getNext(o,c);if(!e.isOnBoard(u)||!yi.isEmptyAt(e.board,u))break;{const h=Ei.of(i,u);r.push(h)}}return r}static mustPass(e){return 0===this.getMovablePieces(e).length}static getFurthestPiecePositions(e){let t=7,r=0;return yi.allPieceCoords(e.board).forEach(s=>{const i=e.getPieceAt(s);qe(i!==Bn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===B.ONE?r=Math.max(r,s.y):t=Math.min(t,s.y)}),[t,r]}static isLegal(e,t){if(Ei.isPiece(e)){const r=e.getStart(),s=e.getEnd(),i=t.colorToPlay,o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(i!==bn.ANY&&o.color!==i)return R.failure(F_.NOT_RIGHT_COLOR());if(!t.getPieceAt(s).isEmpty())return R.failure(Xe.MUST_CLICK_ON_EMPTY_SPACE());const u=be.factory.fromMove(r,s);if(u.isFailure())return R.failure(F_.DIRECTION_NOT_ALLOWED());const h=u.get();if(!Mi.directionAllowedForPlayer(h,t.getCurrentPlayer()))return R.failure(F_.DIRECTION_NOT_ALLOWED());let g=r;for(;!g.equals(s);)if(g=g.getNext(h),!t.getPieceAt(g).isEmpty())return R.failure(F_.MOVE_BLOCKED());return R.SUCCESS}return this.isLegalPass(t)}static isLegalPass(e){return this.mustPass(e)&&!e.alreadyPassed?R.SUCCESS:R.failure(Xe.CANNOT_PASS())}nextCoordToPlay(e,t){return y.ofNullable(yi.allPieceCoords(e.board).find(r=>{const s=e.getPieceAt(r);return s.player===e.getCurrentOpponent()&&s.color===t}))}applyLegalMove(e,t,r){if(Ei.isPiece(e)){const s=e.getStart(),i=e.getEnd(),o=t.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=Bn.EMPTY;const c=yi.getColorAt(i.x,i.y),u=this.nextCoordToPlay(t,c);return new nl(t.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(t,t.colorToPlay);return new nl(t.turn+1,t.colorToPlay,s,!0,t.board)}}isLegal(e,t){return Mi.isLegal(e,t)}getGameStatus(e){const t=e.gameState,r=t.getCurrentPlayer();if(Mi.mustPass(t)&&t.alreadyPassed)return Ne.getDefeat(r);const[s,i]=Mi.getFurthestPiecePositions(t);return 7===i?Ne.ONE_WON:0===s?Ne.ZERO_WON:Ne.ONGOING}}Mi.singleton=y.empty();class _8t extends bs{getListMoves(e){const t=Mi.getListMovesFromState(e.gameState);return Je.sortByDescending(t,r=>r.length()),t}getMetrics(e){const t=e.gameState,[r,s]=Mi.getFurthestPiecePositions(t);return[7-r,s]}}const oe=Bn.EMPTY,_T=Bn.ZERO.ORANGE,vT=Bn.ONE.ORANGE,CT=Bn.ZERO.BLUE,yT=Bn.ONE.BLUE,bF=Bn.ZERO.PURPLE,B_=Bn.ONE.PURPLE,ET=Bn.ZERO.PINK,MT=Bn.ONE.PINK,ST=Bn.ZERO.YELLOW,PT=Bn.ONE.YELLOW,TT=Bn.ZERO.RED,wT=Bn.ONE.RED,bT=Bn.ZERO.GREEN,OT=Bn.ONE.GREEN,AT=Bn.ZERO.BROWN,NT=Bn.ONE.BROWN;class c4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new nl(5,bn.ORANGE,y.empty(),!1,[[AT,yT,B_,MT,PT,wT,OT,NT],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,vT,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,bT,TT,ST,ET,bF,CT,_T]])).withPreviousMove(Ei.of(new S(0,7),new S(0,0))),ee.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,nl.getInitialState(),Ei.of(new S(7,7),new S(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),ee.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new nl(1,bn.PINK,y.of(new S(3,0)),!1,[[vT,yT,B_,MT,PT,wT,OT,NT],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,CT,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[AT,bT,TT,ST,ET,bF,oe,_T]]),[Ei.of(new S(3,0),new S(3,6)),Ei.of(new S(3,0),new S(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(Ei.of(new S(6,7),new S(6,5))),ee.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new nl(1,bn.PINK,y.of(new S(3,6)),!1,[[vT,yT,B_,oe,PT,wT,OT,NT],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,oe,CT],[oe,oe,oe,oe,oe,oe,oe,oe],[oe,oe,oe,MT,oe,oe,oe,oe],[AT,bT,TT,ST,ET,bF,oe,_T]])).withPreviousMove(Ei.of(new S(6,5),new S(7,4))),ee.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new nl(2,bn.RED,y.of(new S(2,4)),!1,[[oe,yT,B_,oe,oe,wT,oe,oe],[oe,oe,oe,PT,oe,oe,oe,oe],[oe,oe,oe,MT,oe,B_,oe,oe],[oe,oe,oe,ST,oe,oe,oe,oe],[oe,oe,TT,oe,oe,oe,oe,oe],[oe,oe,oe,oe,oe,oe,OT,oe],[vT,oe,oe,oe,oe,ET,oe,NT],[AT,bT,oe,oe,oe,oe,CT,_T]]),[Ei.of(new S(2,4),new S(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(Ei.of(new S(4,0),new S(3,1)))]}}function v8t(n,e){if(1&n&&(V(),X(0,"circle",8)),2&n){const t=C(),r=t.$implicit,s=t.index,i=C().index,o=C();w("ngClass",o.piecePlayerClass(r)),z("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function C8t(n,e){if(1&n&&(V(),X(0,"rect",9)),2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C();z("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function y8t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"g",4),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(2,"rect",5),x(3,v8t,1,4,"circle",6),x(4,C8t,1,7,"rect",7),A()()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","click_",r,"_",s,""),T(1),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),T(1),w("ngIf",t!==i.UNOCCUPIED),T(1),w("ngIf",t!==i.UNOCCUPIED)}}function E8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,y8t,5,9,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function M8t(n,e){if(1&n&&(V(),O(0,"g"),X(1,"rect",10)(2,"rect",10),A()),2&n){const t=C();T(1),ke("id","last_move_start_",t.lastPieceMove.get().getStart().x,"_",t.lastPieceMove.get().getStart().y,""),z("x",t.lastPieceMove.get().getStart().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getStart().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),T(1),ke("id","last_move_start_",t.lastPieceMove.get().getEnd().x,"_",t.lastPieceMove.get().getEnd().y,""),z("x",t.lastPieceMove.get().getEnd().x*t.SPACE_SIZE)("y",t.lastPieceMove.get().getEnd().y*t.SPACE_SIZE)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function S8t(n,e){if(1&n&&(V(),X(0,"circle",11)),2&n){const t=C();z("cx",t.SPACE_SIZE/2+t.chosen.get().x*t.SPACE_SIZE)("cy",t.SPACE_SIZE/2+t.chosen.get().y*t.SPACE_SIZE)("r",t.SPACE_SIZE/2-t.STROKE_WIDTH)}}let P8t=(()=>{class n extends to{constructor(t){super(t),this.UNOCCUPIED=Bn.EMPTY,this.lastMove=y.empty(),this.lastPieceMove=y.empty(),this.chosen=y.empty(),this.chosenAutomatically=!1,this.hasAsymmetricBoard=!0,this.rules=Mi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new _8t(this.rules,"KamisadoMinimax")],this.encoder=Ei.encoder,this.tutorial=(new c4e).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(t,r){return yi.getColorAt(t,r).rgb}isPlayerZero(t){return t.player===B.ZERO}pieceColor(t){return t.color.rgb}piecePlayerClass(t){return this.getPlayerClass(t.player)}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.lastPieceMove=y.empty(),this.canPass=Mi.mustPass(t);const r=this.rules.getGameStatus(this.node)!==Ne.ONGOING;this.canPass||t.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=y.empty()):(this.chosenAutomatically=!0,this.chosen=t.coordToPlay)}showLastMove(t){Ei.isPiece(t)&&(this.lastPieceMove=y.of(t))}pass(){var t=this;return I(function*(){return qe(t.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),t.chooseMove(Ei.PASS)})()}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r);if(s.canPass)return s.cancelMove(Xe.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(t,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;{const c=s.getState().getPieceAtXY(t,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove(F_.PLAY_WITH_SELECTED_PIECE()):(s.chosen=y.of(o),R.SUCCESS):yield s.chooseDestination(t,r)}})()}choosePiece(t,r){const s=this.getState().getPieceAtXY(t,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=y.of(new S(t,r)),R.SUCCESS)}chooseDestination(t,r){var s=this;return I(function*(){const i=s.chosen.get(),o=new S(t,r),c=Ei.of(i,o);return s.chooseMove(c)})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=y.empty())}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke",3,"id"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,E8t,2,1,"g",1),x(2,M8t,3,12,"g",2),x(3,S8t,1,3,"circle",3),A()),2&t&&(z("viewBox",r.getViewBox())("transform",r.rotation),T(1),w("ngForOf",r.board),T(1),w("ngIf",r.lastPieceMove.isPresent()),T(1),w("ngIf",r.chosen.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),l4e=(()=>{class n extends to{getParallelogramCoords(t){const r=t.parallelogramHeight,s=r*t.horizontalWidthRatio,i=r*t.offsetRatio,o=s,u=s-i,h=r,g=-i,m=r;return[new S(0,0),new S(o,0),new S(u,h),new S(g,m)]}getCoordTranslate(t,r,s,i){const o=i.parallelogramHeight;return new S(t*(o*i.horizontalWidthRatio)+i.offsetRatio*o*(i.abstractBoardSize-r),r*o-i.pieceHeightRatio*o*s)}}return n.\u0275fac=function(){let e;return function(r){return(e||(e=yr(n)))(r||n)}}(),n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(t,r){},encapsulation:2}),n})(),L6=(()=>{class n{}return n.CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`,n.CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`,n.CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`,n.MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`,n.THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`,n.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`,n.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`,n.CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`,n})();class Os{constructor(e,t){this.player=e,this.isOfficer=t}static getPlayerOfficer(e){return e===B.ZERO?Os.ZERO_OFFICER:Os.ONE_OFFICER}toString(){switch(this){case Os.ZERO:return"u";case Os.ONE:return"v";case Os.ZERO_OFFICER:return"O";default:return pe.expectToBe(this,Os.ONE_OFFICER),"X"}}equals(e){return this===e}}Os.ZERO=new Os(B.ZERO,!1),Os.ONE=new Os(B.ONE,!1),Os.ZERO_OFFICER=new Os(B.ZERO,!0),Os.ONE_OFFICER=new Os(B.ONE,!0);class Bo{constructor(e){this.pieces=e}isEmpty(){return 0===this.pieces.length}isCommandedBy(e){return!this.isEmpty()&&this.getCommander().player===e}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Bo(this.pieces.slice(1))}capturePiece(e){return new Bo(this.pieces.concat(e))}addStackBelow(e){let t=this;for(const r of e.pieces)t=t.capturePiece(r);return t}getStackSize(){return this.pieces.length}promoteCommander(){let e=this.getCommander();if(e.isOfficer)return this;{e=Os.getPlayerOfficer(e.player);const t=this.getPiecesUnderCommander();return new Bo([e]).addStackBelow(t)}}get(e){return this.pieces[e]}toString(e){let t=e-this.getStackSize(),r="";for(;t>0;)r+="_",t--;for(const s of this.pieces)r+=s.toString();return r}}Bo.EMPTY=new Bo([]);let er=(()=>{class n extends br{static getInitialState(){const t=new Bo([Os.ZERO]),r=new Bo([Os.ONE]),s=Bo.EMPTY;return new n([[r,s,r,s,r,s,r],[s,r,s,r,s,r,s],[r,s,r,s,r,s,r],[s,s,s,s,s,s,s],[t,s,t,s,t,s,t],[s,t,s,t,s,t,s],[t,s,t,s,t,s,t]],0)}static of(t,r){return new n(t,r)}static isNotOnBoard(t){return t.isNotInRange(n.SIZE,n.SIZE)}static isOnBoard(t){return t.isInRange(n.SIZE,n.SIZE)}getStacksOf(t){const r=[];for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++)this.getPieceAtXY(i,s).isCommandedBy(t)&&r.push(new S(i,s));return r}set(t,r){const s=this.getCopiedBoard();return s[t.y][t.x]=r,new n(s,this.turn)}remove(t){return this.set(t,Bo.EMPTY)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(t){return t===B.ZERO?0:n.SIZE-1}toString(){let t=1;for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++){const o=this.getPieceAtXY(i,s).getStackSize();t=Math.max(t,o)}const r=[];for(let s=0;s<n.SIZE;s++){const i=[];for(let o=0;o<n.SIZE;o++)i.push(this.getPieceAtXY(o,s).toString(t));r.push(i.join(" "))}return r.join("\n")}}return n.SIZE=7,n})();class T8t extends Ot{equals(e){if(e.size()!==this.size())return!1;for(let t=0;t<this.size();t++)if(!1===Ac(e.get(t),this.get(t)))return!1;return!0}get(e){return pe.assert(e<this.values.length,"MGPUniqueList: index out of bounds: "+e),this.values[e]}getFromEnd(e){return pe.assert(e<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+e),this.get(this.values.length-1-e)}}class As extends eo{constructor(e,t){super(),this.isStep=t,this.coords=new T8t(e)}static of(e,t){return new As(e,t)}static fromCapture(e){const t=As.getSteppedOverCoords(e);return t.isSuccess()?_e.success(new As(e,!1)):_e.failure(t.getReason())}static getSteppedOverCoords(e){let t=y.empty();const r=new Ot;for(const s of e){if(er.isNotOnBoard(s))return _e.failure(h9.OUT_OF_RANGE(s));if(t.isPresent()){const i=t.get();if(!1===i.getVectorToward(s).isDiagonalOfLength(2))return _e.failure(L6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const c=i.getCoordsToward(s)[0];if(r.contains(c))return _e.failure(L6.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());r.add(c)}t=y.of(s)}return _e.success(r)}static fromStep(e,t){return er.isNotOnBoard(e)?_e.failure(h9.OUT_OF_RANGE(e)):er.isNotOnBoard(t)?_e.failure(h9.OUT_OF_RANGE(t)):!1===e.getVectorToward(t).isDiagonalOfLength(1)?_e.failure(L6.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):_e.success(new As([e,t],!0))}toString(){return"LascaMove("+this.coords.toList().map(r=>r.toString()).join(", ")+")"}getRelation(e){const t=this.coords.size(),r=e.coords.size(),s=Math.min(t,r);for(let i=0;i<s;i++)if(!1===this.coords.toList()[i].equals(e.coords.toList()[i]))return"INEQUALITY";return t===r?"EQUALITY":"PREFIX"}equals(e){return"EQUALITY"===this.getRelation(e)}isPrefix(e){return"PREFIX"===this.getRelation(e)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return As.getSteppedOverCoords(this.coords.toList())}concatenate(e){const t=this.getEndingCoord(),r=e.coords.toList()[0];qe(t.equals(r),"should not concatenate non-touching move");const s=this.coords.toList(),i=Je.copyImmutableArray(s),o=e.coords.toList(),c=Je.copyImmutableArray(o).slice(1);return As.fromCapture(i.concat(c)).get()}}As.encoder=Ye.tuple([Ye.list(S.encoder),Ye.identity()],n=>[n.coords.toList(),n.isStep],n=>As.of(n[0],n[1]));class $o extends N1{constructor(){super(er)}static get(){return $o.singleton.isAbsent()&&($o.singleton=y.of(new $o)),$o.singleton.get()}getCaptures(e){const t=e.getCurrentPlayer();return this.getCapturesOf(e,t)}getCapturesOf(e,t){const r=[],s=e.getStacksOf(t);for(const i of s)r.push(...this.getPieceCaptures(e,i));return r}getPieceCaptures(e,t){let r=[];const o=e.getPieceAt(t).getCommander().player.getOpponent(),c=this.getPieceDirections(e,t),u=e.getPieceAt(t);for(const h of c){const g=t.getNext(h,1);if(er.isOnBoard(g)&&e.getPieceAt(g).isCommandedBy(o)){const m=g.getNext(h,1);if(er.isOnBoard(m)&&e.getPieceAt(m).isEmpty()){const M=e.remove(t).remove(g).set(m,u),b=As.fromCapture([t,m]).get(),L=this.getPieceCaptures(M,m);if(0===L.length)r=r.concat(b);else{const G=L.map(j=>b.concatenate(j));r=r.concat(G)}}}}return r}getPieceDirections(e,t){const i=e.getPieceAt(t).getCommander().player.getScoreModifier(),o=[be.factory.fromDelta(-1,i).get(),be.factory.fromDelta(1,i).get()];return e.getPieceAt(t).getCommander().isOfficer&&o.push(be.factory.fromDelta(-1,-i).get(),be.factory.fromDelta(1,-i).get()),o}getSteps(e){const t=e.getCurrentPlayer();return this.getStepsOf(e,t)}getStepsOf(e,t){const r=[],s=e.getStacksOf(t);for(const i of s)r.push(...this.getPieceSteps(e,i));return r}getPieceSteps(e,t){const r=[],s=this.getPieceDirections(e,t);for(const i of s){const o=t.getNext(i,1);if(er.isOnBoard(o)&&e.getPieceAt(o).isEmpty()){const c=As.fromStep(t,o).get();r.push(c)}}return r}applyLegalMove(e,t,r){const s=e.getStartingCoord(),i=e.getEndingCoord();let o=t.getPieceAt(s),c=t.remove(s);if(!1===e.isStep)for(const u of e.getCapturedCoords().get()){const h=t.getPieceAt(u),g=h.getCommander();o=o.capturePiece(g);const m=h.getPiecesUnderCommander();c=c.set(u,m)}if(c=c.set(i,o),i.y===t.getFinishLineOf(t.getCurrentPlayer())){const u=o.promoteCommander();c=c.set(i,u)}return c.incrementTurn()}isLegal(e,t){const r=e.getStartingCoord();if(t.getPieceAt(r).isEmpty())return R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const s=t.getPieceAt(r),i=t.getCurrentOpponent();if(s.isCommandedBy(i))return R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());const o=e.coords.get(1);if(!1===s.getCommander().isOfficer&&r.getDirectionToward(o).get().y===i.getScoreModifier())return R.failure(L6.CANNOT_GO_BACKWARD());if(!1===t.getPieceAt(o).isEmpty())return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());const c=this.getCaptures(t);return e.isStep?c.length>0?R.failure(L6.CANNOT_SKIP_CAPTURE()):R.SUCCESS:this.isLegalCapture(e,t,c)}isLegalCapture(e,t,r){const s=t.getCurrentPlayer(),i=e.getCapturedCoords().get();for(const o of i){const c=t.getPieceAt(o);if(c.isCommandedBy(s))return R.failure(Xe.CANNOT_SELF_CAPTURE());if(c.isEmpty())return R.failure(L6.CANNOT_CAPTURE_EMPTY_SPACE())}return r.some(o=>o.equals(e))?R.SUCCESS:R.failure(L6.MUST_FINISH_CAPTURING())}getGameStatus(e){const t=e.gameState;return this.getCaptures(t).length>0||this.getSteps(t).length>0?Ne.ONGOING:Ne.getVictory(t.getCurrentOpponent())}}$o.singleton=y.empty();class $_ extends Xa{constructor(e){super($o.get(),e)}static getListMoves(e){const t=$o.get().getCaptures(e.gameState);return t.length>0?t:$o.get().getSteps(e.gameState)}getListMoves(e){return $_.getListMoves(e)}getBoardValue(e){const t=$o.get().getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const r=e.gameState,s=this.getNumberOfMobileCoords(r,B.ZERO),i=this.getNumberOfMobileCoords(r,B.ONE);return Vn.of(s,i)}getNumberOfMobileCoords(e,t){const s=this.getCapturesAndSteps(e,t).map(o=>o.getStartingCoord());return new Ot(s).size()}getCapturesAndSteps(e,t){const r=$o.get().getCapturesOf(e,t),s=$o.get().getStepsOf(e,t);return r.concat(s)}}class w8t extends $_{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(e){const t=$o.get().getGameStatus(e);if(t.isEndGame)return t.toBoardValue();const r=12*super.getBoardValue(e).value;let s=0;for(let i=0;i<er.SIZE;i++)for(let o=0;o<er.SIZE;o++){const c=e.gameState.getPieceAtXY(o,i);if(c.getStackSize()>0){const u=c.getStackSize();let h=0;const g=c.getCommander().player;for(;h<u&&c.get(h).player===g;)h++;s+=h*g.getScoreModifier()}}return new Vn(r+s)}}const u4e=Os.ZERO,OF=Os.ONE,Ns=new Bo([u4e]),gr=new Bo([OF]),b8t=new Bo([u4e,OF]),O8t=new Bo([Os.ZERO_OFFICER,OF]),re=Bo.EMPTY;class f4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,er.getInitialState()),ee.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,er.getInitialState()),ee.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,er.getInitialState(),As.fromStep(new S(4,4),new S(3,3)).get(),$localize`Congratulations!`),ee.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,er.of([[gr,re,re,re,gr,re,gr],[re,re,re,gr,re,gr,re],[re,re,gr,re,gr,re,gr],[re,gr,re,re,re,re,re],[Ns,re,Ns,re,Ns,re,Ns],[re,Ns,re,Ns,re,Ns,re],[Ns,re,Ns,re,Ns,re,Ns]],2),As.fromCapture([new S(2,4),new S(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),ee.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,er.of([[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[gr,re,re,re,gr,re,gr],[re,gr,re,gr,re,gr,re],[re,re,gr,re,gr,re,gr],[re,gr,re,re,re,re,re],[re,re,Ns,re,Ns,re,Ns]],2),As.fromCapture([new S(2,6),new S(0,4),new S(2,2)]).get(),$localize`Congratulations!`),ee.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,er.of([[re,re,re,re,re,re,re],[re,re,re,re,re,gr,re],[re,re,re,re,re,re,re],[re,gr,re,gr,re,re,re],[re,re,Ns,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re]],2)),ee.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,er.of([[re,re,re,re,re,re,gr],[re,re,re,b8t,re,gr,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ns,re,Ns,re,Ns]],2),[As.fromStep(new S(3,1),new S(2,0)).get(),As.fromStep(new S(3,1),new S(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),ee.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,er.of([[re,re,re,re,O8t,re,gr],[re,re,re,re,re,re,re],[re,re,re,re,gr,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,Ns,re,Ns,re,Ns]],2),[As.fromStep(new S(4,0),new S(3,1)).get(),As.fromStep(new S(4,0),new S(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)]}}function A8t(n,e){if(1&n&&(V(),X(0,"circle",13)),2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C().index,c=C();j2("id","square_",i,"_",o,"_piece_",r,"_officer_symbol"),w("ngClass",s.classes),z("cx",.4*c.SPACE_SIZE)("cy",.575*c.SPACE_SIZE)("r",.045*c.SPACE_SIZE)}}function N8t(n,e){if(1&n&&(V(),O(0,"g",10),X(1,"use",11),x(2,A8t,1,7,"circle",12),A()),2&n){const t=e.$implicit,r=e.index,s=C().index,i=C().index;z("transform",C().getPieceTranslate(r)),T(1),j2("id","square_",s,"_",i,"_piece_",r,""),w("ngClass",t.classes),T(1),w("ngIf",t.isOfficer)}}function I8t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"g",7),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(2,"polygon",8),x(3,N8t,3,6,"g",9),A()()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","coord_",r,"_",s,""),z("transform",i.getTranslate(r,s,0)),T(1),ke("id","square_",r,"_",s,""),w("ngClass",t.squareClasses),z("points",i.getParallelogramPoints()),T(1),w("ngForOf",t.pieceInfos)}}function x8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,I8t,4,8,"g",4),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}let k8t=(()=>{class n extends l4e{constructor(t){super(t),this.THICKNESS=40,this.mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:er.SIZE},this.LEFT=0,this.UP=-this.SPACE_SIZE,this.basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight,this.WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio),this.HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP,this.CX=this.WIDTH/2,this.CY=(this.HEIGHT+this.UP)/2,this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]},this.lastMove=y.empty(),this.currentMoveClicks=[],this.capturedCoords=[],this.legalMoves=[],this.hasAsymmetricBoard=!0,this.rules=$o.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new $_("Lasca Control Minimax"),new w8t],this.encoder=As.encoder,this.tutorial=(new f4e).tutorial,this.canPass=!1,this.updateBoard()}updateBoard(){this.lastMove=this.node.move;const t=this.getState();this.board=t.getCopiedBoard(),this.legalMoves=$_.getListMoves(this.node),this.createAdaptedBoardFrom(t),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}createAdaptedBoardFrom(t){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let i=0;i<er.SIZE;i++){const o=[];for(let c=0;c<er.SIZE;c++){const u=this.getSpaceInfo(t,c,i);o.push(u)}this.adaptedBoard.spaceInfo.push(o)}const s=y.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const i=s.get();for(const o of this.getSpaceInfoAt(i).pieceInfos)o.classes.push("selected-stroke");this.showPossibleLandings(i,t)}for(const i of this.capturedCoords)this.getSpaceInfoAt(i).squareClasses.push("captured-fill");for(const i of this.currentMoveClicks)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}getSpaceInfo(t,r,s){const i=t.getPieceAtXY(r,s),o=[];for(let c=i.getStackSize()-1;c>=0;c--){const u=i.get(c);o.push({classes:[this.getPlayerClass(u.player)],isOfficer:u.isOfficer})}return{pieceInfos:o,squareClasses:[]}}showLastMove(t){this.showLastCapture(t),this.showSteppedOnCoord(t)}showLastCapture(t){if(!1===t.isStep){const r=t.getCapturedCoords();pe.assert(r.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const s of r.get())this.getSpaceInfoAt(s).squareClasses.push("captured-fill")}}showSteppedOnCoord(t){for(const r of t.coords)this.getSpaceInfoAt(r).squareClasses.push("moved-fill")}showPossibleMoves(){for(const t of this.legalMoves){const r=t.getStartingCoord();this.getSpaceInfoAt(r).squareClasses.push("selectable-fill")}}getSpaceInfoAt(t){if(this.role===B.ONE&&this.adaptedBoard.isAlreadySwitched){const r=er.SIZE-1,s=new S(r-t.x,r-t.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[t.y][t.x]}rotateAdaptedBoardIfNeeded(){if(this.role===B.ONE){const t=[];for(let r=0;r<er.SIZE;r++){t[er.SIZE-1-r]=[];for(let s=0;s<er.SIZE;s++)t[er.SIZE-1-r][er.SIZE-1-s]=this.getSpaceInfoAt(new S(s,r))}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:t}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(t,r){var s=this;return I(function*(){s.role===B.ONE&&(t=er.SIZE-1-t,r=er.SIZE-1-r);const i=s.canUserPlay("#coord_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r),c=s.getState().getPieceAt(o),u=s.getState().getCurrentOpponent();return c.isCommandedBy(u)?s.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(o):s.moveClick(o)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showPossibleMoves(),this.rotateAdaptedBoardIfNeeded()}moveClick(t){var r=this;return I(function*(){if(t.equals(r.currentMoveClicks[0]))return r.cancelMoveAttempt(),R.SUCCESS;const s=r.getState().getPieceAt(t),i=r.getState().getCurrentPlayer();if(s.isCommandedBy(i))return r.cancelMoveAttempt(),r.trySelectingPiece(t);if(1===r.currentMoveClicks.length&&r.currentMoveClicks[0].getVectorToward(t).isDiagonalOfLength(1)){const c=As.fromStep(r.currentMoveClicks[0],t).get();return r.chooseMove(c)}return r.capture(t)})()}capture(t){var r=this;return I(function*(){const i=r.currentMoveClicks[r.currentMoveClicks.length-1],o=i.getVectorToward(t);if(o.isDiagonalOfLength(2)){const c=new S(i.x+o.x/2,i.y+o.y/2);r.capturedCoords.push(c),r.currentMoveClicks.push(t);const u=As.fromCapture(r.currentMoveClicks).get();return r.legalMoves.some(h=>h.isPrefix(u))?r.applyPartialCapture():r.chooseMove(u)}return r.cancelMove(L6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let t=this.getState().remove(this.currentMoveClicks[0]),r=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const i of this.capturedCoords){const o=this.getState().getPieceAt(i),c=o.getCommander(),u=o.getPiecesUnderCommander();t=t.set(i,u),r=r.capturePiece(c)}return t=t.set(this.currentMoveClicks[this.currentMoveClicks.length-1],r),this.createAdaptedBoardFrom(t),this.rotateAdaptedBoardIfNeeded(),R.SUCCESS}trySelectingPiece(t){var r=this;return I(function*(){return r.getState().getPieceAt(t).isEmpty()?r.cancelMove(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.selectPiece(t)})()}selectPiece(t){return this.capturedCoords=[],this.legalMoves.some(r=>r.getStartingCoord().equals(t))?(this.currentMoveClicks=[t],this.hideLastMove(),R.SUCCESS):this.cancelMove(L6.THIS_PIECE_CANNOT_MOVE())}showPossibleLandings(t,r){const s=this.rules.getPieceCaptures(r,t);if(0===s.length){const i=this.rules.getPieceSteps(r,t);for(const o of i)this.getSpaceInfoAt(o.getEndingCoord()).squareClasses.push("selectable-fill")}else{const i=s.map(o=>o.coords.get(1));for(const o of i)this.getSpaceInfoAt(o).squareClasses.push("capturable-fill")}}getTranslate(t,r,s){const i=this.getCoordTranslate(t,r,s,this.mode);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(r=>r.x+", "+r.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const t=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(t[0],t[1],t[2],t[3])}getParallelogramCenterOf(t,r,s,i){const o=Math.max(t.x,r.x,s.x,i.x),c=Math.max(t.y,r.y,s.y,i.y),u=Math.min(t.x,r.x,s.x,i.x),h=Math.min(t.y,r.y,s.y,i.y);return new S((o-u)/2,(c-h)/2)}getRightEdge(){const t=this.basicWidth*this.mode.horizontalWidthRatio,r=this.basicWidth*this.mode.offsetRatio;return[r+t,0,r+t,this.THICKNESS,t,this.basicWidth+this.THICKNESS,t,this.basicWidth].join(" ")}getPieceTranslate(t){return"translate(0 "+(this.getParallelogramCenter().y-32.5-t*(.15*this.SPACE_SIZE))+")"}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-lasca"]],features:[l],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),A()(),x(5,x8t,2,1,"g",4),X(6,"rect",5)(7,"polygon",6),A()),2&t&&(z("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),T(5),w("ngForOf",r.adaptedBoard.spaceInfo),T(1),z("y",r.basicWidth)("width",r.basicWidth*r.mode.horizontalWidthRatio)("height",r.THICKNESS),T(1),z("points",r.getRightEdge()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Si=(()=>{class n extends br{static getInitialState(){const t=le.NONE,r=le.ZERO,s=le.ONE;return new n([[t,r,r,r,r,r,r,t],[s,t,t,t,t,t,t,s],[s,t,t,t,t,t,t,s],[s,t,t,t,t,t,t,s],[s,t,t,t,t,t,t,s],[s,t,t,t,t,t,t,s],[s,t,t,t,t,t,t,s],[t,r,r,r,r,r,r,t]],0)}static isOnBoard(t){return t.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class so extends kc{constructor(e,t,r){super(e,t),this.direction=r,this.direction=be.factory.fromMove(e,t).get()}static from(e,t){const r=be.factory.fromMove(e,t);return r.isFailure()?_e.failure(r.getReason()):e.isNotInRange(Si.SIZE,Si.SIZE)?_e.failure("start coord is not in range"):t.isNotInRange(Si.SIZE,Si.SIZE)?_e.failure("end coord is not in range"):_e.success(new so(e,t,r.get()))}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}}so.encoder=_a.getFallibleEncoder(so.from);let AF=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class Is extends N1{constructor(){super(Si)}static get(){return Is.singleton.isAbsent()&&(Is.singleton=y.of(new Is)),Is.singleton.get()}static getListMovesFromState(e){const t=[];if(Is.getVictory(e).isPresent())return t;for(let r=0;r<Si.SIZE;r++)for(let s=0;s<Si.SIZE;s++){const i=new S(s,r);if(e.getPieceAt(i).isPlayer())for(const c of Is.possibleTargets(e,i)){const u=so.from(i,c).get();t.push(u)}}return t}static getNumberOfGroups(e){const t=Je.createTable(Si.SIZE,Si.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<Si.SIZE;i++)for(let o=0;o<Si.SIZE;o++)if(-1===t[i][o]){const c=e.getPieceAt(new S(o,i));c.isPlayer()&&(s+=1,Is.markGroupStartingAt(e,t,new S(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(e,t,r,s){const i=[r],o=e.getPieceAt(r);for(;i.length>0;){const c=pe.getNonNullable(i.pop());if(-1===t[c.y][c.x]){const u=e.getPieceAt(c);if(u===o){t[c.y][c.x]=s;for(const h of be.DIRECTIONS){const g=c.getNext(h);e.isOnBoard(g)&&i.push(g)}}else u===le.NONE&&(t[c.y][c.x]=0)}}}applyLegalMove(e,t,r){const s=t.getCopiedBoard();return s[e.getStart().y][e.getStart().x]=le.NONE,s[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new Si(s,t.turn+1)}static isLegal(e,t){return t.getPieceAt(e.getStart())!==t.getCurrentPlayer()?R.failure(Xe.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.getStart(),e.direction)?R.failure(AF.INVALID_MOVE_LENGTH()):e.getStart().getCoordsToward(e.getEnd()).some(r=>t.getPieceAt(r)===t.getCurrentOpponent())?R.failure(AF.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.getEnd())===t.getCurrentPlayer()?R.failure(Xe.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):R.SUCCESS}isLegal(e,t){return Is.isLegal(e,t)}static numberOfPiecesOnLine(e,t,r){let s=0;for(const i of Is.getLineCoords(t,r))e.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(e,t){const r=Is.getEntranceAndForwardDirection(e,t);let s=r[0];const i=r[1],o=[];for(;Si.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(e,t){switch(t){case be.UP:case be.DOWN:return[new S(e.x,0),be.DOWN];case be.LEFT:case be.RIGHT:return[new S(0,e.y),be.RIGHT];case be.UP_RIGHT:case be.DOWN_LEFT:return[new S(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),be.UP_RIGHT];default:return pe.expectToBeMultiple(t,[be.UP_LEFT,be.DOWN_RIGHT]),[new S(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),be.DOWN_RIGHT]}}static getVictory(e){const[t,r]=Is.getNumberOfGroups(e);return 1===t&&1===r?y.of(le.NONE):1===t?y.of(B.ZERO):1===r?y.of(B.ONE):y.empty()}static possibleTargets(e,t){const r=[];for(const s of be.DIRECTIONS){const i=Is.numberOfPiecesOnLine(e,t,s),o=t.getNext(s,i);if(e.isOnBoard(o)){const c=so.from(t,o).get();Is.isLegal(c,e).isSuccess()&&r.push(o)}}return r}getGameStatus(e){const t=e.gameState,[r,s]=Is.getNumberOfGroups(t);return 1===r&&s>1?Ne.ZERO_WON:r>1&&1===s?Ne.ONE_WON:Ne.ONGOING}}Is.singleton=y.empty();class L8t extends bs{getListMoves(e){return Is.getListMovesFromState(e.gameState)}getMetrics(e){const t=e.gameState,[r,s]=Is.getNumberOfGroups(t);return[100/r,100/s]}}const Y=le.NONE,ar=le.ZERO,tr=le.ONE;class h4e{constructor(){this.tutorial=[ee.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new Si([[Y,Y,Y,Y,Y,Y,Y,Y],[tr,Y,Y,Y,ar,Y,Y,tr],[Y,Y,ar,ar,tr,Y,Y,Y],[Y,Y,Y,ar,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y]],0)),ee.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,Si.getInitialState(),so.from(new S(1,7),new S(1,5)).get(),$localize`Congratulations!`),ee.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new Si([[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,tr,ar,ar,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,tr],[Y,Y,Y,Y,Y,Y,Y,ar]],0),[so.from(new S(3,1),new S(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),ee.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new Si([[Y,Y,Y,Y,Y,Y,tr,Y],[Y,Y,Y,Y,Y,ar,Y,Y],[Y,Y,Y,Y,tr,Y,Y,Y],[Y,Y,Y,ar,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,tr],[Y,Y,Y,Y,Y,tr,Y,tr],[Y,Y,Y,ar,Y,Y,tr,tr],[Y,Y,Y,ar,Y,Y,Y,Y]],0),[so.from(new S(3,3),new S(3,0)).get(),so.from(new S(3,3),new S(0,0)).get(),so.from(new S(3,3),new S(2,3)).get(),so.from(new S(3,3),new S(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),ee.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new Si([[Y,ar,Y,ar,ar,ar,ar,Y],[tr,Y,Y,Y,Y,Y,Y,tr],[Y,Y,ar,Y,tr,Y,Y,Y],[tr,Y,Y,Y,Y,Y,Y,tr],[tr,Y,Y,Y,Y,Y,Y,tr],[tr,Y,Y,Y,Y,Y,Y,tr],[tr,Y,Y,Y,Y,Y,Y,tr],[Y,ar,ar,ar,ar,ar,ar,Y]],0),so.from(new S(2,2),new S(4,2)).get(),(e,t,r)=>t.getPieceAt(e.getEnd())===le.ONE?R.SUCCESS:R.failure($localize`Failed. Try again.`),$localize`Congratulations!`),ee.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new Si([[Y,Y,Y,Y,Y,Y,Y,Y],[Y,Y,Y,Y,Y,Y,Y,Y],[ar,Y,Y,ar,tr,ar,Y,Y],[Y,Y,Y,ar,Y,Y,Y,tr],[Y,Y,Y,Y,Y,Y,Y,tr],[Y,Y,Y,Y,Y,Y,Y,tr],[Y,Y,Y,Y,Y,Y,Y,tr],[Y,Y,Y,Y,Y,Y,Y,Y]],0),[so.from(new S(0,2),new S(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function R8t(n,e){if(1&n&&(V(),X(0,"circle",4)),2&n){const t=C().index,r=C().index,s=C();ke("id","piece_",t,"_",r,""),w("ngClass",s.getPieceClasses(t,r)),z("cx",s.SPACE_SIZE/2+t*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function D8t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"g",3),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(2,"rect",4),x(3,R8t,1,6,"circle",5),A()()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","click_",r,"_",s,""),T(1),ke("id","space_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t!==i.EMPTY)}}function z8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,D8t,4,10,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function H8t(n,e){if(1&n){const t=Oe();V(),O(0,"rect",6),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const t=e.$implicit,r=C();z("x",t.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",t.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let V8t=(()=>{class n extends to{constructor(t){super(t),this.INDICATOR_SIZE=20,this.EMPTY=le.NONE,this.targets=[],this.selected=y.empty(),this.lastMove=y.empty(),this.captured=y.empty(),this.rules=Is.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new L8t(this.rules,"LinesOfActionMinimax")],this.encoder=so.encoder,this.tutorial=(new h4e).tutorial,this.updateBoard()}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),R.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(t){var r=this;return I(function*(){const s=so.from(r.selected.get(),t);return s.isSuccess()?r.chooseMove(s.get()):r.cancelMove(s.getReason())})()}select(t){var r=this;return I(function*(){return r.getState().getPieceAt(t)!==r.getState().getCurrentPlayer()?r.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=y.of(t),r.targets=Is.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(AF.PIECE_CANNOT_MOVE()):R.SUCCESS)})()}updateBoard(){this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.node.move}showLastMove(t){this.captured=this.getPreviousState().getPieceAt(t.getEnd()).isPlayer()?y.of(t.getEnd()):y.empty()}cancelMoveAttempt(){this.selected=y.empty(),this.targets=[]}getSquareClasses(t,r){const s=new S(t,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(t,r){const s=this.board[r][t],i=new S(t,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"indicator",3,"click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,z8t,2,1,"g",1),x(2,H8t,1,4,"rect",2),A()),2&t&&(T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.targets))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class rl extends us{constructor(e,t,r,s={top:0,bottom:0,left:0,right:0}){super(e.x,e.y),this.direction=t,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}rl.encoder=new class extends Ye{encode(n){return{coord:S.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decode(n){const e=n;return qe(null!=e.coord,"Invalid encoded LodestoneMove"),qe(null!=e.direction,"Invalid encoded LodestoneMove"),qe(null!=e.orientation,"Invalid encoded LodestoneMove"),qe(null!=e.captures,"Invalid encoded LodestoneMove"),new rl(S.encoder.decode(e.coord),e.direction,e.orientation,e.captures)}};class io{constructor(e){this.unreachable=e}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(e){return this===e}}io.UNREACHABLE=new io(!0),io.EMPTY=new io(!1);class qc{constructor(e){this.owner=e}static of(e){return e===B.ZERO?qc.ZERO:qc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}qc.ZERO=new qc(B.ZERO),qc.ONE=new qc(B.ONE);class Go{constructor(e,t,r){this.owner=e,this.direction=t,this.orientation=r}static of(e,t){return Go.LODESTONES[e.value][t.direction][t.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(e){return this===e}}Go.LODESTONES={0:{push:{diagonal:new Go(B.ZERO,"push","diagonal"),orthogonal:new Go(B.ZERO,"push","orthogonal")},pull:{diagonal:new Go(B.ZERO,"pull","diagonal"),orthogonal:new Go(B.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Go(B.ONE,"push","diagonal"),orthogonal:new Go(B.ONE,"push","orthogonal")},pull:{diagonal:new Go(B.ONE,"pull","diagonal"),orthogonal:new Go(B.ONE,"pull","orthogonal")}}};class mr{constructor(e,t){this.width=e,this.pieces=t}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(e,t){if(this.pieces.length+t>=this.width)return 5===this.width?mr.EMPTY_3.addCaptured(e,t+this.pieces.length-5):(qe(this.pieces.length+t===3,"should never put more pieces than the plate can support"),y.empty());{const r=Je.copyImmutableArray(this.pieces);for(let s=0;s<t;s++)r.push(qc.of(e));return y.of(new mr(this.width,r))}}getPieceAt(e){return e<this.pieces.length?this.pieces[e]:io.EMPTY}}mr.POSITIONS=["top","bottom","left","right"],mr.EMPTY_5=new mr(5,[]),mr.EMPTY_3=new mr(3,[]);let nr=(()=>{class n extends br{constructor(t,r,s,i){super(t,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const t=io.EMPTY,r=qc.ZERO,s=qc.ONE;return new n([[t,t,r,s,r,s,t,t],[t,r,s,r,s,r,s,t],[r,s,r,s,r,s,r,s],[s,r,s,t,t,r,s,r],[r,s,r,t,t,s,r,s],[s,r,s,r,s,r,s,r],[t,s,r,s,r,s,r,t],[t,t,s,r,s,r,t,t]],0,new Wn,{top:y.of(mr.EMPTY_5),bottom:y.of(mr.EMPTY_5),left:y.of(mr.EMPTY_5),right:y.of(mr.EMPTY_5)})}withBoard(t){return new n(t,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const t=this.remainingSpacesDetails();return t.top+t.bottom+t.left+t.right}remainingSpacesDetails(){const t={top:0,bottom:0,left:0,right:0};for(const r of mr.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(t[r]=s.get().remainingSpaces())}return t}numberOfPieces(){const t=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(t[i.owner.value]+=1)}return t}getScores(){const t=this.numberOfPieces();return[24-t[1],24-t[0]]}nextLodestoneDirection(){const t=this.getCurrentPlayer(),r=this.lodestones.get(t);if(!r.isPresent())return y.empty();{const s=this.getPieceAt(r.get());switch(qe(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return y.of("pull");case"pull":return y.of("push")}}}}return n.SIZE=8,n})();const je=io.UNREACHABLE,fe=io.EMPTY,ds=qc.ZERO,oo=qc.ONE,G_=Go.of(B.ONE,{direction:"push",orientation:"orthogonal"}),NF={top:y.of(mr.EMPTY_5),bottom:y.of(mr.EMPTY_5),left:y.of(mr.EMPTY_5),right:y.of(mr.EMPTY_5)};class d4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,nr.getInitialState()),ee.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,nr.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),ee.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,nr.getInitialState()),ee.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,nr.getInitialState()),ee.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,nr.getInitialState()),ee.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,nr.getInitialState(),new rl(new S(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(e,t,r)=>32===r.remainingSpaces()?R.failure($localize`You have not captured any of the opponent's pieces, try again!`):R.SUCCESS,$localize`Congratulations!`),ee.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new nr([[fe,fe,fe,fe,oo,fe,fe,fe],[fe,fe,ds,fe,fe,oo,fe,fe],[fe,fe,G_,fe,fe,fe,fe,ds],[fe,fe,fe,fe,oo,fe,fe,ds],[fe,fe,fe,fe,fe,ds,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Wn([{key:B.ONE,value:new S(2,2)}]),{...NF,top:mr.EMPTY_5.addCaptured(B.ONE,4)}),new rl(new S(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,r)=>5===r.pressurePlates.top.get().width?R.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):R.SUCCESS,$localize`Congratulations!`),ee.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new nr([[je,je,je,je,je,je,je,je],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,ds],[fe,fe,fe,fe,fe,ds,fe,ds],[fe,G_,fe,fe,oo,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,oo,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Wn([{key:B.ONE,value:new S(1,4)}]),{...NF,top:mr.EMPTY_3.addCaptured(B.ONE,2)}),new rl(new S(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(e,t,r)=>r.pressurePlates.top.isPresent()?R.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):R.SUCCESS,$localize`Congratulations!`),ee.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new nr([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,je,ds,oo,fe,fe,je,je],[je,je,G_,oo,fe,fe,je,je],[je,je,fe,ds,ds,fe,je,je],[je,je,ds,fe,fe,fe,je,je],[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je]],0,new Wn([{key:B.ONE,value:new S(2,3)}]),{top:y.empty(),bottom:y.empty(),left:y.empty(),right:y.empty()})),ee.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new nr([[fe,fe,fe,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,oo,fe,fe],[fe,fe,fe,G_,fe,fe,ds,fe],[fe,fe,ds,ds,oo,fe,fe,ds],[fe,fe,fe,fe,fe,ds,fe,fe],[fe,fe,ds,fe,fe,fe,fe,fe],[fe,fe,oo,fe,fe,fe,fe,fe],[fe,fe,fe,fe,fe,fe,fe,fe]],0,new Wn([{key:B.ONE,value:new S(3,2)}]),{...NF,top:mr.EMPTY_5.addCaptured(B.ONE,4)}),[new rl(new S(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),ee.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new nr([[je,je,je,je,je,je,je,je],[je,je,je,je,je,je,je,je],[je,oo,ds,oo,fe,fe,je,je],[je,oo,G_,fe,oo,fe,je,je],[je,fe,fe,ds,ds,fe,je,je],[je,oo,ds,fe,oo,fe,je,je],[je,fe,fe,fe,ds,fe,je,je],[je,je,je,je,je,je,je,je]],0,new Wn([{key:B.ONE,value:new S(2,3)}]),{top:y.empty(),bottom:mr.EMPTY_3.addCaptured(B.ZERO,2),left:y.of(mr.EMPTY_3),right:y.empty()}),[new rl(new S(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}let P9=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class R2 extends N1{constructor(){super(nr)}static get(){return R2.singleton.isAbsent()&&(R2.singleton=y.of(new R2)),R2.singleton.get()}applyLegalMove(e,t,r){const s=t.getCurrentPlayer(),i=s.getOpponent(),o=Je.copyBiArray(r.board),c=t.lodestones.getCopy();c.put(s,e.coord);const u={...t.pressurePlates};return this.updatePressurePlates(o,u,c,i,e.captures),new nr(o,t.turn+1,c,u)}updatePressurePlates(e,t,r,s,i){for(const o of mr.POSITIONS)t[o]=this.updatePressurePlate(e,o,t[o],r,s,i[o])}updatePressurePlate(e,t,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=R2.THREATENED_COORD_RANGE.get(t).get();return c.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,s),this.removePressurePlate(e,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(e,t,r,s){for(let i=t;i.isInRange(nr.SIZE,nr.SIZE);i=i.getNext(r)){for(const o of B.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);e[i.y][i.x]=io.UNREACHABLE}}isLegal(e,t){const r=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(r.isFailure())return _e.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(s.captures.length,t.remainingSpaces()))return _e.failure(P9.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of mr.POSITIONS){const u=t.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<e.captures[c])return _e.failure(P9.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return _e.success(s)}applyMoveWithoutPlacingCaptures(e,t,r){let s;const i=Je.copyBiArray(e.board),o=e.lodestones.get(e.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=io.EMPTY}return s="pull"===r.direction?this.applyPull(e,i,t,r.orientation):this.applyPush(e,i,t,r.orientation),s.board[t.y][t.x]=Go.of(e.getCurrentPlayer(),r),s.moved.push(t),s}applyPull(e,t,r,s){const i=e.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const g of h)for(let m=r.getNext(g);e.isOnBoard(m);m=m.getNext(g)){const M=t[m.y][m.x],b=m.getNext(g);if(e.isOnBoard(b)){const L=t[b.y][b.x];L.isPlayerPiece()&&L.owner===i&&(M.isEmpty()?(u.push(m),t[m.y][m.x]=L,u.push(b),t[b.y][b.x]=io.EMPTY):M.isPlayerPiece()&&M.owner===o&&(c.push(m),t[m.y][m.x]=L,u.push(b),t[b.y][b.x]=io.EMPTY))}}return{board:t,captures:c,moved:u}}applyPush(e,t,r,s){const o=e.getCurrentPlayer().getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const g of h)for(let M=r.getNext(g,nr.SIZE);!1===M.equals(r);M=M.getPrevious(g))if(e.isOnBoard(M)){const b=t[M.y][M.x];if(b.isPlayerPiece()&&b.owner===o){const L=M.getNext(g);if(e.isOnBoard(L)){const G=t[L.y][L.x];G.isUnreachable()?(c.push(M),t[M.y][M.x]=io.EMPTY):G.isEmpty()&&(u.push(L),t[L.y][L.x]=b,u.push(M),t[M.y][M.x]=io.EMPTY)}else c.push(M),t[M.y][M.x]=io.EMPTY}}return{board:t,captures:c,moved:u}}isLegalWithoutCaptures(e,t,r){const s=this.isTargetLegal(e,t);if(s.isFailure())return s;const i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?R.failure(P9.MUST_FLIP_LODESTONE()):R.SUCCESS}isTargetLegal(e,t){const r=e.getPieceAt(t);if(r.isUnreachable())return R.failure(P9.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE());const s=e.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}getGameStatus(e){const r=e.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?Ne.DRAW:0===r[0]?Ne.ONE_WON:0===r[1]?Ne.ZERO_WON:Ne.ONGOING}}R2.THREATENED_COORD_RANGE=Wn.from({top:{startForBigPlate:new S(0,0),startForSmallPlate:new S(0,1),direction:be.RIGHT},bottom:{startForBigPlate:new S(0,nr.SIZE-1),startForSmallPlate:new S(0,nr.SIZE-2),direction:be.RIGHT},left:{startForBigPlate:new S(0,0),startForSmallPlate:new S(1,0),direction:be.DOWN},right:{startForBigPlate:new S(nr.SIZE-1,0),startForSmallPlate:new S(nr.SIZE-2,0),direction:be.DOWN}}),R2.singleton=y.empty();class F8t extends Xa{getListMoves(e){const t=e.gameState;return this.flatMapEmptyCoords(t,r=>{const s=[];for(const i of this.nextDirection(t)){const o=["diagonal","orthogonal"];for(const c of o){const g=R2.get().applyMoveWithoutPlacingCaptures(t,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(t,g))s.push(new rl(r,i,c,m))}}return s})}captureCombinations(e,t){if(0===t)return new Ot([{top:0,bottom:0,left:0,right:0}]);{const r=new Ot,s=e.remainingSpacesDetails(),i=this.captureCombinations(e,t-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(e,t){let r=[];for(let s=0;s<nr.SIZE;s++)for(let i=0;i<nr.SIZE;i++){const o=new S(i,s),c=e.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===e.getCurrentPlayer())&&(r=r.concat(t(o)))}return r}nextDirection(e){const t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}getBoardValue(e){const t=e.gameState.getScores();let r;return r=24===t[0]&&24!==t[1]?B.ZERO.getVictoryValue():24!==t[0]&&24===t[1]?B.ONE.getVictoryValue():Vn.of(t[0],t[1]).value,new Vn(r)}}function B8t(n,e){if(1&n&&(V(),X(0,"circle",10)),2&n){const t=C(2),r=t.index,s=t.$implicit,i=C().index,o=C();ke("id","piece_",r,"_",i,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function $8t(n,e){if(1&n&&(V(),X(0,"polygon",15)),2&n){const t=C().$implicit,r=C(3).$implicit,s=C(2);qu("transform","rotate(",90*t,")"),w("ngClass",r.lodestone.movingClass),z("points",s.TRIANGLE_OUT)}}function G8t(n,e){if(1&n&&(V(),X(0,"polygon",15)),2&n){const t=C().$implicit,r=C(3).$implicit,s=C(2);qu("transform","rotate(",90*t,")"),w("ngClass",r.lodestone.movingClass),z("points",s.TRIANGLE_IN)}}function U8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,$8t,1,3,"polygon",14),x(2,G8t,1,3,"polygon",14),A()),2&n){const t=C(3).$implicit;T(1),w("ngIf","push"===t.lodestone.direction),T(1),w("ngIf","pull"===t.lodestone.direction)}}const p4e=function(){return[0,1,2,3]};function q8t(n,e){if(1&n&&(V(),O(0,"g",11),X(1,"circle",12)(2,"circle",13),O(3,"g"),x(4,U8t,3,2,"g",1),A()()),2&n){const t=C(2),r=t.index,s=t.$implicit,i=C().index,o=C();z("transform",o.getSquareTransform(r,i)),T(1),w("ngClass",s.lodestone.selectedClass),z("r",o.PIECE_RADIUS),T(1),w("ngClass",s.lodestone.pieceClasses),z("r",o.PIECE_RADIUS/4),T(1),qu("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),T(1),w("ngForOf",K1(7,p4e))}}function W8t(n,e){if(1&n){const t=Oe();V(),O(0,"g",6),J("click",function(){he(t);const s=C().$implicit;return ce(C(2).selectCoord(s.coord))}),X(1,"rect",7),x(2,B8t,1,6,"circle",8),x(3,q8t,5,8,"g",9),A()}if(2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C();ke("id","square_",r,"_",i,""),T(1),w("ngClass",s.squareClasses),z("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),T(1),w("ngIf",s.hasPiece),T(1),w("ngIf",s.lodestone)}}function j8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,W8t,4,9,"g",5),A()),2&n){const t=e.$implicit;T(1),w("ngIf",!1===t.crumbled)}}function Z8t(n,e){if(1&n&&(V(),O(0,"g"),x(1,j8t,2,1,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Y8t(n,e){if(1&n&&(V(),O(0,"g",16),X(1,"circle",17),A()),2&n){const t=e.$implicit,r=e.index,s=C();h1("id","capture_",r,""),z("transform",s.getCaptureTransform(r)),T(1),w("ngClass",t.pieceClasses),z("r",s.PIECE_RADIUS)}}function K8t(n,e){if(1&n&&(V(),O(0,"g"),X(1,"polygon",15),A()),2&n){const t=e.$implicit,r=C().$implicit,s=C();T(1),qu("transform","rotate(",90*t,")"),w("ngClass",r.movingClass),z("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function X8t(n,e){if(1&n){const t=Oe();V(),O(0,"g",6),J("click",function(){const i=he(t).$implicit;return ce(C().selectLodestone(i))}),X(1,"circle",12)(2,"circle",13),O(3,"g"),x(4,K8t,2,3,"g",1),A()()}if(2&n){const t=e.$implicit,r=e.index,s=C();ke("id","lodestone_",t.direction,"_",t.orientation,""),z("transform",s.getAvailableLodestoneTransform(r)),T(1),w("ngClass",t.selectedClass),z("r",s.PIECE_RADIUS),T(1),w("ngClass",t.pieceClasses),z("r",s.PIECE_RADIUS/4),T(1),qu("transform","rotate(","diagonal"===t.orientation?45:0,")"),T(1),w("ngForOf",K1(9,p4e))}}function Q8t(n,e){if(1&n&&(V(),X(0,"circle",10)),2&n){const t=C(),r=t.index,s=t.$implicit,i=C().$implicit,o=C();ke("id","platePiece_",i.position,"_",r,""),w("ngClass",s.pieceClasses),z("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function J8t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"g",6),J("click",function(){const s=he(t),i=s.$implicit,o=s.index,c=C().$implicit;return ce(C().onPressurePlateClick(i.temporary,c.position,o))}),X(2,"rect",18),x(3,Q8t,1,6,"circle",8),A()()}if(2&n){const t=e.$implicit,r=e.index,s=C().$implicit,i=C();z("transform",i.getPressurePlateTransform(s.position)),T(1),ke("id","plate_",s.position,"_",r,""),T(1),ke("id","plateSquare_",s.position,"_",r,""),w("ngClass",t.squareClasses),z("x",i.SPACE_SIZE*t.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*t.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t.hasPiece)}}function eut(n,e){if(1&n&&(V(),O(0,"g",16),x(1,J8t,4,11,"g",1),A()),2&n){const t=e.$implicit;h1("id","pressurePlate_",t.position,""),T(1),w("ngForOf",t.coords)}}function tut(n,e){if(1&n&&(V(),X(0,"rect",19)),2&n){const t=C();ke("id","selection_",t.viewInfo.selected.get().x,"_",t.viewInfo.selected.get().y,""),z("x",t.SPACE_SIZE*t.viewInfo.selected.get().x+t.STROKE_WIDTH)("y",t.SPACE_SIZE*t.viewInfo.selected.get().y+t.STROKE_WIDTH)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}class D2 extends b8{constructor(e){super(e),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:y.empty(),pressurePlateShift:{top:new Bt(0,0),left:new Bt(0,0),right:new Bt(0,0),bottom:new Bt(0,0)}},this.stateAfterPlacingLodestone=y.empty(),this.lastInfos=y.empty(),this.capturesToPlace=0,this.selectedCoord=y.empty(),this.selectedLodestone=y.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=R2.get(),this.node=this.rules.getInitialNode(),this.tutorial=(new d4e).tutorial,this.availableMinimaxes=[new F8t(this.rules,"LodestoneDummyMinimax")],this.encoder=rl.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const t=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${t},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${t},${r} ${t},-${r}`,this.displayedState=this.getState(),this.scores=y.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(e){var t=this;return I(function*(){const r=t.canUserPlay("#square_"+e.x+"_"+e.y);if(r.isFailure())return t.cancelMove(r.getReason());if(t.capturesToPlace>0)return t.cancelMove(P9.MUST_PLACE_CAPTURES());const s=R2.get().isTargetLegal(t.getState(),e);return s.isFailure()?t.cancelMove(s.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),R.SUCCESS):(t.selectedCoord=y.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),R.SUCCESS))})()}selectLodestone(e){var t=this;return I(function*(){const r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation);if(r.isFailure())return t.cancelMove(r.getReason());qe(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=t.getCurrentPlayer(),i=Go.of(s,e);return t.selectedLodestone.equalsValue(i)?(t.cancelMoveAttempt(),R.SUCCESS):(t.selectedLodestone=y.of(i),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),R.SUCCESS))})()}putLodestone(){var e=this;return I(function*(){qe(e.selectedCoord.isPresent(),"coord should have been selected"),qe(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),r=e.selectedLodestone.get(),s=e.getState();qe(R2.get().isLegalWithoutCaptures(s,t,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=R2.get().applyMoveWithoutPlacingCaptures(s,t,r);return e.lastInfos=y.of(o),e.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(o.board),e.stateAfterPlacingLodestone=y.of(e.displayedState),e.updateViewInfo(),R.SUCCESS)})()}applyMove(){var e=this;return I(function*(){qe(e.selectedCoord.isPresent(),"coord should have been selected"),qe(e.selectedLodestone.isPresent(),"lodestone should have been selected");const t=e.selectedCoord.get(),r=e.selectedLodestone.get(),s=new rl(t,r.direction,r.orientation,e.captures);return e.chooseMove(s)})()}onPressurePlateClick(e,t,r){return e?this.deselectPressurePlate(t,r):this.selectPressurePlate(t,r)}selectPressurePlate(e,t){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+e+"_"+t);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove(P9.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[e]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Je.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return R2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new nr(c,i.turn,h,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),R.SUCCESS)})()}deselectPressurePlate(e,t){var r=this;return I(function*(){const s=r.canUserPlay("#plate_"+e+"_"+t);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[e]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Je.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return R2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new nr(c,i.turn,h,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),R.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.scores=y.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=y.empty(),this.lastInfos=y.empty();const e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){const t=Je.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=io.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=y.empty(),this.selectedLodestone=y.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const t=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(t),this.viewInfo.opponentClass=this.getPlayerClass(t.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let e=0;e<nr.SIZE;e++){this.viewInfo.boardInfo.push([]);for(let t=0;t<nr.SIZE;t++){const r=new S(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:y.empty()}getSquareInfo(e){const t=this.displayedState.getPieceAt(e),r={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(r.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){const r=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:r,orientation:"orthogonal"}),this.nextLodestone(e,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}nextLodestone(e,t){const r=Go.of(e,t),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const e of mr.POSITIONS){const t=[],r=this.displayedState.pressurePlates[e];if(r.isPresent()){const s=D2.PRESSURE_PLATES_POSITIONS.get(e).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let h="";u.isPlayerPiece()&&(h=this.getPlayerClass(u.owner)),t.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:e,coords:t})}}showLastMove(e){const t=this.getPreviousState();this.lastInfos=y.of(R2.get().applyMoveWithoutPlacingCaptures(t,e.coord,e)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(t,r,!1)}showPressurePlateDifferences(e,t,r){for(const s of mr.POSITIONS)this.showPressurePlateDifference(e.pressurePlates[s],t.pressurePlates[s],s,r)}showPressurePlateDifference(e,t,r,s){if(e.isPresent()&&t.isPresent()){const i=e.get(),o=t.get(),c=pe.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const h=i.getPieceAt(u),g=o.getPieceAt(u);!1===h.equals(g)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(e){for(const t of e.moved)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("moved-fill");for(const t of e.captures)this.viewInfo.boardInfo[t.y][t.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),r=this.getPressurePlateShift(e.pressurePlates.right),s=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Bt(.5*(t-r),0),this.viewInfo.pressurePlateShift.bottom=new Bt(.5*(t-r),0),this.viewInfo.pressurePlateShift.left=new Bt(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new Bt(0,.5*(s-i))}getPressurePlateShift(e){return e.isAbsent()?2:3===e.get().width?1:0}getSquareTransform(e,t){return`translate(${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(e){return`translate(${(e+(nr.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(e){return`translate(${(e+(nr.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(e){return`translate(${this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE})`}}D2.PRESSURE_PLATE_EXTRA_SHIFT=.2,D2.PRESSURE_PLATES_POSITIONS=Wn.from({top:{startForBigPlate:new S(.5,-1-D2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,0-D2.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},bottom:{startForBigPlate:new S(.5,8+D2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new S(1.5,7+D2.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},left:{startForBigPlate:new S(-1-D2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(0-D2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN},right:{startForBigPlate:new S(8+D2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new S(7+D2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN}}),D2.\u0275fac=function(e){return new(e||D2)(Q(_n))},D2.\u0275cmp=ct({type:D2,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(e,t){1&e&&(V(),O(0,"svg",0),x(1,Z8t,2,1,"g",1),x(2,Y8t,2,4,"g",2),x(3,X8t,5,10,"g",3),x(4,eut,2,2,"g",2),x(5,tut,1,6,"rect",4),A()),2&e&&(T(1),w("ngForOf",t.viewInfo.boardInfo),T(1),w("ngForOf",t.viewInfo.capturesToPlace),T(1),w("ngForOf",t.viewInfo.availableLodestones),T(1),w("ngForOf",t.viewInfo.pressurePlates),T(1),w("ngIf",t.viewInfo.selected.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let IT=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class ps extends kc{constructor(e,t,r){super(e,t),this.calledTheClock=r}static from(e,t,r=!1){if(e.isNotInRange(4,8))return _e.failure(IT.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return _e.failure(IT.END_COORD_OUT_OF_RANGE());if(t.equals(e))return _e.failure(Xe.MOVE_CANNOT_BE_STATIC());const s=be.factory.fromDelta(t.x-e.x,t.y-e.y);return s.isFailure()?_e.failure(s.getReason()):_e.success(new ps(e,t,r))}toString(){const e=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+e+")"}equals(e){return!1!==super.equals(e)&&this.calledTheClock===e.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(e){if(e.isAbsent())return!1;const t=e.get();return t.getEnd().equals(this.getStart())&&t.getStart().equals(this.getEnd())}}ps.encoder=Ye.tuple([S.encoder,S.encoder,Ye.identity()],n=>[n.getStart(),n.getEnd(),n.calledTheClock],n=>ps.from(n[0],n[1],n[2]).get());class Ht{constructor(e){this.value=e}static tryMerge(e,t){qe(e!==Ht.EMPTY&&t!==Ht.EMPTY,"tryMerge cannot be called with empty pieces");const s=e.value+t.value;return 2===s||3===s?y.of(Ht.of(s)):y.empty()}static of(e){return e===Ht.DRONE.value?Ht.DRONE:(pe.expectToBe(e,Ht.QUEEN.value),Ht.QUEEN)}getValue(){return this.value}equals(e){return this.getValue()===e.getValue()}}Ht.EMPTY=new Ht(0),Ht.PAWN=new Ht(1),Ht.DRONE=new Ht(2),Ht.QUEEN=new Ht(3);class u7{constructor(e){this.captures=e,e.makeImmutable()}static of(e){const t=new Wn;for(const r of e)u7.addToMap(t,r);return new u7(t)}static addToMap(e,t){const r=e.get(t);r.isPresent()?e.replace(t,r.get()+1):e.set(t,1)}toValue(){let e=0;return this.captures.forEach(t=>{e+=t.key.getValue()*t.value}),e}add(e){const t=this.captures.getCopy();return u7.addToMap(t,e),new u7(t)}}class Zs extends br{constructor(e,t,r=y.empty(),s=y.empty(),i){super(e,t),this.lastMove=r,this.countDown=s,null==i&&(i=new Wn([{key:B.ZERO,value:u7.of([])},{key:B.ONE,value:u7.of([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const e=Ht.EMPTY,t=Ht.PAWN,r=Ht.DRONE,s=Ht.QUEEN;return new Zs([[s,s,r,e],[s,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,s],[e,r,s,s]],0,y.empty())}getPlayerTerritory(e){return e===B.ZERO?Zs.PLAYER_ZERO_TERRITORY:Zs.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(e){const t=this.getCurrentPlayer(),r=this.getPlayerTerritory(t);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===e)return!0;return!1}getScoreOf(e){return this.captured.get(e).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(B.ZERO)?y.of(B.ZERO):this.isTerritoryEmpty(B.ONE)?y.of(B.ONE):y.empty()}isTerritoryEmpty(e){const t=this.getPlayerTerritory(e);for(const r of t)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==Ht.EMPTY)return!1;return!0}isInOpponentTerritory(e){const t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}isInPlayerTerritory(e){const t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}getCapturesOf(e){const t=this.captured.get(e).get();return[t.captures.get(Ht.PAWN).getOrElse(0),t.captures.get(Ht.DRONE).getOrElse(0),t.captures.get(Ht.QUEEN).getOrElse(0)]}}Zs.PLAYER_ZERO_TERRITORY=new Ot([4,5,6,7]),Zs.PLAYER_ONE_TERRITORY=new Ot([0,1,2,3]);let g4e=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const ae=Ht.EMPTY,z2=Ht.PAWN,R6=Ht.DRONE,D8=Ht.QUEEN,m4e=()=>$localize`This is not a field promotion!`;class _4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Zs.getInitialState()),ee.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Zs.getInitialState()),ee.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Zs.getInitialState(),ps.from(new S(2,5),new S(1,4)).get(),(e,t,r)=>r.getPieceAt(e.getEnd())===Ht.PAWN?R.SUCCESS:R.failure($localize`This is not a pawn!`),$localize`Congratulations!`),ee.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Zs.getInitialState(),ps.from(new S(1,7),new S(0,7)).get(),(e,t,r)=>r.getPieceAt(e.getEnd())===Ht.DRONE?R.SUCCESS:R.failure($localize`This is not a drone!`),$localize`Congratulations!`),ee.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new Zs([[R6,z2,ae,ae],[D8,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,D8,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[D8,R6,z2,ae]],1),ps.from(new S(2,3),new S(2,7)).get(),(e,t,r)=>r.getPieceAt(e.getEnd())===Ht.QUEEN?R.SUCCESS:R.failure($localize`This is not a queen!`),$localize`Congratulations!`),ee.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new Zs([[R6,z2,z2,ae],[ae,ae,ae,ae],[D8,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,z2,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,R6,z2,ae]],1),[ps.from(new S(0,2),new S(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,g4e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),ee.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new Zs([[ae,ae,ae,D8],[ae,z2,ae,ae],[ae,ae,z2,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,D8],[ae,ae,R6,ae],[ae,z2,ae,ae]],1),[ps.from(new S(1,1),new S(2,2)).get(),ps.from(new S(2,2),new S(1,1)).get()],$localize`Congratulations!`,m4e()),ee.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new Zs([[z2,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,R6,ae],[ae,z2,ae,ae]],0),ps.from(new S(1,7),new S(2,6)).get(),(e,t,r)=>r.getPieceAt(e.getEnd())===Ht.QUEEN?R.SUCCESS:R.failure(m4e()),$localize`Congratulations!`),ee.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Zs.getInitialState(),ps.from(new S(1,5),new S(0,4),!0).get(),(e,t,r)=>e.calledTheClock?R.SUCCESS:R.failure($localize`You did not call the clock!`),$localize`Congratulations!`),ee.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new Zs([[ae,ae,ae,ae],[ae,z2,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,z2],[ae,ae,R6,ae],[ae,z2,ae,ae]],15,y.empty(),y.of(1)),[ps.from(new S(1,1),new S(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),ee.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new Zs([[ae,ae,ae,D8],[ae,z2,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[R6,ae,ae,ae],[ae,ae,ae,ae],[ae,R6,ae,ae]],15,y.empty(),y.of(1)),ps.from(new S(1,1),new S(2,2)).get(),$localize`Congratulations!`),ee.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new Zs([[ae,ae,ae,D8],[ae,z2,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,z2,ae],[ae,ae,ae,ae],[ae,ae,ae,ae],[ae,ae,ae,ae]],0),ps.from(new S(2,4),new S(1,3)).get(),(e,t,r)=>3===e.getEnd().y?R.SUCCESS:R.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}let xT=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class q3 extends N1{constructor(){super(Zs)}static get(){return q3.singleton.isAbsent()&&(q3.singleton=y.of(new q3)),q3.singleton.get()}applyLegalMove(e,t,r){const s=t.getCopiedBoard();s[e.getStart().y][e.getStart().x]=Ht.EMPTY;const i=r.finalPiece;s[e.getEnd().y][e.getEnd().x]=i;const o=r.score;let c=t.countDown;if(c.isPresent())if(this.isCapture(e,t))c=q3.STARTING_COUNT_DOWN;else{const h=t.countDown.get();c=y.of(h-1)}return e.calledTheClock&&(c=q3.STARTING_COUNT_DOWN),new Zs(s,t.turn+1,y.of(e),c,o)}isLegal(e,t){this.assertNonDoubleClockCall(e,t);const r=this.isLegalMove(e,t);if(r.isFailure())return r.toOtherFallible();if(e.isUndoneBy(t.lastMove))return _e.failure(xT.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);const s=t.getPieceAt(e.getStart()),i=t.captured.getCopy();if(this.isCapture(e,t)){const c=t.getCurrentPlayer();let u=i.get(c).get();const h=t.getPieceAt(e.getEnd());u=u.add(h),i.replace(c,u),i.makeImmutable()}return _e.success({finalPiece:s,score:i})}assertNonDoubleClockCall(e,t){qe(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}isCapture(e,t){const r=t.isInOpponentTerritory(e.getEnd()),s=t.getPieceAt(e.getEnd())!==Ht.EMPTY;return r&&s}isFieldPromotion(e,t){const r=t.isInPlayerTerritory(e.getEnd()),s=t.getPieceAt(e.getEnd())!==Ht.EMPTY;return r&&s}isLegalFieldPromotion(e,t){const r=this.getPromotedPiece(e,t);if(r.isAbsent())return _e.failure(xT.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(t.isTherePieceOnPlayerSide(s))return _e.failure(xT.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:t.captured.getCopy()};return _e.success(i)}}isLegalMove(e,t){if(!1===t.isInPlayerTerritory(e.getStart()))return R.failure(xT.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=t.getPieceAt(e.getStart());if(s===Ht.EMPTY)return R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===Ht.PAWN)return e.isValidForPawn()?R.SUCCESS:R.failure(IT.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===Ht.DRONE&&!1===e.isValidForDrone())return R.failure(IT.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of e.getStart().getUntil(e.getEnd()))if(t.getPieceAt(i)!==Ht.EMPTY)return R.failure(Xe.SOMETHING_IN_THE_WAY());return R.SUCCESS}getPromotedPiece(e,t){const r=t.getPieceAt(e.getStart()),s=t.getPieceAt(e.getEnd());return Ht.tryMerge(r,s)}getGameStatus(e){const t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,Ne.DRAW);if(t.getEmptyTerritory().isPresent()){const s=t.getCurrentOpponent(),i=Ne.getVictory(s);return this.getGameStatusScoreVictoryOr(t,i)}return Ne.ONGOING}getGameStatusScoreVictoryOr(e,t){const r=e.getScoreOf(B.ZERO),s=e.getScoreOf(B.ONE);return r>s?Ne.ZERO_WON:s>r?Ne.ONE_WON:t}}q3.STARTING_COUNT_DOWN=y.of(7),q3.singleton=y.empty();class nut extends bs{constructor(e,t){super(e,t)}getListMoves(e){const t=e.gameState,r=t.getCurrentPlayer(),s=t.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(t.getPieceAtXY(c,o)){case Ht.PAWN:i=i.concat(this.getMovesForPawnAt(t,c,o));break;case Ht.DRONE:i=i.concat(this.getMovesForDroneAt(t,c,o));break;case Ht.QUEEN:i=i.concat(this.getMovesForQueenAt(t,c,o))}return i}getMovesForPawnAt(e,t,r){const s=new S(t,r),i=[];for(const o of be.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(e,s,i)}addLegalMoves(e,t,r){const s=[],i=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(Ht.DRONE),c=!1===e.isTherePieceOnPlayerSide(Ht.QUEEN),u=e.lastMove;for(const h of r){const g=e.getPieceAt(h);if(g===Ht.EMPTY)this.add(s,ps.from(t,h).get(),u);else if(e.isInPlayerTerritory(h)){const m=Ht.tryMerge(g,i);if(m.isPresent()){const M=m.get(),b=ps.from(t,h).get();(M===Ht.DRONE&&o||M===Ht.QUEEN&&c)&&this.add(s,b,u)}}else this.add(s,ps.from(t,h).get(),u)}return s}add(e,t,r){!1===t.isUndoneBy(r)&&e.push(t)}getMovesForDroneAt(e,t,r){const s=new S(t,r),i=this.getLandingCoordsForLinearMove(s,e,2);return this.addLegalMoves(e,s,i)}getLandingCoordsForLinearMove(e,t,r){const s=[];for(const i of be.DIRECTIONS){let o=1,c=e.getNext(i,o),u=t.tryToGetPieceAt(c),h=u.equalsValue(Ht.EMPTY);for(;h;)s.push(c),o++,c=e.getNext(i,o),u=t.tryToGetPieceAt(c),h=u.equalsValue(Ht.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(e,t,r){const s=new S(t,r),i=this.getLandingCoordsForQueen(s,e);return this.addLegalMoves(e,s,i)}getLandingCoordsForQueen(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}getMetrics(e){return[e.gameState.getScoreOf(B.ZERO),e.gameState.getScoreOf(B.ONE)]}}function rut(n,e){if(1&n&&(V(),X(0,"g",19)),2&n){const t=C(2).index,r=C().index,s=C();y2(s.style),ke("mainShapeId","pawn_",t,"_",r,""),w("pieceClasses",s.getPieceClasses(t,r))}}function sut(n,e){if(1&n&&(V(),X(0,"g",20)),2&n){const t=C(2).index,r=C().index,s=C();y2(s.style),ke("mainShapeId","drone_",t,"_",r,""),w("pieceClasses",s.getPieceClasses(t,r))}}function iut(n,e){if(1&n&&(V(),X(0,"g",21)),2&n){const t=C(2).index,r=C().index,s=C();y2(s.style),ke("mainShapeId","queen_",t,"_",r,""),w("pieceClasses",s.getPieceClasses(t,r))}}function out(n,e){if(1&n&&(V(),O(0,"g"),x(1,rut,1,5,"g",16),x(2,sut,1,5,"g",17),x(3,iut,1,5,"g",18),A()),2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C();z("transform",o.getPieceLocation(r,i)),T(1),w("ngIf",s===o.pieces.PAWN),T(1),w("ngIf",s===o.pieces.DRONE),T(1),w("ngIf",s===o.pieces.QUEEN)}}function aut(n,e){if(1&n){const t=Oe();V(),O(0,"g",14),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",15),x(2,out,4,4,"g",13),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();ke("id","click_",r,"_",s,""),z("transform",i.getPieceTranslation(s)),T(1),ke("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t!==i.pieces.EMPTY)}}function cut(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",22),J("click",function(){const i=he(t).$implicit;return ce(C(3).onClick(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C(3);T(1),ke("id","indicator_",t.x,"_",t.y,""),z("transform",r.getPieceTranslation(t.y))("x",t.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",t.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function lut(n,e){if(1&n&&(V(),O(0,"g"),x(1,cut,2,7,"g",1),A()),2&n){const t=C(2);T(1),w("ngForOf",t.selectedPieceInfo.get().legalLandings)}}function uut(n,e){if(1&n&&(V(),O(0,"g"),x(1,aut,3,11,"g",12),x(2,lut,2,1,"g",13),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngForOf",t),T(1),w("ngIf",r.selectedPieceInfo.isPresent())}}function fut(n,e){if(1&n&&(V(),O(0,"text",23),wt(1),A()),2&n){const t=C();w("ngClass","player"+t.getCurrentPlayer().value)("ngClass",t.getClockCircleClasses()),z("x",.5*t.SPACE_SIZE)("y",.5*t.SPACE_SIZE),T(1),c1(t.countDown.get())}}function hut(n,e){if(1&n&&(V(),X(0,"polyline",24)),2&n){const t=C();w("ngClass",t.getClockCircleClasses()),z("points",t.clockNeedlesPoints)}}const kT=function(n){return[n]};function dut(n,e){if(1&n){const t=Oe();V(),dn(0),O(1,"g",27),J("click",function(){const i=he(t).index;return ce(C(2).chooseStyle(i))}),A(),pn()}if(2&n){const t=e.$implicit,r=e.index,s=C(2);T(1),y2(t.style),w("id",t.name)("pieceClasses",b3(5,kT,"player"+s.getCurrentPlayer().value+"-fill")),z("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function put(n,e){if(1&n&&(V(),O(0,"g",25),X(1,"rect",26),x(2,dut,2,7,"ng-container",1),A()),2&n){const t=C();T(1),z("x",0)("y",-t.listOfStyles.length*t.SPACE_SIZE)("width",1*t.SPACE_SIZE)("height",t.listOfStyles.length*t.SPACE_SIZE),T(1),w("ngForOf",t.listOfStyles)}}function gut(n,e){if(1&n&&(V(),O(0,"text",33),wt(1),A()),2&n){const t=C(2).$implicit,r=C().$implicit,s=C();w("ngClass",s.getPlayerClass(r)),z("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),T(1),c1(t+" x ")}}function mut(n,e){if(1&n&&(V(),X(0,"g",34)),2&n){const t=C(3).$implicit,r=C();y2(r.style),w("pieceClasses",b3(3,kT,r.getPlayerClass(t)))}}function _ut(n,e){if(1&n&&(V(),X(0,"g",35)),2&n){const t=C(3).$implicit,r=C();y2(r.style),w("pieceClasses",b3(3,kT,r.getPlayerClass(t)))}}function vut(n,e){if(1&n&&(V(),X(0,"g",36)),2&n){const t=C(3).$implicit,r=C();y2(r.style),w("pieceClasses",b3(3,kT,r.getPlayerClass(t)))}}function Cut(n,e){if(1&n&&(V(),O(0,"g"),x(1,gut,2,4,"text",29),O(2,"g",28),x(3,mut,1,5,"g",30),x(4,_ut,1,5,"g",31),x(5,vut,1,5,"g",32),A()()),2&n){const t=C(),r=t.index,s=t.$implicit,i=C().$implicit,o=C();z("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),T(1),w("ngIf",s>1),T(1),ke("id","piece_",r,"_player_",i.value,""),z("transform","translate("+o.SPACE_SIZE+", 0)"),T(1),w("ngIf",0===r),T(1),w("ngIf",1===r),T(1),w("ngIf",2===r)}}function yut(n,e){if(1&n&&(V(),O(0,"g"),x(1,Cut,6,8,"g",13),A()),2&n){const t=e.$implicit;T(1),w("ngIf",t>0)}}function Eut(n,e){if(1&n&&(V(),O(0,"g")(1,"g",28),x(2,yut,2,1,"g",1),A()()),2&n){const t=e.$implicit,r=C();T(1),h1("id","capture_of_player_",t.value,""),z("transform",r.getCapturesTransformation(t)),T(1),w("ngForOf",r.state.getCapturesOf(t))}}let Uo=(()=>{class n extends to{constructor(t){super(t),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=Ht,this.selectedPieceInfo=y.empty(),this.countDown=y.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymmetricBoard=!0,this.rules=q3.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new nut(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=ps.encoder,this.tutorial=(new _4e).tutorial,this.scores=y.of([0,0]),this.updateBoard()}static getRegularPolygon(t,r=0){const s=n.getRegularPolygonCoords(t,r);return n.mapCoordsToString(s)}static getNPointedStar(t,r){const s=this.getNPointedStarCoords(t,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(t,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;t*=2;for(let c=0;c<t;c++){const h=(c*(360/t)+r)/180*Math.PI,g=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*g*Math.cos(h),M=o+.8*g*Math.sin(h);s.push(new S(m,M))}return s}static getRegularPolygonCoords(t,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<t;c++){const h=(c*(360/t)-90)/180*Math.PI,g=.5*n.SPACE_SIZE,m=i+.8*g*Math.cos(h),M=o+.8*g*Math.sin(h)+r;s.push(new S(m,M))}return s}static mapCoordsToString(t){let r="";for(const s of t)r+=s.x+", "+s.y+" ";return r}static getRadius(t){return this.SPACE_SIZE*t/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const t=this.STROKE_WIDTH,s=(this.SPACE_SIZE-t)/40;return"translate("+1*t+", "+1*t+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const t=.5*this.SPACE_SIZE;return t+" "+.1*this.SPACE_SIZE+", "+t+" "+t+", "+.75*this.SPACE_SIZE+" "+t}updateBoard(){this.state=this.getState(),this.board=this.state.board;const t=this.state.getScoreOf(B.ZERO),r=this.state.getScoreOf(B.ONE);this.countDown=this.state.countDown,this.scores=y.of([t,r])}getPieceLocation(t,r){return"translate("+this.SPACE_SIZE*t+", "+this.SPACE_SIZE*r+")"}getPieceClasses(t,r){const s=new S(t,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.node.move.isPresent()&&this.node.move.get().getEnd().equals(s)&&this.getPreviousState().getPieceAt(s)!==Ht.EMPTY&&this.getState().isInOpponentTerritory(new S(0,r))&&i.push("last-move-stroke"),i}onClick(t,r){var s=this;return I(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(t){var r=this;return I(function*(){return r.isOneOfUsersPieces(t)?r.selectAsFirstPiece(t):(r.cancelMoveAttempt(),R.SUCCESS)})()}selectAsFirstPiece(t){var r=this;return I(function*(){const s=r.getLegalLandings(t);return r.selectedPieceInfo=y.of({selectedPiece:t,legalLandings:s}),R.SUCCESS})()}getLegalLandings(t){const r=this.state.getPieceAt(t);let s;return s=r===Ht.PAWN?be.DIAGONALS.map(i=>t.getNext(i)):this.getValidLinearLandingSquareUntil(t,r===Ht.DRONE?2:8),s.filter(i=>{const o=ps.from(t,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(t,r){return be.DIRECTIONS.flatMap(s=>{const i=[];let o=t.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===Ht.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(t){var r=this;return I(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(t))return r.cancelMoveAttempt(),R.SUCCESS;if(s.legalLandings.some(i=>i.equals(t))){const i=ps.from(s.selectedPiece,t,r.callTheClock);return qe(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),r.chooseMove(i.get())}if(r.isOneOfUsersPieces(t))return r.selectAsFirstPiece(t);{const i=ps.from(s.selectedPiece,t,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(t){return this.state.getPieceAt(t)!==Ht.EMPTY&&this.state.isInPlayerTerritory(t)}cancelMoveAttempt(){this.selectedPieceInfo=y.empty(),this.callTheClock=!1}onClockClick(){var t=this;return I(function*(){const r=t.canUserPlay("#clockOrCountDownView");return r.isFailure()?t.cancelMove(r.getReason()):(t.getState().countDown.isAbsent()&&(t.callTheClock=!t.callTheClock),R.SUCCESS)})()}getClockCircleClasses(){const t=["base"];return this.callTheClock&&t.push("selected-stroke"),this.getCurrentPlayer()===B.ZERO?t.push("player0-stroke"):t.push("player1-stroke"),t}getSquareClasses(t,r){const s=new S(t,r),i=["base"];if(this.node.move.isPresent()){const o=this.node,c=o.move.get();c.getStart().equals(s)?i.push("moved-fill"):c.getEnd().equals(s)&&(o.mother.get().gameState.getPieceAt(s)===Ht.EMPTY||o.gameState.isInOpponentTerritory(new S(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(t){this.style=this.listOfStyles[t].style,this.displayModePanel=!1}getPieceTranslation(t){return"translate(0, "+(t<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(t){let i=this.SPACE_SIZE/2;return t===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"g"),x(2,uut,3,2,"g",1),A(),O(3,"g",2),J("click",function(){return r.onClockClick()}),X(4,"rect",3)(5,"circle",4),x(6,fut,2,5,"text",5),x(7,hut,1,2,"polyline",6),A(),O(8,"g",7)(9,"g",8),J("click",function(){return r.onModeCogClick()}),X(10,"rect",3)(11,"path",9),A(),x(12,put,3,5,"g",10),A(),O(13,"g",11),x(14,Eut,3,3,"g",1),A()()),2&t&&(z("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),T(1),z("transform",r.getBoardTransformation()),T(1),w("ngForOf",r.board),T(1),z("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),T(1),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngClass",r.getClockCircleClasses()),z("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),T(1),w("ngIf",r.countDown.isPresent()),T(1),w("ngIf",r.countDown.isAbsent()),T(1),z("transform",r.configViewTranslation),T(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngClass",r.getPlayerClass(r.getCurrentPlayer())),z("transform",r.configCogTransformation),T(1),w("ngIf",r.displayModePanel),T(2),w("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class z8 extends br{static getInitialState(){const e=Je.createTable(7,6,le.NONE);return new z8(e,0)}}class D1 extends eo{constructor(e){super(),this.x=e}static of(e){switch(e){case 0:return D1.ZERO;case 1:return D1.ONE;case 2:return D1.TWO;case 3:return D1.THREE;case 4:return D1.FOUR;case 5:return D1.FIVE;case 6:return D1.SIX;default:throw new Error("Invalid P4Move")}}equals(e){return this===e}toString(){return"P4Move("+this.x+")"}}D1.ZERO=new D1(0),D1.ONE=new D1(1),D1.TWO=new D1(2),D1.THREE=new D1(3),D1.FOUR=new D1(4),D1.FIVE=new D1(5),D1.SIX=new D1(6),D1.encoder=Ye.tuple([Ye.identity()],n=>[n.x],n=>D1.of(n[0]));let Mut=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})();var sl;let il=sl=class extends N1{constructor(){super(z8)}static get(){return sl.singleton.isAbsent()&&(sl.singleton=y.of(new sl)),sl.singleton.get()}static isInRange(e){return e.isInRange(7,6)}static getVictoriousCoords(e){return sl.P4_HELPER.getVictoriousCoord(e)}static getLowestUnoccupiedSpace(e,t){let r=0;for(;r<6&&e[r][t]===le.NONE;)r++;return r-1}static getListMoves(e){const t=e.gameState,r=[];for(let s=0;s<7;s++)if(t.getPieceAtXY(s,0)===le.NONE){const i=D1.of(s);r.push(i)}return r}applyLegalMove(e,t,r){const s=e.x,i=t.getCopiedBoard(),o=sl.getLowestUnoccupiedSpace(i,s),c=t.turn;return i[o][s]=t.getCurrentPlayer(),new z8(i,c+1)}isLegal(e,t){return t.getPieceAtXY(e.x,0).isPlayer()?R.failure(Mut.COLUMN_IS_FULL()):R.SUCCESS}getGameStatus(e){const t=e.gameState;return sl.P4_HELPER.getVictoriousCoord(t).length>0?Ne.getVictory(t.getCurrentOpponent()):42===t.turn?Ne.DRAW:Ne.ONGOING}};il.singleton=y.empty(),il.P4_HELPER=new _9(sl.isInRange,pe.identity,4),il=sl=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],il);let IF=class extends Xa{getListMoves(e){return il.getListMoves(e).sort((t,r)=>Math.abs(t.x-3)-Math.abs(r.x-3))}getBoardValue(e){const t=e.gameState;let r=0;for(let s=0;s<7;s++)for(let i=5;-1!==i&&t.board[i][s].isPlayer();i--){const o=il.P4_HELPER.getSquareScore(t,new S(s,i));if(x2.getScoreStatus(o)===Pn.VICTORY)return new Vn(o);r+=o}return new Vn(r)}};IF=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],IF);const Mt=le.NONE,D6=le.ZERO,T9=le.ONE;class v4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,z8.getInitialState()),ee.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,z8.getInitialState(),D1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),ee.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new z8([[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,T9,Mt,Mt,Mt],[Mt,Mt,Mt,T9,Mt,Mt,Mt],[Mt,Mt,D6,D6,D6,T9,Mt]],0),[D1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),ee.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new z8([[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,Mt,Mt,Mt,Mt],[Mt,Mt,Mt,D6,T9,Mt,Mt],[Mt,Mt,D6,D6,T9,Mt,Mt],[Mt,D6,T9,D6,D6,Mt,Mt]],0),[D1.of(3),D1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function Tut(n,e){if(1&n&&(V(),X(0,"circle",8)),2&n){const t=C().index,r=C().index,s=C();w("ngClass",s.getSquareFillClass(t,r)),z("cx",s.SPACE_SIZE*t+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function wut(n,e){if(1&n){const t=Oe();V(),O(0,"g",5),J("click",function(){const i=he(t).index;return ce(C(2).onClick(i))}),X(1,"rect",6),x(2,Tut,1,4,"circle",7),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();h1("id","click_",r,""),T(1),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t!==i.EMPTY)}}function but(n,e){if(1&n&&(V(),O(0,"g"),x(1,wut,3,6,"g",4),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Out(n,e){if(1&n&&(V(),X(0,"rect",9)),2&n){const t=C();z("x",t.SPACE_SIZE*t.last.get().x)("y",t.SPACE_SIZE*t.last.get().y)("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function Aut(n,e){if(1&n&&(V(),X(0,"rect",10)),2&n){const t=e.$implicit,r=C();ke("id","victory_coord_",t.x,"_",t.y,""),z("x",r.SPACE_SIZE*t.x)("y",r.SPACE_SIZE*t.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let Nut=(()=>{class n extends to{constructor(t){super(t),this.EMPTY=le.NONE,this.victoryCoords=[],this.rules=il.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new IF(this.rules,"P4Minimax")],this.encoder=D1.encoder,this.tutorial=(new v4e).tutorial,this.updateBoard()}onClick(t){var r=this;return I(function*(){const s=r.canUserPlay("#click_"+t);if(s.isFailure())return r.cancelMove(s.getReason());const i=D1.of(t);return yield r.chooseMove(i)})()}updateBoard(){const t=this.getState();this.victoryCoords=il.getVictoriousCoords(t),this.board=t.board,this.hideLastMove()}showLastMove(t){const r=this.getState(),s=il.getLowestUnoccupiedSpace(r.board,t.x)+1;this.last=y.of(new S(t.x,s))}hideLastMove(){this.last=y.empty()}getSquareFillClass(t,r){return[this.getPlayerClass(this.board[r][t])]}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,but,2,1,"g",1),x(2,Out,1,4,"rect",2),x(3,Aut,1,6,"rect",3),A()),2&t&&(T(1),w("ngForOf",r.board),T(1),w("ngIf",r.last.isPresent()),T(1),w("ngForOf",r.victoryCoords))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class xs extends us{constructor(e,t,r,s=!1){super(e,t),this.blockTurned=r,this.turnedClockwise=s,pe.assert(this.coord.isInRange(6,6),"The board is a 6 space wide square, invalid coord: "+this.coord.toString())}static of(e,t,r){return new xs(e.x,e.y,t,r)}static withRotation(e,t,r,s){return pe.assert(0<=r&&r<=3,"This block does not exist: "+r),new xs(e,t,y.of(r),s)}static rotationless(e,t){return new xs(e,t,y.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}xs.encoder=Ye.tuple([S.encoder,y.getEncoder(Ye.identity()),Ye.identity()],n=>[n.coord,n.blockTurned,n.turnedClockwise],n=>xs.of(n[0],n[1],n[2]));class LT extends bs{getListMoves(e){const t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return LT.FIRST_TURN_MOVES;const s=this.getLegalDrops(e.gameState);for(const i of s){const o=xs.rotationless(i.x,i.y),c=e.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const g of u)t.push(xs.withRotation(i.x,i.y,g[0],g[1]));0===c.neutralBlocks.length==0&&t.push(o)}return t}getLegalDrops(e){const t=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new S(s,r);e.getPieceAt(i)===le.NONE&&t.push(i)}return t}getLegalRotations(e,t){const r=0===e.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getMetrics(e){return[0,0]}}LT.FIRST_TURN_MOVES=[xs.rotationless(0,0),xs.rotationless(1,0),xs.rotationless(2,0),xs.rotationless(0,1),xs.rotationless(1,1),xs.rotationless(0,2)];let C4e=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class ao extends br{constructor(e,t){super(e,t),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const e=Je.createTable(6,6,le.NONE);return new ao(e,0)}getBlocksNeutralities(){const e=[];for(let t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}getBlockNeutrality(e){const t=ao.getBlockCenter(e),r=this.getPieceAt(t.getNext(be.UP,1)),s=this.getPieceAt(t.getNext(be.UP_LEFT,1));return this.getPieceAt(t.getNext(be.RIGHT,1))===r&&this.getPieceAt(t.getNext(be.DOWN,1))===r&&this.getPieceAt(t.getNext(be.LEFT,1))===r&&this.getPieceAt(t.getNext(be.UP_RIGHT,1))===s&&this.getPieceAt(t.getNext(be.DOWN_RIGHT,1))===s&&this.getPieceAt(t.getNext(be.DOWN_LEFT,1))===s}static getBlockCenter(e){return new S(1+(e%2==0?0:3),1+(e<2?0:3))}applyLegalDrop(e){const t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new ao(t,this.turn)}applyLegalMove(e){const t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){const i=ao.getBlockCenter(e.blockTurned.get()).toVector();if(e.turnedClockwise)for(const o of ao.ROTATION_MAP){const c=o[0].getNext(i),u=o[1].getNext(i),h=t.getPieceAt(c);r[u.y][u.x]=h}else for(const o of ao.ROTATION_MAP){const c=o[1].getNext(i),u=o[0].getNext(i),h=t.getPieceAt(c);r[u.y][u.x]=h}}return new ao(r,this.turn+1)}blockIsNeutral(e){return this.neutralBlocks.includes(e)}}ao.ROTATION_MAP=[[new S(-1,-1),new S(1,-1)],[new S(0,-1),new S(1,0)],[new S(1,-1),new S(1,1)],[new S(1,0),new S(0,1)],[new S(1,1),new S(-1,1)],[new S(0,1),new S(-1,0)],[new S(-1,1),new S(-1,-1)],[new S(-1,0),new S(0,-1)]];class ol extends N1{constructor(){super(ao)}static get(){return ol.singleton.isAbsent()&&(ol.singleton=y.of(new ol)),ol.singleton.get()}applyLegalMove(e,t,r){return t.applyLegalMove(e)}isLegal(e,t){if(t.getPieceAt(e.coord).isPlayer())return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());const r=t.applyLegalDrop(e);if(0===r.neutralBlocks.length){if(e.blockTurned.isAbsent())return R.failure(C4e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){const s=e.blockTurned.get();if(r.neutralBlocks.includes(s))return R.failure(C4e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return R.SUCCESS}getVictoryCoords(e){let t=[];for(const r of ol.VICTORY_SOURCE){const s=e.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)e.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(e.getPieceAt(o)===s&&(i.push(o),t=t.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);e.getPieceAt(u)===s&&(i.push(u),t=t.concat(i))}}}return t}getGameStatus(e){const t=e.gameState,r=this.getVictoryCoords(t),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[t.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?Ne.DRAW:Ne.ZERO_WON:!0===s[1]?Ne.ONE_WON:36===t.turn?Ne.DRAW:Ne.ONGOING}}ol.singleton=y.empty(),ol.VICTORY_SOURCE=[[new S(1,0),new Bt(1,1),!1],[new S(0,1),new Bt(1,1),!1],[new S(4,0),new Bt(-1,1),!1],[new S(5,1),new Bt(-1,1),!1],[new S(1,1),new Bt(1,1),!0],[new S(4,1),new Bt(-1,1),!0],[new S(0,1),new Bt(0,1),!0],[new S(1,1),new Bt(0,1),!0],[new S(2,1),new Bt(0,1),!0],[new S(3,1),new Bt(0,1),!0],[new S(4,1),new Bt(0,1),!0],[new S(5,1),new Bt(0,1),!0],[new S(1,0),new Bt(1,0),!0],[new S(1,1),new Bt(1,0),!0],[new S(1,2),new Bt(1,0),!0],[new S(1,3),new Bt(1,0),!0],[new S(1,4),new Bt(1,0),!0],[new S(1,5),new Bt(1,0),!0]];const Qe=le.NONE,al=le.ZERO,z6=le.ONE;class y4e{constructor(){this.tutorial=[ee.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,ao.getInitialState()),ee.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new ao([[al,Qe,Qe,al,z6,Qe],[al,z6,Qe,Qe,Qe,Qe],[al,Qe,z6,Qe,Qe,Qe],[al,Qe,Qe,Qe,Qe,z6],[al,Qe,Qe,Qe,z6,Qe],[Qe,Qe,Qe,Qe,Qe,Qe]],10)).withPreviousMove(xs.withRotation(0,0,0,!1)),ee.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new ao([[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,al,Qe,Qe,z6,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,z6,Qe,Qe,al,Qe],[Qe,Qe,Qe,Qe,Qe,Qe]],10),xs.rotationless(2,2),(e,t,r)=>e.blockTurned.isPresent()?R.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):R.SUCCESS,$localize`Congratulations!`),ee.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new ao([[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,al,Qe,Qe,z6,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,Qe,Qe,Qe,Qe,Qe],[Qe,z6,Qe,Qe,al,Qe],[Qe,Qe,Qe,Qe,Qe,Qe]],10),xs.withRotation(0,0,0,!0),(e,t,r)=>e.blockTurned.isPresent()?R.SUCCESS:R.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function Iut(n,e){if(1&n){const t=Oe();V(),O(0,"circle",12),J("click",function(){const i=he(t).$implicit,o=C().$implicit,c=C().index,u=C().index;return ce(C().onClick(3*c+i,3*u+o))}),A()}if(2&n){const t=e.$implicit,r=C().$implicit,s=C(),i=s.index,o=s.$implicit,c=C(),u=c.index,h=c.$implicit,g=C();ke("id","click_",3*i+t,"_",3*u+r,""),w("ngClass",g.getSquareClasses(3*i+t,3*u+r)),z("cx",o+2*g.STROKE_WIDTH+(t+.5)*g.SPACE_SIZE)("cy",h+2*g.STROKE_WIDTH+(r+.5)*g.SPACE_SIZE)("r",(g.SPACE_SIZE-g.STROKE_WIDTH)/2)}}const E4e=function(){return[0,1,2]};function xut(n,e){1&n&&(V(),dn(0),x(1,Iut,1,6,"circle",11),pn()),2&n&&(T(1),w("ngForOf",K1(1,E4e)))}function kut(n,e){if(1&n&&(V(),dn(0),X(1,"rect",10),x(2,xut,2,2,"ng-container",4),pn()),2&n){const t=e.$implicit,r=e.index,s=C(),i=s.index,o=s.$implicit,c=C();T(1),w("ngClass",c.getBlockClasses(r,i)),z("x",c.STROKE_WIDTH+t)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),T(1),w("ngForOf",K1(8,E4e))}}const M4e=function(n){return[0,n]};function Lut(n,e){if(1&n&&(V(),dn(0),x(1,kut,3,9,"ng-container",4),pn()),2&n){const t=C();T(1),w("ngForOf",b3(1,M4e,t.BLOCK_SEPARATION))}}function Rut(n,e){if(1&n&&(V(),X(0,"circle",13)),2&n){const t=C();ke("id","currentDrop_",t.currentDrop.get().x,"_",t.currentDrop.get().y,""),w("ngClass",t.getPlayerClass(t.getCurrentPlayer())),z("cx",t.getCenter(t.currentDrop.get().x))("cy",t.getCenter(t.currentDrop.get().y))("r",(t.SPACE_SIZE-t.STROKE_WIDTH)/2)}}function Dut(n,e){if(1&n){const t=Oe();V(),O(0,"path",14),J("click",function(){const i=he(t).$implicit;return ce(C().rotate(i))}),A()}if(2&n){const t=e.$implicit,r=C();ke("id","rotate_",t.blockIndex,"_",t.clockwise?"clockwise":"counterclockwise",""),z("d",t.path)("stroke-width",2*r.STROKE_WIDTH)}}function zut(n,e){if(1&n&&(V(),X(0,"path",15)),2&n){const t=C();ke("id","last_rotation_",t.lastRotation.get().blockIndex,"_",t.lastRotation.get().clockwise?"clockwise":"counterclockwise",""),z("d",t.lastRotation.get().path)("stroke-width",2*t.STROKE_WIDTH)}}function Hut(n,e){if(1&n&&(V(),X(0,"circle",16)),2&n){const t=e.$implicit,r=C();ke("id","victoryCoord_",t.x,"_",t.y,""),w("ngClass",r.getSquareClasses(t.x,t.y)),z("cx",r.getCenter(t.x))("cy",r.getCenter(t.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function Vut(n,e){if(1&n){const t=Oe();V(),O(0,"g",17),J("click",function(){return he(t),ce(C().skipRotation())}),X(1,"circle",18)(2,"line",19),A()}if(2&n){const t=C();T(1),z("cx",t.BLOCK_SEPARATION)("cy",t.BLOCK_SEPARATION)("r",.75*t.SPACE_SIZE)("stroke-width",2*t.STROKE_WIDTH),T(1),z("x1",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("y1",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("x2",t.BLOCK_SEPARATION+t.DIAGONAL_BAR_OFFSET)("y2",t.BLOCK_SEPARATION-t.DIAGONAL_BAR_OFFSET)("stroke-width",2*t.STROKE_WIDTH)}}let Fut=(()=>{class n extends to{constructor(t){super(t),this.arrows=[],this.victoryCoords=[],this.currentDrop=y.empty(),this.movedBlock=y.empty(),this.lastDrop=y.empty(),this.lastRotation=y.empty(),this.rules=ol.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new LT(this.rules,"PentagoMinimax")],this.encoder=xs.encoder,this.tutorial=(new y4e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.lastDrop=y.empty(),this.lastRotation=y.empty()}showLastMove(t){this.cancelMoveAttempt(),this.movedBlock=t.blockTurned;const r=new S(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&(this.showLastRotation(t),!1===r.equals(new S(0,0))&&this.coordBelongToBlock(t)))return this.showLastDrop(t,r);this.lastDrop=y.of(t.coord)}showLastRotation(t){if(t.blockTurned.isPresent()){const r=t.blockTurned.get(),s=this.ARROWS.filter(i=>i.blockIndex===r&&i.clockwise===t.turnedClockwise)[0];this.lastRotation=y.of(s)}}showLastDrop(t,r){let s;s=t.turnedClockwise?pe.getNonNullable(ao.ROTATION_MAP.find(h=>h[0].equals(r)))[1]:pe.getNonNullable(ao.ROTATION_MAP.find(h=>h[1].equals(r)))[0];const i=t.blockTurned.get(),u=new S(i%2==0?1:4,i<2?1:4);s=s.getNext(u,1),this.lastDrop=y.of(s)}coordBelongToBlock(t){return t.blockTurned.equalsValue(2*(t.coord.y<3?0:1)+(t.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=y.empty(),this.movedBlock=y.empty(),this.lastRotation=y.empty(),this.victoryCoords=[]}generateArrowsCoord(){const t=2*this.BLOCK_SEPARATION,s=this.SPACE_SIZE,i=t-s,o=2*s,c=.5*this.SPACE_SIZE;return[{path:"M "+c+" 0 q  "+s+" -"+s+"  "+o+"  0",blockIndex:0,clockwise:!0},{path:"M 0 "+c+" q -"+s+"  "+s+"  0  "+o,blockIndex:0,clockwise:!1},{path:"M "+t+" "+c+" q  "+s+"  "+s+"  0  "+o,blockIndex:1,clockwise:!0},{path:"M "+i+" 0 q -"+s+" -"+s+" -"+o+"  0",blockIndex:1,clockwise:!1},{path:"M 0 "+i+" q -"+s+" -"+s+"  0 -"+o,blockIndex:2,clockwise:!0},{path:"M "+c+" "+t+" q  "+s+"  "+s+"  "+o+"  0",blockIndex:2,clockwise:!1},{path:"M "+i+" "+t+" q -"+s+"  "+s+" -"+o+"  0",blockIndex:3,clockwise:!0},{path:"M "+t+" "+i+" q  "+s+" -"+s+"  0 -"+o,blockIndex:3,clockwise:!1}]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=y.empty(),this.canSkipRotation=!1}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hidePreviousMove(),s.board[r][t].isPlayer())return s.cancelMove(Xe.MUST_LAND_ON_EMPTY_SPACE());const o=xs.rotationless(t,r),u=s.getState().applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o);const h=s.rules.getGameStatus(s.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===h.isEndGame,s.currentDrop=y.of(new S(t,r)),s.displayArrows(u.neutralBlocks),R.SUCCESS})()}getCenter(t){return(t<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(t%3+.5)*this.SPACE_SIZE}displayArrows(t){this.arrows=[];for(let r=0;r<4;r++)if(!1===t.includes(r)){const s=this.ARROWS.filter(i=>i.blockIndex===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(t,r){return this.movedBlock.equalsValue(t+2*r)?["last-move-stroke"]:[]}getSquareClasses(t,r){const s=[],i=this.getPlayerClass(this.board[r][t]);return s.push(i),this.lastDrop.equalsValue(new S(t,r))&&s.push("last-move-stroke"),s}rotate(t){var r=this;return I(function*(){const i=r.canUserPlay("#rotate_"+t.blockIndex+"_"+(t.clockwise?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=xs.withRotation(o.x,o.y,t.blockIndex,t.clockwise);return r.chooseMove(c)})()}skipRotation(){var t=this;return I(function*(){const r=t.canUserPlay("#skipRotation");if(r.isFailure())return t.cancelMove(r.getReason());const s=t.currentDrop.get(),i=xs.rotationless(s.x,s.y);return t.chooseMove(i)})()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-pentago"]],features:[l],decls:13,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","bluearrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],["id","movedarrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto",1,"last-move-fill"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#bluearrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","no-fill last-move-stroke","marker-end","url(#movedarrowhead)",3,"id",4,"ngIf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["class","base","pointer-events","fill",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#bluearrowhead)",1,"no-fill",3,"id","click"],["marker-end","url(#movedarrowhead)",1,"no-fill","last-move-stroke",3,"id"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),A()(),O(4,"defs")(5,"marker",3),X(6,"polygon",2),A()(),x(7,Lut,2,3,"ng-container",4),x(8,Rut,1,6,"circle",5),x(9,Dut,1,4,"path",6),x(10,zut,1,4,"path",7),x(11,Hut,1,7,"circle",8),x(12,Vut,3,9,"g",9),A()),2&t&&(T(7),w("ngForOf",b3(6,M4e,r.BLOCK_SEPARATION)),T(1),w("ngIf",r.currentDrop.isPresent()),T(1),w("ngForOf",r.arrows),T(1),w("ngIf",r.lastRotation.isPresent()),T(1),w("ngForOf",r.victoryCoords),T(1),w("ngIf",r.canSkipRotation))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),W3=(()=>{class n extends br{constructor(t,r,s){super(t,s),this.captures=r}static getInitialState(){const t=Je.createTable(n.SIZE,n.SIZE,le.NONE);return t[9][9]=le.ONE,new n(t,[0,0],0)}}return n.SIZE=19,n})();class Ki extends us{constructor(e,t){super(e,t)}static isOnBoard(e){return e.isInRange(W3.SIZE,W3.SIZE)}static of(e){return pe.assert(Ki.isOnBoard(e),"PenteMove: coord is out of the board"),new Ki(e.x,e.y)}toString(){return`PenteMove(${this.coord.x}, ${this.coord.y})`}}Ki.encoder=us.getEncoder(Ki.of);class Ca extends N1{constructor(){super(W3)}static get(){return Ca.singleton.isAbsent()&&(Ca.singleton=y.of(new Ca)),Ca.singleton.get()}isLegal(e,t){return t.getPieceAt(e.coord).isPlayer()?R.failure(Xe.MUST_CLICK_ON_EMPTY_SQUARE()):R.SUCCESS}applyLegalMove(e,t,r){const s=t.getCurrentPlayer(),i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=s;const o=this.getCaptures(e.coord,t,s);for(const u of o)i[u.y][u.x]=le.NONE;const c=[t.captures[0],t.captures[1]];return c[s.value]+=o.length,new W3(i,c,t.turn+1)}getCaptures(e,t,r){const s=r.getOpponent(),i=[];for(const o of be.factory.all){const c=e.getNext(o,1),u=e.getNext(o,2),h=e.getNext(o,3);Ki.isOnBoard(c)&&t.getPieceAt(c)===s&&Ki.isOnBoard(u)&&t.getPieceAt(u)===s&&Ki.isOnBoard(h)&&t.getPieceAt(h)===r&&(i.push(c),i.push(u))}return i}getGameStatus(e){const t=e.gameState,r=t.getCurrentOpponent();return t.captures[r.value]>=10||Ca.PENTE_HELPER.getVictoriousCoord(t).length>0?Ne.getVictory(r):this.stillHaveEmptySquare(t)?Ne.ONGOING:Ne.DRAW}stillHaveEmptySquare(e){for(let t=0;t<W3.SIZE;t++)for(let r=0;r<W3.SIZE;r++)if(e.board[t][r]===le.NONE)return!0;return!1}}Ca.PENTE_HELPER=new _9(Ki.isOnBoard,pe.identity,5),Ca.singleton=y.empty();class But extends Xa{getListMoves(e){const r=[];return e.gameState.forEachCoord((s,i)=>{!1===i.isPlayer()&&r.push(Ki.of(s))}),r}getBoardValue(e){const t=Ca.get().getGameStatus(e);return t.isEndGame?Vn.fromWinner(t.winner):Ca.PENTE_HELPER.getBoardValue(e.gameState)}}const v=le.NONE,cl=le.ZERO,j3=le.ONE;class S4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Initial board and object of the game`,$localize`Pente is played on a 19x19 board, on which the pieces are put on the intersections of the squares. The object of the game is to align 5 of your pieces, or to capture 10 pieces of your opponent. Initially, a piece of the second player is in the center location of the board.`,W3.getInitialState()),ee.anyMove($localize`Dropping a piece`,$localize`At your turn, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,W3.getInitialState(),Ki.of(new S(9,8)),$localize`Congratulations!`),ee.fromMove($localize`Capturing`,$localize`You can capture exactly two pieces of your opponent by sandwiching them between two of your pieces.<br/><br/>You're playing Light and you can capture, do it!`,new W3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,cl,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,j3,cl,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,j3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],3),[Ki.of(new S(9,6))],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromMove($localize`Placing in a sandwich position`,$localize`You can safely place a piece next to another of your piece in what would look like a sandwich from the opponent's pieces. This is a safe move.<br/><br/>You're playing Light and have the opportunity to do such a move here, do it!`,new W3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,j3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,j3,cl,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,j3,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[0,0],4),[Ki.of(new S(9,7))],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromMove($localize`Victory`,$localize`Remember, to win you can either align 5 or your pieces, or capture 10 pieces of your opponent. Here, as Light, you have already captured 8 pieces and you only need two more to win.<br/><br/>You're playing Light, you can win in two ways. Win!`,new W3([[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,j3,v,v,cl,cl,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,cl,v,cl,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,j3,cl,cl,cl,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,j3,j3,j3,j3,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]],[8,8],7),[Ki.of(new S(9,6)),Ki.of(new S(8,9)),Ki.of(new S(13,9))],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function $ut(n,e){if(1&n&&(V(),X(0,"circle",8)),2&n){const t=C().index,r=C().index,s=C();ke("id","piece_",t,"_",r,""),w("ngClass",s.getSpaceClass(t,r)),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.22*s.SPACE_SIZE)}}function Gut(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=C(2).index,r=C().index,s=C();ke("id","hoshi_",t,"_",r,""),z("cx",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("cy",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("r",.1*s.SPACE_SIZE)}}function Uut(n,e){if(1&n&&(V(),X(0,"rect",9)(1,"line",10)(2,"line",10),x(3,Gut,1,5,"circle",11)),2&n){const t=C().index,r=C().index,s=C();z("width",.5*s.SPACE_SIZE)("height",.5*s.SPACE_SIZE)("x",.5*s.SPACE_SIZE*t)("y",.5*s.SPACE_SIZE*r),T(1),z("x1",.5*s.SPACE_SIZE*t)("y1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r)("x2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),z("x1",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y1",.5*s.SPACE_SIZE*r)("x2",.25*s.SPACE_SIZE+.5*s.SPACE_SIZE*t)("y2",.5*s.SPACE_SIZE+.5*s.SPACE_SIZE*r),T(1),w("ngIf",s.isHoshi(t,r))}}function qut(n,e){if(1&n){const t=Oe();V(),O(0,"g",5),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),x(1,$ut,1,6,"circle",6),x(2,Uut,4,13,"ng-template",null,7,Un),A()}if(2&n){const t=e.$implicit,r=e.index,s=Hn(3);ke("id","click_",r,"_",C().index,""),T(1),w("ngIf",t.isPlayer())("ngIfElse",s)}}function Wut(n,e){if(1&n&&(V(),O(0,"g"),x(1,qut,4,4,"g",4),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function jut(n,e){if(1&n){const t=Oe();V(),O(0,"circle",13),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()}if(2&n){const t=e.$implicit,r=C();ke("id","capture_",t.x,"_",t.y,""),z("cx",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*t.x)("cy",.25*r.SPACE_SIZE+.5*r.SPACE_SIZE*t.y)("r",.07*r.SPACE_SIZE)}}let Zut=(()=>{class n extends vF{constructor(t){super(t),this.lastMoved=y.empty(),this.victoryCoords=[],this.captured=[],this.scores=y.of([0,0]),this.rules=Ca.get(),this.node=this.rules.getInitialNode(),this.encoder=Ki.encoder,this.tutorial=(new S4e).tutorial,this.availableMinimaxes=[new But(this.rules,"Alignment")]}updateBoard(){const t=this.getState();this.board=t.board,this.scores=y.of(this.getState().captures),this.victoryCoords=Ca.PENTE_HELPER.getVictoriousCoord(t),this.createHoshis(),this.cancelMoveAttempt()}showLastMove(){const t=this.node.move.get();this.lastMoved=y.of(t.coord);const r=this.getCurrentPlayer().getOpponent();this.captured=Ca.get().getCaptures(t.coord,this.getPreviousState(),r)}cancelMoveAttempt(){this.lastMoved=y.empty(),this.captured=[]}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r);return s.chooseMove(Ki.of(o))})()}getSpaceClass(t,r){const s=new S(t,r),i=this.getState().getPieceAt(s),o=[];return o.push(this.getPlayerClass(i)),this.victoryCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),this.lastMoved.equalsValue(s)&&o.push("last-move-stroke"),o}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-new-game"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["class","captured-fill",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"id","ngClass"],["fill-opacity","0",1,"base","no-stroke"],[1,"base","mid-stroke"],["class","base-no-stroke",3,"id",4,"ngIf"],[1,"base-no-stroke",3,"id"],[1,"captured-fill",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),X(1,"rect",1),x(2,Wut,2,1,"g",2),x(3,jut,1,5,"circle",3),A()),2&t&&(z("viewBox","0 -3 "+r.board.length*r.SPACE_SIZE*.5+" "+(6+r.board.length*r.SPACE_SIZE*.5)),T(1),z("width",r.board.length*r.SPACE_SIZE*.5)("height",r.board.length*r.SPACE_SIZE*.5),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.captured))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class U_ extends S{constructor(e,t,r){super(e,t),this.z=r}static getCoord3DEncoder(e){return Ye.tuple([Ye.identity(),Ye.identity(),Ye.identity()],t=>[t.x,t.y,t.z],t=>e(t[0],t[1],t[2]))}static of(e,t,r){return new U_(e,t,r)}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}isHigherThan(e){return this.z>e.z}}class $n extends U_{constructor(e,t,r){super(e,t,r),pe.assert(0<=e&&e<=3,`PylosCoord: Invalid X: ${e}.`),pe.assert(0<=t&&t<=3,`PylosCoord: Invalid Y: ${t}.`),pe.assert(0<=r&&r<=3,`PylosCoord: Invalid Z: ${r}.`);const s=4-r;pe.assert(this.isInRange(s,s),this.toString()+" is not in range.")}static of(e,t,r){return new $n(e,t,r)}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const e=this.z-1;return[new $n(this.x,this.y,e),new $n(this.x+1,this.y,e),new $n(this.x,this.y+1,e),new $n(this.x+1,this.y+1,e)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const e=this.z+1,t=new S(this.x-1,this.y-1),r=new S(this.x,this.y-1),s=new S(this.x-1,this.y),i=new S(this.x,this.y),o=4-e;return[t,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new $n(c.x,c.y,e))}getNextValid(e){const t=new S(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?y.empty():y.of(new $n(t.x,t.y,this.z))}}$n.coordEncoder=U_.getCoord3DEncoder($n.of),$n.optionalEncoder=y.getEncoder($n.coordEncoder);let H8=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),P4e=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class Xr extends eo{constructor(e,t,r,s){super(),this.startingCoord=e,this.landingCoord=t,this.firstCapture=r,this.secondCapture=s}static ofClimb(e,t,r){const s=y.of(e),i=Xr.checkCaptures(r),o=new Xr(s,t,i.firstCapture,i.secondCapture);return pe.assert(t.isHigherThan(e),H8.MUST_MOVE_UPWARD()),o}static checkCaptures(e){let t=y.empty(),r=y.empty();if(e.length>0&&(t=y.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=y.of(e[1]),e[1].isHigherThan(e[0])&&(t=y.of(e[1]),r=y.of(e[0])),e.length>2)throw new Error(P4e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:t,secondCapture:r}}static ofDrop(e,t){const r=y.empty(),s=Xr.checkCaptures(t);return new Xr(r,e,s.firstCapture,s.secondCapture)}static changeCapture(e,t){const r=Xr.checkCaptures(t);return new Xr(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}static of(e,t,r,s){return new Xr(e,t,r,s)}isClimb(){return this.startingCoord.isPresent()}toString(){const e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+r+")"}equals(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}Xr.encoder=Ye.tuple([$n.optionalEncoder,$n.coordEncoder,$n.optionalEncoder,$n.optionalEncoder],n=>[n.startingCoord,n.landingCoord,n.firstCapture,n.secondCapture],n=>Xr.of(n[0],n[1],n[2],n[3]));class Z3 extends JP{constructor(e,t){super(t),this.boards=e}static getInitialState(){const e=Je.createTable(4,4,le.NONE),t=Je.createTable(3,3,le.NONE),r=Je.createTable(2,2,le.NONE);return new Z3([e,t,r,[[le.NONE]]],0)}static getLevelRange(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return pe.expectToBe(e,2),[0,1]}}getPieceAt(e){return this.boards[e.z][e.y][e.x]}applyLegalMove(e,t=!0){const r=[];let s;return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:le.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:le.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:le.NONE}),s=t?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(e,t){const r=[Je.copyBiArray(this.boards[0]),Je.copyBiArray(this.boards[1]),Je.copyBiArray(this.boards[2]),Je.copyBiArray(this.boards[3])];for(const s of e){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new Z3(r,t)}isLandable(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;const t=e.getLowerPieces();for(const r of t)if(this.getPieceAt(r)===le.NONE)return!1;return!0}isSupporting(e){if(3===e.z)return!1;const t=e.getHigherCoords();for(const r of t)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const e={};e[le.NONE.value]=0,e[B.ZERO.value]=0,e[B.ONE.value]=0;for(let t=0;t<3;t++)for(let r=0;r<4-t;r++)for(let s=0;s<4-t;s++){const i=new $n(s,r,t),o=this.getPieceAt(i);e[o.value]=1+e[o.value]}return e}removePieceAt(e){return this.setBoardAtCoords([{coord:e,value:le.NONE}],this.turn)}dropCurrentPlayersPieceAt(e){const t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAtCoords([t],this.turn)}getFreeToMoves(){const e=[],t=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=Z3.getLevelRange(r);for(const i of s)for(const o of s){const c=new $n(o,i,r);this.getPieceAt(c).equals(t)&&!1===this.isSupporting(c)&&e.push(c)}}return e}}class Pi extends N1{constructor(){super(Z3)}static get(){return Pi.singleton.isAbsent()&&(Pi.singleton=y.of(new Pi)),Pi.singleton.get()}static getStateInfo(e){const t=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new $n(o,i,s);e.getPieceAt(c)===e.getCurrentPlayer()&&!1===e.isSupporting(c)&&t.push(c),e.isLandable(c)&&r.push(c)}return{freeToMove:t,landable:r}}static getClimbingMoves(e){const t=[];for(const r of e.freeToMove)for(const s of e.landable)if(s.isHigherThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=Xr.ofClimb(r,s,[]);t.push(i)}return t}static getDropMoves(e){const t=[];for(const r of e.landable){const s=Xr.ofDrop(r,[]);t.push(s)}return t}static canCapture(e,t){const r=e.getCurrentPlayer();for(const s of[Fe.UP,Fe.DOWN]){const i=t.getNextValid(s);if(i.isPresent()&&e.getPieceAt(i.get())===r)for(const o of[Fe.LEFT,Fe.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&e.getPieceAt(c.get())===r){const u=s.getOpposite(),h=c.get().getNextValid(u).get();if(e.getPieceAt(h)===r)return!0}}}return!1}static getPossibleCaptures(e){const t=new Ot,r=e.getFreeToMoves();for(const s of r){t.add(new Ot([s]));const o=e.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new Ot([s,c]);t.add(u)}}return t}static applyLegalMove(e,t,r){return t.applyLegalMove(e)}static isValidCapture(e,t,r){const s=e.getCurrentPlayer();return!(!r.equals(t.landingCoord)&&e.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>e.getPieceAt(o).isPlayer()&&!1===o.equals(t.firstCapture.get())).length}static getGameStatus(e){const r=e.gameState.getPiecesRepartition();return 15===r[B.ZERO.value]?Ne.ONE_WON:15===r[B.ONE.value]?Ne.ZERO_WON:Ne.ONGOING}applyLegalMove(e,t,r){return Pi.applyLegalMove(e,t,r)}isLegal(e,t){const r=this.isLegalStartingCoord(e,t);if(r.isFailure())return r.toOtherFallible();const s=r.get(),i=this.isLegalLandingCoord(e,s);if(i.isFailure())return i.toOtherFallible();const o=i.get(),c=this.isLegalCaptures(e,o);return c.isFailure()?c:R.SUCCESS}isLegalStartingCoord(e,t){const r=t.getCurrentOpponent();if(e.startingCoord.isPresent()){const s=e.startingCoord.get(),i=t.getPieceAt(s);if(i===r)return _e.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===le.NONE)return _e.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>t.getPieceAt(c).isPlayer()).length){const c=t.removePieceAt(e.startingCoord.get());return _e.success(c)}return _e.failure(H8.CANNOT_MOVE_SUPPORTING_PIECE())}return _e.success(t)}isLegalLandingCoord(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?_e.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?_e.success(t.dropCurrentPlayersPieceAt(e.landingCoord)):_e.failure(H8.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(e,t){if(e.firstCapture.isAbsent())return R.SUCCESS;if(!1===Pi.canCapture(t,e.landingCoord))return R.failure(H8.CANNOT_CAPTURE());if(Pi.isValidCapture(t,e,e.firstCapture.get())){const r=t.removePieceAt(e.firstCapture.get());return e.secondCapture.isAbsent()||Pi.isValidCapture(r,e,e.secondCapture.get())?R.SUCCESS:R.failure(H8.INVALID_SECOND_CAPTURE())}return R.failure(H8.INVALID_FIRST_CAPTURE())}getGameStatus(e){return Pi.getGameStatus(e)}}Pi.singleton=y.empty();class q_ extends bs{static getListMoves(e){const t=e.gameState,r=[],s=Pi.getStateInfo(t),i=Pi.getClimbingMoves(s),o=Pi.getDropMoves(s),c=i.concat(o);for(const u of c){const h=t.applyLegalMove(u,!1);let g=new Ot;Pi.canCapture(h,u.landingCoord)?g=Pi.getPossibleCaptures(h):r.push(u);for(const m of g){const M=Xr.changeCapture(u,m.toList());r.push(M)}}return r}getListMoves(e){return q_.getListMoves(e)}getMetrics(e){const t=e.gameState.getPiecesRepartition();return[t[B.ZERO.value],t[B.ONE.value]]}}class w9 extends q_{static countStoneUsed(e){let t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}static sumMoveEmplacementByValue(e){let t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}getListMoves(e){const t=q_.getListMoves(e);return this.orderMoves(t)}orderMoves(e){return e.sort((t,r)=>{const s=12*w9.countStoneUsed(t),i=12*w9.countStoneUsed(r);return s+w9.sumMoveEmplacementByValue(t)-(i+w9.sumMoveEmplacementByValue(r))})}}const at=le.NONE,H6=le.ZERO,T4e=le.ONE;class w4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,Z3.getInitialState()),ee.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,Z3.getInitialState(),Xr.ofDrop(new $n(1,1,0),[]),$localize`There you go, as simple as that.`),ee.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new Z3([[[H6,T4e,at,at],[T4e,H6,at,at],[at,at,at,at],[at,at,at,H6]],[[at,at,at],[at,at,at],[at,at,at]],[[at,at],[at,at]],[[at]]],0),[Xr.ofClimb(new $n(3,3,0),new $n(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),ee.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new Z3([[[H6,H6,at,at],[at,H6,at,at],[at,at,at,at],[at,at,at,at]],[[at,at,at],[at,at,at],[at,at,at]],[[at,at],[at,at]],[[at]]],0),[Xr.ofDrop(new $n(0,1,0),[new $n(0,0,0)]),Xr.ofDrop(new $n(0,1,0),[new $n(0,1,0)]),Xr.ofDrop(new $n(0,1,0),[new $n(1,0,0)]),Xr.ofDrop(new $n(0,1,0),[new $n(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),ee.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new Z3([[[H6,H6,at,at],[at,H6,at,at],[at,at,at,at],[at,at,at,at]],[[at,at,at],[at,at,at],[at,at,at]],[[at,at],[at,at]],[[at]]],0),Xr.ofDrop(new $n(0,1,0),[new $n(0,0,0),new $n(1,0,0)]),(e,t,r)=>e.secondCapture.isPresent()?R.SUCCESS:e.firstCapture.isPresent()?R.failure($localize`Failed, you only captured one piece.`):R.failure(g4e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function Yut(n,e){if(1&n&&(V(),X(0,"circle",8)),2&n){const t=e.$implicit,r=C().$implicit,s=C();ke("id","piece_",r.value,"_",t,""),w("ngClass",s.getPlayerClass(r)),z("cx",s.SPACE_SIZE/4+t/15*(s.boardWidth-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function Kut(n,e){if(1&n&&(V(),O(0,"g"),x(1,Yut,1,6,"circle",7),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngForOf",r.getPlayerSidePieces(t))}}function Xut(n,e){if(1&n){const t=Oe();V(),O(0,"circle",12),J("click",function(){he(t);const s=C(2).$implicit,i=C().$implicit,o=C().$implicit;return ce(C().onPieceClick(s,i,o))}),A()}if(2&n){const t=C(2).$implicit,r=C().$implicit,s=C().$implicit,i=C();j2("id","piece_",t,"_",r,"_",s,""),w("ngClass",i.getPieceClasses(t,r,s)),z("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(t,r,s))("cy",i.getPieceCy(t,r,s))}}function Qut(n,e){if(1&n){const t=Oe();V(),O(0,"rect",12),J("click",function(){he(t);const s=C(3).$implicit,i=C().$implicit,o=C().$implicit;return ce(C().onDrop(s,i,o))}),A()}if(2&n){const t=C(3).$implicit,r=C().$implicit,s=C().$implicit,i=C();j2("id","drop_",t,"_",r,"_",s,""),w("ngClass",i.getSquareClasses(t,r,s)),z("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(t,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(t,r,s)-i.getPieceRadius(s))}}function Jut(n,e){if(1&n&&(V(),x(0,Qut,1,8,"rect",13)),2&n){const t=C(2).$implicit,r=C().$implicit,s=C().$implicit;w("ngIf",C().mustDisplayLandingCoord(t,r,s))}}function e5t(n,e){if(1&n&&(V(),dn(0),x(1,Xut,1,7,"circle",10),x(2,Jut,1,1,"ng-template",null,11,Un),pn()),2&n){const t=Hn(3),r=C().$implicit,s=C().$implicit,i=C().$implicit,o=C();T(1),w("ngIf",o.isOccupied(r,s,i))("ngIfElse",t)}}function t5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,e5t,4,2,"ng-container",9),A()),2&n){const t=e.$implicit,r=C().$implicit,s=C().$implicit,i=C();T(1),w("ngIf",i.mustDraw(t,r,s))}}function n5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,t5t,2,1,"g",1),A()),2&n){const t=C().$implicit,r=C();T(1),w("ngForOf",r.getLevelRange(t))}}function r5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,n5t,2,1,"g",1),A()),2&n){const t=e.$implicit,r=C();T(1),w("ngForOf",r.getLevelRange(t))}}function s5t(n,e){if(1&n&&(V(),X(0,"rect",14)),2&n){const t=C();j2("id","highCapture_",t.highCapture.get().x,"_",t.highCapture.get().y,"_",t.highCapture.get().z,""),z("width",2*t.getPieceRadius(t.highCapture.get().z))("height",2*t.getPieceRadius(t.highCapture.get().z))("x",t.getPieceCxByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))("y",t.getPieceCyByCoord(t.highCapture.get())-t.getPieceRadius(t.highCapture.get().z))}}function i5t(n,e){if(1&n){const t=Oe();V(),O(0,"g",15),J("click",function(){return he(t),ce(C().validateCapture())}),X(1,"circle",16)(2,"polygon",17),A()}if(2&n){const t=C();z("transform","translate("+4*t.SPACE_SIZE+" "+4*t.SPACE_SIZE+")"),T(1),w("ngClass",t.getCaptureValidationButtonClasses()),z("cx",t.STROKE_WIDTH/2)("cy",t.STROKE_WIDTH/2)("r",t.SPACE_SIZE/2)}}function o5t(n,e){if(1&n){const t=Oe();V(),O(0,"g",18),J("click",function(){const i=he(t).$implicit;return ce(C().onPieceClick(i.x,i.y,i.z))}),X(1,"line",19)(2,"line",19),A()}if(2&n){const t=e.$implicit,r=C();j2("id","capturable_",t.x,"_",t.y,"_",t.z,""),z("transform","translate("+r.getPieceCxByCoord(t)+" "+r.getPieceCyByCoord(t)+")"),T(1),z("x1",-.25*r.getPieceRadius(t.z))("y1",-.25*r.getPieceRadius(t.z))("x2",.25*r.getPieceRadius(t.z))("y2",.25*r.getPieceRadius(t.z)),T(1),z("x1",.25*r.getPieceRadius(t.z))("y1",-.25*r.getPieceRadius(t.z))("x2",-.25*r.getPieceRadius(t.z))("y2",.25*r.getPieceRadius(t.z))}}const a5t=function(){return[0,1,2]};let c5t=(()=>{class n extends b8{constructor(t){super(t),this.boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.pieceRowHeight=this.SPACE_SIZE/2,this.boardHeight=this.boardWidth+2*this.pieceRowHeight,this.lastLandingCoord=y.empty(),this.lastStartingCoord=y.empty(),this.lastFirstCapture=y.empty(),this.lastSecondCapture=y.empty(),this.highCapture=y.empty(),this.capturables=[],this.chosenStartingCoord=y.empty(),this.chosenLandingCoord=y.empty(),this.chosenFirstCapture=y.empty(),this.chosenSecondCapture=y.empty(),this.lastMove=y.empty(),this.remainingPieces={0:15,1:15},this.hasAsymmetricBoard=!0,this.rules=Pi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new q_(this.rules,"PylosMinimax"),new w9(this.rules,"PylosOrderedMinimax")],this.encoder=Xr.encoder,this.tutorial=(new w4e).tutorial,this.updateBoard()}getPiecesCyForPlayer(t){return t===B.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(t){return Z3.getLevelRange(t)}mustDraw(t,r,s){const i=new $n(t,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(t){return this.chosenFirstCapture.equalsValue(t)||this.chosenSecondCapture.equalsValue(t)}onPieceClick(t,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#piece_"+t+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new $n(t,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),R.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(H8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(H8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(t,r){return r.isSupporting(t)}onClimbClick(t){var r=this;return I(function*(){return r.chosenStartingCoord=y.of(t),r.constructedState=r.constructedState.removePieceAt(t),R.SUCCESS})()}onCaptureClick(t){var r=this;return I(function*(){return r.chosenFirstCapture.equalsValue(t)?(r.chosenFirstCapture=y.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(t),r.updateCapturableList(),R.SUCCESS):r.chosenSecondCapture.equalsValue(t)?(r.chosenSecondCapture=y.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(t),r.updateCapturableList(),R.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=y.of(t),r.constructedState=r.constructedState.removePieceAt(t),r.updateCapturableList(),R.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=y.of(t),r.constructedState=r.constructedState.removePieceAt(t),r.updateCapturableList(),R.SUCCESS):r.cancelMove(P4e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var t=this;return I(function*(){const r=t.canUserPlay("#capture_validation");return r.isFailure()?t.cancelMove(r.getReason()):t.chosenFirstCapture.isAbsent()&&t.chosenSecondCapture.isAbsent()?R.SUCCESS:t.chosenFirstCapture.isPresent()&&t.chosenSecondCapture.isAbsent()?t.concludeMoveWithCapture([t.chosenFirstCapture.get()]):t.chosenFirstCapture.isAbsent()&&t.chosenSecondCapture.isPresent()?t.concludeMoveWithCapture([t.chosenSecondCapture.get()]):t.concludeMoveWithCapture([t.chosenFirstCapture.get(),t.chosenSecondCapture.get()])})()}concludeMoveWithCapture(t){var r=this;return I(function*(){if(r.chosenStartingCoord.isAbsent()){const s=Xr.ofDrop(r.chosenLandingCoord.get(),t);return r.chooseMove(s)}{const s=Xr.ofClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),t);return r.chooseMove(s)}})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=y.empty(),this.chosenLandingCoord=y.empty(),this.chosenFirstCapture=y.empty(),this.chosenSecondCapture=y.empty(),this.capturables=[]}onDrop(t,r,s){var i=this;return I(function*(){const o=i.canUserPlay("#drop_"+t+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new $n(t,r,s);return Pi.canCapture(i.constructedState,c)?(i.chosenLandingCoord=y.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),R.SUCCESS):(i.chosenLandingCoord=y.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(t,r,s){const i=new $n(t,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(t){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(t)}getPieceRadius(t){return this.SPACE_SIZE*(.45+.025*t)}getPieceCx(t,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+t*this.SPACE_SIZE}getPieceCy(t,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(t){return this.getPieceCx(t.x,t.y,t.z)}getPieceCyByCoord(t){return this.getPieceCy(t.x,t.y,t.z)}isOccupied(t,r,s){const i=new $n(t,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(t,r,s){const i=new $n(t,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(t){return this.chosenLandingCoord.equalsValue(t)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(t))}getPlayerSidePieces(t){const r=this.remainingPieces[t.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.node.move;const t=this.state.getPiecesRepartition();this.remainingPieces={0:15-t[0],1:15-t[1]},this.highCapture=y.empty(),this.cancelMoveAttempt(),this.hideLastMove()}showLastMove(t){this.lastLandingCoord=y.of(t.landingCoord),this.lastStartingCoord=t.startingCoord,this.lastFirstCapture=t.firstCapture,this.lastSecondCapture=t.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=y.empty(),this.lastLandingCoord=y.empty(),this.lastFirstCapture=y.empty(),this.lastSecondCapture=y.empty()}mustDrawCoord(t){return this.mustDraw(t.x,t.y,t.z)}mustDisplayLandingCoord(t,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new $n(t,r,s))||this.chosenStartingCoord.get().z<s}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"g"),x(2,Kut,2,1,"g",1),A(),O(3,"g",null,2),X(5,"rect",3),x(6,r5t,2,1,"g",1),x(7,s5t,1,7,"rect",4),x(8,i5t,3,5,"g",5),x(9,o5t,3,12,"g",6),A()()),2&t&&(z("viewBox","0 0 "+r.boardWidth+" "+r.boardHeight),T(1),z("transform","rotate("+180*r.role.value+" "+r.boardWidth/2+" "+r.boardHeight/2+")"),T(1),w("ngForOf",r.Player.PLAYERS),T(1),z("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.pieceRowHeight)+")"),T(2),z("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),T(1),w("ngForOf",K1(10,a5t)),T(1),w("ngIf",r.highCapture.isPresent()),T(1),w("ngIf",r.chosenLandingCoord.isPresent()),T(1),w("ngForOf",r.capturables))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ke{constructor(e){this.value=e}static ofInt(e){if(0<=e&&e<=15)return Ke.pieces[e];if(16===e)return Ke.EMPTY;throw new Error("Invalid piece ("+e+")")}equals(e){return this===e}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}Ke.AAAA=new Ke(0),Ke.AAAB=new Ke(1),Ke.AABA=new Ke(2),Ke.AABB=new Ke(3),Ke.ABAA=new Ke(4),Ke.ABAB=new Ke(5),Ke.ABBA=new Ke(6),Ke.ABBB=new Ke(7),Ke.BAAA=new Ke(8),Ke.BAAB=new Ke(9),Ke.BABA=new Ke(10),Ke.BABB=new Ke(11),Ke.BBAA=new Ke(12),Ke.BBAB=new Ke(13),Ke.BBBA=new Ke(14),Ke.BBBB=new Ke(15),Ke.EMPTY=new Ke(16),Ke.pieces=[Ke.AAAA,Ke.AAAB,Ke.AABA,Ke.AABB,Ke.ABAA,Ke.ABAB,Ke.ABBA,Ke.ABBB,Ke.BAAA,Ke.BAAB,Ke.BABA,Ke.BABB,Ke.BBAA,Ke.BBAB,Ke.BBBA,Ke.BBBB],Ke.encoder=Ye.fromFunctions(n=>n.value,Ke.ofInt);class ll extends us{constructor(e,t,r){super(e,t),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(e){return this===e||!1!==e.coord.equals(this.coord)&&this.piece===e.piece}}ll.encoder=Ye.tuple([S.encoder,Ke.encoder],n=>[n.coord,n.piece],n=>new ll(n[0].x,n[0].y,n[1]));class Y3 extends br{constructor(e,t,r){super(e,t),this.pieceInHand=r}static getInitialState(){const e=Je.createTable(4,4,Ke.EMPTY);return new Y3(e,0,Ke.AAAA)}static isGivable(e,t,r){return e!==r&&!1===Y3.isAlreadyOnBoard(e,t)}static isAlreadyOnBoard(e,t){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(t[r][s]===e)return!0;return!1}getRemainingPieces(){const e=Ke.pieces,t=[];for(const r of e)Y3.isGivable(r,this.board,this.pieceInHand)&&t.push(r);return t}}let xF=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class W_{constructor(e){this.subCriterion=[y.empty(),y.empty(),y.empty(),y.empty()],this.subCriterion[0]=y.of(8==(8&e.value)),this.subCriterion[1]=y.of(4==(4&e.value)),this.subCriterion[2]=y.of(2==(2&e.value)),this.subCriterion[3]=y.of(1==(1&e.value))}mergeWith(e){let t=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(e.subCriterion[r])&&(this.subCriterion[r]=y.empty()),this.subCriterion[r].isAbsent()&&t--;return t>0}mergeWithQuartoPiece(e){const t=new W_(e);return this.mergeWith(t)}areAllAbsent(){for(let e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}match(e){for(let t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}matchPiece(e){return this.match(new W_(e))}toString(){return"Criterion{"+this.subCriterion.map(e=>e.isPresent()?e.get()?"1":"0":"x").join(" ")+"}"}}class ul{constructor(e,t){this.initialCoord=e,this.direction=t}allCoords(){const e=[];for(let t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}class gs extends N1{constructor(){super(Y3)}static get(){return gs.singleton.isAbsent()&&(gs.singleton=y.of(new gs)),gs.singleton.get()}static isOccupied(e){return e!==Ke.EMPTY}static isLegal(e,t){const r=e.coord.x,s=e.coord.y,i=e.piece,o=t.getCopiedBoard(),c=t.pieceInHand;return gs.isOccupied(o[s][r])?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):i===Ke.EMPTY?15===t.turn?R.SUCCESS:R.failure(xF.MUST_GIVE_A_PIECE()):Y3.isAlreadyOnBoard(i,o)?R.failure(xF.PIECE_ALREADY_ON_BOARD()):c===i?R.failure(xF.CANNOT_GIVE_PIECE_IN_HAND()):R.SUCCESS}isLegal(e,t){return gs.isLegal(e,t)}applyLegalMove(e,t,r){const s=t.getCopiedBoard();return s[e.coord.y][e.coord.x]=t.pieceInHand,new Y3(s,t.turn+1,e.piece)}static updateBoardStatus(e,t,r){return r.score===Pn.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:Pn.VICTORY,sensitiveSquares:new Or}:r:this.searchForVictoryOrPreVictoryInLine(e,t,r)}static isThereAVictoriousLine(e,t){let r=e.initialCoord,s=t.getPieceAt(r);const i=new W_(s);for(let o=0;o<3&&!1!==gs.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(e.direction,1),s=t.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!gs.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(e,t,r){const s=gs.getLineInfos(e,t,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:Pn.VICTORY,sensitiveSquares:new Or};{i.get().matchPiece(t.pieceInHand)&&(r.score=Pn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(e,t,r){let s=y.empty(),i=y.empty(),o=e.initialCoord;for(let c=0;c<4;c++){const u=t.getPieceAt(o);if(u===Ke.EMPTY){if(!s.isAbsent())return{sensitiveCoord:y.of(o),commonCriterion:i,boardStatus:y.of(r)};s=y.of(o)}else i.isAbsent()?(i=y.of(new W_(u)),We.display("QuartoRules","getLineInfos","set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),We.display("QuartoRules","getLineInfos","update commonCrit: "+i.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:y.empty()}}static scoreToGameStatus(e,t){const r=B.of(t%2);return e===Pn.VICTORY?Ne.getDefeat(r):16===t?Ne.DRAW:Ne.ONGOING}getGameStatus(e){const t=e.gameState;let r={score:Pn.DEFAULT,sensitiveSquares:new Or};for(const s of gs.lines)if(r=gs.updateBoardStatus(s,t,r),r.score===Pn.VICTORY)return gs.scoreToGameStatus(r.score,t.turn);return gs.scoreToGameStatus(r.score,t.turn)}getVictoriousCoords(e){for(const t of gs.lines)if(gs.isThereAVictoriousLine(t,e))return t.allCoords();return[]}}gs.singleton=y.empty(),gs.lines=[new ul(new S(0,0),be.DOWN),new ul(new S(1,0),be.DOWN),new ul(new S(2,0),be.DOWN),new ul(new S(3,0),be.DOWN),new ul(new S(0,0),be.RIGHT),new ul(new S(0,1),be.RIGHT),new ul(new S(0,2),be.RIGHT),new ul(new S(0,3),be.RIGHT),new ul(new S(0,0),be.DOWN_RIGHT),new ul(new S(0,3),be.UP_RIGHT)];class kF extends Xa{static scoreToBoardValue(e,t){if(e===Pn.DEFAULT)return new Vn(0);{const r=B.of(t%2);return new Vn(e===Pn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(e){const t=[],r=e.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let h=0;h<4;h++)if(s[u][h]===Ke.EMPTY){if(c=r.getCopiedBoard(),c[u][h]=o,15===r.turn){const g=new ll(h,u,Ke.EMPTY);return t.push(g),t}for(const g of i){const m=new ll(h,u,g);t.push(m)}}return t}getBoardValue(e){const t=e.gameState;let r={score:Pn.DEFAULT,sensitiveSquares:new Or};for(const s of gs.lines)if(r=gs.updateBoardStatus(s,t,r),r.score===Pn.VICTORY)break;return kF.scoreToBoardValue(r.score,t.turn)}}const l5t=Ke.AABA,u5t=Ke.AABB,b4e=Ke.ABAA,f5t=Ke.ABAB,h5t=Ke.ABBA,O4e=Ke.BAAA,d5t=Ke.BAAB,p5t=Ke.BABB,A4e=Ke.BBAA,g5t=Ke.BBAB,LF=Ke.BBBA,m5t=Ke.BBBB,z1=Ke.EMPTY;class N4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Y3([[LF,A4e,b4e,l5t],[z1,z1,z1,z1],[z1,z1,z1,z1],[z1,z1,z1,z1]],7,Ke.ABAB)),ee.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Y3([[LF,u5t,h5t,z1],[z1,z1,z1,z1],[z1,O4e,z1,z1],[z1,z1,z1,z1]],7,Ke.ABAA),new ll(2,2,Ke.BAAB),$localize`Perfect!`),ee.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Y3([[m5t,LF,g5t,z1],[b4e,p5t,A4e,z1],[f5t,O4e,d5t,z1],[z1,z1,z1,z1]],7,Ke.AABA),[new ll(3,3,Ke.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}}function _5t(n,e){if(1&n&&(V(),X(0,"rect",12)),2&n){const t=C(2),r=t.$implicit,s=t.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),z("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function v5t(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=C(2),r=t.$implicit,s=t.index,i=C().index,o=C();w("ngClass",o.getPieceClasses(r.value)),z("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function C5t(n,e){if(1&n&&(V(),X(0,"circle")),2&n){const t=C(2).index,r=C().index,s=C();z("cx",s.SPACE_SIZE*t+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function y5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,_5t,1,5,"rect",10),x(2,v5t,1,4,"ng-template",null,11,Un),x(4,C5t,1,3,"circle",7),A()),2&n){const t=Hn(3),r=C().$implicit,s=C(2);T(1),w("ngIf",r.isRectangle())("ngIfElse",t),T(3),w("ngIf",s.pieceHasDot(r.value))}}function E5t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",9),J("click",function(){const i=he(t).index,o=C().index;return ce(C().chooseCoord(i,o))}),A(),x(2,y5t,5,3,"g",7),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","chooseCoord_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t!==i.EMPTY)}}function M5t(n,e){if(1&n&&(V(),O(0,"g",null,8),x(2,E5t,3,8,"g",2),A()),2&n){const t=e.$implicit;T(2),w("ngForOf",t)}}function S5t(n,e){if(1&n&&(V(),X(0,"rect",17)),2&n){const t=C(2);w("ngClass",t.getPieceClasses(t.pieceInHand.value)),z("x",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("y",t.SPACE_SIZE/2-t.getPieceSize(t.pieceInHand.value))("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function P5t(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=C(2);w("ngClass",t.getPieceClasses(t.pieceInHand.value)),z("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",t.getPieceSize(t.pieceInHand.value))}}function T5t(n,e){if(1&n&&(V(),X(0,"circle")),2&n){const t=C(2);z("cx",t.SPACE_SIZE/2)("cy",t.SPACE_SIZE/2)("r",10)}}function w5t(n,e){if(1&n){const t=Oe();V(),O(0,"g",13,14),J("click",function(){return he(t),ce(C().deselectDroppedPiece())}),X(2,"rect",15),x(3,S5t,1,5,"rect",16),x(4,P5t,1,4,"ng-template",null,11,Un),x(6,T5t,1,3,"circle",7),A()}if(2&n){const t=Hn(5),r=C();ke("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),z("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),T(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),T(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",t),T(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function b5t(n,e){if(1&n&&(V(),O(0,"g",null,18),X(2,"rect",19),A()),2&n){const t=e.$implicit,r=C();T(2),z("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+t.x*r.SPACE_SIZE+" "+t.y*r.SPACE_SIZE+")")}}function O5t(n,e){if(1&n&&(V(),X(0,"rect",12)),2&n){const t=C(2);w("ngClass",t.getPieceClasses(t.pieceInHand.value)),z("x",0)("y",.75*t.SPACE_SIZE)("transform","translate("+-t.getPieceSize(t.pieceInHand.value)+", "+-t.getPieceSize(t.pieceInHand.value)+")")("width",2*t.getPieceSize(t.pieceInHand.value))("height",2*t.getPieceSize(t.pieceInHand.value))}}function A5t(n,e){if(1&n&&(V(),X(0,"circle",21)),2&n){const t=C(2);w("ngClass",t.getPieceClasses(t.pieceInHand.value)),z("cy",.75*t.SPACE_SIZE)("r",t.getPieceSize(t.pieceInHand.value))}}function N5t(n,e){1&n&&(V(),X(0,"circle",22)),2&n&&z("cy",.75*C(2).SPACE_SIZE)("r",10)}function I5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,O5t,1,6,"rect",10),x(2,A5t,1,3,"ng-template",null,11,Un),x(4,N5t,1,2,"circle",20),A()),2&n){const t=Hn(3),r=C();T(1),w("ngIf",r.pieceInHand.isRectangle())("ngIfElse",t),T(3),w("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function x5t(n,e){if(1&n&&(V(),X(0,"rect",27)),2&n){const t=C(2).index,r=C().index,s=C();h1("id","chosenPiece_",4*r+t,""),z("x",s.SPACE_SIZE*t)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function k5t(n,e){if(1&n&&(V(),X(0,"rect",12)),2&n){const t=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+t)),z("x",s.SPACE_SIZE*t+s.SPACE_SIZE/2-s.getPieceSize(4*r+t))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+t))("width",2*s.getPieceSize(4*r+t))("height",2*s.getPieceSize(4*r+t))}}function L5t(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=C(2).index,r=C().index,s=C();w("ngClass",s.getPieceClasses(4*r+t)),z("cx",s.SPACE_SIZE*t+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+t))}}function R5t(n,e){if(1&n&&(V(),X(0,"circle")),2&n){const t=C(2).index,r=C().index,s=C();z("cx",s.SPACE_SIZE*t+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function D5t(n,e){if(1&n){const t=Oe();V(),O(0,"g",13),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().choosePiece(4*i+s))}),x(1,x5t,1,5,"rect",26),x(2,k5t,1,5,"rect",10),x(3,L5t,1,4,"ng-template",null,11,Un),x(5,R5t,1,3,"circle",7),A()}if(2&n){const t=Hn(4),r=C().index,s=C().index,i=C();h1("id","choosePiece_",4*s+r,""),T(1),w("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.ofInt(4*s+r))),T(1),w("ngIf",(4*s+r)%4<2)("ngIfElse",t),T(3),w("ngIf",i.pieceHasDot(4*s+r))}}function z5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,D5t,6,5,"g",3),A()),2&n){const t=e.index,r=C().index,s=C();T(1),w("ngIf",s.isRemaining(4*r+t))}}function H5t(n,e){if(1&n&&(V(),O(0,"g",null,23),X(2,"rect",24,25),x(4,z5t,2,1,"g",2),A()),2&n){const t=e.$implicit,r=C();z("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),T(2),z("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),T(2),w("ngForOf",t)}}let V5t=(()=>{class n extends to{constructor(t){super(t),this.EMPTY=Ke.EMPTY,this.QuartoPiece=Ke,this.chosen=y.empty(),this.lastMove=y.empty(),this.pieceInHand=Ke.EMPTY,this.pieceToGive=y.empty(),this.victoriousCoords=[],this.rules=gs.get(),this.node=this.rules.getInitialNode(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new kF(this.rules,"QuartoMinimax")],this.encoder=ll.encoder,this.tutorial=(new N4e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const t=this.getState(),r=this.node.move;this.board=t.getCopiedBoard(),this.chosen=y.empty(),this.pieceInHand=t.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(t),this.lastMove=r.map(s=>s.coord)}chooseCoord(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#chooseCoord_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][t]===Ke.EMPTY){if(s.showPieceInHandOnBoard(t,r),15===s.getState().turn){const o=new ll(t,r,Ke.EMPTY);return s.chooseMove(o)}if(s.pieceToGive.isAbsent())return R.SUCCESS;{const o=new ll(t,r,s.pieceToGive.get());return s.chooseMove(o)}}return s.cancelMove(Xe.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(t){var r=this;return I(function*(){const s=r.canUserPlay("#choosePiece_"+t);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(Ke.ofInt(t)))return r.cancelMoveAttempt(),R.SUCCESS;if(r.pieceToGive=y.of(Ke.ofInt(t)),r.chosen.isAbsent())return R.SUCCESS;{const i=r.chosen.get(),o=new ll(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o)}})()}hideLastMove(){this.lastMove=y.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=y.empty(),this.chosen=y.empty()}deselectDroppedPiece(){const t=this.chosen.getOrElse(new S(404,404)),s=this.canUserPlay("#droppedPiece_"+t.x+"_"+t.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),R.SUCCESS)}showPieceInHandOnBoard(t,r){this.chosen=y.of(new S(t,r))}isRemaining(t){return Y3.isGivable(Ke.ofInt(t),this.board,this.pieceInHand)}getSquareClasses(t,r){const s=new S(t,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(t){const r=[];return r.push(t%2==0?"player0-fill":"player1-fill"),r}getPieceSize(t){return t<8?40:25}pieceHasDot(t){return t!==Ke.EMPTY.value&&t%8<4}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"g",1),x(2,M5t,3,1,"g",2),x(3,w5t,7,8,"g",3),x(4,b5t,3,3,"g",2),O(5,"g",null,4),X(7,"rect",5,6),x(9,I5t,5,3,"g",7),A(),x(10,H5t,5,6,"g",2),A()()),2&t&&(z("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),T(2),w("ngForOf",r.board),T(1),w("ngIf",r.chosen.isPresent()),T(1),w("ngForOf",r.victoriousCoords),T(1),z("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),T(2),z("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),T(2),w("ngIf",r.chosen.isAbsent()),T(1),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),F5t=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class rc extends us{constructor(e,t,r){super(e,t),this.direction=r;const s=rc.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===e&&r===Fe.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&r===Fe.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===t&&r===Fe.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===t&&r===Fe.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isInRange(e){return e.isInRange(5,5)}static isValidCoord(e){return!1===rc.isInRange(e)?R.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?R.failure(F5t.NO_INSIDE_CLICK()):R.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}rc.encoder=Ye.tuple([S.encoder,Fe.encoder],n=>[n.coord,n.direction],n=>new rc(n[0].x,n[0].y,n[1]));class f7 extends br{static getInitialState(){const e=Je.createTable(5,5,le.NONE);return new f7(e,0)}applyLegalMove(e){const t=this.getCopiedBoard(),r=this.turn+1;let s=e.coord,i=e.coord.getNext(e.direction);for(;rc.isInRange(i);)t[s.y][s.x]=t[i.y][i.x],s=s.getNext(e.direction),i=i.getNext(e.direction);return t[s.y][s.x]=this.getCurrentPlayer(),new f7(t,r)}}class Xi extends N1{constructor(){super(f7)}static get(){return Xi.singleton.isAbsent()&&(Xi.singleton=y.of(new Xi)),Xi.singleton.get()}static getVerticalCoords(e){const t=e.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)e.gameState.getPieceAtXY(0,s)!==t&&r.push(new S(0,s)),e.gameState.getPieceAtXY(4,s)!==t&&r.push(new S(4,s));return r}static getHorizontalCenterCoords(e){const t=e.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)e.gameState.getPieceAtXY(s,0)!==t&&r.push(new S(s,0)),e.gameState.getPieceAtXY(s,4)!==t&&r.push(new S(s,4));return r}static getPossibleDirections(e){const t=[];return 0!==e.x&&t.push(Fe.LEFT),0!==e.y&&t.push(Fe.UP),4!==e.x&&t.push(Fe.RIGHT),4!==e.y&&t.push(Fe.DOWN),t}static getLinesSums(e){const t={};t[B.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[B.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=e.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;t[o].columns[s]=t[o].columns[s]+1,t[o].rows[r]=t[o].rows[r]+1,s===r&&(t[o].diagonals[0]=t[o].diagonals[0]+1),s+r===4&&(t[o].diagonals[1]=t[o].diagonals[1]+1)}}return t}static getVictoriousCoords(e){return Xi.QUIXO_HELPER.getVictoriousCoord(e)}static getFullestLine(e){const t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max(...t)}applyLegalMove(e,t,r){return t.applyLegalMove(e)}isLegal(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):R.SUCCESS}getGameStatus(e){const t=e.gameState,s=Xi.QUIXO_HELPER.getVictoriousCoord(t).map(o=>t.getPieceAt(o)),i=new Ot(s);return 0===i.size()?Ne.ONGOING:1===i.size()?Ne.getVictory(i.getAnyElement().get()):Ne.getVictory(t.getCurrentPlayer())}}Xi.singleton=y.empty(),Xi.QUIXO_HELPER=new _9(rc.isInRange,pe.identity,5);class B5t extends bs{getListMoves(e){const t=[],r=Xi.getVerticalCoords(e),i=Xi.getHorizontalCenterCoords(e).concat(r);for(const o of i){const c=Xi.getPossibleDirections(o);for(const u of c){const h=new rc(o.x,o.y,u);t.push(h)}}return t}getMetrics(e){const r=Xi.getLinesSums(e.gameState);return[Xi.getFullestLine(r[B.ZERO.value]),Xi.getFullestLine(r[B.ONE.value])]}}const cr=le.NONE,Wc=le.ZERO,K3=le.ONE;class I4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,f7.getInitialState()),ee.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new f7([[cr,cr,cr,cr,cr],[cr,cr,cr,cr,cr],[cr,cr,cr,cr,cr],[cr,cr,cr,cr,cr],[Wc,Wc,Wc,Wc,cr]],1),[new rc(4,4,Fe.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),ee.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new f7([[cr,K3,cr,K3,K3],[cr,Wc,Wc,cr,Wc],[K3,K3,K3,Wc,K3],[Wc,cr,Wc,K3,K3],[K3,Wc,cr,K3,Wc]],31),[new rc(3,0,Fe.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function $5t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"circle",4),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onBoardClick(i,o))}),A()()}if(2&n){const t=e.index,r=C().index,s=C();T(1),ke("id","click_",t,"_",r,""),w("ngClass",s.getPieceClasses(t,r)),z("r",.45*s.SPACE_SIZE)("cx",(t+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function G5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,$5t,2,6,"g",2),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function U5t(n,e){if(1&n){const t=Oe();V(),O(0,"use",6),J("click",function(){const i=he(t).$implicit;return ce(C(2).chooseDirection(i))}),A()}if(2&n){const t=e.$implicit,r=C(2);h1("id","chooseDirection_",t,""),z("transform",r.getArrowTransform(t))}}function q5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,U5t,1,2,"use",5),A()),2&n){const t=C();T(1),w("ngForOf",t.getPossiblesDirections())}}let W5t=(()=>{class n extends to{constructor(t){super(t),this.lastMoveCoord=y.empty(),this.chosenCoord=y.empty(),this.victoriousCoords=[],this.rules=Xi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new B5t(this.rules,"QuixoMinimax")],this.encoder=rc.encoder,this.tutorial=(new I4e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.node.move.map(t=>t.coord),this.victoriousCoords=Xi.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=y.empty()}getPieceClasses(t,r){const s=new S(t,r),o=[];return o.push(this.getPlayerClass(this.board[r][t])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(t,r){const s=this.canUserPlay("#click_"+t+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new S(t,r),o=rc.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][t]===this.state.getCurrentOpponent()?this.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=y.of(i),R.SUCCESS)}getPossiblesDirections(){const t=[],r=this.chosenCoord.get();return 4!==r.x&&t.push(Fe.RIGHT),0!==r.x&&t.push(Fe.LEFT),4!==r.y&&t.push(Fe.DOWN),0!==r.y&&t.push(Fe.UP),t}chooseDirection(t){var r=this;return I(function*(){const s=r.canUserPlay("#chooseDirection_"+t.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=t,yield r.tryMove())})()}tryMove(){var t=this;return I(function*(){const r=t.chosenCoord.get(),s=new rc(r.x,r.y,t.chosenDirection);return t.chooseMove(s)})()}getArrowTransform(t){return class b0t{static getArrowTransform(e,t,r){let s,i,o;switch(r){case Fe.UP:s=1,i=0,o=-90;break;case Fe.DOWN:s=1,i=2,o=90;break;case Fe.LEFT:s=0,i=1,o=180;break;default:pe.expectToBe(r,Fe.RIGHT),s=2,i=1,o=0}return["scale("+e/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new S(0,0),t)}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0)(1,"defs"),X(2,"polygon",1),A(),x(3,G5t,2,1,"g",2),x(4,q5t,2,1,"g",3),A()),2&t&&(z("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),T(3),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Qr=(()=>{class n extends br{static getInitialState(){const t=Je.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,le.NONE);return t[3][3]=B.ZERO,t[4][4]=B.ZERO,t[3][4]=B.ONE,t[4][3]=B.ONE,new n(t,0)}static getNeighboringPawnLike(t,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let h=-1;h<2;h++)o=new S(s+h,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&t[o.y][o.x]===r&&c.push(o);return c}countScore(){const t=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(t[i.value]+=1)}return t}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class H2 extends us{static of(e){return new H2(e.x,e.y)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}H2.encoder=us.getEncoder(H2.of),H2.PASS=new H2(-1,-1);let j5t=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();var jc;class x4e{constructor(e,t){this.move=e,this.switched=t}}let h7=jc=class extends N1{constructor(){super(Qr)}static get(){return jc.singleton.isAbsent()&&(jc.singleton=y.of(new jc)),jc.singleton.get()}static getGameStatus(e){const t=e.gameState;if(!1===jc.isGameEnded(t))return Ne.ONGOING;const s=t.countScore(),i=s[1]-s[0];return i<0?Ne.ZERO_WON:i>0?Ne.ONE_WON:Ne.DRAW}applyLegalMove(e,t,r){const s=t.turn,i=t.getCurrentPlayer(),o=t.getCopiedBoard();if(e.equals(H2.PASS))return new Qr(o,s+1);for(const u of r)o[u.y][u.x]=i;return o[e.coord.y][e.coord.x]=i,new Qr(o,s+1)}static getAllSwitcheds(e,t,r){const s=[],i=t.getOpponent();for(const o of be.DIRECTIONS){const c=e.coord.getNext(o);if(c.isInRange(Qr.BOARD_WIDTH,Qr.BOARD_HEIGHT)&&r[c.y][c.x]===i){const u=jc.getSandwicheds(t,o,c,r);for(const h of u)s.push(h)}}return s}static getSandwicheds(e,t,r,s){const i=[r];let o=r.getNext(t);for(;o.isInRange(Qr.BOARD_WIDTH,Qr.BOARD_HEIGHT);){const c=s[o.y][o.x];if(c===e)return i;if(c===le.NONE)return[];i.push(o),o=o.getNext(t)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return jc.getGameStatus(e)}static playerCanOnlyPass(e){const t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(H2.PASS)}static nextPlayerCantOnlyPass(e){const t=e.getCopiedBoard(),s=new Qr(t,e.turn+1);return this.playerCanOnlyPass(s)}static getListMoves(e){const t=[];let r;const s=e.getCurrentPlayer(),i=e.getCurrentOpponent();for(let o=0;o<8;o++)for(let c=0;c<8;c++)if(e.getPieceAtXY(c,o)===le.NONE&&(r=e.getCopiedBoard(),Qr.getNeighboringPawnLike(r,i,c,o).length>0)){const h=new H2(c,o),g=jc.getAllSwitcheds(h,s,r);if(g.length>0){for(const m of g)qe(s!==e.getPieceAt(m),m+"was already switched!"),r[m.y][m.x]=s;r[o][c]=s,t.push(new x4e(h,g.length))}}return 0===t.length&&t.push(new x4e(H2.PASS,0)),t}isLegal(e,t){if(e.equals(H2.PASS))return jc.playerCanOnlyPass(t)?_e.success([]):_e.failure(Xe.CANNOT_PASS());if(t.getPieceAt(e.coord).isPlayer())return _e.failure(Xe.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCopiedBoard(),s=jc.getAllSwitcheds(e,t.getCurrentPlayer(),r);return 0===s.length?_e.failure(j5t.NO_ELEMENT_SWITCHED()):_e.success(s)}};h7.singleton=y.empty(),h7=jc=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],h7);class RT extends bs{getMetrics(e){const r=e.gameState.getCopiedBoard();let s=0,i=0;for(let o=0;o<Qr.BOARD_HEIGHT;o++)for(let c=0;c<Qr.BOARD_WIDTH;c++){const g=(0===c||c===Qr.BOARD_WIDTH-1?4:1)*(0===o||o===Qr.BOARD_HEIGHT-1?4:1);r[o][c]===B.ZERO&&(s+=g),r[o][c]===B.ONE&&(i+=g)}return[s,i]}getListMoves(e){const t=h7.getListMoves(e.gameState);return Je.sortByDescending(t,r=>RT.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),t.map(r=>r.move)}}RT.bestCoords=[new S(0,0),new S(0,Qr.BOARD_HEIGHT-1),new S(Qr.BOARD_WIDTH-1,0),new S(Qr.BOARD_WIDTH-1,Qr.BOARD_HEIGHT-1)];const Vt=le.NONE,$t=le.ZERO,dt=le.ONE;class k4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new Qr([[$t,$t,$t,$t,$t,$t,$t,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,$t,$t,$t,$t,$t,$t,$t]],60)),ee.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,Qr.getInitialState(),new H2(2,4),$localize`Congratulations!`),ee.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new Qr([[Vt,Vt,Vt,Vt,Vt,Vt,Vt,Vt],[Vt,Vt,Vt,Vt,Vt,Vt,Vt,Vt],[Vt,Vt,Vt,Vt,Vt,Vt,Vt,Vt],[Vt,Vt,Vt,Vt,dt,Vt,Vt,Vt],[Vt,Vt,Vt,$t,Vt,Vt,Vt,Vt],[Vt,Vt,$t,Vt,Vt,Vt,Vt,Vt],[$t,$t,Vt,Vt,Vt,Vt,Vt,Vt],[Vt,$t,dt,$t,dt,$t,Vt,Vt]],1),[new H2(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),ee.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new Qr([[dt,$t,$t,$t,$t,$t,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[$t,dt,dt,dt,dt,dt,dt,$t],[dt,dt,dt,dt,dt,dt,Vt,Vt],[$t,$t,$t,$t,$t,$t,Vt,Vt]],60))]}}function Y5t(n,e){if(1&n&&(V(),X(0,"circle",4)),2&n){const t=C().index,r=C().index,s=C();w("ngClass",s.getPieceClass(t,r)),z("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*t+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function K5t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",2),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),A(),x(2,Y5t,1,4,"circle",3),A()}if(2&n){const t=e.index,r=C().index,s=C();T(1),ke("id","click_",t,"_",r,""),w("ngClass",s.getRectClasses(t,r)),z("x",s.SPACE_SIZE*t)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][t]!==s.EMPTY)}}function X5t(n,e){if(1&n&&(V(),O(0,"g"),x(1,K5t,3,8,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}let Q5t=(()=>{class n extends to{constructor(t){super(t),this.EMPTY=le.NONE,this.lastMove=new S(-2,-2),this.capturedCoords=[],this.scores=y.of([2,2]),this.rules=h7.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new RT(this.rules,"ReversiMinimax")],this.encoder=H2.encoder,this.tutorial=(new k4e).tutorial,this.canPass=!1,this.updateBoard()}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new H2(t,r);return yield s.chooseMove(o)})()}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.capturedCoords=[],this.lastMove=new S(-2,-2),this.scores=y.of(t.countScore()),this.canPass=h7.playerCanOnlyPass(t)}showLastMove(t){this.lastMove=t.coord;const r=this.getState().getCurrentPlayer(),s=this.getState().getCurrentOpponent();for(const i of be.DIRECTIONS){let o=this.lastMove.getNext(i,1);for(;o.isInRange(Qr.BOARD_WIDTH,Qr.BOARD_HEIGHT)&&this.getState().getPieceAt(o)===s&&this.getPreviousState().getPieceAt(o)===r;)this.capturedCoords.push(o),o=o.getNext(i,1)}}getRectClasses(t,r){const s=new S(t,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(t,r){return this.getPlayerClass(this.board[r][t])}pass(){var t=this;return I(function*(){return qe(t.canPass,"ReversiComponent: pass() can only be called if canPass is true"),t.onClick(H2.PASS.coord.x,H2.PASS.coord.y)})()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,X5t,2,1,"g",1),A()),2&t&&(z("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),T(1),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),ya=(()=>{class n extends t7{static getInitialState(){const t=Ie.UNREACHABLE,r=Ie.ZERO,s=Ie.ONE,i=Ie.EMPTY;return new n([[t,t,r,s,i,i,i,r,s,t,t],[t,i,i,i,i,i,i,i,i,i,t],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[t,i,i,i,i,i,i,i,i,i,t],[t,t,s,r,i,i,i,s,r,t,t]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),b9=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class X3 extends kc{constructor(e,t){super(e,t)}static checkDistanceAndLocation(e,t){const r=e.getOrthogonalDistance(t);if(0===r)return R.failure(Xe.MOVE_CANNOT_BE_STATIC());if(1===r){const s=Rc.getFakeNeighbors(e);if(t.equals(s))return R.failure(b9.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==r)return R.failure($localize`You can move one or two spaces, not ${r}.`);if(Rc.isSpaceDark(e))return R.failure(b9.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return R.failure(b9.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return R.SUCCESS}static from(e,t){pe.assert(e.isInRange(ya.WIDTH,ya.HEIGHT),"Move must start inside the board not at "+e.toString()+"."),pe.assert(t.isInRange(ya.WIDTH,ya.HEIGHT),"Move must end inside the board not at "+t.toString()+".");const r=X3.checkDistanceAndLocation(e,t);return r.isFailure()?r.toOtherFallible():_e.success(new X3(e,t))}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}var fl;X3.encoder=_a.getFallibleEncoder(X3.from);let V8=fl=class extends N1{constructor(){super(ya)}static get(){return fl.singleton.isAbsent()&&(fl.singleton=y.of(new fl)),fl.singleton.get()}static getStartingCoords(e,t){const r=[];for(let s=0;s<ya.HEIGHT;s++)for(let i=0;i<ya.WIDTH;i++)e[s][i].is(t)&&r.push(new S(i,s));return r}static getBoardValuesFor(e,t){const r=fl.getStartingCoords(e,t),s=[];for(const i of r){const o=t7.getEmptyNeighbors(e,i,Ie.EMPTY).length;if(0===o)return[0];s.push(o)}return s.sort((i,o)=>i-o)}applyLegalMove(e,t,r){const s=t.getCopiedBoard();return s[e.getEnd().y][e.getEnd().x]=s[e.getStart().y][e.getStart().x],s[e.getStart().y][e.getStart().x]=Ie.EMPTY,new ya(s,t.turn+1)}isLegal(e,t){if(t.getPieceAt(e.getStart()).value!==t.getCurrentPlayer().value)return R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.getEnd())!==Ie.EMPTY)return R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE());const i=Rc.getCommonNeighbor(e.getStart(),e.getEnd());return i.isPresent()?t.getPieceAt(i.get())===Ie.EMPTY?R.SUCCESS:R.failure(b9.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):R.SUCCESS}getGameStatus(e){const t=e.gameState.getCopiedBoard(),r=fl.getBoardValuesFor(t,B.ZERO),s=fl.getBoardValuesFor(t,B.ONE);return fl.getGameStatusFromFreedoms(r,s)}getLandingCoords(e,t){const r=i=>i.isInRange(ya.WIDTH,ya.HEIGHT)&&e[i.y][i.x]===Ie.EMPTY,s=new Ot(Rc.getNeighbors(t).filter(r));if(!0===Rc.isSpaceDark(t))return s.toList();{const i=new Ot(s.toList());for(const o of s){const c=Rc.getNeighbors(o).filter(r);for(const u of c)i.add(u)}return i.toList()}}static getGameStatusFromFreedoms(e,t){return 0===e[0]?Ne.ONE_WON:0===t[0]?Ne.ZERO_WON:Ne.ONGOING}};V8.singleton=y.empty(),V8=fl=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],V8);class e7t extends bs{getListMoves(e){const t=[],r=e.gameState.getCopiedBoard(),s=e.gameState.getCurrentPlayer(),i=V8.getStartingCoords(r,s);for(const o of i){const c=t7.getEmptyNeighbors(r,o,Ie.EMPTY);for(const u of c){const h=X3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=Ie.EMPTY,t.push(h),(u.y+u.x)%2==0){const m=t7.getEmptyNeighbors(r,u,Ie.EMPTY);for(const M of m)if(!M.equals(o)){const b=X3.from(o,M).get();r[M.y][M.x]=r[u.y][u.x],r[u.y][u.x]=Ie.EMPTY,t.push(b),r[u.y][u.x]=r[M.y][M.x],r[M.y][M.x]=Ie.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=Ie.EMPTY}}return t}getMetrics(e){const t=e.gameState.board,r=V8.getBoardValuesFor(t,B.ZERO),s=V8.getBoardValuesFor(t,B.ONE);let i=0;for(;i<6&&r[i]===s[i];)i++;return[r[i%6],s[i%6]]}}const Zc=Ie.UNREACHABLE,O9=Ie.ZERO,A9=Ie.ONE,kn=Ie.EMPTY;class L4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,ya.getInitialState()),ee.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new ya([[Zc,Zc,kn,kn,A9,kn,kn,O9,A9,Zc,Zc],[Zc,kn,kn,kn,kn,kn,kn,kn,kn,kn,Zc],[A9,O9,kn,kn,kn,kn,kn,kn,kn,kn,O9],[O9,kn,kn,kn,kn,kn,kn,kn,kn,kn,A9],[Zc,kn,kn,kn,kn,kn,kn,kn,kn,kn,Zc],[Zc,Zc,A9,O9,kn,kn,kn,A9,O9,Zc,Zc]],3)),ee.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,ya.getInitialState(),X3.from(new S(2,0),new S(2,1)).get(),(e,t,r)=>e.isSimpleStep()?R.SUCCESS:R.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),ee.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,ya.getInitialState(),X3.from(new S(7,0),new S(5,0)).get(),(e,t,r)=>e.isSimpleStep()?R.failure($localize`Failed! You have made a single step.`):R.SUCCESS,$localize`Congratulations!`)]}}function t7t(n,e){if(1&n&&(V(),O(0,"g"),X(1,"polygon",7),A()),2&n){const t=C().index,r=C().index,s=C();T(1),w("ngClass",s.getPlayerClassFor(t,r)),z("points",s.getPyramidCoordinate(t,r))}}function n7t(n,e){if(1&n&&(V(),X(0,"polygon",10)),2&n){const t=C(2).index,r=C().index;z("points",C().getTriangleCoordinate(t,r))}}function r7t(n,e){if(1&n&&(V(),X(0,"polygon",11)),2&n){const t=C(2).index,r=C().index;z("points",C().getTriangleCoordinate(t,r))}}function s7t(n,e){if(1&n&&(V(),O(0,"g"),x(1,n7t,1,1,"polygon",8),x(2,r7t,1,1,"polygon",9),A()),2&n){const t=C().index,r=C().index;T(1),w("ngIf",(t+r)%2==1),T(1),w("ngIf",(t+r)%2==0)}}function i7t(n,e){if(1&n){const t=Oe();V(),O(0,"g",5),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),x(1,t7t,2,2,"g",6),x(2,s7t,3,2,"g",6),A()}if(2&n){const t=e.$implicit;ke("id","click_",e.index,"_",C().index,""),T(1),w("ngIf",t.isPlayer()),T(1),w("ngIf",2===t.value)}}function o7t(n,e){if(1&n&&(V(),O(0,"g"),x(1,i7t,3,4,"g",4),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function a7t(n,e){if(1&n&&(V(),X(0,"polygon",14)),2&n){const t=e.$implicit,r=C(2);ke("id","possible_landing_",t.x,"_",t.y,""),z("points",r.getTriangleCoordinate(t.x,t.y))}}function c7t(n,e){if(1&n&&(V(),X(0,"polygon",14)),2&n){const t=C(2);ke("id","chosen_coord_",t.chosenCoord.get().x,"_",t.chosenCoord.get().y,""),z("points",t.getTriangleCoordinate(t.chosenCoord.get().x,t.chosenCoord.get().y))}}function l7t(n,e){if(1&n&&(V(),dn(0),x(1,a7t,1,3,"polygon",12),x(2,c7t,1,3,"polygon",13),pn()),2&n){const t=C();T(1),w("ngForOf",t.possibleLandings),T(1),w("ngIf",t.chosenCoord.isPresent())}}function u7t(n,e){if(1&n&&(V(),dn(0),X(1,"polygon",15)(2,"polygon",15),pn()),2&n){const t=C(2);T(1),z("points",t.getTriangleCoordinate(t.lastCoord.get().x,t.lastCoord.get().y)),T(1),z("points",t.getTriangleCoordinate(t.lastMoved.get().x,t.lastMoved.get().y))}}function f7t(n,e){1&n&&(V(),x(0,u7t,3,2,"ng-container",6)),2&n&&w("ngIf",C().lastMoved.isPresent())}let h7t=(()=>{class n extends G3e{constructor(t){super(t),this.lastCoord=y.empty(),this.lastMoved=y.empty(),this.chosenCoord=y.empty(),this.possibleLandings=[],this.rules=V8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new e7t(this.rules,"SaharaMinimax")],this.encoder=X3.encoder,this.tutorial=(new L4e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=y.empty()}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=Ie.ofPlayer(o);return s.chosenCoord.equalsValue(new S(t,r))?(s.cancelMoveAttempt(),R.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][t]===c?s.choosePiece(t,r):s.chooseLandingCoord(t,r)})()}choosePiece(t,r){if(this.board[r][t]===Ie.EMPTY)return this.cancelMove(b9.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][t].is(B.ofTurn(this.getTurn()))){const s=new S(t,r);return this.selectPiece(s),R.SUCCESS}return this.cancelMove(b9.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(t){this.chosenCoord=y.of(t),this.possibleLandings=this.rules.getLandingCoords(this.board,t)}chooseLandingCoord(t,r){var s=this;return I(function*(){const i=new S(t,r),o=X3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get())})()}updateBoard(){const t=this.node.move;this.lastCoord=t.map(r=>r.getStart()),this.lastMoved=t.map(r=>r.getEnd()),this.board=this.getState().board}getPlayerClassFor(t,r){return this.getPlayerClass(B.of(this.board[r][t].value))}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(t,r){if(1&t&&(V(),O(0,"svg",0),x(1,o7t,2,1,"g",1),x(2,l7t,3,2,"ng-container",2),x(3,f7t,1,1,"ng-template",null,3,Un),A()),2&t){const s=Hn(4);T(1),w("ngForOf",r.board),T(1),w("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ea extends us{constructor(e,t,r,s){super(e,t),this.x=e,this.y=t,this.direction=r,this.landingOrientation=s}static from(e,t,r,s){const i=new Ea(e,t,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return _e.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return _e.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return _e.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return _e.success(i)}isRotation(){return this.direction.isAbsent()}equals(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.direction.equals(e.direction))&&this.landingOrientation===e.landingOrientation}toString(){const e=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}Ea.encoder=Ye.tuple([Ye.identity(),Ye.identity(),y.getEncoder(Fe.encoder),Fe.encoder],n=>[n.x,n.y,n.direction,n.landingOrientation],n=>Ea.from(n[0],n[1],n[2],n[3]).get());class vt{constructor(e){this.value=e}static decode(e){switch(e){case 0:return vt.EMPTY;case 1:return vt.LIGHT_UP;case 2:return vt.LIGHT_RIGHT;case 3:return vt.LIGHT_DOWN;case 4:return vt.LIGHT_LEFT;case 5:return vt.DARK_UP;case 6:return vt.DARK_RIGHT;case 7:return vt.DARK_DOWN;case 8:return vt.DARK_LEFT;case 9:return vt.MOUNTAIN}}belongTo(e){return e===B.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?B.ZERO:5<=this.value&&this.value<=8?B.ONE:le.NONE}getOptionalDirection(){switch(this.value){case 0:return y.empty();case 1:case 5:return y.of(Fe.UP);case 2:case 6:return y.of(Fe.RIGHT);case 3:case 7:return y.of(Fe.DOWN);case 4:case 8:return y.of(Fe.LEFT);default:return pe.expectToBe(this.value,9),y.empty()}}static of(e,t){return t===B.ZERO?e===Fe.UP?vt.LIGHT_UP:e===Fe.RIGHT?vt.LIGHT_RIGHT:e===Fe.DOWN?vt.LIGHT_DOWN:vt.LIGHT_LEFT:e===Fe.UP?vt.DARK_UP:e===Fe.RIGHT?vt.DARK_RIGHT:e===Fe.DOWN?vt.DARK_DOWN:vt.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return pe.expectToBe(this.value,9),"MOUNTAIN"}}}vt.EMPTY=new vt(0),vt.LIGHT_UP=new vt(1),vt.LIGHT_RIGHT=new vt(2),vt.LIGHT_DOWN=new vt(3),vt.LIGHT_LEFT=new vt(4),vt.DARK_UP=new vt(5),vt.DARK_RIGHT=new vt(6),vt.DARK_DOWN=new vt(7),vt.DARK_LEFT=new vt(8),vt.MOUNTAIN=new vt(9);class Q3 extends br{static getInitialState(){const e=Je.createTable(5,5,vt.EMPTY);return e[2][1]=vt.MOUNTAIN,e[2][2]=vt.MOUNTAIN,e[2][3]=vt.MOUNTAIN,new Q3(e,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const e=[0,0];for(let t=0;t<5;t++)for(let r=0;r<5;r++)this.board[t][r]!==vt.EMPTY&&e[this.getPieceAtXY(r,t).getOwner().value]++;return e}}let N9=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();var I9;class R4e{constructor(e,t){this.resultingBoard=e,this.moved=t}}let Yc=I9=class extends N1{constructor(){super(Q3)}static get(){return I9.singleton.isAbsent()&&(I9.singleton=y.of(new I9)),I9.singleton.get()}isLegal(e,t){if(!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return _e.failure(Xe.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return this.isLegalRotation(e,t);{let r;if(e.isInsertion()){const s=this.isLegalInsertion(e.coord,t);if(s.legal.isFailure())return _e.failure(s.legal.getReason());r=s.insertedPiece}else r=t.getPieceAt(e.coord);return this.isLegalForwarding(e,t,r)}}isLegalInsertion(e,t){const r=t.countCurrentPlayerPawn(),s=t.getCurrentPlayer(),i=r<5?R.SUCCESS:R.failure(N9.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(e,s),legal:i}}getInsertedPiece(e,t){return vt.of(-1===e.x?Fe.RIGHT:-1===e.y?Fe.DOWN:5===e.x?Fe.LEFT:Fe.UP,t)}isLegalForwarding(e,t,r){qe(r!==vt.MOUNTAIN&&r!==vt.EMPTY,"forwarding must be done with player piece");const s=[];let i=vt.of(e.landingOrientation,t.getCurrentPlayer());const o=e.direction.get();let c=e.coord.getNext(o);if(c.isInRange(5,5)&&t.getPieceAt(c)!==vt.EMPTY&&!1===this.isStraight(r,e))return _e.failure(N9.ILLEGAL_PUSH());let u=y.of(o);const h=o.getOpposite();let g=0;const m=t.getCopiedBoard();e.coord.isInRange(5,5)&&(m[e.coord.y][e.coord.x]=vt.EMPTY,s.push(e.coord));let M=c.isInRange(5,5)&&i!==vt.EMPTY;for(;M;){u.equalsValue(o)?g++:u.equalsValue(h)&&g--;const b=m[c.y][c.x];b===vt.MOUNTAIN&&(g-=.9),m[c.y][c.x]=i,s.push(c),i=b,c=c.getNext(o),u=i.getOptionalDirection(),M=c.isInRange(5,5)&&i!==vt.EMPTY&&g>0}return c.isNotInRange(5,5)&&(u.equalsValue(o)?g++:u.equalsValue(h)&&g--),g<=0?_e.failure(N9.NOT_ENOUGH_FORCE_TO_PUSH()):_e.success(new R4e(m,s))}isStraight(e,t){const r=e.getDirection();return t.direction.equalsValue(r)&&r===t.landingOrientation}isLegalRotation(e,t){const r=e.coord,s=t.getPieceAt(r),i=t.getCurrentPlayer();if(s.getDirection()===e.landingOrientation)return _e.failure(N9.MUST_MOVE_OR_ROTATE());const o=t.getCopiedBoard();return o[r.y][r.x]=vt.of(e.landingOrientation,i),_e.success(new R4e(o,[r]))}applyLegalMove(e,t,r){const s=Je.copyBiArray(r.resultingBoard);return new Q3(s,t.turn+1)}getBoardValueInfo(e,t){const r=this.getMountainsRowsAndColumns(t),s=r.rows,i=r.columns,o=this.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===B.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(t,i,s);let u=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;const g=t.getCurrentPlayer();for(const M of c)M.coord.isInRange(5,5)?t.getPieceAt(M.coord).belongTo(B.ZERO)?u=Math.min(u,M.distance):h=Math.min(h,M.distance):g===B.ZERO?u=Math.min(u,M.distance):h=Math.min(h,M.distance);return{shortestZero:u,shortestOne:h,boardValue:this.getScoreFromShortestDistances(u,h,g)}}}getScoreFromShortestDistances(e,t,r){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);const s=6-e,i=6-t;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(e){const t=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)e.getPieceAtXY(o,i)===vt.MOUNTAIN&&(t.includes(i)||t.push(i),r.includes(o)||r.push(o),s++);return{rows:t,columns:r,nbMountain:s}}getWinner(e,t,r){return 2===r?this.getPusher(e,t.get()):le.NONE}getPusher(e,t){const r=t.coord;let s;s=r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):this.getInsertedPiece(r,e.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(e,i,r),c=e.getPieceAt(o).getOwner();return We.display("SiamRules","getPusher",r.toString()+" belong to "+e.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(e,t,r){let s=r.getNext(t),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(t);const o=e.getPieceAt(r);o!==vt.MOUNTAIN&&o.getDirection()===t&&(i=r)}return i}getPushers(e,t,r){let s=[];const i=[];for(const o of t){let c=Fe.DOWN,u=new S(o,4);i.push({direction:c,fallingCoord:u}),c=Fe.UP,u=new S(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=Fe.LEFT,u=new S(0,o);i.push({direction:c,fallingCoord:u}),c=Fe.RIGHT,u=new S(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(e,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(e,t,r,s){const i=this.getLineClosestPusher(e,t,r);if(i.isAbsent())return s;const o=i.get();return s.push({coord:o.coord,distance:o.distance}),s}getLineClosestPusher(e,t,r){const s=r.getOpposite();let i=1,o=e.getPieceAt(t),c=t,u=y.empty(),h=!1,g=!1,m=0;for(;c.isInRange(5,5)&&!1===h;){const M=e.getPieceAt(c);if(M.isEmptyOrMountain())M===vt.MOUNTAIN?(m+=.9,g=!0):i++;else{const b=M.getDirection();b===r?g&&(m-=1,m<=0&&(h=!0,c=c.getNext(r))):b===s?(m+=1,g||i++):g?(u=y.of(c),o!==vt.EMPTY&&i++):i++}o=M,c=c.getPrevious(r)}if(!1===h&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===e.countCurrentPlayerPawn())||m>0?y.empty():y.of({distance:i,coord:c})}getInsertions(e){let t=[];for(let r=1;r<4;r++)t=t.concat(this.getInsertionsAt(e,0,r)),t=t.concat(this.getInsertionsAt(e,4,r)),t=t.concat(this.getInsertionsAt(e,r,0)),t=t.concat(this.getInsertionsAt(e,r,4));return t=t.concat(this.getInsertionsAt(e,0,0)),t=t.concat(this.getInsertionsAt(e,0,4)),t=t.concat(this.getInsertionsAt(e,4,0)),t=t.concat(this.getInsertionsAt(e,4,4)),t}getInsertionsAt(e,t,r){const s=[];for(const i of Fe.ORTHOGONALS){const o=new S(t,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of Fe.ORTHOGONALS){const u=Ea.from(o.x,o.y,y.of(i),c);qe(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),e).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(e,t,r,s){const i=new S(r,s);let o=this.getRotationMovesAt(i,t);for(const c of Fe.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(e,i,u))}return o}getMovesBetween(e,t,r,s){return r.equals(s)?this.getRotationMovesAt(r,t):Fe.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(e,r,s):[]}getRotationMovesAt(e,t){const r=[],s=t.getDirection();for(const i of Fe.ORTHOGONALS)if(i!==s){const o=Ea.from(e.x,e.y,y.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(e,t,r){const s=[];let i;const o=Fe.factory.fromMove(t,r).get(),c=e.getPieceAt(t);i=r.isInRange(5,5)?Fe.ORTHOGONALS:[o];for(const u of i){const h=Ea.from(t.x,t.y,y.of(o),u).get();this.isLegalForwarding(h,e,c).isSuccess()&&s.push(h)}return s}getGameStatus(e){const t=this.getMountainsRowsAndColumns(e.gameState),r=this.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?Ne.getVictory(r):Ne.ONGOING}};Yc.singleton=y.empty(),Yc=I9=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],Yc);let RF=class extends Xa{getBoardValue(e){return new Vn(Yc.get().getBoardValueInfo(e.move,e.gameState).boardValue)}getListMoves(e){let t=[];const r=e.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=e.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(t=t.concat(Yc.get().getMovesFrom(e.gameState,o,i,s)))}if(e.gameState.countCurrentPlayerPawn()<5)for(const s of Yc.get().getInsertions(e.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;t.push(s)}return t}isOnBorder(e){return 0===e.coord.x||4===e.coord.x||0===e.coord.y||4===e.coord.y}};RF=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],RF);const Ze=vt.EMPTY,sc=vt.MOUNTAIN,DF=vt.LIGHT_UP,zF=vt.LIGHT_LEFT,x9=vt.LIGHT_RIGHT,g7t=vt.LIGHT_DOWN,m7t=vt.DARK_UP,D4e=vt.DARK_LEFT,z4e=vt.DARK_RIGHT,_7t=vt.DARK_DOWN;class H4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,Q3.getInitialState()),ee.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,Q3.getInitialState(),Ea.from(2,-1,y.of(Fe.DOWN),Fe.DOWN).get(),$localize`Congratulations!`),ee.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new Q3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,sc,sc,sc,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,DF,Ze,Ze]],0),[Ea.from(2,4,y.of(Fe.UP),Fe.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),ee.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new Q3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,sc,sc,sc,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,DF,Ze,Ze]],0),[Ea.from(2,4,y.of(Fe.DOWN),Fe.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),ee.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new Q3([[Ze,x9,D4e,Ze,Ze],[x9,z4e,zF,Ze,Ze],[Ze,Ze,DF,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze]],0),[Ea.from(2,2,y.of(Fe.UP),Fe.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new Q3([[Ze,Ze,x9,sc,Ze],[Ze,Ze,x9,sc,zF],[Ze,x9,sc,sc,Ze],[Ze,x9,z4e,D4e,sc],[Ze,Ze,Ze,Ze,Ze]],0),[Ea.from(1,3,y.of(Fe.RIGHT),Fe.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),ee.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new Q3([[Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze],[sc,m7t,zF,Ze,g7t],[Ze,Ze,Ze,Ze,_7t],[Ze,Ze,Ze,Ze,sc]],0),[Ea.from(2,2,y.of(Fe.LEFT),Fe.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function C7t(n,e){if(1&n){const t=Oe();V(),O(0,"use",11),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().clickSquare(s,i))}),A()}if(2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C();ke("id","piece_",r,"_",i,""),w("ngClass",o.getPieceClasses(r,i,s)),z("transform",o.getPieceTransform(r,i))}}function y7t(n,e){if(1&n){const t=Oe();V(),O(0,"use",12),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C().clickSquare(s,i))}),A()}if(2&n){const t=C().index,r=C().index,s=C();z("transform","translate("+(t+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function E7t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",8),J("click",function(){const i=he(t).index,o=C().index;return ce(C().clickSquare(i,o))}),A(),x(2,C7t,1,4,"use",9),x(3,y7t,1,1,"use",10),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();T(1),ke("id","square_",r,"_",s,""),w("ngClass",i.getSquareClasses(r,s)),z("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t.isPiece()),T(1),w("ngIf",i.isMountain(t))}}function M7t(n,e){if(1&n&&(V(),O(0,"g"),x(1,E7t,4,9,"g",4),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function S7t(n,e){if(1&n){const t=Oe();V(),O(0,"rect",15),J("click",function(){he(t);const s=C().$implicit;return ce(C().clickSquare(s.x,s.y))}),A()}if(2&n){const t=C().$implicit,r=C();ke("id","square_",t.x,"_",t.y,""),w("ngClass",r.getSquareClasses(t.x,t.y)),z("x",r.SPACE_SIZE*(t.x+1))("y",r.SPACE_SIZE*(t.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function P7t(n,e){if(1&n){const t=Oe();V(),O(0,"g"),x(1,S7t,1,7,"rect",13),O(2,"rect",14),J("click",function(){const i=he(t).$implicit;return ce(C().clickSquare(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C();T(1),w("ngIf",!1===t.isInRange(5,5)),T(1),z("x",r.SPACE_SIZE*(t.x+1))("y",r.SPACE_SIZE*(t.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function T7t(n,e){if(1&n){const t=Oe();V(),O(0,"rect",16),J("click",function(){he(t);const s=C();return ce(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),A()}if(2&n){const t=C();z("x",t.SPACE_SIZE*(t.selectedLanding.get().x+1))("y",t.SPACE_SIZE*(t.selectedLanding.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function w7t(n,e){if(1&n){const t=Oe();V(),O(0,"rect",16),J("click",function(){he(t);const s=C();return ce(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),A()}if(2&n){const t=C();z("x",t.SPACE_SIZE*(t.selectedPiece.get().x+1))("y",t.SPACE_SIZE*(t.selectedPiece.get().y+1))("width",t.SPACE_SIZE)("height",t.SPACE_SIZE)}}function b7t(n,e){if(1&n&&(V(),X(0,"use",19)),2&n){const t=e.$implicit,r=C().$implicit,s=C();ke("id","remainingPieces_",r.value,"_",t,""),w("ngClass",s.getRemainingPieceClasses(r,t)),z("transform",s.getRemainingPieceTransform(t,r))}}function O7t(n,e){if(1&n){const t=Oe();V(),O(0,"g",17),J("click",function(){const i=he(t).$implicit;return ce(C().selectPieceForInsertion(i))}),x(1,b7t,1,4,"use",18),A()}if(2&n){const t=e.$implicit,r=C();h1("id","remainingPieces_",t.value,""),T(1),w("ngForOf",r.ArrayUtils.range(r.playerPieces(t)))}}function A7t(n,e){if(1&n){const t=Oe();V(),O(0,"use",22),J("click",function(){he(t);const s=C().$implicit;return ce(C().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),A()}if(2&n){const t=C().$implicit,r=C();w("ngClass",r.getPieceClasses(t.source.get().coord.x,t.source.get().coord.y,t.source.get().piece)),z("transform",r.getPieceTransform(t.source.get().coord.x,t.source.get().coord.y))}}function N7t(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"use",20),J("click",function(){const i=he(t).$implicit;return ce(C().clickArrow(i))}),A(),x(2,A7t,1,2,"use",21),A()}if(2&n){const t=e.$implicit,r=C();T(1),j2("id","indicator_",t.target.x,"_",t.target.y,"_",t.direction.toString(),""),z("transform",r.getIndicatorTransform(t)),T(1),w("ngIf",t.source.isPresent())}}function I7t(n,e){if(1&n){const t=Oe();V(),O(0,"use",23),J("click",function(){const i=he(t).$implicit;return ce(C().selectOrientation(i))}),A()}if(2&n){const t=e.$implicit,r=C();h1("id","orientation_",t.landingOrientation,""),w("ngClass",r.getCurrentPlayerClass()),z("transform",r.getOrientationTransform(t.landingOrientation))}}let d7=class extends to{constructor(e){super(e),this.lastMove=y.empty(),this.movedPieces=[],this.selectedPiece=y.empty(),this.selectedLanding=y.empty(),this.orientations=[],this.clickableCoords=new Ot,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=Yc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new RF(this.rules,"SiamMinimax")],this.encoder=Ea.encoder,this.tutorial=(new H4e).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.board,this.movedPieces=[]}showLastMove(e){this.lastMove=y.of(e);const t=this.getPreviousState();this.movedPieces=this.rules.isLegal(this.lastMove.get(),t).get().moved}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=y.empty(),this.selectedLanding=y.empty(),this.orientations=[],this.clickableCoords=new Ot,this.indicatorArrows=[]}selectPieceForInsertion(e){var t=this;return I(function*(){const r=t.canUserPlay("#remainingPieces_"+e.value);if(r.isFailure())return t.cancelMove(r.getReason());if(e!==t.getCurrentPlayer())return t.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE());if(t.insertingPiece)return t.cancelMoveAttempt(),R.SUCCESS;t.cancelMoveAttempt();for(const s of Yc.get().getInsertions(t.getState())){const i=s.coord.getNext(s.direction.get());if(t.board[i.y][i.x]!==vt.EMPTY){const o={source:y.empty(),target:i,direction:s.direction.get(),move:s};t.indicatorArrows.push(o)}t.clickableCoords.add(i)}return t.insertingPiece=!0,R.SUCCESS})()}selectOrientation(e){var t=this;return I(function*(){const r=t.canUserPlay("#orientation_"+e.landingOrientation.toString());return r.isFailure()?t.cancelMove(r.getReason()):t.chooseMove(e)})()}clickSquare(e,t,r=!1){var s=this;return I(function*(){if(!1===r){const o=s.canUserPlay("#square_"+e+"_"+t);if(o.isFailure())return s.cancelMove(o.getReason())}const i=new S(e,t);if(s.insertingPiece)return s.insertPiece(i);if(s.selectedLanding.isPresent())return s.cancelMoveAttempt(),R.SUCCESS;if(s.selectedPiece.isPresent()){s.selectedLanding=y.of(i);const o=Yc.get().getMovesBetween(s.getState(),s.getState().getPieceAt(s.selectedPiece.get()),s.selectedPiece.get(),i);return 0===o.length?s.changeMoveDestinationClick(i):s.performMoveOrShowOrientationArrows(o)}{qe(s.getState().isOnBoard(i),"SiamComponent: user clicked outside of board when it should not be possible");const o=s.board[t][e];return o.getOwner()!==s.getCurrentPlayer()?s.cancelMove(Xe.MUST_CHOOSE_PLAYER_PIECE()):s.selectPiece(i,o)}})()}insertPiece(e){var t=this;return I(function*(){if(t.selectedLanding.isPresent())return t.cancelMove(N9.MUST_SELECT_ORIENTATION()),R.SUCCESS;t.selectedLanding=y.of(e);const r=Yc.get().getInsertionsAt(t.getState(),e.x,e.y);return 0===r.length?t.changeMoveDestinationClick(e):t.performMoveOrShowOrientationArrows(r)})()}changeMoveDestinationClick(e){var t=this;return I(function*(){return t.cancelMoveAttempt(),t.getState().getPieceAt(e).getOwner()===t.getCurrentPlayer()?t.clickSquare(e.x,e.y,!0):t.cancelMove(N9.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var t=this;return I(function*(){return qe(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(t.cancelMove(),t.chooseMove(e[0])):(t.clickableCoords=new Ot,t.indicatorArrows=[],t.orientations=e,R.SUCCESS)})()}selectPiece(e,t){this.cancelMoveAttempt();const r=this.getState();this.selectedPiece=y.of(e);const s=Yc.get().getMovesFrom(r,t,e.x,e.y);for(const i of s)if(i.direction.isPresent()){const o=i.coord.getNext(i.direction.get());if(this.clickableCoords.add(o),r.isOnBoard(o)&&r.getPieceAt(o)!==vt.EMPTY){const c={source:y.of({coord:e,piece:t}),target:o,direction:i.direction.get(),move:i};this.indicatorArrows.push(c)}}else this.clickableCoords.add(i.coord);return R.SUCCESS}clickArrow(e){var t=this;return I(function*(){const r=t.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return r.isFailure()?t.cancelMove(r.getReason()):t.chooseMove(e.move)})()}isMountain(e){return e===vt.MOUNTAIN}getArrowTransform(e,t,r){const i=`rotate(${90*(r.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",i].join(" ")}getPieceTransform(e,t){return this.getArrowTransform(e+1,t+1,this.board[t][e].getDirection())}getIndicatorTransform(e){const t=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(t.x+1,t.y+1,e.direction)}getRemainingPieceTransform(e,t){const r=this.playerPieces(t);let c,u,o=2;return t===B.ONE?(o+=(r-e+(5-r)/2)/3,c=-1,u=Fe.RIGHT):(o+=(e+1+(5-r)/2)/3,c=7,u=Fe.LEFT),this.getArrowTransform(o,c,u)}getOrientationTransform(e){const t=`translate(0, ${this.SPACE_SIZE/1.6})`,s=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",s,t].join(" ")}getPieceClasses(e,t,r){const s=new S(e,t),i=[this.getPlayerClass(r.getOwner())];return this.selectedPiece.equalsValue(s)&&i.push("selected-stroke"),i}getSquareClasses(e,t){const r=new S(e,t);return this.movedPieces.some(s=>s.equals(r))?["moved-fill"]:[]}getRemainingPieceClasses(e,t){const r=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&t===this.playerPieces(e)-1&&r.push("selected-stroke"),r}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}};d7.\u0275fac=function(e){return new(e||d7)(Q(_n))},d7.\u0275cmp=ct({type:d7,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,t){1&e&&(V(),O(0,"svg",0)(1,"defs"),X(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),A(),x(5,M7t,2,1,"g",4),x(6,P7t,3,5,"g",4),x(7,T7t,1,4,"rect",5),x(8,w7t,1,4,"rect",5),x(9,O7t,2,2,"g",6),x(10,N7t,3,5,"g",4),x(11,I7t,1,3,"use",7),A()),2&e&&(T(5),w("ngForOf",t.board),T(1),w("ngForOf",t.clickableCoords),T(1),w("ngIf",t.selectedLanding.isPresent()),T(1),w("ngIf",t.selectedPiece.isPresent()),T(1),w("ngForOf",t.Player.PLAYERS),T(1),w("ngForOf",t.indicatorArrows),T(1),w("ngForOf",t.orientations))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),d7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],d7);class Fr extends eo{constructor(e,t,r){super(),this.start=e,this.landing=t,this.keep=r,pe.assert(!1===e.equalsValue(t),"Deplacement cannot be static!"),pe.assert(e.isAbsent()||!1===e.equals(r),"Cannot keep starting coord, since it will always be empty after move!")}static of(e,t,r){return new Fr(e,t,r)}static ofDrop(e){return new Fr(y.empty(),e,y.empty())}static ofMovement(e,t){return new Fr(y.of(e),t,y.empty())}static ofCut(e,t,r){return new Fr(y.of(e),t,y.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}Fr.encoder=Ye.tuple([y.getEncoder(S.encoder),S.encoder,y.getEncoder(S.encoder)],n=>[n.start,n.landing,n.keep],n=>Fr.of(n[0],n[1],n[2]));let J3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class co extends s4e{static getInitialState(){return co.ofRepresentation([[B.ZERO],[B.ONE]],0)}static ofRepresentation(e,t,r=new Bt(0,0)){const s=new w_;for(let i=0;i<e.length;i++)for(let o=0;o<e[0].length;o++)if(e[i][o]!==le.NONE){const c=new S(o,i).getNext(r);s.set(c,e[i][o])}return new co(s,t)}movePiece(e){const t=this.pieces.getCopy();return t.delete(e.start.get()),t.set(e.landing,this.getCurrentPlayer()),new co(t,this.turn)}toRepresentation(){const e=Je.createTable(this.width,this.height,le.NONE);for(const t of this.pieces.listKeys()){const r=this.getPieceAt(t);e[t.y][t.x]=r}return e}isIllegalLandingZone(e,t){return this.pieces.containsKey(e)?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?R.SUCCESS:R.failure(J3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(e,t){for(const r of mi.getNeighbors(e))if(this.pieces.containsKey(r)&&!1===t.equalsValue(r))return!0;return!1}getPieceAt(e){return this.isOnBoard(e)?this.pieces.get(e).get():le.NONE}applyLegalDrop(e){const t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new co(t,this.turn+1)}applyLegalDeplacement(e,t){const r=this.movePiece(e);if(t.size()>0){const s=new w_;for(const i of t)s.set(i,r.getPieceAt(i));return new co(s,this.turn+1)}return new co(r.pieces,this.turn+1)}countPieces(){const e=this.pieces.reverse(),t=e.get(B.ZERO).getOrElse(new Or),r=e.get(B.ONE).getOrElse(new Or);return[t.size(),r.size()]}switchPiece(e){const t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new co(t,this.turn);Ts.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}equals(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}var F8;let Kc=F8=class extends N1{constructor(){super(co)}static get(){return F8.singleton.isAbsent()&&(F8.singleton=y.of(new F8)),F8.singleton.get()}applyLegalMove(e,t,r){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,r)}isLegal(e,t){const r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toOtherFallible():t.turn<40?this.isLegalDrop(e,t):F8.isLegalPhaseTwoMove(e,t)}static getLegalLandings(e){const t=new Or;for(const r of e.getPieceCoords())for(const s of Re.factory.all){const i=r.getNext(s,1);e.getPieceAt(i)===le.NONE&&t.add(i)}return t.toList()}isLegalDrop(e,t){return!1===e.isDrop()?_e.failure(J3.NO_MOVEMENT_BEFORE_TURN_40()):_e.success(new Ot(t.getPieceCoords()))}static isLegalPhaseTwoMove(e,t){if(e.isDrop())return _e.failure(J3.CAN_NO_LONGER_DROP());const r=t.getPieceAt(e.start.get());if(r===le.NONE)return _e.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(r===t.getCurrentOpponent())return _e.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE());const s=t.movePiece(e),i=s.getGroups();if(F8.isSplit(i)){const o=this.getLargestGroups(i);return 1===o.size()?e.keep.isPresent()?_e.failure(J3.CANNOT_CHOOSE_TO_KEEP()):_e.success(o.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,o,s)}return _e.success(new Or)}static isSplit(e){return e.size()>1}static getLargestGroups(e){let t=0,r=new Ot;for(const s of e){const i=s.size();i>t?(t=i,r=new Ot([s])):i===t&&r.add(s)}return r}static moveKeepBiggerGroup(e,t,r){if(e.isAbsent())return _e.failure(J3.MUST_CUT());if(r.getPieces().get(e.get()).isAbsent())return _e.failure(J3.CANNOT_KEEP_EMPTY_COORD());const s=e.get();for(const i of t)if(i.contains(s))return _e.success(i);return _e.failure(J3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(e){const t=e.gameState,r=t.getCurrentOpponent();let s=[];if(e.move.isPresent()&&(s=this.getShapeVictory(e.move.get(),t)),6===s.length)return Ne.getVictory(r);if(t.turn>39){const i=t.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?Ne.ONE_WON:c<o?Ne.ZERO_WON:Ne.DRAW:o<6?Ne.getDefeat(B.ZERO):c<6?Ne.getDefeat(B.ONE):Ne.ONGOING}return Ne.ONGOING}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,r){const s=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(e.index,s,r)}}searchVictoryOnlyForCircle(e,t,r){const s=r.getCurrentOpponent(),o=[t];let c=t.getNext(Re.factory.all[e],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const h=(e+o.length)%6;o.push(c),c=c.getNext(Re.factory.all[h],1)}return o}searchVictoryOnlyForLine(e,t,r){const s=r.getCurrentOpponent();let i=Re.factory.all[e],o=t.getNext(i,1);const c=[t];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(e,t,r){const s=r.getCurrentOpponent();let i=Re.factory.all[e];const o=[t];let c=t.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=Re.factory.all[(e+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(e,t,r){const s=r.getCurrentOpponent();let i=Re.factory.all[e];const o=[t];let c=t.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=Re.factory.all[(e+o.length)%6]),c=c.getNext(i,1)}return o}};Kc.singleton=y.empty(),Kc=F8=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],Kc);class k7t extends Xa{calculateBoardValue(e,t){this.startSearchingVictorySources();const r={status:Pn.DEFAULT,victory:y.empty(),preVictory:y.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===Pn.PRE_VICTORY?this.searchVictoryOnly(s,e,t):this.getBoardInfo(s,e,t,r),i.status===Pn.VICTORY)return i;r.status=i.status,r.sum=r.sum+i.sum,r.preVictory.isAbsent()&&(r.preVictory=i.preVictory)}return r}}var p7;class V6 extends Vn{constructor(e,t){super(e),this.preVictory=t}}let DT=p7=class extends k7t{static get(){if(p7.singleton.isAbsent()){const e=Kc.get();p7.singleton=y.of(new p7(e,"SixMinimax"))}return p7.singleton.get()}getListMoves(e){const t=p7.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedMovement(e,r);const s=Kc.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(s):this.getMovement(e.gameState,s)}getMovement(e,t){const r=this.getSafelyMovablePieceOrFirstOne(e);return this.getMovementFrom(e,r,t)}createForcedDrop(e){const t=[],r=Fr.ofDrop(e.preVictory.get());return t.push(r),t}createForcedMovement(e,t){const r=this.getSafelyMovablePieceOrFirstOne(e.gameState),s=[t.preVictory.get()];return this.getMovementFrom(e.gameState,r,s)}getMovementFrom(e,t,r){const s=[];for(const i of t)for(const o of r){const c=Fr.ofMovement(i,o);if(e.isCoordConnected(o,y.of(i))){const h=e.movePiece(c).getGroups();if(Kc.isSplit(h)){const g=Kc.getLargestGroups(h);if(1===g.size())s.push(Fr.ofMovement(i,o));else for(const m of g){const M=m.getAnyElement().get(),b=Fr.ofCut(i,o,M);s.push(b)}}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(e){const t=e.getPieces().reverse(),r=e.getCurrentPlayer(),s=t.get(r).get(),i=s.getAnyElement().get(),o=[];for(const c of s)!1===this.isPieceBlockingAVictory(e,c)&&o.push(c);return new Or(0===o.length?[i]:o)}isPieceBlockingAVictory(e,t){const r=e.switchPiece(t),s=Fr.ofDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===Pn.VICTORY)return!0;return!1}getListDrop(e){const t=[];for(const r of e){const s=Fr.ofDrop(r);t.push(s)}return t}getBoardValue(e){const t=e.move,r=e.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:Pn.DEFAULT,victory:y.empty(),preVictory:y.empty(),sum:0};if(t.isPresent()&&(o=this.calculateBoardValue(t.get(),r)),o.status===Pn.VICTORY)return new V6(i,y.empty());if(r.turn>39){const c=r.countPieces(),u=c[0],h=c[1];return u<6&&h<6?new V6(u<h?B.ONE.getVictoryValue():h<u?B.ZERO.getVictoryValue():0,y.empty()):u<6?new V6(B.ZERO.getDefeatValue(),y.empty()):h<6?new V6(B.ONE.getDefeatValue(),y.empty()):new V6(u-h,o.preVictory)}return new V6(o.status===Pn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),o.preVictory)}startSearchingVictorySources(){this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let t;switch(this.currentVictorySource.typeSource){case"LINE":t="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":t="TRIANGLE_EDGE";break;default:t="CIRCLE"}this.currentVictorySource={typeSource:t,index:0}}else{let t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}searchVictoryOnly(e,t,r){const s=t.landing;switch(e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(e.index,s,r)}}searchVictoryOnlyForCircle(e,t,r){const s=r.getCurrentOpponent(),o=[t];let c=t.getNext(Re.factory.all[e],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};const h=(e+o.length)%6;o.push(c),c=c.getNext(Re.factory.all[h],1)}return{status:Pn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}searchVictoryOnlyForLine(e,t,r){const s=r.getCurrentOpponent();let i=Re.factory.all[e],o=t.getNext(i,1);const c=[t];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:Pn.VICTORY,victory:y.of(c),preVictory:y.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(e,t,r){const s=r.getCurrentOpponent();let i=Re.factory.all[e];const o=[t];let c=t.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};o.length%2==0&&(i=Re.factory.all[(e+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:Pn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(e,t,r){const s=r.getCurrentOpponent();let i=Re.factory.all[e];const o=[t];let c=t.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};o.push(c),o.length%2==0&&(i=Re.factory.all[(e+o.length)%6]),c=c.getNext(i,1)}return{status:Pn.VICTORY,victory:y.of(o),preVictory:y.empty(),sum:0}}getBoardInfo(e,t,r,s){const i=t.landing;switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,r,s);case"LINE":return this.getBoardInfoForLine(e.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(e.index,i,r,s)}}getBoardInfoForCircle(e,t,r,s){const i=r.getCurrentPlayer(),c=[t];let u=t.getNext(Re.factory.all[e],1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const M=(e+c.length)%6;c.push(u);const b=Re.factory.all[M];m===le.NONE?(h+=.16,g=y.of(u)):h++,u=u.getNext(b,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoResult(e,t,r,s){let i=s.preVictory;if(4.16===e){if(i.isPresent()&&!1===i.equals(t))return{status:Pn.PRE_VICTORY,victory:y.empty(),preVictory:y.empty(),sum:0};i=t}else if(5===e)return{status:Pn.VICTORY,victory:y.of(r),preVictory:y.empty(),sum:0};return{status:s.status,victory:y.empty(),preVictory:i,sum:s.sum+e}}getBoardInfoForLine(e,t,r,s){const i=Re.factory.all[e];let o=t.getPrevious(i,5),c=[],u=[],h=y.empty();for(let G=0;G<6;G++){const j=this.updateEncounterAndReturnLastEmpty(r,o,u);j.isPresent()&&(h=j),c.push(o),o=o.getNext(i,1)}let g=s.status,m=s.preVictory,M=0,b=0;for(;M<6;){const G=u.reduce((ie,ye)=>ie+ye);if(6===G)return{status:Pn.VICTORY,victory:y.of(c),preVictory:y.empty(),sum:0};5.16===G&&g===Pn.DEFAULT&&(m.isPresent()?(qe(!1===m.equals(h),"Impossible to have point aligned with differents line to a same point"),g=Pn.PRE_VICTORY):m=h),b=Math.max(b,G),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const j=this.updateEncounterAndReturnLastEmpty(r,o,u);j.isPresent()&&(h=j),M++,o=o.getNext(i,1)}const L={status:g,victory:y.of(c),preVictory:m,sum:b};return this.getBoardInfoResult(b,h,c,L)}updateEncounterAndReturnLastEmpty(e,t,r){const s=e.getCurrentPlayer();switch(e.getPieceAt(t)){case s:return r.push(-7),y.empty();case le.NONE:return r.push(.16),y.of(t);default:return r.push(1),y.empty()}}getBoardInfoForTriangleCorner(e,t,r,s){const i=r.getCurrentPlayer();let o=Re.factory.all[e];const c=[t];let u=t.getNext(o,1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===le.NONE?(h+=.16,g=y.of(u)):h++,c.length%2==0&&(o=Re.factory.all[(e+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}getBoardInfoForTriangleEdge(e,t,r,s){const i=r.getCurrentPlayer();let o=Re.factory.all[e];const c=[t];let u=t.getNext(o,1),h=0,g=y.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===le.NONE?(h+=.16,g=y.of(u)):h++,c.push(u),c.length%2==0&&(o=Re.factory.all[(e+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(h,g,c,s)}};DT.singleton=y.empty(),DT=p7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],DT);const Se=le.NONE,Gt=B.ZERO,Jt=B.ONE;let HF=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class V4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,co.getInitialState()),ee.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,co.ofRepresentation([[Gt,Jt,Jt,Jt,Jt,Gt],[Se,Gt,Jt,Se,Gt,Se],[Jt,Jt,Gt,Se,Se,Se],[Se,Se,Gt,Se,Se,Se],[Se,Gt,Se,Se,Se,Se],[Gt,Se,Se,Se,Se,Se]],0),[Fr.ofDrop(new S(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,co.ofRepresentation([[Se,Se,Se,Jt,Se,Se],[Se,Se,Jt,Jt,Gt,Gt],[Se,Jt,Se,Gt,Jt,Se],[Jt,Gt,Gt,Gt,Gt,Jt]],0),[Fr.ofDrop(new S(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),ee.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,co.ofRepresentation([[Se,Se,Se,Jt,Se,Se],[Se,Gt,Jt,Gt,Gt,Gt],[Se,Gt,Se,Gt,Gt,Se],[Jt,Jt,Jt,Se,Jt,Se]],0),[Fr.ofDrop(new S(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),ee.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,co.ofRepresentation([[Se,Se,Se,Se,Se,Se,Se,Jt,Se],[Se,Se,Se,Se,Se,Se,Gt,Se,Se],[Se,Se,Se,Se,Gt,Gt,Gt,Se,Se],[Se,Se,Se,Se,Jt,Jt,Se,Jt,Gt],[Se,Gt,Jt,Jt,Gt,Gt,Jt,Se,Se],[Gt,Gt,Gt,Gt,Jt,Jt,Jt,Gt,Se],[Jt,Jt,Gt,Se,Jt,Jt,Gt,Se,Se],[Se,Gt,Se,Gt,Gt,Se,Se,Se,Se],[Jt,Jt,Jt,Jt,Se,Se,Se,Se,Se],[Se,Gt,Se,Jt,Se,Se,Se,Se,Se]],40),Fr.ofMovement(new S(6,1),new S(5,1)),(e,t,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?R.SUCCESS:R.failure(HF.MOVEMENT_NOT_DISCONNECTING()):R.failure(HF.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),ee.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,co.ofRepresentation([[Se,Se,Se,Se,Se,Jt],[Se,Se,Se,Se,Gt,Jt],[Se,Se,Se,Jt,Gt,Gt],[Se,Se,Gt,Se,Jt,Gt],[Jt,Jt,Se,Se,Se,Gt],[Gt,Jt,Se,Se,Se,Se],[Gt,Se,Se,Se,Se,Se]],40),Fr.ofMovement(new S(2,3),new S(3,3)),(e,t,r)=>e.start.equalsValue(new S(2,3))?R.SUCCESS:R.failure(HF.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),ee.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,co.ofRepresentation([[Se,Se,Se,Se,Se,Jt],[Se,Se,Se,Se,Gt,Jt],[Se,Se,Se,Jt,Gt,Gt],[Gt,Se,Gt,Se,Se,Jt],[Jt,Jt,Se,Se,Se,Se],[Gt,Gt,Se,Se,Se,Se],[Gt,Se,Se,Se,Se,Se]],40),Fr.ofCut(new S(2,3),new S(2,5),new S(2,5)),(e,t,r)=>e.keep.isAbsent()?R.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(e.landing)===le.NONE?R.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):R.SUCCESS,$localize`Congratulations, you won!`)]}}function R7t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",10),J("click",function(){const i=he(t).$implicit;return ce(C().onPieceClick(i))}),A()}if(2&n){const t=e.$implicit,r=C();ke("id","piece_",t.x,"_",t.y,""),w("ngClass",r.getPieceClass(t)),z("points",r.getHexaPointsAt(t))}}function D7t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",11),J("click",function(){const i=he(t).$implicit;return ce(C().onNeighborClick(i))}),A()}if(2&n){const t=e.$implicit,r=C();ke("id","neighbor_",t.x,"_",t.y,""),z("points",r.getHexaPointsAt(t))}}function z7t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",10),J("click",function(){he(t);const s=C();return ce(s.onPieceClick(s.chosenLanding.get()))}),A()}if(2&n){const t=C();ke("id","chosenLanding_",t.chosenLanding.get().x,"_",t.chosenLanding.get().y,""),w("ngClass",t.getPlayerClass(t.state.getCurrentPlayer())),z("points",t.getHexaPointsAt(t.chosenLanding.get()))}}function H7t(n,e){if(1&n&&(V(),X(0,"polygon",12)),2&n){const t=e.$implicit,r=C();ke("id","disconnected_",t.x,"_",t.y,""),z("points",r.getHexaPointsAt(t))}}function V7t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",13),J("click",function(){he(t);const s=C();return ce(s.onNeighborClick(s.leftCoord.get()))}),A()}if(2&n){const t=C();ke("id","leftCoord_",t.leftCoord.get().x,"_",t.leftCoord.get().y,""),z("points",t.getHexaPointsAt(t.leftCoord.get()))}}function F7t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",14),J("click",function(){he(t);const s=C();return ce(s.onPieceClick(s.lastDrop.get()))}),A()}if(2&n){const t=C();ke("id","lastDrop_",t.lastDrop.get().x,"_",t.lastDrop.get().y,""),z("points",t.getHexaPointsAt(t.lastDrop.get()))}}function B7t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",15),J("click",function(){he(t);const s=C();return ce(s.onPieceClick(s.selectedPiece.get()))}),A()}if(2&n){const t=C();ke("id","selectedPiece_",t.selectedPiece.get().x,"_",t.selectedPiece.get().y,""),w("ngClass",t.getSelectedPieceClass()),z("points",t.getHexaPointsAt(t.selectedPiece.get()))}}function $7t(n,e){if(1&n&&(V(),X(0,"polygon",16)),2&n){const t=e.$implicit,r=C();ke("id","victoryCoord_",t.x,"_",t.y,""),z("points",r.getHexaPointsAt(t))}}function G7t(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",19),J("click",function(){const i=he(t).$implicit;return ce(C(2).onPieceClick(i))}),A()}if(2&n){const t=e.$implicit,r=C(2);ke("id","cuttable_",t.x,"_",t.y,""),z("points",r.getHexaPointsAt(t))}}function U7t(n,e){if(1&n&&(V(),O(0,"g",17),x(1,G7t,1,3,"polygon",18),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}let q7t=(()=>{class n extends d9{constructor(t){super(t),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=y.empty(),this.lastDrop=y.empty(),this.selectedPiece=y.empty(),this.chosenLanding=y.empty(),this.nextClickShouldSelectGroup=!1,this.rules=Kc.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new DT(this.rules,"SixMinimax")],this.encoder=Fr.encoder,this.tutorial=(new V4e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new p9(1.5*this.SPACE_SIZE,new S(2*this.SPACE_SIZE,0),ws.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=y.empty(),this.chosenLanding=y.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.node.gameState,this.node.move.isAbsent()&&this.hideLastMove(),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}hideLastMove(){this.leftCoord=y.empty(),this.lastDrop=y.empty(),this.victoryCoords=[],this.disconnecteds=[]}getViewBox(){const t=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return k6.fromHexa(t,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(t){this.lastDrop=y.of(t.landing),this.leftCoord=!1===t.isDrop()?y.of(t.start.get()):y.empty();const r=this.getState();this.rules.getGameStatus(this.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(t,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const t=this.getPreviousState().getPieceCoords(),r=this.getState().getPieceCoords(),s=[];for(const o of t)!1===this.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o))&&s.push(o);const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let t=Kc.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();t=t.filter(s=>!1===s.equals(r))}return t}getPieceClass(t){const r=this.getState().getPieceAt(t);return this.getPlayerClass(r)}onPieceClick(t){var r=this;return I(function*(){const s=r.canUserPlay("#piece_"+t.x+"_"+t.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(J3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(t)===r.state.getCurrentOpponent()?r.cancelMove(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(t)?y.empty():y.of(t),R.SUCCESS);{const i=Fr.ofCut(r.selectedPiece.get(),r.chosenLanding.get(),t);return r.chooseMove(i)}})()}onNeighborClick(t){var r=this;return I(function*(){const s=r.canUserPlay("#neighbor_"+t.x+"_"+t.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(J3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(Fr.ofDrop(t));if(r.selectedPiece.isAbsent())return r.cancelMove(J3.CAN_NO_LONGER_DROP());{const i=Fr.ofMovement(r.selectedPiece.get(),t),o=Kc.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=y.of(t),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,R.SUCCESS):r.chooseMove(i)}})()}neededCutting(t){return t.isFailure()&&t.getReason()===J3.MUST_CUT()}moveVirtuallyPiece(){const t=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(t)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const t=Fr.ofMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(t).getGroups(),i=Kc.getLargestGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,R7t,1,4,"polygon",1),x(2,D7t,1,3,"polygon",2),x(3,z7t,1,4,"polygon",3),x(4,H7t,1,3,"polygon",4),x(5,V7t,1,3,"polygon",5),x(6,F7t,1,3,"polygon",6),x(7,B7t,1,4,"polygon",7),x(8,$7t,1,3,"polygon",8),x(9,U7t,2,1,"g",9),A()),2&t&&(z("viewBox",r.viewBox),T(1),w("ngForOf",r.pieces),T(1),w("ngForOf",r.neighbors),T(1),w("ngIf",r.chosenLanding.isPresent()),T(1),w("ngForOf",r.disconnecteds),T(1),w("ngIf",r.leftCoord.isPresent()),T(1),w("ngIf",r.lastDrop.isPresent()),T(1),w("ngIf",r.selectedPiece.isPresent()),T(1),w("ngForOf",r.victoryCoords),T(1),w("ngForOf",r.cuttableGroups))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ma extends hF{static of(e,t){return new Ma(e,t)}static from(e,t){try{const r=new Ma(e,t);return _e.success(r)}catch(r){return _e.failure(r.message)}}getMaximalDistance(){return 9}}Ma.encoder=_a.getFallibleEncoder(Ma.from);const W7t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:B.ZERO};class hl extends dF{static getInitialState(){const e=Tn.UNOCCUPIED,t=Tn.INVADERS,r=Tn.DEFENDERS;return new hl([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Tn.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}of(e,t){return new hl(e,t)}}class B8 extends pF{constructor(){super(hl,W7t,Ma.from)}static get(){return B8.singleton.isAbsent()&&(B8.singleton=y.of(new B8)),B8.singleton.get()}}B8.singleton=y.empty();const Z=Tn.UNOCCUPIED,s1=Tn.INVADERS,lo=Tn.DEFENDERS,zT=Tn.PLAYER_ONE_KING;class F4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,hl.getInitialState()),ee.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,hl.getInitialState(),Ma.of(new S(4,1),new S(1,1)),$localize`Congratulations!`),ee.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new hl([[Z,Z,Z,s1,s1,s1,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,Z,lo,Z,Z,Z,Z],[Z,Z,Z,s1,lo,Z,Z,Z,s1],[s1,s1,lo,lo,zT,lo,lo,s1,s1],[Z,Z,Z,Z,lo,Z,Z,Z,s1],[Z,Z,Z,Z,lo,Z,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,s1,s1,s1,Z,Z,Z]],1),[Ma.of(new S(2,4),new S(2,3)),Ma.of(new S(4,2),new S(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ee.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new hl([[Z,Z,Z,s1,s1,s1,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,Z,lo,Z,Z,Z,Z],[Z,Z,lo,Z,zT,Z,lo,Z,s1],[s1,s1,Z,lo,Z,lo,lo,s1,s1],[Z,Z,Z,Z,lo,Z,Z,Z,s1],[Z,Z,Z,Z,lo,Z,Z,Z,Z],[Z,Z,Z,Z,s1,Z,Z,Z,Z],[Z,Z,Z,s1,s1,s1,Z,Z,Z]],12),[Ma.of(new S(1,4),new S(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ee.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new hl([[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,s1,Z,Z,Z,Z,Z,Z,Z],[s1,zT,Z,s1,Z,Z,Z,Z,Z],[Z,s1,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z]],72),[Ma.of(new S(3,4),new S(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ee.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new hl([[Z,Z,s1,zT,s1,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,s1,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z],[Z,Z,Z,Z,Z,Z,Z,Z,Z]],72),[Ma.of(new S(3,3),new S(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function j7t(n,e){1&n&&(V(),X(0,"polygon",8))}function Z7t(n,e){1&n&&(V(),X(0,"rect",9))}function Y7t(n,e){if(1&n&&(V(),O(0,"g"),x(1,j7t,1,0,"polygon",6),x(2,Z7t,1,0,"ng-template",null,7,Un),A()),2&n){const t=Hn(3),r=C().index,s=C().index,i=C();T(1),w("ngIf",i.isCentralThrone(r,s))("ngIfElse",t)}}function K7t(n,e){if(1&n&&(V(),O(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),A()),2&n){const t=C(2).index,r=C().index,s=C();T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function X7t(n,e){if(1&n&&(V(),X(0,"polyline",16)),2&n){const t=C(3).index,r=C().index;w("ngClass",C().viewInfo.pieceClasses[r][t])}}function Q7t(n,e){if(1&n&&(V(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const t=C(3).index,r=C().index,s=C();w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),T(1),w("ngClass",s.viewInfo.pieceClasses[r][t]),z("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function J7t(n,e){if(1&n&&(V(),x(0,X7t,1,1,"polyline",14),x(1,Q7t,4,20,"ng-template",null,15,Un)),2&n){const t=Hn(2),r=C(2).index,s=C().index;w("ngIf",C().isKing(r,s))("ngIfElse",t)}}function eft(n,e){if(1&n&&(V(),O(0,"g"),X(1,"circle",10),x(2,K7t,6,25,"g",11),x(3,J7t,3,2,"ng-template",null,12,Un),A()),2&n){const t=Hn(4),r=C().index,s=C().index,i=C();T(1),ke("id","piece_",r,"_",s,""),w("ngClass",i.viewInfo.pieceClasses[s][r]),z("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),T(1),w("ngIf",i.isInvader(r,s))("ngIfElse",t)}}function tft(n,e){if(1&n){const t=Oe();V(),O(0,"g",3),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",4),x(2,Y7t,4,2,"g",5),x(3,eft,5,8,"g",5),A()}if(2&n){const t=e.index,r=C().index,s=C();ke("id","click_",t,"_",r,""),z("transform","translate("+s.SPACE_SIZE*t+", "+s.SPACE_SIZE*r+")"),T(1),ke("id","space_",t,"_",r,""),w("ngClass",s.getRectClasses(t,r)),z("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),T(1),w("ngIf",s.board[r][t]===s.EMPTY&&s.isThrone(t,r)),T(1),w("ngIf",s.board[r][t]!==s.EMPTY)}}function nft(n,e){if(1&n&&(V(),O(0,"g"),x(1,tft,4,10,"g",2),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function rft(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"rect",17),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i.x,i.y))}),A()()}if(2&n){const t=e.$implicit,r=C();T(1),ke("id","click_",t.x,"_",t.y,""),z("x",r.SPACE_SIZE*t.x)("y",r.SPACE_SIZE*t.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let sft=(()=>{class n extends gF{constructor(t){super(t,Ma.from),this.rules=B8.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new m9(this.rules,"DummyBot"),new iT(this.rules,"Piece > Influence"),new oT(this.rules,"Piece > Control"),new mF(this.rules,"Escape > Piece > Control")],this.encoder=Ma.encoder,this.tutorial=(new F4e).tutorial,this.updateBoard()}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"id","ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,nft,2,1,"g",1),x(2,rft,2,6,"g",1),A()),2&t&&(z("viewBox",r.getViewBox()),T(1),w("ngForOf",r.board),T(1),w("ngForOf",r.getClickables()))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),ic=(()=>{class n extends br{static isOnBoard(t){return t.isInRange(n.WIDTH,n.WIDTH)}static getInitialState(){const t=Je.createTable(n.WIDTH,n.WIDTH,le.NONE);return new n(t,0)}isInDropPhase(){return this.turn<8}}return n.WIDTH=5,n})();class oc extends us{static from(e){return ic.isOnBoard(e)?_e.success(new oc(e.x,e.y)):_e.failure(h9.OUT_OF_RANGE(e))}toString(){return"TeekoMove"+this.coord.toString()}equals(e){return e instanceof oc&&super.equals(e)}}oc.encoder=us.getFallibleEncoder(oc.from);class Sa extends kc{static from(e,t){return!1===ic.isOnBoard(e)?_e.failure(h9.OUT_OF_RANGE(e)):!1===ic.isOnBoard(t)?_e.failure(h9.OUT_OF_RANGE(t)):e.equals(t)?_e.failure(Xe.MOVE_CANNOT_BE_STATIC()):_e.success(new Sa(e,t))}toString(){return"TeekoMove("+this.getStart().toString()+" -> "+this.getEnd().toString()+")"}equals(e){return e instanceof Sa&&super.equals(e)}}var VF;Sa.encoder=kc.getFallibleEncoder(Sa.from),function(n){n.encoder=Ye.disjunction([e=>e instanceof oc,e=>e instanceof Sa],[oc.encoder,Sa.encoder])}(VF||(VF={}));class ac extends N1{constructor(){super(ic)}static get(){return ac.singleton.isAbsent()&&(ac.singleton=y.of(new ac)),ac.singleton.get()}isLegal(e,t){return t.isInDropPhase()?this.isLegalDrop(e,t):this.isLegalTranslation(e,t)}isLegalDrop(e,t){return pe.assert(e instanceof oc,"Cannot translate in dropping phase !"),t.getPieceAt(e.coord).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}isLegalTranslation(e,t){pe.assert(e instanceof Sa,"Cannot drop in translation phase !");const r=e,s=t.getCurrentOpponent();return t.getPieceAt(r.getStart())===s?R.failure(Xe.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(r.getStart())===le.NONE?R.failure(Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):t.getPieceAt(r.getEnd()).isPlayer()?R.failure(Xe.MUST_LAND_ON_EMPTY_SPACE()):R.SUCCESS}applyLegalMove(e,t){return e instanceof oc?this.applyLegalDrop(e,t):this.applyLegalTranslate(e,t)}applyLegalDrop(e,t){const r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=t.getCurrentPlayer(),new ic(r,t.turn+1)}applyLegalTranslate(e,t){const r=t.getCopiedBoard();return r[e.getStart().y][e.getStart().x]=le.NONE,r[e.getEnd().y][e.getEnd().x]=t.getCurrentPlayer(),new ic(r,t.turn+1)}getGameStatus(e){const t=e.gameState;return this.getVictoryCoord(t).length>0?Ne.getVictory(t.getCurrentOpponent()):Ne.ONGOING}getLastCoord(e){return e instanceof oc?e.coord:e.getEnd()}getSquareInfo(e){const t=[],r=[0,0];for(let s=0;s<ic.WIDTH-1;s++)for(let i=0;i<ic.WIDTH-1;i++){const o=new S(s,i),c=new S(s+1,i),u=new S(s,i+1),h=new S(s+1,i+1),g=[e.getPieceAt(o),e.getPieceAt(c),e.getPieceAt(u),e.getPieceAt(h)],m=this.count(g,le.NONE),M=this.count(g,le.ZERO),b=this.count(g,le.ONE);m<4&&(4===M||4===b?t.push(o,c,u,h):M>0?r[0]=r[0]+1:r[1]=r[1]+1)}return{score:r[1]-r[0],victoriousCoords:t}}count(e,t){let r=0;for(const s of e)s===t&&r++;return r}getVictoryCoord(e){const t=ac.TEEKO_HELPER.getVictoriousCoord(e);return t.push(...this.getSquareInfo(e).victoriousCoords),t}}ac.singleton=y.empty(),ac.TEEKO_HELPER=new _9(ic.isOnBoard,pe.identity,4);class ift extends Xa{constructor(){super(ac.get(),"Teeko Minimax")}getListMoves(e){return e.gameState.isInDropPhase()?this.getListDrops(e.gameState):this.getListTranslations(e.gameState)}getListDrops(e){const t=[];for(const r of e.getCoordsAndContents()){const s=r.coord;if(!1===e.getPieceAt(s).isPlayer()){const i=oc.from(s).get();t.push(i)}}return t}getListTranslations(e){const t=[],r=e.getCurrentPlayer(),s=this.getCoordsContaining(e,r),i=this.getCoordsContaining(e,le.NONE);for(const o of s)for(const c of i){const u=Sa.from(o,c).get();t.push(u)}return t}getCoordsContaining(e,t){const r=[];for(const s of e.getCoordsAndContents())s.content===t&&r.push(s.coord);return r}getBoardValue(e){const t=ac.TEEKO_HELPER.getBoardValue(e.gameState).value;if(Vn.VICTORIES.some(r=>r===t))return new Vn(t);{const r=ac.get().getSquareInfo(e.gameState);return r.victoriousCoords.length>0?Vn.fromWinner(e.gameState.getCurrentOpponent()):new Vn(r.score+t)}}}const v1=le.NONE,$8=le.ZERO,G8=le.ONE;class B4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`The goal of the game is to align your 4 pieces, or to form a square with them.`,ic.getInitialState()),ee.anyMove($localize`Dropping a piece`,$localize`During your first four turns, you must drop one piece on any empty space of the board. There is no other restriction.<br/><br/>You're playing Dark, put a piece on the board.`,ic.getInitialState(),oc.from(new S(2,2)).get(),$localize`Congratulations!`),ee.anyMove($localize`Moving a piece`,$localize`Once all of your four pieces are placed on the board, you must now move one of your piece to another empty space. The goal remain to be the first to create a line or a square.<br/><br/>You're playing Dark, move a piece.`,new ic([[$8,G8,v1,v1,v1],[$8,$8,v1,v1,v1],[G8,G8,v1,v1,v1],[G8,$8,v1,v1,v1],[v1,v1,v1,v1,v1]],8),Sa.from(new S(1,3),new S(2,1)).get(),$localize`Congratulations!`),ee.fromMove($localize`Victory`,$localize`In this board, you can win either by creating a line, or a square.<br/><br/>You are playing Dark, win.`,new ic([[G8,v1,v1,v1,v1],[G8,$8,v1,v1,v1],[v1,$8,$8,G8,v1],[v1,G8,v1,$8,v1],[v1,v1,v1,v1,v1]],8),[Sa.from(new S(1,2),new S(4,4)).get(),Sa.from(new S(3,3),new S(2,1)).get()],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function oft(n,e){if(1&n&&(V(),X(0,"circle",4)),2&n){const t=C().index,r=C().index,s=C();ke("id","piece_",t,"_",r,""),w("ngClass",s.getPieceClasses(t,r)),z("r",42)("cx",s.SPACE_SIZE*t+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function aft(n,e){if(1&n){const t=Oe();V(),O(0,"g",3),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),X(1,"rect",4),x(2,oft,1,6,"circle",5),A()}if(2&n){const t=e.$implicit,r=e.index,s=C().index,i=C();ke("id","click_",r,"_",s,""),T(1),ke("id","space_",r,"_",s,""),w("ngClass",i.getSpaceClasses(r,s)),z("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),T(1),w("ngIf",t.isPlayer())}}function cft(n,e){if(1&n&&(V(),O(0,"g"),x(1,aft,3,10,"g",2),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}let lft=(()=>{class n extends to{constructor(t){super(t),this.selected=y.empty(),this.last=y.empty(),this.moved=[],this.victory=[],this.rules=ac.get(),this.node=this.rules.getInitialNode(),this.encoder=VF.encoder,this.tutorial=(new B4e).tutorial,this.availableMinimaxes=[new ift]}updateBoard(){this.board=this.node.gameState.board}showLastMove(t){this.hideLastMove(),this.last=y.of(this.rules.getLastCoord(t)),this.moved=t instanceof Sa?[t.getStart(),t.getEnd()]:[],this.victory=this.rules.getVictoryCoord(this.getState())}hideLastMove(){this.last=y.empty(),this.moved=[],this.victory=[]}cancelMoveAttempt(){this.selected=y.empty()}onClick(t,r){var s=this;return I(function*(){const i=s.canUserPlay("#click_"+t+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new S(t,r);if(s.getState().isInDropPhase()){const c=oc.from(o).get();return s.chooseMove(c)}if(s.selected.isPresent()){if(s.selected.equalsValue(o))return s.selected=y.empty(),R.SUCCESS;{const c=Sa.from(s.selected.get(),o).get();return s.chooseMove(c)}}{const c=s.getState().getCurrentPlayer(),u=s.getState().getPieceAt(o);return u===c?(s.selected=y.of(o),R.SUCCESS):s.cancelMove(u===le.NONE?Xe.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY():Xe.CANNOT_CHOOSE_OPPONENT_PIECE())}})()}getPieceClasses(t,r){const s=new S(t,r),o=[this.getPlayerClass(this.getState().getPieceAt(s))];return this.victory.some(c=>c.equals(s))?o.push("victory-stroke"):this.last.equalsValue(s)?o.push("last-move-stroke"):this.selected.equalsValue(s)&&o.push("selected-stroke"),o}getSpaceClasses(t,r){const s=new S(t,r);return this.moved.some(i=>i.equals(s))?["moved-fill"]:[]}}return n.\u0275fac=function(t){return new(t||n)(Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-teeko"]],features:[l],decls:2,vars:1,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-5 -5 510 510","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"id","ngClass"],["class","base",3,"id","ngClass",4,"ngIf"]],template:function(t,r){1&t&&(V(),O(0,"svg",0),x(1,cft,2,1,"g",1),A()),2&t&&(T(1),w("ngForOf",r.board))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class V2{constructor(e,t){this.owner=e,this.tileId=t}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class ks{constructor(e){this.pieces=e}static of(e){let t=-1;for(const r of e)qe(t<r.tileId,"TrexoPieceStack: dropped turn should be ascending"),t=r.tileId;return new ks(e)}getHeight(){return this.pieces.length}getOwner(){const e=this.pieces.length;return 0===e?le.NONE:this.pieces[e-1].owner}getUpperTileId(){const e=this.pieces.length;return 0===e?-1:this.pieces[e-1].tileId}add(e){return ks.of(this.pieces.concat(e))}getPieceAt(e){return qe(e<this.pieces.length,"no element "+e+"in piece!"),this.pieces[e]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(e=>"("+e.toString()+")").join(" ")+"]"}}ks.EMPTY=ks.of([]);let Jr=(()=>{class n extends br{static getInitialState(){const t=Je.createTable(n.SIZE,n.SIZE,ks.EMPTY);return new n(t,0)}static of(t,r){pe.assert(t.length===n.SIZE,"Invalid board dimensions");for(const s of t)pe.assert(s.length===n.SIZE,"Invalid board dimensions");return new n(t,r)}drop(t,r){const s=this.getCopiedBoard(),i=new V2(r,this.turn);return s[t.y][t.x]=s[t.y][t.x].add(i),new n(s,this.turn)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(t=>"["+t.map(r=>"TrexoPieceStack.of("+r.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(t,r,s){return this.getPieceAtXY(t,r).getPieceAt(s)}}return n.SIZE=10,n})(),HT=(()=>{class n{}return n.NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`,n.NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`,n.CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`,n.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`,n})();class Pa extends _a{constructor(e,t){super(e,t)}static from(e,t){return pe.assert(e.isInRange(Jr.SIZE,Jr.SIZE),`${e.toString()} is out of the TrexoBoard!`),pe.assert(t.isInRange(Jr.SIZE,Jr.SIZE),`${t.toString()} is out of the TrexoBoard!`),1===e.getOrthogonalDistance(t)?_e.success(new Pa(e,t)):_e.failure(HT.NON_NEIGHBORING_SPACES())}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(e){return this.getFirst().equals(e.getFirst())&&this.getSecond().equals(e.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}Pa.encoder=_a.getFallibleEncoder(Pa.from);class Qi extends N1{constructor(){super(Jr)}static get(){return Qi.instance.isAbsent()&&(Qi.instance=y.of(new Qi)),Qi.instance.get()}static getOwner(e){return e.getOwner()}static isInRange(e){return e.isInRange(Jr.SIZE,Jr.SIZE)}applyLegalMove(e,t,r){return t.drop(e.getZero(),B.ZERO).drop(e.getOne(),B.ONE).incrementTurn()}isLegal(e,t){return this.isUnevenGround(e,t)?R.failure(HT.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(e,t)?R.failure(HT.CANNOT_DROP_ON_ONLY_ONE_PIECE()):R.SUCCESS}isUnevenGround(e,t){const r=t.getPieceAt(e.getZero()),s=t.getPieceAt(e.getOne());return r.getHeight()!==s.getHeight()}landsOnOnlyOnePiece(e,t){const r=t.getPieceAt(e.getZero()),s=t.getPieceAt(e.getOne());return(-1!==r.getUpperTileId()||-1!==s.getUpperTileId())&&r.getUpperTileId()===s.getUpperTileId()}static getSquareScore(e,t){return Qi.TREXO_HELPER.getSquareScore(e,t)}static getVictoriousCoords(e){const t=[],r=[],s=e.getCurrentOpponent();for(const i of e.toMap()){const o=i.key,c=e.getPieceAt(o).getOwner();if(c.isPlayer()){const u=Qi.getSquareScore(e,o);x2.getScoreStatus(u)===Pn.VICTORY&&(c===s?t.push(o):r.push(o))}}return r.length>0?r:t}getGameStatus(e){const t=e.gameState,r=t.getCurrentOpponent();let s=!1;for(const i of t.toMap()){const o=i.key,c=t.getPieceAt(o).getOwner();if(c.isPlayer()){const u=Qi.getSquareScore(t,o);if(x2.getScoreStatus(u)===Pn.VICTORY){if(c!==r)return Ne.getDefeat(r);s=!0}}}return s?Ne.getVictory(r):Ne.ONGOING}getLegalMoves(e){const t=[];for(const r of e.toMap()){const s=r.key;if(s.x+1<Jr.SIZE){const i=new S(s.x+1,s.y);t.push(...this.getPossiblesMoves(e,s,i))}if(s.y+1<Jr.SIZE){const i=new S(s.x,s.y+1);t.push(...this.getPossiblesMoves(e,s,i))}}return t}getPossiblesMoves(e,t,r){const s=e.getPieceAt(t),i=e.getPieceAt(r);let o;o=!s.isGround()&&s.getUpperTileId()===i.getUpperTileId();const c=s.getHeight()!==i.getHeight();return o||c?[]:[Pa.from(t,r).get(),Pa.from(r,t).get()]}}Qi.instance=y.empty(),Qi.TREXO_HELPER=new _9(Qi.isInRange,Qi.getOwner,5);class uft extends Xa{getListMoves(e){return Qi.get().getLegalMoves(e.gameState)}getBoardValue(e){let t=0;const r=e.gameState,s=r.getCurrentOpponent();let i=!1;for(const o of r.toMap()){const c=r.getPieceAt(o.key).getOwner();if(c.isPlayer()){const u=Qi.getSquareScore(r,o.key);if(x2.getScoreStatus(u)===Pn.VICTORY){if(c!==s)return new Vn(s.getDefeatValue());i=!0}else t+=u}}return new Vn(i?s.getVictoryValue():t)}}const ue=ks.EMPTY,$4e=ks.of([new V2(B.ONE,0)]),fft=ks.of([new V2(B.ZERO,0)]),hft=ks.of([new V2(B.ONE,1)]),G4e=ks.of([new V2(B.ZERO,1)]),dft=ks.of([new V2(B.ZERO,2)]),pft=ks.of([new V2(B.ONE,2)]),gft=ks.of([new V2(B.ZERO,0),new V2(B.ZERO,3)]),mft=ks.of([new V2(B.ONE,1),new V2(B.ONE,3)]),_ft=ks.of([new V2(B.ZERO,4)]),vft=ks.of([new V2(B.ONE,4)]),Cft=ks.of([new V2(B.ZERO,5)]),yft=ks.of([new V2(B.ONE,5)]),Eft=ks.of([new V2(B.ONE,6)]),Mft=ks.of([new V2(B.ZERO,6)]);class U4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,Jr.getInitialState()),ee.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,Jr.getInitialState(),Pa.from(new S(4,4),new S(3,4)).get(),$localize`Congratulations!`),ee.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new Jr([[ue,ue,ue,$4e,fft,G4e,hft,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue]],7),[Pa.from(new S(4,0),new S(5,0)).get(),Pa.from(new S(5,0),new S(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),ee.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new Jr([[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,Cft,ue,ue,ue,ue,ue,ue],[ue,ue,ue,yft,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,$4e,ue,ue,_ft,vft,ue],[ue,ue,ue,ue,gft,mft,G4e,ue,ue,ue],[ue,ue,ue,ue,ue,dft,Eft,Mft,ue,ue],[ue,ue,ue,ue,ue,pft,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue,ue,ue]],7),Pa.from(new S(2,0),new S(2,1)).get(),(e,t,r)=>Qi.TREXO_HELPER.getSquareScore(r,e.getOne())===Number.MAX_SAFE_INTEGER?R.SUCCESS:R.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)]}}function Sft(n,e){if(1&n){const t=Oe();V(),O(0,"g")(1,"polygon",5),J("click",function(){const i=he(t).index,o=C().index;return ce(C().onClick(i,o))}),A()()}if(2&n){const t=e.index,r=C().index,s=C();T(1),ke("id","space_",t,"_",r,""),w("ngClass",s.getSpaceClasses(t,r)),z("points",s.getParallelogramPoints())("transform",s.getTranslate(t,r,0))}}function Pft(n,e){if(1&n&&(V(),O(0,"g"),x(1,Sft,2,5,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Tft(n,e){if(1&n){const t=Oe();V(),O(0,"g",8),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C(2).onClick(s,i))}),A()}if(2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index,o=C().index,c=C();j2("id","half_tile_",r,"_",i,"_",o,""),w("mode",c.mode)("coord",c.Coord3D.of(r,i,o))("mustDisplayHeight","2D"===c.chosenMode)("move",s.move.get())("pieceClasses",c.getPieceClasses(r,i,o)),z("transform",c.getTranslate(r,i,o+1))}}const q4e=function(n){return[n]};function wft(n,e){if(1&n){const t=Oe();V(),O(0,"g",9),J("click",function(){he(t);const s=C().index,i=C().index;return ce(C(2).onClick(s,i))}),A()}if(2&n){const t=C().index,r=C().index,s=C().index,i=C();j2("id","dropped_piece_",t,"_",r,"_",s,""),w("mode",i.mode)("coord",i.Coord3D.of(t,r,s))("pieceClasses",b3(7,q4e,i.currentOpponentClass)),z("transform",i.getTranslate(t,r,s+1))}}function bft(n,e){if(1&n&&(V(),O(0,"g"),x(1,Tft,1,9,"g",6),x(2,wft,1,9,"g",7),A()),2&n){const t=e.$implicit;T(1),w("ngIf",t.move.isPresent()),T(1),w("ngIf",t.isDroppedPiece)}}function Oft(n,e){if(1&n&&(V(),O(0,"g"),x(1,bft,3,2,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function Aft(n,e){if(1&n&&(V(),O(0,"g"),x(1,Oft,2,1,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}const Nft=function(){return["player0-fill"]};function Ift(n,e){if(1&n){const t=Oe();V(),O(0,"g",10),J("click",function(){return he(t),ce(C().switchToMode("3D"))}),A()}if(2&n){const t=C();w("mode",t.TrexoComponent.modeMap["3D"])("coord",t.Coord3D.of(10.5,8.5,0))("pieceClasses",K1(4,Nft)),z("transform",t.get3DSwitcherTransform())}}function xft(n,e){if(1&n){const t=Oe();V(),O(0,"g",11),J("click",function(){return he(t),ce(C().switchToMode("2D"))}),A()}if(2&n){const t=C();w("mode",t.TrexoComponent.modeMap["2D"])("coord",t.Coord3D.of(12,9,0))("pieceClasses",b3(4,q4e,t.currentPlayerClass)),z("transform",t.getTranslate(12,9,0))}}class C1 extends l4e{constructor(e){super(e),this.TrexoComponent=C1,this.left=-this.STROKE_WIDTH/2,this.Coord3D=U_,this.up=0,this.chosenMode="3D",this.victoryCoords=[],this.droppedPiece=y.empty(),this.possibleNextClicks=[],this.possibleMoves=[],this.pieceOnBoard=[],this.currentOpponentClass="player1",this.currentPlayerClass="player0",this.rules=Qi.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new uft(this.rules,"TrexoMinimax")],this.encoder=Pa.encoder,this.tutorial=(new U4e).tutorial,C1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(e){this.chosenMode=e,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=C1.modeMap[e]}getViewBoxWidth(){const e=C1.modeMap["3D"],t=Jr.SIZE;return"2D"===this.chosenMode?(t+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:t*(this.SPACE_SIZE*(e.horizontalWidthRatio+e.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const t=Jr.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?t:this.STROKE_WIDTH+t+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const e=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+e)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*C1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(e.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(e.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(e),this.victoryCoords=Qi.getVictoriousCoords(e),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const e=Je.create3DTable(1,Jr.SIZE,Jr.SIZE,C1.INITIAL_PIECE_ON_BOARD);let t=1;for(let r=0;r<=t;r++)for(const s of this.getState().toMap()){const i=s.key,o=s.value.getHeight();if(t=Math.max(t,o),r<o){const c=this.extractMoveFromState(i.x,i.y,r);this.addMoveToArray(r,c,e)}}return e}extractMoveFromState(e,t,r){const s=this.getState().getPieceAtXYZ(e,t,r),i=new S(e,t);let o=new S(-2,-2);for(const c of be.ORTHOGONALS){const u=i.getNext(c);if(u.isInRange(Jr.SIZE,Jr.SIZE)){const h=this.getState().getPieceAt(u);h.getHeight()>r&&h.getPieceAt(r).tileId===s.tileId&&(o=u)}}return s.owner===B.ZERO?Pa.from(i,o).get():Pa.from(o,i).get()}addMoveToArray(e,t,r){for(;r.length<=e;)r.push(Je.createTable(Jr.SIZE,Jr.SIZE,C1.INITIAL_PIECE_ON_BOARD));r[e][t.getZero().y][t.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:y.of(t)},r[e][t.getOne().y][t.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:y.of(t)}}onClick(e,t){var r=this;return I(function*(){const s=r.canUserPlay("#space_"+e+"_"+t);if(s.isFailure())return r.cancelMove(s.getReason());const i=new S(e,t);if(r.droppedPiece.isPresent()){const o=r.droppedPiece.get();if(r.droppedPiece.equalsValue(i))return r.cancelMoveAttempt(),R.SUCCESS;if(r.possibleNextClicks.some(c=>c.equals(i))){const c=r.getState().getCurrentPlayer()===B.ZERO,g=Pa.from(c?i:o,c?o:i).get();return r.chooseMove(g)}r.deselectPiece()}return r.selectPiece(i)})()}deselectPiece(){const e=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),t=this.droppedPiece.get().y,r=this.droppedPiece.get().x;this.pieceOnBoard[e][t][r]=C1.INITIAL_PIECE_ON_BOARD;for(const s of this.possibleNextClicks)this.pieceOnBoard[e][s.y][s.x].isPossibleClick=!1}selectPiece(e){if(this.possibleMoves.some(t=>t.getZero().equals(e))){const t=this.getState().getPieceAt(e).getHeight();return t>=this.pieceOnBoard.length&&this.pieceOnBoard.push(Je.createTable(Jr.SIZE,Jr.SIZE,C1.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(e,t),R.SUCCESS}return this.cancelMove(HT.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(e,t){this.droppedPiece=y.of(e),this.possibleNextClicks=this.getPossibleNextClicks(e);for(const r of this.possibleNextClicks)this.pieceOnBoard[t][r.y][r.x]={isDroppedPiece:!1,isPossibleClick:!0,move:y.empty()};this.pieceOnBoard[t][e.y][e.x]={isDroppedPiece:!0,isPossibleClick:!1,move:y.empty()}}getPossibleNextClicks(e){return this.possibleMoves.filter(r=>r.getZero().equals(e)).map(r=>r.getOne())}cancelMoveAttempt(){this.droppedPiece=y.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(e,t,r){const s=new S(e,t),i=this.getState().getPieceAtXYZ(e,t,r).owner;let o=[this.getPlayerClass(i)];o=o.concat(this.getSpaceClasses(e,t));for(const c of this.victoryCoords)if(c.equals(s)){o.push("victory-stroke");break}if(this.node.move.isPresent()){const c=this.node.move.get();(c.getZero().equals(s)||c.getOne().equals(s))&&o.push("last-move-stroke")}return o}getSpaceClasses(e,t){for(const r of this.pieceOnBoard)if(r[t][e].isPossibleClick)return["darker"];return[]}getTranslate(e,t,r){const i=this.getCoordTranslate(e,t,r,C1.modeMap[this.chosenMode]);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(t=>t.x+" "+t.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(C1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const e=C1.modeMap["3D"],t=e.horizontalWidthRatio+e.offsetRatio;return"translate("+(10+e.offsetRatio)*e.parallelogramHeight+", "+(9+(1-1/t)/2)*e.parallelogramHeight+") scale("+1/t+")"}}C1.INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:y.empty()},C1.modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}},C1.\u0275fac=function(e){return new(e||C1)(Q(_n))},C1.\u0275cmp=ct({type:C1,selectors:[["app-trexo"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(e,t){if(1&e&&(V(),O(0,"svg",0),x(1,Pft,2,1,"g",1),x(2,Aft,2,1,"g",1),O(3,"g",null,2),x(5,Ift,1,5,"g",3),x(6,xft,1,6,"ng-template",null,4,Un),A()()),2&e){const r=Hn(7);z("viewBox",t.left+" "+t.up+" "+t.width+" "+t.height),T(1),w("ngForOf",t.board),T(1),w("ngForOf",t.pieceOnBoard),T(3),w("ngIf","2D"===t.chosenMode)("ngIfElse",r)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Ir{}Ir.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,Ir.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,Ir.MISSING_CAPTURES=Bc.MISSING_CAPTURES,Ir.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,Ir.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,Ir.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,Ir.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,Ir.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,Ir.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,Ir.AMBIGUOUS_CAPTURE_COORD=Bc.AMBIGUOUS_CAPTURE_COORD,Ir.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class At{constructor(e,t){this.player=e,this.isRing=t}static of(e,t){return e===le.NONE?At.EMPTY:t?At.RINGS[e.value]:At.MARKERS[e.value]}equals(e){return this===e}flip(){return qe(!1===this.isRing,"cannot flip a ring (it should never happen)"),qe(this.player.isPlayer(),"cannot flip a non-player piece"),At.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case At.UNREACHABLE:return"NONE";case At.EMPTY:return"EMPTY";case At.MARKER_ZERO:return"MARKER_ZERO";case At.MARKER_ONE:return"MARKER_ONE";case At.RING_ZERO:return"RING_ZERO";default:return pe.expectToBe(this,At.RING_ONE),"RING_ONE"}}}At.encoder=Ye.tuple([le.encoder,Ye.identity()],n=>[n.player,n.isRing],n=>At.of(n[0],n[1])),At.UNREACHABLE=new At(le.NONE,!1),At.EMPTY=new At(le.NONE,!1),At.MARKER_ZERO=new At(B.ZERO,!1),At.MARKER_ONE=new At(B.ONE,!1),At.MARKERS=[At.MARKER_ZERO,At.MARKER_ONE],At.RING_ZERO=new At(B.ZERO,!0),At.RING_ONE=new At(B.ONE,!0),At.RINGS=[At.RING_ZERO,At.RING_ONE];let Xc=(()=>{class n extends yF{constructor(t,r,s){super(s,t,n.SIZE,n.SIZE,[6,4,3,2,1],At.EMPTY),this.sideRings=r}static getInitialState(){const t=At.EMPTY,r=At.UNREACHABLE;return new n([[r,r,r,r,r,r,t,t,t,t,r],[r,r,r,r,t,t,t,t,t,t,t],[r,r,r,t,t,t,t,t,t,t,t],[r,r,t,t,t,t,t,t,t,t,t],[r,t,t,t,t,t,t,t,t,t,t],[r,t,t,t,t,t,t,t,t,t,r],[t,t,t,t,t,t,t,t,t,t,r],[t,t,t,t,t,t,t,t,t,r,r],[t,t,t,t,t,t,t,t,r,r,r],[t,t,t,t,t,t,t,r,r,r,r],[r,t,t,t,t,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(t){return this===t||this.turn===t.turn&&this.sideRings[0]===t.sideRings[0]&&this.sideRings[1]===t.sideRings[1]&&Je.compareTable(this.board,t.board)}getRingCoords(t){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===t&&r.push(s)}),r}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==At.UNREACHABLE}setAtUnsafe(t,r){const s=Je.copyBiArray(this.board);return s[t.y][t.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class Qc extends vi{constructor(e,t=y.empty()){if(super(e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=t}static of(e,t,r){const s=[],i=Re.factory.fromMove(e,t).get();for(let o=e;!1===o.equals(t);o=o.getNext(i))s.push(o);return s.push(t),new Qc(s,r)}setRingTaken(e){return new Qc(this.capturedSpaces,y.of(e))}equals(e){return!(!1===super.equals(e)||!1===this.ringTaken.equals(e.ringTaken))}}Qc.encoder=Ye.tuple([Ye.list(S.encoder),y.getEncoder(S.encoder)],n=>[n.capturedSpaces,n.ringTaken],n=>new Qc(n[0],n[1]));class dl extends eo{constructor(e,t,r,s){super(),this.initialCaptures=e,this.start=t,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===Je.compareArray(this.initialCaptures,e.initialCaptures)||!1===Je.compareArray(this.finalCaptures,e.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(e){let t="";for(const r of e)""!==t&&(t+=","),t+="["+r.toString()+"]";return t}}dl.encoder=Ye.tuple([Ye.list(Qc.encoder),S.encoder,y.getEncoder(S.encoder),Ye.list(Qc.encoder)],n=>[n.initialCaptures,n.start,n.end,n.finalCaptures],n=>new dl(n[0],n[1],n[2],n[3]));class e4 extends N1{constructor(){super(Xc)}static get(){return e4.singleton.isAbsent()&&(e4.singleton=y.of(new e4)),e4.singleton.get()}applyLegalMove(e,t,r){return new Xc(r.board,r.sideRings,r.turn+1)}applyCaptures(e,t){let r=t;return e.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(e,t){const r=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new Xc(r,t.sideRings,t.turn),e.ringTaken.get())}takeRing(e,t){const r=e.getCurrentPlayer().value,s=e.setAt(t,At.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[r]+=1,new Xc(s,i,e.turn)}applyCaptureWithoutTakingRing(e,t){return t.forEach(r=>{e=e.setAt(r,At.EMPTY)}),e.board}ringSelectionValidity(e,t){const r=e.getCurrentPlayer().value;return e.getPieceAt(t)===At.RINGS[r]?R.SUCCESS:R.failure(Ir.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(e,t,r){const s=r.getCurrentPlayer().value;let i=r.setAt(e,At.MARKERS[s]);i=i.setAt(t,At.RINGS[s]);const o=Re.factory.fromMove(e,t).get();for(let c=e.getNext(o);!1===c.equals(t);c=c.getNext(o)){const u=i.getPieceAt(c);u!==At.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return _e.failure(Ir.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toOtherFallible();const s=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(s,e.start,e.end.get());if(i.isFailure())return i.toOtherFallible();const o=this.applyRingMoveAndFlip(e.start,e.end.get(),s),c=this.capturesValidity(o,e.finalCaptures);if(c.isFailure())return c.toOtherFallible();const u=this.applyCaptures(e.finalCaptures,o),h=this.noMoreCapturesValidity(u);return h.isFailure()?h.toOtherFallible():_e.success(u)}initialPlacementValidity(e,t){if(!0!==e.isInitialPlacementPhase())return _e.failure(Ir.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==At.EMPTY)return _e.failure(Xe.MUST_CLICK_ON_EMPTY_SPACE());const r=e.getCurrentPlayer(),s=[e.sideRings[0],e.sideRings[1]];s[r.value]-=1;const i=e.setAt(t,At.of(r,!0)).board,o=new Xc(i,s,e.turn);return _e.success(o)}moveStartValidity(e,t){const r=e.getCurrentPlayer().value;return e.getPieceAt(t)!==At.RINGS[r]?R.failure(Ir.SHOULD_SELECT_PLAYER_RING()):R.SUCCESS}moveValidity(e,t,r){const s=this.moveStartValidity(e,t);if(s.isFailure())return s;if(e.getPieceAt(r)!==At.EMPTY)return R.failure(Ir.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=Re.factory.fromMove(t,r);if(i.isFailure())return R.failure(Ir.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=t.getNext(o);!1===u.equals(r);u=u.getNext(o)){const h=e.getPieceAt(u);if(h===At.EMPTY){if(c)return R.failure(Ir.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(h.isRing)return R.failure(Ir.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return R.SUCCESS}capturesValidity(e,t){let r=e;for(const s of t){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return R.SUCCESS}captureValidity(e,t){const r=e.getCurrentPlayer().value;for(const s of t.capturedSpaces)if(e.getPieceAt(s)!==At.MARKERS[r])return R.failure(Ir.CAN_ONLY_CAPTURE_YOUR_MARKERS());return e.getPieceAt(t.ringTaken.get())!==At.RINGS[r]?R.failure(Ir.CAPTURE_SHOULD_TAKE_RING()):R.SUCCESS}noMoreCapturesValidity(e){const t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?R.SUCCESS:R.failure(Ir.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t){const r=[];return e.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,r){let s=0;const i=e.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;e.isOnBoard(u);u=u.getNext(o)){const h=e.getPieceAt(u);if(h.player===t&&!1===h.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?y.of({start:c,end:u,dir:o}):y.empty()}getPossibleCaptures(e){const t=e.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(Qc.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(e,t){const r=[];for(const s of Re.factory.all){let i=!1;for(let o=t.getNext(s);e.isOnBoard(o);o=o.getNext(s)){const c=e.getPieceAt(o);if(c===At.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(e){return e.gameState.isInitialPlacementPhase()?Ne.ONGOING:e.gameState.sideRings[0]>=3?Ne.ZERO_WON:e.gameState.sideRings[1]>=3?Ne.ONE_WON:Ne.ONGOING}}e4.singleton=y.empty();class Lft extends bs{getMetrics(e){return e.gameState.sideRings}getListMoves(e){const t=[],r=e.gameState;if(r.isInitialPlacementPhase())for(const{coord:s,content:i}of r.getCoordsAndContents())i===At.EMPTY&&t.push(new dl([],s,y.empty(),[]));else{const s=e4.get();this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(h=>{const g=new dl(i,c.start,y.of(c.end),h);t.push(g)})})})}return t}getPossibleCaptureCombinations(e){const r=e4.get().getPossibleCaptures(e),s=this.getRingCoords(e);return L_.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class kft{static getCombinations(e,t){return qe(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(e){const t=e.length,r=[e.slice()],s=new Array(t).fill(0);let i=1;for(;i<t;)if(s[i]<i){const o=i%2&&s[i],c=e[i];e[i]=e[o],e[o]=c,++s[i],i=1,r.push(e.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(e,t){return function r(s,i){if(i>=e.length||s<1)return[[]];{const o=[];for(;i<=e.length-s;){const c=e[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(t,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new Qc(c.capturedSpaces,y.of(o[u]))))).reduce((i,o)=>i.concat(o),[])}getRingMoves(e){const t=e4.get(),r=[];for(const s of this.getRingCoords(e))for(const i of t.getRingTargets(e,s))r.push({start:s,end:i});return r}getRingCoords(e){const t=e.getCurrentPlayer().value,r=[];return e.forEachCoord((s,i)=>{i===At.RINGS[t]&&r.push(s)}),r}}const W=At.EMPTY,Pe=At.UNREACHABLE,Ji=At.MARKER_ZERO,uo=At.RING_ZERO,pl=At.MARKER_ONE,Ti=At.RING_ONE;let W4e=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class j4e extends R1{constructor(){super(...arguments),this.tutorial=[ee.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new Xc([[Pe,Pe,Pe,Pe,Pe,Pe,W,W,W,W,Pe],[Pe,Pe,Pe,Pe,W,W,W,W,W,W,W],[Pe,Pe,Pe,Ji,Ti,W,W,W,W,W,W],[Pe,Pe,W,Ji,W,Ti,W,pl,W,W,W],[Pe,W,uo,pl,W,W,Ti,Ji,W,W,W],[Pe,W,W,Ji,pl,W,W,W,W,W,Pe],[W,W,W,Ji,W,W,W,Ti,W,W,Pe],[W,W,W,pl,Ji,uo,W,W,W,Pe,Pe],[W,W,W,W,W,W,W,W,Pe,Pe,Pe],[W,W,W,W,W,W,W,Pe,Pe,Pe,Pe],[Pe,W,W,W,W,Pe,Pe,Pe,Pe,Pe,Pe]],[3,1],20)),ee.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new Xc(Xc.getInitialState().board,[5,5],0),new dl([],new S(5,5),y.empty(),[]),$localize`Congratulations!`),ee.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new Xc([[Pe,Pe,Pe,Pe,Pe,Pe,W,W,W,W,Pe],[Pe,Pe,Pe,Pe,W,W,W,W,W,W,W],[Pe,Pe,Pe,Ti,W,W,W,W,W,W,W],[Pe,Pe,Ti,W,W,Ti,W,W,W,W,W],[Pe,W,uo,pl,W,W,Ti,W,W,W,W],[Pe,W,W,pl,W,W,W,W,W,W,Pe],[W,W,W,W,uo,W,W,Ti,W,W,Pe],[W,W,W,W,W,uo,W,W,W,Pe,Pe],[W,W,W,uo,W,W,W,Pe,Pe,Pe,Pe],[W,W,W,W,W,W,W,Pe,Pe,Pe,Pe],[Pe,W,W,W,W,Pe,Pe,Pe,Pe,Pe,Pe]],[0,0],20),new dl([],new S(2,4),y.of(new S(4,4)),[]),$localize`Congratulations!`),ee.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new Xc([[Pe,Pe,Pe,Pe,Pe,Pe,W,W,W,W,Pe],[Pe,Pe,Pe,Pe,W,W,W,W,W,W,W],[Pe,Pe,Pe,Ti,W,W,W,W,W,W,W],[Pe,Pe,Ti,W,W,Ti,W,W,W,W,W],[Pe,W,Ji,Ji,uo,pl,pl,W,W,W,W],[Pe,W,W,Ti,W,W,W,W,W,W,Pe],[W,W,W,W,uo,W,W,Ti,W,W,Pe],[W,W,W,W,W,uo,W,W,W,Pe,Pe],[W,W,W,uo,W,W,W,uo,Pe,Pe,Pe],[W,W,W,W,W,W,W,Pe,Pe,Pe,Pe],[Pe,W,W,W,W,Pe,Pe,Pe,Pe,Pe,Pe]],[0,0],20),new dl([],new S(4,4),y.of(new S(7,4)),[Qc.of(new S(2,4),new S(6,4),y.of(new S(7,4)))]),(e,t,r)=>1===r.sideRings[B.ZERO.value]?R.SUCCESS:R.failure(W4e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),ee.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new Xc([[Pe,Pe,Pe,Pe,Pe,Pe,W,W,W,W,Pe],[Pe,Pe,Pe,Pe,uo,W,W,Ti,Ti,uo,W],[Pe,Pe,Pe,uo,W,W,pl,Ti,W,uo,W],[Pe,Pe,W,uo,W,W,W,W,W,Ti,W],[Pe,W,W,W,W,Ji,W,W,Ti,W,W],[Pe,W,W,W,Ji,Ji,W,pl,W,W,Pe],[W,W,W,Ji,W,Ji,W,W,W,W,Pe],[W,W,Ji,W,W,Ji,W,W,W,Pe,Pe],[W,Ji,W,W,W,Ji,W,W,Pe,Pe,Pe],[W,W,W,W,W,Ji,W,Pe,Pe,Pe,Pe],[Pe,W,W,W,W,Pe,Pe,Pe,Pe,Pe,Pe]],[0,0],10),new dl([Qc.of(new S(5,4),new S(1,8),y.of(new S(3,2))),Qc.of(new S(5,9),new S(5,5),y.of(new S(3,3)))],new S(4,1),y.of(new S(4,2)),[]),(e,t,r)=>2===r.sideRings[B.ZERO.value]?R.SUCCESS:R.failure(W4e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function Rft(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=C(2).$implicit,r=C(2);z("cx",t.center.x)("cy",t.center.y)("r",r.viewInfo.ringOuterSize)}}function Dft(n,e){if(1&n&&(V(),X(0,"circle",13)),2&n){const t=C(2),r=t.index,s=t.$implicit,i=C().index,o=C();ke("id","ring_",r,"_",i,""),w("ngClass",s.ringClasses),z("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function zft(n,e){if(1&n&&(V(),X(0,"circle",12)),2&n){const t=C(2).$implicit,r=C(2);z("cx",t.center.x)("cy",t.center.y)("r",r.viewInfo.ringInnerSize)}}function Hft(n,e){if(1&n&&(V(),X(0,"circle",14)),2&n){const t=C(2),r=t.index,s=t.$implicit,i=C().index,o=C();ke("id","marker_",r,"_",i,""),w("ngClass",s.markerClasses),z("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function Vft(n,e){if(1&n){const t=Oe();V(),O(0,"g",6),J("click",function(){he(t);const s=C().$implicit;return ce(C(2).onClick(s.coord))}),X(1,"polygon",7),O(2,"g",8),x(3,Rft,1,3,"circle",9),x(4,Dft,1,6,"circle",10),x(5,zft,1,3,"circle",9),x(6,Hft,1,6,"circle",11),A()()}if(2&n){const t=C(),r=t.index,s=t.$implicit,i=C().index;ke("id","click_",r,"_",i,""),T(1),ke("id","space_",r,"_",i,""),w("ngClass",s.spaceClasses),z("points",s.coordinates),T(1),ke("id","pieceGroup_",r,"_",i,""),w("ngClass",s.removedClass),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isRing),T(1),w("ngIf",s.isMarker)}}function Fft(n,e){if(1&n&&(V(),O(0,"g"),x(1,Vft,7,13,"g",5),A()),2&n){const t=e.$implicit;T(1),w("ngIf",null!=t)}}function Bft(n,e){if(1&n&&(V(),O(0,"g"),x(1,Fft,2,1,"g",1),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}function $ft(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",15),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i))}),A()}if(2&n){const t=e.$implicit,r=C();ke("id","selected_",t.x,"_",t.y,""),z("points",r.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function Gft(n,e){if(1&n){const t=Oe();V(),O(0,"polygon",17),J("click",function(){const i=he(t).$implicit;return ce(C(2).onClick(i))}),A()}if(2&n){const t=e.$implicit,r=C(2);ke("id","selectable_",t.x,"_",t.y,""),z("points",r.viewInfo.spaceInfo[t.y][t.x].coordinates)}}function Uft(n,e){if(1&n&&(V(),O(0,"g"),x(1,Gft,1,3,"polygon",16),A()),2&n){const t=C();T(1),w("ngForOf",t.viewInfo.selectableCoords)}}function qft(n,e){if(1&n){const t=Oe();V(),O(0,"rect",18),J("click",function(){const i=he(t).$implicit;return ce(C().onClick(i))}),A()}if(2&n){const t=e.$implicit,r=C();ke("id","indicator_",t.x,"_",t.y,""),z("x",r.viewInfo.spaceInfo[t.y][t.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[t.y][t.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function Wft(n,e){if(1&n&&(V(),O(0,"g"),X(1,"circle",19)(2,"circle",12)(3,"circle",20),A()),2&n){const t=e.index,r=C().$implicit,s=C();T(1),ke("id","player_",r.value,"_sideRing_",t+1,""),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(t+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),T(1),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(t+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),T(1),w("ngClass",s.viewInfo.sideRingClass[r.value]),z("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(t+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const jft=function(){return[]};function Zft(n,e){if(1&n&&(V(),O(0,"g"),x(1,Wft,4,12,"g",1),A()),2&n){const t=e.$implicit,r=C();z("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),T(1),w("ngForOf",K1(2,jft).constructor(r.viewInfo.sideRings[t.value]))}}class wi extends d9{constructor(e){super(e),this.movePhase="MOVE_START",this.moveStart=y.empty(),this.moveEnd=y.empty(),this.currentlyMoved=[],this.currentCapture=y.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:wi.MARKER_SIZE,ringOuterSize:wi.RING_OUTER_SIZE,ringMidSize:wi.RING_MID_SIZE,ringInnerSize:wi.RING_INNER_SIZE,indicatorSize:wi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=y.of([0,0]),this.rules=e4.get(),this.node=this.rules.getInitialNode(),this.availableMinimaxes=[new Lft(this.rules,"YinshMinimax")],this.encoder=dl.encoder,this.tutorial=(new j4e).tutorial,this.hexaLayout=new p9(1.5*wi.RING_OUTER_SIZE,new S(2*wi.RING_OUTER_SIZE,0),ws.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(t=>{null==this.viewInfo.spaceInfo[t.y]&&(this.viewInfo.spaceInfo[t.y]=[]),this.viewInfo.spaceInfo[t.y][t.x]={coord:t,coordinates:this.getHexaPointsAt(t),center:this.getCenterAt(t),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const e=this.getState();this.scores=y.of(e.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(e=>{this.viewInfo.spaceInfo[e.y][e.x].spaceClasses=this.getSpaceClasses(e);const t=this.constructedState.getPieceAt(e);this.viewInfo.spaceInfo[e.y][e.x].removedClass="",this.setRingInfo(e,t),this.setMarkerInfo(e,t)});for(const e of B.PLAYERS)this.viewInfo.sideRings[e.value]=this.constructedState.sideRings[e.value];switch(this.showCurrentMoveCaptures(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const e of this.possibleCaptures)for(const t of e.capturedSpaces)this.viewInfo.selectableCoords.push(t);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const e of this.initialCaptures)this.markCurrentCapture(e);for(const e of this.finalCaptures)this.markCurrentCapture(e)}getSpaceClasses(e){return this.currentlyMoved.some(t=>t.equals(e))?["moved-fill"]:[]}setRingInfo(e,t){t.isRing?(this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=["player"+t.player.value+"-stroke"]):(this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[])}setMarkerInfo(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==At.EMPTY&&(!t.isRing||this.moveStart.equalsValue(e))){const s=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=y.empty(),this.moveStart=y.empty(),this.moveEnd=y.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(e){if(e.isInitialPlacement())this.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const r of this.coordsBetween(e.start,e.end.get()))this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["moved-fill"];const t=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();e.initialCaptures.forEach(r=>this.showLastMoveCapture(r,t)),e.finalCaptures.forEach(r=>this.showLastMoveCapture(r,t))}}coordsBetween(e,t){const r=[],s=Re.factory.fromMove(e,t).get();for(let i=e;!i.equals(t);i=i.getNext(s))this.constructedState.getPieceAt(i)!==At.EMPTY&&r.push(i),r.push(t);return r}showLastMoveCapture(e,t){for(const r of e.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],t&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured-fill"],t&&this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),R.SUCCESS}onClick(e){var t=this;return I(function*(){const r=t.canUserPlay("#click_"+e.x+"_"+e.y);if(r.isFailure())return t.cancelMove(r.getReason());switch(t.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return t.selectCaptureFirstCoord(e);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return t.selectCaptureLastCoord(e);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return t.selectRing(e);case"MOVE_START":return t.selectMoveStart(e);case"MOVE_END":return t.selectMoveEnd(e)}})()}selectCaptureFirstCoord(e){var t=this;return I(function*(){const r=[];if(t.possibleCaptures.forEach(s=>{s.contains(e)&&r.push(s)}),r.length>1)t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r);else{if(0===r.length)return t.cancelMove(Ir.MISSING_CAPTURES());t.selectCapture(r[0])}return R.SUCCESS})()}moveToCaptureSelectLast(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;for(const t of e)for(const r of t.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(pe.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(e){var t=this;return I(function*(){const r=[];return t.possibleCaptures.forEach(s=>{s.contains(e)&&r.push(s)}),r.length>1?t.cancelMove(Ir.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(Ir.MISSING_CAPTURES()):t.selectCapture(r[0])})()}selectCapture(e){return this.currentCapture=y.of(e),this.constructedState=new Xc(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(qe("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),R.SUCCESS}markCurrentCapture(e){for(const t of e.capturedSpaces)this.viewInfo.selectedCoords.push(t),this.markRemovedMarker(t,this.getState().getCurrentPlayer());e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,At.MARKERS[t.value])}markRemovedRing(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,At.RINGS[t.value])}selectRing(e){var t=this;return I(function*(){const r=t.rules.ringSelectionValidity(t.constructedState,e);if(r.isFailure())return t.cancelMove(r.getReason());t.constructedState=t.rules.takeRing(t.constructedState,e);const s=t.currentCapture.get().setRingTaken(e);return"INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=y.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(s),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),R.SUCCESS)):(pe.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(s),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),R.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),R.SUCCESS}tryMove(){var e=this;return I(function*(){const t=new dl(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures);return yield e.chooseMove(t)})()}selectMoveStart(e){var t=this;return I(function*(){if(t.constructedState.isInitialPlacementPhase()){const r=t.rules.initialPlacementValidity(t.constructedState,e);return r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=y.of(e),t.tryMove())}{const r=t.rules.moveStartValidity(t.constructedState,e);if(r.isFailure())return t.cancelMove(r.getReason());t.moveStart=y.of(e),t.movePhase="MOVE_END",t.updateViewInfo()}return R.SUCCESS})()}selectMoveEnd(e){var t=this;return I(function*(){if(t.moveStart.equalsValue(e))return t.cancelMoveAttempt(),R.SUCCESS;const r=At.RINGS[t.getState().getCurrentPlayer().value];if(t.constructedState.getPieceAt(e)===r)return t.cancelMoveAttempt(),t.selectMoveStart(e);const s=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e);return s.isFailure()?t.cancelMove(s.getReason()):(t.moveEnd=y.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var e=this;return I(function*(){return e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),R.SUCCESS)})()}}function Yft(n,e){if(1&n&&(O(0,"option",5),wt(1),A()),2&n){const t=e.$implicit;w("value",t.urlName),T(1),c1(t.name)}}wi.RING_OUTER_SIZE=40,wi.RING_MID_SIZE=34,wi.RING_INNER_SIZE=28,wi.MARKER_SIZE=wi.RING_INNER_SIZE,wi.INDICATOR_SIZE=10,wi.\u0275fac=function(e){return new(e||wi)(Q(_n))},wi.\u0275cmp=ct({type:wi,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(V(),O(0,"svg",0),x(1,Bft,2,1,"g",1),x(2,$ft,1,3,"polygon",2),x(3,Uft,2,1,"g",3),x(4,qft,1,6,"rect",4),x(5,Zft,2,3,"g",1),A()),2&e&&(T(1),w("ngForOf",t.viewInfo.spaceInfo),T(1),w("ngForOf",t.viewInfo.selectedCoords),T(1),w("ngIf",t.isPlayerTurn()),T(1),w("ngForOf",t.viewInfo.targets),T(1),w("ngForOf",t.Player.PLAYERS))},dependencies:[hn,En,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let y1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONNECT_SIX=()=>$localize`Put two pieces on the board at each turn, and be the first to align six pieces!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PENTE=()=>$localize`You can align 5 pieces to win, or you can capture 10 pieces of your opponent to win!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.TEEKO=()=>$localize`Align your 4 pieces or form a square with them to win!`,n.TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),k9=(()=>{class n{constructor(t,r,s,i,o,c,u,h=!0){this.name=t,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=h}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",Nut,new v4e,il.get(),new Date("2018-08-28"),y1.P4()),new n($localize`Awalé`,"Awale",hlt,new R3e,xc.get(),new Date("2018-11-29"),y1.AWALE()),new n($localize`Quarto`,"Quarto",V5t,new N4e,gs.get(),new Date("2018-12-09"),y1.QUARTO()),new n($localize`Tablut`,"Tablut",sft,new F4e,B8.get(),new Date("2018-12-27"),y1.TABLUT()),new n($localize`Reversi`,"Reversi",Q5t,new k4e,h7.get(),new Date("2019-01-16"),y1.REVERSI()),new n($localize`Go`,"Go",s7,new t4e,Q4.get(),new Date("2019-12-21"),y1.GO()),new n($localize`Encapsule`,"Encapsule",W6t,new X3e,L8.get(),new Date("2019-12-30"),y1.ENCAPSULE()),new n($localize`Siam`,"Siam",d7,new H4e,Yc.get(),new Date("2020-01-11"),y1.SIAM()),new n($localize`Sahara`,"Sahara",h7t,new L4e,V8.get(),new Date("2020-02-29"),y1.SAHARA()),new n($localize`Pylos`,"Pylos",c5t,new w4e,Pi.get(),new Date("2020-10-02"),y1.PYLOS()),new n($localize`Kamisado`,"Kamisado",P8t,new c4e,Mi.get(),new Date("2020-10-03"),y1.KAMISADO()),new n($localize`Quixo`,"Quixo",W5t,new I4e,Xi.get(),new Date("2020-10-15"),y1.QUIXO()),new n($localize`Dvonn`,"Dvonn",k6t,new j3e,fs.get(),new Date("2020-10-21"),y1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",J6t,new Q3e,no.get(),new Date("2021-01-16"),y1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",c0t,new e4e,On.get(),new Date("2021-02-22"),y1.GIPF()),new n($localize`Coerceo`,"Coerceo",t6t,new q3e,I_.get(),new Date("2021-03-21"),y1.COERCEO()),new n($localize`Six`,"Six",q7t,new V4e,Kc.get(),new Date("2021-04-08"),y1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",V8t,new h4e,Is.get(),new Date("2021-04-28"),y1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",Fut,new y4e,ol.get(),new Date("2021-05-23"),y1.PENTAGO()),new n($localize`Abalone`,"Abalone",Q4t,new L3e,Do.get(),new Date("2021-07-13"),y1.ABALONE()),new n($localize`Yinsh`,"Yinsh",wi,new j4e,e4.get(),new Date("2021-07-31"),y1.YINSH()),new n($localize`Apagos`,"Apagos",olt,new I3e,b6.get(),new Date("2021-11-04"),y1.APAGOS()),new n($localize`Diam`,"Diam",B3,new $3e,Z4.get(),new Date("2021-11-30"),y1.DIAM()),new n($localize`Brandhub`,"Brandhub",blt,new z3e,N8.get(),new Date("2021-12-07"),y1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",f6t,new V3e,ec.get(),new Date("2021-12-30"),y1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",D2,new d4e,R2.get(),new Date("2022-06-24"),y1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",Uo,new _4e,q3.get(),new Date("2022-07-01"),y1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",g8t,new a4e,R8.get(),new Date("2022-09-21"),y1.HNEFATAFL()),new n($localize`Hive`,"Hive",n8t,new i4e,Yi.get(),new Date("2023-04-02"),y1.HIVE()),new n($localize`Trexo`,"Trexo",C1,new U4e,Qi.get(),new Date("2023-04-23"),y1.TREXO()),new n($localize`Lasca`,"Lasca",k8t,new f4e,$o.get(),new Date("2023-05-11"),y1.LASCA()),new n($localize`Connect Six`,"ConnectSix",Rlt,new H3e,Ja.get(),new Date("2023-05-13"),y1.CONNECT_SIX()),new n($localize`Pente`,"Pente",Zut,new S4e,Ca.get(),new Date("2023-05-20"),y1.PENTE()),new n($localize`Teeko`,"Teeko",lft,new B4e,ac.get(),new Date("2023-07-30"),y1.TEEKO())].sort((e,t)=>e.name.localeCompare(t.name)),n})(),FF=(()=>{class n{constructor(){this.games=k9.ALL_GAMES(),this.pickGame=new ur}onChange(t){this.pickGame.emit(t.target.value)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ct({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let e;return e=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],e,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(t,r){1&t&&(O(0,"div",0)(1,"select",1),J("change",function(i){return r.onChange(i)}),O(2,"option",2),ve(3,3),A(),x(4,Yft,2,2,"option",4),A()()),2&t&&(T(4),w("ngForOf",r.games))},dependencies:[En,_g,vg],encapsulation:2}),n})();function Kft(n,e){if(1&n){const t=Oe();O(0,"div",26)(1,"div",27),J("click",function(){return he(t),ce(C().closeInfo())}),A(),O(2,"div",28)(3,"header",29)(4,"p",30),wt(5),A(),O(6,"button",31),J("click",function(){return he(t),ce(C().closeInfo())}),A()(),O(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),X(11,"img",35),A()(),O(12,"div",7)(13,"div",13),wt(14),A()()(),O(15,"div",6)(16,"div",33)(17,"a",36),J("click",function(){he(t);const s=C();return ce(s.createGame(s.gameInfoDetails.get().urlName))}),X(18,"fa-icon",37),wt(19,"\xa0"),O(20,"span"),ve(21,38),A()()(),O(22,"div",33)(23,"a",36),J("click",function(){he(t);const s=C();return ce(s.createLocalGame(s.gameInfoDetails.get().urlName))}),X(24,"fa-icon",37),wt(25,"\xa0"),O(26,"span"),ve(27,39),A()()(),O(28,"div",33)(29,"a",36),J("click",function(){he(t);const s=C();return ce(s.createTutorial(s.gameInfoDetails.get().urlName))}),X(30,"fa-icon",37),wt(31,"\xa0"),O(32,"span"),ve(33,40),A()()()()()()()}if(2&n){const t=C();T(5),c1(t.gameInfoDetails.get().name),T(6),ke("src","assets/images/",t.theme,"/",t.gameInfoDetails.get().urlName,".png",_3),T(3),Ri(" ",t.gameInfoDetails.get().description," "),T(4),w("icon",t.iconOnlineGame),T(6),w("icon",t.iconLocalGame),T(6),w("icon",t.iconTutorial)}}function Xft(n,e){if(1&n){const t=Oe();O(0,"div",8)(1,"div",9)(2,"p",10),wt(3),A()(),O(4,"div",42)(5,"figure",34)(6,"img",43),J("click",function(){const i=he(t).$implicit;return ce(C(2).openInfo(i))}),A(),O(7,"figcaption",44),J("click",function(){const i=he(t).$implicit;return ce(C(2).openInfo(i))}),O(8,"div",45),wt(9,"?"),A()(),O(10,"figcaption",46)(11,"a",47),J("click",function(){const i=he(t).$implicit;return ce(C(2).createGame(i.urlName))}),X(12,"fa-icon",37),A(),O(13,"a",48),J("click",function(){const i=he(t).$implicit;return ce(C(2).createLocalGame(i.urlName))}),X(14,"fa-icon",37),A(),O(15,"a",49),J("click",function(){const i=he(t).$implicit;return ce(C(2).createTutorial(i.urlName))}),X(16,"fa-icon",37),A()()()(),O(17,"div",50),wt(18),A()()}if(2&n){const t=e.$implicit,r=C(2);T(3),c1(t.name),T(3),h1("id","image_",t.urlName,""),ke("src","assets/images/",r.theme,"/",t.urlName,".png",_3),T(5),h1("id","playOnline_",t.urlName,""),T(1),w("icon",r.iconOnlineGame),T(1),h1("id","playLocally_",t.urlName,""),T(1),w("icon",r.iconLocalGame),T(1),h1("id","startTutorial_",t.urlName,""),T(1),w("icon",r.iconTutorial),T(2),Ri(" ",t.description," ")}}function Qft(n,e){if(1&n&&(O(0,"div",7),x(1,Xft,19,11,"div",41),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}let Jft=(()=>{class n{constructor(t,r,s,i){this.router=t,this.messageDisplayer=r,this.currentGameService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=Qoe,this.iconLocalGame=JV,this.iconTutorial=e3e,this.gameInfoDetails=y.empty(),this.theme=i.getTheme();const o=k9.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(t){var r=this;return I(function*(){const s=r.currentGameService.canUserCreate();return s.isSuccess()?r.router.navigate(null==t?["/play"]:["/play",t]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(t){var r=this;return I(function*(){return r.router.navigate(["/local",t])})()}createTutorial(t){return this.router.navigate(["/tutorial",t])}openInfo(t){this.gameInfoDetails=y.of(t)}closeInfo(){this.gameInfoDetails=y.empty()}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn),Q(_n),Q(I2),Q(_P))},n.\u0275cmp=ct({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let e,t,r,s,i,o,c,u,h,g,m,M,b,L;return e=$localize`EveryBoard`,t=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,h=$localize`Play online`,g=$localize`Play offline`,m=$localize`Learn the rules`,M=$localize`Play online`,b=$localize`Play offline`,L=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],e,[1,"subtitle"],t,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],h,g,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",M,1,"button",3,"id","click"],["data-tooltip",b,1,"button",3,"id","click"],["data-tooltip",L,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(t,r){1&t&&(O(0,"section",0)(1,"div",1)(2,"p",2),ve(3,3),A(),O(4,"p",4),ca(5,5),X(6,"br"),la(),A()(),O(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),ve(12,11),A()(),O(13,"div",12)(14,"div",13)(15,"button",14),J("click",function(){return r.createGame()}),ve(16,15),A(),O(17,"button",16),ve(18,17),A()()()()(),O(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),ve(23,18),A()(),O(24,"div",12)(25,"div",19)(26,"button",20),ve(27,21),A(),O(28,"button",22),ve(29,23),A()()()()()(),x(30,Kft,34,7,"div",24),O(31,"div",6),x(32,Qft,2,1,"div",25),A()()),2&t&&(T(30),w("ngIf",r.gameInfoDetails.isPresent()),T(2),w("ngForOf",r.games))},dependencies:[En,Kt,uh,e7],encapsulation:2}),n})();const eht=["board"];let g7=(()=>{class n{static NO_MATCHING_GAME(t){return $localize`This game (${t}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.GAME_HAS_ENDED=()=>$localize`This game has ended.`,n.CANNOT_PLAY_AS_OBSERVER=()=>$localize`You are an observer in this game, you cannot play.`,n.MUST_ANSWER_REQUEST=()=>$localize`You must answer your opponent's request.`,n})(),VT=(()=>{class n{constructor(t,r,s,i){this.actRoute=t,this.connectedUserService=r,this.router=s,this.messageDisplayer=i,this.boardRef=null,this.players=[y.empty(),y.empty()],this.role=le.NONE,this.endGame=!1,this.Player=B}getMatchingComponent(t){return y.ofNullable(k9.ALL_GAMES().find(s=>s.urlName===t)).map(s=>s.component)}afterViewInit(){var t=this;return I(function*(){const r=yield t.createGameComponent();return r&&(t.gameComponent.node=t.gameComponent.rules.getInitialNode(),t.gameComponent.updateBoard()),r})()}getGameName(){return pe.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var t=this;return I(function*(){const r=t.getGameName(),s=t.getMatchingComponent(r);if(s.isAbsent())return yield t.router.navigate(["/notFound",g7.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;qe(null!=t.boardRef,"Board element should be present");const i=pe.getNonNullable(t.boardRef).createComponent(s.get());return t.gameComponent=i.instance,t.gameComponent.chooseMove=o=>t.receiveValidMove(o),t.gameComponent.canUserPlay=o=>t.canUserPlay(o),t.gameComponent.isPlayerTurn=()=>t.isPlayerTurn(),t.gameComponent.cancelMoveOnWrapper=o=>{t.onCancelMove(o)},t.setRole(t.role),!0})()}setRole(t){this.role=t,this.gameComponent.role=this.role,this.gameComponent.hasAsymmetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")"),this.updateBoardAndShowLastMove()}receiveValidMove(t){var r=this;return I(function*(){const s=r.gameComponent.rules.isLegal(t,r.gameComponent.getState());return s.isFailure()?(r.gameComponent.cancelMove(s.getReason()),R.ofFallible(s)):(r.gameComponent.cancelMoveAttempt(),yield r.onLegalUserMove(t),R.SUCCESS)})()}canUserPlay(t){if(this.role===le.NONE){const r=g7.CANNOT_PLAY_AS_OBSERVER();return R.failure(r)}return!1===this.isPlayerTurn()?R.failure(g7.NOT_YOUR_TURN()):this.endGame?R.failure(g7.GAME_HAS_ENDED()):R.SUCCESS}isPlayerTurn(){if(this.role===le.NONE||null==this.gameComponent)return!1;const r=this.gameComponent.getTurn()%2,s=this.getPlayer();return!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}updateBoardAndShowLastMove(){if(this.gameComponent.cancelMoveAttempt(),this.gameComponent.updateBoard(),this.gameComponent.node.move.isPresent()){const t=this.gameComponent.node.move.get();this.gameComponent.showLastMove(t)}}}return n.\u0275fac=function(t){return new(t||n)(Q(No),Q(Q1),Q(Kn),Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["ng-component"]],viewQuery:function(t,r){if(1&t&&F0(eht,5,Ba),2&t){let s;O4(s=A4())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(t,r){},encapsulation:2}),n})();const tht=["board"];let nht=(()=>{class n extends VT{constructor(t,r,s,i,o){super(t,r,s,i),this.cdr=o,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var t=this;return I(function*(){setTimeout(I(function*(){yield t.afterViewInit(),t.gameComponent.node=t.demoNodeInfo.node,t.setRole(t.gameComponent.getCurrentPlayer()),t.cdr.detectChanges(),t.demoNodeInfo.click.isPresent()&&(pe.getNonNullable(document.querySelector(t.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),t.cdr.detectChanges())}),1)})()}onLegalUserMove(t,r){return I(function*(){})()}getPlayer(){return"no-player"}onCancelMove(t){}}return n.\u0275fac=function(t){return new(t||n)(Q(No),Q(Q1),Q(Kn),Q(_n),Q(Zu))},n.\u0275cmp=ct({type:n,selectors:[["app-demo-card"]],viewQuery:function(t,r){if(1&t&&F0(tht,5,Ba),2&t){let s;O4(s=A4())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(t,r){1&t&&X(0,"div",null,0)},encapsulation:2}),n})();function rht(n,e){if(1&n&&(O(0,"div",17)(1,"figure",18),X(2,"app-demo-card",19),A()()),2&n){const t=C().$implicit;T(2),w("demoNodeInfo",t)}}function sht(n,e){if(1&n&&(O(0,"div",20)(1,"figure",21),X(2,"app-demo-card",19),A()()),2&n){const t=C().$implicit;T(2),w("demoNodeInfo",t)}}function iht(n,e){if(1&n&&(O(0,"div",12)(1,"div",13)(2,"p",14),wt(3),A()(),x(4,rht,3,1,"div",15),x(5,sht,3,1,"ng-template",null,16,Un),A()),2&n){const t=e.$implicit,r=Hn(6),s=C(2);T(3),c1(t.name),T(1),w("ngIf",s.squared.value)("ngIfElse",r)}}function oht(n,e){if(1&n&&(O(0,"div",10),x(1,iht,7,3,"div",11),A()),2&n){const t=e.$implicit;T(1),w("ngForOf",t)}}let aht=(()=>{class n{constructor(){this.numberOfColumns=new $a(5),this.squared=new $a(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(t=>{this.fillColumns(t)})}fillColumns(t){const r=k9.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,h=o.tutorial.tutorial;for(const g of h){const m=this.getNodeFromStep(g,u);c.push(m)}for(const g of c)i<t&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:g.node,click:g.click}),i++,s=(s+1)%t}}getNodeFromStep(t,r){if(t.hasSolution()){const s=t.getSolution();if("string"==typeof s)return{node:new x2(t.state),click:y.of(s)};{const i=s;return{node:new x2(r.applyLegalMove(i,t.state,r.isLegal(i,t.state).get()),y.of(new x2(t.state)),y.of(i)),click:y.empty()}}}return{node:new x2(t.state),click:y.empty()}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ct({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let e,t;return e=$localize`Number of columns: `,t=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],e,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],t,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(t,r){1&t&&(O(0,"form")(1,"div",0)(2,"label",1),dn(3),ve(4,2),pn(),O(5,"output"),wt(6),A()(),O(7,"div",3),X(8,"input",4),A()(),O(9,"div",0)(10,"label",5),X(11,"input",6),wt(12," \xa0"),dn(13),ve(14,7),pn(),A()()(),O(15,"div",8),x(16,oht,2,1,"div",9),A()),2&t&&(T(6),c1(r.numberOfColumns.value),T(2),w("formControl",r.numberOfColumns),T(3),w("formControl",r.squared),T(5),w("ngForOf",r.columns))},dependencies:[En,Kt,Ju,k4,AE,WA,Ql,Qu,iN,gg,nht],encapsulation:2}),n})(),BF=(()=>{class n{constructor(t){this.element=t}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(t){return new(t||n)(Q(g2))},n.\u0275dir=Ut({type:n,selectors:[["","autofocus",""]]}),n})(),Z4e=(()=>{class n{constructor(t){this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(t){return new(t||n)(Q(g2))},n.\u0275dir=Ut({type:n,selectors:[["","toggleVisibility",""]]}),n})();function cht(n,e){if(1&n&&(O(0,"div",29)(1,"div",30),ve(2,31),A(),O(3,"div",32),wt(4),A()()),2&n){const t=C();T(4),c1(t.errorMessage)}}const lht=function(){return["/register"]},uht=function(){return["/reset-password"]};let fht=(()=>{class n{constructor(t,r){this.router=t,this.connectedUserService=r,this.faEye=AV,this.loginForm=new W0({email:new $a,password:new $a})}ngOnInit(){var t=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=I(function*(s){s!==Y5.NOT_CONNECTED&&(yield t.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(t){var r=this;return I(function*(){const s=yield r.connectedUserService.doEmailLogin(t.email,t.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var t=this;return I(function*(){const r=yield t.connectedUserService.doGoogleLogin();r.isFailure()&&(t.errorMessage=r.getReason())})()}redirect(){var t=this;return I(function*(){return t.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn),Q(Q1))},n.\u0275cmp=ct({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let e,t,r,s,i,o,c,u,h,g,m,M;return e=$localize`Log in`,t=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,h=$localize`Register`,g=$localize`Forgot your password?`,m=$localize`Reset your password`,M=$localize`Connection error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],h,g,m,["role","alert",1,"message","is-danger"],[1,"message-header"],M,["id","errorMessage",1,"message-body"]]},template:function(t,r){1&t&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ve(7,7),A()(),O(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),A()()()(),O(12,"div",4)(13,"div",5)(14,"label",12),ve(15,13),A()(),O(16,"div",8)(17,"div",9)(18,"div",14),X(19,"input",15),O(20,"span",16),X(21,"fa-icon",17),A()()()()(),O(22,"div",4),X(23,"div",5),O(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),J("click",function(){return r.loginWithEmail(r.loginForm.value)}),ve(28,19),A()()()()(),O(29,"div",4),X(30,"div",5),O(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),J("click",function(){return r.loginWithGoogle()}),ve(35,21),A()()()()(),x(36,cht,5,1,"div",22),O(37,"p",23),dn(38),ve(39,24),pn(),wt(40,"\xa0 "),O(41,"a",25),ve(42,26),A()(),O(43,"p",23),dn(44),ve(45,27),pn(),wt(46,"\xa0 "),O(47,"a",25),ve(48,28),A()()()()),2&t&&(T(3),w("formGroup",r.loginForm),T(18),w("icon",r.faEye),T(6),w("disabled",!r.canLogin()),T(9),w("ngIf",r.errorMessage),T(5),w("routerLink",K1(6,lht)),T(6),w("routerLink",K1(7,uht)))},dependencies:[Kt,o5,Ju,k4,Ql,Qu,n5,e5,rh,e7,BF,Z4e],encapsulation:2}),n})(),hht=(()=>{class n{constructor(t){this.partDAO=t}subscribeToActiveParts(t){let r=[];const c=new mP(u=>{r=r.concat(...u),t(r)},u=>{const h=r;for(const g of u)h.forEach(m=>{m.id===g.id&&(m.data=g.data)});r=h,t(r)},u=>{const h=[];for(const g of r)u.some(m=>m.id===g.id)||h.push(g);r=h,t(r)});return this.partDAO.observingWhere([["result","==",S1.UNACHIEVED.value]],c)}}return n.\u0275fac=function(t){return new(t||n)(De(W4))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),dht=(()=>{class n{transform(t){return nq(1e3*t.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=ti({name:"firestoreTime",type:n,pure:!0}),n})();const ght=["chatDiv"];function mht(n,e){1&n&&(dn(0),ve(1,5),pn())}function _ht(n,e){1&n&&ve(0,6),2&n&&(M1(C().unreadMessagesText),A1(0))}function vht(n,e){if(1&n){const t=Oe();O(0,"button",11),J("click",function(){return he(t),ce(C(2).scrollToBottom())}),wt(1),A()}if(2&n){const t=C(2);T(1),Ri("",t.unreadMessagesText," \u2193")}}function Cht(n,e){if(1&n&&(O(0,"p"),wt(1),O3(2,"firestoreTime"),O(3,"b",12),wt(4),A(),O(5,"span",13),wt(6),A()()),2&n){const t=e.$implicit;T(1),Ri(" [",b4(2,3,t.postedTime),"] "),T(3),Ri("",t.sender.name," : "),T(2),c1(t.content)}}function yht(n,e){if(1&n){const t=Oe();O(0,"div"),x(1,vht,2,1,"button",7),O(2,"div",8,9),J("scroll",function(){return he(t),ce(C().updateCurrentScrollPosition())}),x(4,Cht,7,5,"p",10),A()()}if(2&n){const t=C();T(1),w("ngIf",t.showUnreadMessagesButton),T(3),w("ngForOf",t.chat)}}const Eht=function(){return{standalone:!0}};function Mht(n,e){if(1&n){const t=Oe();O(0,"form",14),J("onSubmit",function(){return he(t),ce(C().sendMessage())}),O(1,"div",15)(2,"div",16)(3,"input",17,18),J("ngModelChange",function(s){return he(t),ce(C().userMessage=s)}),A(),O(5,"p",19),wt(6),A()(),O(7,"div",20)(8,"button",21),J("click",function(){return he(t),ce(C().sendMessage())}),X(9,"fa-icon",22),A()()(),O(10,"div",23)(11,"p")(12,"strong"),ve(13,24),A()()()()}if(2&n){const t=Hn(4),r=C();T(3),w("ngModel",r.userMessage)("ngModelOptions",K1(4,Eht)),T(3),Ri("",t.value.length,"/128"),T(3),w("icon",r.faReply)}}let U8=class{constructor(e,t){this.chatService=e,this.connectedUserService=t,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=pV,this.isNearBottom=!0,this.notYetScrolled=!0}ngOnInit(){qe(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=r=>{this.updateMessages(r.flatMap(s=>null==s.data.postedTime?[]:[s.data]))},t=new mP(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,t)}updateMessages(e){this.chat=this.chat.concat(e);const t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return I(function*(){const t=e.userMessage;e.userMessage="";const r=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,r,t,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}};U8.\u0275fac=function(e){return new(e||U8)(Q(L3),Q(Q1))},U8.\u0275cmp=ct({type:U8,selectors:[["app-chat"]],viewQuery:function(e,t){if(1&e&&F0(ght,5),2&e){let r;O4(r=A4())&&(t.chatDiv=r.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let n,e,t,r;return n=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,t=$localize`Type your message here`,r=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],n,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",t,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],r]},template:function(e,t){if(1&e&&(O(0,"div")(1,"button",0),J("click",function(){return t.switchChatVisibility()}),x(2,mht,2,0,"ng-container",1),x(3,_ht,1,1,"ng-template",null,2,Un),A(),x(5,yht,5,2,"div",3),x(6,Mht,14,5,"form",4),A()),2&e){const r=Hn(4);T(2),w("ngIf",t.visible)("ngIfElse",r),T(3),w("ngIf",t.visible),T(1),w("ngIf",t.visible)}},dependencies:[En,Kt,Ju,k4,Ql,Qu,lN,mg,gg,e7,dht],encapsulation:2}),U8=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],U8);let Y4e=(()=>{class n{constructor(t,r,s){this.router=t,this.currentGameService=r,this.messageDisplayer=s}pickGame(t){this.selectedGame=t}navigateToOnlineGameCreation(){var t=this;return I(function*(){const r=t.currentGameService.canUserCreate();r.isSuccess()?yield t.router.navigate(["/play",t.selectedGame]):t.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn),Q(I2),Q(_n))},n.\u0275cmp=ct({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(t,r){1&t&&(O(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),J("click",function(){return r.navigateToOnlineGameCreation()}),ve(2,2),A()),2&t&&(T(1),w("disabled",!r.selectedGame))},dependencies:[FF],encapsulation:2}),n})();function Pht(n,e){if(1&n&&(dn(0),wt(1),pn()),2&n){const t=C().$implicit;T(1),c1(t.data.playerOne.name)}}function Tht(n,e){1&n&&(dn(0),ve(1,27),pn())}function wht(n,e){if(1&n){const t=Oe();O(0,"tr",22),J("click",function(){const i=he(t).$implicit;return ce(C(2).joinGame(i))}),O(1,"td",23),wt(2),A(),O(3,"td",23),wt(4),A(),O(5,"td",23),x(6,Pht,2,1,"ng-container",24),x(7,Tht,2,0,"ng-template",null,25,Un),A(),O(9,"td",26),wt(10),A()()}if(2&n){const t=e.$implicit,r=e.index,s=Hn(8);h1("id","part_",r,""),T(2),c1(t.data.typeGame),T(2),c1(t.data.playerZero.name),T(2),w("ngIf",t.data.playerOne)("ngIfElse",s),T(4),c1(t.data.turn+1)}}function bht(n,e){if(1&n&&(O(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),ve(6,17),A(),O(7,"th",16),ve(8,18),A(),O(9,"th",16),ve(10,19),A(),O(11,"th",16),ve(12,20),A()()(),O(13,"tbody"),x(14,wht,11,6,"tr",21),A()()()()),2&n){const t=C();T(14),w("ngForOf",t.activeParts)}}function Oht(n,e){1&n&&(O(0,"div",28),X(1,"app-online-game-selection",29),A())}function Aht(n,e){1&n&&(O(0,"div",30)(1,"div",31)(2,"div",32),X(3,"app-chat",33),A()()()),2&n&&(T(3),w("turn",-1))}let m7=class{constructor(e,t,r,s){this.router=e,this.messageDisplayer=t,this.activePartsService=r,this.currentGameService=s,this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.currentGameSubscription=this.currentGameService.subscribeToCurrentGame(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){this.activePartsSubscription.unsubscribe(),this.currentGameSubscription.unsubscribe()}joinGame(e){var t=this;return I(function*(){const r=e.id,s=e.data.typeGame,o=t.currentGameService.canUserJoin(r,null!=e.data.beginning);o.isSuccess()?yield t.router.navigate(["/play",s,r]):t.messageDisplayer.criticalMessage(o.getReason())})()}selectTab(e){if("create"===e){const t=this.currentGameService.canUserCreate();t.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(t.getReason())}else this.currentTab=e}};m7.\u0275fac=function(e){return new(e||m7)(Q(Kn),Q(_n),Q(hht),Q(I2))},m7.\u0275cmp=ct({type:m7,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let n,e,t,r,s,i,o,c;return n=$localize`Games`,e=$localize`Create`,t=$localize`Chat`,r=$localize`Game`,s=$localize`First player`,i=$localize`Second player`,o=$localize`Turn`,c=$localize`Waiting for opponent`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],n,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],t,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],r,s,i,o,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],[1,"td","turn"],c,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],[1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"]]},template:function(e,t){1&e&&(O(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),J("click",function(){return t.selectTab("games")}),ve(4,3),A()(),O(5,"li",4)(6,"a",5),J("click",function(){return t.selectTab("create")}),ve(7,6),A()(),O(8,"li",7)(9,"a",8),J("click",function(){return t.selectTab("chat")}),ve(10,9),A()()()(),x(11,bht,15,1,"div",10),x(12,Oht,2,0,"div",11),x(13,Aht,4,1,"div",12)),2&e&&(T(6),w("ngClass",t.createTabClasses),T(5),w("ngIf","games"===t.currentTab),T(1),w("ngIf","create"===t.currentTab),T(1),w("ngIf","chat"===t.currentTab))},dependencies:[hn,En,Kt,U8,Y4e],encapsulation:2}),m7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],m7);let Nht=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ct({type:n,selectors:[["app-account"]],decls:11,vars:0,consts:function(){let e,t,r;return e=$localize`User settings`,t=$localize`If you forgot your password or want to change it, click on the following button:`,r=$localize`Reset password`,[[1,"hero-body"],[1,"title"],e,[1,"box"],[1,"block","level-left"],[1,"level-item"],t,["id","reset","routerLink","/reset-password",1,"button","is-primary","level-item","is-small"],r]},template:function(t,r){1&t&&(O(0,"div",0)(1,"p",1),ve(2,2),A()(),O(3,"div",3)(4,"p",1),wt(5,"Resetting password"),A(),O(6,"div",4)(7,"p",5),ve(8,6),A(),O(9,"button",7),ve(10,8),A()()())},dependencies:[uh],encapsulation:2}),n})(),K4e=(()=>{class n{constructor(t){this.route=t,this.message=t.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(t){return new(t||n)(Q(No))},n.\u0275cmp=ct({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let e;return e=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],e,[1,"message-body"]]},template:function(t,r){1&t&&(O(0,"div",0)(1,"div",1),ve(2,2),A(),O(3,"div",3),wt(4),A()()),2&t&&(T(4),c1(r.message))},encapsulation:2}),n})();new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const kht=new Error("request for lock canceled");class Rht{constructor(e,t=kht){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t,r)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:r}),this._dispatch()})}runExclusive(e,t=1){return function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof t?i:new t(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){const[r,s]=yield this.acquire(t);try{return yield e(r)}finally{s()}})}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach(e=>e.forEach(t=>t.reject(this._cancelError))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const r=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!r)continue;const s=this._value,i=t;this._value-=t,t=this._value+1,r.resolve([s,this._newReleaser(i)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)!this._weightedWaiters[e-1]||(this._weightedWaiters[e-1].forEach(t=>t()),this._weightedWaiters[e-1]=[])}}class zht{constructor(e){this._semaphore=new Rht(1,e)}acquire(){return function(n,e,t,r){return new(t||(t=Promise))(function(i,o){function c(g){try{h(r.next(g))}catch(m){o(m)}}function u(g){try{h(r.throw(g))}catch(m){o(m)}}function h(g){g.done?i(g.value):function s(i){return i instanceof t?i:new t(function(o){o(i)})}(g.value).then(c,u)}h((r=r.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){const[,e]=yield this._semaphore.acquire();return e})}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}let Q4e=(()=>{class n{constructor(){this.requestAwaitingReply=y.empty(),this.lastDeniedRequest=y.empty(),this.forbiddenRequests=new Ot}onGameStart(){this.requestAwaitingReply=y.empty(),this.lastDeniedRequest=y.empty(),this.forbiddenRequests=new Ot}onReceivedMove(){this.forbiddenRequests=new Ot,this.lastDeniedRequest=y.empty()}onReceivedRequest(t){pe.assert(this.requestAwaitingReply.isAbsent(),"Should not receive two requests in a row!"),this.requestAwaitingReply=y.of(t)}onReceivedReply(t,r){var s=this;return I(function*(){switch(s.requestAwaitingReply=y.empty(),t.reply){case"Accept":return!0;case"Reject":return t.player===r.getOpponent().value&&(s.lastDeniedRequest=y.of(t.requestType),s.forbiddenRequests.add(t.requestType)),!1}})()}canMakeRequest(t){return!(this.requestAwaitingReply.isPresent()||this.forbiddenRequests.contains(t))}getRequestAwaitingReplyFrom(t){return this.requestAwaitingReply.isPresent()&&this.requestAwaitingReply.get().player===t.getOpponent().value?y.of(this.requestAwaitingReply.get().requestType):y.empty()}getCurrentRequest(){return this.requestAwaitingReply}deniedRequest(){return this.lastDeniedRequest}}return n.requestInfos={TakeBack:{requestType:"TakeBack",textForRequest:()=>$localize`Ask to take back one move`,textForReply:()=>$localize`Your opponent is asking for a take back.`,name:()=>$localize`take back`,icon:zV},Draw:{requestType:"Draw",textForRequest:()=>$localize`Propose a draw`,textForReply:()=>$localize`Your opponent is proposing a draw.`,name:()=>$localize`draw`,icon:tse},Rematch:{requestType:"Rematch",textForRequest:()=>$localize`Propose a rematch`,textForReply:()=>$localize`Your opponent is proposing a rematch.`,name:()=>$localize`rematch`,icon:Dse}},n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function J4e(n){return 1e3*n.seconds+n.nanoseconds/1e6}function ele(n,e){return J4e(e)-J4e(n)}let Vht=(()=>{class n{constructor(){this.configRoom=y.empty(),this.takenGlobalTime=[0,0],this.extraGlobalTime=[0,0],this.availableTurnTime=[0,0],this.lastMoveStartTimestamp=y.empty()}setClocks(t,r){this.turnClocks=t,this.globalClocks=r,this.allClocks=t.concat(r)}onGameStart(t){this.configRoom=y.of(t);for(const r of B.PLAYERS)this.takenGlobalTime[r.value]=0,this.extraGlobalTime[r.value]=0,this.availableTurnTime[r.value]=this.getMoveDurationInMs(),this.globalClocks[r.value].setDuration(this.getPartDurationInMs()),this.turnClocks[r.value].setDuration(this.getMoveDurationInMs());for(const r of this.allClocks)r.start(),r.pause()}getPartDurationInMs(){return 1e3*this.configRoom.get().totalPartDuration}getMoveDurationInMs(){return 1e3*this.configRoom.get().maximalMoveDuration}onReceivedAction(t){switch(t.action){case"AddTurnTime":this.addTurnTime(B.of(t.player));break;case"AddGlobalTime":this.addGlobalTime(B.of(t.player));break;case"StartGame":this.lastMoveStartTimestamp=y.of(t.time);break;case"EndGame":this.onGameEnd()}}onReceivedMove(t){const r=B.of(t.player),s=t.time,i=this.getMillisecondsElapsedSinceLastMoveStart(s);this.lastMoveStartTimestamp=y.of(s),this.takenGlobalTime[r.value]+=i,this.availableTurnTime[r.value]-=i;const o=r.getOpponent();this.availableTurnTime[o.value]=this.getMoveDurationInMs();const c=this.getPartDurationInMs()-this.takenGlobalTime[o.value];this.globalClocks[o.value].changeDuration(c)}getMillisecondsElapsedSinceLastMoveStart(t){return ele(this.lastMoveStartTimestamp.get(),t)}onGameEnd(){for(const t of this.allClocks)t.isStarted()&&t.stop();this.updateClocks()}beforeEventsBatch(t){!1===t&&this.pauseAllClocks()}afterEventsBatch(t,r,s){if(this.updateClocks(),!1===t){const i=this.getMillisecondsElapsedSinceLastMoveStart(s);this.turnClocks[r.value].subtract(i),this.globalClocks[r.value].subtract(i),this.resumeClocks(r)}}resumeClocks(t){this.turnClocks[t.value].resume(),this.globalClocks[t.value].resume()}addTurnTime(t){this.availableTurnTime[t.getOpponent().value]+=3e4}addGlobalTime(t){this.extraGlobalTime[t.getOpponent().value]+=3e5}updateClocks(){for(const t of B.PLAYERS){this.turnClocks[t.value].changeDuration(this.availableTurnTime[t.value]);const r=this.getPartDurationInMs()+this.extraGlobalTime[t.value]-this.takenGlobalTime[t.value];this.globalClocks[t.value].changeDuration(r)}}pauseAllClocks(){for(const t of this.allClocks)!1===t.isIdle()&&t.pause()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function j_(n){return lr((e,t)=>{po(n).subscribe(ns(t,()=>t.complete(),ho)),!t.closed&&e.subscribe(t)})}let Fht=(()=>{class n{transform(t){const r=t%60,s=(t-r)%3600/60,i=(t-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=ti({name:"humanDuration",type:n,pure:!0}),n})();var L9;function $ht(n,e){if(1&n&&(dn(0),wt(1),pn()),2&n){const t=C(3);T(1),c1(t.viewInfo.chosenOpponent)}}function Ght(n,e){1&n&&ve(0,44)}function Uht(n,e){if(1&n&&(O(0,"div",45)(1,"div",8)(2,"label",46),dn(3),ve(4,47),pn(),O(5,"output"),wt(6),O3(7,"humanDuration"),A()(),O(8,"div",37),X(9,"input",48),A()(),O(10,"div",8)(11,"label",49),ca(12,50),X(13,"output"),O3(14,"humanDuration"),la(),A(),O(15,"div",37),X(16,"input",51),A()()()),2&n){const t=C(3);T(6),c1(b4(7,2,t.viewInfo.maximalMoveDuration||0)),T(8),M1(b4(14,4,t.viewInfo.totalPartDuration||0)),A1(12)}}function qht(n,e){1&n&&(O(0,"div"),ca(1,52),X(2,"br"),la(),A())}function Wht(n,e){1&n&&(O(0,"button",64),ve(1,65),A())}function jht(n,e){if(1&n){const t=Oe();O(0,"tr",60),J("click",function(){const i=he(t).$implicit;return ce(C(4).selectOpponent(i))}),O(1,"td",61),wt(2),A(),O(3,"td",62),x(4,Wht,2,0,"button",63),A()()}if(2&n){const t=e.$implicit,r=C(4);h1("id","presenceOf_",t,""),w("ngClass",r.viewInfo.candidateClasses[t]),T(1),w("id",r.viewInfo.chosenOpponent===t?"selected_"+t:"candidate_"+t),T(1),c1(t),T(2),w("ngIf",r.viewInfo.chosenOpponent!==t)}}function Zht(n,e){if(1&n&&(dn(0),ve(1,53),pn(),O(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),ve(7,57),A(),O(8,"th",56),ve(9,58),A()()(),O(10,"tbody"),x(11,jht,5,5,"tr",59),A()()()),2&n){const t=C(3);T(11),w("ngForOf",t.viewInfo.candidates)}}function Yht(n,e){if(1&n){const t=Oe();O(0,"button",66),J("click",function(){return he(t),ce(C(3).changeConfig())}),ve(1,67),A()}}function Kht(n,e){if(1&n){const t=Oe();O(0,"div")(1,"h1",4),ve(2,5),A(),O(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),ve(7,10),A(),O(8,"div",11)(9,"button",12),J("click",function(){return he(t),ce(C(2).selectFirstPlayer("RANDOM"))}),ve(10,13),A(),O(11,"button",14),J("click",function(){return he(t),ce(C(2).selectFirstPlayer("CREATOR"))}),ve(12,15),A(),O(13,"button",16),J("click",function(){return he(t),ce(C(2).selectFirstPlayer("CHOSEN_PLAYER"))}),x(14,$ht,2,1,"ng-container",17),x(15,Ght,1,0,"ng-template",null,18,Un),A()()(),O(17,"div",8)(18,"label",9),ve(19,19),A(),O(20,"div",11)(21,"div",20),J("click",function(){return he(t),ce(C(2).selectPartType("STANDARD"))}),O(22,"div",21)(23,"span"),ve(24,22),A()(),O(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),dn(29),ve(30,26),pn(),O(31,"strong"),wt(32),O3(33,"humanDuration"),A(),X(34,"br"),dn(35),ca(36,27),X(37,"strong"),O3(38,"humanDuration"),la(),pn(),A()()()()(),O(39,"div",28),J("click",function(){return he(t),ce(C(2).selectPartType("BLITZ"))}),O(40,"div",21)(41,"span"),ve(42,29),A()(),O(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),dn(47),ve(48,30),pn(),O(49,"strong"),wt(50),O3(51,"humanDuration"),A(),X(52,"br"),dn(53),ca(54,31),X(55,"strong"),O3(56,"humanDuration"),la(),pn(),A()()()()(),O(57,"button",32),J("click",function(){return he(t),ce(C(2).selectPartType("CUSTOM"))}),ve(58,33),A()()(),x(59,Uht,17,6,"div",34),O(60,"div",8)(61,"label",35),ve(62,36),A(),O(63,"div",37),x(64,qht,3,0,"div",17),x(65,Zht,12,1,"ng-template",null,38,Un),A()()(),O(67,"div",8)(68,"div",11)(69,"button",39),J("click",function(){return he(t),ce(C(2).proposeConfig())}),ve(70,40),A(),x(71,Yht,2,0,"button",41),O(72,"button",42),J("click",function(){return he(t),ce(C(2).cancelGameCreation())}),ve(73,43),A()()()()()}if(2&n){const t=Hn(16),r=Hn(66),s=C(2);T(3),w("formGroup",s.configFormGroup),T(1),w("disabled",!s.viewInfo.canEditConfig),T(5),w("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),T(2),w("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),T(2),w("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),T(1),w("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",t),T(7),w("ngClass",s.viewInfo.partTypeClasses.STANDARD),T(11),c1(b4(33,19,s.partType.NORMAL_MOVE_DURATION)),T(6),M1(b4(38,21,s.partType.NORMAL_PART_DURATION)),A1(36),T(1),w("ngClass",s.viewInfo.partTypeClasses.BLITZ),T(11),c1(b4(51,23,s.partType.BLITZ_MOVE_DURATION)),T(6),M1(b4(56,25,s.partType.BLITZ_PART_DURATION)),A1(54),T(1),w("ngClass",s.viewInfo.partTypeClasses.CUSTOM),T(2),w("ngIf",s.viewInfo.showCustomTime),T(5),w("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),T(5),w("disabled",!s.viewInfo.canProposeConfig),T(2),w("ngIf",s.viewInfo.canReviewConfig)}}function Xht(n,e){if(1&n&&(O(0,"div",74)(1,"p"),ca(2,75),X(3,"br"),la(),A()()),2&n){const t=C(3);T(3),M1(t.viewInfo.creator),A1(2)}}function Qht(n,e){if(1&n&&(O(0,"span"),ve(1,81),A()),2&n){const t=C(4);T(1),M1(t.viewInfo.creator),A1(1)}}function Jht(n,e){1&n&&(O(0,"span"),ve(1,82),A())}function e9t(n,e){1&n&&(O(0,"span"),ve(1,83),A())}function t9t(n,e){if(1&n){const t=Oe();O(0,"div",74)(1,"p"),ve(2,76),A(),O(3,"ul")(4,"li"),x(5,Qht,2,1,"span",2),x(6,Jht,2,0,"span",2),x(7,e9t,2,0,"span",2),A(),O(8,"li"),ca(9,77),X(10,"strong"),O3(11,"humanDuration"),la(),A(),O(12,"li"),ca(13,78),X(14,"strong"),O3(15,"humanDuration"),la(),A()(),O(16,"button",79),J("click",function(){return he(t),ce(C(3).acceptConfig())}),ve(17,80),A()()}if(2&n){const t=C(3);T(2),M1(t.viewInfo.creator)(t.viewInfo.partTypeName),A1(2),T(3),w("ngIf","CREATOR"===t.viewInfo.firstPlayer),T(1),w("ngIf","CHOSEN_PLAYER"===t.viewInfo.firstPlayer),T(1),w("ngIf","RANDOM"===t.viewInfo.firstPlayer),T(4),M1(b4(11,7,t.viewInfo.maximalMoveDuration||0)),A1(9),T(4),M1(b4(15,9,t.viewInfo.totalPartDuration||0)),A1(13)}}function n9t(n,e){if(1&n&&(O(0,"div")(1,"div",68)(2,"div",69)(3,"p"),ve(4,70),A()(),O(5,"div",71),x(6,Xht,4,1,"div",72),x(7,t9t,18,11,"ng-template",null,73,Un),A()()()),2&n){const t=Hn(8),r=C(2);T(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function r9t(n,e){if(1&n&&(dn(0),ve(1,86),pn()),2&n){const t=C(3);T(1),M1(t.viewInfo.creator),A1(1)}}function s9t(n,e){if(1&n&&ve(0,87),2&n){const t=C(3);M1(t.viewInfo.creator)(t.viewInfo.chosenOpponent),A1(0)}}function i9t(n,e){if(1&n&&(O(0,"div",68)(1,"div",69)(2,"p"),ve(3,84),A()(),O(4,"div",71)(5,"p"),x(6,r9t,2,1,"ng-container",17),x(7,s9t,1,2,"ng-template",null,85,Un),A()()()),2&n){const t=Hn(8),r=C(2);T(6),w("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",t)}}function o9t(n,e){if(1&n&&(O(0,"div",1),x(1,Kht,74,27,"div",2),x(2,n9t,9,2,"div",2),x(3,i9t,9,2,"div",3),A()),2&n){const t=C();T(1),w("ngIf",t.viewInfo.userIsCreator),T(1),w("ngIf",t.viewInfo.userIsChosenOpponent),T(1),w("ngIf",t.viewInfo.userIsObserver)}}let F6=L9=class{constructor(e,t,r,s,i,o,c,u,h,g){this.router=e,this.actRoute=t,this.connectedUserService=r,this.currentGameService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=h,this.messageDisplayer=g,this.partType=Pr,this.gameStartNotification=new ur,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new F2,this.allUserInterval=y.empty(),this.ownTokenInterval=y.empty(),this.selfSubscription=new I1,this.configRoomSubscription=new I1,this.candidatesSubscription=new I1,this.allDocDeleted=!1}ngOnInit(){var e=this;return I(function*(){e.checkInputs(),e.createForms();const t=yield e.configRoomService.joinGame(e.partId);if(t.isFailure()){const r=t.getReason();e.messageDisplayer.criticalMessage(r)}else yield e.startSendingPresenceTokens(),e.subscribeToConfigRoomDoc(),e.subscribeToFormElements()})()}checkInputs(){const e=this.connectedUserService.user;qe(e.isPresent(),"PartCreationComponent should not be called without connected user"),qe(e.get()!==Y5.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),qe(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[Us.RANDOM.value,ug.required],maximalMoveDuration:[Pr.NORMAL_MOVE_DURATION,ug.required],partType:["STANDARD",ug.required],totalPartDuration:[Pr.NORMAL_PART_DURATION,ug.required],chosenOpponent:["",ug.required]})}updateUserDocWithCurrentGame(e){const t=this.getUserRoleInPart(e),r={id:this.partId,opponent:this.getOpponent(),typeGame:pe.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:t};return this.currentGameService.updateCurrentGame(r)}getUserRoleInPart(e){const t=this.connectedUserService.user.get().id;return t===e.creator.id?"Creator":t===e.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let e=null;return e=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:pe.getNonNullable(this.currentConfigRoom?.creator),e}subscribeToConfigRoomDoc(){var e=this;const t=function(){var s=I(function*(i){yield e.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=I(function*(i){yield e.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,t),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(e){return pe.getNonNullable(this.configFormGroup.get(e))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(j_(this.ngUnsubscribe)).subscribe(e=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[e]=["is-selected"],this.viewInfo.chosenOpponent=e;const t=pe.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=t!==qs.CONFIG_PROPOSED.value&&""!==e}),this.getForm("partType").valueChanges.pipe(j_(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[e]=["is-primary","is-selected"],this.viewInfo.partType=e,this.viewInfo.showCustomTime="CUSTOM"===e}),this.getForm("maximalMoveDuration").valueChanges.pipe(j_(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.maximalMoveDuration=e}),this.getForm("totalPartDuration").valueChanges.pipe(j_(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.totalPartDuration=e}),this.getForm("firstPlayer").valueChanges.pipe(j_(this.ngUnsubscribe)).subscribe(e=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[e]=["is-primary","is-selected"],this.viewInfo.firstPlayer=e})}updateViewInfo(){const e=pe.getNonNullable(this.currentConfigRoom),t=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=e.partStatus===qs.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=e.partStatus!==qs.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(e),this.viewInfo.userIsChosenOpponent=t.id===e.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=e.partStatus!==qs.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=e.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(e)?this.setDataForCreator(e):(this.viewInfo.maximalMoveDuration=e.maximalMoveDuration,this.viewInfo.totalPartDuration=e.totalPartDuration,this.viewInfo.partType=e.partType,this.viewInfo.chosenOpponent=e.chosenOpponent?.name,this.viewInfo.firstPlayer=e.firstPlayer),e.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(e){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??e.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??e.totalPartDuration;let t=this.viewInfo.chosenOpponent;null==t||""===t?t=e.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===t)&&(t=""),this.getForm("chosenOpponent").setValue(t)}selectFirstPlayer(e){this.getForm("firstPlayer").setValue(e)}selectPartType(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue(Pr.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Pr.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue(Pr.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(Pr.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}selectOpponent(e){var t=this;return I(function*(){const r=t.getUserFromName(e);yield Promise.all([t.currentGameService.updateCurrentGame({opponent:r}),t.configRoomService.setChosenOpponent(t.partId,r)])})()}getUserFromName(e){const t=this.candidates.find(r=>r.name===e);return pe.getNonNullable(t)}changeConfig(){var e=this;return I(function*(){return e.configRoomService.reviewConfig(e.partId)})()}proposeConfig(){var e=this;return I(function*(){const t=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,s=e.getForm("maximalMoveDuration").value,i=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,c=e.getUserFromName(t);return e.configRoomService.proposeConfig(e.partId,c,Pr.of(r),s,Us.of(i),o)})()}cancelGameCreation(){var e=this;return I(function*(){e.allDocDeleted=!0,yield e.currentGameService.removeCurrentGame(),We.display("PartCreationComponent","cancelGameCreation","observed part removed"),yield e.chatService.deleteChat(e.partId),We.display("PartCreationComponent","cancelGameCreation","chat deleted"),yield e.gameService.deletePart(e.partId),We.display("PartCreationComponent","cancelGameCreation","chat and part deleted"),yield e.configRoomService.deleteConfigRoom(e.partId,e.candidates),We.display("PartCreationComponent","cancelGameCreation","chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(e){var t=this;return I(function*(){if(e.isAbsent())return We.display("PartCreationComponent","onCurrentConfigRoomUpdate","LAST UPDATE : the game is cancelled"),t.onGameCanceled();{const r=e.get();if(t.chosenOpponentJustLeft(r)&&t.userIsCreator(r)){const i=pe.getNonNullable(t.currentConfigRoom),o=pe.getNonNullable(i.chosenOpponent).name;t.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield t.currentGameService.updateCurrentGame({opponent:null})}let s=!1;t.userJustChosenAsOpponent(r)&&(yield t.updateUserDocWithCurrentGame(r),s=!0),t.currentConfigRoom=r,t.allUserInterval.isAbsent()&&(qe(!1===s,"Expected currentGameUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield t.updateUserDocWithCurrentGame(t.currentConfigRoom),yield t.observeNeededPlayers()),t.updateViewInfo(),t.isGameStarted(t.currentConfigRoom)&&(We.display("PartCreationComponent","onCurrentConfigRoomUpdate","the game has started"),t.onGameStarted())}})()}onCandidatesUpdate(e){var t=this;return I(function*(){t.candidates=e,t.updateViewInfo()})()}userJustChosenAsOpponent(e){if(this.isGameStarted(e))return!1;const t=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==t&&e.chosenOpponent?.id===t}chosenOpponentJustLeft(e){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent)}onGameCanceled(){var e=this;return I(function*(){e.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield e.router.navigate(["/lobby"])})()}isGameStarted(e){return qe(null!=e,"configRoom should not be null (isGameStarted)"),pe.getNonNullable(e).partStatus===qs.PART_STARTED.value}onGameStarted(){const e=pe.getNonNullable(this.currentConfigRoom);this.gameStartNotification.emit(e),this.gameStarted=!0}observeNeededPlayers(){var e=this;return I(function*(){const t=pe.getNonNullable(e.currentConfigRoom);qe(e.allUserInterval.isAbsent(),"Cannot observe players multiple times"),e.allUserInterval=y.of(window.setInterval(I(function*(){const r=e.lastToken;e.userIsCreator(t)?yield e.checkCandidatesTokensFreshness(r):yield e.checkCreatorTokenFreshness(r)}),L9.TOKEN_INTERVAL))})()}userIsCreator(e){return this.connectedUserService.user.get().id===e.creator.id}checkCreatorTokenFreshness(e){var t=this;return I(function*(){const r=pe.getNonNullable(t.currentConfigRoom);(yield t.didUserTimeout(r.creator.id,e))&&(yield t.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var e=this;return I(function*(){qe(!1===e.isGameStarted(e.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),qe(!1===e.allDocDeleted,"Should not delete doc twice"),yield e.cancelGameCreation()})()}checkCandidatesTokensFreshness(e){var t=this;return I(function*(){for(const r of t.candidates)(yield t.didUserTimeout(r.id,e))&&(yield t.removeCandidateFromLobby(r))})()}didUserTimeout(e,t){var r=this;return I(function*(){const s=yield r.userService.getUserLastUpdateTime(e);return s.isAbsent()?(Ts.logError("PartCreationComponent","found no user while observing "+e+" !"),!0):ele(s.get(),t)>L9.TOKEN_TIMEOUT})()}removeCandidateFromLobby(e){var t=this;return I(function*(){const r=pe.getNonNullable(t.currentConfigRoom);return e.id===r.chosenOpponent?.id&&(yield t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId)),t.configRoomService.removeCandidate(t.partId,e)})()}startSendingPresenceTokens(){var e=this;return I(function*(){yield e.connectedUserService.sendPresenceToken(),qe(e.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),e.ownTokenInterval=y.of(window.setInterval(()=>{e.connectedUserService.sendPresenceToken()},L9.TOKEN_INTERVAL));const t=e.connectedUserService.user.get().id;e.selfSubscription=e.userService.observeUserOnServer(t,r=>{qe(r.isPresent(),"connected user should exist"),e.lastToken=pe.getNonNullable(r.get().lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=y.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return this.gameService.acceptConfig(this.partId,pe.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var e=this;return I(function*(){if(e.ngUnsubscribe.next(),e.ngUnsubscribe.complete(),e.configRoomSubscription.unsubscribe(),e.candidatesSubscription.unsubscribe(),e.stopSendingPresenceTokensAndObservingUsersIfNeeded(),e.connectedUserService.user.isAbsent())return;const t=e.connectedUserService.user.get();!0!==e.gameStarted&&(null===e.currentConfigRoom?We.display("PartCreationComponent","ngOnDestroy","there is no part here"):!0===e.allDocDeleted?We.display("PartCreationComponent","ngOnDestroy","part has already been deleted"):t.id===e.currentConfigRoom.creator.id?(We.display("PartCreationComponent","ngOnDestroy","you(creator) about to cancel creation."),yield e.cancelGameCreation()):(We.display("PartCreationComponent","ngOnDestroy","you are about to cancel game joining"),yield e.currentGameService.removeCurrentGame(),yield e.configRoomService.cancelJoining(e.partId)))})()}};var _7;function c9t(n,e){if(1&n){const t=Oe();O(0,"button",3),J("click",function(){return he(t),ce(C().addTime())}),ve(1,4),A()}if(2&n){const t=C();T(1),M1(t.timeToAdd),A1(1)}}F6.TOKEN_INTERVAL=5e3,F6.TOKEN_TIMEOUT=2*L9.TOKEN_INTERVAL,F6.\u0275fac=function(e){return new(e||F6)(Q(Kn),Q(No),Q(Q1),Q(I2),Q(z3),Q(D3),Q(L3),Q(i9),Q(afe),Q(_n))},F6.\u0275cmp=ct({type:F6,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,e,t,r,s,i,o,c,u,h,g,m,M,b,L,G,j,ie,ye,te,xe,$e,et,Ft,H1,jt,Ys,G6,Jc,wa,U6,q6,St,qt,en,i1;return n=$localize`Game creation`,e=$localize`First player`,t=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,h=$localize`Maximal turn duration: `,g=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,M=$localize`Opponents`,b=$localize`Propose configuration`,L=$localize`Cancel game`,G=$localize`The opponent`,j=$localize`Maximal turn duration: `,ie=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,ye=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,te=$localize`Click on the opponent against which you would like to play.`,xe=$localize`Name`,$e=$localize`Actions`,et=$localize`Pick`,Ft=$localize`Change configuration`,H1=$localize`Configuration proposal`,jt=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,Ys=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,G6=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Jc=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,wa=$localize`Accept and start`,U6=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,q6=$localize`you play first`,St=$localize`the first player is selected randomly`,qt=$localize`One moment...`,en=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,i1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],e,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],t,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,h,g,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],M,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],b,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],L,G,["id","customTime"],["for","maximalMoveDuration",1,"label"],j,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],ie,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],ye,te,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],xe,$e,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],et,["id","reviewConfig",1,"button",3,"click"],Ft,[1,"message","is-primary"],[1,"message-header"],H1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],jt,Ys,G6,Jc,["id","acceptConfig",1,"button","is-primary",3,"click"],wa,U6,q6,St,qt,["proposalSent",""],en,i1]},template:function(e,t){1&e&&x(0,o9t,4,3,"div",0),2&e&&w("ngIf",t.viewInfo)},dependencies:[hn,En,Kt,Ju,k4,AE,Ql,Qu,e5,rh,Fht],encapsulation:2}),F6=L9=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],F6);let t4=_7=class{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new ur,this.addTimeToOpponent=new ur,this.cssClasses=_7.SAFE_TIME}setDuration(e){pe.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){pe.assert(this.isPaused,"Should not change duration of a clock while it is running"),this.remainingMs=e,this.displayDuration()}subtract(e){this.changeDuration(this.remainingMs-e)}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){pe.assert(this.isSet,"Should not start a chrono that has not been set!"),pe.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){pe.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){pe.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),pe.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){pe.assert(this.started,"Should only stop chrono that are started!"),!1===this.isPaused&&this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?_7.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?_7.DANGER_TIME_ODD:_7.DANGER_TIME_EVEN:_7.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}};t4.DANGER_TIME_EVEN="has-background-danger has-text-white",t4.DANGER_TIME_ODD="has-background-warning has-text-white",t4.PASSIVE_STYLE="has-text-passive is-italic",t4.SAFE_TIME="",t4.\u0275fac=function(e){return new(e||t4)},t4.\u0275cmp=ct({type:t4,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let n;return n=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],n]},template:function(e,t){1&e&&(O(0,"div",0)(1,"p",1),wt(2),O3(3,"number"),A(),x(4,c9t,2,1,"button",2),A()),2&e&&(w("ngClass",t.getTimeClass()),T(2),HO("",t.displayedMinute,":",UG(3,4,t.displayedSec,"2.0-0"),""),T(2),w("ngIf",t.canAddTime))},dependencies:[hn,Kt,mq],encapsulation:2}),t4=_7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],t4);const u9t=["chronoZeroGlobal"],f9t=["chronoOneGlobal"],h9t=["chronoZeroTurn"],d9t=["chronoOneTurn"];function p9t(n,e){if(1&n){const t=Oe();O(0,"app-part-creation",5,6),J("gameStartNotification",function(s){return he(t),ce(C().startGame(s))}),A()}2&n&&w("partId",C().currentPartId)}function g9t(n,e){1&n&&(dn(0),O(1,"span",39),ve(2,40),A(),pn())}function m9t(n,e){if(1&n&&(O(0,"span",41),ve(1,42),A()),2&n){const t=C(4);T(1),M1(null==t.currentPlayer?null:t.currentPlayer.name),A1(1)}}function _9t(n,e){if(1&n&&(O(0,"p",36),x(1,g9t,3,0,"ng-container",37),x(2,m9t,2,1,"ng-template",null,38,Un),A()),2&n){const t=Hn(3),r=C(3);T(1),w("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",t)}}function v9t(n,e){if(1&n&&(O(0,"div",32)(1,"p",33),ve(2,34),A(),x(3,_9t,4,2,"p",35),A()),2&n){const t=C(2);T(2),M1(t.currentPart.getTurn()+1),A1(2),T(1),w("ngIf",!1===t.endGame)}}function C9t(n,e){if(1&n&&(O(0,"p",43),wt(1),A()),2&n){const t=C(2);w("ngClass",t.getPlayerNameClass(t.Player.ZERO)),T(1),c1(t.players[0].get().name)}}function y9t(n,e){if(1&n&&(O(0,"p",44),ve(1,45),A()),2&n){const t=C(2);T(1),M1(t.gameComponent.scores.get()[0]),A1(1)}}function E9t(n,e){if(1&n&&(O(0,"p",46),wt(1),A()),2&n){const t=C(2);w("ngClass",t.getPlayerNameClass(t.Player.ONE)),T(1),c1(t.players[1].get().name)}}function M9t(n,e){if(1&n&&(O(0,"p",47),ve(1,48),A()),2&n){const t=C(2);T(1),M1(t.gameComponent.scores.get()[1]),A1(1)}}function S9t(n,e){1&n&&(O(0,"div")(1,"p",50),ve(2,51),A()())}function P9t(n,e){1&n&&(O(0,"p",55),ve(1,56),A())}function T9t(n,e){1&n&&(O(0,"p",57),ve(1,58),A())}function w9t(n,e){1&n&&(O(0,"p",59),ve(1,60),A())}function b9t(n,e){if(1&n&&(O(0,"div"),x(1,P9t,2,0,"p",52),x(2,T9t,2,0,"p",53),x(3,w9t,2,0,"p",54),A()),2&n){const t=C(3);T(1),w("ngIf",t.currentPart.getDrawAccepter().name===t.getPlayer().name),T(1),w("ngIf",t.currentPart.getDrawAccepter().name!==t.getPlayer().name&&t.isPlaying()),T(1),w("ngIf",!1===t.isPlaying())}}function O9t(n,e){1&n&&(O(0,"p",64),ve(1,65),A())}function A9t(n,e){1&n&&(O(0,"p",66),ve(1,67),A())}function N9t(n,e){if(1&n&&(O(0,"p",68),ve(1,69),A()),2&n){const t=C(4);T(1),M1(t.currentPart.getWinner().get().name),A1(1)}}function I9t(n,e){if(1&n&&(O(0,"div"),x(1,O9t,2,0,"p",61),x(2,A9t,2,0,"p",62),x(3,N9t,2,1,"p",63),A()),2&n){const t=C(3);T(1),w("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),T(1),w("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),T(1),w("ngIf",!1===t.isPlaying())}}function x9t(n,e){if(1&n&&(O(0,"p",64),ve(1,70),A()),2&n){const t=C(4);T(1),M1(t.currentPart.getLoser().get().name),A1(1)}}function k9t(n,e){1&n&&(O(0,"p",68),ve(1,71),A())}function L9t(n,e){if(1&n&&(O(0,"p",68),ve(1,72),A()),2&n){const t=C(4);T(1),M1(t.currentPart.getLoser().get().name),A1(1)}}function R9t(n,e){if(1&n&&(O(0,"div"),x(1,x9t,2,1,"p",61),x(2,k9t,2,0,"p",63),x(3,L9t,2,1,"p",63),A()),2&n){const t=C(3);T(1),w("ngIf",t.currentPart.getWinner().get().name===t.getPlayer().name),T(1),w("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),T(1),w("ngIf",!1===t.isPlaying())}}function D9t(n,e){1&n&&(O(0,"p",74),ve(1,75),A())}function z9t(n,e){if(1&n&&(O(0,"p",74),ve(1,76),A()),2&n){const t=C(4);T(1),M1(t.currentPart.getLoser().get().name),A1(1)}}function H9t(n,e){if(1&n&&(O(0,"div"),x(1,D9t,2,0,"p",73),x(2,z9t,2,1,"p",73),A()),2&n){const t=C(3);T(1),w("ngIf",t.currentPart.getWinner().get().name!==t.getPlayer().name&&t.isPlaying()),T(1),w("ngIf",!1===t.isPlaying()||t.currentPart.getWinner().get().name===t.getPlayer().name)}}function V9t(n,e){if(1&n&&(O(0,"div",49),X(1,"hr"),x(2,S9t,3,0,"div",27),x(3,b9t,4,3,"div",27),x(4,I9t,4,3,"div",27),x(5,R9t,4,3,"div",27),x(6,H9t,3,2,"div",27),A()),2&n){const t=C(2);T(2),w("ngIf",t.currentPart.isHardDraw()),T(1),w("ngIf",t.currentPart.isAgreedDraw()),T(1),w("ngIf",t.currentPart.isWin()),T(1),w("ngIf",t.currentPart.isTimeout()),T(1),w("ngIf",t.currentPart.isResign())}}function F9t(n,e){if(1&n){const t=Oe();dn(0),O(1,"button",85),J("click",function(){const i=he(t).$implicit;return ce(C(4).propose(i))}),wt(2),X(3,"fa-icon",86),A(),pn()}if(2&n){const t=e.$implicit,r=C(4);T(1),h1("id","propose",t,""),w("disabled",!1===r.requestAvailable(t)),T(1),Ri("",r.requestInfos[t].textForRequest(),"\xa0\xa0"),T(1),w("icon",r.requestInfos[t].icon)}}function B9t(n,e){if(1&n){const t=Oe();dn(0),O(1,"button",80),J("click",function(){return he(t),ce(C(3).resign())}),ve(2,81),A(),O(3,"button",82),J("click",function(){return he(t),ce(C(3).gameComponent.pass())}),ve(4,83),A(),x(5,F9t,4,4,"ng-container",84),pn()}if(2&n){const t=C(3);T(1),w("disabled",!1===t.canResign()),T(2),w("disabled",!1===t.canPass()),T(2),w("ngForOf",t.allRequests)}}function $9t(n,e){if(1&n){const t=Oe();O(0,"div",87)(1,"p"),wt(2),X(3,"fa-icon",86),A(),O(4,"button",88),J("click",function(){return he(t),ce(C(3).accept())}),ve(5,89),A(),O(6,"button",90),J("click",function(){return he(t),ce(C(3).reject())}),ve(7,91),A()()}if(2&n){const t=C(3);T(2),Ri(" ",t.requestInfos[t.requestAwaitingReplyFromUs().get()].textForReply(),"\xa0\xa0 "),T(1),w("icon",t.requestInfos[t.requestAwaitingReplyFromUs().get()].icon)}}function G9t(n,e){if(1&n&&(O(0,"div",92)(1,"p")(2,"span"),ca(3,93),X(4,"fa-icon",86),la(),A()()()),2&n){const t=C(3);T(4),w("icon",t.requestInfos[t.deniedRequest().get()].icon),M1(t.requestInfos[t.deniedRequest().get()].name()),A1(3)}}function U9t(n,e){if(1&n&&(O(0,"div",94)(1,"p")(2,"span"),ca(3,95),X(4,"fa-icon",86),la(),A()()()),2&n){const t=C(3);T(4),w("icon",t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].icon),M1(t.requestInfos[t.requestAwaitingReplyFromOpponent().get()].name()),A1(3)}}function q9t(n,e){if(1&n&&(dn(0),x(1,B9t,6,3,"ng-container",37),x(2,$9t,8,2,"ng-template",null,77,Un),x(4,G9t,5,2,"div",78),x(5,U9t,5,2,"div",79),pn()),2&n){const t=Hn(3),r=C(2);T(1),w("ngIf",!1===r.mustReply())("ngIfElse",t),T(3),w("ngIf",r.deniedRequest().isPresent()),T(1),w("ngIf",r.requestAwaitingReplyFromOpponent().isPresent())}}function W9t(n,e){1&n&&(O(0,"button",96),ve(1,97),A())}function j9t(n,e){if(1&n){const t=Oe();O(0,"div",7)(1,"div",8)(2,"div",9),x(3,v9t,4,2,"div",10),O(4,"div",11),x(5,C9t,2,2,"p",12),x(6,y9t,2,1,"p",13),O(7,"app-count-down",14,15),J("outOfTimeAction",function(){he(t);const s=C();return ce(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(t),ce(C().addGlobalTime())}),A(),O(9,"app-count-down",16,17),J("outOfTimeAction",function(){he(t);const s=C();return ce(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return he(t),ce(C().addTurnTime())}),A()(),O(11,"p",18),ve(12,19),A(),O(13,"div",11),x(14,E9t,2,2,"p",20),x(15,M9t,2,1,"p",21),O(16,"app-count-down",22,23),J("outOfTimeAction",function(){he(t);const s=C();return ce(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(t),ce(C().addGlobalTime())}),A(),O(18,"app-count-down",24,25),J("outOfTimeAction",function(){he(t);const s=C();return ce(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return he(t),ce(C().addTurnTime())}),A()(),X(20,"hr"),x(21,V9t,7,5,"div",26),x(22,q9t,6,4,"ng-container",27),x(23,W9t,2,0,"button",28),A()(),O(24,"div",29)(25,"div",30),X(26,"div",null,31),A()()()}if(2&n){const t=C();T(3),w("ngIf",null!==t.currentPart),T(2),w("ngIf",t.players[0].isPresent()),T(1),w("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),T(1),w("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),T(2),w("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==0)("canAddTime",t.role===t.Player.ONE&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),T(5),w("ngIf",t.players[1].isPresent()),T(1),w("ngIf",null!==t.currentPart&&t.gameComponent&&t.gameComponent.scores.isPresent()),T(1),w("dangerTimeLimit",6e4)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.globalTimeMessage),T(2),w("dangerTimeLimit",15e3)("active",null!==t.currentPart&&t.currentPart.getTurn()%2==1)("canAddTime",t.role===t.Player.ZERO&&!1===t.endGame)("timeToAdd",t.turnTimeMessage),T(3),w("ngIf",t.endGame&&null!==t.currentPart),T(1),w("ngIf",t.isPlaying()),T(1),w("ngIf",t.endGame),T(1),w("ngClass",t.getBoardHighlight())}}let Z9t=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})(),v7=class extends VT{constructor(e,t,r,s,i,o,c,u,h,g){super(e,t,r,s),this.currentGameService=i,this.userService=o,this.gameService=c,this.gameEventService=u,this.timeManager=h,this.requestManager=g,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.currentGame=y.empty(),this.userLinkedToThisPart=!0,this.opponentSubscription=new I1,this.partSubscription=new I1,this.gameEventsSubscription=new I1,this.currentGameSubscription=new I1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.requestInfos=Q4e.requestInfos,this.allRequests=["TakeBack","Draw","Rematch"]}extractPartIdFromURL(){return pe.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return pe.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}redirectIfPartOrGameIsInvalid(){var e=this;return I(function*(){const t=e.extractGameNameFromURL();if(k9.ALL_GAMES().some(s=>s.urlName===t)){if((yield e.gameService.getPartValidity(e.currentPartId,t)).isFailure()){e.routerEventsSubscription.unsubscribe();const i=Z9t.NO_MATCHING_PART();yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const s=g7.NO_MATCHING_GAME(t);yield e.router.navigate(["/notFound",s],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return I(function*(){e.routerEventsSubscription=e.router.events.subscribe(function(){var t=I(function*(r){r instanceof Q0&&(yield e.setCurrentPartIdOrRedirect())});return function(r){return t.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(t=>{e.authUser=t}),yield e.setCurrentPartIdOrRedirect(),e.currentGameSubscription=e.currentGameService.subscribeToCurrentGame(function(){var t=I(function*(r){yield e.onCurrentGameUpdate(r)});return function(r){return t.apply(this,arguments)}}())})()}onCurrentGameUpdate(e){var t=this;return I(function*(){if(e.isPresent()){const r=e.get();"Observer"===r.role||r.id===t.currentPartId?t.currentGame=e:(t.userLinkedToThisPart=!1,yield t.router.navigate(["/lobby"]))}else t.currentGame=y.empty()})()}startGame(e){var t=this;return I(function*(){pe.assert(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(I(function*(){const r=yield t.afterViewInit();t.timeManager.setClocks([t.chronoZeroTurn,t.chronoOneTurn],[t.chronoZeroGlobal,t.chronoOneGlobal]),pe.assert(r,"Game should be created successfully, otherwise part-creation would have redirected"),yield t.startPart()}),2)})()}startPart(){var e=this;return I(function*(){const t=(yield e.gameService.getPart(e.currentPartId)).get();e.currentPart=new gP(e.currentPartId,t),e.partSubscription=e.gameService.subscribeToChanges(e.currentPartId,function(){var r=I(function*(s){pe.assert(s.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.currentPart=new gP(e.currentPartId,s.get())});return function(s){return r.apply(this,arguments)}}()),e.subscribeToEvents()})()}onGameStart(){var e=this;return I(function*(){yield e.initializePlayersDatas(e.currentPart);const t=e.gameComponent.getTurn();pe.assert(0===t,"turn should always be 0 upon game start"),e.timeManager.onGameStart(e.configRoom),e.requestManager.onGameStart()})()}subscribeToEvents(){var e=this;const t=new zht,r=function(){var s=I(function*(i){yield t.runExclusive(I(function*(){e.beforeEventsBatch();for(const o of i)switch(o.eventType){case"Move":const c=o;yield e.onReceivedMove(c);break;case"Request":e.requestManager.onReceivedRequest(o);break;case"Reply":const h=o;(yield e.requestManager.onReceivedReply(h,e.role))&&(yield e.handleReply(h));break;default:pe.expectToBe(o.eventType,"Action","Event should be an action");const m=o;e.timeManager.onReceivedAction(m),"EndGame"===m.action?yield e.onGameEnd():"StartGame"===m.action&&(yield e.onGameStart())}yield e.afterEventsBatch()}))});return function(o){return s.apply(this,arguments)}}();this.gameEventsSubscription=this.gameEventService.subscribeToEvents(this.currentPartId,r)}handleReply(e){var t=this;return I(function*(){switch(e.requestType){case"TakeBack":const r=B.of(e.player);t.takeBackToPreviousPlayerTurn(r.getOpponent());break;case"Rematch":yield t.router.navigate(["/nextGameLoading"]);const s=t.extractGameNameFromURL();yield t.router.navigate(["/play",s,e.data])}})()}onGameEnd(){var e=this;return I(function*(){yield e.currentGameService.removeCurrentGame(),e.endGame=!0})()}onReceivedMove(e){var t=this;return I(function*(){const r=t.gameComponent.rules,s=t.gameComponent.getTurn(),i=t.gameComponent.encoder.decode(e.move),o=r.isLegal(i,t.gameComponent.getState()),c="We received an incorrect db move: "+i.toString()+" at turn "+s+'because "'+o.getReasonOr("")+'"';pe.assert(o.isSuccess(),c);const u=r.choose(t.gameComponent.node,i);pe.assert(u.isPresent(),"Chosen move should be legal after all checks, but it is not!"),t.gameComponent.node=u.get(),t.updateBoardAndShowLastMove(),t.currentPlayer=t.players[t.gameComponent.getTurn()%2].get(),t.timeManager.onReceivedMove(e),t.requestManager.onReceivedMove()})()}beforeEventsBatch(){this.timeManager.beforeEventsBatch(this.endGame)}afterEventsBatch(){var e=this;return I(function*(){const t=B.ofTurn(e.gameComponent.getTurn()),r=yield e.userService.getServerTime(e.connectedUserService.user.get().id);e.timeManager.afterEventsBatch(e.endGame,t,r)})()}takeBackToPreviousPlayerTurn(e){this.gameComponent.node=this.gameComponent.node.mother.get(),this.gameComponent.getCurrentPlayer()!==e&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.updateBoardAndShowLastMove()}canResign(){return pe.assert(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}requestAvailable(e){switch(e){case"TakeBack":return this.canAskTakeBack();case"Draw":return this.canProposeDraw();default:return pe.expectToBe(e,"Rematch"),this.endGame}}mustReply(){return this.requestAwaitingReplyFromUs().isPresent()}requestAwaitingReplyFromUs(){return pe.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role)}requestAwaitingReplyFromOpponent(){return pe.assert(this.role.isPlayer(),"User should be playing"),this.requestManager.getRequestAwaitingReplyFrom(this.role.getOpponent())}deniedRequest(){return this.requestManager.deniedRequest()}canPass(){return pe.assert(this.isPlaying(),"Non playing should not call canPass"),!this.endGame&&this.currentPlayer?.name===this.getPlayer().name&&this.gameComponent.canPass}canAskTakeBack(){return pe.assert(this.isPlaying(),"Non playing should not call canAskTakeBack"),pe.assert(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet"),!(!0===this.endGame||pe.getNonNullable(this.currentPart).data.turn<=this.role.value)&&this.requestManager.canMakeRequest("TakeBack")}canProposeDraw(){return pe.assert(this.isPlaying(),"Non playing should not call canProposeDraw"),!this.endGame&&this.requestManager.canMakeRequest("Draw")}initializePlayersDatas(e){var t=this;return I(function*(){t.players=[y.of(e.data.playerZero),y.ofNullable(e.data.playerOne)],pe.assert(null!=e.data.playerOne,"should not initializePlayersDatas when players data is not received"),t.currentPlayer=t.players[e.data.turn%2].get();const r=yield t.setRealObserverRole();if(r.isPresent()){const s=i=>{pe.assert(i.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent=r.get()};t.opponentSubscription=t.userService.observeUserOnServer(r.get().id,s)}})()}setRealObserverRole(){var e=this;return I(function*(){let t=y.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(B.ZERO),t=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(B.ONE),t=e.players[0]):e.setRole(le.NONE),yield e.currentGameService.updateCurrentGame({...e.currentGame.get(),role:e.role===le.NONE?"Observer":"Player"}),t})()}onLegalUserMove(e){var t=this;return I(function*(){if(!t.mustReply()){const r=t.gameComponent.rules.isLegal(e,t.gameComponent.node.gameState);pe.assert(r.isSuccess(),"onLegalUserMove called with an illegal move");const s=t.gameComponent.rules.applyLegalMove(e,t.gameComponent.node.gameState,r.get()),i=new x2(s,y.of(t.gameComponent.node),y.of(e)),o=t.gameComponent.rules.getGameStatus(i),c=t.gameComponent.encoder.encode(e);return yield t.gameService.addMove(t.currentPartId,t.role,c),t.updatePartWithStatusAndScores(o,t.gameComponent.scores)}t.gameComponent.message(g7.MUST_ANSWER_REQUEST())})()}updatePartWithStatusAndScores(e,t){var r=this;return I(function*(){return e.isEndGame?e===Ne.DRAW?yield r.gameService.drawPart(r.currentPartId,r.role,t):(pe.assert(e.winner.isPlayer(),"Non-draw end games should have a winner"),r.notifyVictory(e.winner,t)):r.gameService.updatePart(r.currentPartId,t)})()}notifyTimeoutVictory(e,t){var r=this;return I(function*(){const s=r.role;yield r.gameService.notifyTimeout(r.currentPartId,s,e,t)})()}notifyVictory(e,t){var r=this;return I(function*(){const s=pe.getNonNullable(r.currentPart),i=r.players[0].get(),o=r.players[1].get();r.currentPart=e===B.ONE?s.setWinnerAndLoser(o,i):s.setWinnerAndLoser(i,o);const c=r.role;yield r.gameService.endPartWithVictory(r.currentPartId,c,r.currentPart.getWinner().get(),r.currentPart.getLoser().get(),t)})()}resign(){var e=this;return I(function*(){const t=e.role,r=e.getPlayer(),s=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,t,s,r)})()}reachedOutOfTime(e){var t=this;return I(function*(){if(!1===t.isPlaying())return;const r=pe.getNonNullable(t.opponent);e===t.role?yield t.notifyTimeoutVictory(r,t.authUser.toMinimalUser()):yield t.notifyTimeoutVictory(t.authUser.toMinimalUser(),r)})()}propose(e){var t=this;return I(function*(){pe.assert(t.role.isPlayer(),"cannot propose request if not player");const r=t.role;switch(e){case"Rematch":return t.gameService.proposeRematch(t.currentPartId,r);case"Draw":return t.gameService.proposeDraw(t.currentPartId,r);default:return pe.expectToBe(e,"TakeBack"),t.gameService.askTakeBack(t.currentPartId,r)}})()}accept(){var e=this;return I(function*(){pe.assert(e.role.isPlayer(),"cannot accept request if not player");const t=e.role,r=pe.getNonNullable(e.currentPart),s=e.requestManager.getCurrentRequest().get().requestType;switch(s){case"Rematch":return e.gameService.acceptRematch(r,t);case"Draw":return e.gameService.acceptDraw(r.id,t);default:return pe.expectToBe(s,"TakeBack"),e.gameService.acceptTakeBack(r.id,r.data.turn,t)}})()}reject(){var e=this;return I(function*(){pe.assert(e.role.isPlayer(),"cannot reject request if not player");const t=e.role,r=e.requestManager.getCurrentRequest().get().requestType;switch(r){case"Rematch":return e.gameService.rejectRematch(e.currentPartId,t);case"Draw":return e.gameService.refuseDraw(e.currentPartId,t);default:return pe.expectToBe(r,"TakeBack"),e.gameService.refuseTakeBack(e.currentPartId,t)}})()}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===B.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}addGlobalTime(){return this.gameService.addGlobalTime(this.currentPartId,this.role)}addTurnTime(){return this.gameService.addTurnTime(this.currentPartId,this.role)}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const t=this.gameComponent.node.move.get();this.gameComponent.showLastMove(t)}}ngOnDestroy(){var e=this;return I(function*(){e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.currentGameSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&e.connectedUserService.user.isPresent()&&(yield e.currentGameService.removeCurrentGame()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe(),e.gameEventsSubscription.unsubscribe())})()}};function K9t(n,e){if(1&n&&(O(0,"option",26),wt(1),A()),2&n){const t=e.$implicit;w("value",t.name),T(1),c1(t.name)}}function X9t(n,e){if(1&n&&(O(0,"option",26),ve(1,30),A()),2&n){const t=e.$implicit;w("value",t),T(1),M1(t),A1(1)}}v7.\u0275fac=function(e){return new(e||v7)(Q(No),Q(Q1),Q(Kn),Q(_n),Q(I2),Q(i9),Q(z3),Q(LH),Q(Vht),Q(Q4e))},v7.\u0275cmp=ct({type:v7,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){if(1&e&&(F0(u9t,5),F0(f9t,5),F0(h9t,5),F0(d9t,5)),2&e){let r;O4(r=A4())&&(t.chronoZeroGlobal=r.first),O4(r=A4())&&(t.chronoOneGlobal=r.first),O4(r=A4())&&(t.chronoZeroTurn=r.first),O4(r=A4())&&(t.chronoOneTurn=r.first)}},features:[l],decls:5,vars:4,consts:function(){let n,e,t,r,s,i,o,c,u,h,g,m,M,b,L,G,j,ie,ye,te,xe,$e,et,Ft,H1;return n=$localize`vs.`,e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,t=$localize`It is your turn.`,r=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,s=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Draw`,c=$localize`You agreed to draw.`,u=$localize`Your draw proposal has been accepted.`,h=$localize`Players agreed to draw.`,g=$localize`You won.`,m=$localize`You lost.`,M=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,b=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,L=$localize`You reached your time limit.`,G=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,j=$localize`You resigned.`,ie=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,ye=$localize`Resign`,te=$localize`Pass a turn`,xe=$localize`Accept`,$e=$localize`Reject`,et=$localize`Your ${"\ufffd0\ufffd"}:INTERPOLATION: request has been rejected.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,Ft=$localize`Your request for a ${"\ufffd0\ufffd"}:INTERPOLATION: has been sent.  ${"\ufffd#4\ufffd"}:START_TAG_FA_ICON:${"\ufffd/#4\ufffd"}:CLOSE_TAG_FA_ICON:`,H1=$localize`Go back to the game list`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],n,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],["class","block","id","winnerIndicator",4,"ngIf"],[4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],t,["id","opponentTurn"],r,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],s,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],i,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],o,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],c,["id","yourOpponentAgreedToDrawIndicator",1,"title"],u,["id","playersAgreedToDraw",1,"title"],h,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],g,["id","youLostIndicator",1,"title"],m,[1,"title"],M,b,L,G,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],j,ie,["replyButtons",""],["id","requestRejected","class","notification is-danger",4,"ngIf"],["id","requestAwaitingReply","class","notification",4,"ngIf"],["id","resign",1,"button","is-fullwidth","mb-1","is-danger",3,"disabled","click"],ye,["id","pass",1,"button","is-fullwidth","mb-1","is-success",3,"disabled","click"],te,[4,"ngFor","ngForOf"],[1,"button","is-fullwidth","mb-1",3,"id","disabled","click"],[3,"icon"],[1,"notification"],["id","accept",1,"button","is-fullwidth","mb-1","is-success",3,"click"],xe,["id","reject",1,"button","is-fullwidth","mb-1","is-danger",3,"click"],$e,["id","requestRejected",1,"notification","is-danger"],et,["id","requestAwaitingReply",1,"notification"],Ft,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],H1]},template:function(e,t){1&e&&(x(0,p9t,2,1,"app-part-creation",0),x(1,j9t,28,25,"div",1),O(2,"div",2)(3,"div",3),X(4,"app-chat",4),A()()),2&e&&(w("ngIf",!1===t.gameStarted),T(1),w("ngIf",t.gameStarted),T(3),w("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},dependencies:[hn,En,Kt,uh,e7,U8,F6,t4],encapsulation:2}),v7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],v7);const Q9t=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function J9t(n,e){if(1&n){const t=Oe();O(0,"select",27),J("ngModelChange",function(s){return he(t),ce(C(2).aiDepths[0]=s)})("change",function(){he(t);const s=C(2);return ce(s.updatePlayer(s.Player.ZERO))}),O(1,"option",28),ve(2,29),A(),x(3,X9t,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[0]),T(3),w("ngForOf",K1(2,Q9t)))}function edt(n,e){if(1&n&&(O(0,"p",31),ve(1,32),A()),2&n){const t=C(2);T(1),M1(t.gameComponent.scores.get()[0]),A1(1)}}function tdt(n,e){if(1&n&&(O(0,"option",26),wt(1),A()),2&n){const t=e.$implicit;w("value",t.name),T(1),c1(t.name)}}function ndt(n,e){if(1&n&&(O(0,"option",26),ve(1,35),A()),2&n){const t=e.$implicit;w("value",t),T(1),M1(t),A1(1)}}const rdt=function(){return[1,2,3,4,5,6,7,8,9,10]};function sdt(n,e){if(1&n){const t=Oe();O(0,"select",33),J("ngModelChange",function(s){return he(t),ce(C(2).aiDepths[1]=s)})("change",function(){he(t);const s=C(2);return ce(s.updatePlayer(s.Player.ONE))}),O(1,"option",28),ve(2,34),A(),x(3,ndt,2,2,"option",17),A()}2&n&&(w("ngModel",C(2).aiDepths[1]),T(3),w("ngForOf",K1(2,rdt)))}function idt(n,e){if(1&n&&(O(0,"p",36),ve(1,37),A()),2&n){const t=C(2);T(1),M1(t.gameComponent.scores.get()[1]),A1(1)}}function odt(n,e){if(1&n&&(O(0,"h4",41),wt(1),A()),2&n){const t=C(3);T(1),c1(t.winnerMessage.get())}}function adt(n,e){1&n&&(O(0,"h4",42),ve(1,43),A())}function cdt(n,e){if(1&n&&(O(0,"div",38),x(1,odt,2,1,"h4",39),x(2,adt,2,0,"h4",40),A()),2&n){const t=C(2);T(1),w("ngIf",t.winnerMessage.isPresent()),T(1),w("ngIf",t.winnerMessage.isAbsent())}}function ldt(n,e){if(1&n){const t=Oe();O(0,"div",7)(1,"div",8)(2,"p",9),ve(3,10),A()(),O(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),J("change",function(){he(t);const s=C();return ce(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return he(t),ce(C().playerSelection[0]=s)}),O(8,"option",15),ve(9,16),A(),x(10,K9t,2,2,"option",17),A()(),O(11,"div",13),x(12,J9t,4,3,"select",18),A(),x(13,edt,2,1,"p",19),A(),O(14,"div",20)(15,"div",13)(16,"select",21),J("change",function(){he(t);const s=C();return ce(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return he(t),ce(C().playerSelection[1]=s)}),O(17,"option",15),ve(18,22),A(),x(19,tdt,2,2,"option",17),A()(),O(20,"div",13),x(21,sdt,4,3,"select",23),A(),x(22,idt,2,1,"p",24),A()(),x(23,cdt,3,2,"div",25),A()}if(2&n){const t=C();T(3),M1(t.gameComponent.getTurn()+1),A1(3),T(4),w("ngModel",t.playerSelection[0]),T(3),w("ngForOf",t.gameComponent.availableMinimaxes),T(2),w("ngIf",!1===t.players[0].equalsValue("human")),T(1),w("ngIf",t.gameComponent.scores.isPresent()),T(3),w("ngModel",t.playerSelection[1]),T(3),w("ngForOf",t.gameComponent.availableMinimaxes),T(2),w("ngIf",!1===t.players[1].equalsValue("human")),T(1),w("ngIf",t.gameComponent.scores.isPresent()),T(1),w("ngIf",t.endGame)}}function udt(n,e){if(1&n){const t=Oe();O(0,"button",50),J("click",function(){return he(t),ce(C(2).gameComponent.pass())}),ve(1,51),A()}}function fdt(n,e){if(1&n){const t=Oe();O(0,"button",52),J("click",function(){return he(t),ce(C(2).takeBack())}),ve(1,53),A()}}function hdt(n,e){if(1&n&&(dn(0),wt(1),X(2,"br"),pn()),2&n){const t=e.$implicit,r=C(3);T(1),Ri(" ",t.name+": "+t.getBoardValue(r.gameComponent.node)," ")}}function ddt(n,e){if(1&n&&(O(0,"div",54),x(1,hdt,3,1,"ng-container",55),wt(2),X(3,"br"),wt(4),X(5,"br"),A()),2&n){const t=C(2);T(1),w("ngForOf",t.gameComponent.availableMinimaxes),T(1),Ri(" Created ",t.getCreatedNodes()," nodes."),T(2),Ri(" Minimax time: ",t.getMinimaxTime(),"ms.")}}function pdt(n,e){if(1&n){const t=Oe();O(0,"div",44),x(1,udt,2,0,"button",45),x(2,fdt,2,0,"button",46),O(3,"button",47),J("click",function(){return he(t),ce(C().restartGame())}),ve(4,48),A(),x(5,ddt,6,3,"div",49),A()}if(2&n){const t=C();T(1),w("ngIf",!1===t.endGame&&t.gameComponent.canPass),T(1),w("ngIf",t.canTakeBack()),T(3),w("ngIf",t.gameComponent.node.move.isPresent()&&t.displayAIMetrics)}}let C7=class extends VT{constructor(e,t,r,s,i){super(e,t,r,s),this.cdr=i,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=y.empty(),this.botTimeOut=1e3,this.displayAIMetrics=!1,this.players=[y.of(this.playerSelection[0]),y.of(this.playerSelection[1])],this.role=B.ZERO}getCreatedNodes(){return tT.createdNodes}getMinimaxTime(){return tT.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(I(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=y.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?B.ONE:B.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var t=this;return I(function*(){t.gameComponent.node=t.gameComponent.rules.choose(t.gameComponent.node,e).get(),t.updateBoard(),t.proposeAIToPlay()})()}updateBoard(){this.updateBoardAndShowLastMove();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const t=$localize`Player ${e.winner.value+1}`,s=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[s].equalsValue("human")?y.of($localize`${t} won`):y.of($localize`You won`):this.players[s].equalsValue("human")?y.of($localize`You lost`):y.of($localize`${this.players[e.winner.value].get()} (Player ${e.winner.value+1}) won`)}}proposeAIToPlay(){var e=this;const t=this.getPlayingAI();t.isPresent()&&window.setTimeout(I(function*(){yield e.doAIMove(t.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.node).isEndGame)return y.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?y.empty():y.ofNullable(this.gameComponent.availableMinimaxes.find(t=>this.players[e].equalsValue(t.name)))}doAIMove(e){var t=this;return I(function*(){const r=t.gameComponent.rules;qe(r.getGameStatus(t.gameComponent.node)===Ne.ONGOING,"AI should not try to play when game is over!");const o=Number.parseInt(t.aiDepths[t.gameComponent.node.gameState.turn%2%2]),c=t.gameComponent.node.findBestMove(o,e,!0),u=r.choose(t.gameComponent.node,c);return u.isPresent()?(t.gameComponent.node=u.get(),t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),R.SUCCESS):(t.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),Ts.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:c.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.node=this.gameComponent.node.mother.get(),this.isAITurn()&&(this.gameComponent.node=this.gameComponent.node.mother.get()),this.updateBoardAndShowLastMove()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.node=this.gameComponent.rules.getInitialNode(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=y.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}onCancelMove(e){if(this.gameComponent.node.move.isPresent()){const t=this.gameComponent.node.move.get();this.gameComponent.showLastMove(t)}}};C7.\u0275fac=function(e){return new(e||C7)(Q(No),Q(Q1),Q(Kn),Q(_n),Q(Zu))},C7.\u0275cmp=ct({type:C7,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let n,e,t,r,s,i,o,c,u,h,g,m,M;return n=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,t=$localize`Human`,r=$localize`Pick the level`,s=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`Pick the level`,c=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,u=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,h=$localize`Draw`,g=$localize`Start a new game`,m=$localize`Pass a turn`,M=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],n,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],t,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],r,s,["id","scoreOne",1,"block"],i,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],o,c,["id","scoreZero",1,"block"],u,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],h,[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],g,["id","AIMetrics",4,"ngIf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],m,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],M,["id","AIMetrics"],[4,"ngFor","ngForOf"]]},template:function(e,t){1&e&&(O(0,"div",0)(1,"div",1),x(2,ldt,24,10,"div",2),x(3,pdt,6,3,"div",3),A(),O(4,"div",4)(5,"div",5),X(6,"div",null,6),A()()()),2&e&&(T(2),w("ngIf",t.gameComponent),T(1),w("ngIf",t.gameComponent),T(1),w("ngClass",t.getBoardHighlight()))},dependencies:[hn,En,Kt,_g,vg,NE,Ql,mg],encapsulation:2,changeDetection:0}),C7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],C7);let tle=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function mdt(n,e){if(1&n&&(O(0,"div",21)(1,"div",22),ve(2,23),A(),X(3,"div",24),A()),2&n){const t=C();T(3),w("innerHTML",t.currentReason.get(),Ou)}}function _dt(n,e){if(1&n){const t=Oe();O(0,"button",25),J("click",function(){return he(t),ce(C().retry())}),ve(1,26),A()}}function vdt(n,e){1&n&&(dn(0),ve(1,31),pn())}function Cdt(n,e){1&n&&(dn(0),ve(1,32),pn())}function ydt(n,e){if(1&n&&x(0,Cdt,2,0,"ng-container",28),2&n){C();const t=Hn(5),r=C();w("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",t)}}function Edt(n,e){1&n&&(dn(0),ve(1,33),pn())}function Mdt(n,e){if(1&n){const t=Oe();O(0,"button",27),J("click",function(){return he(t),ce(C().next())}),x(1,vdt,2,0,"ng-container",28),x(2,ydt,1,2,"ng-template",null,29,Un),x(4,Edt,2,0,"ng-template",null,30,Un),A()}if(2&n){const t=Hn(3),r=C();T(1),w("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",t)}}function Sdt(n,e){if(1&n){const t=Oe();O(0,"button",34),J("click",function(){return he(t),ce(C().start())}),ve(1,35),A()}}function Pdt(n,e){if(1&n){const t=Oe();O(0,"button",36),J("click",function(){return he(t),ce(C().playLocally())}),ve(1,37),A()}}function Tdt(n,e){if(1&n){const t=Oe();O(0,"button",38),J("click",function(){return he(t),ce(C().createGame())}),ve(1,39),A()}}function wdt(n,e){if(1&n){const t=Oe();O(0,"button",40),J("click",function(){return he(t),ce(C().showSolution())}),ve(1,41),A()}}function bdt(n,e){if(1&n&&(dn(0),O(1,"option",43),wt(2),A(),pn()),2&n){const t=C(),r=t.index,s=t.$implicit;T(1),h1("id","step_",r,""),w("value",r),T(1),c1(s.title)}}function Odt(n,e){1&n&&(dn(0),wt(1,"v "),pn())}function Adt(n,e){1&n&&wt(0,"x ")}function Ndt(n,e){if(1&n&&(O(0,"option",44),x(1,Odt,2,0,"ng-container",28),x(2,Adt,1,0,"ng-template",null,45,Un),O(4,"span",46),wt(5),A()()),2&n){const t=Hn(3),r=C(),s=r.index,i=r.$implicit,o=C();w("value",s),T(1),w("ngIf",o.stepFinished[s])("ngIfElse",t),T(3),h1("id","step_",s,""),T(1),c1(i.title)}}function Idt(n,e){if(1&n&&(dn(0),x(1,bdt,3,3,"ng-container",28),x(2,Ndt,6,5,"ng-template",null,42,Un),pn()),2&n){const t=e.index,r=Hn(3),s=C();T(1),w("ngIf",t===s.stepIndex)("ngIfElse",r)}}let y7=class extends VT{constructor(e,t,r,s,i){super(e,i,t,r),this.cdr=s,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=y.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,this.role=B.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return I(function*(){(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const t=this.steps[this.stepIndex];this.currentMessage=t.instruction,this.currentReason=y.empty(),this.gameComponent.node=new x2(t.state,y.empty(),t.previousMove),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var t=this;return I(function*(){const r=t.steps[t.stepIndex],s=t.gameComponent.rules.choose(t.gameComponent.node,e);if(qe(s.isPresent(),"It should be impossible to call onLegalUserMove with an illegal move"),t.gameComponent.node=s.get(),t.updateBoardAndShowLastMove(),t.moveAttemptMade=!0,r.isPredicate()){const i=t.gameComponent.getPreviousState(),o=t.gameComponent.getState(),c=pe.getNonNullable(r.predicate)(e,i,o);c.isSuccess()?t.showStepSuccess(r.getSuccessMessage()):t.currentReason=y.of(c.getReason())}else if(r.isAnyMove())We.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(r.getSuccessMessage());else{qe(r.isMove(),"cannot reach here with a click step");const i=r;i.acceptedMoves.some(o=>o.equals(e))?(We.display("TutorialGameWrapperComponent","onLegalUserMove","awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(We.display("TutorialGameWrapperComponent","onLegalUserMove","not the move that was awaited."),t.currentReason=y.of(i.getFailureMessage()))}t.cdr.detectChanges()})()}retry(){this.moveAttemptMade=!1,this.showStep(this.stepIndex)}canUserPlay(e){if(this.currentReason=y.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return R.failure(tle.STEP_FINISHED());const t=this.steps[this.stepIndex];return t.isClick()?(this.updateBoardAndShowLastMove(),this.moveAttemptMade=!0,pe.getNonNullable(t.acceptedClicks).some(r=>r===e)?this.showStepSuccess(t.getSuccessMessage()):this.currentMessage=t.getFailureMessage(),R.SUCCESS):t.isMove()||t.isPredicate()||t.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),R.SUCCESS):R.failure(tle.INFORMATIONAL_STEP())}onCancelMove(e){void 0!==e&&(this.currentReason=y.of(e)),this.cdr.detectChanges()}showStepSuccess(e){this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const t of this.stepFinished)t&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return I(function*(){const t=e.steps[e.stepIndex];qe(t.hasSolution(),"step must have solution");const r=t,s=r.getSolution();s instanceof eo?(e.showStep(e.stepIndex),e.gameComponent.node=e.gameComponent.rules.choose(e.gameComponent.node,s).get(),e.updateBoardAndShowLastMove()):(e.showStep(e.stepIndex),window.document.querySelector(s).dispatchEvent(new Event("click"))),e.currentMessage=r.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return I(function*(){const t=pe.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",t])})()}createGame(){var e=this;return I(function*(){const t=pe.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",t])})()}getPlayer(){return"tutorial-player"}};function xdt(n,e){if(1&n&&(O(0,"div",35)(1,"div",36),ve(2,37),A(),O(3,"div",38),wt(4),A()()),2&n){const t=C();T(4),c1(t.errorMessage)}}y7.\u0275fac=function(e){return new(e||y7)(Q(No),Q(Kn),Q(_n),Q(Zu),Q(Q1))},y7.\u0275cmp=ct({type:y7,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let n,e,t,r,s,i,o,c,u;return n=$localize`Failure`,e=$localize`Try again`,t=$localize`Ok`,r=$localize`Continue`,s=$localize`Skip`,i=$localize`Try again`,o=$localize`Play locally`,c=$localize`Create an online game`,u=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],n,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],t,r,s,["id","restartButton",1,"button",3,"click"],i,["id","playLocallyButton",1,"button",3,"click"],o,["id","playOnlineButton",1,"button",3,"click"],c,["id","showSolutionButton",1,"button",3,"click"],u,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(O(0,"div",0)(1,"div",1)(2,"div",2),X(3,"progress",3),O(4,"div",4)(5,"p",5),wt(6),A(),X(7,"p",6),A(),x(8,mdt,4,1,"div",7),O(9,"div",8),x(10,_dt,2,0,"button",9),x(11,Mdt,6,2,"button",10),x(12,Sdt,2,0,"button",11),x(13,Pdt,2,0,"button",12),x(14,Tdt,2,0,"button",13),x(15,wdt,2,0,"button",14),O(16,"div",15)(17,"select",16),J("change",function(s){return t.changeStep(s)}),x(18,Idt,4,2,"ng-container",17),A()()()()(),O(19,"div",18)(20,"div",19),X(21,"div",null,20),A()()()),2&e&&(T(3),z("value",t.successfulSteps)("max",t.getNumberOfSteps()),T(3),VO("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),T(1),w("innerHTML",t.currentMessage,Ou),T(1),w("ngIf",t.currentReason.isPresent()),T(2),w("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),T(1),w("ngIf",!1===t.tutorialOver),T(1),w("ngIf",t.tutorialOver),T(1),w("ngIf",t.tutorialOver),T(1),w("ngIf",t.tutorialOver),T(1),w("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),T(3),w("ngForOf",t.steps),T(1),w("ngClass",t.getBoardHighlight()))},dependencies:[hn,En,Kt,_g,vg],encapsulation:2,changeDetection:0}),y7=function(n,e,t,r){var o,s=arguments.length,i=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,t):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(n,e,t,r);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i}([We.log],y7);const kdt=function(){return["/login"]};let Ldt=(()=>{class n{constructor(t,r){this.connectedUserService=t,this.router=r,this.faEye=AV,this.registrationForm=new W0({email:new $a,username:new $a,password:new $a})}registerWithEmail(){var t=this;return I(function*(){const r=t.registrationForm.value.username,s=t.registrationForm.value.email,i=t.registrationForm.value.password;if(null==r||null==s||null==i)t.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield t.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield t.connectedUserService.sendEmailVerification();c.isSuccess()?yield t.router.navigate(["/verify-account"]):t.errorMessage=c.getReason()}else t.errorMessage=o.getReason()}})()}registerWithGoogle(){var t=this;return I(function*(){const r=yield t.connectedUserService.doGoogleLogin();r.isSuccess()?yield t.router.navigate(["/verify-account"]):t.errorMessage=r.getReason()})()}getPasswordHelpClass(){const t=this.registrationForm.value.password;return null==t||""===t?"":t.length<6?"is-danger":"is-success"}canRegister(){const t=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===t||t.length<6)}}return n.\u0275fac=function(t){return new(t||n)(Q(Q1),Q(Kn))},n.\u0275cmp=ct({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let e,t,r,s,i,o,c,u,h,g,m,M,b,L;return e=$localize`Registering`,t=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,h=$localize`The password should be at least 6 characters long`,g=$localize`Register`,m=$localize`Register with Google`,M=$localize`Have an account?`,b=$localize`Log in`,L=$localize`Registration error`,[[1,"box"],[1,"title"],e,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],h,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],g,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],M,[3,"routerLink"],b,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],L,["id","errorMessage",1,"message-body"]]},template:function(t,r){1&t&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),ve(7,7),A()(),O(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),O(12,"p",12),ve(13,13),A()()()()(),O(14,"div",4)(15,"div",5)(16,"label",14),ve(17,15),A()(),O(18,"div",8)(19,"div",9)(20,"div",10),X(21,"input",16),A()()()(),O(22,"div",4)(23,"div",5)(24,"label",17),ve(25,18),A()(),O(26,"div",8)(27,"div",9)(28,"div",19),X(29,"input",20),O(30,"span",21),X(31,"fa-icon",22),A(),O(32,"p",23),ve(33,24),A()()()()(),O(34,"div",4),X(35,"div",5),O(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),J("click",function(){return r.registerWithEmail()}),ve(40,26),A()()()()(),O(41,"div",4),X(42,"div",5),O(43,"div",27),x(44,xdt,5,1,"div",28),A()(),O(45,"div",4),X(46,"div",5),O(47,"div",8)(48,"button",29),J("click",function(){return r.registerWithGoogle()}),ve(49,30),A()()(),O(50,"p",31),dn(51),ve(52,32),pn(),wt(53,"\xa0 "),O(54,"a",33),ve(55,34),A()()()()),2&t&&(T(3),w("formGroup",r.registrationForm),T(28),w("icon",r.faEye),T(1),w("ngClass",r.getPasswordHelpClass()),T(7),w("disabled",!r.canRegister()),T(5),w("ngIf",r.errorMessage),T(10),w("routerLink",K1(6,kdt)))},dependencies:[hn,Kt,o5,Ju,k4,Ql,Qu,n5,e5,rh,e7,BF,Z4e],encapsulation:2}),n})(),Rdt=(()=>{class n{constructor(t){this.router=t}pickGame(t){this.selectedGame=t}playLocally(){var t=this;return I(function*(){yield t.router.navigate(["local/"+t.selectedGame])})()}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn))},n.\u0275cmp=ct({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(t,r){1&t&&(O(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),J("click",function(){return r.playLocally()}),ve(2,2),A()),2&t&&(T(1),w("disabled",!r.selectedGame))},dependencies:[FF],encapsulation:2}),n})(),Ddt=(()=>{class n{constructor(t){this.router=t}pickGame(t){this.selectedGame=t}launchTutorial(){var t=this;return I(function*(){yield t.router.navigate(["/tutorial/",t.selectedGame])})()}}return n.\u0275fac=function(t){return new(t||n)(Q(Kn))},n.\u0275cmp=ct({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let e;return e=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],e]},template:function(t,r){1&t&&(O(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),A(),O(1,"button",1),J("click",function(){return r.launchTutorial()}),ve(2,2),A()),2&t&&(T(1),w("disabled",!r.selectedGame))},dependencies:[FF],encapsulation:2}),n})(),zdt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=ct({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let e;return e=$localize`The replay game is loading, please wait, it should not take long.`,[e]},template:function(t,r){1&t&&(O(0,"p"),ve(1,0),A())},encapsulation:2}),n})();function Vdt(n,e){if(1&n&&(V(),X(0,"polygon",4)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("points",t.MartianChessQueenComponent.HEPTAGON)}}function Fdt(n,e){if(1&n&&(V(),X(0,"polygon",4)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("points",t.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Bdt(n,e){if(1&n&&(V(),X(0,"circle",5)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function $dt(n,e){if(1&n&&(dn(0),V(),X(1,"circle",6)(2,"circle",6)(3,"circle",6),pn()),2&n){const t=C();T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(3)),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function Gdt(n,e){if(1&n&&(V(),O(0,"g"),X(1,"circle",7)(2,"circle",7)(3,"circle",7),A()),2&n){const t=C();T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.45*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),T(1),z("cx",.45*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),T(1),z("cx",.55*t.MartianChessComponent.SPACE_SIZE)("cy",.55*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function Udt(n,e){if(1&n&&(V(),O(0,"g",8),X(1,"circle",9)(2,"circle",9)(3,"circle",9),A()),2&n){const t=C();w("ngClass",t.pieceClasses),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE-3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE+3*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}class B6{constructor(){this.MartianChessQueenComponent=B6,this.MartianChessComponent=Uo,this.horizontalDotsRadius=Uo.SPACE_SIZE/15}}function Wdt(n,e){if(1&n&&(V(),X(0,"polygon",4)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("points",t.MartianChessDroneComponent.PENTAGON)}}function jdt(n,e){if(1&n&&(V(),X(0,"polygon",4)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("points",t.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function Zdt(n,e){if(1&n&&(V(),X(0,"circle",5)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function Ydt(n,e){if(1&n&&(dn(0),V(),X(1,"circle",6)(2,"circle",6),pn()),2&n){const t=C();T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(2)),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",t.MartianChessComponent.getRadius(1))}}function Kdt(n,e){if(1&n&&(V(),O(0,"g",7),X(1,"circle",8)(2,"circle",8),A()),2&n){const t=C();w("ngClass",t.pieceClasses),T(1),z("cx",.4*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE),T(1),z("cx",.6*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function Xdt(n,e){if(1&n&&(V(),O(0,"g",7),X(1,"circle",9)(2,"circle",9),A()),2&n){const t=C();w("ngClass",t.pieceClasses),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE-2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE+2*t.horizontalDotsRadius)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}B6.HEPTAGON=Uo.getRegularPolygon(7),B6.EIGHT_POINTED_STAR=Uo.getNPointedStar(8,0),B6.\u0275fac=function(e){return new(e||B6)},B6.\u0275cmp=ct({type:B6,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(x(0,Vdt,1,3,"polygon",0),x(1,Fdt,1,3,"polygon",0),x(2,Bdt,1,5,"circle",1),x(3,$dt,4,9,"ng-container",2),x(4,Gdt,4,9,"g",2),x(5,Udt,4,10,"g",3)),2&e&&(w("ngIf","Polygon"===t.style.shape),T(1),w("ngIf","Star"===t.style.shape),T(1),w("ngIf","Circle"===t.style.shape),T(1),w("ngIf","Concentric Circles"===t.style.points),T(1),w("ngIf","Dots"===t.style.points),T(1),w("ngIf","Horizontal Points"===t.style.points))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class $6{constructor(){this.MartianChessComponent=Uo,this.MartianChessDroneComponent=$6,this.horizontalDotsRadius=Uo.SPACE_SIZE/15}}function Jdt(n,e){if(1&n&&(V(),X(0,"polygon",5)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("points",t.MartianChessPawnComponent.TRIANGLE)}}function ept(n,e){if(1&n&&(V(),X(0,"polygon",5)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("points",t.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function tpt(n,e){if(1&n&&(V(),X(0,"circle",6)),2&n){const t=C();w("id",t.mainShapeId)("ngClass",t.pieceClasses),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.5*t.MartianChessComponent.SPACE_SIZE-t.MartianChessComponent.STROKE_WIDTH)}}function npt(n,e){if(1&n&&(V(),X(0,"circle",7)),2&n){const t=C();z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE+t.getConcreteTriangleYOffset())("r",t.MartianChessComponent.getRadius(1))}}function rpt(n,e){if(1&n&&(V(),X(0,"circle",8)),2&n){const t=C();z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",.2/3*t.MartianChessComponent.SPACE_SIZE)}}function spt(n,e){if(1&n&&(V(),O(0,"g",9),X(1,"circle",10),A()),2&n){const t=C();w("ngClass",t.pieceClasses),T(1),z("cx",.5*t.MartianChessComponent.SPACE_SIZE)("cy",.5*t.MartianChessComponent.SPACE_SIZE)("r",1.5*t.horizontalDotsRadius)}}$6.FOUR_POINTED_STAR_VERTICAL=Uo.getNPointedStar(4,0),$6.PENTAGON=Uo.getRegularPolygon(5),$6.\u0275fac=function(e){return new(e||$6)},$6.\u0275cmp=ct({type:$6,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(x(0,Wdt,1,3,"polygon",0),x(1,jdt,1,3,"polygon",0),x(2,Zdt,1,5,"circle",1),x(3,Ydt,3,6,"ng-container",2),x(4,Kdt,3,7,"g",3),x(5,Xdt,3,7,"g",3)),2&e&&(w("ngIf","Polygon"===t.style.shape),T(1),w("ngIf","Star"===t.style.shape),T(1),w("ngIf","Circle"===t.style.shape),T(1),w("ngIf","Concentric Circles"===t.style.points),T(1),w("ngIf","Dots"===t.style.points),T(1),w("ngIf","Horizontal Points"===t.style.points))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Ta{constructor(){this.MartianChessComponent=Uo,this.MartianChessPawnComponent=Ta,this.horizontalDotsRadius=Uo.SPACE_SIZE/15}static getTriangle(){return Uo.getRegularPolygon(3,Ta.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const t=Uo.getRegularPolygonCoords(3).map(u=>u.y);return(t.reduce((u,h)=>Math.min(u,h))+(100-t.reduce((u,h)=>Math.max(u,h))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?Ta.TRIANGLE_Y_OFFSET:0}}function opt(n,e){if(1&n&&(V(),X(0,"text",8)),2&n){const t=C();j2("id","height_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),w("innerHTML",t.coord.z,Ou)}}function apt(n,e){if(1&n&&(V(),X(0,"polyline",9)),2&n){const t=C();w("ngClass",t.pieceClasses),z("points",t.getUpperHorizontalLine())}}function cpt(n,e){if(1&n&&(V(),O(0,"g"),X(1,"polyline",10)(2,"polyline",11),A()),2&n){const t=C();T(1),w("ngClass",t.pieceClasses),z("points",t.getMiddleHorizontalLine()),T(1),w("ngClass",t.pieceClasses),z("points",t.getLowerHorizontalLine())}}function lpt(n,e){if(1&n&&(V(),X(0,"polyline",12)),2&n){const t=C();w("ngClass",t.pieceClasses),z("points",t.getLeftDiagonalLine())}}function upt(n,e){if(1&n&&(V(),O(0,"g"),X(1,"polyline",13)(2,"polyline",14),A()),2&n){const t=C();T(1),w("ngClass",t.pieceClasses),z("points",t.getMiddleDiagonalLine()),T(1),w("ngClass",t.pieceClasses),z("points",t.getRighterDiagonalLine())}}function fpt(n,e){if(1&n&&(V(),X(0,"polyline",15)),2&n){const t=C();w("ngClass",t.pieceClasses),z("points",t.getLeftVerticalLine())}}function hpt(n,e){if(1&n&&(V(),X(0,"polyline",16)),2&n){const t=C();w("ngClass",t.pieceClasses),z("points",t.getMiddleVerticalLine())}}function dpt(n,e){if(1&n&&(V(),X(0,"polyline",17)),2&n){const t=C();w("ngClass",t.pieceClasses),z("points",t.getRighterVerticalLine())}}Ta.FOUR_POINTED_STAR_DIAGONAL=Uo.getNPointedStar(4,45),Ta.TRIANGLE_Y_OFFSET=Ta.yOffsetForVerticalCentering(),Ta.TRIANGLE=Ta.getTriangle(),Ta.\u0275fac=function(e){return new(e||Ta)},Ta.\u0275cmp=ct({type:Ta,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(x(0,Jdt,1,3,"polygon",0),x(1,ept,1,3,"polygon",0),x(2,tpt,1,5,"circle",1),x(3,npt,1,3,"circle",2),x(4,rpt,1,3,"circle",3),x(5,spt,2,4,"g",4)),2&e&&(w("ngIf","Polygon"===t.style.shape),T(1),w("ngIf","Star"===t.style.shape),T(1),w("ngIf","Circle"===t.style.shape),T(1),w("ngIf","Concentric Circles"===t.style.points),T(1),w("ngIf","Dots"===t.style.points),T(1),w("ngIf","Horizontal Points"===t.style.points))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class R9{mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(e=>"victory-stroke"===e)||this.pieceClasses.some(e=>"last-move-stroke"===e)}get3DIsoSquarePoints(){const e=this.getParallelogramPoints();return this.mapCoordToPoints([e[0],e[1],e[4],e[6],e[5],e[2],e[0]])}getParallelogramPoints(){const e=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,t=this.mode.parallelogramHeight,r=this.mode.offsetRatio*this.mode.parallelogramHeight,s=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,i=e,c=e-r,u=t,h=-r,g=t;return[new S(0,0),new S(i,0),new S(h,g),new S(c,u),new S(i,0+s),new S(h,g+s),new S(c,u+s)]}mapCoordToPoints(e){return e.map(t=>t.x+" "+t.y).join(" ")}getUpperHorizontalLineCoords(){const e=this.getParallelogramPoints(),t=e[0],r=e[1],i=new Bt(-1*this.mode.offsetRatio*C1.STROKE_WIDTH,C1.STROKE_WIDTH),o=t.getNext(i),c=r.getNext(i);return[t,r,c,o]}getUpperHorizontalLine(){const e=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(e)}getMiddleHorizontalCoords(){const e=this.getParallelogramPoints(),t=e[2],r=e[3],i=new Bt(-1*this.mode.offsetRatio*C1.STROKE_WIDTH,C1.STROKE_WIDTH);return[t.getNext(i,-1),r.getNext(i,-1),r,t]}getMiddleHorizontalLine(){const e=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(e)}getLowerHorizontalLine(){const e=this.getParallelogramPoints(),t=e[5],r=e[6],s=new Bt(0,C1.STROKE_WIDTH),i=t.getNext(s,-1),o=r.getNext(s,-1);return this.mapCoordToPoints([i,o,r,t])}getLeftDiagonalLine(){const e=this.getParallelogramPoints(),t=e[0],r=e[2],i=new Bt(C1.STROKE_WIDTH,0),o=t.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([t,o,c,r])}getMiddleDiagonalLine(){const e=this.getParallelogramPoints(),t=e[1],r=e[3],i=new Bt(C1.STROKE_WIDTH,0),o=t.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,t,r,c])}getRighterDiagonalLine(){const e=this.getParallelogramPoints(),t=e[4],r=e[6],i=new Bt(0,C1.STROKE_WIDTH),o=t.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,t,r,c])}getLeftVerticalLine(){const e=this.getParallelogramPoints(),t=e[2],r=e[5],i=new Bt(C1.STROKE_WIDTH,0),o=t.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([t,o,c,r])}getMiddleVerticalLine(){const e=this.getParallelogramPoints(),t=e[3],r=e[6],i=new Bt(C1.STROKE_WIDTH,0),o=t.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,t,r,c])}getRighterVerticalLine(){const e=this.getParallelogramPoints(),t=e[1],r=e[4],o=new Bt(C1.STROKE_WIDTH,-C1.STROKE_WIDTH/this.mode.offsetRatio),c=t.getNext(o,-1),u=r.getNext(o,-1);return this.mapCoordToPoints([c,t,r,u])}getOtherCoord(){qe(null!=this.move,"Move should be set before calling getOtherCoord");const e=this.move;return e.getZero().equals(this.coord)?e.getOne():e.getZero()}isLeftHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x-1}}isRightHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.x===e.x+1}}isTopHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y-1}}isBottomHalf(){if(null==this.move)return!1;{const e=this.getOtherCoord();return this.coord.y===e.y+1}}}R9.STROKE_OFFSET=C1.STROKE_WIDTH/2,R9.\u0275fac=function(e){return new(e||R9)},R9.\u0275cmp=ct({type:R9,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(e,t){1&e&&(V(),X(0,"polyline",0),x(1,opt,1,4,"text",1),x(2,apt,1,2,"polyline",2),x(3,cpt,3,4,"g",3),x(4,lpt,1,2,"polyline",4),x(5,upt,3,4,"g",3),x(6,fpt,1,2,"polyline",5),x(7,hpt,1,2,"polyline",6),x(8,dpt,1,2,"polyline",7)),2&e&&(j2("id","tile_",t.coord.x,"_",t.coord.y,"_",t.coord.z,""),w("ngClass",t.pieceClasses),z("points",t.get3DIsoSquarePoints()),T(1),w("ngIf",t.mustDisplayHeight),T(1),w("ngIf",!1===t.isBottomHalf()||t.mustForceStrokeDisplay()),T(1),w("ngIf",!1===t.isTopHalf()||t.mustForceStrokeDisplay()),T(1),w("ngIf",!1===t.isRightHalf()||t.mustForceStrokeDisplay()),T(1),w("ngIf",!1===t.isLeftHalf()||t.mustForceStrokeDisplay()),T(1),w("ngIf",t.isBottomHalf()||t.isLeftHalf()||t.mustForceStrokeDisplay()),T(1),w("ngIf",t.isBottomHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()),T(1),w("ngIf",t.isTopHalf()||t.isRightHalf()||t.mustForceStrokeDisplay()))},dependencies:[hn,Kt],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%], .last-move-fill[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const Z__firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let $F=(()=>{class n{constructor(t){this.connectedUserService=t}canActivate(){var t=this;return I(function*(){const r=yield new Promise(s=>{t.userSubscription=t.connectedUserService.subscribeToUser(function(){var i=I(function*(o){return s(yield t.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return t.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(t){return new(t||n)(De(Q1))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),D9=(()=>{class n extends $F{constructor(t,r){super(t),this.router=r}static evaluateUserPermission(t,r){return I(function*(){return!1===r.isConnected()?t.parseUrl("/login"):!1!==r.verified||t.parseUrl("/verify-account")})()}evaluateUserPermission(t){var r=this;return I(function*(){return n.evaluateUserPermission(r.router,t)})()}}return n.\u0275fac=function(t){return new(t||n)(De(Q1),De(Kn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),GF=(()=>{class n{constructor(t,r){this.currentGameService=t,this.router=r,this.currentGameSubscription=y.empty()}canActivate(t){var r=this;return I(function*(){const s=yield r.currentGameService.getCurrentGame();if(s.isAbsent())return!0;const i=s.get();return t.params.id===i.id||r.router.parseUrl("/play/"+i.typeGame+"/"+i.id)})()}}return n.\u0275fac=function(t){return new(t||n)(De(I2),De(Kn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ppt=(()=>{class n extends $F{constructor(t,r){super(t),this.router=r}evaluateUserPermission(t){var r=this;return I(function*(){return!1===t.isConnected()?r.router.parseUrl("/login"):!t.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(t){return new(t||n)(De(Q1),De(Kn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gpt=(()=>{class n extends $F{constructor(t,r){super(t),this.router=r}evaluateUserPermission(t){var r=this;return I(function*(){return!1===t.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(t){return new(t||n)(De(Q1),De(Kn))},n.\u0275prov=nt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function mpt(n,e){1&n&&(O(0,"p",20),ve(1,21),A())}function _pt(n,e){if(1&n){const t=Oe();O(0,"div",7)(1,"p",8),ve(2,9),A(),O(3,"div",10)(4,"p",11),ve(5,12),A(),O(6,"button",13),J("click",function(){return he(t),ce(C().finalizeEmailVerification())}),ve(7,14),A()(),O(8,"div",15)(9,"p",11),ve(10,16),A(),O(11,"button",17),J("click",function(){return he(t),ce(C().sendEmailVerification())}),ve(12,18),A()(),x(13,mpt,2,0,"p",19),A()}if(2&n){const t=C();T(2),M1(t.emailAddress),A1(2),T(11),w("ngIf",t.success)}}function vpt(n,e){if(1&n){const t=Oe();O(0,"div",24)(1,"div",8),ve(2,25),A(),O(3,"form",26)(4,"div",27)(5,"div",28),X(6,"input",29),A(),O(7,"div",28)(8,"button",30),J("click",function(){he(t);const s=C(2);return ce(s.pickUsername(s.usernameForm.value))}),ve(9,31),A()()()()()}if(2&n){const t=C(2);T(3),w("formGroup",t.usernameForm)}}const Cpt=function(){return["/lobby"]};function ypt(n,e){1&n&&(O(0,"div",32),ca(1,33),X(2,"a",34),la(),A()),2&n&&(T(2),w("routerLink",K1(1,Cpt)))}function Ept(n,e){if(1&n&&(dn(0),x(1,vpt,10,1,"div",22),x(2,ypt,3,2,"div",23),pn()),2&n){const t=C();T(1),w("ngIf",!t.success),T(1),w("ngIf",t.success)}}function Mpt(n,e){if(1&n&&(O(0,"div",35)(1,"div",36),wt(2),A()()),2&n){const t=C();T(2),c1(t.errorMessage)}}let Spt=(()=>{class n{constructor(t,r){this.connectedUserService=t,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new W0({username:new $a})}ngOnInit(){var t=this;return I(function*(){t.userSubscription=t.connectedUserService.subscribeToUser(function(){var r=I(function*(s){t.emailAddress=s.email.get(),s.username.isAbsent()?t.verificationType="enter-username":(t.verificationType="send-email",!0===t.triedToFinalize&&!1===s.verified&&(t.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield t.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(t){var r=this;return I(function*(){const s=yield r.connectedUserService.setUsername(t.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var t=this;return I(function*(){const r=yield t.connectedUserService.sendEmailVerification();r.isSuccess()?t.success=!0:t.errorMessage=r.getReason()})()}finalizeEmailVerification(){var t=this;return I(function*(){t.triedToFinalize=!0,yield t.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(Q(Q1),Q(Kn))},n.\u0275cmp=ct({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let e,t,r,s,i,o,c,u,h,g,m;return e=$localize`Account verification`,t=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,h=$localize`Username`,g=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],e,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],t,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",h,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],g,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(t,r){1&t&&(O(0,"div",0)(1,"div",1)(2,"div",2),ve(3,3),A(),x(4,_pt,14,2,"div",4),x(5,Ept,3,2,"ng-container",5),A(),x(6,Mpt,3,1,"div",6),A()),2&t&&(T(4),w("ngIf","send-email"===r.verificationType),T(1),w("ngIf","enter-username"===r.verificationType),T(1),w("ngIf",r.errorMessage))},dependencies:[Kt,o5,Ju,k4,Ql,Qu,n5,e5,rh],encapsulation:2}),n})();function Ppt(n,e){1&n&&(O(0,"p",17),ve(1,18),A())}function Tpt(n,e){if(1&n&&(O(0,"div",19)(1,"div",20),ve(2,21),A(),O(3,"div",22),wt(4),A()()),2&n){const t=C();T(4),c1(t.errorMessage.get())}}const wpt=function(){return{standalone:!0}};let bpt=(()=>{class n{constructor(t){this.connectedUserService=t,this.success=!1,this.errorMessage=y.empty(),this.email=""}resetPassword(){var t=this;return I(function*(){qe(""!==t.email,"No email was entered, but it should not be possible to submit the form then!"),t.errorMessage=y.empty(),t.success=!1;const r=yield t.connectedUserService.sendPasswordResetEmail(t.email);r.isSuccess()?t.success=!0:t.errorMessage=y.of(r.getReason())})()}}return n.\u0275fac=function(t){return new(t||n)(Q(Q1))},n.\u0275cmp=ct({type:n,selectors:[["app-reset-password"]],decls:17,vars:6,consts:function(){let e,t,r,s,i,o,c;return e=$localize`Password reset`,t=$localize`Email`,r=$localize`Email`,s=$localize`An email will be sent with instruction to reset your password.`,i=$localize`Reset password`,o=$localize`The email has been sent, please follow the instructions from that email.`,c=$localize`Error`,[[1,"box"],[1,"title"],e,[1,"field","is-horizontal"],[1,"field-label","is-normal"],["for","email",1,"label"],t,[1,"field-body"],[1,"field"],[1,"control"],["id","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],s,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],i,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],o,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],c,["id","errorMessage",1,"message-body"]]},template:function(t,r){1&t&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"div",3)(4,"div",4)(5,"label",5),ve(6,6),A()(),O(7,"div",7)(8,"div",8)(9,"div",9)(10,"input",10),J("ngModelChange",function(i){return r.email=i}),A(),O(11,"p",11),ve(12,12),A(),x(13,Ppt,2,0,"p",13),A()()()(),O(14,"button",14),J("click",function(){return r.resetPassword()}),ve(15,15),A(),x(16,Tpt,5,1,"div",16),A()),2&t&&(T(10),w("ngModel",r.email)("ngModelOptions",K1(5,wpt)),T(3),w("ngIf",r.success),T(1),w("disabled",""===r.email),T(2),w("ngIf",r.errorMessage.isPresent()))},dependencies:[Kt,k4,Ql,n5,mg,BF],encapsulation:2}),n})();function Opt(n,e){if(1&n&&(O(0,"option",13),wt(1),A()),2&n){const t=e.$implicit,r=C();w("value",t.value)("selected",t.value===r.currentTheme),T(1),Ri(" ",t.name," ")}}function Apt(n,e){if(1&n&&(O(0,"option",13),wt(1),A()),2&n){const t=e.$implicit,r=C();w("value",t.value)("selected",t.value===r.currentLanguage),T(1),Ri(" ",t.name," ")}}let Npt=(()=>{class n{constructor(t,r){this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(t){this.userSettingsService.changeLanguage(t.target.value),this.reload()}changeTheme(t){this.userSettingsService.changeTheme(t.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(t){return new(t||n)(Q(e1e),Q(_P))},n.\u0275cmp=ct({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let e,t,r;return e=$localize`User settings`,t=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],e,[1,"field"],["for","theme",1,"label"],t,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(t,r){1&t&&(O(0,"div",0)(1,"p",1),ve(2,2),A(),O(3,"div",3)(4,"label",4),ve(5,5),A(),O(6,"div",6)(7,"div",7)(8,"select",8),J("change",function(i){return r.changeTheme(i)}),x(9,Opt,2,3,"option",9),A()()()(),O(10,"div",3)(11,"label",10),ve(12,11),A(),O(13,"div",6)(14,"div",7)(15,"select",12),J("change",function(i){return r.changeLanguage(i)}),x(16,Apt,2,3,"option",9),A()()()()()),2&t&&(T(9),w("ngForOf",r.availableThemes),T(7),w("ngForOf",r.availableLanguages))},dependencies:[En,_g,vg],encapsulation:2}),n})(),Ipt=(()=>{class n{constructor(t,r,s,i,o,c){this.route=t,this.router=r,this.connectedUserService=s,this.currentGameService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var t=this;return I(function*(){yield t.createGameAndRedirectOrShowError(t.extractGameFromURL())})()}extractGameFromURL(){return pe.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(t){var r=this;return I(function*(){if(qe(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(t))return yield r.router.navigate(["/notFound",g7.NO_MATCHING_GAME(t)],{skipLocationChange:!0}),!1;const i=r.currentGameService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(t);return yield r.router.navigate(["/play",t,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(t){return y.ofNullable(k9.ALL_GAMES().find(s=>s.urlName===t)).isPresent()}}return n.\u0275fac=function(t){return new(t||n)(Q(No),Q(Kn),Q(Q1),Q(I2),Q(_n),Q(z3))},n.\u0275cmp=ct({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let e;return e=$localize`Creating online game, please wait, it should not take long.`,[e]},template:function(t,r){1&t&&(O(0,"p"),ve(1,0),A())},encapsulation:2}),n})();!function Aue(n,e,t){(function r6e(n,e,t){"string"!=typeof e&&(t=e,e=n[Ct.LocaleId]),e=e.toLowerCase().replace(/_/g,"-"),Qf[e]=n,t&&(Qf[e][Ct.ExtraData]=t)})(n,e,t)}(Zpe);const xpt=[{path:"login",component:fht},{path:"lobby",component:m7,canActivate:[D9]},{path:"account",component:Nht,canActivate:[D9]},{path:"settings",component:Npt},{path:"register",component:Ldt,canActivate:[gpt]},{path:"reset-password",component:bpt},{path:"notFound/:message",component:K4e},{path:"nextGameLoading",component:zdt,canActivate:[D9]},{path:"verify-account",component:Spt,canActivate:[ppt]},{path:"play",component:Y4e,canActivate:[D9,GF]},{path:"play/:compo",component:Ipt,canActivate:[D9,GF]},{path:"play/:compo/:id",component:v7,canActivate:[D9,GF]},{path:"local",component:Rdt},{path:"local/:compo",component:C7},{path:"tutorial",component:Ddt},{path:"tutorial/:compo",component:y7},{path:"",component:Jft},{path:"demo",component:aht},{path:"**",component:K4e}];class UF{static app(){return function aPe(n,...e){return{ngModule:oPe,providers:[{provide:gD,useFactory:iPe(n),multi:!0,deps:[Er,ii,dD,...e]}]}}(()=>cPe(Z__firebaseConfig))}static firestore(){return function oOe(n,...e){return{ngModule:iOe,providers:[{provide:IH,useFactory:nOe(n),multi:!0,deps:[Er,ii,dD,pD,[new si,pne],[new si,kD],...e]}]}}(()=>{const e=dOe();e.toJSON();return e})}static auth(){return function Ube(n,...e){return{ngModule:Gbe,providers:[{provide:NH,useFactory:Fbe(n),multi:!0,deps:[Er,ii,dD,pD,[new si,kD],...e]}]}}(()=>{const e=jbe();return e})}}let kpt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=ei({type:n,bootstrap:[D4t]}),n.\u0275inj=$r({providers:[Q1,z3,LH,D3,i9,L3,_P,{provide:N4,useValue:c_.getLocale()}],imports:[UF.app(),UF.firestore(),UF.auth(),Hq,Mfe,F9e.forRoot(xpt,{useHash:!1}),jW,ofe,Wpe,QHe]}),n})();tu(Uo,function(){return[hn,En,Kt,B6,$6,Ta]},[]),tu(C1,function(){return[hn,En,Kt,R9]},[]);var Lpt=lc(7742);function nle(){(function M8e(){zU=!1})(),K5e().bootstrapModule(kpt).catch(n=>console.error(n))}const rle=c_.getLocale();"en"!==rle?fetch("/assets/"+rle+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,Lpt.XJ)(n.translations),$localize.locale=n.locale,nle()}).catch(function(n){console.log(n)}):nle()},2486:function(z9,M7){!function(lc){"use strict";function ln(mt,ft){var rn=Object.keys(mt);if(Object.getOwnPropertySymbols){var o1=Object.getOwnPropertySymbols(mt);ft&&(o1=o1.filter(function(Ls){return Object.getOwnPropertyDescriptor(mt,Ls).enumerable})),rn.push.apply(rn,o1)}return rn}function ts(mt){for(var ft,rn=1;rn<arguments.length;rn++)ft=arguments[rn]??{},rn%2?ln(Object(ft),!0).forEach(function(o1){W8(mt,o1,ft[o1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(mt,Object.getOwnPropertyDescriptors(ft)):ln(Object(ft)).forEach(function(o1){Object.defineProperty(mt,o1,Object.getOwnPropertyDescriptor(ft,o1))});return mt}function n4(mt,ft){if(!(mt instanceof ft))throw new TypeError("Cannot call a class as a function")}function t3(mt,ft){for(var rn,o1=0;o1<ft.length;o1++)(rn=ft[o1]).enumerable=rn.enumerable||!1,rn.configurable=!0,"value"in rn&&(rn.writable=!0),Object.defineProperty(mt,rn.key,rn)}function I1(mt,ft,rn){return ft&&t3(mt.prototype,ft),rn&&t3(mt,rn),mt}function W8(mt,ft,rn){return ft in mt?Object.defineProperty(mt,ft,{value:rn,enumerable:!0,configurable:!0,writable:!0}):mt[ft]=rn,mt}function n3(){var mt;return null!==(mt=ml)&&void 0!==mt?mt:document}var r4={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},ho=ts({},r4),Ks={},ml=null,H9=function(mt,ft,rn,o1,Ls){return"top-left"===mt?"left:".concat(o1,";top:").concat(ft,";text-align:left;align-items:flex-start;"):"top-right"===mt?"right:".concat(Ls,";top:").concat(ft,";text-align:right;align-items:flex-end;"):"top-center"===mt?"top:".concat(ft,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===mt?"left:".concat(o1,";bottom:").concat(rn,";text-align:left;align-items:flex-start;"):"bottom-right"===mt?"right:".concat(Ls,";bottom:").concat(rn,";text-align:right;align-items:flex-end;"):"bottom-center"===mt?"bottom:".concat(rn,";left:0;right:0;text-align:center;align-items:center;"):"center"===mt?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},j8=function(){function mt(ft){var rn=this;n4(this,mt),this.element=n3().createElement("div"),this.opacity=ft.opacity,this.type=ft.type,this.animate=ft.animate,this.dismissible=ft.dismissible,this.closeOnClick=ft.closeOnClick,this.message=ft.message,this.duration=ft.duration,this.pauseOnHover=ft.pauseOnHover,this.offsetTop=ft.offsetTop,this.offsetBottom=ft.offsetBottom,this.offsetLeft=ft.offsetLeft,this.offsetRight=ft.offsetRight,this.extraClasses=ft.extraClasses;var o1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),Ls=["notification",this.extraClasses];if(this.type&&Ls.push(this.type),this.animate&&this.animate.in){var In="animate__".concat(this.animate.in),rr=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";Ls.push("animate__animated ".concat(In," ").concat(rr)),this.onAnimationEnd(function(){return rn.element.classList.remove(In)})}if(this.element.className=Ls.join(" "),this.dismissible){var s4=n3().createElement("button");s4.className="delete",s4.addEventListener("click",function(){rn.destroy()}),this.element.insertAdjacentElement("afterbegin",s4)}else o1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){rn.destroy()}),this.element.setAttribute("style",o1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var S7=new s3(function(){rn.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){S7.pause()}),this.element.addEventListener("mouseout",function(){S7.resume()}))}return I1(mt,[{key:"destroy",value:function(){var ft=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){ft.removeParent(ft.element.parentNode),ft.element.remove(),delete Ks.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete Ks.position)}},{key:"removeParent",value:function(ft){ft&&1>=ft.children.length&&ft.remove()}},{key:"onAnimationEnd",value:function(){var ft=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},rn={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var o1 in rn)if(void 0!==this.element.style[o1]){this.element.addEventListener(rn[o1],function(){return ft()});break}}}]),mt}(),s3=function(){function mt(ft,rn){n4(this,mt),this.remaining=rn,this.callback=ft,this.resume()}return I1(mt,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),mt}();lc.resetDefaults=function(){ho=ts({},r4)},lc.setDefaults=function(mt){ho=ts(ts({},r4),mt)},lc.setDoc=function uc(mt){for(var ft in Ks)Ks[ft].remove();Ks={},ml=mt},lc.toast=function r3(mt){if(!mt.message)throw new Error("message is required");var ft=ts(ts({},ho),mt),rn=new j8(ft),o1=function vn(mt,ft,rn,o1,Ls,In){if(Ks.position)return Ks.position;var rr=n3().createElement("div");return rr.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+H9(ft,rn,o1,Ls,In)),mt.appendChild(rr),Ks.position=rr,rr}(ft.appendTo||n3().body,ft.position||ho.position,ft.offsetTop||ho.offsetTop,ft.offsetBottom||ho.offsetBottom,ft.offsetLeft||ho.offsetLeft,ft.offsetRight||ho.offsetRight);if(ft.single)for(var Ls=o1.lastElementChild;Ls;)o1.removeChild(Ls),Ls=o1.lastElementChild;o1.appendChild(rn.element)},Object.defineProperty(lc,"__esModule",{value:!0})}(M7)},7742:(z9,M7,lc)=>{"use strict";lc.d(M7,{XJ:()=>Uu,pQ:()=>Hy,Q:()=>kO});class Cn{constructor(a){this.digits=a}static zero(){return new Cn([0])}static one(){return new Cn([1])}clone(){return new Cn(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let p=0;p<l;p++){let _=f;p<this.digits.length&&(_+=this.digits[p]),p<a.digits.length&&(_+=a.digits[p]),_>=10?(this.digits[p]=_-10,f=1):(this.digits[p]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class w7{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=Cn.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const p=this.getMultipliedByPowerOfTwo(f);l.addToSelf(p)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class jF{constructor(a){this.base=a,this.exponents=[new w7(Cn.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new w7(f)}return this.exponents[a]}}function tv(d){const a=function F2(d){let a=[];for(let l=0;l<d.length;l++){let f=d.charCodeAt(l);if(f>=55296&&f<=56319&&d.length>l+1){const p=d.charCodeAt(l+1);p>=56320&&p<=57343&&(l++,f=(f-55296<<10)+p-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(d);let l=jT(a,0),f=jT(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function jT(d,a){let p,l=2654435769,f=2654435769;const _=d.length;for(p=0;p+12<=_;p+=12){l=e2(l,W6(d,p,Br.Little)),f=e2(f,W6(d,p+4,Br.Little));const E=ZT(l,f,a=e2(a,W6(d,p+8,Br.Little)));l=E[0],f=E[1],a=E[2]}return l=e2(l,W6(d,p,Br.Little)),f=e2(f,W6(d,p+4,Br.Little)),a=e2(a,_),ZT(l,f,a=e2(a,W6(d,p+8,Br.Little)<<8))[2]}function ZT(d,a,l){return d=Xs(d,a),d=Xs(d,l),d^=l>>>13,a=Xs(a,l),a=Xs(a,d),a^=d<<8,l=Xs(l,d),l=Xs(l,a),l^=a>>>13,d=Xs(d,a),d=Xs(d,l),d^=l>>>12,a=Xs(a,l),a=Xs(a,d),a^=d<<16,l=Xs(l,d),l=Xs(l,a),l^=a>>>5,d=Xs(d,a),d=Xs(d,l),d^=l>>>3,a=Xs(a,l),a=Xs(a,d),a^=d<<10,l=Xs(l,d),l=Xs(l,a),[d,a,l^=a>>>15]}var Br=(()=>((Br=Br||{})[Br.Little=0]="Little",Br[Br.Big=1]="Big",Br))();function e2(d,a){return YT(d,a)[1]}function YT(d,a){const l=(65535&d)+(65535&a),f=(d>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function Xs(d,a){const l=(65535&d)-(65535&a);return(d>>16)-(a>>16)+(l>>16)<<16|65535&l}function rv(d,a){return a>=d.length?0:d[a]}function W6(d,a,l){let f=0;if(l===Br.Big)for(let p=0;p<4;p++)f+=rv(d,a+p)<<24-8*p;else for(let p=0;p<4;p++)f+=rv(d,a+p)<<8*p;return f}const U9=new jF(256);function ky(d,a,l,f,p=[]){const _={},E={},N={},D=function Ly(d,a){const{text:l,block:f}=Zf(d,a);if(void 0===f)return{text:l};{const[p,..._]=f.split("\u241f"),[E,N]=p.split("@@",2);let[D,F]=E.split("|",2);return void 0===F&&(F=D,D=void 0),""===F&&(F=void 0),{text:l,meaning:D,description:F,customId:N,legacyIds:_}}}(d[0],d.raw[0]),F=[D.text],q=[];let se=D.text;for(let He=1;He<d.length;He++){const{messagePart:Et,placeholderName:ot=P3(He),associatedMessageId:yt}=Ry(d[He],d.raw[He]);se+=`{$${ot}}${Et}`,void 0!==a&&(_[ot]=a[He-1],E[ot]=p[He-1]),q.push(ot),void 0!==yt&&(N[ot]=yt),F.push(Et)}const Te=D.customId||function nv(d,a=""){let l=tv(d);if(a){const _=tv(a);l=function KT(d,a){const l=d[0],p=a[0],E=YT(d[1],a[1]),N=E[0],D=E[1];return[e2(e2(l,p),N),D]}(function KF(d,a){const l=d[0],f=d[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function ov(d,a){const l=U9.toThePowerOf(0).multiplyBy(a);return U9.toThePowerOf(4).multiplyByAndAddTo(d,l),l.toString()}(2147483647&l[0],l[1])}(se,D.meaning||""),Ve=D.legacyIds?D.legacyIds.filter(He=>He!==Te):[];return{id:Te,legacyIds:Ve,substitutions:_,substitutionLocations:E,text:se,customId:D.customId,meaning:D.meaning||"",description:D.description||"",messageParts:F,messagePartLocations:f,placeholderNames:q,associatedMessageIds:N,location:l}}function Ry(d,a){const{text:l,block:f}=Zf(d,a);if(void 0===f)return{messagePart:l};{const[p,_]=f.split("@@");return{messagePart:l,placeholderName:p,associatedMessageId:_}}}function Zf(d,a){if(":"!==a.charAt(0))return{text:d};{const l=Gu(d,a);return{block:d.substring(1,l),text:d.substring(l+1)}}}function P3(d){return 1===d?"PH":"PH_"+(d-1)}function Gu(d,a){for(let l=1,f=1;l<d.length;l++,f++)if("\\"===a[f])f++;else if(":"===d[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class Yf extends Error{constructor(a){super(`No translation found for ${zy(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function Dy(d,a){return Object.defineProperty(d,"raw",{value:a}),d}function zy(d){const a=d.meaning&&` - "${d.meaning}"`,l=d.legacyIds&&d.legacyIds.length>0?` [${d.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${d.id}"${l} ("${d.text}"${a})`}function Uu(d){$localize.translate||($localize.translate=i$),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(d).forEach(a=>{$localize.TRANSLATIONS[a]=function Up(d){const a=d.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const p=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:d,messageParts:Dy(l,p),placeholderNames:f}}(d[a])})}function i$(d,a){try{return function IO(d,a,l){const f=ky(a,l);let p=d[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===p;_++)p=d[f.legacyIds[_]];if(void 0===p)throw new Yf(f);return[p.messageParts,p.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${zy(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,d,a)}catch(l){return console.warn(l.message),[d,a]}}const kO=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Hy=function(d,...a){if(Hy.translate){const f=Hy.translate(d,a);d=f[0],a=f[1]}let l=Vy(d[0],d.raw[0]);for(let f=1;f<d.length;f++)l+=a[f-1]+Vy(d[f],d.raw[f]);return l};function Vy(d,a){return":"===a.charAt(0)?d.substring(Gu(d,a)+1):d}}},z9=>{z9(z9.s=9713)}]);