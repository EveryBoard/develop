!function(){var e,t,n,r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_,E,b,S,P,O,T,I,A,R,M,x,N,D,L,F,U,V,B,z,H,G,$,Z,q,W,j,Y,K,Q,X,J,ee,te,ne,re,ie,ae,oe,se,ue,ce,le,fe,he,de,ve,pe,ge,ye,me,ke,Ce,we,_e,Ee,be,Se,Pe,Oe,Te,Ie,Ae,Re,Me,xe,Ne,De,Le,Fe,Ue,Ve,Be,ze,He,Ge,$e,Ze,qe,We,je,Ye,Ke,Qe,Xe,Je,et,tt,nt,rt,it,at,ot,st,ut,ct,lt,ft,ht,dt,vt,pt,gt,yt,mt,kt,Ct,wt,_t,Et,bt,St,Pt,Ot,Tt,It,At,Rt,Mt,xt,Nt,Dt,Lt,Ft,Ut,Vt,Bt,zt,Ht,Gt,$t,Zt,qt,Wt,jt,Yt,Kt,Qt,Xt,Jt,en,tn,nn,rn,an,on,sn,un,cn,ln,fn,hn,dn,vn,pn,gn,yn,mn,kn,Cn,wn,_n,En,bn,Sn,Pn,On,Tn,In,An,Rn,Mn,xn,Nn,Dn,Ln,Fn,Un,Vn,Bn,zn,Hn,Gn,$n,Zn,qn,Wn,jn,Yn,Kn,Qn,Xn,Jn,er,tr,nr,rr,ir,ar,or,sr,ur,cr,lr,fr,hr,dr,vr,pr,gr,yr,mr,kr,Cr,wr,_r,Er,br,Sr,Pr,Or,Tr,Ir,Ar,Rr,Mr,xr,Nr,Dr,Lr,Fr,Ur,Vr,Br,zr,Hr,Gr,$r,Zr,qr,Wr,jr,Yr,Kr,Qr,Xr,Jr,ei,ti,ni,ri,ii,ai,oi,si,ui,ci,li,fi,hi,di,vi,pi,gi,yi,mi,ki,Ci,wi,_i,Ei,bi,Si,Pi,Oi,Ti,Ii,Ai,Ri,Mi,xi,Ni,Di,Li,Fi,Ui,Vi,Bi,zi,Hi,Gi,$i,Zi,qi,Wi,ji,Yi,Ki,Qi,Xi,Ji,ea,ta,na,ra,ia,aa,oa,sa,ua,ca,la,fa,ha,da,va,pa,ga,ya,ma,ka,Ca,wa,_a,Ea,ba,Sa,Pa,Oa,Ta,Ia,Aa,Ra,Ma,xa,Na,Da,La,Fa,Ua,Va,Ba,za,Ha,Ga,$a,Za,qa,Wa,ja,Ya,Ka,Qa,Xa,Ja,eo,to,no,ro,io,ao,oo,so,uo,co,lo,fo,ho,vo,po,go,yo,mo,ko,Co,wo,_o,Eo,bo,So,Po,Oo,To,Io,Ao,Ro,Mo,xo,No,Do,Lo,Fo,Uo,Vo,Bo,zo,Ho,Go,$o,Zo,qo,Wo,jo,Yo,Ko,Qo,Xo,Jo,es,ts,ns,rs,is,as,os,ss,us,cs,ls,fs,hs,ds,vs,ps,gs,ys,ms,ks,Cs,ws,_s,Es,bs,Ss,Ps,Os,Ts,Is,As,Rs,Ms,xs,Ns,Ds,Ls,Fs,Us,Vs,Bs,zs,Hs,Gs,$s,Zs,qs,Ws,js,Ys,Ks,Qs,Xs,Js,eu,tu,nu,ru,iu,au,ou,su,uu,cu,lu,fu,hu,du,vu,pu,gu,yu,mu,ku,Cu,wu,_u,Eu,bu,Su,Pu,Ou,Tu,Iu,Au,Ru,Mu,xu,Nu,Du,Lu,Fu,Uu,Vu,Bu,zu,Hu,Gu,$u,Zu,qu,Wu,ju,Yu,Ku,Qu,Xu,Ju,ec,tc,nc,rc,ic,ac,oc,sc,uc,cc,lc,fc,hc,dc,vc,pc,gc,yc,mc,kc,Cc,wc,_c,Ec,bc,Sc,Pc,Oc,Tc,Ic,Ac,Rc,Mc,xc,Nc,Dc,Lc,Fc,Uc,Vc,Bc,zc,Hc,Gc,$c,Zc,qc,Wc,jc,Yc,Kc,Qc,Xc,Jc,el,tl,nl,rl,il,al,ol,sl,ul,cl,ll,fl,hl,dl,vl,pl,gl,yl,ml,kl,Cl,wl,_l,El,bl,Sl,Pl,Ol,Tl,Il,Al,Rl,Ml,xl,Nl,Dl,Ll,Fl,Ul,Vl,Bl,zl,Hl,Gl,$l,Zl,ql,Wl,jl,Yl,Kl,Ql,Xl,Jl,ef,tf,nf,rf,af,of,sf,uf,cf,lf,ff,hf,df,vf,pf,gf,yf,mf,kf,Cf,wf,_f,Ef,bf,Sf,Pf,Of,Tf,If,Af,Rf,Mf,xf,Nf,Df,Lf,Ff,Uf,Vf,Bf,zf,Hf,Gf,$f,Zf,qf,Wf,jf,Yf,Kf,Qf,Xf,Jf,eh,th,nh,rh,ih,ah,oh,sh,uh,ch,lh,fh,hh,dh,vh,ph,gh,yh,mh,kh,Ch,wh,_h,Eh,bh,Sh,Ph,Oh,Th,Ih,Ah,Rh,Mh,xh,Nh,Dh,Lh,Fh,Uh,Vh,Bh,zh,Hh,Gh,$h,Zh,qh,Wh,jh,Yh,Kh,Qh,Xh,Jh,ed,td,nd,rd,id,ad,od,sd,ud,cd,ld,fd,hd,dd,vd,pd,gd,yd,md,kd,Cd,wd,_d,Ed,bd,Sd,Pd,Od,Td,Id,Ad,Rd,Md,xd,Nd,Dd,Ld,Fd,Ud,Vd,Bd,zd,Hd,Gd,$d,Zd,qd,Wd,jd,Yd,Kd,Qd,Xd,Jd,ev,tv,nv,rv,iv,av,ov,sv,uv,cv,lv,fv,hv,dv,vv,pv,gv,yv,mv,kv,Cv,wv,_v,Ev,bv,Sv,Pv,Ov,Tv,Iv,Av,Rv,Mv,xv,Nv,Dv,Lv,Fv,Uv,Vv,Bv,zv,Hv,Gv,$v,Zv,qv,Wv,jv,Yv,Kv,Qv,Xv,Jv,ep,tp,np,rp,ip,ap,op,sp,up,cp,lp,fp,hp,dp,vp,pp,gp,yp,mp,kp,Cp,wp,_p,Ep,bp,Sp,Pp,Op,Tp,Ip,Ap,Rp,Mp,xp,Np,Dp,Lp,Fp,Up,Vp,Bp,zp,Hp,Gp,$p,Zp,qp,Wp,jp,Yp,Kp,Qp,Xp,Jp,eg,tg,ng,rg,ig,ag,og,sg,ug,cg,lg,fg,hg,dg,vg,pg,gg,yg,mg,kg,Cg,wg,_g,Eg,bg,Sg,Pg,Og,Tg,Ig,Ag,Rg,Mg,xg,Ng,Dg,Lg,Fg,Ug,Vg,Bg;function zg(e){return jg(e)||sy(e)||cy(e)||Wg()}function Hg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Gg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gg(Object(n),!0).forEach(function(t){Zg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Zg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qg(e,t){return jg(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||cy(e,t)||Wg()}function Wg(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jg(e){if(Array.isArray(e))return e}function Yg(e){var t="function"==typeof Map?new Map:void 0;return Yg=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Kg(e,arguments,ay(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),ey(r,e)},Yg(e)}function Kg(e,t,n){return Kg=iy()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&ey(i,n.prototype),i},Kg.apply(null,arguments)}function Qg(){return Qg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Xg(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Qg.apply(this,arguments)}function Xg(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ay(e)););return e}function Jg(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ey(e,t)}function ey(e,t){return ey=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ey(e,t)}function ty(e){var t=iy();return function(){var n,r=ay(e);if(t){var i=ay(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ny(this,n)}}function ny(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ry(e)}function ry(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iy(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function ay(e){return ay=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ay(e)}function oy(e){return function(e){if(Array.isArray(e))return ly(e)}(e)||sy(e)||cy(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sy(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function uy(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=cy(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function cy(e,t){if(e){if("string"==typeof e)return ly(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ly(e,t):void 0}}function ly(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dy(e,t,n){return t&&hy(e.prototype,t),n&&hy(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(self.webpackChunkEveryBoard=self.webpackChunkEveryBoard||[]).push([[179],{8255:function(e){function t(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=8255,e.exports=t},9575:function(e,t,n){var r,i,a;!function(o){if("object"==typeof e.exports){var s=o(0,t);void 0!==s&&(e.exports=s)}else i=[n,t],void 0!==(a="function"==typeof(r=o)?r.apply(t,i):r)&&(e.exports=a)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=void 0;t.default=["fr",[["AM","PM"],n,n],n,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],n,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],n,[["av. J.-C.","ap. J.-C."],n,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1} '\xe0' {0}",n,n],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[n,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[n,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[n,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[n,"\xa5"],KMF:[n,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[n,"$C"],NZD:["$NZ","$"],RHD:["$RH"],RON:[n,"L"],RWF:[n,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[n,"$T"],TTD:["$TT","$"],TWD:[n,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[n,"$"],XPF:["FCFP"],ZMW:[n,"Kw"]},"ltr",function(e){var t=Math.floor(Math.abs(e));return 0===t||1===t?1:5}]})},5378:function(e,t){!function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function n(e){for(var n,r=1;r<arguments.length;r++){var i;n=null!==(i=arguments[r])&&void 0!==i?i:{},r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n,r=0;r<t.length;r++)(n=t[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){var e;return null!==(e=f)&&void 0!==e?e:document}var u={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},c=n({},u),l={},f=null,h=function(){function e(t){var n=this;r(this,e),this.element=s().createElement("div"),this.opacity=t.opacity,this.type=t.type,this.animate=t.animate,this.dismissible=t.dismissible,this.closeOnClick=t.closeOnClick,this.message=t.message,this.duration=t.duration,this.pauseOnHover=t.pauseOnHover,this.offsetTop=t.offsetTop,this.offsetBottom=t.offsetBottom,this.offsetLeft=t.offsetLeft,this.offsetRight=t.offsetRight,this.extraClasses=t.extraClasses;var i="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),a=["notification",this.extraClasses];if(this.type&&a.push(this.type),this.animate&&this.animate.in){var o="animate__".concat(this.animate.in),u=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";a.push("animate__animated ".concat(o," ").concat(u)),this.onAnimationEnd(function(){return n.element.classList.remove(o)})}if(this.element.className=a.join(" "),this.dismissible){var c=s().createElement("button");c.className="delete",c.addEventListener("click",function(){n.destroy()}),this.element.insertAdjacentElement("afterbegin",c)}else i+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){n.destroy()}),this.element.setAttribute("style",i),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var l=new d(function(){n.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){l.pause()}),this.element.addEventListener("mouseout",function(){l.resume()}))}return a(e,[{key:"destroy",value:function(){var e=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){e.removeParent(e.element.parentNode),e.element.remove(),delete l.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete l.position)}},{key:"removeParent",value:function(e){e&&1>=e.children.length&&e.remove()}},{key:"onAnimationEnd",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var n in t)if(void 0!==this.element.style[n]){this.element.addEventListener(t[n],function(){return e()});break}}}]),e}(),d=function(){function e(t,n){r(this,e),this.remaining=n,this.callback=t,this.resume()}return a(e,[{key:"pause",value:function(){"undefined"==typeof document||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){"undefined"==typeof document||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),e}();e.resetDefaults=function(){c=n({},u)},e.setDefaults=function(e){c=n(n({},u),e)},e.setDoc=function(e){for(var t in l)l[t].remove();l={},f=e},e.toast=function(e){if(!e.message)throw new Error("message is required");var t=n(n({},c),e),r=new h(t),i=function(e,t,n,r,i,a){if(l.position)return l.position;var o=s().createElement("div");return o.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+function(e,t,n,r,i){return"top-left"===e?"left:".concat(r,";top:").concat(t,";text-align:left;align-items:flex-start;"):"top-right"===e?"right:".concat(i,";top:").concat(t,";text-align:right;align-items:flex-end;"):"top-center"===e?"top:".concat(t,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===e?"left:".concat(r,";bottom:").concat(n,";text-align:left;align-items:flex-start;"):"bottom-right"===e?"right:".concat(i,";bottom:").concat(n,";text-align:right;align-items:flex-end;"):"bottom-center"===e?"bottom:".concat(n,";left:0;right:0;text-align:center;align-items:center;"):"center"===e?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0}(t,n,r,i,a)),e.appendChild(o),l.position=o,o}(t.appendTo||s().body,t.position||c.position,t.offsetTop||c.offsetTop,t.offsetBottom||c.offsetBottom,t.offsetLeft||c.offsetLeft,t.offsetRight||c.offsetRight);if(t.single)for(var a=i.lastElementChild;a;)i.removeChild(a),a=i.lastElementChild;i.appendChild(r.element)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},4975:function(Gg,Wg,jg){"use strict";var Xg,ey;function iy(e){return"function"==typeof e}function sy(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var cy=sy(function(e){return function(t){e(this),this.message=t?"".concat(t.length," errors occurred during unsubscription:\n").concat(t.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=t}});function ly(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var hy=function(){function e(t){fy(this,e),this.initialTeardown=t,this.closed=!1,this._parentage=null,this._teardowns=null}return dy(e,[{key:"unsubscribe",value:function(){var e;if(!this.closed){this.closed=!0;var t=this._parentage;if(t)if(this._parentage=null,Array.isArray(t)){var n,r=uy(t);try{for(r.s();!(n=r.n()).done;){var i;n.value.remove(this)}}catch(f){r.e(f)}finally{r.f()}}else t.remove(this);var a=this.initialTeardown;if(iy(a))try{a()}catch(i){e=i instanceof cy?i.errors:[i]}var o=this._teardowns;if(o){this._teardowns=null;var s,u=uy(o);try{for(u.s();!(s=u.n()).done;){var c=s.value;try{gy(c)}catch(h){var l;e=null!==(l=e)&&void 0!==l?l:[],h instanceof cy?e=[].concat(oy(e),oy(h.errors)):e.push(h)}}}catch(f){u.e(f)}finally{u.f()}}if(e)throw new cy(e)}}},{key:"add",value:function(t){var n;if(t&&t!==this)if(this.closed)gy(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(n=this._teardowns)&&void 0!==n?n:[]).push(t)}}},{key:"_hasParent",value:function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)}},{key:"_addParent",value:function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}},{key:"_removeParent",value:function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&ly(t,e)}},{key:"remove",value:function(t){var n=this._teardowns;n&&ly(n,t),t instanceof e&&t._removeParent(this)}}]),e}();hy.EMPTY=function(){var e=new hy;return e.closed=!0,e}();var vy=hy.EMPTY;function py(e){return e instanceof hy||e&&"closed"in e&&iy(e.remove)&&iy(e.add)&&iy(e.unsubscribe)}function gy(e){iy(e)?e():e.unsubscribe()}var yy=null,my=null,ky=void 0,Cy=!1,wy=!1,_y={setTimeout:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=_y.delegate;return((null==e?void 0:e.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=_y.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)}),delegate:void 0};function Ey(e){_y.setTimeout(function(){if(!yy)throw e;yy(e)})}function by(){}var Sy=Py("C",void 0,void 0);function Py(e,t,n){return{kind:e,value:t,error:n}}var Oy=null;function Ty(e){if(Cy){var t=!Oy;if(t&&(Oy={errorThrown:!1,error:null}),e(),t){var n=Oy,r=n.errorThrown,i=n.error;if(Oy=null,r)throw i}}else e()}var Iy=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).isStopped=!1,e?(r.destination=e,py(e)&&e.add(ry(r))):r.destination=Ny,r}return dy(n,[{key:"next",value:function(e){this.isStopped?xy(Py("N",e,void 0),this):this._next(e)}},{key:"error",value:function(e){this.isStopped?xy(Py("E",void 0,e),this):(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped?xy(Sy,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,Qg(ay(n.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){try{this.destination.error(e)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(e,t,n){return new Ay(e,t,n)}}]),n}(hy),Ay=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a,o,s;if(fy(this,n),o=t.call(this),iy(e))s=e;else if(e){var u,c;s=(u=e).next,r=u.error,i=u.complete,ry(o)&&wy?(c=Object.create(e)).unsubscribe=function(){return o.unsubscribe()}:c=e,s=null==s?void 0:s.bind(c),r=null==r?void 0:r.bind(c),i=null==i?void 0:i.bind(c)}return o.destination={next:s?Ry(s):by,error:Ry(null!==(a=r)&&void 0!==a?a:My),complete:i?Ry(i):by},ny(o)}return dy(n)}(Iy);function Ry(e,t){return function(){try{e.apply(void 0,arguments)}catch(t){Cy?function(e){Cy&&Oy&&(Oy.errorThrown=!0,Oy.error=e)}(t):Ey(t)}}}function My(e){throw e}function xy(e,t){var n=my;n&&_y.setTimeout(function(){return n(e,t)})}var Ny={closed:!0,next:by,error:My,complete:by},Dy="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ly(e){return e}var Fy=function(){var e=function(){function e(t){fy(this,e),t&&(this._subscribe=t)}return dy(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this,i=function(e){return e&&e instanceof Iy||function(e){return e&&iy(e.next)&&iy(e.error)&&iy(e.complete)}(e)&&py(e)}(e)?e:new Ay(e,t,n);return Ty(function(){var e=r.operator,t=r.source;i.add(e?e.call(i,t):t?r._subscribe(i):r._trySubscribe(i))}),i}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){e.error(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=Uy(t))(function(t,r){var i=new Ay({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})}},{key:"_subscribe",value:function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)}},{key:Dy,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return 0===e.length?Ly:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=Uy(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})}}]),e}();return e.create=function(t){return new e(t)},e}();function Uy(e){var t;return null!==(t=null!=e?e:ky)&&void 0!==t?t:Promise}var Vy=sy(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),By=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.call(this)).closed=!1,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return dy(n,[{key:"lift",value:function(e){var t=new zy(this,this);return t.operator=e,t}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new Vy}},{key:"next",value:function(e){var t=this;Ty(function(){if(t._throwIfClosed(),!t.isStopped){var n,r=uy(t.observers.slice());try{for(r.s();!(n=r.n()).done;){n.value.next(e)}}catch(i){r.e(i)}finally{r.f()}}})}},{key:"error",value:function(e){var t=this;Ty(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})}},{key:"complete",value:function(){var e=this;Ty(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}},{key:"_trySubscribe",value:function(e){return this._throwIfClosed(),Qg(ay(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}},{key:"_innerSubscribe",value:function(e){var t=this.hasError,n=this.isStopped,r=this.observers;return t||n?vy:(r.push(e),new hy(function(){return ly(r,e)}))}},{key:"_checkFinalizedStatuses",value:function(e){var t=this.hasError,n=this.thrownError,r=this.isStopped;t?e.error(n):r&&e.complete()}},{key:"asObservable",value:function(){var e=new Fy;return e.source=this,e}}]),n}(Fy);return e.create=function(e,t){return new zy(e,t)},e}(),zy=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).destination=e,i.source=r,i}return dy(n,[{key:"next",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}},{key:"error",value:function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}},{key:"complete",value:function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}},{key:"_subscribe",value:function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:vy}}]),n}(By);function Hy(e){return iy(null==e?void 0:e.lift)}function Gy(e){return function(t){if(Hy(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var $y=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s,u,c,l;return fy(this,n),(l=t.call(this,e)).onFinalize=o,l._next=r?function(t){try{r(t)}catch(n){e.error(n)}}:Qg((s=ry(l),ay(n.prototype)),"_next",s),l._error=a?function(t){try{a(t)}catch(n){e.error(n)}finally{this.unsubscribe()}}:Qg((u=ry(l),ay(n.prototype)),"_error",u),l._complete=i?function(){try{i()}catch(t){e.error(t)}finally{this.unsubscribe()}}:Qg((c=ry(l),ay(n.prototype)),"_complete",c),l}return dy(n,[{key:"unsubscribe",value:function(){var e,t=this.closed;Qg(ay(n.prototype),"unsubscribe",this).call(this),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}]),n}(Iy);function Zy(e,t){return Gy(function(n,r){var i=0;n.subscribe(new $y(r,function(n){r.next(e.call(t,n,i++))}))})}function qy(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function Wy(e){return this instanceof Wy?(this.v=e,this):new Wy(e)}function jy(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){a.push([e,t,n,r])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof Wy?Promise.resolve(e.value.v).then(u,c):l(a[0][2],e)}(i[e](t))}catch(n){l(a[0][3],n)}}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function Yy(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}}var Ky=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function Qy(e){return iy(null==e?void 0:e.then)}function Xy(e){return iy(e[Dy])}function Jy(e){return Symbol.asyncIterator&&iy(null==e?void 0:e[Symbol.asyncIterator])}function em(e){return new TypeError("You provided ".concat(null!==e&&"object"==typeof e?"an invalid object":"'".concat(e,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var tm="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function nm(e){return iy(null==e?void 0:e[tm])}function rm(e){return jy(this,arguments,regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getReader(),t.prev=1;case 2:return t.next=4,Wy(n.read());case 4:if(r=t.sent,i=r.value,!r.done){t.next=11;break}return t.next=10,Wy(void 0);case 10:return t.abrupt("return",t.sent);case 11:return t.next=13,Wy(i);case 13:return t.next=15,t.sent;case 15:t.next=2;break;case 17:return t.prev=17,n.releaseLock(),t.finish(17);case 20:case"end":return t.stop()}},t,null,[[1,,17,20]])}))}function im(e){return iy(null==e?void 0:e.getReader)}function am(e){if(e instanceof Fy)return e;if(null!=e){if(Xy(e))return function(e){return new Fy(function(t){var n=e[Dy]();if(iy(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(Ky(e))return function(e){return new Fy(function(t){for(var n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(Qy(e))return function(e){return new Fy(function(t){e.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,Ey)})}(e);if(Jy(e))return om(e);if(nm(e))return function(e){return new Fy(function(t){var n,r=uy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.next(i),t.closed)return}}catch(a){r.e(a)}finally{r.f()}t.complete()})}(e);if(im(e))return function(e){return om(rm(e))}(e)}throw em(e)}function om(e){return new Fy(function(t){(function(e,t){var n,r,i,a;return function(e,t,n,r){return new(n||(n=Promise))(function(t,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function o(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?t(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,o)}s((r=r.apply(e,[])).next())})}(this,0,void 0,regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:o.prev=0,n=Yy(e);case 2:return o.next=4,n.next();case 4:if((r=o.sent).done){o.next=9;break}if(t.next(r.value),!t.closed){o.next=7;break}return o.abrupt("return");case 7:o.next=2;break;case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),i={error:o.t0};case 14:if(o.prev=14,o.prev=15,o.t1=r&&!r.done&&(a=n.return),!o.t1){o.next=20;break}return o.next=20,a.call(n);case 20:if(o.prev=20,!i){o.next=23;break}throw i.error;case 23:return o.finish(20);case 24:return o.finish(14);case 25:t.complete();case 26:case"end":return o.stop()}},o,null,[[0,11,14,25],[15,,20,24]])}))})(e,t).catch(function(e){return t.error(e)})})}function sm(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(a),!i)return a}function um(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return iy(t)?um(function(n,r){return Zy(function(e,i){return t(n,e,r,i)})(am(e(n,r)))},n):("number"==typeof t&&(n=t),Gy(function(t,r){return function(e,t,n,r,i,a,o,s){var u=[],c=0,l=0,f=!1,h=function(){f&&!u.length&&!c&&t.complete()},d=function e(i){c++;var a=!1;am(n(i,l++)).subscribe(new $y(t,function(e){t.next(e)},function(){a=!0},void 0,function(){if(a)try{for(c--;u.length&&c<r;){var n=u.shift();e(n)}h()}catch(n){t.error(n)}}))};return e.subscribe(new $y(t,function(e){return c<r?d(e):u.push(e)},function(){f=!0,h()})),function(){}}(t,r,e,n)}))}function cm(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return um(Ly,e)}var lm=new Fy(function(e){return e.complete()});function fm(e){return e[e.length-1]}function hm(e){return iy(fm(e))?e.pop():void 0}function dm(e){return function(e){return e&&iy(e.schedule)}(fm(e))?e.pop():void 0}function vm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Gy(function(n,r){n.subscribe(new $y(r,function(n){return sm(r,e,function(){return r.next(n)},t)},function(){return sm(r,e,function(){return r.complete()},t)},function(n){return sm(r,e,function(){return r.error(n)},t)}))})}function pm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Gy(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function gm(e,t){if(!e)throw new Error("Iterable cannot be null");return new Fy(function(n){sm(n,t,function(){var r=e[Symbol.asyncIterator]();sm(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function ym(e,t){return t?function(e,t){if(null!=e){if(Xy(e))return function(e,t){return am(e).pipe(pm(t),vm(t))}(e,t);if(Ky(e))return function(e,t){return new Fy(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Qy(e))return function(e,t){return am(e).pipe(pm(t),vm(t))}(e,t);if(Jy(e))return gm(e,t);if(nm(e))return function(e,t){return new Fy(function(n){var r;return sm(n,t,function(){r=e[tm](),sm(n,t,function(){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(a){return void n.error(a)}t?n.complete():n.next(e)},0,!0)}),function(){return iy(null==r?void 0:r.return)&&r.return()}})}(e,t);if(im(e))return function(e,t){return gm(rm(e),t)}(e,t)}throw em(e)}(e,t):am(e)}function mm(e){return e<=0?function(){return lm}:Gy(function(t,n){var r=0;t.subscribe(new $y(n,function(t){++r<=e&&(n.next(t),e<=r&&n.complete())}))})}function km(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return!0===t?(e(),null):!1===t?null:t.apply(void 0,r).pipe(mm(1)).subscribe(function(){return e()})}function Cm(e){for(var t in e)if(e[t]===Cm)return t;throw Error("Could not find renamed property on target object.")}function wm(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function _m(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(_m).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function Em(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var bm=Cm({__forward_ref__:Cm});function Sm(e){return e.__forward_ref__=Sm,e.toString=function(){return _m(this())},e}function Pm(e){return Om(e)?e():e}function Om(e){return"function"==typeof e&&e.hasOwnProperty(bm)&&e.__forward_ref__===Sm}var Tm=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),i=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,r)),i.code=e,i}return dy(n)}(Yg(Error));function Im(e){return"string"==typeof e?e:null==e?"":String(e)}function Am(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Im(e)}function Rm(e,t){var n=t?" in ".concat(t):"";throw new Tm("201","No provider for ".concat(Am(e)," found").concat(n))}function Mm(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat(e)+(null==r?"":" [Expected=> ".concat(n," ").concat(r," ").concat(t," <=Actual]")))}function xm(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Nm(e){return{providers:e.providers||[],imports:e.imports||[]}}function Dm(e){return Lm(e,Vm)||Lm(e,zm)}function Lm(e,t){return e.hasOwnProperty(t)?e[t]:null}function Fm(e){return e&&(e.hasOwnProperty(Bm)||e.hasOwnProperty(Hm))?e[Bm]:null}var Um,Vm=Cm({"\u0275prov":Cm}),Bm=Cm({"\u0275inj":Cm}),zm=Cm({ngInjectableDef:Cm}),Hm=Cm({ngInjectorDef:Cm}),Gm=((Gm=Gm||{})[Gm.Default=0]="Default",Gm[Gm.Host=1]="Host",Gm[Gm.Self=2]="Self",Gm[Gm.SkipSelf=4]="SkipSelf",Gm[Gm.Optional=8]="Optional",Gm);function $m(e){var t=Um;return Um=e,t}function Zm(e,t,n){var r=Dm(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:n&Gm.Optional?null:void 0!==t?t:void Rm(_m(e),"Injector")}function qm(e){return{toString:e}.toString()}var Wm=((Wm=Wm||{})[Wm.OnPush=0]="OnPush",Wm[Wm.Default=1]="Default",Wm),jm=((jm=jm||{})[jm.Emulated=0]="Emulated",jm[jm.None=2]="None",jm[jm.ShadowDom=3]="ShadowDom",jm),Ym="undefined"!=typeof globalThis&&globalThis,Km="undefined"!=typeof window&&window,Qm="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Xm=Ym||"undefined"!=typeof global&&global||Km||Qm,Jm={},ek=[],tk=Cm({"\u0275cmp":Cm}),nk=Cm({"\u0275dir":Cm}),rk=Cm({"\u0275pipe":Cm}),ik=Cm({"\u0275mod":Cm}),ak=Cm({"\u0275loc":Cm}),ok=Cm({"\u0275fac":Cm}),sk=Cm({__NG_ELEMENT_ID__:Cm}),uk=0;function ck(e){return qm(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Wm.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||ek,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||jm.Emulated,id:"c",styles:e.styles||ek,_:null,setInput:null,schemas:e.schemas||null,tView:null},r=e.directives,i=e.features,a=e.pipes;return n.id+=uk++,n.inputs=vk(e.inputs,t),n.outputs=vk(e.outputs),i&&i.forEach(function(e){return e(n)}),n.directiveDefs=r?function(){return("function"==typeof r?r():r).map(lk)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(fk)}:null,n})}function lk(e){return yk(e)||function(e){return e[nk]||null}(e)}function fk(e){return function(e){return e[rk]||null}(e)}var hk={};function dk(e){return qm(function(){var t={type:e.type,bootstrap:e.bootstrap||ek,declarations:e.declarations||ek,imports:e.imports||ek,exports:e.exports||ek,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&(hk[e.id]=e.type),t})}function vk(e,t){if(null==e)return Jm;var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],a=i;Array.isArray(i)&&(a=i[1],i=i[0]),n[i]=r,t&&(t[i]=a)}return n}var pk=ck;function gk(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function yk(e){return e[tk]||null}function mk(e,t){var n=e[ik]||null;if(!n&&!0===t)throw new Error("Type ".concat(_m(e)," does not have '\u0275mod' property."));return n}function kk(e){return Array.isArray(e)&&"object"==typeof e[1]}function Ck(e){return Array.isArray(e)&&!0===e[1]}function wk(e){return 0!=(8&e.flags)}function _k(e){return 2==(2&e.flags)}function Ek(e){return 1==(1&e.flags)}function bk(e){return null!==e.template}function Sk(e){return 0!=(512&e[2])}function Pk(e,t){return e.hasOwnProperty(ok)?e[ok]:null}var Ok=function(){function e(t,n,r){fy(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return dy(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function Tk(){return Ik}function Ik(e){return e.type.prototype.ngOnChanges&&(e.setInput=Rk),Ak}function Ak(){var e=xk(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===Jm)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function Rk(e,t,n,r){var i=xk(e)||function(e,t){return e[Mk]=t}(e,{previous:Jm,current:null}),a=i.current||(i.current={}),o=i.previous,s=this.declaredInputs[n],u=o[s];a[s]=new Ok(u&&u.currentValue,t,o===Jm),e[r]=t}Tk.ngInherit=!0;var Mk="__ngSimpleChanges__";function xk(e){return e[Mk]||null}var Nk,Dk="http://www.w3.org/2000/svg";function Lk(){return void 0!==Nk?Nk:"undefined"!=typeof document?document:void 0}function Fk(e){return!!e.listen}var Uk={createRenderer:function(e,t){return Lk()}};function Vk(e){for(;Array.isArray(e);)e=e[0];return e}function Bk(e,t){return Vk(t[e])}function zk(e,t){return Vk(t[e.index])}function Hk(e,t){return e.data[t]}function Gk(e,t){return e[t]}function $k(e,t){var n=t[e];return kk(n)?n:n[0]}function Zk(e){return 4==(4&e[2])}function qk(e){return 128==(128&e[2])}function Wk(e,t){return null==t?null:e[t]}function jk(e){e[18]=0}function Yk(e,t){e[5]+=t;for(var n=e,r=e[3];null!==r&&(1===t&&1===n[5]||-1===t&&0===n[5]);)r[5]+=t,n=r,r=r[3]}var Kk={lFrame:_C(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Qk(){return Kk.bindingsEnabled}function Xk(){return Kk.lFrame.lView}function Jk(){return Kk.lFrame.tView}function eC(e){return Kk.lFrame.contextLView=e,e[8]}function tC(){for(var e=nC();null!==e&&64===e.type;)e=e.parent;return e}function nC(){return Kk.lFrame.currentTNode}function rC(){var e=Kk.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function iC(e,t){var n=Kk.lFrame;n.currentTNode=e,n.isParent=t}function aC(){return Kk.lFrame.isParent}function oC(){Kk.lFrame.isParent=!1}function sC(){return Kk.isInCheckNoChangesMode}function uC(e){Kk.isInCheckNoChangesMode=e}function cC(){var e=Kk.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function lC(){return Kk.lFrame.bindingIndex}function fC(){return Kk.lFrame.bindingIndex++}function hC(e){var t=Kk.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function dC(e){Kk.lFrame.inI18n=e}function vC(e,t){var n=Kk.lFrame;n.bindingIndex=n.bindingRootIndex=e,pC(t)}function pC(e){Kk.lFrame.currentDirectiveIndex=e}function gC(){return Kk.lFrame.currentQueryIndex}function yC(e){Kk.lFrame.currentQueryIndex=e}function mC(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function kC(e,t,n){if(n&Gm.SkipSelf){for(var r=t,i=e;!(null!==(r=r.parent)||n&Gm.Host||(r=mC(i),null===r||(i=i[15],10&r.type))););if(null===r)return!1;t=r,e=i}var a=Kk.lFrame=wC();return a.currentTNode=t,a.lView=e,!0}function CC(e){var t=wC(),n=e[1];Kk.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function wC(){var e=Kk.lFrame,t=null===e?null:e.child;return null===t?_C(e):t}function _C(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function EC(){var e=Kk.lFrame;return Kk.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var bC=EC;function SC(){var e=EC();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function PC(){return Kk.lFrame.selectedIndex}function OC(e){Kk.lFrame.selectedIndex=e}function TC(){var e=Kk.lFrame;return Hk(e.tView,e.selectedIndex)}function IC(){Kk.lFrame.currentNamespace=Dk}function AC(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var i=e.data[n].type.prototype,a=i.ngAfterContentInit,o=i.ngAfterContentChecked,s=i.ngAfterViewInit,u=i.ngAfterViewChecked,c=i.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),u&&((e.viewHooks||(e.viewHooks=[])).push(n,u),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,u)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function RC(e,t,n){NC(e,t,3,n)}function MC(e,t,n,r){(3&e[2])===n&&NC(e,t,n,r)}function xC(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function NC(e,t,n,r){for(var i=null!=r?r:-1,a=t.length-1,o=0,s=void 0!==r?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=r&&o>=r)break}else t[s]<0&&(e[18]+=65536),(o<i||-1==i)&&(DC(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function DC(e,t,n,r){var i=n[r]<0,a=n[r+1],o=e[i?-n[r]:n[r]];if(i){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var LC=dy(function e(t,n,r){fy(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r});function FC(e,t,n){for(var r=Fk(e),i=0;i<n.length;){var a=n[i];if("number"==typeof a){if(0!==a)break;i++;var o=n[i++],s=n[i++],u=n[i++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=a,l=n[++i];VC(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),i++}}return i}function UC(e){return 3===e||4===e||6===e}function VC(e){return 64===e.charCodeAt(0)}function BC(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var i=t[r];"number"==typeof i?n=i:0===n||zC(e,n,i,null,-1===n||2===n?t[++r]:null)}return e}function zC(e,t,n,r,i){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var u=e[a];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==i&&(e[a+1]=i));if(r===e[a+1])return void(e[a+2]=i)}a++,null!==r&&a++,null!==i&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==r&&e.splice(a++,0,r),null!==i&&e.splice(a++,0,i)}function HC(e){return-1!==e}function GC(e){return 32767&e}function $C(e,t){for(var n=function(e){return e>>16}(e),r=t;n>0;)r=r[15],n--;return r}var ZC=!0;function qC(e){var t=ZC;return ZC=e,t}var WC=0;function jC(e,t){var n=KC(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,YC(r.data,e),YC(t,null),YC(r.blueprint,null));var i=QC(e,t),a=e.injectorIndex;if(HC(i))for(var o=GC(i),s=$C(i,t),u=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|u[o+c];return t[a+8]=i,a}function YC(e,t){e.push(0,0,0,0,0,0,0,0,t)}function KC(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function QC(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,r=null,i=t;null!==i;){var a=i[1],o=a.type;if(null===(r=2===o?a.declTNode:1===o?i[6]:null))return-1;if(n++,i=i[15],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function XC(e,t,n){!function(e,t,n){var r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(sk)&&(r=n[sk]),null==r&&(r=n[sk]=WC++);var i=255&r;t.data[e+(i>>5)]|=1<<i}(e,t,n)}function JC(e,t,n){if(n&Gm.Optional)return e;Rm(t,"NodeInjector")}function ew(e,t,n,r){if(n&Gm.Optional&&void 0===r&&(r=null),0==(n&(Gm.Self|Gm.Host))){var i=e[9],a=$m(void 0);try{return i?i.get(t,r,n&Gm.Optional):Zm(t,r,n&Gm.Optional)}finally{$m(a)}}return JC(r,t,n)}function tw(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gm.Default,i=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(sk)?e[sk]:void 0;return"number"==typeof t?t>=0?255&t:rw:t}(n);if("function"==typeof a){if(!kC(t,e,r))return r&Gm.Host?JC(i,n,r):ew(t,n,r,i);try{var o=a(r);if(null!=o||r&Gm.Optional)return o;Rm(n)}finally{bC()}}else if("number"==typeof a){var s=null,u=KC(e,t),c=-1,l=r&Gm.Host?t[16][6]:null;for((-1===u||r&Gm.SkipSelf)&&(-1!==(c=-1===u?QC(e,t):t[u+8])&&uw(r,!1)?(s=t[1],u=GC(c),t=$C(c,t)):u=-1);-1!==u;){var f=t[1];if(sw(a,u,f.data)){var h=iw(u,t,n,s,r,l);if(h!==nw)return h}-1!==(c=t[u+8])&&uw(r,t[1].data[u+8]===l)&&sw(a,u,t)?(s=f,u=GC(c),t=$C(c,t)):u=-1}}}return ew(t,n,r,i)}var nw={};function rw(){return new cw(tC(),Xk())}function iw(e,t,n,r,i,a){var o=t[1],s=o.data[e+8],u=aw(s,o,n,null==r?_k(s)&&ZC:r!=o&&0!=(3&s.type),i&Gm.Host&&a===s);return null!==u?ow(t,o,u,s):nw}function aw(e,t,n,r,i){for(var a=e.providerIndexes,o=t.data,s=1048575&a,u=e.directiveStart,c=a>>20,l=i?s+c:e.directiveEnd,f=r?s:s+c;f<l;f++){var h=o[f];if(f<u&&n===h||f>=u&&h.type===n)return f}if(i){var d=o[u];if(d&&bk(d)&&d.type===n)return u}return null}function ow(e,t,n,r){var i=e[n],a=t.data;if(function(e){return e instanceof LC}(i)){var o=i;o.resolving&&function(e,t){throw new Tm("200","Circular dependency in DI detected for ".concat(e))}(Am(a[n]));var s=qC(o.canSeeViewProviders);o.resolving=!0;var u=o.injectImpl?$m(o.injectImpl):null;kC(e,r,Gm.Default);try{i=e[n]=o.factory(void 0,a,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.type.prototype,i=r.ngOnChanges,a=r.ngOnInit,o=r.ngDoCheck;if(i){var s=Ik(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==u&&$m(u),qC(s),o.resolving=!1,bC()}}return i}function sw(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function uw(e,t){return!(e&Gm.Self||e&Gm.Host&&t)}var cw=function(){function e(t,n){fy(this,e),this._tNode=t,this._lView=n}return dy(e,[{key:"get",value:function(e,t,n){return tw(this._tNode,this._lView,e,n,t)}}]),e}();function lw(e){return qm(function(){for(var t=e.prototype.constructor,n=t[ok]||fw(t),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;i&&i!==r;){var a=i[ok]||fw(i);if(a&&a!==n)return a;i=Object.getPrototypeOf(i)}return function(e){return new e}})}function fw(e){return Om(e)?function(){var t=fw(Pm(e));return t&&t()}:Pk(e)}function hw(e){return function(e,t){if("class"===t)return e.classes;if("style"===t)return e.styles;var n=e.attrs;if(n)for(var r=n.length,i=0;i<r;){var a=n[i];if(UC(a))break;if(0===a)i+=2;else if("number"==typeof a)for(i++;i<r&&"string"==typeof n[i];)i++;else{if(a===t)return n[i+1];i+=2}}return null}(tC(),e)}var dw="__parameters__";function vw(e,t,n){return qm(function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof i)return r.apply(this,t),this;var a=Kg(i,t);return o.annotation=a,o;function o(e,t,n){for(var r=e.hasOwnProperty(dw)?e[dw]:Object.defineProperty(e,dw,{value:[]})[dw];r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(a),e}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var pw=function(){function e(t,n){fy(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=xm({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return dy(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),gw=new pw("AnalyzeForEntryComponents"),yw=Function;function mw(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?(t===e&&(t=e.slice(0,n)),mw(r,t)):t!==e&&t.push(r)}return t}function kw(e,t){e.forEach(function(e){return Array.isArray(e)?kw(e,t):t(e)})}function Cw(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function ww(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function _w(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function Ew(e,t,n){var r=Sw(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var i=e.length;if(i==t)e.push(n,r);else if(1===i)e.push(r,e[0]),e[0]=n;else{for(i--,e.push(e[i-1],e[i]);i>t;)e[i]=e[i-2],i--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function bw(e,t){var n=Sw(e,t);if(n>=0)return e[1|n]}function Sw(e,t){return function(e,t,n){for(var r=0,i=e.length>>1;i!==r;){var a=r+(i-r>>1),o=e[a<<1];if(t===o)return a<<1;o>t?i=a:r=a+1}return~(i<<1)}(e,t)}var Pw,Ow={},Tw="__NG_DI_FLAG__",Iw="ngTempTokenPath",Aw=/\n/gm,Rw="__source",Mw=Cm({provide:String,useValue:Cm});function xw(e){var t=Pw;return Pw=e,t}function Nw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gm.Default;if(void 0===Pw)throw new Error("inject() must be called from an injection context");return null===Pw?Zm(e,void 0,t):Pw.get(e,t&Gm.Optional?null:void 0,t)}function Dw(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gm.Default;return(Um||Nw)(Pm(e),t)}function Lw(e){for(var t=[],n=0;n<e.length;n++){var r=Pm(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var i=void 0,a=Gm.Default,o=0;o<r.length;o++){var s=r[o],u=Uw(s);"number"==typeof u?-1===u?i=s.token:a|=u:i=s}t.push(Dw(i,a))}else t.push(Dw(r))}return t}function Fw(e,t){return e[Tw]=t,e.prototype[Tw]=t,e}function Uw(e){return e[Tw]}function Vw(e,t,n,r){var i=e[Iw];throw t[Rw]&&i.unshift(t[Rw]),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var i=_m(t);if(Array.isArray(t))i=t.map(_m).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):_m(s)))}i="{".concat(a.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(i,"]: ").concat(e.replace(Aw,"\n  "))}("\n"+e.message,i,n,r),e.ngTokenPath=i,e[Iw]=null,e}var Bw,zw,Hw=Fw(vw("Inject",function(e){return{token:e}}),-1),Gw=Fw(vw("Optional"),8),$w=Fw(vw("SkipSelf"),4);function Zw(e){var t;return(null===(t=function(){if(void 0===Bw&&(Bw=null,Xm.trustedTypes))try{Bw=Xm.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return Bw}())||void 0===t?void 0:t.createHTML(e))||e}function qw(e){var t;return(null===(t=function(){if(void 0===zw&&(zw=null,Xm.trustedTypes))try{zw=Xm.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(e){}return zw}())||void 0===t?void 0:t.createHTML(e))||e}var Ww=function(){function e(t){fy(this,e),this.changingThisBreaksApplicationSecurity=t}return dy(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),jw=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Ww),Yw=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Ww),Kw=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Ww),Qw=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Ww),Xw=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Ww);function Jw(e){return e instanceof Ww?e.changingThisBreaksApplicationSecurity:e}function e_(e,t){var n=t_(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function t_(e){return e instanceof Ww&&e.getTypeName()||null}function n_(e){var t=new i_(e);return function(){try{return!!(new window.DOMParser).parseFromString(Zw(""),"text/html")}catch(e){return!1}}()?new r_(t):t}var r_=function(){function e(t){fy(this,e),this.inertDocumentHelper=t}return dy(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Zw(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),i_=function(){function e(t){if(fy(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var r=this.inertDocument.createElement("body");n.appendChild(r)}}return dy(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Zw(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Zw(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var r=t.item(n).name;("xmlns:ns1"===r||0===r.indexOf("ns1:"))&&e.removeAttribute(r)}for(var i=e.firstChild;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}]),e}(),a_=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,o_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function s_(e){return(e=String(e)).match(a_)||e.match(o_)?e:"unsafe:"+e}function u_(e){return(e=String(e)).split(",").map(function(e){return s_(e.trim())}).join(", ")}function c_(e){var t,n={},r=uy(e.split(","));try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(i){r.e(i)}finally{r.f()}return n}function l_(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var f_,h_=c_("area,br,col,hr,img,wbr"),d_=c_("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),v_=c_("rp,rt"),p_=l_(h_,l_(d_,c_("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),l_(v_,c_("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),l_(v_,d_)),g_=c_("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),y_=c_("srcset"),m_=l_(g_,y_,c_("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),c_("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),k_=c_("script,style,template"),C_=function(){function e(){fy(this,e),this.sanitizedSomething=!1,this.buf=[]}return dy(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!p_.hasOwnProperty(t))return this.sanitizedSomething=!0,!k_.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n=e.attributes,r=0;r<n.length;r++){var i=n.item(r),a=i.name,o=a.toLowerCase();if(m_.hasOwnProperty(o)){var s=i.value;g_[o]&&(s=s_(s)),y_[o]&&(s=u_(s)),this.buf.push(" ",a,'="',E_(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();p_.hasOwnProperty(t)&&!h_.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(E_(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),w_=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,__=/([^\#-~ |!])/g;function E_(e){return e.replace(/&/g,"&amp;").replace(w_,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(__,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function b_(e,t){var n=null;try{f_=f_||n_(e);var r=t?String(t):"";n=f_.getInertBodyElement(r);var i=5,a=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=a,a=n.innerHTML,n=f_.getInertBodyElement(r)}while(r!==a);return Zw((new C_).sanitizeChildren(S_(n)||n))}finally{if(n)for(var o=S_(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function S_(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var P_=((P_=P_||{})[P_.NONE=0]="NONE",P_[P_.HTML=1]="HTML",P_[P_.STYLE=2]="STYLE",P_[P_.SCRIPT=3]="SCRIPT",P_[P_.URL=4]="URL",P_[P_.RESOURCE_URL=5]="RESOURCE_URL",P_);function O_(e){var t=I_();return t?qw(t.sanitize(P_.HTML,e)||""):e_(e,"HTML")?qw(Jw(e)):b_(Lk(),Im(e))}function T_(e){var t=I_();return t?t.sanitize(P_.URL,e)||"":e_(e,"URL")?Jw(e):s_(Im(e))}function I_(){var e=Xk();return e&&e[12]}var A_="__ngContext__";function R_(e,t){e[A_]=t}function M_(e){var t=function(e){return e[A_]||null}(e);return t?Array.isArray(t)?t:t.lView:null}function x_(e){return e.ngOriginalError}function N_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var D_=function(){function e(){fy(this,e),this._console=console}return dy(e,[{key:"handleError",value:function(e){var t,n=this._findOriginalError(e),r=this._findContext(e),i=(t=e)&&t.ngErrorLogger||N_;i(this._console,"ERROR",e),n&&i(this._console,"ORIGINAL ERROR",n),r&&i(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?e.ngDebugContext||this._findContext(x_(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=e&&x_(e);t&&x_(t);)t=x_(t);return t||null}}]),e}(),L_=/^>|^->|<!--|-->|--!>|<!-$/g,F_=/(<|>)/,U_=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Xm);function V_(e){return e instanceof Function?e():e}var B_,z_=((z_=z_||{})[z_.Important=1]="Important",z_[z_.DashCase=2]="DashCase",z_);function H_(e,t){return B_(e,t)}function G_(e){var t=e[3];return Ck(t)?t[3]:t}function $_(e){return q_(e[13])}function Z_(e){return q_(e[4])}function q_(e){for(;null!==e&&!Ck(e);)e=e[4];return e}function W_(e,t,n,r,i){if(null!=r){var a,o=!1;Ck(r)?a=r:kk(r)&&(o=!0,r=r[0]);var s=Vk(r);0===e&&null!==n?null==i?aE(t,n,s):iE(t,n,s,i||null,!0):1===e&&null!==n?iE(t,n,s,i||null,!0):2===e?yE(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,r,i){var a=n[7];a!==Vk(n)&&W_(t,e,r,a,i);for(var o=10;o<n.length;o++){var s=n[o];kE(s[1],s,e,t,r,a)}}(t,e,a,n,i)}}function j_(e,t){return Fk(e)?e.createText(t):e.createTextNode(t)}function Y_(e,t,n){Fk(e)?e.setValue(t,n):t.textContent=n}function K_(e,t){return e.createComment(function(e){return e.replace(L_,function(e){return e.replace(F_,"\u200b$1\u200b")})}(t))}function Q_(e,t,n){return Fk(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function X_(e,t){var n=e[9],r=n.indexOf(t),i=t[3];1024&t[2]&&(t[2]&=-1025,Yk(i,-1)),n.splice(r,1)}function J_(e,t){if(!(e.length<=10)){var n=10+t,r=e[n];if(r){var i=r[17];null!==i&&i!==e&&X_(i,r),t>0&&(e[n-1][4]=r[4]);var a=ww(e,10+t);!function(e,t){kE(e,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);var o=a[19];null!==o&&o.detachView(a[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function eE(e,t){if(!(256&t[2])){var n=t[11];Fk(n)&&n.destroyNode&&kE(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return tE(e[1],e);for(;t;){var n=null;if(kk(t))n=t[13];else{var r=t[10];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)kk(t)&&tE(t[1],t),t=t[3];null===t&&(t=e),kk(t)&&tE(t[1],t),n=t&&t[4]}t=n}}(t)}}function tE(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var i=t[n[r]];if(!(i instanceof LC)){var a=n[r+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2){var s=i[a[o]],u=a[o+1];try{u.call(s)}finally{}}else try{a.call(i)}finally{}}}}(e,t),function(e,t){var n=e.cleanup,r=t[7],i=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):Vk(t[o]),u=r[i=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],u,c):c>=0?r[i=c]():r[i=-c].unsubscribe(),a+=2}else{var l=r[i=n[a+1]];n[a].call(l)}if(null!==r){for(var f=i+1;f<r.length;f++)r[f]();t[7]=null}}(e,t),1===t[1].type&&Fk(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&Ck(t[3])){n!==t[3]&&X_(n,t);var r=t[19];null!==r&&r.detachView(e)}}}function nE(e,t,n){return rE(e,t.parent,n)}function rE(e,t,n){for(var r=t;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return n[0];if(2&r.flags){var i=e.data[r.directiveStart].encapsulation;if(i===jm.None||i===jm.Emulated)return null}return zk(r,n)}function iE(e,t,n,r,i){Fk(e)?e.insertBefore(t,n,r,i):t.insertBefore(n,r,i)}function aE(e,t,n){Fk(e)?e.appendChild(t,n):t.appendChild(n)}function oE(e,t,n,r,i){null!==r?iE(e,t,n,r,i):aE(e,t,n)}function sE(e,t){return Fk(e)?e.parentNode(t):t.parentNode}function uE(e,t,n){return fE(e,t,n)}function cE(e,t,n){return 40&e.type?zk(e,n):null}var lE,fE=cE;function hE(e,t){fE=e,lE=t}function dE(e,t,n,r){var i=nE(e,r,t),a=t[11],o=uE(r.parent||t[6],r,t);if(null!=i)if(Array.isArray(n))for(var s=0;s<n.length;s++)oE(a,i,n[s],o,!1);else oE(a,i,n,o,!1);void 0!==lE&&lE(a,r,t,n,i)}function vE(e,t){if(null!==t){var n=t.type;if(3&n)return zk(t,e);if(4&n)return gE(-1,e[t.index]);if(8&n){var r=t.child;if(null!==r)return vE(e,r);var i=e[t.index];return Ck(i)?gE(-1,i):Vk(i)}if(32&n)return H_(t,e)()||Vk(e[t.index]);var a=pE(e,t);return null!==a?Array.isArray(a)?a[0]:vE(G_(e[16]),a):vE(e,t.next)}return null}function pE(e,t){return null!==t?e[16][6].projection[t.projection]:null}function gE(e,t){var n=10+e+1;if(n<t.length){var r=t[n],i=r[1].firstChild;if(null!==i)return vE(r,i)}return t[7]}function yE(e,t,n){var r=sE(e,t);r&&function(e,t,n,r){Fk(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}function mE(e,t,n,r,i,a,o){for(;null!=n;){var s=r[n.index],u=n.type;if(o&&0===t&&(s&&R_(Vk(s),r),n.flags|=4),64!=(64&n.flags))if(8&u)mE(e,t,n.child,r,i,a,!1),W_(t,e,i,s,a);else if(32&u){for(var c=H_(n,r),l=void 0;l=c();)W_(t,e,i,l,a);W_(t,e,i,s,a)}else 16&u?CE(e,t,r,n,i,a):W_(t,e,i,s,a);n=o?n.projectionNext:n.next}}function kE(e,t,n,r,i,a){mE(n,r,e.firstChild,t,i,a,!1)}function CE(e,t,n,r,i,a){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)W_(t,e,i,s[u],a);else mE(e,t,s,o[3],i,a,!0)}function wE(e,t,n){Fk(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function _E(e,t,n){Fk(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function EE(e,t,n){for(var r=e.length;;){var i=e.indexOf(t,n);if(-1===i)return i;if(0===i||e.charCodeAt(i-1)<=32){var a=t.length;if(i+a===r||e.charCodeAt(i+a)<=32)return i}n=i+1}}var bE="ng-template";function SE(e,t,n){for(var r=0;r<e.length;){var i=e[r++];if(n&&"class"===i){if(-1!==EE((i=e[r]).toLowerCase(),t,0))return!0}else if(1===i){for(;r<e.length&&"string"==typeof(i=e[r++]);)if(i.toLowerCase()===t)return!0;return!1}}return!1}function PE(e){return 4===e.type&&e.value!==bE}function OE(e,t,n){return t===(4!==e.type||n?e.value:bE)}function TE(e,t,n){for(var r=4,i=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(UC(e[t]))return t;return e.length}(i),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!OE(e,u,n)||""===u&&1===t.length){if(IE(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!SE(e.attrs,c,n)){if(IE(r))return!1;o=!0}continue}var l=AE(8&r?"class":u,i,PE(e),n);if(-1===l){if(IE(r))return!1;o=!0;continue}if(""!==c){var f;f=l>a?"":i[l+1].toLowerCase();var h=8&r?f:null;if(h&&-1!==EE(h,c,0)||2&r&&c!==f){if(IE(r))return!1;o=!0}}}}else{if(!o&&!IE(r)&&!IE(u))return!1;if(o&&IE(u))continue;o=!1,r=u|1&r}}return IE(r)||o}function IE(e){return 0==(1&e)}function AE(e,t,n,r){if(null===t)return-1;var i=0;if(r||!n){for(var a=!1;i<t.length;){var o=t[i];if(o===e)return i;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++i];"string"==typeof s;)s=t[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function RE(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(TE(e,t[r],n))return!0;return!1}function ME(e,t){return e?":not("+t.trim()+")":t}function xE(e){for(var t=e[0],n=1,r=2,i="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];i+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!IE(o)&&(t+=ME(a,i),i=""),r=o,a=a||!IE(r);n++}return""!==i&&(t+=ME(a,i)),t}var NE={};function DE(e){LE(Jk(),Xk(),PC()+e,sC())}function LE(e,t,n,r){if(!r)if(3==(3&t[2])){var i=e.preOrderCheckHooks;null!==i&&RC(t,i,n)}else{var a=e.preOrderHooks;null!==a&&MC(t,a,0,n)}OC(n)}function FE(e,t){return e<<17|t<<2}function UE(e){return e>>17&32767}function VE(e){return 2|e}function BE(e){return(131068&e)>>2}function zE(e,t){return-131069&e|t<<2}function HE(e){return 1|e}function GE(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var i=n[r],a=n[r+1];if(-1!==a){var o=e.data[a];yC(i),o.contentQueries(2,t[a],a)}}}function $E(e,t,n,r,i,a,o,s,u,c){var l=t.blueprint.slice();return l[0]=i,l[2]=140|r,jk(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=a,l[16]=2==t.type?e[16]:l,l}function ZE(e,t,n,r,i){var a=e.data[t];if(null===a)a=qE(e,t,n,r,i),Kk.lFrame.inI18n&&(a.flags|=64);else if(64&a.type){a.type=n,a.value=r,a.attrs=i;var o=rC();a.injectorIndex=null===o?-1:o.injectorIndex}return iC(a,!0),a}function qE(e,t,n,r,i){var a=nC(),o=aC(),s=e.data[t]=function(e,t,n,r,i,a){return{type:n,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:i,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,r,i);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}function WE(e,t,n,r){if(0===n)return-1;for(var i=t.length,a=0;a<n;a++)t.push(r),e.blueprint.push(r),e.data.push(null);return i}function jE(e,t,n){CC(t);try{var r=e.viewQuery;null!==r&&Pb(1,r,n);var i=e.template;null!==i&&QE(e,t,i,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&GE(e,t),e.staticViewQueries&&Pb(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)wb(e,t[n])}(t,a)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[2]&=-5,SC()}}function YE(e,t,n,r){var i=t[2];if(256!=(256&i)){CC(t);var a=sC();try{jk(t),function(e){Kk.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==n&&QE(e,t,n,2,r);var o=3==(3&i);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&RC(t,s,null)}else{var u=e.preOrderHooks;null!==u&&MC(t,u,0,null),xC(t,0)}if(function(e){for(var t=$_(e);null!==t;t=Z_(t))if(t[2])for(var n=t[9],r=0;r<n.length;r++){var i=n[r],a=i[3];0==(1024&i[2])&&Yk(a,1),i[2]|=1024}}(t),function(e){for(var t=$_(e);null!==t;t=Z_(t))for(var n=10;n<t.length;n++){var r=t[n],i=r[1];qk(r)&&YE(i,r,i.template,r[8])}}(t),null!==e.contentQueries&&GE(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&RC(t,c)}else{var l=e.contentHooks;null!==l&&MC(t,l,1),xC(t,1)}!function(e,t){var n=e.hostBindingOpCodes;if(null!==n)try{for(var r=0;r<n.length;r++){var i=n[r];if(i<0)OC(~i);else{var a=i,o=n[++r],s=n[++r];vC(o,a),s(2,t[a])}}}finally{OC(-1)}}(e,t);var f=e.components;null!==f&&function(e,t){for(var n=0;n<t.length;n++)kb(e,t[n])}(t,f);var h=e.viewQuery;if(null!==h&&Pb(2,h,r),!a)if(o){var d=e.viewCheckHooks;null!==d&&RC(t,d)}else{var v=e.viewHooks;null!==v&&MC(t,v,2),xC(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Yk(t[3],-1))}finally{SC()}}}function KE(e,t,n,r){var i=t[10],a=!sC(),o=Zk(t);try{a&&!o&&i.begin&&i.begin(),o&&jE(e,t,r),YE(e,t,n,r)}finally{a&&!o&&i.end&&i.end()}}function QE(e,t,n,r,i){var a=PC(),o=2&r;try{OC(-1),o&&t.length>20&&LE(e,t,20,sC()),n(r,i)}finally{OC(a)}}function XE(e,t,n){if(wk(t))for(var r=t.directiveEnd,i=t.directiveStart;i<r;i++){var a=e.data[i];a.contentQueries&&a.contentQueries(1,n[i],i)}}function JE(e,t,n){!Qk()||(function(e,t,n,r){var i=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||jC(n,t),R_(r,t);for(var o=n.initialInputs,s=i;s<a;s++){var u=e.data[s],c=bk(u);c&&db(t,n,u);var l=ow(t,e,s,n);R_(l,t),null!==o&&gb(0,s-i,l,u,0,o),c&&($k(n.index,t)[8]=l)}}(e,t,n,zk(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,i=n.directiveEnd,a=n.index,o=Kk.lFrame.currentDirectiveIndex;try{OC(a);for(var s=r;s<i;s++){var u=e.data[s],c=t[s];pC(s),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&ub(u,c)}}finally{OC(-1),pC(o)}}(e,t,n))}function eb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:zk,r=t.localNames;if(null!==r)for(var i=t.index+1,a=0;a<r.length;a+=2){var o=r[a+1],s=-1===o?n(t,e):e[o];e[i++]=s}}function tb(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=nb(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function nb(e,t,n,r,i,a,o,s,u,c){var l=20+r,f=l+i,h=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:NE);return n}(l,f),d="function"==typeof c?c():c;return h[1]={type:e,blueprint:h,template:n,queries:null,viewQuery:s,declTNode:t,data:h.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:f,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:d,incompleteFirstPass:!1}}function rb(e,t,n,r){var i=Tb(t);null===n?i.push(r):(i.push(n),e.firstCreatePass&&Ib(e).push(r,i.length-1))}function ib(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,i):n[r]=[t,i]}return n}function ab(e,t,n,r,i,a,o,s){var u,c=zk(t,n),l=t.inputs;!s&&null!=l&&(u=l[r])?(Rb(e,n,u,r,i),_k(t)&&function(e,t){var n=$k(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(r=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),i=null!=o?o(i,t.value||"",r):i,Fk(a)?a.setProperty(c,r,i):VC(r)||(c.setProperty?c.setProperty(r,i):c[r]=i))}function ob(e,t,n,r){var i=!1;if(Qk()){var a=function(e,t,n){var r=e.directiveRegistry,i=null;if(r)for(var a=0;a<r.length;a++){var o=r[a];RE(n,o.selectors,!1)&&(i||(i=[]),XC(jC(n,t),e,o.type),bk(o)?(cb(e,n),i.unshift(o)):i.push(o))}return i}(e,t,n),o=null===r?null:{"":-1};if(null!==a){i=!0,fb(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var u=a[s];u.providersResolver&&u.providersResolver(u)}for(var c=!1,l=!1,f=WE(e,t,a.length,null),h=0;h<a.length;h++){var d=a[h];n.mergedAttrs=BC(n.mergedAttrs,d.hostAttrs),hb(e,n,t,f,d),lb(f,d,o),null!==d.contentQueries&&(n.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(n.flags|=128);var v=d.type.prototype;!c&&(v.ngOnChanges||v.ngOnInit||v.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),!l&&(v.ngOnChanges||v.ngDoCheck)&&((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),l=!0),f++}!function(e,t){for(var n=t.directiveEnd,r=e.data,i=t.attrs,a=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs,f=null===i||PE(t)?null:yb(l,i);a.push(f),o=ib(l,u,o),s=ib(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],i=0;i<t.length;i+=2){var a=n[t[i+1]];if(null==a)throw new Tm("301","Export of name '".concat(t[i+1],"' not found!"));r.push(t[i],a)}}(n,r,o)}return n.mergedAttrs=BC(n.mergedAttrs,n.attrs),i}function sb(e,t,n,r,i,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var u=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=u&&s.push(u),s.push(r,i,o)}}function ub(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function cb(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function lb(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;bk(t)&&(n[""]=e)}}function fb(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function hb(e,t,n,r,i){e.data[r]=i;var a=i.factory||(i.factory=Pk(i.type)),o=new LC(a,bk(i),null);e.blueprint[r]=o,n[r]=o,sb(e,t,0,r,WE(e,n,i.hostVars,NE),i)}function db(e,t,n){var r=zk(t,e),i=tb(n),a=e[10],o=_b(e,$E(e,i,null,n.onPush?64:16,r,t,a,a.createRenderer(r,n),null,null));e[t.index]=o}function vb(e,t,n,r,i,a){var o=zk(e,t);pb(t[11],o,a,e.value,n,r,i)}function pb(e,t,n,r,i,a,o){if(null==a)Fk(e)?e.removeAttribute(t,i,n):t.removeAttribute(i);else{var s=null==o?Im(a):o(a,r||"",i);Fk(e)?e.setAttribute(t,i,s,n):n?t.setAttributeNS(n,i,s):t.setAttribute(i,s)}}function gb(e,t,n,r,i,a){var o=a[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],f=o[u++];null!==s?r.setInput(n,f,c,l):n[l]=f}}function yb(e,t){for(var n=null,r=0;r<t.length;){var i=t[r];if(0!==i)if(5!==i){if("number"==typeof i)break;e.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,e[i],t[r+1])),r+=2}else r+=2;else r+=4}return n}function mb(e,t,n,r){return new Array(e,!0,!1,t,null,0,r,n,null,null)}function kb(e,t){var n=$k(t,e);if(qk(n)){var r=n[1];80&n[2]?YE(r,n,r.template,n[8]):n[5]>0&&Cb(n)}}function Cb(e){for(var t=$_(e);null!==t;t=Z_(t))for(var n=10;n<t.length;n++){var r=t[n];if(1024&r[2]){var i=r[1];YE(i,r,i.template,r[8])}else r[5]>0&&Cb(r)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=$k(a[o],e);qk(s)&&s[5]>0&&Cb(s)}}function wb(e,t){var n=$k(t,e),r=n[1];(function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])})(r,n),jE(r,n,n[8])}function _b(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Eb(e){for(;e;){e[2]|=64;var t=G_(e);if(Sk(e)&&!t)return e;e=t}return null}function bb(e,t,n){var r=t[10];r.begin&&r.begin();try{YE(e,t,e.template,n)}catch(i){throw Ab(t,i),i}finally{r.end&&r.end()}}function Sb(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=M_(n),i=r[1];KE(i,r,i.template,n)}}(e[8])}function Pb(e,t,n){yC(0),t(e,n)}var Ob=Promise.resolve(null);function Tb(e){return e[7]||(e[7]=[])}function Ib(e){return e.cleanup||(e.cleanup=[])}function Ab(e,t){var n=e[9],r=n?n.get(D_,null):null;r&&r.handleError(t)}function Rb(e,t,n,r,i){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,i,r,s):u[s]=i}}function Mb(e,t,n){var r=Bk(t,e);Y_(e[11],r,n)}function xb(e,t,n){var r=n?e.styles:null,i=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?i=Em(i,s):2==a&&(r=Em(r,s+": "+t[++o]+";"))}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=i:e.classesWithoutHost=i}var Nb,Db=new pw("INJECTOR",-1),Lb=function(){function e(){fy(this,e)}return dy(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ow;if(t===Ow){var n=new Error("NullInjectorError: No provider for ".concat(_m(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),Fb=new pw("Set Injector scope."),Ub={},Vb={};function Bb(){return void 0===Nb&&(Nb=new Lb),Nb}function zb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new Hb(e,n,t||Bb(),r)}var Hb=function(){function e(t,n,r){var i=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;fy(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&kw(n,function(e){return i.processProvider(e,t,n)}),kw([t],function(e){return i.processInjectorType(e,[],o)}),this.records.set(Db,Zb(void 0,this));var s=this.records.get(Fb);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:_m(t))}return dy(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ow,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gm.Default;this.assertNotDestroyed();var r,i=xw(this),a=$m(void 0);try{if(!(n&Gm.SkipSelf)){var o=this.records.get(e);if(void 0===o){var s=("function"==typeof(r=e)||"object"==typeof r&&r instanceof pw)&&Dm(e);o=s&&this.injectableDefInScope(s)?Zb(Gb(e),Ub):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(n&Gm.Self?Bb():this.parent).get(e,t=n&Gm.Optional&&t===Ow?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[Iw]=u[Iw]||[]).unshift(_m(e)),i)throw u;return Vw(u,e,"R3InjectorError",this.source)}throw u}finally{$m(a),xw(i)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(_m(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=Pm(e)))return!1;var i=Fm(e),a=null==i&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(i=Fm(a)),null==i)return!1;if(null!=i.imports&&!s){var u;n.push(o);try{kw(i.imports,function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))})}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,i=t.providers;kw(i,function(e){return r.processProvider(e,n,i||ek)})},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o);var f=Pk(o)||function(){return new o};this.records.set(o,Zb(f,Ub));var h=i.providers;if(null!=h&&!s){var d=e;kw(h,function(e){return r.processProvider(e,d,h)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r,i=Wb(e=Pm(e))?e:Pm(e&&e.provide),a=qb(r=e)?Zb(void 0,r.useValue):Zb($b(r),Ub);if(Wb(e)||!0!==e.multi)this.records.get(i);else{var o=this.records.get(i);o||((o=Zb(void 0,Ub,!0)).factory=function(){return Lw(o.multi)},this.records.set(i,o)),i=e,o.multi.push(e)}this.records.set(i,a)}},{key:"hydrate",value:function(e,t){return t.value===Ub&&(t.value=Vb,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value;var n}},{key:"injectableDefInScope",value:function(e){if(!e.providedIn)return!1;var t=Pm(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}]),e}();function Gb(e){var t=Dm(e),n=null!==t?t.factory:Pk(e);if(null!==n)return n;if(e instanceof pw)throw new Error("Token ".concat(_m(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=_w(t,"?");throw new Error("Can't resolve all parameters for ".concat(_m(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[Vm]||e[zm]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function $b(e,t,n){var r;if(Wb(e)){var i=Pm(e);return Pk(i)||Gb(i)}if(qb(e))r=function(){return Pm(e.useValue)};else if(function(e){return!(!e||!e.useFactory)}(e))r=function(){return e.useFactory.apply(e,oy(Lw(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return Dw(Pm(e.useExisting))};else{var a=Pm(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return Pk(a)||Gb(a);r=function(){return Kg(a,oy(Lw(e.deps)))}}return r}function Zb(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function qb(e){return null!==e&&"object"==typeof e&&Mw in e}function Wb(e){return"function"==typeof e}var jb=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,i=zb(e,t,n,r);return i._resolveInjectorDefTypes(),i}({name:n},t,e,n)},Yb=function(){var e=function(){function e(){fy(this,e)}return dy(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?jb(e,t,""):jb(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Ow,e.NULL=new Lb,e.\u0275prov=xm({token:e,providedIn:"any",factory:function(){return Dw(Db)}}),e.__NG_ELEMENT_ID__=-1,e}();function Kb(e,t){AC(M_(e)[1],tC())}function Qb(e){for(var t=function(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0,r=[e];t;){var i=void 0;if(bk(e))i=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");i=t.\u0275dir}if(i){if(n){r.push(i);var a=e;a.inputs=Xb(e.inputs),a.declaredInputs=Xb(e.declaredInputs),a.outputs=Xb(e.outputs);var o=i.hostBindings;o&&tS(e,o);var s=i.viewQuery,u=i.contentQueries;if(s&&Jb(e,s),u&&eS(e,u),wm(e.inputs,i.inputs),wm(e.declaredInputs,i.declaredInputs),wm(e.outputs,i.outputs),bk(i)&&i.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(i.data.animation)}}var l=i.features;if(l)for(var f=0;f<l.length;f++){var h=l[f];h&&h.ngInherit&&h(e),h===Qb&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var i=e[r];i.hostVars=t+=i.hostVars,i.hostAttrs=BC(i.hostAttrs,n=BC(n,i.hostAttrs))}}(r)}function Xb(e){return e===Jm?{}:e===ek?[]:e}function Jb(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function eS(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,i){t(e,r,i),n(e,r,i)}:t}function tS(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var nS=null;function rS(){if(!nS){var e=Xm.Symbol;if(e&&e.iterator)nS=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(nS=r)}}return nS}var iS=function(){function e(t){fy(this,e),this.wrapped=t}return dy(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function aS(e){return!!oS(e)&&(Array.isArray(e)||!(e instanceof Map)&&rS()in e)}function oS(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function sS(e,t,n){return e[t]=n}function uS(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function cS(e,t,n,r){var i=uS(e,t,n);return uS(e,t+1,r)||i}function lS(e,t,n,r){var i=Xk();return uS(i,fC(),t)&&(Jk(),vb(TC(),i,e,t,n,r)),lS}function fS(e,t,n,r){return uS(e,fC(),n)?t+Im(n)+r:NE}function hS(e,t,n,r,i,a){var o=cS(e,lC(),n,i);return hC(2),o?t+Im(n)+r+Im(i)+a:NE}function dS(e,t,n,r,i,a,o,s){var u=function(e,t,n,r,i){var a=cS(e,t,n,r);return uS(e,t+2,i)||a}(e,lC(),n,i,o);return hC(3),u?t+Im(n)+r+Im(i)+a+Im(o)+s:NE}function vS(e,t,n,r,i,a){var o=Xk(),s=fS(o,t,n,r);return s!==NE&&vb(TC(),o,e,s,i,a),vS}function pS(e,t,n,r,i,a,o,s){var u=Xk(),c=Jk(),l=e+20,f=c.firstCreatePass?function(e,t,n,r,i,a,o,s,u){var c=t.consts,l=ZE(t,e,4,o||null,Wk(c,s));ob(t,n,l,Wk(c,u)),AC(t,l);var f=l.tViews=nb(2,l,r,i,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,l),f.queries=t.queries.embeddedTView(l)),l}(l,c,u,t,n,r,i,a,o):c.data[l];iC(f,!1);var h=u[11].createComment("");dE(c,u,h,f),R_(h,u),_b(u,u[l]=mb(h,u,h,f)),Ek(f)&&JE(c,u,f),null!=o&&eb(u,f,s)}function gS(e){return Gk(Kk.lFrame.contextLView,20+e)}function yS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Gm.Default,n=Xk();return null===n?Dw(e,t):tw(tC(),n,Pm(e),t)}function mS(e,t,n){var r=Xk();return uS(r,fC(),t)&&ab(Jk(),TC(),r,e,t,r[11],n,!1),mS}function kS(e,t,n,r,i){var a=i?"class":"style";Rb(e,n,t.inputs[a],a,r)}function CS(e,t,n,r){var i=Xk(),a=Jk(),o=20+e,s=i[11],u=i[o]=Q_(s,t,Kk.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,r,i,a,o){var s=t.consts,u=ZE(t,e,2,i,Wk(s,a));return ob(t,n,u,Wk(s,o)),null!==u.attrs&&xb(u,u.attrs,!1),null!==u.mergedAttrs&&xb(u,u.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,u),u}(o,a,i,0,t,n,r):a.data[o];iC(c,!0);var l=c.mergedAttrs;null!==l&&FC(s,u,l);var f=c.classes;null!==f&&_E(s,u,f);var h=c.styles;null!==h&&wE(s,u,h),64!=(64&c.flags)&&dE(a,i,u,c),0===Kk.lFrame.elementDepthCount&&R_(u,i),Kk.lFrame.elementDepthCount++,Ek(c)&&(JE(a,i,c),XE(a,c,i)),null!==r&&eb(i,c)}function wS(){var e=tC();aC()?oC():iC(e=e.parent,!1);var t=e;Kk.lFrame.elementDepthCount--;var n=Jk();n.firstCreatePass&&(AC(n,e),wk(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&kS(n,t,Xk(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&kS(n,t,Xk(),t.stylesWithoutHost,!1)}function _S(e,t,n,r){CS(e,t,n,r),wS()}function ES(e,t,n){var r=Xk(),i=Jk(),a=e+20,o=i.firstCreatePass?function(e,t,n,r,i){var a=t.consts,o=Wk(a,r),s=ZE(t,e,8,"ng-container",o);return null!==o&&xb(s,o,!0),ob(t,n,s,Wk(a,i)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,i,r,t,n):i.data[a];iC(o,!0);var s=r[a]=r[11].createComment("");dE(i,r,s,o),R_(s,r),Ek(o)&&(JE(i,r,o),XE(i,o,r)),null!=n&&eb(r,o)}function bS(){var e=tC(),t=Jk();aC()?oC():iC(e=e.parent,!1),t.firstCreatePass&&(AC(t,e),wk(e)&&t.queries.elementEnd(e))}function SS(){return Xk()}function PS(e){return!!e&&"function"==typeof e.then}var OS=function(e){return!!e&&"function"==typeof e.subscribe};function TS(e,t,n,r){var i=Xk(),a=Jk(),o=tC();return function(e,t,n,r,i,a,o,s){var u=Ek(r),c=e.firstCreatePass&&Ib(e),l=t[8],f=Tb(t),h=!0;if(3&r.type||s){var d=zk(r,t),v=s?s(d):d,p=f.length,g=s?function(e){return s(Vk(e[r.index]))}:r.index;if(Fk(n)){var y=null;if(!s&&u&&(y=function(e,t,n,r){var i=e.cleanup;if(null!=i)for(var a=0;a<i.length-1;a+=2){var o=i[a];if(o===n&&i[a+1]===r){var s=t[7],u=i[a+2];return s.length>u?s[u]:null}"string"==typeof o&&(a+=2)}return null}(e,t,i,r.index)),null!==y)(y.__ngLastListenerFn__||y).__ngNextListenerFn__=a,y.__ngLastListenerFn__=a,h=!1;else{a=AS(r,t,l,a,!1);var m=n.listen(v,i,a);f.push(a,m),c&&c.push(i,g,p,p+1)}}else a=AS(r,t,l,a,!0),v.addEventListener(i,a,o),f.push(a),c&&c.push(i,g,p,o)}else a=AS(r,t,l,a,!1);var k,C=r.outputs;if(h&&null!==C&&(k=C[i])){var w=k.length;if(w)for(var _=0;_<w;_+=2){var E=t[k[_]][k[_+1]].subscribe(a),b=f.length;f.push(a,E),c&&c.push(i,r.index,b,-(b+1))}}}(a,i,i[11],o,e,t,!!n,r),TS}function IS(e,t,n,r){try{return!1!==n(r)}catch(i){return Ab(e,i),!1}}function AS(e,t,n,r,i){return function n(a){if(a===Function)return r;var o=2&e.flags?$k(e.index,t):t;0==(32&t[2])&&Eb(o);for(var s=IS(t,0,r,a),u=n.__ngNextListenerFn__;u;)s=IS(t,0,u,a)&&s,u=u.__ngNextListenerFn__;return i&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function RS(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Kk.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Kk.lFrame.contextLView))[8]}(e)}function MS(e,t,n){return xS(e,"",t,"",n),MS}function xS(e,t,n,r,i){var a=Xk(),o=fS(a,t,n,r);return o!==NE&&ab(Jk(),TC(),a,e,o,a[11],i,!1),xS}function NS(e,t,n,r,i,a,o){var s=Xk(),u=hS(s,t,n,r,i,a);return u!==NE&&ab(Jk(),TC(),s,e,u,s[11],o,!1),NS}function DS(e,t,n,r,i,a,o,s,u){var c=Xk(),l=dS(c,t,n,r,i,a,o,s);return l!==NE&&ab(Jk(),TC(),c,e,l,c[11],u,!1),DS}function LS(e,t,n,r,i){for(var a=e[n+1],o=null===t,s=r?UE(a):BE(a),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];FS(e[s],t)&&(u=!0,e[s+1]=r?HE(c):VE(c)),s=r?UE(c):BE(c)}u&&(e[n+1]=r?VE(a):HE(a))}function FS(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Sw(e,t)>=0}var US={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function VS(e){return e.substring(US.key,US.keyEnd)}function BS(e){return e.substring(US.value,US.valueEnd)}function zS(e,t){var n=US.textEnd,r=US.key=HS(e,t,n);return n===r?-1:(r=US.keyEnd=function(e,t,n){for(var r;t<n&&(45===(r=e.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(e,r,n),r=GS(e,r,n),r=US.value=HS(e,r,n),r=US.valueEnd=function(e,t,n){for(var r=-1,i=-1,a=-1,o=t,s=o;o<n;){var u=e.charCodeAt(o++);if(59===u)return s;34===u||39===u?s=o=$S(e,u,o,n):t===o-4&&85===a&&82===i&&76===r&&40===u?s=o=$S(e,41,o,n):u>32&&(s=o),a=i,i=r,r=-33&u}return s}(e,r,n),GS(e,r,n))}function HS(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function GS(e,t,n,r){return(t=HS(e,t,n))<n&&t++,t}function $S(e,t,n,r){for(var i=-1,a=n;a<r;){var o=e.charCodeAt(a++);if(o==t&&92!==i)return a;i=92==o&&92===i?0:o}throw new Error}function ZS(e,t){return function(e,t,n,r){var i=Xk(),a=Jk(),o=hC(2);a.firstUpdatePass&&YS(a,e,o,true),t!==NE&&uS(i,o,t)&&JS(a,a.data[PC()],i,i[11],e,i[o+1]=function(e,t){return null==e||"object"==typeof e&&(e=_m(Jw(e))),e}(t),true,o)}(e,t),ZS}function qS(e){!function(e,t,n,r){var i=Jk(),a=hC(2);i.firstUpdatePass&&YS(i,null,a,r);var o=Xk();if(n!==NE&&uS(o,a,n)){var s=i.data[PC()];if(nP(s,r)&&!jS(i,a)){var u=s.stylesWithoutHost;null!==u&&(n=Em(u,n||"")),kS(i,s,o,n,r)}else!function(e,t,n,r,i,a,o,s){i===NE&&(i=ek);for(var u=0,c=0,l=0<i.length?i[0]:null,f=0<a.length?a[0]:null;null!==l||null!==f;){var h=u<i.length?i[u+1]:void 0,d=c<a.length?a[c+1]:void 0,v=void 0,p=null;l===f?(u+=2,c+=2,h!==d&&(p=f,v=d)):null===f||null!==l&&l<f?(u+=2,p=l):(c+=2,p=f,v=d),null!==p&&JS(e,t,n,r,p,v,false,s),l=u<i.length?i[u]:null,f=c<a.length?a[c]:null}}(i,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return ek;var r=[],i=Jw(n);if(Array.isArray(i))for(var a=0;a<i.length;a++)e(r,i[a],!0);else if("object"==typeof i)for(var o in i)i.hasOwnProperty(o)&&e(r,o,i[o]);else"string"==typeof i&&t(r,i);return r}(e,t,n),0,a)}}(XS,WS,e,!1)}function WS(e,t){for(var n=function(e){return function(e){US.key=0,US.keyEnd=0,US.value=0,US.valueEnd=0,US.textEnd=e.length}(e),zS(e,HS(e,0,US.textEnd))}(t);n>=0;n=zS(t,n))XS(e,VS(t),BS(t))}function jS(e,t){return t>=e.expandoStartIndex}function YS(e,t,n,r){var i=e.data;if(null===i[n+1]){var a=i[PC()],o=jS(e,n);nP(a,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var i=function(e){var t=Kk.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=r?t.residualClasses:t.residualStyles;if(null===i)0===(r?t.classBindings:t.styleBindings)&&(n=QS(n=KS(null,e,t,n,r),t.attrs,r),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==i)if(n=KS(i,e,t,n,r),null===a){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==BE(r))return e[UE(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[UE(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=QS(s=KS(null,e,t,s[1],r),t.attrs,r))}else a=function(e,t,n){for(var r,i=t.directiveEnd,a=1+t.directiveStylingLast;a<i;a++)r=QS(r,e[a].hostAttrs,n);return QS(r,t.attrs,n)}(e,t,r)}return void 0!==a&&(r?t.residualClasses=a:t.residualStyles=a),n}(i,a,t,r),function(e,t,n,r,i,a){var o=a?t.classBindings:t.styleBindings,s=UE(o),u=BE(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var f=n;(null===(c=f[1])||Sw(f,c)>0)&&(l=!0)}else c=n;if(i)if(0!==u){var h=UE(e[s+1]);e[r+1]=FE(h,s),0!==h&&(e[h+1]=zE(e[h+1],r)),e[s+1]=function(e,t){return 131071&e|t<<17}(e[s+1],r)}else e[r+1]=FE(s,0),0!==s&&(e[s+1]=zE(e[s+1],r)),s=r;else e[r+1]=FE(u,0),0===s?s=r:e[u+1]=zE(e[u+1],r),u=r;l&&(e[r+1]=VE(e[r+1])),LS(e,c,r,!0),LS(e,c,r,!1),function(e,t,n,r,i){var a=i?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&Sw(a,t)>=0&&(n[r+1]=HE(n[r+1]))}(t,c,e,r,a),o=FE(s,u),a?t.classBindings=o:t.styleBindings=o}(i,a,t,n,o,r)}}function KS(e,t,n,r,i){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=QS(r,(a=t[s]).hostAttrs,i),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function QS(e,t,n){var r=n?1:2,i=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?i=o:i===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Ew(e,o,!!n||t[++a]))}return void 0===e?null:e}function XS(e,t,n){Ew(e,t,Jw(n))}function JS(e,t,n,r,i,a,o,s){if(3&t.type){var u=e.data,c=u[s+1];tP(function(e){return 1==(1&e)}(c)?eP(u,t,n,i,BE(c),o):void 0)||(tP(a)||function(e){return 2==(2&e)}(c)&&(a=eP(u,null,n,i,s,o)),function(e,t,n,r,i){var a=Fk(e);if(t)i?a?e.addClass(n,r):n.classList.add(r):a?e.removeClass(n,r):n.classList.remove(r);else{var o=-1===r.indexOf("-")?void 0:z_.DashCase;if(null==i)a?e.removeStyle(n,r,o):n.style.removeProperty(r);else{var s="string"==typeof i&&i.endsWith("!important");s&&(i=i.slice(0,-10),o|=z_.Important),a?e.setStyle(n,r,i,o):n.style.setProperty(r,i,s?"important":"")}}}(r,o,Bk(PC(),n),i,a))}}function eP(e,t,n,r,i,a){for(var o,s=null===t;i>0;){var u=e[i],c=Array.isArray(u),l=c?u[1]:u,f=null===l,h=n[i+1];h===NE&&(h=f?ek:void 0);var d=f?bw(h,r):l===r?h:void 0;if(c&&!tP(d)&&(d=bw(u,r)),tP(d)&&(o=d,s))return o;var v=e[i+1];i=s?UE(v):BE(v)}if(null!==t){var p=a?t.residualClasses:t.residualStyles;null!=p&&(o=bw(p,r))}return o}function tP(e){return void 0!==e}function nP(e,t){return 0!=(e.flags&(t?16:32))}function rP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Xk(),r=Jk(),i=e+20,a=r.firstCreatePass?ZE(r,i,1,t,null):r.data[i],o=n[i]=j_(n[11],t);dE(r,n,o,a),iC(a,!1)}function iP(e){return aP("",e,""),iP}function aP(e,t,n){var r=Xk(),i=fS(r,e,t,n);return i!==NE&&Mb(r,PC(),i),aP}function oP(e,t,n,r,i){var a=Xk(),o=hS(a,e,t,n,r,i);return o!==NE&&Mb(a,PC(),o),oP}function sP(e,t,n,r,i,a,o){var s=Xk(),u=dS(s,e,t,n,r,i,a,o);return u!==NE&&Mb(s,PC(),u),sP}function uP(e,t,n){var r=Xk();return uS(r,fC(),t)&&ab(Jk(),TC(),r,e,t,r[11],n,!0),uP}var cP=void 0,lP=["en",[["a","p"],["AM","PM"],cP],[["AM","PM"],cP,cP],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],cP,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],cP,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",cP,"{1} 'at' {0}",cP],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],fP={};function hP(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=vP(t);if(n)return n;var r=t.split("-")[0];if(n=vP(r))return n;if("en"===r)return lP;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function dP(e){return hP(e)[pP.PluralCase]}function vP(e){return e in fP||(fP[e]=Xm.ng&&Xm.ng.common&&Xm.ng.common.locales&&Xm.ng.common.locales[e]),fP[e]}var pP=((pP=pP||{})[pP.LocaleId=0]="LocaleId",pP[pP.DayPeriodsFormat=1]="DayPeriodsFormat",pP[pP.DayPeriodsStandalone=2]="DayPeriodsStandalone",pP[pP.DaysFormat=3]="DaysFormat",pP[pP.DaysStandalone=4]="DaysStandalone",pP[pP.MonthsFormat=5]="MonthsFormat",pP[pP.MonthsStandalone=6]="MonthsStandalone",pP[pP.Eras=7]="Eras",pP[pP.FirstDayOfWeek=8]="FirstDayOfWeek",pP[pP.WeekendRange=9]="WeekendRange",pP[pP.DateFormat=10]="DateFormat",pP[pP.TimeFormat=11]="TimeFormat",pP[pP.DateTimeFormat=12]="DateTimeFormat",pP[pP.NumberSymbols=13]="NumberSymbols",pP[pP.NumberFormats=14]="NumberFormats",pP[pP.CurrencyCode=15]="CurrencyCode",pP[pP.CurrencySymbol=16]="CurrencySymbol",pP[pP.CurrencyName=17]="CurrencyName",pP[pP.Currencies=18]="Currencies",pP[pP.Directionality=19]="Directionality",pP[pP.PluralCase=20]="PluralCase",pP[pP.ExtraData=21]="ExtraData",pP),gP=["zero","one","two","few","many"],yP="en-US",mP={marker:"element"},kP={marker:"ICU"},CP=((CP=CP||{})[CP.SHIFT=2]="SHIFT",CP[CP.APPEND_EAGERLY=1]="APPEND_EAGERLY",CP[CP.COMMENT=2]="COMMENT",CP),wP=yP;function _P(e){(function(e,t){null==e&&Mm("Expected localeId to be defined",e,null,"!=")})(e),"string"==typeof e&&(wP=e.toLowerCase().replace(/_/g,"-"))}function EP(e,t,n){var r=t.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return null===i?cE(e,0,n):Vk(n[i])}function bP(e,t,n,r,i){var a=t.insertBeforeIndex;if(Array.isArray(a)){var o=r,s=null;if(3&t.type||(s=o,o=i),null!==o&&0==(2&t.flags))for(var u=1;u<a.length;u++)iE(e,o,n[a[u]],s,!1)}}function SP(e,t){if(e.push(t),e.length>1)for(var n=e.length-2;n>=0;n--){var r=e[n];PP(r)||OP(r,t)&&null===TP(r)&&IP(r,t.index)}}function PP(e){return!(64&e.type)}function OP(e,t){return PP(t)||e.index>t.index}function TP(e){var t=e.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function IP(e,t){var n=e.insertBeforeIndex;Array.isArray(n)?n[0]=t:(hE(EP,bP),e.insertBeforeIndex=t)}function AP(e,t){var n=e.data[t];return null===n||"string"==typeof n?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function RP(e,t,n){var r=qE(e,n,64,null,null);return SP(t,r),r}function MP(e,t){var n=t[e.currentCaseLViewIndex];return null===n?n:n<0?~n:n}function xP(e){return e>>>17}function NP(e){return(131070&e)>>>1}var DP=0,LP=0;function FP(e,t,n,r){for(var i,a=n[11],o=null,s=0;s<t.length;s++){var u=t[s];if("string"==typeof u){var c=t[++s];null===n[c]&&(n[c]=j_(a,u))}else if("number"==typeof u)switch(1&u){case 0:var l=xP(u),f=void 0,h=void 0;if(null===o&&(o=l,i=sE(a,r)),l===o?(f=r,h=i):(f=null,h=Vk(n[l])),null!==h){var d=NP(u);iE(a,h,n[d],f,!1);var v=AP(e,d);if(null!==v&&"object"==typeof v){var p=MP(v,n);null!==p&&FP(e,v.create[p],n,n[v.anchorIdx])}}break;case 1:var g=t[++s],y=t[++s];pb(a,Bk(u>>>1,n),null,null,g,y,null);break;default:throw new Error('Unable to determine the type of mutate operation for "'.concat(u,'"'))}else switch(u){case kP:var m=t[++s],k=t[++s];null===n[k]&&R_(n[k]=K_(a,m),n);break;case mP:var C=t[++s],w=t[++s];null===n[w]&&R_(n[w]=Q_(a,C,null),n)}}}function UP(e,t,n,r,i){for(var a=0;a<n.length;a++){var o=n[a],s=n[++a];if(o&i)for(var u="",c=a+1;c<=a+s;c++){var l=n[c];if("string"==typeof l)u+=l;else if("number"==typeof l)if(l<0)u+=Im(t[r-l]);else{var f=l>>>2;switch(3&l){case 1:var h=n[++c],d=n[++c],v=e.data[f];"string"==typeof v?pb(t[11],t[f],null,v,h,u,d):ab(e,v,t,h,u,t[11],d,!1);break;case 0:var p=t[f];null!==p&&Y_(t[11],p,u);break;case 2:BP(e,AP(e,f),t,u);break;case 3:VP(e,AP(e,f),r,t)}}}else{var g=n[a+1];if(g>0&&3==(3&g)){var y=AP(e,g>>>2);t[y.currentCaseLViewIndex]<0&&VP(e,y,r,t)}}a+=s}}function VP(e,t,n,r){var i=r[t.currentCaseLViewIndex];if(null!==i){var a=DP;i<0&&(i=r[t.currentCaseLViewIndex]=~i,a=-1),UP(e,r,t.update[i],n,a)}}function BP(e,t,n,r){var i=function(e,t){var n=e.cases.indexOf(t);if(-1===n)switch(e.type){case 1:var r=function(e,t){var n=dP(t)(parseInt(e,10)),r=gP[n];return void 0!==r?r:"other"}(t,wP);-1===(n=e.cases.indexOf(r))&&"other"!==r&&(n=e.cases.indexOf("other"));break;case 0:n=e.cases.indexOf("other")}return-1===n?null:n}(t,r);if(MP(t,n)!==i&&(zP(e,t,n),n[t.currentCaseLViewIndex]=null===i?null:~i,null!==i)){var a=n[t.anchorIdx];a&&FP(e,t.create[i],n,a)}}function zP(e,t,n){var r=MP(t,n);if(null!==r)for(var i=t.remove[r],a=0;a<i.length;a++){var o=i[a];if(o>0){var s=Bk(o,n);null!==s&&yE(n[11],s)}else zP(e,AP(e,~o),n)}}function HP(){var e,t,n=[],r=-1;function i(e,n){r=0;var i=MP(e,n);t=null!==i?e.remove[i]:ek}function a(){if(r<t.length){var o=t[r++];return o>0?e[o]:(n.push(r,t),i(e[1].data[~o],e),a())}return 0===n.length?null:(t=n.pop(),r=n.pop(),a())}return function(t,r){for(e=r;n.length;)n.pop();return i(t.value,r),a}}var GP=/\ufffd(\d+):?\d*\ufffd/gi,$P=/\ufffd(\d+)\ufffd/,ZP=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,qP=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,WP=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,jP=/\uE500/g;function YP(e,t,n,r,i,a,o){var s=WE(e,r,1,null),u=s<<CP.SHIFT,c=rC();t===c&&(c=null),null===c&&(u|=CP.APPEND_EAGERLY),o&&(u|=CP.COMMENT,function(e){void 0===B_&&(B_=e())}(HP)),i.push(u,null===a?"":a);var l=qE(e,s,o?32:1,null===a?"":a,null);SP(n,l);var f=l.index;return iC(l,!1),null!==c&&t!==c&&function(e,t){var n=e.insertBeforeIndex;null===n?(hE(EP,bP),n=e.insertBeforeIndex=[null,t]):(function(e,t,n){true!=e&&Mm("Expecting array here",e,true,"==")}(Array.isArray(n)),n.push(t))}(c,f),l}function KP(e,t,n,r,i,a,o){var s=o.match(GP),u=YP(e,t,n,a,r,s?null:o,!1);s&&QP(i,o,u.index,null,0,null)}function QP(e,t,n,r,i,a){var o=e.length,s=o+1;e.push(null,null);for(var u=o+2,c=t.split(GP),l=0,f=0;f<c.length;f++){var h=c[f];if(1&f){var d=i+parseInt(h,10);e.push(-1-d),l|=XP(d)}else""!==h&&e.push(h)}return e.push(n<<2|(r?1:0)),r&&e.push(r,a),e[o]=l,e[s]=e.length-u,l}function XP(e){return 1<<Math.min(e,31)}function JP(e){for(var t,n,r="",i=0,a=!1;null!==(t=qP.exec(e));)a?t[0]==="\ufffd/*".concat(n,"\ufffd")&&(i=t.index,a=!1):(r+=e.substring(i,t.index+t[0].length),n=t[1],a=!0);return r+=e.substr(i)}function eO(e,t,n,r,i,a){var o=0,s={type:i.type,currentCaseLViewIndex:WE(e,t,1,null),anchorIdx:a,cases:[],create:[],remove:[],update:[]};(function(e,t,n){e.push(XP(t.mainBinding),2,-1-t.mainBinding,n<<2|2)})(n,i,a),function(e,t,n){var r=e.data[t];null===r?e.data[t]=n:r.value=n}(e,a,s);for(var u=i.values,c=0;c<u.length;c++){for(var l=u[c],f=[],h=0;h<l.length;h++){var d=l[h];if("string"!=typeof d){var v=f.push(d)-1;l[h]="\x3c!--\ufffd".concat(v,"\ufffd--\x3e")}}o=rO(e,s,t,n,r,i.cases[c],l.join(""),f)|o}o&&function(e,t,n){e.push(t,1,n<<2|3)}(n,o,a)}function tO(e){for(var t=[],n=[],r=1,i=0,a=nO(e=e.replace(ZP,function(e,t,n){return r="select"===n?0:1,i=parseInt(t.substr(1),10),""})),o=0;o<a.length;){var s=a[o++].trim();1===r&&(s=s.replace(/\s*(?:=)?(\w+)\s*/,"$1")),s.length&&t.push(s);var u=nO(a[o++]);t.length>n.length&&n.push(u)}return{type:r,mainBinding:i,cases:t,values:n}}function nO(e){if(!e)return[];var t,n=0,r=[],i=[],a=/[{}]/g;for(a.lastIndex=0;t=a.exec(e);){var o=t.index;if("}"==t[0]){if(r.pop(),0==r.length){var s=e.substring(n,o);ZP.test(s)?i.push(tO(s)):i.push(s),n=o+1}}else{if(0==r.length){var u=e.substring(n,o);i.push(u),n=o+1}r.push("{")}}var c=e.substring(n);return i.push(c),i}function rO(e,t,n,r,i,a,o,s){var u=[],c=[],l=[];t.cases.push(a),t.create.push(u),t.remove.push(c),t.update.push(l);var f=n_(Lk()).getInertBodyElement(o),h=S_(f)||f;return h?iO(e,t,n,r,u,c,l,h,i,s,0):0}function iO(e,t,n,r,i,a,o,s,u,c,l){for(var f=0,h=s.firstChild;h;){var d=WE(e,n,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:var v=h,p=v.tagName.toLowerCase();if(p_.hasOwnProperty(p)){sO(i,mP,p,u,d),e.data[d]=p;for(var g=v.attributes,y=0;y<g.length;y++){var m=g.item(y),k=m.name.toLowerCase();m.value.match(GP)?m_.hasOwnProperty(k)&&QP(o,m.value,d,m.name,0,g_[k]?s_:y_[k]?u_:null):uO(i,d,m)}f=iO(e,t,n,r,i,a,o,h,d,c,l+1)|f,aO(a,d,l)}break;case Node.TEXT_NODE:var C=h.textContent||"",w=C.match(GP);sO(i,null,w?"":C,u,d),aO(a,d,l),w&&(f=QP(o,C,d,null,0,null)|f);break;case Node.COMMENT_NODE:var _=$P.exec(h.textContent||"");if(_){var E=c[parseInt(_[1],10)];sO(i,kP,"",u,d),eO(e,n,r,u,E,d),oO(a,d,l)}}h=h.nextSibling}return f}function aO(e,t,n){0===n&&e.push(t)}function oO(e,t,n){0===n&&(e.push(~t),e.push(t))}function sO(e,t,n,r,i){null!==t&&e.push(t),e.push(n,i,function(e,t,n){return 0|t<<17|n<<1}(0,r,i))}function uO(e,t,n){e.push(t<<1|1,n.name,n.value)}function cO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=Jk(),i=Xk(),a=20+e,o=Wk(r.consts,t),s=rC();r.firstCreatePass&&function(e,t,n,r,i,a){var o=rC(),s=[],u=[],c=[[]];i=function(e,t){if(function(e){return-1===e}(t))return JP(e);var n=e.indexOf(":".concat(t,"\ufffd"))+2+t.toString().length,r=e.search(new RegExp("\ufffd\\/\\*\\d+:".concat(t,"\ufffd")));return JP(e.substring(n,r))}(i,a);for(var l=function(e){return e.replace(jP," ")}(i).split(WP),f=0;f<l.length;f++){var h=l[f];if(0==(1&f))for(var d=nO(h),v=0;v<d.length;v++){var p=d[v];if(0==(1&v)){var g=p;""!==g&&KP(e,o,c[0],s,u,n,g)}else{var y=p;if("object"!=typeof y)throw new Error('Unable to parse ICU expression in "'.concat(i,'" message.'));eO(e,n,u,t,y,YP(e,o,c[0],n,s,"",!0).index)}}else{var m=47===h.charCodeAt(0),k=(h.charCodeAt(m?1:0),20+Number.parseInt(h.substring(m?2:1)));if(m)c.shift(),iC(rC(),!1);else{var C=RP(e,c[0],k);c.unshift([]),iC(C,!0)}}}e.data[r]={create:s,update:u}}(r,null===s?0:s.index,i,a,o,n);var u=r.data[a],c=rE(r,s===i[6]?null:s,i);(function(e,t,n,r){for(var i=e[11],a=0;a<t.length;a++){var o=t[a++],s=t[a],u=(o&CP.COMMENT)===CP.COMMENT,c=(o&CP.APPEND_EAGERLY)===CP.APPEND_EAGERLY,l=o>>>CP.SHIFT,f=e[l];null===f&&(f=e[l]=u?i.createComment(s):j_(i,s)),c&&null!==n&&iE(i,n,f,r,!1)}})(i,u.create,c,s&&8&s.type?i[s.index]:null),dC(!0)}function lO(){dC(!1)}function fO(e,t,n){cO(e,t,n),lO()}function hO(e){return function(e){e&&(DP|=1<<Math.min(LP,31)),LP++}(uS(Xk(),fC(),e)),hO}function dO(e){!function(e,t,n){if(LP>0){var r=e.data[n];UP(e,t,Array.isArray(r)?r:r.update,lC()-LP-1,DP)}DP=0,LP=0}(Jk(),Xk(),e+20)}function vO(e,t,n,r,i){if(e=Pm(e),Array.isArray(e))for(var a=0;a<e.length;a++)vO(e[a],t,n,r,i);else{var o=Jk(),s=Xk(),u=Wb(e)?e:Pm(e.provide),c=$b(e),l=tC(),f=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(Wb(e)||!e.multi){var v=new LC(c,i,yS),p=yO(u,t,i?f:f+d,h);-1===p?(XC(jC(l,s),o,u),pO(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(v),s.push(v)):(n[p]=v,s[p]=v)}else{var g=yO(u,t,f+d,h),y=yO(u,t,f,f+d),m=g>=0&&n[g],k=y>=0&&n[y];if(i&&!k||!i&&!m){XC(jC(l,s),o,u);var C=function(e,t,n,r,i){var a=new LC(e,n,yS);return a.multi=[],a.index=t,a.componentProviders=0,gO(a,i,r&&!n),a}(i?kO:mO,n.length,i,r,c);!i&&k&&(n[y].providerFactory=C),pO(o,e,t.length,0),t.push(u),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(C),s.push(C)}else pO(o,e,g>-1?g:y,gO(n[i?y:g],c,!i&&r));!i&&r&&k&&n[y].componentProviders++}}}function pO(e,t,n,r){var i=Wb(t);if(i||function(e){return!!e.useClass}(t)){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!i&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[r,a]):o[s+1].push(r,a)}else o.push(n,a)}}}function gO(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function yO(e,t,n,r){for(var i=n;i<r;i++)if(t[i]===e)return i;return-1}function mO(e,t,n,r){return CO(this.multi,[])}function kO(e,t,n,r){var i,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=ow(n,n[1],this.providerFactory.index,r);CO(a,i=s.slice(0,o));for(var u=o;u<s.length;u++)i.push(s[u])}else CO(a,i=[]);return i}function CO(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function wO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=Jk();if(r.firstCreatePass){var i=bk(e);vO(n,r.data,r.blueprint,i,!0),vO(t,r.data,r.blueprint,i,!1)}}(n,r?r(e):e,t)}}}var _O=dy(function e(){fy(this,e)}),EO=function(){function e(){fy(this,e)}return dy(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(_m(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),bO=function(){var e=dy(function e(){fy(this,e)});return e.NULL=new EO,e}();function SO(){}function PO(e,t){return new TO(zk(e,t))}var OO=function(){return PO(tC(),Xk())},TO=function(){var e=dy(function e(t){fy(this,e),this.nativeElement=t});return e.__NG_ELEMENT_ID__=OO,e}();function IO(e){return e instanceof TO?e.nativeElement:e}var AO=dy(function e(){fy(this,e)}),RO=function(){var e=dy(function e(){fy(this,e)});return e.__NG_ELEMENT_ID__=function(){return MO()},e}(),MO=function(){var e=Xk(),t=$k(tC().index,e);return function(e){return e[11]}(kk(t)?t:e)},xO=function(){var e=dy(function e(){fy(this,e)});return e.\u0275prov=xm({token:e,providedIn:"root",factory:function(){return null}}),e}(),NO=dy(function e(t){fy(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}),DO=new NO("12.2.16"),LO=function(){function e(){fy(this,e)}return dy(e,[{key:"supports",value:function(e){return aS(e)}},{key:"create",value:function(e){return new UO(e)}}]),e}(),FO=function(e,t){return t},UO=function(){function e(t){fy(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||FO}return dy(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var a=!n||t&&t.currentIndex<HO(n,r,i)?t:n,o=HO(a,r,i),s=a.currentIndex;if(a===n)r--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)r++;else{i||(i=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var f=l<i.length?i[l]:i[l]=0,h=f+l;c<=h&&h<u&&(i[l]=f+1)}i[a.previousIndex]=c-u}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!aS(e))throw new Error("Error trying to diff '".concat(_m(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,i,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],i=this._trackByFn(s,r),null!==a&&Object.is(a.trackById,i)?(o&&(a=this._verifyReinsertion(a,r,i,s)),Object.is(a.item,r)||this._addIdentityChange(a,r)):(a=this._mismatch(a,r,i,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,i=e[rS()]();!(r=i.next()).done;)t(r.value)}(e,function(e){i=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,i)?(o&&(a=t._verifyReinsertion(a,e,i,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,i,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):e=this._addAfter(new VO(t,n),i,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new zO),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zO),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),VO=dy(function e(t,n){fy(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}),BO=function(){function e(){fy(this,e),this._head=null,this._tail=null}return dy(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),zO=function(){function e(){fy(this,e),this.map=new Map}return dy(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new BO,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function HO(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var GO=function(){function e(){fy(this,e)}return dy(e,[{key:"supports",value:function(e){return e instanceof Map||oS(e)}},{key:"create",value:function(){return new $O}}]),e}(),$O=function(){function e(){fy(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return dy(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||oS(e)))throw new Error("Error trying to diff '".concat(_m(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var a=new ZO(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),ZO=dy(function e(t){fy(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null});function qO(){return new WO([new LO])}var WO=function(){var e=function(){function e(t){fy(this,e),this.factories=t}return dy(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(null!=t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||qO())},deps:[[e,new $w,new Gw]]}}}]),e}();return e.\u0275prov=xm({token:e,providedIn:"root",factory:qO}),e}();function jO(){return new YO([new GO])}var YO=function(){var e=function(){function e(t){fy(this,e),this.factories=t}return dy(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||jO())},deps:[[e,new $w,new Gw]]}}}]),e}();return e.\u0275prov=xm({token:e,providedIn:"root",factory:jO}),e}();function KO(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var a=t[n.index];if(null!==a&&r.push(Vk(a)),Ck(a))for(var o=10;o<a.length;o++){var s=a[o],u=s[1].firstChild;null!==u&&KO(s[1],s,u,r)}var c=n.type;if(8&c)KO(e,t,n.child,r);else if(32&c)for(var l=H_(n,t),f=void 0;f=l();)r.push(f);else if(16&c){var h=pE(t,n);if(Array.isArray(h))r.push.apply(r,oy(h));else{var d=G_(t[16]);KO(d[1],d,h,r,!0)}}n=i?n.projectionNext:n.next}return r}var QO=function(){function e(t,n){fy(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return dy(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return KO(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(e){this._lView[8]=e}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(Ck(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(J_(e,n),ww(t,n))}this._attachedToViewContainer=!1}eE(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){rb(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){Eb(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){bb(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){uC(!0);try{bb(e,t,n)}finally{uC(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,kE(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),XO=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e))._view=e,r}return dy(n,[{key:"detectChanges",value:function(){Sb(this._view)}},{key:"checkNoChanges",value:function(){!function(e){uC(!0);try{Sb(e)}finally{uC(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(QO),JO=function(e){return function(e,t,n){if(_k(e)&&!n){var r=$k(e.index,t);return new QO(r,r)}return 47&e.type?new QO(t[16],t):null}(tC(),Xk(),16==(16&e))},eT=function(){var e=dy(function e(){fy(this,e)});return e.__NG_ELEMENT_ID__=JO,e}(),tT=[new GO],nT=new WO([new LO]),rT=new YO(tT),iT=function(){return sT(tC(),Xk())},aT=function(){var e=dy(function e(){fy(this,e)});return e.__NG_ELEMENT_ID__=iT,e}(),oT=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=r,a.elementRef=i,a}return dy(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=$E(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var r=this._declarationLView[19];return null!==r&&(n[19]=r.createEmbeddedView(t)),jE(t,n,e),new QO(n)}}]),n}(aT);function sT(e,t){return 4&e.type?new oT(t,e,PO(e,t)):null}var uT=dy(function e(){fy(this,e)}),cT=dy(function e(){fy(this,e)}),lT=function(){return pT(tC(),Xk())},fT=function(){var e=dy(function e(){fy(this,e)});return e.__NG_ELEMENT_ID__=lT,e}(),hT=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=r,a._hostLView=i,a}return dy(n,[{key:"element",get:function(){return PO(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new cw(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=QC(this._hostTNode,this._hostLView);if(HC(e)){var t=$C(e,this._hostLView),n=GC(e);return new cw(t[1].data[n+8],t)}return new cw(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=dT(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,i){var a=n||this.parentInjector;if(!i&&null==e.ngModule&&a){var o=a.get(uT,null);o&&(i=o)}var s=e.create(a,r,void 0,i);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var r=e._lView,i=r[1];if(Ck(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var u=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,r){var i=10+r,a=n.length;r>0&&(n[i-1][4]=t),r<a-10?(t[4]=n[i],Cw(n,10+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(i,r,c,u);var l=gE(u,c),f=r[11],h=sE(f,c[7]);return null!==h&&function(e,t,n,r,i,a){r[0]=i,r[6]=t,kE(e,r,n,1,i,a)}(i,c[6],f,r,h,l),e.attachToViewContainerRef(),Cw(vT(c),u,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=dT(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=J_(this._lContainer,t);n&&(ww(vT(this._lContainer),t),eE(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=J_(this._lContainer,t);return n&&null!=ww(vT(this._lContainer),t)?new QO(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!=e?e:this.length+t}}]),n}(fT);function dT(e){return e[8]}function vT(e){return e[8]||(e[8]=[])}function pT(e,t){var n,r=t[e.index];if(Ck(r))n=r;else{var i;if(8&e.type)i=Vk(r);else{var a=t[11];i=a.createComment("");var o=zk(e,t);iE(a,sE(a,o),i,function(e,t){return Fk(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=mb(r,t,i,e),_b(t,n)}return new hT(n,e,t)}var gT={},yT=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).ngModule=e,r}return dy(n,[{key:"resolveComponentFactory",value:function(e){var t=yk(e);return new CT(t,this.ngModule)}}]),n}(bO);function mT(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var kT=new pw("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return U_}}),CT=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).componentDef=e,i.ngModule=r,i.componentType=e.type,i.selector=e.selectors.map(xE).join(","),i.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],i.isBoundToModule=!!r,i}return dy(n,[{key:"inputs",get:function(){return mT(this.componentDef.inputs)}},{key:"outputs",get:function(){return mT(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,r){var i,a,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,i){var a=e.get(n,gT,i);return a!==gT||r===gT?a:t.get(n,r,i)}}}(e,r.injector):e,s=o.get(AO,Uk),u=o.get(xO,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",f=n?function(e,t,n){if(Fk(e))return e.selectRootElement(t,n===jm.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):Q_(s.createRenderer(null,this.componentDef),l,function(e){var t=e.toLowerCase();return"svg"===t?Dk:"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,d={components:[],scheduler:U_,clean:Ob,playerHandler:null,flags:0},v=nb(0,null,null,1,0,null,null,null,null,null),p=$E(null,v,d,h,null,null,s,c,u,o);CC(p);try{var g=function(e,t,n,r,i,a){var o=n[1];n[20]=e;var s=ZE(o,20,2,"#host",null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(xb(s,u,!0),null!==e&&(FC(i,e,u),null!==s.classes&&_E(i,e,s.classes),null!==s.styles&&wE(i,e,s.styles)));var c=r.createRenderer(e,t),l=$E(n,tb(t),null,t.onPush?64:16,n[20],s,r,c,null,null);return o.firstCreatePass&&(XC(jC(s,n),o,t.type),cb(o,s),fb(s,n.length,1)),_b(n,l),n[20]=l}(f,this.componentDef,p,s,c);if(f)if(n)FC(c,f,["ng-version",DO.full]);else{var y=function(e){for(var t=[],n=[],r=1,i=2;r<e.length;){var a=e[r];if("string"==typeof a)2===i?""!==a&&t.push(a,e[++r]):8===i&&n.push(a);else{if(!IE(i))break;i=a}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),m=y.attrs,k=y.classes;m&&FC(c,f,m),k&&k.length>0&&_E(c,f,k.join(" "))}if(a=Hk(v,20),void 0!==t)for(var C=a.projection=[],w=0;w<this.ngContentSelectors.length;w++){var _=t[w];C.push(null!=_?Array.from(_):null)}i=function(e,t,n,r,i){var a=n[1],o=function(e,t,n){var r=tC();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),hb(e,r,t,WE(e,t,1,null),n));var i=ow(t,e,r.directiveStart,r);R_(i,t);var a=zk(r,t);return a&&R_(a,t),i}(a,n,t);if(r.components.push(o),e[8]=o,i&&i.forEach(function(e){return e(o,t)}),t.contentQueries){var s=tC();t.contentQueries(1,o,s.directiveStart)}var u=tC();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(OC(u.index),sb(n[1],u,0,u.directiveStart,u.directiveEnd,t),ub(t,o)),o}(g,this.componentDef,p,d,[Kb]),jE(v,p,null)}finally{SC()}return new wT(this.componentType,i,PO(a,p),p,a)}}]),n}(_O),wT=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;return fy(this,n),(s=t.call(this)).location=i,s._rootLView=a,s._tNode=o,s.instance=r,s.hostView=s.changeDetectorRef=new XO(a),s.componentType=e,s}return dy(n,[{key:"injector",get:function(){return new cw(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return dy(function e(){fy(this,e)})}()),_T=new Map,ET=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;fy(this,n),(i=t.call(this))._parent=r,i._bootstrapComponents=[],i.injector=ry(i),i.destroyCbs=[],i.componentFactoryResolver=new yT(ry(i));var a=mk(e),o=e[ak]||null;return o&&_P(o),i._bootstrapComponents=V_(a.bootstrap),i._r3Injector=zb(e,r,[{provide:uT,useValue:ry(i)},{provide:bO,useValue:i.componentFactoryResolver}],_m(e)),i._r3Injector._resolveInjectorDefTypes(),i.instance=i.get(e),i}return dy(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yb.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gm.Default;return e===Yb||e===uT||e===Db?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(uT),bT=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).moduleType=e,null!==mk(e)&&function(e){var t=new Set;!function e(n){var r=mk(n,!0),i=r.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(_m(t)," vs ").concat(_m(t.name)))}(i,_T.get(i),n),_T.set(i,n));var a,o=uy(V_(r.imports));try{for(o.s();!(a=o.n()).done;){var s=a.value;t.has(s)||(t.add(s),e(s))}}catch(u){o.e(u)}finally{o.f()}}(e)}(e),r}return dy(n,[{key:"create",value:function(e){return new ET(this.moduleType,e)}}]),n}(cT);function ST(e,t,n){var r=cC()+e,i=Xk();return i[r]===NE?sS(i,r,n?t.call(n):t()):function(e,t){return e[t]}(i,r)}function PT(e,t,n,r){return IT(Xk(),cC(),e,t,n,r)}function OT(e,t,n,r,i){return AT(Xk(),cC(),e,t,n,r,i)}function TT(e,t){var n=e[t];return n===NE?void 0:n}function IT(e,t,n,r,i,a){var o=t+n;return uS(e,o,i)?sS(e,o+1,a?r.call(a,i):r(i)):TT(e,o+1)}function AT(e,t,n,r,i,a,o){var s=t+n;return cS(e,s,i,a)?sS(e,s+2,o?r.call(o,i,a):r(i,a)):TT(e,s+2)}function RT(e,t){var n,r=Jk(),i=e+20;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new Tm("302","The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[i]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(i,n.onDestroy)):n=r.data[i];var a=n.factory||(n.factory=Pk(n.type)),o=$m(yS);try{var s=qC(!1),u=a();return qC(s),function(e,t,n,r){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=r}(r,Xk(),i,u),u}finally{$m(o)}}function MT(e,t,n){var r=e+20,i=Xk(),a=Gk(i,r);return NT(i,xT(i,r)?IT(i,cC(),t,a.transform,n,a):a.transform(n))}function xT(e,t){return e[1].data[t].pure}function NT(e,t){return iS.isWrapped(t)&&(t=iS.unwrap(t),e[lC()]=NE),t}function DT(e){return function(t){setTimeout(e,void 0,t)}}var LT=function(e){Jg(n,e);var t=ty(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return fy(this,n),(e=t.call(this)).__isAsync=r,e}return dy(n,[{key:"emit",value:function(e){Qg(ay(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var i,a,o,s=e,u=t||function(){return null},c=r;if(e&&"object"==typeof e){var l=e;s=null===(i=l.next)||void 0===i?void 0:i.bind(l),u=null===(a=l.error)||void 0===a?void 0:a.bind(l),c=null===(o=l.complete)||void 0===o?void 0:o.bind(l)}this.__isAsync&&(u=DT(u),s&&(s=DT(s)),c&&(c=DT(c)));var f=Qg(ay(n.prototype),"subscribe",this).call(this,{next:s,error:u,complete:c});return e instanceof hy&&e.add(f),f}}]),n}(By);function FT(){return this._results[rS()]()}var UT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];fy(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=rS(),r=e.prototype;r[n]||(r[n]=FT)}return dy(e,[{key:"changes",get:function(){return this._changes||(this._changes=new LT)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){var n=this;n.dirty=!1;var r=mw(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var i=e[r],a=t[r];if(n&&(i=n(i),a=n(a)),a!==i)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}();Symbol;var VT=function(){function e(t){fy(this,e),this.queryList=t,this.matches=null}return dy(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),BT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];fy(this,e),this.queries=t}return dy(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,i=[],a=0;a<r;a++){var o=n.getByIndex(a);i.push(this.queries[o.indexInDeclarationView].clone())}return new e(i)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==QT(e,t).matches&&this.queries[t].setDirty()}}]),e}(),zT=dy(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;fy(this,e),this.predicate=t,this.flags=n,this.read=r}),HT=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];fy(this,e),this.queries=t}return dy(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var i=null!==n?n.length:0,a=this.getByIndex(r).embeddedTView(t,i);a&&(a.indexInDeclarationView=r,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),GT=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;fy(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return dy(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var r=0;r<n.length;r++){var i=n[r];this.matchTNodeWithReadOption(e,t,$T(t,i)),this.matchTNodeWithReadOption(e,t,aw(t,e,i,!1,!1))}else n===aT?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,aw(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===TO||r===fT||r===aT&&4&t.type)this.addMatch(t.index,-2);else{var i=aw(t,e,r,!1,!1);null!==i&&this.addMatch(t.index,i)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function $T(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function ZT(e,t,n,r){return-1===n?function(e,t){return 11&e.type?PO(e,t):4&e.type?sT(e,t):null}(t,e):-2===n?function(e,t,n){return n===TO?PO(t,e):n===aT?sT(t,e):n===fT?pT(t,e):void 0}(e,t,r):ow(e,e[1],n,t)}function qT(e,t,n,r){var i=t[19].queries[r];if(null===i.matches){for(var a=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:ZT(t,a[c],o[u+1],n.metadata.read))}i.matches=s}return i.matches}function WT(e,t,n,r){var i=e.queries.getByIndex(n),a=i.matches;if(null!==a)for(var o=qT(e,t,i,n),s=0;s<a.length;s+=2){var u=a[s];if(u>0)r.push(o[s/2]);else{for(var c=a[s+1],l=t[-u],f=10;f<l.length;f++){var h=l[f];h[17]===h[3]&&WT(h[1],h,c,r)}if(null!==l[9])for(var d=l[9],v=0;v<d.length;v++){var p=d[v];WT(p[1],p,c,r)}}}return r}function jT(e){var t=Xk(),n=Jk(),r=gC();yC(r+1);var i=QT(n,r);if(e.dirty&&Zk(t)===(2==(2&i.metadata.flags))){if(null===i.matches)e.reset([]);else{var a=i.crossesNgTemplate?WT(n,t,r,[]):qT(n,t,i,r);e.reset(a,IO),e.notifyOnChanges()}return!0}return!1}function YT(e,t,n){var r=Jk();r.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new HT),e.queries.track(new GT(t,-1))}(r,new zT(e,t,n)),2==(2&t)&&(r.staticViewQueries=!0)),function(e,t,n){var r=new UT(4==(4&n));rb(e,t,r,r.destroy),null===t[19]&&(t[19]=new BT),t[19].queries.push(new VT(r))}(r,Xk(),t)}function KT(){return e=Xk(),t=gC(),e[19].queries[t].queryList;var e,t}function QT(e,t){return e.queries.getByIndex(t)}function XT(e,t){return sT(e,t)}var JT=new pw("Application Initializer"),eI=function(){var e=function(){function e(t){var n=this;fy(this,e),this.appInits=t,this.resolve=SO,this.reject=SO,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return dy(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=function(n){var r=e.appInits[n]();if(PS(r))t.push(r);else if(OS(r)){var i=new Promise(function(e,t){r.subscribe({complete:e,error:t})});t.push(i)}},i=0;i<this.appInits.length;i++)r(i);Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(JT,8))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),tI=new pw("AppId"),nI={provide:tI,useFactory:function(){return"".concat(rI()).concat(rI()).concat(rI())},deps:[]};function rI(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var iI=new pw("Platform Initializer"),aI=new pw("Platform ID"),oI=new pw("appBootstrapListener"),sI=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),uI=new pw("LocaleId"),cI=new pw("DefaultCurrencyCode"),lI=dy(function e(t,n){fy(this,e),this.ngModuleFactory=t,this.componentFactories=n}),fI=function(e){return new bT(e)},hI=fI,dI=function(e){return Promise.resolve(fI(e))},vI=function(e){var t=fI(e),n=V_(mk(e).declarations).reduce(function(e,t){var n=yk(t);return n&&e.push(new CT(n)),e},[]);return new lI(t,n)},pI=vI,gI=function(e){return Promise.resolve(vI(e))},yI=function(){var e=function(){function e(){fy(this,e),this.compileModuleSync=hI,this.compileModuleAsync=dI,this.compileModuleAndAllComponentsSync=pI,this.compileModuleAndAllComponentsAsync=gI}return dy(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),mI=Promise.resolve(0);function kI(e){"undefined"==typeof Zone?mI.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var CI=function(){function e(t){var n=t.enableLongStackTrace,r=void 0!==n&&n,i=t.shouldCoalesceEventChangeDetection,a=void 0!==i&&i,o=t.shouldCoalesceRunChangeDetection,s=void 0!==o&&o;if(fy(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new LT(!1),this.onMicrotaskEmpty=new LT(!1),this.onStable=new LT(!1),this.onError=new LT(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var u=this;u._nesting=0,u._outer=u._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(u._inner=u._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(u._inner=u._inner.fork(Zone.longStackTraceZoneSpec)),u.shouldCoalesceEventChangeDetection=!s&&a,u.shouldCoalesceRunChangeDetection=s,u.lastRequestAnimationFrameId=-1,u.nativeRequestAnimationFrame=function(){var e=Xm.requestAnimationFrame,t=Xm.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){var t=function(){!function(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Xm,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,EI(e),e.isCheckStableRunning=!0,_I(e),e.isCheckStableRunning=!1},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),EI(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(n,r,i,a,o,s){try{return bI(e),n.invokeTask(i,a,o,s)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||e.shouldCoalesceRunChangeDetection)&&t(),SI(e)}},onInvoke:function(n,r,i,a,o,s,u){try{return bI(e),n.invoke(i,a,o,s,u)}finally{e.shouldCoalesceRunChangeDetection&&t(),SI(e)}},onHasTask:function(t,n,r,i){t.hasTask(r,i),n===r&&("microTask"==i.change?(e._hasPendingMicrotasks=i.microTask,EI(e),_I(e)):"macroTask"==i.change&&(e.hasPendingMacrotasks=i.macroTask))},onHandleError:function(t,n,r,i){return t.handleError(r,i),e.runOutsideAngular(function(){return e.onError.emit(i)}),!1}})}(u)}return dy(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var i=this._inner,a=i.scheduleEventTask("NgZoneEvent: "+r,e,wI,SO,SO);try{return i.runTask(a,t,n)}finally{i.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),wI={};function _I(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function EI(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function bI(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function SI(e){e._nesting--,_I(e)}var PI,OI=function(){function e(){fy(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new LT,this.onMicrotaskEmpty=new LT,this.onStable=new LT,this.onError=new LT}return dy(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),TI=function(){var e=function(){function e(t){var n=this;fy(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return dy(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){CI.assertNotInAngularZone(),kI(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())kI(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var r=this,i=-1;t&&t>0&&(i=setTimeout(function(){r._callbacks=r._callbacks.filter(function(e){return e.timeoutId!==i}),e(r._didWork,r.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(CI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),II=function(){var e=function(){function e(){fy(this,e),this._applications=new Map,AI.addToWindow(this)}return dy(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return AI.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),AI=new(function(){function e(){fy(this,e)}return dy(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),RI=!0,MI=!1,xI=new pw("AllowMultipleToken"),NI=dy(function e(t,n){fy(this,e),this.name=t,this.token=n});function DI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),i=new pw(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=LI();if(!a||a.injector.get(xI,!1))if(e)e(n.concat(t).concat({provide:i,useValue:!0}));else{var o=n.concat(t).concat({provide:i,useValue:!0},{provide:Fb,useValue:"platform"});!function(e){if(PI&&!PI.destroyed&&!PI.injector.get(xI,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");PI=e.get(FI);var t=e.get(iI,null);t&&t.forEach(function(e){return e()})}(Yb.create({providers:o,name:r}))}return function(e){var t=LI();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(i)}}function LI(){return PI&&!PI.destroyed?PI:null}var FI=function(){var e=function(){function e(t){fy(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return dy(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n=this,r=function(e,t){return"noop"===e?new OI:("zone.js"===e?void 0:e)||new CI({enableLongStackTrace:(MI=!0,RI),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)})}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:CI,useValue:r}];return r.run(function(){var a=Yb.create({providers:i,parent:n.injector,name:e.moduleType.name}),o=e.create(a),s=o.injector.get(D_,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.runOutsideAngular(function(){var e=r.onError.subscribe({next:function(e){s.handleError(e)}});o.onDestroy(function(){BI(n._modules,o),e.unsubscribe()})}),function(e,r,i){try{var a=((s=o.injector.get(eI)).runInitializers(),s.donePromise.then(function(){return _P(o.injector.get(uI,yP)||yP),n._moduleDoBootstrap(o),o}));return PS(a)?a.catch(function(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}):a}catch(t){throw r.runOutsideAngular(function(){return e.handleError(t)}),t}var s}(s,r)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=UI({},n);return function(e,t,n){var r=new bT(n);return Promise.resolve(r)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,r)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(VI);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(_m(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(Yb))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}();function UI(e,t){return Array.isArray(t)?t.reduce(UI,e):Object.assign(Object.assign({},e),t)}var VI=function(){var e=function(){function e(t,n,r,i,a){var o=this;fy(this,e),this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new Fy(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),u=new Fy(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){CI.assertNotInAngularZone(),kI(function(){!o._stable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks&&(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){CI.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=dm(t),i=function(e,t){return"number"==typeof fm(e)?e.pop():1/0}(t),a=t;return a.length?1===a.length?am(a[0]):cm(i)(ym(a,r)):lm}(s,u.pipe(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connector,n=void 0===t?function(){return new By}:t,r=e.resetOnError,i=void 0===r||r,a=e.resetOnComplete,o=void 0===a||a,s=e.resetOnRefCountZero,u=void 0===s||s;return function(e){var t=null,r=null,a=null,s=0,c=!1,l=!1,f=function(){null==r||r.unsubscribe(),r=null},h=function(){f(),t=a=null,c=l=!1},d=function(){var e=t;h(),null==e||e.unsubscribe()};return Gy(function(e,v){var p;s++,!l&&!c&&f();var g=a=null!==(p=a)&&void 0!==p?p:n();v.add(function(){0===--s&&!l&&!c&&(r=km(d,u))}),g.subscribe(v),t||(t=new Ay({next:function(e){return g.next(e)},error:function(e){l=!0,f(),r=km(h,i,e),g.error(e)},complete:function(){c=!0,f(),r=km(h,o),g.complete()}}),ym(e).subscribe(t))})(e)}}()))}return dy(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof _O?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=function(e){return e.isBoundToModule}(n)?void 0:this._injector.get(uT),a=n.create(Yb.NULL,[],t||n.selector,i),o=a.location.nativeElement,s=a.injector.get(TI,null),u=s&&a.injector.get(II);return s&&u&&u.registerApplication(o,s),a.onDestroy(function(){r.detachView(a.hostView),BI(r.components,a),u&&u.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=uy(this._views);try{for(n.s();!(t=n.n()).done;){var r;t.value.detectChanges()}}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;BI(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(oI,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(CI),Dw(Yb),Dw(D_),Dw(bO),Dw(eI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}();function BI(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var zI=dy(function e(){fy(this,e)}),HI=dy(function e(){fy(this,e)}),GI={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},$I=function(){var e=function(){function e(t,n){fy(this,e),this._compiler=t,this._config=n||GI}return dy(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=qg(e.split("#"),2),r=n[0],i=n[1];return void 0===i&&(i="default"),jg(8255)(r).then(function(e){return e[i]}).then(function(e){return ZI(e,r,i)}).then(function(e){return t._compiler.compileModuleAsync(e)})}},{key:"loadFactory",value:function(e){var t=qg(e.split("#"),2),n=t[0],r=t[1],i="NgFactory";return void 0===r&&(r="default",i=""),jg(8255)(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then(function(e){return e[r+i]}).then(function(e){return ZI(e,n,r)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(yI),Dw(HI,8))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}();function ZI(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var qI=DI(null,"core",[{provide:aI,useValue:"unknown"},{provide:FI,deps:[Yb]},{provide:II,deps:[]},{provide:sI,deps:[]}]),WI=[{provide:VI,useClass:VI,deps:[CI,Yb,D_,bO,eI]},{provide:kT,deps:[CI],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:eI,useClass:eI,deps:[[new Gw,JT]]},{provide:yI,useClass:yI,deps:[]},nI,{provide:WO,useFactory:function(){return nT},deps:[]},{provide:YO,useFactory:function(){return rT},deps:[]},{provide:uI,useFactory:function(e){return _P(e=e||"undefined"!=typeof $localize&&$localize.locale||yP),e},deps:[[new Hw(uI),new Gw,new $w]]},{provide:cI,useValue:"USD"}],jI=function(){var e=dy(function e(t){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)(Dw(VI))},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:WI}),e}(),YI=null;function KI(){return YI}var QI=new pw("DocumentToken"),XI=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({factory:JI,token:e,providedIn:"platform"}),e}();function JI(){return Dw(tA)}var eA=new pw("Location Initialized"),tA=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this))._doc=e,r._init(),r}return dy(n,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return KI().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){var t=KI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("popstate",e,!1),function(){return t.removeEventListener("popstate",e)}}},{key:"onHashChange",value:function(e){var t=KI().getGlobalEventTarget(this._doc,"window");return t.addEventListener("hashchange",e,!1),function(){return t.removeEventListener("hashchange",e)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(e,t,n){nA()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){nA()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(e)}},{key:"getState",value:function(){return this._history.state}}]),n}(XI);return e.\u0275fac=function(t){return new(t||e)(Dw(QI))},e.\u0275prov=xm({factory:rA,token:e,providedIn:"platform"}),e}();function nA(){return!!window.history.pushState}function rA(){return new tA(Dw(QI))}function iA(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function aA(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function oA(e){return e&&"?"!==e[0]?"?"+e:e}var sA=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"historyGo",value:function(e){throw new Error("Not implemented")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({factory:uA,token:e,providedIn:"root"}),e}();function uA(e){var t=Dw(QI).location;return new lA(Dw(XI),t&&t.origin||"")}var cA=new pw("appBaseHref"),lA=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;if(fy(this,n),(i=t.call(this))._platformLocation=e,i._removeListenerFns=[],null==r&&(r=i._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return i._baseHref=r,ny(i)}return dy(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return iA(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+oA(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+oA(r));this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+oA(r));this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(sA);return e.\u0275fac=function(t){return new(t||e)(Dw(XI),Dw(cA,8))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),fA=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this))._platformLocation=e,i._baseHref="",i._removeListenerFns=[],null!=r&&(i._baseHref=r),i}return dy(n,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=iA(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+oA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)}},{key:"replaceState",value:function(e,t,n,r){var i=this.prepareExternalUrl(n+oA(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformLocation).historyGo)||void 0===t||t.call(e,n)}}]),n}(sA);return e.\u0275fac=function(t){return new(t||e)(Dw(XI),Dw(cA,8))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),hA=function(){var e=function(){function e(t,n){var r=this;fy(this,e),this._subject=new LT,this._urlChangeListeners=[],this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=aA(vA(i)),this._platformStrategy.onPopState(function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})})}return dy(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+oA(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,vA(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+oA(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+oA(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(t=(e=this._platformStrategy).historyGo)||void 0===t||t.call(e,n)}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(n){return n(e,t)})}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(sA),Dw(XI))},e.normalizeQueryParams=oA,e.joinWithSlash=iA,e.stripTrailingSlash=aA,e.\u0275prov=xm({factory:dA,token:e,providedIn:"root"}),e}();function dA(){return new hA(Dw(sA),Dw(XI))}function vA(e){return e.replace(/\/index.html$/,"")}var pA=((pA=pA||{})[pA.Decimal=0]="Decimal",pA[pA.Percent=1]="Percent",pA[pA.Currency=2]="Currency",pA[pA.Scientific=3]="Scientific",pA),gA=((gA=gA||{})[gA.Zero=0]="Zero",gA[gA.One=1]="One",gA[gA.Two=2]="Two",gA[gA.Few=3]="Few",gA[gA.Many=4]="Many",gA[gA.Other=5]="Other",gA),yA=((yA=yA||{})[yA.Format=0]="Format",yA[yA.Standalone=1]="Standalone",yA),mA=((mA=mA||{})[mA.Narrow=0]="Narrow",mA[mA.Abbreviated=1]="Abbreviated",mA[mA.Wide=2]="Wide",mA[mA.Short=3]="Short",mA),kA=((kA=kA||{})[kA.Short=0]="Short",kA[kA.Medium=1]="Medium",kA[kA.Long=2]="Long",kA[kA.Full=3]="Full",kA),CA=((CA=CA||{})[CA.Decimal=0]="Decimal",CA[CA.Group=1]="Group",CA[CA.List=2]="List",CA[CA.PercentSign=3]="PercentSign",CA[CA.PlusSign=4]="PlusSign",CA[CA.MinusSign=5]="MinusSign",CA[CA.Exponential=6]="Exponential",CA[CA.SuperscriptingExponent=7]="SuperscriptingExponent",CA[CA.PerMille=8]="PerMille",CA[CA.Infinity=9]="Infinity",CA[CA.NaN=10]="NaN",CA[CA.TimeSeparator=11]="TimeSeparator",CA[CA.CurrencyDecimal=12]="CurrencyDecimal",CA[CA.CurrencyGroup=13]="CurrencyGroup",CA);function wA(e,t){return OA(hP(e)[pP.DateFormat],t)}function _A(e,t){return OA(hP(e)[pP.TimeFormat],t)}function EA(e,t){return OA(hP(e)[pP.DateTimeFormat],t)}function bA(e,t){var n=hP(e),r=n[pP.NumberSymbols][t];if(void 0===r){if(t===CA.CurrencyDecimal)return n[pP.NumberSymbols][CA.Decimal];if(t===CA.CurrencyGroup)return n[pP.NumberSymbols][CA.Group]}return r}var SA=dP;function PA(e){if(!e[pP.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[pP.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function OA(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function TA(e){var t=qg(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var IA=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,AA={},RA=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,MA=((MA=MA||{})[MA.Short=0]="Short",MA[MA.ShortGMT=1]="ShortGMT",MA[MA.Long=2]="Long",MA[MA.Extended=3]="Extended",MA),xA=((xA=xA||{})[xA.FullYear=0]="FullYear",xA[xA.Month=1]="Month",xA[xA.Date=2]="Date",xA[xA.Hours=3]="Hours",xA[xA.Minutes=4]="Minutes",xA[xA.Seconds=5]="Seconds",xA[xA.FractionalSeconds=6]="FractionalSeconds",xA[xA.Day=7]="Day",xA),NA=((NA=NA||{})[NA.DayPeriods=0]="DayPeriods",NA[NA.Days=1]="Days",NA[NA.Months=2]="Months",NA[NA.Eras=3]="Eras",NA);function DA(e,t,n,r){var i=function(e){if(jA(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){var t=e.split("-").map(function(e){return+e}),n=qg(t,3),r=n[0],i=n[1],a=void 0===i?1:i,o=n[2];return LA(r,a-1,void 0===o?1:o)}var s,u=parseFloat(e);if(!isNaN(e-u))return new Date(u);if(s=e.match(IA))return function(e){var t=new Date(0),n=0,r=0,i=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,u,c),t}(s)}var c=new Date(e);if(!jA(c))throw new Error('Unable to convert "'.concat(e,'" into a date'));return c}(e);t=FA(n,t)||t;for(var a,o=[];t;){if(!(a=RA.exec(t))){o.push(t);break}var s=(o=o.concat(a.slice(1))).pop();if(!s)break;t=s}var u=i.getTimezoneOffset();r&&(u=WA(r,u),i=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(WA(t,r)-r))}(i,r));var c="";return o.forEach(function(e){var t=function(e){if(qA[e])return qA[e];var t;switch(e){case"G":case"GG":case"GGG":t=zA(NA.Eras,mA.Abbreviated);break;case"GGGG":t=zA(NA.Eras,mA.Wide);break;case"GGGGG":t=zA(NA.Eras,mA.Narrow);break;case"y":t=BA(xA.FullYear,1,0,!1,!0);break;case"yy":t=BA(xA.FullYear,2,0,!0,!0);break;case"yyy":t=BA(xA.FullYear,3,0,!1,!0);break;case"yyyy":t=BA(xA.FullYear,4,0,!1,!0);break;case"Y":t=ZA(1);break;case"YY":t=ZA(2,!0);break;case"YYY":t=ZA(3);break;case"YYYY":t=ZA(4);break;case"M":case"L":t=BA(xA.Month,1,1);break;case"MM":case"LL":t=BA(xA.Month,2,1);break;case"MMM":t=zA(NA.Months,mA.Abbreviated);break;case"MMMM":t=zA(NA.Months,mA.Wide);break;case"MMMMM":t=zA(NA.Months,mA.Narrow);break;case"LLL":t=zA(NA.Months,mA.Abbreviated,yA.Standalone);break;case"LLLL":t=zA(NA.Months,mA.Wide,yA.Standalone);break;case"LLLLL":t=zA(NA.Months,mA.Narrow,yA.Standalone);break;case"w":t=$A(1);break;case"ww":t=$A(2);break;case"W":t=$A(1,!0);break;case"d":t=BA(xA.Date,1);break;case"dd":t=BA(xA.Date,2);break;case"c":case"cc":t=BA(xA.Day,1);break;case"ccc":t=zA(NA.Days,mA.Abbreviated,yA.Standalone);break;case"cccc":t=zA(NA.Days,mA.Wide,yA.Standalone);break;case"ccccc":t=zA(NA.Days,mA.Narrow,yA.Standalone);break;case"cccccc":t=zA(NA.Days,mA.Short,yA.Standalone);break;case"E":case"EE":case"EEE":t=zA(NA.Days,mA.Abbreviated);break;case"EEEE":t=zA(NA.Days,mA.Wide);break;case"EEEEE":t=zA(NA.Days,mA.Narrow);break;case"EEEEEE":t=zA(NA.Days,mA.Short);break;case"a":case"aa":case"aaa":t=zA(NA.DayPeriods,mA.Abbreviated);break;case"aaaa":t=zA(NA.DayPeriods,mA.Wide);break;case"aaaaa":t=zA(NA.DayPeriods,mA.Narrow);break;case"b":case"bb":case"bbb":t=zA(NA.DayPeriods,mA.Abbreviated,yA.Standalone,!0);break;case"bbbb":t=zA(NA.DayPeriods,mA.Wide,yA.Standalone,!0);break;case"bbbbb":t=zA(NA.DayPeriods,mA.Narrow,yA.Standalone,!0);break;case"B":case"BB":case"BBB":t=zA(NA.DayPeriods,mA.Abbreviated,yA.Format,!0);break;case"BBBB":t=zA(NA.DayPeriods,mA.Wide,yA.Format,!0);break;case"BBBBB":t=zA(NA.DayPeriods,mA.Narrow,yA.Format,!0);break;case"h":t=BA(xA.Hours,1,-12);break;case"hh":t=BA(xA.Hours,2,-12);break;case"H":t=BA(xA.Hours,1);break;case"HH":t=BA(xA.Hours,2);break;case"m":t=BA(xA.Minutes,1);break;case"mm":t=BA(xA.Minutes,2);break;case"s":t=BA(xA.Seconds,1);break;case"ss":t=BA(xA.Seconds,2);break;case"S":t=BA(xA.FractionalSeconds,1);break;case"SS":t=BA(xA.FractionalSeconds,2);break;case"SSS":t=BA(xA.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=HA(MA.Short);break;case"ZZZZZ":t=HA(MA.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=HA(MA.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=HA(MA.Long);break;default:return null}return qA[e]=t,t}(e);c+=t?t(i,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),c}function LA(e,t,n){var r=new Date(0);return r.setFullYear(e,t,n),r.setHours(0,0,0),r}function FA(e,t){var n=function(e){return hP(e)[pP.LocaleId]}(e);if(AA[n]=AA[n]||{},AA[n][t])return AA[n][t];var r="";switch(t){case"shortDate":r=wA(e,kA.Short);break;case"mediumDate":r=wA(e,kA.Medium);break;case"longDate":r=wA(e,kA.Long);break;case"fullDate":r=wA(e,kA.Full);break;case"shortTime":r=_A(e,kA.Short);break;case"mediumTime":r=_A(e,kA.Medium);break;case"longTime":r=_A(e,kA.Long);break;case"fullTime":r=_A(e,kA.Full);break;case"short":var i=FA(e,"shortTime"),a=FA(e,"shortDate");r=UA(EA(e,kA.Short),[i,a]);break;case"medium":var o=FA(e,"mediumTime"),s=FA(e,"mediumDate");r=UA(EA(e,kA.Medium),[o,s]);break;case"long":var u=FA(e,"longTime"),c=FA(e,"longDate");r=UA(EA(e,kA.Long),[u,c]);break;case"full":var l=FA(e,"fullTime"),f=FA(e,"fullDate");r=UA(EA(e,kA.Full),[l,f])}return r&&(AA[n][t]=r),r}function UA(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function VA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="";(e<0||i&&e<=0)&&(i?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),a+o}function BA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s=function(e,t){switch(e){case xA.FullYear:return t.getFullYear();case xA.Month:return t.getMonth();case xA.Date:return t.getDate();case xA.Hours:return t.getHours();case xA.Minutes:return t.getMinutes();case xA.Seconds:return t.getSeconds();case xA.FractionalSeconds:return t.getMilliseconds();case xA.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||s>-n)&&(s+=n),e===xA.Hours)0===s&&-12===n&&(s=12);else if(e===xA.FractionalSeconds)return function(e,t){return VA(e,3).substr(0,t)}(s,t);var u=bA(o,CA.MinusSign);return VA(s,t,u,r,i)}}function zA(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yA.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(i,a){return function(e,t,n,r,i,a){switch(n){case NA.Months:return function(e,t,n){var r=hP(e),i=OA([r[pP.MonthsFormat],r[pP.MonthsStandalone]],t);return OA(i,n)}(t,i,r)[e.getMonth()];case NA.Days:return function(e,t,n){var r=hP(e),i=OA([r[pP.DaysFormat],r[pP.DaysStandalone]],t);return OA(i,n)}(t,i,r)[e.getDay()];case NA.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(a){var u=function(e){var t=hP(e);return PA(t),(t[pP.ExtraData][2]||[]).map(function(e){return"string"==typeof e?TA(e):[TA(e[0]),TA(e[1])]})}(t),c=function(e,t,n){var r=hP(e);PA(r);var i=OA([r[pP.ExtraData][0],r[pP.ExtraData][1]],t)||[];return OA(i,n)||[]}(t,i,r),l=u.findIndex(function(e){if(Array.isArray(e)){var t=qg(e,2),n=t[0],r=t[1],i=o>=n.hours&&s>=n.minutes,a=o<r.hours||o===r.hours&&s<r.minutes;if(n.hours<r.hours){if(i&&a)return!0}else if(i||a)return!0}else if(e.hours===o&&e.minutes===s)return!0;return!1});if(-1!==l)return c[l]}return function(e,t,n){var r=hP(e),i=OA([r[pP.DayPeriodsFormat],r[pP.DayPeriodsStandalone]],t);return OA(i,n)}(t,i,r)[o<12?0:1];case NA.Eras:return function(e,t){return OA(hP(e)[pP.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(i,a,e,t,n,r)}}function HA(e){return function(t,n,r){var i=-1*r,a=bA(n,CA.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case MA.Short:return(i>=0?"+":"")+VA(o,2,a)+VA(Math.abs(i%60),2,a);case MA.ShortGMT:return"GMT"+(i>=0?"+":"")+VA(o,1,a);case MA.Long:return"GMT"+(i>=0?"+":"")+VA(o,2,a)+":"+VA(Math.abs(i%60),2,a);case MA.Extended:return 0===r?"Z":(i>=0?"+":"")+VA(o,2,a)+":"+VA(Math.abs(i%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function GA(e){return LA(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function $A(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var i;if(t){var a=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,o=n.getDate();i=1+Math.floor((o+a)/7)}else{var s=GA(n),u=function(e){var t=LA(e,0,1).getDay();return LA(e,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-u.getTime();i=1+Math.round(c/6048e5)}return VA(i,e,bA(r,CA.MinusSign))}}function ZA(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){return VA(GA(n).getFullYear(),e,bA(r,CA.MinusSign),t)}}var qA={};function WA(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function jA(e){return e instanceof Date&&!isNaN(e.valueOf())}var YA=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function KA(e){var t=parseInt(e);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+e);return t}var QA=dy(function e(){fy(this,e)}),XA=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).locale=e,r}return dy(n,[{key:"getPluralCategory",value:function(e,t){switch(SA(t||this.locale)(e)){case gA.Zero:return"zero";case gA.One:return"one";case gA.Two:return"two";case gA.Few:return"few";case gA.Many:return"many";default:return"other"}}}]),n}(QA);return e.\u0275fac=function(t){return new(t||e)(Dw(uI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}();function JA(e,t){t=encodeURIComponent(t);var n,r=uy(e.split(";"));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=i.indexOf("="),o=qg(-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}var eR=function(){var e=function(){function e(t,n,r,i){fy(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return dy(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(aS(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(_m(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(WO),yS(YO),yS(TO),yS(RO))},e.\u0275dir=pk({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e}(),tR=function(){function e(t,n,r,i){fy(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=i}return dy(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),nR=function(){var e=function(){function e(t,n,r){fy(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return dy(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(n){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat(function(e){return e.name||typeof e}(e),"'. NgFor only supports binding to Iterables such as Arrays."))}}if(this._differ){var t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new tR(null,t._ngForOf,-1,-1),null===i?void 0:i),o=new rR(e,a);n.push(o)}else if(null==i)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,i);var u=new rR(e,s);n.push(u)}});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var i=0,a=this._viewContainer.length;i<a;i++){var o=this._viewContainer.get(i);o.context.index=i,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(fT),yS(aT),yS(WO))},e.\u0275dir=pk({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e}(),rR=dy(function e(t,n){fy(this,e),this.record=t,this.view=n}),iR=function(){var e=function(){function e(t,n){fy(this,e),this._viewContainer=t,this._context=new aR,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return dy(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){oR("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){oR("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(fT),yS(aT))},e.\u0275dir=pk({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e}(),aR=dy(function e(){fy(this,e),this.$implicit=null,this.ngIf=null});function oR(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(_m(t),"'."))}var sR=function(){var e=function(){function e(t){fy(this,e),this._locale=t}return dy(e,[{key:"transform",value:function(t,n,r){if(!function(e){return!(null==e||""===e||e!=e)}(t))return null;r=r||this._locale;try{return function(e,t,n){return function(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!1;if(isFinite(e)){var c=function(e){var t,n,r,i,a,o=Math.abs(e)+"",s=0;for((n=o.indexOf("."))>-1&&(o=o.replace(".","")),(r=o.search(/e/i))>0?(n<0&&(n=r),n+=+o.slice(r+1),o=o.substring(0,r)):n<0&&(n=o.length),r=0;"0"===o.charAt(r);r++);if(r===(a=o.length))t=[0],n=1;else{for(a--;"0"===o.charAt(a);)a--;for(n-=r,t=[],i=0;r<=a;r++,i++)t[i]=Number(o.charAt(r))}return n>22&&(t=t.splice(0,21),s=n-1,n=1),{digits:t,exponent:s,integerLen:n}}(e);o&&(c=function(e){if(0===e.digits[0])return e;var t=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===t?e.digits.push(0,0):1===t&&e.digits.push(0),e.integerLen+=2),e}(c));var l=t.minInt,f=t.minFrac,h=t.maxFrac;if(a){var d=a.match(YA);if(null===d)throw new Error("".concat(a," is not a valid digit info"));var v=d[1],p=d[3],g=d[5];null!=v&&(l=KA(v)),null!=p&&(f=KA(p)),null!=g?h=KA(g):null!=p&&f>h&&(h=f)}!function(e,t,n){if(t>n)throw new Error("The minimum number of digits after fraction (".concat(t,") is higher than the maximum (").concat(n,")."));var r=e.digits,i=r.length-e.integerLen,a=Math.min(Math.max(t,i),n),o=a+e.integerLen,s=r[o];if(o>0){r.splice(Math.max(e.integerLen,o));for(var u=o;u<r.length;u++)r[u]=0}else{i=Math.max(0,i),e.integerLen=1,r.length=Math.max(1,o=a+1),r[0]=0;for(var c=1;c<o;c++)r[c]=0}if(s>=5)if(o-1<0){for(var l=0;l>o;l--)r.unshift(0),e.integerLen++;r.unshift(1),e.integerLen++}else r[o-1]++;for(;i<Math.max(0,a);i++)r.push(0);var f=0!==a,h=t+e.integerLen,d=r.reduceRight(function(e,t,n,r){return r[n]=(t+=e)<10?t:t-10,f&&(0===r[n]&&n>=h?r.pop():f=!1),t>=10?1:0},0);d&&(r.unshift(d),e.integerLen++)}(c,f,h);var y=c.digits,m=c.integerLen,k=c.exponent,C=[];for(u=y.every(function(e){return!e});m<l;m++)y.unshift(0);for(;m<0;m++)y.unshift(0);m>0?C=y.splice(m,y.length):(C=y,y=[0]);var w=[];for(y.length>=t.lgSize&&w.unshift(y.splice(-t.lgSize,y.length).join(""));y.length>t.gSize;)w.unshift(y.splice(-t.gSize,y.length).join(""));y.length&&w.unshift(y.join("")),s=w.join(bA(n,r)),C.length&&(s+=bA(n,i)+C.join("")),k&&(s+=bA(n,CA.Exponential)+"+"+k)}else s=bA(n,CA.Infinity);return s=e<0&&!u?t.negPre+s+t.negSuf:t.posPre+s+t.posSuf}(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=e.split(";"),i=r[0],a=r[1],o=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=o[0],u=o[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(var c=0;c<u.length;c++){var l=u.charAt(c);"0"===l?n.minFrac=n.maxFrac=c+1:"#"===l?n.maxFrac=c+1:n.posSuf+=l}var f=s.split(",");if(n.gSize=f[1]?f[1].length:0,n.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,a){var h=i.length-n.posPre.length-n.posSuf.length,d=a.indexOf("#");n.negPre=a.substr(0,d).replace(/'/g,""),n.negSuf=a.substr(d+h).replace(/'/g,"")}else n.negPre=t+n.posPre,n.negSuf=n.posSuf;return n}(function(e,t){return hP(e)[pP.NumberFormats][t]}(t,pA.Decimal),bA(t,CA.MinusSign)),t,CA.Group,CA.Decimal,n)}(function(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error("".concat(e," is not a number"));return e}(t),r,n)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(_m(e),"'"))}(e,i.message)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(uI,16))},e.\u0275pipe=gk({name:"number",type:e,pure:!0}),e}(),uR=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:[{provide:QA,useClass:XA}]}),e}(),cR=function(){var e=dy(function e(){fy(this,e)});return e.\u0275prov=xm({token:e,providedIn:"root",factory:function(){return new lR(Dw(QI),window)}}),e}(),lR=function(){function e(t,n){fy(this,e),this.document=t,this.window=n,this.offset=function(){return[0,0]}}return dy(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportsScrolling()){var t=function(e,t){var n=e.getElementById(t)||e.getElementsByName(t)[0];if(n)return n;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow))for(var r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;i;){var a=i.shadowRoot;if(a){var o=a.getElementById(t)||a.querySelector('[name="'.concat(t,'"]'));if(o)return o}i=r.nextNode()}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}},{key:"attemptFocus",value:function(e){return e.focus(),this.document.activeElement===e}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var e=fR(this.window.history)||fR(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(t){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}]),e}();function fR(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}var hR,dR=dy(function e(){fy(this,e)}),vR=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getBaseHref",value:function(e){var t=(pR=pR||document.querySelector("base"))?pR.getAttribute("href"):null;return null==t?null:function(e){(hR=hR||document.createElement("a")).setAttribute("href",e);var t=hR.pathname;return"/"===t.charAt(0)?t:"/".concat(t)}(t)}},{key:"resetBaseElement",value:function(){pR=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(e){return JA(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,YI||(YI=e)}}]),n}(function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).supportsDOMEvents=!0,e}return dy(n)}(function(){return dy(function e(){fy(this,e)})}())),pR=null,gR=new pw("TRANSITION_ID"),yR=[{provide:JT,useFactory:function(e,t,n){return function(){n.get(eI).donePromise.then(function(){for(var n=KI(),r=t.querySelectorAll('style[ng-transition="'.concat(e,'"]')),i=0;i<r.length;i++)n.remove(r[i])})}},deps:[gR,QI,Yb],multi:!0}],mR=function(){function e(){fy(this,e)}return dy(e,[{key:"addToWindow",value:function(e){Xm.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},Xm.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Xm.getAllAngularRootElements=function(){return e.getAllRootElements()},Xm.frameworkStabilizers||(Xm.frameworkStabilizers=[]),Xm.frameworkStabilizers.push(function(e){var t=Xm.getAllAngularTestabilities(),n=t.length,r=!1,i=function(t){r=r||t,0==--n&&e(r)};t.forEach(function(e){e.whenStable(i)})})}},{key:"findTestabilityInTree",value:function(e,t,n){var r;return null==t?null:null!==(r=e.getTestability(t))&&void 0!==r?r:n?KI().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,AI=t}}]),e}(),kR=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),CR=new pw("EventManagerPlugins"),wR=function(){var e=function(){function e(t,n){var r=this;fy(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=r}),this._plugins=t.slice().reverse()}return dy(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(CR),Dw(CI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),_R=function(){function e(t){fy(this,e),this._doc=t}return dy(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=KI().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),ER=function(){var e=function(){function e(){fy(this,e),this._stylesSet=new Set}return dy(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),bR=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Map,r._hostNodes.set(e.head,[]),r}return dy(n,[{key:"_addStylesToHost",value:function(e,t,n){var r=this;e.forEach(function(e){var i=r._doc.createElement("style");i.textContent=e,n.push(t.appendChild(i))})}},{key:"addHost",value:function(e){var t=[];this._addStylesToHost(this._stylesSet,e,t),this._hostNodes.set(e,t)}},{key:"removeHost",value:function(e){var t=this._hostNodes.get(e);t&&t.forEach(SR),this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n,r){t._addStylesToHost(e,r,n)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(e){return e.forEach(SR)})}}]),n}(ER);return e.\u0275fac=function(t){return new(t||e)(Dw(QI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}();function SR(e){KI().remove(e)}var PR={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},OR=/%COMP%/g;function TR(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?TR(e,i,n):(i=i.replace(OR,e),n.push(i))}return n}function IR(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var AR=function(){var e=function(){function e(t,n,r){fy(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new RR(t)}return dy(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case jm.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new MR(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case jm.ShadowDom:return new xR(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=TR(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(wR),Dw(bR),Dw(tI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),RR=function(){function e(t){fy(this,e),this.eventManager=t,this.data=Object.create(null)}return dy(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(PR[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var i=PR[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=PR[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&(z_.DashCase|z_.Important)?e.style.setProperty(t,n,r&z_.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&z_.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,IR(n)):this.eventManager.addEventListener(e,t,IR(n))}}]),e}(),MR=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;fy(this,n),(o=t.call(this,e)).component=i;var s=TR(a+"-"+i.id,i.styles,[]);return r.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(OR,a+"-"+i.id),o.hostAttr="_nghost-%COMP%".replace(OR,a+"-"+i.id),o}return dy(n,[{key:"applyToHost",value:function(e){Qg(ay(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=Qg(ay(n.prototype),"createElement",this).call(this,e,t);return Qg(ay(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(RR),xR=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;fy(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=i,o.shadowRoot=i.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=TR(a.id,a.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return dy(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return Qg(ay(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return Qg(ay(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return Qg(ay(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(Qg(ay(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(RR),NR=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){return fy(this,n),t.call(this,e)}return dy(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(_R);return e.\u0275fac=function(t){return new(t||e)(Dw(QI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),DR=["alt","control","meta","shift"],LR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},FR={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},UR={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},VR=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){return fy(this,n),t.call(this,e)}return dy(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var i=n.parseEventName(t),a=n.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return KI().onAndCancel(e,i.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var i=n._normalizeKey(t.pop()),a="";if(DR.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=i,0!=t.length||0===i.length)return null;var o={};return o.domEventName=r,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&FR.hasOwnProperty(t)&&(t=FR[t]))}return LR[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),DR.forEach(function(r){r!=n&&UR[r](e)&&(t+=r+".")}),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(i){n.getEventFullKey(i)===e&&r.runGuarded(function(){return t(i)})}}},{key:"_normalizeKey",value:function(e){return"esc"===e?"escape":e}}]),n}(_R);return e.\u0275fac=function(t){return new(t||e)(Dw(QI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),BR=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({factory:function(){return Dw(zR)},token:e,providedIn:"root"}),e}(),zR=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this))._doc=e,r}return dy(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case P_.NONE:return t;case P_.HTML:return e_(t,"HTML")?Jw(t):b_(this._doc,String(t)).toString();case P_.STYLE:return e_(t,"Style")?Jw(t):t;case P_.SCRIPT:if(e_(t,"Script"))return Jw(t);throw new Error("unsafe value used in a script context");case P_.URL:return t_(t),e_(t,"URL")?Jw(t):s_(String(t));case P_.RESOURCE_URL:if(e_(t,"ResourceURL"))return Jw(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return function(e){return new jw(e)}(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return function(e){return new Yw(e)}(e)}},{key:"bypassSecurityTrustScript",value:function(e){return function(e){return new Kw(e)}(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return function(e){return new Qw(e)}(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return function(e){return new Xw(e)}(e)}}]),n}(BR);return e.\u0275fac=function(t){return new(t||e)(Dw(QI))},e.\u0275prov=xm({factory:function(){return function(e){return new zR(e.get(QI))}(Dw(Db))},token:e,providedIn:"root"}),e}(),HR=[{provide:aI,useValue:"browser"},{provide:iI,useValue:function(){vR.makeCurrent(),mR.init()},multi:!0},{provide:QI,useFactory:function(){return e=document,Nk=e,document;var e},deps:[]}],GR=DI(qI,"browser",HR),$R=[[],{provide:Fb,useValue:"root"},{provide:D_,useFactory:function(){return new D_},deps:[]},{provide:CR,useClass:NR,multi:!0,deps:[QI,CI,aI]},{provide:CR,useClass:VR,multi:!0,deps:[QI]},[],{provide:AR,useClass:AR,deps:[wR,bR,tI]},{provide:AO,useExisting:AR},{provide:ER,useExisting:bR},{provide:bR,useClass:bR,deps:[QI]},{provide:TI,useClass:TI,deps:[CI]},{provide:wR,useClass:wR,deps:[CR,CI]},{provide:dR,useClass:kR,deps:[]},[]],ZR=function(){var e=function(){function e(t){if(fy(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return dy(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:tI,useValue:t.appId},{provide:gR,useExisting:tI},yR]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(e,12))},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:$R,imports:[uR,jI]}),e}();"undefined"!=typeof window&&window;var qR=Array.isArray,WR=Object.getPrototypeOf,jR=Object.prototype,YR=Object.keys;function KR(e){if(1===e.length){var t=e[0];if(qR(t))return{args:t,keys:null};if(function(e){return e&&"object"==typeof e&&WR(e)===jR}(t)){var n=YR(t);return{args:n.map(function(e){return t[e]}),keys:n}}}return{args:e,keys:null}}var QR=Array.isArray;function XR(e){return Zy(function(t){return function(e,t){return QR(t)?e.apply(void 0,oy(t)):e(t)}(e,t)})}function JR(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}var eM=function(){var e=function(){function e(t,n){fy(this,e),this._renderer=t,this._elementRef=n,this.onChange=function(e){},this.onTouched=function(){}}return dy(e,[{key:"setProperty",value:function(e,t){this._renderer.setProperty(this._elementRef.nativeElement,e,t)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"setDisabledState",value:function(e){this.setProperty("disabled",e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(RO),yS(TO))},e.\u0275dir=pk({type:e}),e}(),tM=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n)}(eM);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275dir=pk({type:t,features:[Qb]}),t}(),nM=new pw("NgValueAccessor"),rM={provide:nM,useExisting:Sm(function(){return aM}),multi:!0},iM=new pw("CompositionEventMode"),aM=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r))._compositionMode=i,a._composing=!1,null==a._compositionMode&&(a._compositionMode=!function(){var e=KI()?KI().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}()),a}return dy(n,[{key:"writeValue",value:function(e){this.setProperty("value",null!=e?e:"")}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),n}(eM);return e.\u0275fac=function(t){return new(t||e)(yS(RO),yS(TO),yS(iM,8))},e.\u0275dir=pk({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&TS("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[wO([rM]),Qb]}),e}();function oM(e){return null==e||0===e.length}function sM(e){return null!=e&&"number"==typeof e.length}var uM=new pw("NgValidators"),cM=new pw("NgAsyncValidators"),lM=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,fM=function(){function e(){fy(this,e)}return dy(e,null,[{key:"min",value:function(e){return t=e,function(e){if(oM(e.value)||oM(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null};var t}},{key:"max",value:function(e){return t=e,function(e){if(oM(e.value)||oM(t))return null;var n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null};var t}},{key:"required",value:function(e){return hM(e)}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return oM((t=e).value)||lM.test(t.value)?null:{email:!0};var t}},{key:"minLength",value:function(e){return t=e,function(e){return oM(e.value)||!sM(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null};var t}},{key:"maxLength",value:function(e){return dM(e)}},{key:"pattern",value:function(e){return function(e){return e?("string"==typeof e?(n="","^"!==e.charAt(0)&&(n+="^"),n+=e,"$"!==e.charAt(e.length-1)&&(n+="$"),t=new RegExp(n)):(n=e.toString(),t=e),function(e){if(oM(e.value))return null;var r=e.value;return t.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}):vM;var t,n}(e)}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){return CM(e)}},{key:"composeAsync",value:function(e){return _M(e)}}]),e}();function hM(e){return oM(e.value)?{required:!0}:null}function dM(e){return function(t){return sM(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null}}function vM(e){return null}function pM(e){return null!=e}function gM(e){var t=PS(e)?ym(e):e;return OS(t),t}function yM(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function mM(e,t){return t.map(function(t){return t(e)})}function kM(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function CM(e){if(!e)return null;var t=e.filter(pM);return 0==t.length?null:function(e){return yM(mM(e,t))}}function wM(e){return null!=e?CM(kM(e)):null}function _M(e){if(!e)return null;var t=e.filter(pM);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=hm(t),i=KR(t),a=i.args,o=i.keys,s=new Fy(function(e){var t=a.length;if(t)for(var n=new Array(t),r=t,i=t,s=function(t){var s=!1;am(a[t]).subscribe(new $y(e,function(e){s||(s=!0,i--),n[t]=e},function(){return r--},void 0,function(){(!r||!s)&&(i||e.next(o?JR(o,n):n),e.complete())}))},u=0;u<t;u++)s(u);else e.complete()});return r?s.pipe(XR(r)):s}(mM(e,t).map(gM)).pipe(Zy(yM))}}function EM(e){return null!=e?_M(kM(e)):null}function bM(e,t){return null===e?[t]:Array.isArray(e)?[].concat(oy(e),[t]):[e,t]}function SM(e){return e._rawValidators}function PM(e){return e._rawAsyncValidators}function OM(e){return e?Array.isArray(e)?e:[e]:[]}function TM(e,t){return Array.isArray(e)?e.includes(t):e===t}function IM(e,t){var n=OM(t);return OM(e).forEach(function(e){TM(n,e)||n.push(e)}),n}function AM(e,t){return OM(t).filter(function(t){return!TM(e,t)})}var RM=function(){var e=function(){function e(){fy(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return dy(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=wM(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=EM(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=pk({type:e}),e}(),MM=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(RM);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275dir=pk({type:t,features:[Qb]}),t}(),xM=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return dy(n)}(RM),NM=function(){function e(t){fy(this,e),this._cd=t}return dy(e,[{key:"is",value:function(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}]),e}(),DM=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){return fy(this,n),t.call(this,e)}return dy(n)}(NM);return e.\u0275fac=function(t){return new(t||e)(yS(xM,2))},e.\u0275dir=pk({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&ZS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[Qb]}),e}(),LM=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){return fy(this,n),t.call(this,e)}return dy(n)}(NM);return e.\u0275fac=function(t){return new(t||e)(yS(MM,10))},e.\u0275dir=pk({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,t){2&e&&ZS("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))("ng-submitted",t.is("submitted"))},features:[Qb]}),e}();function FM(e,t){return[].concat(oy(t.path),[e])}function UM(e,t){zM(e,t),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&GM(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&GM(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function VM(e,t){var n=function(){};t.valueAccessor&&(t.valueAccessor.registerOnChange(n),t.valueAccessor.registerOnTouched(n)),HM(e,t),e&&(t._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(function(){}))}function BM(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function zM(e,t){var n=SM(e);null!==t.validator?e.setValidators(bM(n,t.validator)):"function"==typeof n&&e.setValidators([n]);var r=PM(e);null!==t.asyncValidator?e.setAsyncValidators(bM(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);var i=function(){return e.updateValueAndValidity()};BM(t._rawValidators,i),BM(t._rawAsyncValidators,i)}function HM(e,t){var n=!1;if(null!==e){if(null!==t.validator){var r=SM(e);if(Array.isArray(r)&&r.length>0){var i=r.filter(function(e){return e!==t.validator});i.length!==r.length&&(n=!0,e.setValidators(i))}}if(null!==t.asyncValidator){var a=PM(e);if(Array.isArray(a)&&a.length>0){var o=a.filter(function(e){return e!==t.asyncValidator});o.length!==a.length&&(n=!0,e.setAsyncValidators(o))}}}var s=function(){};return BM(t._rawValidators,s),BM(t._rawAsyncValidators,s),n}function GM(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function $M(e,t){zM(e,t)}function ZM(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}function qM(e,t){e._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})}function WM(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===aM?n=e:function(e){return Object.getPrototypeOf(e.constructor)===tM}(e)?r=e:i=e}),i||r||n||null):null;var n,r,i}function jM(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var YM="VALID",KM="INVALID",QM="PENDING",XM="DISABLED";function JM(e){return(rx(e)?e.validators:e)||null}function ex(e){return Array.isArray(e)?wM(e):e||null}function tx(e,t){return(rx(t)?t.asyncValidators:e)||null}function nx(e){return Array.isArray(e)?EM(e):e||null}function rx(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var ix=function(){function e(t,n){fy(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=ex(this._rawValidators),this._composedAsyncValidatorFn=nx(this._rawAsyncValidators)}return dy(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return this.status===YM}},{key:"invalid",get:function(){return this.status===KM}},{key:"pending",get:function(){return this.status==QM}},{key:"disabled",get:function(){return this.status===XM}},{key:"enabled",get:function(){return this.status!==XM}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=ex(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=nx(e)}},{key:"addValidators",value:function(e){this.setValidators(IM(e,this._rawValidators))}},{key:"addAsyncValidators",value:function(e){this.setAsyncValidators(IM(e,this._rawAsyncValidators))}},{key:"removeValidators",value:function(e){this.setValidators(AM(e,this._rawValidators))}},{key:"removeAsyncValidators",value:function(e){this.setAsyncValidators(AM(e,this._rawAsyncValidators))}},{key:"hasValidator",value:function(e){return TM(this._rawValidators,e)}},{key:"hasAsyncValidator",value:function(e){return TM(this._rawAsyncValidators,e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status=QM,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=XM,this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status=YM,this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===YM||this.status===QM)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?XM:YM}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status=QM,this._hasOwnPendingAsyncValidator=!0;var n=gM(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t||(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length))return null;var r=e;return t.forEach(function(e){r=r instanceof ox?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof sx&&r.at(e)||null}),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new LT,this.statusChanges=new LT}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?XM:this.errors?KM:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(QM)?QM:this._anyControlsHaveStatus(KM)?KM:YM}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){rx(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),ax=function(e){Jg(n,e);var t=ty(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return fy(this,n),(e=t.call(this,JM(i),tx(a,i)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(i),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!e.asyncValidator}),e}return dy(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){jM(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){jM(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(ix),ox=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,JM(r),tx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return dy(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"removeControl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof ax?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var r=t.controls[n];r&&e(r,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var r=n[t],i=this.controls[r];if(this.contains(r)&&e(i))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(ix),sx=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,JM(r),tx(i,r))).controls=e,a._initObservables(),a._setUpdateStrategy(r),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!a.asyncValidator}),a}return dy(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}},{key:"insert",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}},{key:"removeAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}},{key:"setControl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof ax?e.value:e.getRawValue()})}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=uy(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(ix),ux={provide:MM,useExisting:Sm(function(){return lx})},cx=Promise.resolve(null),lx=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).submitted=!1,i._directives=[],i.ngSubmit=new LT,i.form=new ox({},wM(e),EM(r)),i}return dy(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;cx.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),UM(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;cx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),jM(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;cx.then(function(){var n=t._findContainer(e.path),r=new ox({});$M(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;cx.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;cx.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,qM(this.form,this._directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(MM);return e.\u0275fac=function(t){return new(t||e)(yS(uM,10),yS(cM,10))},e.\u0275dir=pk({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&TS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[wO([ux]),Qb]}),e}(),fx={provide:xM,useExisting:Sm(function(){return dx})},hx=Promise.resolve(null),dx=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this)).control=new ax,o._registered=!1,o.update=new LT,o._parent=e,o._setValidators(r),o._setAsyncValidators(i),o.valueAccessor=WM(0,a),o}return dy(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),ZM(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?FM(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){UM(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;hx.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;hx.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})}}]),n}(xM);return e.\u0275fac=function(t){return new(t||e)(yS(MM,9),yS(uM,10),yS(cM,10),yS(nM,10))},e.\u0275dir=pk({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[wO([fx]),Qb,Tk]}),e}(),vx=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=pk({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e}(),px=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({}),e}(),gx={provide:nM,useExisting:Sm(function(){return yx}),multi:!0},yx=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"writeValue",value:function(e){this.setProperty("value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}}]),n}(tM);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275dir=pk({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&TS("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[wO([gx]),Qb]}),t}(),mx=new pw("NgModelWithFormControlWarning"),kx={provide:MM,useExisting:Sm(function(){return Cx})},Cx=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).validators=e,i.asyncValidators=r,i.submitted=!1,i._onCollectionChange=function(){return i._updateDomValue()},i.directives=[],i.form=null,i.ngSubmit=new LT,i._setValidators(e),i._setAsyncValidators(r),i}return dy(n,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}},{key:"ngOnDestroy",value:function(){this.form&&(HM(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(function(){}))}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return UM(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){VM(e.control||null,e,!1),jM(this.directives,e)}},{key:"addFormGroup",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormGroup",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){this._setUpFormContainer(e)}},{key:"removeFormArray",value:function(e){this._cleanUpFormContainer(e)}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,qM(this.form,this.directives),this.ngSubmit.emit(e),!1}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach(function(t){var n=t.control,r=e.form.get(t.path);n!==r&&(VM(n||null,t),r instanceof ax&&(UM(r,t),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_setUpFormContainer",value:function(e){var t=this.form.get(e.path);$M(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"_cleanUpFormContainer",value:function(e){if(this.form){var t=this.form.get(e.path);t&&function(e,t){return HM(e,t)}(t,e)&&t.updateValueAndValidity({emitEvent:!1})}}},{key:"_updateRegistrations",value:function(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(function(){})}},{key:"_updateValidators",value:function(){zM(this.form,this),this._oldForm&&HM(this._oldForm,this)}},{key:"_checkFormPresent",value:function(){}}]),n}(MM);return e.\u0275fac=function(t){return new(t||e)(yS(uM,10),yS(cM,10))},e.\u0275dir=pk({type:e,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&TS("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[wO([kx]),Qb,Tk]}),e}(),wx={provide:xM,useExisting:Sm(function(){return _x})},_x=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;return fy(this,n),(s=t.call(this))._ngModelWarningConfig=o,s._added=!1,s.update=new LT,s._ngModelWarningSent=!1,s._parent=e,s._setValidators(r),s._setAsyncValidators(i),s.valueAccessor=WM(0,a),s}return dy(n,[{key:"isDisabled",set:function(e){}},{key:"ngOnChanges",value:function(e){this._added||this._setUpControl(),ZM(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"path",get:function(){return FM(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"_checkParentType",value:function(){}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}]),n}(xM);return e.\u0275fac=function(t){return new(t||e)(yS(MM,13),yS(uM,10),yS(cM,10),yS(nM,10),yS(mx,8))},e.\u0275dir=pk({type:e,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[wO([wx]),Qb,Tk]}),e._ngModelWarningSentOnce=!1,e}(),Ex={provide:nM,useExisting:Sm(function(){return Sx}),multi:!0};function bx(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var Sx=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return dy(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this.setProperty("selectedIndex",-1);var n=bx(t,e);this.setProperty("value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(tM);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275dir=pk({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&TS("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[wO([Ex]),Qb]}),t}(),Px=function(){var e=function(){function e(t,n,r){fy(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}return dy(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(bx(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(TO),yS(RO),yS(Sx,9))},e.\u0275dir=pk({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),Ox={provide:nM,useExisting:Sm(function(){return Ix}),multi:!0};function Tx(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var Ix=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments))._optionMap=new Map,e._idCounter=0,e._compareWith=Object.is,e}return dy(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var r=[];if(void 0!==n.selectedOptions)for(var i=n.selectedOptions,a=0;a<i.length;a++){var o=i.item(a),s=t._getOptionValue(o.value);r.push(s)}else for(var u=n.options,c=0;c<u.length;c++){var l=u.item(c);if(l.selected){var f=t._getOptionValue(l.value);r.push(f)}}t.value=r,e(r)}}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(tM);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275dir=pk({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&TS("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[wO([Ox]),Qb]}),t}(),Ax=function(){var e=function(){function e(t,n,r){fy(this,e),this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}return dy(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(Tx(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(Tx(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(TO),yS(RO),yS(Ix,9))},e.\u0275dir=pk({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e}(),Rx={provide:uM,useExisting:Sm(function(){return Mx}),multi:!0},Mx=function(){var e=function(){function e(){fy(this,e),this._required=!1}return dy(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?hM(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=pk({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&lS("required",t.required?"":null)},inputs:{required:"required"},features:[wO([Rx])]}),e}(),xx={provide:uM,useExisting:Sm(function(){return Nx}),multi:!0},Nx=function(){var e=function(){function e(){fy(this,e),this._validator=vM}return dy(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return this.enabled()?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){this._validator=this.enabled()?dM(function(e){return"number"==typeof e?e:parseInt(e,10)}(this.maxlength)):vM}},{key:"enabled",value:function(){return null!=this.maxlength}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=pk({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&lS("maxlength",t.enabled()?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[wO([xx]),Tk]}),e}(),Dx=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({imports:[[px]]}),e}(),Lx=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({imports:[Dx]}),e}(),Fx=function(){var e=function(){function e(){fy(this,e)}return dy(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:mx,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({imports:[Dx]}),e}(),Ux=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"group",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),i=null,a=null;return null!=n&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(n)?(i=null!=n.validators?n.validators:null,a=null!=n.asyncValidators?n.asyncValidators:null,t=null!=n.updateOn?n.updateOn:void 0):(i=null!=n.validator?n.validator:null,a=null!=n.asyncValidator?n.asyncValidator:null)),new ox(r,{asyncValidators:a,updateOn:t,validators:i})}},{key:"control",value:function(e,t,n){return new ax(e,t,n)}},{key:"array",value:function(e,t,n){var r=this,i=e.map(function(e){return r._createControl(e)});return new sx(i,t,n)}},{key:"_reduceControls",value:function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=t._createControl(e[r])}),n}},{key:"_createControl",value:function(e){return e instanceof ax||e instanceof ox||e instanceof sx?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({factory:function(){return new e},token:e,providedIn:Fx}),e}();function Vx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ym(t,dm(t))}function Bx(e,t){return iy(t)?um(e,t,1):um(e,1)}function zx(e,t){return Gy(function(n,r){var i=0;n.subscribe(new $y(r,function(n){return e.call(t,n,i++)&&r.next(n)}))})}var Hx=dy(function e(){fy(this,e)}),Gx=dy(function e(){fy(this,e)}),$x=function(){function e(t){var n=this;fy(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){n.headers=new Map,t.split("\n").forEach(function(e){var t=e.indexOf(":");if(t>0){var r=e.slice(0,t),i=r.toLowerCase(),a=e.slice(t+1).trim();n.maybeSetNormalizedName(r,i),n.headers.has(i)?n.headers.get(i).push(a):n.headers.set(i,[a])}})}:function(){n.headers=new Map,Object.keys(t).forEach(function(e){var r=t[e],i=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(n.headers.set(i,r),n.maybeSetNormalizedName(e,i))})}:this.headers=new Map}return dy(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})}},{key:"clone",value:function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,oy(n)),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var a=this.headers.get(t);if(!a)return;0===(a=a.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})}}]),e}(),Zx=function(){function e(){fy(this,e)}return dy(e,[{key:"encodeKey",value:function(e){return jx(e)}},{key:"encodeValue",value:function(e){return jx(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}(),qx=/%(\d[a-f0-9])/gi,Wx={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function jx(e){return encodeURIComponent(e).replace(qx,function(e,t){var n;return null!==(n=Wx[t])&&void 0!==n?n:e})}function Yx(e){return"".concat(e)}var Kx=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(fy(this,e),this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new Zx,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var n=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(function(e){var r=e.indexOf("="),i=qg(-1==r?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,r)),t.decodeValue(e.slice(r+1))],2),a=i[0],o=i[1],s=n.get(a)||[];s.push(o),n.set(a,s)}),n}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(function(e){var r=n.fromObject[e];t.map.set(e,Array.isArray(r)?r:[r])})):this.map=null}return dy(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"appendAll",value:function(e){var t=[];return Object.keys(e).forEach(function(n){var r=e[n];Array.isArray(r)?r.forEach(function(e){t.push({param:n,value:e,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).filter(function(e){return""!==e}).join("&")}},{key:"clone",value:function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(t),n}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(Yx(t.value)),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(Yx(t.value));-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=this.updates=null)}}]),e}(),Qx=function(){function e(){fy(this,e),this.map=new Map}return dy(e,[{key:"set",value:function(e,t){return this.map.set(e,t),this}},{key:"get",value:function(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}},{key:"delete",value:function(e){return this.map.delete(e),this}},{key:"keys",value:function(){return this.map.keys()}}]),e}();function Xx(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Jx(e){return"undefined"!=typeof Blob&&e instanceof Blob}function eN(e){return"undefined"!=typeof FormData&&e instanceof FormData}var tN=function(){function e(t,n,r,i){var a;if(fy(this,e),this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new $x),this.context||(this.context=new Qx),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=n;else{var s=n.indexOf("?");this.urlWithParams=n+(-1===s?"?":s<n.length-1?"&":"")+o}}else this.params=new Kx,this.urlWithParams=n}return dy(e,[{key:"serializeBody",value:function(){return null===this.body?null:Xx(this.body)||Jx(this.body)||eN(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof Kx?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||eN(this.body)?null:Jx(this.body)?this.body.type||null:Xx(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Kx?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.method||this.method,i=n.url||this.url,a=n.responseType||this.responseType,o=void 0!==n.body?n.body:this.body,s=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,u=void 0!==n.reportProgress?n.reportProgress:this.reportProgress,c=n.headers||this.headers,l=n.params||this.params,f=null!==(t=n.context)&&void 0!==t?t:this.context;return void 0!==n.setHeaders&&(c=Object.keys(n.setHeaders).reduce(function(e,t){return e.set(t,n.setHeaders[t])},c)),n.setParams&&(l=Object.keys(n.setParams).reduce(function(e,t){return e.set(t,n.setParams[t])},l)),new e(r,i,o,{params:l,headers:c,context:f,reportProgress:u,responseType:a,withCredentials:s})}}]),e}(),nN=((nN=nN||{})[nN.Sent=0]="Sent",nN[nN.UploadProgress=1]="UploadProgress",nN[nN.ResponseHeader=2]="ResponseHeader",nN[nN.DownloadProgress=3]="DownloadProgress",nN[nN.Response=4]="Response",nN[nN.User=5]="User",nN),rN=dy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";fy(this,e),this.headers=t.headers||new $x,this.status=void 0!==t.status?t.status:n,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}),iN=function(e){Jg(n,e);var t=ty(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fy(this,n),(e=t.call(this,r)).type=nN.ResponseHeader,e}return dy(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(rN),aN=function(e){Jg(n,e);var t=ty(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fy(this,n),(e=t.call(this,r)).type=nN.Response,e.body=void 0!==r.body?r.body:null,e}return dy(n,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new n({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),n}(rN),oN=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",r.ok=!1,r.message=r.status>=200&&r.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),r.error=e.error||null,r}return dy(n)}(rN);function sN(e,t){return{body:t,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var uN=function(){var e=function(){function e(t){fy(this,e),this.handler=t}return dy(e,[{key:"request",value:function(e,t){var n,r,i,a=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e instanceof tN?n=e:(r=o.headers instanceof $x?o.headers:new $x(o.headers),o.params&&(i=o.params instanceof Kx?o.params:new Kx({fromObject:o.params})),n=new tN(e,t,void 0!==o.body?o.body:null,{headers:r,context:o.context,params:i,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials}));var s=Vx(n).pipe(Bx(function(e){return a.handler.handle(e)}));if(e instanceof tN||"events"===o.observe)return s;var u=s.pipe(zx(function(e){return e instanceof aN}));switch(o.observe||"body"){case"body":switch(n.responseType){case"arraybuffer":return u.pipe(Zy(function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body}));case"blob":return u.pipe(Zy(function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body}));case"text":return u.pipe(Zy(function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body}));default:return u.pipe(Zy(function(e){return e.body}))}case"response":return u;default:throw new Error("Unreachable: unhandled observe type ".concat(o.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new Kx).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,sN(n,t))}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,sN(n,t))}},{key:"put",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,sN(n,t))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(Hx))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),cN=function(){function e(t,n){fy(this,e),this.next=t,this.interceptor=n}return dy(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),lN=new pw("HTTP_INTERCEPTORS"),fN=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),hN=/^\)\]\}',?\n/,dN=function(){var e=function(){function e(t){fy(this,e),this.xhrFactory=t}return dy(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Fy(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var a=e.responseType.toLowerCase();r.responseType="json"!==a?a:"text"}var o=e.serializeBody(),s=null,u=function(){if(null!==s)return s;var t=1223===r.status?204:r.status,n=r.statusText||"OK",i=new $x(r.getAllResponseHeaders()),a=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(r)||e.url;return s=new iN({headers:i,status:t,statusText:n,url:a})},c=function(){var t=u(),i=t.headers,a=t.status,o=t.statusText,s=t.url,c=null;204!==a&&(c=void 0===r.response?r.responseText:r.response),0===a&&(a=c?200:0);var l=a>=200&&a<300;if("json"===e.responseType&&"string"==typeof c){var f=c;c=c.replace(hN,"");try{c=""!==c?JSON.parse(c):null}catch(h){c=f,l&&(l=!1,c={error:h,text:c})}}l?(n.next(new aN({body:c,headers:i,status:a,statusText:o,url:s||void 0})),n.complete()):n.error(new oN({error:c,headers:i,status:a,statusText:o,url:s||void 0}))},l=function(e){var t=u().url,i=new oN({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error",url:t||void 0});n.error(i)},f=!1,h=function(t){f||(n.next(u()),f=!0);var i={type:nN.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&!!r.responseText&&(i.partialText=r.responseText),n.next(i)},d=function(e){var t={type:nN.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",c),r.addEventListener("error",l),r.addEventListener("timeout",l),r.addEventListener("abort",l),e.reportProgress&&(r.addEventListener("progress",h),null!==o&&r.upload&&r.upload.addEventListener("progress",d)),r.send(o),n.next({type:nN.Sent}),function(){r.removeEventListener("error",l),r.removeEventListener("abort",l),r.removeEventListener("load",c),r.removeEventListener("timeout",l),e.reportProgress&&(r.removeEventListener("progress",h),null!==o&&r.upload&&r.upload.removeEventListener("progress",d)),r.readyState!==r.DONE&&r.abort()}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(dR))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),vN=new pw("XSRF_COOKIE_NAME"),pN=new pw("XSRF_HEADER_NAME"),gN=dy(function e(){fy(this,e)}),yN=function(){var e=function(){function e(t,n,r){fy(this,e),this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return dy(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=JA(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(QI),Dw(aI),Dw(vN))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),mN=function(){var e=function(){function e(t,n){fy(this,e),this.tokenService=t,this.headerName=n}return dy(e,[{key:"intercept",value:function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null!==r&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(gN),Dw(pN))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),kN=function(){var e=function(){function e(t,n){fy(this,e),this.backend=t,this.injector=n,this.chain=null}return dy(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(lN,[]);this.chain=t.reduceRight(function(e,t){return new cN(e,t)},this.backend)}return this.chain.handle(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(Gx),Dw(Yb))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),CN=function(){var e=function(){function e(){fy(this,e)}return dy(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:mN,useClass:fN}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:vN,useValue:t.cookieName}:[],t.headerName?{provide:pN,useValue:t.headerName}:[]]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:[mN,{provide:lN,useExisting:mN,multi:!0},{provide:gN,useClass:yN},{provide:vN,useValue:"XSRF-TOKEN"},{provide:pN,useValue:"X-XSRF-TOKEN"}]}),e}(),wN=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:[uN,{provide:Hx,useClass:kN},dN,{provide:Gx,useExisting:dN}],imports:[[CN.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),e}(),_N=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this))._value=e,r}return dy(n,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(e){var t=Qg(ay(n.prototype),"_subscribe",this).call(this,e);return!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){var e=this.hasError,t=this.thrownError,n=this._value;if(e)throw t;return this._throwIfClosed(),n}},{key:"next",value:function(e){Qg(ay(n.prototype),"next",this).call(this,this._value=e)}}]),n}(By);function EN(e,t,n){e?sm(n,e,t):t()}var bN=sy(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function SN(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return cm(1)(ym(t,dm(t)))}function PN(e){return new Fy(function(t){am(e()).subscribe(t)})}function ON(){return Gy(function(e,t){var n=null;e._refCount++;var r=new $y(t,void 0,void 0,void 0,function(){if(!e||e._refCount<=0||0<--e._refCount)n=null;else{var r=e._connection,i=n;n=null,r&&(!i||r===i)&&r.unsubscribe(),t.unsubscribe()}});e.subscribe(r),r.closed||(n=e.connect())})}var TN=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).source=e,i.subjectFactory=r,i._subject=null,i._refCount=0,i._connection=null,Hy(e)&&(i.lift=e.lift),i}return dy(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var e=this._connection;this._subject=this._connection=null,null==e||e.unsubscribe()}},{key:"connect",value:function(){var e=this,t=this._connection;if(!t){t=this._connection=new hy;var n=this.getSubject();t.add(this.source.subscribe(new $y(n,void 0,function(){e._teardown(),n.complete()},function(t){e._teardown(),n.error(t)},function(){return e._teardown()}))),t.closed&&(this._connection=null,t=hy.EMPTY)}return t}},{key:"refCount",value:function(){return ON()(this)}}]),n}(Fy);function IN(e,t){return Gy(function(n,r){var i=null,a=0,o=!1,s=function(){return o&&!i&&r.complete()};n.subscribe(new $y(r,function(n){null==i||i.unsubscribe();var o=0,u=a++;am(e(n,u)).subscribe(i=new $y(r,function(e){return r.next(t?t(n,e,u,o++):e)},function(){i=null,s()}))},function(){o=!0,s()}))})}function AN(e,t,n,r,i){return function(a,o){var s=n,u=t,c=0;a.subscribe(new $y(o,function(t){var n=c++;u=s?e(u,t,n):(s=!0,t),r&&o.next(u)},i&&function(){s&&o.next(u),o.complete()}))}}function RN(e,t){return Gy(AN(e,t,arguments.length>=2,!0))}function MN(e){return Gy(function(t,n){var r,i=null,a=!1;i=t.subscribe(new $y(n,void 0,void 0,function(o){r=am(e(o,MN(e)(t))),i?(i.unsubscribe(),i=null,r.subscribe(n)):a=!0})),a&&(i.unsubscribe(),i=null,r.subscribe(n))})}function xN(e){return e<=0?function(){return lm}:Gy(function(t,n){var r=[];t.subscribe(new $y(n,function(t){r.push(t),e<r.length&&r.shift()},function(){var e,t=uy(r);try{for(t.s();!(e=t.n()).done;){var i=e.value;n.next(i)}}catch(a){t.e(a)}finally{t.f()}n.complete()},void 0,function(){r=null}))})}function NN(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DN;return Gy(function(t,n){var r=!1;t.subscribe(new $y(n,function(e){r=!0,n.next(e)},function(){return r?n.complete():n.error(e())}))})}function DN(){return new bN}function LN(e){return Gy(function(t,n){var r=!1;t.subscribe(new $y(n,function(e){r=!0,n.next(e)},function(){r||n.next(e),n.complete()}))})}function FN(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?zx(function(t,n){return e(t,n,r)}):Ly,mm(1),n?LN(t):NN(function(){return new bN}))}}function UN(e,t,n){var r=iy(e)||t||n?{next:e,error:t,complete:n}:e;return r?Gy(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(new $y(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):Ly}var VN=dy(function e(t,n){fy(this,e),this.id=t,this.url=n}),BN=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return fy(this,n),(i=t.call(this,e,r)).navigationTrigger=a,i.restoredState=o,i}return dy(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(VN),zN=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).urlAfterRedirects=i,a}return dy(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(VN),HN=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).reason=i,a}return dy(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(VN),GN=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).error=i,a}return dy(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(VN),$N=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return dy(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(VN),ZN=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return dy(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(VN),qN=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;return fy(this,n),(s=t.call(this,e,r)).urlAfterRedirects=i,s.state=a,s.shouldActivate=o,s}return dy(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(VN),WN=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return dy(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(VN),jN=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r)).urlAfterRedirects=i,o.state=a,o}return dy(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(VN),YN=function(){function e(t){fy(this,e),this.route=t}return dy(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),KN=function(){function e(t){fy(this,e),this.route=t}return dy(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),QN=function(){function e(t){fy(this,e),this.snapshot=t}return dy(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),XN=function(){function e(t){fy(this,e),this.snapshot=t}return dy(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),JN=function(){function e(t){fy(this,e),this.snapshot=t}return dy(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),eD=function(){function e(t){fy(this,e),this.snapshot=t}return dy(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),tD=function(){function e(t,n,r){fy(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return dy(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),nD="primary",rD=function(){function e(t){fy(this,e),this.params=t||{}}return dy(e,[{key:"has",value:function(e){return Object.prototype.hasOwnProperty.call(this.params,e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function iD(e){return new rD(e)}var aD="ngNavigationCancelingError";function oD(e){var t=Error("NavigationCancelingError: "+e);return t[aD]=!0,t}function sD(e,t,n){var r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},a=0;a<r.length;a++){var o=r[a],s=e[a];if(o.startsWith(":"))i[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function uD(e,t){var n,r=e?Object.keys(e):void 0,i=t?Object.keys(t):void 0;if(!r||!i||r.length!=i.length)return!1;for(var a=0;a<r.length;a++)if(!cD(e[n=r[a]],t[n]))return!1;return!0}function cD(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;var n=oy(e).sort(),r=oy(t).sort();return n.every(function(e,t){return r[t]===e})}return e===t}function lD(e){return Array.prototype.concat.apply([],e)}function fD(e){return e.length>0?e[e.length-1]:null}function hD(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function dD(e){return OS(e)?e:PS(e)?ym(Promise.resolve(e)):Vx(e)}var vD={exact:function e(t,n,r){if(!ED(t.segments,n.segments)||!kD(t.segments,n.segments,r)||t.numberOfChildren!==n.numberOfChildren)return!1;for(var i in n.children)if(!t.children[i]||!e(t.children[i],n.children[i],r))return!1;return!0},subset:yD},pD={exact:function(e,t){return uD(e,t)},subset:function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(function(n){return cD(e[n],t[n])})},ignored:function(){return!0}};function gD(e,t,n){return vD[n.paths](e.root,t.root,n.matrixParams)&&pD[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function yD(e,t,n){return mD(e,t,t.segments,n)}function mD(e,t,n,r){if(e.segments.length>n.length){var i=e.segments.slice(0,n.length);return!(!ED(i,n)||t.hasChildren()||!kD(i,n,r))}if(e.segments.length===n.length){if(!ED(e.segments,n)||!kD(e.segments,n,r))return!1;for(var a in t.children)if(!e.children[a]||!yD(e.children[a],t.children[a],r))return!1;return!0}var o=n.slice(0,e.segments.length),s=n.slice(e.segments.length);return!!(ED(e.segments,o)&&kD(e.segments,o,r)&&e.children[nD])&&mD(e.children[nD],t,s,r)}function kD(e,t,n){return t.every(function(t,r){return pD[n](e[r].parameters,t.parameters)})}var CD=function(){function e(t,n,r){fy(this,e),this.root=t,this.queryParams=n,this.fragment=r}return dy(e,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=iD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return PD.serialize(this)}}]),e}(),wD=function(){function e(t,n){var r=this;fy(this,e),this.segments=t,this.children=n,this.parent=null,hD(n,function(e,t){return e.parent=r})}return dy(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return OD(this)}}]),e}(),_D=function(){function e(t,n){fy(this,e),this.path=t,this.parameters=n}return dy(e,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=iD(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return ND(this)}}]),e}();function ED(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}var bD=dy(function e(){fy(this,e)}),SD=function(){function e(){fy(this,e)}return dy(e,[{key:"parse",value:function(e){var t=new VD(e);return new CD(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n="/".concat(TD(e.root,!0)),r=function(e){var t=Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return"".concat(AD(t),"=").concat(AD(e))}).join("&"):"".concat(AD(t),"=").concat(AD(n))}).filter(function(e){return!!e});return t.length?"?".concat(t.join("&")):""}(e.queryParams);return"".concat(n).concat(r).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),PD=new SD;function OD(e){return e.segments.map(function(e){return ND(e)}).join("/")}function TD(e,t){if(!e.hasChildren())return OD(e);if(t){var n=e.children[nD]?TD(e.children[nD],!1):"",r=[];return hD(e.children,function(e,t){t!==nD&&r.push("".concat(t,":").concat(TD(e,!1)))}),r.length>0?"".concat(n,"(").concat(r.join("//"),")"):n}var i=function(e,t){var n=[];return hD(e.children,function(e,r){r===nD&&(n=n.concat(t(e,r)))}),hD(e.children,function(e,r){r!==nD&&(n=n.concat(t(e,r)))}),n}(e,function(t,n){return n===nD?[TD(e.children[nD],!1)]:["".concat(n,":").concat(TD(t,!1))]});return 1===Object.keys(e.children).length&&null!=e.children[nD]?"".concat(OD(e),"/").concat(i[0]):"".concat(OD(e),"/(").concat(i.join("//"),")")}function ID(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function AD(e){return ID(e).replace(/%3B/gi,";")}function RD(e){return ID(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function MD(e){return decodeURIComponent(e)}function xD(e){return MD(e.replace(/\+/g,"%20"))}function ND(e){return"".concat(RD(e.path)).concat(function(e){return Object.keys(e).map(function(t){return";".concat(RD(t),"=").concat(RD(e[t]))}).join("")}(e.parameters))}var DD=/^[^\/()?;=#]+/;function LD(e){var t=e.match(DD);return t?t[0]:""}var FD=/^[^=?&#]+/,UD=/^[^?&#]+/,VD=function(){function e(t){fy(this,e),this.url=t,this.remaining=t}return dy(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new wD([],{}):new wD([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[nD]=new wD(e,t)),n}},{key:"parseSegment",value:function(){var e=LD(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new _D(MD(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=LD(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=LD(this.remaining);r&&(n=r,this.capture(n))}e[MD(t)]=MD(n)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(FD);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=function(e){var t=e.match(UD);return t?t[0]:""}(this.remaining);r&&(n=r,this.capture(n))}var i=xD(t),a=xD(n);if(e.hasOwnProperty(i)){var o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(a)}else e[i]=a}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=LD(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=nD);var a=this.parseChildren();t[i]=1===Object.keys(a).length?a[nD]:new wD([],a),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),BD=function(){function e(t){fy(this,e),this._root=t}return dy(e,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=zD(e,this._root);return t?t.children.map(function(e){return e.value}):[]}},{key:"firstChild",value:function(e){var t=zD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=HD(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})}},{key:"pathFromRoot",value:function(e){return HD(e,this._root).map(function(e){return e.value})}}]),e}();function zD(e,t){if(e===t.value)return t;var n,r=uy(t.children);try{for(r.s();!(n=r.n()).done;){var i=zD(e,n.value);if(i)return i}}catch(a){r.e(a)}finally{r.f()}return null}function HD(e,t){if(e===t.value)return[t];var n,r=uy(t.children);try{for(r.s();!(n=r.n()).done;){var i=HD(e,n.value);if(i.length)return i.unshift(t),i}}catch(a){r.e(a)}finally{r.f()}return[]}var GD=function(){function e(t,n){fy(this,e),this.value=t,this.children=n}return dy(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function $D(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var ZD=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e)).snapshot=r,QD(ry(i),e),i}return dy(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(BD);function qD(e,t){var n=function(e,t){var n=new YD([],{},{},"",{},nD,t,null,e.root,-1,{});return new KD("",new GD(n,[]))}(e,t),r=new _N([new _D("",{})]),i=new _N({}),a=new _N({}),o=new _N({}),s=new _N(""),u=new WD(r,i,o,s,a,nD,t,n.root);return u.snapshot=n.root,new ZD(new GD(u,[]),n)}var WD=function(){function e(t,n,r,i,a,o,s,u){fy(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this._futureSnapshot=u}return dy(e,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(Zy(function(e){return iD(e)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(Zy(function(e){return iD(e)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),e}();function jD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var i=n[r],a=n[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function(e){return e.reduce(function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}},{params:{},data:{},resolve:{}})}(n.slice(r))}var YD=function(){function e(t,n,r,i,a,o,s,u,c,l,f){fy(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=f}return dy(e,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=iD(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=iD(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return"Route(url:'".concat(this.url.map(function(e){return e.toString()}).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}}]),e}(),KD=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,r)).url=e,QD(ry(i),r),i}return dy(n,[{key:"toString",value:function(){return XD(this._root)}}]),n}(BD);function QD(e,t){t.value._routerState=e,t.children.forEach(function(t){return QD(e,t)})}function XD(e){var t=e.children.length>0?" { ".concat(e.children.map(XD).join(", ")," } "):"";return"".concat(e.value).concat(t)}function JD(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,uD(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),uD(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!uD(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),uD(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function eL(e,t){var n=uD(e.params,t.params)&&function(e,t){return ED(e,t)&&e.every(function(e,n){return uD(e.parameters,t[n].parameters)})}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||eL(e.parent,t.parent))}function tL(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){var r=n.value;r._futureSnapshot=t.value;var i=function(e,t,n){return t.children.map(function(t){var r,i=uy(n.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.shouldReuseRoute(t.value,a.value.snapshot))return tL(e,t,a)}}catch(o){i.e(o)}finally{i.f()}return tL(e,t)})}(e,t,n);return new GD(r,i)}if(e.shouldAttach(t.value)){var a=e.retrieve(t.value);if(null!==a){var o=a.route;return nL(t,o),o}}var s=function(e){return new WD(new _N(e.url),new _N(e.params),new _N(e.queryParams),new _N(e.fragment),new _N(e.data),e.outlet,e.component,e)}(t.value),u=t.children.map(function(t){return tL(e,t)});return new GD(s,u)}function nL(e,t){if(e.value.routeConfig!==t.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==t.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");t.value._futureSnapshot=e.value;for(var n=0;n<e.children.length;++n)nL(e.children[n],t.children[n])}function rL(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function iL(e){return"object"==typeof e&&null!=e&&e.outlets}function aL(e,t,n,r,i){var a={};return r&&hD(r,function(e,t){a[t]=Array.isArray(e)?e.map(function(e){return"".concat(e)}):"".concat(e)}),new CD(n.root===e?t:oL(n.root,e,t),a,i)}function oL(e,t,n){var r={};return hD(e.children,function(e,i){r[i]=e===t?n:oL(e,t,n)}),new wD(e.segments,r)}var sL=function(){function e(t,n,r){if(fy(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&rL(r[0]))throw new Error("Root segment cannot have matrix parameters");var i=r.find(iL);if(i&&i!==fD(r))throw new Error("{outlets:{}} has to be the last command")}return dy(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),uL=dy(function e(t,n,r){fy(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r});function cL(e,t,n){if(e||(e=new wD([],{})),0===e.segments.length&&e.hasChildren())return lL(e,t,n);var r=function(e,t,n){for(var r=0,i=t,a={match:!1,pathIndex:0,commandIndex:0};i<e.segments.length;){if(r>=n.length)return a;var o=e.segments[i],s=n[r];if(iL(s))break;var u="".concat(s),c=r<n.length-1?n[r+1]:null;if(i>0&&void 0===u)break;if(u&&c&&"object"==typeof c&&void 0===c.outlets){if(!vL(u,c,o))return a;r+=2}else{if(!vL(u,{},o))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(e,t,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var a=new wD(e.segments.slice(0,r.pathIndex),{});return a.children[nD]=new wD(e.segments.slice(r.pathIndex),e.children),lL(a,0,i)}return r.match&&0===i.length?new wD(e.segments,{}):r.match&&!e.hasChildren()?fL(e,t,n):r.match?lL(e,0,i):fL(e,t,n)}function lL(e,t,n){if(0===n.length)return new wD(e.segments,{});var r=function(e){return iL(e[0])?e[0].outlets:Zg({},nD,e)}(n),i={};return hD(r,function(n,r){"string"==typeof n&&(n=[n]),null!==n&&(i[r]=cL(e.children[r],t,n))}),hD(e.children,function(e,t){void 0===r[t]&&(i[t]=e)}),new wD(e.segments,i)}function fL(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){var a=n[i];if(iL(a)){var o=hL(a.outlets);return new wD(r,o)}if(0===i&&rL(n[0]))r.push(new _D(e.segments[t].path,dL(n[0]))),i++;else{var s=iL(a)?a.outlets[nD]:"".concat(a),u=i<n.length-1?n[i+1]:null;s&&u&&rL(u)?(r.push(new _D(s,dL(u))),i+=2):(r.push(new _D(s,{})),i++)}}return new wD(r,{})}function hL(e){var t={};return hD(e,function(e,n){"string"==typeof e&&(e=[e]),null!==e&&(t[n]=fL(new wD([],{}),0,e))}),t}function dL(e){var t={};return hD(e,function(e,n){return t[n]="".concat(e)}),t}function vL(e,t,n){return e==n.path&&uD(t,n.parameters)}var pL=function(){function e(t,n,r,i){fy(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=i}return dy(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),JD(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,i=$D(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),hD(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){for(var n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,i=$D(e),a=0,o=Object.keys(i);a<o.length;a++){var s=o[a];this.deactivateRouteAndItsChildren(i[s],r)}n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,i=$D(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new eD(e.value.snapshot))}),e.children.length&&this.forwardEvent(new XN(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,i=t?t.value:null;if(JD(r),r===i)if(r.component){var a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),gL(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function gL(e){JD(e.value),e.children.forEach(gL)}var yL=dy(function e(t,n){fy(this,e),this.routes=t,this.module=n});function mL(e){return"function"==typeof e}function kL(e){return e instanceof CD}var CL=Symbol("INITIAL_VALUE");function wL(){return IN(function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=dm(t),i=hm(t),a=KR(t),o=a.args,s=a.keys;if(0===o.length)return ym([],r);var u=new Fy(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ly;return function(r){EN(t,function(){for(var i=e.length,a=new Array(i),o=i,s=i,u=function(i){EN(t,function(){var u=ym(e[i],t),c=!1;u.subscribe(new $y(r,function(e){a[i]=e,c||(c=!0,s--),s||r.next(n(a.slice()))},function(){--o||r.complete()}))},r)},c=0;c<i;c++)u(c)},r)}}(o,r,s?function(e){return JR(s,e)}:Ly));return i?u.pipe(XR(i)):u}(e.map(function(e){return e.pipe(mm(1),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=dm(t);return Gy(function(e,n){(r?SN(t,e,r):SN(t,e)).subscribe(n)})}(CL))})).pipe(RN(function(e,t){var n=!1;return t.reduce(function(e,r,i){return e!==CL?e:(r===CL&&(n=!0),n||!1!==r&&i!==t.length-1&&!kL(r)?e:r)},e)},CL),zx(function(e){return e!==CL}),Zy(function(e){return kL(e)?e:!0===e}),mm(1))})}var _L=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ck({type:e,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&_S(0,"router-outlet")},directives:function(){return[kF]},encapsulation:2}),e}();function EL(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];bL(r,SL(t,r))}}function bL(e,t){e.children&&EL(e.children,t)}function SL(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function PL(e){var t=e.children&&e.children.map(PL),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&n.outlet!==nD&&(n.component=_L),n}function OL(e){return e.outlet||nD}function TL(e,t){var n=e.filter(function(e){return OL(e)===t});return n.push.apply(n,oy(e.filter(function(e){return OL(e)!==t}))),n}var IL={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function AL(e,t,n){var r;if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?Object.assign({},IL):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var i=(t.matcher||sD)(n,e,t);if(!i)return Object.assign({},IL);var a={};hD(i.posParams,function(e,t){a[t]=e.path});var o=i.consumed.length>0?Object.assign(Object.assign({},a),i.consumed[i.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:i.consumed,lastChild:i.consumed.length,parameters:o,positionalParamSegments:null!==(r=i.posParams)&&void 0!==r?r:{}}}function RL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(n.length>0&&function(e,t,n){return n.some(function(n){return ML(e,t,n)&&OL(n)!==nD})}(e,n,r)){var a=new wD(t,function(e,t,n,r){var i={};i[nD]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var a,o=uy(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(""===s.path&&OL(s)!==nD){var u=new wD([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,i[OL(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return i}(e,t,r,new wD(n,e.children)));return a._sourceSegment=e,a._segmentIndexShift=t.length,{segmentGroup:a,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some(function(n){return ML(e,t,n)})}(e,n,r)){var o=new wD(e.segments,function(e,t,n,r,i,a){var o,s={},u=uy(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(ML(e,n,c)&&!i[OL(c)]){var l=new wD([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===a?e.segments.length:t.length,s[OL(c)]=l}}}catch(f){u.e(f)}finally{u.f()}return Object.assign(Object.assign({},i),s)}(e,t,n,r,e.children,i));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new wD(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function ML(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}function xL(e,t,n,r){return!!(OL(e)===r||r!==nD&&ML(t,n,e))&&("**"===e.path||AL(t,e,n).matched)}function NL(e,t,n){return 0===t.length&&!e.children[n]}var DL=dy(function e(t){fy(this,e),this.segmentGroup=t||null}),LL=dy(function e(t){fy(this,e),this.urlTree=t});function FL(e){return new Fy(function(t){return t.error(new DL(e))})}function UL(e){return new Fy(function(t){return t.error(new LL(e))})}function VL(e){return new Fy(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))})}var BL=function(){function e(t,n,r,i,a){fy(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0,this.ngModule=t.get(uT)}return dy(e,[{key:"apply",value:function(){var e=this,t=RL(this.urlTree.root,[],[],this.config).segmentGroup,n=new wD(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,n,nD).pipe(Zy(function(t){return e.createUrlTree(zL(t),e.urlTree.queryParams,e.urlTree.fragment)})).pipe(MN(function(t){if(t instanceof LL)return e.allowRedirects=!1,e.match(t.urlTree);throw t instanceof DL?e.noMatchError(t):t}))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,nD).pipe(Zy(function(n){return t.createUrlTree(zL(n),e.queryParams,e.fragment)})).pipe(MN(function(e){throw e instanceof DL?t.noMatchError(e):e}))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new wD([],Zg({},nD,e)):e;return new CD(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(Zy(function(e){return new wD([],e)})):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){for(var r=this,i=[],a=0,o=Object.keys(n.children);a<o.length;a++){var s=o[a];"primary"===s?i.unshift(s):i.push(s)}return ym(i).pipe(Bx(function(i){var a=n.children[i],o=TL(t,i);return r.expandSegmentGroup(e,o,a,i).pipe(Zy(function(e){return{segment:e,outlet:i}}))}),RN(function(e,t){return e[t.outlet]=t.segment,e},{}),function(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?zx(function(t,n){return e(t,n,r)}):Ly,xN(1),n?LN(t):NN(function(){return new bN}))}}())}},{key:"expandSegment",value:function(e,t,n,r,i,a){var o=this;return ym(n).pipe(Bx(function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,i,a).pipe(MN(function(e){if(e instanceof DL)return Vx(null);throw e}))}),FN(function(e){return!!e}),MN(function(e,n){if(e instanceof bN||"EmptyError"===e.name){if(NL(t,r,i))return Vx(new wD([],{}));throw new DL(t)}throw e}))}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,i,a,o){return xL(r,t,i,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a):FL(t):FL(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,a)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var i=this,a=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?UL(a):this.lineralizeSegments(n,a).pipe(um(function(n){var a=new wD(n,{});return i.expandSegment(e,a,t,n,r,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,i,a){var o=this,s=AL(t,r,i),u=s.matched,c=s.consumedSegments,l=s.lastChild,f=s.positionalParamSegments;if(!u)return FL(t);var h=this.applyRedirectCommands(c,r.redirectTo,f);return r.redirectTo.startsWith("/")?UL(h):this.lineralizeSegments(r,h).pipe(um(function(r){return o.expandSegment(e,t,n,r.concat(i.slice(l)),a,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r,i){var a=this;if("**"===n.path)return n.loadChildren?(n._loadedConfig?Vx(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe(Zy(function(e){return n._loadedConfig=e,new wD(r,{})})):Vx(new wD(r,{}));var o=AL(t,n,r),s=o.matched,u=o.consumedSegments,c=o.lastChild;if(!s)return FL(t);var l=r.slice(c);return this.getChildConfig(e,n,r).pipe(um(function(e){var r=e.module,o=e.routes,s=RL(t,u,l,o),c=s.segmentGroup,f=s.slicedSegments,h=new wD(c.segments,c.children);if(0===f.length&&h.hasChildren())return a.expandChildren(r,o,h).pipe(Zy(function(e){return new wD(u,e)}));if(0===o.length&&0===f.length)return Vx(new wD(u,{}));var d=OL(n)===i;return a.expandSegment(r,h,o,f,d?nD:i,!0).pipe(Zy(function(e){return new wD(u.concat(e.segments),e.children)}))}))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?Vx(new yL(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Vx(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(um(function(n){return n?r.configLoader.load(e.injector,t).pipe(Zy(function(e){return t._loadedConfig=e,e})):(i=t,new Fy(function(e){return e.error(oD("Cannot load children because the guard of the route \"path: '".concat(i.path,"'\" returned false")))}));var i})):Vx(new yL([],e))}},{key:"runCanLoadGuards",value:function(e,t,n){var r=this,i=t.canLoad;return i&&0!==i.length?Vx(i.map(function(r){var i,a,o=e.get(r);if((a=o)&&mL(a.canLoad))i=o.canLoad(t,n);else{if(!mL(o))throw new Error("Invalid CanLoad guard");i=o(t,n)}return dD(i)})).pipe(wL(),UN(function(e){if(kL(e)){var t=oD('Redirecting to "'.concat(r.urlSerializer.serialize(e),'"'));throw t.url=e,t}}),Zy(function(e){return!0===e})):Vx(!0)}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Vx(n);if(r.numberOfChildren>1||!r.children[nD])return VL(e.redirectTo);r=r.children[nD]}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new CD(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return hD(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var i=this,a=this.createSegments(e,t.segments,n,r),o={};return hD(t.children,function(t,a){o[a]=i.createSegmentGroup(e,t,n,r)}),new wD(a,o)}},{key:"createSegments",value:function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,i=uy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.path===e.path)return t.splice(r),a;r++}}catch(o){i.e(o)}finally{i.f()}return e}}]),e}();function zL(e){for(var t={},n=0,r=Object.keys(e.children);n<r.length;n++){var i=r[n],a=zL(e.children[i]);(a.segments.length>0||a.hasChildren())&&(t[i]=a)}return function(e){if(1===e.numberOfChildren&&e.children[nD]){var t=e.children[nD];return new wD(e.segments.concat(t.segments),t.children)}return e}(new wD(e.segments,t))}var HL=dy(function e(t){fy(this,e),this.path=t,this.route=this.path[this.path.length-1]}),GL=dy(function e(t,n){fy(this,e),this.component=t,this.route=n});function $L(e,t,n){var r=e._root;return qL(r,t?t._root:null,n,[r.value])}function ZL(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function qL(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=$D(t);return e.children.forEach(function(e){(function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},a=e.value,o=t?t.value:null,s=n?n.getContext(e.value.outlet):null;if(o&&a.routeConfig===o.routeConfig){var u=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!ED(e.url,t.url);case"pathParamsOrQueryParamsChange":return!ED(e.url,t.url)||!uD(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!eL(e,t)||!uD(e.queryParams,t.queryParams);default:return!eL(e,t)}}(o,a,a.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new HL(r)):(a.data=o.data,a._resolvedData=o._resolvedData),qL(e,t,a.component?s?s.children:null:n,r,i),u&&s&&s.outlet&&s.outlet.isActivated&&i.canDeactivateChecks.push(new GL(s.outlet.component,o))}else o&&WL(t,s,i),i.canActivateChecks.push(new HL(r)),qL(e,null,a.component?s?s.children:null:n,r,i)})(e,a[e.value.outlet],n,r.concat([e.value]),i),delete a[e.value.outlet]}),hD(a,function(e,t){return WL(e,n.getContext(t),i)}),i}function WL(e,t,n){var r=$D(e),i=e.value;hD(r,function(e,r){WL(e,i.component?t?t.children.getContext(r):null:t,n)}),n.canDeactivateChecks.push(new GL(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))}var jL=dy(function e(){fy(this,e)});function YL(e){return new Fy(function(t){return t.error(e)})}var KL=function(){function e(t,n,r,i,a,o){fy(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=i,this.paramsInheritanceStrategy=a,this.relativeLinkResolution=o}return dy(e,[{key:"recognize",value:function(){var e=RL(this.urlTree.root,[],[],this.config.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,nD);if(null===t)return null;var n=new YD([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},nD,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new GD(n,t),i=new KD(this.url,r);return this.inheritParamsAndData(i._root),i}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=jD(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){for(var n=[],r=0,i=Object.keys(t.children);r<i.length;r++){var a=i[r],o=t.children[a],s=TL(e,a),u=this.processSegmentGroup(s,o,a);if(null===u)return null;n.push.apply(n,oy(u))}var c=QL(n);return c.sort(function(e,t){return e.value.outlet===nD?-1:t.value.outlet===nD?1:e.value.outlet.localeCompare(t.value.outlet)}),c}},{key:"processSegment",value:function(e,t,n,r){var i,a=uy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=this.processSegmentAgainstRoute(o,t,n,r);if(null!==s)return s}}catch(u){a.e(u)}finally{a.f()}return NL(t,n,r)?[]:null}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo||!xL(e,t,n,r))return null;var i,a=[],o=[];if("**"===e.path){var s=n.length>0?fD(n).parameters:{};i=new YD(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,eF(e),OL(e),e.component,e,XL(t),JL(t)+n.length,tF(e))}else{var u=AL(t,e,n);if(!u.matched)return null;a=u.consumedSegments,o=n.slice(u.lastChild),i=new YD(a,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,eF(e),OL(e),e.component,e,XL(t),JL(t)+a.length,tF(e))}var c,l=(c=e).children?c.children:c.loadChildren?c._loadedConfig.routes:[],f=RL(t,a,o,l.filter(function(e){return void 0===e.redirectTo}),this.relativeLinkResolution),h=f.segmentGroup,d=f.slicedSegments;if(0===d.length&&h.hasChildren()){var v=this.processChildren(l,h);return null===v?null:[new GD(i,v)]}if(0===l.length&&0===d.length)return[new GD(i,[])];var p=OL(e)===r,g=this.processSegment(l,h,d,p?nD:r);return null===g?null:[new GD(i,g)]}}]),e}();function QL(e){var t,n=[],r=new Set,i=uy(e);try{var a=function(){var e,i=t.value;if(!function(e){var t=e.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}(i))return n.push(i),"continue";var a=n.find(function(e){return i.value.routeConfig===e.value.routeConfig});void 0!==a?((e=a.children).push.apply(e,oy(i.children)),r.add(a)):n.push(i)};for(i.s();!(t=i.n()).done;)a()}catch(l){i.e(l)}finally{i.f()}var o,s=uy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=QL(u.children);n.push(new GD(u.value,c))}}catch(l){s.e(l)}finally{s.f()}return n.filter(function(e){return!r.has(e)})}function XL(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function JL(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function eF(e){return e.data||{}}function tF(e){return e.resolve||{}}function nF(e){return IN(function(t){var n=e(t);return n?ym(n).pipe(Zy(function(){return t})):Vx(t)})}var rF=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n)}(function(){function e(){fy(this,e)}return dy(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}()),iF=new pw("ROUTES"),aF=function(){function e(t,n,r,i){fy(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=i}return dy(e,[{key:"load",value:function(e,t){var n=this;if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren).pipe(Zy(function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new yL(lD(i.injector.get(iF,void 0,Gm.Self|Gm.Optional)).map(PL),i)}),MN(function(e){throw t._loader$=void 0,e}));return t._loader$=new TN(r,function(){return new By}).pipe(ON()),t._loader$}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?ym(this.loader.load(e)):dD(e()).pipe(um(function(e){return e instanceof cT?Vx(e):ym(t.compiler.compileModuleAsync(e))}))}}]),e}(),oF=dy(function e(){fy(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new sF,this.attachRef=null}),sF=function(){function e(){fy(this,e),this.contexts=new Map}return dy(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new oF,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),uF=function(){function e(){fy(this,e)}return dy(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function cF(e){throw e}function lF(e,t,n){return t.parse("/")}function fF(e,t){return Vx(null)}var hF={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},dF={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},vF=function(){var e=function(){function e(t,n,r,i,a,o,s,u){var c=this;fy(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new By,this.errorHandler=cF,this.malformedUriErrorHandler=lF,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:fF,afterPreactivation:fF},this.urlHandlingStrategy=new uF,this.routeReuseStrategy=new rF,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(uT),this.console=a.get(sI);var l=a.get(CI);this.isNgZoneEnabled=l instanceof CI&&CI.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=new CD(new wD([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new aF(o,s,function(e){return c.triggerEvent(new YN(e))},function(e){return c.triggerEvent(new KN(e))}),this.routerState=qD(this.currentUrlTree,this.rootComponentType),this.transitions=new _N({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return dy(e,[{key:"browserPageId",get:function(){var e;return null===(e=this.location.getState())||void 0===e?void 0:e.\u0275routerPageId}},{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(zx(function(e){return 0!==e.id}),Zy(function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})}),IN(function(e){var r=!1,i=!1;return Vx(e).pipe(UN(function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}}),IN(function(e){var r=t.browserUrlTree.toString(),a=!t.navigated||e.extractedUrl.toString()!==r||r!==t.currentUrlTree.toString();if(("reload"===t.onSameUrlNavigation||a)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return pF(e.source)&&(t.browserUrlTree=e.extractedUrl),Vx(e).pipe(IN(function(e){var r=t.transitions.getValue();return n.next(new BN(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?lm:Promise.resolve(e)}),function(e,t,n,r){return IN(function(i){return function(e,t,n,r,i){return new BL(e,t,n,r,i).apply()}(e,t,n,i.extractedUrl,r).pipe(Zy(function(e){return Object.assign(Object.assign({},i),{urlAfterRedirects:e})}))})}(t.ngModule.injector,t.configLoader,t.urlSerializer,t.config),UN(function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})}),function(e,n,r,a,o){return um(function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var s=new KL(e,t,n,r,a,o).recognize();return null===s?YL(new jL):Vx(s)}catch(i){return YL(i)}}(e,n,r.urlAfterRedirects,(s=r.urlAfterRedirects,t.serializeUrl(s)),a,o).pipe(Zy(function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})}));var s})}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),UN(function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,e),t.browserUrlTree=e.urlAfterRedirects);var r=new $N(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)}));if(a&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var o=e.id,s=e.extractedUrl,u=e.source,c=e.restoredState,l=e.extras,f=new BN(o,t.serializeUrl(s),u,c);n.next(f);var h=qD(s,t.rootComponentType).snapshot;return Vx(Object.assign(Object.assign({},e),{targetSnapshot:h,urlAfterRedirects:s,extras:Object.assign(Object.assign({},l),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),lm}),nF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),UN(function(e){var n=new ZN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),Zy(function(e){return Object.assign(Object.assign({},e),{guards:$L(e.targetSnapshot,e.currentSnapshot,t.rootContexts)})}),function(e,t){return um(function(n){var r=n.targetSnapshot,i=n.currentSnapshot,a=n.guards,o=a.canActivateChecks,s=a.canDeactivateChecks;return 0===s.length&&0===o.length?Vx(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return ym(e).pipe(um(function(e){return function(e,t,n,r,i){var a=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return a&&0!==a.length?Vx(a.map(function(a){var o,s=ZL(a,t,i);if(function(e){return e&&mL(e.canDeactivate)}(s))o=dD(s.canDeactivate(e,t,n,r));else{if(!mL(s))throw new Error("Invalid CanDeactivate guard");o=dD(s(e,t,n,r))}return o.pipe(FN())})).pipe(wL()):Vx(!0)}(e.component,e.route,n,t,r)}),FN(function(e){return!0!==e},!0))}(s,r,i,e).pipe(um(function(n){return n&&function(e){return"boolean"==typeof e}(n)?function(e,t,n,r){return ym(t).pipe(Bx(function(t){return SN(function(e,t){return null!==e&&t&&t(new QN(e)),Vx(!0)}(t.route.parent,r),function(e,t){return null!==e&&t&&t(new JN(e)),Vx(!0)}(t.route,r),function(e,t,n){var r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)}).filter(function(e){return null!==e}).map(function(t){return PN(function(){return Vx(t.guards.map(function(i){var a,o=ZL(i,t.node,n);if(function(e){return e&&mL(e.canActivateChild)}(o))a=dD(o.canActivateChild(r,e));else{if(!mL(o))throw new Error("Invalid CanActivateChild guard");a=dD(o(r,e))}return a.pipe(FN())})).pipe(wL())})});return Vx(i).pipe(wL())}(e,t.path,n),function(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return Vx(!0);var i=r.map(function(r){return PN(function(){var i,a=ZL(r,t,n);if(function(e){return e&&mL(e.canActivate)}(a))i=dD(a.canActivate(t,e));else{if(!mL(a))throw new Error("Invalid CanActivate guard");i=dD(a(t,e))}return i.pipe(FN())})});return Vx(i).pipe(wL())}(e,t.route,n))}),FN(function(e){return!0!==e},!0))}(r,o,e,t):Vx(n)}),Zy(function(e){return Object.assign(Object.assign({},n),{guardsResult:e})}))})}(t.ngModule.injector,function(e){return t.triggerEvent(e)}),UN(function(e){if(kL(e.guardsResult)){var n=oD('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}var r=new qN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)}),zx(function(e){return!!e.guardsResult||(t.restoreHistory(e),t.cancelNavigationTransition(e,""),!1)}),nF(function(e){if(e.guards.canActivateChecks.length)return Vx(e).pipe(UN(function(e){var n=new WN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}),IN(function(e){var n=!1;return Vx(e).pipe(function(e,t){return um(function(n){var r=n.targetSnapshot,i=n.guards.canActivateChecks;if(!i.length)return Vx(n);var a=0;return ym(i).pipe(Bx(function(n){return function(e,t,n,r){return function(e,t,n,r){var i=Object.keys(e);if(0===i.length)return Vx({});var a={};return ym(i).pipe(um(function(i){return function(e,t,n,r){var i=ZL(e,t,r);return dD(i.resolve?i.resolve(t,n):i(t,n))}(e[i],t,n,r).pipe(UN(function(e){a[i]=e}))}),xN(1),um(function(){return Object.keys(a).length===i.length?Vx(a):lm}))}(e._resolve,e,t,r).pipe(Zy(function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),jD(e,n).resolve),null}))}(n.route,r,e,t)}),UN(function(){return a++}),xN(1),um(function(e){return a===i.length?Vx(n):lm}))})}(t.paramsInheritanceStrategy,t.ngModule.injector),UN({next:function(){return n=!0},complete:function(){n||(t.restoreHistory(e),t.cancelNavigationTransition(e,"At least one route resolver didn't emit any value."))}}))}),UN(function(e){var n=new jN(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)}))}),nF(function(e){var n=e.targetSnapshot,r=e.id,i=e.extractedUrl,a=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:i,rawUrlTree:a,skipLocationChange:!!s,replaceUrl:!!u})}),Zy(function(e){var n=function(e,t,n){var r=tL(e,t._root,n?n._root:void 0);return new ZD(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})}),UN(function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(e.urlAfterRedirects,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,e),t.browserUrlTree=e.urlAfterRedirects)}),function(e,t,n){return Zy(function(r){return new pL(t,r.targetRouterState,r.currentRouterState,n).activate(e),r})}(t.rootContexts,t.routeReuseStrategy,function(e){return t.triggerEvent(e)}),UN({next:function(){r=!0},complete:function(){r=!0}}),function(e){return Gy(function(t,n){try{t.subscribe(n)}finally{n.add(e)}})}(function(){var n;if(!r&&!i){var a="Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId);"replace"===t.canceledNavigationResolution?(t.restoreHistory(e),t.cancelNavigationTransition(e,a)):t.cancelNavigationTransition(e,a)}(null===(n=t.currentNavigation)||void 0===n?void 0:n.id)===e.id&&(t.currentNavigation=null)}),MN(function(r){if(i=!0,function(e){return e&&e[aD]}(r)){var a=kL(r.url);a||(t.navigated=!0,t.restoreHistory(e,!0));var o=new HN(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(o),a?setTimeout(function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree),i={skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||pF(e.source)};t.scheduleNavigation(n,"imperative",null,i,{resolve:e.resolve,reject:e.reject,promise:e.promise})},0):e.resolve(!1)}else{t.restoreHistory(e,!0);var s=new GN(e.id,t.serializeUrl(e.extractedUrl),r);n.next(s);try{e.resolve(t.errorHandler(r))}catch(o){e.reject(o)}}return lm}))}))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(t){var n=e.extractLocationChangeInfoFromEvent(t);e.shouldScheduleNavigation(e.lastLocationChangeInfo,n)&&setTimeout(function(){var t=n.source,r=n.state,i=n.urlTree,a={replaceUrl:!0};if(r){var o=Object.assign({},r);delete o.navigationId,delete o.\u0275routerPageId,0!==Object.keys(o).length&&(a.state=o)}e.scheduleNavigation(i,t,r,a)},0),e.lastLocationChangeInfo=n}))}},{key:"extractLocationChangeInfoFromEvent",value:function(e){var t;return{source:"popstate"===e.type?"popstate":"hashchange",urlTree:this.parseUrl(e.url),state:(null===(t=e.state)||void 0===t?void 0:t.navigationId)?e.state:null,transitionId:this.getTransition().id}}},{key:"shouldScheduleNavigation",value:function(e,t){if(!e)return!0;var n=t.urlTree.toString()===e.urlTree.toString();return t.transitionId!==e.transitionId||!n||!("hashchange"===t.source&&"popstate"===e.source||"popstate"===t.source&&"hashchange"===e.source)}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){EL(e),this.config=e.map(PL),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,i=t.fragment,a=t.queryParamsHandling,o=t.preserveFragment,s=n||this.routerState.root,u=o?this.currentUrlTree.fragment:i,c=null;switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,n,r,i){if(0===n.length)return aL(t.root,t.root,t,r,i);var a=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new sL(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var a={};return hD(r.outlets,function(e,t){a[t]="string"==typeof e?e.split("/"):e}),[].concat(oy(e),[{outlets:a}])}if(r.segmentPath)return[].concat(oy(e),[r.segmentPath])}return"string"!=typeof r?[].concat(oy(e),[r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):[].concat(oy(e),[r])},[]);return new sL(n,t,r)}(n);if(a.toRoot())return aL(t.root,new wD([],{}),t,r,i);var o=function(e,t,n){if(e.isAbsolute)return new uL(t.root,!0,0);if(-1===n.snapshot._lastPathIndex){var r=n.snapshot._urlSegment;return new uL(r,r===t.root,0)}var i=rL(e.commands[0])?0:1;return function(e,t,n){for(var r=e,i=t,a=n;a>i;){if(a-=i,!(r=r.parent))throw new Error("Invalid number of '../'");i=r.segments.length}return new uL(r,!1,i-a)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,e.numberOfDoubleDots)}(a,t,e),s=o.processChildren?lL(o.segmentGroup,o.index,a.commands):cL(o.segmentGroup,o.index,a.commands);return aL(o.segmentGroup,s,t,r,i)}(s,this.currentUrlTree,e,c,null!=u?u:null)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},n=kL(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){var n;if(n=!0===t?Object.assign({},hF):!1===t?Object.assign({},dF):t,kL(e))return gD(this.currentUrlTree,e,n);var r=this.parseUrl(e);return gD(this.currentUrlTree,r,n)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!=r&&(t[n]=r),t},{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe(function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.currentPageId=t.targetPageId,e.events.next(new zN(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,t.resolve(!0)},function(t){e.console.warn("Unhandled Navigation Error: ".concat(t))})}},{key:"scheduleNavigation",value:function(e,t,n,r,i){var a,o;if(this.disposed)return Promise.resolve(!1);var s,u,c,l=this.getTransition(),f=pF(t)&&l&&!pF(l.source),h=(this.lastSuccessfulId===l.id||this.currentNavigation?l.rawUrl:l.urlAfterRedirects).toString()===e.toString();if(f&&h)return Promise.resolve(!0);i?(s=i.resolve,u=i.reject,c=i.promise):c=new Promise(function(e,t){s=e,u=t});var d,v=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(n=this.location.getState()),d=n&&n.\u0275routerPageId?n.\u0275routerPageId:r.replaceUrl||r.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(o=this.browserPageId)&&void 0!==o?o:0)+1):d=0,this.setTransition({id:v,targetPageId:d,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:s,reject:u,promise:c,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),c.catch(function(e){return Promise.reject(e)})}},{key:"setBrowserUrl",value:function(e,t){var n=this.urlSerializer.serialize(e),r=Object.assign(Object.assign({},t.extras.state),this.generateNgRouterState(t.id,t.targetPageId));this.location.isCurrentPathEqualTo(n)||t.extras.replaceUrl?this.location.replaceState(n,"",r):this.location.go(n,"",r)}},{key:"restoreHistory",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var i=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(t=this.currentNavigation)||void 0===t?void 0:t.finalUrl)||0===i?this.currentUrlTree===(null===(n=this.currentNavigation)||void 0===n?void 0:n.finalUrl)&&0===i&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(e,t){var n=new HN(e.id,this.serializeUrl(e.extractedUrl),t);this.triggerEvent(n),e.resolve(!1)}},{key:"generateNgRouterState",value:function(e,t){return"computed"===this.canceledNavigationResolution?{navigationId:e,"\u0275routerPageId":t}:{navigationId:e}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(yw),Dw(bD),Dw(sF),Dw(hA),Dw(Yb),Dw(zI),Dw(yI),Dw(void 0))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}();function pF(e){return"imperative"!==e}var gF=function(){var e=function(){function e(t,n,r,i,a){fy(this,e),this.router=t,this.route=n,this.commands=[],this.onChanges=new By,null==r&&i.setAttribute(a.nativeElement,"tabindex","0")}return dy(e,[{key:"ngOnChanges",value:function(e){this.onChanges.next(this)}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"onClick",value:function(){var e={skipLocationChange:mF(this.skipLocationChange),replaceUrl:mF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,e),!0}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:mF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF),yS(WD),hw("tabindex"),yS(RO),yS(TO))},e.\u0275dir=pk({type:e,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,t){1&e&&TS("click",function(){return t.onClick()})},inputs:{routerLink:"routerLink",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Tk]}),e}(),yF=function(){var e=function(){function e(t,n,r){var i=this;fy(this,e),this.router=t,this.route=n,this.locationStrategy=r,this.commands=[],this.onChanges=new By,this.subscription=t.events.subscribe(function(e){e instanceof zN&&i.updateTargetUrlAndHref()})}return dy(e,[{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,n,r,i){if(0!==e||t||n||r||i||"string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:mF(this.skipLocationChange),replaceUrl:mF(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:mF(this.preserveFragment)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF),yS(WD),yS(sA))},e.\u0275dir=pk({type:e,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&TS("click",function(e){return t.onClick(e.button,e.ctrlKey,e.shiftKey,e.altKey,e.metaKey)}),2&e&&(uP("href",t.href,T_),lS("target",t.target))},inputs:{routerLink:"routerLink",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo"},features:[Tk]}),e}();function mF(e){return""===e||!!e}var kF=function(){var e=function(){function e(t,n,r,i,a){fy(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new LT,this.deactivateEvents=new LT,this.name=i||nD,t.onChildOutletCreated(this.name,this)}return dy(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new CF(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(sF),yS(fT),yS(bO),hw("name"),yS(eT))},e.\u0275dir=pk({type:e,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),e}(),CF=function(){function e(t,n,r){fy(this,e),this.route=t,this.childContexts=n,this.parent=r}return dy(e,[{key:"get",value:function(e,t){return e===WD?this.route:e===sF?this.childContexts:this.parent.get(e,t)}}]),e}(),wF=dy(function e(){fy(this,e)}),_F=function(){function e(){fy(this,e)}return dy(e,[{key:"preload",value:function(e,t){return Vx(null)}}]),e}(),EF=function(){var e=function(){function e(t,n,r,i,a){fy(this,e),this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=new aF(n,r,function(e){return t.triggerEvent(new YN(e))},function(e){return t.triggerEvent(new KN(e))})}return dy(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(zx(function(e){return e instanceof zN}),Bx(function(){return e.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var e=this.injector.get(uT);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],i=uy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a.loadChildren&&!a.canLoad&&a._loadedConfig){var o=a._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else a.loadChildren&&!a.canLoad?r.push(this.preloadConfig(e,a)):a.children&&r.push(this.processRoutes(e,a.children))}}catch(s){i.e(s)}finally{i.f()}return ym(r).pipe(cm(),Zy(function(e){}))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){return(t._loadedConfig?Vx(t._loadedConfig):n.loader.load(e.injector,t)).pipe(um(function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)}))})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(vF),Dw(zI),Dw(yI),Dw(Yb),Dw(wF))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),bF=function(){var e=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};fy(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return dy(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof BN?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof zN&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe(function(t){t instanceof tD&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new tD(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(vF),Dw(cR),Dw(void 0))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),SF=new pw("ROUTER_CONFIGURATION"),PF=new pw("ROUTER_FORROOT_GUARD"),OF=[hA,{provide:bD,useClass:SD},{provide:vF,useFactory:function(e,t,n,r,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new vF(null,e,t,n,r,i,a,lD(o));return u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),function(e,t){e.errorHandler&&(t.errorHandler=e.errorHandler),e.malformedUriErrorHandler&&(t.malformedUriErrorHandler=e.malformedUriErrorHandler),e.onSameUrlNavigation&&(t.onSameUrlNavigation=e.onSameUrlNavigation),e.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=e.paramsInheritanceStrategy),e.relativeLinkResolution&&(t.relativeLinkResolution=e.relativeLinkResolution),e.urlUpdateStrategy&&(t.urlUpdateStrategy=e.urlUpdateStrategy)}(s,l),s.enableTracing&&l.events.subscribe(function(e){var t,n;null===(t=console.group)||void 0===t||t.call(console,"Router Event: ".concat(e.constructor.name)),console.log(e.toString()),console.log(e),null===(n=console.groupEnd)||void 0===n||n.call(console)}),l},deps:[bD,sF,hA,Yb,zI,yI,iF,SF,[function(){return dy(function e(){fy(this,e)})}(),new Gw],[function(){return dy(function e(){fy(this,e)})}(),new Gw]]},sF,{provide:WD,useFactory:function(e){return e.routerState.root},deps:[vF]},{provide:zI,useClass:$I},EF,_F,function(){function e(){fy(this,e)}return dy(e,[{key:"preload",value:function(e,t){return t().pipe(MN(function(){return Vx(null)}))}}]),e}(),{provide:SF,useValue:{enableTracing:!1}}];function TF(){return new NI("Router",vF)}var IF=function(){var e=function(){function e(t,n){fy(this,e)}return dy(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[OF,xF(t),{provide:PF,useFactory:MF,deps:[[vF,new Gw,new $w]]},{provide:SF,useValue:n||{}},{provide:sA,useFactory:RF,deps:[XI,[new Hw(cA),new Gw],SF]},{provide:bF,useFactory:AF,deps:[vF,cR,SF]},{provide:wF,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:_F},{provide:NI,multi:!0,useFactory:TF},[NF,{provide:JT,multi:!0,useFactory:DF,deps:[NF]},{provide:FF,useFactory:LF,deps:[NF]},{provide:oI,multi:!0,useExisting:FF}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[xF(t)]}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(PF,8),Dw(vF,8))},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({}),e}();function AF(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new bF(e,t,n)}function RF(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new fA(e,t):new lA(e,t)}function MF(e){return"guarded"}function xF(e){return[{provide:gw,multi:!0,useValue:e},{provide:iF,multi:!0,useValue:e}]}var NF=function(){var e=function(){function e(t){fy(this,e),this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new By}return dy(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(eA,Promise.resolve(null)).then(function(){if(e.destroyed)return Promise.resolve(!0);var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(vF),i=e.injector.get(SF);return"disabled"===i.initialNavigation?(r.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(r.hooks.afterPreactivation=function(){return e.initNavigation?Vx(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()):t(!0),n})}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(SF),n=this.injector.get(EF),r=this.injector.get(bF),i=this.injector.get(vF),a=this.injector.get(VI);e===a.components[0]&&(("enabledNonBlocking"===t.initialNavigation||void 0===t.initialNavigation)&&i.initialNavigation(),n.setUpPreloading(),r.init(),i.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(Yb))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}();function DF(e){return e.appInitializer.bind(e)}function LF(e){return e.bootstrapListener.bind(e)}var FF=new pw("Router Initializer"),UF=dy(function e(){fy(this,e)}),VF="*";function BF(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function zF(e){return{type:6,styles:e,offset:null}}function HF(e){Promise.resolve(null).then(e)}var GF=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;fy(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return dy(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;HF(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this._started=!1}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),$F=function(){function e(t){var n=this;fy(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var r=0,i=0,a=0,o=this.players.length;0==o?HF(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++r==o&&n._onFinish()}),e.onDestroy(function(){++i==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return dy(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function ZF(){return"undefined"!=typeof window&&void 0!==window.document}function qF(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function WF(e){switch(e.length){case 0:return new GF;case 1:return e[0];default:return new $F(e)}}function jF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],u=-1,c=null;if(r.forEach(function(e){var n=e.offset,r=n==u,l=r&&c||{};Object.keys(e).forEach(function(n){var r=n,s=e[n];if("offset"!==n)switch(r=t.normalizePropertyName(r,o),s){case"!":s=i[n];break;case VF:s=a[n];break;default:s=t.normalizeStyleValue(n,r,s,o)}l[r]=s}),r||s.push(l),c=l,u=n}),o.length){var l="\n - ";throw new Error("Unable to animate due to the following errors:".concat(l).concat(o.join(l)))}return s}function YF(e,t,n,r){switch(t){case"start":e.onStart(function(){return r(n&&KF(n,"start",e))});break;case"done":e.onDone(function(){return r(n&&KF(n,"done",e))});break;case"destroy":e.onDestroy(function(){return r(n&&KF(n,"destroy",e))})}}function KF(e,t,n){var r,i=QF(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null!==(r=n.totalTime)&&void 0!==r?r:e.totalTime,!!n.disabled),a=e._data;return null!=a&&(i._data=a),i}function QF(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:r,phaseName:i,totalTime:a,disabled:!!o}}function XF(e,t,n){var r;return e instanceof Map?(r=e.get(t))||e.set(t,r=n):(r=e[t])||(r=e[t]=n),r}function JF(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var eU=function(e,t){return!1},tU=function(e,t){return!1},nU=function(e,t,n){return[]},rU=qF();(rU||"undefined"!=typeof Element)&&(eU=ZF()?function(e,t){for(;t&&t!==document.documentElement;){if(t===e)return!0;t=t.parentNode||t.host}return!1}:function(e,t){return e.contains(t)},tU=function(){if(rU||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:tU}(),nU=function(e,t,n){var r=[];if(n)for(var i=e.querySelectorAll(t),a=0;a<i.length;a++)r.push(i[a]);else{var o=e.querySelector(t);o&&r.push(o)}return r});var iU=null,aU=!1;function oU(e){iU||(iU=("undefined"!=typeof document?document.body:null)||{},aU=!!iU.style&&"WebkitAppearance"in iU.style);var t=!0;return iU.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in iU.style)&&aU&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in iU.style)),t}var sU=tU,uU=eU,cU=nU;function lU(e){var t={};return Object.keys(e).forEach(function(n){var r=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[r]=e[n]}),t}var fU=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"validateStyleProperty",value:function(e){return oU(e)}},{key:"matchesElement",value:function(e,t){return sU(e,t)}},{key:"containsElement",value:function(e,t){return uU(e,t)}},{key:"query",value:function(e,t,n){return cU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,r,i){return new GF(n,r)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),hU=function(){var e=dy(function e(){fy(this,e)});return e.NOOP=new fU,e}(),dU="ng-enter",vU="ng-leave",pU="ng-trigger",gU=".ng-trigger",yU="ng-animating",mU=".ng-animating";function kU(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:CU(parseFloat(t[1]),t[2])}function CU(e,t){return"s"===t?1e3*e:e}function wU(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var r,i=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};r=CU(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(i=CU(parseFloat(s),o[4]));var u=o[5];u&&(a=u)}else r=e;if(!n){var c=!1,l=t.length;r<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),i<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(l,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:r,delay:i,easing:a}}(e,t,n)}function _U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function EU(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var r in e)n[r]=e[r];else _U(e,n);return n}function bU(e,t,n){return n?t+":"+n+";":""}function SU(e){for(var t="",n=0;n<e.style.length;n++){var r=e.style.item(n);t+=bU(0,r,e.style.getPropertyValue(r))}for(var i in e.style)e.style.hasOwnProperty(i)&&!i.startsWith("_")&&(t+=bU(0,DU(i),e.style[i]));e.setAttribute("style",t)}function PU(e,t,n){e.style&&(Object.keys(t).forEach(function(r){var i=NU(r);n&&!n.hasOwnProperty(r)&&(n[r]=e.style[i]),e.style[i]=t[r]}),qF()&&SU(e))}function OU(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=NU(t);e.style[n]=""}),qF()&&SU(e))}function TU(e){return Array.isArray(e)?1==e.length?e[0]:BF(e):e}var IU=new RegExp("{{\\s*(.+?)\\s*}}","g");function AU(e){var t=[];if("string"==typeof e){for(var n;n=IU.exec(e);)t.push(n[1]);IU.lastIndex=0}return t}function RU(e,t,n){var r=e.toString(),i=r.replace(IU,function(e,r){var i=t[r];return t.hasOwnProperty(r)||(n.push("Please provide a value for the animation param ".concat(r)),i=""),i.toString()});return i==r?e:i}function MU(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var xU=/-+([a-z0-9])/g;function NU(e){return e.replace(xU,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function DU(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function LU(e,t){return 0===e||0===t}function FU(e,t,n){var r=Object.keys(n);if(r.length&&t.length){var i=t[0],a=[];if(r.forEach(function(e){i.hasOwnProperty(e)||a.push(e),i[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=VU(e,t)})},s=1;s<t.length;s++)o()}return t}function UU(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function VU(e,t){return window.getComputedStyle(e)[t]}function BU(e,t){var n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var r=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof r)return void t.push(r);e=r}var i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=i[1],o=i[2],s=i[3];t.push(GU(a,s)),"<"==o[0]&&("*"!=a||"*"!=s)&&t.push(GU(s,a))}(e,n,t)}):n.push(e),n}var zU=new Set(["true","1"]),HU=new Set(["false","0"]);function GU(e,t){var n=zU.has(e)||HU.has(e),r=zU.has(t)||HU.has(t);return function(i,a){var o="*"==e||e==i,s="*"==t||t==a;return!o&&n&&"boolean"==typeof i&&(o=i?zU.has(e):HU.has(e)),!s&&r&&"boolean"==typeof a&&(s=a?zU.has(t):HU.has(t)),o&&s}}var $U=new RegExp("s*:selfs*,?","g");function ZU(e,t,n){return new qU(e).build(t,n)}var qU=function(){function e(t){fy(this,e),this._driver=t}return dy(e,[{key:"build",value:function(e,t){var n=new WU(t);return this._resetContextStyleTimingState(n),UU(this,TU(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,r=t.queryCount=0,i=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,u=s.name;u.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=u}else if(1==e.type){var c=n.visitTransition(e,t);r+=c.queryCount,i+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:r,depCount:i,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){var i=new Set,a=r||{};if(n.styles.forEach(function(e){if(jU(e)){var t=e;Object.keys(t).forEach(function(e){AU(t[e]).forEach(function(e){a.hasOwnProperty(e)||i.add(e)})})}}),i.size){var o=MU(i.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n=UU(this,TU(e.animation),t);return{type:1,matchers:BU(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:YU(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return UU(n,e,t)}),options:YU(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,r=t.currentTime,i=0,a=e.steps.map(function(e){t.currentTime=r;var a=UU(n,e,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:3,steps:a,options:YU(e.options)}}},{key:"visitAnimate",value:function(e,t){var n=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return KU(wU(e,t).duration,0,"");var r=e;if(r.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var i=KU(0,0,"");return i.dynamic=!0,i.strValue=r,i}return KU((n=n||wU(r,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var r,i=e.styles?e.styles:zF({});if(5==i.type)r=this.visitKeyframes(i,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};n.easing&&(s.easing=n.easing),a=zF(s)}t.currentTime+=n.duration+n.delay;var u=this.visitStyle(a,t);u.isEmptyStep=o,r=u}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?e==VF?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var r=!1,i=null;return n.forEach(function(e){if(jU(e)){var t=e,n=t.easing;if(n&&(i=n,delete t.easing),!r)for(var a in t)if(t[a].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:e.offset,containsDynamicStyles:r,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,r=t.currentAnimateTimings,i=t.currentTime,a=t.currentTime;r&&a>0&&(a-=r.duration+r.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(r){if(n._driver.validateStyleProperty(r)){var o=t.collectedStyles[t.currentQuerySelector],s=o[r],u=!0;s&&(a!=i&&a>=s.startTime&&i<=s.endTime&&(t.errors.push('The CSS property "'.concat(r,'" that exists between the times of "').concat(s.startTime,'ms" and "').concat(s.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(i,'ms"')),u=!1),a=s.startTime),u&&(o[r]={startTime:a,endTime:i}),t.options&&function(e,t,n){var r=t.params||{},i=AU(e);i.length&&i.forEach(function(e){r.hasOwnProperty(e)||n.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})}(e[r],t.options,t.errors)}else t.errors.push('The provided animation property "'.concat(r,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,r={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),r;var i=0,a=[],o=!1,s=!1,u=0,c=e.steps.map(function(e){var r=n._makeStyleAst(e,t),c=null!=r.offset?r.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(jU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(jU(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(r.styles),l=0;return null!=c&&(i++,l=r.offset=c),s=s||l<0||l>1,o=o||l<u,u=l,a.push(l),r});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var l=e.steps.length,f=0;i>0&&i<l?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(f=1/(l-1));var h=l-1,d=t.currentTime,v=t.currentAnimateTimings,p=v.duration;return c.forEach(function(e,i){var o=f>0?i==h?1:f*i:a[i],s=o*p;t.currentTime=d+v.delay+s,v.duration=s,n._validateStyleAst(e,t),e.offset=o,r.styles.push(e)}),r}},{key:"visitReference",value:function(e,t){return{type:8,animation:UU(this,TU(e.animation),t),options:YU(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:YU(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:YU(e.options)}}},{key:"visitQuery",value:function(e,t){var n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;var i=function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace($U,"")),e=e.replace(/@\*/g,gU).replace(/@\w+/g,function(e){return gU+"-"+e.substr(1)}).replace(/:animating/g,mU),[e,t]}(e.selector),a=qg(i,2),o=a[0],s=a[1];t.currentQuerySelector=n.length?n+" "+o:o,XF(t.collectedStyles,t.currentQuerySelector,{});var u=UU(this,TU(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:u,originalSelector:e.selector,options:YU(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:wU(e.timings,t.errors,!0);return{type:12,animation:UU(this,TU(e.animation),t),timings:n,options:null}}}]),e}(),WU=dy(function e(t){fy(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null});function jU(e){return!Array.isArray(e)&&"object"==typeof e}function YU(e){return e?(e=_U(e)).params&&(e.params=function(e){return e?_U(e):null}(e.params)):e={},e}function KU(e,t,n){return{duration:e,delay:t,easing:n}}function QU(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:r,duration:i,delay:a,totalTime:i+a,easing:o,subTimeline:s}}var XU=function(){function e(){fy(this,e),this._map=new Map}return dy(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,oy(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),JU=new RegExp(":enter","g"),eV=new RegExp(":leave","g");function tV(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new nV).buildKeyframes(e,t,n,r,i,a,o,s,u,c)}var nV=function(){function e(){fy(this,e)}return dy(e,[{key:"buildKeyframes",value:function(e,t,n,r,i,a,o,s,u){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];u=u||new XU;var l=new iV(e,t,u,r,i,c,[]);l.options=s,l.currentTimeline.setStyles([a],null,l.errors,s),UU(this,n,l);var f=l.timelines.filter(function(e){return e.containsAnimation()});if(f.length&&Object.keys(o).length){var h=f[f.length-1];h.allowOnlyTimelineStyles()||h.setStyles([o],null,l.errors,s)}return f.length?f.map(function(e){return e.buildKeyframes()}):[QU(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var r=t.createSubContext(e.options),i=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,r,r.options);i!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var r=t.currentTimeline.currentTime,i=null!=n.duration?kU(n.duration):null,a=null!=n.delay?kU(n.delay):null;return 0!==i&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,i,a);r=Math.max(r,n.duration+n.delay)}),r}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),UU(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,r=t.subContextCount,i=t,a=e.options;if(a&&(a.params||a.delay)&&((i=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=rV);var o=kU(a.delay);i.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return UU(n,e,i)}),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,r=[],i=t.currentTimeline.currentTime,a=e.options&&e.options.delay?kU(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),UU(n,o,s),i=Math.max(i,s.currentTimeline.currentTime),r.push(s.currentTimeline)}),r.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(i),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return wU(t.params?RU(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());var i=e.style;5==i.type?this.visitKeyframes(i,t):(t.incrementTime(n.duration),this.visitStyle(i,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();var i=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(i):n.setStyles(e.styles,i,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,r=t.currentTimeline.duration,i=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*i),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+i),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,r=t.currentTimeline.currentTime,i=e.options||{},a=i.delay?kU(i.delay):0;a&&(6===t.previousNode.type||0==r&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=rV);var o=r,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=s.length;var u=null;s.forEach(function(r,i){t.currentQueryIndex=i;var s=t.createSubContext(e.options,r);a&&s.delayNextStep(a),r===t.element&&(u=s.currentTimeline),UU(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),u&&(t.currentTimeline.mergeTimelineCollectedStyles(u),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,r=t.currentTimeline,i=e.timings,a=Math.abs(i.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var u=t.currentTimeline;s&&u.delayNextStep(s);var c=u.currentTime;UU(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-c+(r.startTime-n.currentTimeline.startTime)}}]),e}(),rV={},iV=function(){function e(t,n,r,i,a,o,s,u){fy(this,e),this._driver=t,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=rV,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new aV(this._driver,n,0),s.push(this.currentTimeline)}return dy(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var r=e,i=this.options;null!=r.duration&&(i.duration=kU(r.duration)),null!=r.delay&&(i.delay=kU(r.delay));var a=r.params;if(a){var o=i.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){(!t||!o.hasOwnProperty(e))&&(o[e]=RU(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,i=n||this.element,a=new e(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=rV,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},i=new oV(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(i),r}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,i,a){var o=[];if(r&&o.push(this.element),e.length>0){e=(e=e.replace(JU,"."+this._enterClassName)).replace(eV,"."+this._leaveClassName);var s=this._driver.query(this.element,e,1!=n);0!==n&&(s=n<0?s.slice(s.length+n,s.length):s.slice(0,n)),o.push.apply(o,oy(s))}return!i&&0==o.length&&a.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),o}}]),e}(),aV=function(){function e(t,n,r,i){fy(this,e),this._driver=t,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return dy(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||VF,t._currentKeyframe[e]=VF}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,r){var i=this;t&&(this._previousKeyframe.easing=t);var a=r&&r.params||{},o=function(e,t){var n,r={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){r[e]=VF}):EU(e,!1,r)}),r}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=RU(o[e],a,n);i._pendingStyles[e]=t,i._localTimelineStyles.hasOwnProperty(e)||(i._backFill[e]=i._globalTimelineStyles.hasOwnProperty(e)?i._globalTimelineStyles[e]:VF),i._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var r=t._styleSummary[n],i=e._styleSummary[n];(!r||i.time>r.time)&&t._updateStyle(n,i.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,r=1===this._keyframes.size&&0===this.duration,i=[];this._keyframes.forEach(function(a,o){var s=EU(a,!0);Object.keys(s).forEach(function(e){var r=s[e];"!"==r?t.add(e):r==VF&&n.add(e)}),r||(s.offset=o/e.duration),i.push(s)});var a=t.size?MU(t.values()):[],o=n.size?MU(n.values()):[];if(r){var s=i[0],u=_U(s);s.offset=0,u.offset=1,i=[s,u]}return QU(this.element,i,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),oV=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return fy(this,n),(u=t.call(this,e,r,s.delay)).keyframes=i,u.preStyleProps=a,u.postStyleProps=o,u._stretchStartingKeyframe=c,u.timings={duration:s.duration,delay:s.delay,easing:s.easing},u}return dy(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,r=t.duration,i=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=r+n,s=n/o,u=EU(e[0],!1);u.offset=0,a.push(u);var c=EU(e[0],!1);c.offset=sV(s),a.push(c);for(var l=e.length-1,f=1;f<=l;f++){var h=EU(e[f],!1);h.offset=sV((n+h.offset*r)/o),a.push(h)}r=o,n=0,i="",e=a}return QU(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}}]),n}(aV);function sV(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var uV=dy(function e(){fy(this,e)}),cV=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"normalizePropertyName",value:function(e,t){return NU(e)}},{key:"normalizeStyleValue",value:function(e,t,n,r){var i="",a=n.toString().trim();if(lV[t]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&r.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+i}}]),n}(uV),lV=function(e){var t={};return e.forEach(function(e){return t[e]=!0}),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function fV(e,t,n,r,i,a,o,s,u,c,l,f,h){return{type:0,element:e,triggerName:t,isRemovalTransition:i,fromState:n,fromStyles:a,toState:r,toStyles:o,timelines:s,queriedElements:u,preStyleProps:c,postStyleProps:l,totalTime:f,errors:h}}var hV={},dV=function(){function e(t,n,r){fy(this,e),this._triggerName=t,this.ast=n,this._stateStyles=r}return dy(e,[{key:"match",value:function(e,t,n,r){return function(e,t,n,r,i){return e.some(function(e){return e(t,n,r,i)})}(this.ast.matchers,e,t,n,r)}},{key:"buildStyles",value:function(e,t,n){var r=this._stateStyles["*"],i=this._stateStyles[e],a=r?r.buildStyles(t,n):{};return i?i.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,r,i,a,o,s,u,c){var l=[],f=this.ast.options&&this.ast.options.params||hV,h=this.buildStyles(n,o&&o.params||hV,l),d=s&&s.params||hV,v=this.buildStyles(r,d,l),p=new Set,g=new Map,y=new Map,m="void"===r,k={params:Object.assign(Object.assign({},f),d)},C=c?[]:tV(e,t,this.ast.animation,i,a,h,v,k,u,l),w=0;if(C.forEach(function(e){w=Math.max(e.duration+e.delay,w)}),l.length)return fV(t,this._triggerName,n,r,m,h,v,[],[],g,y,w,l);C.forEach(function(e){var n=e.element,r=XF(g,n,{});e.preStyleProps.forEach(function(e){return r[e]=!0});var i=XF(y,n,{});e.postStyleProps.forEach(function(e){return i[e]=!0}),n!==t&&p.add(n)});var _=MU(p.values());return fV(t,this._triggerName,n,r,m,h,v,C,_,g,y,w)}}]),e}(),vV=function(){function e(t,n,r){fy(this,e),this.styles=t,this.defaultParams=n,this.normalizer=r}return dy(e,[{key:"buildStyles",value:function(e,t){var n=this,r={},i=_U(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach(function(e){var o=a[e];o.length>1&&(o=RU(o,i,t));var s=n.normalizer.normalizePropertyName(e,t);o=n.normalizer.normalizeStyleValue(e,s,o,t),r[s]=o})}}),r}}]),e}(),pV=function(){function e(t,n,r){var i=this;fy(this,e),this.name=t,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new vV(e.style,e.options&&e.options.params||{},r)}),gV(this.states,"true","1"),gV(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new dV(t,e,i.states))}),this.fallbackTransition=function(e,t,n){return new dV(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},t)}(t,this.states)}return dy(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,r){return this.transitionFactories.find(function(i){return i.match(e,t,n,r)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function gV(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var yV=new XU,mV=function(){function e(t,n,r){fy(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}return dy(e,[{key:"register",value:function(e,t){var n=[],r=ZU(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=r}},{key:"_buildPlayer",value:function(e,t,n){var r=e.element,i=jF(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,i,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=tV(this._driver,t,o,dU,vU,{},{},i,yV,a)).forEach(function(e){var t=XF(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=r._driver.computeStyle(t,n,VF)})});var u=WF(n.map(function(e){var t=s.get(e.element);return r._buildPlayer(e,{},t)}));return this._playersById[e]=u,u.onDestroy(function(){return r.destroy(e)}),this.players.push(u),u}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,r){var i=QF(t,"","","");return YF(this._getPlayer(e),n,i,r),function(){}}},{key:"command",value:function(e,t,n,r){if("register"!=n)if("create"!=n){var i=this._getPlayer(e);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,r[0]||{});else this.register(e,r[0])}}]),e}(),kV="ng-animate-queued",CV="ng-animate-disabled",wV=".ng-animate-disabled",_V=[],EV={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},bV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},SV="__ng_removed",PV=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";fy(this,e),this.namespaceId=r;var i=t&&t.hasOwnProperty("value");if(this.value=null!==(n=i?t.value:t)&&void 0!==n?n:null,i){var a=_U(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return dy(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),OV="void",TV=new PV(OV),IV=function(){function e(t,n,r){fy(this,e),this.id=t,this.hostElement=n,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,FV(n,this._hostClassName)}return dy(e,[{key:"listen",value:function(e,t,n,r){var i,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(i=n)&&"done"!=i)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=XF(this._elementListeners,e,[]),s={name:t,phase:n,callback:r};o.push(s);var u=XF(this._engine.statesByElement,e,{});return u.hasOwnProperty(t)||(FV(e,pU),FV(e,pU+"-"+t),u[t]=TV),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete u[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new RV(this.id,t,e),s=this._engine.statesByElement.get(e);s||(FV(e,pU),FV(e,pU+"-"+t),this._engine.statesByElement.set(e,s={}));var u=s[t],c=new PV(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&u&&c.absorbOptions(u.options),s[t]=c,u||(u=TV),c.value===OV||u.value!==c.value){var l=XF(this._engine.playersByElement,e,[]);l.forEach(function(e){e.namespaceId==r.id&&e.triggerName==t&&e.queued&&e.destroy()});var f=a.matchTransition(u.value,c.value,e,c.params),h=!1;if(!f){if(!i)return;f=a.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:u,toState:c,player:o,isFallbackTransition:h}),h||(FV(e,kV),o.onStart(function(){UV(e,kV)})),o.onDone(function(){var t=r.players.indexOf(o);t>=0&&r.players.splice(t,1);var n=r._engine.playersByElement.get(e);if(n){var i=n.indexOf(o);i>=0&&n.splice(i,1)}}),this.players.push(o),l.push(o),o}if(!function(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!=r.length)return!1;for(var i=0;i<n.length;i++){var a=n[i];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(u.params,c.params)){var d=[],v=a.matchStyles(u.value,u.params,d),p=a.matchStyles(c.value,c.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush(function(){OU(e,v),PU(e,p)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,r){t._elementListeners.set(r,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,r=this._engine.driver.query(e,gU,!0);r.forEach(function(e){if(!e[SV]){var r=n._engine.fetchNamespacesByElement(e);r.size?r.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return r.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,r){var i=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(i._triggers[t]){var n=i.trigger(e,t,OV,r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&WF(o).onDone(function(){return i._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){var i=new Set;n.forEach(function(n){var a=n.name;if(!i.has(a)){i.add(a);var o=t._triggers[a].fallbackTransition,s=r[a]||TV,u=new PV(OV),c=new RV(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:u,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var i=!1;if(r.totalAnimations){var a=r.players.length?r.playersByQueriedElement.get(e):[];if(a&&a.length)i=!0;else for(var o=e;o=o.parentNode;)if(r.statesByElement.get(o)){i=!0;break}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,t);else{var s=e[SV];(!s||s===EV)&&(r.afterFlush(function(){return n.clearElementCache(e)}),r.destroyInnerAnimations(e),r._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){FV(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(r){var i=r.player;if(!i.destroyed){var a=r.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==r.triggerName){var n=QF(a,r.triggerName,r.fromState.value,r.toState.value);n._data=e,YF(r.player,t.phase,n,t.callback)}}),i.markedForDestroy?t._engine.afterFlush(function(){i.destroy()}):n.push(r)}}),this._queue=[],n.sort(function(e,n){var r=e.transition.ast.depCount,i=n.transition.ast.depCount;return 0==r||0==i?r-i:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),AV=function(){function e(t,n,r){fy(this,e),this.bodyNode=t,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return dy(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new IV(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var r=!1,i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,t)){this._namespaceList.splice(i+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var r=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(r.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(r);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return r.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=n[r[i]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,r){if(MV(t)){var i=this._fetchNamespace(e);if(i)return i.trigger(t,n,r),!0}return!1}},{key:"insertNode",value:function(e,t,n,r){if(MV(t)){var i=t[SV];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),FV(e,CV)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),UV(e,CV))}},{key:"removeNode",value:function(e,t,n,r){if(MV(t)){var i=e?this._fetchNamespace(e):null;if(i?i.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,r)}}else this._onRemovalComplete(t,r)}},{key:"markElementAsRemoved",value:function(e,t,n,r){this.collectedLeaveElements.push(t),t[SV]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,r,i){return MV(t)?this._fetchNamespace(e).listen(t,n,r,i):function(){}}},{key:"_buildInstruction",value:function(e,t,n,r,i){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,i)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,gU,!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,mU,!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return WF(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e[SV];if(n&&n.setForRemoval){if(e[SV]=EV,n.namespaceId){this.destroyInnerAnimations(e);var r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,wV)&&this.markElementAsDisabled(e,!1),this.driver.query(e,wV,!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var r=0;r<this.collectedEnterElements.length;r++)FV(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var i=[];try{n=this._flushAnimations(i,t)}finally{for(var a=0;a<i.length;a++)i[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?WF(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new XU,i=[],a=new Map,o=[],s=new Map,u=new Map,c=new Map,l=new Set;this.disabledNodes.forEach(function(e){l.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),r=0;r<t.length;r++)l.add(t[r])});var f=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=DV(h,this.collectedEnterElements),v=new Map,p=0;d.forEach(function(e,t){var n=dU+p++;v.set(t,n),e.forEach(function(e){return FV(e,n)})});for(var g=[],y=new Set,m=new Set,k=0;k<this.collectedLeaveElements.length;k++){var C=this.collectedLeaveElements[k],w=C[SV];w&&w.setForRemoval&&(g.push(C),y.add(C),w.hasAnimation?this.driver.query(C,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):m.add(C))}var _=new Map,E=DV(h,Array.from(y));E.forEach(function(e,t){var n=vU+p++;_.set(t,n),e.forEach(function(e){return FV(e,n)})}),e.push(function(){d.forEach(function(e,t){var n=v.get(t);e.forEach(function(e){return UV(e,n)})}),E.forEach(function(e,t){var n=_.get(t);e.forEach(function(e){return UV(e,n)})}),g.forEach(function(e){n.processLeaveNode(e)})});for(var b=[],S=[],P=this._namespaceList.length-1;P>=0;P--)this._namespaceList[P].drainQueuedTransitions(t).forEach(function(e){var t=e.player,a=e.element;if(b.push(t),n.collectedEnterElements.length){var l=a[SV];if(l&&l.setForMove)return void t.destroy()}var h=!f||!n.driver.containsElement(f,a),d=_.get(a),p=v.get(a),g=n._buildInstruction(e,r,p,d,h);if(g.errors&&g.errors.length)S.push(g);else{if(h)return t.onStart(function(){return OU(a,g.fromStyles)}),t.onDestroy(function(){return PU(a,g.toStyles)}),void i.push(t);if(e.isFallbackTransition)return t.onStart(function(){return OU(a,g.fromStyles)}),t.onDestroy(function(){return PU(a,g.toStyles)}),void i.push(t);g.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(a,g.timelines),o.push({instruction:g,player:t,element:a}),g.queriedElements.forEach(function(e){return XF(s,e,[]).push(t)}),g.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var r=u.get(t);r||u.set(t,r=new Set),n.forEach(function(e){return r.add(e)})}}),g.postStyleProps.forEach(function(e,t){var n=Object.keys(e),r=c.get(t);r||c.set(t,r=new Set),n.forEach(function(e){return r.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),b.forEach(function(e){return e.destroy()}),this.reportError(O)}var T=new Map,I=new Map;o.forEach(function(e){var t=e.element;r.has(t)&&(I.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,T))}),i.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){XF(T,t,[]).push(e),e.destroy()})});var A=g.filter(function(e){return zV(e,u,c)}),R=new Map;NV(R,this.driver,m,c,VF).forEach(function(e){zV(e,u,c)&&A.push(e)});var M=new Map;d.forEach(function(e,t){NV(M,n.driver,new Set(e),u,"!")}),A.forEach(function(e){var t=R.get(e),n=M.get(e);R.set(e,Object.assign(Object.assign({},t),n))});var x=[],N=[],D={};o.forEach(function(e){var t=e.element,o=e.player,s=e.instruction;if(r.has(t)){if(l.has(t))return o.onDestroy(function(){return PU(t,s.toStyles)}),o.disabled=!0,o.overrideTotalTime(s.totalTime),void i.push(o);var u=D;if(I.size>1){for(var c=t,f=[];c=c.parentNode;){var h=I.get(c);if(h){u=h;break}f.push(c)}f.forEach(function(e){return I.set(e,u)})}var d=n._buildAnimation(o.namespaceId,s,T,a,M,R);if(o.setRealPlayer(d),u===D)x.push(o);else{var v=n.playersByElement.get(u);v&&v.length&&(o.parentPlayer=WF(v)),i.push(o)}}else OU(t,s.fromStyles),o.onDestroy(function(){return PU(t,s.toStyles)}),N.push(o),l.has(t)&&i.push(o)}),N.forEach(function(e){var t=a.get(e.element);if(t&&t.length){var n=WF(t);e.setRealPlayer(n)}}),i.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var L=0;L<g.length;L++){var F=g[L],U=F[SV];if(UV(F,vU),!U||!U.hasAnimation){var V=[];if(s.size){var B=s.get(F);B&&B.length&&V.push.apply(V,oy(B));for(var z=this.driver.query(F,mU,!0),H=0;H<z.length;H++){var G=s.get(z[H]);G&&G.length&&V.push.apply(V,oy(G))}}var $=V.filter(function(e){return!e.destroyed});$.length?VV(this,F,$):this.processLeaveNode(F)}}return g.length=0,x.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),x}},{key:"elementContainsData",value:function(e,t){var n=!1,r=t[SV];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,r,i){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var u=!i||i==OV;s.forEach(function(e){e.queued||!u&&e.triggerName!=r||a.push(e)})}}return(n||r)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||r&&r!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var r,i=this,a=t.element,o=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName,u=uy(t.timelines);try{var c=function(){var e=r.value.element,u=e!==a,c=XF(n,e,[]);i._getPreviousPlayers(e,u,o,s,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(u.s();!(r=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}OU(a,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,r,i,a){var o=this,s=t.triggerName,u=t.element,c=[],l=new Set,f=new Set,h=t.timelines.map(function(t){var h=t.element;l.add(h);var d=h[SV];if(d&&d.removedBeforeQueried)return new GF(t.duration,t.delay);var v=h!==u,p=function(e){var t=[];return BV(e,t),t}((n.get(h)||_V).map(function(e){return e.getRealPlayer()})).filter(function(e){return!!e.element&&e.element===h}),g=i.get(h),y=a.get(h),m=jF(0,o._normalizer,0,t.keyframes,g,y),k=o._buildPlayer(t,m,p);if(t.subTimeline&&r&&f.add(h),v){var C=new RV(e,s,h);C.setRealPlayer(k),c.push(C)}return k});c.forEach(function(e){XF(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var r;if(e instanceof Map){if(r=e.get(t)){if(r.length){var i=r.indexOf(n);r.splice(i,1)}0==r.length&&e.delete(t)}}else if(r=e[t]){if(r.length){var a=r.indexOf(n);r.splice(a,1)}0==r.length&&delete e[t]}return r}(o.playersByQueriedElement,e.element,e)})}),l.forEach(function(e){return FV(e,yU)});var d=WF(h);return d.onDestroy(function(){l.forEach(function(e){return UV(e,yU)}),PU(u,t.toStyles)}),f.forEach(function(e){XF(r,e,[]).push(d)}),d}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new GF(e.duration,e.delay)}}]),e}(),RV=function(){function e(t,n,r){fy(this,e),this.namespaceId=t,this.triggerName=n,this.element=r,this._player=new GF,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return dy(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return YF(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){XF(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function MV(e){return e&&1===e.nodeType}function xV(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function NV(e,t,n,r,i){var a=[];n.forEach(function(e){return a.push(xV(e))});var o=[];r.forEach(function(n,r){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(r,e,i);(!n||0==n.length)&&(r[SV]=bV,o.push(r))}),e.set(r,a)});var s=0;return n.forEach(function(e){return xV(e,a[s++])}),o}function DV(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var r=new Set(t),i=new Map;function a(e){if(!e)return 1;var t=i.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:r.has(o)?1:a(o),i.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}var LV="$$classes";function FV(e,t){if(e.classList)e.classList.add(t);else{var n=e[LV];n||(n=e[LV]={}),n[t]=!0}}function UV(e,t){if(e.classList)e.classList.remove(t);else{var n=e[LV];n&&delete n[t]}}function VV(e,t,n){WF(n).onDone(function(){return e.processLeaveNode(t)})}function BV(e,t){for(var n=0;n<e.length;n++){var r=e[n];r instanceof $F?BV(r.players,t):t.push(r)}}function zV(e,t,n){var r=n.get(e);if(!r)return!1;var i=t.get(e);return i?r.forEach(function(e){return i.add(e)}):t.set(e,r),n.delete(e),!0}var HV=function(){function e(t,n,r){var i=this;fy(this,e),this.bodyNode=t,this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new AV(t,n,r),this._timelineEngine=new mV(t,n,r),this._transitionEngine.onRemovalComplete=function(e,t){return i.onRemovalComplete(e,t)}}return dy(e,[{key:"registerTrigger",value:function(e,t,n,r,i){var a=e+"-"+r,o=this._triggerCache[a];if(!o){var s=[],u=ZU(this._driver,i,s);if(s.length)throw new Error('The animation trigger "'.concat(r,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t,n){return new pV(e,t,n)}(r,u,this._normalizer),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,r,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}},{key:"onRemove",value:function(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,n,r){if("@"==n.charAt(0)){var i=qg(JF(n),2),a=i[0],o=i[1];this._timelineEngine.command(a,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}},{key:"listen",value:function(e,t,n,r,i){if("@"==n.charAt(0)){var a=qg(JF(n),2),o=a[0],s=a[1];return this._timelineEngine.listen(o,t,s,i)}return this._transitionEngine.listen(e,t,n,r,i)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),e}();function GV(e,t){var n=null,r=null;return Array.isArray(t)&&t.length?(n=ZV(t[0]),t.length>1&&(r=ZV(t[t.length-1]))):t&&(n=ZV(t)),n||r?new $V(e,n,r):null}var $V=function(){var e=function(){function e(t,n,r){fy(this,e),this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;var i=e.initialStylesByElement.get(t);i||e.initialStylesByElement.set(t,i={}),this._initialStyles=i}return dy(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&PU(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(PU(this._element,this._initialStyles),this._endStyles&&(PU(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(OU(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(OU(this._element,this._endStyles),this._endStyles=null),PU(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function ZV(e){for(var t=null,n=Object.keys(e),r=0;r<n.length;r++){var i=n[r];qV(i)&&((t=t||{})[i]=e[i])}return t}function qV(e){return"display"===e||"position"===e}var WV="animation",jV="animationend",YV=function(){function e(t,n,r,i,a,o,s){var u=this;fy(this,e),this._element=t,this._name=n,this._duration=r,this._delay=i,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return u._handleCallback(e)}}return dy(e,[{key:"apply",value:function(){(function(e,t){var n=tB(e,"").trim();n.length&&(function(e,t){for(var n=0,r=0;r<e.length;r++)","===e.charAt(r)&&n++}(n),t="".concat(n,", ").concat(t)),eB(e,"",t)})(this._element,"".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name)),JV(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){KV(this._element,this._name,"paused")}},{key:"resume",value:function(){KV(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=QV(this._element,this._name);this._position=e*this._duration,eB(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),JV(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=tB(e,"").split(","),r=XV(n,t);r>=0&&(n.splice(r,1),eB(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function KV(e,t,n){eB(e,"PlayState",n,QV(e,t))}function QV(e,t){var n=tB(e,"");return n.indexOf(",")>0?XV(n.split(","),t):XV([n],t)}function XV(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function JV(e,t,n){n?e.removeEventListener(jV,t):e.addEventListener(jV,t)}function eB(e,t,n,r){var i=WV+t;if(null!=r){var a=e.style[i];if(a.length){var o=a.split(",");o[r]=n,n=o.join(",")}}e.style[i]=n}function tB(e,t){return e.style[WV+t]||""}var nB=function(){function e(t,n,r,i,a,o,s,u){fy(this,e),this.element=t,this.keyframes=n,this.animationName=r,this._duration=i,this._delay=a,this._finalStyles=s,this._specialStyles=u,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=i+a,this._buildStyler()}return dy(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new YV(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(r){"offset"!=r&&(t[r]=n?e._finalStyles[r]:VU(e.element,r))})}this.currentSnapshot=t}}]),e}(),rB=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).element=e,i._startingStyles={},i.__initialized=!1,i._styles=lU(r),i}return dy(n,[{key:"init",value:function(){var e=this;this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),Qg(ay(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),Qg(ay(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;!this._startingStyles||(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,Qg(ay(n.prototype),"destroy",this).call(this))}}]),n}(GF),iB=function(){function e(){fy(this,e),this._count=0}return dy(e,[{key:"validateStyleProperty",value:function(e){return oU(e)}},{key:"matchesElement",value:function(e,t){return sU(e,t)}},{key:"containsElement",value:function(e,t){return uU(e,t)}},{key:"query",value:function(e,t,n){return cU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return lU(e)});var r="@keyframes ".concat(t," {\n"),i="";n.forEach(function(e){i=" ";var t=parseFloat(e.offset);r+="".concat(i).concat(100*t,"% {\n"),i+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(r+="".concat(i,"animation-timing-function: ").concat(n,";\n")));default:return void(r+="".concat(i).concat(t,": ").concat(n,";\n"))}}),r+="".concat(i,"}\n")}),r+="}\n";var a=document.createElement("style");return a.textContent=r,a}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof nB}),s={};LU(n,r)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var u=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"==n||"easing"==n||(t[n]=e[n])})}),t}(t=FU(e,t,s));if(0==n)return new rB(e,u);var c="gen_css_kf_"+this._count++,l=this.buildKeyframeElement(e,c,t);(function(e){var t,n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e);return"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot?n:document.head})(e).appendChild(l);var f=GV(e,t),h=new nB(e,t,c,n,r,i,u,f);return h.onDestroy(function(){var e;(e=l).parentNode.removeChild(e)}),h}}]),e}(),aB=function(){function e(t,n,r,i){fy(this,e),this.element=t,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}return dy(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:VU(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),oB=function(){function e(){fy(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(sB().toString()),this._cssKeyframesDriver=new iB}return dy(e,[{key:"validateStyleProperty",value:function(e){return oU(e)}},{key:"matchesElement",value:function(e,t){return sU(e,t)}},{key:"containsElement",value:function(e,t){return uU(e,t)}},{key:"query",value:function(e,t,n){return cU(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,r,i,a);var s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);var u={},c=a.filter(function(e){return e instanceof aB});LU(n,r)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return u[e]=t[e]})});var l=GV(e,t=FU(e,t=t.map(function(e){return EU(e,!1)}),u));return new aB(e,t,s,l)}}]),e}();function sB(){return ZF()&&Element.prototype.animate||{}}var uB=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this))._nextAnimationId=0,i._renderer=e.createRenderer(r.body,{id:"0",encapsulation:jm.None,styles:[],data:{animation:[]}}),i}return dy(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?BF(e):e;return fB(this._renderer,null,t,"register",[n]),new cB(t,this._renderer)}}]),n}(UF);return e.\u0275fac=function(t){return new(t||e)(Dw(AO),Dw(QI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),cB=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this))._id=e,i._renderer=r,i}return dy(n,[{key:"create",value:function(e,t){return new lB(this._id,e,t||{},this._renderer)}}]),n}(function(){return dy(function e(){fy(this,e)})}()),lB=function(){function e(t,n,r,i){fy(this,e),this.id=t,this.element=n,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}return dy(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return fB(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset"),this._started=!1}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function fB(e,t,n,r,i){return e.setProperty(t,"@@".concat(n,":").concat(r),i)}var hB="@.disabled",dB=function(){var e=function(){function e(t,n,r){fy(this,e),this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return dy(e,[{key:"createRenderer",value:function(e,t){var n=this,r=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var i=this._rendererCache.get(r);return i||(i=new vB("",r,this.engine),this._rendererCache.set(r,i)),i}var a=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);return t.data.animation.forEach(function t(r){Array.isArray(r)?r.forEach(t):n.engine.registerTrigger(a,o,e,r.name,r)}),new pB(this,o,r,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(e,t,n){var r=this;e>=0&&e<this._microtaskId?this._zone.run(function(){return t(n)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(e){var t=qg(e,2);(0,t[0])(t[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(AO),Dw(HV),Dw(CI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),vB=function(){function e(t,n,r){fy(this,e),this.namespaceId=t,this.delegate=n,this.engine=r,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return dy(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,r){this.delegate.setStyle(e,t,n,r)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&t==hB?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),pB=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,r,i,a)).factory=e,o.namespaceId=r,o}return dy(n,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==hB?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(e,t,n){var r=this;if("@"==t.charAt(0)){var i,a,o=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),u="";return"@"!=s.charAt(0)&&(i=function(e){var t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(s),s=(a=qg(i,2))[0],u=a[1]),this.engine.listen(this.namespaceId,o,s,u,function(e){r.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}]),n}(vB),gB=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){return fy(this,n),t.call(this,e.body,r,i)}return dy(n,[{key:"ngOnDestroy",value:function(){this.flush()}}]),n}(HV);return e.\u0275fac=function(t){return new(t||e)(Dw(QI),Dw(hU),Dw(uV))},e.\u0275prov=xm({token:e,factory:e.\u0275fac}),e}(),yB=new pw("AnimationModuleType"),mB=[{provide:UF,useClass:uB},{provide:uV,useFactory:function(){return new cV}},{provide:HV,useClass:gB},{provide:AO,useFactory:function(e,t,n){return new dB(e,t,n)},deps:[AR,HV,CI]}],kB=[{provide:hU,useFactory:function(){return"function"==typeof sB()?new oB:new iB}},{provide:yB,useValue:"BrowserAnimations"}].concat(mB),CB=[{provide:hU,useClass:fU},{provide:yB,useValue:"NoopAnimations"}].concat(mB),wB=function(){var e=function(){function e(){fy(this,e)}return dy(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:t.disableAnimations?CB:kB}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:kB,imports:[ZR]}),e}(),_B=jg(9575),EB=jg.n(_B);function bB(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function SB(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){bB(a,r,i,o,s,"next",e)}function s(e){bB(a,r,i,o,s,"throw",e)}o(void 0)})}}var PB=function(){function e(){fy(this,e)}return dy(e,null,[{key:"expectToBe",value:function(e,t,n){if(e!==t)throw void 0!==n?new Error(n):new Error("A default switch case did not observe the correct value, expected ".concat(t,", but got ").concat(e," instead."))}},{key:"expectToBeMultiple",value:function(e,t){var n,r=!1,i=uy(t);try{for(i.s();!(n=i.n()).done;){if(e===n.value){r=!0;break}}}catch(a){i.e(a)}finally{i.f()}if(!1===r)throw new Error("A default switch case did not observe the correct value, expected a value among ".concat(t,", but got ").concat(e," instead."))}},{key:"getNonNullable",value:function(e){if(null==e)throw new Error("Expected value not to be null or undefined, but it was.");return e}}]),e}();function OB(e,t){e&&console.log(t)}function TB(e,t){if(null!=e&&null!=t&&"object"==typeof e){if(null!=e.equals)return e.equals(t);for(var n=e,r=t,i=0,a=Object.keys(n);i<a.length;i++){var o=a[i];if(!(o in r))return!1;if(!1===TB(n[o],r[o]))return!1}return!0}return e===t}function IB(e){return null==e||function(e){return"object"==typeof e&&null!=e&&null!=e.equals}(e)||function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||null===e}(e)||function(e){if("object"==typeof e){for(var t in e)if(null!=e[t]&&!1===IB(e[t]))return!1;return null!=e&&e.constructor.prototype===Object.prototype}return!1}(e)}function AB(e,t){if(IB(e)&&IB(t))return TB(e,t);throw new Error("Comparing non comparable objects: ".concat(e.constructor.name," and ").concat(t.constructor.name))}var RB=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"isPresent",value:function(){return null!=this.value}},{key:"isAbsent",value:function(){return null==this.value}},{key:"get",value:function(){if(this.isPresent())return this.value;throw new Error("Value is absent")}},{key:"getOrElse",value:function(e){return this.isPresent()?this.value:e}},{key:"equals",value:function(e){return this.isAbsent()?e.isAbsent():!e.isAbsent()&&AB(this.value,e.value)}},{key:"equalsValue",value:function(t){return this.equals(e.of(t))}},{key:"toString",value:function(){return this.isAbsent()?"MGPOptional.empty()":"MGPOptional.of(".concat(this.value,")")}},{key:"map",value:function(t){return this.isPresent()?e.of(t(this.get())):e.empty()}}],[{key:"of",value:function(t){return new e(t)}},{key:"ofNullable",value:function(t){return null==t?e.empty():e.of(t)}},{key:"empty",value:function(){return new e(null)}}]),e}(),MB=function(){function e(){fy(this,e)}return dy(e,[{key:"equals",value:function(e){return this.isFailure()?e.isFailure()&&this.getReason()===e.getReason():!e.isFailure()&&AB(this.get(),e.get())}}],[{key:"success",value:function(e){return new xB(e)}},{key:"failure",value:function(e){return new NB(e)}}]),e}(),xB=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).value=e,r}return dy(n,[{key:"isSuccess",value:function(){return!0}},{key:"isFailure",value:function(){return!1}},{key:"get",value:function(){return this.value}},{key:"getReason",value:function(){throw new Error("Cannot get failure reason from a success")}},{key:"getReasonOr",value:function(e){return e}},{key:"toOptional",value:function(){return RB.of(this.value)}},{key:"toString",value:function(){return"MGPFallible.success(".concat(this.value,")")}}]),n}(MB),NB=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).reason=e,r}return dy(n,[{key:"isSuccess",value:function(){return!1}},{key:"isFailure",value:function(){return!0}},{key:"get",value:function(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}},{key:"getReason",value:function(){return this.reason}},{key:"getReasonOr",value:function(e){return this.getReason()}},{key:"toOptional",value:function(){return RB.empty()}},{key:"toString",value:function(){return"MGPFallible.failure(".concat(this.reason,")")}}]),n}(MB),DB=function(){function e(t){fy(this,e),this.reason=t}return dy(e,[{key:"isFailure",value:function(){return!1===this.isSuccess()}},{key:"isSuccess",value:function(){return null==this.reason}},{key:"getReason",value:function(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}},{key:"toFallible",value:function(e){return this.isSuccess()?MB.success(e):MB.failure(this.getReason())}},{key:"toFailedFallible",value:function(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return MB.failure(this.getReason())}}],[{key:"ofFallible",value:function(t){return t.isSuccess()?e.SUCCESS:e.failure(t.getReason())}},{key:"failure",value:function(t){return new e(t)}}]),e}();DB.SUCCESS=new DB(null);var LB=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},FB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,s=o?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=(15&s)<<2|c>>6,f=63&c;u||(f=64,o||(l=64)),r.push(n[a>>2],n[(3&a)<<4|s>>4],n[l],n[f])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(LB(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==s||null==u)throw Error();r.push(a<<2|o>>4),64!==s&&(r.push(o<<4&240|s>>2),64!==u&&r.push(s<<6&192|u))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},UB=function(e){return function(e){var t=LB(e);return FB.encodeByteArray(t,!0)}(e).replace(/\./g,"")},VB=function(){function e(){var t=this;fy(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return dy(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}}}]),e}();function BB(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function zB(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(BB())}function HB(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function GB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function $B(){var e=BB();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function ZB(){return"object"==typeof indexedDB}function qB(){return new Promise(function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}function WB(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}var jB=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,r)).code=e,a.customData=i,a.name="FirebaseError",Object.setPrototypeOf(ry(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(ry(a),YB.prototype.create),a}return dy(n)}(Yg(Error)),YB=function(){function e(t,n,r){fy(this,e),this.service=t,this.serviceName=n,this.errors=r}return dy(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(KB,function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error";return new jB(n,"".concat(this.serviceName,": ").concat(i," (").concat(n,")."),t)}}]),e}(),KB=/\{\$([^}]+)}/g;function QB(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),i=0,a=n;i<a.length;i++){var o=a[i];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(XB(s)&&XB(u)){if(!QB(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function XB(e){return null!==e&&"object"==typeof e}function JB(e){for(var t=[],n=function(){var e=qg(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach(function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function ez(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=qg(e.split("="),2),r=n[0],i=n[1];t[decodeURIComponent(r)]=decodeURIComponent(i)}}),t}function tz(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var nz=function(){function e(t,n){var r=this;fy(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){t(r)}).catch(function(e){r.error(e)})}return dy(e,[{key:"next",value:function(e){this.forEachObserver(function(t){t.next(e)})}},{key:"error",value:function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)}},{key:"complete",value:function(){this.forEachObserver(function(e){e.complete()}),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=rz),void 0===r.error&&(r.error=rz),void 0===r.complete&&(r.complete=rz);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))}}]),e}();function rz(){}function iz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function az(e){return e&&e._delegate?e._delegate:e}var oz,sz,uz=function(){function e(t,n,r){fy(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return dy(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),cz="[DEFAULT]",lz=function(){function e(t,n){fy(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return dy(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new VB;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:cz})}catch(u){}var t,n=uy(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=qg(t.value,2),i=r[0],a=r[1],o=this.normalizeInstanceIdentifier(i);try{var s=this.getOrInitializeService({instanceIdentifier:o});a.resolve(s)}catch(c){}}}catch(l){n.e(l)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cz;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=Array.from(e.instances.values()),t.next=3,Promise.all([].concat(oy(n.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()})),oy(n.filter(function(e){return"_delete"in e}).map(function(e){return e._delete()}))));case 3:case"end":return t.stop()}},t)}))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cz;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cz;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=uy(this.instancesDeferred.entries());try{for(o.s();!(i=o.n()).done;){var s=qg(i.value,2),u=s[0],c=s[1];r===this.normalizeInstanceIdentifier(u)&&c.resolve(a)}}catch(l){o.e(l)}finally{o.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;try{a(e,t)}catch(o){}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===cz?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(o){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cz;return this.component?this.component.multipleInstances?e:cz:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}(),fz=function(){function e(t){fy(this,e),this.name=t,this.providers=new Map}return dy(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new lz(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),hz=[],dz=function(){return(e=dz||(dz={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",dz;var e}(),vz={debug:dz.DEBUG,verbose:dz.VERBOSE,info:dz.INFO,warn:dz.WARN,error:dz.ERROR,silent:dz.SILENT},pz=dz.INFO,gz=(Zg(Xg={},dz.DEBUG,"log"),Zg(Xg,dz.VERBOSE,"log"),Zg(Xg,dz.INFO,"info"),Zg(Xg,dz.WARN,"warn"),Zg(Xg,dz.ERROR,"error"),Xg),yz=function(e,t){var n;if(!(t<e.logLevel)){var r=(new Date).toISOString(),i=gz[t];if(!i)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a=arguments.length,o=new Array(a>2?a-2:0),s=2;s<a;s++)o[s-2]=arguments[s];(n=console)[i].apply(n,["[".concat(r,"]  ").concat(e.name,":")].concat(o))}},mz=function(){function e(t){fy(this,e),this.name=t,this._logLevel=pz,this._logHandler=yz,this._userLogHandler=null,hz.push(this)}return dy(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in dz))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?vz[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,dz.DEBUG].concat(t)),this._logHandler.apply(this,[this,dz.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,dz.VERBOSE].concat(t)),this._logHandler.apply(this,[this,dz.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,dz.INFO].concat(t)),this._logHandler.apply(this,[this,dz.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,dz.WARN].concat(t)),this._logHandler.apply(this,[this,dz.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,dz.ERROR].concat(t)),this._logHandler.apply(this,[this,dz.ERROR].concat(t))}}]),e}(),kz=new WeakMap,Cz=new WeakMap,wz=new WeakMap,_z=new WeakMap,Ez=new WeakMap,bz={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Cz.get(e);if("objectStoreNames"===t)return e.objectStoreNames||wz.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Sz(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Sz(e){if(e instanceof IDBRequest)return function(e){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("success",i),e.removeEventListener("error",a)},i=function(){t(Sz(e.result)),r()},a=function(){n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(function(t){t instanceof IDBCursor&&kz.set(t,e)}).catch(function(){}),Ez.set(t,e),t}(e);if(_z.has(e))return _z.get(e);var t=function(e){return"function"==typeof e?function(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(sz||(sz=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Pz(this),n),Sz(kz.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Sz(e.apply(Pz(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.call.apply(e,[Pz(this),t].concat(r));return wz.set(a,t.sort?t.sort():[t]),Sz(a)}}(e):(e instanceof IDBTransaction&&function(e){if(!Cz.has(e)){var t=new Promise(function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});Cz.set(e,t)}}(e),function(e,t){return t.some(function(t){return e instanceof t})}(e,oz||(oz=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,bz):e)}(e);return t!==e&&(_z.set(e,t),Ez.set(t,e)),t}var Pz=function(e){return Ez.get(e)};function Oz(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=Sz(s);return i&&s.addEventListener("upgradeneeded",function(e){i(Sz(s.result),e.oldVersion,e.newVersion,Sz(s.transaction))}),r&&s.addEventListener("blocked",function(){return r()}),u.then(function(e){o&&e.addEventListener("close",function(){return o()}),a&&e.addEventListener("versionchange",function(){return a()})}).catch(function(){}),u}function Tz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.blocked,r=indexedDB.deleteDatabase(e);return n&&r.addEventListener("blocked",function(){return n()}),Sz(r).then(function(){})}var Iz,Az=["get","getKey","getAll","getAllKeys","count"],Rz=["put","add","delete","clear"],Mz=new Map;function xz(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(Mz.get(t))return Mz.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,i=Rz.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(i||Az.includes(n))){var a,o=(a=SB(regeneratorRuntime.mark(function e(t){var a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,i?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(a=s)[n].apply(a,c),i&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)});return Mz.set(t,o),o}}}bz=$g($g({},Iz=bz),{},{get:function(e,t,n){return xz(e,t)||Iz.get(e,t,n)},has:function(e,t){return!!xz(e,t)||Iz.has(e,t)}});var Nz=function(){function e(t){fy(this,e),this.container=t}return dy(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map(function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(function(e){return e}).join(" ")}}]),e}(),Dz="@firebase/app",Lz=new mz("@firebase/app"),Fz="[DEFAULT]",Uz=(Zg(ey={},Dz,"fire-core"),Zg(ey,"@firebase/app-compat","fire-core-compat"),Zg(ey,"@firebase/analytics","fire-analytics"),Zg(ey,"@firebase/analytics-compat","fire-analytics-compat"),Zg(ey,"@firebase/app-check","fire-app-check"),Zg(ey,"@firebase/app-check-compat","fire-app-check-compat"),Zg(ey,"@firebase/auth","fire-auth"),Zg(ey,"@firebase/auth-compat","fire-auth-compat"),Zg(ey,"@firebase/database","fire-rtdb"),Zg(ey,"@firebase/database-compat","fire-rtdb-compat"),Zg(ey,"@firebase/functions","fire-fn"),Zg(ey,"@firebase/functions-compat","fire-fn-compat"),Zg(ey,"@firebase/installations","fire-iid"),Zg(ey,"@firebase/installations-compat","fire-iid-compat"),Zg(ey,"@firebase/messaging","fire-fcm"),Zg(ey,"@firebase/messaging-compat","fire-fcm-compat"),Zg(ey,"@firebase/performance","fire-perf"),Zg(ey,"@firebase/performance-compat","fire-perf-compat"),Zg(ey,"@firebase/remote-config","fire-rc"),Zg(ey,"@firebase/remote-config-compat","fire-rc-compat"),Zg(ey,"@firebase/storage","fire-gcs"),Zg(ey,"@firebase/storage-compat","fire-gcs-compat"),Zg(ey,"@firebase/firestore","fire-fst"),Zg(ey,"@firebase/firestore-compat","fire-fst-compat"),Zg(ey,"fire-js","fire-js"),Zg(ey,"firebase","fire-js-all"),ey),Vz=new Map,Bz=new Map;function zz(e,t){try{e.container.addComponent(t)}catch(n){Lz.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function Hz(e){var t=e.name;if(Bz.has(t))return Lz.debug("There were multiple attempts to register component ".concat(t,".")),!1;Bz.set(t,e);var n,r=uy(Vz.values());try{for(r.s();!(n=r.n()).done;){zz(n.value,e)}}catch(i){r.e(i)}finally{r.f()}return!0}function Gz(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var $z=new YB("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."}),Zz=function(){function e(t,n,r){var i=this;fy(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new uz("app",function(){return i},"PUBLIC"))}return dy(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw $z.create("app-deleted",{appName:this._name})}}]),e}(),qz="9.9.0";function Wz(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fz,t=Vz.get(e);if(!t)throw $z.create("no-app",{appName:e});return t}function jz(){return Array.from(Vz.values())}function Yz(e,t,n){var r,i=null!==(r=Uz[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Lz.warn(s.join(" "))}Hz(new uz("".concat(i,"-version"),function(){return{library:i,version:t}},"VERSION"))}var Kz="firebase-heartbeat-store",Qz=null;function Xz(){return Qz||(Qz=Oz("firebase-heartbeat-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(Kz)}}).catch(function(e){throw $z.create("storage-open",{originalErrorMessage:e.message})})),Qz}function Jz(){return Jz=SB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xz();case 3:return e.abrupt("return",e.sent.transaction(Kz).objectStore(Kz).get(nH(t)));case 6:throw e.prev=6,e.t0=e.catch(0),$z.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 9:case"end":return e.stop()}},e,null,[[0,6]])})),Jz.apply(this,arguments)}function eH(e,t){return tH.apply(this,arguments)}function tH(){return tH=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xz();case 3:return i=e.sent.transaction(Kz,"readwrite"),e.next=6,i.objectStore(Kz).put(n,nH(t));case 6:return e.abrupt("return",i.done);case 9:throw e.prev=9,e.t0=e.catch(0),$z.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 12:case"end":return e.stop()}},e,null,[[0,9]])})),tH.apply(this,arguments)}function nH(e){return"".concat(e.name,"!").concat(e.options.appId)}var rH=function(){function e(t){var n=this;fy(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new aH(r),this._heartbeatsCachePromise=this._storage.read().then(function(e){return n._heartbeatsCache=e,e})}return dy(e,[{key:"triggerHeartbeat",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=iH(),t.t0=null===e._heartbeatsCache,!t.t0){t.next=6;break}return t.next=5,e._heartbeatsCachePromise;case 5:e._heartbeatsCache=t.sent;case 6:if(e._heartbeatsCache.lastSentHeartbeatDate===r||e._heartbeatsCache.heartbeats.some(function(e){return e.date===r})){t.next=8;break}return t.abrupt("return",(e._heartbeatsCache.heartbeats.push({date:r,agent:n}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),e._storage.overwrite(e._heartbeatsCache)));case 8:case"end":return t.stop()}},t)}))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=null===e._heartbeatsCache,!t.t0){t.next=4;break}return t.next=4,e._heartbeatsCachePromise;case 4:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=6;break}return t.abrupt("return","");case 6:if(n=iH(),r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],i=e.slice(),a=uy(e);try{var o=function(){var e=t.value,a=r.find(function(t){return t.agent===e.agent});if(a){if(a.dates.push(e.date),oH(r)>n)return a.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),oH(r)>n)return r.pop(),"break";i=i.slice(1)};for(a.s();!(t=a.n()).done;){var s=o();if("break"===s)break}}catch(u){a.e(u)}finally{a.f()}return{heartbeatsToSend:r,unsentEntries:i}}(e._heartbeatsCache.heartbeats),i=r.heartbeatsToSend,a=r.unsentEntries,o=UB(JSON.stringify({version:2,heartbeats:i})),e._heartbeatsCache.lastSentHeartbeatDate=n,!(a.length>0)){t.next=14;break}return e._heartbeatsCache.heartbeats=a,t.next=12,e._storage.overwrite(e._heartbeatsCache);case 12:t.next=15;break;case 14:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 15:return t.abrupt("return",o);case 16:case"end":return t.stop()}},t)}))()}}]),e}();function iH(){return(new Date).toISOString().substring(0,10)}var aH=function(){function e(t){fy(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return dy(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!!ZB()&&qB().then(function(){return!0}).catch(function(){return!1}));case 1:case"end":return e.stop()}},e)}))()}},{key:"read",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.t1=t.sent,!t.t1){t.next=7;break}return t.next=6,function(e){return Jz.apply(this,arguments)}(e.app);case 6:t.t1=t.sent;case 7:if(t.t0=t.t1,t.t0){t.next=10;break}t.t0={heartbeats:[]};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}},t)}))()}},{key:"overwrite",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",eH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 7:case"end":return n.stop()}},n)}))()}},{key:"add",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._canUseIndexedDBPromise;case 2:if(!n.sent){n.next=7;break}return n.next=5,t.read();case 5:return i=n.sent,n.abrupt("return",eH(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[].concat(oy(i.heartbeats),oy(e.heartbeats))}));case 7:case"end":return n.stop()}},n)}))()}}]),e}();function oH(e){return UB(JSON.stringify({version:2,heartbeats:e})).length}Hz(new uz("platform-logger",function(e){return new Nz(e)},"PRIVATE")),Hz(new uz("heartbeat",function(e){return new rH(e)},"PRIVATE")),Yz(Dz,"0.7.28",""),Yz(Dz,"0.7.28","esm2017"),Yz("fire-js","");var sH,uH="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},cH={},lH=lH||{},fH=uH||self;function hH(){}function dH(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function vH(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var pH="closure_uid_"+(1e9*Math.random()>>>0),gH=0;function yH(e,t,n){return e.call.apply(e.bind,arguments)}function mH(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function kH(e,t,n){return(kH=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?yH:mH).apply(null,arguments)}function CH(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function wH(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function _H(){this.s=this.s,this.o=this.o}var EH={};_H.prototype.s=!1,_H.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,pH)&&e[pH]||(e[pH]=++gH)}(this);delete EH[e]}},_H.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var bH=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},SH=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function PH(e){return Array.prototype.concat.apply([],arguments)}function OH(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function TH(e){return/^[\s\xa0]*$/.test(e)}var IH,AH=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function RH(e,t){return-1!=e.indexOf(t)}function MH(e,t){return e<t?-1:e>t?1:0}e:{var xH=fH.navigator;if(xH){var NH=xH.userAgent;if(NH){IH=NH;break e}}IH=""}function DH(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function LH(e){var t={};for(var n in e)t[n]=e[n];return t}var FH="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function UH(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<FH.length;a++)n=FH[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function VH(e){return VH[" "](e),e}VH[" "]=hH;var BH,zH=RH(IH,"Opera"),HH=RH(IH,"Trident")||RH(IH,"MSIE"),GH=RH(IH,"Edge"),$H=GH||HH,ZH=RH(IH,"Gecko")&&!(RH(IH.toLowerCase(),"webkit")&&!RH(IH,"Edge"))&&!(RH(IH,"Trident")||RH(IH,"MSIE"))&&!RH(IH,"Edge"),qH=RH(IH.toLowerCase(),"webkit")&&!RH(IH,"Edge");function WH(){var e=fH.document;return e?e.documentMode:void 0}e:{var jH="",YH=function(){var e=IH;return ZH?/rv:([^\);]+)(\)|;)/.exec(e):GH?/Edge\/([\d\.]+)/.exec(e):HH?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):qH?/WebKit\/(\S+)/.exec(e):zH?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(YH&&(jH=YH?YH[1]:""),HH){var KH=WH();if(null!=KH&&KH>parseFloat(jH)){BH=String(KH);break e}}BH=jH}var QH={};var XH=fH.document&&HH&&(WH()||parseInt(BH,10))||void 0,JH=function(){if(!fH.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{fH.addEventListener("test",hH,t),fH.removeEventListener("test",hH,t)}catch(n){}return e}();function eG(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function tG(e,t){if(eG.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(ZH){e:{try{VH(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:nG[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&tG.Z.h.call(this)}}eG.prototype.h=function(){this.defaultPrevented=!0},wH(tG,eG);var nG={2:"touch",3:"pen",4:"mouse"};tG.prototype.h=function(){tG.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var rG="closure_listenable_"+(1e6*Math.random()|0),iG=0;function aG(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++iG,this.ca=this.fa=!1}function oG(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function sG(e){this.src=e,this.g={},this.h=0}function uG(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=bH(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(oG(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function cG(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}sG.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=cG(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new aG(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var lG="closure_lm_"+(1e6*Math.random()|0),fG={};function hG(e,t,n,r,i){if(r&&r.once)return vG(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)hG(e,t[a],n,r,i);return null}return n=wG(n),e&&e[rG]?e.N(t,n,vH(r)?!!r.capture:!!r,i):dG(e,t,n,!1,r,i)}function dG(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=vH(i)?!!i.capture:!!i,s=kG(e);if(s||(e[lG]=s=new sG(e)),(n=s.add(t,n,r,o,a)).proxy)return n;if(r=function(){var e=mG;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)JH||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(yG(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function vG(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)vG(e,t[a],n,r,i);return null}return n=wG(n),e&&e[rG]?e.O(t,n,vH(r)?!!r.capture:!!r,i):dG(e,t,n,!0,r,i)}function pG(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)pG(e,t[a],n,r,i);else r=vH(r)?!!r.capture:!!r,n=wG(n),e&&e[rG]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=cG(a=e.g[t],n,r,i))&&(oG(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--))):e&&(e=kG(e))&&(t=e.g[t.toString()],e=-1,t&&(e=cG(t,n,r,i)),(n=-1<e?t[e]:null)&&gG(n))}function gG(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[rG])uG(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(yG(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=kG(t))?(uG(n,e),0==n.h&&(n.src=null,t[lG]=null)):oG(e)}}}function yG(e){return e in fG?fG[e]:fG[e]="on"+e}function mG(e,t){if(e.ca)e=!0;else{t=new tG(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&gG(e),e=n.call(r,t)}return e}function kG(e){return(e=e[lG])instanceof sG?e:null}var CG="__closure_events_fn_"+(1e9*Math.random()>>>0);function wG(e){return"function"==typeof e?e:(e[CG]||(e[CG]=function(t){return e.handleEvent(t)}),e[CG])}function _G(){_H.call(this),this.i=new sG(this),this.P=this,this.I=null}function EG(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new eG(t,e);else if(t instanceof eG)t.target=t.target||e;else{var i=t;UH(t=new eG(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=bG(o,r,!0,t)&&i}if(i=bG(o=t.g=e,r,!0,t)&&i,i=bG(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=bG(o=t.g=n[a],r,!1,t)&&i}function bG(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&uG(e.i,o),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}wH(_G,_H),_G.prototype[rG]=!0,_G.prototype.removeEventListener=function(e,t,n,r){pG(this,e,t,n,r)},_G.prototype.M=function(){if(_G.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)oG(n[r]);delete t.g[e],t.h--}}this.I=null},_G.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},_G.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var SG=fH.JSON.stringify;function PG(){var e=xG,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var OG,TG=new(function(){function e(t,n){fy(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return dy(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())(function(){return new IG},function(e){return e.reset()}),IG=function(){function e(){fy(this,e),this.next=this.g=this.h=null}return dy(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function AG(e){fH.setTimeout(function(){throw e},0)}function RG(e,t){OG||function(){var e=fH.Promise.resolve(void 0);OG=function(){e.then(NG)}}(),MG||(OG(),MG=!0),xG.add(e,t)}var MG=!1,xG=new(function(){function e(){fy(this,e),this.h=this.g=null}return dy(e,[{key:"add",value:function(e,t){var n=TG.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}());function NG(){for(var e;e=PG();){try{e.h.call(e.g)}catch(n){AG(n)}var t=TG;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}MG=!1}function DG(e,t){_G.call(this),this.h=e||1,this.g=t||fH,this.j=kH(this.kb,this),this.l=Date.now()}function LG(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function FG(e,t,n){if("function"==typeof e)n&&(e=kH(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=kH(e.handleEvent,e)}return 2147483647<Number(t)?-1:fH.setTimeout(e,t||0)}function UG(e){e.g=FG(function(){e.g=null,e.i&&(e.i=!1,UG(e))},e.j);var t=e.h;e.h=null,e.m.apply(null,t)}wH(DG,_G),(sH=DG.prototype).da=!1,sH.S=null,sH.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),EG(this,"tick"),this.da&&(LG(this),this.start()))}},sH.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},sH.M=function(){DG.Z.M.call(this),LG(this),delete this.g};var VG=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return dy(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:UG(this)}},{key:"M",value:function(){Qg(ay(n.prototype),"M",this).call(this),this.g&&(fH.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(_H);function BG(e){_H.call(this),this.h=e,this.g={}}wH(BG,_H);var zG=[];function HG(e,t,n,r){Array.isArray(n)||(n&&(zG[0]=n.toString()),n=zG);for(var i=0;i<n.length;i++){var a=hG(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function GG(e){DH(e.g,function(e,t){this.g.hasOwnProperty(t)&&gG(e)},e),e.g={}}function $G(){this.g=!0}function ZG(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return SG(n)}catch(s){return t}}(e,n)+(r?" "+r:"")})}BG.prototype.M=function(){BG.Z.M.call(this),GG(this)},BG.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},$G.prototype.Aa=function(){this.g=!1},$G.prototype.info=function(){};var qG={},WG=null;function jG(){return WG=WG||new _G}function YG(e){eG.call(this,qG.Ma,e)}function KG(e){var t=jG();EG(t,new YG(t,e))}function QG(e,t){eG.call(this,qG.STAT_EVENT,e),this.stat=t}function XG(e){var t=jG();EG(t,new QG(t,e))}function JG(e,t){eG.call(this,qG.Na,e),this.size=t}function e$(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return fH.setTimeout(function(){e()},t)}qG.Ma="serverreachability",wH(YG,eG),qG.STAT_EVENT="statevent",wH(QG,eG),qG.Na="timingevent",wH(JG,eG);var t$={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},n$={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function r$(){}function i$(){}r$.prototype.h=null;var a$,o$={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function s$(){eG.call(this,"d")}function u$(){eG.call(this,"c")}function c$(){}function l$(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new BG(this),this.P=h$,this.W=new DG(e=$H?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new f$}function f$(){this.i=null,this.g="",this.h=!1}wH(s$,eG),wH(u$,eG),wH(c$,r$),c$.prototype.g=function(){return new XMLHttpRequest},c$.prototype.i=function(){return{}},a$=new c$;var h$=45e3,d$={},v$={};function p$(e,t,n){e.K=1,e.v=U$(M$(t)),e.s=n,e.U=!0,g$(e,null)}function g$(e,t){e.F=Date.now(),C$(e),e.A=M$(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),Q$(n.h,"t",r),e.C=0,n=e.l.H,e.h=new f$,e.g=QZ(e.l,n?t:null,!e.s),0<e.O&&(e.L=new VG(kH(e.Ia,e,e.g),e.O)),HG(e.V,e.g,"readystatechange",e.gb),t=e.H?LH(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),KG(1),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a)for(var o="",s=a.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.X,e.s)}function y$(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Ba}function m$(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=k$(e,n))==v$){4==t&&(e.o=4,XG(14),i=!1),ZG(e.j,e.m,null,"[Incomplete Response]");break}if(r==d$){e.o=4,XG(15),ZG(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}ZG(e.j,e.m,r,null),S$(e,r)}y$(e)&&r!=v$&&r!=d$&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,XG(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),GZ(t),t.L=!0,XG(11))):(ZG(e.j,e.m,n,"[Invalid Chunked Response]"),b$(e),E$(e))}function k$(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?v$:(n=Number(t.substring(n,r)),isNaN(n)?d$:(r+=1)+n>t.length?v$:(t=t.substr(r,n),e.C=r+n,t))}function C$(e){e.Y=Date.now()+e.P,w$(e,e.P)}function w$(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=e$(kH(e.eb,e),t)}function _$(e){e.B&&(fH.clearTimeout(e.B),e.B=null)}function E$(e){0==e.l.G||e.I||qZ(e.l,e)}function b$(e){_$(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,LG(e.W),GG(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function S$(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||rZ(n.i,e)))if(n.I=e.N,!e.J&&rZ(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0])e:if(n.u)n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=e$(kH(n.ab,n),6e3));else{if(n.g){if(!(n.g.F+3e3<e.F))break e;ZZ(n),NZ(n)}HZ(n),XG(18)}if(1>=nZ(n.i)&&n.ka){try{n.ka()}catch(y){}n.ka=void 0}}else jZ(n,11)}else if((e.J||n.g==e)&&ZZ(n),!TH(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var o=a[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=a[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(n.K=r=1.5*u,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;!f.g&&(RH(l,"spdy")||RH(l,"quic")||RH(l,"h2"))&&(f.j=f.l,f.g=new Set,f.h&&(iZ(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,F$(r.F,r.D,h))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=KZ(r,r.H?r.la:null,r.W),d.J){aZ(r.i,d);var v=d,p=r.K;p&&v.setTimeout(p),v.B&&(_$(v),C$(v)),r.g=d}else zZ(r);0<n.l.length&&FZ(n)}else"stop"!=a[0]&&"close"!=a[0]||jZ(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?jZ(n,7):xZ(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}KG(4)}catch(m){}}function P$(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(dH(e)||"string"==typeof e)SH(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(dH(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(dH(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function O$(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof O$)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function T$(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];I$(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)I$(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function I$(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(sH=l$.prototype).setTimeout=function(e){this.P=e},sH.gb=function(e){e=e.target;var t=this.L;t&&3==TZ(e)?t.l():this.Ia(e)},sH.Ia=function(e){try{if(e==this.g)e:{var t=TZ(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||$H||this.g&&(this.h.h||this.g.ga()||IZ(this.g)))){this.I||4!=t||7==n||KG(8==n||0>=r?3:2),_$(this);var i=this.g.ba();this.N=i;t:if(y$(this)){var a=IZ(this.g);e="";var o=a.length,s=4==TZ(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){b$(this),E$(this);var u="";break t}this.h.i=new fH.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:s&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o})}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!TH(c)){var f=c;break t}}f=null}if(!(i=f)){this.i=!1,this.o=3,XG(12),b$(this),E$(this);break e}ZG(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,S$(this,i)}this.U?(m$(this,t,u),$H&&this.i&&3==t&&(HG(this.V,this.W,"tick",this.fb),this.W.start())):(ZG(this.j,this.m,u,null),S$(this,u)),4==t&&b$(this),this.i&&!this.I&&(4==t?qZ(this.l,this):(this.i=!1,C$(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,XG(12)):(this.o=0,XG(13)),b$(this),E$(this)}}}catch(h){}},sH.fb=function(){if(this.g){var e=TZ(this.g),t=this.g.ga();this.C<t.length&&(_$(this),m$(this,e,t),this.i&&4!=e&&C$(this))}},sH.cancel=function(){this.I=!0,b$(this)},sH.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(KG(3),XG(17)),b$(this),this.o=2,E$(this)):w$(this,this.Y-e)},(sH=O$.prototype).R=function(){T$(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},sH.T=function(){return T$(this),this.g.concat()},sH.get=function(e,t){return I$(this.h,e)?this.h[e]:t},sH.set=function(e,t){I$(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},sH.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var A$=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function R$(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof R$){this.g=void 0!==t?t:e.g,x$(this,e.j),this.s=e.s,N$(this,e.i),D$(this,e.m),this.l=e.l,t=e.h;var n=new W$;n.i=t.i,t.g&&(n.g=new O$(t.g),n.h=t.h),L$(this,n),this.o=e.o}else e&&(n=String(e).match(A$))?(this.g=!!t,x$(this,n[1]||"",!0),this.s=V$(n[2]||""),N$(this,n[3]||"",!0),D$(this,n[4]),this.l=V$(n[5]||"",!0),L$(this,n[6]||"",!0),this.o=V$(n[7]||"")):(this.g=!!t,this.h=new W$(null,this.g))}function M$(e){return new R$(e)}function x$(e,t,n){e.j=n?V$(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function N$(e,t,n){e.i=n?V$(t,!0):t}function D$(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function L$(e,t,n){t instanceof W$?(e.h=t,function(e,t){t&&!e.j&&(j$(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Y$(this,t),Q$(this,n,e))},e)),e.j=t}(e.h,e.g)):(n||(t=B$(t,Z$)),e.h=new W$(t,e.g))}function F$(e,t,n){e.h.set(t,n)}function U$(e){return F$(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function V$(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function B$(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,z$),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function z$(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}R$.prototype.toString=function(){var e=[],t=this.j;t&&e.push(B$(t,H$,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(B$(t,H$,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(B$(n,"/"==n.charAt(0)?$$:G$,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",B$(n,q$)),e.join("")};var H$=/[#\/\?@]/g,G$=/[#\?:]/g,$$=/[#\?]/g,Z$=/[#\?@]/g,q$=/#/g;function W$(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function j$(e){e.g||(e.g=new O$,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Y$(e,t){j$(e),t=X$(e,t),I$(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,I$((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&T$(e)))}function K$(e,t){return j$(e),t=X$(e,t),I$(e.g.h,t)}function Q$(e,t,n){Y$(e,t),0<n.length&&(e.i=null,e.g.set(X$(e,t),OH(n)),e.h+=n.length)}function X$(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function J$(e){this.l=e||eZ,e=fH.PerformanceNavigationTiming?0<(e=fH.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(fH.g&&fH.g.Ea&&fH.g.Ea()&&fH.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(sH=W$.prototype).add=function(e,t){j$(this),this.i=null,e=X$(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},sH.forEach=function(e,t){j$(this),this.g.forEach(function(n,r){SH(n,function(n){e.call(t,n,r,this)},this)},this)},sH.T=function(){j$(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},sH.R=function(e){j$(this);var t=[];if("string"==typeof e)K$(this,e)&&(t=PH(t,this.g.get(X$(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=PH(t,e[n])}return t},sH.set=function(e,t){return j$(this),this.i=null,K$(this,e=X$(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},sH.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},sH.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var o=i;""!==r[a]&&(o+="="+encodeURIComponent(String(r[a]))),e.push(o)}}return this.i=e.join("&")};var eZ=10;function tZ(e){return!!e.h||!!e.g&&e.g.size>=e.j}function nZ(e){return e.h?1:e.g?e.g.size:0}function rZ(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function iZ(e,t){e.g?e.g.add(t):e.h=t}function aZ(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function oZ(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=uy(e.g.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;n=n.concat(i.D)}}catch(a){r.e(a)}finally{r.f()}return n}return OH(e.i)}function sZ(){}function uZ(){this.g=new sZ}function cZ(e,t,n){var r=n||"";try{P$(e,function(e,n){var i=e;vH(e)&&(i=SG(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function lZ(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(a){}}function fZ(e){this.l=e.$b||null,this.j=e.ib||!1}function hZ(e,t){_G.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=dZ,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}J$.prototype.cancel=function(){if(this.i=oZ(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=uy(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},sZ.prototype.stringify=function(e){return fH.JSON.stringify(e,void 0)},sZ.prototype.parse=function(e){return fH.JSON.parse(e,void 0)},wH(fZ,r$),fZ.prototype.g=function(){return new hZ(this.l,this.j)},fZ.prototype.i=function(e){return function(){return e}}({}),wH(hZ,_G);var dZ=0;function vZ(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function pZ(e){e.readyState=4,e.l=null,e.j=null,e.A=null,gZ(e)}function gZ(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(sH=hZ.prototype).open=function(e,t){if(this.readyState!=dZ)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,gZ(this)},sH.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||fH).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},sH.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,pZ(this)),this.readyState=dZ},sH.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,gZ(this)),this.g&&(this.readyState=3,gZ(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==fH.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vZ(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},sH.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?pZ(this):gZ(this),3==this.readyState&&vZ(this)}},sH.Ua=function(e){this.g&&(this.response=this.responseText=e,pZ(this))},sH.Ta=function(e){this.g&&(this.response=e,pZ(this))},sH.ha=function(){this.g&&pZ(this)},sH.setRequestHeader=function(e,t){this.v.append(e,t)},sH.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},sH.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(hZ.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var yZ=fH.JSON.parse;function mZ(e){_G.call(this),this.headers=new O$,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=kZ,this.K=this.L=!1}wH(mZ,_G);var kZ="",CZ=/^https?$/i,wZ=["POST","PUT"];function _Z(e){return"content-type"==e.toLowerCase()}function EZ(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,bZ(e),PZ(e)}function bZ(e){e.D||(e.D=!0,EG(e,"complete"),EG(e,"error"))}function SZ(e){if(e.h&&void 0!==lH&&(!e.C[1]||4!=TZ(e)||2!=e.ba()))if(e.v&&4==TZ(e))FG(e.Fa,0,e);else if(EG(e,"readystatechange"),4==TZ(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(A$)[1]||null;if(!a&&fH.self&&fH.self.location){var o=fH.self.location.protocol;a=o.substr(0,o.length-1)}i=!CZ.test(a?a.toLowerCase():"")}t=i}if(t)EG(e,"complete"),EG(e,"success");else{e.m=6;try{var s=2<TZ(e)?e.g.statusText:""}catch(u){s=""}e.j=s+" ["+e.ba()+"]",bZ(e)}}finally{PZ(e)}}}function PZ(e,t){if(e.g){OZ(e);var n=e.g,r=e.C[0]?hH:null;e.g=null,e.C=null,t||EG(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function OZ(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(fH.clearTimeout(e.A),e.A=null)}function TZ(e){return e.g?e.g.readyState:0}function IZ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case kZ:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function AZ(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return DH(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):F$(e,t,n))}function RZ(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function MZ(e){this.za=0,this.l=[],this.h=new $G,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=RZ("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=RZ("baseRetryDelayMs",5e3,e),this.$a=RZ("retryDelaySeedMs",1e4,e),this.Ya=RZ("forwardChannelMaxRetries",2,e),this.ra=RZ("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new J$(e&&e.concurrentRequestLimit),this.Ca=new uZ,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function xZ(e){if(DZ(e),3==e.G){var t=e.V++,n=M$(e.F);F$(n,"SID",e.J),F$(n,"RID",t),F$(n,"TYPE","terminate"),VZ(e,n),(t=new l$(e,e.h,t,void 0)).K=2,t.v=U$(M$(n)),n=!1,fH.navigator&&fH.navigator.sendBeacon&&(n=fH.navigator.sendBeacon(t.v.toString(),"")),!n&&fH.Image&&((new Image).src=t.v,n=!0),n||(t.g=QZ(t.l,null),t.g.ea(t.v)),t.F=Date.now(),C$(t)}YZ(e)}function NZ(e){e.g&&(GZ(e),e.g.cancel(),e.g=null)}function DZ(e){NZ(e),e.u&&(fH.clearTimeout(e.u),e.u=null),ZZ(e),e.i.cancel(),e.m&&("number"==typeof e.m&&fH.clearTimeout(e.m),e.m=null)}function LZ(e,t){e.l.push(new(function(){return dy(function e(t,n){fy(this,e),this.h=t,this.g=n})}())(e.Za++,t)),3==e.G&&FZ(e)}function FZ(e){tZ(e.i)||e.m||(e.m=!0,RG(e.Ha,e),e.C=0)}function UZ(e,t){var n;n=t?t.m:e.V++;var r=M$(e.F);F$(r,"SID",e.J),F$(r,"RID",n),F$(r,"AID",e.U),VZ(e,r),e.o&&e.s&&AZ(r,e.o,e.s),n=new l$(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=BZ(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),iZ(e.i,n),p$(n,r,t)}function VZ(e,t){e.j&&P$({},function(e,n){F$(t,n,e)})}function BZ(e,t,n){n=Math.min(e.l.length,n);var r=e.j?kH(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),s=!1;else try{cZ(l,o,"req"+c+"_")}catch(f){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function zZ(e){e.g||e.u||(e.Y=1,RG(e.Ga,e),e.A=0)}function HZ(e){return!(e.g||e.u||3<=e.A||(e.Y++,e.u=e$(kH(e.Ga,e),WZ(e,e.A)),e.A++,0))}function GZ(e){null!=e.B&&(fH.clearTimeout(e.B),e.B=null)}function $Z(e){e.g=new l$(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=M$(e.oa);F$(t,"RID","rpc"),F$(t,"SID",e.J),F$(t,"CI",e.N?"0":"1"),F$(t,"AID",e.U),VZ(e,t),F$(t,"TYPE","xmlhttp"),e.o&&e.s&&AZ(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=U$(M$(t)),n.s=null,n.U=!0,g$(n,e)}function ZZ(e){null!=e.v&&(fH.clearTimeout(e.v),e.v=null)}function qZ(e,t){var n=null;if(e.g==t){ZZ(e),GZ(e),e.g=null;var r=2}else{if(!rZ(e.i,t))return;n=t.D,aZ(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;EG(r=jG(),new JG(r,n,t,i)),FZ(e)}else zZ(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(nZ(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=e$(kH(e.Ha,e,t),WZ(e,e.C)),e.C++,0)))}(e,t)||2==r&&HZ(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:jZ(e,5);break;case 4:jZ(e,10);break;case 3:jZ(e,6);break;default:jZ(e,2)}}function WZ(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function jZ(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=kH(e.jb,e);n||(n=new R$("//www.google.com/images/cleardot.gif"),fH.location&&"http"==fH.location.protocol||x$(n,"https"),U$(n)),function(e,t){var n=new $G;if(fH.Image){var r=new Image;r.onload=CH(lZ,n,r,"TestLoadImage: loaded",!0,t),r.onerror=CH(lZ,n,r,"TestLoadImage: error",!1,t),r.onabort=CH(lZ,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=CH(lZ,n,r,"TestLoadImage: timeout",!1,t),fH.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else XG(2);e.G=0,e.j&&e.j.va(t),YZ(e),DZ(e)}function YZ(e){e.G=0,e.I=-1,e.j&&((0!=oZ(e.i).length||0!=e.l.length)&&(e.i.i.length=0,OH(e.l),e.l.length=0),e.j.ua())}function KZ(e,t,n){var r=function(e){return e instanceof R$?M$(e):new R$(e,void 0)}(n);if(""!=r.i)t&&N$(r,t+"."+r.i),D$(r,r.m);else{var i=fH.location;r=function(e,t,n,r){var i=new R$(null,void 0);return e&&x$(i,e),t&&N$(i,t),n&&D$(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&DH(e.aa,function(e,t){F$(r,t,e)}),n=e.sa,(t=e.D)&&n&&F$(r,t,n),F$(r,"VER",e.ma),VZ(e,r),r}function QZ(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new mZ(n&&e.Ba&&!e.qa?new fZ({ib:!0}):e.qa)).L=e.H,t}function XZ(){}function JZ(){if(HH&&!(10<=Number(XH)))throw Error("Environmental error: no available transport.")}function eq(e,t){_G.call(this),this.g=new MZ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!TH(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!TH(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new rq(this)}function tq(e){s$.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function nq(){u$.call(this),this.status=1}function rq(e){this.g=e}(sH=mZ.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():a$.g(),this.C=function(e){return e.h||(e.h=e.i())}(this.u?this.u:a$),this.g.onreadystatechange=kH(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(a){return void EZ(this,a)}e=n||"";var i=new O$(this.headers);r&&P$(r,function(e,t){i.set(t,e)}),r=function(e){e:{for(var t=_Z,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=fH.FormData&&e instanceof fH.FormData,!(0<=bH(wZ,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(e,t){this.g.setRequestHeader(t,e)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{OZ(this),0<this.B&&((this.K=function(e){return HH&&function(){return e=QH,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){for(var e=0,t=AH(String(BH)).split("."),n=AH("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=MH(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||MH(0==a[2].length,0==o[2].length)||MH(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}();var e}()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=kH(this.pa,this)):this.A=FG(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(a){EZ(this,a)}},sH.pa=function(){void 0!==lH&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,EG(this,"timeout"),this.abort(8))},sH.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,EG(this,"complete"),EG(this,"abort"),PZ(this))},sH.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),PZ(this,!0)),mZ.Z.M.call(this)},sH.Fa=function(){this.s||(this.F||this.v||this.l?SZ(this):this.cb())},sH.cb=function(){SZ(this)},sH.ba=function(){try{return 2<TZ(this)?this.g.status:-1}catch(e){return-1}},sH.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},sH.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),yZ(t)}},sH.Da=function(){return this.m},sH.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(sH=MZ.prototype).ma=8,sH.G=1,sH.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(t){}},sH.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new l$(this,this.h,e,void 0),n=this.s;if(this.P&&(n?UH(n=LH(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=BZ(this,t,r),F$(i=M$(this.F),"RID",e),F$(i,"CVER",22),this.D&&F$(i,"X-HTTP-Session-Id",this.D),VZ(this,i),this.o&&n&&AZ(i,this.o,n),iZ(this.i,t),this.Ra&&F$(i,"TYPE","init"),this.ja?(F$(i,"$req",r),F$(i,"SID","null"),t.$=!0,p$(t,i,null)):p$(t,i,r),this.G=2}}else 3==this.G&&(e?UZ(this,e):0==this.l.length||tZ(this.i)||UZ(this))},sH.Ga=function(){if(this.u=null,$Z(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=e$(kH(this.bb,this),e)}},sH.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,XG(10),NZ(this),$Z(this))},sH.ab=function(){null!=this.v&&(this.v=null,NZ(this),HZ(this),XG(19))},sH.jb=function(e){e?(this.h.info("Successfully pinged google.com"),XG(2)):(this.h.info("Failed to ping google.com"),XG(1))},(sH=XZ.prototype).xa=function(){},sH.wa=function(){},sH.va=function(){},sH.ua=function(){},sH.Oa=function(){},JZ.prototype.g=function(e,t){return new eq(e,t)},wH(eq,_G),eq.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),RG(kH(e.hb,e,t))),XG(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=KZ(e,null,e.W),FZ(e)},eq.prototype.close=function(){xZ(this.g)},eq.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,LZ(this.g,t)}else this.v?((t={}).__data__=SG(e),LZ(this.g,t)):LZ(this.g,e)},eq.prototype.M=function(){this.g.j=null,delete this.j,xZ(this.g),delete this.g,eq.Z.M.call(this)},wH(tq,s$),wH(nq,u$),wH(rq,XZ),rq.prototype.xa=function(){EG(this.g,"a")},rq.prototype.wa=function(e){EG(this.g,new tq(e))},rq.prototype.va=function(e){EG(this.g,new nq(e))},rq.prototype.ua=function(){EG(this.g,"b")},JZ.prototype.createWebChannel=JZ.prototype.g,eq.prototype.send=eq.prototype.u,eq.prototype.open=eq.prototype.m,eq.prototype.close=eq.prototype.close,t$.NO_ERROR=0,t$.TIMEOUT=8,t$.HTTP_ERROR=6,n$.COMPLETE="complete",i$.EventType=o$,o$.OPEN="a",o$.CLOSE="b",o$.ERROR="c",o$.MESSAGE="d",_G.prototype.listen=_G.prototype.N,mZ.prototype.listenOnce=mZ.prototype.O,mZ.prototype.getLastError=mZ.prototype.La,mZ.prototype.getLastErrorCode=mZ.prototype.Da,mZ.prototype.getStatus=mZ.prototype.ba,mZ.prototype.getResponseJson=mZ.prototype.Qa,mZ.prototype.getResponseText=mZ.prototype.ga,mZ.prototype.send=mZ.prototype.ea;var iq=cH.createWebChannelTransport=function(){return new JZ},aq=cH.getStatEventTarget=function(){return jG()},oq=cH.ErrorCode=t$,sq=cH.EventType=n$,uq=cH.Event=qG,cq=cH.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},lq=cH.FetchXmlHttpFactory=fZ,fq=cH.WebChannel=i$,hq=cH.XhrIo=mZ,dq="@firebase/firestore",vq=function(){function e(t){fy(this,e),this.uid=t}return dy(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();vq.UNAUTHENTICATED=new vq(null),vq.GOOGLE_CREDENTIALS=new vq("google-credentials-uid"),vq.FIRST_PARTY=new vq("first-party-uid"),vq.MOCK_USER=new vq("mock-user");var pq="9.9.0",gq=new mz("@firebase/firestore");function yq(){return gq.logLevel}function mq(e){if(gq.logLevel<=dz.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(wq);gq.debug.apply(gq,["Firestore (".concat(pq,"): ").concat(e)].concat(oy(i)))}}function kq(e){if(gq.logLevel<=dz.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(wq);gq.error.apply(gq,["Firestore (".concat(pq,"): ").concat(e)].concat(oy(i)))}}function Cq(e){if(gq.logLevel<=dz.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map(wq);gq.warn.apply(gq,["Firestore (".concat(pq,"): ").concat(e)].concat(oy(i)))}}function wq(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(pq,") INTERNAL ASSERTION FAILED: ")+e;throw kq(t),new Error(t)}function Eq(e,t){e||_q()}function bq(e,t){return e}var Sq={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Pq=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,r)).code=e,i.message=r,i.toString=function(){return"".concat(i.name,": [code=").concat(i.code,"]: ").concat(i.message)},i}return dy(n)}(jB),Oq=dy(function e(){var t=this;fy(this,e),this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}),Tq=dy(function e(t,n){fy(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}),Iq=function(){function e(){fy(this,e)}return dy(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(vq.UNAUTHENTICATED)})}},{key:"shutdown",value:function(){}}]),e}(),Aq=function(){function e(t){fy(this,e),this.t=t,this.currentUser=vq.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return dy(e,[{key:"start",value:function(e,t){var n=this,r=this,i=this.i,a=function(e){return n.i!==i?(i=n.i,t(e)):Promise.resolve()},o=new Oq;this.o=function(){n.i++,n.currentUser=n.u(),o.resolve(),o=new Oq,e.enqueueRetryable(function(){return a(n.currentUser)})};var s=function(){var t=o;e.enqueueRetryable(SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(r.currentUser);case 4:case"end":return e.stop()}},e)})))},u=function(e){mq("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),s()};this.t.onInit(function(e){return u(e)}),setTimeout(function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?u(e):(mq("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Oq)}},0),s()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return e.i!==t?(mq("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Eq("string"==typeof n.accessToken),new Tq(n.accessToken,e.currentUser)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Eq(null===e||"string"==typeof e),new vq(e)}}]),e}(),Rq=dy(function e(t,n,r){fy(this,e),this.type="FirstParty",this.user=vq.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)}),Mq=function(){function e(t,n,r){fy(this,e),this.h=t,this.l=n,this.m=r}return dy(e,[{key:"getToken",value:function(){return Promise.resolve(new Rq(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable(function(){return t(vq.FIRST_PARTY)})}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),xq=dy(function e(t){fy(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}),Nq=function(){function e(t){fy(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return dy(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable(function(){return function(e){null!=e.error&&mq("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,mq("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)})};var r=function(e){mq("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit(function(e){return r(e)}),setTimeout(function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):mq("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(function(t){return t?(Eq("string"==typeof t.token),e.p=t.token,new xq(t.token)):null}):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function Dq(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Lq=function(){function e(){fy(this,e)}return dy(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=Dq(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function Fq(e,t){return e<t?-1:e>t?1:0}function Uq(e,t,n){return e.length===t.length&&e.every(function(e,r){return n(e,t[r])})}var Vq=function(){function e(t,n){if(fy(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Pq(Sq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Pq(Sq.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Pq(Sq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Pq(Sq.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return dy(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Fq(this.nanoseconds,e.nanoseconds):Fq(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),Bq=function(){function e(t){fy(this,e),this.timestamp=t}return dy(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Vq(0,0))}},{key:"max",value:function(){return new e(new Vq(253402300799,999999999))}}]),e}(),zq=function(){function e(t,n,r){fy(this,e),void 0===n?n=0:n>t.length&&_q(),void 0===r?r=t.length-n:r>t.length-n&&_q(),this.segments=t,this.offset=n,this.len=r}return dy(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach(function(e){n.push(e)}):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),Hq=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];for(var a=0,o=r;a<o.length;a++){var s=o[a];if(s.indexOf("//")>=0)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,oy(s.split("/").filter(function(e){return e.length>0})))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(zq),Gq=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$q=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map(function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return Gq.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new Pq(Sq.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Pq(Sq.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===s?(o=!o,i++):"."!==s||o?(r+=s,i++):(a(),i++)}if(a(),o)throw new Pq(Sq.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(zq),Zq=function(){function e(t){fy(this,e),this.path=t}return dy(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===Hq.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(Hq.fromString(t))}},{key:"fromName",value:function(t){return new e(Hq.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(Hq.emptyPath())}},{key:"comparator",value:function(e,t){return Hq.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new Hq(t.slice()))}}]),e}();function qq(e){return new Wq(e.readTime,e.key,-1)}var Wq=function(){function e(t,n,r){fy(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return dy(e,null,[{key:"min",value:function(){return new e(Bq.min(),Zq.empty(),-1)}},{key:"max",value:function(){return new e(Bq.max(),Zq.empty(),-1)}}]),e}();function jq(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=Zq.comparator(e.documentKey,t.documentKey))?n:Fq(e.largestBatchId,t.largestBatchId)}var Yq="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function Kq(e){return Qq.apply(this,arguments)}function Qq(){return Qq=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Sq.FAILED_PRECONDITION&&t.message===Yq){e.next=2;break}throw t;case 2:mq("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}},e)})),Qq.apply(this,arguments)}var Xq=function(){function e(t){var n=this;fy(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)},function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)})}return dy(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&_q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}})}},{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.next(t,n)})}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(n){return e.reject(n)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction(function(){return t(n)}):e.reject(n)}}],[{key:"resolve",value:function(t){return new e(function(e,n){e(t)})}},{key:"reject",value:function(t){return new e(function(e,n){n(t)})}},{key:"waitFor",value:function(t){return new e(function(e,n){var r=0,i=0,a=!1;t.forEach(function(t){++r,t.next(function(){++i,a&&i===r&&e()},function(e){return n(e)})}),a=!0,i===r&&e()})}},{key:"or",value:function(t){var n,r=e.resolve(!1),i=uy(t);try{var a=function(){var t=n.value;r=r.next(function(n){return n?e.resolve(n):t()})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach(function(e,i){r.push(t.call(n,e,i))}),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e(function(e,r){for(var i=t.length,a=new Array(i),o=0,s=function(s){var u=s;n(t[u]).next(function(t){a[u]=t,++o===i&&e(a)},function(e){return r(e)})},u=0;u<i;u++)s(u)})}},{key:"doWhile",value:function(t,n){return new e(function(e,r){!function i(){!0===t()?n().next(function(){i()},r):e()}()})}}]),e}();function Jq(e){return"IndexedDbTransactionError"===e.name}var eW=function(){function e(t,n){var r=this;fy(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return dy(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function tW(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function nW(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function rW(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}eW.ot=-1;var iW=function(){function e(t,n){fy(this,e),this.comparator=t,this.root=n||oW.EMPTY}return dy(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,oW.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,oW.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal(function(t,n){return e(t,n),!1})}},{key:"toString",value:function(){var e=[];return this.inorderTraversal(function(t,n){return e.push("".concat(t,":").concat(n)),!1}),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new aW(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new aW(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new aW(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new aW(this.root,e,this.comparator,!0)}}]),e}(),aW=function(){function e(t,n,r,i){fy(this,e),this.isReverse=i,this.nodeStack=[];for(var a=1;!t.isEmpty();)if(a=n?r(t.key,n):1,n&&i&&(a*=-1),a<0)t=this.isReverse?t.left:t.right;else{if(0===a){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return dy(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),oW=function(){function e(t,n,r,i,a){fy(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=a?a:e.EMPTY,this.size=this.left.size+1+this.right.size}return dy(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _q();var e=this.left.check();if(e!==this.right.check())throw _q();return e+(this.isRed()?0:1)}}]),e}();oW.EMPTY=null,oW.RED=!0,oW.BLACK=!1,oW.EMPTY=new(function(){function e(){fy(this,e),this.size=0}return dy(e,[{key:"key",get:function(){throw _q()}},{key:"value",get:function(){throw _q()}},{key:"color",get:function(){throw _q()}},{key:"left",get:function(){throw _q()}},{key:"right",get:function(){throw _q()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new oW(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var sW=function(){function e(t){fy(this,e),this.comparator=t,this.data=new iW(this.comparator)}return dy(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal(function(t,n){return e(t),!1})}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new uW(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new uW(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach(function(e){t=t.add(e)}),t}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach(function(t){e.push(t)}),e}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),uW=function(){function e(t){fy(this,e),this.iter=t}return dy(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}(),cW=function(){function e(t){fy(this,e),this.fields=t,t.sort($q.comparator)}return dy(e,[{key:"unionWith",value:function(t){var n,r=new sW($q.comparator),i=uy(this.fields);try{for(i.s();!(n=i.n()).done;){var a=n.value;r=r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=uy(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=uy(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return Uq(this.fields,e.fields,function(e,t){return e.isEqual(t)})}}],[{key:"empty",value:function(){return new e([])}}]),e}(),lW=function(e){function t(e){fy(this,t),this.binaryString=e}return dy(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return btoa(this.binaryString)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Fq(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();lW.EMPTY_BYTE_STRING=new lW("");var fW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hW(e){if(Eq(!!e),"string"==typeof e){var t=0,n=fW.exec(e);if(Eq(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:dW(e.seconds),nanos:dW(e.nanos)}}function dW(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function vW(e){return"string"==typeof e?lW.fromBase64String(e):lW.fromUint8Array(e)}function pW(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function gW(e){var t=e.mapValue.fields.__previous_value__;return pW(t)?gW(t):t}function yW(e){var t=hW(e.mapValue.fields.__local_write_time__.timestampValue);return new Vq(t.seconds,t.nanos)}var mW=dy(function e(t,n,r,i,a,o,s,u){fy(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u}),kW=function(){function e(t,n){fy(this,e),this.projectId=t,this.database=n||"(default)"}return dy(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function CW(e){return null==e}function wW(e){return 0===e&&1/e==-1/0}var _W={fields:{__type__:{stringValue:"__max__"}}};function EW(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?pW(e)?4:FW(e)?9007199254740991:10:_q()}function bW(e,t){if(e===t)return!0;var n,r=EW(e);if(r!==EW(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return yW(e).isEqual(yW(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=hW(e.timestampValue),r=hW(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,vW(e.bytesValue).isEqual(vW(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return dW(e.geoPointValue.latitude)===dW(t.geoPointValue.latitude)&&dW(e.geoPointValue.longitude)===dW(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return dW(e.integerValue)===dW(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=dW(e.doubleValue),r=dW(t.doubleValue);return n===r?wW(n)===wW(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Uq(e.arrayValue.values||[],t.arrayValue.values||[],bW);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(tW(n)!==tW(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!bW(n[i],r[i])))return!1;return!0}(e,t);default:return _q()}}function SW(e,t){return void 0!==(e.values||[]).find(function(e){return bW(e,t)})}function PW(e,t){if(e===t)return 0;var n,r,i,a,o=EW(e),s=EW(t);if(o!==s)return Fq(o,s);switch(o){case 0:case 9007199254740991:return 0;case 1:return Fq(e.booleanValue,t.booleanValue);case 2:return r=t,i=dW((n=e).integerValue||n.doubleValue),a=dW(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return OW(e.timestampValue,t.timestampValue);case 4:return OW(yW(e),yW(t));case 5:return Fq(e.stringValue,t.stringValue);case 6:return function(e,t){var n=vW(e),r=vW(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=Fq(n[i],r[i]);if(0!==a)return a}return Fq(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Fq(dW(e.latitude),dW(t.latitude));return 0!==n?n:Fq(dW(e.longitude),dW(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=PW(n[i],r[i]);if(a)return a}return Fq(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===_W&&t===_W)return 0;if(e===_W)return 1;if(t===_W)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var s=Fq(r[o],a[o]);if(0!==s)return s;var u=PW(n[r[o]],i[a[o]]);if(0!==u)return u}return Fq(r.length,a.length)}(e.mapValue,t.mapValue);default:throw _q()}}function OW(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Fq(e,t);var n=hW(e),r=hW(t),i=Fq(n.seconds,r.seconds);return 0!==i?i:Fq(n.nanos,r.nanos)}function TW(e){return IW(e)}function IW(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(t=e.timestampValue,n=hW(t),"time(".concat(n.seconds,",").concat(n.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?vW(e.bytesValue).toBase64():"referenceValue"in e?Zq.fromName(e.referenceValue).toString():"geoPointValue"in e?"geo(".concat((r=e.geoPointValue).latitude,",").concat(r.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,i=uy(e.values||[]);try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+=IW(a)}}catch(o){i.e(o)}finally{i.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,i=uy(Object.keys(e.fields||{}).sort());try{for(i.s();!(t=i.n()).done;){var a=t.value;r?r=!1:n+=",",n+="".concat(a,":").concat(IW(e.fields[a]))}}catch(o){i.e(o)}finally{i.f()}return n+"}"}(e.mapValue):_q();var t,n,r}function AW(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function RW(e){return!!e&&"integerValue"in e}function MW(e){return!!e&&"arrayValue"in e}function xW(e){return!!e&&"nullValue"in e}function NW(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function DW(e){return!!e&&"mapValue"in e}function LW(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return nW(e.mapValue.fields,function(e,n){return t.mapValue.fields[e]=LW(n)}),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=LW(e.arrayValue.values[r]);return n}return Object.assign({},e)}function FW(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var UW=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!DW(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=LW(t)}},{key:"setAll",value:function(e){var t=this,n=$q.emptyPath(),r={},i=[];e.forEach(function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=LW(e):i.push(a.lastSegment())});var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());DW(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return bW(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];DW(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){nW(t,function(t,n){return e[t]=n});var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;delete e[a]}}catch(o){i.e(o)}finally{i.f()}}},{key:"clone",value:function(){return new e(LW(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function VW(e){var t=[];return nW(e.fields,function(e,n){var r=new $q([e]);if(DW(n)){var i=VW(n.mapValue).fields;if(0===i.length)t.push(r);else{var a,o=uy(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)}),new cW(t)}var BW=function(){function e(t,n,r,i,a,o){fy(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=i,this.data=a,this.documentState=o}return dy(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=UW.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=UW.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Bq.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,Bq.min(),Bq.min(),UW.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,Bq.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Bq.min(),UW.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Bq.min(),UW.empty(),2)}}]),e}(),zW=dy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;fy(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=o,this.endAt=s,this.ut=null});function HW(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new zW(e,t,n,r,i,a,o)}function GW(e){var t=bq(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map(function(e){return(t=e).field.canonicalString()+t.op.toString()+TW(t.value);var t}).join(","),n+="|ob:",n+=t.orderBy.map(function(e){return(t=e).field.canonicalString()+t.dir;var t}).join(","),CW(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(function(e){return TW(e)}).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(function(e){return TW(e)}).join(",")),t.ut=n}return t.ut}function $W(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!rj(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if((i=e.filters[r]).op!==(a=t.filters[r]).op||!i.field.isEqual(a.field)||!bW(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!aj(e.startAt,t.startAt)&&aj(e.endAt,t.endAt)}function ZW(e){return Zq.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var qW=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this)).field=e,a.op=r,a.value=i,a}return dy(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(PW(t,this.value)):null!==t&&EW(this.value)===EW(t)&&this.at(PW(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return _q()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new WW(e,t,r):"array-contains"===t?new QW(e,r):"in"===t?new XW(e,r):"not-in"===t?new JW(e,r):"array-contains-any"===t?new ej(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new jW(e,n):new YW(e,n)}}]),n}(function(){return dy(function e(){fy(this,e)})}()),WW=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r,i)).key=Zq.fromName(i.referenceValue),a}return dy(n,[{key:"matches",value:function(e){var t=Zq.comparator(e.key,this.key);return this.at(t)}}]),n}(qW),jW=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,"in",r)).keys=KW(0,r),i}return dy(n,[{key:"matches",value:function(e){return this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(qW),YW=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,"not-in",r)).keys=KW(0,r),i}return dy(n,[{key:"matches",value:function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})}}]),n}(qW);function KW(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(e){return Zq.fromName(e.referenceValue)})}var QW=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,"array-contains",r)}return dy(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return MW(t)&&SW(t.arrayValue,this.value)}}]),n}(qW),XW=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,"in",r)}return dy(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&SW(this.value.arrayValue,t)}}]),n}(qW),JW=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,"not-in",r)}return dy(n,[{key:"matches",value:function(e){if(SW(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!SW(this.value.arrayValue,t)}}]),n}(qW),ej=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,"array-contains-any",r)}return dy(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!MW(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(e){return SW(t.value.arrayValue,e)})}}]),n}(qW),tj=dy(function e(t,n){fy(this,e),this.position=t,this.inclusive=n}),nj=dy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";fy(this,e),this.field=t,this.dir=n});function rj(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function ij(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?Zq.comparator(Zq.fromName(o.referenceValue),n.key):PW(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function aj(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!bW(e.position[n],t.position[n]))return!1;return!0}var oj=dy(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;fy(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null});function sj(e){return new oj(e)}function uj(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function cj(e){var t,n=uy(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(i){n.e(i)}finally{n.f()}return null}function lj(e){return null!==e.collectionGroup}function fj(e){var t=bq(e);if(null===t.lt){t.lt=[];var n=cj(t),r=uj(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new nj(n)),t.lt.push(new nj($q.keyField(),"asc"));else{var i,a=!1,o=uy(t.explicitOrderBy);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.lt.push(s),s.field.isKeyField()&&(a=!0)}}catch(c){o.e(c)}finally{o.f()}if(!a){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new nj($q.keyField(),u))}}}return t.lt}function hj(e){var t=bq(e);if(!t.ft)if("F"===t.limitType)t.ft=HW(t.path,t.collectionGroup,fj(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],i=uy(fj(t));try{for(i.s();!(n=i.n()).done;){var a=n.value;r.push(new nj(a.field,"desc"===a.dir?"asc":"desc"))}}catch(u){i.e(u)}finally{i.f()}var o=t.endAt?new tj(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new tj(t.startAt.position,t.startAt.inclusive):null;t.ft=HW(t.path,t.collectionGroup,r,t.filters,t.limit,o,s)}return t.ft}function dj(e,t,n){return new oj(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function vj(e,t){return $W(hj(e),hj(t))&&e.limitType===t.limitType}function pj(e){return"".concat(GW(hj(e)),"|lt:").concat(e.limitType)}function gj(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(TW(t.value));var t}).join(", "),"]")),CW(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(function(e){return TW(e)}).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(function(e){return TW(e)}).join(",")),"Target(".concat(t,")")}(hj(e)),"; limitType=").concat(e.limitType,")")}function yj(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Zq.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=uy(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=uy(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&(s=t,!((o=e).startAt&&(n=o.startAt,r=fj(o),i=s,a=ij(n,r,i),!(n.inclusive?a<=0:a<0))||o.endAt&&!function(e,t,n){var r=ij(e,t,n);return e.inclusive?r>=0:r>0}(o.endAt,fj(o),s)));var n,r,i,a,o,s}function mj(e){return function(t,n){var r,i=!1,a=uy(fj(e));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=kj(o,t,n);if(0!==s)return s;i=i||o.field.isKeyField()}}catch(u){a.e(u)}finally{a.f()}return 0}}function kj(e,t,n){var r,i,a,o,s=e.field.isKeyField()?Zq.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),o=i.data.field(r),null!==a&&null!==o?PW(a,o):_q());switch(e.dir){case"asc":return s;case"desc":return-1*s;default:return _q()}}function Cj(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wW(t)?"-0":t}}function wj(e){return{integerValue:""+e}}var _j=dy(function e(){fy(this,e),this._=void 0});function Ej(e,t,n){return e instanceof Pj?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof Oj?Tj(e,t):e instanceof Ij?Aj(e,t):function(e,t){var n=Sj(e,t),r=Mj(n)+Mj(e._t);return RW(n)&&RW(e._t)?wj(r):Cj(e.wt,r)}(e,t);var r,i,a}function bj(e,t,n){return e instanceof Oj?Tj(e,t):e instanceof Ij?Aj(e,t):n}function Sj(e,t){return e instanceof Rj?RW(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}var Pj=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n)}(_j),Oj=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).elements=e,r}return dy(n)}(_j);function Tj(e,t){var n,r=xj(t),i=uy(e.elements);try{var a=function(){var e=n.value;r.some(function(t){return bW(t,e)})||r.push(e)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Ij=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).elements=e,r}return dy(n)}(_j);function Aj(e,t){var n,r=xj(t),i=uy(e.elements);try{var a=function(){var e=n.value;r=r.filter(function(t){return!bW(t,e)})};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return{arrayValue:{values:r}}}var Rj=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).wt=e,i._t=r,i}return dy(n)}(_j);function Mj(e){return dW(e.integerValue||e.doubleValue)}function xj(e){return MW(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var Nj=dy(function e(t,n){fy(this,e),this.field=t,this.transform=n}),Dj=dy(function e(t,n){fy(this,e),this.version=t,this.transformResults=n}),Lj=function(){function e(t,n){fy(this,e),this.updateTime=t,this.exists=n}return dy(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Fj(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Uj=dy(function e(){fy(this,e)});function Vj(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Qj(e.key,Lj.none()):new $j(e.key,e.data,Lj.none());var n,r=e.data,i=UW.empty(),a=new sW($q.comparator),o=uy(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!a.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?i.delete(s):i.set(s,u),a=a.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new Zj(e.key,i,new cW(a.toArray()),Lj.none())}function Bj(e,t,n){var r,i,a,o,s;e instanceof $j?(i=t,a=n,o=(r=e).value.clone(),s=Wj(r.fieldTransforms,i,a.transformResults),o.setAll(s),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()):e instanceof Zj?function(e,t,n){if(Fj(e.precondition,t)){var r=Wj(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(qj(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):t.convertToNoDocument(n.version).setHasCommittedMutations()}function zj(e,t,n,r){return e instanceof $j?function(e,t,n,r){if(!Fj(e.precondition,t))return n;var i=e.value.clone(),a=jj(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Zj?function(e,t,n,r){if(!Fj(e.precondition,t))return n;var i=jj(e.fieldTransforms,r,t),a=t.data;return a.setAll(qj(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(function(e){return e.field}))}(e,t,n,r):(a=n,Fj(e.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function Hj(e,t){var n,r=null,i=uy(e.fieldTransforms);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=t.data.field(a.field),s=Sj(a.transform,o||null);null!=s&&(null===r&&(r=UW.empty()),r.set(a.field,s))}}catch(u){i.e(u)}finally{i.f()}return r||null}function Gj(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(n=e.fieldTransforms)&&void 0===r||n&&r&&Uq(n,r,function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(r=t.transform,(n=e.transform)instanceof Oj&&r instanceof Oj||n instanceof Ij&&r instanceof Ij?Uq(n.elements,r.elements,bW):n instanceof Rj&&r instanceof Rj?bW(n._t,r._t):n instanceof Pj&&r instanceof Pj);var n,r}(e,t)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var $j=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return fy(this,n),(a=t.call(this)).key=e,a.value=r,a.precondition=i,a.fieldTransforms=o,a.type=0,a}return dy(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Uj),Zj=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return fy(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=i,o.precondition=a,o.fieldTransforms=s,o.type=1,o}return dy(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Uj);function qj(e){var t=new Map;return e.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}}),t}function Wj(e,t,n){var r=new Map;Eq(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,bj(o,s,n[i]))}return r}function jj(e,t,n){var r,i=new Map,a=uy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);i.set(o.field,Ej(s,u,t))}}catch(c){a.e(c)}finally{a.f()}return i}var Yj,Kj,Qj=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=2,i.fieldTransforms=[],i}return dy(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Uj),Xj=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).key=e,i.precondition=r,i.type=3,i.fieldTransforms=[],i}return dy(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Uj),Jj=dy(function e(t){fy(this,e),this.count=t});function eY(e){switch(e){default:return _q();case Sq.CANCELLED:case Sq.UNKNOWN:case Sq.DEADLINE_EXCEEDED:case Sq.RESOURCE_EXHAUSTED:case Sq.INTERNAL:case Sq.UNAVAILABLE:case Sq.UNAUTHENTICATED:return!1;case Sq.INVALID_ARGUMENT:case Sq.NOT_FOUND:case Sq.ALREADY_EXISTS:case Sq.PERMISSION_DENIED:case Sq.FAILED_PRECONDITION:case Sq.ABORTED:case Sq.OUT_OF_RANGE:case Sq.UNIMPLEMENTED:case Sq.DATA_LOSS:return!0}}function tY(e){if(void 0===e)return kq("GRPC error has no .code"),Sq.UNKNOWN;switch(e){case Yj.OK:return Sq.OK;case Yj.CANCELLED:return Sq.CANCELLED;case Yj.UNKNOWN:return Sq.UNKNOWN;case Yj.DEADLINE_EXCEEDED:return Sq.DEADLINE_EXCEEDED;case Yj.RESOURCE_EXHAUSTED:return Sq.RESOURCE_EXHAUSTED;case Yj.INTERNAL:return Sq.INTERNAL;case Yj.UNAVAILABLE:return Sq.UNAVAILABLE;case Yj.UNAUTHENTICATED:return Sq.UNAUTHENTICATED;case Yj.INVALID_ARGUMENT:return Sq.INVALID_ARGUMENT;case Yj.NOT_FOUND:return Sq.NOT_FOUND;case Yj.ALREADY_EXISTS:return Sq.ALREADY_EXISTS;case Yj.PERMISSION_DENIED:return Sq.PERMISSION_DENIED;case Yj.FAILED_PRECONDITION:return Sq.FAILED_PRECONDITION;case Yj.ABORTED:return Sq.ABORTED;case Yj.OUT_OF_RANGE:return Sq.OUT_OF_RANGE;case Yj.UNIMPLEMENTED:return Sq.UNIMPLEMENTED;case Yj.DATA_LOSS:return Sq.DATA_LOSS;default:return _q()}}(Kj=Yj||(Yj={}))[Kj.OK=0]="OK",Kj[Kj.CANCELLED=1]="CANCELLED",Kj[Kj.UNKNOWN=2]="UNKNOWN",Kj[Kj.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kj[Kj.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kj[Kj.NOT_FOUND=5]="NOT_FOUND",Kj[Kj.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kj[Kj.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kj[Kj.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kj[Kj.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kj[Kj.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kj[Kj.ABORTED=10]="ABORTED",Kj[Kj.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kj[Kj.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kj[Kj.INTERNAL=13]="INTERNAL",Kj[Kj.UNAVAILABLE=14]="UNAVAILABLE",Kj[Kj.DATA_LOSS=15]="DATA_LOSS";var nY=function(){function e(t,n){fy(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return dy(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){var a=qg(r.value,2),o=a[0],s=a[1];if(this.equalsFn(o,e))return s}}catch(u){i.e(u)}finally{i.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){nW(this.inner,function(t,n){var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){var a=qg(r.value,2),o=a[0],s=a[1];e(o,s)}}catch(u){i.e(u)}finally{i.f()}})}},{key:"isEmpty",value:function(){return rW(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),rY=new iW(Zq.comparator);function iY(){return rY}var aY=new iW(Zq.comparator);function oY(){for(var e=aY,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.insert(o.key,o)}return e}function sY(e){var t=aY;return e.forEach(function(e,n){return t=t.insert(e,n.overlayedDocument)}),t}function uY(){return lY()}function cY(){return lY()}function lY(){return new nY(function(e){return e.toString()},function(e,t){return e.isEqual(t)})}var fY=new iW(Zq.comparator),hY=new sW(Zq.comparator);function dY(){for(var e=hY,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=e.add(o)}return e}var vY=new sW(Fq);function pY(){return vY}var gY=function(){function e(t,n,r,i,a){fy(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}return dy(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,yY.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(Bq.min(),r,pY(),iY(),dY())}}]),e}(),yY=function(){function e(t,n,r,i,a){fy(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}return dy(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(lW.EMPTY_BYTE_STRING,n,dY(),dY(),dY())}}]),e}(),mY=dy(function e(t,n,r,i){fy(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=i}),kY=dy(function e(t,n){fy(this,e),this.targetId=t,this.It=n}),CY=dy(function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lW.EMPTY_BYTE_STRING,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;fy(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=i}),wY=function(){function e(){fy(this,e),this.Tt=0,this.Et=bY(),this.At=lW.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return dy(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=dY(),t=dY(),n=dY();return this.Et.forEach(function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:_q()}}),new yY(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=bY()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),_Y=function(){function e(t){fy(this,e),this.Mt=t,this.Ft=new Map,this.$t=iY(),this.Bt=EY(),this.Lt=new sW(Fq)}return dy(e,[{key:"Ut",value:function(e){var t,n=uy(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var i,a=uy(e.removedTargetIds);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.Kt(o,e.key,e.yt)}}catch(s){a.e(s)}finally{a.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:_q()}})}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach(function(e,r){n.jt(r)&&t(r)})}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var i=r.target;if(ZW(i))if(0===n){var a=new Zq(i.path);this.Kt(t,a,BW.newNoDocument(a,Bq.min()))}else Eq(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach(function(r,i){var a=t.Ht(i);if(a){if(r.current&&ZW(a.target)){var o=new Zq(a.target.path);null!==t.$t.get(o)||t.Xt(i,o)||t.Kt(i,o,BW.newNoDocument(o,e))}r.vt&&(n.set(i,r.St()),r.Dt())}});var r=dY();this.Bt.forEach(function(e,n){var i=!0;n.forEachWhile(function(e){var n=t.Ht(e);return!n||2===n.purpose||(i=!1,!1)}),i&&(r=r.add(e))}),this.$t.forEach(function(t,n){return n.setReadTime(e)});var i=new gY(e,n,this.Lt,this.$t,r);return this.$t=iY(),this.Bt=EY(),this.Lt=new sW(Fq),i}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new wY,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new sW(Fq),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||mq("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new wY),this.Mt.getRemoteKeysForTarget(e).forEach(function(n){t.Kt(e,n,null)})}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function EY(){return new iW(Zq.comparator)}function bY(){return new iW(Zq.comparator)}var SY={asc:"ASCENDING",desc:"DESCENDING"},PY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OY=dy(function e(t,n){fy(this,e),this.databaseId=t,this.dt=n});function TY(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function IY(e,t){return e.dt?t.toBase64():t.toUint8Array()}function AY(e,t){return TY(e,t.toTimestamp())}function RY(e){return Eq(!!e),Bq.fromTimestamp((t=hW(e),new Vq(t.seconds,t.nanos)));var t}function MY(e,t){return(n=e,new Hq(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function xY(e){var t=Hq.fromString(e);return Eq(QY(t)),t}function NY(e,t){return MY(e.databaseId,t.path)}function DY(e,t){var n=xY(t);if(n.get(1)!==e.databaseId.projectId)throw new Pq(Sq.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Pq(Sq.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Zq(UY(n))}function LY(e,t){return MY(e.databaseId,t)}function FY(e){return new Hq(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function UY(e){return Eq(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function VY(e,t,n){return{name:NY(e,t),fields:n.value.mapValue.fields}}function BY(e,t){return{documents:[LY(e,t.path)]}}function zY(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=LY(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=LY(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map(function(e){return function(e){if("=="===e.op){if(NW(e.value))return{unaryFilter:{field:qY(e.field),op:"IS_NAN"}};if(xW(e.value))return{unaryFilter:{field:qY(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(NW(e.value))return{unaryFilter:{field:qY(e.field),op:"IS_NOT_NAN"}};if(xW(e.value))return{unaryFilter:{field:qY(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qY(e.field),op:ZY(e.op),value:e.value}}}(e)});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map(function(e){return{field:qY((t=e).field),direction:$Y(t.dir)};var t})}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,s,u,c=(o=t.limit,e.dt||CW(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),n}function HY(e){var t=function(e){var t=xY(e);return 4===t.length?Hq.emptyPath():UY(t)}(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Eq(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=GY(n.where));var s=[];n.orderBy&&(s=n.orderBy.map(function(e){return new nj(WY((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));var u=null;n.limit&&(u=function(e){var t;return CW(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c,l=null;n.startAt&&(l=new tj((c=n.startAt).values||[],!!c.before));var f=null;return n.endAt&&(f=function(e){return new tj(e.values||[],!e.before)}(n.endAt)),function(e,t,n,r,i,a,o,s){return new oj(e,t,n,r,i,"F",o,s)}(t,i,s,o,u,0,l,f)}function GY(e){return e?void 0!==e.unaryFilter?[YY(e)]:void 0!==e.fieldFilter?[jY(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return GY(e)}).reduce(function(e,t){return e.concat(t)}):_q():[]}function $Y(e){return SY[e]}function ZY(e){return PY[e]}function qY(e){return{fieldPath:e.canonicalString()}}function WY(e){return $q.fromServerFormat(e.fieldPath)}function jY(e){return qW.create(WY(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _q()}}(e.fieldFilter.op),e.fieldFilter.value)}function YY(e){switch(e.unaryFilter.op){case"IS_NAN":var t=WY(e.unaryFilter.field);return qW.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=WY(e.unaryFilter.field);return qW.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=WY(e.unaryFilter.field);return qW.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=WY(e.unaryFilter.field);return qW.create(i,"!=",{nullValue:"NULL_VALUE"});default:return _q()}}function KY(e){var t=[];return e.fields.forEach(function(e){return t.push(e.canonicalString())}),{fieldPaths:t}}function QY(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var XY=function(){function e(t,n,r,i){fy(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}return dy(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Bj(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=uy(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.key.isEqual(e.key)&&(t=zj(i,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var a,o=uy(this.mutations);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.key.isEqual(e.key)&&(t=zj(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=cY();return this.mutations.forEach(function(i){var a=e.get(i.key),o=a.overlayedDocument,s=n.applyToLocalView(o,a.mutatedFields),u=Vj(o,s=t.has(i.key)?null:s);null!==u&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(Bq.min())}),r}},{key:"keys",value:function(){return this.mutations.reduce(function(e,t){return e.add(t.key)},dY())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&Uq(this.mutations,e.mutations,function(e,t){return Gj(e,t)})&&Uq(this.baseMutations,e.baseMutations,function(e,t){return Gj(e,t)})}}]),e}(),JY=function(){function e(t,n,r,i){fy(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}return dy(e,null,[{key:"from",value:function(t,n,r){Eq(t.mutations.length===r.length);for(var i=fY,a=t.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new e(t,n,r,i)}}]),e}(),eK=function(){function e(t,n){fy(this,e),this.largestBatchId=t,this.mutation=n}return dy(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),tK=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Bq.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Bq.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:lW.EMPTY_BYTE_STRING;fy(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return dy(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),nK=dy(function e(t){fy(this,e),this.ne=t});function rK(e){var t=HY({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?dj(t,t.limit,"L"):t}var iK=function(){function e(){fy(this,e)}return dy(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(dW(e.integerValue));else if("doubleValue"in e){var n=dW(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),wW(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(vW(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ce(t,45),t.ae(i.latitude||0),t.ae(i.longitude||0)}else"mapValue"in e?FW(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):_q()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];this.le(a,t),this.oe(n[a],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.oe(a,t)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),Zq.fromName(e).path.forEach(function(e){n.ce(t,60),n.ge(e,t)})}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();iK.ye=new iK;var aK=function(){function e(){fy(this,e),this.ze=new oK}return dy(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),Xq.resolve()}},{key:"getCollectionParents",value:function(e,t){return Xq.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Xq.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Xq.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Xq.resolve(null)}},{key:"getIndexType",value:function(e,t){return Xq.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Xq.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Xq.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Xq.resolve(Wq.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Xq.resolve(Wq.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Xq.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Xq.resolve()}}]),e}(),oK=function(){function e(){fy(this,e),this.index={}}return dy(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new sW(Hq.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new sW(Hq.comparator)).toArray()}}]),e}();new Uint8Array(0);var sK=function(){function e(t,n,r){fy(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return dy(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();sK.DEFAULT_COLLECTION_PERCENTILE=10,sK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sK.DEFAULT=new sK(41943040,sK.DEFAULT_COLLECTION_PERCENTILE,sK.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sK.DISABLED=new sK(-1,0,0);var uK=function(){function e(t){fy(this,e),this.En=t}return dy(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}(),cK=dy(function e(t,n){fy(this,e),this.overlayedDocument=t,this.mutatedFields=n}),lK=function(){function e(t,n,r,i){fy(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}return dy(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next(function(i){return r=i,n.getBaseDocument(e,t,r)}).next(function(e){return null!==r&&zj(r.mutation,e,cW.empty(),Vq.now()),e})}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.getLocalViewOfDocuments(e,t,dY()).next(function(){return t})})}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:dY(),i=uY();return this.populateOverlays(e,i,t).next(function(){return n.computeViews(e,t,i,r).next(function(e){var t=oY();return e.forEach(function(e,n){t=t.insert(e,n.overlayedDocument)}),t})})}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=uY();return this.populateOverlays(e,r,t).next(function(){return n.computeViews(e,t,r,dY())})}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach(function(e){t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(function(e){e.forEach(function(e,n){t.set(e,n)})})}},{key:"computeViews",value:function(e,t,n,r){var i=iY(),a=lY(),o=lY();return t.forEach(function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Zj)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),zj(o.mutation,t,o.mutation.getFieldMask(),Vq.now()))}),this.recalculateAndSaveOverlays(e,i).next(function(e){return e.forEach(function(e,t){return a.set(e,t)}),t.forEach(function(e,t){var n;return o.set(e,new cK(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),o})}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=lY(),i=new iW(function(e,t){return e-t}),a=dY();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(function(e){var n,a=uy(e);try{var o=function(){var e=n.value;e.keys().forEach(function(n){var a=t.get(n);if(null!==a){var o=r.get(n)||cW.empty();o=e.applyToLocalView(a,o),r.set(n,o);var s=(i.get(e.batchId)||dY()).add(n);i=i.insert(e.batchId,s)}})};for(a.s();!(n=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}}).next(function(){for(var o=[],s=i.getReverseIterator(),u=function(){var i=s.getNext(),u=i.key,c=i.value,l=cY();c.forEach(function(e){if(!a.has(e)){var n=Vj(t.get(e),r.get(e));null!==n&&l.set(e,n),a=a.add(e)}}),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return Xq.waitFor(o)}).next(function(){return r})}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next(function(t){return n.recalculateAndSaveOverlays(e,t)})}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return Zq.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):lj(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(function(a){var o=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Xq.resolve(uY()),s=-1,u=a;return o.next(function(t){return Xq.forEach(t,function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Xq.resolve():i.getBaseDocument(e,t,n).next(function(e){u=u.insert(t,e)})}).next(function(){return i.populateOverlays(e,t,a)}).next(function(){return i.computeViews(e,u,t,dY())}).next(function(e){return{batchId:s,changes:sY(e)}})})})}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new Zq(t)).next(function(e){var t=oY();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=oY();return this.indexManager.getCollectionParents(e,i).next(function(o){return Xq.forEach(o,function(o){var s,u,c=(s=t,u=o.child(i),new oj(u,null,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next(function(e){e.forEach(function(e,t){a=a.insert(e,t)})})}).next(function(){return a})})}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)}).next(function(e){e.forEach(function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,BW.newInvalidDocument(n)))});var n=oY();return r.forEach(function(r,i){var a=e.get(r);void 0!==a&&zj(a.mutation,i,cW.empty(),Vq.now()),yj(t,i)&&(n=n.insert(r,i))}),n})}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):Xq.resolve(BW.newInvalidDocument(t))}}]),e}(),fK=function(){function e(t){fy(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return dy(e,[{key:"getBundleMetadata",value:function(e,t){return Xq.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:RY(n.createTime)}),Xq.resolve()}},{key:"getNamedQuery",value:function(e,t){return Xq.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:rK(n.bundledQuery),readTime:RY(n.readTime)}),Xq.resolve();var n}}]),e}(),hK=function(){function e(){fy(this,e),this.overlays=new iW(Zq.comparator),this.Xn=new Map}return dy(e,[{key:"getOverlay",value:function(e,t){return Xq.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=uY();return Xq.forEach(t,function(t){return n.getOverlay(e,t).next(function(e){null!==e&&r.set(t,e)})}).next(function(){return r})}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach(function(n,i){r.ie(e,t,i)}),Xq.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Xn.get(n);return void 0!==i&&(i.forEach(function(e){return r.overlays=r.overlays.remove(e)}),this.Xn.delete(n)),Xq.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=uY(),i=t.length+1,a=new Zq(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&s.largestBatchId>n&&r.set(s.getKey(),s)}return Xq.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new iW(function(e,t){return e-t}),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=i.get(o.largestBatchId);null===s&&(s=uY(),i=i.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=uY(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach(function(e,t){return u.set(e,t)}),!(u.size()>=r)););return Xq.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new eK(t,n));var a=this.Xn.get(t);void 0===a&&(a=dY(),this.Xn.set(t,a)),this.Xn.set(t,a.add(n.key))}}]),e}(),dK=function(){function e(){fy(this,e),this.Zn=new sW(vK.ts),this.es=new sW(vK.ns)}return dy(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new vK(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})}},{key:"removeReference",value:function(e,t){this.rs(new vK(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})}},{key:"us",value:function(e){var t=this,n=new Zq(new Hq([])),r=new vK(n,e),i=new vK(n,e+1),a=[];return this.es.forEachInRange([r,i],function(e){t.rs(e),a.push(e.key)}),a}},{key:"cs",value:function(){var e=this;this.Zn.forEach(function(t){return e.rs(t)})}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new Zq(new Hq([])),n=new vK(t,e),r=new vK(t,e+1),i=dY();return this.es.forEachInRange([n,r],function(e){i=i.add(e.key)}),i}},{key:"containsKey",value:function(e){var t=new vK(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),vK=function(){function e(t,n){fy(this,e),this.key=t,this.ls=n}return dy(e,null,[{key:"ts",value:function(e,t){return Zq.comparator(e.key,t.key)||Fq(e.ls,t.ls)}},{key:"ns",value:function(e,t){return Fq(e.ls,t.ls)||Zq.comparator(e.key,t.key)}}]),e}(),pK=function(){function e(t,n){fy(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new sW(vK.ts)}return dy(e,[{key:"checkEmpty",value:function(e){return Xq.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.fs;this.fs++;var a=new XY(i,t,n,r);this.mutationQueue.push(a);var o,s=uy(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new vK(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return Xq.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Xq.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this.ws(t+1),r=n<0?0:n;return Xq.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Xq.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return Xq.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new vK(t,0),i=new vK(t,Number.POSITIVE_INFINITY),a=[];return this.ds.forEachInRange([r,i],function(e){var t=n._s(e.ls);a.push(t)}),Xq.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new sW(Fq);return t.forEach(function(e){var t=new vK(e,0),i=new vK(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,i],function(e){r=r.add(e.ls)})}),Xq.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;Zq.isDocumentKey(i)||(i=i.child(""));var a=new vK(new Zq(i),0),o=new sW(Fq);return this.ds.forEachWhile(function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)},a),Xq.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach(function(e){var r=t._s(e);null!==r&&n.push(r)}),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Eq(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return Xq.forEach(t.mutations,function(i){var a=new vK(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(function(){n.ds=r})}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new vK(t,0),r=this.ds.firstAfterOrEqual(n);return Xq.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return Xq.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),gK=function(){function e(t){fy(this,e),this.ps=t,this.docs=new iW(Zq.comparator),this.size=0}return dy(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Xq.resolve(n?n.document.mutableCopy():BW.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=iY();return t.forEach(function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():BW.newInvalidDocument(e))}),Xq.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=iY(),i=new Zq(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||jq(qq(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return Xq.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){_q()}},{key:"Is",value:function(e,t){return Xq.forEach(this.docs,function(e){return t(e)})}},{key:"newChangeBuffer",value:function(e){return new yK(this)}},{key:"getSize",value:function(e){return Xq.resolve(this.size)}}]),e}(),yK=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).zn=e,r}return dy(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach(function(r,i){i.isValidDocument()?n.push(t.zn.addEntry(e,i)):t.zn.removeEntry(r)}),Xq.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(function(){function e(){fy(this,e),this.changes=new nY(function(e){return e.toString()},function(e,t){return e.isEqual(t)}),this.changesApplied=!1}return dy(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,BW.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Xq.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}()),mK=function(){function e(t){fy(this,e),this.persistence=t,this.Ts=new nY(function(e){return GW(e)},$W),this.lastRemoteSnapshotVersion=Bq.min(),this.highestTargetId=0,this.Es=0,this.As=new dK,this.targetCount=0,this.Rs=uK.An()}return dy(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach(function(e,n){return t(n)}),Xq.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Xq.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Xq.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),Xq.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),Xq.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new uK(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,Xq.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),Xq.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,Xq.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Ts.forEach(function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),a.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)}),Xq.waitFor(a).next(function(){return i})}},{key:"getTargetCount",value:function(e){return Xq.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return Xq.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),Xq.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(function(t){i.push(r.markPotentiallyOrphaned(e,t))}),Xq.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),Xq.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return Xq.resolve(n)}},{key:"containsKey",value:function(e,t){return Xq.resolve(this.As.containsKey(t))}}]),e}(),kK=function(){function e(t,n){var r=this;fy(this,e),this.bs={},this.overlays={},this.Ps=new eW(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new mK(this),this.indexManager=new aK,this.remoteDocumentCache=new gK(function(e){return r.referenceDelegate.Ss(e)}),this.wt=new nK(n),this.Ds=new fK(this.wt)}return dy(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new hK,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new pK(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;mq("MemoryPersistence","Starting transaction:",e);var i=new CK(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next(function(e){return r.referenceDelegate.xs(i).next(function(){return e})}).toPromise().then(function(e){return i.raiseOnCommittedEvent(),e})}},{key:"Ns",value:function(e,t){return Xq.or(Object.values(this.bs).map(function(n){return function(){return n.containsKey(e,t)}}))}}]),e}(),CK=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return dy(n)}(function(){function e(){fy(this,e),this.onCommittedListeners=[]}return dy(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach(function(e){return e()})}}]),e}()),wK=function(){function e(t){fy(this,e),this.persistence=t,this.ks=new dK,this.Os=null}return dy(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw _q()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),Xq.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),Xq.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),Xq.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach(function(e){return n.Fs.add(e.toString())});var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(function(e){e.forEach(function(e){return n.Fs.add(e.toString())})}).next(function(){return r.removeTargetData(e,t)})}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xq.forEach(this.Fs,function(r){var i=Zq.fromPath(r);return t.$s(e,i).next(function(e){e||n.removeEntry(i,Bq.min())})}).next(function(){return t.Os=null,n.apply(e)})}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next(function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())})}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return Xq.or([function(){return Xq.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}(),_K=function(){function e(t,n,r,i){fy(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=i}return dy(e,null,[{key:"Vi",value:function(t,n){var r,i=dY(),a=dY(),o=uy(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:a=a.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,i,a)}}]),e}(),EK=function(){function e(){fy(this,e),this.Si=!1}return dy(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.Ci(e,t).next(function(a){return a||i.xi(e,t,r,n)}).next(function(n){return n||i.Ni(e,t)})}},{key:"Ci",value:function(e,t){return Xq.resolve(null)}},{key:"xi",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(Bq.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(function(a){var o=i.ki(t,a);return i.Oi(t,o,n,r)?i.Ni(e,t):(yq()<=dz.DEBUG&&mq("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),gj(t)),i.Mi(e,o,t,function(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Bq.fromTimestamp(1e9===r?new Vq(n+1,0):new Vq(n,r));return new Wq(i,Zq.empty(),-1)}(r)))})}},{key:"ki",value:function(e,t){var n=new sW(mj(e));return t.forEach(function(t,r){yj(e,r)&&(n=n.add(r))}),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return yq()<=dz.DEBUG&&mq("QueryEngine","Using full collection scan to execute query:",gj(t)),this.Di.getDocumentsMatchingQuery(e,t,Wq.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(function(e){return t.forEach(function(t){e=e.insert(t.key,t)}),e})}}]),e}(),bK=function(){function e(t,n,r,i){fy(this,e),this.persistence=t,this.Fi=n,this.wt=i,this.$i=new iW(Fq),this.Bi=new nY(function(e){return GW(e)},$W),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return dy(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lK(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return e.collect(n,t.$i)})}}]),e}();function SK(e,t){return PK.apply(this,arguments)}function PK(){return PK=SB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=bq(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next(function(i){return t=i,r.qi(n),r.mutationQueue.getAllMutationBatches(e)}).next(function(n){var i,a=[],o=[],s=dY(),u=uy(t);try{for(u.s();!(i=u.n()).done;){var c=i.value;a.push(c.batchId);var l,f=uy(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(k){f.e(k)}finally{f.f()}}}catch(k){u.e(k)}finally{u.f()}var d,v=uy(n);try{for(v.s();!(d=v.n()).done;){var p=d.value;o.push(p.batchId);var g,y=uy(p.mutations);try{for(y.s();!(g=y.n()).done;){var m=g.value;s=s.add(m.key)}}catch(k){y.e(k)}finally{y.f()}}}catch(k){v.e(k)}finally{v.f()}return r.localDocuments.getDocuments(e,s).next(function(e){return{Ki:e,removedBatchIds:a,addedBatchIds:o}})})});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)})),PK.apply(this,arguments)}function OK(e,t){var n=bq(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(e){var r,i,a,o,s,u,c,l=t.batch.keys(),f=n.Ui.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,o=f,s=a.batch,u=s.keys(),c=Xq.resolve(),u.forEach(function(e){c=c.next(function(){return o.getEntry(i,e)}).next(function(t){var n=a.docVersions.get(e);Eq(null!==n),t.version.compareTo(n)<0&&(s.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),o.addEntry(t)))})}),c.next(function(){return r.mutationQueue.removeMutationBatch(i,s)})).next(function(){return f.apply(e)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,l,t.batch.batchId)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=dY(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))}).next(function(){return n.localDocuments.getDocuments(e,l)})})}function TK(e){var t=bq(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",function(e){return t.Vs.getLastRemoteSnapshotVersion(e)})}function IK(e,t){var n=bq(e),r=t.snapshotVersion,i=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(e){var a=n.Ui.newChangeBuffer({trackRemovals:!0});i=n.$i;var o=[];t.targetChanges.forEach(function(a,s){var u=i.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,a.removedDocuments,s).next(function(){return n.Vs.addMatchingKeys(e,a.addedDocuments,s)}));var c,l,f,h=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?h=h.withResumeToken(lW.EMPTY_BYTE_STRING,Bq.min()).withLastLimboFreeSnapshotVersion(Bq.min()):a.resumeToken.approximateByteSize()>0&&(h=h.withResumeToken(a.resumeToken,r)),i=i.insert(s,h),l=h,f=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||f.addedDocuments.size+f.modifiedDocuments.size+f.removedDocuments.size>0)&&o.push(n.Vs.updateTargetData(e,h))}});var s=iY(),u=dY();if(t.documentUpdates.forEach(function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){var r=dY(),i=dY();return n.forEach(function(e){return r=r.add(e)}),t.getEntries(e,r).next(function(e){var r=iY();return n.forEach(function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Bq.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):mq("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)}),{Gi:r,Qi:i}})}(e,a,t.documentUpdates).next(function(e){s=e.Gi,u=e.Qi})),!r.isEqual(Bq.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next(function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)});o.push(c)}return Xq.waitFor(o).next(function(){return a.apply(e)}).next(function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)}).next(function(){return s})}).then(function(e){return n.$i=i,e})}function AK(e,t){var n=bq(e);return n.persistence.runTransaction("Get next mutation batch","readonly",function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})}function RK(e,t){var n=bq(e);return n.persistence.runTransaction("Allocate target","readwrite",function(e){var r;return n.Vs.getTargetData(e,t).next(function(i){return i?(r=i,Xq.resolve(r)):n.Vs.allocateTargetId(e).next(function(i){return r=new tK(t,i,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next(function(){return r})})})}).then(function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e})}function MK(e,t,n){return xK.apply(this,arguments)}function xK(){return xK=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=bq(t),a=i.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,i.persistence.runTransaction("Release target",o,function(e){return i.persistence.referenceDelegate.removeTarget(e,a)});case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),Jq(e.t1)){e.next=12;break}throw e.t1;case 12:mq("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:i.$i=i.$i.remove(n),i.Bi.delete(a.target);case 14:case"end":return e.stop()}},e,null,[[1,8]])})),xK.apply(this,arguments)}function NK(e,t,n){var r=bq(e),i=Bq.min(),a=dY();return r.persistence.runTransaction("Execute query","readonly",function(e){return(o=r,s=e,u=hj(t),c=bq(o),l=c.Bi.get(u),void 0!==l?Xq.resolve(c.$i.get(l)):c.Vs.getTargetData(s,u)).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next(function(e){a=e})}).next(function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?i:Bq.min(),n?a:dY())}).next(function(e){return function(e,t,n){var r=Bq.min();n.forEach(function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Li.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ji:a}});var o,s,u,c,l})}var DK=function(){function e(){fy(this,e),this.activeTargetIds=pY()}return dy(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),LK=function(){function e(){fy(this,e),this.Fr=new DK,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return dy(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new DK,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),FK=function(){function e(){fy(this,e)}return dy(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),UK=function(){function e(){var t=this;fy(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return dy(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){mq("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=uy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){mq("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=uy(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),VK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},BK=function(){function e(t){fy(this,e),this.jr=t.jr,this.Wr=t.Wr}return dy(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),zK=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return dy(n,[{key:"co",value:function(e,t,n,r){return new Promise(function(i,a){var o=new hq;o.listenOnce(sq.COMPLETE,function(){try{switch(o.getLastErrorCode()){case oq.NO_ERROR:var t=o.getResponseJson();mq("Connection","XHR received:",JSON.stringify(t)),i(t);break;case oq.TIMEOUT:mq("Connection",'RPC "'+e+'" timed out'),a(new Pq(Sq.DEADLINE_EXCEEDED,"Request time out"));break;case oq.HTTP_ERROR:var n=o.getStatus();if(mq("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(Sq).indexOf(c)>=0?c:Sq.UNKNOWN);a(new Pq(s,r.message))}else a(new Pq(Sq.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new Pq(Sq.UNAVAILABLE,"Connection failed."));break;default:_q()}}finally{mq("Connection",'RPC "'+e+'" completed.')}var u,c});var s=JSON.stringify(r);o.send(t,"POST",s,n,15)})}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=iq(),a=aq(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new lq({})),this.uo(o.initMessageHeaders,t,n),zB()||GB()||BB().indexOf("Electron/")>=0||$B()||BB().indexOf("MSAppHost/")>=0||HB()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");mq("Connection","Creating WebChannel: "+s,o);var u=i.createWebChannel(s,o),c=!1,l=!1,f=new BK({jr:function(e){l?mq("Connection","Not sending because WebChannel is closed:",e):(c||(mq("Connection","Opening WebChannel transport."),u.open(),c=!0),mq("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,function(e){try{n(e)}catch(t){setTimeout(function(){throw t},0)}})};return h(u,fq.EventType.OPEN,function(){l||mq("Connection","WebChannel transport opened.")}),h(u,fq.EventType.CLOSE,function(){l||(l=!0,mq("Connection","WebChannel transport closed"),f.eo())}),h(u,fq.EventType.ERROR,function(e){l||(l=!0,Cq("Connection","WebChannel transport errored:",e),f.eo(new Pq(Sq.UNAVAILABLE,"The operation could not be completed")))}),h(u,fq.EventType.MESSAGE,function(e){var t;if(!l){var n=e.data[0];Eq(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){mq("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=Yj[e];if(void 0!==t)return tY(t)}(a),s=i.message;void 0===o&&(o=Sq.INTERNAL,s="Unknown error status: "+a+" with message "+i.message),l=!0,f.eo(new Pq(o,s)),u.close()}else mq("Connection","WebChannel received:",n),f.no(n)}}),h(a,uq.STAT_EVENT,function(e){e.stat===cq.PROXY?mq("Connection","Detected buffering proxy"):e.stat===cq.NOPROXY&&mq("Connection","Detected no buffering proxy")}),setTimeout(function(){f.Zr()},0),f}}]),n}(function(){function e(t){fy(this,e),this.databaseInfo=t,this.databaseId=t.databaseId,this.so=(t.ssl?"https":"http")+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return dy(e,[{key:"ro",value:function(e,t,n,r,i){var a=this.oo(e,t);mq("RestConnection","Sending: ",a,n);var o={};return this.uo(o,r,i),this.co(e,a,o,n).then(function(e){return mq("RestConnection","Received: ",e),e},function(t){throw Cq("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t})}},{key:"ao",value:function(e,t,n,r,i,a){return this.ro(e,t,n,r,i)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+pq,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(function(t,n){return e[n]=t}),n&&n.headers.forEach(function(t,n){return e[n]=t})}},{key:"oo",value:function(e,t){return"".concat(this.so,"/v1/").concat(t,":").concat(VK[e])}}]),e}());function HK(){return"undefined"!=typeof document?document:null}function GK(e){return new OY(e,!0)}var $K=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;fy(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=i,this._o=a,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return dy(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),i=Math.max(0,n-r);i>0&&mq("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,i,function(){return t.yo=Date.now(),e()}),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),ZK=function(){function e(t,n,r,i,a,o,s,u){fy(this,e),this.js=t,this.Ao=r,this.Ro=i,this.bo=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new $K(t,n)}return dy(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.Do(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}},t)}))()}},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,function(){return e.Oo()}))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Co()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}},t)}))()}},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===Sq.RESOURCE_EXHAUSTED?(kq(t.toString()),kq("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===Sq.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,r.next=9,n.listener.Jr(t);case 9:case"end":return r.stop()}},r)}))()}},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(function(t){var r=qg(t,2),i=r[0],a=r[1];e.Po===n&&e.Uo(i,a)},function(n){t(function(){var t=new Pq(Sq.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)})})}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(function(){r(function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,function(){return n.Co()&&(n.state=3),Promise.resolve()}),n.listener.zr()})}),this.stream.Jr(function(e){r(function(){return n.qo(e)})}),this.stream.onMessage(function(e){r(function(){return n.onMessage(e)})})}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}},t)})))}},{key:"qo",value:function(e){return mq("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget(function(){return t.Po===e?n():(mq("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}}}]),e}(),qK=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u}return dy(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n,r;if("targetChange"in t){var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:_q(),a=t.targetChange.targetIds||[],o=function(e,t){return e.dt?(Eq(void 0===t||"string"==typeof t),lW.fromBase64String(t||"")):(Eq(void 0===t||t instanceof Uint8Array),lW.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,u=s&&function(e){var t=void 0===e.code?Sq.UNKNOWN:tY(e.code);return new Pq(t,e.message||"")}(s);n=new CY(i,a,o,u||null)}else if("documentChange"in t){var c=t.documentChange,l=DY(e,c.document.name),f=RY(c.document.updateTime),h=new UW({mapValue:{fields:c.document.fields}}),d=BW.newFoundDocument(l,f,h);n=new mY(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in t){var v=t.documentDelete,p=DY(e,v.document),g=v.readTime?RY(v.readTime):Bq.min(),y=BW.newNoDocument(p,g);n=new mY([],v.removedTargetIds||[],y.key,y)}else if("documentRemove"in t){var m=t.documentRemove,k=DY(e,m.document);n=new mY([],m.removedTargetIds||[],k,null)}else{if(!("filter"in t))return _q();var C=t.filter,w=new Jj(C.count||0);n=new kY(C.targetId,w)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return Bq.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?Bq.min():t.readTime?RY(t.readTime):Bq.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t,n,r,i,a={};a.database=FY(this.wt),a.addTarget=(t=this.wt,i=(n=e).target,(r=ZW(i)?{documents:BY(t,i)}:{query:zY(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=IY(t,n.resumeToken):n.snapshotVersion.compareTo(Bq.min())>0&&(r.readTime=TY(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _q()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);o&&(a.labels=o),this.Mo(a)}},{key:"jo",value:function(e){var t={};t.database=FY(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(ZK),WK=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,i,a,s)).wt=o,u.Wo=!1,u}return dy(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,Qg(ay(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(Eq(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(Eq(void 0!==t),e.map(function(e){return function(e,t){var n=RY(e.updateTime?e.updateTime:t);return n.isEqual(Bq.min())&&(n=RY(t)),new Dj(n,e.transformResults||[])}(e,t)})):[]}(e.writeResults,e.commitTime),n=RY(e.commitTime);return this.listener.Jo(n,t)}return Eq(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=FY(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map(function(e){return function(e,t){var n,r;if(t instanceof $j)n={update:VY(e,t.key,t.value)};else if(t instanceof Qj)n={delete:NY(e,t.key)};else if(t instanceof Zj)n={update:VY(e,t.key,t.data),updateMask:KY(t.fieldMask)};else{if(!(t instanceof Xj))return _q();n={verify:NY(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(function(e){return function(e,t){var n=t.transform;if(n instanceof Pj)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Oj)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ij)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Rj)return{fieldPath:t.field.canonicalString(),increment:n._t};throw _q()}(0,e)})),t.precondition.isNone||(n.currentDocument=void 0!==(r=t.precondition).updateTime?{updateTime:AY(e,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:_q()),n}(t.wt,e)})};this.Mo(n)}}]),n}(ZK),jK=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=i,o.wt=a,o.Zo=!1,o}return dy(n,[{key:"tu",value:function(){if(this.Zo)throw new Pq(Sq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(i){var a=qg(i,2),o=a[0],s=a[1];return r.bo.ro(e,t,n,o,s)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Sq.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Pq(Sq.UNKNOWN,e.toString())})}},{key:"ao",value:function(e,t,n,r){var i=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(function(a){var o=qg(a,2),s=o[0],u=o[1];return i.bo.ao(e,t,n,s,u,r)}).catch(function(e){throw"FirebaseError"===e.name?(e.code===Sq.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new Pq(Sq.UNKNOWN,e.toString())})}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return dy(function e(){fy(this,e)})}()),YK=function(){function e(t,n){fy(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return dy(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()}))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(kq(t),this.su=!1):mq("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),KK=dy(function e(t,n,r,i,a){fy(this,e);var o=this;this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=a,this.du.Br(function(e){r.enqueueAndForget(SB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=sQ(o),!e.t0){e.next=5;break}return mq("RemoteStore","Restarting streams for network reachability change."),e.next=5,(t=SB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=bq(t)).lu.add(4),e.next=4,JK(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,QK(n);case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})(o);case 5:case"end":return e.stop()}},e)})))}),this._u=new YK(r,i)});function QK(e){return XK.apply(this,arguments)}function XK(){return XK=SB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!sQ(t)){e.next=18;break}n=uy(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,i(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}},e,null,[[2,12,15,18]])})),XK.apply(this,arguments)}function JK(e){return eQ.apply(this,arguments)}function eQ(){return eQ=SB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=uy(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,i(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}},e,null,[[1,11,14,17]])})),eQ.apply(this,arguments)}function tQ(e,t){var n=bq(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),oQ(n)?aQ(n):DQ(n).Co()&&rQ(n,t))}function nQ(e,t){var n=bq(e),r=DQ(n);n.hu.delete(t),r.Co()&&iQ(n,t),0===n.hu.size&&(r.Co()?r.ko():sQ(n)&&n._u.set("Unknown"))}function rQ(e,t){e.wu.Nt(t.targetId),DQ(e).Qo(t)}function iQ(e,t){e.wu.Nt(t),DQ(e).jo(t)}function aQ(e){e.wu=new _Y({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),DQ(e).start(),e._u.iu()}function oQ(e){return sQ(e)&&!DQ(e).Do()&&e.hu.size>0}function sQ(e){return 0===bq(e).lu.size}function uQ(e){e.wu=void 0}function cQ(e){return lQ.apply(this,arguments)}function lQ(){return lQ=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach(function(e,n){rQ(t,e)});case 1:case"end":return e.stop()}},e)})),lQ.apply(this,arguments)}function fQ(e,t){return hQ.apply(this,arguments)}function hQ(){return hQ=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:uQ(t),oQ(t)?(t._u.uu(n),aQ(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}},e)})),hQ.apply(this,arguments)}function dQ(e,t,n){return vQ.apply(this,arguments)}function vQ(){return vQ=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof CY&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,(a=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,i=uy(n.targetIds),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=14;break}if(o=a.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),i.e(e.t1);case 19:return e.prev=19,i.f(),e.finish(19);case 22:case"end":return e.stop()}},e,null,[[2,16,19,22]])})),function(e,t){return a.apply(this,arguments)})(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),mq("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,pQ(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof mY?t.wu.Ut(n):n instanceof kY?t.wu.zt(n):t.wu.Gt(n),r.isEqual(Bq.min())){e.next=29;break}return e.prev=14,e.next=17,TK(t.localStore);case 17:if(i=e.sent,e.t1=r.compareTo(i)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach(function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.hu.get(r);i&&e.hu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(lW.EMPTY_BYTE_STRING,n.snapshotVersion)),iQ(e,t);var r=new tK(n.target,t,1,n.sequenceNumber);rQ(e,r)}}),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),mq("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,pQ(t,e.t2);case 29:case"end":return e.stop()}},e,null,[[1,6],[14,24]])})),vQ.apply(this,arguments)}function pQ(e,t,n){return gQ.apply(this,arguments)}function gQ(){return gQ=SB(regeneratorRuntime.mark(function e(t,n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Jq(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,JK(t);case 5:t._u.set("Offline"),r||(r=function(){return TK(t.localStore)}),t.asyncQueue.enqueueRetryable(SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return mq("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,QK(t);case 6:case"end":return e.stop()}},e)})));case 8:case"end":return e.stop()}},e)})),gQ.apply(this,arguments)}function yQ(e,t){return t().catch(function(n){return pQ(e,n,t)})}function mQ(e){return kQ.apply(this,arguments)}function kQ(){return kQ=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=bq(t),r=LQ(n),i=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!CQ(n)){e.next=19;break}return e.prev=3,e.next=6,AK(n.localStore,i);case 6:if(null!==(a=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:i=a.batchId,wQ(n,a),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,pQ(n,e.t0);case 17:e.next=2;break;case 19:_Q(n)&&EQ(n);case 20:case"end":return e.stop()}},e,null,[[3,13]])})),kQ.apply(this,arguments)}function CQ(e){return sQ(e)&&e.au.length<10}function wQ(e,t){e.au.push(t);var n=LQ(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function _Q(e){return sQ(e)&&!LQ(e).Do()&&e.au.length>0}function EQ(e){LQ(e).start()}function bQ(e){return SQ.apply(this,arguments)}function SQ(){return SQ=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:LQ(t).Xo();case 1:case"end":return e.stop()}},e)})),SQ.apply(this,arguments)}function PQ(e){return OQ.apply(this,arguments)}function OQ(){return OQ=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=LQ(t),r=uy(t.au);try{for(r.s();!(i=r.n()).done;)a=i.value,n.Ho(a.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}},e)})),OQ.apply(this,arguments)}function TQ(e,t,n){return IQ.apply(this,arguments)}function IQ(){return IQ=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.au.shift(),a=JY.from(i,n,r),e.next=3,yQ(t,function(){return t.remoteSyncer.applySuccessfulWrite(a)});case 3:return e.next=5,mQ(t);case 5:case"end":return e.stop()}},e)})),IQ.apply(this,arguments)}function AQ(e,t){return RQ.apply(this,arguments)}function RQ(){return RQ=SB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&LQ(t).zo,!e.t0){e.next=4;break}return e.next=4,(r=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!eY(i=n.code)||i===Sq.ABORTED){e.next=7;break}return r=t.au.shift(),LQ(t).No(),e.next=5,yQ(t,function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)});case 5:return e.next=7,mQ(t);case 7:case"end":return e.stop()}},e)})),function(e,t){return r.apply(this,arguments)})(t,n);case 4:_Q(t)&&EQ(t);case 5:case"end":return e.stop()}},e)})),RQ.apply(this,arguments)}function MQ(e,t){return xQ.apply(this,arguments)}function xQ(){return xQ=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=bq(t)).asyncQueue.verifyOperationInProgress(),mq("RemoteStore","RemoteStore received new credentials"),i=sQ(r),r.lu.add(3),e.next=6,JK(r);case 6:return i&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,QK(r);case 12:case"end":return e.stop()}},e)})),xQ.apply(this,arguments)}function NQ(){return NQ=SB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=bq(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,QK(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,JK(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}},e)})),NQ.apply(this,arguments)}function DQ(e){return e.mu||(e.mu=(t=e.datastore,n=e.asyncQueue,r={zr:cQ.bind(null,e),Jr:fQ.bind(null,e),Go:dQ.bind(null,e)},(i=bq(t)).tu(),new qK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=SB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),oQ(e)?aQ(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:uQ(e);case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.mu;var t,n,r,i}function LQ(e){return e.gu||(e.gu=(t=e.datastore,n=e.asyncQueue,r={zr:bQ.bind(null,e),Jr:AQ.bind(null,e),Yo:PQ.bind(null,e),Jo:TQ.bind(null,e)},(i=bq(t)).tu(),new WK(n,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,r)),e.fu.push(function(){var t=SB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,mQ(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(mq("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}())),e.gu;var t,n,r,i}var FQ=function(){function e(t,n,r,i,a){fy(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Oq,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return dy(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Pq(Sq.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then(function(t){return e.deferred.resolve(t)})):Promise.resolve()})}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)})}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var o=new e(t,n,Date.now()+r,i,a);return o.start(r),o}}]),e}();function UQ(e,t){if(kq("AsyncQueue","".concat(t,": ").concat(e)),Jq(e))return new Pq(Sq.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var VQ=function(){function e(t){fy(this,e),this.comparator=t?function(e,n){return t(e,n)||Zq.comparator(e.key,n.key)}:function(e,t){return Zq.comparator(e.key,t.key)},this.keyedMap=oY(),this.sortedSet=new iW(this.comparator)}return dy(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal(function(t,n){return e(t),!1})}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e)||this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),BQ=function(){function e(){fy(this,e),this.yu=new iW(Zq.comparator)}return dy(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):_q():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal(function(t,n){e.push(n)}),e}}]),e}(),zQ=function(){function e(t,n,r,i,a,o,s,u){fy(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return dy(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vj(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach(function(e){a.push({type:0,doc:e})}),new e(t,n,VQ.emptySet(n),a,r,i,!0,!1)}}]),e}(),HQ=dy(function e(){fy(this,e),this.Iu=void 0,this.listeners=[]}),GQ=dy(function e(){fy(this,e),this.queries=new nY(function(e){return pj(e)},vj),this.onlineState="Unknown",this.Tu=new Set});function $Q(e,t){return ZQ.apply(this,arguments)}function ZQ(){return ZQ=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=bq(t),i=n.query,a=!1,(o=r.queries.get(i))||(a=!0,o=new HQ),!a){e.next=13;break}return e.prev=3,e.next=6,r.onListen(i);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=UQ(e.t0,"Initialization of query '".concat(gj(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(i,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&KQ(r);case 14:case"end":return e.stop()}},e,null,[[3,9]])})),ZQ.apply(this,arguments)}function qQ(e,t){return WQ.apply(this,arguments)}function WQ(){return WQ=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=bq(t),i=n.query,a=!1,(o=r.queries.get(i))&&(s=o.listeners.indexOf(n))>=0&&(o.listeners.splice(s,1),a=0===o.listeners.length),!a){e.next=6;break}return e.abrupt("return",(r.queries.delete(i),r.onUnlisten(i)));case 6:case"end":return e.stop()}},e)})),WQ.apply(this,arguments)}function jQ(e,t){var n,r=bq(e),i=!1,a=uy(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=r.queries.get(o.query);if(s){var u,c=uy(s.listeners);try{for(c.s();!(u=c.n()).done;){u.value.Au(o)&&(i=!0)}}catch(l){c.e(l)}finally{c.f()}s.Iu=o}}}catch(l){a.e(l)}finally{a.f()}i&&KQ(r)}function YQ(e,t,n){var r=bq(e),i=r.queries.get(t);if(i){var a,o=uy(i.listeners);try{for(o.s();!(a=o.n()).done;){a.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function KQ(e){e.Tu.forEach(function(e){e.next()})}var QQ=function(){function e(t,n,r){fy(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return dy(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=uy(e.docChanges);try{for(r.s();!(t=r.n()).done;){var i=t.value;3!==i.type&&n.push(i)}}catch(o){r.e(o)}finally{r.f()}e=new zQ(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var a=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),a=!0):this.Vu(e,this.onlineState)&&(this.Su(e),a=!0),this.Pu=e,a}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}},{key:"vu",value:function(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=zQ.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}(),XQ=dy(function e(t){fy(this,e),this.key=t}),JQ=dy(function e(t){fy(this,e),this.key=t}),eX=function(){function e(t,n){fy(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=dY(),this.mutatedKeys=dY(),this.Lu=mj(t),this.Uu=new VQ(this.Lu)}return dy(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new BQ,i=t?t.Uu:this.Uu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,s=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(function(e,t){var l=i.get(e),f=yj(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),d=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),v=!1;l&&f?l.data.isEqual(f.data)?h!==d&&(r.track({type:3,doc:f}),v=!0):n.Qu(l,f)||(r.track({type:2,doc:f}),v=!0,(u&&n.Lu(f,u)>0||c&&n.Lu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),v=!0):l&&!f&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(s=!0)),v&&(f?(o=o.add(f),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:a}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var a=e.Gu.pu();a.sort(function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _q()}})(n)-a(i)||r.Lu(e.doc,t.doc);var n,i,a}),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==a.length||u?{snapshot:new zQ(this.query,e.Uu,i,a,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new BQ,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach(function(e){return t.Fu=t.Fu.add(e)}),e.modifiedDocuments.forEach(function(e){}),e.removedDocuments.forEach(function(e){return t.Fu=t.Fu.delete(e)}),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=dY(),this.Uu.forEach(function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))});var n=[];return t.forEach(function(t){e.Bu.has(t)||n.push(new JQ(t))}),this.Bu.forEach(function(e){t.has(e)||n.push(new XQ(e))}),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=dY();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return zQ.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),tX=dy(function e(t,n,r){fy(this,e),this.query=t,this.targetId=n,this.view=r}),nX=dy(function e(t){fy(this,e),this.key=t,this.Xu=!1}),rX=function(){function e(t,n,r,i,a,o){fy(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new nY(function(e){return pj(e)},vj),this.ec=new Map,this.nc=new Set,this.sc=new iW(Zq.comparator),this.ic=new Map,this.rc=new dK,this.oc={},this.uc=new Map,this.cc=uK.Rn(),this.onlineState="Unknown",this.ac=void 0}return dy(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function iX(e,t){return aX.apply(this,arguments)}function aX(){return aX=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=MX(t),!(o=r.tc.get(n))){e.next=6;break}i=o.targetId,r.sharedClientState.addLocalQueryTarget(i),a=o.view.Yu(),e.next=15;break;case 6:return e.next=8,RK(r.localStore,hj(n));case 8:return s=e.sent,r.isPrimaryClient&&tQ(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.targetId,e.next=14,oX(r,n,i,"current"===u);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}},e)})),aX.apply(this,arguments)}function oX(e,t,n,r){return sX.apply(this,arguments)}function sX(){return sX=SB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return(i=SB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.view.Ku(r),e.t0=a.Oi,!e.t0){e.next=6;break}return e.next=5,NK(t.localStore,n.query,!1).then(function(e){var t=e.documents;return n.view.Ku(t,a)});case 5:a=e.sent;case 6:return o=i&&i.targetChanges.get(n.targetId),s=n.view.applyChanges(a,t.isPrimaryClient,o),e.abrupt("return",(bX(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}},e)})),function(e,t,n,r){return i.apply(this,arguments)})(t,e,n,r);var i},e.next=3,NK(t.localStore,n,!0);case 3:return a=e.sent,o=new eX(n,a.ji),s=o.Ku(a.documents),u=yY.createSynthesizedTargetChangeForCurrentChange(r,i&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),bX(t,r,c.zu),l=new tX(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}},e)})),sX.apply(this,arguments)}function uX(e,t){return cX.apply(this,arguments)}function cX(){return cX=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=bq(t),i=r.tc.get(n),!((a=r.ec.get(i.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(i.targetId,a.filter(function(e){return!vj(e,n)})),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(i.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(i.targetId),e.t0){e.next=9;break}return e.next=9,MK(r.localStore,i.targetId,!1).then(function(){r.sharedClientState.clearQueryState(i.targetId),nQ(r.remoteStore,i.targetId),_X(r,i.targetId)}).catch(Kq);case 9:e.next=14;break;case 11:return _X(r,i.targetId),e.next=14,MK(r.localStore,i.targetId,!0);case 14:case"end":return e.stop()}},e)})),cX.apply(this,arguments)}function lX(){return lX=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=xX(t),e.prev=1,e.next=4,function(e,t){var n,r,i=bq(e),a=Vq.now(),o=t.reduce(function(e,t){return e.add(t.key)},dY());return i.persistence.runTransaction("Locally write mutations","readwrite",function(e){var s=iY(),u=dY();return i.Ui.getEntries(e,o).next(function(e){(s=e).forEach(function(e,t){t.isValidDocument()||(u=u.add(e))})}).next(function(){return i.localDocuments.getOverlayedDocuments(e,s)}).next(function(r){n=r;var o,s=[],u=uy(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=Hj(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new Zj(c.key,l,VW(l.value.mapValue),Lj.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return i.mutationQueue.addMutationBatch(e,a,s,t)}).next(function(t){r=t;var a=t.applyToLocalDocumentSet(n,u);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(function(){return{batchId:r.batchId,changes:sY(n)}})}(i.localStore,n);case 4:return a=e.sent,i.sharedClientState.addPendingMutation(a.batchId),function(e,t,n){var r=e.oc[e.currentUser.toKey()];r||(r=new iW(Fq)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(i,a.batchId,r),e.next=9,OX(i,a.changes);case 9:return e.next=11,mQ(i.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=UQ(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}},e,null,[[1,13]])})),lX.apply(this,arguments)}function fX(e,t){return hX.apply(this,arguments)}function hX(){return hX=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=bq(t),e.prev=1,e.next=4,IK(r.localStore,n);case 4:return i=e.sent,n.targetChanges.forEach(function(e,t){var n=r.ic.get(t);n&&(Eq(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?Eq(n.Xu):e.removedDocuments.size>0&&(Eq(n.Xu),n.Xu=!1))}),e.next=8,OX(r,i,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Kq(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])})),hX.apply(this,arguments)}function dX(e,t,n){var r=bq(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.tc.forEach(function(e,n){var r=n.view.Eu(t);r.snapshot&&i.push(r.snapshot)}),function(e,t){var n=bq(e);n.onlineState=t;var r=!1;n.queries.forEach(function(e,n){var i,a=uy(n.listeners);try{for(a.s();!(i=a.n()).done;){i.value.Eu(t)&&(r=!0)}}catch(o){a.e(o)}finally{a.f()}}),r&&KQ(n)}(r.eventManager,t),i.length&&r.Zu.Go(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function vX(e,t,n){return pX.apply(this,arguments)}function pX(){return pX=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((i=bq(t)).sharedClientState.updateQueryState(n,"rejected",r),a=i.ic.get(n),!(o=a&&a.key)){e.next=14;break}return s=(s=new iW(Zq.comparator)).insert(o,BW.newNoDocument(o,Bq.min())),u=dY().add(o),c=new gY(Bq.min(),new Map,new sW(Fq),s,u),e.next=9,fX(i,c);case 9:i.sc=i.sc.remove(o),i.ic.delete(n),PX(i),e.next=16;break;case 14:return e.next=16,MK(i.localStore,n,!1).then(function(){return _X(i,n,r)}).catch(Kq);case 16:case"end":return e.stop()}},e)})),pX.apply(this,arguments)}function gX(e,t){return yX.apply(this,arguments)}function yX(){return yX=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=bq(t),i=n.batch.batchId,e.prev=1,e.next=4,OK(r.localStore,n);case 4:return a=e.sent,wX(r,i,null),CX(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),e.next=10,OX(r,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Kq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),yX.apply(this,arguments)}function mX(e,t,n){return kX.apply(this,arguments)}function kX(){return kX=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=bq(t),e.prev=1,e.next=4,function(e,t){var n=bq(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next(function(t){return Eq(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)}).next(function(){return n.mutationQueue.performConsistencyCheck(e)}).next(function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)}).next(function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)}).next(function(){return n.localDocuments.getDocuments(e,r)})})}(i.localStore,n);case 4:return a=e.sent,wX(i,n,r),CX(i,n),i.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,OX(i,a);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Kq(e.t0);case 16:case"end":return e.stop()}},e,null,[[1,12]])})),kX.apply(this,arguments)}function CX(e,t){(e.uc.get(t)||[]).forEach(function(e){e.resolve()}),e.uc.delete(t)}function wX(e,t,n){var r=bq(e),i=r.oc[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.oc[r.currentUser.toKey()]=i}}function _X(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,i=uy(e.ec.get(t));try{for(i.s();!(r=i.n()).done;){var a=r.value;e.tc.delete(a),n&&e.Zu.lc(a,n)}}catch(o){i.e(o)}finally{i.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach(function(t){e.rc.containsKey(t)||EX(e,t)})}function EX(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(nQ(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),PX(e))}function bX(e,t,n){var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof XQ?(e.rc.addReference(a.key,t),SX(e,a)):a instanceof JQ?(mq("SyncEngine","Document no longer in limbo: "+a.key),e.rc.removeReference(a.key,t),e.rc.containsKey(a.key)||EX(e,a.key)):_q()}}catch(o){i.e(o)}finally{i.f()}}function SX(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(mq("SyncEngine","New document in limbo: "+n),e.nc.add(r),PX(e))}function PX(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new Zq(Hq.fromString(t)),r=e.cc.next();e.ic.set(r,new nX(n)),e.sc=e.sc.insert(n,r),tQ(e.remoteStore,new tK(hj(sj(n.path)),r,2,eW.ot))}}function OX(e,t,n){return TX.apply(this,arguments)}function TX(){return TX=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=bq(t),a=[],o=[],s=[],e.t0=i.tc.isEmpty(),e.t0){e.next=9;break}return i.tc.forEach(function(e,t){s.push(i.hc(t,n,r).then(function(e){if(e){i.isPrimaryClient&&i.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),a.push(e);var n=_K.Vi(t.targetId,e);o.push(n)}}))}),e.next=6,Promise.all(s);case 6:return i.Zu.Go(a),e.next=9,(u=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=bq(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return Xq.forEach(n,function(t){return Xq.forEach(t.Pi,function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)}).next(function(){return Xq.forEach(t.vi,function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)})})})});case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),Jq(e.t0)){e.next=10;break}throw e.t0;case 10:mq("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:i=uy(n);try{for(i.s();!(a=i.n()).done;)o=a.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.withLastLimboFreeSnapshotVersion(u.snapshotVersion),r.$i=r.$i.insert(s,c))}catch(l){i.e(l)}finally{i.f()}case 13:case"end":return e.stop()}},e,null,[[1,6]])})),function(e,t){return u.apply(this,arguments)})(i.localStore,o);case 9:case"end":return e.stop()}},e)})),TX.apply(this,arguments)}function IX(e,t){return AX.apply(this,arguments)}function AX(){return AX=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=bq(t)).currentUser.isEqual(n)){e.next=12;break}return mq("SyncEngine","User change. New user:",n.toKey()),e.next=5,SK(r.localStore,n);case 5:return i=e.sent,r.currentUser=n,(a=r).uc.forEach(function(e){e.forEach(function(e){e.reject(new Pq(Sq.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.uc.clear(),r.sharedClientState.handleUserChange(n,i.removedBatchIds,i.addedBatchIds),e.next=12,OX(r,i.Ki);case 12:case"end":return e.stop()}},e)})),AX.apply(this,arguments)}function RX(e,t){var n=bq(e),r=n.ic.get(t);if(r&&r.Xu)return dY().add(r.key);var i=dY(),a=n.ec.get(t);if(!a)return i;var o,s=uy(a);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);i=i.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return i}function MX(e){var t=bq(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=fX.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=RX.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=vX.bind(null,t),t.Zu.Go=jQ.bind(null,t.eventManager),t.Zu.lc=YQ.bind(null,t.eventManager),t}function xX(e){var t=bq(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gX.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=mX.bind(null,t),t}var NX=function(){function e(){fy(this,e),this.synchronizeTabs=!1}return dy(e,[{key:"initialize",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.wt=GK(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),n.next=5,t.persistence.start();case 5:t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore);case 8:case"end":return n.stop()}},n)}))()}},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return function(e,t,n,r){return new bK(e,t,n,r)}(this.persistence,new EK,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new kK(wK.Ms,this.wt)}},{key:"dc",value:function(e){return new LK}},{key:"terminate",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}},t)}))()}}]),e}(),DX=function(){function e(){fy(this,e)}return dy(e,[{key:"initialize",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=n.localStore,r.t0){r.next=12;break}return n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=function(e){return dX(n.syncEngine,e,1)},n.remoteStore.remoteSyncer.handleCredentialChange=IX.bind(null,n.syncEngine),r.next=12,function(e,t){return NQ.apply(this,arguments)}(n.remoteStore,n.syncEngine.isPrimaryClient);case 12:case"end":return r.stop()}},r)}))()}},{key:"createEventManager",value:function(e){return new GQ}},{key:"createDatastore",value:function(e){var t=GK(e.databaseInfo.databaseId),n=new zK(e.databaseInfo);return new jK(e.authCredentials,e.appCheckCredentials,n,t)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return dX(o.syncEngine,e,0)},a=UK.V()?new UK:new FK,new KK(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,o=e.initialUser,s=e.maxConcurrentLimboResolutions,u=t,c=new rX(n,r,i,a,o,s),u&&(c.ac=!0),c;var n,r,i,a,o,s,u,c}},{key:"terminate",value:function(){return(e=SB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=bq(t),mq("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,JK(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}(),LX=function(){function e(t){fy(this,e),this.observer=t,this.muted=!1}return dy(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)}}]),e}(),FX=function(){function e(t,n,r,i){var a=this;fy(this,e);var o,s=this;this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=vq.UNAUTHENTICATED,this.clientId=Lq.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,(o=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return mq("FirestoreClient","Received user=",t.uid),e.next=3,s.authCredentialListener(t);case 3:s.user=t;case 4:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)})),this.appCheckCredentials.start(r,function(e){return mq("FirestoreClient","Received new app check token=",e),a.appCheckCredentialListener(e,a.user)})}return dy(e,[{key:"getConfiguration",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}},t)}))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Pq(Sq.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Oq;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=UQ(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}},n,null,[[0,14]])}))),t.promise}}]),e}();function UX(e,t){return VX.apply(this,arguments)}function VX(){return VX=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),mq("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:i=r.initialUser,t.setCredentialChangeListener(function(){var e=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=i.isEqual(t),e.t0){e.next=5;break}return e.next=4,SK(n.localStore,t);case 4:i=t;case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=n;case 8:case"end":return e.stop()}},e)})),VX.apply(this,arguments)}function BX(e,t){return zX.apply(this,arguments)}function zX(){return zX=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,HX(t);case 3:return r=e.sent,mq("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return i=e.sent,e.next=10,n.initialize(r,i);case 10:t.setCredentialChangeListener(function(e){return MQ(n.remoteStore,e)}),t.setAppCheckTokenChangeListener(function(e,t){return MQ(n.remoteStore,t)}),t.onlineComponents=n;case 13:case"end":return e.stop()}},e)})),zX.apply(this,arguments)}function HX(e){return GX.apply(this,arguments)}function GX(){return GX=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return mq("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,UX(t,new NX);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}},e)})),GX.apply(this,arguments)}function $X(e){return ZX.apply(this,arguments)}function ZX(){return ZX=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return mq("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,BX(t,new DX);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}},e)})),ZX.apply(this,arguments)}function qX(e){return WX.apply(this,arguments)}function WX(){return WX=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$X(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=iX.bind(null,n.syncEngine),r.onUnlisten=uX.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}},e)})),WX.apply(this,arguments)}var jX=new Map;function YX(e,t,n){if(!n)throw new Pq(Sq.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function KX(e){if(!Zq.isDocumentKey(e))throw new Pq(Sq.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function QX(e){if(Zq.isDocumentKey(e))throw new Pq(Sq.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function XX(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":_q()}function JX(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Pq(Sq.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=XX(e);throw new Pq(Sq.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}var eJ=function(){function e(t){var n;if(fy(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Pq(Sq.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Pq(Sq.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Pq(Sq.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling)}return dy(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),tJ=function(){function e(t,n,r){fy(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eJ({}),this._settingsFrozen=!1,t instanceof kW?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Pq(Sq.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kW(e.options.projectId)}(t))}return dy(e,[{key:"app",get:function(){if(!this._app)throw new Pq(Sq.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Pq(Sq.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eJ(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Iq;switch(e.type){case"gapi":var t=e.client;return Eq(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Mq(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Pq(Sq.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=jX.get(e))&&(mq("ComponentProvider","Removing Datastore"),jX.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}(),nJ=function(){function e(t,n,r){fy(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return dy(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new iJ(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),rJ=function(){function e(t,n,r){fy(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return dy(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),iJ=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r,sj(i)))._path=i,a.type="collection",a}return dy(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new nJ(this.firestore,null,new Zq(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(rJ);function aJ(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=az(e),1===arguments.length&&(t=Lq.I()),YX("doc","path",t),e instanceof tJ){var a=Hq.fromString.apply(Hq,[t].concat(r));return KX(a),new nJ(e,null,new Zq(a))}if(!(e instanceof nJ||e instanceof iJ))throw new Pq(Sq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Hq.fromString.apply(Hq,[t].concat(r)));return KX(o),new nJ(e.firestore,e instanceof iJ?e.converter:null,new Zq(o))}var oJ=function(){function e(){var t=this;fy(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new $K(this,"async_queue_retry"),this.Kc=function(){var e=HK();e&&mq("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=HK();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return dy(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=HK();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise(function(){});var n=new Oq;return this.Qc(function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)}).then(function(){return n.promise})}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget(function(){return t.Mc.push(e),t.jc()})}},{key:"jc",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.Mc.length){t.next=14;break}return t.prev=1,t.next=4,e.Mc[0]();case 4:e.Mc.shift(),e.So.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),Jq(t.t0)){t.next=12;break}throw t.t0;case 12:mq("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.Mc.length>0&&e.So.Io(function(){return e.jc()});case 14:case"end":return t.stop()}},t,null,[[1,8]])}))()}},{key:"Qc",value:function(e){var t=this,n=this.Oc.then(function(){return t.Lc=!0,e().catch(function(e){throw t.Bc=e,t.Lc=!1,kq("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e;var n,r}).then(function(e){return t.Lc=!1,e})});return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var i=FQ.createAndSchedule(this,e,t,n,function(e){return r.Wc(e)});return this.$c.push(i),i}},{key:"Gc",value:function(){this.Bc&&_q()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.Oc,t.next=3,n;case 3:if(n!==e.Oc){t.next=0;break}case 4:case"end":return t.stop()}},t)}))()}},{key:"Hc",value:function(e){var t,n=uy(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then(function(){t.$c.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});var n,r=uy(t.$c);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.skipDelay(),"all"!==e&&i.timerId===e)break}}catch(a){r.e(a)}finally{r.f()}return t.zc()})}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function sJ(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var a=i[r];if(a in n&&"function"==typeof n[a])return!0}return!1}(e)}var uJ=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r,i)).type="firestore",a._queue=new oJ,a._persistenceKey="name"in e?e.name:"[DEFAULT]",a}return dy(n,[{key:"_terminate",value:function(){return this._firestoreClient||lJ(this),this._firestoreClient.terminate()}}]),n}(tJ);function cJ(e){return e._firestoreClient||lJ(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function lJ(e){var t,n,r,i=e._freezeSettings(),a=(n=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",new mW(e._databaseId,n,e._persistenceKey,(r=i).host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams));e._firestoreClient=new FX(e._authCredentials,e._appCheckCredentials,e._queue,a)}var fJ=function(){function e(){fy(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0;i<n.length;++i)if(0===n[i].length)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $q(n)}return dy(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}(),hJ=function(){function e(t){fy(this,e),this._byteString=t}return dy(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(lW.fromBase64String(t))}catch(n){throw new Pq(Sq.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}},{key:"fromUint8Array",value:function(t){return new e(lW.fromUint8Array(t))}}]),e}(),dJ=dy(function e(t){fy(this,e),this._methodName=t}),vJ=function(){function e(t,n){if(fy(this,e),!isFinite(t)||t<-90||t>90)throw new Pq(Sq.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Pq(Sq.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return dy(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Fq(this._lat,e._lat)||Fq(this._long,e._long)}}]),e}(),pJ=/^__.*__$/,gJ=function(){function e(t,n,r){fy(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return dy(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new Zj(e,this.data,this.fieldMask,t,this.fieldTransforms):new $j(e,this.data,t,this.fieldTransforms)}}]),e}(),yJ=function(){function e(t,n,r){fy(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return dy(e,[{key:"toMutation",value:function(e,t){return new Zj(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),e}();function mJ(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _q()}}var kJ=function(){function e(t,n,r,i,a,o){fy(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=i,void 0===a&&this.Xc(),this.fieldTransforms=a||[],this.fieldMask=o||[]}return dy(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return MJ(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find(function(t){return e.isPrefixOf(t)})||void 0!==this.fieldTransforms.find(function(t){return e.isPrefixOf(t.field)})}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(mJ(this.Zc)&&pJ.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),CJ=function(){function e(t,n,r){fy(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||GK(t)}return dy(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new kJ({Zc:e,methodName:t,ca:n,path:$q.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function wJ(e){var t=e._freezeSettings(),n=GK(e._databaseId);return new CJ(e._databaseId,!!t.ignoreUndefinedProperties,n)}function _J(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(a.merge||a.mergeFields?2:0,t,n,i);TJ("Data must be an object, but it was:",o,r);var s,u,c=PJ(r,o);if(a.merge)s=new cW(o.fieldMask),u=o.fieldTransforms;else if(a.mergeFields){var l,f=[],h=uy(a.mergeFields);try{for(h.s();!(l=h.n()).done;){var d=l.value,v=IJ(t,d,n);if(!o.contains(v))throw new Pq(Sq.INVALID_ARGUMENT,"Field '".concat(v,"' is specified in your field mask but missing from your input data."));xJ(f,v)||f.push(v)}}catch(p){h.e(p)}finally{h.f()}s=new cW(f),u=o.fieldTransforms.filter(function(e){return s.covers(e.field)})}else s=null,u=o.fieldTransforms;return new gJ(new UW(c),s,u)}var EJ=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"_toFieldTransform",value:function(e){if(2!==e.Zc)throw e.oa(1===e.Zc?"".concat(this._methodName,"() can only appear at the top level of your update data"):"".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(dJ),bJ=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"_toFieldTransform",value:function(e){return new Nj(e.path,new Pj)}},{key:"isEqual",value:function(e){return e instanceof n}}]),n}(dJ);function SJ(e,t){if(OJ(e=az(e)))return TJ("Unsupported field value:",t,e),PJ(e,t);if(e instanceof dJ)return function(e,t){if(!mJ(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],i=0,a=uy(e);try{for(a.s();!(n=a.n()).done;){var o=SJ(n.value,t.ra(i));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),i++}}catch(s){a.e(s)}finally{a.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=az(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return function(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!wW(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?wj(t):Cj(e,t)}(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Vq.fromDate(e);return{timestampValue:TY(t.wt,n)}}if(e instanceof Vq){var r=new Vq(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:TY(t.wt,r)}}if(e instanceof vJ)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof hJ)return{bytesValue:IY(t.wt,e._byteString)};if(e instanceof nJ){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.oa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:MY(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(XX(e)))}(e,t)}function PJ(e,t){var n={};return rW(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):nW(e,function(e,r){var i=SJ(r,t.ea(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function OJ(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Vq||e instanceof vJ||e instanceof hJ||e instanceof nJ||e instanceof dJ)}function TJ(e,t,n){if(!OJ(n)||"object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){var r=XX(n);throw t.oa("an object"===r?e+" a custom object":e+" "+r)}var i}function IJ(e,t,n){if((t=az(t))instanceof fJ)return t._internalPath;if("string"==typeof t)return RJ(e,t);throw MJ("Field path arguments must be of type string or ",e,!1,void 0,n)}var AJ=new RegExp("[~\\*/\\[\\]]");function RJ(e,t,n){if(t.search(AJ)>=0)throw MJ("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return Kg(fJ,oy(t.split(".")))._internalPath}catch(r){throw MJ("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function MJ(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(a||o)&&(u+=" (found",a&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(i)),u+=")"),new Pq(Sq.INVALID_ARGUMENT,s+e+u)}function xJ(e,t){return e.some(function(e){return e.isEqual(t)})}var NJ=function(){function e(t,n,r,i,a){fy(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=i,this._converter=a}return dy(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new nJ(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new DJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(LJ("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),DJ=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"data",value:function(){return Qg(ay(n.prototype),"data",this).call(this)}}]),n}(NJ);function LJ(e,t){return"string"==typeof t?RJ(e,t):t instanceof fJ?t._internalPath:t._delegate._internalPath}var FJ=function(){function e(t,n){fy(this,e),this.hasPendingWrites=t,this.fromCache=n}return dy(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),UJ=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,r,i,a,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return dy(n,[{key:"exists",value:function(){return Qg(ay(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new VJ(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(LJ("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(NJ),VJ=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Qg(ay(n.prototype),"data",this).call(this,e)}}]),n}(UJ),BJ=function(){function e(t,n,r,i){fy(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=i,this.metadata=new FJ(i.hasPendingWrites,i.fromCache),this.query=r}return dy(e,[{key:"docs",get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach(function(r){e.call(t,new VJ(n._firestore,n._userDataWriter,r.key,r,new FJ(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))})}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Pq(Sq.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map(function(t){return{type:"added",doc:new VJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new FJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}})}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(function(e){return t||3!==e.type}).map(function(t){var n=new VJ(e._firestore,e._userDataWriter,t.doc.key,t.doc,new FJ(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:zJ(t.type),doc:n,oldIndex:i,newIndex:a}})}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function zJ(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _q()}}function HJ(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Pq(Sq.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var GJ=dy(function e(){fy(this,e)});var $J=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this)).fa=e,a.da=r,a._a=i,a.type="where",a}return dy(n,[{key:"_apply",value:function(e){var t,n,r,i=wJ(e.firestore),a=function(e,t,n,r,i,a,o){var s;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){jJ(o,a);var u,c=[],l=uy(o);try{for(l.s();!(u=l.n()).done;){var f=u.value;c.push(WJ(r,e,f))}}catch(d){l.e(d)}finally{l.f()}s={arrayValue:{values:c}}}else s=WJ(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||jJ(o,a),s=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return SJ(n,e.aa(r?4:3,t))}(n,"where",o,"in"===a||"not-in"===a);var h=qW.create(i,a,s);return function(e,t){if(t.ht()){var n=cj(e);if(null!==n&&!n.isEqual(t.field))throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=uj(e);null!==r&&YJ(0,t.field,r)}var i=function(e,t){var n,r=uy(e.filters);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.indexOf(i.op)>=0)return i.op}}catch(d){r.e(d)}finally{r.f()}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw new Pq(Sq.INVALID_ARGUMENT,i===t.op?"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter."):"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,h),h}(e._query,0,i,e.firestore._databaseId,this.fa,this.da,this._a);return new rJ(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new oj(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(GJ);var ZJ=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).fa=e,i.wa=r,i.type="orderBy",i}return dy(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new nj(t,n);return function(e,t){if(null===uj(e)){var n=cj(e);null!==n&&YJ(0,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new rJ(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new oj(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(GJ);var qJ=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this)).type=e,a.ma=r,a.ga=i,a}return dy(n,[{key:"_apply",value:function(e){return new rJ(e.firestore,e.converter,dj(e._query,this.ma,this.ga))}}]),n}(GJ);function WJ(e,t,n){if("string"==typeof(n=az(n))){if(""===n)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lj(t)&&-1!==n.indexOf("/"))throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(Hq.fromString(n));if(!Zq.isDocumentKey(r))throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return AW(e,new Zq(r))}if(n instanceof nJ)return AW(e,n._key);throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(XX(n),"."))}function jJ(e,t){if(!Array.isArray(e)||0===e.length)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Pq(Sq.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function YJ(e,t,n){if(!n.isEqual(t))throw new Pq(Sq.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}function KJ(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var QJ=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).firestore=e,r}return dy(n,[{key:"convertBytes",value:function(e){return new hJ(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new nJ(this.firestore,null,t)}}]),n}(function(){function e(){fy(this,e)}return dy(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(EW(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dW(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vW(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw _q()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return nW(e.fields,function(e,i){r[e]=n.convertValue(i,t)}),r}},{key:"convertGeoPoint",value:function(e){return new vJ(dW(e.latitude),dW(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map(function(e){return n.convertValue(e,t)})}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=gW(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(yW(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=hW(e);return new Vq(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=Hq.fromString(e);Eq(QY(n));var r=new kW(n.get(1),n.get(3)),i=new Zq(n.popFirst(5));return r.isEqual(t)||kq("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}());function XJ(e,t){return n=cJ(e),r=t,i=new Oq,n.asyncQueue.enqueueAndForget(SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n){return lX.apply(this,arguments)},e.next=3,function(e){return $X(e).then(function(e){return e.syncEngine})}(n);case 3:return e.t1=e.sent,e.t2=r,e.t3=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}},e)}))),i.promise;var n,r,i}function JJ(e,t,n){var r=n.docs.get(t._key),i=new QJ(e);return new UJ(e,i,t._key,r,new FJ(n.hasPendingWrites,n.fromCache),t.converter)}function e1(){return new bJ("serverTimestamp")}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];pq="9.9.0",Hz(new uz("firestore",function(e,n){var r=n.options,i=e.getProvider("app").getImmediate(),a=new uJ(i,new Aq(e.getProvider("auth-internal")),new Nq(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),a._setSettings(r),a},"PUBLIC")),Yz(dq,"3.4.12",e),Yz(dq,"3.4.12","esm2017")}(),Yz("firebase","9.9.0","app");var t1="@firebase/installations",n1="0.5.12",r1="w:".concat(n1),i1="FIS_v2",a1=new YB("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function o1(e){return e instanceof jB&&e.code.includes("request-failed")}function s1(e){var t=e.projectId;return"https://firebaseinstallations.googleapis.com/v1/projects/".concat(t,"/installations")}function u1(e){return{token:e.token,requestStatus:2,expiresIn:p1(e.expiresIn),creationTime:Date.now()}}function c1(e,t){return l1.apply(this,arguments)}function l1(){return l1=SB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return r=e.sent.error,e.abrupt("return",a1.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status}));case 4:case"end":return e.stop()}},e)})),l1.apply(this,arguments)}function f1(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function h1(e,t){var n=t.refreshToken,r=f1(e);return r.append("Authorization",function(e){return"".concat(i1," ").concat(e)}(n)),r}function d1(e){return v1.apply(this,arguments)}function v1(){return v1=SB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return n=e.sent,e.abrupt("return",n.status>=500&&n.status<600?t():n);case 4:case"end":return e.stop()}},e)})),v1.apply(this,arguments)}function p1(e){return Number(e.replace("s","000"))}function g1(e,t){return y1.apply(this,arguments)}function y1(){return y1=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=n.fid,o=s1(r),s=f1(r),!(u=i.getImmediate({optional:!0}))){e.next=8;break}return e.next=6,u.getHeartbeatsHeader();case 6:(c=e.sent)&&s.append("x-firebase-client",c);case 8:return l={method:"POST",headers:s,body:JSON.stringify({fid:a,authVersion:i1,appId:r.appId,sdkVersion:r1})},e.next=11,d1(function(){return fetch(o,l)});case 11:if(!(f=e.sent).ok){e.next=17;break}return e.next=15,f.json();case 15:return h=e.sent,e.abrupt("return",{fid:h.fid||a,registrationStatus:2,refreshToken:h.refreshToken,authToken:u1(h.authToken)});case 17:return e.next=19,c1("Create Installation",f);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),y1.apply(this,arguments)}function m1(e){return new Promise(function(t){setTimeout(t,e)})}var k1=/^[cdef][\w-]{21}$/;function C1(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return function(e){return btoa(String.fromCharCode.apply(String,oy(e))).replace(/\+/g,"-").replace(/\//g,"_")}(e).substr(0,22)}(e);return k1.test(t)?t:""}catch(n){return""}}function w1(e){return"".concat(e.appName,"!").concat(e.appId)}var _1=new Map;function E1(e,t){var n=w1(e);b1(n,t),function(e,t){var n=(!S1&&"BroadcastChannel"in self&&((S1=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){b1(e.data.key,e.data.fid)}),S1);n&&n.postMessage({key:e,fid:t}),0===_1.size&&S1&&(S1.close(),S1=null)}(n,t)}function b1(e,t){var n=_1.get(e);if(n){var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){(0,r.value)(t)}}catch(a){i.e(a)}finally{i.f()}}}var S1=null,P1="firebase-installations-store",O1=null;function T1(){return O1||(O1=Oz("firebase-installations-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(P1)}})),O1}function I1(e,t){return A1.apply(this,arguments)}function A1(){return A1=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=w1(t),e.next=3,T1();case 3:return i=e.sent.transaction(P1,"readwrite"),a=i.objectStore(P1),e.next=7,a.get(r);case 7:return o=e.sent,e.next=10,a.put(n,r);case 10:return e.next=12,i.done;case 12:return(!o||o.fid!==n.fid)&&E1(t,n.fid),e.abrupt("return",n);case 14:case"end":return e.stop()}},e)})),A1.apply(this,arguments)}function R1(e){return M1.apply(this,arguments)}function M1(){return M1=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=w1(t),e.next=3,T1();case 3:return r=e.sent.transaction(P1,"readwrite"),e.next=6,r.objectStore(P1).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),M1.apply(this,arguments)}function x1(e,t){return N1.apply(this,arguments)}function N1(){return N1=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=w1(t),e.next=3,T1();case 3:return i=e.sent.transaction(P1,"readwrite"),a=i.objectStore(P1),e.next=7,a.get(r);case 7:if(o=e.sent,void 0!==(s=n(o))){e.next=14;break}return e.next=12,a.delete(r);case 12:e.next=16;break;case 14:return e.next=16,a.put(s,r);case 16:return e.next=18,i.done;case 18:return s&&(!o||o.fid!==s.fid)&&E1(t,s.fid),e.abrupt("return",s);case 20:case"end":return e.stop()}},e)})),N1.apply(this,arguments)}function D1(e){return L1.apply(this,arguments)}function L1(){return L1=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x1(t.appConfig,function(e){var r=F1(e),i=U1(t,r);return n=i.registrationPromise,i.installationEntry});case 2:if(""!==(r=e.sent).fid){e.next=10;break}return e.next=6,n;case 6:e.t1=e.sent,e.t0={installationEntry:e.t1},e.next=11;break;case 10:e.t0={installationEntry:r,registrationPromise:n};case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),L1.apply(this,arguments)}function F1(e){return G1(e||{fid:C1(),registrationStatus:0})}function U1(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(a1.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function(e,t){return V1.apply(this,arguments)}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:B1(e)}:{installationEntry:t}}function V1(){return V1=SB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g1(t,n);case 3:return r=e.sent,e.abrupt("return",I1(t.appConfig,r));case 7:if(e.prev=7,e.t0=e.catch(0),!o1(e.t0)||409!==e.t0.customData.serverCode){e.next=14;break}return e.next=12,R1(t.appConfig);case 12:e.next=16;break;case 14:return e.next=16,I1(t.appConfig,{fid:n.fid,registrationStatus:0});case 16:throw e.t0;case 17:case"end":return e.stop()}},e,null,[[0,7]])})),V1.apply(this,arguments)}function B1(e){return z1.apply(this,arguments)}function z1(){return z1=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H1(t.appConfig);case 2:n=e.sent;case 3:if(1!==n.registrationStatus){e.next=11;break}return e.next=6,m1(100);case 6:return e.next=8,H1(t.appConfig);case 8:n=e.sent;case 9:e.next=3;break;case 11:if(0!==n.registrationStatus){e.next=18;break}return e.next=14,D1(t);case 14:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",a||i);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}},e)})),z1.apply(this,arguments)}function H1(e){return x1(e,function(e){if(!e)throw a1.create("installation-not-found");return G1(e)})}function G1(e){return function(e){return 1===e.registrationStatus&&e.registrationTime+1e4<Date.now()}(e)?{fid:e.fid,registrationStatus:0}:e}function $1(e,t){return Z1.apply(this,arguments)}function Z1(){return Z1=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.appConfig,i=t.heartbeatServiceProvider,a=q1(r,n),o=h1(r,n),!(s=i.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,s.getHeartbeatsHeader();case 5:(u=e.sent)&&o.append("x-firebase-client",u);case 7:return c={method:"POST",headers:o,body:JSON.stringify({installation:{sdkVersion:r1,appId:r.appId}})},e.next=10,d1(function(){return fetch(a,c)});case 10:if(!(l=e.sent).ok){e.next=17;break}return e.t0=u1,e.next=15,l.json();case 15:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 17:return e.next=19,c1("Generate Auth Token",l);case 19:throw e.sent;case 20:case"end":return e.stop()}},e)})),Z1.apply(this,arguments)}function q1(e,t){var n=t.fid;return"".concat(s1(e),"/").concat(n,"/authTokens:generate")}function W1(e){return j1.apply(this,arguments)}function j1(){return j1=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.next=3,x1(t.appConfig,function(e){if(!e0(e))throw a1.create("not-registered");var i=e.authToken;if(!n&&t0(i))return e;if(1===i.requestStatus)return r=Y1(t,n),e;if(!navigator.onLine)throw a1.create("app-offline");var a=n0(e);return r=X1(t,a),a});case 3:if(i=e.sent,!r){e.next=10;break}return e.next=7,r;case 7:e.t0=e.sent,e.next=11;break;case 10:e.t0=i.authToken;case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}},e)})),j1.apply(this,arguments)}function Y1(e,t){return K1.apply(this,arguments)}function K1(){return K1=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q1(t.appConfig);case 2:r=e.sent;case 3:if(1!==r.authToken.requestStatus){e.next=11;break}return e.next=6,m1(100);case 6:return e.next=8,Q1(t.appConfig);case 8:r=e.sent;case 9:e.next=3;break;case 11:return i=r.authToken,e.abrupt("return",0===i.requestStatus?W1(t,n):i);case 13:case"end":return e.stop()}},e)})),K1.apply(this,arguments)}function Q1(e){return x1(e,function(e){if(!e0(e))throw a1.create("not-registered");return function(e){return 1===e.requestStatus&&e.requestTime+1e4<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function X1(e,t){return J1.apply(this,arguments)}function J1(){return J1=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$1(t,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{authToken:r}),e.next=7,I1(t.appConfig,i);case 7:return e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(0),o1(e.t0)&&(401===e.t0.customData.serverCode||404===e.t0.customData.serverCode)){e.next=18;break}return a=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),e.next=16,I1(t.appConfig,a);case 16:e.next=20;break;case 18:return e.next=20,R1(t.appConfig);case 20:throw e.t0;case 21:case"end":return e.stop()}},e,null,[[0,10]])})),J1.apply(this,arguments)}function e0(e){return void 0!==e&&2===e.registrationStatus}function t0(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(e)}function n0(e){var t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}function r0(){return r0=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,D1(n);case 3:return r=e.sent,i=r.installationEntry,a=r.registrationPromise,e.abrupt("return",(a?a.catch(console.error):W1(n).catch(console.error),i.fid));case 7:case"end":return e.stop()}},e)})),r0.apply(this,arguments)}function i0(){return i0=SB(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],r=t,e.next=4,a0(r);case 4:return e.next=6,W1(r,n);case 6:return e.abrupt("return",e.sent.token);case 7:case"end":return e.stop()}},e)})),i0.apply(this,arguments)}function a0(e){return o0.apply(this,arguments)}function o0(){return o0=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D1(t);case 2:if(n=e.sent,r=n.registrationPromise,e.t0=r,!e.t0){e.next=8;break}return e.next=8,r;case 8:case"end":return e.stop()}},e)})),o0.apply(this,arguments)}function s0(e){return a1.create("missing-app-config-values",{valueName:e})}var u0="installations";Hz(new uz(u0,function(e){var t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw s0("App Configuration");if(!e.name)throw s0("App Name");for(var t=0,n=["projectId","apiKey","appId"];t<n.length;t++){var r=n[t];if(!e.options[r])throw s0(r)}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Gz(t,"heartbeat"),_delete:function(){return Promise.resolve()}}},"PUBLIC")),Hz(new uz("installations-internal",function(e){var t=Gz(e.getProvider("app").getImmediate(),u0).getImmediate();return{getId:function(){return function(e){return r0.apply(this,arguments)}(t)},getToken:function(e){return function(e){return i0.apply(this,arguments)}(t,e)}}},"PRIVATE")),Yz(t1,n1),Yz(t1,n1,"esm2017");var c0="@firebase/remote-config",l0=new YB("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),f0=function(){function e(t,n,r,i){fy(this,e),this.client=t,this.storage=n,this.storageCache=r,this.logger=i}return dy(e,[{key:"isCachedDataFresh",value:function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: ".concat(n,". Cache max age millis (minimumFetchIntervalMillis setting): ").concat(e,". Is cache hit: ").concat(r,".")),r}},{key:"fetch",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);case 2:if(r=n.sent,i=qg(r,2),a=i[0],!(o=i[1])||!t.isCachedDataFresh(e.cacheMaxAgeMillis,a)){n.next=8;break}return n.abrupt("return",o);case 8:return e.eTag=o&&o.eTag,n.next=11,t.client.fetch(e);case 11:return s=n.sent,u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),n.next=16,Promise.all(u);case 16:return n.abrupt("return",s);case 17:case"end":return n.stop()}},n)}))()}}]),e}();function h0(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e.languages&&e.languages[0]||e.language}var d0=function(){function e(t,n,r,i,a,o){fy(this,e),this.firebaseInstallations=t,this.sdkVersion=n,this.namespace=r,this.projectId=i,this.apiKey=a,this.appId=o}return dy(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l,f,h,d,v,p,g,y,m,k,C,w,_;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]);case 2:return o=n.sent,s=qg(o,2),u=s[0],c=s[1],l="".concat(window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com","/v1/projects/").concat(t.projectId,"/namespaces/").concat(t.namespace,":fetch?key=").concat(t.apiKey),f={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},h={sdk_version:t.sdkVersion,app_instance_id:u,app_instance_id_token:c,app_id:t.appId,language_code:h0()},d={method:"POST",headers:f,body:JSON.stringify(h)},v=fetch(l,d),p=new Promise(function(t,n){e.signal.addEventListener(function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)})}),n.prev=12,n.next=15,Promise.race([v,p]);case 15:return n.next=17,v;case 17:g=n.sent,n.next=24;break;case 20:throw n.prev=20,n.t0=n.catch(12),y="fetch-client-network","AbortError"===(null===(r=n.t0)||void 0===r?void 0:r.name)&&(y="fetch-timeout"),l0.create(y,{originalErrorMessage:null===(i=n.t0)||void 0===i?void 0:i.message});case 24:if(m=g.status,k=g.headers.get("ETag")||void 0,200!==g.status){n.next=37;break}return n.prev=27,n.next=30,g.json();case 30:_=n.sent,n.next=36;break;case 33:throw n.prev=33,n.t1=n.catch(27),l0.create("fetch-client-parse",{originalErrorMessage:null===(a=n.t1)||void 0===a?void 0:a.message});case 36:C=_.entries,w=_.state;case 37:if("INSTANCE_STATE_UNSPECIFIED"===w?m=500:"NO_CHANGE"===w?m=304:("NO_TEMPLATE"===w||"EMPTY_CONFIG"===w)&&(C={}),304===m||200===m){n.next=39;break}throw l0.create("fetch-status",{httpStatus:m});case 39:return n.abrupt("return",{status:m,eTag:k,config:C});case 40:case"end":return n.stop()}},n,null,[[12,20],[27,33]])}))()})}]),e}(),v0=function(){function e(t,n){fy(this,e),this.client=t,this.storage=n}return dy(e,[{key:"fetch",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.storage.getThrottleMetadata();case 2:if(n.t0=n.sent,n.t0){n.next=5;break}n.t0={backoffCount:0,throttleEndTimeMillis:Date.now()};case 5:return r=n.t0,n.abrupt("return",t.attemptFetch(e,r));case 7:case"end":return n.stop()}},n)}))()}},{key:"attemptFetch",value:function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount,i=this;return SB(regeneratorRuntime.mark(function t(){var a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r(l0.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(e.signal,n);case 2:return t.prev=2,t.next=5,i.client.fetch(e);case 5:return a=t.sent,t.next=8,i.storage.deleteThrottleMetadata();case 8:return t.abrupt("return",a);case 11:if(t.prev=11,t.t0=t.catch(2),function(e){if(!(e instanceof jB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t.t0)){t.next=15;break}throw t.t0;case 15:return o={throttleEndTimeMillis:Date.now()+iz(r),backoffCount:r+1},t.next=18,i.storage.setThrottleMetadata(o);case 18:return t.abrupt("return",i.attemptFetch(e,o));case 19:case"end":return t.stop()}},t,null,[[2,11]])}))()}}]),e}(),p0=function(){function e(t,n,r,i,a){fy(this,e),this.app=t,this._client=n,this._storageCache=r,this._storage=i,this._logger=a,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return dy(e,[{key:"fetchTimeMillis",get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}},{key:"lastFetchStatus",get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}]),e}();function g0(e,t){var n,r=e.target.error||void 0;return l0.create(t,{originalErrorMessage:r&&(null===(n=r)||void 0===n?void 0:n.message)})}var y0="app_namespace_store",m0=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Promise(function(e,t){var n;try{var i=indexedDB.open("firebase_remote_config",1);i.onerror=function(e){t(g0(e,"storage-open"))},i.onsuccess=function(t){e(t.target.result)},i.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(y0,{keyPath:"compositeKey"})}}catch(r){t(l0.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}});fy(this,e),this.appId=t,this.appName=n,this.namespace=r,this.openDbPromise=i}return dy(e,[{key:"getLastFetchStatus",value:function(){return this.get("last_fetch_status")}},{key:"setLastFetchStatus",value:function(e){return this.set("last_fetch_status",e)}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.get("last_successful_fetch_timestamp_millis")}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.set("last_successful_fetch_timestamp_millis",e)}},{key:"getLastSuccessfulFetchResponse",value:function(){return this.get("last_successful_fetch_response")}},{key:"setLastSuccessfulFetchResponse",value:function(e){return this.set("last_successful_fetch_response",e)}},{key:"getActiveConfig",value:function(){return this.get("active_config")}},{key:"setActiveConfig",value:function(e){return this.set("active_config",e)}},{key:"getActiveConfigEtag",value:function(){return this.get("active_config_etag")}},{key:"setActiveConfigEtag",value:function(e){return this.set("active_config_etag",e)}},{key:"getThrottleMetadata",value:function(){return this.get("throttle_metadata")}},{key:"setThrottleMetadata",value:function(e){return this.set("throttle_metadata",e)}},{key:"deleteThrottleMetadata",value:function(){return this.delete("throttle_metadata")}},{key:"get",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([y0],"readonly").objectStore(y0),s=t.createCompositeKey(e);try{var u=o.get(s);u.onerror=function(e){i(g0(e,"storage-get"))},u.onsuccess=function(e){var t=e.target.result;n(t?t.value:void 0)}}catch(u){i(l0.create("storage-get",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"set",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.openDbPromise;case 2:return i=r.sent,r.abrupt("return",new Promise(function(r,a){var o,s=i.transaction([y0],"readwrite").objectStore(y0),u=n.createCompositeKey(e);try{var c=s.put({compositeKey:u,value:t});c.onerror=function(e){a(g0(e,"storage-set"))},c.onsuccess=function(){r()}}catch(c){a(l0.create("storage-set",{originalErrorMessage:null===(o=c)||void 0===o?void 0:o.message}))}}));case 4:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.openDbPromise;case 2:return r=n.sent,n.abrupt("return",new Promise(function(n,i){var a,o=r.transaction([y0],"readwrite").objectStore(y0),s=t.createCompositeKey(e);try{var u=o.delete(s);u.onerror=function(e){i(g0(e,"storage-delete"))},u.onsuccess=function(){n()}}catch(u){i(l0.create("storage-delete",{originalErrorMessage:null===(a=u)||void 0===a?void 0:a.message}))}}));case 4:case"end":return n.stop()}},n)}))()}},{key:"createCompositeKey",value:function(e){return[this.appId,this.appName,this.namespace,e].join()}}]),e}(),k0=function(){function e(t){fy(this,e),this.storage=t}return dy(e,[{key:"getLastFetchStatus",value:function(){return this.lastFetchStatus}},{key:"getLastSuccessfulFetchTimestampMillis",value:function(){return this.lastSuccessfulFetchTimestampMillis}},{key:"getActiveConfig",value:function(){return this.activeConfig}},{key:"loadFromStorage",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.storage.getLastFetchStatus(),r=e.storage.getLastSuccessfulFetchTimestampMillis(),i=e.storage.getActiveConfig(),t.next=5,n;case 5:return(a=t.sent)&&(e.lastFetchStatus=a),t.next=9,r;case 9:return(o=t.sent)&&(e.lastSuccessfulFetchTimestampMillis=o),t.next=13,i;case 13:(s=t.sent)&&(e.activeConfig=s);case 15:case"end":return t.stop()}},t)}))()}},{key:"setLastFetchStatus",value:function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}},{key:"setLastSuccessfulFetchTimestampMillis",value:function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}},{key:"setActiveConfig",value:function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}]),e}();function C0(){return(C0=SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ZB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,qB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}Hz(new uz("remote-config",function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw l0.create("registration-window");if(!ZB())throw l0.create("indexed-db-unavailable");var a=r.options,o=a.projectId,s=a.apiKey,u=a.appId;if(!o)throw l0.create("registration-project-id");if(!s)throw l0.create("registration-api-key");if(!u)throw l0.create("registration-app-id");var c=new m0(u,r.name,n=n||"firebase"),l=new k0(c),f=new mz(c0);f.logLevel=dz.ERROR;var h=new d0(i,qz,n,o,s,u),d=new v0(h,c),v=new f0(d,c,l,f),p=new p0(r,v,l,c,f);return function(e){var t=az(e);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0}))}(p),p},"PUBLIC").setMultipleInstances(!0)),Yz(c0,"0.3.11"),Yz(c0,"0.3.11","esm2017");var w0="/firebase-messaging-sw.js",_0="/firebase-cloud-messaging-push-scope",E0="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",b0="google.c.a.c_id",S0="google.c.a.c_l",P0="google.c.a.ts",O0="google.c.a.e",T0=(function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(T0||(T0={})),T0);function I0(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,oy(t))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function A0(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var R0="fcm_token_details_db",M0="fcm_token_object_Store";function x0(e){return N0.apply(this,arguments)}function N0(){return N0=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="databases"in indexedDB,!e.t0){e.next=5;break}return e.next=4,indexedDB.databases();case 4:e.t0=!e.sent.map(function(e){return e.name}).includes(R0);case 5:if(!e.t0){e.next=7;break}return e.abrupt("return",null);case 7:return n=null,e.next=10,Oz(R0,5,{upgrade:(r=SB(regeneratorRuntime.mark(function e(r,i,a,o){var s,u,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i<2)&&r.objectStoreNames.contains(M0)){e.next=2;break}return e.abrupt("return");case 2:return u=o.objectStore(M0),e.next=5,u.index("fcmSenderId").get(t);case 5:return c=e.sent,e.next=8,u.clear();case 8:if(!c){e.next=17;break}if(2!==i){e.next=16;break}if((l=c).auth&&l.p256dh&&l.endpoint){e.next=13;break}return e.abrupt("return");case 13:n={token:l.fcmToken,createTime:null!==(s=l.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:l.auth,p256dh:l.p256dh,endpoint:l.endpoint,swScope:l.swScope,vapidKey:"string"==typeof l.vapidKey?l.vapidKey:I0(l.vapidKey)}},e.next=17;break;case 16:3===i?n={token:(f=c).fcmToken,createTime:f.createTime,subscriptionOptions:{auth:I0(f.auth),p256dh:I0(f.p256dh),endpoint:f.endpoint,swScope:f.swScope,vapidKey:I0(f.vapidKey)}}:4===i&&(n={token:(h=c).fcmToken,createTime:h.createTime,subscriptionOptions:{auth:I0(h.auth),p256dh:I0(h.p256dh),endpoint:h.endpoint,swScope:h.swScope,vapidKey:I0(h.vapidKey)}});case 17:case"end":return e.stop()}},e)})),function(e,t,n,i){return r.apply(this,arguments)})});case 10:return e.sent.close(),e.next=13,Tz(R0);case 13:return e.next=15,Tz("fcm_vapid_details_db");case 15:return e.next=17,Tz("undefined");case 17:return e.abrupt("return",D0(n)?n:null);case 18:case"end":return e.stop()}},e)})),N0.apply(this,arguments)}function D0(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var L0="firebase-messaging-store",F0=null;function U0(){return F0||(F0=Oz("firebase-messaging-database",1,{upgrade:function(e,t){0===t&&e.createObjectStore(L0)}})),F0}function V0(e){return B0.apply(this,arguments)}function B0(){return B0=SB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Z0(t),e.next=3,U0();case 3:return e.next=5,e.sent.transaction(L0).objectStore(L0).get(n);case 5:if(!(r=e.sent)){e.next=8;break}return e.abrupt("return",r);case 8:return e.next=10,x0(t.appConfig.senderId);case 10:if(!(i=e.sent)){e.next=15;break}return e.next=14,z0(t,i);case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}},e)})),B0.apply(this,arguments)}function z0(e,t){return H0.apply(this,arguments)}function H0(){return H0=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=Z0(t),e.next=3,U0();case 3:return i=e.sent.transaction(L0,"readwrite"),e.next=6,i.objectStore(L0).put(n,r);case 6:return e.next=8,i.done;case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)})),H0.apply(this,arguments)}function G0(e){return $0.apply(this,arguments)}function $0(){return $0=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Z0(t),e.next=3,U0();case 3:return r=e.sent.transaction(L0,"readwrite"),e.next=6,r.objectStore(L0).delete(n);case 6:return e.next=8,r.done;case 8:case"end":return e.stop()}},e)})),$0.apply(this,arguments)}function Z0(e){return e.appConfig.appId}var q0=new YB("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function W0(e,t){return j0.apply(this,arguments)}function j0(){return j0=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,e2(t);case 2:return i=e.sent,a=n2(n),o={method:"POST",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch(J0(t.appConfig),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),q0.create("token-subscribe-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw q0.create("token-subscribe-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw q0.create("token-subscribe-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),j0.apply(this,arguments)}function Y0(e,t){return K0.apply(this,arguments)}function K0(){return K0=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,e2(t);case 2:return i=e.sent,a=n2(n.subscriptionOptions),o={method:"PATCH",headers:i,body:JSON.stringify(a)},e.prev=5,e.next=8,fetch("".concat(J0(t.appConfig),"/").concat(n.token),o);case 8:return e.next=10,e.sent.json();case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),q0.create("token-update-failed",{errorInfo:null===(r=e.t0)||void 0===r?void 0:r.toString()});case 16:if(!s.error){e.next=18;break}throw q0.create("token-update-failed",{errorInfo:s.error.message});case 18:if(s.token){e.next=20;break}throw q0.create("token-update-no-token");case 20:return e.abrupt("return",s.token);case 21:case"end":return e.stop()}},e,null,[[5,13]])})),K0.apply(this,arguments)}function Q0(e,t){return X0.apply(this,arguments)}function X0(){return X0=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,e2(t);case 2:return e.t0=e.sent,i={method:"DELETE",headers:e.t0},e.prev=4,e.next=7,fetch("".concat(J0(t.appConfig),"/").concat(n),i);case 7:return e.next=9,e.sent.json();case 9:if(!(a=e.sent).error){e.next=12;break}throw q0.create("token-unsubscribe-failed",{errorInfo:a.error.message});case 12:e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(4),q0.create("token-unsubscribe-failed",{errorInfo:null===(r=e.t1)||void 0===r?void 0:r.toString()});case 17:case"end":return e.stop()}},e,null,[[4,14]])})),X0.apply(this,arguments)}function J0(e){var t=e.projectId;return"https://fcmregistrations.googleapis.com/v1/projects/".concat(t,"/registrations")}function e2(e){return t2.apply(this,arguments)}function t2(){return t2=SB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.appConfig,r=t.installations,e.next=3,r.getToken();case 3:return i=e.sent,e.abrupt("return",new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(i)}));case 5:case"end":return e.stop()}},e)})),t2.apply(this,arguments)}function n2(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,a={web:{endpoint:r,auth:n,p256dh:t}};return i!==E0&&(a.web.applicationPubKey=i),a}function r2(e){return i2.apply(this,arguments)}function i2(){return i2=SB(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f2(t.swRegistration,t.vapidKey);case 2:return n=e.sent,r={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:n.endpoint,auth:I0(n.getKey("auth")),p256dh:I0(n.getKey("p256dh"))},e.next=6,V0(t.firebaseDependencies);case 6:if(!(i=e.sent)){e.next=19;break}if(!d2(i.subscriptionOptions,r)){e.next=10;break}return e.abrupt("return",Date.now()>=i.createTime+6048e5?s2(t,{token:i.token,createTime:Date.now(),subscriptionOptions:r}):i.token);case 10:return e.prev=10,e.next=13,Q0(t.firebaseDependencies,i.token);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),console.warn(e.t0);case 18:case 19:return e.abrupt("return",c2(t.firebaseDependencies,r));case 20:case"end":return e.stop()}},e,null,[[10,15]])})),i2.apply(this,arguments)}function a2(e){return o2.apply(this,arguments)}function o2(){return o2=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V0(t.firebaseDependencies);case 2:if(n=e.sent,e.t0=n,!e.t0){e.next=9;break}return e.next=7,Q0(t.firebaseDependencies,n.token);case 7:return e.next=9,G0(t.firebaseDependencies);case 9:return e.next=11,t.swRegistration.pushManager.getSubscription();case 11:return r=e.sent,e.abrupt("return",!r||r.unsubscribe());case 13:case"end":return e.stop()}},e)})),o2.apply(this,arguments)}function s2(e,t){return u2.apply(this,arguments)}function u2(){return u2=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y0(t.firebaseDependencies,n);case 3:return r=e.sent,i=Object.assign(Object.assign({},n),{token:r,createTime:Date.now()}),e.next=7,z0(t.firebaseDependencies,i);case 7:return e.abrupt("return",r);case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,a2(t);case 14:throw e.t0;case 15:case"end":return e.stop()}},e,null,[[0,10]])})),u2.apply(this,arguments)}function c2(e,t){return l2.apply(this,arguments)}function l2(){return l2=SB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W0(t,n);case 2:return e.t0=e.sent,e.t1=Date.now(),e.t2=n,r={token:e.t0,createTime:e.t1,subscriptionOptions:e.t2},e.next=8,z0(t,r);case 8:return e.abrupt("return",r.token);case 9:case"end":return e.stop()}},e)})),l2.apply(this,arguments)}function f2(e,t){return h2.apply(this,arguments)}function h2(){return h2=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:A0(n)});case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}},e)})),h2.apply(this,arguments)}function d2(e,t){return t.vapidKey===e.vapidKey&&t.endpoint===e.endpoint&&t.auth===e.auth&&t.p256dh===e.p256dh}function v2(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){!t.data||(e.data=t.data)}(t,e),function(e,t){var n,r,i,a,o;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var s=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(a=t.notification)||void 0===a?void 0:a.click_action;s&&(e.fcmOptions.link=s);var u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(e.fcmOptions.analyticsLabel=u)}}(t,e),t}function p2(e){return"object"==typeof e&&!!e&&b0 in e}function g2(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function y2(e){return q0.create("missing-app-config-values",{valueName:e})}g2("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),g2("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var m2=function(){function e(t,n,r){fy(this,e),this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var i=function(e){if(!e||!e.options)throw y2("App Configuration Object");if(!e.name)throw y2("App Name");for(var t=e.options,n=0,r=["projectId","apiKey","appId","messagingSenderId"];n<r.length;n++){var i=r[n];if(!t[i])throw y2(i)}return{appName:e.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:i,installations:n,analyticsProvider:r}}return dy(e,[{key:"_delete",value:function(){return Promise.resolve()}}]),e}();function k2(e){return C2.apply(this,arguments)}function C2(){return C2=SB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(w0,{scope:_0});case 3:t.swRegistration=e.sent,t.swRegistration.update().catch(function(){}),e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),q0.create("failed-service-worker-registration",{browserErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}},e,null,[[0,7]])})),C2.apply(this,arguments)}function w2(e,t){return _2.apply(this,arguments)}function _2(){return _2=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!n&&!t.swRegistration,!e.t0){e.next=4;break}return e.next=4,k2(t);case 4:if(!n&&t.swRegistration){e.next=8;break}if(n instanceof ServiceWorkerRegistration){e.next=7;break}throw q0.create("invalid-sw-registration");case 7:t.swRegistration=n;case 8:case"end":return e.stop()}},e)})),_2.apply(this,arguments)}function E2(e,t){return b2.apply(this,arguments)}function b2(){return b2=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n?t.vapidKey=n:t.vapidKey||(t.vapidKey=E0);case 1:case"end":return e.stop()}},e)})),b2.apply(this,arguments)}function S2(){return S2=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator){e.next=2;break}throw q0.create("only-available-in-window");case 2:if(e.t0="default"===Notification.permission,!e.t0){e.next=6;break}return e.next=6,Notification.requestPermission();case 6:if("granted"===Notification.permission){e.next=8;break}throw q0.create("permission-blocked");case 8:return e.next=10,E2(t,null==n?void 0:n.vapidKey);case 10:return e.next=12,w2(t,null==n?void 0:n.serviceWorkerRegistration);case 12:return e.abrupt("return",r2(t));case 13:case"end":return e.stop()}},e)})),S2.apply(this,arguments)}function P2(e,t,n){return O2.apply(this,arguments)}function O2(){return O2=SB(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=T2(n),e.next=3,t.firebaseDependencies.analyticsProvider.get();case 3:e.sent.logEvent(i,{message_id:r[b0],message_name:r[S0],message_time:r[P0],message_device_time:Math.floor(Date.now()/1e3)});case 4:case"end":return e.stop()}},e)})),O2.apply(this,arguments)}function T2(e){switch(e){case T0.NOTIFICATION_CLICKED:return"notification_open";case T0.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function I2(){return I2=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.data).isFirebaseMessaging){e.next=3;break}return e.abrupt("return");case 3:if(t.onMessageHandler&&r.messageType===T0.PUSH_RECEIVED&&("function"==typeof t.onMessageHandler?t.onMessageHandler(v2(r)):t.onMessageHandler.next(v2(r))),i=r.data,e.t0=p2(i)&&"1"===i[O0],!e.t0){e.next=9;break}return e.next=9,P2(t,r.messageType,i);case 9:case"end":return e.stop()}},e)})),I2.apply(this,arguments)}var A2="@firebase/messaging";function R2(){return(R2=SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,qB();case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",!1);case 8:return e.abrupt("return","undefined"!=typeof window&&ZB()&&WB()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"));case 9:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}Hz(new uz("messaging",function(e){var t=new m2(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",function(e){return function(e,t){return I2.apply(this,arguments)}(t,e)}),t},"PUBLIC")),Hz(new uz("messaging-internal",function(e){var t=e.getProvider("messaging").getImmediate();return{getToken:function(e){return function(e,t){return S2.apply(this,arguments)}(t,e)}}},"PRIVATE")),Yz(A2,"0.9.16"),Yz(A2,"0.9.16","esm2017");var M2="analytics",x2="firebase_id",N2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",D2="https://www.googletagmanager.com/gtag/js",L2=new mz("@firebase/analytics");function F2(e){return Promise.all(e.map(function(e){return e.catch(function(e){return e})}))}function U2(e,t){var n=document.createElement("script");n.src="".concat(D2,"?l=").concat(e,"&id=").concat(t),n.async=!0,document.head.appendChild(n)}function V2(e,t,n,r,i,a){return B2.apply(this,arguments)}function B2(){return B2=SB(regeneratorRuntime.mark(function e(t,n,r,i,a,o){var s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=i[a],e.prev=1,!s){e.next=7;break}return e.next=5,n[s];case 5:e.next=14;break;case 7:return e.next=9,F2(r);case 9:if(u=e.sent.find(function(e){return e.measurementId===a}),e.t0=u,!e.t0){e.next=14;break}return e.next=14,n[u.appId];case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(1),L2.error(e.t1);case 19:t("config",a,o);case 20:case"end":return e.stop()}},e,null,[[1,16]])})),B2.apply(this,arguments)}function z2(e,t,n,r,i){return H2.apply(this,arguments)}function H2(){return H2=SB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,u,c,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=[],!a||!a.send_to){e.next=26;break}return s=a.send_to,Array.isArray(s)||(s=[s]),e.next=7,F2(r);case 7:u=e.sent,c=uy(s),e.prev=9,f=function(){var e=l.value,t=u.find(function(t){return t.measurementId===e}),r=t&&n[t.appId];if(!r)return o=[],"break";o.push(r)},c.s();case 12:if((l=c.n()).done){e.next=18;break}if("break"!==f()){e.next=16;break}return e.abrupt("break",18);case 16:e.next=12;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(9),c.e(e.t0);case 23:return e.prev=23,c.f(),e.finish(23);case 26:return 0===o.length&&(o=Object.values(n)),e.next=29,Promise.all(o);case 29:t("event",i,a||{}),e.next=35;break;case 32:e.prev=32,e.t1=e.catch(0),L2.error(e.t1);case 35:case"end":return e.stop()}},e,null,[[0,32],[9,20,23,26]])})),H2.apply(this,arguments)}function G2(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(D2))return r}return null}var $2=new YB("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),Z2=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;fy(this,e),this.throttleMetadata=t,this.intervalMillis=n}return dy(e,[{key:"getThrottleMetadata",value:function(e){return this.throttleMetadata[e]}},{key:"setThrottleMetadata",value:function(e,t){this.throttleMetadata[e]=t}},{key:"deleteThrottleMetadata",value:function(e){delete this.throttleMetadata[e]}}]),e}());function q2(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function W2(e){return j2.apply(this,arguments)}function j2(){return j2=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appId,i=t.apiKey,a={method:"GET",headers:q2(i)},o=N2.replace("{app-id}",r),e.next=6,fetch(o,a);case 6:if(200===(s=e.sent).status||304===s.status){e.next=19;break}return u="",e.prev=9,e.next=12,s.json();case 12:c=e.sent,(null===(n=c.error)||void 0===n?void 0:n.message)&&(u=c.error.message),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(9);case 18:throw $2.create("config-fetch-failed",{httpStatus:s.status,responseMessage:u});case 19:return e.abrupt("return",s.json());case 20:case"end":return e.stop()}},e,null,[[9,16]])})),j2.apply(this,arguments)}function Y2(e){return K2.apply(this,arguments)}function K2(){return K2=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:Z2,r=l.length>2?l[2]:void 0,i=t.options,a=i.appId,o=i.apiKey,s=i.measurementId,a){e.next=5;break}throw $2.create("no-app-id");case 5:if(o){e.next=9;break}if(!s){e.next=8;break}return e.abrupt("return",{measurementId:s,appId:a});case 8:throw $2.create("no-api-key");case 9:return u=n.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new r3,e.abrupt("return",(setTimeout(SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c.abort();case 1:case"end":return e.stop()}},e)})),void 0!==r?r:6e4),Q2({appId:a,apiKey:o,measurementId:s},u,c,n)));case 11:case"end":return e.stop()}},e)})),K2.apply(this,arguments)}function Q2(e,t,n){return X2.apply(this,arguments)}function X2(){return X2=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d,v,p=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.throttleEndTimeMillis,a=n.backoffCount,o=p.length>3&&void 0!==p[3]?p[3]:Z2,c=t.appId,l=t.measurementId,e.prev=3,e.next=6,J2(r,i);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(3),!l){e.next=12;break}return e.abrupt("return",(L2.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null===(s=e.t0)||void 0===s?void 0:s.message,"]")),{appId:c,measurementId:l}));case 12:throw e.t0;case 13:return e.prev=13,e.next=16,W2(t);case 16:return f=e.sent,e.abrupt("return",(o.deleteThrottleMetadata(c),f));case 20:if(e.prev=20,e.t1=e.catch(13),e3(h=e.t1)){e.next=27;break}if(o.deleteThrottleMetadata(c),!l){e.next=26;break}return e.abrupt("return",(L2.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ".concat(l,' provided in the "measurementId" field in the local Firebase config. [').concat(null==h?void 0:h.message,"]")),{appId:c,measurementId:l}));case 26:throw e.t1;case 27:return d=503===Number(null===(u=null==h?void 0:h.customData)||void 0===u?void 0:u.httpStatus)?iz(a,o.intervalMillis,30):iz(a,o.intervalMillis),v={throttleEndTimeMillis:Date.now()+d,backoffCount:a+1},e.abrupt("return",(o.setThrottleMetadata(c,v),L2.debug("Calling attemptFetch again in ".concat(d," millis")),Q2(t,v,r,o)));case 29:case"end":return e.stop()}},e,null,[[3,8],[13,20]])})),X2.apply(this,arguments)}function J2(e,t){return new Promise(function(n,r){var i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(function(){clearTimeout(a),r($2.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function e3(e){if(!(e instanceof jB&&e.customData))return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}var t3,n3,r3=function(){function e(){fy(this,e),this.listeners=[]}return dy(e,[{key:"addEventListener",value:function(e){this.listeners.push(e)}},{key:"abort",value:function(){this.listeners.forEach(function(e){return e()})}}]),e}();function i3(){return i3=SB(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!a.global){e.next=4;break}t("event",r,i),e.next=8;break;case 4:return e.next=6,n;case 6:o=e.sent,t("event",r,Object.assign(Object.assign({},i),{send_to:o}));case 8:case"end":return e.stop()}},e)})),i3.apply(this,arguments)}function a3(e){n3=e}function o3(e){t3=e}function s3(){return u3.apply(this,arguments)}function u3(){return u3=SB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ZB()){e.next=2;break}return e.abrupt("return",(L2.warn($2.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1));case 2:return e.prev=2,e.next=5,qB();case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",(L2.warn($2.create("indexeddb-unavailable",{errorInfo:null===(t=e.t0)||void 0===t?void 0:t.toString()}).message),!1));case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,7]])})),u3.apply(this,arguments)}function c3(){return c3=SB(regeneratorRuntime.mark(function e(t,n,r,i,a,o,s){var u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(c=Y2(t)).then(function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&L2.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,") does not match the measurement ID fetched from the server (").concat(e.measurementId,"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config."))}).catch(function(e){return L2.error(e)}),n.push(c),l=s3().then(function(e){if(e)return i.getId()}),e.next=5,Promise.all([c,l]);case 5:return f=e.sent,h=qg(f,2),d=h[0],v=h[1],G2()||U2(o,d.measurementId),n3&&(a("consent","default",n3),a3(void 0)),a("js",new Date),p=null!==(u=null==s?void 0:s.config)&&void 0!==u?u:{},e.abrupt("return",(p.origin="firebase",p.update=!0,null!=v&&(p[x2]=v),a("config",d.measurementId,p),t3&&(a("set",t3),o3(void 0)),d.measurementId));case 12:case"end":return e.stop()}},e)})),c3.apply(this,arguments)}var l3,f3,h3=function(){function e(t){fy(this,e),this.app=t}return dy(e,[{key:"_delete",value:function(){return delete d3[this.app.options.appId],Promise.resolve()}}]),e}(),d3={},v3=[],p3={},g3="dataLayer",y3=!1;function m3(){return(m3=SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!HB()&&WB()&&ZB()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,qB();case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!1);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var k3="@firebase/analytics";Hz(new uz(M2,function(e,t){var n=t.options;return function(e,t,n){!function(){var e=[];if(HB()&&e.push("This is a browser extension environment."),WB()||e.push("Cookies are not available."),e.length>0){var t=e.map(function(e,t){return"(".concat(t+1,") ").concat(e)}).join(" "),n=$2.create("invalid-analytics-context",{errorInfo:t});L2.warn(n.message)}}();var r=e.options.appId;if(!r)throw $2.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw $2.create("no-api-key");L2.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '.concat(e.options.measurementId,' provided in the "measurementId" field in the local Firebase config.'))}if(null!=d3[r])throw $2.create("already-exists",{id:r});if(!y3){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(g3);var i=function(e,t,n,r,i){var a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(a=window[i]),window[i]=function(e,t,n,r){function i(){return(i=SB(regeneratorRuntime.mark(function i(a,o,s){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,"event"!==a){i.next=6;break}return i.next=4,z2(e,t,n,o,s);case 4:i.next=12;break;case 6:if("config"!==a){i.next=11;break}return i.next=9,V2(e,t,n,r,o,s);case 9:i.next=12;break;case 11:"consent"===a?e("consent","update",s):e("set",o);case 12:i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),L2.error(i.t0);case 17:case"end":return i.stop()}},i,null,[[0,14]])}))).apply(this,arguments)}return function(e,t,n){return i.apply(this,arguments)}}(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}(d3,v3,p3,g3,"gtag"),a=i.wrappedGtag,o=i.gtagCore;f3=a,l3=o,y3=!0}return d3[r]=function(e,t,n,r,i,a,o){return c3.apply(this,arguments)}(e,v3,p3,t,l3,g3,n),new h3(e)}(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),Hz(new uz("analytics-internal",function(e){try{var t=e.getProvider(M2).getImmediate();return{logEvent:function(e,n,r){return function(e,t,n,r){e=az(e),function(e,t,n,r,i){return i3.apply(this,arguments)}(f3,d3[e.app.options.appId],t,n,r).catch(function(e){return L2.error(e)})}(t,e,n,r)}}}catch(t){throw $2.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),Yz(k3,"0.8.0"),Yz(k3,"0.8.0","esm2017");var C3=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this)}return dy(n,[{key:"schedule",value:function(e){return this}}]),n}(hy),w3={setInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=w3.delegate;return((null==e?void 0:e.setInterval)||setInterval).apply(void 0,arguments)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=w3.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)}),delegate:void 0},_3=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i.pending=!1,i}return dy(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return w3.setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!=n&&this.delay===n&&!1===this.pending)return t;w3.clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,r=!1;try{this.work(e)}catch(i){r=!0,n=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n}},{key:"unsubscribe",value:function(){if(!this.closed){var e=this.id,t=this.scheduler,r=t.actions;this.work=this.state=this.scheduler=null,this.pending=!1,ly(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,Qg(ay(n.prototype),"unsubscribe",this).call(this)}}}]),n}(C3),E3={now:function(){return(E3.delegate||Date).now()},delegate:void 0},b3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;fy(this,e),this.schedulerActionCtor=t,this.now=n}return dy(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.schedulerActionCtor(this,e).schedule(n,t)}}]),e}();b3.now=E3.now;var S3=function(e){Jg(n,e);var t=ty(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b3.now;return fy(this,n),(r=t.call(this,e,i)).actions=[],r._active=!1,r._scheduled=void 0,r}return dy(n,[{key:"flush",value:function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(b3),P3=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n)}(S3))(function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,r)).scheduler=e,i.work=r,i}return dy(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?Qg(ay(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?Qg(ay(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!=r&&r>0||null==r&&this.delay>0?Qg(ay(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(_3)),O3=new S3(_3),T3=new NO("7.4.1"),I3="__angularfire_symbol__analyticsIsSupportedValue",A3="__angularfire_symbol__analyticsIsSupported",R3="__angularfire_symbol__remoteConfigIsSupportedValue",M3="__angularfire_symbol__remoteConfigIsSupported",x3="__angularfire_symbol__messagingIsSupportedValue",N3="__angularfire_symbol__messagingIsSupported";function D3(e,t,n){if(t){if(1===t.length)return t[0];var r=t.filter(function(e){return e.app===n});if(1===r.length)return r[0]}return n.container.getProvider(e).getImmediate({optional:!0})}globalThis[A3]||(globalThis[A3]=function(){return m3.apply(this,arguments)}().then(function(e){return globalThis[I3]=e}).catch(function(){return globalThis[I3]=!1})),globalThis[N3]||(globalThis[N3]=function(){return R2.apply(this,arguments)}().then(function(e){return globalThis[x3]=e}).catch(function(){return globalThis[x3]=!1})),globalThis[M3]||(globalThis[M3]=function(){return C0.apply(this,arguments)}().then(function(e){return globalThis[R3]=e}).catch(function(){return globalThis[R3]=!1}));var L3=function(e,t){var n=t?[t]:jz(),r=[];return n.forEach(function(t){t.container.getProvider(e).instances.forEach(function(e){r.includes(e)||r.push(e)})}),r};function F3(){}var U3=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P3;fy(this,e),this.zone=t,this.delegate=n}return dy(e,[{key:"now",value:function(){return this.delegate.now()}},{key:"schedule",value:function(e,t,n){var r=this.zone;return this.delegate.schedule(function(t){var n=this;r.runGuarded(function(){e.apply(n,[t])})},t,n)}}]),e}(),V3=function(){function e(t){fy(this,e),this.zone=t,this.task=null}return dy(e,[{key:"call",value:function(e,t){var n=this.unscheduleTask.bind(this);return this.task=this.zone.run(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",F3,{},F3,F3)}),t.pipe(UN({next:n,complete:n,error:n})).subscribe(e).add(n)}},{key:"unscheduleTask",value:function(){var e=this;setTimeout(function(){null!=e.task&&"scheduled"===e.task.state&&(e.task.invoke(),e.task=null)},10)}}]),e}(),B3=function(){var e=dy(function e(t){fy(this,e),this.ngZone=t,this.outsideAngular=t.runOutsideAngular(function(){return new U3(Zone.current)}),this.insideAngular=t.run(function(){return new U3(Zone.current,O3)}),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)});return e.\u0275fac=function(t){return new(t||e)(Dw(CI))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function z3(){var e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return e}function H3(e){return z3().ngZone.runOutsideAngular(function(){return e()})}function G3(e){return z3().ngZone.run(function(){return e()})}function $3(e){return z3(),function(e){return function(t){return(t=t.lift(new V3(e.ngZone))).pipe(pm(e.outsideAngular),vm(e.insideAngular))}}(z3())(e)}var Z3=function(e,t){var n=void 0;return function(){var r=arguments;return t&&setTimeout(function(){"scheduled"===t.state&&t.invoke()},10),G3(function(){return e.apply(n,r)})}},q3=function(e,t){return function(){for(var n,r=this,i=arguments,a=0;a<arguments.length;a++)"function"==typeof i[a]&&(t&&(n||(n=G3(function(){return Zone.current.scheduleMacroTask("firebaseZoneBlock",F3,{},F3,F3)}))),i[a]=Z3(i[a],n));var o=H3(function(){return e.apply(r,i)});if(!t){if(o instanceof Fy){var s=z3();return o.pipe(pm(s.outsideAngular),vm(s.insideAngular))}return G3(function(){return o})}return o instanceof Fy?o.pipe($3):o instanceof Promise?G3(function(){return new Promise(function(e,t){return o.then(function(t){return G3(function(){return e(t)})},function(e){return G3(function(){return t(e)})})})}):"function"==typeof o&&n?function(){return setTimeout(function(){n&&"scheduled"===n.state&&n.invoke()},10),o.apply(this,arguments)}:G3(function(){return o})}},W3=dy(function e(t){return fy(this,e),t}),j3=dy(function e(){return fy(this,e),jz()}),Y3=new pw("angularfire2._apps"),K3={provide:W3,useFactory:function(e){return e&&1===e.length?e[0]:new W3(Wz())},deps:[[new Gw,Y3]]},Q3={provide:j3,deps:[[new Gw,Y3]]};function X3(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new W3(r)}}var J3=function(){var e=dy(function e(t){fy(this,e),Yz("angularfire",T3.full,"core"),Yz("angularfire",T3.full,"app"),Yz("angular",DO.full,t.toString())});return e.\u0275fac=function(t){return new(t||e)(Dw(aI))},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:[K3,Q3]}),e}(),e4=q3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"!=typeof t&&(t={name:t});var n=Object.assign({name:Fz,automaticDataCollectionEnabled:!1},t),r=n.name;if("string"!=typeof r||!r)throw $z.create("bad-app-name",{appName:String(r)});var i=Vz.get(r);if(i){if(QB(e,i.options)&&QB(n,i.config))return i;throw $z.create("duplicate-app",{appName:r})}var a,o=new fz(r),s=uy(Bz.values());try{for(s.s();!(a=s.n()).done;){var u=a.value;o.addComponent(u)}}catch(l){s.e(l)}finally{s.f()}var c=new Zz(e,n,o);return Vz.set(r,c),c},!0),t4=new Map,n4={activated:!1,tokenObservers:[]},r4={initialized:!1,enabled:!1};function i4(e){return t4.get(e)||n4}function a4(e,t){t4.set(e,t)}function o4(){return r4}var s4=function(){function e(t,n,r,i,a){if(fy(this,e),this.operation=t,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}return dy(e,[{key:"start",value:function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(function(){})}},{key:"stop",value:function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}},{key:"isRunning",value:function(){return!!this.pending}},{key:"process",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.stop(),n.prev=1,t.pending=new VB,n.next=5,function(e){return new Promise(function(t){setTimeout(t,e)})}(t.getNextRun(e));case 5:return t.pending.resolve(),n.next=8,t.pending.promise;case 8:return t.pending=new VB,n.next=11,t.operation();case 11:return t.pending.resolve(),n.next=14,t.pending.promise;case 14:t.process(!0).catch(function(){}),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(1),t.retryPolicy(n.t0)?t.process(!1).catch(function(){}):t.stop();case 20:case"end":return n.stop()}},n,null,[[1,17]])}))()}},{key:"getNextRun",value:function(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}]),e}(),u4=new YB("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function c4(e){if(!i4(e).activated)throw u4.create("use-before-activation",{appName:e.name})}function l4(e,t){return f4.apply(this,arguments)}function f4(){return f4=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l,f,h,d,v,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,i=t.body,s={"Content-Type":"application/json"},!(u=n.getImmediate({optional:!0}))){e.next=7;break}return e.next=5,u.getHeartbeatsHeader();case 5:(c=e.sent)&&(s["X-Firebase-Client"]=c);case 7:return l={method:"POST",body:JSON.stringify(i),headers:s},e.prev=8,e.next=11,fetch(r,l);case 11:f=e.sent,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(8),u4.create("fetch-network-error",{originalErrorMessage:null===(a=e.t0)||void 0===a?void 0:a.message});case 17:if(200===f.status){e.next=19;break}throw u4.create("fetch-status-error",{httpStatus:f.status});case 19:return e.prev=19,e.next=22,f.json();case 22:h=e.sent,e.next=28;break;case 25:throw e.prev=25,e.t1=e.catch(19),u4.create("fetch-parse-error",{originalErrorMessage:null===(o=e.t1)||void 0===o?void 0:o.message});case 28:if((d=h.ttl.match(/^([\d.]+)(s)$/))&&d[2]&&!isNaN(Number(d[1]))){e.next=31;break}throw u4.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: ".concat(h.ttl)});case 31:return v=1e3*Number(d[1]),p=Date.now(),e.abrupt("return",{token:h.token,expireTimeMillis:p+v,issuedAtTimeMillis:p});case 33:case"end":return e.stop()}},e,null,[[8,14],[19,25]])})),f4.apply(this,arguments)}function h4(e,t){var n=e.options,r=n.projectId,i=n.appId,a=n.apiKey;return{url:"https://content-firebaseappcheck.googleapis.com/v1/projects/".concat(r,"/apps/").concat(i,":exchangeDebugToken?key=").concat(a),body:{debug_token:t}}}var d4="firebase-app-check-store",v4=null;function p4(){return v4||(v4=new Promise(function(e,t){var n;try{var r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){var n;t(u4.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},r.onupgradeneeded=function(e){0===e.oldVersion&&e.target.result.createObjectStore(d4,{keyPath:"compositeKey"})}}catch(r){t(u4.create("storage-open",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message}))}}),v4)}function g4(){return g4=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p4();case 2:return r=e.sent.transaction(d4,"readwrite"),i=r.objectStore(d4).put({compositeKey:t,value:n}),e.abrupt("return",new Promise(function(e,t){i.onsuccess=function(t){e()},r.onerror=function(e){var n;t(u4.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}));case 5:case"end":return e.stop()}},e)})),g4.apply(this,arguments)}var y4=new mz("@firebase/app-check");function m4(e,t){return ZB()?function(e,t){return function(e,t){return g4.apply(this,arguments)}(function(e){return"".concat(e.options.appId,"-").concat(e.name)}(e),t)}(e,t).catch(function(e){y4.warn("Failed to write token to IndexedDB. Error: ".concat(e))}):Promise.resolve()}function k4(){return o4().enabled}function C4(){return w4.apply(this,arguments)}function w4(){return w4=SB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=o4()).enabled||!t.token){e.next=3;break}return e.abrupt("return",t.token.promise);case 3:throw Error("\n            Can't get debug token in production mode.\n        ");case 4:case"end":return e.stop()}},e)})),w4.apply(this,arguments)}var _4={error:"UNKNOWN_ERROR"};function E4(e){return FB.encodeString(JSON.stringify(e),!1)}function b4(e){return S4.apply(this,arguments)}function S4(){return S4=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l,f=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]&&f[1],c4(r=t.app),i=i4(r),o=i.token){e.next=10;break}return e.next=8,i.cachedTokenPromise;case 8:(s=e.sent)&&I4(s)&&(o=s);case 10:if(n||!o||!I4(o)){e.next=12;break}return e.abrupt("return",{token:o.token});case 12:if(c=!1,!k4()){e.next=33;break}if(e.t0=i.exchangeTokenPromise,e.t0){e.next=26;break}return e.t1=l4,e.t2=h4,e.t3=r,e.next=21,C4();case 21:e.t4=e.sent,e.t5=(0,e.t2)(e.t3,e.t4),e.t6=t.heartbeatServiceProvider,i.exchangeTokenPromise=(0,e.t1)(e.t5,e.t6).then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0;case 26:return e.next=28,i.exchangeTokenPromise;case 28:return l=e.sent,e.next=31,m4(r,l);case 31:return a4(r,Object.assign(Object.assign({},i),{token:l})),e.abrupt("return",{token:l.token});case 33:return e.prev=33,i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().then(function(e){return i.exchangeTokenPromise=void 0,e}),c=!0),e.next=37,i.exchangeTokenPromise;case 37:o=e.sent,e.next=43;break;case 40:e.prev=40,e.t7=e.catch(33),"appCheck/throttled"===e.t7.code?y4.warn(e.t7.message):y4.error(e.t7),a=e.t7;case 43:if(!o){e.next=50;break}return u={token:o.token},a4(r,Object.assign(Object.assign({},i),{token:o})),e.next=48,m4(r,o);case 48:e.next=51;break;case 50:u=A4(a);case 51:return c&&T4(r,u),e.abrupt("return",u);case 53:case"end":return e.stop()}},e,null,[[33,40]])})),S4.apply(this,arguments)}function P4(e,t){var n=i4(e),r=n.tokenObservers.filter(function(e){return e.next!==t});0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),a4(e,Object.assign(Object.assign({},n),{tokenObservers:r}))}function O4(e){var t=e.app,n=i4(t),r=n.tokenRefresher;r||(r=function(e){var t=e.app;return new s4(SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!i4(t).token){n.next=6;break}return n.next=3,b4(e,!0);case 3:n.t0=n.sent,n.next=9;break;case 6:return n.next=8,b4(e);case 8:n.t0=n.sent;case 9:if(!(r=n.t0).error){n.next=12;break}throw r.error;case 12:case"end":return n.stop()}},n)})),function(){return!0},function(){var e=i4(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,e.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(e),a4(t,Object.assign(Object.assign({},n),{tokenRefresher:r}))),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function T4(e,t){var n,r=uy(i4(e).tokenObservers);try{for(r.s();!(n=r.n()).done;){var i=n.value;try{"EXTERNAL"===i.type&&null!=t.error?i.error(t.error):i.next(t)}catch(a){}}}catch(o){r.e(o)}finally{r.f()}}function I4(e){return e.expireTimeMillis-Date.now()>0}function A4(e){return{token:E4(_4),error:e}}var R4=function(){function e(t,n){fy(this,e),this.app=t,this.heartbeatServiceProvider=n}return dy(e,[{key:"_delete",value:function(){var e,t=uy(i4(this.app).tokenObservers);try{for(t.s();!(e=t.n()).done;){var n=e.value;P4(this.app,n.next)}}catch(r){t.e(r)}finally{t.f()}return Promise.resolve()}}]),e}(),M4="app-check-internal";Hz(new uz("app-check",function(e){return function(e,t){return new R4(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider(M4).initialize()})),Hz(new uz(M4,function(e){return function(e){return{getToken:function(t){return b4(e,t)},addTokenListener:function(t){return function(e,t,n,r){var i=e.app,a=i4(i),o={next:n,error:void 0,type:"INTERNAL"};if(a4(i,Object.assign(Object.assign({},a),{tokenObservers:[].concat(oy(a.tokenObservers),[o])})),a.token&&I4(a.token)){var s=a.token;Promise.resolve().then(function(){n({token:s.token}),O4(e)}).catch(function(){})}a.cachedTokenPromise.then(function(){return O4(e)})}(e,0,t)},removeTokenListener:function(t){return P4(e.app,t)}}}(e.getProvider("app-check").getImmediate())},"PUBLIC").setInstantiationMode("EXPLICIT")),Yz("@firebase/app-check","0.5.11");var x4=dy(function e(){return fy(this,e),L3("app-check")});"undefined"!=typeof window&&window;var N4=new YB("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),D4=new mz("@firebase/auth");function L4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];D4.logLevel<=dz.ERROR&&D4.error.apply(D4,["Auth (9.9.0): ".concat(e)].concat(n))}function F4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw z4.apply(void 0,[e].concat(n))}function U4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return z4.apply(void 0,[e].concat(n))}function V4(e,t,n){var r=Object.assign(Object.assign({},{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Zg({},t,n));return new YB("auth","Firebase",r).create(t,{appName:e.name})}function B4(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&F4(e,"argument-error"),V4(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.Did you pass a reference from a different Auth SDK?"))}function z4(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!=typeof e){var i,a=n[0],o=oy(n.slice(1));return o[0]&&(o[0].appName=e.name),(i=e._errorFactory).create.apply(i,[a].concat(oy(o)))}return N4.create.apply(N4,[e].concat(n))}function H4(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e)throw z4.apply(void 0,[t].concat(r))}function G4(e){var t="INTERNAL ASSERTION FAILED: "+e;throw L4(t),new Error(t)}function $4(e,t){e||G4(t)}var Z4=new Map;function q4(e){$4(e instanceof Function,"Expected a class definition");var t=Z4.get(e);return t?($4(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Z4.set(e,t),t)}function W4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function j4(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var Y4=function(){function e(t,n){fy(this,e),this.shortDelay=t,this.longDelay=n,$4(n>t,"Short delay should be less than long delay!"),this.isMobile=zB()||GB()}return dy(e,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===j4()||"https:"===j4()||HB()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function K4(e,t){$4(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var Q4=function(){function e(){fy(this,e)}return dy(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void G4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void G4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void G4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),X4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},J4=new Y4(3e4,6e4);function e5(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function t5(e,t,n,r){return n5.apply(this,arguments)}function n5(){return n5=SB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",r5(t,a,SB(regeneratorRuntime.mark(function e(){var a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={},o={},i&&("GET"===n?o=i:a={body:JSON.stringify(i)}),s=JB(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=5,t._getAdditionalHeaders();case 5:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),Q4.fetch()(s5(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},a))));case 7:case"end":return e.stop()}},e)}))));case 2:case"end":return e.stop()}},e)})),n5.apply(this,arguments)}function r5(e,t,n){return i5.apply(this,arguments)}function i5(){return i5=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,u,c,l,f,h,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},X4),n),e.prev=2,a=new u5(t),e.next=6,Promise.race([r(),a.promise]);case 6:return o=e.sent,a.clearNetworkTimeout(),e.next=10,o.json();case 10:if(!("needConfirmation"in(s=e.sent))){e.next=13;break}throw c5(t,"account-exists-with-different-credential",s);case 13:if(!o.ok||"errorMessage"in s){e.next=15;break}return e.abrupt("return",s);case 15:if(u=o.ok?s.errorMessage:s.error.message,c=u.split(" : "),l=qg(c,2),f=l[0],h=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==f){e.next=18;break}throw c5(t,"credential-already-in-use",s);case 18:if("EMAIL_EXISTS"!==f){e.next=20;break}throw c5(t,"email-already-in-use",s);case 20:if("USER_DISABLED"!==f){e.next=22;break}throw c5(t,"user-disabled",s);case 22:if(d=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-"),!h){e.next=25;break}throw V4(t,d,h);case 25:F4(t,d),e.next=33;break;case 28:if(e.prev=28,e.t0=e.catch(2),!(e.t0 instanceof jB)){e.next=32;break}throw e.t0;case 32:F4(t,"network-request-failed");case 33:case"end":return e.stop()}},e,null,[[2,28]])})),i5.apply(this,arguments)}function a5(e,t,n,r){return o5.apply(this,arguments)}function o5(){return o5=SB(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,t5(t,n,r,i,a);case 3:return o=e.sent,e.abrupt("return",("mfaPendingCredential"in o&&F4(t,"multi-factor-auth-required",{_serverResponse:o}),o));case 5:case"end":return e.stop()}},e)})),o5.apply(this,arguments)}function s5(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?K4(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var u5=function(){function e(t){var n=this;fy(this,e),this.auth=t,this.timer=null,this.promise=new Promise(function(e,t){n.timer=setTimeout(function(){return t(U4(n.auth,"network-request-failed"))},J4.get())})}return dy(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function c5(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=U4(e,t,r);return i.customData._tokenResponse=n,i}function l5(){return l5=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t5(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}},e)})),l5.apply(this,arguments)}function f5(e,t){return h5.apply(this,arguments)}function h5(){return h5=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t5(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}},e)})),h5.apply(this,arguments)}function d5(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(n){}}function v5(){return v5=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=az(t),e.next=4,r.getIdToken(n);case 4:return i=e.sent,H4((a=g5(i))&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error"),o="object"==typeof a.firebase?a.firebase:void 0,s=null==o?void 0:o.sign_in_provider,e.abrupt("return",{claims:a,token:i,authTime:d5(p5(a.auth_time)),issuedAtTime:d5(p5(a.iat)),expirationTime:d5(p5(a.exp)),signInProvider:s||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null});case 9:case"end":return e.stop()}},e)})),v5.apply(this,arguments)}function p5(e){return 1e3*Number(e)}function g5(e){var t,n=qg(e.split("."),3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return L4("JWT malformed, contained fewer than 3 sections"),null;try{var o=function(e){try{return FB.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(i);return o?JSON.parse(o):(L4("Failed to decode base64 JWT payload"),null)}catch(s){return L4("Caught error parsing JWT payload as JSON",null===(t=s)||void 0===t?void 0:t.toString()),null}}function y5(e,t){return m5.apply(this,arguments)}function m5(){return m5=SB(regeneratorRuntime.mark(function e(t,n){var r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),e.t1=e.t0 instanceof jB&&k5(e.t0)&&t.auth.currentUser===t,!e.t1){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}},e,null,[[3,9]])})),m5.apply(this,arguments)}function k5(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}var C5=function(){function e(t){fy(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return dy(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(this.isRunning){var n=this.getInterval(e);this.timerId=setTimeout(SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.iteration();case 2:case"end":return e.stop()}},e)})),n)}}},{key:"iteration",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.user.getIdToken(!0);case 3:t.next=8;break;case 5:return t.prev=5,t.t0=t.catch(0),t.abrupt("return",void("auth/network-request-failed"===(null===(n=t.t0)||void 0===n?void 0:n.code)&&e.schedule(!0)));case 8:e.schedule();case 9:case"end":return t.stop()}},t,null,[[0,5]])}))()}}]),e}(),w5=function(){function e(t,n){fy(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return dy(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=d5(this.lastLoginAt),this.creationTime=d5(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function _5(e){return E5.apply(this,arguments)}function E5(){return E5=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return i=e.sent,e.next=6,y5(t,f5(r,{idToken:i}));case 6:H4(null==(a=e.sent)?void 0:a.users.length,r,"internal-error"),o=a.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?P5(o.providerUserInfo):[],u=S5(t.providerData,s),c=!!t.isAnonymous&&!(t.email&&o.passwordHash||(null==u?void 0:u.length)),l={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new w5(o.createdAt,o.lastLoginAt),isAnonymous:c},Object.assign(t,l);case 12:case"end":return e.stop()}},e)})),E5.apply(this,arguments)}function b5(){return b5=SB(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=az(t),e.next=3,_5(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}},e)})),b5.apply(this,arguments)}function S5(e,t){return[].concat(oy(e.filter(function(e){return!t.some(function(t){return t.providerId===e.providerId})})),oy(t))}function P5(e){return e.map(function(e){var t=e.providerId,n=qy(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function O5(){return O5=SB(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r5(t,{},SB(regeneratorRuntime.mark(function e(){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=JB({grant_type:"refresh_token",refresh_token:n}).slice(1),i=t.config,a=i.tokenApiHost,o=i.apiKey,s=s5(t,a,"/v1/token","key=".concat(o)),e.next=7,t._getAdditionalHeaders();case 7:return u=e.sent,e.abrupt("return",(u["Content-Type"]="application/x-www-form-urlencoded",Q4.fetch()(s,{method:"POST",headers:u,body:r})));case 9:case"end":return e.stop()}},e)})));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}},e)})),O5.apply(this,arguments)}var T5=function(){function e(){fy(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return dy(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){H4(e.idToken,"internal-error"),H4(void 0!==e.idToken,"internal-error"),H4(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){var t=g5(e);return H4(t,"internal-error"),H4(void 0!==t.exp,"internal-error"),H4(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(H4(!n.accessToken||n.refreshToken,e,"user-token-expired"),!t&&n.accessToken&&!n.isExpired){r.next=12;break}if(!n.refreshToken){r.next=8;break}return r.next=5,n.refresh(e,n.refreshToken);case 5:r.t1=n.accessToken,r.next=9;break;case 8:r.t1=null;case 9:r.t0=r.t1,r.next=13;break;case 12:r.t0=n.accessToken;case 13:return r.abrupt("return",r.t0);case 14:case"end":return r.stop()}},r)}))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){return O5.apply(this,arguments)}(e,t);case 2:i=r.sent,a=i.accessToken,o=i.refreshToken,s=i.expiresIn,n.updateTokensAndExpiration(a,o,Number(s));case 7:case"end":return r.stop()}},r)}))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return G4("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new e;return r&&(H4("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),i&&(H4("string"==typeof i,"internal-error",{appName:t}),o.accessToken=i),a&&(H4("number"==typeof a,"internal-error",{appName:t}),o.expirationTime=a),o}}]),e}();function I5(e,t){H4("string"==typeof e||void 0===e,"internal-error",{appName:t})}var A5=function(){function e(t){fy(this,e);var n=t.uid,r=t.auth,i=t.stsTokenManager,a=qy(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new C5(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?oy(a.providerData):[],this.metadata=new w5(a.createdAt||void 0,a.lastLoginAt||void 0)}return dy(e,[{key:"getIdToken",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,y5(t,t.stsTokenManager.getToken(t.auth,e));case 2:if(H4(r=n.sent,t.auth,"internal-error"),n.t0=t.accessToken!==r,!n.t0){n.next=10;break}return t.accessToken=r,n.next=9,t.auth._persistUserIfCurrent(t);case 9:t.auth._notifyListenersIfCurrent(t);case 10:return n.abrupt("return",r);case 11:case"end":return n.stop()}},n)}))()}},{key:"getIdTokenResult",value:function(e){return function(e){return v5.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return b5.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(H4(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(function(e){return Object.assign({},e)}),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){H4(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=!1,e.idToken&&e.idToken!==n.stsTokenManager.accessToken&&(n.stsTokenManager.updateFromServerResponse(e),i=!0),r.t0=t,!r.t0){r.next=6;break}return r.next=6,_5(n);case 6:return r.next=8,n.auth._persistUserIfCurrent(n);case 8:i&&n.auth._notifyListenersIfCurrent(n);case 9:case"end":return r.stop()}},r)}))()}},{key:"delete",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getIdToken();case 2:return n=t.sent,t.next=5,y5(e,function(e,t){return l5.apply(this,arguments)}(e.auth,{idToken:n}));case 5:return e.stsTokenManager.clearRefreshToken(),t.abrupt("return",e.auth.signOut());case 7:case"end":return t.stop()}},t)}))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(function(e){return Object.assign({},e)}),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,i,a,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(s=n.tenantId)&&void 0!==s?s:void 0,g=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,m=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,C=n.emailVerified,w=n.isAnonymous,_=n.providerData,E=n.stsTokenManager;H4(k&&E,t,"internal-error");var b=T5.fromJSON(this.name,E);H4("string"==typeof k,t,"internal-error"),I5(f,t.name),I5(h,t.name),H4("boolean"==typeof C,t,"internal-error"),H4("boolean"==typeof w,t,"internal-error"),I5(d,t.name),I5(v,t.name),I5(p,t.name),I5(g,t.name),I5(y,t.name),I5(m,t.name);var S=new e({uid:k,auth:t,email:h,emailVerified:C,displayName:f,isAnonymous:w,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:b,createdAt:y,lastLoginAt:m});return _&&Array.isArray(_)&&(S.providerData=_.map(function(e){return Object.assign({},e)})),g&&(S._redirectEventId=g),S}},{key:"_fromIdTokenResponse",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return SB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return(a=new T5).updateFromServerResponse(n),o=new e({uid:n.localId,auth:t,stsTokenManager:a,isAnonymous:r}),i.next=5,_5(o);case 5:return i.abrupt("return",o);case 6:case"end":return i.stop()}},i)}))()}}]),e}(),R5=function(){var e=function(){function e(){fy(this,e),this.type="NONE",this.storage={}}return dy(e,[{key:"_isAvailable",value:function(){return SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}},e)}))()}},{key:"_set",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n.storage[e]=t;case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.storage[e],n.abrupt("return",void 0===r?null:r);case 2:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:delete t.storage[e];case 1:case"end":return n.stop()}},n)}))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();return e.type="NONE",e}();function M5(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var x5=function(){function e(t,n,r){fy(this,e),this.persistence=t,this.auth=n,this.userKey=r;var i=this.auth,a=i.config,o=i.name;this.fullUserKey=M5(this.userKey,a.apiKey,o),this.fullPersistenceKey=M5("persistence",a.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return dy(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.persistence._get(e.fullUserKey);case 2:return n=t.sent,t.abrupt("return",n?A5._fromJSON(e.auth,n):null);case 4:case"end":return t.stop()}},t)}))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.persistence!==e){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.getCurrentUser();case 4:return r=n.sent,n.next=7,t.removeCurrentUser();case 7:return t.persistence=e,n.abrupt("return",r?t.setCurrentUser(r):void 0);case 9:case"end":return n.stop()}},n)}))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return SB(regeneratorRuntime.mark(function i(){var a,o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n.length){i.next=2;break}return i.abrupt("return",new e(q4(R5),t,r));case 2:return i.next=4,Promise.all(n.map(function(){var e=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:a=i.sent.filter(function(e){return e}),o=a[0]||q4(R5),s=M5(r,t.config.apiKey,t.name),u=null,c=uy(n),i.prev=9,c.s();case 11:if((l=c.n()).done){i.next=27;break}return f=l.value,i.prev=13,i.next=16,f._get(s);case 16:if(!(h=i.sent)){i.next=21;break}return d=A5._fromJSON(t,h),f!==o&&(u=d),o=f,i.abrupt("break",27);case 21:i.next=25;break;case 23:i.prev=23,i.t0=i.catch(13);case 25:i.next=11;break;case 27:i.next=32;break;case 29:i.prev=29,i.t1=i.catch(9),c.e(i.t1);case 32:return i.prev=32,c.f(),i.finish(32);case 35:if(v=a.filter(function(e){return e._shouldAllowMigration}),!o._shouldAllowMigration||!v.length){i.next=47;break}if(o=v[0],i.t3=u,!i.t3){i.next=42;break}return i.next=42,o._set(s,u.toJSON());case 42:return i.next=44,Promise.all(n.map(function(){var e=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}},e,null,[[1,6]])}));return function(t){return e.apply(this,arguments)}}()));case 44:i.t2=new e(o,t,r),i.next=48;break;case 47:i.t2=new e(o,t,r);case 48:return i.abrupt("return",i.t2);case 49:case"end":return i.stop()}},i,null,[[9,29,32,35],[13,23]])}))()}}]),e}();function N5(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(U5(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(D5(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(B5(t))return"Blackberry";if(z5(t))return"Webos";if(L5(t))return"Safari";if((t.includes("chrome/")||F5(t))&&!t.includes("edge/"))return"Chrome";if(V5(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function D5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return/firefox\//i.test(e)}function L5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function F5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return/crios\//i.test(e)}function U5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return/iemobile/i.test(e)}function V5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return/android/i.test(e)}function B5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return/blackberry/i.test(e)}function z5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return/webos/i.test(e)}function H5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function G5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return H5(e)||V5(e)||z5(e)||B5(e)||/windows phone/i.test(e)||U5(e)}function $5(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=N5(BB());break;case"Worker":t="".concat(N5(BB()),"-").concat(e);break;default:t=e}return"".concat(t,"/JsCore/9.9.0/").concat(n.length?n.join(","):"FirebaseCore-web")}var Z5=function(){function e(t){fy(this,e),this.auth=t,this.queue=[]}return dy(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise(function(n,r){try{n(e(t))}catch(i){r(i)}})};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.auth.currentUser!==e){n.next=2;break}return n.abrupt("return");case 2:i=[],n.prev=3,a=uy(t.queue),n.prev=5,a.s();case 7:if((o=a.n()).done){n.next=14;break}return s=o.value,n.next=11,s(e);case 11:s.onAbort&&i.push(s.onAbort);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:n.next=30;break;case 24:n.prev=24,n.t1=n.catch(3),i.reverse(),u=uy(i);try{for(u.s();!(c=u.n()).done;){l=c.value;try{l()}catch(f){}}}catch(h){u.e(h)}finally{u.f()}throw t.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=n.t1)||void 0===r?void 0:r.message});case 30:case"end":return n.stop()}},n,null,[[3,24],[5,16,19,22]])}))()}}]),e}(),q5=function(){function e(t,n,r){fy(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new j5(this),this.idTokenSubscription=new j5(this),this.beforeStateQueue=new Z5(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=N4,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return dy(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=q4(t)),this._initializationPromise=this.queue(SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!n._deleted,!r.t0){r.next=6;break}return r.next=4,x5.create(n,e);case 4:n.persistenceManager=r.sent,r.t0=!n._deleted;case 6:if(!r.t0){r.next=19;break}if(!(null===(i=n._popupRedirectResolver)||void 0===i?void 0:i._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t1=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:n.lastNotifiedUid=(null===(a=n.currentUser)||void 0===a?void 0:a.uid)||null,!n._deleted&&(n._isInitialized=!0);case 19:case"end":return r.stop()}},r,null,[[8,13]])}))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e._deleted){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.assertedPersistence.getCurrentUser();case 4:if(n=t.sent,!e.currentUser&&!n){t.next=13;break}if(!e.currentUser||!n||e.currentUser.uid!==n.uid){t.next=11;break}return e._currentUser._assign(n),t.next=10,e.currentUser.getIdToken();case 10:return t.abrupt("return",void t.sent);case 11:return t.next=13,e._updateCurrentUser(n,!0);case 13:case"end":return t.stop()}},t)}))()}},{key:"initializeCurrentUser",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.getCurrentUser();case 2:if(i=n.sent,a=i,o=!1,!e||!t.config.authDomain){n.next=13;break}return n.next=7,t.getOrInitRedirectPersistenceManager();case 7:return s=null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId,u=null==a?void 0:a._redirectEventId,n.next=11,t.tryRedirectSignIn(e);case 11:c=n.sent,(!s||s===u)&&(null==c?void 0:c.user)&&(a=c.user,o=!0);case 13:if(a){n.next=15;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 15:if(a._redirectEventId){n.next=26;break}if(!o){n.next=25;break}return n.prev=17,n.next=20,t.beforeStateQueue.runMiddleware(a);case 20:n.next=25;break;case 22:n.prev=22,n.t0=n.catch(17),a=i,t._popupRedirectResolver._overrideRedirectResult(t,function(){return Promise.reject(n.t0)});case 25:return n.abrupt("return",a?t.reloadAndSetCurrentUserOrClear(a):t.directlySetCurrentUser(null));case 26:return H4(t._popupRedirectResolver,t,"argument-error"),n.next=29,t.getOrInitRedirectPersistenceManager();case 29:return n.abrupt("return",t.redirectUser&&t.redirectUser._redirectEventId===a._redirectEventId?t.directlySetCurrentUser(a):t.reloadAndSetCurrentUserOrClear(a));case 30:case"end":return n.stop()}},n,null,[[17,22]])}))()}},{key:"tryRedirectSignIn",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=null,n.prev=1,n.next=4,t._popupRedirectResolver._completeRedirectFn(t,e,!0);case 4:r=n.sent,n.next=11;break;case 7:return n.prev=7,n.t0=n.catch(1),n.next=11,t._setRedirectUser(null);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}},n,null,[[1,7]])}))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_5(e);case 3:n.next=9;break;case 5:if(n.prev=5,n.t0=n.catch(0),"auth/network-request-failed"===(null===(r=n.t0)||void 0===r?void 0:r.code)){n.next=9;break}return n.abrupt("return",t.directlySetCurrentUser(null));case 9:return n.abrupt("return",t.directlySetCurrentUser(e));case 10:case"end":return n.stop()}},n,null,[[0,5]])}))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e._deleted=!0;case 1:case"end":return t.stop()}},t)}))()}},{key:"updateCurrentUser",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=e?az(e):null,n.abrupt("return",(r&&H4(r.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(r&&r._clone(t))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_updateCurrentUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n._deleted){r.next=7;break}if(e&&H4(n.tenantId===e.tenantId,n,"tenant-id-mismatch"),r.t0=t,r.t0){r.next=6;break}return r.next=6,n.beforeStateQueue.runMiddleware(e);case 6:return r.abrupt("return",n.queue(SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.directlySetCurrentUser(e);case 2:n.notifyAuthListeners();case 3:case"end":return t.stop()}},t)}))));case 7:case"end":return r.stop()}},r)}))()}},{key:"signOut",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.beforeStateQueue.runMiddleware(null);case 2:if(t.t0=e.redirectPersistenceManager||e._popupRedirectResolver,!t.t0){t.next=6;break}return t.next=6,e._setRedirectUser(null);case 6:return t.abrupt("return",e._updateCurrentUser(null,!0));case 7:case"end":return t.stop()}},t)}))()}},{key:"setPersistence",value:function(e){var t=this;return this.queue(SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(q4(e));case 2:case"end":return n.stop()}},n)})))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new YB("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.getOrInitRedirectPersistenceManager(t);case 2:return i=r.sent,r.abrupt("return",null===e?i.removeCurrentUser():i.setCurrentUser(e));case 4:case"end":return r.stop()}},r)}))()}},{key:"getOrInitRedirectPersistenceManager",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.redirectPersistenceManager){n.next=9;break}return H4(r=e&&q4(e)||t._popupRedirectResolver,t,"argument-error"),n.next=5,x5.create(t,[q4(r._redirectPersistence)],"redirectUser");case 5:return t.redirectPersistenceManager=n.sent,n.next=8,t.redirectPersistenceManager.getCurrentUser();case 8:t.redirectUser=n.sent;case 9:return n.abrupt("return",t.redirectPersistenceManager);case 10:case"end":return n.stop()}},n)}))()}},{key:"_redirectUserForId",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=t._isInitialized,!n.t0){n.next=4;break}return n.next=4,t.queue(SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})));case 4:return n.abrupt("return",(null===(r=t._currentUser)||void 0===r?void 0:r._redirectEventId)===e?t._currentUser:(null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId)===e?t.redirectUser:null);case 5:case"end":return n.stop()}},n)}))()}},{key:"_persistUserIfCurrent",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(e!==t.currentUser){n.next=2;break}return n.abrupt("return",t.queue(SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.directlySetCurrentUser(e));case 1:case"end":return n.stop()}},n)}))));case 2:case"end":return n.stop()}},n)}))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return H4(o,this,"internal-error"),o.then(function(){return a(i.currentUser)}),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.currentUser&&t.currentUser!==e&&(t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh()),t.currentUser=e,!e){n.next=7;break}return n.next=5,t.assertedPersistence.setCurrentUser(e);case 5:n.next=9;break;case 7:return n.next=9,t.assertedPersistence.removeCurrentUser();case 9:case"end":return n.stop()}},n)}))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return H4(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=$5(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={"X-Client-Version":e.clientVersion},e.app.options.appId&&(r["X-Firebase-gmpid"]=e.app.options.appId),t.next=4,null===(n=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===n?void 0:n.getHeartbeatsHeader();case 4:return i=t.sent,t.abrupt("return",(i&&(r["X-Firebase-Client"]=i),r));case 6:case"end":return t.stop()}},t)}))()}}]),e}();function W5(e){return az(e)}var j5=function(){function e(t){var n,r=this;fy(this,e),this.auth=t,this.observer=null,this.addObserver=(n=new nz(function(e){return r.observer=e},void 0)).subscribe.bind(n)}return dy(e,[{key:"next",get:function(){return H4(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}(),Y5=function(){function e(t,n){fy(this,e),this.providerId=t,this.signInMethod=n}return dy(e,[{key:"toJSON",value:function(){return G4("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return G4("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return G4("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return G4("not implemented")}}]),e}();function K5(){return K5=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),K5.apply(this,arguments)}function Q5(){return Q5=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a5(t,"POST","/v1/accounts:signInWithPassword",e5(t,n)));case 1:case"end":return e.stop()}},e)})),Q5.apply(this,arguments)}function X5(e,t){return J5.apply(this,arguments)}function J5(){return J5=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t5(t,"POST","/v1/accounts:sendOobCode",e5(t,n)));case 1:case"end":return e.stop()}},e)})),J5.apply(this,arguments)}function e6(e,t){return t6.apply(this,arguments)}function t6(){return t6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X5(t,n));case 1:case"end":return e.stop()}},e)})),t6.apply(this,arguments)}function n6(e,t){return r6.apply(this,arguments)}function r6(){return r6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",X5(t,n));case 1:case"end":return e.stop()}},e)})),r6.apply(this,arguments)}function i6(){return i6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a5(t,"POST","/v1/accounts:signInWithEmailLink",e5(t,n)));case 1:case"end":return e.stop()}},e)})),i6.apply(this,arguments)}function a6(){return a6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a5(t,"POST","/v1/accounts:signInWithEmailLink",e5(t,n)));case 1:case"end":return e.stop()}},e)})),a6.apply(this,arguments)}var o6=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return fy(this,n),(a=t.call(this,"password",i))._email=e,a._password=r,a._tenantId=o,a}return dy(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=t.signInMethod,n.next="password"===n.t0?3:"emailLink"===n.t0?4:5;break;case 3:return n.abrupt("return",function(e,t){return Q5.apply(this,arguments)}(e,{returnSecureToken:!0,email:t._email,password:t._password}));case 4:return n.abrupt("return",function(e,t){return i6.apply(this,arguments)}(e,{email:t._email,oobCode:t._password}));case 5:F4(e,"internal-error");case 6:case"end":return n.stop()}},n)}))()}},{key:"_linkToIdToken",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=n.signInMethod,r.next="password"===r.t0?3:"emailLink"===r.t0?4:5;break;case 3:return r.abrupt("return",function(e,t){return K5.apply(this,arguments)}(e,{idToken:t,returnSecureToken:!0,email:n._email,password:n._password}));case 4:return r.abrupt("return",function(e,t){return a6.apply(this,arguments)}(e,{idToken:t,email:n._email,oobCode:n._password}));case 5:F4(e,"internal-error");case 6:case"end":return r.stop()}},r)}))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(Y5);function s6(e,t){return u6.apply(this,arguments)}function u6(){return u6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a5(t,"POST","/v1/accounts:signInWithIdp",e5(t,n)));case 1:case"end":return e.stop()}},e)})),u6.apply(this,arguments)}var c6=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return dy(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return s6(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,s6(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,s6(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=JB(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):F4("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,r=t.providerId,i=t.signInMethod,a=qy(t,["providerId","signInMethod"]);if(!r||!i)return null;var o=new n(r,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),n}(Y5),l6=function(){function e(t){var n,r,i,a,o,s;fy(this,e);var u=ez(tz(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=u.mode)&&void 0!==i?i:null);H4(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(a=u.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return dy(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=ez(tz(e)).link,n=t?ez(tz(t)).deep_link_id:null,r=ez(tz(e)).deep_link_id;return(r?ez(tz(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(r){return null}}}]),e}(),f6=function(){var e=function(){function e(){fy(this,e),this.providerId=e.PROVIDER_ID}return dy(e,null,[{key:"credential",value:function(e,t){return o6._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=l6.parseLink(t);return H4(n,"argument-error"),o6._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();return e.PROVIDER_ID="password",e.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e.EMAIL_LINK_SIGN_IN_METHOD="emailLink",e}(),h6=function(){function e(t){fy(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return dy(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),d6=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).scopes=[],e}return dy(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return oy(this.scopes)}}]),n}(h6),v6=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return dy(n,null,[{key:"credential",value:function(e,t){return c6._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,i=t.oauthAccessToken;if(!r&&!i)return null;try{return n.credential(r,i)}catch(a){return null}}}]),n}(d6);return e.GOOGLE_SIGN_IN_METHOD="google.com",e.PROVIDER_ID="google.com",e}();function p6(e,t){return g6.apply(this,arguments)}function g6(){return g6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a5(t,"POST","/v1/accounts:signUp",e5(t,n)));case 1:case"end":return e.stop()}},e)})),g6.apply(this,arguments)}var y6=function(){function e(t){fy(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return dy(e,null,[{key:"_fromIdTokenResponse",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return SB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,A5._fromIdTokenResponse(t,r,i);case 2:return o=a.sent,s=m6(r),a.abrupt("return",new e({user:o,providerId:s,_tokenResponse:r,operationType:n}));case 5:case"end":return a.stop()}},a)}))()}},{key:"_forOperation",value:function(t,n,r){return SB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t._updateTokensIfNecessary(r,!0);case 2:return a=m6(r),i.abrupt("return",new e({user:t,providerId:a,_tokenResponse:r,operationType:n}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function m6(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var k6=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o,s;return fy(this,n),(o=t.call(this,r.code,r.message)).operationType=i,o.user=a,Object.setPrototypeOf(ry(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:i},o}return dy(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,i){return new n(e,t,r,i)}}]),n}(jB);function C6(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(function(n){throw"auth/multi-factor-auth-required"===n.code?k6._fromErrorAndOperation(e,n,t,r):n})}function w6(e,t){return _6.apply(this,arguments)}function _6(){return _6=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]&&a[2],e.t0=y5,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return i=e.sent,e.abrupt("return",y6._forOperation(t,"link",i));case 14:case"end":return e.stop()}},e)})),_6.apply(this,arguments)}function E6(){return E6=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u,c,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],a=t.auth,o="reauthenticate",e.prev=2,e.next=5,y5(t,C6(a,o,n,t),r);case 5:return H4((s=e.sent).idToken,a,"internal-error"),H4(u=g5(s.idToken),a,"internal-error"),c=u.sub,e.abrupt("return",(H4(t.uid===c,a,"user-mismatch"),y6._forOperation(t,o,s)));case 13:throw e.prev=13,e.t0=e.catch(2),"auth/user-not-found"===(null===(i=e.t0)||void 0===i?void 0:i.code)&&F4(a,"user-mismatch"),e.t0;case 16:case"end":return e.stop()}},e,null,[[2,13]])})),E6.apply(this,arguments)}function b6(e,t){return S6.apply(this,arguments)}function S6(){return S6=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i="signIn",e.next=4,C6(t,i,n);case 4:return a=e.sent,e.next=7,y6._fromIdTokenResponse(t,i,a);case 7:if(o=e.sent,e.t0=r,e.t0){e.next=12;break}return e.next=12,t._updateCurrentUser(o.user);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)})),S6.apply(this,arguments)}function P6(){return P6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",b6(W5(t),n));case 1:case"end":return e.stop()}},e)})),P6.apply(this,arguments)}function O6(e,t,n){var r;H4((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),H4(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(H4(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(H4(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function T6(){return T6=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=az(t),a={requestType:"PASSWORD_RESET",email:n},r&&O6(i,a,r),e.next=4,n6(i,a);case 4:case"end":return e.stop()}},e)})),T6.apply(this,arguments)}function I6(){return I6=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=W5(t),e.next=3,p6(i,{returnSecureToken:!0,email:n,password:r});case 3:return a=e.sent,e.next=6,y6._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)})),I6.apply(this,arguments)}function A6(){return A6=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=az(t),e.next=3,t.getIdToken();case 3:return e.t0=e.sent,i={requestType:"VERIFY_EMAIL",idToken:e.t0},n&&O6(r.auth,i,n),e.next=8,e6(r.auth,i);case 8:if(a=e.sent,o=a.email,e.t1=o!==t.email,!e.t1){e.next=14;break}return e.next=14,t.reload();case 14:case"end":return e.stop()}},e)})),A6.apply(this,arguments)}function R6(e,t){return M6.apply(this,arguments)}function M6(){return M6=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t5(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}},e)})),M6.apply(this,arguments)}function x6(){return x6=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.displayName,i=n.photoURL,void 0!==r||void 0!==i){e.next=3;break}return e.abrupt("return");case 3:return a=az(t),e.next=6,a.getIdToken();case 6:return e.t0=e.sent,e.t1=r,e.t2=i,e.t3=!0,o={idToken:e.t0,displayName:e.t1,photoUrl:e.t2,returnSecureToken:e.t3},e.next=13,y5(a,R6(a.auth,o));case 13:return s=e.sent,a.displayName=s.displayName||null,a.photoURL=s.photoUrl||null,(u=a.providerData.find(function(e){return"password"===e.providerId}))&&(u.displayName=a.displayName,u.photoURL=a.photoURL),e.next=19,a._updateTokensIfNecessary(s);case 19:case"end":return e.stop()}},e)})),x6.apply(this,arguments)}new WeakMap;var N6="__sak",D6=function(){function e(t,n){fy(this,e),this.storageRetriever=t,this.type=n}return dy(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(N6,"1"),this.storage.removeItem(N6),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}(),L6=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.call(this,function(){return window.localStorage},"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=BB();return L5(e)||H5(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),e.fallbackToPolling=G5(),e._shouldAllowMigration=!0,e}return dy(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],i=this.storage.getItem(r),a=this.localCache[r];i!==a&&e(r,a,i)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var a=function(){var e=t.storage.getItem(r);!n&&t.localCache[r]===e||t.notifyListeners(r,e)},o=this.storage.getItem(r);$B()&&10===document.documentMode&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else this.forAllChangedKeys(function(e,n,r){t.notifyListeners(e,r)})}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t&&JSON.parse(t))}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(function(){e.forAllChangedKeys(function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)})},1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(e,t){var r=this,i=this;return SB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Qg(ay(n.prototype),"_set",r).call(i,e,t);case 2:i.localCache[e]=JSON.stringify(t);case 3:case"end":return a.stop()}},a)}))()}},{key:"_get",value:function(e){var t=this,r=this;return SB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Qg(ay(n.prototype),"_get",t).call(r,e);case 2:return a=i.sent,i.abrupt("return",(r.localCache[e]=JSON.stringify(a),a));case 4:case"end":return i.stop()}},i)}))()}},{key:"_remove",value:function(e){var t=this,r=this;return SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Qg(ay(n.prototype),"_remove",t).call(r,e);case 2:delete r.localCache[e];case 3:case"end":return i.stop()}},i)}))()}}]),n}(D6);return e.type="LOCAL",e}(),F6=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this,function(){return window.sessionStorage},"SESSION")}return dy(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(D6);return e.type="SESSION",e}(),U6=function(){var e=function(){function e(t){fy(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return dy(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=(r=e).data,a=i.eventId,o=i.eventType,s=i.data,null==(u=t.handlersMap[o])?void 0:u.size){n.next=3;break}return n.abrupt("return");case 3:return r.ports[0].postMessage({status:"ack",eventId:a,eventType:o}),c=Array.from(u).map(function(){var e=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(r.origin,s));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n.next=7,function(e){return Promise.all(e.map((t=SB(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=!0,e.next=4,t;case 4:return e.t1=e.sent,e.abrupt("return",{fulfilled:e.t0,value:e.t1});case 8:return e.prev=8,e.t2=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t2});case 11:case"end":return e.stop()}},e,null,[[0,8]])})),function(e){return t.apply(this,arguments)})));var t}(c);case 7:l=n.sent,r.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:l});case 9:case"end":return n.stop()}},n)}))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find(function(e){return e.isListeningto(t)});if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();return e.receivers=[],e}();function V6(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}var B6=function(){function e(t){fy(this,e),this.target=t,this.handlers=new Set}return dy(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=this;return SB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a="undefined"!=typeof MessageChannel?new MessageChannel:null){i.next=3;break}throw new Error("connection_unavailable");case 3:return i.abrupt("return",new Promise(function(i,u){var c=V6("",20);a.port1.start();var l=setTimeout(function(){u(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage:function(e){var t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),o=setTimeout(function(){u(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(t.data.response);break;default:clearTimeout(l),clearTimeout(o),u(new Error("invalid_response"))}}},r.handlers.add(s),a.port1.addEventListener("message",s.onMessage),r.target.postMessage({eventType:e,eventId:c,data:t},[a.port2])}).finally(function(){s&&r.removeMessageHandler(s)}));case 4:case"end":return i.stop()}},i)}))()}}]),e}();function z6(){return window}function H6(){return void 0!==z6().WorkerGlobalScope&&"function"==typeof z6().importScripts}function G6(){return(G6=SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return e.abrupt("return",e.sent.active);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var $6="firebaseLocalStorageDb",Z6="firebaseLocalStorage",q6="fbase_key",W6=function(){function e(t){fy(this,e),this.request=t}return dy(e,[{key:"toPromise",value:function(){var e=this;return new Promise(function(t,n){e.request.addEventListener("success",function(){t(e.request.result)}),e.request.addEventListener("error",function(){n(e.request.error)})})}}]),e}();function j6(e,t){return e.transaction([Z6],t?"readwrite":"readonly").objectStore(Z6)}function Y6(){var e=indexedDB.open($6,1);return new Promise(function(t,n){e.addEventListener("error",function(){n(e.error)}),e.addEventListener("upgradeneeded",function(){var t=e.result;try{t.createObjectStore(Z6,{keyPath:q6})}catch(r){n(r)}}),e.addEventListener("success",SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.result).objectStoreNames.contains(Z6)){n.next=5;break}t(r),n.next=13;break;case 5:return r.close(),n.next=8,function(){var e=indexedDB.deleteDatabase($6);return new W6(e).toPromise()}();case 8:return n.t0=t,n.next=11,Y6();case 11:n.t1=n.sent,(0,n.t0)(n.t1);case 13:case"end":return n.stop()}},n)})))})}function K6(e,t,n){return Q6.apply(this,arguments)}function Q6(){return Q6=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=j6(t,!0).put((Zg(i={},q6,n),Zg(i,"value",r),i)),e.abrupt("return",new W6(a).toPromise());case 2:case"end":return e.stop()}},e)})),Q6.apply(this,arguments)}function X6(){return X6=SB(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=j6(t,!1).get(n),e.next=3,new W6(r).toPromise();case 3:return i=e.sent,e.abrupt("return",void 0===i?null:i.value);case 5:case"end":return e.stop()}},e)})),X6.apply(this,arguments)}function J6(e,t){var n=j6(e,!0).delete(t);return new W6(n).toPromise()}var e8=function(){var e=function(){function e(){fy(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(function(){},function(){})}return dy(e,[{key:"_openDb",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.db,t.t0){t.next=5;break}return t.next=4,Y6();case 4:e.db=t.sent;case 5:return t.abrupt("return",e.db);case 6:case"end":return t.stop()}},t)}))()}},{key:"_withRetries",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:return n.prev=1,n.next=4,t._openDb();case 4:return i=n.sent,n.next=7,e(i);case 7:return n.abrupt("return",n.sent);case 10:if(n.prev=10,n.t0=n.catch(1),!(r++>3)){n.next=14;break}throw n.t0;case 14:t.db&&(t.db.close(),t.db=void 0);case 15:n.next=1;break;case 17:case"end":return n.stop()}},n,null,[[1,10]])}))()}},{key:"initializeServiceWorkerMessaging",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",H6()?e.initializeReceiver():e.initializeSender());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeReceiver",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.receiver=U6._getInstance(H6()?self:null),e.receiver._subscribe("keyChanged",function(){var t=SB(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._poll();case 2:return t.t0=t.sent.includes(r.key),t.abrupt("return",{keyProcessed:t.t0});case 4:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var e=SB(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"initializeSender",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(){return G6.apply(this,arguments)}();case 2:if(e.activeServiceWorker=t.sent,e.activeServiceWorker){t.next=5;break}return t.abrupt("return");case 5:return e.sender=new B6(e.activeServiceWorker),t.next=8,e.sender._send("ping",{},800);case 8:!(i=t.sent)||(null===(n=i[0])||void 0===n?void 0:n.fulfilled)&&(null===(r=i[0])||void 0===r?void 0:r.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0);case 10:case"end":return t.stop()}},t)}))()}},{key:"notifyServiceWorker",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.sender||!t.activeServiceWorker||function(){var e;return(null===(e=null==navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()!==t.activeServiceWorker){n.next=8;break}return n.prev=1,n.next=4,t.sender._send("keyChanged",{key:e},t.serviceWorkerReceiverAvailable?800:50);case 4:n.next=8;break;case 6:n.prev=6,n.t0=n.catch(1);case 8:case"end":return n.stop()}},n,null,[[1,6]])}))()}},{key:"_isAvailable",value:function(){return SB(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Y6();case 5:return t=e.sent,e.next=8,K6(t,N6,"1");case 8:return e.next=10,J6(t,N6);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}},e,null,[[0,13]])}))()}},{key:"_withPendingWrite",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.pendingWrites++,n.prev=1,n.next=4,e();case 4:return n.prev=4,t.pendingWrites--,n.finish(4);case 7:case"end":return n.stop()}},n,null,[[1,,4,7]])}))()}},{key:"_set",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n._withRetries(function(n){return K6(n,e,t)});case 2:return n.localCache[e]=t,r.abrupt("return",n.notifyServiceWorker(e));case 4:case"end":return r.stop()}},r)}))));case 1:case"end":return r.stop()}},r)}))()}},{key:"_get",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return function(e,t){return X6.apply(this,arguments)}(t,e)});case 2:return r=n.sent,n.abrupt("return",(t.localCache[e]=r,r));case 4:case"end":return n.stop()}},n)}))()}},{key:"_remove",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._withPendingWrite(SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._withRetries(function(t){return J6(t,e)});case 2:return delete t.localCache[e],n.abrupt("return",t.notifyServiceWorker(e));case 4:case"end":return n.stop()}},n)}))));case 1:case"end":return n.stop()}},n)}))()}},{key:"_poll",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._withRetries(function(e){var t=j6(e,!1).getAll();return new W6(t).toPromise()});case 2:if(n=t.sent){t.next=5;break}return t.abrupt("return",[]);case 5:if(0===e.pendingWrites){t.next=7;break}return t.abrupt("return",[]);case 7:r=[],i=new Set,a=uy(n);try{for(a.s();!(o=a.n()).done;)s=o.value,u=s.fbase_key,c=s.value,i.add(u),JSON.stringify(e.localCache[u])!==JSON.stringify(c)&&(e.notifyListeners(u,c),r.push(u))}catch(d){a.e(d)}finally{a.f()}for(l=0,f=Object.keys(e.localCache);l<f.length;l++)h=f[l],e.localCache[h]&&!i.has(h)&&(e.notifyListeners(h,null),r.push(h));return t.abrupt("return",r);case 12:case"end":return t.stop()}},t)}))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,i=Array.from(n);r<i.length;r++){(0,i[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}},t)})),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();return e.type="LOCAL",e}();function t8(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}function n8(e,t){return t?q4(t):(H4(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}t8("rcb"),new Y4(3e4,6e4);var r8=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,"custom","custom")).params=e,r}return dy(n,[{key:"_getIdTokenResponse",value:function(e){return s6(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return s6(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return s6(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(Y5);function i8(e){return b6(e.auth,new r8(e),e.bypassAuthState)}function a8(e){var t=e.auth,n=e.user;return H4(n,t,"internal-error"),function(e,t){return E6.apply(this,arguments)}(n,new r8(e),e.bypassAuthState)}function o8(e){return s8.apply(this,arguments)}function s8(){return s8=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,r=t.user,e.abrupt("return",(H4(r,n,"internal-error"),w6(r,new r8(t),t.bypassAuthState)));case 2:case"end":return e.stop()}},e)})),s8.apply(this,arguments)}var u8=function(){function e(t,n,r,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];fy(this,e),this.auth=t,this.resolver=r,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return dy(e,[{key:"execute",value:function(){var e,t=this;return new Promise((e=SB(regeneratorRuntime.mark(function e(n,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.pendingPromise={resolve:n,reject:r},e.prev=1,e.next=4,t.resolver._initialize(t.auth);case 4:return t.eventManager=e.sent,e.next=7,t.onExecution();case 7:t.eventManager.registerConsumer(t),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),t.reject(e.t0);case 13:case"end":return e.stop()}},e,null,[[1,10]])})),function(t,n){return e.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o,s,u,c;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=e.urlResponse,i=e.sessionId,a=e.postBody,o=e.tenantId,s=e.error,u=e.type,!s){n.next=3;break}return n.abrupt("return",void t.reject(s));case 3:return c={auth:t.auth,requestUri:r,sessionId:i,tenantId:o||void 0,postBody:a||void 0,user:t.user,bypassAuthState:t.bypassAuthState},n.prev=4,n.t0=t,n.next=8,t.getIdpTask(u)(c);case 8:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=15;break;case 12:n.prev=12,n.t2=n.catch(4),t.reject(n.t2);case 15:case"end":return n.stop()}},n,null,[[4,12]])}))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return i8;case"linkViaPopup":case"linkViaRedirect":return o8;case"reauthViaPopup":case"reauthViaRedirect":return a8;default:F4(this.auth,"internal-error")}}},{key:"resolve",value:function(e){$4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){$4(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),c8=new Y4(2e3,1e4);function l8(){return l8=SB(regeneratorRuntime.mark(function e(t,n,r){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=W5(t),B4(t,n,h6),a=n8(i,r),e.abrupt("return",new f8(i,"signInViaPopup",n,a).executeNotNull());case 4:case"end":return e.stop()}},e)})),l8.apply(this,arguments)}var f8=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;return fy(this,n),(s=t.call(this,e,r,a,o)).provider=i,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=ry(s),s}return dy(n,[{key:"executeNotNull",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.execute();case 2:return n=t.sent,t.abrupt("return",(H4(n,e.auth,"internal-error"),n));case 4:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $4(1===e.filter.length,"Popup operations only handle one event"),n=V6(),t.next=4,e.resolver._openPopup(e.auth,e.provider,e.filter[0],n);case 4:e.authWindow=t.sent,e.authWindow.associatedEvent=n,e.resolver._originValidation(e.auth).catch(function(t){e.reject(t)}),e.resolver._isIframeWebStorageSupported(e.auth,function(t){t||e.reject(U4(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation();case 9:case"end":return t.stop()}},t)}))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(U4(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;e.pollId=(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?window.setTimeout(function(){e.pollId=null,e.reject(U4(e.auth,"popup-closed-by-user"))},2e3):window.setTimeout(t,c8.get())}()}}]),n}(u8);return e.currentPopupAction=null,e}(),h8=new Map,d8=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return fy(this,n),(i=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,a)).eventId=null,i}return dy(n,[{key:"execute",value:function(){var e=this,t=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=h8.get(t.auth._key())){r.next=20;break}return r.prev=2,r.next=5,function(e,t){return v8.apply(this,arguments)}(t.resolver,t.auth);case 5:if(!r.sent){r.next=11;break}return r.next=8,Qg(ay(n.prototype),"execute",e).call(t);case 8:r.t0=r.sent,r.next=12;break;case 11:r.t0=null;case 12:a=r.t0,i=function(){return Promise.resolve(a)},r.next=19;break;case 16:r.prev=16,r.t1=r.catch(2),i=function(){return Promise.reject(r.t1)};case 19:h8.set(t.auth._key(),i);case 20:return r.abrupt("return",(t.bypassAuthState||h8.set(t.auth._key(),function(){return Promise.resolve(null)}),i()));case 21:case"end":return r.stop()}},r,null,[[2,16]])}))()}},{key:"onAuthEvent",value:function(e){var t=this,r=function(){return Qg(ay(n.prototype),"onAuthEvent",t)},i=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("signInViaRedirect"!==e.type){t.next=2;break}return t.abrupt("return",r().call(i,e));case 2:if("unknown"===e.type){t.next=12;break}if(!e.eventId){t.next=10;break}return t.next=6,i.auth._redirectUserForId(e.eventId);case 6:if(!(n=t.sent)){t.next=9;break}return t.abrupt("return",(i.user=n,r().call(i,e)));case 9:i.resolve(null);case 10:t.next=13;break;case 12:i.resolve(null);case 13:case"end":return t.stop()}},t)}))()}},{key:"onExecution",value:function(){return SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))()}},{key:"cleanUp",value:function(){}}]),n}(u8);function v8(){return v8=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=y8(n),i=g8(t),e.next=3,i._isAvailable();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,i._get(r);case 7:return e.t0=e.sent,a="true"===e.t0,e.next=11,i._remove(r);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}},e)})),v8.apply(this,arguments)}function p8(e,t){h8.set(e._key(),t)}function g8(e){return q4(e._redirectPersistence)}function y8(e){return M5("pendingRedirect",e.config.apiKey,e.name)}function m8(e,t){return k8.apply(this,arguments)}function k8(){return k8=SB(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],i=W5(t),a=n8(i,n),e.next=5,new d8(i,a,r).execute();case 5:if(o=e.sent,e.t0=o&&!r,!e.t0){e.next=13;break}return delete o.user._redirectEventId,e.next=11,i._persistUserIfCurrent(o.user);case 11:return e.next=13,i._setRedirectUser(null,n);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}},e)})),k8.apply(this,arguments)}var C8=function(){function e(t){fy(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return dy(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach(function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _8(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!_8(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(U4(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(w8(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(w8(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function w8(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(function(e){return e}).join("-")}function _8(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function E8(e){return b8.apply(this,arguments)}function b8(){return b8=SB(regeneratorRuntime.mark(function e(t){var n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",t5(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}},e)})),b8.apply(this,arguments)}var S8=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,P8=/^https?/;function O8(){return O8=SB(regeneratorRuntime.mark(function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,E8(t);case 4:n=e.sent,r=n.authorizedDomains,i=uy(r),e.prev=7,i.s();case 9:if((a=i.n()).done){e.next=20;break}if(o=a.value,e.prev=11,!T8(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),i.e(e.t1);case 25:return e.prev=25,i.f(),e.finish(25);case 28:F4(t,"unauthorized-domain");case 29:case"end":return e.stop()}},e,null,[[7,22,25,28],[11,16]])})),O8.apply(this,arguments)}function T8(e){var t=W4(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!P8.test(r))return!1;if(S8.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}var I8=new Y4(3e4,6e4);function A8(){var e=z6().___jsl;if(null==e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=oy(e.H[r].L),e.CP)for(var i=0;i<e.CP.length;i++)e.CP[i]=null}}var R8=null;function M8(e){return R8=R8||function(e){return new Promise(function(t,n){var r,i,a;function o(){A8(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){A8(),n(U4(e,"network-request-failed"))},timeout:I8.get()})}if(null===(i=null===(r=z6().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=z6().gapi)||void 0===a?void 0:a.load)){var s=t8("iframefcb");return z6()[s]=function(){gapi.load?o():n(U4(e,"network-request-failed"))},function(e){return new Promise(function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=U4("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})}("https://apis.google.com/js/api.js?onload=".concat(s)).catch(function(e){return n(e)})}o()}}).catch(function(e){throw R8=null,e})}(e),R8}var x8=new Y4(5e3,15e3),N8={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},D8=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function L8(e){var t=e.config;H4(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?K4(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:qz},i=D8.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(JB(r).slice(1))}function F8(){return F8=SB(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M8(t);case 2:return n=e.sent,r=z6().gapi,e.abrupt("return",(H4(r,t,"internal-error"),n.open({where:document.body,url:L8(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:N8,dontclear:!0},function(e){return new Promise((n=SB(regeneratorRuntime.mark(function n(r,i){var a,o,s;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){z6().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:a=U4(t,"network-request-failed"),o=z6().setTimeout(function(){i(a)},x8.get()),e.ping(s).then(s,function(){i(a)});case 5:case"end":return n.stop()}},n)})),function(e,t){return n.apply(this,arguments)}));var n})));case 5:case"end":return e.stop()}},e)})),F8.apply(this,arguments)}var U8={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V8=function(){function e(t){fy(this,e),this.window=t,this.associatedEvent=null}return dy(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),e}();function B8(e,t,n,r,i,a){H4(e.config.authDomain,e,"auth-domain-config-required"),H4(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:qz,eventId:i};if(t instanceof h6){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(var s=0,u=Object.entries(a||{});s<u.length;s++){var c=qg(u[s],2),l=c[0],f=c[1];o[l]=f}}if(t instanceof d6){var h=t.getScopes().filter(function(e){return""!==e});h.length>0&&(o.scopes=h.join(","))}e.tenantId&&(o.tid=e.tenantId);for(var d=o,v=0,p=Object.keys(d);v<p.length;v++){var g=p[v];void 0===d[g]&&delete d[g]}return"".concat(function(e){var t=e.config;return t.emulator?K4(t,"emulator/auth/handler"):"https://".concat(t.authDomain,"/__/auth/handler")}(e),"?").concat(JB(d).slice(1))}var z8="webStorageSupport",H8=function(){function e(){fy(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=F6,this._completeRedirectFn=m8,this._overrideRedirectResult=p8}return dy(e,[{key:"_openPopup",value:function(e,t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return $4(null===(o=i.eventManagers[e._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()"),s=B8(e,t,n,W4(),r),a.abrupt("return",function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s="",u=Object.assign(Object.assign({},U8),{width:r.toString(),height:i.toString(),top:a,left:o}),c=BB().toLowerCase();n&&(s=F5(c)?"_blank":n),D5(c)&&(t=t||"http://localhost",u.scrollbars="yes");var l=Object.entries(u).reduce(function(e,t){var n=qg(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")},"");if(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BB();return H5(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==s)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",s),new V8(null);var f=window.open(t||"",s,l);H4(f,e,"popup-blocked");try{f.focus()}catch(h){}return new V8(f)}(e,s,V6()));case 3:case"end":return a.stop()}},a)}))()}},{key:"_openRedirect",value:function(e,t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,i._originValidation(e);case 2:return function(e){z6().location.href=e}(B8(e,t,n,W4(),r)),a.abrupt("return",new Promise(function(){}));case 4:case"end":return a.stop()}},a)}))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):($4(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch(function(){delete t.eventManagers[n]}),o}},{key:"initAndGetManager",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,function(e){return F8.apply(this,arguments)}(e);case 2:return r=n.sent,i=new C8(e),n.abrupt("return",(r.register("authEvent",function(t){return H4(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:i.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:i},t.iframes[e._key()]=r,i));case 5:case"end":return n.stop()}},n)}))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(z8,{type:z8},function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[z8];void 0!==i&&t(!!i),F4(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return O8.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return G5()||L5()||H5()}}]),e}(),G8="@firebase/auth",$8=function(){function e(t){fy(this,e),this.auth=t,this.internalListeners=new Map}return dy(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.assertAuthConfigured(),n.next=3,t.auth._initializationPromise;case 3:if(!t.auth.currentUser){n.next=10;break}return n.next=6,t.auth.currentUser.getIdToken(e);case 6:n.t1=n.sent,n.t0={accessToken:n.t1},n.next=11;break;case 10:n.t0=null;case 11:return n.abrupt("return",n.t0);case 12:case"end":return n.stop()}},n)}))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged(function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);!t||(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){H4(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();!function(e){Hz(new uz("auth",function(t,n){var r=n.options,i=t.getProvider("app").getImmediate(),a=t.getProvider("heartbeat"),o=i.options,s=o.apiKey,u=o.authDomain;return function(t,n){H4(s&&!s.includes(":"),"invalid-api-key",{appName:t.name}),H4(!(null==u?void 0:u.includes(":")),"argument-error",{appName:t.name});var i={apiKey:s,authDomain:u,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:$5(e)},a=new q5(t,n,i);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(q4);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(a,r),a}(i,a)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(function(e,t,n){e.getProvider("auth-internal").initialize()})),Hz(new uz("auth-internal",function(e){var t=W5(e.getProvider("auth").getImmediate());return new $8(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Yz(G8,"0.20.5",void 0),Yz(G8,"0.20.5","esm2017")}("Browser");var Z8=dy(function e(t){return fy(this,e),t}),q8=dy(function e(){return fy(this,e),L3("auth")}),W8=new pw("angularfire2.auth-instances");function j8(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new Z8(r)}}var Y8={provide:q8,deps:[[new Gw,W8]]},K8={provide:Z8,useFactory:function(e,t){var n=D3("auth",e,t);return n&&new Z8(n)},deps:[[new Gw,W8],W3]},Q8=function(){var e=dy(function e(){fy(this,e),Yz("angularfire",T3.full,"auth")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:[K8,Y8]}),e}(),X8=q3(function(e,t,n){return I6.apply(this,arguments)},!0),J8=q3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wz(),t=Gz(e,"auth");return t.isInitialized()?t.getImmediate():function(e,t){var n=Gz(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(QB(n.getOptions(),null!=t?t:{}))return r;F4(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:H8,persistence:[e8,L6,F6]})},!0),e7=q3(function(e,t,n,r){return az(e).onAuthStateChanged(t,n,r)},!0),t7=q3(function(e,t){return A6.apply(this,arguments)},!0),n7=q3(function(e,t,n){return T6.apply(this,arguments)},!0),r7=q3(function(e,t,n){return function(e,t){return P6.apply(this,arguments)}(az(e),f6.credential(t,n))},!0),i7=q3(function(e,t,n){return l8.apply(this,arguments)},!0),a7=q3(function(e,t){return x6.apply(this,arguments)},!0),o7=dy(function e(t){return fy(this,e),t}),s7=new pw("angularfire2.firestore-instances");function u7(e){return function(t,n){var r=t.runOutsideAngular(function(){return e(n)});return new o7(r)}}var c7={provide:dy(function e(){return fy(this,e),L3("firestore")}),deps:[[new Gw,s7]]},l7={provide:o7,useFactory:function(e,t){var n=D3("firestore",e,t);return n&&new o7(n)},deps:[[new Gw,s7],W3]},f7=function(){var e=dy(function e(){fy(this,e),Yz("angularfire",T3.full,"fst")});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({providers:[l7,c7]}),e}(),h7=q3(function(e,t){var n=JX(e.firestore,uJ),r=aJ(e),i=KJ(e.converter,t);return XJ(n,[_J(wJ(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Lj.exists(!1))]).then(function(){return r})},!0),d7=q3(function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=az(e),YX("collection","path",t),e instanceof tJ){var a=Hq.fromString.apply(Hq,[t].concat(r));return QX(a),new iJ(e,null,a)}if(!(e instanceof nJ||e instanceof iJ))throw new Pq(Sq.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Hq.fromString.apply(Hq,[t].concat(r)));return QX(o),new iJ(e.firestore,null,o)},!0),v7=q3(function(e){return XJ(JX(e.firestore,uJ),[new Qj(e._key,Lj.none())])},!0),p7=q3(aJ,!0),g7=q3(function(e){e=JX(e,nJ);var t=JX(e.firestore,uJ);return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Oq;return e.asyncQueue.enqueueAndForget(SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new LX({next:function(a){t.enqueueAndForget(function(){return qQ(e,o)});var s=a.docs.has(n);!s&&a.fromCache?i.reject(new Pq(Sq.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&a.fromCache&&r&&"server"===r.source?i.reject(new Pq(Sq.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new QQ(sj(n.path),a,{includeMetadataChanges:!0,Du:!0});return $Q(e,o)},i.next=3,qX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(cJ(t),e._key).then(function(n){return JJ(t,e,n)})},!0),y7=q3(function(e){e=JX(e,rJ);var t=JX(e.firestore,uJ),n=cJ(t),r=new QJ(t);return HJ(e._query),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new Oq;return e.asyncQueue.enqueueAndForget(SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=function(e,t,n,r,i){var a=new LX({next:function(n){t.enqueueAndForget(function(){return qQ(e,o)}),n.fromCache&&"server"===r.source?i.reject(new Pq(Sq.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new QQ(n,a,{includeMetadataChanges:!0,Du:!0});return $Q(e,o)},i.next=3,qX(e);case 3:return i.t1=i.sent,i.t2=e.asyncQueue,i.t3=t,i.t4=n,i.t5=r,i.abrupt("return",(0,i.t0)(i.t1,i.t2,i.t3,i.t4,i.t5));case 9:case"end":return i.stop()}},i)}))),r.promise}(n,e._query).then(function(n){return new BJ(t,r,e,n)})},!0),m7=q3(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wz();return Gz(e,"firestore").getImmediate()},!0),k7=q3(function(e){return function(e,t){if(t<=0)throw new Pq(Sq.INVALID_ARGUMENT,"Function ".concat("limit","() requires a positive number, but it was: ").concat(t,"."))}(0,e),new qJ("limit",e,"F")},!0),C7=q3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,a,o;e=az(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||sJ(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(sJ(n[u])){var d=n[u];n[u]=null===(i=d.next)||void 0===i?void 0:i.bind(d),n[u+1]=null===(a=d.error)||void 0===a?void 0:a.bind(d),n[u+2]=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}if(e instanceof nJ)l=JX(e.firestore,uJ),f=sj(e._key.path),c={next:function(t){n[u]&&n[u](JJ(l,e,t))},error:n[u+1],complete:n[u+2]};else{var v=JX(e,rJ);l=JX(v.firestore,uJ),f=v._query;var p=new QJ(l);c={next:function(e){n[u]&&n[u](new BJ(l,p,v,e))},error:n[u+1],complete:n[u+2]},HJ(e._query)}return function(e,t,n,r){var i=new LX(r),a=new QQ(t,i,n);return e.asyncQueue.enqueueAndForget(SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=$Q,t.next=3,qX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)}))),function(){i.Tc(),e.asyncQueue.enqueueAndForget(SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=qQ,t.next=3,qX(e);case 3:return t.t1=t.sent,t.t2=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}},t)})))}}(cJ(l),f,h,c)},!0),w7=q3(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=LJ("orderBy",e);return new ZJ(r,n)},!0),_7=q3(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];e=o._apply(e)}return e},!0),E7=q3(function(e,t,n){e=JX(e,nJ);var r=JX(e.firestore,uJ),i=KJ(e.converter,t,n);return XJ(r,[_J(wJ(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Lj.none())])},!0),b7=q3(function(e,t,n){e=JX(e,nJ);for(var r,i=JX(e.firestore,uJ),a=wJ(i),o=arguments.length,s=new Array(o>3?o-3:0),u=3;u<o;u++)s[u-3]=arguments[u];return r="string"==typeof(t=az(t))||t instanceof fJ?function(e,t,n,r,i,a){var o=e.aa(1,t,n),s=[IJ(t,r,n)],u=[i];if(a.length%2!=0)throw new Pq(Sq.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)s.push(IJ(t,a[c])),u.push(a[c+1]);for(var l=[],f=UW.empty(),h=s.length-1;h>=0;--h)if(!xJ(l,s[h])){var d=s[h],v=u[h];v=az(v);var p=o.ia(d);if(v instanceof EJ)l.push(d);else{var g=SJ(v,p);null!=g&&(l.push(d),f.set(d,g))}}var y=new cW(l);return new yJ(f,y,o.fieldTransforms)}(a,"updateDoc",e._key,t,n,s):function(e,t,n,r){var i=e.aa(1,t,n);TJ("Data must be an object, but it was:",i,r);var a=[],o=UW.empty();nW(r,function(e,r){var s=RJ(t,e,n);r=az(r);var u=i.ia(s);if(r instanceof EJ)a.push(s);else{var c=SJ(r,u);null!=c&&(a.push(s),o.set(s,c))}});var s=new cW(a);return new yJ(o,s,i.fieldTransforms)}(a,"updateDoc",e._key,t),XJ(i,[r.toMutation(e._key,Lj.exists(!0))])},!0),S7=q3(function(e,t,n){var r=t,i=LJ("where",e);return new $J(i,r,n)},!0),P7=function(){var e=function(){function e(t,n){fy(this,e),this.collectionName=t,this.firestore=n,this.subDAOs={},this.collection=d7(n,this.collectionName).withConverter({fromFirestore:function(e){return e.data()},toFirestore:function(e){return e}})}return dy(e,[{key:"create",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,{called:n.collectionName+".create",newElement:t}),r.next=3,h7(n.collection,t);case 3:return r.abrupt("return",r.sent.id);case 4:case"end":return r.stop()}},r)}))()}},{key:"read",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,{called:n.collectionName+".read",id:t}),r.next=3,g7(p7(n.collection,t));case 3:return i=r.sent,r.abrupt("return",i.exists()?RB.of(PB.getNonNullable(i.data())):RB.empty());case 5:case"end":return r.stop()}},r)}))()}},{key:"exists",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,{called:n.collectionName+".exists",id:t}),r.next=3,n.read(t);case 3:return r.abrupt("return",r.sent.isPresent());case 4:case"end":return r.stop()}},r)}))()}},{key:"update",value:function(t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(OB(e.VERBOSE,{called:r.collectionName+".update",id:t,update:n}),b7(p7(r.collection,t),n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"delete",value:function(t){return OB(e.VERBOSE,{called:this.collectionName+".delete",id:t}),v7(p7(this.collection,t))}},{key:"set",value:function(t,n){return OB(e.VERBOSE,{called:this.collectionName+".set",id:t,element:n}),E7(p7(this.collection,t),n)}},{key:"subscribeToChanges",value:function(e,t){return new hy(C7(p7(this.collection,e),function(e){t(RB.ofNullable(e.data()))}))}},{key:"findWhere",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=r.constructQuery(e,t,n),i.next=3,y7(a);case 3:return i.abrupt("return",i.sent.docs.map(function(e){return{id:e.id,data:e.data()}}));case 4:case"end":return i.stop()}},i)}))()}},{key:"observingWhere",value:function(t,n,r){var i=this;OB(e.VERBOSE,{called:this.collectionName+".observingWhere"});var a=this.constructQuery(t,r);return new hy(C7(a,function(t){var r=[],a=[],o=[];t.docChanges().forEach(function(e){var t={id:e.doc.id,data:e.doc.data()};switch(e.type){case"added":r.push(t);break;case"modified":a.push(t);break;case"removed":o.push(t)}}),r.length>0&&(OB(e.VERBOSE,"firebase gave us "+r.length+" NEW "+i.collectionName),n.onDocumentCreated(r)),a.length>0&&(OB(e.VERBOSE,"firebase gave us "+a.length+" MODIFIED "+i.collectionName),n.onDocumentModified(a)),o.length>0&&(OB(e.VERBOSE,"firebase gave us "+o.length+" DELETED "+i.collectionName),n.onDocumentDeleted(o))}))}},{key:"constructQuery",value:function(e,t,n){var r=_7(this.collection);null!=t&&(r=_7(r,w7(t))),null!=n&&(r=_7(r,k7(n)));var i,a=uy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;r=_7(r,S7(o[0],o[1],o[2]))}}catch(s){a.e(s)}finally{a.f()}return r}},{key:"subCollectionDAO",value:function(t,n){var r="".concat(this.collection.path,"/").concat(t,"/").concat(n);if(r in this.subDAOs)return this.subDAOs[r];var i=new(function(e){Jg(n,e);var t=ty(n);function n(e){return fy(this,n),t.call(this,r,e)}return dy(n)}(e))(this.firestore);return this.subDAOs[r]=i,i}}]),e}();return e.VERBOSE=!1,e}(),O7=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),r=t.call(this,"chats",e),OB(n.VERBOSE,"ChatDAO.constructor"),r}return dy(n)}(P7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Dw(o7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),T7=function(){var n=dy(function e(){fy(this,e)});return n.CANNOT_SEND_MESSAGE=function(){return $localize(e||(e=Hg(["You're not allowed to send a message here."])))},n.FORBIDDEN_MESSAGE=function(){return $localize(t||(t=Hg(["This message is forbidden."])))},n}(),I7=function(){var e=function(){function e(t){fy(this,e),this.chatDAO=t,OB(e.VERBOSE,"ChatService.constructor")}return dy(e,[{key:"addMessage",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").create(t));case 1:case"end":return r.stop()}},r)}))()}},{key:"getLastMessages",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",t));case 1:case"end":return r.stop()}},r)}))()}},{key:"subscribeToMessages",value:function(e,t){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],t,"postedTime")}},{key:"deleteChat",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(OB(e.VERBOSE,"ChatService.deleteChat "+t),n.chatDAO.delete(t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"createNewChat",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chatDAO.set(e,{}));case 1:case"end":return n.stop()}},n)}))()}},{key:"sendMessage",value:function(e,t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!1!==i.userCanSendMessage(t.name,e)){a.next=2;break}return a.abrupt("return",DB.failure(T7.CANNOT_SEND_MESSAGE()));case 2:if(!i.isForbiddenMessage(n)){a.next=4;break}return a.abrupt("return",DB.failure(T7.FORBIDDEN_MESSAGE()));case 4:return o={content:n,sender:t,postedTime:e1(),currentTurn:r},a.next=7,i.addMessage(e,o);case 7:return a.abrupt("return",DB.SUCCESS);case 8:case"end":return a.stop()}},a)}))()}},{key:"userCanSendMessage",value:function(e,t){return""!==e}},{key:"isForbiddenMessage",value:function(e){return""===e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Dw(O7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),A7=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){return fy(this,n),t.call(this,"errors",e)}return dy(n)}(P7);return e.\u0275fac=function(t){return new(t||e)(Dw(o7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),R7=jg(5378),M7=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"infoMessage",value:function(e){this.message(e,"is-info")}},{key:"gameMessage",value:function(e){this.message(e,"is-warning")}},{key:"criticalMessage",value:function(e){this.message(e,"is-danger")}},{key:"message",value:function(e,t){(0,R7.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:t,dismissible:!0})}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),x7=function(){function e(t,n,r){fy(this,e),this.errorDAO=t,this.router=n,this.messageDisplayer=r,e.setSingletonInstance(this)}return dy(e,[{key:"findErrors",value:function(e,t,n,r){return this.errorDAO.findWhere(void 0===r?[["component","==",e],["route","==",t],["message","==",n]]:[["component","==",e],["route","==",t],["message","==",n],["data","==",r]])}},{key:"logError",value:function(e,t,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o,s,u,c,l;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.messageDisplayer.criticalMessage($localize(n||(n=Hg(["An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible."])))),o=i.router.url,a.next=4,i.findErrors(e,o,t,r);case 4:if(0!==(s=a.sent).length){a.next=12;break}return u={component:e,route:o,message:t,firstEncounter:e1(),lastEncounter:e1(),occurences:1},null!=r&&(u.data=r),a.next=10,i.errorDAO.create(u);case 10:a.next=15;break;case 12:return c=s[0].id,l=s[0].data,a.next=15,i.errorDAO.update(c,{lastEncounter:e1(),occurences:l.occurences+1});case 15:case"end":return a.stop()}},a)}))()}}],[{key:"setSingletonInstance",value:function(t){e.singleton=RB.of(t)}},{key:"logErrorAndFail",value:function(t,n,r){throw e.logError(t,n,r),new Error("".concat(t,": ").concat(n," (extra data: ").concat(JSON.stringify(r),")"))}},{key:"logError",value:function(e,t,n){if(this.singleton.isAbsent())throw new Error("".concat(e,": ").concat(t," (extra data: ").concat(JSON.stringify(n),")"));return this.singleton.get().logError(e,t,n),DB.failure(e+": "+t)}}]),e}();function N7(e,t){if(!1===e)throw x7.logError("Assertion failure",t),new Error("Assertion failure: ".concat(t))}x7.singleton=RB.empty(),x7.\u0275fac=function(e){return new(e||x7)(Dw(A7),Dw(vF),Dw(M7))},x7.\u0275prov=xm({token:x7,factory:x7.\u0275fac,providedIn:"root"});var D7=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),r=t.call(this,n.COLLECTION_NAME,e),OB(n.VERBOSE,"UserDAO.constructor"),r}return dy(n)}(P7);return e.VERBOSE=!1,e.COLLECTION_NAME="users",e.\u0275fac=function(t){return new(t||e)(Dw(o7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),L7=function(){var e=function(){function e(t){fy(this,e),this.userDAO=t}return dy(e,[{key:"usernameIsAvailable",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.findWhere([["username","==",e]]);case 2:return n.t0=n.sent.length,n.abrupt("return",0===n.t0);case 4:case"end":return n.stop()}},n)}))()}},{key:"setUsername",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.userDAO.update(e,{username:t});case 2:case"end":return r.stop()}},r)}))()}},{key:"markAsVerified",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.update(e,{verified:!0});case 2:case"end":return n.stop()}},n)}))()}},{key:"observeUser",value:function(e,t){return this.userDAO.subscribeToChanges(e,t)}},{key:"getUserLastUpdateTime",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.userDAO.read(e);case 2:if(!(r=n.sent).isAbsent()){n.next=5;break}return n.abrupt("return",RB.empty());case 5:return i=r.get().lastUpdateTime,n.abrupt("return",(N7(null!=i,"should not receive a lastUpdateTime equal to null"),RB.of(i)));case 7:case"end":return n.stop()}},n)}))()}},{key:"updatePresenceToken",value:function(e){return this.userDAO.update(e,{lastUpdateTime:e1()})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(D7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),F7=function(e){Jg(n,e);var t=ty(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E3;return fy(this,n),(e=t.call(this))._bufferSize=r,e._windowTime=i,e._timestampProvider=a,e._buffer=[],e._infiniteTimeWindow=!0,e._infiniteTimeWindow=i===1/0,e._bufferSize=Math.max(1,r),e._windowTime=Math.max(1,i),e}return dy(n,[{key:"next",value:function(e){var t=this.isStopped,r=this._buffer,i=this._infiniteTimeWindow,a=this._timestampProvider,o=this._windowTime;t||(r.push(e),!i&&r.push(a.now()+o)),this._trimBuffer(),Qg(ay(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t}},{key:"_trimBuffer",value:function(){var e=this._bufferSize,t=this._timestampProvider,n=this._buffer,r=this._infiniteTimeWindow,i=(r?1:2)*e;if(e<1/0&&i<n.length&&n.splice(0,n.length-i),!r){for(var a=t.now(),o=0,s=1;s<n.length&&n[s]<=a;s+=2)o=s;o&&n.splice(0,o+1)}}}]),n}(By),U7=function(){function e(){fy(this,e)}return dy(e,null,[{key:"createUserWithEmailAndPassword",value:function(e,t,n){return X8(e,t,n)}},{key:"sendEmailVerification",value:function(e){return t7(e)}},{key:"sendPasswordResetEmail",value:function(e,t){return n7(e,t)}},{key:"signInWithEmailAndPassword",value:function(e,t,n){return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,r7(e,t,n);case 2:return r.abrupt("return",r.sent.user);case 3:case"end":return r.stop()}},r)}))()}},{key:"signInWithPopup",value:function(e,t){return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i7(e,t);case 2:return n.abrupt("return",n.sent.user);case 3:case"end":return n.stop()}},n)}))()}},{key:"updateProfile",value:function(e,t){return a7(e,t)}}]),e}(),V7=function(){function e(t,n,r,i){fy(this,e),this.id=t,this.email=n,this.username=r,this.verified=i}return dy(e,[{key:"isConnected",value:function(){return this.email.isPresent()}},{key:"toMinimalUser",value:function(){return{id:this.id,name:this.username.get()}}}]),e}();V7.NOT_CONNECTED=new V7("",RB.empty(),RB.empty(),!1);var B7=function(){var e=function(){function e(t,n,r){fy(this,e);var i,a=this;this.userDAO=t,this.userService=n,this.auth=r,this.user=RB.empty(),this.userSubscription=new hy,OB(e.VERBOSE,"ConnectedUserService constructor"),this.userRS=new F7(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new hy(e7(this.auth,(i=SB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:null==n?(OB(e.VERBOSE,"User is not connected"),a.userSubscription.unsubscribe(),a.userRS.next(V7.NOT_CONNECTED),a.user=RB.empty()):(N7(a.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),a.userSubscription=a.userDAO.subscribeToChanges(n.uid,function(t){if(t.isPresent()){var r=t.get().username;OB(e.VERBOSE,"User ".concat(r," is connected, and the verified status is ").concat(a.emailVerified(n)));var i=!0===a.emailVerified(n)&&null!=r;if(!0===i&&!1===t.get().verified)return a.userService.markAsVerified(n.uid);var o=new V7(n.uid,RB.ofNullable(n.email),RB.ofNullable(r),i);a.user=RB.of(o),a.userRS.next(o)}}));case 1:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)})))}return dy(e,[{key:"emailVerified",value:function(e){return e.emailVerified}},{key:"sendPasswordResetEmail",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,U7.sendPasswordResetEmail(t.auth,e);case 3:return n.abrupt("return",DB.SUCCESS);case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",DB.failure(t.mapFirebaseError(n.t0)));case 9:case"end":return n.stop()}},n,null,[[0,6]])}))()}},{key:"doRegister",value:function(t,n,i){var a=this;return SB(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return OB(e.VERBOSE,"ConnectedUserService.doRegister("+n+")"),o.next=3,a.userService.usernameIsAvailable(t);case 3:if(!o.sent){o.next=7;break}o.t0=a.registerAfterUsernameCheck(t,n,i),o.next=8;break;case 7:o.t0=MB.failure($localize(r||(r=Hg(["This username is already in use."]))));case 8:return o.abrupt("return",o.t0);case 9:case"end":return o.stop()}},o)}))()}},{key:"registerAfterUsernameCheck",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,U7.createUserWithEmailAndPassword(r.auth,t,n);case 3:return a=i.sent,i.next=6,U7.signInWithEmailAndPassword(r.auth,t,n);case 6:return o=PB.getNonNullable(a.user),i.next=9,r.createUser(o.uid,e);case 9:return i.abrupt("return",MB.success(o));case 12:return i.prev=12,i.t0=i.catch(0),i.abrupt("return",MB.failure(r.mapFirebaseError(i.t0)));case 15:case"end":return i.stop()}},i,null,[[0,12]])}))()}},{key:"mapFirebaseError",value:function(e){switch(e.code){case"auth/email-already-in-use":return $localize(i||(i=Hg(["This email address is already in use."])));case"auth/invalid-email":return $localize(a||(a=Hg(["This email address is invalid."])));case"auth/user-not-found":case"auth/wrong-password":return $localize(o||(o=Hg(["You have entered invalid credentials."])));case"auth/invalid-credential":return $localize(s||(s=Hg(["The credential is invalid or has expired, please try again."])));case"auth/weak-password":return $localize(u||(u=Hg(["Your password is too weak, please use a stronger password."])));case"auth/too-many-requests":return $localize(c||(c=Hg(["There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later."])));case"auth/popup-closed-by-user":return $localize(l||(l=Hg(["You closed the authentication popup without finalizing your log in."])));case"auth/popup-blocked":return $localize(f||(f=Hg(["The authentication popup was blocked. Try again after disabling popup blocking."])));default:return x7.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}},{key:"sendEmailVerification",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(OB(e.VERBOSE,"ConnectedUserService.sendEmailVerification()"),(r=RB.ofNullable(t.auth.currentUser)).isPresent()){n.next=4;break}return n.abrupt("return",x7.logError("ConnectedUserService","Unlogged users cannot request for email verification"));case 4:if(!t.emailVerified(r.get())){n.next=6;break}return n.abrupt("return",x7.logError("ConnectedUserService","Verified users should not ask email verification after being verified"));case 6:return n.prev=6,n.next=9,U7.sendEmailVerification(r.get());case 9:return n.abrupt("return",DB.SUCCESS);case 12:return n.prev=12,n.t0=n.catch(6),n.abrupt("return",DB.failure(t.mapFirebaseError(n.t0)));case 15:case"end":return n.stop()}},n,null,[[6,12]])}))()}},{key:"doEmailLogin",value:function(t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return OB(e.VERBOSE,"ConnectedUserService.doEmailLogin("+t+")"),i.prev=1,i.next=4,U7.signInWithEmailAndPassword(r.auth,t,n);case 4:return i.abrupt("return",DB.SUCCESS);case 7:return i.prev=7,i.t0=i.catch(1),i.abrupt("return",DB.failure(r.mapFirebaseError(i.t0)));case 10:case"end":return i.stop()}},i,null,[[1,7]])}))()}},{key:"createUser",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(null!=t){r.next=5;break}return r.next=3,n.userDAO.set(e,{verified:!1});case 3:r.next=7;break;case 5:return r.next=7,n.userDAO.set(e,{username:t,verified:!1});case 7:case"end":return r.stop()}},r)}))()}},{key:"doGoogleLogin",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=DB,t.next=3,e.registerOrLoginWithGoogle();case 3:return t.t1=t.sent,t.abrupt("return",t.t0.ofFallible.call(t.t0,t.t1));case 5:case"end":return t.stop()}},t)}))()}},{key:"registerOrLoginWithGoogle",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new v6).addScope("profile"),n.addScope("email"),t.next=5,U7.signInWithPopup(e.auth,n);case 5:return r=t.sent,t.t0=!1,t.next=9,e.userDAO.exists(r.uid);case 9:if(t.t1=t.sent,t.t2=t.t0===t.t1,!t.t2){t.next=14;break}return t.next=14,e.createUser(r.uid);case 14:return t.abrupt("return",MB.success(r));case 17:return t.prev=17,t.t3=t.catch(0),t.abrupt("return",MB.failure(e.mapFirebaseError(t.t3)));case 20:case"end":return t.stop()}},t,null,[[0,17]])}))()}},{key:"disconnect",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!RB.ofNullable(e.auth.currentUser).isPresent()){t.next=6;break}return t.next=3,e.auth.signOut();case 3:t.t0=DB.SUCCESS,t.next=7;break;case 6:t.t0=DB.failure("Cannot disconnect a non-connected user");case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}},t)}))()}},{key:"subscribeToUser",value:function(e){return this.userObs.subscribe(e)}},{key:"setUsername",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(""!==e){n.next=2;break}return n.abrupt("return",DB.failure($localize(h||(h=Hg(["Your username may not be empty."])))));case 2:return n.prev=2,n.t0=!1,n.next=6,t.userService.usernameIsAvailable(e);case 6:if(n.t1=n.sent,n.t0!==n.t1){n.next=9;break}return n.abrupt("return",DB.failure($localize(d||(d=Hg(["This username is already in use, please select a different one."])))));case 9:return r=PB.getNonNullable(t.auth.currentUser),n.next=12,U7.updateProfile(r,{displayName:e});case 12:return n.next=14,t.userService.setUsername(r.uid,e);case 14:return n.next=16,t.userService.markAsVerified(r.uid);case 16:return n.next=18,t.reloadUser();case 18:return n.abrupt("return",DB.SUCCESS);case 21:return n.prev=21,n.t2=n.catch(2),n.abrupt("return",DB.failure(t.mapFirebaseError(n.t2)));case 24:case"end":return n.stop()}},n,null,[[2,21]])}))()}},{key:"setPicture",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=PB.getNonNullable(t.auth.currentUser),n.next=4,U7.updateProfile(r,{photoURL:e});case 4:return n.abrupt("return",DB.SUCCESS);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",DB.failure(t.mapFirebaseError(n.t0)));case 10:case"end":return n.stop()}},n,null,[[0,7]])}))()}},{key:"reloadUser",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=PB.getNonNullable(e.auth.currentUser),t.next=3,n.getIdToken(!0);case 3:return t.next=5,n.reload();case 5:case"end":return t.stop()}},t)}))()}},{key:"updateObservedPart",value:function(e){return N7(this.user.isPresent(),"Should not call updateObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:e})}},{key:"removeObservedPart",value:function(){return N7(this.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.user.get().id,{observedPart:null})}},{key:"sendPresenceToken",value:function(){return N7(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Dw(D7),Dw(L7),Dw(Z8))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),z7=dy(function e(t){fy(this,e),this.value=t});z7.HARD_DRAW=new z7(0),z7.RESIGN=new z7(1),z7.ESCAPE=new z7(2),z7.VICTORY=new z7(3),z7.TIMEOUT=new z7(4),z7.UNACHIEVED=new z7(5),z7.AGREED_DRAW_BY_ZERO=new z7(6),z7.AGREED_DRAW_BY_ONE=new z7(7);var H7=function(){function e(t,n){fy(this,e),this.id=t,this.data=n}return dy(e,[{key:"getTurn",value:function(){return this.data.turn}},{key:"isHardDraw",value:function(){return this.data.result===z7.HARD_DRAW.value}},{key:"isAgreedDraw",value:function(){return this.data.result===z7.AGREED_DRAW_BY_ZERO.value||this.data.result===z7.AGREED_DRAW_BY_ONE.value}},{key:"getDrawAccepter",value:function(){return this.data.result===z7.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(N7(this.data.result===z7.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),PB.getNonNullable(this.data.playerOne))}},{key:"isWin",value:function(){return this.data.result===z7.VICTORY.value}},{key:"isTimeout",value:function(){return this.data.result===z7.TIMEOUT.value}},{key:"isResign",value:function(){return this.data.result===z7.RESIGN.value}},{key:"getWinner",value:function(){return RB.ofNullable(this.data.winner)}},{key:"getLoser",value:function(){return RB.ofNullable(this.data.loser)}},{key:"setWinnerAndLoser",value:function(t,n){return new e(this.id,$g($g({},this.data),{},{winner:t,loser:n}))}}]),e}(),G7=function(){function e(t){fy(this,e),this.value=t}return dy(e,null,[{key:"of",value:function(t){switch(t){case"CREATOR":return e.CREATOR;case"RANDOM":return e.RANDOM;default:return N7("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),e.CHOSEN_PLAYER}}}]),e}();G7.CREATOR=new G7("CREATOR"),G7.RANDOM=new G7("RANDOM"),G7.CHOSEN_PLAYER=new G7("CHOSEN_PLAYER");var $7=function(){function e(t){fy(this,e),this.value=t}return dy(e,null,[{key:"of",value:function(t){switch(t){case"STANDARD":return e.STANDARD;case"BLITZ":return e.BLITZ;case"CUSTOM":return e.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}]),e}();$7.STANDARD=new $7("STANDARD"),$7.BLITZ=new $7("BLITZ"),$7.CUSTOM=new $7("CUSTOM"),$7.NORMAL_MOVE_DURATION=120,$7.NORMAL_PART_DURATION=1800,$7.BLITZ_MOVE_DURATION=30,$7.BLITZ_PART_DURATION=900;var Z7=dy(function e(t){fy(this,e),this.value=t});Z7.PART_CREATED=new Z7(0),Z7.CONFIG_PROPOSED=new Z7(2),Z7.PART_STARTED=new Z7(3),Z7.PART_FINISHED=new Z7(4);var q7=dy(function e(){fy(this,e)}),W7=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encode",value:function(e){return this.encodeMove(e)}},{key:"decode",value:function(e){return N7(!1===Array.isArray(e),"MoveEncoder.decode called with an array"),this.decodeMove(e)}}],[{key:"disjunction3",value:function(e,t,r,i,a){return new(function(n){Jg(s,n);var o=ty(s);function s(){return fy(this,s),o.apply(this,arguments)}return dy(s,[{key:"encodeMove",value:function(n){return i(n)?{type:"T1",encoded:e.encode(n)}:a(n)?{type:"T2",encoded:t.encode(n)}:{type:"T3",encoded:r.encode(n)}}},{key:"decodeMove",value:function(n){var i=PB.getNonNullable(n).type,a=PB.getNonNullable(n).encoded;return"T1"===i?e.decode(a):"T2"===i?t.decode(a):r.decode(a)}}]),s}(n))}}]),n}(q7),j7=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"shift",value:function(){return this.maxValue()+1}},{key:"encodeMove",value:function(e){return this.encodeNumber(e)}},{key:"decodeMove",value:function(e){return N7("number"==typeof e,"Invalid encoded number"),this.decodeNumber(e)}}],[{key:"ofN",value:function(e,t,r){return new(function(n){Jg(a,n);var i=ty(a);function a(){return fy(this,a),i.apply(this,arguments)}return dy(a,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(e){return t(e)}},{key:"decodeNumber",value:function(e){return r(e)}}]),a}(n))}},{key:"tuple",value:function(e,t,r){return new(function(n){Jg(a,n);var i=ty(a);function a(){return fy(this,a),i.apply(this,arguments)}return dy(a,[{key:"maxValue",value:function(){var t=0;return Object.keys(e).forEach(function(n){t=t*e[n].shift()+e[n].maxValue()}),t}},{key:"encodeNumber",value:function(n){var r=t(n),i=0;return Object.keys(r).forEach(function(t){i=i*e[t].shift()+e[t].encode(r[t])}),i}},{key:"decodeNumber",value:function(t){var n={},i=t;return Object.keys(e).reverse().forEach(function(t){var r=i%e[t].shift();i=(i-r)/e[t].shift(),n[t]=e[t].decode(r)}),r(n)}}]),a}(n))}},{key:"disjunction",value:function(e,t,r){return new(function(n){Jg(a,n);var i=ty(a);function a(){return fy(this,a),i.apply(this,arguments)}return dy(a,[{key:"maxValue",value:function(){return Math.max(2*e.maxValue(),2*t.maxValue()+1)}},{key:"encodeNumber",value:function(n){return r(n)?2*e.encodeNumber(n):2*t.encodeNumber(n)+1}},{key:"decodeNumber",value:function(n){return n%2==0?e.decodeNumber(n/2):t.decodeNumber((n-1)/2)}}]),a}(n))}},{key:"numberEncoder",value:function(e){return new(function(t){Jg(r,t);var n=ty(r);function r(){return fy(this,r),n.apply(this,arguments)}return dy(r,[{key:"maxValue",value:function(){return e}},{key:"encodeNumber",value:function(t){if(t>e)throw new Error("Cannot encode number bigger than the max with numberEncoder");return t}},{key:"decodeNumber",value:function(t){if(t>e)throw new Error("Cannot decode number bigger than the max with numberEncoder");return t}}]),r}(n))}}]),n}(W7);j7.booleanEncoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 1}},{key:"encodeNumber",value:function(e){return e?1:0}},{key:"decodeNumber",value:function(e){if(0===e)return!1;if(1===e)return!0;throw new Error("Invalid encoded boolean")}}]),n}(j7));var Y7=function(){function e(){fy(this,e),this.value=2}return dy(e,[{key:"isPlayer",value:function(){return!1}},{key:"toString",value:function(){return"PLAYER_NONE"}},{key:"equals",value:function(e){return this===e}}]),e}();Y7.NONE=new Y7;var K7,Q7=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"isPlayer",value:function(){return!0}},{key:"toString",value:function(){return this===e.ZERO?"PLAYER_ZERO":(PB.expectToBe(this,e.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}},{key:"equals",value:function(e){return this===e}},{key:"getScoreModifier",value:function(){return 0===this.value?-1:1}},{key:"getPreVictory",value:function(){return this.getVictoryValue()-this.getScoreModifier()}},{key:"getDefeatValue",value:function(){return this===e.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}},{key:"getVictoryValue",value:function(){return this===e.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}},{key:"getOpponent",value:function(){return this===e.ZERO?e.ONE:(PB.expectToBe(this,e.ONE),e.ZERO)}}],[{key:"of",value:function(t){return 0===t?e.ZERO:(PB.expectToBe(t,1),e.ONE)}},{key:"fromTurn",value:function(t){return t%2==0?e.ZERO:e.ONE}}]),e}();Q7.numberEncoder=j7.ofN(2,function(e){return e.value},function(e){return 2===e?K7.NONE:Q7.of(e)}),Q7.ZERO=new Q7(0),Q7.ONE=new Q7(1),Q7.PLAYERS=[Q7.ZERO,Q7.ONE],function(e){e.ZERO=Q7.ZERO,e.ONE=Q7.ONE,e.NONE=Y7.NONE}(K7||(K7={}));var X7=function(){function e(){fy(this,e)}return dy(e,null,[{key:"rematchAccepted",value:function(e,t){return J7("RematchAccepted",{typeGame:e,partId:t})}},{key:"getPlayer",value:function(e){return Q7.of(PB.getNonNullable(e.data).player)}},{key:"getTypeGame",value:function(e){return PB.getNonNullable(e.data).typeGame}},{key:"getPartId",value:function(e){return PB.getNonNullable(e.data).partId}}]),e}();function J7(e,t){return{code:e,data:t}}function e9(e){return function(t){return J7(e,{player:t.value})}}X7.drawProposed=e9("DrawProposed"),X7.drawAccepted=J7("DrawAccepted",{}),X7.drawRefused=e9("DrawRefused"),X7.takeBackAsked=e9("TakeBackAsked"),X7.takeBackRefused=e9("TakeBackRefused"),X7.takeBackAccepted=e9("TakeBackAccepted"),X7.rematchProposed=e9("RematchProposed"),X7.addTurnTime=e9("AddTurnTime"),X7.addGlobalTime=e9("AddGlobalTime");var t9=function(){function e(){fy(this,e)}return dy(e,null,[{key:"mapBiArray",value:function(e,t){for(var n=[],r=0;r<e.length;){n[r]=[];for(var i=0;i<e[r].length;)n[r][i]=t(e[r][i]),i++;r++}return n}},{key:"createTable",value:function(e,t,n){for(var r=[],i=t-1;i>=0;){r[i]=[];for(var a=e-1;a>=0;)r[i][a]=n,a--;i--}return r}},{key:"copyBiArray",value:function(t){for(var n=[],r=0;r<t.length;)n[r]=e.copyImmutableArray(t[r]),r++;return n}},{key:"copyImmutableArray",value:function(e){for(var t=[],n=0;n<e.length;)t[n]=e[n],n++;return t}},{key:"sortByDescending",value:function(e,t){e.sort(function(e,n){var r=t(e),i=t(n);return r<i?1:r>i?-1:0})}},{key:"compareArray",value:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!1===AB(e[n],t[n]))return!1;return!0}},{key:"compareTable",value:function(t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!1===e.compareArray(t[r],n[r]))return!1;return!0}}]),e}(),n9=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),r=t.call(this,"parts",e),OB(n.VERBOSE,"PartDAO.constructor"),r}return dy(n)}(P7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Dw(o7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),r9=dy(function e(t,n,r){fy(this,e),this.onDocumentCreated=t,this.onDocumentModified=n,this.onDocumentDeleted=r}),i9=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),r=t.call(this,"config-room",e),OB(n.VERBOSE,"ConfigRoomDAO.constructor"),r}return dy(n)}(P7);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Dw(o7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),a9=function(){var e=function(){function e(t,n){fy(this,e),this.configRoomDAO=t,this.connectedUserService=n,OB(e.VERBOSE,"ConfigRoomService.constructor")}return dy(e,[{key:"addCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(t.id,t)}},{key:"removeCandidate",value:function(e,t){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(t.id)}},{key:"subscribeToChanges",value:function(e,t){return this.configRoomDAO.subscribeToChanges(e,t)}},{key:"subscribeToCandidates",value:function(e,t){var n=[],r=new r9(function(e){var r,i=uy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.push(a.data)}}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=uy(e);try{var a=function(){var e=r.value;n=n.map(function(t){return t.id===e.data.id?e.data:t})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)},function(e){var r,i=uy(e);try{var a=function(){var e=r.value;n=n.filter(function(t){return t.id!==e.data.id})};for(i.s();!(r=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}t(n)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],r)}},{key:"createInitialConfigRoom",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.abrupt("return",n.configRoomDAO.set(t,{chosenOpponent:null,firstPlayer:G7.RANDOM.value,partType:$7.STANDARD.value,partStatus:Z7.PART_CREATED.value,maximalMoveDuration:$7.NORMAL_MOVE_DURATION,totalPartDuration:$7.NORMAL_PART_DURATION,creator:i}));case 3:case"end":return r.stop()}},r)}))()}},{key:"joinGame",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,"ConfigRoomService.joinGame("+t+")"),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if(!(a=r.sent).isAbsent()){r.next=9;break}r.t0=DB.failure(e.GAME_DOES_NOT_EXIST()),r.next=14;break;case 9:if(r.t1=a.get().creator.id!==i.id,!r.t1){r.next=13;break}return r.next=13,n.addCandidate(t,i);case 13:r.t0=DB.SUCCESS;case 14:return r.abrupt("return",r.t0);case 15:case"end":return r.stop()}},r)}))()}},{key:"cancelJoining",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,"ConfigRoomService.cancelJoining(".concat(t,")")),i=n.connectedUserService.user.get().toMinimalUser(),r.next=4,n.configRoomDAO.read(t);case 4:if((a=r.sent).isAbsent()){r.next=10;break}return s=a.get(),u=[n.removeCandidate(t,i)],(null===(o=s.chosenOpponent)||void 0===o?void 0:o.id)===i.id&&u.push(n.configRoomDAO.update(t,{chosenOpponent:null,partStatus:Z7.PART_CREATED.value})),r.next=10,Promise.all(u);case 10:case"end":return r.stop()}},r)}))()}},{key:"deleteConfigRoom",value:function(t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return OB(e.VERBOSE,"ConfigRoomService.deleteConfigRoom(".concat(t)),i.next=3,Promise.all(n.map(function(e){return r.removeCandidate(t,e)}));case 3:return i.next=5,r.configRoomDAO.delete(t);case 5:case"end":return i.stop()}},i)}))()}},{key:"proposeConfig",value:function(t,n,r,i,a,o){var s=this;return SB(regeneratorRuntime.mark(function u(){return regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(OB(e.VERBOSE,{configRoomService_proposeConfig:{configRoomId:t,maximalMoveDuration:i,firstPlayer:a,totalPartDuration:o}}),s.configRoomDAO.update(t,{partStatus:Z7.CONFIG_PROPOSED.value,chosenOpponent:n,partType:r.value,maximalMoveDuration:i,totalPartDuration:o,firstPlayer:a.value})));case 1:case"end":return u.stop()}},u)}))()}},{key:"setChosenOpponent",value:function(t,n){return OB(e.VERBOSE,"ConfigRoomService.setChosenOpponent(".concat(t,", ").concat(n.name,")")),this.configRoomDAO.update(t,{chosenOpponent:n})}},{key:"reviewConfig",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(OB(e.VERBOSE,"ConfigRoomService.reviewConfig(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:Z7.PART_CREATED.value})));case 1:case"end":return r.stop()}},r)}))()}},{key:"reviewConfigAndRemoveChosenOpponent",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(OB(e.VERBOSE,"ConfigRoomService.reviewConfigAndRemoveChosenOpponent(".concat(t,")")),n.configRoomDAO.update(t,{partStatus:Z7.PART_CREATED.value,chosenOpponent:null})));case 1:case"end":return r.stop()}},r)}))()}},{key:"acceptConfig",value:function(t){return OB(e.VERBOSE,"ConfigRoomService.acceptConfig(".concat(t)),this.configRoomDAO.update(t,{partStatus:Z7.PART_STARTED.value})}},{key:"createConfigRoom",value:function(t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(OB(e.VERBOSE,"ConfigRoomService.create(".concat(t)+JSON.stringify(n)+")"),r.configRoomDAO.set(t,n)));case 1:case"end":return i.stop()}},i)}))()}},{key:"readConfigRoomById",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,"ConfigRoomService.readConfigRoomById(".concat(t,")")),r.next=3,n.configRoomDAO.read(t);case 3:return r.abrupt("return",r.sent.get());case 4:case"end":return r.stop()}},r)}))()}}]),e}();return e.VERBOSE=!1,e.GAME_DOES_NOT_EXIST=function(){return $localize(v||(v=Hg(["Game does not exist"])))},e.\u0275fac=function(t){return new(t||e)(Dw(i9),Dw(B7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),o9=function(){var e=function(){function e(t,n,r,i){fy(this,e),this.partDAO=t,this.connectedUserService=n,this.configRoomService=r,this.chatService=i,OB(e.VERBOSE,"GameService.constructor")}return dy(e,[{key:"updateAndBumpIndex",value:function(e,t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(r=$g($g({},r),{},{lastUpdate:{index:n+1,player:t.value}}),i.partDAO.update(e,r)));case 1:case"end":return a.stop()}},a)}))()}},{key:"getPartValidity",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.partDAO.read(e);case 2:return i=r.sent,r.abrupt("return",i.isAbsent()?DB.failure("NONEXISTENT_PART"):i.get().typeGame===t?DB.SUCCESS:DB.failure("WRONG_GAME_TYPE"));case 4:case"end":return r.stop()}},r)}))()}},{key:"createUnstartedPart",value:function(t){OB(e.VERBOSE,"GameService.createPart("+t+")");var n=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:t,playerZero:n,turn:-1,result:z7.UNACHIEVED.value,listMoves:[]})}},{key:"createChat",value:function(t){return OB(e.VERBOSE,"GameService.createChat("+t+")"),this.chatService.createNewChat(t)}},{key:"createPartConfigRoomAndChat",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,"GameService.createGame(".concat(t,")")),r.next=3,n.createUnstartedPart(t);case 3:return i=r.sent,r.next=6,n.configRoomService.createInitialConfigRoom(i);case 6:return r.next=8,n.createChat(i);case 8:return r.abrupt("return",i);case 9:case"end":return r.stop()}},r)}))()}},{key:"startGameWithConfig",value:function(t,n,r,i){OB(e.VERBOSE,"GameService.startGameWithConfig("+t+", "+JSON.stringify(i));var a=this.getStartingConfig(i);return this.updateAndBumpIndex(t,n,r,a)}},{key:"getStartingConfig",value:function(e){var t,n,r=G7.of(e.firstPlayer);return r===G7.RANDOM&&(r=Math.random()<.5?G7.CREATOR:G7.CHOSEN_PLAYER),r===G7.CREATOR?(t=e.creator,n=PB.getNonNullable(e.chosenOpponent)):(t=PB.getNonNullable(e.chosenOpponent),n=e.creator),{playerZero:t,playerOne:n,turn:0,beginning:e1(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}},{key:"deletePart",value:function(t){return OB(e.VERBOSE,"GameService.deletePart("+t+")"),this.partDAO.delete(t)}},{key:"acceptConfig",value:function(t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return OB(e.VERBOSE,{gameService_acceptConfig:{partId:t,configRoom:n}}),i.next=3,r.configRoomService.acceptConfig(t);case 3:return i.abrupt("return",r.startGameWithConfig(t,Q7.ONE,0,n));case 4:case"end":return i.stop()}},i)}))()}},{key:"subscribeToChanges",value:function(e,t){return this.partDAO.subscribeToChanges(e,t)}},{key:"resign",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,n,t,{winner:r,loser:i,result:z7.RESIGN.value,request:null})}},{key:"notifyTimeout",value:function(e,t,n,r,i){return this.updateAndBumpIndex(e,t,n,{winner:r,loser:i,result:z7.TIMEOUT.value,request:null})}},{key:"sendRequest",value:function(e,t,n,r){return this.updateAndBumpIndex(e,t,n,{request:r})}},{key:"proposeDraw",value:function(e,t,n){return this.sendRequest(e,n,t,X7.drawProposed(n))}},{key:"acceptDraw",value:function(e,t,n){return this.updateAndBumpIndex(e,n,t,{result:(n===Q7.ZERO?z7.AGREED_DRAW_BY_ZERO:z7.AGREED_DRAW_BY_ONE).value,request:null})}},{key:"refuseDraw",value:function(e,t,n){return this.sendRequest(e,n,t,X7.drawRefused(n))}},{key:"proposeRematch",value:function(e,t,n){return this.sendRequest(e,n,t,X7.rematchProposed(n))}},{key:"acceptRematch",value:function(t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o,s,u,c,l,f,h,d,v;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return OB(e.VERBOSE,{called:"GameService.acceptRematch(",partDocument:t}),o=PB.getNonNullable(t.data),a.next=4,i.configRoomService.readConfigRoomById(t.id);case 4:return s=a.sent,c=i.connectedUserService.user.get().toMinimalUser(),o.playerZero.id===c.id?(l=PB.getNonNullable(o.playerOne),u=G7.CHOSEN_PLAYER):(l=o.playerZero,u=G7.CREATOR),f=$g($g({},s),{},{firstPlayer:u.value,creator:c,chosenOpponent:l,partStatus:Z7.PART_STARTED.value}),h=i.getStartingConfig(f),d=$g({lastUpdate:{index:0,player:r.value},typeGame:o.typeGame,result:z7.UNACHIEVED.value,listMoves:[]},h),a.next=12,i.partDAO.create(d);case 12:return v=a.sent,a.next=15,i.configRoomService.createConfigRoom(v,f);case 15:return a.next=17,i.createChat(v);case 17:return a.abrupt("return",i.sendRequest(t.id,r,n,X7.rematchAccepted(o.typeGame,v)));case 18:case"end":return a.stop()}},a)}))()}},{key:"askTakeBack",value:function(e,t,n){return this.sendRequest(e,n,t,X7.takeBackAsked(n))}},{key:"acceptTakeBack",value:function(e,t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o,s,u,c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return N7(X7.getPlayer(PB.getNonNullable(t.data.request))!==n,"Illegal to accept your own request"),o=X7.takeBackAccepted(n),(s=t.data.listMoves.slice(0,t.data.listMoves.length-1)).length%2===n.value&&(s=s.slice(0,s.length-1)),u={request:o,listMoves:s,turn:s.length,lastUpdateTime:e1(),remainingMsForZero:PB.getNonNullable(t.data.remainingMsForZero)-r[0],remainingMsForOne:PB.getNonNullable(t.data.remainingMsForOne)-r[1]},c=t.data.lastUpdate.index,a.next=7,i.updateAndBumpIndex(e,n,c,u);case 7:return a.abrupt("return",a.sent);case 8:case"end":return a.stop()}},a)}))()}},{key:"refuseTakeBack",value:function(e,t,n){var r=X7.takeBackRefused(n);return this.updateAndBumpIndex(e,n,t,{request:r})}},{key:"addGlobalTime",value:function(e,t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o={request:X7.addGlobalTime(r.getOpponent())},o=r===Q7.ZERO?$g($g({},o),{},{remainingMsForOne:PB.getNonNullable(n.remainingMsForOne)+3e5}):$g($g({},o),{},{remainingMsForZero:PB.getNonNullable(n.remainingMsForZero)+3e5}),a.next=4,i.updateAndBumpIndex(e,r,t,o);case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}},a)}))()}},{key:"addTurnTime",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a={request:X7.addTurnTime(e.getOpponent())},i.next=3,r.updateAndBumpIndex(n,e,t,a);case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(t,n,r,i,a,o,s,u){var c=this;return SB(regeneratorRuntime.mark(function l(){var f,h,d,v,p;return regeneratorRuntime.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return OB(e.VERBOSE,{gameService_updateDBBoard:{partId:t,encodedMove:r,scores:a,msToSubstract:i,notifyDraw:o,winner:s,loser:u}}),l.next=3,c.partDAO.read(t);case 3:return f=l.sent.get(),h=f.lastUpdate.index,d=f.turn+1,(v=t9.copyImmutableArray(f.listMoves))[v.length]=r,p={listMoves:v,turn:d,request:null,lastUpdateTime:e1()},p=c.updateScore(p,a),p=c.substractMs(p,f,i),null!=s?p=$g($g({},p),{},{winner:s,loser:u,result:z7.VICTORY.value}):!0===o&&(p=$g($g({},p),{},{result:z7.HARD_DRAW.value})),l.next=14,c.updateAndBumpIndex(t,n,h,p);case 14:return l.abrupt("return",l.sent);case 15:case"end":return l.stop()}},l)}))()}},{key:"updateScore",value:function(e,t){return void 0!==t?$g($g({},e),{},{scorePlayerZero:t[0],scorePlayerOne:t[1]}):e}},{key:"substractMs",value:function(e,t,n){return n[0]>0?$g($g({},e),{},{remainingMsForZero:PB.getNonNullable(t.remainingMsForZero)-n[0]}):n[1]>0?$g($g({},e),{},{remainingMsForOne:PB.getNonNullable(t.remainingMsForOne)-n[1]}):e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Dw(n9),Dw(B7),Dw(a9),Dw(I7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),s9={prefix:"fab",iconName:"facebook",icon:[512,512,[],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},u9={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},c9={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]},l9=function(){function e(){fy(this,e)}return dy(e,null,[{key:"getNavigatorLanguage",value:function(){return navigator.language}},{key:"getLocale",value:function(){var t,n,r=(null!==(t=null!==(n=localStorage.getItem("locale"))&&void 0!==n?n:e.getNavigatorLanguage())&&void 0!==t?t:"fr").slice(0,2).toLowerCase();return["en","fr"].some(function(e){return e===r})?r:"fr"}}]),e}(),f9=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"changeTheme",value:function(e){localStorage.setItem("theme",e)}},{key:"getTheme",value:function(){return RB.ofNullable(localStorage.getItem("theme"))}},{key:"changeLanguage",value:function(e){localStorage.setItem("locale",e.toLowerCase())}},{key:"getLanguage",value:function(){return l9.getLocale()}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),h9=function(){var e=function(){function e(t,n){fy(this,e),this.document=t,this.userSettingsService=n,this.availableThemes=["dark","light"];var r=this.getStoredTheme();r.isPresent()?this.loadTheme(r.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}return dy(e,[{key:"getStoredTheme",value:function(){var e=this.userSettingsService.getTheme();if(e.isPresent()){var t=e.get();if(this.availableThemes.some(function(e){return e===t}))return RB.of(t)}return RB.empty()}},{key:"loadTheme",value:function(e){this.loadStyle(e+".css"),this.theme=e}},{key:"loadStyle",value:function(e){var t=this.document.getElementsByTagName("head")[0],n=this.document.getElementById("theme");if(null!=n)n.href=e;else{var r=this.document.createElement("link");r.id="theme",r.rel="stylesheet",r.href="".concat(e),t.appendChild(r)}}},{key:"getTheme",value:function(){return this.theme}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(QI),Dw(f9))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),d9={prefix:"fas",iconName:"book-open",icon:[576,512,[],"f518","M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"]},v9={prefix:"fas",iconName:"cog",icon:[512,512,[],"f013","M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"]},p9={prefix:"fas",iconName:"desktop",icon:[576,512,[],"f108","M528 0H48C21.5 0 0 21.5 0 48v320c0 26.5 21.5 48 48 48h192l-16 48h-72c-13.3 0-24 10.7-24 24s10.7 24 24 24h272c13.3 0 24-10.7 24-24s-10.7-24-24-24h-72l-16-48h192c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zm-16 352H64V64h448v288z"]},g9={prefix:"fas",iconName:"eye",icon:[576,512,[],"f06e","M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"]},y9={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M640 264v-16c0-8.84-7.16-16-16-16H344v-40h72c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32H224c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h72v40H16c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h104v40H64c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h304v40h-56c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h160c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32h-56v-40h104c8.84 0 16-7.16 16-16zM256 128V64h128v64H256zm-64 320H96v-64h96v64zm352 0h-96v-64h96v64z"]},m9={prefix:"fas",iconName:"reply",icon:[512,512,[],"f3e5","M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"]},k9={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"]};function C9(e){return(C9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w9(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){w9(e,t,n[t])})}return e}function E9(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{!r&&null!=s.return&&s.return()}finally{if(i)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var b9={},S9={};try{"undefined"!=typeof window&&(b9=window),"undefined"!=typeof document&&(S9=document),"undefined"!=typeof MutationObserver&&MutationObserver,"undefined"!=typeof performance&&performance}catch(Fme){}var P9=(b9.navigator||{}).userAgent,O9=void 0===P9?"":P9,T9=b9,I9=S9,A9=!!I9.documentElement&&!!I9.head&&"function"==typeof I9.addEventListener&&"function"==typeof I9.createElement,R9=(~O9.indexOf("MSIE")||O9.indexOf("Trident/"),"___FONT_AWESOME___"),M9="svg-inline--fa",x9=[1,2,3,4,5,6,7,8,9,10],N9=x9.concat([11,12,13,14,15,16,17,18,19,20]),D9={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},L9=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",D9.GROUP,D9.SWAP_OPACITY,D9.PRIMARY,D9.SECONDARY].concat(x9.map(function(e){return"".concat(e,"x")})).concat(N9.map(function(e){return"w-".concat(e)})),T9.FontAwesomeConfig||{});I9&&"function"==typeof I9.querySelector&&[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(e){var t=E9(e,2),n=t[1],r=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=I9.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t[0]));null!=r&&(L9[n]=r)});var F9=_9({},{familyPrefix:"fa",replacementClass:M9,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},L9);F9.autoReplaceSvg||(F9.observeMutations=!1);var U9=_9({},F9);T9.FontAwesomeConfig=U9;var V9=T9||{};V9[R9]||(V9[R9]={}),V9[R9].styles||(V9[R9].styles={}),V9[R9].hooks||(V9[R9].hooks={}),V9[R9].shims||(V9[R9].shims=[]);var B9=V9[R9],z9=[];A9&&((I9.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(I9.readyState)||I9.addEventListener("DOMContentLoaded",function e(){I9.removeEventListener("DOMContentLoaded",e),z9.map(function(e){return e()})}));var H9,G9="pending",$9="fulfilled",Z9="rejected",q9=function(){},W9="undefined"!=typeof global&&void 0!==global.process&&"function"==typeof global.process.emit,j9="undefined"==typeof setImmediate?setTimeout:setImmediate,Y9=[];function K9(){for(var e=0;e<Y9.length;e++)Y9[e][0](Y9[e][1]);Y9=[],H9=!1}function Q9(e,t){Y9.push([e,t]),H9||(H9=!0,j9(K9,0))}function X9(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=$9;try{r=i(r)}catch(o){nee(a,o)}}J9(a,r)||(n===$9&&eee(a,r),n===Z9&&nee(a,r))}function J9(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"===C9(t))){var r=t.then;if("function"==typeof r)return r.call(t,function(r){n||(n=!0,t===r?tee(e,r):eee(e,r))},function(t){n||(n=!0,nee(e,t))}),!0}}catch(i){return n||nee(e,i),!0}return!1}function eee(e,t){(e===t||!J9(e,t))&&tee(e,t)}function tee(e,t){e._state===G9&&(e._state="settled",e._data=t,Q9(iee,e))}function nee(e,t){e._state===G9&&(e._state="settled",e._data=t,Q9(aee,e))}function ree(e){e._then=e._then.forEach(X9)}function iee(e){e._state=$9,ree(e)}function aee(e){e._state=Z9,ree(e),!e._handled&&W9&&global.process.emit("unhandledRejection",e._data,e)}function oee(e){global.process.emit("rejectionHandled",e)}function see(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(!(this instanceof see))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){nee(t,e)}try{e(function(e){eee(t,e)},n)}catch(r){n(r)}}(e,this)}see.prototype={constructor:see,_state:G9,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(q9),fulfilled:e,rejected:t};return(t||e)&&!this._handled&&(this._handled=!0,this._state===Z9&&W9&&Q9(oee,this)),this._state===$9||this._state===Z9?Q9(X9,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},see.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new see(function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)})},see.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new see(function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)})},see.resolve=function(e){return e&&"object"===C9(e)&&e.constructor===see?e:new see(function(t){t(e)})},see.reject=function(e){return new see(function(t,n){n(e)})};var uee={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function cee(){for(var e=12,t="";e-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function lee(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function fee(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,": ").concat(e[n],";")},"")}function hee(e){return e.size!==uee.size||e.x!==uee.x||e.y!==uee.y||e.rotate!==uee.rotate||e.flipX||e.flipY}function dee(e){var t=e.transform,n=e.iconWidth,r={transform:"translate(".concat(e.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),o="rotate(".concat(t.rotate," 0 0)");return{outer:r,inner:{transform:"".concat(i," ").concat(a," ").concat(o)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}var vee={x:0,y:0,width:"100%",height:"100%"};function pee(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}function gee(e){return"g"===e.tag?e.children:[e]}function yee(e){var t=e.icons,n=t.main,r=t.mask,i=e.prefix,a=e.iconName,o=e.transform,s=e.symbol,u=e.title,c=e.maskId,l=e.titleId,f=e.extra,h=e.watchable,d=void 0!==h&&h,v=r.found?r:n,p=v.width,g=v.height,y="fak"===i,m=y?"":"fa-w-".concat(Math.ceil(p/g*16)),k=[U9.replacementClass,a?"".concat(U9.familyPrefix,"-").concat(a):"",m].filter(function(e){return-1===f.classes.indexOf(e)}).filter(function(e){return""!==e||!!e}).concat(f.classes).join(" "),C={children:[],attributes:_9({},f.attributes,{"data-prefix":i,"data-icon":a,class:k,role:f.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(p," ").concat(g)})},w=y&&!~f.classes.indexOf("fa-fw")?{width:"".concat(p/g*16*.0625,"em")}:{};d&&(C.attributes["data-fa-i2svg"]=""),u&&C.children.push({tag:"title",attributes:{id:C.attributes["aria-labelledby"]||"title-".concat(l||cee())},children:[u]});var _=_9({},C,{prefix:i,iconName:a,main:n,mask:r,maskId:c,transform:o,symbol:s,styles:_9({},w,f.styles)}),E=r.found&&n.found?function(e){var t=e.children,n=e.attributes,r=e.main,i=e.mask,a=e.maskId,o=r.icon,s=i.icon,u=dee({transform:e.transform,containerWidth:i.width,iconWidth:r.width}),c={tag:"rect",attributes:_9({},vee,{fill:"white"})},l=o.children?{children:o.children.map(pee)}:{},f={tag:"g",attributes:_9({},u.inner),children:[pee(_9({tag:o.tag,attributes:_9({},o.attributes,u.path)},l))]},h={tag:"g",attributes:_9({},u.outer),children:[f]},d="mask-".concat(a||cee()),v="clip-".concat(a||cee()),p={tag:"mask",attributes:_9({},vee,{id:d,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[c,h]},g={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:gee(s)},p]};return t.push(g,{tag:"rect",attributes:_9({fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(d,")")},vee)}),{children:t,attributes:n}}(_):function(e){var t=e.children,n=e.attributes,r=e.main,i=e.transform,a=fee(e.styles);if(a.length>0&&(n.style=a),hee(i)){var o=dee({transform:i,containerWidth:r.width,iconWidth:r.width});t.push({tag:"g",attributes:_9({},o.outer),children:[{tag:"g",attributes:_9({},o.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:_9({},r.icon.attributes,o.path)}]}]})}else t.push(r.icon);return{children:t,attributes:n}}(_),b=E.attributes;return _.children=E.children,_.attributes=b,s?function(e){var t=e.iconName,n=e.children,r=e.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:_9({},e.attributes,{id:!0===r?"".concat(e.prefix,"-").concat(U9.familyPrefix,"-").concat(t):r}),children:n}]}]}(_):function(e){var t=e.children,n=e.main,r=e.mask,i=e.attributes,a=e.styles,o=e.transform;if(hee(o)&&n.found&&!r.found){var s={x:n.width/n.height/2,y:.5};i.style=fee(_9({},a,{"transform-origin":"".concat(s.x+o.x/16,"em ").concat(s.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:t}]}(_)}var mee=function(e,t,n,r){var i,a,o,s=Object.keys(e),u=s.length,c=void 0!==r?function(e,t){return function(n,r,i,a){return e.call(t,n,r,i,a)}}(t,r):t;for(void 0===n?(i=1,o=e[s[0]]):(i=0,o=n);i<u;i++)o=c(o,e[a=s[i]],a,e);return o};function kee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,a=Object.keys(t).reduce(function(e,n){var r=t[n];return r.icon?e[r.iconName]=r.icon:e[n]=r,e},{});"function"!=typeof B9.hooks.addPack||i?B9.styles[e]=_9({},B9.styles[e]||{},a):B9.hooks.addPack(e,a),"fas"===e&&kee("fa",t)}var Cee=B9.styles,wee=B9.shims,_ee=function(){var e=function(e){return mee(Cee,function(t,n,r){return t[r]=mee(n,e,{}),t},{})};e(function(e,t,n){return t[3]&&(e[t[3]]=n),e}),e(function(e,t,n){var r=t[2];return e[n]=n,r.forEach(function(t){e[t]=n}),e});var t="far"in Cee;mee(wee,function(e,n){var r=n[1];return"far"===r&&!t&&(r="fas"),e[n[0]]={prefix:r,iconName:n[2]},e},{})};function Eee(e,t,n){if(e&&e[t]&&e[t][n])return{prefix:t,iconName:n,icon:e[t][n]}}function bee(e){var t=e.tag,n=e.attributes,r=void 0===n?{}:n,i=e.children,a=void 0===i?[]:i;return"string"==typeof e?lee(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(function(t,n){return t+"".concat(n,'="').concat(lee(e[n]),'" ')},"").trim()}(r),">").concat(a.map(bee).join(""),"</").concat(t,">")}function See(e){this.name="MissingIcon",this.message=e||"Icon unavailable",this.stack=(new Error).stack}_ee(),(See.prototype=Object.create(Error.prototype)).constructor=See;var Pee={fill:"currentColor"},Oee={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},Tee=(_9({},Pee,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}),_9({},Oee,{attributeName:"opacity"}));function Iee(e){var t=e[0],n=e[1],r=E9(e.slice(4),1)[0];return{found:!0,width:t,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(U9.familyPrefix,"-").concat(D9.GROUP)},children:[{tag:"path",attributes:{class:"".concat(U9.familyPrefix,"-").concat(D9.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(U9.familyPrefix,"-").concat(D9.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}_9({},Pee,{cx:"256",cy:"364",r:"28"}),_9({},Oee,{attributeName:"r",values:"28;14;28;28;14;28;"}),_9({},Tee,{values:"1;0;1;1;0;1;"}),_9({},Pee,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),_9({},Tee,{values:"1;0;0;0;0;1;"}),_9({},Pee,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),_9({},Tee,{values:"0;0;1;1;0;0;"});var Aee=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.definitions={}}return function(e,t,n){t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t)}(e,[{key:"add",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(t){e.definitions[t]=_9({},e.definitions[t]||{},i[t]),kee(t,i[t]),_ee()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,t){var n=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(n).map(function(t){var r=n[t],i=r.prefix,a=r.iconName,o=r.icon;e[i]||(e[i]={}),e[i][a]=o}),e}}]),e}();function Ree(){U9.autoAddCss&&!Dee&&(function(e){if(e&&A9){var t=I9.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;for(var n=I9.head.childNodes,r=null,i=n.length-1;i>-1;i--){var a=n[i],o=(a.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=a)}I9.head.insertBefore(t,r)}}(function(){var e="fa",t=M9,n=U9.familyPrefix,r=U9.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==e||r!==t){var a=new RegExp("\\.".concat(e,"\\-"),"g"),o=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(a,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(s,".".concat(r))}return i}()),Dee=!0)}function Mee(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map(function(e){return bee(e)})}}),Object.defineProperty(e,"node",{get:function(){if(A9){var t=I9.createElement("div");return t.innerHTML=e.html,t.children}}}),e}function xee(e){var t=e.prefix,n=void 0===t?"fa":t,r=e.iconName;if(r)return Eee(Nee.definitions,n,r)||Eee(B9.styles,n,r)}var Nee=new Aee,Dee=!1,Lee=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:xee(t||{}),i=n.mask;return i&&(i=(i||{}).icon?i:xee(i||{})),e(r,_9({},n,{mask:i}))}}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.transform,r=void 0===n?uee:n,i=t.symbol,a=void 0!==i&&i,o=t.mask,s=void 0===o?null:o,u=t.maskId,c=void 0===u?null:u,l=t.title,f=void 0===l?null:l,h=t.titleId,d=void 0===h?null:h,v=t.classes,p=void 0===v?[]:v,g=t.attributes,y=void 0===g?{}:g,m=t.styles,k=void 0===m?{}:m;if(e){var C=e.prefix,w=e.iconName,_=e.icon;return Mee(_9({type:"icon"},e),function(){return Ree(),U9.autoA11y&&(f?y["aria-labelledby"]="".concat(U9.replacementClass,"-title-").concat(d||cee()):(y["aria-hidden"]="true",y.focusable="false")),yee({icons:{main:Iee(_),mask:s?Iee(s.icon):{found:!1,width:null,height:null,icon:{}}},prefix:C,iconName:w,transform:_9({},uee,r),symbol:a,title:f,maskId:c,titleId:d,extra:{attributes:y,styles:k,classes:p}})})}}),Fee=["*"],Uee=function(e){var t,n=(Zg(t={"fa-spin":e.spin,"fa-pulse":e.pulse,"fa-fw":e.fixedWidth,"fa-border":e.border,"fa-inverse":e.inverse,"fa-layers-counter":e.counter,"fa-flip-horizontal":"horizontal"===e.flip||"both"===e.flip,"fa-flip-vertical":"vertical"===e.flip||"both"===e.flip},"fa-".concat(e.size),null!==e.size),Zg(t,"fa-rotate-".concat(e.rotate),null!==e.rotate),Zg(t,"fa-pull-".concat(e.pull),null!==e.pull),Zg(t,"fa-stack-".concat(e.stackItemSize),null!=e.stackItemSize),t);return Object.keys(n).map(function(e){return n[e]?e:null}).filter(function(e){return e})},Vee=function(){var e=dy(function e(){fy(this,e),this.defaultPrefix="fas",this.fallbackIcon=null});return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Bee=function(){var e=function(){function e(){fy(this,e),this.definitions={}}return dy(e,[{key:"addIcons",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];a.prefix in this.definitions||(this.definitions[a.prefix]={}),this.definitions[a.prefix][a.iconName]=a;var o,s=uy(a.icon[2]);try{for(s.s();!(o=s.n()).done;){var u=o.value;"string"==typeof u&&(this.definitions[a.prefix][u]=a)}}catch(c){s.e(c)}finally{s.f()}}}},{key:"addIconPacks",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=o[a],n=Object.keys(t).map(function(e){return t[e]});e.addIcons.apply(e,oy(n))},a=0,o=n;a<o.length;a++)i()}},{key:"getIconDefinition",value:function(e,t){return e in this.definitions&&t in this.definitions[e]?this.definitions[e][t]:null}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),zee=function(){var e=function(){function e(){fy(this,e),this.stackItemSize="1x"}return dy(e,[{key:"ngOnChanges",value:function(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=pk({type:e,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[Tk]}),e}(),Hee=function(){var e=function(){function e(t,n){fy(this,e),this.renderer=t,this.elementRef=n}return dy(e,[{key:"ngOnInit",value:function(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}},{key:"ngOnChanges",value:function(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,"fa-".concat(e.size.currentValue)),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,"fa-".concat(e.size.previousValue)))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(RO),yS(TO))},e.\u0275cmp=ck({type:e,selectors:[["fa-stack"]],inputs:{size:"size"},features:[Tk],ngContentSelectors:Fee,decls:1,vars:0,template:function(e,t){1&e&&(function(e){var t=Xk()[16][6];if(!t.projection)for(var n=t.projection=_w(1,null),r=n.slice(),i=t.child;null!==i;){r[0]?r[0].projectionNext=i:n[0]=i,r[0]=i,i=i.next}}(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=Xk(),i=Jk(),a=ZE(i,20+e,16,null,n||null);null===a.projection&&(a.projection=t),oC(),64!=(64&a.flags)&&function(e,t,n){CE(t[11],0,t,n,nE(e,n,t),uE(n.parent||t[6],n,t))}(i,r,a)}(0))},encapsulation:2}),e}(),Gee=function(){var e=function(){function e(t,n,r,i,a){fy(this,e),this.sanitizer=t,this.config=n,this.iconLibrary=r,this.stackItem=i,this.classes=[],null!=a&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}return dy(e,[{key:"ngOnChanges",value:function(e){var t;if(null==this.icon&&null==this.config.fallbackIcon)return function(){throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")}();var n;if(n=null!==(t=this.icon)&&void 0!==t?t:this.config.fallbackIcon,e){var r=this.findIconDefinition(n);if(null!=r){var i=this.buildParams();this.renderIcon(r,i)}}}},{key:"render",value:function(){this.ngOnChanges({})}},{key:"findIconDefinition",value:function(e){var t,n,r,i,a=(n=e,r=this.config.defaultPrefix,void 0!==(i=n).prefix&&void 0!==i.iconName?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:r,iconName:n}:void 0);return"icon"in a?a:null!==(t=this.iconLibrary.getIconDefinition(a.prefix,a.iconName))&&void 0!==t?t:(function(e){throw new Error("Could not find icon with iconName=".concat(e.iconName," and prefix=").concat(e.prefix," in the icon library."))}(a),null)}},{key:"buildParams",value:function(){var e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},t="string"==typeof this.transform?function(e){var t={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(e,t){var n=t.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return e.flipX=!0,e;if(r&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(r){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e},t):t}(this.transform):this.transform;return{title:this.title,transform:t,classes:[].concat(oy(Uee(e)),oy(this.classes)),mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}},{key:"renderIcon",value:function(e,t){var n=Lee(e,t);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(n.html.join("\n"))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(BR),yS(Vee),yS(Bee),yS(zee,8),yS(Hee,8))},e.\u0275cmp=ck({type:e,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,t){2&e&&(uP("innerHTML",t.renderedIconHTML,O_),lS("title",t.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[Tk],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),$ee=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e}),e.\u0275inj=Nm({}),e}();function Zee(e,t){if(1&e&&(ES(0),_S(1,"fa-icon",24),bS()),2&e){var n=RS();DE(1),mS("icon",n.faSpinner)}}function qee(e,t){if(1&e){var n=SS();ES(0),CS(1,"div",9),CS(2,"a",10),rP(3),wS(),CS(4,"div",12),CS(5,"a",26),TS("click",function(){return eC(n),RS(2).logout()}),fO(6,27),wS(),wS(),wS(),bS()}if(2&e){var r=RS(2);DE(3),iP(r.username.get())}}var Wee=function(){return["/register"]},jee=function(){return["/login"]};function Yee(e,t){1&e&&(CS(0,"div",28),CS(1,"a",29),CS(2,"strong"),fO(3,30),wS(),wS(),CS(4,"a",31),fO(5,32),wS(),wS()),2&e&&(DE(1),mS("routerLink",ST(2,Wee)),DE(3),mS("routerLink",ST(3,jee)))}function Kee(e,t){if(1&e&&(pS(0,qee,7,1,"ng-container",22),pS(1,Yee,6,4,"ng-template",null,25,XT)),2&e){var n=gS(2);mS("ngIf",RS().username.isPresent())("ngIfElse",n)}}var Qee=function(){return["/"]},Xee=function(){return["/play"]},Jee=function(){return["/lobby"]},ete=function(){return["/local"]},tte=function(){return["/tutorial"]},nte=function(){return["/settings"]},rte=function(){var e=function(){function e(t,n,r){fy(this,e),this.router=t,this.connectedUserService=n,this.userService=r,this.loading=!0,this.username=RB.empty(),this.faCog=v9,this.faSpinner=k9,this.showMenu=!1}return dy(e,[{key:"ngOnInit",value:function(){var e=this;this.userSub=this.connectedUserService.subscribeToUser(function(t){e.loading=!1,e.username=t.username.isPresent()?t.username:t.email})}},{key:"logout",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.disconnect();case 2:return t.next=4,e.router.navigate(["/"]);case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF),yS(B7),yS(L7))},e.\u0275cmp=ck({type:e,selectors:[["app-header"]],decls:35,vars:19,consts:function(){return[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],$localize(p||(p=Hg(["Home"]))),[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],$localize(g||(g=Hg(["Play online"]))),[1,"navbar-dropdown"],$localize(y||(y=Hg(["Create a game"]))),$localize(m||(m=Hg(["Join a game"]))),$localize(k||(k=Hg(["Play offline"]))),$localize(C||(C=Hg(["Create a game"]))),$localize(w||(w=Hg(["Learn the rules"]))),[1,"navbar-end"],["data-tooltip",$localize(_||(_=Hg(["Settings"]))),1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","logout",1,"navbar-item",3,"click"],$localize(E||(E=Hg(["Log out"]))),[1,"buttons"],[1,"button","is-primary",3,"routerLink"],$localize(b||(b=Hg(["Register"]))),[1,"button","is-light",3,"routerLink"],$localize(S||(S=Hg(["Log in"])))]},template:function(e,t){if(1&e&&(CS(0,"nav",0),CS(1,"div",1),CS(2,"a",2),_S(3,"img",3),wS(),CS(4,"a",4),TS("click",function(){return t.showMenu=!t.showMenu}),_S(5,"span",5),_S(6,"span",5),_S(7,"span",5),wS(),wS(),CS(8,"div",6),TS("click",function(){return t.showMenu=!t.showMenu}),CS(9,"div",7),CS(10,"a",2),fO(11,8),wS(),CS(12,"div",9),CS(13,"a",10),fO(14,11),wS(),CS(15,"div",12),CS(16,"a",2),fO(17,13),wS(),CS(18,"a",2),fO(19,14),wS(),wS(),wS(),CS(20,"div",9),CS(21,"a",10),fO(22,15),wS(),CS(23,"div",12),CS(24,"a",2),fO(25,16),wS(),CS(26,"a",2),fO(27,17),wS(),wS(),wS(),wS(),CS(28,"div",18),CS(29,"a",19),_S(30,"fa-icon",20),wS(),CS(31,"div",21),pS(32,Zee,2,1,"ng-container",22),pS(33,Kee,3,2,"ng-template",null,23,XT),wS(),wS(),wS(),wS()),2&e){var n=gS(34);DE(2),mS("routerLink",ST(12,Qee)),DE(2),mS("ngClass",t.showMenu?"is-active":""),DE(4),mS("ngClass",t.showMenu?"is-active":""),DE(2),mS("routerLink",ST(13,Qee)),DE(6),mS("routerLink",ST(14,Xee)),DE(2),mS("routerLink",ST(15,Jee)),DE(6),mS("routerLink",ST(16,ete)),DE(2),mS("routerLink",ST(17,tte)),DE(3),mS("routerLink",ST(18,nte)),DE(1),mS("icon",t.faCog),DE(2),mS("ngIf",t.loading)("ngIfElse",n)}},directives:[yF,eR,Gee,iR],encapsulation:2}),e}(),ite=function(){var e=dy(function e(t,n){fy(this,e),this._themeService=t,this._errorLoggerService=n,this.faTwitter=c9,this.faFacebook=s9,this.faGithub=u9});return e.\u0275fac=function(t){return new(t||e)(yS(h9),yS(x7))},e.\u0275cmp=ck({type:e,selectors:[["app-root"]],decls:18,vars:3,consts:function(){return[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],$localize(P||(P=Hg(["If you like ",":START_TAG_STRONG:EveryBoard",":CLOSE_TAG_STRONG:, follow us!"])),"\ufffd#8\ufffd","\ufffd/#8\ufffd"),["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoard"],["href","https://facebook.com/EveryBoard"]]},template:function(e,t){1&e&&(_S(0,"app-header"),CS(1,"main",0),_S(2,"router-outlet"),wS(),CS(3,"footer",1),CS(4,"div",2),CS(5,"p"),CS(6,"span"),cO(7,3),_S(8,"strong"),lO(),wS(),rP(9," \xa0 "),CS(10,"a",4),_S(11,"fa-icon",5),wS(),rP(12,"\xa0 "),CS(13,"a",6),_S(14,"fa-icon",5),wS(),rP(15,"\xa0 "),CS(16,"a",7),_S(17,"fa-icon",5),wS(),wS(),wS(),wS()),2&e&&(DE(11),mS("icon",t.faGithub),DE(3),mS("icon",t.faTwitter),DE(3),mS("icon",t.faFacebook))},directives:[rte,kF,Gee],encapsulation:2}),e}(),ate=function(){function e(t,n){fy(this,e),this.x=t,this.y=n}return dy(e,[{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}}]),e}(),ote=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isDown",value:function(){return 1===this.y}},{key:"isUp",value:function(){return-1===this.y}},{key:"isLeft",value:function(){return-1===this.x}},{key:"isRight",value:function(){return 1===this.x}},{key:"toInt",value:function(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}},{key:"toString",value:function(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}]),n}(ate),ste=function(){function e(){fy(this,e)}return dy(e,[{key:"of",value:function(e,t){var n,r=uy(this.all);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.x===e&&i.y===t)return MB.success(i)}}catch(a){r.e(a)}finally{r.f()}return MB.failure("Invalid x and y in direction construction")}},{key:"fromDelta",value:function(e,t){return 0===e&&0===t?MB.failure("Empty delta for direction"):Math.abs(e)===Math.abs(t)||0===e||0===t?this.of(Math.sign(e),Math.sign(t)):MB.failure(lte.DIRECTION_MUST_BE_LINEAR())}},{key:"fromMove",value:function(e,t){return this.fromDelta(t.x-e.x,t.y-e.y)}},{key:"fromString",value:function(e){switch(e){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return MB.failure("Invalid direction string ".concat(e))}}},{key:"fromInt",value:function(e){switch(e){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return MB.failure("Invalid int direction: ".concat(e))}}}]),e}(),ute=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,r)}return dy(n,[{key:"isDiagonal",value:function(){return 0!==this.x&&0!==this.y}},{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ote);ute.UP=new ute(0,-1),ute.UP_RIGHT=new ute(1,-1),ute.RIGHT=new ute(1,0),ute.DOWN_RIGHT=new ute(1,1),ute.DOWN=new ute(0,1),ute.DOWN_LEFT=new ute(-1,1),ute.LEFT=new ute(-1,0),ute.UP_LEFT=new ute(-1,-1),ute.factory=new(function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).all=[ute.UP,ute.UP_RIGHT,ute.RIGHT,ute.DOWN_RIGHT,ute.DOWN,ute.DOWN_LEFT,ute.LEFT,ute.UP_LEFT],e}return dy(n)}(ste)),ute.DIRECTIONS=ute.factory.all,ute.DIAGONALS=[ute.UP_RIGHT,ute.DOWN_RIGHT,ute.DOWN_LEFT,ute.UP_LEFT],ute.ORTHOGONALS=[ute.UP,ute.RIGHT,ute.DOWN,ute.LEFT],ute.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return N7("string"==typeof e,"Invalid encoded direction"),ute.factory.fromString(e).get()}}]),n}(q7));var cte=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,r)}return dy(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}]),n}(ote);cte.UP=new cte(0,-1),cte.RIGHT=new cte(1,0),cte.DOWN=new cte(0,1),cte.LEFT=new cte(-1,0),cte.factory=new(function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).all=[cte.UP,cte.RIGHT,cte.DOWN,cte.LEFT],e}return dy(n,[{key:"of",value:function(e,t){return 0===e&&-1===t?MB.success(cte.UP):1===e&&0===t?MB.success(cte.RIGHT):0===e&&1===t?MB.success(cte.DOWN):-1===e&&0===t?MB.success(cte.LEFT):MB.failure("Invalid orthogonal from x and y")}}]),n}(ste)),cte.ORTHOGONALS=cte.factory.all,cte.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encode",value:function(e){return e.toString()}},{key:"decode",value:function(e){return N7("string"==typeof e,"Invalid encoded orthogonal"),cte.factory.fromString(e).get()}}]),n}(q7));var lte=function(){var e=dy(function e(){fy(this,e)});return e.DIRECTION_MUST_BE_LINEAR=function(){return $localize(O||(O=Hg(["You must move in a straight line! You can only move orthogonally or diagonally!"])))},e}(),fte=function(){function e(t,n){fy(this,e),this.x=t,this.y=n}return dy(e,[{key:"getNext",value:function(t,n){var r;return new e(this.x+(n=null!==(r=n)&&void 0!==r?r:1)*t.x,this.y+n*t.y)}},{key:"getPrevious",value:function(e,t){var n;return this.getNext(e,-(t=null!==(n=t)&&void 0!==n?n:1))}},{key:"getLeft",value:function(t){return new e(this.x+t.y,this.y+-t.x)}},{key:"getRight",value:function(t){return new e(this.x+-t.y,this.y+t.x)}},{key:"getOpposite",value:function(){return new e(-this.x,-this.y)}},{key:"isInRange",value:function(e,t){return!(this.x<0||this.y<0||this.x>=e||this.y>=t)}},{key:"isNotInRange",value:function(e,t){return this.x<0||this.y<0||this.x>=e||this.y>=t}},{key:"getDirectionToward",value:function(e){return ute.factory.fromMove(this,e)}},{key:"getOrthogonalDistance",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"getDistance",value:function(e){if(!e.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");var t=Math.abs(e.x-this.x),n=Math.abs(e.y-this.y);return Math.max(t,n)}},{key:"isHexagonallyAlignedWith",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t!==n&&(t===-n||t*n==0)}},{key:"isAlignedWith",value:function(e){var t=Math.abs(this.x-e.x),n=Math.abs(this.y-e.y);return t===n||t*n==0}},{key:"getVectorToward",value:function(t){return new e(t.x-this.x,t.y-this.y)}},{key:"getMinimalVectorToward",value:function(e){return this.getVectorToward(e).toVector()}},{key:"getCoordsToward",value:function(e){if(e.equals(this))return[];if(!e.isAlignedWith(this))return[];for(var t=this.getDirectionToward(e).get(),n=this.getNext(t,1),r=[];!1===n.equals(e);)r.push(n),n=n.getNext(t,1);return r}},{key:"toVector",value:function(){for(var t=Math.abs(this.x),n=Math.abs(this.y),r=Math.max(t,n),i=this.x,a=this.y,o=2;o<=r;)i%o==0&&a%o==0?(i/=o,a/=o):o++;return new e(i,a)}},{key:"isBetween",value:function(e,t){var n=e.getMinimalVectorToward(this),r=t.getMinimalVectorToward(this);return n.equals(r.getOpposite())}},{key:"getUntil",value:function(e){for(var t=[],n=this.getDirectionToward(e).get(),r=this.getNext(n);!1===r.equals(e);)t.push(r),r=r.getNext(n);return t}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y}},{key:"compareTo",value:function(e){return e.y===this.y?e.x===this.x?0:this.x<e.x?-1:1:this.y<e.y?-1:1}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}}],[{key:"numberEncoder",value:function(t,n){return j7.tuple([j7.numberEncoder(t),j7.numberEncoder(n)],function(e){return[e.x,e.y]},function(t){return new e(t[0],t[1])})}}]),e}();fte.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encode",value:function(e){return{x:e.x,y:e.y}}},{key:"decode",value:function(e){var t=e;return N7(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new fte(t.x,t.y)}}]),n}(q7));var hte=function(){var e=function(){function e(t){fy(this,e),this.messageDisplayer=t,this.Player=Q7,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=RB.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}return dy(e,[{key:"message",value:function(e){this.messageDisplayer.gameMessage(e)}},{key:"cancelMove",value:function(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?DB.SUCCESS:(this.messageDisplayer.gameMessage(e),DB.failure(e))}},{key:"cancelMoveAttempt",value:function(){}},{key:"getPlayerClass",value:function(e){switch(e){case Q7.ZERO:return"player0";case Q7.ONE:return"player1";default:return PB.expectToBe(e,K7.NONE),""}}},{key:"pass",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",x7.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name}));case 1:case"end":return t.stop()}},t)}))()}},{key:"getTurn",value:function(){return this.rules.node.gameState.turn}},{key:"getCurrentPlayer",value:function(){return this.rules.node.gameState.getCurrentPlayer()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"range",value:function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),dte=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getHexaCoordsBy",value:function(e,t){var n=new fte(e,t);return this.getHexaCoordsAt(n)}},{key:"getHexaCoordsAt",value:function(e){var t,n="",r=this.hexaLayout.getHexaCoordsAt(e),i=uy(r);try{for(i.s();!(t=i.n()).done;){var a=t.value;n+=a.x+" "+a.y+" "}}catch(o){i.e(o)}finally{i.f()}return n+=r[0].x+" "+r[0].y}},{key:"getCenterBy",value:function(e,t){var n=new fte(e,t);return this.getCenterAt(n)}},{key:"getCenterAt",value:function(e){return this.hexaLayout.getCenterAt(e)}}]),n}(hte);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275cmp=ck({type:t,selectors:[["ng-component"]],features:[Qb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),vte=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"equals",value:function(e){return this===e}},{key:"is",value:function(e){return this.value===e.value}},{key:"isPlayer",value:function(){return this===e.ZERO||this===e.ONE}}],[{key:"from",value:function(t){switch(t){case e.ZERO.value:return e.ZERO;case e.ONE.value:return e.ONE;case e.EMPTY.value:return e.EMPTY;case e.UNREACHABLE.value:return e.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}},{key:"ofPlayer",value:function(t){return t===Q7.ZERO?e.ZERO:(PB.expectToBe(t,Q7.ONE),e.ONE)}}]),e}();vte.ZERO=new vte(Q7.ZERO.value),vte.ONE=new vte(Q7.ONE.value),vte.EMPTY=new vte(K7.NONE.value),vte.UNREACHABLE=new vte(3);var pte=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,r)}return dy(n,[{key:"getOpposite",value:function(){return n.factory.of(-this.x,-this.y).get()}}],[{key:"getAngle",value:function(e){switch(e){case n.UP:return 0;case n.UP_RIGHT:return 60;case n.RIGHT:return 120;case n.DOWN:return 180;case n.DOWN_LEFT:return 240;default:return PB.expectToBe(e,n.LEFT),300}}}]),n}(ote);pte.UP=new pte(0,-1),pte.LEFT=new pte(-1,0),pte.UP_RIGHT=new pte(1,-1),pte.DOWN_LEFT=new pte(-1,1),pte.RIGHT=new pte(1,0),pte.DOWN=new pte(0,1),pte.factory=new(function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).all=[pte.UP,pte.UP_RIGHT,pte.RIGHT,pte.DOWN,pte.DOWN_LEFT,pte.LEFT],e}return dy(n)}(ste)),pte.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){switch(e){case pte.UP:return 0;case pte.UP_RIGHT:return 1;case pte.RIGHT:return 2;case pte.DOWN:return 3;case pte.DOWN_LEFT:return 4;default:return 5}}},{key:"decodeNumber",value:function(e){return N7(0<=e&&e<=5,"Invalid encoded number for HexaDirection "+e),pte.factory.all[e]}}]),n}(j7));var gte=function(){function e(t,n,r){fy(this,e),this.size=t,this.origin=n,this.orientation=r}return dy(e,[{key:"getCenterAt",value:function(e){var t=this.orientation.conversionMatrix;return new fte(this.size*(t[0]*e.x+t[1]*e.y)+this.origin.x,this.size*(t[2]*e.x+t[3]*e.y)+this.origin.y)}},{key:"getCornerOffset",value:function(e){var t=2*Math.PI*(this.orientation.startAngle+e)/6;return new fte(this.size*Math.cos(t),this.size*Math.sin(t))}},{key:"getHexaCoordsAt",value:function(e){for(var t=this.getCenterAt(e),n=[],r=0;r<6;r+=1){var i=this.getCornerOffset(r);n.push(new fte(t.x+i.x,t.y+i.y))}return n}}]),e}(),yte=dy(function e(){fy(this,e)}),mte=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.call(this)).startAngle=.5,e.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],e.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3],e}return dy(n)}(yte);mte.INSTANCE=new mte;var kte=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.call(this)).startAngle=0,e.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],e.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3],e}return dy(n,[{key:"isOnBorder",value:function(e,t){return this.isOnTopRightBorder(e,t)||this.isOnRightBorder(e,t)||this.isOnBottomRightBorder(e,t)||this.isOnBottomLeftBorder(e,t)||this.isOnLeftBorder(e,t)||this.isOnTopLeftBorder(e,t)}},{key:"isOnTopRightBorder",value:function(e,t){return 0===t.y}},{key:"isOnRightBorder",value:function(e,t){return t.x===e.width-1}},{key:"isOnLeftBorder",value:function(e,t){return 0===t.x}},{key:"isOnBottomLeftBorder",value:function(e,t){return t.y===e.height-1}},{key:"isOnTopLeftBorder",value:function(e,t){return null!=e.excludedCases[t.y]?t.x===e.excludedCases[t.y]:t.y===e.excludedCases.length&&0===t.x}},{key:"isOnBottomRightBorder",value:function(e,t){return null!=e.excludedCases[e.height-1-t.y]?e.width-1-t.x===e.excludedCases[e.height-1-t.y]:e.height-1-t.y===e.excludedCases.length&&t.x===e.width-1}},{key:"getAllBorders",value:function(e){var t=this,n=[];return e.forEachCoord(function(r,i){t.isOnBorder(e,r)&&n.push(r)}),n}},{key:"isTopCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnTopRightBorder(e,t)}},{key:"isTopLeftCorner",value:function(e,t){return this.isOnTopLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isTopRightCorner",value:function(e,t){return this.isOnTopRightBorder(e,t)&&this.isOnRightBorder(e,t)}},{key:"isBottomCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnBottomRightBorder(e,t)}},{key:"isBottomLeftCorner",value:function(e,t){return this.isOnBottomLeftBorder(e,t)&&this.isOnLeftBorder(e,t)}},{key:"isBottomRightCorner",value:function(e,t){return this.isOnBottomRightBorder(e,t)&&this.isOnRightBorder(e,t)}}]),n}(yte);kte.INSTANCE=new kte;var Cte=function(){var e=dy(function e(){fy(this,e)});return e.CANNOT_CHOOSE_OPPONENT_PIECE=function(){return $localize(T||(T=Hg(["You cannot pick a piece of the opponent."])))},e.MUST_CLICK_ON_EMPTY_SPACE=function(){return $localize(I||(I=Hg(["You must click on an empty space."])))},e.MUST_CLICK_ON_EMPTY_SQUARE=function(){return $localize(A||(A=Hg(["You must click on an empty square."])))},e.CANNOT_SELF_CAPTURE=function(){return $localize(R||(R=Hg(["Your landing space should be empty or contain a piece of the opponent."])))},e.MUST_CHOOSE_PLAYER_PIECE=function(){return $localize(M||(M=Hg(["You must pick one of your pieces."])))},e.CANNOT_PASS=function(){return $localize(x||(x=Hg(["You cannot pass your turn."])))},e.MUST_LAND_ON_EMPTY_SPACE=function(){return $localize(N||(N=Hg(["You must drop your piece on an empty space."])))},e.MUST_PASS=function(){return $localize(D||(D=Hg(["You must pass your turn."])))},e.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=function(){return $localize(L||(L=Hg(["You have selected an empty space, you must select one of your own pieces."])))},e.MOVE_CANNOT_BE_STATIC=function(){return $localize(F||(F=Hg(["You must choose different starting and ending coordinates."])))},e.SOMETHING_IN_THE_WAY=function(){return $localize(U||(U=Hg(["There is a piece between the piece you chose and its landing space."])))},e}(),wte=function(){function e(t,n){fy(this,e),this.ruler=t,this.name=n}return dy(e,[{key:"toString",value:function(){return this.name}}]),e}(),_te=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"toString",value:function(){return""+this.value}}],[{key:"fromWinner",value:function(t){return t.isPlayer()?new e(t.getVictoryValue()):new e(0)}}]),e}(),Ete=function(){function e(){fy(this,e)}return dy(e,null,[{key:"toComparableObjectSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return t.equals(e)})||t.push(e)}),t}},{key:"toComparableSet",value:function(e){var t=[];return e.forEach(function(e){t.some(function(t){return AB(t,e)})||t.push(e)}),t}}]),e}(),bte=function(e){function t(e){fy(this,t),this.values=void 0===e?[]:Ete.toComparableSet(e)}return dy(t,[{key:"equals",value:function(e){if(e.size()!==this.size())return!1;var t,n=uy(this);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===e.contains(r))return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"toString",value:function(){var e,t="",n=uy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+=null==r?"null, ":r.toString()+", "}}catch(i){n.e(i)}finally{n.f()}return"["+t.slice(0,-2)+"]"}},{key:"add",value:function(e){return!this.contains(e)&&(this.values.push(e),!0)}},{key:"union",value:function(e){var t,n=uy(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.add(r)}}catch(i){n.e(i)}finally{n.f()}}},{key:"contains",value:function(e){var t,n=uy(this.values);try{for(n.s();!(t=n.n()).done;){if(AB(t.value,e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"size",value:function(){return this.values.length}},{key:"toList",value:function(){var e,t=[],n=uy(this);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(r)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"getAnyElement",value:function(){return this.size()>0?RB.of(this.values[0]):RB.empty()}},{key:Symbol.iterator,value:function(){return this.values.values()}}]),t}(),Ste=function(){function e(t){fy(this,e),this.turn=t}return dy(e,[{key:"getCurrentPlayer",value:function(){return Q7.fromTurn(this.turn)}},{key:"getCurrentOpponent",value:function(){return this.turn%2==1?Q7.ZERO:Q7.ONE}}]),e}(),Pte=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,r)).board=e,i}return dy(n,[{key:"getPieceAt",value:function(e){if(this.isOnBoard(e))return this.board[e.y][e.x];throw new Error("Accessing coord not on board "+e+".")}},{key:"tryToGetPieceAt",value:function(e){return this.isOnBoard(e)?RB.of(this.board[e.y][e.x]):RB.empty()}},{key:"isOnBoard",value:function(e){return e.isInRange(this.board[0].length,this.board.length)}},{key:"getPieceAtXY",value:function(e,t){return this.getPieceAt(new fte(e,t))}},{key:"forEachCoord",value:function(e){var t,n=uy(this.getCoordsAndContents());try{for(n.s();!(t=n.n()).done;){var r=qg(t.value,2);e(r[0],r[1])}}catch(i){n.e(i)}finally{n.f()}}},{key:"getCoordsAndContents",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new fte(n,t);this.isOnBoard(r)&&e.push([r,this.getPieceAt(r)])}return e}},{key:"getCopiedBoard",value:function(){return t9.copyBiArray(this.board)}}]),n}(Ste),Ote=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isInBoard",value:function(e){return e.isInRange(9,9)&&this.getPieceAt(e)!==vte.UNREACHABLE}},{key:"isPiece",value:function(e){return this.getPieceAt(e).isPlayer()}},{key:"getScores",value:function(){for(var e=[14,14],t=0;t<9;t++)for(var n=0;n<9;n++)this.getPieceAtXY(n,t)===vte.ZERO&&(e[1]=e[1]-1),this.getPieceAtXY(n,t)===vte.ONE&&(e[0]=e[0]-1);return e}}],[{key:"getInitialState",value:function(){var e=vte.EMPTY,t=vte.UNREACHABLE,r=vte.ZERO,i=vte.ONE;return new n([[t,t,t,t,i,i,i,i,i],[t,t,t,i,i,i,i,i,i],[t,t,e,e,i,i,i,e,e],[t,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,t],[e,e,r,r,r,e,e,t,t],[r,r,r,r,r,r,t,t,t],[r,r,r,r,r,t,t,t,t]],0)}}]),n}(Pte),Tte=dy(function e(){fy(this,e)}),Ite=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).coord=new fte(e,r),i}return dy(n)}(Tte),Ate=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;if(fy(this,n),(a=t.call(this,e.x,e.y)).dir=r,a.lastPiece=i,e.isNotInRange(9,9))throw new Error("Coord "+e.toString()+" out of range, invalid move!");return ny(a)}return dy(n,[{key:"toString",value:function(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}},{key:"isSingleCoord",value:function(){return this.lastPiece.isAbsent()}},{key:"equals",value:function(e){return e.coord.equals(this.coord)&&e.dir.equals(this.dir)&&e.lastPiece.equals(this.lastPiece)}}],[{key:"fromSingleCoord",value:function(e,t){try{return MB.success(new n(e,t,RB.empty()))}catch(r){return MB.failure(r.message)}}},{key:"fromDoubleCoord",value:function(e,t,r){var i=[e,t];t9.sortByDescending(i,n.sortCoord);var a=i[1].getDirectionToward(i[0]).get(),o=pte.factory.fromDelta(a.x,a.y);if(o.isFailure())return MB.failure("Invalid direction");var s=o.get();return i[1].getDistance(i[0])>2?MB.failure("Distance between first coord and last coord is too great"):s.equals(r)?n.fromSingleCoord(i[1],r):s.getOpposite().equals(r)?n.fromSingleCoord(i[0],r):MB.success(new n(i[1],r,RB.of(i[0])))}},{key:"sortCoord",value:function(e){return 9*e.y+e.x}}]),n}(Ite);Ate.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 104831}},{key:"encodeNumber",value:function(e){var t=9*e.coord.x*8+8*e.coord.y+e.dir.toInt();if(e.isSingleCoord())return t;var n=e.lastPiece.get();return 9*n.x*2*9*9*8+2*n.y*9*9*8+648+t}},{key:"decodeNumber",value:function(e){var t=e%8;e=(e-t)/8;var n=pte.factory.fromInt(t).get(),r=e%9,i=(e=(e-r)/9)%9;e=(e-i)/9;var a=new fte(i,r);if(0===e)return Ate.fromSingleCoord(a,n).get();var o=(e=(e-1)/2)%9,s=(e=(e-o)/9)%9;e=(e-s)/9;var u=new fte(s,o);return Ate.fromDoubleCoord(a,u,n).get()}}]),n}(j7));var Rte=(function(e){e.VICTORY="VICTORY",e.PRE_VICTORY="PRE_VICTORY",e.DEFAULT="DEFAULT"}(Rte||(Rte={})),Rte),Mte=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];fy(this,e),this.map=t,this.isImmutable=n}return dy(e,[{key:"makeImmutable",value:function(){this.isImmutable=!0}},{key:"get",value:function(e){var t,n=uy(this.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(AB(r.key,e))return RB.of(r.value)}}catch(i){n.e(i)}finally{n.f()}return RB.empty()}},{key:"forEach",value:function(e){for(var t=0;t<this.map.length;t++)e(this.getByIndex(t))}},{key:"getByIndex",value:function(e){return this.map[e]}},{key:"putAll",value:function(e){this.checkImmutability("putAll");var t,n=uy(e.map);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.put(r.key,r.value)}}catch(i){n.e(i)}finally{n.f()}}},{key:"checkImmutability",value:function(e){if(this.isImmutable)throw new Error("Cannot call "+e+" on immutable map!")}},{key:"put",value:function(e,t){this.checkImmutability("put");var n,r=uy(this.map);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(AB(i.key,e)){var a=i.value;return i.value=t,RB.of(a)}}}catch(o){r.e(o)}finally{r.f()}return this.map.push({key:e,value:t}),RB.empty()}},{key:"containsKey",value:function(e){return this.map.some(function(t){return AB(t.key,e)})}},{key:"size",value:function(){return this.map.length}},{key:"listKeys",value:function(){return this.map.map(function(e){return e.key})}},{key:"getKeySet",value:function(){return new bte(this.listKeys())}},{key:"filter",value:function(t){var n,r=new e,i=uy(this.map);try{for(i.s();!(n=i.n()).done;){var a=n.value;t(a.key,a.value)&&r.set(a.key,a.value)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"replace",value:function(e,t){if(this.checkImmutability("replace"),this.get(e).isAbsent())throw new Error("No Value to replace for key "+e.toString()+"!");return this.put(e,t),t}},{key:"set",value:function(e,t){if(this.checkImmutability("set"),this.containsKey(e))throw new Error("Key "+e.toString()+" already exist in Map!");this.map.push({key:e,value:t})}},{key:"delete",value:function(e){this.checkImmutability("delete");for(var t=0;t<this.map.length;t++)if(AB(this.map[t].key,e)){var n=this.map[t].value,r=this.map.slice(0,t),i=this.map.slice(t+1);return this.map=r.concat(i),n}throw new Error('No Value to delete for key "'+e.toString()+'"!')}},{key:"getCopy",value:function(){var e,t=new this.constructor,n=uy(this.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value;t.set(r,this.get(r).get())}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"equals",value:function(e){var t=this.getKeySet(),n=e.getKeySet();if(!1===t.equals(n))return!1;var r,i=uy(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=this.get(a).get(),s=e.get(a);if(N7(s.isPresent(),"value is absent in a map even though its key is present!"),!1===AB(o,s.get()))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}}],[{key:"from",value:function(t){for(var n=Object.keys(t),r=new e,i=0,a=n;i<a.length;i++){var o=a[i];r.set(o,t[o])}return r}}]),e}(),xte=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"reverse",value:function(){var e,t=new n,r=uy(this.listKeys());try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.get(i).get();if(t.containsKey(a))t.get(a).get().add(i);else{var o=new bte;o.add(i),t.set(a,o)}}}catch(s){r.e(s)}finally{r.f()}return t}}]),n}(Mte),Nte=function(){var e=dy(function e(){fy(this,e)});return e.createdNodes=0,e.minimaxTime=0,e}(),Dte=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:RB.empty(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:RB.empty(),i=arguments.length>3?arguments[3]:void 0;if(fy(this,e),this.gameState=t,this.mother=n,this.move=r,this.minimaxCreator=i,this.childs=RB.empty(),this.hopedValue=new Mte,this.ownValue=new Mte,this.possibleMoves=new Mte,this.ownValue=new Mte,null!=i){var a=i.getBoardValue(this);this.ownValue.set(i.name,a),this.hopedValue.set(i.name,a.value)}Nte.createdNodes++,OB(e.VERBOSE||!1,"creating "+this.myToString())}return dy(e,[{key:"findBestMove",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=(new Date).getTime(),a=this.alphaBeta(e,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,t,n,r);a.gameState.turn>this.gameState.turn+1;)a=a.mother.get(),e--;return Nte.minimaxTime+=(new Date).getTime()-i,a.move.get()}},{key:"alphaBeta",value:function(t,n,r,i,a,o){if(t<1)return OB(e.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(i.ruler.getGameStatus(this).isEndGame)return OB(e.VERBOSE||!1,"isLeaf-EndGame("+e.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;var s=this.getPossibleMoves(i);N7(s.size()>0,"Minimax "+i.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=RB.of([]));var u=this.getBestChilds(s,t,n,r,i,a,o),c=this.getBestChildAmongst(u,a),l=c.hopedValue.get(i.toString()).get();return this.hopedValue.put(i.toString(),l),c}},{key:"getPossibleMoves",value:function(e){var t=this.possibleMoves.get(e.name);if(t.isAbsent()){var n=e.getListMoves(this);return this.possibleMoves.set(e.name,new bte(n)),new bte(n)}return t.get()}},{key:"getBestChilds",value:function(e,t,n,r,i,a,o){var s,u=[],c=this.gameState.getCurrentPlayer(),l=c===Q7.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,f=c===Q7.ZERO?function(e,t){return e<t}:function(e,t){return e>t},h=uy(e);try{for(h.s();!(s=h.n()).done;){var d=s.value,v=this.getOrCreateChild(d,i).alphaBeta(t-1,n,r,i,a,o),p=v.getHopedValue(i);if(f(p,l)||0===u.length?(l=p,u=[v]):p===l&&u.push(v),o&&f(l,c===Q7.ZERO?n:r))break;c===Q7.ZERO?r=Math.min(l,r):n=Math.max(l,n)}}catch(g){h.e(g)}finally{h.f()}return u}},{key:"getBestChildAmongst",value:function(e,t){return t?e[Math.floor(Math.random()*e.length)]:e[0]}},{key:"getOrCreateChild",value:function(t,n){var r=this.getSonByMove(t);if(r.isAbsent()){var i=n.ruler.isLegal(t,this.gameState),a=t.toString();N7(i.isSuccess(),'The minimax "'+n.name+'" has proposed an illegal move ('+a+"), this should not happen.");var o=n.ruler.applyLegalMove(t,this.gameState,i.get());r=RB.of(new e(o,RB.of(this),RB.of(t),n)),this.childs.get().push(r.get())}return r.get()}},{key:"getSonByMove",value:function(e){N7(this.childs.isPresent(),"Cannot get son of uncalculated node");var t,n=uy(this.childs.get());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.move.isPresent()&&r.move.equalsValue(e))return RB.of(r)}}catch(i){n.e(i)}finally{n.f()}return RB.empty()}},{key:"getInitialNode",value:function(){for(var e=this;e.mother.isPresent();)e=e.mother.get();return e}},{key:"getHopedValue",value:function(e){return this.hopedValue.get(e.name).get()}},{key:"getOwnValue",value:function(e){var t=this.ownValue.get(e.name);if(t.isAbsent()){var n=e.getBoardValue(this);return this.ownValue.set(e.name,n),n}return t.get()}},{key:"myToString",value:function(){var e="",t=this;if(t.mother.isAbsent())return"NodeInitial: "+t.gameState.turn;for(;t.mother.isPresent();)e=(t.move.isAbsent()?" ":" > "+t.move.get().toString()+"> ")+t.gameState.turn+" "+e,t=t.mother.get();return"Node: "+e}},{key:"hasMoves",value:function(){return this.childs.isPresent()}},{key:"countDescendants",value:function(){if(this.childs.isAbsent())return 0;var e,t=this.childs.get().length,n=uy(this.childs.get());try{for(n.s();!(e=n.n()).done;){t+=e.value.countDescendants()}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"getScoreStatus",value:function(t){var n=!1;return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(OB(e.VERBOSE||n,"VICTORY"),Rte.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(OB(e.VERBOSE||n,"PRE_VICTORY_MIN"),Rte.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(OB(e.VERBOSE||n,"PRE_VICTORY_MAX"),Rte.PRE_VICTORY):(OB(e.VERBOSE||n,"DEFAULT"),Rte.DEFAULT)}}]),e}();Dte.VERBOSE=!1,Dte.minimaxes=new Mte;var Lte=function(){function e(t,n){fy(this,e),this.isEndGame=t,this.winner=n}return dy(e,[{key:"toBoardValue",value:function(){return this.winner.isPlayer()?this.winner.getVictoryValue():0}}],[{key:"getVictory",value:function(t){return t===Q7.ZERO?e.ZERO_WON:e.ONE_WON}},{key:"getDefeat",value:function(t){return t===Q7.ZERO?e.ONE_WON:e.ZERO_WON}}]),e}();Lte.ZERO_WON=new Lte(!0,Q7.ZERO),Lte.ONE_WON=new Lte(!0,Q7.ONE),Lte.DRAW=new Lte(!0,K7.NONE),Lte.ONGOING=new Lte(!1,K7.NONE);var Fte=function(){function e(t){fy(this,e),this.stateType=t,this.setInitialBoard()}return dy(e,[{key:"choose",value:function(e){var t=!1;OB(t,"Rules.choose: "+e.toString()+" was proposed");var n=this.isLegal(e,this.node.gameState);if(this.node.hasMoves()){OB(t,"Rules.choose: current node has moves");var r=this.node.getSonByMove(e);if(r.isPresent())return N7(n.isSuccess(),"Rules.choose: Move is illegal: "+n.getReasonOr("")),OB(t,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=r.get(),!0}if(OB(t,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),n.isFailure())return OB(t,"Rules.choose: Move is illegal: "+n.getReason()),!1;OB(t,"Rules.choose: Move is legal, let's apply it");var i=this.applyLegalMove(e,this.node.gameState,n.get()),a=new Dte(i,RB.of(this.node),RB.of(e));return this.node=a,!0}},{key:"setInitialBoard",value:function(){if(null==this.node){var e=this.stateType.getInitialState();Dte.ruler=this,this.node=new Dte(e)}else this.node=this.node.getInitialNode()}},{key:"applyMoves",value:function(e,t,n){var r,i=0,a=uy(e);try{for(a.s();!(r=a.n()).done;){var o=n(r.value),s=this.isLegal(o,t);N7(s.isSuccess(),"Can't create state from invalid moves ("+i+"): "+s.toString()+"."),t=this.applyLegalMove(o,t,s.get()),i++}}catch(u){a.e(u)}finally{a.f()}return t}}]),e}(),Ute=function(){var e=dy(function e(){fy(this,e)});return e.CANNOT_MOVE_MORE_THAN_THREE_PIECES=function(){return $localize(V||(V=Hg(["You cannot move more than 3 of your pieces!"])))},e.NOT_ENOUGH_PIECE_TO_PUSH=function(){return $localize(B||(B=Hg(["You don't have enough pieces to push that group!"])))},e.CANNOT_PUSH_YOUR_OWN_PIECES=function(){return $localize(z||(z=Hg(["You cannot push this piece because it is blocked by one of yours!"])))},e.MUST_ONLY_TRANSLATE_YOUR_PIECES=function(){return $localize(H||(H=Hg(["This line contains pieces of your opponent or empty spaces, which is forbidden."])))},e.TRANSLATION_IMPOSSIBLE=function(){return $localize(G||(G=Hg(["This move is impossible, some landing spaces are occupied."])))},e.LINE_AND_COORD_NOT_ALIGNED=function(){return $localize($||($=Hg(["This space is not aligned with the current line."])))},e}(),Vte=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return new Ote(n,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=this.getFirstPieceValidity(e,t);return r.isFailure()?r.toFailedFallible():e.isSingleCoord()?n.isLegalPush(e,t):n.isLegalSideStep(e,t)}},{key:"getFirstPieceValidity",value:function(e,t){var n=t.getPieceAt(e.coord);return!1===t.isPiece(e.coord)?DB.failure(Cte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):n===vte.ofPlayer(t.getCurrentOpponent())?DB.failure(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()):DB.SUCCESS}},{key:"isLegalPush",value:function(e,t){var r=1,i=e.coord.getNext(e.dir),a=vte.ofPlayer(t.getCurrentPlayer()),o=vte.EMPTY,s=t.getCopiedBoard();for(s[e.coord.y][e.coord.x]=o;r<=3&&t.isOnBoard(i)&&t.getPieceAt(i)===a;)r++,i=i.getNext(e.dir);return r>3?MB.failure(Ute.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===t.isInBoard(i)||(s[i.y][i.x]=a,t.getPieceAt(i)===o)?MB.success(s):n.isLegalRealPush(i,e,t,r,s)}},{key:"isLegalRealPush",value:function(e,t,n,r,i){for(var a=0,o=vte.ofPlayer(n.getCurrentOpponent()),s=vte.ofPlayer(n.getCurrentPlayer());a<r&&n.isOnBoard(e)&&n.getPieceAt(e)===o;)a++,e=e.getNext(t.dir);return a>=r?MB.failure(Ute.NOT_ENOUGH_PIECE_TO_PUSH()):e.isInRange(9,9)&&(n.getPieceAt(e)===vte.EMPTY&&(i[e.y][e.x]=o),n.getPieceAt(e)===s)?MB.failure(Ute.CANNOT_PUSH_YOUR_OWN_PIECES()):MB.success(i)}},{key:"isLegalSideStep",value:function(e,t){var n=e.lastPiece.get(),r=e.coord.getDirectionToward(n).get();n=n.getNext(r);for(var i=e.coord,a=vte.ofPlayer(t.getCurrentPlayer()),o=t.getCopiedBoard();!1===i.equals(n)&&i.isInRange(9,9);){if(t.getPieceAt(i)!==a)return MB.failure(Ute.MUST_ONLY_TRANSLATE_YOUR_PIECES());var s=i.getNext(e.dir);if(o[i.y][i.x]=vte.EMPTY,s.isInRange(9,9)){if(t.isPiece(s))return MB.failure(Ute.TRANSLATION_IMPOSSIBLE());t.getPieceAt(s)===vte.EMPTY&&(o[s.y][s.x]=a)}i=i.getNext(r)}return MB.success(o)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getScores();return t[0]>5?Lte.ZERO_WON:t[1]>5?Lte.ONE_WON:Lte.ONGOING}}]),n}(Fte),Bte=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<9;i++)for(var a=0;a<9;a++){var o=new fte(a,i);if(!1!==n.getPieceAt(o).is(r)){var s,u=uy(pte.factory.all);try{for(u.s();!(s=u.n()).done;){var c=s.value,l=Ate.fromSingleCoord(o,c).get();if(this.isAcceptablePush(l,n)){t.push(l);var f,h=uy(pte.factory.all);try{for(h.s();!(f=h.n()).done;)for(var d=f.value,v=1;v<=2&&!d.equals(c);v++){var p=o.getNext(d,v);if(!p.isInRange(9,9))break;var g=Ate.fromDoubleCoord(o,p,c).get();Vte.isLegal(g,n).isSuccess()&&t.push(g)}}catch(y){h.e(y)}finally{h.f()}}}}catch(y){u.e(y)}finally{u.f()}}}return new bte(t).toList()}},{key:"isAcceptablePush",value:function(e,t){var n=t.getScores(),r=Vte.isLegal(e,t);if(r.isSuccess()){var i=t.getCurrentOpponent().value;return!(new Ote(r.get(),t.turn+1).getScores()[i]>n[i])}return!1}},{key:"getBoardValue",value:function(e){var t=Vte.getGameStatus(e);if(t.isEndGame)return new _te(t.toBoardValue());var n=e.gameState.getScores();return new _te(n[1]-n[0])}}]),n}(wte),zte=function(){function e(t,n,r){fy(this,e),this.title=t,this.instruction=n,this.state=r,this.previousMove=RB.empty(),this.previousState=RB.empty()}return dy(e,[{key:"isMove",value:function(){return!1}},{key:"isAnyMove",value:function(){return!1}},{key:"isClick",value:function(){return!1}},{key:"isPredicate",value:function(){return!1}},{key:"isInformation",value:function(){return!1}},{key:"hasSolution",value:function(){return!1}},{key:"withPreviousMove",value:function(e){return this.previousMove=RB.of(e),this}},{key:"withPreviousState",value:function(e){return this.previousState=RB.of(e),this}}],[{key:"fromMove",value:function(e,t,n,r,i,a){return new Gte(e,t,n,r,i,a)}},{key:"forClick",value:function(e,t,n,r,i,a){return new Zte(e,t,n,r,i,a)}},{key:"anyMove",value:function(e,t,n,r,i){return new $te(e,t,n,r,i)}},{key:"fromPredicate",value:function(e,t,n,r,i,a){return new qte(e,t,n,r,i,a)}},{key:"informational",value:function(e,t,n){return new Wte(e,t,n)}}]),e}(),Hte=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r,i)).successMessage=a,o}return dy(n,[{key:"hasSolution",value:function(){return!0}},{key:"getSuccessMessage",value:function(){return this.successMessage}}]),n}(zte),Gte=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,r,i,o)).acceptedMoves=a,u.failureMessage=s,N7(a.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational"),u}return dy(n,[{key:"isMove",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedMoves[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Hte),$te=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;return fy(this,n),(s=t.call(this,e,r,i,o)).solutionMove=a,s}return dy(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isAnyMove",value:function(){return!0}}]),n}(Hte),Zte=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,r,i,o)).acceptedClicks=a,u.failureMessage=s,u}return dy(n,[{key:"isClick",value:function(){return!0}},{key:"getSolution",value:function(){return this.acceptedClicks[0]}},{key:"getFailureMessage",value:function(){return this.failureMessage}}]),n}(Hte),qte=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,r,i,s)).solutionMove=a,u.predicate=o,u}return dy(n,[{key:"getSolution",value:function(){return this.solutionMove}},{key:"isPredicate",value:function(){return!0}}]),n}(Hte),Wte=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isInformation",value:function(){return!0}}]),n}(zte),jte=vte.EMPTY,Yte=vte.UNREACHABLE,Kte=vte.ZERO,Qte=vte.ONE,Xte=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Z||(Z=Hg(["Initial board and goal of the game"]))),$localize(q||(q=Hg(["At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!"]))),Ote.getInitialState()),zte.anyMove($localize(W||(W=Hg(["Moving a piece"]))),$localize(j||(j=Hg(["At each turn, move one, two, or three pieces either along their line, or on their side.\n        For your moves you can therefore choose between up to 6 directions.\n        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).\n        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>\n        You're playing Dark, make any move!"]))),Ote.getInitialState(),Ate.fromSingleCoord(new fte(2,6),pte.UP).get(),$localize(Y||(Y=Hg(["Congratulations!"])))),zte.fromMove($localize(K||(K=Hg(["Pushing"]))),$localize(Q||(Q=Hg(["To push one opponent piece, you must move at least two of your pieces.\n        To push two opponent pieces, you must move three of your pieces.\n        If one of your pieces is in the way, it will be impossible to push.\n        You cannot move more than three pieces.<br/><br/>\n        Only one push towards the right is possible here, find it. (You're playing Dark)."]))),new Ote([[Yte,Yte,Yte,Yte,jte,Kte,Kte,Qte,Qte],[Yte,Yte,Yte,jte,jte,jte,jte,jte,jte],[Yte,Yte,jte,Kte,Kte,Kte,Qte,Kte,jte],[Yte,jte,jte,jte,jte,jte,jte,jte,jte],[jte,jte,jte,jte,Kte,Kte,Kte,Qte,Qte],[jte,jte,jte,jte,jte,jte,jte,jte,Yte],[jte,jte,jte,jte,Kte,Qte,jte,Yte,Yte],[jte,jte,jte,Kte,jte,jte,Yte,Yte,Yte],[jte,jte,Kte,jte,jte,Yte,Yte,Yte,Yte]],0),[Ate.fromSingleCoord(new fte(4,4),pte.RIGHT).get()],$localize(X||(X=Hg(["Congratulations! You know everything you need to start a game!"]))),$localize(J||(J=Hg(["Failed!"]))))]});function Jte(e,t){if(1&e){var n=SS();IC(),CS(0,"circle",6),TS("click",function(){eC(n);var e=RS(2).index,t=RS().index;return RS().onPieceClick(e,t)}),wS()}if(2&e){var r=RS(2).index,i=RS().index,a=RS();NS("id","piece_",r,"_",i,""),mS("ngClass",a.getPieceClasses(r,i)),lS("cx",a.getCenterBy(r,i).x)("cy",a.getCenterBy(r,i).y)("r",.5*a.SPACE_SIZE)}}function ene(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"polygon",4),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().onSpaceClick(e,t)}),wS(),pS(2,Jte,1,6,"circle",5),wS()}if(2&e){var r=RS(),i=r.index,a=r.$implicit,o=RS().index,s=RS();DE(1),NS("id","space_",i,"_",o,""),mS("ngClass",s.getSquareClasses(i,o)),lS("points",s.getHexaCoordsBy(i,o)),DE(1),mS("ngIf",s.isPiece(a))}}function tne(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,ene,3,5,"g",3),wS()),2&e){var n=t.$implicit,r=RS(2);DE(1),mS("ngIf",r.isBoard(n))}}function nne(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,tne,2,1,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function rne(e,t){1&e&&(IC(),CS(0,"marker",7),_S(1,"polygon",8),wS()),2&e&&xS("id","arrowhead_",t.$implicit.dir.toString(),"")}function ine(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),_S(1,"line",9),CS(2,"line",10),TS("click",function(){var e=eC(n).$implicit;return RS().chooseDirection(e.dir)}),wS(),CS(3,"polygon",11),TS("click",function(){var e=eC(n).$implicit;return RS().chooseDirection(e.dir)}),wS(),wS()}if(2&e){var r=t.$implicit;DE(1),xS("id","line_start_",r.dir.toString(),""),lS("x1",r.startCenter.x)("y1",r.startCenter.y)("x2",r.middle.x)("y2",r.middle.y),DE(1),xS("id","line_end_",r.dir.toString(),""),lS("x1",r.middle.x)("y1",r.middle.y)("x2",r.landingCenter.x)("y2",r.landingCenter.y),DE(1),xS("id","direction_",r.dir.toString(),""),lS("transform",r.transformation)}}var ane=dy(function e(t,n,r,i,a,o){fy(this,e),this.startCenter=t,this.middle=n,this.landingCenter=r,this.landing=i,this.dir=a,this.transformation=o}),one=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).moveds=[],r.directions=[],r.selecteds=[],r.rules=new Vte(Ote),r.availableMinimaxes=[new Bte(r.rules,"Dummy")],r.encoder=Ate.encoder,r.tutorial=(new Xte).tutorial,r.scores=RB.of([0,0]),r.SPACE_SIZE=30,r.hexaLayout=new gte(r.SPACE_SIZE,new fte(-8*r.SPACE_SIZE,2*r.SPACE_SIZE),mte.INSTANCE),r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.rules.node.gameState.getCopiedBoard(),this.scores=RB.of(this.rules.node.gameState.getScores())}},{key:"hidePreviousMove",value:function(){this.moveds=[]}},{key:"cancelMoveAttempt",value:function(){this.directions=[],this.selecteds=[]}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}},{key:"showPushingMove",value:function(e){var t=this.rules.node.mother.get().gameState,n=e.coord;for(this.moveds=[n],n=n.getNext(e.dir);n.isInRange(9,9)&&t.isPiece(n);)this.moveds.push(n),n=n.getNext(e.dir);n.isInRange(9,9)&&this.moveds.push(n)}},{key:"showSideStepMove",value:function(e){var t=e.lastPiece.get(),n=e.coord.getDirectionToward(t).get();t=t.getNext(n);for(var r=e.coord;!1===r.equals(t);)this.moveds.push(r),this.moveds.push(r.getNext(e.dir)),r=r.getNext(n)}},{key:"onPieceClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#piece_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentOpponent(),r.abrupt("return",n.hexaBoard[t][e].is(a)?n.opponentClick(e,t):0===n.selecteds.length?n.firstClick(e,t):1===n.selecteds.length?n.secondClick(e,t):n.thirdClick(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"opponentClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.tryChoosingDirection(e,t);case 2:if(!r.sent.isSuccess()){r.next=6;break}r.t0=DB.SUCCESS,r.next=7;break;case 6:r.t0=n.cancelMove(Cte.CANNOT_CHOOSE_OPPONENT_PIECE());case 7:return r.abrupt("return",r.t0);case 8:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.selecteds=[new fte(e,t)],n.showPossibleDirections(),DB.SUCCESS));case 1:case"end":return r.stop()}},r)}))()}},{key:"showPossibleDirections",value:function(){this.directions=[],this.showDirection(1===this.selecteds.length)}},{key:"showDirection",value:function(e){var t,n=this.rules.node.gameState,r=vte.ofPlayer(n.getCurrentPlayer()),i=this.selecteds[0],a=this.selecteds[this.selecteds.length-1],o=uy(pte.factory.all);try{for(o.s();!(t=o.n()).done;){var s,u=t.value,c=i.getNext(u,1);if(n.isOnBoard(c)&&n.getPieceAt(c)===r){if(e)continue;if(c=a.getNext(u,1),n.isOnBoard(c)&&n.getPieceAt(c)===r)continue}if(s=e?Ate.fromSingleCoord(i,u).get():Ate.fromDoubleCoord(i,a,u).get(),this.rules.isLegal(s,n).isSuccess()){var l=this.getCenterAt(i),f=this.getCenterAt(c),h=this.getMiddleOfArrow(u,c,f),d=f.x+" "+f.y,v=pte.getAngle(u)+150,p=new ane(l,h,f,c,u,"rotate("+v+" "+d+") translate("+d+")");this.directions.push(p)}}}catch(g){o.e(g)}finally{o.f()}}},{key:"getMiddleOfArrow",value:function(e,t,n){var r=t.getPrevious(e),i=this.getCenterAt(r);return new fte(i.x+(n.x-i.x)/2,i.y+(n.y-i.y)/2)}},{key:"isBoard",value:function(e){return e!==vte.UNREACHABLE}},{key:"isPiece",value:function(e){return e!==vte.EMPTY}},{key:"secondClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.selecteds[0],!(a=new fte(e,t)).equals(i)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),DB.SUCCESS));case 3:if(!1!==a.isHexagonallyAlignedWith(i)){r.next=5;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 5:if(!((o=a.getDistance(i))>2)){r.next=8;break}return r.abrupt("return",n.cancelMove(Ute.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 8:for(s=i.getDirectionToward(a).get(),n.selecteds=[i],u=0;u<o;u++)n.selecteds.push(i.getNext(s,u+1));if(3!==n.selecteds.length){r.next=15;break}if(c=n.selecteds[1],l=n.rules.node.gameState.getCurrentPlayer(),!1!==n.hexaBoard[c.y][c.x].is(l)){r.next=15;break}return r.abrupt("return",(n.cancelMoveAttempt(),n.firstClick(e,t)));case 15:return r.abrupt("return",(n.showPossibleDirections(),DB.SUCCESS));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new fte(e,t),a=n.selecteds[0],!i.equals(a)){r.next=3;break}return r.abrupt("return",n.deselectExtremity(!0));case 3:return o=n.selecteds[n.selecteds.length-1],r.abrupt("return",i.equals(o)?n.deselectExtremity(!1):3===n.selecteds.length&&i.equals(n.selecteds[1])?(n.cancelMoveAttempt(),DB.SUCCESS):n.tryExtension(i,a,o));case 5:case"end":return r.stop()}},r)}))()}},{key:"tryExtension",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o,s,u,c;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=ute.factory.fromMove(t,e)).isSuccess()){i.next=6;break}if(o=ute.factory.fromMove(n,e),!a.equals(o)){i.next=6;break}return s=t.getDistance(e),u=n.getDistance(e),i.abrupt("return",2===Math.max(s,u)?(r.selecteds.push(e),t9.sortByDescending(r.selecteds,Ate.sortCoord),r.showPossibleDirections(),DB.SUCCESS):r.cancelMove(Ute.CANNOT_MOVE_MORE_THAN_THREE_PIECES()));case 6:return c=r.cancelMove(Ute.LINE_AND_COORD_NOT_ALIGNED()),i.next=9,r.firstClick(e.x,e.y);case 9:return i.abrupt("return",c);case 10:case"end":return i.stop()}},i)}))()}},{key:"deselectExtremity",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.selecteds=t.selecteds.slice(e?1:0,e?void 0:-1),t.showPossibleDirections(),DB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"chooseDirection",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#direction_"+e.toString()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t._chooseDirection(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"_chooseDirection",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.rules.node.gameState,a=t.selecteds[0],n.abrupt("return",(i=1===t.selecteds.length?Ate.fromSingleCoord(a,e).get():Ate.fromDoubleCoord(a,t.selecteds[t.selecteds.length-1],e).get(),t.chooseMove(i,r,t.scores.get())));case 3:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#space_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.tryChoosingDirection(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"tryChoosingDirection",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new fte(e,t),a=uy(n.directions),r.prev=2,a.s();case 4:if((o=a.n()).done){r.next=10;break}if(!(s=o.value).landing.equals(i)){r.next=8;break}return r.abrupt("return",n._chooseDirection(s.dir));case 8:r.next=4;break;case 10:r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),a.e(r.t0);case 15:return r.prev=15,a.f(),r.finish(15);case 18:return r.abrupt("return",DB.failure("not a direction"));case 19:case"end":return r.stop()}},r,null,[[2,12,15,18]])}))()}},{key:"getSquareClasses",value:function(e,t){var n=new fte(e,t),r=[];return this.moveds.some(function(e){return e.equals(n)})&&r.push("moved"),r}},{key:"getPieceClasses",value:function(e,t){var n=new fte(e,t),r=Q7.of(this.hexaBoard[t][e].value),i=[this.getPlayerClass(r)];return this.selecteds.some(function(e){return e.equals(n)})&&i.push("highlighted"),i}}]),n}(dte);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-abalone"]],features:[Qb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,nne,2,1,"g",1),CS(2,"defs"),pS(3,rne,2,1,"marker",2),wS(),pS(4,ine,4,12,"g",1),wS()),2&e&&(DE(1),mS("ngForOf",t.hexaBoard),DE(2),mS("ngForOf",t.directions),DE(1),mS("ngForOf",t.directions))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),sne=function(){function e(t){fy(this,e),this.x=t}return dy(e,[{key:"equals",value:function(e){return this.x===e.x}}],[{key:"from",value:function(t){switch(t){case 0:return e.ZERO;case 1:return e.ONE;case 2:return e.TWO;default:return N7(3===t,"Invalid Apagos Coord "+t),e.THREE}}}]),e}();sne.ZERO=new sne(0),sne.ONE=new sne(1),sne.TWO=new sne(2),sne.THREE=new sne(3);var une=function(){var e=dy(function e(){fy(this,e)});return e.PIECE_SHOULD_MOVE_DOWNWARD=function(){return $localize(ee||(ee=Hg(["Pieces should only move downward!"])))},e.CANNOT_LAND_ON_A_FULL_SQUARE=function(){return $localize(te||(te=Hg(["That square is already full, you cannot put a piece in it!"])))},e.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=function(){return $localize(ne||(ne=Hg(["You have no pieces in that square, select one that contains at least one of your pieces!"])))},e.NO_PIECE_REMAINING_TO_DROP=function(){return $localize(re||(re=Hg(["There are no remaining pieces of that color to drop!"])))},e.NO_POSSIBLE_TRANSFER_REMAINS=function(){return $localize(ie||(ie=Hg(["There is no possible transfer from that square!"])))},e}(),cne=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this)).landing=e,a.piece=r,a.starting=i,a}return dy(n,[{key:"isDrop",value:function(){return this.piece.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}},{key:"equals",value:function(e){return!1!==this.starting.equals(e.starting)&&!1!==this.landing.equals(e.landing)&&this.piece.equals(e.piece)}}],[{key:"drop",value:function(e,t){return PB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(e)&&n.piece.equalsValue(t)&&n.starting.equals(RB.empty())}))}},{key:"transfer",value:function(e,t){if(e.x<=t.x)return MB.failure(une.PIECE_SHOULD_MOVE_DOWNWARD());var r=PB.getNonNullable(n.ALL_MOVES.find(function(n){return n.landing.equals(t)&&n.piece.equals(RB.empty())&&n.starting.equals(RB.of(e))}));return MB.success(r)}}]),n}(Tte);cne.ALL_MOVES=[new cne(sne.ZERO,RB.of(Q7.ZERO),RB.empty()),new cne(sne.ONE,RB.of(Q7.ZERO),RB.empty()),new cne(sne.TWO,RB.of(Q7.ZERO),RB.empty()),new cne(sne.THREE,RB.of(Q7.ZERO),RB.empty()),new cne(sne.ZERO,RB.of(Q7.ONE),RB.empty()),new cne(sne.ONE,RB.of(Q7.ONE),RB.empty()),new cne(sne.TWO,RB.of(Q7.ONE),RB.empty()),new cne(sne.THREE,RB.of(Q7.ONE),RB.empty()),new cne(sne.TWO,RB.empty(),RB.of(sne.THREE)),new cne(sne.ONE,RB.empty(),RB.of(sne.THREE)),new cne(sne.ZERO,RB.empty(),RB.of(sne.THREE)),new cne(sne.ONE,RB.empty(),RB.of(sne.TWO)),new cne(sne.ZERO,RB.empty(),RB.of(sne.TWO)),new cne(sne.ZERO,RB.empty(),RB.of(sne.ONE))],cne.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return cne.ALL_MOVES.length}},{key:"encodeNumber",value:function(e){var t=cne.ALL_MOVES.findIndex(function(t){return t.equals(e)});return N7(t>=0,e.toString()+" is not part of possibles moves of Apagos!"),t}},{key:"decodeNumber",value:function(e){return N7(e<cne.ALL_MOVES.length,e+" is not a valid encoded number for ApagosMove decoder"),cne.ALL_MOVES[e]}}]),n}(j7));var lne=function(){function e(t){fy(this,e),this.containing=t}return dy(e,[{key:"isFull",value:function(){return this.count(Q7.ZERO)+this.count(Q7.ONE)>=this.count(K7.NONE)}},{key:"count",value:function(e){return this.containing.get(e).get()}},{key:"addPiece",value:function(t){var n=this.count(Q7.ZERO),r=this.count(Q7.ONE),i=this.count(K7.NONE);return t===Q7.ZERO?n++:r++,e.from(n,r,i).get()}},{key:"substractPiece",value:function(t){var n=this.count(Q7.ZERO),r=this.count(Q7.ONE),i=this.count(K7.NONE);return t===Q7.ZERO?n--:r--,e.from(n,r,i).get()}},{key:"getDominatingPlayer",value:function(){var e=this.count(Q7.ZERO),t=this.count(Q7.ONE);return e>t?Q7.ZERO:t>e?Q7.ONE:K7.NONE}},{key:"equals",value:function(e){return this.containing.equals(e.containing)}}],[{key:"from",value:function(t,n,r){if(t+n>r)return MB.failure("invalid starting space");var i=new Mte([{key:Q7.ZERO,value:t},{key:Q7.ONE,value:n},{key:K7.NONE,value:r}]);i.makeImmutable();var a=new e(i);return MB.success(a)}}]),e}(),fne=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e)).board=r,a.remaining=i,a.remaining.makeImmutable(),a}return dy(n,[{key:"getPieceAt",value:function(e){return this.board[e.x]}},{key:"updateAt",value:function(e,t){for(var r=[],i=0;i<4;i++)r.push(e.x===i?t:this.board[i]);var a=this.getRemainingCopy();return new n(this.turn,r,a)}},{key:"getRemainingCopy",value:function(){return this.remaining.getCopy()}},{key:"getRemaining",value:function(e){return this.remaining.get(e).get()}},{key:"equals",value:function(e){return this.turn===e.turn&&t9.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}},{key:"fromRepresentation",value:function(e,t,r,i){for(var a=[],o=0;o<4;o++){var s=lne.from(t[0][o],t[1][o],t[2][o]).get();a.push(s)}var u=new Mte;return u.set(Q7.ZERO,r),u.set(Q7.ONE,i),new n(e,a,u)}}]),n}(Ste);return e.PIECES_PER_PLAYER=10,e}(),hne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalTransfer(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t.getRemainingCopy(),r=n.get(e.piece.get()).get();n.put(e.piece.get(),r-1);var i=new fne(t.turn+1,t.board,n),a=e.piece.get(),o=i.getPieceAt(e.landing).addPiece(a);if(e.landing===sne.THREE)return i.updateAt(e.landing,o);var s=sne.from(e.landing.x+1),u=i.getPieceAt(s);return i.updateAt(e.landing,u).updateAt(s,o)}},{key:"applyLegalTransfer",value:function(e,t){var n=t.getCurrentPlayer(),r=e.starting.get(),i=t.getPieceAt(r).substractPiece(n),a=t.getPieceAt(e.landing).addPiece(n),o=t.updateAt(r,i);return o=o.updateAt(e.landing,a),new fne(o.turn+1,o.board,o.remaining)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.landing).isFull()?MB.failure(une.CANNOT_LAND_ON_A_FULL_SQUARE()):e.isDrop()?this.isLegalDrop(e,t):this.isLegalSlideDown(e,t)}},{key:"isLegalDrop",value:function(e,t){return t.getRemaining(e.piece.get())<=0?MB.failure(une.NO_PIECE_REMAINING_TO_DROP()):MB.success(void 0)}},{key:"isLegalSlideDown",value:function(e,t){var n=t.getCurrentPlayer();return 0===t.getPieceAt(e.starting.get()).count(n)?MB.failure(une.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):MB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=0;n<4;n++)if(!1===t.getPieceAt(sne.from(n)).isFull())return Lte.ONGOING;var r=t.getPieceAt(sne.THREE).getDominatingPlayer();return N7(r.isPlayer(),"winner can only be a player if the game is finished"),Lte.getVictory(r)}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=RB.of(new n(fne))),this.singleton.get()}}]),n}(Fte);hne.singleton=RB.empty();var dne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=e.gameState;return cne.ALL_MOVES.filter(function(e){return hne.get().isLegal(e,t).isSuccess()})}},{key:"getBoardValue",value:function(e){var t=hne.get().getGameStatus(e);if(t.isEndGame)return _te.fromWinner(t.winner);var n=e.gameState.board[3].getDominatingPlayer();return n.isPlayer()?new _te(n.getScoreModifier()):new _te(0)}}]),n}(wte),vne=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(ae||(ae=Hg(["Initial board and goal of the game"]))),$localize(oe||(oe=Hg(["At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!"]))),fne.getInitialState()),zte.anyMove($localize(se||(se=Hg(["Drop"]))),$localize(ue||(ue=Hg(["There are two kind of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right. You're playing Light.<br/><br/>Drop a piece on one of those three squares."]))),fne.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),cne.drop(sne.ZERO,Q7.ZERO),$localize(ce||(ce=Hg(["Congratulations!"])))),zte.fromPredicate($localize(le||(le=Hg(["Transfer"]))),$localize(fe||(fe=Hg(["The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from an higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!"]))),fne.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),cne.transfer(sne.TWO,sne.ZERO).get(),function(e,t,n){return e.isDrop()?DB.failure($localize(he||(he=Hg(["This move is a drop, please do a transfer!"])))):DB.SUCCESS},$localize(de||(de=Hg(["Congratulations!"])))),zte.fromPredicate($localize(ve||(ve=Hg(["Victory"]))),$localize(pe||(pe=Hg(["When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!"]))),fne.fromRepresentation(2,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),cne.drop(sne.TWO,Q7.ONE),function(e,t,n){return e.isDrop()?e.piece.equalsValue(Q7.ONE)?DB.SUCCESS:DB.failure($localize(ge||(ge=Hg(["You actively made your opponent win!"])))):DB.failure($localize(ye||(ye=Hg(["Wrong choice, your opponent will win in the next turn no matter which piece is dropped!"]))))},$localize(me||(me=Hg(["Congratulations!"]))))]});function pne(e,t){if(1&e&&(IC(),_S(0,"circle",5)),2&e){var n=t.$implicit,r=RS();lS("cx",r.getRemainingPieceCx(n))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function gne(e,t){if(1&e&&(IC(),_S(0,"circle",6)),2&e){var n=t.$implicit,r=RS();lS("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(n))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function yne(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",9),TS("click",function(){eC(n);var e=RS().index,t=RS();return t.onArrowClick(e,t.PlayerOrNone.ZERO)}),wS()}if(2&e){var r=RS().index,i=RS();xS("id","dropArrow_zero_",r,""),mS("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ZERO)),lS("points",i.ARROW_COORD)("transform","translate("+i.SPACE_SIZE/2+" "+-i.SPACE_SIZE/2+")")}}function mne(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",9),TS("click",function(){eC(n);var e=RS().index,t=RS();return t.onArrowClick(e,t.PlayerOrNone.ONE)}),wS()}if(2&e){var r=RS().index,i=RS();xS("id","dropArrow_one_",r,""),mS("ngClass",i.getArrowClasses(r,i.PlayerOrNone.ONE)),lS("points",i.ARROW_COORD)("transform","translate(0 "+-i.SPACE_SIZE/2+")")}}function kne(e,t){if(1&e){var n=SS();IC(),ES(0),CS(1,"circle",10),TS("click",function(){eC(n);var e=RS().index;return RS().onSquareClick(e)}),wS(),bS()}if(2&e){var r=t.$implicit,i=RS(),a=i.index,o=i.$implicit,s=RS();DE(1),DS("id","square_",a,"_piece_",r,"_out_of_",o.count(s.PlayerOrNone.NONE),""),mS("ngClass",s.getPieceClasses(a,r,o)),lS("cx",s.getCircleCenter(a,r,o).x)("cy",s.getCircleCenter(a,r,o).y)}}function Cne(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),pS(1,yne,1,4,"polygon",7),pS(2,mne,1,4,"polygon",7),CS(3,"rect",8),TS("click",function(){var e=eC(n).index;return RS().onSquareClick(e)}),wS(),pS(4,kne,2,6,"ng-container",4),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS();lS("transform",a.getBlockTransform(i)),DE(1),mS("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ZERO)),DE(1),mS("ngIf",a.canDisplayArrow(i,a.PlayerOrNone.ONE)),DE(1),xS("id","square_",i,""),mS("ngClass",a.getSquareClasses(i)),lS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),DE(1),mS("ngForOf",a.range(r.count(a.PlayerOrNone.NONE)))}}var wne=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).PlayerOrNone=K7,r.BOARD_WIDTH=4*r.SPACE_SIZE,r.BOARD_HEIGHT=4.5*r.SPACE_SIZE,r.ARROW_COORD=n.getArrowCoord(),r.PIECES_PER_PLAYER=fne.PIECES_PER_PLAYER,r.selectedPiece=RB.empty(),r.leftPiece=RB.empty(),r.droppedPiece=RB.empty(),r.displayableArrow=[],r.rules=new hne(fne),r.hasAsymetricBoard=!0,r.availableMinimaxes=[new dne(r.rules,"ApagosDummyMinimax")],r.encoder=cne.encoder,r.tutorial=(new vne).tutorial,r.PIECE_RADIUS=2*r.SPACE_SIZE/(r.PIECES_PER_PLAYER+.5),r.updateBoard(),r}return dy(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=RB.empty(),this.showPossibleDrops()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.board,this.remainingZero=e.remaining.get(Q7.ZERO).get(),this.remainingOne=e.remaining.get(Q7.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}},{key:"hideLastMove",value:function(){this.movedSquare=[],this.droppedPiece=RB.empty(),this.leftPiece=RB.empty(),this.selectedPiece=RB.empty()}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}},{key:"showLastDrop",value:function(e){var t=e.piece.get(),n=e.landing.x;this.movedSquare=[n],3!==e.landing.x&&(n+=1,this.movedSquare.push(n));var r=this.getLowestPlayerPiece(this.board[n],t);this.droppedPiece=RB.of({square:n,piece:r})}},{key:"getLowestPlayerPiece",value:function(e,t){var n=e.count(t);return t===Q7.ZERO?n-1:e.count(K7.NONE)-n}},{key:"showLastTransfer",value:function(e){var t=this.rules.node.mother.get().gameState,n=t.getCurrentPlayer(),r=e.starting.get().x,i=this.getLowestPlayerPiece(t.board[r],n);this.leftPiece=RB.of({square:r,piece:i});var a=e.landing.x,o=this.getLowestPlayerPiece(this.board[a],n);this.droppedPiece=RB.of({square:a,piece:o})}},{key:"showPossibleDrops",value:function(){this.displayableArrow=[];for(var e=this.rules.node.gameState,t=0;t<4;t++)!1===e.board[t].isFull()&&(e.remaining.get(Q7.ZERO).get()>0&&this.displayableArrow.push({x:t,player:Q7.ZERO}),e.remaining.get(Q7.ONE).get()>0&&this.displayableArrow.push({x:t,player:Q7.ONE}))}},{key:"getCircleCenter",value:function(e,t,n){var r=this.SPACE_SIZE/2,i=this.SPACE_SIZE/2;if(1===n.count(K7.NONE))return new fte(r,i);var a=n.count(K7.NONE),o=2*t*Math.PI/a-Math.PI/2,s=.3*this.SPACE_SIZE,u=s*Math.cos(o),c=s*Math.sin(o);return new fte(r+u,i+c)}},{key:"canDisplayArrow",value:function(e,t){return this.displayableArrow.some(function(n){return n.x===e&&n.player.equals(t)})}},{key:"getArrowClasses",value:function(e,t){return[this.getPlayerClass(t)]}},{key:"getBlockTransform",value:function(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}},{key:"getSquareClasses",value:function(e){var t=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?t.push("selected"):this.movedSquare.includes(e)&&t.push("last-move"),t}},{key:"onArrowClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#dropArrow_"+(t===Q7.ZERO?"zero":"one")+"_"+e)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=sne.from(e),n.selectedPiece.isPresent()?(s=n.selectedPiece.get().square,o=cne.transfer(sne.from(s),a).get()):o=cne.drop(a,t),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 6:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e,t,n){var r={square:e,piece:t},i=[],a=n.count(Q7.ZERO),o=n.count(Q7.ONE);if(this.selectedPiece.equalsValue(r))i.push("selected");else if(this.droppedPiece.equalsValue(r))i.push("last-move");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===t)return i.push("captured-stroke"),i;this.rules.node.gameState.getCurrentOpponent()===Q7.ZERO?a++:o++}var s=n.count(K7.NONE)-(o+a),u=this.getPieceColor(t,a,s);return""!==u&&i.push(u),i}},{key:"getPieceColor",value:function(e,t,n){return e<t?"player0":e>=t+n?"player1":""}},{key:"onSquareClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.selectedPiece.isPresent()||t.selectedPiece.get().square!==e){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),DB.SUCCESS));case 5:return i=t.rules.node.gameState.getCurrentPlayer(),a=t.board[e],n.abrupt("return",a.count(i)<=0?t.cancelMove(une.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(t.selectedPiece=RB.of({square:e,piece:t.getLowestPlayerPiece(a,i)}),0===t.showAndGetPossibleTranfers().length?t.cancelMove(une.NO_POSSIBLE_TRANSFER_REMAINS()):DB.SUCCESS));case 7:case"end":return n.stop()}},n)}))()}},{key:"showAndGetPossibleTranfers",value:function(){this.displayableArrow=[];for(var e=this.selectedPiece.get().square-1,t=this.rules.node.gameState.getCurrentPlayer();0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:t}),e--;return this.displayableArrow}},{key:"getRemainingPieceCx",value:function(e){return(e+.5)*this.PIECE_RADIUS*1.5}}],[{key:"getArrowCoord",value:function(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}}]),n}(hte);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-apagos"]],features:[Qb],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1",4,"ngFor","ngForOf"],["class","base mid-stroke player0",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1"],[1,"base","mid-stroke","player0"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"g"),pS(2,pne,1,3,"circle",1),pS(3,gne,1,3,"circle",2),wS(),CS(4,"g",3),pS(5,Cne,5,8,"g",4),wS(),wS()),2&e&&(lS("viewBox",-t.STROKE_WIDTH/2+" "+-t.STROKE_WIDTH/2+" "+(t.BOARD_WIDTH+t.STROKE_WIDTH)+" "+(t.BOARD_HEIGHT+t.STROKE_WIDTH)),DE(1),lS("transform","rotate("+180*t.role.value+" "+t.BOARD_WIDTH/2+" "+t.BOARD_HEIGHT/2+")"),DE(1),mS("ngForOf",t.range(t.remainingOne)),DE(1),mS("ngForOf",t.range(t.remainingZero)),DE(2),mS("ngForOf",t.board))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),_ne=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getViewBox",value:function(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}]),n}(hte);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275cmp=ck({type:t,selectors:[["ng-component"]],features:[Qb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),Ene=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).captured=i,a}return dy(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}}],[{key:"getInitialState",value:function(){return new n(t9.createTable(6,2,4),0,[0,0])}}]),n}(Pte),bne=function(){var e=dy(function e(){fy(this,e)});return e.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=function(){return $localize(ke||(ke=Hg(["You cannot distribute from the opponent's home."])))},e.MUST_CHOOSE_NON_EMPTY_HOUSE=function(){return $localize(Ce||(Ce=Hg(["You should choose a non-empty house to distribute."])))},e.SHOULD_DISTRIBUTE=function(){return $localize(we||(we=Hg(["You should distribute but you do not."])))},e}(),Sne=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,r){OB(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:t});var i=e.x,a=t.getCurrentPlayer(),o=t.getCurrentOpponent(),s=o.value,u=t.getCopiedBoard(),c=n.distribute(i,s,u);if(c.y===s)return new Ene(u,t.turn+1,t.captured);var l=[0,0],f=t9.copyBiArray(u);return l[a.value]=n.capture(c.x,c.y,a,u),l[a.value]>0&&n.isStarving(o,u)&&(u=f,l=[0,0]),n.isStarving(a,u)&&!1===n.canDistribute(o,u)&&(l[o.value]+=n.mansoon(o,u)),l[0]+=t.captured[0],l[1]+=t.captured[1],new Ene(u,t.turn+1,l)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"mansoon",value:function(e,t){var n=0,r=0,i=e.getOpponent().value;do{n+=t[i][r],t[i][r]=0,r++}while(r<6);return n}},{key:"isLegal",value:function(e,t){var r=t.getCurrentOpponent(),i=r.value,a=e.x;if(0===t.getPieceAtXY(a,i))return MB.failure(bne.MUST_CHOOSE_NON_EMPTY_HOUSE());var o=n.isStarving(r,t.board),s=!1===n.doesDistribute(a,i,t.board);return o&&s?MB.failure(bne.SHOULD_DISTRIBUTE()):MB.success(void 0)}},{key:"doesDistribute",value:function(e,t,n){return 0===t?n[t][e]>5-e:n[t][e]>e}},{key:"canDistribute",value:function(e,t){for(var r=0;r<6;r++)if(n.doesDistribute(r++,e.getOpponent().value,t))return!0;return!1}},{key:"isStarving",value:function(e,t){var n=0,r=e.getOpponent().value;do{if(t[r][n++]>0)return!1}while(n<6);return!0}},{key:"distribute",value:function(e,t,n){var r=e,i=t,a=n[t][e];for(n[t][e]=0;a>0;)0===t?5===e?t=1:e++:0===e?t=0:e--,(e!==r||t!==i)&&(n[t][e]+=1,a--);return new fte(e,t)}},{key:"capture",value:function(e,t,n,r){N7(t!==n.getOpponent().value,"AwaleRules.capture cannot capture the players house");var i=r[t][e];if(i<2||i>3)return 0;var a=0,o=-1,s=-1;n===Q7.ONE&&(o=1,s=6);do{a+=i,r[t][e]=0,i=r[t][e+=o]}while(e!==s&&(2===i||3===i));return a}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captured[0]>24?Lte.ZERO_WON:t.captured[1]>24?Lte.ONE_WON:24===t.captured[0]&&24===t.captured[1]?Lte.DRAW:Lte.ONGOING}}]),n}(Fte);return e.VERBOSE=!1,e}(),Pne=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).x=e,r}return dy(n,[{key:"equals",value:function(e){return e===this||e.x===this.x}},{key:"toString",value:function(){return"AwaleMove("+this.x+")"}}],[{key:"from",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;default:return N7(5===e,"Invalid x for AwaleMove: "+e),n.FIVE}}}]),n}(Tte);Pne.ZERO=new Pne(0),Pne.ONE=new Pne(1),Pne.TWO=new Pne(2),Pne.THREE=new Pne(3),Pne.FOUR=new Pne(4),Pne.FIVE=new Pne(5),Pne.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 5}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Pne.from(e)}}]),n}(j7));var One=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState,i=(r.turn+1)%2,a=0;do{0!==r.getPieceAtXY(a,i)&&(t=Pne.from(a),Sne.isLegal(t,r).isSuccess()&&(t=Pne.from(a),n.push(t))),a++}while(a<6);return this.orderMoves(e,n)}},{key:"orderMoves",value:function(e,t){var n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent().value,i=n.value;return t9.sortByDescending(t,function(t){var a,o=e.gameState.getCopiedBoard(),s=o[r][t.x],u=Sne.distribute(t.x,r,o),c=0;return u.y===r?(a=0,s<=6&&(c=10)):a=Sne.capture(u.x,i,n,o),100*a+c-s}),t}},{key:"getBoardValue",value:function(e){var t=Sne.getGameStatus(e);if(t.isEndGame)return _te.fromWinner(t.winner);var n=e.gameState.getCapturedCopy();return new _te(n[1]-n[0])}}]),n}(wte),Tne=dy(function e(){fy(this,e),this.tutorial=[zte.anyMove($localize(_e||(_e=Hg(["Sowing"]))),$localize(Ee||(Ee=Hg(["Awal\xe9 is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.\n         Let's see how seeds are sown.\n         As you're playing first, the 6 houses on the bottom are yours.<br/><br>\n         Click on any of them to sow the seeds it contains: they will be sown clockwise, one seed per house."]))),Ene.getInitialState(),Pne.ZERO,$localize(be||(be=Hg(["Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.\n        This is how seeds are sown:\n        one by one from the house next to the one they come from, clockwise."])))),zte.anyMove($localize(Se||(Se=Hg(["Big sowing"]))),$localize(Pe||(Pe=Hg(["You are still the first player.\n        When there are enough seeds to make a full turn, something else happens.<br/><br/>\n        Sow the house that contains 12 seeds."]))),new Ene([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),Pne.ONE,$localize(Oe||(Oe=Hg(["See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds)."])))),zte.fromMove($localize(Te||(Te=Hg(["Simple capture"]))),$localize(Ie||(Ie=Hg(["After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.\n         Then, the player looks at the preceding house:\n         if it is still in the opponent's side and contains two or three seeds, they are also captured.\n         This continues until we reach either the player's side or a house containing neither two nor three seeds.<br/><br/>\n         You are the first player, try to capture some pieces!"]))),new Ene([[1,0,0,0,1,0],[1,0,0,0,1,0]],0,[0,0]),[Pne.ZERO],$localize(Ae||(Ae=Hg(["Well done! This was a simple capture, now let us see how to make multiple captures."]))),$localize(Re||(Re=Hg(["Failed. Try again and sow from the leftmost house."])))),zte.fromMove($localize(Me||(Me=Hg(["Multiple captures"]))),$localize(xe||(xe=Hg(["By sowing from your leftmost house, you will change the number of seeds in a house from 2 to 3, and from the preceding house from 1 to 2.\n        As these are consecutive houses, all seeds in them will be captured.<br/><br/>\n        Capture them."]))),new Ene([[2,1,0,0,1,0],[2,0,0,0,1,0]],1,[0,0]),[Pne.ZERO],$localize(Ne||(Ne=Hg(["Nice, you win 3 points from the first house, and 2 from the second!"]))),$localize(De||(De=Hg(["Failed. Try again."])))),zte.fromMove($localize(Le||(Le=Hg(["Interrupted capture"]))),$localize(Fe||(Fe=Hg(["By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>\n        Do it."]))),new Ene([[1,0,1,0,0,1],[3,0,0,0,1,0]],1,[0,0]),[Pne.ZERO],$localize(Ue||(Ue=Hg(["Notice that because the second house was not capturable, the captured was interrupted and you have not captured the first house."]))),$localize(Ve||(Ve=Hg(["Failed. Try again."])))),zte.fromMove($localize(Be||(Be=Hg(["Capture on the other side only"]))),$localize(ze||(ze=Hg(["Try to capture the two leftmost houses of the opponent."]))),new Ene([[2,2,0,0,1,0],[1,3,0,0,0,0]],1,[0,0]),[Pne.ONE],$localize(He||(He=Hg(["Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!"]))),$localize(Ge||(Ge=Hg(["You have only captured one house, try again!"])))),zte.fromMove($localize($e||($e=Hg(["Do not starve"]))),$localize(Ze||(Ze=Hg(["You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>\n        Try it."]))),new Ene([[1,1,1,1,1,0],[5,0,0,1,0,0]],1,[0,0]),[Pne.ZERO],$localize(qe||(qe=Hg(["Sadly, you cannot capture here, otherwise the opponent could not play after you.\n        When this happens, the move can be made, but no capture takes place!"]))),$localize(We||(We=Hg(["Failed. Try again."])))),zte.anyMove($localize(je||(je=Hg(["Feeding is mandatory"]))),$localize(Ye||(Ye=Hg(["You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>Go ahead!"]))),new Ene([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),Pne.THREE,$localize(Ke||(Ke=Hg(["Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.\n        It is often a good way to have easy captures!"])))),zte.anyMove($localize(Qe||(Qe=Hg(["End of the game"]))),$localize(Xe||(Xe=Hg(["A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>\n         Sow the house on the top right."]))),new Ene([[0,0,0,0,0,1],[0,1,2,3,4,4]],0,[0,0]),Pne.FIVE,$localize(Je||(Je=Hg(["Also, as soon as on player cannot play, the other player captures all the seeds in its own side.\n         Here, it was the first player's turn, and the second player has taken all the remaining seeds."]))))]});function Ine(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"circle",4),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),wS(),CS(2,"text",5),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),rP(3),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();DE(1),NS("id","click_",i,"_",a,""),mS("ngClass",o.getSquareClasses(i,a)),lS("cx",o.getPieceCx(i))("cy",o.getPieceCy(a)),DE(1),lS("x",50+100*i)("y",66+120*a)("transform",o.getPieceRotation(i,a)),DE(1),aP(" ",r," ")}}function Ane(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Ine,4,9,"g",2),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}var Rne=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).last=RB.empty(),r.captured=[],r.moved=[],r.hasAsymetricBoard=!0,r.scores=RB.of([0,0]),r.rules=new Sne(Ene),r.availableMinimaxes=[new One(r.rules,"AwaleMinimax")],r.encoder=Pne.encoder,r.tutorial=(new Tne).tutorial,r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.scores=RB.of(e.getCapturedCopy()),this.hidePreviousMove();var t=this.rules.node.move;if(this.board=e.getCopiedBoard(),t.isPresent()){var n=e.getCurrentPlayer().value;this.last=RB.of(new fte(t.get().x,n)),this.showPreviousMove()}else this.last=RB.empty()}},{key:"hidePreviousMove",value:function(){this.captured=[],this.moved=[]}},{key:"showPreviousMove",value:function(){for(var e=this.rules.node.mother.get().gameState,t=0;t<=1;t++)for(var n=0;n<=5;n++){var r=new fte(n,t),i=this.board[t][n],a=e.getPieceAt(r);this.last.equalsValue(r)||(i<a?this.captured.push(r):i>a&&this.moved.push(r))}}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(t!==n.rules.node.gameState.getCurrentPlayer().value){r.next=5;break}return r.abrupt("return",n.cancelMove(bne.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME()));case 5:return n.last=RB.empty(),a=Pne.from(e),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 8:case"end":return r.stop()}},r)}))()}},{key:"getSquareClasses",value:function(e,t){var n=new fte(e,t);return this.captured.some(function(e){return e.equals(n)})?["captured"]:this.last.equalsValue(n)?["moved","highlighted"]:this.moved.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getPieceCx",value:function(e){return 50+100*e}},{key:"getPieceCy",value:function(e){return 50+120*e}},{key:"getPieceRotation",value:function(e,t){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(t)+")"}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-awale-component"]],features:[Qb],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),_S(1,"rect",1),pS(2,Ane,2,1,"g",2),_S(3,"line",3),wS()),2&e&&(lS("transform",t.rotation),DE(2),mS("ngForOf",t.board))},directives:[nR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Mne=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;if(fy(this,n),i=t.call(this,e.x,e.y),e.equals(r))throw new Error(Cte.MOVE_CANNOT_BE_STATIC());return i.end=r,ny(i)}return dy(n,[{key:"length",value:function(){return this.coord.getDistance(this.end)}},{key:"getDirection",value:function(){return ute.factory.fromMove(this.coord,this.end)}}],[{key:"getEncoder",value:function(e,t,n){return new(function(r){Jg(a,r);var i=ty(a);function a(){var n;return fy(this,a),(n=i.apply(this,arguments)).shiftAX=t,n.shiftDY=n.shiftAX*e,n.shiftDX=n.shiftDY*t,n}return dy(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftDX+(t-1)*this.shiftDY+(e-1)*this.shiftAX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftDX+e.coord.y*this.shiftDY+e.end.x*this.shiftAX+e.end.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new fte((r-=r%1)%e,i);r/=e;var o=(r-=r%1)%t;r/=t;var s=new fte((r-=r%1)%e,o);return n(s,a)}}]),a}(j7))}}]),n}(Ite),xne=function(){var e=dy(function e(){fy(this,e)});return e.LANDING_ON_OCCUPIED_SQUARE=function(){return $localize(et||(et=Hg(["You cannot land on an occupied square."])))},e.THRONE_IS_LEFT_FOR_GOOD=function(){return $localize(tt||(tt=Hg(["Once you left the central throne, you cannot return to it."])))},e.SOLDIERS_CANNOT_SIT_ON_THRONE=function(){return $localize(nt||(nt=Hg(["Soldiers cannot sit on the throne."])))},e.MOVE_MUST_BE_ORTHOGONAL=function(){return $localize(rt||(rt=Hg(["Tafl moves must be orthogonal."])))},e}(),Nne=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;if(fy(this,n),i=t.call(this,e,r),e.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+e.toString()+".");if(r.isNotInRange(i.getMaximalDistance(),i.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+r.toString()+".");var a=e.getDirectionToward(r);if(a.isFailure()||a.get().isDiagonal())throw new Error(xne.MOVE_MUST_BE_ORTHOGONAL());return ny(i)}return dy(n,[{key:"equals",value:function(e){return e===this||!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"TaflMove("+this.coord+"->"+this.end+")"}}]),n}(Mne),Dne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getMaximalDistance",value:function(){return 7}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return MB.success(r)}catch(r){return MB.failure(r.message)}}}]),n}(Nne);Dne.encoder=Mne.getEncoder(7,7,Dne.of);var Lne={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:Q7.ZERO},Fne=function(){function e(t,n){fy(this,e),this.owner=t,this.king=n}return dy(e,[{key:"isKing",value:function(){return this.king}},{key:"getOwner",value:function(){return this.owner}}]),e}();Fne.UNOCCUPIED=new Fne(K7.NONE,!1),Fne.PLAYER_ONE_KING=new Fne(K7.ONE,!0),Fne.INVADERS=new Fne(K7.ZERO,!1),Fne.DEFENDERS=new Fne(K7.ONE,!1);var Une=dy(function e(t){fy(this,e),this.value=t});Une.NONE=new Une("NONE"),Une.OPPONENT=new Une("OPPONENT"),Une.PLAYER=new Une("PLAYER");var Vne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isCentralThrone",value:function(e){return e.equals(this.getCentralThrone())}},{key:"getCentralThrone",value:function(){var e=(this.board.length-1)/2;return new fte(e,e)}},{key:"getRelativeOwner",value:function(e,t){var n=this.getAbsoluteOwner(t);return n===K7.NONE?Une.NONE:e===n?Une.PLAYER:Une.OPPONENT}},{key:"getAbsoluteOwner",value:function(e){return this.getPieceAt(e).getOwner()}}]),n}(Pte),Bne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Fne.UNOCCUPIED,t=Fne.INVADERS,r=Fne.DEFENDERS;return new n([[e,e,e,t,e,e,e],[e,e,e,t,e,e,e],[e,e,e,r,e,e,e],[t,t,r,Fne.PLAYER_ONE_KING,r,t,t],[e,e,e,r,e,e,e],[e,e,e,t,e,e,e],[e,e,e,t,e,e,e]],0)}}]),n}(Vne),zne=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e)).config=r,a.generateMove=i,a}return dy(n,[{key:"isLegal",value:function(e,t){OB(n.VERBOSE,{tablutRules_isLegal:{move:e,state:t}});var r=t.getCurrentPlayer(),i=this.getMoveValidity(r,e,t);return i.isFailure()?MB.failure(i.getReason()):MB.success(void 0)}},{key:"getMoveValidity",value:function(e,t,n){var r=n.getRelativeOwner(e,t.coord);if(r===Une.NONE)return DB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE());if(r===Une.OPPONENT)return DB.failure(Cte.CANNOT_CHOOSE_OPPONENT_PIECE());if(n.getRelativeOwner(e,t.end)!==Une.NONE)return DB.failure(xne.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(n,t.end)){if(!n.getPieceAt(t.coord).isKing())return DB.failure(xne.SOLDIERS_CANNOT_SIT_ON_THRONE());if(n.isCentralThrone(t.end)&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return DB.failure(xne.THRONE_IS_LEFT_FOR_GOOD())}for(var i=t.coord.getDirectionToward(t.end).get(),a=t.coord.getOrthogonalDistance(t.end),o=t.coord.getNext(i),s=1;s<a;s++){if(n.getPieceAt(o)!==Fne.UNOCCUPIED)return DB.failure(Cte.SOMETHING_IN_THE_WAY());o=o.getNext(i)}return DB.SUCCESS}},{key:"isThrone",value:function(e,t){return!!this.isExternalThrone(t)||e.isCentralThrone(t)}},{key:"isExternalThrone",value:function(e){var t=this.config.WIDTH-1;return!(0!==e.x&&e.x!==t||0!==e.y&&e.y!==t)}},{key:"tryCapture",value:function(e,t,n,r){var i=t.getNext(n);return i.isInRange(this.config.WIDTH,this.config.WIDTH)&&r.getRelativeOwner(e,i)===Une.OPPONENT?r.getPieceAt(i).isKing()?this.captureKing(e,t,n,r):this.capturePawn(e,t,n,r):RB.empty()}},{key:"captureKing",value:function(e,t,n,r){var i=t.getNext(n),a=this.getSurroundings(i,n,e,r),o=a.backCoord,s=a.back,u=a.backInRange,c=a.left,l=a.leftCoord,f=a.right,h=a.rightCoord;return!1===u?this.captureKingAgainstTheWall(c,f,i):s===Une.NONE&&this.isThrone(r,o)?this.captureKingAgainstThrone(o,i,c,f):s===Une.PLAYER?this.captureKingWithAtLeastASandwich(r,i,c,l,f,h):RB.empty()}},{key:"getSurroundings",value:function(e,t,n,r){var i=e.getNext(t),a=i.isInRange(this.config.WIDTH,this.config.WIDTH),o=a?r.getRelativeOwner(n,i):Une.NONE,s=e.getLeft(t),u=s.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,s):Une.NONE,c=e.getRight(t),l=c.isInRange(this.config.WIDTH,this.config.WIDTH)?r.getRelativeOwner(n,c):Une.NONE;return{backCoord:i,back:o,backInRange:a,leftCoord:s,left:u,rightCoord:c,right:l}}},{key:"captureKingAgainstTheWall",value:function(e,t,r){var i=e===Une.PLAYER?1:0;return 2===(i+=t===Une.PLAYER?1:0)&&this.config.BORDER_CAN_SURROUND_KING?(OB(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),RB.of(r)):RB.empty()}},{key:"captureKingAgainstThrone",value:function(e,t,n,r){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return RB.of(t)}else{var i=r===Une.PLAYER,a=n===Une.PLAYER||i;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&a)return RB.of(t)}return RB.empty()}},{key:"capturePawn",value:function(e,t,r,i){var a=!1,o=t.getNext(r),s=o.getNext(r),u=Une.NONE;return s.isInRange(this.config.WIDTH,this.config.WIDTH)&&(u=i.getRelativeOwner(e,s)),u===Une.NONE?!1===this.isThrone(i,s)?(OB(n.VERBOSE||a,"cannot capture a pawn without an ally; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")cannot capture a pawn without an ally behind"),RB.empty()):(OB(n.VERBOSE||a,"pawn captured by 1 opponent and 1 throne; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),RB.of(o)):u===Une.PLAYER?(OB(n.VERBOSE||a,"pawn captured by 2 opponents; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),RB.of(o)):(OB(n.VERBOSE||a,"no captures; "+o+"threatened by "+e+"'s pawn in  "+t+" coming from this direction ("+r.x+", "+r.y+")"),RB.empty())}},{key:"captureKingWithAtLeastASandwich",value:function(e,t,r,i,a,o){if(!1===this.kingTouchCentralThrone(e,t)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return RB.of(t);var s=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,u=this.isThrone(e,i),c=r===Une.PLAYER||u&&s,l=this.isThrone(e,o);return c&&(a===Une.PLAYER||l&&s)?(OB(n.VERBOSE||!1,"king captured by 4 invaders"),RB.of(t)):RB.empty()}},{key:"kingTouchCentralThrone",value:function(e,t){var n=e.getCentralThrone();return t.getOrthogonalDistance(n)<=1}},{key:"applyLegalMove",value:function(e,t){OB(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:t}});var r=t.turn,i=t.getCopiedBoard(),a=t.getCurrentPlayer(),o=e.coord,s=e.end;i[s.y][s.x]=i[o.y][o.x],i[o.y][o.x]=Fne.UNOCCUPIED;var u,c=uy(cte.ORTHOGONALS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=this.tryCapture(a,e.end,l,t);f.isPresent()&&(i[f.get().y][f.get().x]=Fne.UNOCCUPIED)}}catch(h){c.e(h)}finally{c.f()}return t.from(i,r+1)}},{key:"getGameStatus",value:function(e){var t=this.getWinner(e.gameState);return t.isPresent()?Lte.getVictory(t.get()):Lte.ONGOING}},{key:"getWinner",value:function(e){var t=!1,n=this.getKingCoord(e);if(n.isAbsent())return OB(t,"The king is dead, victory to invader"),RB.of(this.getInvader());var r=n.get();return this.isExternalThrone(r)?(OB(t,"The king escape, victory to defender"),RB.of(this.getDefender())):this.isPlayerImmobilized(Q7.ZERO,e)?(OB(t,"Zero has no move, victory to one"),RB.of(Q7.ONE)):this.isPlayerImmobilized(Q7.ONE,e)?(OB(t,"One has no move, victory to zero"),RB.of(Q7.ZERO)):(OB(t,"no victory"),RB.empty())}},{key:"getKingCoord",value:function(e){OB(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(var t=0;t<this.config.WIDTH;t++)for(var r=0;r<this.config.WIDTH;r++)if(e.getPieceAtXY(r,t).isKing())return RB.of(new fte(r,t));return RB.empty()}},{key:"getInvader",value:function(){return this.config.INVADER}},{key:"getDefender",value:function(){return this.config.INVADER.getOpponent()}},{key:"isPlayerImmobilized",value:function(e,t){return 0===this.getPlayerListMoves(e,t).length}},{key:"getPlayerListMoves",value:function(e,t){var r=[],i=this.getPlayerListPawns(e,t);OB(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:t}});var a,o=uy(i);try{for(o.s();!(a=o.n()).done;){var s,u=a.value,c=uy(this.getPossibleDestinations(u,t));try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.generateMove(u,l);r.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}return r}},{key:"getPlayerListPawns",value:function(e,t){for(var n=[],r=0;r<this.config.WIDTH;r++)for(var i=0;i<this.config.WIDTH;i++){var a=new fte(i,r);t.getAbsoluteOwner(a)===e&&n.push(a)}return n}},{key:"getPossibleDestinations",value:function(e,t){var n,r,i=[],a=uy(cte.ORTHOGONALS);try{for(a.s();!(r=a.n()).done;){var o=r.value;n=e.getNext(o,1);for(var s=!1;n.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===s;)t.getAbsoluteOwner(n)===K7.NONE?this.isExternalThrone(n)?t.getPieceAt(e).isKing()&&i.push(n):t.isCentralThrone(n)?t.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&i.push(n):i.push(n):s=!0,n=n.getNext(o,1)}}catch(u){a.e(u)}finally{a.f()}return i}}]),n}(Fte);return e.VERBOSE=!1,e}(),Hne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this,Bne,Lne,Dne.of)}return dy(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Dte.ruler=this.singleton,n.singleton}}]),n}(zne),Gne=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e)).VERBOSE=r,a.generateMove=i,a.viewInfo={pieceClasses:[]},a.EMPTY=Fne.UNOCCUPIED,a.captureds=[],a.chosen=RB.empty(),a.lastMove=RB.empty(),a}return dy(n,[{key:"getViewBox",value:function(){var e=-this.STROKE_WIDTH,t=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return e+" "+e+" "+t+" "+t}},{key:"updateBoard",value:function(){OB(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.rules.node.gameState.getCopiedBoard(),this.captureds=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}},{key:"showPreviousMove",value:function(){var e,t=this.rules.node.mother.get().gameState,n=this.rules.node.gameState.getCurrentOpponent(),r=uy(cte.ORTHOGONALS);try{for(r.s();!(e=r.n()).done;){var i=e.value,a=this.lastMove.get().end.getNext(i,1);if(a.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){var o=t.getRelativeOwner(n,a)===Une.OPPONENT,s=this.rules.node.gameState.getPieceAt(a)===Fne.UNOCCUPIED;o&&s&&this.captureds.push(a)}}}catch(u){r.e(u)}finally{r.f()}}},{key:"updateViewInfo",value:function(){for(var e=[],t=0;t<this.board.length;t++){for(var n=[],r=0;r<this.board[0].length;r++){var i;i=this.board[t][r].getOwner()===K7.NONE?[""]:this.getPieceClasses(r,t),n.push(i)}e.push(n)}this.viewInfo={pieceClasses:e}}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(OB(n.VERBOSE,"TaflComponent.onClick("+e+", "+t+")"),!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new fte(e,t),r.abrupt("return",n.chosen.equalsValue(a)?(n.cancelMoveAttempt(),DB.SUCCESS):n.chosen.isAbsent()||n.pieceBelongToCurrentPlayer(a)?n.choosePiece(a):n.chooseDestination(e,t));case 6:case"end":return r.stop()}},r)}))()}},{key:"chooseDestination",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(OB(n.VERBOSE,"TaflComponent.chooseDestination"),i=n.chosen.get(),a=new fte(e,t),!(o=n.generateMove(i,a)).isSuccess()){r.next=8;break}return r.next=5,n.chooseMove(o.get(),n.rules.node.gameState);case 5:r.t0=r.sent,r.next=9;break;case 8:r.t0=n.cancelMove(o.getReason());case 9:return r.abrupt("return",r.t0);case 10:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){return OB(this.VERBOSE,"TaflComponent.choosePiece"),this.board[e.y][e.x]===Fne.UNOCCUPIED?this.cancelMove(Cte.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(e)?(this.chosen=RB.of(e),this.updateViewInfo(),OB(this.VERBOSE,"selected piece = ("+e.x+", "+e.y+")"),DB.SUCCESS):this.cancelMove(Cte.CANNOT_CHOOSE_OPPONENT_PIECE())}},{key:"pieceBelongToCurrentPlayer",value:function(e){var t=this.rules.node.gameState,n=t.getCurrentPlayer();return t.getRelativeOwner(n,e)===Une.PLAYER}},{key:"cancelMoveAttempt",value:function(){this.chosen=RB.empty(),this.updateViewInfo()}},{key:"isThrone",value:function(e,t){return this.rules.isThrone(this.rules.node.gameState,new fte(e,t))}},{key:"isCentralThrone",value:function(e,t){return this.rules.node.gameState.isCentralThrone(new fte(e,t))}},{key:"getPieceClasses",value:function(e,t){var n=[],r=new fte(e,t),i=this.rules.node.gameState.getAbsoluteOwner(r);return n.push(this.getPlayerClass(i)),this.chosen.equalsValue(r)&&n.push("selected"),n}},{key:"getRectClasses",value:function(e,t){var n=[],r=new fte(e,t);if(this.captureds.some(function(e){return e.equals(r)}))n.push("captured");else if(this.lastMove.isPresent()){var i=this.lastMove.get().coord,a=this.lastMove.get().end;(r.equals(i)||r.equals(a))&&n.push("moved")}return n}},{key:"getClickables",value:function(){for(var e=[],t=0;t<this.board.length;t++)for(var n=0;n<this.board[t].length;n++){var r=new fte(n,t);this.isClickable(r)&&e.push(r)}return e}},{key:"isClickable",value:function(e){return this.pieceBelongToCurrentPlayer(e)}},{key:"isInvader",value:function(e,t){return this.board[t][e]===Fne.INVADERS}},{key:"isKing",value:function(e,t){return this.board[t][e].isKing()}}]),n}(_ne),$ne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){OB(!1,{TaflMinimax_getListMoves:{node:e}});var t=e.gameState,n=t.getCurrentPlayer(),r=this.ruler.getPlayerListMoves(n,t);return this.orderMoves(t,r)}},{key:"orderMoves",value:function(e,t){var n=this,r=this.ruler.getKingCoord(e).get();return e.getCurrentPlayer()===this.ruler.config.INVADER?t9.sortByDescending(t,function(e){return-e.end.getOrthogonalDistance(r)}):t9.sortByDescending(t,function(e){return e.coord.equals(r)?n.ruler.isExternalThrone(e.end)?2:1:0}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getWinner(t);if(n.isPresent())return new _te(n.get().getVictoryValue());var r=this.ruler.getPlayerListPawns(Q7.ZERO,t).length,i=this.ruler.getPlayerListPawns(Q7.ONE,t).length,a=[1,2][this.ruler.config.INVADER.value];a*=Q7.ZERO.getScoreModifier();var o=[2,1][this.ruler.config.INVADER.value];return o*=Q7.ONE.getScoreModifier(),new _te(r*a+i*o)}}]),n}(wte),Zne=function(){function e(t,n){fy(this,e),this.directThreats=t,this.mover=n}return dy(e,[{key:"equals",value:function(e){return e.directThreats.equals(this.directThreats)&&e.mover.equals(this.mover)}}]),e}(),qne=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,new bte([e]),r)).directThreat=e,i.mover=r,i}return dy(n)}(Zne),Wne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"toFields",value:function(e){return[[e.y],e.x]}}]),n}(function(e,t){Jg(r,e);var n=ty(r);function r(e){var t;if(fy(this,r),(t=n.call(this)).map=[],t.values=[],void 0!==e){var i,a=uy(e);try{for(a.s();!(i=a.n()).done;){var o=i.value;t.add(o)}}catch(s){a.e(s)}finally{a.f()}}return ny(t)}return dy(r,[{key:"add",value:function(e){var t,n=this.toFields(e),r=this.map,i=uy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;void 0===r[a]&&(r[a]=[]),r=r[a]}}catch(s){i.e(s)}finally{i.f()}var o=n[1];return void 0===r[o]&&(r[o]=!0,this.values.push(e),!0)}},{key:"contains",value:function(e){var t,n=this.toFields(e),r=this.map,i=uy(n[0]);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0===r[a])return!1;r=r[a]}}catch(o){i.e(o)}finally{i.f()}return void 0!==r[n[1]]}},{key:t,value:function(){return this.values.values()}}]),r}(bte,Symbol.iterator)),jne=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,r)).width=i.ruler.config.WIDTH,i.maxInfluence=16*(2*i.width-2),i.scoreByThreatenedPiece=16*i.maxInfluence+1,i.scoreBySafePiece=16*i.scoreByThreatenedPiece+1,i}return dy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new _te(t.toBoardValue());var n,r=e.gameState,i=Fne.UNOCCUPIED,a=0,o=this.getPiecesMap(r),s=this.getThreatMap(r,o),u=this.filterThreatMap(s,r),c=uy(Q7.PLAYERS);try{for(c.s();!(n=c.n()).done;){var l,f=n.value,h=uy(o.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;if(u.get(d).isPresent())a+=f.getScoreModifier()*this.scoreByThreatenedPiece;else{a+=f.getScoreModifier()*this.scoreBySafePiece;var v,p=0,g=uy(cte.ORTHOGONALS);try{for(g.s();!(v=g.n()).done;)for(var y=v.value,m=d.getNext(y,1);m.isInRange(this.width,this.width)&&r.getPieceAt(m)===i;)p++,m=m.getNext(y,1)}catch(k){g.e(k)}finally{g.f()}a+=p*f.getScoreModifier()}}}catch(k){h.e(k)}finally{h.f()}}}catch(k){c.e(k)}finally{c.f()}return new _te(a)}},{key:"getPiecesMap",value:function(e){for(var t=Fne.UNOCCUPIED,n=[],r=[],i=0;i<this.width;i++)for(var a=0;a<this.width;a++){var o=new fte(a,i);e.getPieceAt(o)!==t&&(e.getAbsoluteOwner(o)===Q7.ZERO?n.push(o):r.push(o))}return new Mte([{key:Q7.ZERO,value:new Wne(n)},{key:Q7.ONE,value:new Wne(r)}])}},{key:"getThreatMap",value:function(e,t){var n,r=new Mte,i=uy(Q7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=uy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreats(u,e);this.isThreatReal(u,e,c)&&r.set(u,new bte(c))}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreats",value:function(e,t){var n=t.getAbsoluteOwner(e);N7(n.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");var r,i=n.getOpponent(),a=[],o=uy(cte.ORTHOGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=e.getPrevious(s,1);if(this.isAThreat(u,t,i)){var c,l=[],f=uy(cte.ORTHOGONALS);try{for(f.s();!(c=f.n()).done;){var h=c.value;if(h!==s.getOpposite()){for(var d=e.getNext(s,1);d.isInRange(this.width,this.width)&&t.getPieceAt(d)===Fne.UNOCCUPIED;)d=d.getNext(h);d.isInRange(this.width,this.width)&&t.getAbsoluteOwner(d)===i&&!1===e.getNext(s,1).equals(d)&&l.push(d)}}}catch(v){f.e(v)}finally{f.f()}a.push(new qne(u,new Wne(l)))}}}catch(v){o.e(v)}finally{o.f()}return a}},{key:"isAThreat",value:function(e,t,n){return!(e.isNotInRange(this.width,this.width)||t.getAbsoluteOwner(e)!==n&&(!this.ruler.isThrone(t,e)||n!==Q7.ONE&&t.getPieceAt(e)!==Fne.UNOCCUPIED))}},{key:"isThreatReal",value:function(e,t,n){if(0===n.length)return!1;if(t.getPieceAt(e).isKing())return 3===n.length;var r,i=uy(n);try{for(i.s();!(r=i.n()).done;){if(r.value.mover.size()>0)return!0}}catch(a){i.e(a)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new Mte,i=e.listKeys(),a=i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentPlayer()}),o=new Wne(i.filter(function(e){return t.getAbsoluteOwner(e)===t.getCurrentOpponent()})),s=uy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=[],h=uy(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d.directThreat)){var v,p=[],g=uy(d.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&f.push(new qne(d.directThreat,new Wne(p)))}}}catch(_){h.e(_)}finally{h.f()}f.length>0&&r.set(c,new bte(f))}}catch(_){s.e(_)}finally{s.f()}var m,k=uy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}($ne),Yne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new _te(t.toBoardValue());var r,i=e.gameState,a=this.ruler.config.WIDTH,o=Fne.UNOCCUPIED,s=0,u=this.getPiecesMap(i),c=this.getThreatMap(i,u),l=this.filterThreatMap(c,i),f=uy(Q7.PLAYERS);try{for(f.s();!(r=f.n()).done;){var h,d=r.value,v=new Wne,p=uy(u.get(d).get());try{for(p.s();!(h=p.n()).done;){var g=h.value;if(l.get(g).isPresent())s+=d.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE;else{s+=d.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;var y,m=uy(cte.ORTHOGONALS);try{for(m.s();!(y=m.n()).done;)for(var k=y.value,C=g.getNext(k,1);C.isInRange(a,a)&&i.getPieceAt(C)===o;)v.add(C),C=C.getNext(k,1)}catch(S){m.e(S)}finally{m.f()}}}}catch(S){p.e(S)}finally{p.f()}var w,_=uy(v);try{for(_.s();!(w=_.n()).done;){var E=w.value,b=this.getControlledPieceValue(E.x,E.y,a);s+=d.getScoreModifier()*b}}catch(S){_.e(S)}finally{_.f()}}}catch(S){f.e(S)}finally{f.f()}return new _te(s)}},{key:"getControlledPieceValue",value:function(e,t,n){var r=1;return(0===e||e===n-1)&&(r*=n),(0===t||t===n-1)&&(r*=n),r}}]),n}(jne);Yne.SCORE_BY_THREATENED_PIECE=530,Yne.SCORE_BY_SAFE_PIECE=16*Yne.SCORE_BY_THREATENED_PIECE+1;var Kne=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);if(t.isEndGame)return new _te(t.toBoardValue());var n,r=e.gameState,i=this.ruler.config.WIDTH,a=Fne.UNOCCUPIED,o=0,s=0,u=0,c=this.getPiecesMap(r),l=this.getThreatMap(r,c),f=this.filterThreatMap(l,r),h=uy(Q7.PLAYERS);try{for(h.s();!(n=h.n()).done;){var d,v=n.value,p=new Wne,g=uy(c.get(v).get());try{for(g.s();!(d=g.n()).done;){var y=d.value;if(f.get(y).isPresent())s+=v.getScoreModifier();else{o+=v.getScoreModifier();var m,k=uy(cte.ORTHOGONALS);try{for(k.s();!(m=k.n()).done;)for(var C=m.value,w=y.getNext(C,1);w.isInRange(i,i)&&r.getPieceAt(w)===a;)p.add(w),w=w.getNext(C,1)}catch(O){k.e(O)}finally{k.f()}}}}catch(O){g.e(O)}finally{g.f()}var _,E=uy(p);try{for(E.s();!(_=E.n()).done;){var b=_.value,S=this.getControlledPieceValue(b.x,b.y,i);u+=v.getScoreModifier()*S}}catch(O){E.e(O)}finally{E.f()}}}catch(O){h.e(O)}finally{h.f()}var P=this.getStepForEscape(r);return new _te(531*P*17*17+531*o*17+531*s+u)}},{key:"getStepForEscape",value:function(e){var t=this.ruler.getKingCoord(e).get();return this._getStepForEscape(e,1,[t],[]).getOrElse(Number.MAX_SAFE_INTEGER)}},{key:"_getStepForEscape",value:function(e,t,n,r){var i=this,a=this.getNextGen(e,n,r);return 0===a.length?RB.empty():a.some(function(e){return i.ruler.isExternalThrone(e)})?RB.of(t):(t++,r.push.apply(r,oy(a)),this._getStepForEscape(e,t,a,r))}},{key:"getNextGen",value:function(e,t,n){var r,i=this,a=[],o=uy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=uy(cte.ORTHOGONALS);try{var l=function(){for(var t=s.value,r=u.getNext(t,1);r.isInRange(i.ruler.config.WIDTH,i.ruler.config.WIDTH)&&e.getPieceAt(r)===Fne.UNOCCUPIED;)n.every(function(e){return!1===e.equals(r)})&&a.push(r),r=r.getNext(t,1)};for(c.s();!(s=c.n()).done;)l()}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a}}]),n}(Yne);Kne.SCORE_BY_THREATENED_PIECE=530,Kne.SCORE_BY_SAFE_PIECE=16*Yne.SCORE_BY_THREATENED_PIECE+1,Kne.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];var Qne=Fne.UNOCCUPIED,Xne=Fne.INVADERS,Jne=Fne.DEFENDERS,ere=Fne.PLAYER_ONE_KING,tre=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(it||(it=Hg(["Goal of the game"]))),$localize(at||(at=Hg(["Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Bne.getInitialState()),zte.anyMove($localize(ot||(ot=Hg(["Moving"]))),$localize(st||(st=Hg(["All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Bne.getInitialState(),Dne.of(new fte(3,1),new fte(1,1)),$localize(ut||(ut=Hg(["Congratulations!"])))),zte.fromMove($localize(ct||(ct=Hg(["Capturing a soldier (1/2)"]))),$localize(lt||(lt=Hg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Bne([[Qne,Qne,Qne,Xne,Qne,Qne,Qne],[Qne,Qne,Qne,Xne,Qne,Qne,Qne],[Xne,Qne,Qne,Jne,Qne,Qne,Qne],[Qne,Qne,Jne,ere,Jne,Xne,Xne],[Qne,Qne,Xne,Qne,Qne,Qne,Qne],[Qne,Qne,Qne,Jne,Qne,Xne,Qne],[Qne,Qne,Qne,Xne,Qne,Qne,Qne]],1),[Dne.of(new fte(3,5),new fte(2,5))],$localize(ft||(ft=Hg(["Congratulations, that will teach him a lesson!"]))),$localize(ht||(ht=Hg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),zte.fromMove($localize(dt||(dt=Hg(["Capturing a soldier (2/2)"]))),$localize(vt||(vt=Hg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Bne([[Qne,Qne,Qne,Xne,Qne,Qne,Qne],[Qne,Qne,Xne,Qne,Qne,Qne,Qne],[Qne,Qne,Qne,Jne,Qne,Qne,Qne],[Xne,Jne,Qne,Qne,Jne,Xne,Xne],[Qne,Jne,Qne,Qne,Qne,Qne,Qne],[Qne,Xne,Qne,ere,Qne,Xne,Qne],[Qne,Qne,Qne,Xne,Qne,Qne,Qne]],12),[Dne.of(new fte(2,1),new fte(3,1)),Dne.of(new fte(3,0),new fte(3,1))],$localize(pt||(pt=Hg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(gt||(gt=Hg(["Failed, you did not do the expected move."])))),zte.fromMove($localize(yt||(yt=Hg(["Capturing the king on his throne"]))),$localize(mt||(mt=Hg(["To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>Capture the king."]))),new Bne([[Qne,Qne,Qne,Qne,Qne,Qne,Qne],[Qne,Qne,Qne,Jne,Qne,Qne,Qne],[Qne,Qne,Qne,Xne,Qne,Qne,Qne],[Qne,Xne,Qne,ere,Xne,Qne,Qne],[Qne,Qne,Qne,Xne,Qne,Qne,Qne],[Qne,Jne,Qne,Qne,Qne,Qne,Qne],[Qne,Qne,Qne,Qne,Qne,Qne,Qne]],72),[Dne.of(new fte(1,3),new fte(2,3))],$localize(kt||(kt=Hg(["Congratulations, you won!"]))),$localize(Ct||(Ct=Hg(["Failed, you let the king run away."])))),zte.fromMove($localize(wt||(wt=Hg(["Capturing the king next to his throne"]))),$localize(_t||(_t=Hg(["Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>Capture the king."]))),new Bne([[Qne,Qne,Xne,Qne,Qne,Qne,Qne],[Qne,Qne,Qne,Xne,Qne,Qne,Qne],[Qne,Qne,Qne,ere,Xne,Qne,Qne],[Qne,Xne,Jne,Qne,Jne,Qne,Qne],[Qne,Qne,Qne,Xne,Qne,Qne,Qne],[Qne,Qne,Qne,Qne,Qne,Qne,Qne],[Qne,Qne,Qne,Qne,Qne,Qne,Qne]],72),[Dne.of(new fte(2,0),new fte(2,2))],$localize(Et||(Et=Hg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(bt||(bt=Hg(["Failed!"])))),zte.fromMove($localize(St||(St=Hg(["Capturing the king far from his throne"]))),$localize(Pt||(Pt=Hg(["When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>Capture the king."]))),new Bne([[Qne,Qne,Qne,Qne,Qne,Qne,Qne],[Qne,Qne,Qne,Qne,Qne,Qne,Qne],[Qne,Xne,Qne,Xne,Qne,Qne,Qne],[Xne,Qne,Qne,Qne,Jne,Qne,Qne],[Qne,Qne,Qne,Jne,Qne,Qne,Qne],[Qne,Qne,Qne,Qne,Qne,Qne,Qne],[Qne,ere,Qne,Xne,Qne,Qne,Qne]],72),[Dne.of(new fte(3,6),new fte(2,6))],$localize(Ot||(Ot=Hg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Tt||(Tt=Hg(["Failed!"]))))]});function nre(e,t){1&e&&(IC(),_S(0,"polygon",8))}function rre(e,t){1&e&&(IC(),_S(0,"rect",9))}function ire(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,nre,1,0,"polygon",6),pS(2,rre,1,0,"ng-template",null,7,XT),wS()),2&e){var n=gS(3),r=RS().index,i=RS().index,a=RS();DE(1),mS("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function are(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"line",13),_S(2,"line",13),_S(3,"line",13),_S(4,"line",13),_S(5,"line",13),wS()),2&e){var n=RS(2).index,r=RS().index,i=RS();DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function ore(e,t){if(1&e&&(IC(),_S(0,"polyline",16)),2&e){var n=RS(3).index,r=RS().index;mS("ngClass",RS().viewInfo.pieceClasses[r][n])}}function sre(e,t){if(1&e&&(IC(),_S(0,"line",13),_S(1,"line",13),_S(2,"line",13),_S(3,"line",13)),2&e){var n=RS(3).index,r=RS().index,i=RS();mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function ure(e,t){if(1&e&&(IC(),pS(0,ore,1,1,"polyline",14),pS(1,sre,4,20,"ng-template",null,15,XT)),2&e){var n=gS(2),r=RS(2).index,i=RS().index;mS("ngIf",RS().isKing(r,i))("ngIfElse",n)}}function cre(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"circle",10),pS(2,are,6,25,"g",11),pS(3,ure,3,2,"ng-template",null,12,XT),wS()),2&e){var n=gS(4),r=RS().index,i=RS().index,a=RS();DE(1),NS("id","piece_",r,"_",i,""),mS("ngClass",a.viewInfo.pieceClasses[i][r]),lS("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),DE(1),mS("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function lre(e,t){if(1&e){var n=SS();IC(),CS(0,"g",3),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),_S(1,"rect",4),pS(2,ire,4,2,"g",5),pS(3,cre,5,8,"g",5),wS()}if(2&e){var r=t.index,i=RS().index,a=RS();NS("id","click_",r,"_",i,""),lS("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),DE(1),mS("ngClass",a.getRectClasses(r,i)),lS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),DE(1),mS("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),DE(1),mS("ngIf",a.board[i][r]!==a.EMPTY)}}function fre(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,lre,4,8,"g",2),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function hre(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",17),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e.x,e.y)}),wS(),wS()}if(2&e){var r=t.$implicit,i=RS();DE(1),NS("id","click_",r.x,"_",r.y,""),lS("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var dre=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e,!1,Dne.from)).rules=Hne.get(),r.availableMinimaxes=[new $ne(r.rules,"DummyBot"),new jne(r.rules,"Piece > Influence"),new Yne(r.rules,"Piece > Control"),new Kne(r.rules,"Escape > Piece > Control")],r.encoder=Dne.encoder,r.tutorial=(new tre).tutorial,r}return dy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Gne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-brandhub"]],features:[Qb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,fre,2,1,"g",1),pS(2,hre,2,6,"g",1),wS()),2&e&&(lS("viewBox",t.getViewBox()),DE(1),mS("ngForOf",t.board),DE(1),mS("ngForOf",t.getClickables()))},directives:[nR,eR,iR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),vre=function(){var e,t=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).SPACE_SIZE=50,e}return dy(n,[{key:"getTriangleCornerCoords",value:function(e,t){return(e+t)%2==1?this.getDownwardCoordinate(e,t):this.getUpwardCoordinate(e,t)}},{key:"getTriangleCoordinate",value:function(e,t){return this.getTriangleCornerCoords(e,t).map(function(e){return e.x+","+e.y}).reduce(function(e,t){return e+","+t})}},{key:"getDownwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new fte(.5*this.SPACE_SIZE*e,i);return[o,new fte(n,a),new fte(r,i),o]}},{key:"getUpwardCoordinate",value:function(e,t){var n=.5*this.SPACE_SIZE*(e+1),r=.5*this.SPACE_SIZE*(e+2),i=this.SPACE_SIZE*t,a=this.SPACE_SIZE*(t+1),o=new fte(.5*this.SPACE_SIZE*e,a);return[o,new fte(n,i),new fte(r,a),o]}},{key:"getPyramidCoordinate",value:function(e,t){return(e+t)%2==1?this.getDownwardPyramidCoordinate(e,t):this.getUpwardPyramidCoordinate(e,t)}},{key:"getDownwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=this.SPACE_SIZE*t,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r+this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}},{key:"getUpwardPyramidCoordinate",value:function(e,t){var n=this.SPACE_SIZE*e/2,r=(t+1)*this.SPACE_SIZE,i=n+", "+r,a=n+this.SPACE_SIZE+", "+r,o=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE),s=n+this.SPACE_SIZE/2+", "+(r-this.SPACE_SIZE/2);return i+","+o+","+s+","+i+","+s+","+a+","+i+","+a+","+o+","+s+","+a}}]),n}(hte);return t.\u0275fac=function(n){return(e||(e=lw(t)))(n||t)},t.\u0275cmp=ck({type:t,selectors:[["ng-component"]],features:[Qb],decls:0,vars:0,template:function(e,t){},encapsulation:2}),t}(),pre=function(){var e=dy(function e(){fy(this,e)});return e.INVALID_DISTANCE=function(){return $localize(It||(It=Hg(["Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is."])))},e.NOT_ENOUGH_TILES_TO_EXCHANGE=function(){return $localize(At||(At=Hg(["You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it."])))},e.FIRST_CLICK_SHOULD_NOT_BE_NULL=function(){return $localize(Rt||(Rt=Hg(["Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles."])))},e.CANNOT_CAPTURE_FROM_EMPTY=function(){return $localize(Mt||(Mt=Hg(["You cannot capture from an empty space."])))},e.CANNOT_CAPTURE_OWN_PIECES=function(){return $localize(xt||(xt=Hg(["You cannot capture your own pieces."])))},e}(),gre=function(){function e(t,n){fy(this,e),this.direction=t,this.str=n}return dy(e,[{key:"toInt",value:function(){var t=this;return e.STEPS.findIndex(function(e){return e.direction.equals(t.direction)})}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return this.str}}],[{key:"fromCoords",value:function(t,n){var r=t.getVectorToward(n),i=e.STEPS.findIndex(function(e){return e.direction.equals(r)});if(-1===i)throw new Error(pre.INVALID_DISTANCE());return e.STEPS[i]}}]),e}();gre.LEFT=new gre(new ate(-2,0),"LEFT"),gre.UP_LEFT=new gre(ute.UP_LEFT,"UP_LEFT"),gre.UP_RIGHT=new gre(ute.UP_RIGHT,"UP_RIGHT"),gre.RIGHT=new gre(new ate(2,0),"RIGHT"),gre.DOWN_LEFT=new gre(ute.DOWN_LEFT,"DOWN_LEFT"),gre.DOWN_RIGHT=new gre(ute.DOWN_RIGHT,"DOWN_RIGHT"),gre.STEPS=[gre.LEFT,gre.UP_LEFT,gre.UP_RIGHT,gre.RIGHT,gre.DOWN_LEFT,gre.DOWN_RIGHT];var yre=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this)).start=e,o.step=r,o.landingCoord=i,o.capture=a,o}return dy(n,[{key:"isTileExchange",value:function(){return this.capture.isPresent()}},{key:"toString",value:function(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}},{key:"equals",value:function(e){return!(!this.capture.equals(e.capture)||!this.start.equals(e.start)||!this.step.equals(e.step))}}],[{key:"fromMovement",value:function(e,t){if(e.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");var r=new fte(e.x+t.direction.x,e.y+t.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new n(RB.of(e),RB.of(t),RB.of(r),RB.empty())}},{key:"fromTilesExchange",value:function(e){if(e.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new n(RB.empty(),RB.empty(),RB.empty(),RB.of(e))}},{key:"fromCoordToCoord",value:function(e,t){var r=gre.fromCoords(e,t);return n.fromMovement(e,r)}}]),n}(Tte);yre.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 1035}},{key:"encodeNumber",value:function(e){if(e.isTileExchange()){var t=e.capture.get().y;return 10*e.capture.get().x+t}var n=e.start.get().y,r=e.start.get().x;return 150*(e.step.get().toInt()+1)+10*r+n}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%10,n=(e=(e-t)/10)%15;return 0==(e=(e-n)/15)?yre.fromTilesExchange(new fte(n,t)):yre.fromMovement(new fte(n,t),gre.STEPS[e-1])}}]),n}(j7));var mre=function(){function e(){fy(this,e)}return dy(e,null,[{key:"getNeighbors",value:function(e){var t=new fte(e.x-1,e.y),n=new fte(e.x+1,e.y);return(e.x+e.y)%2==1?[t,n,new fte(e.x,e.y-1)]:[t,n,new fte(e.x,e.y+1)]}},{key:"getFakeNeighbors",value:function(e){return new fte(e.x,(e.x+e.y)%2==1?e.y+1:e.y-1)}},{key:"getCommonNeighbor",value:function(t,n){for(var r=e.getNeighbors(t),i=e.getNeighbors(n),a=0;a<r.length;){for(var o=r[a],s=0;s<i.length;){if(o.equals(i[s]))return RB.of(o);s++}a++}return RB.empty()}},{key:"isSpaceDark",value:function(e){return(e.x+e.y)%2==0}}]),e}(),kre=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getEmptyNeighbors",value:function(e,t){return n.getEmptyNeighbors(this.board,e,t)}}],[{key:"getEmptyNeighbors",value:function(e,t,n){var r,i=[],a=uy(mre.getNeighbors(t));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.isInRange(e[0].length,e.length)&&e[o.y][o.x]===n&&i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(Pte),Cre=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r)).tiles=i,o.captures=a,o}return dy(n,[{key:"applyLegalMovement",value:function(e){OB(n.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:e}});var t=e.start.get(),r=e.landingCoord.get(),i=this.getCopiedBoard();return i[r.y][r.x]=vte.ofPlayer(this.getCurrentPlayer()),i[t.y][t.x]=vte.EMPTY,new n(i,this.turn,this.tiles,this.captures)}},{key:"doMovementCaptures",value:function(e){OB(n.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:e}});var t,r=this,i=uy(this.getCapturedNeighbors(e.landingCoord.get()));try{for(i.s();!(t=i.n()).done;){var a=t.value;r=r.capture(a)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"getCapturedNeighbors",value:function(e){var t=this,n=this.getCurrentOpponent();return mre.getNeighbors(e).filter(function(e){return!e.isNotInRange(15,10)&&!!t.getPieceAt(e).is(n)&&t.isSurrounded(e)})}},{key:"isSurrounded",value:function(e){return 0===this.getEmptyNeighbors(e,vte.EMPTY).length}},{key:"capture",value:function(e){OB(n.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:e}});var t=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return OB(n.VERBOSE,e.toString()+" has been captured"),t[e.y][e.x]=vte.EMPTY,r[this.getCurrentPlayer().value]+=1,new n(t,this.turn,this.tiles,r)}},{key:"removeTilesIfNeeded",value:function(e,t){OB(n.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:e,countTiles:t}});var r=this,i=n.getTilesUpperLeftCoord(e);if(this.isTileEmpty(i)&&this.isDeconnectable(i)){r=this.deconnectTile(i,t);var a,o=uy(n.getPresentNeighborEntrances(i));try{for(o.s();!(a=o.n()).done;){var s=a.value,u=r.getPieceAt(s);u===vte.EMPTY?r=r.removeTilesIfNeeded(s,t):u.is(this.getCurrentOpponent())&&r.isSurrounded(s)&&(r=r.capture(s))}}catch(c){o.e(c)}finally{o.f()}}return r}},{key:"isTileEmpty",value:function(e){N7(this.getPieceAt(e)!==vte.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(var t=0;t<2;t++)for(var n=0;n<3;n++){var r=e.getNext(new ate(n,t),1);if(this.getPieceAt(r)!==vte.EMPTY)return!1}return!0}},{key:"isDeconnectable",value:function(e){var t=this.getPresentNeighborTilesRelativeIndexes(e);if(t.length>3)return!1;for(var n=0,r=1;r<t.length;r++)!1===this.areNeighbor(t[r-1],t[r])&&(n+=1);return!1===this.areNeighbor(t[0],t[t.length-1])&&(n+=1),n<=1}},{key:"areNeighbor",value:function(e,t){return e+1===t||0===e&&5===t}},{key:"getPresentNeighborTilesRelativeIndexes",value:function(e){for(var t=[],r=RB.empty(),i=0;i<6;i++){var a=e.getNext(n.NEIGHBORS_TILES_DIRECTIONS[i],1);a.isInRange(15,10)&&this.getPieceAt(a)!==vte.UNREACHABLE&&(r.isAbsent()&&(r=RB.of(i)),t.push(i-r.get()))}return t}},{key:"deconnectTile",value:function(e,t){OB(n.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:e,countTiles:t}});for(var r=this.getCopiedBoard(),i=e.x,a=e.y,o=0;o<2;o++)for(var s=0;s<3;s++)r[a+o][i+s]=vte.UNREACHABLE;var u=[this.tiles[0],this.tiles[1]];return t&&(u[this.getCurrentPlayer().value]+=1),new n(r,this.turn,u,this.captures)}},{key:"getLegalLandings",value:function(e){var t,n=[],r=uy(gre.STEPS);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.getNext(i.direction,1);this.isOnBoard(a)&&this.getPieceAt(a)===vte.EMPTY&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPiecesByFreedom",value:function(){for(var e=[[0,0,0,0],[0,0,0,0]],t=0;t<10;t++)for(var n=0;n<15;n++){var r=this.board[t][n];if(r.isPlayer()){var i=this.getEmptyNeighbors(new fte(n,t),vte.EMPTY).length;e[r.value][i]=e[r.value][i]+1}}return e}}],[{key:"getTilesUpperLeftCoord",value:function(e){var t=e.x-e.x%3,n=e.y;return n-=t%2==0?e.y%2:(e.y+1)%2,new fte(t,n)}},{key:"getPresentNeighborEntrances",value:function(e){return[new fte(e.x+1,e.y-1),new fte(e.x+3,e.y+0),new fte(e.x+3,e.y+1),new fte(e.x+1,e.y+2),new fte(e.x-1,e.y+1),new fte(e.x-1,e.y+0)].filter(n.isInRange)}},{key:"getInitialState",value:function(){var e=vte.EMPTY,t=vte.UNREACHABLE,r=vte.ZERO,i=vte.ONE;return new n([[t,t,t,t,t,t,r,e,r,t,t,t,t,t,t],[t,t,t,e,e,r,e,e,e,r,e,e,t,t,t],[e,i,e,i,e,e,r,e,r,e,e,i,e,i,e],[i,e,e,e,i,e,e,e,e,e,i,e,e,e,i],[e,i,e,i,e,e,e,e,e,e,e,i,e,i,e],[e,r,e,r,e,e,e,e,e,e,e,r,e,r,e],[r,e,e,e,r,e,e,e,e,e,r,e,e,e,r],[e,r,e,r,e,e,i,e,i,e,e,r,e,r,e],[t,t,t,e,e,i,e,e,e,i,e,e,t,t,t],[t,t,t,t,t,t,i,e,i,t,t,t,t,t,t]],0,[0,0],[0,0])}}]),n}(kre);Cre.VERBOSE=!1,Cre.NEIGHBORS_TILES_DIRECTIONS=[new ate(0,-2),new ate(3,-1),new ate(3,1),new ate(0,2),new ate(-3,1),new ate(-3,-1)],Cre.isInRange=function(e){return e.isInRange(15,10)};var wre=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isTileExchange()?this.applyLegalTileExchange(e,t):this.applyLegalMovement(e,t)}},{key:"applyLegalTileExchange",value:function(e,t){var r=t.getCopiedBoard(),i=e.capture.get();r[i.y][i.x]=vte.EMPTY;var a=[t.captures[0],t.captures[1]];a[t.getCurrentPlayer().value]+=1;var o=[t.tiles[0],t.tiles[1]];o[t.getCurrentPlayer().value]-=2;var s=new Cre(r,t.turn,o,a),u=s.removeTilesIfNeeded(i,!1),c=new Cre(u.getCopiedBoard(),u.turn+1,u.tiles,u.captures);return OB(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:t,afterCapture:s,afterTileRemoval:u,resultingState:c}}),c}},{key:"applyLegalMovement",value:function(e,t){var r=t.applyLegalMovement(e),i=r.removeTilesIfNeeded(e.start.get(),!0),a=i.doMovementCaptures(e),o=new Cre(a.board,t.turn+1,a.tiles,a.captures);return OB(n.VERBOSE,{ab_state:t,afterMovement:r,afterTilesRemoved:i,afterCaptures:a,resultingState:o}),o}},{key:"isLegal",value:function(e,t){return e.isTileExchange()?this.isLegalTileExchange(e,t):this.isLegalMovement(e,t)}},{key:"isLegalTileExchange",value:function(e,t){if(t.tiles[t.getCurrentPlayer().value]<2)return MB.failure(pre.NOT_ENOUGH_TILES_TO_EXCHANGE());var n=t.getPieceAt(e.capture.get());return n===vte.UNREACHABLE||n===vte.EMPTY?MB.failure(pre.CANNOT_CAPTURE_FROM_EMPTY()):n.is(t.getCurrentPlayer())?MB.failure(pre.CANNOT_CAPTURE_OWN_PIECES()):MB.success(void 0)}},{key:"isLegalMovement",value:function(e,t){if(t.getPieceAt(e.start.get())===vte.UNREACHABLE){var n="Cannot start with a coord outside the board "+e.start.get().toString()+".";return MB.failure(n)}if(t.getPieceAt(e.landingCoord.get())===vte.UNREACHABLE){var r="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return MB.failure(r)}var i=t.getPieceAt(e.start.get());return i===vte.EMPTY?MB.failure(Cte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):i.is(t.getCurrentOpponent())?MB.failure(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()):t.getPieceAt(e.landingCoord.get()).is(t.getCurrentPlayer())?MB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE()):MB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;return t.captures[0]>=18?Lte.ZERO_WON:t.captures[1]>=18?Lte.ONE_WON:Lte.ONGOING}}]),n}(Fte);return e.VERBOSE=!1,e}(),_re=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=this.getListExchanges(e);return t=t.concat(this.getListMovement(e)),this.putCaptureFirst(e,t)}},{key:"getListExchanges",value:function(e){var t=[],n=e.gameState,r=n.getCurrentPlayer().value,i=vte.ofPlayer(n.getCurrentOpponent());if(n.tiles[r]<2)return t;for(var a=0;a<10;a++)for(var o=0;o<15;o++){var s=new fte(o,a);if(n.getPieceAt(s)===i){var u=yre.fromTilesExchange(s);t.push(u)}}return t}},{key:"getListMovement",value:function(e){for(var t=[],n=e.gameState,r=n.getCurrentPlayer(),i=0;i<10;i++)for(var a=0;a<15;a++){var o=new fte(a,i);if(n.getPieceAt(o).is(r)){var s,u=uy(n.getLegalLandings(o));try{for(u.s();!(s=u.n()).done;){var c=s.value,l=yre.fromCoordToCoord(o,c);t.push(l)}}catch(f){u.e(f)}finally{u.f()}}}return t}},{key:"getBoardValue",value:function(e){var t=wre.getGameStatus(e);if(t.isEndGame)return _te.fromWinner(t.winner);var n=e.gameState,r=n.getPiecesByFreedom(),i=this.getPiecesScore(r);return new _te(2*n.captures[1]+i[1]-(2*n.captures[0]+i[0]))}},{key:"getPiecesScore",value:function(e){return[this.getPlayerPiecesScore(e[0]),this.getPlayerPiecesScore(e[1])]}},{key:"getPlayerPiecesScore",value:function(e){return 3*e[0]+1*e[1]+3*e[2]+3*e[3]}},{key:"putCaptureFirst",value:function(e,t){var n=this;return t9.sortByDescending(t,function(t){return n.moveCapturesList(e,t).length}),t}},{key:"moveCapturesList",value:function(e,t){return t.isTileExchange()?[t.capture.get()]:e.gameState.applyLegalMovement(t).removeTilesIfNeeded(t.start.get(),!0).getCapturedNeighbors(t.landingCoord.get())}}]),n}(wte),Ere=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=wre.getGameStatus(e);if(t.isEndGame)return _te.fromWinner(t.winner);var r,i=e.gameState,a=this.getPiecesMap(i),o=this.getThreatMap(i,a),s=this.filterThreatMap(o,i),u=0,c=uy(Q7.PLAYERS);try{for(c.s();!(r=c.n()).done;){var l,f=r.value,h=uy(a.get(f).get());try{for(h.s();!(l=h.n()).done;){var d=l.value;s.get(d).isPresent()?u+=f.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=f.getScoreModifier()*n.SCORE_BY_SAFE_PIECE}}catch(v){h.e(v)}finally{h.f()}}}catch(v){c.e(v)}finally{c.f()}return u+=i.tiles[1]-i.tiles[0],new _te(u)}},{key:"getPiecesMap",value:function(e){for(var t=new Mte,n=[],r=[],i=0;i<10;i++)for(var a=0;a<15;a++){var o=new fte(a,i),s=e.getPieceAt(o);s===vte.ZERO?n.push(o):s===vte.ONE&&r.push(o)}return t.set(Q7.ZERO,new Wne(n)),t.set(Q7.ONE,new Wne(r)),t}},{key:"getThreatMap",value:function(e,t){var n,r=new Mte,i=uy(Q7.PLAYERS);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=uy(t.get(o).get());try{for(s.s();!(a=s.n()).done;){var u=a.value,c=this.getThreat(u,e);c.isPresent()&&r.set(u,c.get())}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return r}},{key:"getThreat",value:function(e,t){var n,r=Q7.of(t.getPieceAt(e).value).getOpponent(),i=RB.empty(),a=RB.empty(),o=[],s=mre.getNeighbors(e).filter(function(e){return e.isInRange(15,10)}),u=uy(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=t.getPieceAt(c);if(l.is(r))o.push(c),this.tileCouldBeRemovedThisTurn(c,t,r)&&(a=RB.of(c));else if(l===vte.EMPTY){if(i.isPresent())return RB.empty();i=RB.of(c)}}}catch(g){u.e(g)}finally{u.f()}if(i.isPresent()){var f,h=[],d=uy(gre.STEPS);try{var v=function(){var e=f.value,n=i.get().getNext(e.direction,1);n.isInRange(15,10)&&t.getPieceAt(n).is(r)&&!1===o.some(function(e){return e.equals(n)})&&h.push(n)};for(d.s();!(f=d.n()).done;)v()}catch(g){d.e(g)}finally{d.f()}if(h.length>0)return RB.of(new Zne(new Wne(o),new Wne(h)))}if(a.isPresent()){o=o.filter(function(e){return e.equals(a.get())});var p=new Wne(o);return RB.of(new Zne(p,new Wne([a.get()])))}return RB.empty()}},{key:"tileCouldBeRemovedThisTurn",value:function(e,t,n){var r=n.getOpponent();if(!1===t.isDeconnectable(e))return!1;for(var i=RB.empty(),a=Cre.getTilesUpperLeftCoord(e),o=0;o<2;o++)for(var s=0;s<3;s++){var u=a.getNext(new ate(s,o),1);if(t.getPieceAt(u).is(n)){if(!this.pieceCouldLeaveTheTile(u,t))return!1;i=RB.of(u)}else if(t.getPieceAt(u).is(r))return!1}return i.isPresent()}},{key:"pieceCouldLeaveTheTile",value:function(e,t){var n,r=Cre.getTilesUpperLeftCoord(e),i=uy(gre.STEPS);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=e.getNext(a.direction,1),s=Cre.getTilesUpperLeftCoord(o);if(!1===r.equals(s)&&t.getPieceAt(o)===vte.EMPTY)return!0}}catch(u){i.e(u)}finally{i.f()}return!1}},{key:"filterThreatMap",value:function(e,t){var n,r=new Mte,i=e.listKeys(),a=i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentPlayer())}),o=new Wne(i.filter(function(e){return t.getPieceAt(e).is(t.getCurrentOpponent())})),s=uy(a);try{for(s.s();!(n=s.n()).done;){var u,c=n.value,l=e.get(c).get(),f=RB.empty(),h=uy(l.directThreats);try{for(h.s();!(u=h.n()).done;){var d=u.value;if(!1===o.contains(d)){var v,p=[],g=uy(l.mover);try{for(g.s();!(v=g.n()).done;){var y=v.value;!1===o.contains(y)&&p.push(y)}}catch(_){g.e(_)}finally{g.f()}p.length>0&&(f=RB.of(new Zne(l.directThreats,new Wne(p))))}}}catch(_){h.e(_)}finally{h.f()}f.isPresent()&&r.set(c,f.get())}}catch(_){s.e(_)}finally{s.f()}var m,k=uy(o);try{for(k.s();!(m=k.n()).done;){var C=m.value,w=e.get(C).get();r.set(C,w)}}catch(_){k.e(_)}finally{k.f()}return r}}]),n}(_re);return e.SCORE_BY_THREATENED_PIECE=1e3,e.SCORE_BY_SAFE_PIECE=1e6,e}(),bre=vte.EMPTY,Sre=vte.UNREACHABLE,Pre=vte.ZERO,Ore=vte.ONE,Tre=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Nt||(Nt=Hg(["Board and goal of the game"]))),$localize(Dt||(Dt=Hg(["Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.\n         The triangles are the spaces on which pieces move during the game.\n         The tiles can be removed from the board (you will see how later).\n         The dark pieces belong to the first player and can only move on the dark spaces,\n         while the light pieces belong to the second player and can only move on the light spaces.\n         The goal of the game is to capture all of the opponent's pieces."]))),Cre.getInitialState()),zte.anyMove($localize(Lt||(Lt=Hg(["Move"]))),$localize(Ft||(Ft=Hg(["To move a piece, you need to:\n        <ol>\n          <li>Click on one of your pieces.</li>\n          <li>Click on one of the triangular space highlighted in yellow.</li>\n        </ol>\n        You can pass through the opponent's pieces.\n        You're playing first, hence you're playing Dark.<br/><br/>\n        Perform any move."]))),Cre.getInitialState(),yre.fromCoordToCoord(new fte(3,5),new fte(5,5)),$localize(Ut||(Ut=Hg(["Congratulations! Let's see captures now."])))),zte.fromMove($localize(Vt||(Vt=Hg(["Capture"]))),$localize(Bt||(Bt=Hg(["Every piece has three neighboring triangular spaces (2 on the sides).\n        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!\n        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>\n        You're playing Light, make a capture."]))),new Cre([[Sre,Sre,Sre,Sre,Sre,Sre,Pre,bre,Pre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Pre,bre,bre,bre,bre,bre,Pre,bre,bre,Sre,Sre,Sre],[bre,Ore,bre,Ore,Pre,Ore,bre,bre,Pre,bre,bre,Ore,bre,Ore,bre],[Ore,bre,bre,bre,bre,bre,bre,bre,bre,bre,Ore,bre,bre,bre,Ore],[bre,Ore,bre,Ore,bre,bre,bre,bre,bre,bre,bre,Ore,bre,Ore,bre],[bre,Pre,bre,Pre,bre,bre,bre,bre,bre,bre,bre,Pre,bre,Pre,bre],[Pre,bre,bre,bre,Pre,bre,bre,bre,bre,bre,Pre,bre,bre,bre,Pre],[bre,Pre,bre,Pre,bre,bre,Ore,bre,Ore,bre,bre,Pre,bre,Pre,bre],[Sre,Sre,Sre,bre,bre,Ore,bre,bre,bre,Ore,bre,bre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Ore,bre,Ore,Sre,Sre,Sre,Sre,Sre,Sre]],3,[0,0],[0,0]),[yre.fromCoordToCoord(new fte(5,2),new fte(4,1)),yre.fromCoordToCoord(new fte(3,4),new fte(4,3))],$localize(zt||(zt=Hg(["Congratulations!"]))),$localize(Ht||(Ht=Hg(["Failed, you have not captured any piece."])))),zte.fromMove($localize(Gt||(Gt=Hg(["Gain a tile"]))),$localize($t||($t=Hg(["When a tile is empty, it can become removable from the board.\n        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.\n        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.\n        For example, here, the topmost dark piece will not disconnect its tile when leaving it.\n        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>\n        Perform a move that lets you gain two tiles."]))),new Cre([[Sre,Sre,Sre,Sre,Sre,Sre,bre,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Ore,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[bre,bre,bre,Sre,Sre,Sre,bre,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[bre,bre,Ore,bre,bre,bre,bre,Pre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[bre,bre,bre,Ore,bre,bre,bre,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[bre,bre,bre,bre,bre,bre,bre,bre,bre,bre,bre,Pre,Sre,Sre,Sre],[bre,bre,Pre,bre,bre,Ore,bre,bre,bre,bre,Pre,bre,bre,bre,Pre],[bre,bre,bre,bre,bre,bre,Ore,bre,Ore,bre,bre,Pre,bre,Pre,bre],[Sre,Sre,Sre,bre,bre,Ore,bre,bre,bre,Ore,bre,bre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Ore,bre,Ore,Sre,Sre,Sre,Sre,Sre,Sre]],2,[0,0],[0,0]),[yre.fromCoordToCoord(new fte(2,6),new fte(4,6)),yre.fromCoordToCoord(new fte(2,6),new fte(3,5)),yre.fromCoordToCoord(new fte(2,6),new fte(3,7))],$localize(Zt||(Zt=Hg(["Congratulations!"]))),$localize(qt||(qt=Hg(["Failed, you have not gained the two tiles that you could, try again!"])))),zte.fromMove($localize(Wt||(Wt=Hg(["Exchanging a tile"]))),$localize(jt||(jt=Hg(["When you have a tile, you can see it on the left of the board.\n        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.\n        This will cost you two tiles.\n        If any tiles are removed during that turn, nobody will get them.<br/><br/>\n        Gain some time and capture the last piece!"]))),new Cre([[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,bre,Pre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,bre,bre,bre,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,bre,bre,Ore,bre,Ore,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,bre,Ore,bre,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Ore,bre,Ore,Sre,Sre,Sre,Sre,Sre,Sre]],1,[0,2],[0,0]),[yre.fromTilesExchange(new fte(5,5))],$localize(Yt||(Yt=Hg(["Congratulations!"]))),$localize(Kt||(Kt=Hg(["It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!"])))),zte.fromMove($localize(Qt||(Qt=Hg(["Special capture"]))),$localize(Xt||(Xt=Hg(["When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!\n        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>\n        A move that demonstrate both of these things can be done on this board by Light. Try it!"]))),new Cre([[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,bre,bre,Pre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,bre,Pre,bre,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,Pre,Ore,bre,Ore,bre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,Ore,Pre,bre,bre,bre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,bre,bre,Ore,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre],[Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre,Sre]],1,[0,0],[0,0]),[yre.fromCoordToCoord(new fte(7,6),new fte(6,5)),yre.fromCoordToCoord(new fte(7,6),new fte(8,5))],$localize(Jt||(Jt=Hg(["Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.\n        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space."]))),$localize(en||(en=Hg(["Failed!"]))))]});function Ire(e,t){if(1&e&&(IC(),_S(0,"polygon",13)),2&e){var n=RS().index,r=RS().index,i=RS();mS("ngClass",i.getPyramidClass(n,r)),lS("points",i.getPyramidCoordinate(n,r))}}function Are(e,t){if(1&e&&(IC(),_S(0,"polygon",15)),2&e){var n=RS(2).index,r=RS().index,i=RS();mS("ngClass",i.getEmptyClass(n,r)),lS("points",i.getTriangleCoordinate(n,r))}}function Rre(e,t){if(1&e&&(IC(),pS(0,Are,1,2,"polygon",14)),2&e){var n=RS().index,r=RS().index;mS("ngIf",RS().isEmptyCase(n,r))}}function Mre(e,t){if(1&e&&(IC(),_S(0,"polygon",16)),2&e){var n=RS().index,r=RS().index,i=RS();NS("id","dark_line_",n,"_",r,""),lS("points",i.getLineCoordinate(n,r))}}function xre(e,t){if(1&e&&(IC(),_S(0,"polygon",17)),2&e){var n=RS().index,r=RS().index,i=RS();NS("id","dark_line_",n,"_",r,""),lS("points",i.getLineCoordinate(n,r))}}function Nre(e,t){if(1&e){var n=SS();IC(),CS(0,"g",8),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),pS(1,Ire,1,2,"polygon",9),pS(2,Rre,1,1,"ng-template",null,10,XT),pS(4,Mre,1,3,"polygon",11),pS(5,xre,1,3,"polygon",12),wS()}if(2&e){var r=t.$implicit,i=t.index,a=gS(3),o=RS().index,s=RS();NS("id","click_",i,"_",o,""),DE(1),mS("ngIf",s.isPyramid(i,o))("ngIfElse",a),DE(3),mS("ngIf",r!==s.NONE),DE(1),mS("ngIf",r!==s.NONE)}}function Dre(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Nre,6,6,"g",7),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function Lre(e,t){if(1&e&&(IC(),_S(0,"polygon",18)),2&e){var n=t.$implicit;lS("points",RS().getTriangleCoordinate(n.x,n.y))}}function Fre(e,t){if(1&e&&(IC(),_S(0,"polygon",19)),2&e){var n=RS();lS("points",n.getTriangleCoordinate(n.lastStart.get().x,n.lastStart.get().y))}}function Ure(e,t){if(1&e&&(IC(),_S(0,"polygon",19)),2&e){var n=RS();lS("points",n.getTriangleCoordinate(n.lastEnd.get().x,n.lastEnd.get().y))}}function Vre(e,t){if(1&e&&(IC(),_S(0,"polygon",20)),2&e){var n=RS();NS("id","selected_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),lS("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Bre(e,t){if(1&e&&(IC(),CS(0,"g",21),_S(1,"polygon",22),CS(2,"text",23),rP(3),wS(),wS()),2&e){var n=RS();DE(1),lS("points",n.getTilesCountCoordinate(0,0))("stroke",n.lastTurnWasTilesExchange(0)?"yellow":"black"),DE(1),lS("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+0*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),DE(1),iP(n.tiles[0])}}function zre(e,t){if(1&e&&(IC(),CS(0,"g",24),_S(1,"polygon",25),CS(2,"text",26),rP(3),wS(),wS()),2&e){var n=RS();DE(1),lS("points",n.getTilesCountCoordinate(0,9))("stroke",n.lastTurnWasTilesExchange(1)?"yellow":"black"),DE(1),lS("x",n.SPACE_SIZE/2+0*n.SPACE_SIZE)("y",16+n.SPACE_SIZE/2+9*n.SPACE_SIZE)("font-size",n.SPACE_SIZE/2),DE(1),iP(n.tiles[1])}}var Hre=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).tiles=[0,0],r.NONE=vte.UNREACHABLE,r.chosenCoord=RB.empty(),r.lastStart=RB.empty(),r.lastEnd=RB.empty(),r.possibleLandings=[],r.scores=RB.of([0,0]),r.rules=new wre(Cre),r.availableMinimaxes=[new _re(r.rules,"Normal"),new Ere(r.rules,"Piece > Threat > Tiles")],r.encoder=yre.encoder,r.tutorial=(new Tre).tutorial,r.SPACE_SIZE=70,r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){this.chosenCoord=RB.empty(),this.state=this.rules.node.gameState,this.scores=RB.of(this.state.captures),this.tiles=this.state.tiles;var e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=RB.empty(),this.lastEnd=RB.empty()),this.board=this.rules.node.gameState.board}},{key:"showHighlight",value:function(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=RB.empty(),this.possibleLandings=[]}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new fte(e,t),o=n.state.getCurrentPlayer(),r.abrupt("return",n.chosenCoord.equalsValue(a)?(n.cancelMoveAttempt(),DB.SUCCESS):n.chosenCoord.isAbsent()||n.state.getPieceAt(a).is(o)?n.firstClick(a):n.secondClick(a));case 5:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.state.getPieceAt(e)).is(t.state.getCurrentOpponent())){n.next=4;break}return i=yre.fromTilesExchange(e),n.abrupt("return",t.chooseMove(i,t.state,t.state.captures));case 4:return n.abrupt("return",r.is(t.state.getCurrentPlayer())?(t.chosenCoord=RB.of(e),t.showHighlight(),DB.SUCCESS):t.cancelMove(pre.FIRST_CLICK_SHOULD_NOT_BE_NULL()));case 5:case"end":return n.stop()}},n)}))()}},{key:"secondClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.possibleLandings.some(function(t){return t.equals(e)})){n.next=3;break}return r=yre.fromCoordToCoord(t.chosenCoord.get(),e),n.abrupt("return",t.chooseMove(r,t.state,t.state.captures));case 3:return n.abrupt("return",t.cancelMove(pre.INVALID_DISTANCE()));case 4:case"end":return n.stop()}},n)}))()}},{key:"isPyramid",value:function(e,t){return this.board[t][e].isPlayer()||this.wasOpponent(e,t)}},{key:"wasOpponent",value:function(e,t){var n=this.rules.node.mother;return n.isPresent()&&n.get().gameState.getPieceAtXY(e,t).is(n.get().gameState.getCurrentOpponent())}},{key:"getPyramidClass",value:function(e,t){var n=this.board[t][e];return n===vte.ZERO?this.getPlayerClass(Q7.ZERO):n===vte.ONE?this.getPlayerClass(Q7.ONE):"captured"}},{key:"isEmptyCase",value:function(e,t){return this.board[t][e]===vte.EMPTY||this.wasRemoved(e,t)}},{key:"wasRemoved",value:function(e,t){var n=this.rules.node.mother;if(this.board[t][e]===vte.UNREACHABLE&&n.isPresent()){var r=n.get().gameState.getPieceAtXY(e,t);return r===vte.EMPTY||r.is(n.get().gameState.getCurrentPlayer())}return!1}},{key:"getEmptyClass",value:function(e,t){return this.board[t][e]===vte.EMPTY?(e+t)%2==1?"background":"background2":"captured2"}},{key:"getTilesCountCoordinate",value:function(e,t){var n=100*e,r=100*t,i=n+25;return i+", "+r+", "+(n+75)+", "+r+", "+(n+100)+", "+(r+50)+", "+(n+75)+", "+(r+100)+", "+(n+25)+", "+(r+100)+", "+(n+0)+", "+(r+50)+", "+i+", "+r}},{key:"getLineCoordinate",value:function(e,t){var n=this.getTriangleCornerCoords(e,t);return e%3==0?n[0].x+","+n[0].y+","+n[1].x+","+n[1].y:e%3==1?n[0].x+","+n[0].y+","+n[2].x+","+n[2].y:n[1].x+","+n[1].y+","+n[2].x+","+n[2].y}},{key:"mustShowTilesOf",value:function(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}},{key:"lastTurnWasTilesExchange",value:function(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}]),n}(vre);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-coerceo"]],features:[Qb],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill highlighted",4,"ngFor","ngForOf"],["class","base no-fill last-move",4,"ngIf"],["class","base no-fill selected",3,"id",4,"ngIf"],["id","tilesCountZero",4,"ngIf"],["id","tilesCountOne",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptyCase",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","last-move"],[1,"base","no-fill","selected",3,"id"],["id","tilesCountZero"],["stroke-linecap","round",1,"base","player0"],["id","playerZeroTilesCount","text-anchor","middle",1,"text"],["id","tilesCountOne"],["stroke-linecap","round",1,"base","player1"],["id","playerOneTilesCount","text-anchor","middle",1,"text"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,Dre,2,1,"g",1),pS(2,Lre,1,1,"polygon",2),pS(3,Fre,1,1,"polygon",3),pS(4,Ure,1,1,"polygon",3),pS(5,Vre,1,3,"polygon",4),pS(6,Bre,4,6,"g",5),pS(7,zre,4,6,"g",6),wS()),2&e&&(lS("viewBox","-5 -5 "+(10+8*t.SPACE_SIZE)+" "+(10+10*t.SPACE_SIZE)),DE(1),mS("ngForOf",t.board),DE(1),mS("ngForOf",t.possibleLandings),DE(1),mS("ngIf",t.lastStart.isPresent()),DE(1),mS("ngIf",t.lastEnd.isPresent()),DE(1),mS("ngIf",t.chosenCoord.isPresent()),DE(1),mS("ngIf",t.mustShowTilesOf(0)),DE(1),mS("ngIf",t.mustShowTilesOf(1)))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Gre=function(){var e=dy(function e(){fy(this,e)});return e.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=function(){return $localize(tn||(tn=Hg(["Your piece should land on a neighboring square."])))},e.CANNOT_DROP_AFTER_TURN_40=function(){return $localize(nn||(nn=Hg(["You cannot drop a piece during the moving phase."])))},e.CANNOT_MOVE_BEFORE_TURN_40=function(){return $localize(rn||(rn=Hg(["You cannot move a piece before both players have dropped all of their pieces."])))},e.MUST_JUMP_OVER_PIECES=function(){return $localize(an||(an=Hg(["A jump must be made over a piece, not over an empty square."])))},e.MUST_DROP_IN_CENTRAL_ZONE=function(){return $localize(on||(on=Hg(["A drop must occur in the central zone of the board."])))},e.INVALID_JUMP=function(){return $localize(sn||(sn=Hg(["A jump must land two squares from its original position, and be done in a straight line in any direction."])))},e.SAME_LOCATION_VISITED_IN_JUMP=function(){return $localize(un||(un=Hg(["You are visiting the same location twice in a move, you are not allowed to do so."])))},e}(),$re=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isShelter",value:function(e){return 0===e.x||e.x===n.WIDTH-1?n.SHELTERS_INDICES.some(function(t){return e.y===t}):(0===e.y||e.y===n.HEIGHT-1)&&n.SHELTERS_INDICES.some(function(t){return e.x===t})}},{key:"isCentralZone",value:function(e){return e.x>=n.CENTRAL_ZONE_TOP_LEFT.x&&e.x<=n.CENTRAL_ZONE_BOTTOM_RIGHT.x&&e.y>=n.CENTRAL_ZONE_TOP_LEFT.y&&e.y<=n.CENTRAL_ZONE_BOTTOM_RIGHT.y}},{key:"isDropPhase",value:function(){return this.turn<40}},{key:"getSidePieces",value:function(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}],[{key:"getInitialState",value:function(){return new n(t9.createTable(n.WIDTH,n.HEIGHT,K7.NONE),0)}}]),n}(Pte);$re.WIDTH=17,$re.HEIGHT=17,$re.CENTRAL_ZONE_TOP_LEFT=new fte(4,6),$re.CENTRAL_ZONE_BOTTOM_RIGHT=new fte(12,10),$re.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],$re.ALL_SHELTERS=new bte($re.SHELTERS_INDICES.flatMap(function(e){return[new fte(e,0),new fte(e,$re.HEIGHT-1),new fte(0,e),new fte($re.WIDTH-1,e)]})).toList();var Zre=function(e){Jg(n,e);var t=ty(n);function n(e){return fy(this,n),t.call(this,e.x,e.y)}return dy(n,[{key:"toString",value:function(){return"ConspirateursMoveDrop(".concat(this.coord.toString(),")")}},{key:"equals",value:function(e){return!!e.isDrop()&&this.coord.equals(e.coord)}},{key:"isDrop",value:function(){return!0}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e){return e.isInRange($re.WIDTH,$re.HEIGHT)?MB.success(new n(e)):MB.failure("Move out of board")}}]),n}(Ite);Zre.encoder=function(){function e(){fy(this,e)}return dy(e,null,[{key:"getEncoder",value:function(e,t,n){return new(function(r){Jg(a,r);var i=ty(a);function a(){var e;return fy(this,a),(e=i.apply(this,arguments)).shiftX=t,e}return dy(a,[{key:"maxValue",value:function(){return(e-1)*this.shiftX+(t-1)}},{key:"encodeNumber",value:function(e){return e.coord.x*this.shiftX+e.coord.y}},{key:"decodeNumber",value:function(r){var i=r%t;r/=t;var a=new fte((r-=r%1)%e,i);return n(a)}}]),a}(j7))}}]),e}().getEncoder($re.WIDTH,$re.HEIGHT,function(e){return Zre.of(e).get()});var qre=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,r)}return dy(n,[{key:"toString",value:function(){return"ConspirateursMoveSimple(".concat(this.coord.toString()," -> ").concat(this.end.toString(),")")}},{key:"equals",value:function(e){return!(!e.isSimple()||e!==this&&(!1===e.coord.equals(this.coord)||!1===e.end.equals(this.end)))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!0}},{key:"isJump",value:function(){return!1}}],[{key:"of",value:function(e,t){return e.isInRange($re.WIDTH,$re.HEIGHT)&&t.isInRange($re.WIDTH,$re.HEIGHT)?e.isAlignedWith(t)&&1===e.getDistance(t)?MB.success(new n(e,t)):MB.failure(Gre.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):MB.failure("Move out of board")}}]),n}(Mne);qre.encoder=Mne.getEncoder($re.WIDTH,$re.HEIGHT,function(e,t){return qre.of(e,t).get()});var Wre=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).coords=e,r}return dy(n,[{key:"addJump",value:function(e){var t=t9.copyImmutableArray(this.coords);return t.push(e),n.of(t)}},{key:"getStartingCoord",value:function(){return this.coords[0]}},{key:"getEndingCoord",value:function(){return this.coords[this.coords.length-1]}},{key:"getLandingCoords",value:function(){return this.coords.slice(1)}},{key:"getJumpedOverCoords",value:function(){for(var e=[],t=1;t<this.coords.length;t++){var n=this.coords[t-1].getDirectionToward(this.coords[t]).get();e.push(this.coords[t-1].getNext(n,1))}return e}},{key:"toString",value:function(){return"ConspirateursMoveJump(".concat(this.coords.map(function(e){return e.toString()}).reduce(function(e,t){return e+" -> "+t}),")")}},{key:"equals",value:function(e){return!(e.isSimple()||e.isDrop()||e!==this&&(!1===this.getStartingCoord().equals(e.getStartingCoord())||!1===this.getEndingCoord().equals(e.getEndingCoord())))}},{key:"isDrop",value:function(){return!1}},{key:"isSimple",value:function(){return!1}},{key:"isJump",value:function(){return!0}}],[{key:"of",value:function(e){if(e.length<2)return MB.failure("ConspirateursMoveJump requires at least one jump, so two coords");var t,r=uy(e);try{for(r.s();!(t=r.n()).done;){if(t.value.isNotInRange($re.WIDTH,$re.HEIGHT))return MB.failure("Move out of board")}}catch(a){r.e(a)}finally{r.f()}for(var i=1;i<e.length;i++)if(e[i-1].getDirectionToward(e[i]).isFailure()||2!==e[i-1].getDistance(e[i]))return MB.failure(Gre.INVALID_JUMP());return new Wne(e).size()===e.length?MB.success(new n(e)):MB.failure(Gre.SAME_LOCATION_VISITED_IN_JUMP())}}]),n}(Tte);Wre.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).coordEncoder=fte.numberEncoder($re.WIDTH,$re.HEIGHT),e}return dy(n,[{key:"encodeMove",value:function(e){return{coords:e.coords.map(this.coordEncoder.encodeNumber)}}},{key:"decodeMove",value:function(e){N7(null!=PB.getNonNullable(e).coords,"Encoded ConspirateursMoveJump should contain coords");var t=PB.getNonNullable(e).coords.map(this.coordEncoder.decodeNumber);return Wre.of(t).get()}}]),n}(W7));var jre=W7.disjunction3(Zre.encoder,qre.encoder,Wre.encoder,function(e){return e.isDrop()},function(e){return e.isSimple()}),Yre=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this,$re)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();if(e.isDrop())r[e.coord.y][e.coord.x]=t.getCurrentPlayer();else if(e.isSimple())r[e.coord.y][e.coord.x]=K7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer();else{var i=e.getStartingCoord(),a=e.getEndingCoord();r[i.y][i.x]=K7.NONE,r[a.y][a.x]=t.getCurrentPlayer()}return new $re(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.dropLegality(e,t):e.isSimple()?this.simpleMoveLegality(e,t):this.jumpLegality(e,t)}},{key:"dropLegality",value:function(e,t){return t.turn>=40?MB.failure(Gre.CANNOT_DROP_AFTER_TURN_40()):t.getPieceAt(e.coord).isPlayer()?MB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE()):!1===t.isCentralZone(e.coord)?MB.failure(Gre.MUST_DROP_IN_CENTRAL_ZONE()):MB.success(void 0)}},{key:"simpleMoveLegality",value:function(e,t){return t.turn<40?MB.failure(Gre.CANNOT_MOVE_BEFORE_TURN_40()):t.getPieceAt(e.coord)!==t.getCurrentPlayer()?MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE()):t.getPieceAt(e.end).isPlayer()?MB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE()):MB.success(void 0)}},{key:"jumpLegality",value:function(e,t){if(t.turn<40)return MB.failure(Gre.CANNOT_MOVE_BEFORE_TURN_40());if(t.getPieceAt(e.getStartingCoord())!==t.getCurrentPlayer())return MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE());var n,r=uy(e.getJumpedOverCoords());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t.getPieceAt(i)===K7.NONE)return MB.failure(Gre.MUST_JUMP_OVER_PIECES())}}catch(u){r.e(u)}finally{r.f()}var a,o=uy(e.getLandingCoords());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t.getPieceAt(s).isPlayer())return MB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE())}}catch(u){o.e(u)}finally{o.f()}return MB.success(void 0)}},{key:"jumpTargetsFrom",value:function(e){for(var t=[],n=0,r=[new fte(e.x+2,e.y),new fte(e.x-2,e.y),new fte(e.x,e.y+2),new fte(e.x,e.y-2),new fte(e.x+2,e.y+2),new fte(e.x+2,e.y-2),new fte(e.x-2,e.y+2),new fte(e.x-2,e.y-2)];n<r.length;n++){var i=r[n];Wre.of([e,i]).isSuccess()&&t.push(i)}return t}},{key:"nextJumps",value:function(e,t){var n,r=e.getEndingCoord(),i=[],a=uy(this.jumpTargetsFrom(r));try{for(a.s();!(n=a.n()).done;){var o=n.value,s=e.addJump(o);s.isSuccess()&&this.jumpLegality(s.get(),t).isSuccess()&&i.push(s.get())}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"jumpHasPossibleNextTargets",value:function(e,t){return this.nextJumps(e,t).length>0}},{key:"getGameStatus",value:function(e){var t,n=e.gameState,r=[0,0],i=uy($re.ALL_SHELTERS);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.getPieceAt(a);if(o.isPlayer()&&(r[o.value]+=1,20===r[o.value]))return Lte.getVictory(o)}}catch(s){i.e(s)}finally{i.f()}return Lte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=RB.of(new n)),n.singleton.get()}}]),n}(Fte);Yre.singleton=RB.empty();var Kre=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){return this.sortByNumberOfJump(e.gameState.turn<40?this.getListMovesDrop(e.gameState):this.getListMovesAfterDrop(e.gameState))}},{key:"sortByNumberOfJump",value:function(e){return e.sort(function(e,t){var n=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(t.isDrop()?1:t.isSimple()?2:t.coords.length)-n})}},{key:"getListMovesDrop",value:function(e){for(var t=[],n=$re.CENTRAL_ZONE_TOP_LEFT,r=$re.CENTRAL_ZONE_BOTTOM_RIGHT,i=n.y;i<=r.y;i++)for(var a=n.x;a<=r.x;a++)e.getPieceAtXY(a,i)===K7.NONE&&t.push(Zre.of(new fte(a,i)).get());return t}},{key:"getListMovesAfterDrop",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<$re.HEIGHT;r++)for(var i=0;i<$re.WIDTH;i++){var a=new fte(i,r);e.getPieceAt(a)===n&&(t=(t=t.concat(this.getListSimpleMoves(e,a))).concat(this.getListJumps(e,a)))}return t}},{key:"getListSimpleMoves",value:function(e,t){for(var n=[],r=0,i=[new fte(t.x+1,t.y),new fte(t.x-1,t.y),new fte(t.x,t.y+1),new fte(t.x,t.y-1),new fte(t.x+1,t.y+1),new fte(t.x+1,t.y-1),new fte(t.x-1,t.y+1),new fte(t.x-1,t.y-1)];r<i.length;r++){var a=i[r],o=qre.of(t,a);o.isSuccess()&&Yre.get().simpleMoveLegality(o.get(),e).isSuccess()&&n.push(o.get())}return n}},{key:"getListJumps",value:function(e,t){var n,r=new bte,i=uy(Yre.get().jumpTargetsFrom(t));try{for(i.s();!(n=i.n()).done;){var a=n.value,o=Wre.of([t,a]).get();Yre.get().jumpLegality(o,e).isSuccess()&&(r.add(o),r.union(this.getListJumpStartingFrom(e,o)))}}catch(s){i.e(s)}finally{i.f()}return r.toList()}},{key:"getListJumpStartingFrom",value:function(e,t){var n,r=Yre.get().nextJumps(t,e),i=new bte(r),a=uy(r);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.union(this.getListJumpStartingFrom(e,o))}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getBoardValue",value:function(e){for(var t=e.gameState,n=0,r=new Mte([{key:Q7.ZERO,value:0},{key:Q7.ONE,value:0}]),i=0;i<$re.HEIGHT;i++)for(var a=0;a<$re.WIDTH;a++){var o=new fte(a,i),s=t.getPieceAt(o);if(s.isPlayer())if(t.isShelter(o)){if(n+=20*s.getScoreModifier(),r.replace(s,r.get(s).get()+1),20===r.get(s).get())return new _te(s.getVictoryValue())}else{var u,c=100,l=uy($re.ALL_SHELTERS);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(t.getPieceAt(f)===K7.NONE){var h=o.getOrthogonalDistance(f);c=Math.min(c,h)}}}catch(d){l.e(d)}finally{l.f()}n-=s.getScoreModifier()*c}}return new _te(n)}}]),n}(wte),Qre=K7.NONE,Xre=K7.ZERO,Jre=K7.ONE,eie=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(cn||(cn=Hg(["Board and aim of the game"]))),$localize(ln||(ln=Hg(["Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially."]))),$re.getInitialState()),zte.anyMove($localize(fn||(fn=Hg(["Initial phase"]))),$localize(hn||(hn=Hg(["In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>Drop one of your piece in the central zone."]))),$re.getInitialState(),Zre.of(new fte(7,7)).get(),$localize(dn||(dn=Hg(["Congratulations!"])))),zte.fromPredicate($localize(vn||(vn=Hg(["Simple move"]))),$localize(pn||(pn=Hg(["Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move."]))),new $re([[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Xre,Jre,Jre,Xre,Xre,Jre,Xre,Jre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Jre,Xre,Jre,Xre,Xre,Xre,Xre,Jre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Jre,Qre,Qre,Qre,Qre,Qre,Jre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Jre,Xre,Xre,Jre,Jre,Jre,Xre,Xre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Jre,Xre,Jre,Jre,Jre,Jre,Jre,Jre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre]],40),qre.of(new fte(4,6),new fte(3,5)).get(),function(e,t,n){return e.isSimple()?DB.SUCCESS:DB.failure($localize(gn||(gn=Hg(["You have made a jump, not a simple move. Try again!"]))))},$localize(yn||(yn=Hg(["Congratulations!"])))),zte.fromPredicate($localize(mn||(mn=Hg(["Jumps"]))),$localize(kn||(kn=Hg(["The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful)."]))),new $re([[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Xre,Jre,Jre,Xre,Xre,Jre,Xre,Jre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Jre,Xre,Jre,Xre,Xre,Xre,Xre,Jre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Jre,Qre,Qre,Qre,Qre,Qre,Jre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Jre,Xre,Xre,Jre,Jre,Jre,Xre,Xre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Jre,Xre,Jre,Jre,Jre,Jre,Jre,Jre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre]],40),Wre.of([new fte(6,7),new fte(6,5)]).get(),function(e,t,n){return e.isJump()?DB.SUCCESS:DB.failure($localize(Cn||(Cn=Hg(["You have not performed a jump. Try again!"]))))},$localize(wn||(wn=Hg(["Congratulations!"])))),zte.fromMove($localize(_n||(_n=Hg(["Chaining jumps in a single move"]))),$localize(En||(En=Hg(["Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it."]))),new $re([[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Jre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Jre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Jre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Xre,Qre,Jre,Xre,Xre,Jre,Xre,Jre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Qre,Xre,Jre,Xre,Xre,Xre,Xre,Jre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Xre,Jre,Qre,Qre,Qre,Qre,Qre,Jre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Jre,Xre,Xre,Jre,Jre,Jre,Xre,Xre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Jre,Xre,Jre,Jre,Jre,Jre,Jre,Jre,Xre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre],[Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre,Qre]],40),[Wre.of([new fte(8,6),new fte(6,4),new fte(6,2),new fte(6,0)]).get()],$localize(bn||(bn=Hg(["Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does."]))),$localize(Sn||(Sn=Hg(["You have not performed a triple jump. Try again!"]))))]});function tie(e,t){if(1&e){var n=SS();IC(),CS(0,"rect",9),TS("click",function(){eC(n);var e=RS().$implicit;return RS(2).onClick(e.coord)}),wS()}if(2&e){var r=RS().$implicit,i=RS(2);lS("x",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.x+i.STROKE_WIDTH)("y",1.5*i.STROKE_WIDTH+i.SPACE_SIZE*r.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE-3*i.STROKE_WIDTH)("height",i.SPACE_SIZE-3*i.STROKE_WIDTH)}}function nie(e,t){if(1&e){var n=SS();IC(),CS(0,"circle",6),TS("click",function(){eC(n);var e=RS().$implicit;return RS(2).onClick(e.coord)}),wS()}if(2&e){var r=RS(),i=r.index,a=r.$implicit,o=RS().index,s=RS();NS("id","piece_",i,"_",o,""),mS("ngClass",a.pieceClasses),lS("r",s.PIECE_RADIUS)("cx",s.SPACE_SIZE*i+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*o+s.STROKE_WIDTH+s.SPACE_SIZE/2)}}function rie(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",6),TS("click",function(){var e=eC(n).$implicit;return RS(2).onClick(e.coord)}),wS(),pS(2,tie,1,4,"rect",7),pS(3,nie,1,6,"circle",8),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();DE(1),NS("id","click_",i,"_",a,""),mS("ngClass",r.squareClasses),lS("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngIf",r.isShelter),DE(1),mS("ngIf",r.hasPiece)}}function iie(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,rie,4,9,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function aie(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",10),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e)}),wS(),wS()}if(2&e){var r=t.$implicit,i=RS();DE(1),mS("ngClass",i.viewInfo.boardInfo[r.y][r.x].shelterClasses),lS("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function oie(e,t){if(1&e&&(IC(),_S(0,"circle",11)),2&e){var n=t.$implicit,r=RS();xS("id","sidePiece_0_",n,""),lS("cx",-r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function sie(e,t){if(1&e&&(IC(),_S(0,"circle",12)),2&e){var n=t.$implicit,r=RS();xS("id","sidePiece_1_",n,""),lS("cx",1715+r.PIECE_RADIUS)("cy",1670-n*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function uie(e,t){if(1&e&&(IC(),_S(0,"rect",13)),2&e){var n=RS();lS("x",n.SPACE_SIZE*n.CENTRAL_ZONE_START.x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.CENTRAL_ZONE_START.y+n.STROKE_WIDTH)("width",n.CENTRAL_ZONE_SIZE.x*n.SPACE_SIZE)("height",n.CENTRAL_ZONE_SIZE.y*n.SPACE_SIZE)}}var cie=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).ALL_SHELTERS=$re.ALL_SHELTERS,r.CENTRAL_ZONE_START=$re.CENTRAL_ZONE_TOP_LEFT,r.CENTRAL_ZONE_SIZE=new ate($re.CENTRAL_ZONE_BOTTOM_RIGHT.x-$re.CENTRAL_ZONE_TOP_LEFT.x+1,$re.CENTRAL_ZONE_BOTTOM_RIGHT.y-$re.CENTRAL_ZONE_TOP_LEFT.y+1),r.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},r.selected=RB.empty(),r.jumpInConstruction=RB.empty(),r.PIECE_RADIUS=r.SPACE_SIZE/2-r.STROKE_WIDTH,r.rules=Yre.get(),r.availableMinimaxes=[new Kre(r.rules,"ConspirateursMinimax")],r.encoder=jre,r.tutorial=(new eie).tutorial,r}return dy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"updateViewInfo",value:function(){var e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(var t=0;t<$re.HEIGHT;t++){this.viewInfo.boardInfo.push([]);for(var n=0;n<$re.WIDTH;n++){var r=new fte(n,t),i=e.getPieceAt(r),a={coord:r,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(i)],hasPiece:i.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[t].push(a)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}},{key:"updateOccupiedShelters",value:function(){var e,t=uy($re.ALL_SHELTERS);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.viewInfo.boardInfo[n.y][n.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("highlighted")}}catch(i){t.e(i)}finally{t.f()}}},{key:"updateSelected",value:function(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){var e=this.jumpInConstruction.get(),t=e.getStartingCoord(),n=e.getEndingCoord();this.viewInfo.boardInfo[t.y][t.x].hasPiece=!1,this.viewInfo.boardInfo[n.y][n.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected"],this.viewInfo.boardInfo[n.y][n.x].hasPiece=!0;var r,i=uy(e.coords);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.boardInfo[a.y][a.x].squareClasses.push("moved")}}catch(s){i.e(s)}finally{i.f()}}else{var o=this.selected.get();this.viewInfo.boardInfo[o.y][o.x].pieceClasses.push("selected")}}},{key:"updateVictory",value:function(){var e=this.getState(),t=Yre.get().getGameStatus(this.rules.node);if(!0===t.isEndGame){var n,r=uy($re.ALL_SHELTERS);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.getPieceAt(i)===t.winner&&this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("victory")}}catch(a){r.e(a)}finally{r.f()}}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved");else if(e.isSimple())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved"),this.viewInfo.boardInfo[e.end.y][e.end.x].squareClasses.push("moved");else{this.viewInfo.lastMoveArrow="";var t,n=uy(e.coords);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}catch(i){n.e(i)}finally{n.f()}}}},{key:"cancelMoveAttempt",value:function(){this.jumpInConstruction=RB.empty(),this.selected=RB.empty(),this.updateBoard()}},{key:"onClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if((i=t.getState()).getPieceAt(e)!==t.getCurrentPlayer()){n.next=6;break}return n.abrupt("return",(t.selected.equalsValue(e)?t.cancelMoveAttempt():(t.selected=RB.of(e),t.jumpInConstruction=RB.empty()),t.updateViewInfo(),DB.SUCCESS));case 6:if(!t.jumpInConstruction.isPresent()){n.next=8;break}return n.abrupt("return",t.constructJump(e));case 8:if(!t.selected.isPresent()){n.next=10;break}return n.abrupt("return",t.selectNextCoord(e));case 10:if(!i.isDropPhase()){n.next=13;break}return a=Zre.of(e),n.abrupt("return",(N7(a.isSuccess(),"ConspirateursMove should be valid by construction"),t.chooseMove(a.get(),i)));case 13:return n.abrupt("return",t.cancelMove(Cte.MUST_CHOOSE_PLAYER_PIECE()));case 14:case"end":return n.stop()}},n)}))()}},{key:"constructJump",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.jumpInConstruction.get(),i=t.getState(),!e.equals(r.getEndingCoord())){n.next=3;break}return n.abrupt("return",t.chooseMove(r,i));case 3:if(!(a=r.addJump(e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(a.getReason()));case 6:return o=t.rules.jumpLegality(a.get(),i),n.abrupt("return",o.isFailure()?t.cancelMove(o.getReason()):t.updateJump(a.get()));case 8:case"end":return n.stop()}},n)}))()}},{key:"updateJump",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getState(),n.abrupt("return",t.rules.jumpHasPossibleNextTargets(e,r)?(t.jumpInConstruction=RB.of(e),t.updateViewInfo(),DB.SUCCESS):t.chooseMove(e,r));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectNextCoord",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.selected.get(),!(i=qre.of(r,e)).isSuccess()){n.next=3;break}return n.abrupt("return",t.chooseMove(i.get(),t.getState()));case 3:return a=Wre.of([r,e]),n.abrupt("return",a.isFailure()?t.cancelMove(a.getReason()):t.updateJump(a.get()));case 5:case"end":return n.stop()}},n)}))()}}]),n}(hte);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-conspirateurs"]],features:[Qb],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1",3,"id",4,"ngFor","ngForOf"],["class","base no-fill highlighted mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0",3,"id"],[1,"base","mid-stroke","player1",3,"id"],[1,"base","no-fill","highlighted","mid-stroke"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,iie,2,1,"g",1),pS(2,aie,2,5,"g",1),pS(3,oie,1,4,"circle",2),pS(4,sie,1,4,"circle",3),pS(5,uie,1,4,"rect",4),_S(6,"polyline",5),wS()),2&e&&(DE(1),mS("ngForOf",t.viewInfo.boardInfo),DE(1),mS("ngForOf",t.ALL_SHELTERS),DE(1),mS("ngForOf",t.range(t.viewInfo.sidePieces[0])),DE(1),mS("ngForOf",t.range(t.viewInfo.sidePieces[1])),DE(1),mS("ngIf",t.viewInfo.dropPhase),DE(1),lS("points",t.viewInfo.lastMoveArrow))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),lie=function(){function e(t,n){fy(this,e),this.owner=t,this.otherPieceType=n}return dy(e,[{key:"toString",value:function(){return"DiamPiece(".concat(this.owner,", ").concat(this.otherPieceType,")")}}],[{key:"of",value:function(t,n){return t===Q7.ZERO?n?e.ZERO_SECOND:e.ZERO_FIRST:t===Q7.ONE?n?e.ONE_SECOND:e.ONE_FIRST:e.EMPTY}}]),e}();lie.encoder=j7.tuple([Q7.numberEncoder,j7.booleanEncoder],function(e){return[e.owner,e.otherPieceType]},function(e){return lie.of(e[0],e[1])}),lie.EMPTY=new lie(K7.NONE,!1),lie.ZERO_FIRST=new lie(Q7.ZERO,!1),lie.ZERO_SECOND=new lie(Q7.ZERO,!0),lie.ONE_FIRST=new lie(Q7.ONE,!1),lie.ONE_SECOND=new lie(Q7.ONE,!0),lie.PLAYER_PIECES=[lie.ZERO_FIRST,lie.ZERO_SECOND,lie.ONE_FIRST,lie.ONE_SECOND];var fie=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;if(fy(this,n),(i=t.call(this)).target=e,i.piece=r,r===lie.EMPTY)throw new Error("Cannot drop an empty piece");return ny(i)}return dy(n,[{key:"isDrop",value:function(){return!0}},{key:"getTarget",value:function(){return this.target}},{key:"equals",value:function(e){return!(this.target!==e.target||this.piece!==e.piece)}},{key:"toString",value:function(){return"DiamMoveDrop(".concat(this.target,", ").concat(this.piece,")")}}]),n}(Tte);fie.encoder=j7.tuple([j7.numberEncoder(7),lie.encoder],function(e){return[e.target,e.piece]},function(e){return new fie(e[0],e[1])});var hie=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this)).start=e,i.moveDirection=r,i}return dy(n,[{key:"isDrop",value:function(){return!1}},{key:"getTarget",value:function(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}},{key:"equals",value:function(e){return!(!1===this.start.equals(e.start)||this.moveDirection!==e.moveDirection)}},{key:"toString",value:function(){return"DiamMoveShift(".concat(this.start,", ").concat(this.moveDirection,")")}}],[{key:"fromRepresentation",value:function(e,t){return new n(new fte(e.x,3-e.y),t)}}]),n}(Tte);hie.encoder=j7.tuple([fte.numberEncoder(8,4),j7.booleanEncoder],function(e){return[e.start,"clockwise"===e.moveDirection]},function(e){return new hie(e[0],e[1]?"clockwise":"counterclockwise")});var die=j7.disjunction(fie.encoder,hie.encoder,function(e){return e.isDrop()}),vie=function(){var e=dy(function e(){fy(this,e)});return e.NO_MORE_PIECES_OF_THIS_TYPE=function(){return $localize(Pn||(Pn=Hg(["You do not have any pieces of this type anymore."])))},e.SPACE_IS_FULL=function(){return $localize(On||(On=Hg(["You cannot play here: this space is already full."])))},e.TARGET_STACK_TOO_HIGH=function(){return $localize(Tn||(Tn=Hg(["You cannot add more pieces to the target stack, as it will contain more than 4 pieces."])))},e.MUST_SHIFT_TO_NEIGHBOR=function(){return $localize(In||(In=Hg(["To perform a shift, you must move the pieces to a neighboring space."])))},e.MUST_SELECT_PIECE_FIRST=function(){return $localize(An||(An=Hg(["You must first select either a piece from the side, or a stack of pieces to shift on the board."])))},e}(),pie=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,i)).remainingPieces=r,a}return dy(n,[{key:"getRemainingPiecesOf",value:function(e){return this.remainingPieces[n.pieceIndex(e)]}},{key:"getStackHeight",value:function(e){for(var t=0,r=0;r<n.HEIGHT&&this.getPieceAtXY(e,r)!==lie.EMPTY;r++)t++;return t}}],[{key:"getInitialState",value:function(){var e=lie.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}},{key:"fromRepresentation",value:function(e,t){for(var r=e.reverse(),i=[4,4,4,4],a=0;a<n.HEIGHT;a++)for(var o=0;o<n.WIDTH;o++){var s=r[a][o];r[a][o]!==lie.EMPTY&&i[n.pieceIndex(s)]--}return N7(i.every(function(e){return e>=0}),"Invalid DiamState representation uses too many pieces"),new n(r,i,t)}},{key:"pieceIndex",value:function(e){switch(e){case lie.ZERO_FIRST:return 0;case lie.ZERO_SECOND:return 1;case lie.ONE_FIRST:return 2;default:return PB.expectToBe(e,lie.ONE_SECOND),3}}}]),n}(Pte);return e.WIDTH=8,e.HEIGHT=4,e}(),gie=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this,pie)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return e.isDrop()?this.applyLegalDrop(e,t):this.applyLegalShift(e,t)}},{key:"applyLegalDrop",value:function(e,t){var n=t9.copyBiArray(t.board);n[t.getStackHeight(e.target)][e.target]=e.piece;var r=t9.copyImmutableArray(t.remainingPieces);return r[pie.pieceIndex(e.piece)]-=1,new pie(n,r,t.turn+1)}},{key:"applyLegalShift",value:function(e,t){for(var n=t9.copyBiArray(t.board),r=e.getTarget(),i=t.getStackHeight(r),a=e.start.y;a<pie.HEIGHT&&t.getPieceAtXY(e.start.x,a)!==lie.EMPTY;)n[i][r]=t.getPieceAtXY(e.start.x,a),n[a][e.start.x]=lie.EMPTY,i++,a++;return new pie(n,t.remainingPieces,t.turn+1)}},{key:"isLegal",value:function(e,t){return e.isDrop()?this.isDropLegal(e,t):this.isShiftLegal(e,t)}},{key:"isDropLegal",value:function(e,t){return e.piece.owner!==t.getCurrentPlayer()?MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE()):0===t.getRemainingPiecesOf(e.piece)?MB.failure(vie.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(e,t)}},{key:"dropHeightValidity",value:function(e,t){return t.getStackHeight(e.target)===pie.HEIGHT?MB.failure(vie.SPACE_IS_FULL()):MB.success(void 0)}},{key:"isShiftLegal",value:function(e,t){return t.getPieceAt(e.start).owner!==t.getCurrentPlayer()?MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(e,t)}},{key:"shiftHeightValidity",value:function(e,t){var n=t.getStackHeight(e.start.x)-e.start.y;return t.getStackHeight(e.getTarget())+n>pie.HEIGHT?MB.failure(vie.TARGET_STACK_TOO_HIGH()):MB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=this.findHighestAlignment(e.gameState);if(t.isPresent()){var n=e.gameState.getPieceAt(t.get());return N7(n.owner.isPlayer(),"highest alignment is owned by a player"),Lte.getVictory(n.owner)}return Lte.ONGOING}},{key:"findHighestAlignment",value:function(e){for(var t=0;t<pie.WIDTH/2;t++)for(var n=pie.HEIGHT-1;n>0;n--){var r=e.getPieceAtXY(t,n),i=e.getPieceAtXY(t+pie.WIDTH/2,n);if(r!==lie.EMPTY&&r===i)return RB.of(new fte(t,n))}return RB.empty()}},{key:"pieceCanMove",value:function(e,t){return!!this.isShiftLegal(new hie(t,"clockwise"),e).isSuccess()||!!this.isShiftLegal(new hie(t,"counterclockwise"),e).isSuccess()}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=RB.of(new n)),n.singleton.get()}}]),n}(Fte);gie.singleton=RB.empty();var yie=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=e.gameState,n=this.getListDrops(t),r=this.getListShifts(t);return n.concat(r)}},{key:"getListShifts",value:function(e){var t,n=[],r=uy(this.getShiftSources(e));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0,o=[new hie(i,"clockwise"),new hie(i,"counterclockwise")];a<o.length;a++){var s=o[a];gie.get().shiftHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){r.e(u)}finally{r.f()}return n}},{key:"getListDrops",value:function(e){for(var t=this.getRemainingPiecesForCurrentPlayer(e),n=[],r=0;r<pie.WIDTH;r++){var i,a=uy(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=new fie(r,o);gie.get().dropHeightValidity(s,e).isSuccess()&&n.push(s)}}catch(u){a.e(u)}finally{a.f()}}return n}},{key:"getRemainingPiecesForCurrentPlayer",value:function(e){var t,n=[],r=uy(lie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.currentPlayerCanDropPiece(e,i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"currentPlayerCanDropPiece",value:function(e,t){return e.getCurrentPlayer()===t.owner&&e.getRemainingPiecesOf(t)>0}},{key:"getShiftSources",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=0;r<pie.HEIGHT;r++)for(var i=0;i<pie.WIDTH;i++)e.getPieceAtXY(i,r).owner===n&&t.push(new fte(i,r));return t}},{key:"getBoardValue",value:function(e){var t=gie.get().getGameStatus(e);return new _te(t.isEndGame?t.toBoardValue():0)}}]),n}(wte),mie=lie.EMPTY,kie=lie.ZERO_FIRST,Cie=lie.ZERO_SECOND,wie=lie.ONE_FIRST,_ie=lie.ONE_SECOND,Eie=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Rn||(Rn=Hg(["Initial board and player pieces"]))),$localize(Mn||(Mn=Hg(["Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right."]))),pie.getInitialState()),zte.fromMove($localize(xn||(xn=Hg(["Goal of the game"]))),$localize(Nn||(Nn=Hg(["At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>Do it!"]))),pie.fromRepresentation([[mie,mie,mie,mie,mie,mie,mie,mie],[mie,mie,mie,mie,mie,mie,mie,mie],[mie,mie,mie,mie,wie,mie,mie,mie],[kie,mie,mie,mie,kie,mie,mie,mie]],3),[new fie(0,lie.ONE_FIRST)],$localize(Dn||(Dn=Hg(["Congratulations, you won!"]))),$localize(Ln||(Ln=Hg(["Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board."])))),zte.fromMove($localize(Fn||(Fn=Hg(["Types of move"]))),$localize(Un||(Un=Hg(["You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board."]))),pie.fromRepresentation([[mie,mie,mie,mie,mie,mie,mie,mie],[mie,mie,mie,mie,_ie,mie,mie,mie],[mie,mie,mie,mie,kie,mie,mie,mie],[wie,mie,mie,mie,Cie,mie,mie,mie]],4),[hie.fromRepresentation(new fte(4,3),"counterclockwise"),hie.fromRepresentation(new fte(4,3),"clockwise"),hie.fromRepresentation(new fte(4,2),"counterclockwise"),hie.fromRepresentation(new fte(4,2),"clockwise")],$localize(Vn||(Vn=Hg(["Congratulations!"]))),$localize(Bn||(Bn=Hg(["Failed, try to move one of your piece that is already on the board."])))),zte.fromMove($localize(zn||(zn=Hg(["Special case"]))),$localize(Hn||(Hn=Hg(["It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!"]))),pie.fromRepresentation([[mie,mie,mie,mie,kie,mie,mie,mie],[mie,mie,mie,mie,_ie,mie,mie,kie],[mie,mie,mie,mie,kie,mie,mie,_ie],[mie,wie,mie,mie,Cie,mie,mie,wie]],8),[hie.fromRepresentation(new fte(4,2),"counterclockwise")],$localize(Gn||(Gn=Hg(["Congratulations!"]))),$localize($n||($n=Hg(["Failed, try to shift a stack of pieces to the left."]))))]});function bie(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"path",5),TS("click",function(){var e=eC(n).$implicit;return RS().onSpaceClick(e)}),wS(),CS(2,"path",6),TS("click",function(){var e=eC(n).$implicit;return RS().onSpaceClick(e)}),wS(),wS()}if(2&e){var r=t.$implicit,i=RS();DE(1),xS("id","click_",r,""),mS("ngClass",i.viewInfo.boardInfo[r].spaceClasses),lS("d",i.BOARD_PATHS[r]),DE(1),mS("ngClass",i.viewInfo.boardInfo[r].spaceClasses),lS("d",i.DECORATION_PATHS[r])}}function Sie(e,t){if(1&e){var n=SS();IC(),CS(0,"g",8),TS("click",function(){var e=eC(n).$implicit,t=RS().$implicit;return RS().onPieceInGameClick(t,e.y)}),_S(1,"use",9),_S(2,"use",10),wS()}if(2&e){var r=t.$implicit;NS("id","click_",RS().$implicit,"_",r.y,""),mS("ngClass",r.foregroundClasses),DE(1),mS("ngClass",r.backgroundClasses),lS("x",r.drawPosition.x)("y",r.drawPosition.y),DE(1),lS("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Pie(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Sie,3,8,"g",7),wS()),2&e){var n=t.$implicit,r=RS();DE(1),mS("ngForOf",r.viewInfo.boardInfo[n].pieces)}}function Oie(e,t){if(1&e){var n=SS();IC(),CS(0,"g",12),TS("click",function(){var e=eC(n),t=e.$implicit,r=e.index;return RS(2).onRemainingPieceClick(t.actualPiece,r)}),_S(1,"use",9),_S(2,"use",10),wS()}if(2&e){var r=t.$implicit,i=t.index;DS("id","piece_",r.actualPiece.owner.toString(),"_",r.actualPiece.otherPieceType?1:0,"_",i,""),mS("ngClass",r.foregroundClasses),DE(1),mS("ngClass",r.backgroundClasses),lS("x",r.drawPosition.x)("y",r.drawPosition.y),DE(1),lS("x",r.drawPosition.x)("y",r.drawPosition.y)}}function Tie(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Oie,3,9,"g",11),wS()),2&e){var n=t.$implicit,r=RS();DE(1),mS("ngForOf",r.viewInfo.remainingPieces.get(n).get())}}var Iie=function(){return[0,1,2,3,4,5,6,7]},Aie=function(){return[2,1,3,0,4,7,5,6]},Rie=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],r.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],r.selected=RB.empty(),r.viewInfo={boardInfo:[],remainingPieces:new Mte([{key:Q7.ZERO,value:[]},{key:Q7.ONE,value:[]}])},r.rules=gie.get(),r.availableMinimaxes=[new yie(r.rules,"DiamDummyMinimax")],r.encoder=die,r.tutorial=(new Eie).tutorial,r}return dy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"onSpaceClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.canUserPlay("#click_"+e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):t.onSpaceClickAfterCheck(e));case 2:case"end":return n.stop()}},n)}))()}},{key:"onSpaceClickAfterCheck",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.selected.isPresent()){n.next=14;break}if("pieceFromReserve"!==(r=t.selected.get()).type){n.next=6;break}i=new fie(e,r.piece),n.next=13;break;case 6:if((r.position.x+1)%pie.WIDTH!==e){n.next=10;break}i=new hie(r.position,"clockwise"),n.next=13;break;case 10:if((r.position.x+(pie.WIDTH-1))%pie.WIDTH===e){n.next=12;break}return n.abrupt("return",t.cancelMove(vie.MUST_SHIFT_TO_NEIGHBOR()));case 12:i=new hie(r.position,"counterclockwise");case 13:return n.abrupt("return",t.chooseMove(i,t.getState()));case 14:return n.abrupt("return",t.cancelMove(vie.MUST_SELECT_PIECE_FIRST()));case 15:case"end":return n.stop()}},n)}))()}},{key:"onPieceInGameClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new fte(e,t),r.abrupt("return",n.getState().getPieceAt(a).owner===n.getCurrentPlayer()?(n.isSelected(null,a)?n.cancelMoveAttempt():n.selected=RB.of({type:"pieceFromBoard",position:a}),n.updateViewInfo(),DB.SUCCESS):n.selected.isPresent()?n.onSpaceClickAfterCheck(e):n.cancelMove(Cte.MUST_CHOOSE_PLAYER_PIECE()));case 5:case"end":return r.stop()}},r)}))()}},{key:"onRemainingPieceClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay(n.getPieceId(e,t)),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):e.owner===n.getCurrentPlayer()?(n.selected=n.isSelected(e)?RB.empty():RB.of({type:"pieceFromReserve",piece:e}),n.updateViewInfo(),DB.SUCCESS):n.cancelMove(Cte.MUST_CHOOSE_PLAYER_PIECE()));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceId",value:function(e,t){return"#piece_"+e.owner.toString()+"_"+(e.otherPieceType?1:0)+"_"+t}},{key:"isSelected",value:function(e,t){return!this.selected.isAbsent()&&(null==e&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(t):this.selected.get().piece===e)}},{key:"updateBoard",value:function(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}},{key:"getLastMovedFromDrop",value:function(e,t){var n=this.getDrawPositionRemainingPiece(e.piece,t.getRemainingPiecesOf(e.piece)-1),r=e.getTarget(),i=t.getStackHeight(e.getTarget()),a=this.getDrawPositionOnBoard(r,i),o=new fte(r,i);return[{start:RB.empty(),end:o,startDrawPosition:n,endDrawPosition:a}]}},{key:"getLastMovedFromShift",value:function(e,t){for(var n=e.start.x,r=e.getTarget(),i=t.getStackHeight(r),a=[],o=e.start.y;o<pie.HEIGHT&&t.getPieceAtXY(n,o)!==lie.EMPTY;o++,i++)a.push({start:RB.of(new fte(n,o)),end:new fte(r,i),startDrawPosition:this.getDrawPositionOnBoard(n,o),endDrawPosition:this.getDrawPositionOnBoard(r,i)});return a}},{key:"updateViewInfo",value:function(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}},{key:"updateBoardInfo",value:function(){for(var e=0;e<pie.WIDTH;e++)this.viewInfo.boardInfo[e]={x:e,spaceClasses:[],pieces:this.getPieces(e)}}},{key:"showLastMove",value:function(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}},{key:"showLastMoveOnSpaces",value:function(){var e=this.rules.node.move;N7(e.isPresent(),"showLastMoveOnSpaces called without a last move");for(var t=e.get(),n=0;n<pie.WIDTH;n++){var r=[];t.isDrop()?t.getTarget()===n&&r.push("moved"):(t.getTarget()===n||t.start.x===n)&&r.push("moved"),this.viewInfo.boardInfo[n].spaceClasses=r}}},{key:"showLastMoveOnPieces",value:function(){var e=this.rules.node.move;N7(e.isPresent(),"showLastMoveOnPieces called without a last move");var t,n=e.get(),r=this.getPreviousState(),i=uy(n.isDrop()?this.getLastMovedFromDrop(n,r):this.getLastMovedFromShift(n,r));try{for(i.s();!(t=i.n()).done;){var a=t.value;this.viewInfo.boardInfo[a.end.x].pieces[a.end.y].foregroundClasses.push("last-move")}}catch(o){i.e(o)}finally{i.f()}}},{key:"updateRemainingPiecesInfo",value:function(){var e=this.getCurrentPlayer();this.viewInfo.remainingPieces=new Mte([{key:Q7.ZERO,value:[]},{key:Q7.ONE,value:[]}]);var t,n=this.isPlayerTurn(),r=uy(lie.PLAYER_PIECES);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.getState().getRemainingPiecesOf(i),o=0;o<a;o++){var s=[];this.isTopPieceOfReserveAndSelected(o,a,i)&&s.push("selected"),n&&o===a-1&&i.owner===e&&s.push("clickable-hover");var u=this.viewInfo.remainingPieces.get(i.owner).get();u.push({backgroundClasses:["player"+i.owner.value+(i.otherPieceType?"-alternate":"")],foregroundClasses:s,y:o,drawPosition:this.getDrawPositionRemainingPiece(i,o),actualPiece:i}),this.viewInfo.remainingPieces.put(i.owner,u)}}catch(c){r.e(c)}finally{r.f()}}},{key:"isTopPieceOfReserveAndSelected",value:function(e,t,n){if(this.selected.isPresent()){var r=this.selected.get();return"pieceFromReserve"===r.type&&r.piece===n&&e===t-1}return!1}},{key:"getDrawPositionRemainingPiece",value:function(e,t){var r,i;return r=e.owner===Q7.ZERO?-100:600,i=e.otherPieceType?100:450,new fte(r,i).getNext(new ate(0,-t*n.PIECE_HEIGHT))}},{key:"getPieces",value:function(e){for(var t=this.rules.findHighestAlignment(this.getState()),n=this.isPlayerTurn(),r=[],i=0;i<pie.HEIGHT;i++){var a=this.getState().getPieceAtXY(e,i),o=new fte(e,i);if(a!==lie.EMPTY){var s=[];this.pieceFromBoardIsSelected(e,i)&&s.push("selected"),this.isVictory(e,i,t)&&s.push("victory-stroke"),n&&this.rules.pieceCanMove(this.getState(),o)&&s.push("clickable-hover"),r.push({backgroundClasses:["player"+a.owner.value+(a.otherPieceType?"-alternate":"")],foregroundClasses:s,y:i,drawPosition:this.getDrawPositionOnBoard(e,i),actualPiece:a})}}return r}},{key:"pieceFromBoardIsSelected",value:function(e,t){if(this.selected.isPresent()){var n=this.selected.get();return"pieceFromBoard"===n.type&&n.position.x===e&&n.position.y===t}return!1}},{key:"isVictory",value:function(e,t,n){if(n.isPresent()){var r=n.get();return r.x%4==e%4&&r.y===t}return!1}},{key:"getDrawPositionOnBoard",value:function(e,t){return n.CENTER[e].getNext(new ate(0,-t*n.PIECE_HEIGHT))}},{key:"cancelMoveAttempt",value:function(){this.selected=RB.empty(),this.updateBoard()}}]),n}(hte);Rie.CENTER=[new fte(40,160),new fte(100,50),new fte(255,2),new fte(400,50),new fte(460,160),new fte(400,270),new fte(255,320),new fte(100,270)],Rie.PIECE_HEIGHT=36,Rie.\u0275fac=function(e){return new(e||Rie)(yS(M7))},Rie.\u0275cmp=ck({type:Rie,selectors:[["app-diam"]],features:[Qb],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 1.4319358,16.913484 V 49.329973 H 1.482219 A 39.498175,14.141265 0 0 0 40.938372,63.011675 39.498175,14.141265 0 0 0 80.394523,49.329973 h 0.06885 V 16.913484 h -0.02864 A 39.769348,14.114049 0 0 1 40.941466,29.431707 39.769348,14.114049 0 0 1 1.4481812,16.913484 Z"],["cx","40.952408","cy","15.225397","rx","39.769348","ry","14.11405"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"defs"),CS(2,"g",1),_S(3,"path",2),_S(4,"ellipse",3),wS(),wS(),pS(5,bie,3,5,"g",4),pS(6,Pie,2,1,"g",4),pS(7,Tie,2,1,"g",4),wS()),2&e&&(DE(5),mS("ngForOf",ST(3,Iie)),DE(1),mS("ngForOf",ST(4,Aie)),DE(1),mS("ngForOf",t.Player.PLAYERS))},directives:[nR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Mie=function(){function e(t,n){fy(this,e),this.offset=t,this.constant=n}return dy(e,[{key:"toString",value:function(){return"Line(".concat(this.constant,", ").concat(this.offset,")")}},{key:"equals",value:function(e){return this===e||!(this.offset!==e.offset||this.constant!==e.constant)}},{key:"contains",value:function(e){switch(this.constant){case"q":return e.x===this.offset;case"r":return e.y===this.offset;case"s":return e.x+e.y===this.offset}}},{key:"getDirection",value:function(){switch(this.constant){case"q":return pte.DOWN;case"r":return pte.RIGHT;case"s":return pte.DOWN_LEFT}}}],[{key:"fromTwoCoords",value:function(t,n){var r=t.x,i=n.x,a=t.y,o=n.y,s=r+a,u=i+o;return r===i&&a!==o&&s!==u?RB.of(e.constantQ(r)):r!==i&&a===o&&s!==u?RB.of(e.constantR(a)):r!==i&&a!==o&&s===u?RB.of(e.constantS(s)):RB.empty()}},{key:"constantQ",value:function(t){return new e(t,"q")}},{key:"constantR",value:function(t){return new e(t,"r")}},{key:"constantS",value:function(t){return new e(t,"s")}},{key:"areOnSameLine",value:function(t){if(t.length<2)return!0;var n=e.fromTwoCoords(t[0],t[1]);if(n.isAbsent())return!1;var r,i=n.get(),a=uy(t.slice(2));try{for(a.s();!(r=a.n()).done;){var o=r.value;if(!1===i.contains(o))return!1}}catch(s){a.e(s)}finally{a.f()}return!0}}]),e}(),xie=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,r,e)).board=r,u.width=i,u.height=a,u.excludedCases=o,u.empty=s,N7(u.excludedCases.length<u.height/2+1,"Invalid excluded cases specification for HexagonalGameState."),u}return dy(n,[{key:"setAt",value:function(e,t){if(this.isOnBoard(e))return this.setAtUnsafe(e,t);throw new Error("Setting coord not on board: "+e+".")}},{key:"equalsT",value:function(e,t){if(this===e)return!0;if(this.width!==e.width||this.height!==e.height||!1===t(this.empty,e.empty)||this.excludedCases.length!==e.excludedCases.length)return!1;for(var n=0;n<this.excludedCases.length;n++)if(this.excludedCases[n]!==e.excludedCases[n])return!1;var r,i=uy(this.allCoords());try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!1===t(this.getPieceAt(a),e.getPieceAt(a)))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"allCoords",value:function(){var e=[];return this.forEachCoord(function(t){e.push(t)}),e}},{key:"allLines",value:function(){for(var e=[],t=0;t<this.width;t++)e.push(Mie.constantQ(t));for(var n=0;n<this.height;n++)e.push(Mie.constantR(n));for(var r=this.excludedCases.length;r<this.height+this.excludedCases.length;r++)e.push(Mie.constantS(r));return e}},{key:"getEntranceOnLine",value:function(e){var t,n;switch(e.constant){case"q":return n=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new fte(e.offset,n));case"r":return t=null!=this.excludedCases[e.offset]?this.excludedCases[e.offset]:0,this.findEntranceFrom(e,new fte(t,e.offset));case"s":return this.findEntranceFrom(e,e.offset<this.width?new fte(e.offset,0):new fte(this.width-1,e.offset-this.width+1))}}},{key:"findEntranceFrom",value:function(e,t){for(var n=e.getDirection(),r=t,i=0;i<Math.max(this.width,this.height);i++){if(this.isOnBoard(r))return r;r=r.getNext(n)}var a=x7.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:t.toString(),line:e.toString()});throw new Error(a.getReason())}}],[{key:"neighbors",value:function(e,t){return[new fte(e.x+t,e.y-t),new fte(e.x+t,e.y),new fte(e.x-t,e.y+t),new fte(e.x-t,e.y),new fte(e.x,e.y+t),new fte(e.x,e.y-t)]}}]),n}(Pte),Nie=function(){function e(t,n,r){fy(this,e),this.owner=t,this.size=n,this.source=r}return dy(e,[{key:"getValue",value:function(){return e.encoder.encodeNumber(this)}},{key:"getOwner",value:function(){return this.owner}},{key:"belongsTo",value:function(e){return this.owner===e}},{key:"containsSource",value:function(){return this.source}},{key:"isEmpty",value:function(){return 0===this.size}},{key:"getSize",value:function(){return this.size}},{key:"toString",value:function(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}],[{key:"append",value:function(t,n){return new e(t.owner,t.size+n.size,t.source||n.source)}}]),e}();Nie.sizeEncoder=j7.numberEncoder(49),Nie.encoder=j7.tuple([j7.booleanEncoder,Q7.numberEncoder,Nie.sizeEncoder],function(e){return[e.source,e.owner,e.size]},function(e){return new Nie(e[1],e[2],e[0])}),Nie.MAX_SIZE=49,Nie.EMPTY=new Nie(K7.NONE,0,!1),Nie.UNREACHABLE=new Nie(K7.NONE,-1,!1),Nie.PLAYER_ZERO=new Nie(Q7.ZERO,1,!1),Nie.PLAYER_ONE=new Nie(Q7.ONE,1,!1),Nie.SOURCE=new Nie(K7.NONE,1,!0);var Die=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,Nie.EMPTY)).alreadyPassed=i,a}return dy(n,[{key:"getAllPieces",value:function(){for(var e=[],t=0;t<n.HEIGHT;t++)for(var r=0;r<n.WIDTH;r++){var i=new fte(r,t);this.isOnBoard(i)&&!1===this.getPieceAt(i).isEmpty()&&e.push(i)}return e}},{key:"numberOfNeighbors",value:function(e){var t=this;return xie.neighbors(e,1).filter(function(e){return t.isOnBoard(e)&&!1===t.getPieceAt(e).isEmpty()}).length}},{key:"setAtUnsafe",value:function(e,t){var r=t9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.alreadyPassed)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Nie.UNREACHABLE}}],[{key:"balancedBoard",value:function(){var e=Nie.UNREACHABLE,t=Nie.PLAYER_ZERO,n=Nie.PLAYER_ONE,r=Nie.SOURCE;return[[e,e,t,n,n,n,t,t,n,r,n],[e,n,n,t,t,t,n,n,t,n,n],[n,n,n,n,t,r,n,t,t,t,t],[t,t,n,t,t,n,n,n,t,t,e],[t,r,t,n,n,t,t,t,n,e,e]]}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Nie.UNREACHABLE}},{key:"getInitialState",value:function(){return new n(n.balancedBoard(),0,!1)}}]),n}(xie);return e.WIDTH=11,e.HEIGHT=5,e.EXCLUDED_SPACES=[2,1],e}(),Lie=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,r)}return dy(n,[{key:"toString",value:function(){return this===n.PASS?"DvonnMove.PASS":"DvonnMove("+this.coord+"->"+this.end+")"}},{key:"length",value:function(){return this.coord.y===this.end.y?Math.abs(this.coord.x-this.end.x):Math.abs(this.coord.y-this.end.y)}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}}],[{key:"of",value:function(e,t){if(-1===e.x&&-1===e.y&&-2===t.x&&-2===t.y)return n.PASS;if(!Die.isOnBoard(e))throw new Error("Starting coord of DvonnMove must be on the board, not at "+e.toString());if(!Die.isOnBoard(t))throw new Error("End coord of DvonnMove must be on the board, not at "+e.toString());if(e.y===t.y)return new n(e,t);if(e.x===t.x)return new n(e,t);if(e.x+e.y===t.x+t.y)return new n(e,t);throw new Error("Invalid move")}}]),n}(Mne);Lie.PASS=new Lie(new fte(-1,-1),new fte(-2,-2)),Lie.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 42148}},{key:"encodeNumber",value:function(e){return 4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){if(e<0)return Lie.PASS;var t=e%16,n=(e=e/16|0)%16,r=(e=e/16|0)%16;return new Lie(new fte((e=e/16|0)%16,r),new fte(n,t))}}]),n}(j7));var Fie=function(){var e=dy(function e(){fy(this,e)});return e.NOT_PLAYER_PIECE=function(){return $localize(Zn||(Zn=Hg(["You must select a piece or a stack of your color."])))},e.EMPTY_STACK=function(){return $localize(qn||(qn=Hg(["You must select a stack."])))},e.TOO_MANY_NEIGHBORS=function(){return $localize(Wn||(Wn=Hg(["This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors."])))},e.CANT_REACH_TARGET=function(){return $localize(jn||(jn=Hg(["This stack cannot move because it could never land on another piece."])))},e.INVALID_MOVE_LENGTH=function(){return $localize(Yn||(Yn=Hg(["A stack must always be moved by as many spaces as there are pieces in the stack."])))},e.EMPTY_TARGET_STACK=function(){return $localize(Kn||(Kn=Hg(["The stack must land on an occupied space."])))},e}(),Uie=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isMovablePiece",value:function(e,t){N7(e.isOnBoard(t),"piece is not on the board");var r=e.getPieceAt(t);return r.getSize()<1?DB.failure(Fie.EMPTY_STACK()):r.belongsTo(e.getCurrentPlayer())?e.numberOfNeighbors(t)>=6?DB.failure(Fie.TOO_MANY_NEIGHBORS()):n.pieceHasTarget(e,t)?DB.SUCCESS:DB.failure(Fie.CANT_REACH_TARGET()):DB.failure(Fie.NOT_PLAYER_PIECE())}},{key:"canOnlyPass",value:function(e){return 0===n.getMovablePieces(e).length}},{key:"sourceCoords",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).containsSource()})}},{key:"markPiecesConnectedTo",value:function(e,t,n){var r=this;xie.neighbors(t,1).forEach(function(t){e.isOnBoard(t)&&!n[t.y][t.x]&&!e.getPieceAt(t).isEmpty()&&(n[t.y][t.x]=!0,r.markPiecesConnectedTo(e,t,n))})}},{key:"removeDisconnectedPieces",value:function(e){var t=this,n=t9.createTable(Die.WIDTH,Die.HEIGHT,!1);this.sourceCoords(e).forEach(function(r){n[r.y][r.x]=!0,t.markPiecesConnectedTo(e,r,n)});var r=e;return r.getAllPieces().forEach(function(e){n[e.y][e.x]||(r=r.setAt(e,Nie.EMPTY))}),r}},{key:"applyLegalMove",value:function(e,t,n){if(e===Lie.PASS)return new Die(t.board,t.turn+1,!0);var r=t.getPieceAt(e.coord),i=t.getPieceAt(e.end),a=t.setAt(e.coord,Nie.EMPTY).setAt(e.end,Nie.append(r,i));return this.removeDisconnectedPieces(new Die(a.board,t.turn+1,!1))}},{key:"isLegal",value:function(e,t){if(0===n.getMovablePieces(t).length)return e!==Lie.PASS||t.alreadyPassed?MB.failure(Cte.MUST_PASS()):MB.success(void 0);if(e===Lie.PASS)return MB.failure(Cte.CANNOT_PASS());var r=this.isMovablePiece(t,e.coord);if(r.isFailure())return r.toFailedFallible();var i=t.getPieceAt(e.coord);return e.length()!==i.getSize()?MB.failure(Fie.INVALID_MOVE_LENGTH()):t.getPieceAt(e.end).isEmpty()?MB.failure(Fie.EMPTY_TARGET_STACK()):MB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getScores(t);return 0===n.getMovablePieces(t).length?r[0]>r[1]?Lte.ZERO_WON:r[0]<r[1]?Lte.ONE_WON:Lte.DRAW:Lte.ONGOING}},{key:"getMovablePieces",value:function(e){return n.getFreePieces(e).filter(function(t){return n.pieceHasTarget(e,t)})}},{key:"getFreePieces",value:function(e){return e.getAllPieces().filter(function(t){return e.getPieceAt(t).belongsTo(e.getCurrentPlayer())&&e.numberOfNeighbors(t)<6})}},{key:"pieceHasTarget",value:function(e,t){var n=e.getPieceAt(t).getSize();return void 0!==xie.neighbors(t,n).find(function(t){return e.isOnBoard(t)&&!e.getPieceAt(t).isEmpty()})}},{key:"pieceTargets",value:function(e,t){var n=e.getPieceAt(t).getSize();return xie.neighbors(t,n).filter(function(t){return e.isOnBoard(t)&&!1===e.getPieceAt(t).isEmpty()})}},{key:"getScores",value:function(e){var t=0,n=0;return e.getAllPieces().map(function(r){var i=e.getPieceAt(r);i.belongsTo(Q7.ZERO)?t+=i.getSize():i.belongsTo(Q7.ONE)&&(n+=i.getSize())}),[t,n]}}]),n}(Fte),Vie=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=e.move,n=e.gameState,r=[];return Uie.getMovablePieces(n).forEach(function(e){return Uie.pieceTargets(n,e).forEach(function(t){var n=Lie.of(e,t);r.push(n)})}),0===r.length&&!1===t.equalsValue(Lie.PASS)&&r.push(Lie.PASS),r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Uie.getScores(t);return 0===Uie.getMovablePieces(t).length?new _te(n[0]>n[1]?Number.MIN_SAFE_INTEGER:n[0]<n[1]?Number.MAX_SAFE_INTEGER:0):new _te(n[0]-n[1])}}]),n}(wte),Bie=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=e.gameState,r=Qg(ay(n.prototype),"getListMoves",this).call(this,e),i=t.getCurrentPlayer().getOpponent();return t9.sortByDescending(r,function(e){N7(e!==Lie.PASS,"Cannot sort with DvonnMove.PASS");var n=t.getPieceAt(e.end);return n.belongsTo(i)?n.getSize():0}),r}},{key:"getBoardValue",value:function(e){var t=Uie.getGameStatus(e);if(t.isEndGame)return new _te(t.toBoardValue());var n=e.gameState,r=Uie.getScores(n),i=n.getAllPieces(),a=i.length,o=i.filter(function(e){return n.getPieceAt(e).belongsTo(Q7.ZERO)}).length,s=i.filter(function(e){return n.getPieceAt(e).belongsTo(Q7.ONE)}).length;return new _te((s*r[1]-o*r[0])/a)}}]),n}(Vie),zie=Nie.EMPTY,Hie=Nie.UNREACHABLE,Gie=Nie.SOURCE,$ie=Nie.PLAYER_ZERO,Zie=Nie.PLAYER_ONE,qie=new Nie(Q7.ZERO,2,!1),Wie=new Nie(Q7.ONE,2,!1),jie=new Nie(Q7.ZERO,4,!1),Yie=new Nie(Q7.ONE,4,!1),Kie=dy(function e(){fy(this,e),this.tutorial=[zte.anyMove($localize(Qn||(Qn=Hg(["Moving"]))),$localize(Xn||(Xn=Hg(["At Dvonn, each hexagonal space contains a stack of pieces.\n        If no number is indicated on a stack, it means that it only contains one piece.\n        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.\n        The owner of a stack is the one that has a piece at the top of the stack.\n        Only the owner of a stack can move it.\n        A stack cannot be moved if it is surrounded by 6 other stacks.\n        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.\n        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.\n        Therefore, there are six possible directions.\n        The player with dark pieces starts.<br/><br/>\n        You're playing Dark, click on a stack and move it by one space."]))),Die.getInitialState(),Lie.of(new fte(2,0),new fte(3,0)),$localize(Jn||(Jn=Hg(["Congratulations!"])))),zte.fromPredicate($localize(er||(er=Hg(["Disconnection"]))),$localize(tr||(tr=Hg(['Pieces with a lightning strike are called "sources".\n        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>\n        You\'re playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!']))),new Die([[Hie,Hie,Zie,Gie,zie,zie,zie,zie,zie,zie,zie],[Hie,zie,$ie,zie,zie,zie,zie,zie,zie,zie,zie],[zie,zie,Yie,zie,zie,zie,zie,Zie,Gie,zie,zie],[zie,zie,zie,zie,zie,zie,zie,zie,zie,zie,Hie],[zie,zie,zie,zie,zie,zie,zie,zie,zie,Hie,Hie]],0,!1),Lie.of(new fte(2,1),new fte(2,0)),function(e,t,n){return e.end.equals(new fte(3,0))?DB.failure($localize(nr||(nr=Hg(["You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it."])))):(N7(e.end.equals(new fte(2,0)),"player made an impossible move"),DB.SUCCESS)},$localize(rr||(rr=Hg(["Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!\n        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.\n        Disconnected stacks will not be visible at the next turn."])))),zte.fromPredicate($localize(ir||(ir=Hg(["Moving on a source"]))),$localize(ar||(ar=Hg(["You are allowed to move your stacks on any other stack.\n        This means that you can take control of a source by moving one of your stack on top of it.\n        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>\n        You're playing Dark and you can take control of a source, do it!"]))),new Die([[Hie,Hie,Gie,Zie,zie,zie,zie,zie,zie,zie,zie],[Hie,$ie,$ie,zie,zie,zie,zie,zie,zie,zie,zie],[zie,Zie,$ie,Zie,zie,zie,$ie,Wie,Gie,zie,zie],[zie,zie,Zie,zie,zie,zie,zie,zie,zie,zie,Hie],[zie,zie,zie,zie,zie,zie,zie,zie,zie,Hie,Hie]],0,!1),Lie.of(new fte(2,1),new fte(2,0)),function(e,t,n){return e.end.equals(new fte(2,0))?DB.SUCCESS:DB.failure($localize(or||(or=Hg(["You have not taken possession of a source, try again."]))))},$localize(sr||(sr=Hg(["Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!"])))),zte.informational($localize(ur||(ur=Hg(["Passing"]))),$localize(cr||(cr=Hg(["It can happen that you have no possible move to make.\n        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>\n        This is a situation that occurs here for Dark."]))),new Die([[Hie,Hie,Gie,zie,zie,zie,zie,zie,zie,zie,zie],[Hie,zie,qie,zie,zie,zie,zie,zie,zie,zie,zie],[zie,zie,Wie,zie,zie,zie,zie,Wie,Gie,jie,zie],[zie,zie,zie,zie,zie,zie,zie,zie,zie,zie,Hie],[zie,zie,zie,zie,zie,zie,zie,zie,zie,Hie,Hie]],0,!1)),zte.fromMove($localize(lr||(lr=Hg(["End of the game"]))),$localize(fr||(fr=Hg(["When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>\n        Make your last move."]))),new Die([[Hie,Hie,Gie,zie,zie,zie,zie,zie,zie,zie,zie],[Hie,zie,$ie,zie,zie,zie,zie,zie,zie,zie,zie],[zie,zie,zie,zie,zie,zie,zie,zie,Gie,jie,zie],[zie,zie,zie,zie,zie,zie,zie,zie,zie,zie,Hie],[zie,zie,zie,zie,zie,zie,zie,zie,zie,Hie,Hie]],0,!1),[Lie.of(new fte(2,1),new fte(2,0))],$localize(hr||(hr=Hg(["Congratulations, you won 6 - 0!"]))),$localize(dr||(dr=Hg(["Bad idea, by moving on the source you would have won a point."]))))]});function Qie(e,t){if(1&e&&(IC(),_S(0,"circle",10)),2&e){var n=RS().$implicit,r=RS().$implicit,i=RS();mS("ngClass",i.getPieceClasses(n)),lS("cx",i.getCenterAt(r).x)("cy",i.getCenterAt(r).y)("r",i.SPACE_SIZE)}}function Xie(e,t){if(1&e&&(IC(),_S(0,"polygon",11)),2&e){var n=RS().$implicit,r=RS().$implicit,i=RS();lS("transform",1===n.getSize()?"translate("+(i.getCenterAt(r).x-18)+" "+(i.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(i.getCenterAt(r).x-3)+" "+(i.getCenterAt(r).y-12)+") scale(0.07)")}}function Jie(e,t){if(1&e){var n=SS();IC(),CS(0,"text",12),TS("click",function(){eC(n);var e=RS(2).$implicit;return RS().onClick(e.x,e.y)}),rP(1),wS()}if(2&e){var r=RS().$implicit,i=RS().$implicit,a=RS();lS("x",r.containsSource()?a.getCenterAt(i).x-7:a.getCenterAt(i).x)("y",a.getCenterAt(i).y),DE(1),iP(r.getSize())}}function eae(e,t){if(1&e){var n=SS();IC(),CS(0,"g",5),TS("click",function(){eC(n);var e=RS().$implicit;return RS().onClick(e.x,e.y)}),_S(1,"polygon",6),pS(2,Qie,1,4,"circle",7),pS(3,Xie,1,1,"polygon",8),pS(4,Jie,2,3,"text",9),wS()}if(2&e){var r=t.$implicit,i=RS().$implicit,a=RS();NS("id","click_",i.x,"_",i.y,""),DE(1),lS("points",a.getHexaCoordsAt(i)),DE(1),mS("ngIf",r.getSize()>0),DE(1),mS("ngIf",r.containsSource()),DE(1),mS("ngIf",r.getSize()>1)}}var tae=function(e){return[e]};function nae(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,eae,5,6,"g",4),wS()),2&e){var n=t.$implicit,r=RS();DE(1),mS("ngForOf",PT(1,tae,r.state.getPieceAt(n)))}}function rae(e,t){if(1&e&&(IC(),CS(0,"text",16),rP(1),wS()),2&e){var n=RS().$implicit,r=RS();lS("x",r.getCenterAt(n.coord).x)("y",r.getCenterAt(n.coord).y),DE(1),iP(n.caseContent.getSize())}}function iae(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"polygon",13),_S(2,"circle",14),pS(3,rae,2,3,"text",15),wS()),2&e){var n=t.$implicit,r=RS();DE(1),lS("points",r.getHexaCoordsAt(n.coord)),DE(1),NS("id","captured_",n.coord.x,"_",n.coord.y,""),mS("ngClass",r.getPieceClasses(n.caseContent)),lS("cx",r.getCenterAt(n.coord).x)("cy",r.getCenterAt(n.coord).y)("r",r.SPACE_SIZE),DE(1),mS("ngIf",n.caseContent.getSize()>1)}}function aae(e,t){if(1&e&&(IC(),ES(0),_S(1,"polygon",17),_S(2,"polygon",17),bS()),2&e){var n=RS();DE(1),lS("points",n.getHexaCoordsAt(n.lastMove.get().coord)),DE(1),lS("points",n.getHexaCoordsAt(n.lastMove.get().end))}}function oae(e,t){if(1&e&&(IC(),_S(0,"polygon",18)),2&e){var n=RS();lS("points",n.getHexaCoordsAt(n.chosen.get()))}}var sae=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).lastMove=RB.empty(),r.chosen=RB.empty(),r.disconnecteds=[],r.rules=new Uie(Die),r.availableMinimaxes=[new Vie(r.rules,"DvonnMinimax"),new Bie(r.rules,"DvonnMinimaxMaximizeStacks")],r.encoder=Lie.encoder,r.tutorial=(new Kie).tutorial,r.SPACE_SIZE=30,r.canPass=!1,r.scores=RB.of(Uie.getScores(r.rules.node.gameState)),r.hexaLayout=new gte(1.5*r.SPACE_SIZE,new fte(-r.SPACE_SIZE,2*r.SPACE_SIZE),mte.INSTANCE),r.state=r.rules.node.gameState,r.hexaBoard=r.rules.node.gameState.board,r}return dy(n,[{key:"hideLastMove",value:function(){this.lastMove=RB.empty()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.state=this.rules.node.gameState,this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=RB.of(Uie.getScores(this.state))}},{key:"calculateDisconnecteds",value:function(){for(var e=this.rules.node.mother.get().gameState,t=this.rules.node.gameState,n=0;n<t.board.length;n++)for(var r=0;r<t.board[n].length;r++){var i=new fte(r,n);if(!0===t.isOnBoard(i)&&!1===i.equals(this.lastMove.get().coord)){var a=t.getPieceAt(i),o=e.getPieceAt(i);if(a.isEmpty()&&!o.isEmpty()){var s={coord:new fte(r,n),caseContent:o};this.disconnecteds.push(s)}}}}},{key:"cancelMoveAttempt",value:function(){this.chosen=RB.empty()}},{key:"pass",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),t.next=3,e.chooseMove(Lie.PASS,e.rules.node.gameState);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=5;break}r.t0=n.cancelMove(i.getReason()),r.next=18;break;case 5:if(!n.chosen.isAbsent()){r.next=9;break}r.t1=n.choosePiece(e,t),r.next=17;break;case 9:if(!n.chosen.equalsValue(new fte(e,t))){r.next=13;break}r.t2=(n.cancelMoveAttempt(),DB.SUCCESS),r.next=16;break;case 13:return r.next=15,n.chooseDestination(e,t);case 15:r.t2=r.sent;case 16:r.t1=r.t2;case 17:r.t0=r.t1;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=new fte(e,t),r=this.rules.isMovablePiece(this.rules.node.gameState,n);return r.isSuccess()?(this.chosen=RB.of(n),DB.SUCCESS):this.cancelMove(r.getReason())}},{key:"chooseDestination",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new fte(e,t),o=Lie.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"getPieceClasses",value:function(e){if(e.containsSource()&&1===e.getSize())return["other-piece","dashed-stroke"];var t=this.getPlayerClass(e.getOwner());return e.containsSource()?[t,"other-piece-stroke","dashed-stroke"]:[t]}}]),n}(dte);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-dvonn"]],features:[Qb],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","other-piece-light","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"other-piece-light"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","highlighted"],[1,"base","no-fill","selected"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,nae,2,3,"g",1),pS(2,iae,4,8,"g",1),pS(3,aae,3,2,"ng-container",2),pS(4,oae,1,1,"polygon",3),wS()),2&e&&(DE(1),mS("ngForOf",t.state.allCoords()),DE(1),mS("ngForOf",t.disconnecteds),DE(1),mS("ngIf",t.lastMove.isPresent()),DE(1),mS("ngIf",t.chosen.isPresent()))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),uae=(function(e){e[e.NONE=0]="NONE",e[e.SMALL=1]="SMALL",e[e.MEDIUM=2]="MEDIUM",e[e.BIG=3]="BIG"}(uae||(uae={})),uae),cae=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"getPlayer",value:function(){switch(this){case e.SMALL_DARK:case e.MEDIUM_DARK:case e.BIG_DARK:return Q7.ZERO;case e.SMALL_LIGHT:case e.MEDIUM_LIGHT:case e.BIG_LIGHT:return Q7.ONE;default:return K7.NONE}}},{key:"getSize",value:function(){switch(this){case e.BIG_DARK:case e.BIG_LIGHT:return uae.BIG;case e.MEDIUM_DARK:case e.MEDIUM_LIGHT:return uae.MEDIUM;case e.SMALL_DARK:case e.SMALL_LIGHT:return uae.SMALL;default:return PB.expectToBe(this,e.NONE),uae.NONE}}},{key:"belongsTo",value:function(e){return this.getPlayer()===e}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){switch(this){case e.BIG_DARK:return"BIG_DARK";case e.BIG_LIGHT:return"BIG_LIGHT";case e.MEDIUM_DARK:return"MEDIUM_DARK";case e.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case e.SMALL_DARK:return"SMALL_DARK";case e.SMALL_LIGHT:return"SMALL_LIGHT";default:return PB.expectToBe(this,e.NONE),"EMPTY"}}}],[{key:"of",value:function(e){switch(e){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+e+" for EncapsulePiece")}}},{key:"ofSizeAndPlayer",value:function(t,n){return n===Q7.ZERO&&t===uae.BIG?e.BIG_DARK:n===Q7.ZERO&&t===uae.MEDIUM?e.MEDIUM_DARK:n===Q7.ZERO&&t===uae.SMALL?e.SMALL_DARK:n===Q7.ONE&&t===uae.BIG?e.BIG_LIGHT:n===Q7.ONE&&t===uae.MEDIUM?e.MEDIUM_LIGHT:n===Q7.ONE&&t===uae.SMALL?e.SMALL_LIGHT:e.NONE}}]),e}();cae.SMALL_DARK=new cae(0),cae.SMALL_LIGHT=new cae(1),cae.MEDIUM_DARK=new cae(2),cae.MEDIUM_LIGHT=new cae(3),cae.BIG_DARK=new cae(4),cae.BIG_LIGHT=new cae(5),cae.NONE=new cae(6);var lae=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).remainingPieces=i,a}return dy(n,[{key:"getRemainingPieces",value:function(){return t9.copyImmutableArray(this.remainingPieces)}},{key:"getRemainingPiecesOfPlayer",value:function(e){return this.getRemainingPieces().filter(function(t){return t.getPlayer()===e})}},{key:"pieceBelongsToCurrentPlayer",value:function(e){return e.belongsTo(this.getCurrentPlayer())}},{key:"isDroppable",value:function(e){return this.pieceBelongsToCurrentPlayer(e)&&this.isInRemainingPieces(e)}},{key:"isInRemainingPieces",value:function(e){return this.remainingPieces.some(function(t){return t===e})}},{key:"getPlayerRemainingPieces",value:function(){var e=this;return this.remainingPieces.filter(function(t){return e.pieceBelongsToCurrentPlayer(t)})}}],[{key:"getInitialState",value:function(){var e=new fae(K7.NONE,K7.NONE,K7.NONE).encode(),t=t9.createTable(3,3,e);return new n(t9.mapBiArray(t,function(e){return fae.decode(e)}),0,[cae.BIG_DARK,cae.BIG_DARK,cae.BIG_LIGHT,cae.BIG_LIGHT,cae.MEDIUM_DARK,cae.MEDIUM_DARK,cae.MEDIUM_LIGHT,cae.MEDIUM_LIGHT,cae.SMALL_DARK,cae.SMALL_DARK,cae.SMALL_LIGHT,cae.SMALL_LIGHT])}}]),n}(Pte),fae=function(){function e(t,n,r){fy(this,e),this.small=t,this.medium=n,this.big=r}return dy(e,[{key:"isEmpty",value:function(){return this.small===K7.NONE&&this.medium===K7.NONE&&this.big===K7.NONE}},{key:"toList",value:function(){var e=[];return this.small.isPlayer()&&e.push(cae.ofSizeAndPlayer(uae.SMALL,this.small)),this.medium.isPlayer()&&e.push(cae.ofSizeAndPlayer(uae.MEDIUM,this.medium)),this.big.isPlayer()&&e.push(cae.ofSizeAndPlayer(uae.BIG,this.big)),e}},{key:"toOrderedPieceNames",value:function(){var e=cae.ofSizeAndPlayer(uae.SMALL,this.small),t=cae.ofSizeAndPlayer(uae.MEDIUM,this.medium),n=cae.ofSizeAndPlayer(uae.BIG,this.big);return[e.toString(),t.toString(),n.toString()]}},{key:"getBiggest",value:function(){return this.big===Q7.ZERO?cae.BIG_DARK:this.big===Q7.ONE?cae.BIG_LIGHT:this.medium===Q7.ZERO?cae.MEDIUM_DARK:this.medium===Q7.ONE?cae.MEDIUM_LIGHT:this.small===Q7.ZERO?cae.SMALL_DARK:this.small===Q7.ONE?cae.SMALL_LIGHT:cae.NONE}},{key:"tryToSuperposePiece",value:function(e){var t=this.getBiggest().getSize();if(e===cae.NONE)throw new Error("Cannot move EMPTY on a space");return e.getSize()>t?RB.of(this.put(e)):RB.empty()}},{key:"removeBiggest",value:function(){var t,n=this.getBiggest();if(n===cae.NONE)throw new Error("Cannot removed piece from empty space");var r=n.getSize();switch(r){case uae.BIG:t=new e(this.small,this.medium,K7.NONE);break;case uae.MEDIUM:t=new e(this.small,K7.NONE,K7.NONE);break;default:PB.expectToBe(r,uae.SMALL),t=new e(K7.NONE,K7.NONE,K7.NONE)}return{removedCase:t,removedPiece:n}}},{key:"put",value:function(t){if(t===cae.NONE)throw new Error("Cannot put NONE on space");var n=t.getPlayer(),r=t.getSize();switch(r){case uae.BIG:return new e(this.small,this.medium,n);case uae.MEDIUM:return N7(this.big===K7.NONE,"Cannot put a piece on top of a bigger one"),new e(this.small,n,this.big);default:return PB.expectToBe(r,uae.SMALL),N7(this.big===K7.NONE,"Cannot put a piece on top of a bigger one"),N7(this.medium===K7.NONE,"Cannot put a piece on top of a bigger one"),new e(n,this.medium,this.big)}}},{key:"encode",value:function(){return this.small.value+3*this.medium.value+9*this.big.value}},{key:"belongsTo",value:function(e){return this.getBiggest().getPlayer()===e}},{key:"toString",value:function(){var e=this.toOrderedPieceNames();return"("+e[0]+", "+e[1]+", "+e[2]+")"}}],[{key:"decode",value:function(t){N7(t%1==0,"EncapsuleCase must be encoded as integer: "+t),N7(t>=0,"To small representation for EncapsuleCase: "+t),N7(t<=26,"To big representation for EncapsuleCase: "+t);var n=Q7.numberEncoder.decodeNumber(t%3);t-=n.value;var r=Q7.numberEncoder.decodeNumber((t/=3)%3);return t-=r.value,new e(n,r,Q7.numberEncoder.decodeNumber(t/=3))}}]),e}();fae.EMPTY=new fae(K7.NONE,K7.NONE,K7.NONE);var hae=function(){var e=dy(function e(){fy(this,e)});return e.PIECE_OUT_OF_STOCK=function(){return $localize(vr||(vr=Hg(["You do not have pieces of this type anymore."])))},e.INVALID_PLACEMENT=function(){return $localize(pr||(pr=Hg(["You must put your piece on an empty square or on a smaller piece."])))},e.NOT_DROPPABLE=function(){return $localize(gr||(gr=Hg(["You must pick your piece among the remaining ones."])))},e.INVALID_PIECE_SELECTED=function(){return $localize(yr||(yr=Hg(["You must pick one of your remaining pieces or one piece on the board that is the biggest of its square."])))},e.END_YOUR_MOVE=function(){return $localize(mr||(mr=Hg(["You are performing a move, you must select a landing square."])))},e}(),dae=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){var r,i=t.getCopiedBoard(),a=t.getRemainingPieces(),o=t.turn+1;if(i[e.landingCoord.y][e.landingCoord.x]=fae.decode(n.encode()),e.isDropping()){r=e.piece.get();var s=a.indexOf(r);a=a.slice(0,s).concat(a.slice(s+1))}else{var u=e.startingCoord.get(),c=i[u.y][u.x].encode(),l=fae.decode(c).removeBiggest();i[u.y][u.x]=fae.decode(l.removedCase.encode()),r=l.removedPiece}return new lae(i,o,a)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isVictory",value:function(e){var t,r=e.getCopiedBoard(),i=uy(n.LINES);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=n.isVictoriousLine([r[a[0].y][a[0].x],r[a[1].y][a[1].x],r[a[2].y][a[2].x]]);if(o.isPresent())return o}}catch(s){i.e(s)}finally{i.f()}return RB.empty()}},{key:"isVictoriousLine",value:function(e){var t=e.map(function(e){return e.getBiggest()}).map(function(e){return e.getPlayer()});return t[0]===K7.NONE?RB.empty():t[0]===t[1]&&t[1]===t[2]?RB.of(t[0]):RB.empty()}},{key:"isLegal",value:function(e,t){var n;if(OB(!1,e.toString()),e.isDropping()){if(n=e.piece.get(),!1===t.pieceBelongsToCurrentPlayer(n))return MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE());if(!1===t.isInRemainingPieces(n))return MB.failure(hae.PIECE_OUT_OF_STOCK())}else{var r=e.startingCoord.get();if(n=t.getPieceAt(r).getBiggest(),!1===t.pieceBelongsToCurrentPlayer(n))return MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE())}var i=t.getPieceAt(e.landingCoord).tryToSuperposePiece(n);return i.isPresent()?MB.success(i.get()):MB.failure(hae.INVALID_PLACEMENT())}},{key:"getGameStatus",value:function(e){var t=n.isVictory(e.gameState);return t.isPresent()?Lte.getVictory(t.get()):Lte.ONGOING}}]),n}(Fte);dae.LINES=[[new fte(0,0),new fte(0,1),new fte(0,2)],[new fte(1,0),new fte(1,1),new fte(1,2)],[new fte(2,0),new fte(2,1),new fte(2,2)],[new fte(0,0),new fte(1,0),new fte(2,0)],[new fte(0,1),new fte(1,1),new fte(2,1)],[new fte(0,2),new fte(1,2),new fte(2,2)],[new fte(0,0),new fte(1,1),new fte(2,2)],[new fte(0,2),new fte(1,1),new fte(2,0)]];var vae=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this)).startingCoord=e,a.landingCoord=r,a.piece=i,a}return dy(n,[{key:"isDropping",value:function(){return this.startingCoord.isAbsent()}},{key:"equals",value:function(e){return this===e||!1!==e.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(e.startingCoord)&&this.piece.equals(e.piece)}},{key:"toString",value:function(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}],[{key:"fromMove",value:function(e,t){if(e.equals(t))throw new Error("Starting coord and landing coord must be separate coords");return new n(RB.of(e),t,RB.empty())}},{key:"fromDrop",value:function(e,t){return new n(RB.empty(),t,RB.of(e))}}]),n}(Tte);vae.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 161}},{key:"encodeNumber",value:function(e){var t=e.landingCoord.x,n=e.landingCoord.y;if(e.isDropping()){return 18*e.piece.get().value+6*t+2*n+0}var r=e.startingCoord.get().y;return 54*e.startingCoord.get().x+18*r+6*t+2*n+1}},{key:"decodeNumber",value:function(e){var t=e%2;e-=t;var n=(e/=2)%3;e-=n;var r=(e/=3)%3;e-=r,e/=3;var i=new fte(r,n);if(0===t){var a=cae.of(e);return vae.fromDrop(a,i)}var o=e%3;e-=o;var s=new fte((e/=3)%3,o);return vae.fromMove(s,i)}}]),n}(j7));var pae=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=dae.getGameStatus(e);return new _te(t.toBoardValue())}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getCurrentPlayer(),a=Ete.toComparableObjectSet(n.getPlayerRemainingPieces()),o=0;o<3;o++)for(var s=0;s<3;s++){var u,c=new fte(s,o),l=uy(a);try{for(l.s();!(u=l.n()).done;){var f=u.value,h=vae.fromDrop(f,c);dae.isLegal(h,n).isSuccess()&&t.push(h)}}catch(y){l.e(y)}finally{l.f()}if(r[o][s].belongsTo(i))for(var d=0;d<3;d++)for(var v=0;v<3;v++){var p=new fte(v,d);if(!p.equals(c)){var g=vae.fromMove(c,p);dae.isLegal(g,n).isSuccess()&&t.push(g)}}}return t}}]),n}(wte),gae=new fae(K7.NONE,K7.NONE,K7.NONE),yae=new fae(Q7.ZERO,K7.NONE,K7.NONE),mae=new fae(K7.NONE,Q7.ZERO,K7.NONE),kae=new fae(K7.NONE,K7.NONE,Q7.ZERO),Cae=new fae(Q7.ONE,K7.NONE,K7.NONE),wae=new fae(K7.NONE,K7.NONE,Q7.ONE),_ae=new fae(Q7.ONE,Q7.ZERO,K7.NONE),Eae=new fae(Q7.ZERO,Q7.ZERO,K7.NONE),bae=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(kr||(kr=Hg(["Goal of the game"]))),$localize(Cr||(Cr=Hg(["The goal of Encapsule is to align three of your pieces.\n        Here, we have a victory of the dark player."]))),new lae([[yae,Cae,wae],[gae,mae,gae],[gae,gae,kae]],0,[cae.SMALL_DARK,cae.MEDIUM_DARK,cae.BIG_DARK,cae.SMALL_LIGHT,cae.MEDIUM_LIGHT,cae.MEDIUM_LIGHT,cae.BIG_LIGHT])),zte.anyMove($localize(wr||(wr=Hg(["Putting a piece"]))),$localize(_r||(_r=Hg(["This is the initial board. You're playing Dark.<br/><br/>\n        Pick one of your piece on the side of the board and put it on the board."]))),lae.getInitialState(),vae.fromDrop(cae.SMALL_DARK,new fte(1,1)),$localize(Er||(Er=Hg(["Congratulations!"])))),zte.fromMove($localize(br||(br=Hg(["Moving"]))),$localize(Sr||(Sr=Hg(["Another possible action is to move one of your pieces that is already on the board.<br/><br/>\n        Click on your dark piece and then on any empty square of the board."]))),new lae([[yae,wae,gae],[gae,gae,gae],[gae,gae,gae]],0,[]),[vae.fromMove(new fte(0,0),new fte(2,0)),vae.fromMove(new fte(0,0),new fte(0,1)),vae.fromMove(new fte(0,0),new fte(1,1)),vae.fromMove(new fte(0,0),new fte(2,1)),vae.fromMove(new fte(0,0),new fte(0,2)),vae.fromMove(new fte(0,0),new fte(1,2)),vae.fromMove(new fte(0,0),new fte(2,2))],$localize(Pr||(Pr=Hg(["Congratulations!"]))),$localize(Or||(Or=Hg(["Failed. Try again."])))),zte.fromPredicate($localize(Tr||(Tr=Hg(["Particularity"]))),$localize(Ir||(Ir=Hg(['At Encapsule, pieces encapsulate each other.\n        It is therefore possible to have up to three pieces per square!\n        However, only the biggest piece of each square counts:\n        you cannot win with a piece that is "hidden" by a bigger piece.\n        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.\n        Finally, you cannot encapsulate a piece with a smaller piece.\n        You\'re playing Dark and you can win now in various ways.<br/><br/>\n        Try to win by making a move, and not by putting a new piece on the board.']))),new lae([[_ae,gae,Cae],[Eae,wae,wae],[gae,gae,gae]],0,[cae.MEDIUM_DARK,cae.BIG_DARK,cae.MEDIUM_LIGHT,cae.MEDIUM_LIGHT]),vae.fromMove(new fte(0,1),new fte(0,2)),function(e,t,n){if(e.landingCoord.equals(new fte(0,2))){if(e.isDropping())return DB.failure($localize(Ar||(Ar=Hg(["You won, but the exercise is to win while moving a piece!"]))));if(e.startingCoord.equalsValue(new fte(0,1)))return DB.SUCCESS}return DB.failure($localize(Rr||(Rr=Hg(["Failed. Try again."]))))},$localize(Mr||(Mr=Hg(["Congratulations!"]))))]});function Sae(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"circle",6),TS("click",function(){var e=eC(n),t=e.$implicit,r=e.index;return RS().onPieceClick(0,t,r)}),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS();DE(1),NS("id","piece_0_",r.toString(),"_",i,""),mS("ngClass",a.getSidePieceClasses(r,i)),lS("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(0,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}function Pae(e,t){if(1&e){var n=SS();IC(),CS(0,"circle",9),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().onBoardClick(e,t)}),wS()}if(2&e){var r=t.$implicit,i=RS().index,a=RS().index,o=RS();mS("ngClass",o.getPieceClasses(r)),lS("r",o.getPieceRadius(r))("cx",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Oae(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",7),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onBoardClick(e,t)}),wS(),pS(2,Pae,1,4,"circle",8),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();DE(1),NS("id","click_",i,"_",a,""),mS("ngClass",o.getRectClasses(i,a)),lS("x",o.SPACE_SIZE*i+o.STROKE_WIDTH)("y",o.SPACE_SIZE*a+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngForOf",o.getListPieces(r))}}function Tae(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Oae,3,8,"g",2),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function Iae(e,t){if(1&e){var n=SS();IC(),CS(0,"rect",10),TS("click",function(){eC(n);var e=RS();return e.onBoardClick(e.chosenCoord.get().x,e.chosenCoord.get().y)}),wS()}if(2&e){var r=RS();NS("id","chosenCoord_",r.chosenCoord.get().x,"_",r.chosenCoord.get().y,""),lS("x",r.SPACE_SIZE*r.chosenCoord.get().x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*r.chosenCoord.get().y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Aae(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"circle",6),TS("click",function(){var e=eC(n),t=e.$implicit,r=e.index;return RS().onPieceClick(1,t,r)}),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS();DE(1),NS("id","piece_1_",r.toString(),"_",i,""),mS("ngClass",a.getSidePieceClasses(r,i)),lS("r",a.getPieceRadius(r))("cx",a.getPieceLeftX(1,i)+a.getPieceRadius(r))("cy",a.SPACE_SIZE/2)}}var Rae=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).INTER_PIECE_SPACE=20,r.lastLandingCoord=RB.empty(),r.lastStartingCoord=RB.empty(),r.chosenCoord=RB.empty(),r.chosenPiece=RB.empty(),r.remainingPieceLeftX=[],r.rules=new dae(lae),r.availableMinimaxes=[new pae(r.rules,"EncapsuleMinimax")],r.encoder=vae.encoder,r.tutorial=(new bae).tutorial,r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard();var e=this.rules.node.move;this.calculateLeftX(),e.isPresent()?(this.lastLandingCoord=RB.of(e.get().landingCoord),this.lastStartingCoord=e.get().startingCoord):(this.lastLandingCoord=RB.empty(),this.lastStartingCoord=RB.empty())}},{key:"getListPieces",value:function(e){return e.toList()}},{key:"getRemainingPieces",value:function(e){return this.rules.node.gameState.getRemainingPiecesOfPlayer(Q7.of(e))}},{key:"onBoardClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new fte(e,t),o=n.rules.node.gameState,!n.chosenCoord.isAbsent()){r.next=9;break}if(n.chosenCoord=RB.of(a),!n.chosenPiece.isPresent()){r.next=8;break}return s=vae.fromDrop(n.chosenPiece.get(),a),r.abrupt("return",n.chooseMove(s,n.rules.node.gameState));case 8:return r.abrupt("return",!1===o.getPieceAt(a).belongsTo(o.getCurrentPlayer())?n.cancelMove(hae.INVALID_PIECE_SELECTED()):DB.SUCCESS);case 9:if(!n.chosenCoord.equalsValue(a)){r.next=11;break}return r.abrupt("return",(n.cancelMoveAttempt(),DB.SUCCESS));case 11:return u=vae.fromMove(n.chosenCoord.get(),a),r.abrupt("return",n.chooseMove(u,n.rules.node.gameState));case 13:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=RB.empty(),this.chosenPiece=RB.empty(),this.chosenPieceIndex=RB.empty()}},{key:"onPieceClick",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a="#piece_"+e+"_"+t.toString()+"_"+n,o=r.canUserPlay(a),i.abrupt("return",o.isFailure()?r.cancelMove(o.getReason()):!1===r.rules.node.gameState.isDroppable(t)?r.cancelMove(hae.NOT_DROPPABLE()):r.chosenCoord.isAbsent()?(r.chosenPiece.equalsValue(t)&&r.chosenPieceIndex.equalsValue(n)?(r.chosenPiece=RB.empty(),r.chosenPieceIndex=RB.empty()):(r.chosenPiece=RB.of(t),r.chosenPieceIndex=RB.of(n)),DB.SUCCESS):r.cancelMove(hae.END_YOUR_MOVE()));case 2:case"end":return i.stop()}},i)}))()}},{key:"getRectClasses",value:function(e,t){return this.isSelected(e,t)?"moved":""}},{key:"isSelected",value:function(e,t){var n=new fte(e,t);return!(!this.lastStartingCoord.equalsValue(n)&&!this.lastLandingCoord.equalsValue(n))}},{key:"getPieceClasses",value:function(e){return[this.getPieceStrokeClass(e)]}},{key:"getPieceStrokeClass",value:function(e){var t=e.getPlayer();return N7(t.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+t.value+"-stroke"}},{key:"getPieceRadius",value:function(e){switch(e.getSize()){case uae.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case uae.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return PB.expectToBe(e.getSize(),uae.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}},{key:"getSidePieceClasses",value:function(e,t){var n=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(t)&&n.push("selected"),n}},{key:"isSelectedPiece",value:function(e){return this.chosenPiece.equalsValue(e)}},{key:"calculateLeftX",value:function(){this.remainingPieceLeftX=[];for(var e=0;e<=1;e++){this.remainingPieceLeftX.push([]);for(var t=this.getRemainingPieces(e),n=0;n<t.length;n++)if(0===n)this.remainingPieceLeftX[e].push(0);else{var r=this.remainingPieceLeftX[e][n-1],i=2*this.getPieceRadius(t[n-1]);this.remainingPieceLeftX[e].push(r+i+this.INTER_PIECE_SPACE)}}}},{key:"getPieceLeftX",value:function(e,t){return this.remainingPieceLeftX[e][t]}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-encapsule"]],features:[Qb],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 520 520","preserveAspectRatio","xMidYMid meet"],["remainingCasePlayerZero",""],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingCasePlayerOne",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected",3,"id","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"g",null,1),pS(3,Sae,2,6,"g",2),wS(),CS(4,"g",null,3),pS(6,Tae,2,1,"g",2),pS(7,Iae,1,6,"rect",4),wS(),CS(8,"g",null,5),pS(10,Aae,2,6,"g",2),wS(),wS()),2&e&&(DE(1),lS("transform","translate("+t.STROKE_WIDTH+", 0)"),DE(2),mS("ngForOf",t.getRemainingPieces(0)),DE(1),lS("transform","translate("+(260-1.5*t.SPACE_SIZE-t.STROKE_WIDTH)+", "+t.SPACE_SIZE+")"),DE(2),mS("ngForOf",t.board),DE(1),mS("ngIf",t.chosenCoord.isPresent()),DE(1),lS("transform","translate("+t.STROKE_WIDTH+", "+(2*t.STROKE_WIDTH+4*t.SPACE_SIZE)+")"),DE(2),mS("ngForOf",t.getRemainingPieces(1)))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Mae=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;if(fy(this,n),(s=t.call(this,e,r)).movedPieces=i,s.stepSize=a,s.direction=o,s.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+s.coord.toString()+".");if(i<1)throw new Error("Must select minimum one piece (got "+i+").");if(a<1)throw new Error("Step size must be minimum one (got "+a+").");if(a>i)throw new Error("Cannot move a phalanx further than its size (got step size "+a+" for "+i+" pieces).");return ny(s)}return dy(n,[{key:"toString",value:function(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||this.movedPieces!==e.movedPieces||this.stepSize!==e.stepSize)&&this.direction.equals(e.direction)}}]),n}(Ite);Mae.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 122303}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 8*e.coord.x*7*13*12+8*e.coord.y*7*13+8*(e.movedPieces-1)*7+8*(e.stepSize-1)+t}},{key:"decodeNumber",value:function(e){if(e%1!=0)throw new Error("EncodedMove must be an integer.");var t=e%8;e-=t;var n=(e/=8)%7;e-=n;var r=(e/=7)%13;e-=r;var i=(e/=13)%12;e-=i;var a=e/=12,o=ute.factory.fromInt(t);return new Mae(a,i,r+1,n+1,o.get())}}]),n}(j7));var xae=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"count",value:function(e,t){for(var n=0,r=0;r<14;r++)this.board[t][r]===e&&n++;return n}},{key:"doesOwnPiece",value:function(e){for(var t=0;t<12;t++)for(var n=0;n<14;n++)if(this.board[t][n]===e)return!0;return!1}}],[{key:"getInitialState",value:function(){var e=K7.NONE,t=K7.ZERO,r=K7.ONE;return new n([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t]],0)}}]),n}(Pte),Nae=function(){var e=dy(function e(){fy(this,e)});return e.PHALANX_IS_LEAVING_BOARD=function(){return $localize(xr||(xr=Hg(["The move distance of your phalanx puts it out of the board."])))},e.SOMETHING_IN_PHALANX_WAY=function(){return $localize(Nr||(Nr=Hg(["There is something in the way of your phalanx."])))},e.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=function(){return $localize(Dr||(Dr=Hg(["Your phalanx must be bigger than the one you are capturing."])))},e.SQUARE_NOT_ALIGNED_WITH_SELECTED=function(){return $localize(Lr||(Lr=Hg(["This square is not aligned with the selected piece."])))},e.SINGLE_PIECE_MUST_MOVE_BY_ONE=function(){return $localize(Fr||(Fr=Hg(["A single piece can only move by one square."])))},e.SINGLE_PIECE_CANNOT_CAPTURE=function(){return $localize(Ur||(Ur=Hg(["A single piece cannot make a capture."])))},e.SQUARE_NOT_ALIGNED_WITH_PHALANX=function(){return $localize(Vr||(Vr=Hg(["This square is not aligned with the direction of the phalanx."])))},e.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=function(){return $localize(Br||(Br=Hg(["A phalanx can't contain pieces outside of the board."])))},e.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=function(){return $localize(zr||(zr=Hg(["A phalanx cannot contain an empty square."])))},e.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=function(){return $localize(Hr||(Hr=Hg(["A phalanx cannot contain a piece of the opponent."])))},e}(),Dae=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,n){return new xae(n,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.count(Q7.ZERO,0),r=t.count(Q7.ONE,11);if(t.turn%2==0){if(n>r)return Lte.ZERO_WON}else if(r>n)return Lte.ONE_WON;return!1===t.doesOwnPiece(Q7.ZERO)?Lte.ONE_WON:!1===t.doesOwnPiece(Q7.ONE)?Lte.ZERO_WON:Lte.ONGOING}}],[{key:"isLegal",value:function(e,t){var r=this.getPhalanxValidity(t,e);if(r.isFailure())return MB.failure(r.getReason());var i=this.getLandingStatus(t,e);if(i.isFailure())return i;var a=t9.copyBiArray(i.get()),o=t.getCurrentOpponent(),s=n.getCaptureValidity(t,a,e,o);return s.isFailure()?s:MB.success(s.get())}},{key:"getPhalanxValidity",value:function(e,t){for(var n=t.coord,r=0,i=e.getCurrentOpponent();r<t.movedPieces;){if(n.isNotInRange(14,12))return DB.failure(Nae.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());var a=e.getPieceAt(n);if(a===K7.NONE)return DB.failure(Nae.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(a===i)return DB.failure(Nae.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());n=n.getNext(t.direction,1),r++}return DB.SUCCESS}},{key:"getLandingStatus",value:function(e,t){for(var n=e.getCopiedBoard(),r=e.getCurrentPlayer(),i=t.coord,a=t.coord.getNext(t.direction,t.movedPieces),o=0;o+1<t.stepSize;){if(n[i.y][i.x]=K7.NONE,n[a.y][a.x]=r,a.isNotInRange(14,12))return MB.failure(Nae.PHALANX_IS_LEAVING_BOARD());if(e.getPieceAt(a).isPlayer())return MB.failure(Nae.SOMETHING_IN_PHALANX_WAY());o++,a=a.getNext(t.direction,1),i=i.getNext(t.direction,1)}return a.isNotInRange(14,12)?MB.failure(Nae.PHALANX_IS_LEAVING_BOARD()):e.getPieceAt(a)===r?MB.failure(Cte.CANNOT_SELF_CAPTURE()):(n[i.y][i.x]=K7.NONE,n[a.y][a.x]=r,MB.success(n))}},{key:"getCaptureValidity",value:function(e,t,n,r){for(var i=n.coord.getNext(n.direction,n.movedPieces+n.stepSize-1),a=0;i.isInRange(14,12)&&e.getPieceAt(i)===r;){if(a>0&&(t[i.y][i.x]=K7.NONE),++a>=n.movedPieces)return MB.failure(Nae.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(n.direction,1)}return MB.success(t)}}]),n}(Fte),Lae=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=n.getListMoves(e);return t9.sortByDescending(t,function(e){return e.stepSize}),t}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new _te(t.isEndGame?t.toBoardValue():this.getPieceCountPlusRowDomination(e.gameState))}},{key:"getPieceCountPlusRowDomination",value:function(e){for(var t=0,n=0;n<12;n++){for(var r=0,i=[0,0],a=0;a<14;a++){var o=new fte(a,n),s=e.getPieceAt(o);if(s.isPlayer()){var u=s.getScoreModifier();t+=2002*u,i[s.value]=u,r+=u;for(var c=0,l=[ute.UP_LEFT,ute.UP,ute.UP_RIGHT];c<l.length;c++)for(var f=l[c],h=o.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)t+=1*u,h=h.getNext(f,1)}}0!==r&&(t+=Math.abs(r)/r*2),t+=1*i.reduce(function(e,t){return e+t})}return t}}],[{key:"getListMoves",value:function(e){for(var t,n=e.gameState.getCurrentPlayer(),r=e.gameState.getCurrentOpponent(),i=K7.NONE,a=[],o=e.gameState,s=0;s<12;s++)for(var u=0;u<14;u++){var c=new fte(u,s);if(o.getPieceAt(c)===n){var l,f=uy(ute.DIRECTIONS);try{for(f.s();!(l=f.n()).done;){for(var h=l.value,d=1,v=c.getNext(h,1);v.isInRange(14,12)&&o.getPieceAt(v)===n;)d+=1,v=v.getNext(h,1);for(var p=1;v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===i;)t=new Mae(u,s,d,p,h),a=this.addMove(a,t,o),p++,v=v.getNext(h,1);v.isInRange(14,12)&&p<=d&&o.getPieceAt(v)===r&&(t=new Mae(u,s,d,p,h),a=this.addMove(a,t,o))}}catch(g){f.e(g)}finally{f.f()}}}return a}},{key:"addMove",value:function(e,t,n){return Dae.isLegal(t,n).isSuccess()&&e.push(t),e}}]),n}(wte),Fae=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=Lae.getListMoves(e);return this.orderMovesByPhalanxSizeAndFilter(t,e.gameState)}},{key:"orderMovesByPhalanxSizeAndFilter",value:function(e,t){var n=this;return t9.sortByDescending(e,function(e){return e.movedPieces}),e.length>40?e.filter(function(e){return!!n.moveIsCapture(e,t)||e.movedPieces*Math.random()>1}):e}},{key:"moveIsCapture",value:function(e,t){var n=e.coord.getNext(e.direction,e.movedPieces+e.stepSize-1);return t.board[n.y][n.x]===t.getCurrentOpponent()}},{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return new _te(t.isEndGame?t.toBoardValue():this.getPieceCountThenSupportThenAdvancement(e.gameState))}},{key:"getPieceCountThenSupportThenAdvancement",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=new fte(r,n),a=e.getPieceAt(i);if(a.isPlayer()){var o=void 0,s=void 0;a===Q7.ZERO?(o=12-n,s=[ute.UP_LEFT,ute.UP,ute.UP_RIGHT]):(o=n+1,s=[ute.DOWN_LEFT,ute.DOWN,ute.DOWN_RIGHT]);var u=a.getScoreModifier();t+=o*u,t+=149629*u;var c,l=uy(s);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,h=i.getNext(f,1);h.isInRange(14,12)&&e.getPieceAt(h)===a;)t+=337*u,h=h.getNext(f,1)}catch(d){l.e(d)}finally{l.f()}}}return t}}]),n}(wte),Uae=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).DOMINANCE_FACTOR=20,e.DEFENSE_FACTOR=5,e.TERRITORY_FACTOR=2,e.OFFENSE_FACTOR=10,e.CENTER_FACTOR=5,e.MOBILITY_FACTOR=.12,e}return dy(n,[{key:"getDominance",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new fte(r,n));i.isPlayer()&&(t+=i.getScoreModifier())}return t*this.DOMINANCE_FACTOR}},{key:"getDefense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new fte(n,11))===Q7.ZERO&&(t+=Q7.ZERO.getScoreModifier()),e.getPieceAt(new fte(n,0))===Q7.ONE&&(t+=Q7.ONE.getScoreModifier());return t*this.DEFENSE_FACTOR}},{key:"getTerritory",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new fte(r,n));if(i.isPlayer()){for(var a=-1;a<=1;a++)for(var o=-1;o<=1;o++){var s=new fte(r+a,n+o);if(s.isInRange(14,12)){var u=e.getPieceAt(s);(u===i||u===K7.NONE)&&(t+=1*i.getScoreModifier())}}t-=i.getScoreModifier()}}return t*this.TERRITORY_FACTOR}},{key:"getOffense",value:function(e){for(var t=0,n=0;n<14;n++)e.getPieceAt(new fte(n,0))===Q7.ZERO&&(t+=Q7.ZERO.getScoreModifier()),e.getPieceAt(new fte(n,11))===Q7.ONE&&(t+=Q7.ONE.getScoreModifier());return t*this.OFFENSE_FACTOR}},{key:"getCenter",value:function(e){for(var t=0,n=0;n<12;n++)for(var r=0;r<14;r++){var i=e.getPieceAt(new fte(r,n));i.isPlayer()&&(t+=i.getScoreModifier()*Math.sqrt((r-6.5)*(r-6.5)))}return t*this.CENTER_FACTOR}},{key:"getMobility",value:function(e){for(var t=0,n=0,r=0,i=0;i<12;i++)for(var a=0;a<14;a++){var o=new fte(a,i),s=e.getPieceAt(o);if(s.isPlayer()){var u,c=uy(ute.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){for(var l=u.value,f=1,h=o.getNext(l,1);h.isInRange(14,12)&&e.getPieceAt(h)===s;)f+=1,h=h.getNext(l,1);for(var d=1;h.isInRange(14,12)&&d<=f&&e.getPieceAt(h)===K7.NONE;)d++,h=h.getNext(l,1);t+=d*d*s.getScoreModifier(),s===Q7.ZERO?n=Math.max(n,d):s===Q7.ONE&&(r=Math.max(r,d))}}catch(v){c.e(v)}finally{c.f()}}}return(t+n*Q7.ZERO.getScoreModifier()+r*Q7.ONE.getScoreModifier())*this.MOBILITY_FACTOR}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=this.ruler.getGameStatus(e);if(n.isEndGame)return new _te(n.toBoardValue());var r=this.getDominance(t),i=this.getDefense(t),a=this.getTerritory(t),o=this.getCenter(t),s=this.getOffense(t),u=this.getMobility(t);return new _te(r+i+a+o+s+u)}}]),n}(Lae),Vae=K7.NONE,Bae=K7.ZERO,zae=K7.ONE,Hae=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Gr||(Gr=Hg(["Initial board"]))),$localize($r||($r=Hg(["This is the initial board of Epaminondas.\n        The top line is the starting line of Light.\n        The bottom line is the starting line of Dark."]))),xae.getInitialState()),zte.informational($localize(Zr||(Zr=Hg(["Goal of the game (1/2)"]))),$localize(qr||(qr=Hg(["After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line\n        than the number of pieces the opponent has on the player's starting line, the player wins.\n        Here, it's Dark's turn to play: Dark has therefore won."]))),new xae([[Vae,Vae,Vae,Vae,Vae,Bae,Vae,Vae,zae,zae,zae,zae,zae,zae],[Vae,Vae,Vae,Vae,Vae,Bae,Vae,Vae,Vae,Vae,Vae,Vae,zae,zae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Bae,Bae,Bae,Bae,Vae,Vae,Vae]],0)),zte.informational($localize(Wr||(Wr=Hg(["Goal of the game (2/2)"]))),$localize(jr||(jr=Hg(["Here, it is Light's turn.\n        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line."]))),new xae([[Vae,Vae,Vae,Vae,Vae,Bae,Vae,Vae,Vae,Vae,zae,zae,zae,zae],[Vae,Vae,Vae,Vae,Vae,Bae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,zae,zae,Vae,Vae,Vae,Bae,Bae,Vae,Bae,Bae,Bae,Bae]],1)),zte.fromPredicate($localize(Yr||(Yr=Hg(["Moving a piece"]))),$localize(Kr||(Kr=Hg(["Here is the starting board. Dark plays first.\n        Let's start with moving a single piece:\n        <ol>\n            <li>Click on a piece.</li>\n            <li>Click on a empty neighboring square.</li>\n        </ol>"]))),xae.getInitialState(),new Mae(0,10,1,1,ute.UP),function(e,t,n){return 1===e.movedPieces?DB.SUCCESS:DB.failure($localize(Qr||(Qr=Hg(["Congratulations, you are in advance. But this is not the exercise here, try again."]))))},$localize(Xr||(Xr=Hg(["This is how you move a single piece."])))),zte.fromPredicate($localize(Jr||(Jr=Hg(["Moving a phalanx"]))),$localize(ei||(ei=Hg(["Let us now see how to move multiple pieces along a line, which is called a phalanx:\n        <ol>\n            <li>Click on the first piece of the phalanx.</li>\n            <li>Click on the last piece of the phalanx.</li>\n            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>\n        </ol><br/>\n        Move a phalanx!"]))),xae.getInitialState(),new Mae(0,11,2,1,ute.UP),function(e,t,n){return e.movedPieces>1?DB.SUCCESS:DB.failure($localize(ti||(ti=Hg(["Failed! You moved only one piece."]))))},$localize(ni||(ni=Hg(["Congratulations!\n        The moved pieces can be horizontally, vertically, or diagonally aligned.\n        The move should be made along this axis, forward or backwards.\n        There can be no opponent nor holes in the phalanx."])))),zte.fromMove($localize(ri||(ri=Hg(["Capture"]))),$localize(ii||(ii=Hg(["In order to capture pieces of the opponent:\n        <ol>\n            <li>It must be aligned with the phalanx you are moving.</li>\n            <li>It must be strictly shorter than your phalanx.</li>\n            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>\n        </ol><br/>\n        Capture a phalanx."]))),new xae([[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,zae,zae,zae,zae,zae,zae],[Vae,Vae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,zae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,zae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Bae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Bae,Vae,Vae,Vae,Vae,zae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Bae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Bae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae,Vae],[Vae,Vae,Vae,Vae,Vae,Vae,Vae,Bae,Bae,Bae,Bae,Bae,Bae,Bae]],0),[new Mae(2,10,4,2,ute.UP)],$localize(ai||(ai=Hg(["Congratulations, you made it!\n        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment."]))),$localize(oi||(oi=Hg(["Failed, you have not captured the phalanx."]))))]});function Gae(e,t){if(1&e){var n=SS();IC(),CS(0,"circle",4),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().onClick(e,t)}),wS()}if(2&e){var r=RS().index,i=RS().index,a=RS();mS("ngClass",a.getPieceClasses(r,i)),lS("cx",a.SPACE_SIZE*r+a.STROKE_WIDTH+a.SPACE_SIZE/2)("cy",a.SPACE_SIZE*i+a.STROKE_WIDTH+a.SPACE_SIZE/2)("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)}}function $ae(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",2),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),wS(),pS(2,Gae,1,4,"circle",3),wS()}if(2&e){var r=t.index,i=RS().index,a=RS();DE(1),NS("id","click_",r,"_",i,""),mS("ngClass",a.getRectClasses(r,i)),lS("x",a.SPACE_SIZE*r+a.STROKE_WIDTH)("y",a.SPACE_SIZE*i+a.STROKE_WIDTH)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),DE(1),mS("ngIf",a.board[i][r]!==a.NONE)}}function Zae(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,$ae,3,8,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function qae(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",5),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e.x,e.y)}),wS(),wS()}if(2&e){var r=t.$implicit,i=RS();DE(1),lS("x",i.SPACE_SIZE*r.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*r.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Wae=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).NONE=K7.NONE,r.firstPiece=RB.empty(),r.validExtensions=[],r.phalanxValidLandings=[],r.lastPiece=RB.empty(),r.phalanxDirection=RB.empty(),r.phalanxMiddles=[],r.moveds=[],r.captureds=[],r.hasAsymetricBoard=!0,r.rules=new Dae(xae),r.availableMinimaxes=[new Lae(r.rules,"Normal"),new Fae(r.rules,"Positional"),new Uae(r.rules,"Attack")],r.encoder=Mae.encoder,r.tutorial=(new Hae).tutorial,r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){this.firstPiece=RB.empty(),this.lastPiece=RB.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.rules.node.gameState.getCopiedBoard()}},{key:"showPreviousMove",value:function(){var e=this.rules.node.move.get(),t=e.coord;this.moveds=[t];for(var n=1;n<e.stepSize+e.movedPieces;n++)t=t.getNext(e.direction,1),this.moveds.push(t);for(var r=this.rules.node.mother.get(),i=r.gameState.getCurrentOpponent();t.isInRange(14,12)&&r.gameState.getPieceAt(t)===i;)this.captureds.push(t),t=t.getNext(e.direction,1)}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.canUserPlay("#click_"+e+"_"+t),r.abrupt("return",i.isFailure()?n.cancelMove(i.getReason()):n.firstPiece.isAbsent()?n.firstClick(e,t):n.lastPiece.isAbsent()?n.secondClick(e,t):n.thirdClick(e,t));case 2:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=n.rules.node.gameState.getCurrentOpponent(),a=n.rules.node.gameState.getCurrentPlayer(),r.t0=n.board[t][e],r.next=r.t0===a?4:r.t0===i?5:6;break;case 4:return r.abrupt("return",(n.firstPiece=RB.of(new fte(e,t)),n.validExtensions=n.getValidExtensions(a),n.phalanxValidLandings=n.getPhalanxValidLandings(),DB.SUCCESS));case 5:return r.abrupt("return",n.cancelMove(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()));case 6:return r.abrupt("return",(PB.expectToBe(n.board[t][e],K7.NONE),n.cancelMove(Cte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())));case 7:case"end":return r.stop()}},r)}))()}},{key:"hidePreviousMove",value:function(){this.captureds=[],this.moveds=[]}},{key:"getValidExtensions",value:function(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}},{key:"getFirstPieceExtensions",value:function(e){var t,n=[],r=uy(ute.DIRECTIONS);try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=this.firstPiece.get().getNext(i,1);a.isInRange(14,12)&&this.board[a.y][a.x]===e;)n.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getPhalanxValidExtensions",value:function(e){var t=ute.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get(),n=this.lastPiece.get().getNext(t,1),r=this.getExtensionsToward(n,t,e);t=t.getOpposite();var i=this.firstPiece.get().getNext(t,1),a=this.getExtensionsToward(i,t,e);return r.concat(a)}},{key:"getExtensionsToward",value:function(e,t,n){for(var r=[];e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r.push(e),e=e.getNext(t,1);return r}},{key:"getPhalanxValidLandings",value:function(){if(this.lastPiece.isPresent()){var e=this.firstPiece.get(),t=this.lastPiece.get(),n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y),i=Math.max(n,r)+1,a=ute.factory.fromMove(e,t).get(),o=t.getNext(a,1),s=this.getLandingsToward(o,a,i);a=a.getOpposite();var u=e.getNext(a,1);return this.getLandingsToward(u,a,i).concat(s)}return this.getNeighboringEmptyCases()}},{key:"getNeighboringEmptyCases",value:function(){var e,t=[],n=uy(ute.DIRECTIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.firstPiece.get().getNext(r,1);i.isInRange(14,12)&&this.board[i.y][i.x]===K7.NONE&&t.push(i)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"getLandingsToward",value:function(e,t,n){for(var r=this.rules.node.gameState.getCurrentPlayer(),i=this.rules.node.gameState.getCurrentOpponent(),a=[];e.isInRange(14,12)&&a.length<n&&this.board[e.y][e.x]!==r;){if(this.board[e.y][e.x]===i)return this.getPhalanxLength(e,t,i)<n&&a.push(e),a;a.push(e),e=e.getNext(t,1)}return a}},{key:"getPhalanxLength",value:function(e,t,n){for(var r=0;e.isInRange(14,12)&&this.board[e.y][e.x]===n;)r++,e=e.getNext(t,1);return r}},{key:"cancelMoveAttempt",value:function(){this.firstPiece=RB.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=RB.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}},{key:"secondClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new fte(e,t),a=n.firstPiece.get(),!i.equals(a)){r.next=3;break}return r.abrupt("return",(n.cancelMoveAttempt(),DB.SUCCESS));case 3:if(o=n.rules.node.gameState.getCurrentOpponent(),s=n.rules.node.gameState.getCurrentPlayer(),i.isAlignedWith(a)){r.next=6;break}return r.abrupt("return",n.cancelMove(Nae.SQUARE_NOT_ALIGNED_WITH_SELECTED()));case 6:u=i.getDistance(a),c=a.getDirectionToward(i).get(),r.t0=n.board[t][e],r.next=r.t0===K7.NONE?10:r.t0===o?11:12;break;case 10:return r.abrupt("return",1===u?n.tryMove(new Mae(a.x,a.y,1,1,c)):n.cancelMove(Nae.SINGLE_PIECE_MUST_MOVE_BY_ONE()));case 11:return r.abrupt("return",n.cancelMove(Nae.SINGLE_PIECE_CANNOT_CAPTURE()));case 12:return PB.expectToBe(n.board[t][e],s),l=new Mae(a.x,a.y,u,1,c),f=Dae.getPhalanxValidity(n.rules.node.gameState,l),r.abrupt("return",f.isFailure()?n.cancelMove(f.getReason()):(n.lastPiece=RB.of(i),n.validExtensions=n.getValidExtensions(s),n.phalanxValidLandings=n.getPhalanxValidLandings(),n.phalanxMiddles=a.getCoordsToward(i),n.phalanxDirection=RB.of(c),DB.SUCCESS));case 15:case"end":return r.stop()}},r)}))()}},{key:"thirdClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c,l,f,h;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.rules.node.gameState.getCurrentPlayer(),a=new fte(e,t),!n.firstPiece.equalsValue(a)){r.next=3;break}return r.abrupt("return",n.moveFirstPiece(i));case 3:if(!n.lastPiece.equalsValue(a)){r.next=5;break}return r.abrupt("return",n.moveLastPiece(i));case 5:if(o=n.firstPiece.get(),s=n.lastPiece.get(),a.isAlignedWith(o)){r.next=8;break}return r.abrupt("return",n.cancelMove(Nae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 8:if(u=ute.factory.fromMove(o,s).get(),c=ute.factory.fromMove(o,a).get(),u===c.getOpposite()&&(n.firstPiece=RB.of(s),n.lastPiece=RB.of(o),u=c),u===c){r.next=12;break}return r.abrupt("return",n.cancelMove(Nae.SQUARE_NOT_ALIGNED_WITH_PHALANX()));case 12:if(n.board[t][e]!==i){r.next=14;break}return r.abrupt("return",n.thirdClickOnPlayerPiece(a,u,i));case 14:return l=n.firstPiece.get().getDistance(n.lastPiece.get())+1,f=n.lastPiece.get().getDistance(a),h=new Mae(n.firstPiece.get().x,n.firstPiece.get().y,l,f,u),r.abrupt("return",n.tryMove(h));case 16:case"end":return r.stop()}},r)}))()}},{key:"thirdClickOnPlayerPiece",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return r.lastPiece=RB.of(e),a=r.firstPiece.get().getDistance(e)+1,o=new Mae(r.firstPiece.get().x,r.firstPiece.get().y,a,1,t),s=Dae.getPhalanxValidity(r.rules.node.gameState,o),i.abrupt("return",s.isFailure()?r.cancelMove(s.getReason()):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getValidExtensions(n),r.phalanxValidLandings=r.getPhalanxValidLandings(),DB.SUCCESS));case 3:case"end":return i.stop()}},i)}))()}},{key:"moveFirstPiece",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t.firstPiece=RB.of(t.firstPiece.get().getNext(t.phalanxDirection.get(),1)),!t.firstPiece.equals(t.lastPiece)){n.next=6;break}return n.next=4,t.moveOnlyPiece(e);case 4:n.next=7;break;case 6:t.phalanxMiddles=t.phalanxMiddles.slice(1),t.validExtensions=t.getPhalanxValidExtensions(e);case 7:return t.phalanxValidLandings=t.getPhalanxValidLandings(),n.abrupt("return",DB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveLastPiece",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=RB.of(t.lastPiece.get().getPrevious(t.phalanxDirection.get(),1)),t.firstPiece.equals(t.lastPiece)?t.moveOnlyPiece(e):(t.phalanxMiddles=t.firstPiece.get().getCoordsToward(t.lastPiece.get()),t.validExtensions=t.getPhalanxValidExtensions(e),t.phalanxValidLandings=t.getPhalanxValidLandings(),DB.SUCCESS)));case 1:case"end":return n.stop()}},n)}))()}},{key:"moveOnlyPiece",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.lastPiece=RB.empty(),t.validExtensions=t.getFirstPieceExtensions(e),t.phalanxDirection=RB.empty(),t.phalanxMiddles=[],t.phalanxValidLandings=t.getPhalanxValidLandings(),DB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e){var t=this.rules.node.gameState;return this.cancelMove(),this.chooseMove(e,t)}},{key:"getPieceClasses",value:function(e,t){var n=this.getPlayerClass(this.board[t][e]);return this.getPieceStrokeClasses(e,t).concat([n])}},{key:"getPieceStrokeClasses",value:function(e,t){var n=new fte(e,t);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(n)||this.lastPiece.equalsValue(n)||this.phalanxMiddles.some(function(e){return e.equals(n)})?["highlighted"]:[]}},{key:"getRectClasses",value:function(e,t){var n=new fte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:this.moveds.some(function(e){return e.equals(n)})?["moved"]:[]}},{key:"getHighlightedCoords",value:function(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}},{key:"getCurrentPlayerPieces",value:function(){for(var e=[],t=this.rules.node.gameState.getCurrentPlayer(),n=0;n<this.board.length;n++)for(var r=0;r<this.board[n].length;r++)this.board[n][r]===t&&e.push(new fte(r,n));return e}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-epaminondas"]],features:[Qb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable",3,"click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,Zae,2,1,"g",1),pS(2,qae,2,4,"g",1),wS()),2&e&&(lS("transform",t.rotation),DE(1),mS("ngForOf",t.board),DE(1),mS("ngForOf",t.getHighlightedCoords()))},directives:[nR,eR,iR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}();function jae(e){return new(function(t){Jg(r,t);var n=ty(r);function r(){return fy(this,r),n.apply(this,arguments)}return dy(r,[{key:"encode",value:function(t){return t.isPresent()?e.encode(t.get()):null}},{key:"decode",value:function(t){return null===t?RB.empty():RB.of(e.decode(t))}}]),r}(q7))}var Yae=function(){function e(t){if(fy(this,e),t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Mie.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=t9.copyImmutableArray(t).sort(function(e,t){if(e.x===t.x){if(e.y===t.y)throw new Error("Cannot create a GipfCapture with duplicate cases");return e.y>t.y?1:-1}return e.x>t.x?1:-1});var n,r=RB.empty(),i=uy(this.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(r.isPresent()&&1!==r.get().getDistance(a))throw new Error("Cannot create a GipfCapture with non-consecutive cases");r=RB.of(a)}}catch(o){i.e(o)}finally{i.f()}}return dy(e,[{key:"toString",value:function(){var e,t="",n=uy(this.capturedSpaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;""!==t&&(t+=","),t+=r.toString()}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"size",value:function(){return this.capturedSpaces.length}},{key:"forEach",value:function(e){this.capturedSpaces.forEach(e)}},{key:"contains",value:function(e){for(var t=0;t<this.capturedSpaces.length;t++)if(this.capturedSpaces[t].equals(e))return!0;return!1}},{key:"intersectsWith",value:function(e){return this.capturedSpaces.some(function(t){return e.contains(t)})}},{key:"getLine",value:function(){return Mie.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}},{key:"equals",value:function(e){if(this===e)return!0;if(this.capturedSpaces.length!==e.capturedSpaces.length)return!1;for(var t=0;t<this.capturedSpaces.length;t++)if(!this.capturedSpaces[t].equals(e.capturedSpaces[t]))return!1;return!0}}]),e}();Yae.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encode",value:function(e){return e.capturedSpaces.map(function(e){return fte.encoder.encode(e)})}},{key:"decode",value:function(e){return new Yae(e.map(function(e){return fte.encoder.decode(e)}))}}]),n}(q7));var Kae=function(){function e(t,n){fy(this,e),this.coord=t,this.direction=n}return dy(e,[{key:"toString",value:function(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}},{key:"equals",value:function(e){return!!this.coord.equals(e.coord)&&this.direction.equals(e.direction)}}]),e}();Kae.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).optionalDirectionEncoder=jae(pte.encoder),e}return dy(n,[{key:"encode",value:function(e){return{coord:fte.encoder.encode(e.coord),direction:this.optionalDirectionEncoder.encode(e.direction)}}},{key:"decode",value:function(e){var t=e;return N7(null!=t.coord,"Invalid encoded GipfPlacement"),new Kae(fte.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}}]),n}(q7));var Qae=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this)).placement=e,a.initialCaptures=r,a.finalCaptures=i,a}return dy(n,[{key:"toString",value:function(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=uy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"equals",value:function(e){return this===e||!(!1===this.placement.equals(e.placement)||!1===t9.compareArray(this.initialCaptures,e.initialCaptures)||!1===t9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}]),n}(Tte);Qae.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encodeMove",value:function(e){var t={placement:Kae.encoder.encode(e.placement)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=Yae.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=Yae.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return N7(null!=t.placement,"Invalid encoded GipfMove"),new Qae(Kae.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",Yae.encoder.decode),this.decodeArray(t,"finalCapture",Yae.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(W7));var Xae=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,r,e,7,7,[3,2,1],vte.EMPTY)).sidePieces=i,o.capturedPieces=a,o}return dy(n,[{key:"equals",value:function(e){return this.turn===e.turn&&this.sidePieces[0]===e.sidePieces[0]&&this.sidePieces[1]===e.sidePieces[1]&&this.capturedPieces[0]===e.capturedPieces[0]&&this.capturedPieces[1]===e.capturedPieces[1]&&t9.compareTable(this.board,e.board)}},{key:"getNumberOfPiecesToPlace",value:function(e){return this.sidePieces[e.value]}},{key:"getNumberOfPiecesCaptured",value:function(e){return this.capturedPieces[e.value]}},{key:"setAtUnsafe",value:function(e,t){var r=t9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.turn,this.sidePieces,this.capturedPieces)}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==vte.UNREACHABLE}}],[{key:"getInitialState",value:function(){var e=vte.EMPTY,t=vte.UNREACHABLE,r=vte.ZERO,i=vte.ONE;return new n([[t,t,t,i,e,e,r],[t,t,e,e,e,e,e],[t,e,e,e,e,e,e],[r,e,e,e,e,e,i],[e,e,e,e,e,e,t],[e,e,e,e,e,t,t],[i,e,e,r,t,t,t]],0,[12,12],[0,0])}}]),n}(xie),Jae=function(){var e=dy(function e(){fy(this,e)});return e.CAPTURE_MUST_BE_ALIGNED=function(){return $localize(si||(si=Hg(["You can only capture when 4 or more of your pieces are aligned, and it is not the case."])))},e.INVALID_CAPTURED_PIECES=function(){return $localize(ui||(ui=Hg(["You must select a valid capture that contains 4 pieces or more."])))},e.MISSING_CAPTURES=function(){return $localize(ci||(ci=Hg(["There are still possible captures to be done."])))},e.PLACEMENT_NOT_ON_BORDER=function(){return $localize(li||(li=Hg(["Pieces must be inserted in spaces on the edge of the board."])))},e.INVALID_PLACEMENT_DIRECTION=function(){return $localize(fi||(fi=Hg(["You must select a valid placement direction."])))},e.PLACEMENT_WITHOUT_DIRECTION=function(){return $localize(hi||(hi=Hg(["You must select a placement with a direction alongside the insertion space."])))},e.PLACEMENT_ON_COMPLETE_LINE=function(){return $localize(di||(di=Hg(["You cannot place a piece on a complete line."])))},e.AMBIGUOUS_CAPTURE_COORD=function(){return $localize(vi||(vi=Hg(["This piece belongs to two captures. Please select another piece in the capture you'd like to make."])))},e.NO_DIRECTIONS_AVAILABLE=function(){return $localize(pi||(pi=Hg(["You cannot insert a piece here, as all lines are full. Select another space."])))},e}(),eoe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return new Xae(n.board,n.turn+1,n.sidePieces,n.capturedPieces)}},{key:"getPiecesMoved",value:function(e,t,r){var i=n.applyCaptures(t,e);if(r.direction.isAbsent())return[r.coord];var a=r.direction.get(),o=[];o.push(r.coord);for(var s=r.coord.getNext(a);i.isOnBoard(s)&&i.getPieceAt(s)!==vte.EMPTY;)o.push(s),s=s.getNext(a);return N7(i.isOnBoard(s)&&i.getPieceAt(s)===vte.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(s),o}},{key:"isLegal",value:function(e,t){var r=this.capturesValidity(t,e.initialCaptures);if(r.isFailure())return r.toFailedFallible();var i=n.applyCaptures(e.initialCaptures,t),a=this.noMoreCapturesValidity(i);if(a.isFailure())return a.toFailedFallible();var o=this.placementValidity(i,e.placement);if(o.isFailure())return o.toFailedFallible();var s=n.applyPlacement(e.placement,i),u=this.capturesValidity(s,e.finalCaptures);if(u.isFailure())return u.toFailedFallible();var c=n.applyCaptures(e.finalCaptures,s),l=this.noMoreCapturesValidity(c);return l.isFailure()?l.toFailedFallible():MB.success(c)}},{key:"capturesValidity",value:function(e,t){var r,i=e,a=uy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=this.captureValidity(i,o);if(s.isFailure())return s;i=n.applyCapture(o,i)}}catch(u){a.e(u)}finally{a.f()}return DB.SUCCESS}},{key:"captureValidity",value:function(e,t){var r=e.getCurrentPlayer(),i=n.getLinePortionWithFourPiecesOfPlayer(e,r,t.getLine());if(i.isAbsent())return DB.failure(Jae.CAPTURE_MUST_BE_ALIGNED());var a=i.get();return n.getCapturable(e,a).equals(t)?DB.SUCCESS:DB.failure(Jae.INVALID_CAPTURED_PIECES())}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===n.getLinePortionsWithFourPiecesOfPlayer(e,t).length?DB.SUCCESS:DB.failure(Jae.MISSING_CAPTURES())}},{key:"placementValidity",value:function(e,t){var r=this.placementCoordValidity(e,t.coord);if(r.isFailure())return r;if(e.getPieceAt(t.coord)!==vte.EMPTY){if(t.direction.isAbsent())return DB.failure(Jae.PLACEMENT_WITHOUT_DIRECTION());if(n.isLineComplete(e,t.coord,t.direction.get()))return DB.failure(Jae.PLACEMENT_ON_COMPLETE_LINE());var i,a=uy(n.getAllDirectionsForEntrance(e,t.coord));try{for(a.s();!(i=a.n()).done;){if(i.value===t.direction.get())return DB.SUCCESS}}catch(o){a.e(o)}finally{a.f()}return DB.failure(Jae.INVALID_PLACEMENT_DIRECTION())}return DB.SUCCESS}},{key:"placementCoordValidity",value:function(e,t){return kte.INSTANCE.isOnBorder(e,t)?DB.SUCCESS:DB.failure(Jae.PLACEMENT_NOT_ON_BORDER())}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getPlayerScore(t,Q7.ZERO),i=n.getPlayerScore(t,Q7.ONE);return r.isAbsent()?Lte.ONE_WON:i.isAbsent()?Lte.ZERO_WON:Lte.ONGOING}}],[{key:"applyCaptures",value:function(e,t){var r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=[t.sidePieces[0],t.sidePieces[1]],a=[t.capturedPieces[0],t.capturedPieces[1]];return e.forEach(function(e){var o=t.getPieceAt(e);r=r.setAt(e,vte.EMPTY),o.is(n)?i[n.value]+=1:a[n.value]+=1}),new Xae(r.board,t.turn,i,a)}},{key:"getPlacements",value:function(e){var t=[];return kte.INSTANCE.getAllBorders(e).forEach(function(r){e.getPieceAt(r)===vte.EMPTY?t.push(new Kae(r,RB.empty())):n.getAllDirectionsForEntrance(e,r).forEach(function(i){!1===n.isLineComplete(e,r,i)&&t.push(new Kae(r,RB.of(i)))})}),t}},{key:"isLineComplete",value:function(e,t,r){return n.nextGapInLine(e,t,r).isAbsent()}},{key:"nextGapInLine",value:function(e,t,n){for(var r=t;e.isOnBoard(r);r=r.getNext(n))if(e.getPieceAt(r)===vte.EMPTY)return RB.of(r);return RB.empty()}},{key:"applyPlacement",value:function(e,t){var n=t.getCurrentPlayer(),r=t,i=vte.ofPlayer(t.getCurrentPlayer());if(e.direction.isAbsent()){var a=e.coord;if(t.getPieceAt(a)!==vte.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");r=r.setAt(a,i)}else for(var o=e.coord;r.isOnBoard(o)&&i!==vte.EMPTY;o=o.getNext(e.direction.get())){var s=t.getPieceAt(o);r=r.setAt(o,i),i=s}var u=[t.sidePieces[0],t.sidePieces[1]];return u[n.value]-=1,new Xae(r.board,t.turn,u,t.capturedPieces)}},{key:"getAllDirectionsForEntrance",value:function(e,t){if(kte.INSTANCE.isTopLeftCorner(e,t))return[pte.RIGHT,pte.DOWN,pte.UP_RIGHT];if(kte.INSTANCE.isTopCorner(e,t))return[pte.DOWN,pte.DOWN_LEFT,pte.RIGHT];if(kte.INSTANCE.isTopRightCorner(e,t))return[pte.DOWN_LEFT,pte.DOWN,pte.LEFT];if(kte.INSTANCE.isBottomLeftCorner(e,t))return[pte.UP_RIGHT,pte.UP,pte.RIGHT];if(kte.INSTANCE.isBottomCorner(e,t))return[pte.UP,pte.LEFT,pte.UP_RIGHT];if(kte.INSTANCE.isBottomRightCorner(e,t))return[pte.LEFT,pte.UP,pte.DOWN_LEFT];if(kte.INSTANCE.isOnTopLeftBorder(e,t))return[pte.RIGHT,pte.DOWN];if(kte.INSTANCE.isOnLeftBorder(e,t))return[pte.UP_RIGHT,pte.RIGHT];if(kte.INSTANCE.isOnBottomLeftBorder(e,t))return[pte.UP,pte.UP_RIGHT];if(kte.INSTANCE.isOnBottomRightBorder(e,t))return[pte.LEFT,pte.UP];if(kte.INSTANCE.isOnRightBorder(e,t))return[pte.LEFT,pte.DOWN_LEFT];if(kte.INSTANCE.isOnTopRightBorder(e,t))return[pte.DOWN_LEFT,pte.DOWN];throw new Error("not a border")}},{key:"getLinePortionsWithFourPiecesOfPlayer",value:function(e,t){var r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithFourPiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithFourPiecesOfPlayer",value:function(e,t,n){for(var r=0,i=e.getEntranceOnLine(n),a=n.getDirection(),o=i,s=i;e.isOnBoard(s);s=s.getNext(a))if(e.getPieceAt(s).is(t)?(0===r&&(o=s),r+=1):r=0,4===r)return RB.of({0:o,1:s,2:a});return RB.empty()}},{key:"getCapturable",value:function(e,t){for(var n=[],r=t[0],i=t[1],a=t[2],o=a.getOpposite(),s=r.getNext(o);e.isOnBoard(s)&&e.getPieceAt(s)!==vte.EMPTY;)n.push(s),s=s.getNext(o);for(var u=r;!u.equals(i);u=u.getNext(a))n.push(u);for(var c=i;e.isOnBoard(c)&&e.getPieceAt(c)!==vte.EMPTY;c=c.getNext(a))n.push(c);return new Yae(n)}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),r=[];return n.getLinePortionsWithFourPiecesOfPlayer(e,t).forEach(function(t){r.push(n.getCapturable(e,t))}),r}},{key:"getPlayerScore",value:function(e,t){var r=e.getNumberOfPiecesToPlace(t);if(0===r&&0===n.getPossibleCaptures(e).length)return RB.empty();var i=e.getNumberOfPiecesCaptured(t);return RB.of(r+3*i)}},{key:"isGameOver",value:function(e){var t=n.getPlayerScore(e,Q7.ZERO),r=n.getPlayerScore(e,Q7.ONE);return t.isAbsent()||r.isAbsent()}}]),n}(Fte),toe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=e.gameState,n=eoe.getPlayerScore(t,Q7.ZERO),r=eoe.getPlayerScore(t,Q7.ONE);return n.isAbsent()?new _te(Q7.ONE.getVictoryValue()):r.isAbsent()?new _te(Q7.ZERO.getVictoryValue()):new _te(n.get()-r.get())}},{key:"getListMoves",value:function(e){return this.getListMoveFromState(e.gameState)}},{key:"getListMoveFromState",value:function(e){var t=this,n=[];return eoe.isGameOver(e)||this.getPossibleCaptureCombinations(e).forEach(function(r){var i=eoe.applyCaptures(r,e);eoe.getPlacements(i).forEach(function(e){var a=eoe.applyPlacement(e,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new Qae(e,r,t);n.push(i)})})}),n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=eoe.getPossibleCaptures(e);return n.getPossibleCaptureCombinationsFromPossibleCaptures(t)}}],[{key:"getPossibleCaptureCombinationsFromPossibleCaptures",value:function(e){var t=n.computeIntersections(e),r=[[]];return e.forEach(function(e,n){if(0===t[n].length)r.forEach(function(e){e.push(n)});else{var i,a=[],o=t[n].some(function(e){return e>n}),s=uy(r);try{for(s.s();!(i=s.n()).done;){var u=i.value;!0===u.some(function(e){return t[n].some(function(t){return e===t})})?a.push(t9.copyImmutableArray(u)):o?(a.push(t9.copyImmutableArray(u)),u.push(n),a.push(t9.copyImmutableArray(u))):(u.push(n),a.push(t9.copyImmutableArray(u)))}}catch(c){s.e(c)}finally{s.f()}r=a}}),r.map(function(t){return t.map(function(t){return e[t]})})}},{key:"computeIntersections",value:function(e){var t=[];return e.forEach(function(n,r){t.push([]),e.forEach(function(e,i){r!==i&&n.intersectsWith(e)&&t[r].push(i)})}),t}}]),n}(wte),noe=dy(function e(t,n,r,i,a,o){fy(this,e),this.source=t,this.destination=n,this.x1=r,this.y1=i,this.x2=a,this.y2=o}),roe=vte.UNREACHABLE,ioe=vte.EMPTY,aoe=vte.ZERO,ooe=vte.ONE,soe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(gi||(gi=Hg(["Goal of the game"]))),$localize(yi||(yi=Hg(["The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.\n        This is the initial board.\n        Each player has 12 pieces on the side and 3 pieces on the board.\n        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.\n        The first player plays with the dark pieces, the second player plays with the light pieces."]))),Xae.getInitialState()),zte.anyMove($localize(mi||(mi=Hg(["Pushing"]))),$localize(ki||(ki=Hg(["Pieces can only enter the board through the edges. To insert a new piece:\n        <ol>\n            <li>Click on a space on the edge of the board.</li>\n            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>\n        </ol>\n        You cannot push when a line is full.<br/><br/>\n        You're playing Dark, insert a piece."]))),Xae.getInitialState(),new Qae(new Kae(new fte(3,0),RB.of(pte.DOWN)),[],[]),$localize(Ci||(Ci=Hg(["Congratulations!"])))),zte.fromMove($localize(wi||(wi=Hg(["Capture (1/3)"]))),$localize(_i||(_i=Hg(["To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.\n        There are multiple important aspects of a capture:\n        <ol>\n            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>\n            <li>As soon as there is an empty space on the line, the capture stops.</li>\n            <li>Your own pieces that are captured go back to your stock.\n                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>\n            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.\n                This means that a turn happens in three phases:\n                <ol type=\"A\">\n                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>\n                    <li>Make your insertion.</li>\n                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>\n                </ol>\n            </li>\n        </ol><br/>\n        You're playing Dark, you can make a capture, do it."]))),new Xae([[roe,roe,roe,aoe,ooe,ioe,ioe],[roe,roe,ioe,ioe,ioe,ioe,ioe],[roe,ioe,ioe,ioe,ioe,ioe,ioe],[aoe,aoe,aoe,ioe,ioe,ioe,ioe],[ooe,ioe,ioe,ioe,ioe,ioe,roe],[ioe,ioe,ioe,ooe,ioe,roe,roe],[ioe,ioe,ioe,ooe,roe,roe,roe]],42,[8,8],[0,0]),[new Qae(new Kae(new fte(0,3),RB.of(pte.RIGHT)),[],[new Yae([new fte(0,3),new fte(1,3),new fte(2,3),new fte(3,3)])])],$localize(Ei||(Ei=Hg(["Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.\n        Let's now see how captures can really be useful."]))),$localize(bi||(bi=Hg(["Failed!"])))),zte.fromMove($localize(Si||(Si=Hg(["Capture (2/3)"]))),$localize(Pi||(Pi=Hg(["Here, there are three different ways of capturing.\n        <ol>\n          <li>One way does not capture any of your opponent's pieces.</li>\n          <li>Another way captures one of your opponent's pieces.</li>\n          <li>The last way captures two of your opponent's pieces.</li>\n        </ol>\n        <br/><br/>\n        Pick the last one."]))),new Xae([[roe,roe,roe,ioe,ioe,ioe,ioe],[roe,roe,ioe,ooe,ioe,ioe,ioe],[roe,ioe,ioe,aoe,ioe,ioe,ioe],[aoe,aoe,aoe,ooe,ioe,ioe,ioe],[ioe,ioe,ioe,aoe,ioe,ioe,roe],[ioe,ioe,ioe,aoe,ioe,roe,roe],[ioe,ioe,ioe,ooe,roe,roe,roe]],42,[8,4],[2,3]),[new Qae(new Kae(new fte(0,3),RB.of(pte.RIGHT)),[],[new Yae([new fte(3,1),new fte(3,2),new fte(3,3),new fte(3,4),new fte(3,5),new fte(3,6)])])],$localize(Oi||(Oi=Hg(["Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.\n        The most you can get is 3 per capture."]))),$localize(Ti||(Ti=Hg(["Failed, the best capture was taking 2 of your opponent's pieces"])))),zte.fromMove($localize(Ii||(Ii=Hg(["Capture (3/3)"]))),$localize(Ai||(Ai=Hg(["Here, you must capture at the beginning of your turn.\n        This is due to a move of your opponent at the previous turn\n        (even though this is a fictitious board for pedagogical purpose).\n        After your capture, by performing the right move you can even capture two more of your opponent's pieces!\n        Keep it mind that the most useful in a capture is to take your opponent's pieces."]))),new Xae([[roe,roe,roe,aoe,ioe,ioe,aoe],[roe,roe,ioe,aoe,ioe,ioe,aoe],[roe,aoe,aoe,ioe,aoe,ooe,aoe],[ioe,ioe,ioe,aoe,ioe,ioe,aoe],[ioe,ioe,ioe,aoe,ioe,ioe,roe],[aoe,aoe,aoe,ooe,ooe,roe,roe],[ioe,ioe,ioe,aoe,roe,roe,roe]],42,[8,4],[2,3]),[new Qae(new Kae(new fte(3,6),RB.of(pte.UP)),[new Yae([new fte(6,0),new fte(6,1),new fte(6,2),new fte(6,3)])],[new Yae([new fte(0,5),new fte(1,5),new fte(2,5),new fte(3,5),new fte(4,5)]),new Yae([new fte(1,2),new fte(2,2),new fte(3,2),new fte(4,2),new fte(5,2)])]),new Qae(new Kae(new fte(4,6),RB.of(pte.UP)),[new Yae([new fte(6,0),new fte(6,1),new fte(6,2),new fte(6,3)])],[new Yae([new fte(0,5),new fte(1,5),new fte(2,5),new fte(3,5),new fte(4,5)]),new Yae([new fte(3,0),new fte(3,1),new fte(3,2),new fte(3,3),new fte(3,4)])]),new Qae(new Kae(new fte(3,6),RB.of(pte.UP)),[new Yae([new fte(6,0),new fte(6,1),new fte(6,2),new fte(6,3)])],[new Yae([new fte(1,2),new fte(2,2),new fte(3,2),new fte(4,2),new fte(5,2)]),new Yae([new fte(0,5),new fte(1,5),new fte(2,5),new fte(3,5),new fte(4,5)])])],$localize(Ri||(Ri=Hg(["Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces."]))),$localize(Mi||(Mi=Hg(["Failed, the best capture takes 2 of your opponent's pieces."]))))]});function uoe(e,t){if(1&e&&(IC(),_S(0,"circle",13)),2&e){var n=RS().$implicit,r=RS();mS("ngClass",r.getPieceClass(n)),lS("cx",r.getCenterAt(n).x)("cy",r.getCenterAt(n).y)("r",r.SPACE_SIZE)}}function coe(e,t){if(1&e){var n=SS();IC(),CS(0,"g",10),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e)}),_S(1,"polygon",11),pS(2,uoe,1,4,"circle",12),wS()}if(2&e){var r=t.$implicit,i=RS();NS("id","click_",r.x,"_",r.y,""),DE(1),NS("id","space_",r.x,"_",r.y,""),mS("ngClass",i.getSpaceClass(r)),lS("points",i.getHexaCoordsAt(r)),DE(1),mS("ngIf",i.isPiece(r))}}function loe(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",16),TS("click",function(){var e=eC(n).$implicit;return RS(2).onClick(e)}),wS()}if(2&e){var r=t.$implicit;lS("points",RS(2).getHexaCoordsAt(r))}}function foe(e,t){if(1&e&&(IC(),CS(0,"g",14),pS(1,loe,1,1,"polygon",15),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n.capturedSpaces)}}function hoe(e,t){if(1&e){var n=SS();IC(),CS(0,"line",17),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e.destination)}),wS()}if(2&e){var r=t.$implicit;lS("x1",r.x1)("y1",r.y1)("x2",r.x2)("y2",r.y2)}}function doe(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"circle",18),wS()),2&e){var n=t.$implicit,r=RS().$implicit,i=RS();DE(1),NS("id","piece_",r.value,"_",n,""),mS("ngClass",i.getPlayerClass(r)),lS("cx",i.getRemainingPieceCx(r,n))("cy",i.getRemainingPieceCy(r))("r",.5*i.SPACE_SIZE)}}function voe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,doe,2,6,"g",8),wS()),2&e){var n=t.$implicit,r=RS();DE(1),mS("ngForOf",r.getPlayerSidePieces(n))}}function poe(e,t){if(1&e&&(IC(),_S(0,"line",19)),2&e){var n=RS();lS("x1",n.inserted.get().x1)("y1",n.inserted.get().y1)("x2",n.inserted.get().x2)("y2",n.inserted.get().y2)}}var goe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).inserted=RB.empty(),r.arrows=[],r.captured=[],r.moved=[],r.HEXAGON_WIDTH=r.SPACE_SIZE,r.SHARED_HEXAGON_X=Math.cos(30)*r.HEXAGON_WIDTH*.5,r.BOARD_WIDTH=r.HEXAGON_WIDTH+6*(r.HEXAGON_WIDTH-r.SHARED_HEXAGON_X)+3*r.STROKE_WIDTH/2,r.BOARD_HEIGHT=7*r.HEXAGON_WIDTH+4.5*r.STROKE_WIDTH,r.movePhase=n.PHASE_PLACEMENT_COORD,r.possibleCaptures=[],r.initialCaptures=[],r.placement=RB.empty(),r.placementEntrance=RB.empty(),r.finalCaptures=[],r.hasAsymetricBoard=!0,r.scores=RB.of([0,0]),r.rules=new eoe(Xae),r.availableMinimaxes=[new toe(r.rules,"GipfMinimax")],r.encoder=Qae.encoder,r.tutorial=(new soe).tutorial,r.SPACE_SIZE=40,r.constructedState=r.rules.node.gameState,r.hexaLayout=new gte(1.5*r.SPACE_SIZE,new fte(r.HEXAGON_WIDTH/2+3*r.STROKE_WIDTH/4,-r.HEXAGON_WIDTH),kte.INSTANCE),r}return dy(n,[{key:"updateBoard",value:function(){this.showLastMove(),this.cancelMoveAttempt()}},{key:"showLastMove",value:function(){this.inserted=RB.empty();var e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){var t=e.get().placement;this.inserted=RB.of(this.arrowTowards(t.coord,t.direction.get()))}this.cancelMoveAttempt()}},{key:"arrowTowards",value:function(e,t){var n=e.getNext(t.getOpposite()),r=this.getCenterAt(e),i=this.getCenterAt(n);return new noe(n,e,i.x,i.y,r.x,r.y)}},{key:"markCapture",value:function(e){var t=this;e.forEach(function(e){t.captured.push(e)})}},{key:"getAllCoords",value:function(){return this.constructedState.allCoords()}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.constructedState.getNumberOfPiecesToPlace(e),n=[],r=0;r<t;r+=1)n.push(r);return n}},{key:"isPiece",value:function(e){return this.getPiece(e)!==vte.EMPTY}},{key:"getPiece",value:function(e){return this.constructedState.getPieceAt(e)}},{key:"onClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){r.next=3;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 3:r.t0=t.movePhase,r.next=r.t0===n.PHASE_INITIAL_CAPTURE||r.t0===n.PHASE_FINAL_CAPTURE?6:r.t0===n.PHASE_PLACEMENT_COORD?7:8;break;case 6:return r.abrupt("return",t.selectCapture(e));case 7:return r.abrupt("return",t.selectPlacementCoord(e));case 8:return r.abrupt("return",(PB.expectToBe(t.movePhase,n.PHASE_PLACEMENT_DIRECTION),t.selectPlacementDirectionOrPlacementCoord(e)));case 9:case"end":return r.stop()}},r)}))()}},{key:"selectCapture",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&i.push(t)}),!(i.length>1)){r.next=3;break}return r.abrupt("return",t.cancelMove(Jae.AMBIGUOUS_CAPTURE_COORD()));case 3:if(0!==i.length){r.next=5;break}return r.abrupt("return",t.cancelMove(Jae.MISSING_CAPTURES()));case 5:return a=i[0],r.abrupt("return",(t.constructedState=eoe.applyCapture(a,t.constructedState),t.markCapture(a),t.possibleCaptures=eoe.getPossibleCaptures(t.constructedState),t.movePhase===n.PHASE_INITIAL_CAPTURE?(t.initialCaptures.push(a),0===t.possibleCaptures.length?t.moveToPlacementPhase():DB.SUCCESS):(PB.expectToBe(t.movePhase,n.PHASE_FINAL_CAPTURE),t.finalCaptures.push(a),0===t.possibleCaptures.length?t.tryMove(t.initialCaptures,t.placement.get(),t.finalCaptures):DB.SUCCESS)));case 7:case"end":return r.stop()}},r)}))()}},{key:"moveToPlacementPhase",value:function(){return this.movePhase=n.PHASE_PLACEMENT_COORD,DB.SUCCESS}},{key:"moveToInitialCaptureOrPlacementPhase",value:function(){return this.possibleCaptures=eoe.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,DB.SUCCESS}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=eoe.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,DB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}},{key:"computeArrows",value:function(e){this.arrows=[];var t,n=uy(eoe.getAllDirectionsForEntrance(this.constructedState,e));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(!1===eoe.isLineComplete(this.constructedState,e,r)){var i=e.getNext(r),a=this.getCenterAt(e),o=this.getCenterAt(i);this.arrows.push(new noe(e,i,a.x,a.y,o.x,o.y))}}}catch(s){n.e(s)}finally{n.f()}}},{key:"selectPlacementCoord",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=t.rules.placementCoordValidity(t.constructedState,e),r.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.placementEntrance.equalsValue(e)?(t.cancelMoveAttempt(),DB.SUCCESS):(t.placementEntrance=RB.of(e),t.constructedState.getPieceAt(e)===vte.EMPTY?t.selectPlacementDirection(RB.empty()):(t.movePhase=n.PHASE_PLACEMENT_DIRECTION,t.computeArrows(e),0===t.arrows.length&&t.cancelMove(Jae.NO_DIRECTIONS_AVAILABLE()),DB.SUCCESS)));case 2:case"end":return r.stop()}},r)}))()}},{key:"selectPlacementDirection",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.placement=RB.of(new Kae(t.placementEntrance.get(),e)),r=t.rules.placementValidity(t.constructedState,t.placement.get()),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.arrows=[],t.constructedState=eoe.applyPlacement(t.placement.get(),t.constructedState),t.moveToFinalCapturePhaseOrTryMove()));case 3:case"end":return n.stop()}},n)}))()}},{key:"selectPlacementDirectionOrPlacementCoord",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!1!==(r=t.placementEntrance.get()).isAlignedWith(e)&&1===r.getDistance(e)){n.next=3;break}return n.abrupt("return",t.selectPlacementCoord(e));case 3:return i=pte.factory.fromMove(r,e),n.abrupt("return",t.selectPlacementDirection(i.toOptional()));case 5:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=new Qae(t,e,n),i.next=3,r.chooseMove(a,r.rules.node.gameState,r.scores.get());case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},i)}))()}},{key:"cancelMoveAttempt",value:function(){var e=this;this.constructedState=this.rules.node.gameState,this.captured=[],this.moved=[];var t=this.rules.node.move;if(t.isPresent()){var n=t.get(),r=this.rules.node.mother.get().gameState;n.initialCaptures.forEach(function(t){return e.markCapture(t)}),n.finalCaptures.forEach(function(t){return e.markCapture(t)}),this.moved=this.rules.getPiecesMoved(r,n.initialCaptures,n.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=RB.empty(),this.placement=RB.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}},{key:"getSpaceClass",value:function(e){return this.captured.some(function(t){return t.equals(e)})?"captured":this.moved.some(function(t){return t.equals(e)})?"moved":""}},{key:"getPieceClass",value:function(e){var t=this.getPiece(e);return this.getPlayerClass(Q7.of(t.value))}},{key:"getRemainingPieceCy",value:function(e){return e===Q7.ONE?25:this.BOARD_HEIGHT-25}},{key:"getRemainingPieceCx",value:function(e,t){var n=20+t*this.SPACE_SIZE*.5;return e===Q7.ONE?n:this.BOARD_WIDTH-(15+n)}}]),n}(dte);return e.PHASE_INITIAL_CAPTURE=0,e.PHASE_PLACEMENT_COORD=1,e.PHASE_PLACEMENT_DIRECTION=2,e.PHASE_FINAL_CAPTURE=3,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-gipf"]],features:[Qb],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"defs"),CS(2,"marker",1),_S(3,"polygon",2),wS(),CS(4,"marker",3),_S(5,"polygon",4),wS(),wS(),pS(6,coe,3,7,"g",5),pS(7,foe,2,1,"g",6),pS(8,hoe,1,4,"line",7),pS(9,voe,2,1,"g",8),pS(10,poe,1,4,"line",9),wS()),2&e&&(lS("viewBox",-t.STROKE_WIDTH+" 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),DE(6),mS("ngForOf",t.getAllCoords()),DE(1),mS("ngForOf",t.possibleCaptures),DE(1),mS("ngForOf",t.arrows),DE(1),mS("ngForOf",t.Player.PLAYERS),DE(1),mS("ngIf",t.inserted.isPresent()))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),yoe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"equals",value:function(e){return this===e||this.coord.equals(e.coord)}},{key:"toString",value:function(){return this===n.PASS?"GoMove.PASS":this===n.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Ite);yoe.PASS=new yoe(-1,0),yoe.ACCEPT=new yoe(-2,0),yoe.PASS_NUMBER=-1,yoe.ACCEPT_NUMBER=-2,yoe.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 360}},{key:"encodeNumber",value:function(e){return 19*e.coord.y+e.coord.x}},{key:"decodeNumber",value:function(e){if(e===yoe.PASS_NUMBER)return yoe.PASS;var t=e%19;return new yoe(t,(e-t)/19)}}]),n}(j7));var moe=function(){function e(t,n){fy(this,e),this.player=t,this.type=n}return dy(e,[{key:"equals",value:function(e){return e===this}},{key:"toString",value:function(){switch(this){case e.DARK:return"GoPiece.DARK";case e.LIGHT:return"GoPiece.LIGHT";case e.EMPTY:return"GoPiece.EMPTY";case e.DEAD_DARK:return"GoPiece.DEAD_DARK";case e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return N7(this===e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}},{key:"isOccupied",value:function(){return[e.DARK,e.LIGHT,e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isEmpty",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY,e.EMPTY].includes(this)}},{key:"isDead",value:function(){return[e.DEAD_DARK,e.DEAD_LIGHT].includes(this)}},{key:"isTerritory",value:function(){return[e.DARK_TERRITORY,e.LIGHT_TERRITORY].includes(this)}},{key:"getOwner",value:function(){return this.player}},{key:"nonTerritory",value:function(){return N7(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),e.EMPTY}}],[{key:"pieceBelongTo",value:function(e,t){return t===e.player&&"territory"!==e.type}},{key:"ofPlayer",value:function(t){return t===Q7.ZERO?e.DARK:e.LIGHT}}]),e}();moe.DARK=new moe(Q7.ZERO,"alive"),moe.LIGHT=new moe(Q7.ONE,"alive"),moe.EMPTY=new moe(K7.NONE,"empty"),moe.DEAD_DARK=new moe(Q7.ZERO,"dead"),moe.DEAD_LIGHT=new moe(Q7.ONE,"dead"),moe.DARK_TERRITORY=new moe(K7.NONE,"territory"),moe.LIGHT_TERRITORY=new moe(K7.NONE,"territory");var koe=(function(e){e.PLAYING="PLAYING",e.PASSED="PASSED",e.COUNTING="COUNTING",e.ACCEPT="ACCEPT",e.FINISHED="FINISHED"}(koe||(koe={})),koe),Coe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;return fy(this,n),(s=t.call(this,e,i)).captured=r,s.koCoord=a,s.phase=o,s}return dy(n,[{key:"getCapturedCopy",value:function(){return[this.captured[0],this.captured[1]]}},{key:"copy",value:function(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}},{key:"isDead",value:function(e){return this.getPieceAt(e).isDead()}},{key:"isTerritory",value:function(e){return this.getPieceAt(e).isTerritory()}}],[{key:"getInitialState",value:function(){var e=n.getStartingBoard();return new n(e,[0,0],0,RB.empty(),koe.PLAYING)}},{key:"getStartingBoard",value:function(){return t9.createTable(n.WIDTH,n.HEIGHT,moe.EMPTY)}}]),n}(Pte);return e.WIDTH=13,e.HEIGHT=13,e}(),woe=function(){var e=function(){function e(t){fy(this,e),this.color=t}return dy(e,[{key:"selfContains",value:function(e){return this.getCoords().some(function(t){return t.equals(e)})}}],[{key:"insertAsEntryPoint",value:function(e,t){return 0===e.length?[t]:t.compareTo(e[0])<0?[t].concat(e):e.concat([t])}}]),e}();return e.VERBOSE=!1,e}(),_oe=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e)).emptyCoords=r,u.darkCoords=i,u.lightCoords=a,u.deadDarkCoords=o,u.deadLightCoords=s,u}return dy(n,[{key:"getCoords",value:function(){return this.color===moe.DARK?this.darkCoords:this.color===moe.LIGHT?this.lightCoords:this.color===moe.DEAD_DARK?this.deadDarkCoords:this.color===moe.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}},{key:"contains",value:function(e){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(function(t){return t.equals(e)})}},{key:"addPawn",value:function(e,t){switch(N7(!1===this.contains(e),"This group already contains "+e.toString()),t){case moe.DARK:this.darkCoords=woe.insertAsEntryPoint(this.darkCoords,e);break;case moe.LIGHT:this.lightCoords=woe.insertAsEntryPoint(this.lightCoords,e);break;case moe.DEAD_DARK:this.deadDarkCoords=woe.insertAsEntryPoint(this.deadDarkCoords,e);break;case moe.DEAD_LIGHT:this.deadLightCoords=woe.insertAsEntryPoint(this.deadLightCoords,e);break;default:PB.expectToBeMultiple(t,[moe.EMPTY,moe.DARK_TERRITORY,moe.LIGHT_TERRITORY]),this.emptyCoords=woe.insertAsEntryPoint(this.emptyCoords,e)}}},{key:"isMonoWrapped",value:function(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}},{key:"getWrapper",value:function(){var e=new Mte;e.set(moe.EMPTY,this.emptyCoords.length),e.set(moe.DARK,this.darkCoords.length+this.deadLightCoords.length),e.set(moe.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),e.put(this.color.nonTerritory(),0);var t=e.filter(function(e,t){return t>0});if(1===t.size())return t.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}},{key:"getNeighborsEntryPoints",value:function(){var e=[];return this.color!==moe.EMPTY&&this.emptyCoords.length>0&&e.push(this.emptyCoords[0]),this.color!==moe.DARK&&this.darkCoords.length>0&&e.push(this.darkCoords[0]),this.color!==moe.LIGHT&&this.lightCoords.length>0&&e.push(this.lightCoords[0]),this.color!==moe.DEAD_DARK&&this.deadDarkCoords.length>0&&e.push(this.deadDarkCoords[0]),this.color!==moe.DEAD_LIGHT&&this.deadLightCoords.length>0&&e.push(this.deadLightCoords[0]),e}}]),n}(woe),Eoe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getNewInstance",value:function(e){return new _oe(e,[],[],[],[],[])}},{key:"getDirections",value:function(){return cte.ORTHOGONALS}}]),n}(function(){function e(){fy(this,e)}return dy(e,[{key:"getGroupDatas",value:function(e,t){OB(woe.VERBOSE,"GroupDatas.getGroupDatas("+e+", "+t+")");var n=this.getNewInstance(t[e.y][e.x]);return this._getGroupDatas(e,t,n)}},{key:"_getGroupDatas",value:function(e,t,n){OB(woe.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:n,coord:e}});var r=t[e.y][e.x];if(n.addPawn(e,r),r===n.color){var i,a=uy(this.getDirections());try{for(a.s();!(i=a.n()).done;){var o=i.value,s=e.getNext(o);s.isInRange(t[0].length,t.length)&&(n.contains(s)||(n=this._getGroupDatas(s,t,n)))}}catch(u){a.e(u)}finally{a.f()}}return n}}]),e}()),boe=function(){var e=dy(function e(){fy(this,e)});return e.ILLEGAL_KO=function(){return $localize(xi||(xi=Hg(["This move is a ko, you must play somewhere else before you can play in this intersection again."])))},e.CANNOT_PASS_AFTER_PASSED_PHASE=function(){return $localize(Ni||(Ni=Hg(["We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn."])))},e.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=function(){return $localize(Di||(Di=Hg(["You cannot accept before the counting phase."])))},e.OCCUPIED_INTERSECTION=function(){return $localize(Li||(Li=Hg(["This intersection is already occupied."])))},e.CANNOT_COMMIT_SUICIDE=function(){return $localize(Fi||(Fi=Hg(["You cannot commit suicide."])))},e}(),Soe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"applyLegalMove",value:function(e,t,r){return OB(n.VERBOSE,{applyLegalMove:{legalMove:e,state:t,status:r}}),n.isPass(e)?(OB(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(t)):n.isAccept(e)?(OB(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(t)):n.isLegalDeadMarking(e,t)?(OB(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,t)):(OB(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,t,r))}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"isLegal",value:function(e,t){var r=!1;if(OB(n.VERBOSE||r,{isLegal:{move:e,state:t}}),n.isPass(e)){var i=t.phase===koe.PLAYING,a=t.phase===koe.PASSED;return OB(n.VERBOSE||r,"GoRules.isLegal at "+t.phase+(i||a?" forbid":" allowed")+" passing on "+t.getCopiedBoard()),i||a?MB.success([]):MB.failure(boe.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){var o=t.phase===koe.ACCEPT;return t.phase===koe.COUNTING||o?MB.success([]):MB.failure(boe.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,t.getCopiedBoard())?(OB(n.VERBOSE||r,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,t)?MB.success([]):MB.failure(boe.OCCUPIED_INTERSECTION())):(OB(n.VERBOSE||r,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,t))}},{key:"getNewKo",value:function(e,t,n){if(1===n.length){var r=n[0],i=e.coord,a=t[i.y][i.x],o=(new Eoe).getGroupDatas(i,t),s=o.emptyCoords,u=moe.pieceBelongTo(a,Q7.ZERO)?o.darkCoords:o.lightCoords;if(1===s.length&&s[0].equals(r)&&1===u.length)return RB.of(r)}return RB.empty()}},{key:"markTerritoryAndCount",value:function(e){OB(n.VERBOSE,{markTerritoryAndCount:{state:e}});var t,r=e.getCopiedBoard(),i=n.getTerritoryLikeGroup(e),a=e.getCapturedCopy(),o=uy(i);try{for(o.s();!(t=o.n()).done;){var s=t.value,u=s.getWrapper();if(u===moe.LIGHT){a[1]+=s.emptyCoords.length;var c,l=uy(s.getCoords());try{for(l.s();!(c=l.n()).done;){var f=c.value;r[f.y][f.x]=moe.LIGHT_TERRITORY}}catch(p){l.e(p)}finally{l.f()}}else{N7(u===moe.DARK,"territory should be wrapped by dark or light, not by "+u.toString()),a[0]+=s.emptyCoords.length;var h,d=uy(s.getCoords());try{for(d.s();!(h=d.n()).done;){var v=h.value;r[v.y][v.x]=moe.DARK_TERRITORY}}catch(p){d.e(p)}finally{d.f()}}}}catch(p){o.e(p)}finally{o.f()}return new Coe(r,a,e.turn,e.koCoord,e.phase)}},{key:"removeAndSubstractTerritory",value:function(e){for(var t,n=e.getCopiedBoard(),r=e.getCapturedCopy(),i=0;i<e.board.length;i++)for(var a=0;a<e.board[0].length;a++)(t=n[i][a])===moe.DARK_TERRITORY?(n[i][a]=moe.EMPTY,r[0]=r[0]-1):t===moe.LIGHT_TERRITORY&&(n[i][a]=moe.EMPTY,r[1]=r[1]-1);return new Coe(n,r,e.turn,e.koCoord,e.phase)}},{key:"getEmptyZones",value:function(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),function(e){return e.isEmpty()})}},{key:"getGroupsDatasWhere",value:function(e,t){for(var n,r,i=[],a=new Eoe,o=0;o<e.length;o++)for(var s=0;s<e[0].length;s++)n=new fte(s,o),t(e[o][s])&&(i.some(function(e){return e.selfContains(n)})||(r=a.getGroupDatas(n,e),i.push(r)));return i}},{key:"addDeadToScore",value:function(e){for(var t,n=e.getCapturedCopy(),r=n[1],i=n[0],a=0;a<e.board.length;a++)for(var o=0;o<e.board[0].length;o++)(t=e.getPieceAtXY(o,a))===moe.DEAD_DARK?r++:t===moe.DEAD_LIGHT&&i++;return[i,r]}},{key:"switchAliveness",value:function(e,t){var n=t.getCopiedBoard();N7(!1===n[e.y][e.x].isEmpty(),"Can't switch emptyness aliveness");var r=(new Eoe).getGroupDatas(e,n),i=t.getCapturedCopy();switch(r.color){case moe.DEAD_DARK:i[1]-=2*r.deadDarkCoords.length;var a,o=uy(r.deadDarkCoords);try{for(o.s();!(a=o.n()).done;){var s=a.value;n[s.y][s.x]=moe.DARK}}catch(y){o.e(y)}finally{o.f()}break;case moe.DEAD_LIGHT:i[0]-=2*r.deadLightCoords.length;var u,c=uy(r.deadLightCoords);try{for(c.s();!(u=c.n()).done;){var l=u.value;n[l.y][l.x]=moe.LIGHT}}catch(y){c.e(y)}finally{c.f()}break;case moe.LIGHT:i[0]+=2*r.lightCoords.length;var f,h=uy(r.lightCoords);try{for(h.s();!(f=h.n()).done;){var d=f.value;n[d.y][d.x]=moe.DEAD_LIGHT}}catch(y){h.e(y)}finally{h.f()}break;default:PB.expectToBe(r.color,moe.DARK),i[1]+=2*r.darkCoords.length;var v,p=uy(r.darkCoords);try{for(p.s();!(v=p.n()).done;){var g=v.value;n[g.y][g.x]=moe.DEAD_DARK}}catch(y){p.e(y)}finally{p.f()}}return new Coe(n,i,t.turn,t.koCoord,t.phase)}},{key:"getGameStatus",value:function(e){var t=e.gameState;return t.phase===koe.FINISHED?t.captured[0]>t.captured[1]?Lte.ZERO_WON:t.captured[1]>t.captured[0]?Lte.ONE_WON:Lte.DRAW:Lte.ONGOING}},{key:"isPass",value:function(e){return e.equals(yoe.PASS)}},{key:"isAccept",value:function(e){return e.equals(yoe.ACCEPT)}},{key:"isLegalDeadMarking",value:function(e,t){return n.isOccupied(e.coord,t.getCopiedBoard())&&(t.phase===koe.COUNTING||t.phase===koe.ACCEPT)}},{key:"isLegalNormalMove",value:function(e,t){var r=t.getCopiedBoard();if(n.isKo(e,t))return MB.failure(boe.ILLEGAL_KO());[koe.COUNTING,koe.ACCEPT].includes(t.phase)&&(t=n.resurrectStones(t));var i=n.getCaptureState(e,t);if(Poe.isCapturing(i))return MB.success(i.capturedCoords);r[e.coord.y][e.coord.x]=t.turn%2==0?moe.DARK:moe.LIGHT;var a=0===(new Eoe).getGroupDatas(e.coord,r).emptyCoords.length;return r[e.coord.y][e.coord.x]=moe.EMPTY,a?MB.failure(boe.CANNOT_COMMIT_SUICIDE()):MB.success([])}},{key:"isOccupied",value:function(e,t){return t[e.y][e.x].isOccupied()}},{key:"isKo",value:function(e,t){return!!t.koCoord.isPresent()&&e.coord.equals(t.koCoord.get())}},{key:"getCaptureState",value:function(e,t){OB(n.VERBOSE||!1,{getCaptureState:{move:e,state:t}});var r,i,a=new Poe,o=uy(cte.ORTHOGONALS);try{for(o.s();!(i=o.n()).done;){var s=i.value;(r=n.getCapturedInDirection(e.coord,s,t)).length>0&&a.capturedCoords.every(function(e){return!r[0].equals(e)})&&(a.capturedCoords=a.capturedCoords.concat(r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getCapturedInDirection",value:function(e,t,r){var i=r.getCopiedBoard(),a=e.getNext(t);if(a.isInRange(r.board[0].length,r.board.length)&&i[a.y][a.x]===(r.turn%2==0?moe.LIGHT:moe.DARK)){OB(n.VERBOSE||!1,"a group could be captured");var o=(new Eoe).getGroupDatas(a,i);if(n.isCapturableGroup(o,r.koCoord))return OB(n.VERBOSE||!1,{neightbooringGroupCoord:o.getCoords(),message:"is capturable"}),o.getCoords()}return[]}},{key:"isCapturableGroup",value:function(e,t){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===t.equalsValue(e.emptyCoords[0])}},{key:"getTerritoryLikeGroup",value:function(e){return n.getEmptyZones(e).filter(function(e){return e.isMonoWrapped()})}},{key:"applyPass",value:function(e){var t,r,i=e.getCopiedBoard(),a=e.getCapturedCopy(),o=e.turn;return e.phase===koe.PASSED?(t=koe.COUNTING,r=new Coe(i,a,o+1,RB.empty(),t),r=n.markTerritoryAndCount(r)):(N7(e.phase===koe.PLAYING,"Cannot pass in counting phase!"),t=koe.PASSED,r=new Coe(i,a,o+1,RB.empty(),t)),r}},{key:"applyLegalAccept",value:function(e){var t,n=e.getCopiedBoard();return t=e.phase===koe.COUNTING?koe.ACCEPT:koe.FINISHED,new Coe(n,e.getCapturedCopy(),e.turn+1,RB.empty(),t)}},{key:"applyNormalLegalMove",value:function(e,t,r){var i;OB(n.VERBOSE,{applyNormalLegal:{currentState:t,legalMove:e,status:status}}),i=[koe.COUNTING,koe.ACCEPT].includes(t.phase)?n.resurrectStones(t):t.copy();var a=e.coord.x,o=e.coord.y,s=i.getCopiedBoard(),u=i.turn,c=moe.ofPlayer(i.getCurrentPlayer()),l=u+1;s[o][a]=c;var f,h=uy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value;s[d.y][d.x]=moe.EMPTY}}catch(g){h.e(g)}finally{h.f()}var v=n.getNewKo(e,s,r),p=i.getCapturedCopy();return p[c.player.value]+=r.length,new Coe(s,p,l,v,koe.PLAYING)}},{key:"resurrectStones",value:function(e){for(var t=0;t<e.board.length;t++)for(var r=0;r<e.board[0].length;r++)e.getPieceAtXY(r,t).isDead()&&(e=n.switchAliveness(new fte(r,t),e));return n.removeAndSubstractTerritory(e)}},{key:"applyDeadMarkingMove",value:function(e,t){OB(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:t}});var r=n.removeAndSubstractTerritory(t),i=n.switchAliveness(e.coord,r),a=new Coe(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,RB.empty(),koe.COUNTING);return n.markTerritoryAndCount(a)}}]),n}(Fte);return e.VERBOSE=!1,e}(),Poe=function(){function e(){fy(this,e),this.capturedCoords=[]}return dy(e,null,[{key:"isCapturing",value:function(e){return e.capturedCoords.length>0}}]),e}(),Ooe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){OB(Soe.VERBOSE||!1,"GoRules.getListMoves");var t=e.gameState,n=this.getPlayingMovesList(t);if(t.phase===koe.PLAYING||t.phase===koe.PASSED)return n.push(yoe.PASS),n;OB(Soe.VERBOSE||!1,"GoRules.getListMoves in counting phase");var r=this.getCountingMovesList(t);return 0===r.length?[yoe.ACCEPT]:r}},{key:"getPlayingMovesList",value:function(e){for(var t,n=[],r=0;r<e.board.length;r++)for(var i=0;i<e.board[0].length;i++)t=new yoe(i,r),e.getPieceAt(t.coord)===moe.EMPTY&&Soe.isLegal(t,e).isSuccess()&&n.push(t);return n}},{key:"getCountingMovesList",value:function(e){var t,n=[],r=this.getCorrectBoard(e).getCopiedBoard(),i=uy(Soe.getGroupsDatasWhere(r,function(e){return e!==moe.EMPTY}));try{for(i.s();!(t=i.n()).done;){var a=t.value.getCoords()[0],o=r[a.y][a.x];if(e.getPieceAt(a)!==o){var s=new yoe(a.x,a.y);return n.push(s),n}}}catch(u){i.e(u)}finally{i.f()}return n}},{key:"getCorrectBoard",value:function(e){var t=this.mapBoard(e.getCopiedBoard(),function(e){return e===moe.DARK?moe.DEAD_DARK:e===moe.LIGHT?moe.DEAD_LIGHT:e.isTerritory()?moe.EMPTY:e}),n=new Coe(t,e.getCapturedCopy(),e.turn,e.koCoord,e.phase),r=Soe.getTerritoryLikeGroup(n);return this.setAliveUniqueWrapper(n,r)}},{key:"mapBoard",value:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[0].length;r++)e[n][r]=t(e[n][r]);return e}},{key:"setAliveUniqueWrapper",value:function(e,t){var n,r=e.copy(),i=uy(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=uy(o.deadDarkCoords.concat(o.deadLightCoords));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.isDead(u)&&(r=Soe.switchAliveness(u,r))}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Soe.getGameStatus(e);if(n.isEndGame)return new _te(n.toBoardValue());OB(Soe.VERBOSE||!1,"GoRules.getBoardValue");var r=Soe.markTerritoryAndCount(t),i=r.getCapturedCopy(),a=this.getDeadStones(r);return new _te(i[1]+2*a[0]-(i[0]+2*a[1]))}},{key:"getDeadStones",value:function(e){for(var t=[0,0],n=0;n<e.board.length;n++)for(var r=0;r<e.board[0].length;r++){var i=e.getPieceAtXY(r,n);"dead"===i.type&&(t[i.player.value]=t[i.player.value]+1)}return t}}]),n}(wte),Toe=moe.LIGHT,Ioe=moe.DARK,Aoe=moe.DEAD_LIGHT,Roe=moe.LIGHT_TERRITORY,Moe=moe.DARK_TERRITORY,xoe=moe.EMPTY,Noe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Ui||(Ui=Hg(["Preliminary information"]))),$localize(Vi||(Vi=Hg(["The game of Go is played on a board called a Goban, and the stones are placed on the intersections.\n        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.\n        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).\n        For this tutorial, we will use a smaller board for pedagogical purposes."]))),Coe.getInitialState()),zte.informational($localize(Bi||(Bi=Hg(["Goal of the game"]))),$localize(zi||(zi=Hg(["The goal of the game is to have the most points at the end of the game.\n        We call \"territories\" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.\n        Here, Dark has 9 territories on the left, and Light has 8 on the right.\n        The top part belongs to no one.\n        Each player's score at the end of the game is the sum of that player's territories and captures."]))),new Coe([[xoe,Ioe,xoe,xoe,Toe,Toe],[xoe,Ioe,xoe,xoe,Toe,xoe],[xoe,Ioe,Ioe,Toe,Toe,xoe],[xoe,xoe,Ioe,Toe,xoe,xoe],[xoe,xoe,Ioe,Toe,xoe,xoe],[xoe,xoe,Ioe,Toe,xoe,xoe]],[0,0],0,RB.empty(),koe.PLAYING)),zte.fromMove($localize(Hi||(Hi=Hg(["Simple capture"]))),$localize(Gi||(Gi=Hg(["An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).\n        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.\n        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>\n        The light piece only has one liberty left, play there."]))),new Coe([[xoe,xoe,xoe,xoe,xoe],[xoe,xoe,Ioe,xoe,xoe],[xoe,Ioe,Toe,xoe,xoe],[xoe,xoe,Ioe,xoe,xoe],[xoe,xoe,xoe,xoe,xoe]],[0,0],0,RB.empty(),koe.PLAYING),[new yoe(3,2)],$localize($i||($i=Hg(["Congratulations, you have earned one point."]))),$localize(Zi||(Zi=Hg(["Failed, try again by playing on one of the intersections directly next to the light stone."])))),zte.fromMove($localize(qi||(qi=Hg(["Capturing multiple stones"]))),$localize(Wi||(Wi=Hg(["Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>\n        The light group here only has one liberty left, capture it."]))),new Coe([[xoe,Ioe,xoe,xoe,xoe],[Ioe,Toe,xoe,xoe,xoe],[Ioe,Toe,Toe,Ioe,xoe],[xoe,Ioe,Ioe,xoe,xoe],[xoe,xoe,xoe,xoe,xoe]],[0,0],0,RB.empty(),koe.PLAYING),[new yoe(2,1)],$localize(ji||(ji=Hg(["Congratulations, you have earned three points and formed a territory."]))),$localize(Yi||(Yi=Hg(["Failed, you have not captured the group. Play on the last liberty of that group."])))),zte.informational($localize(Ki||(Ki=Hg(["Suicide"]))),$localize(Qi||(Qi=Hg(["In Go, suicide is forbidden.\n        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.\n        Here, the top left intersection is a suicide for Light.\n        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player."]))),new Coe([[xoe,Ioe,xoe,xoe,xoe],[Ioe,xoe,xoe,xoe,xoe],[Ioe,xoe,xoe,xoe,Toe],[Toe,Ioe,xoe,Toe,xoe],[xoe,Toe,xoe,Toe,Ioe]],[0,0],0,RB.empty(),koe.PLAYING)),zte.informational($localize(Xi||(Xi=Hg(["Life and death (death)"]))),$localize(Ji||(Ji=Hg(["From the capture rule follows the life and death notion:\n        dead stones are stones that are definitely capturable (without losing anything else).\n        Alive stones are stones that can never be captured.\n        From the capture rule, Dark can play inside Light's territory and make a capture.\n        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).\n        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories."]))),new Coe([[xoe,xoe,xoe,xoe,xoe],[Ioe,Ioe,Ioe,xoe,xoe],[Toe,Toe,Ioe,xoe,xoe],[xoe,Toe,Ioe,xoe,xoe],[Toe,Toe,Ioe,xoe,xoe]],[0,0],0,RB.empty(),koe.PLAYING)),zte.informational($localize(ea||(ea=Hg(["Life and death (eyes)"]))),$localize(ta||(ta=Hg(["Here, Light cannot play on the top left, nor on the bottom left.\n        Light will never be able to capture Dark.\n        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive."]))),new Coe([[xoe,Ioe,Toe,xoe,xoe],[Toe,Ioe,Toe,xoe,xoe],[Ioe,Ioe,Toe,xoe,xoe],[Toe,Ioe,Toe,xoe,xoe],[xoe,Ioe,Toe,xoe,xoe]],[0,0],0,RB.empty(),koe.PLAYING)),zte.informational($localize(na||(na=Hg(["Seki"]))),$localize(ra||(ra=Hg(["If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.\n        Similarly, if Light plays on the middle line, Dark will capture Light.\n        In other words, there is no point in playing on the middle line.\n        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral."]))),new Coe([[xoe,Toe,Ioe,xoe,Toe,Ioe,xoe],[xoe,Toe,Ioe,Ioe,Toe,Ioe,xoe],[xoe,Toe,Ioe,Ioe,Toe,Ioe,xoe],[xoe,Toe,Ioe,Ioe,Toe,Ioe,xoe],[xoe,Toe,Ioe,Toe,Toe,Ioe,xoe],[xoe,Toe,Ioe,Toe,Toe,Ioe,xoe],[xoe,Toe,Ioe,xoe,Toe,Ioe,xoe]],[0,0],0,RB.empty(),koe.PLAYING)),zte.fromMove($localize(ia||(ia=Hg(["Ko"]))),$localize(aa||(aa=Hg(["A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>\n        Capture the light stone."]))),new Coe([[xoe,xoe,xoe,xoe,xoe,xoe,xoe],[xoe,xoe,xoe,xoe,xoe,xoe,xoe],[xoe,xoe,xoe,Ioe,Toe,xoe,xoe],[xoe,xoe,Ioe,Toe,xoe,Toe,xoe],[xoe,xoe,xoe,Ioe,Toe,xoe,xoe],[xoe,xoe,xoe,xoe,xoe,xoe,xoe],[xoe,xoe,xoe,xoe,xoe,xoe,xoe]],[0,0],0,RB.empty(),koe.PLAYING),[new yoe(4,3)],$localize(oa||(oa=Hg(["Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.\n        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.\n        This rule is called the Ko.\n        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after."]))),$localize(sa||(sa=Hg(["Failed!"])))),zte.fromMove($localize(ua||(ua=Hg(["End of the game"]))),$localize(ca||(ca=Hg(["When a player feels that there is no advantage to putting a new stone, that player can pass a turn.\n        The game phase stops when both players pass consecutively, and we move on to the counting phase.\n        The dead groups are then marked by clicking on them.\n        Every intersection in a player's territory earns that player a point.\n        The winner is the one with most points.<br/><br/>\n        A last stone is dead, mark it."]))),new Coe([[Toe,Ioe,Ioe,Ioe,Ioe,Ioe,Moe,Moe,Moe],[Toe,Toe,Toe,Toe,Ioe,Ioe,Ioe,Moe,Moe],[Toe,Roe,Toe,Toe,Ioe,Aoe,Aoe,Ioe,Moe],[Ioe,Toe,Toe,Toe,Toe,Ioe,Moe,Moe,Moe],[xoe,Toe,Roe,Toe,Ioe,Ioe,Aoe,Ioe,Moe],[Toe,Roe,Toe,Toe,Ioe,Ioe,Ioe,Ioe,Ioe],[Toe,Toe,Ioe,Ioe,Ioe,Toe,Toe,Ioe,Toe],[Ioe,Ioe,Ioe,Toe,Toe,Toe,Roe,Toe,Toe],[Moe,Moe,Ioe,Ioe,Ioe,Toe,Toe,Roe,Roe]],[0,0],0,RB.empty(),koe.COUNTING),[new yoe(0,3)],$localize(la||(la=Hg(["Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.\n        The intersections where the prisoners are count as Dark's territory\n        Light has 8 territories and 1 prisoner.\n        The end result is therefore 18 - 9 for Dark."]))),$localize(fa||(fa=Hg(["Failed, try again."]))))]});function Doe(e,t){if(1&e&&(IC(),_S(0,"circle",10)),2&e){var n=RS(2).index,r=RS().index;lS("cx",25+50*n)("cy",25+50*r)("r",22)}}function Loe(e,t){if(1&e){var n=SS();IC(),CS(0,"line",11),TS("click",function(){eC(n);var e=RS(2).index,t=RS().index;return RS().onClick(e,t)}),wS()}if(2&e){var r=RS(2).index,i=RS().index;lS("x1",50*r)("y1",50*i)("x2",50+50*r)("y2",50+50*i)}}function Foe(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"circle",7),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().onClick(e,t)}),wS(),pS(2,Doe,1,3,"circle",8),pS(3,Loe,1,4,"line",9),wS()}if(2&e){var r=RS().index,i=RS().index,a=RS();DE(1),mS("ngClass",a.getSpaceClass(r,i)),lS("cx",25+50*r)("cy",25+50*i)("r",22),DE(1),mS("ngIf",a.isLastCase(r,i)),DE(1),mS("ngIf",a.isDead(r,i))}}function Uoe(e,t){if(1&e){var n=SS();IC(),CS(0,"circle",15),TS("click",function(){eC(n);var e=RS(2).index,t=RS().index;return RS().onClick(e,t)}),wS()}if(2&e){var r=RS(2),i=r.index,a=r.$implicit,o=RS().index,s=RS();lS("cx",25+50*i)("cy",25+50*o)("r",10)("class",a===s.GoPiece.LIGHT_TERRITORY?"player1":"player0")}}function Voe(e,t){if(1&e){var n=SS();IC(),CS(0,"rect",12),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().onClick(e,t)}),wS(),CS(1,"line",13),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().onClick(e,t)}),wS(),CS(2,"line",13),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().onClick(e,t)}),wS(),pS(3,Uoe,1,4,"circle",14)}if(2&e){var r=RS().index,i=RS().index,a=RS();NS("id","click_",r,"_",i,""),lS("x",50*r)("y",50*i),DE(1),lS("x1",50*r)("y1",25+50*i)("x2",50+50*r)("y2",25+50*i),DE(1),lS("x1",25+50*r)("y1",50*i)("x2",25+50*r)("y2",50+50*i),DE(1),mS("ngIf",a.isTerritory(r,i))}}function Boe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Foe,4,6,"g",5),pS(2,Voe,4,13,"ng-template",null,6,XT),wS()),2&e){var n=t.index,r=gS(3),i=RS().index,a=RS();DE(1),mS("ngIf",a.caseIsFull(n,i))("ngIfElse",r)}}function zoe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Boe,4,2,"g",2),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function Hoe(e,t){if(1&e&&(IC(),_S(0,"rect",16)),2&e){var n=RS();lS("x",12.5+50*n.ko.get().x)("y",12.5+50*n.ko.get().y)}}function Goe(e,t){if(1&e){var n=SS();IC(),CS(0,"circle",17),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e.x,e.y)}),wS()}if(2&e){var r=t.$implicit;lS("cx",25+50*r.x)("cy",25+50*r.y)("r",7)}}var $oe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).ko=RB.empty(),r.last=RB.empty(),r.captures=[],r.GoPiece=moe,r.scores=RB.of([0,0]),r.rules=new Soe(Coe),r.availableMinimaxes=[new Ooe(r.rules,"GoMinimax")],r.encoder=yoe.encoder,r.tutorial=(new Noe).tutorial,r.canPass=!0,r.updateBoard(),r}return dy(n,[{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.last=RB.empty(),a=new yoe(e,t),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState,n.scores.get()));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){OB(n.VERBOSE,"updateBoard");var e=this.rules.node.gameState,t=this.rules.node.move,r=e.phase;this.board=e.getCopiedBoard(),this.scores=RB.of(e.getCapturedCopy()),this.ko=e.koCoord,t.isPresent()?this.showCaptures():this.captures=[],this.last=t.map(function(e){return e.coord}),this.canPass=r!==koe.FINISHED}},{key:"showCaptures",value:function(){var e=this.rules.node.mother.get().gameState;this.captures=[];for(var t=0;t<this.board.length;t++)for(var n=0;n<this.board[0].length;n++){var r=new fte(n,t),i=!1===e.getPieceAt(r).isEmpty(),a=this.board[t][n]===moe.EMPTY,o=!1===this.ko.equalsValue(r);i&&a&&o&&this.captures.push(r)}}},{key:"pass",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.rules.node.gameState.phase,t.abrupt("return",n===koe.PLAYING||n===koe.PASSED?e.onClick(yoe.PASS.coord.x,yoe.PASS.coord.y):(N7(n===koe.COUNTING||n===koe.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(yoe.ACCEPT.coord.x,yoe.ACCEPT.coord.y)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getSpaceClass",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t);return this.getPlayerClass(n.getOwner())}},{key:"caseIsFull",value:function(e,t){return this.rules.node.gameState.getPieceAtXY(e,t)!==moe.EMPTY&&!this.isTerritory(e,t)}},{key:"isLastCase",value:function(e,t){if(this.last.isPresent()){var n=this.last.get();return e===n.x&&t===n.y}return!1}},{key:"isDead",value:function(e,t){return this.rules.node.gameState.isDead(new fte(e,t))}},{key:"isTerritory",value:function(e,t){return this.rules.node.gameState.isTerritory(new fte(e,t))}}]),n}(_ne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-go"]],features:[Qb],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke highlighted",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","highlighted"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured",3,"click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),_S(1,"rect",1),pS(2,zoe,2,1,"g",2),pS(3,Hoe,1,2,"rect",3),pS(4,Goe,1,3,"circle",4),wS()),2&e&&(lS("viewBox","0 -3 "+50*t.board.length+" "+(6+50*t.board.length)),DE(1),lS("width",50*t.board.length)("height",50*t.board.length),DE(1),mS("ngForOf",t.board),DE(1),mS("ngIf",t.ko.isPresent()),DE(1),mS("ngForOf",t.captures))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Zoe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getMaximalDistance",value:function(){return 11}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return MB.success(r)}catch(r){return MB.failure(r.message)}}}]),n}(Nne);Zoe.encoder=Mne.getEncoder(11,11,Zoe.of);var qoe={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:Q7.ZERO},Woe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Fne.UNOCCUPIED,t=Fne.INVADERS,r=Fne.DEFENDERS;return new n([[e,e,e,t,t,t,t,t,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,r,e,e,e,e,t],[t,e,e,e,r,r,r,e,e,e,t],[t,t,e,r,r,Fne.PLAYER_ONE_KING,r,r,e,t,t],[t,e,e,e,r,r,r,e,e,e,t],[t,e,e,e,e,r,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,t,e,e,e,e,e],[e,e,e,t,t,t,t,t,e,e,e]],0)}}]),n}(Vne),joe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this,Woe,qoe,Zoe.of)}return dy(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Dte.ruler=this.singleton,n.singleton}}]),n}(zne),Yoe=Fne.UNOCCUPIED,Koe=Fne.INVADERS,Qoe=Fne.DEFENDERS,Xoe=Fne.PLAYER_ONE_KING,Joe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(ha||(ha=Hg(["Goal of the game"]))),$localize(da||(da=Hg(["Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Woe.getInitialState()),zte.anyMove($localize(va||(va=Hg(["Moving"]))),$localize(pa||(pa=Hg(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Woe.getInitialState(),Zoe.of(new fte(5,1),new fte(1,1)),$localize(ga||(ga=Hg(["Congratulations!"])))),zte.fromMove($localize(ya||(ya=Hg(["Capturing a soldier (1/2)"]))),$localize(ma||(ma=Hg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Woe([[Yoe,Yoe,Yoe,Yoe,Koe,Koe,Koe,Koe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Koe,Yoe,Yoe,Yoe,Yoe,Qoe,Yoe,Yoe,Yoe,Yoe,Koe],[Koe,Yoe,Yoe,Koe,Qoe,Qoe,Qoe,Yoe,Yoe,Yoe,Koe],[Koe,Koe,Yoe,Qoe,Qoe,Xoe,Qoe,Qoe,Yoe,Koe,Koe],[Koe,Yoe,Yoe,Yoe,Qoe,Qoe,Qoe,Yoe,Yoe,Yoe,Koe],[Koe,Yoe,Yoe,Yoe,Yoe,Qoe,Yoe,Yoe,Yoe,Yoe,Koe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Koe,Koe,Koe,Koe,Koe,Yoe,Yoe,Yoe]],1),[Zoe.of(new fte(5,3),new fte(3,3))],$localize(ka||(ka=Hg(["Congratulations, that will teach him a lesson!"]))),$localize(Ca||(Ca=Hg(["Failed, you missed an opportunity to capture a piece of the opponent."])))).withPreviousMove(Zoe.of(new fte(3,0),new fte(3,4))).withPreviousState(Woe.getInitialState()),zte.fromMove($localize(wa||(wa=Hg(["Capturing a soldier (2/2)"]))),$localize(_a||(_a=Hg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Woe([[Yoe,Yoe,Yoe,Koe,Koe,Koe,Koe,Koe,Yoe,Yoe,Yoe],[Yoe,Qoe,Yoe,Yoe,Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Qoe,Yoe,Yoe,Yoe,Yoe,Koe],[Koe,Yoe,Yoe,Yoe,Yoe,Qoe,Qoe,Yoe,Yoe,Yoe,Koe],[Koe,Koe,Xoe,Yoe,Qoe,Yoe,Qoe,Qoe,Yoe,Yoe,Koe],[Yoe,Yoe,Koe,Yoe,Yoe,Qoe,Qoe,Yoe,Yoe,Yoe,Koe],[Koe,Yoe,Yoe,Yoe,Yoe,Qoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Koe,Koe,Koe,Koe,Yoe,Koe,Yoe,Yoe]],12),[Zoe.of(new fte(3,0),new fte(3,5)),Zoe.of(new fte(3,10),new fte(3,5))],$localize(Ea||(Ea=Hg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(ba||(ba=Hg(["Failed, you did not do the expected move."])))),zte.fromMove($localize(Sa||(Sa=Hg(["Capturing the king (1/2)"]))),$localize(Pa||(Pa=Hg(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new Woe([[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Koe,Xoe,Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe]],72),[Zoe.of(new fte(3,4),new fte(2,4))],$localize(Oa||(Oa=Hg(["Congratulations, you won!"]))),$localize(Ta||(Ta=Hg(["Failed, you let the king run away."])))),zte.fromMove($localize(Ia||(Ia=Hg(["Capturing the king (2/2)"]))),$localize(Aa||(Aa=Hg(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new Woe([[Yoe,Yoe,Koe,Xoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Qoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Koe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe],[Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe,Yoe]],72),[Zoe.of(new fte(3,3),new fte(3,1))],$localize(Ra||(Ra=Hg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Ma||(Ma=Hg(["Failed!"]))))]});function ese(e,t){1&e&&(IC(),_S(0,"polygon",8))}function tse(e,t){1&e&&(IC(),_S(0,"rect",9))}function nse(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,ese,1,0,"polygon",6),pS(2,tse,1,0,"ng-template",null,7,XT),wS()),2&e){var n=gS(3),r=RS().index,i=RS().index,a=RS();DE(1),mS("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function rse(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"line",13),_S(2,"line",13),_S(3,"line",13),_S(4,"line",13),_S(5,"line",13),wS()),2&e){var n=RS(2).index,r=RS().index,i=RS();DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function ise(e,t){if(1&e&&(IC(),_S(0,"polyline",16)),2&e){var n=RS(3).index,r=RS().index;mS("ngClass",RS().viewInfo.pieceClasses[r][n])}}function ase(e,t){if(1&e&&(IC(),_S(0,"line",13),_S(1,"line",13),_S(2,"line",13),_S(3,"line",13)),2&e){var n=RS(3).index,r=RS().index,i=RS();mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function ose(e,t){if(1&e&&(IC(),pS(0,ise,1,1,"polyline",14),pS(1,ase,4,20,"ng-template",null,15,XT)),2&e){var n=gS(2),r=RS(2).index,i=RS().index;mS("ngIf",RS().isKing(r,i))("ngIfElse",n)}}function sse(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"circle",10),pS(2,rse,6,25,"g",11),pS(3,ose,3,2,"ng-template",null,12,XT),wS()),2&e){var n=gS(4),r=RS().index,i=RS().index,a=RS();DE(1),NS("id","piece_",r,"_",i,""),mS("ngClass",a.viewInfo.pieceClasses[i][r]),lS("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),DE(1),mS("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function use(e,t){if(1&e){var n=SS();IC(),CS(0,"g",3),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),_S(1,"rect",4),pS(2,nse,4,2,"g",5),pS(3,sse,5,8,"g",5),wS()}if(2&e){var r=t.index,i=RS().index,a=RS();NS("id","click_",r,"_",i,""),lS("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),DE(1),mS("ngClass",a.getRectClasses(r,i)),lS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),DE(1),mS("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),DE(1),mS("ngIf",a.board[i][r]!==a.EMPTY)}}function cse(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,use,4,8,"g",2),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function lse(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",17),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e.x,e.y)}),wS(),wS()}if(2&e){var r=t.$implicit,i=RS();DE(1),NS("id","click_",r.x,"_",r.y,""),lS("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var fse=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e,!1,Zoe.from)).rules=joe.get(),r.availableMinimaxes=[new $ne(r.rules,"DummyBot"),new jne(r.rules,"Piece > Influence"),new Yne(r.rules,"Piece > Control"),new Kne(r.rules,"Escape > Piece > Control")],r.encoder=Zoe.encoder,r.tutorial=(new Joe).tutorial,r}return dy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}}]),n}(Gne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-hnefatafl"]],features:[Qb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,cse,2,1,"g",1),pS(2,lse,2,6,"g",1),wS()),2&e&&(lS("viewBox",t.getViewBox()),DE(1),mS("ngForOf",t.board),DE(1),mS("ngForOf",t.getClickables()))},directives:[nR,eR,iR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),hse=function(){function e(t,n,r){fy(this,e),this.value=t,this.name=n,this.rgb=r}return dy(e,null,[{key:"of",value:function(t){switch(t){case 0:return e.ANY;case 1:return e.ORANGE;case 2:return e.BLUE;case 3:return e.PURPLE;case 4:return e.PINK;case 5:return e.YELLOW;case 6:return e.RED;case 7:return e.GREEN;default:return PB.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),e.BROWN}}}]),e}();hse.ANY=new hse(0,"any","#000"),hse.ORANGE=new hse(1,"orange","#d67421"),hse.BLUE=new hse(2,"blue","#006bac"),hse.PURPLE=new hse(3,"purple","#6f3787"),hse.PINK=new hse(4,"pink","#d2719e"),hse.YELLOW=new hse(5,"yellow","#e2c200"),hse.RED=new hse(6,"red","#d23339"),hse.GREEN=new hse(7,"green","#009157"),hse.BROWN=new hse(8,"brown","#562500");var dse=function(){function e(t,n){fy(this,e),this.player=t,this.color=n}return dy(e,[{key:"equals",value:function(e){return e.player===this.player&&e.color===this.color}},{key:"isEmpty",value:function(){return this.player.equals(K7.NONE)}},{key:"belongsTo",value:function(e){return this.player===e}}],[{key:"of",value:function(t,n){return new e(t,hse.of(n))}},{key:"createPlayerColors",value:function(t){return{ORANGE:new e(t,hse.ORANGE),BLUE:new e(t,hse.BLUE),PURPLE:new e(t,hse.PURPLE),PINK:new e(t,hse.PINK),YELLOW:new e(t,hse.YELLOW),RED:new e(t,hse.RED),GREEN:new e(t,hse.GREEN),BROWN:new e(t,hse.BROWN)}}}]),e}();dse.EMPTY=new dse(K7.NONE,hse.ANY),dse.ZERO=dse.createPlayerColors(Q7.ZERO),dse.ONE=dse.createPlayerColors(Q7.ONE);var vse=function(){function e(){fy(this,e)}return dy(e,null,[{key:"getColorAt",value:function(t,n){return e.COLORS[n][t]}},{key:"getInitialBoard",value:function(){var e=dse.EMPTY;return[[1,2,3,4,5,6,7,8].map(function(e){return dse.of(Q7.ONE,e)}),[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[8,7,6,5,4,3,2,1].map(function(e){return dse.of(Q7.ZERO,e)})]}},{key:"isEmptyAt",value:function(e,t){return e[t.y][t.x].equals(dse.EMPTY)}},{key:"allPieceCoords",value:function(t){for(var n=[],r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++){var a=new fte(i,r);e.isEmptyAt(t,a)||n.push(a)}return n}}]),e}();vse.INITIAL=vse.getInitialBoard(),vse.SIZE=8,vse.COLORS=t9.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],hse.of);var pse=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this)}return dy(n,[{key:"isPieceMove",value:function(){return!1}},{key:"length",value:function(){return 0}},{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"KamisadoMove(PASS)"}}]),n}(Tte);pse.PASS=new pse;var gse,yse=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,r)}return dy(n,[{key:"isPieceMove",value:function(){return!0}},{key:"equals",value:function(e){return e===this||!!e.isPieceMove()&&!1!==e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"KamisadoMove("+this.coord+"->"+this.end+")"}}],[{key:"of",value:function(e,t){if(e.isNotInRange(vse.SIZE,vse.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+e.toString());if(t.isNotInRange(vse.SIZE,vse.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+t.toString());return new n(e,t)}}]),n}(Mne);!function(e){e.PASS=pse.PASS,e.of=function(e,t){return yse.of(e,t)},e.encoder=new(function(t){Jg(r,t);var n=ty(r);function r(){return fy(this,r),n.apply(this,arguments)}return dy(r,[{key:"maxValue",value:function(){return 34952}},{key:"encodeNumber",value:function(e){return e.isPieceMove()?4096*e.coord.x+256*e.coord.y+16*e.end.x+e.end.y:0}},{key:"decodeNumber",value:function(t){if(0===t)return e.PASS;var n=t%16,r=(t=t/16|0)%16,i=(t=t/16|0)%16;return e.of(new fte((t=t/16|0)%16,i),new fte(r,n))}}]),r}(j7))}(gse||(gse={}));var mse=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o){var s;return fy(this,n),(s=t.call(this,t9.copyBiArray(o),e)).colorToPlay=r,s.coordToPlay=i,s.alreadyPassed=a,s}return dy(n,null,[{key:"getInitialState",value:function(){return new n(0,hse.ANY,RB.empty(),!1,vse.INITIAL)}}]),n}(Pte),kse=function(){var e=dy(function e(){fy(this,e)});return e.NOT_RIGHT_COLOR=function(){return $localize(xa||(xa=Hg(["This piece is not of the color you have to play."])))},e.DIRECTION_NOT_ALLOWED=function(){return $localize(Na||(Na=Hg(["You can only move forward, orthogonally or diagonally."])))},e.MOVE_BLOCKED=function(){return $localize(Da||(Da=Hg(["This move is blocked by another piece."])))},e.PLAY_WITH_SELECTED_PIECE=function(){return $localize(La||(La=Hg(["You must play with the selected piece."])))},e}(),Cse=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"nextCoordToPlay",value:function(e,t){return RB.ofNullable(vse.allPieceCoords(e.board).find(function(n){var r=e.getPieceAt(n);return r.player===e.getCurrentOpponent()&&r.color===t}))}},{key:"applyLegalMove",value:function(e,t,n){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.getCopiedBoard();a[i.y][i.x]=a[r.y][r.x],a[r.y][r.x]=dse.EMPTY;var o=vse.getColorAt(i.x,i.y),s=this.nextCoordToPlay(t,o);return new mse(t.turn+1,o,s,!1,a)}var u=this.nextCoordToPlay(t,t.colorToPlay);return new mse(t.turn+1,t.colorToPlay,u,!0,t.board)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=t.getCurrentPlayer();if(n.mustPass(t)&&t.alreadyPassed)return Lte.getDefeat(r);var i=qg(n.getFurthestPiecePositions(t),2),a=i[0];return 7===i[1]?Lte.ONE_WON:0===a?Lte.ZERO_WON:Lte.ONGOING}}],[{key:"getColorMatchingPiece",value:function(e){return e.coordToPlay.isPresent()?[e.coordToPlay.get()]:[new fte(0,7),new fte(1,7),new fte(2,7),new fte(3,7),new fte(4,7),new fte(5,7),new fte(6,7),new fte(7,7)]}},{key:"getMovablePieces",value:function(e){var t=this;return n.getColorMatchingPiece(e).filter(function(n){var r,i=uy(t.playerDirections(e.getCurrentPlayer()));try{for(i.s();!(r=i.n()).done;){var a=r.value,o=n.getNext(a);if(e.isOnBoard(o)&&vse.isEmptyAt(e.board,o))return!0}}catch(s){i.e(s)}finally{i.f()}return!1})}},{key:"playerDirections",value:function(e){return e===Q7.ONE?[ute.DOWN,ute.DOWN_LEFT,ute.DOWN_RIGHT]:[ute.UP,ute.UP_LEFT,ute.UP_RIGHT]}},{key:"directionAllowedForPlayer",value:function(e,t){return t===Q7.ZERO?e.y<0:e.y>0}},{key:"getListMovesFromState",value:function(e){var t=n.getMovablePieces(e);return 0===t.length?(N7(!1===e.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[gse.PASS]):n.getListMovesFromNonBlockedState(e,t)}},{key:"getListMovesFromNonBlockedState",value:function(e,t){var r,i=[],a=e.getCurrentPlayer(),o=uy(t);try{for(o.s();!(r=o.n()).done;){var s,u=r.value,c=uy(n.playerDirections(a));try{for(c.s();!(s=c.n()).done;)for(var l=s.value,f=1;f<vse.SIZE;f++){var h=u.getNext(l,f);if(!e.isOnBoard(h)||!vse.isEmptyAt(e.board,h))break;var d=gse.of(u,h);i.push(d)}}catch(v){c.e(v)}finally{c.f()}}}catch(v){o.e(v)}finally{o.f()}return i}},{key:"mustPass",value:function(e){return 0===this.getMovablePieces(e).length}},{key:"getFurthestPiecePositions",value:function(e){var t=7,n=0;return vse.allPieceCoords(e.board).forEach(function(r){var i=e.getPieceAt(r);N7(i!==dse.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===Q7.ONE?n=Math.max(n,r.y):t=Math.min(t,r.y)}),[t,n]}},{key:"isLegal",value:function(e,t){if(e.isPieceMove()){var r=e.coord,i=e.end,a=t.colorToPlay,o=t.getPieceAt(r);if(!o.belongsTo(t.getCurrentPlayer()))return MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE());if(a!==hse.ANY&&o.color!==a)return MB.failure(kse.NOT_RIGHT_COLOR());if(!t.getPieceAt(i).isEmpty())return MB.failure(Cte.MUST_CLICK_ON_EMPTY_SPACE());var s=ute.factory.fromMove(r,i);if(s.isFailure())return MB.failure(kse.DIRECTION_NOT_ALLOWED());var u=s.get();if(!n.directionAllowedForPlayer(u,t.getCurrentPlayer()))return MB.failure(kse.DIRECTION_NOT_ALLOWED());for(var c=r;!c.equals(i);)if(c=c.getNext(u),!t.getPieceAt(c).isEmpty())return MB.failure(kse.MOVE_BLOCKED());return MB.success(void 0)}return this.isLegalPass(t)}},{key:"isLegalPass",value:function(e){return this.mustPass(e)&&!e.alreadyPassed?MB.success(void 0):MB.failure(Cte.CANNOT_PASS())}}]),n}(Fte),wse=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=Cse.getListMovesFromState(e.gameState);return t9.sortByDescending(t,function(e){return e.length()}),t}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=t.getCurrentPlayer();if(Cse.mustPass(t)&&t.alreadyPassed)return new _te(n.getDefeatValue());var r=qg(Cse.getFurthestPiecePositions(t),2),i=r[0],a=r[1];return new _te(7===a?Q7.ONE.getVictoryValue():0===i?Q7.ZERO.getVictoryValue():a-(7-i))}}]),n}(wte),_se=dse.EMPTY,Ese=dse.ZERO.ORANGE,bse=dse.ONE.ORANGE,Sse=dse.ZERO.BLUE,Pse=dse.ONE.BLUE,Ose=dse.ZERO.PURPLE,Tse=dse.ONE.PURPLE,Ise=dse.ZERO.PINK,Ase=dse.ONE.PINK,Rse=dse.ZERO.YELLOW,Mse=dse.ONE.YELLOW,xse=dse.ZERO.RED,Nse=dse.ONE.RED,Dse=dse.ZERO.GREEN,Lse=dse.ONE.GREEN,Fse=dse.ZERO.BROWN,Use=dse.ONE.BROWN,Vse=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Fa||(Fa=Hg(["Goal of the game"]))),$localize(Ua||(Ua=Hg(["At Kamisado, there are two ways to win the game:\n        either by moving one of your pieces on the opponent's starting line,\n        or by forcing the opponent to make a move that blocks the entire game.\n        Here, Dark wins because its brown piece is on Light's starting line, on the top left."]))),new mse(5,hse.ORANGE,RB.empty(),!1,[[Fse,Pse,Tse,Ase,Mse,Nse,Lse,Use],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,bse,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,Dse,xse,Rse,Ise,Ose,Sse,Ese]])).withPreviousMove(gse.of(new fte(0,7),new fte(0,0))),zte.anyMove($localize(Va||(Va=Hg(["Initial board and initial move"]))),$localize(Ba||(Ba=Hg(["Here is the initial board.\n        At Kamisado, pieces can only move forward, vertically or diagonally.\n        You're playing first, with dark pieces, you can make your first move.<br/><br/>\n        Click on the piece of your choice and click on the landing square."]))),mse.getInitialState(),gse.of(new fte(7,7),new fte(3,3)),$localize(za||(za=Hg(["Perfect! Note that each of your piece has a different color."])))),zte.fromMove($localize(Ha||(Ha=Hg(["Moving"]))),$localize(Ga||(Ga=Hg(["Let us now consider the move of Light, after the blue piece has been moved by Dark.\n        All moves after the initial move must be made from the piece that corresponds to the color\n        of the square upon which the last move ended.\n        Here, the last move ended on the pink square, hence the pink piece must move.\n        It is already selected, you do not have to click on it.<br/><br/>\n        Move it on a blue square."]))),new mse(1,hse.PINK,RB.of(new fte(3,0)),!1,[[bse,Pse,Tse,Ase,Mse,Nse,Lse,Use],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,Sse,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[Fse,Dse,xse,Rse,Ise,Ose,_se,Ese]]),[gse.of(new fte(3,0),new fte(3,6)),gse.of(new fte(3,0),new fte(4,1))],$localize($a||($a=Hg(["Congratulations!"]))),$localize(Za||(Za=Hg(["You have not moved your pink piece on a blue square!"])))).withPreviousMove(gse.of(new fte(6,7),new fte(6,5))),zte.informational($localize(qa||(qa=Hg(["Stuck situation"]))),$localize(Wa||(Wa=Hg(["Dark moved to another pink square, hence you have to move your pink piece again.\n        However, your pink piece is stuck! In this case, you must pass your turn.\n        Dark will now have to play by moving its pink piece."]))),new mse(1,hse.PINK,RB.of(new fte(3,6)),!1,[[bse,Pse,Tse,_se,Mse,Nse,Lse,Use],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,_se,Sse],[_se,_se,_se,_se,_se,_se,_se,_se],[_se,_se,_se,Ase,_se,_se,_se,_se],[Fse,Dse,xse,Rse,Ise,Ose,_se,Ese]])).withPreviousMove(gse.of(new fte(6,5),new fte(7,4))),zte.fromMove($localize(ja||(ja=Hg(["Victory by blocking"]))),$localize(Ya||(Ya=Hg(["At any time, if a player blocks the entire game, that player loses.\n        In other words, if a player forces its opponent to move a piece that the opponent cannot move,\n        and the player cannot move its own piece of the same color, then that player loses.\n        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>\n        Try to make this move."]))),new mse(2,hse.RED,RB.of(new fte(2,4)),!1,[[_se,Pse,Tse,_se,_se,Nse,_se,_se],[_se,_se,_se,Mse,_se,_se,_se,_se],[_se,_se,_se,Ase,_se,Tse,_se,_se],[_se,_se,_se,Rse,_se,_se,_se,_se],[_se,_se,xse,_se,_se,_se,_se,_se],[_se,_se,_se,_se,_se,_se,Lse,_se],[bse,_se,_se,_se,_se,Ise,_se,Use],[Fse,Dse,_se,_se,_se,_se,Sse,Ese]]),[gse.of(new fte(2,4),new fte(0,2))],$localize(Ka||(Ka=Hg(["Perfect!\n         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.\n         Your orange piece will be stuck and you will have to pass your turn.\n         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.\n         In this case, the last player to have moved a piece loses.\n         Here, your opponent will have moved its green piece last, you therefore win!"]))),$localize(Qa||(Qa=Hg(["Failed!"])))).withPreviousMove(gse.of(new fte(4,0),new fte(3,1)))]});function Bse(e,t){if(1&e&&(IC(),_S(0,"circle",8)),2&e){var n=RS(),r=n.$implicit,i=n.index,a=RS().index,o=RS();mS("ngClass",o.piecePlayerClass(r)),lS("cx",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+a*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function zse(e,t){if(1&e&&(IC(),_S(0,"rect",9)),2&e){var n=RS(),r=n.index,i=n.$implicit,a=RS().index,o=RS();lS("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+a*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(i)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(i)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(i))}}function Hse(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"g",4),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),_S(2,"rect",5),pS(3,Bse,1,4,"circle",6),pS(4,zse,1,7,"rect",7),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();DE(1),NS("id","click_",i,"_",a,""),DE(1),lS("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE)("fill",o.backgroundColor(i,a)),DE(1),mS("ngIf",r!==o.UNOCCUPIED),DE(1),mS("ngIf",r!==o.UNOCCUPIED)}}function Gse(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Hse,5,9,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function $se(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"rect",10),_S(2,"rect",10),wS()),2&e){var n=RS();DE(1),lS("x",n.lastPieceMove.get().coord.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().coord.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE),DE(1),lS("x",n.lastPieceMove.get().end.x*n.SPACE_SIZE)("y",n.lastPieceMove.get().end.y*n.SPACE_SIZE)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function Zse(e,t){if(1&e&&(IC(),_S(0,"circle",11)),2&e){var n=RS();lS("cx",n.SPACE_SIZE/2+n.chosen.get().x*n.SPACE_SIZE)("cy",n.SPACE_SIZE/2+n.chosen.get().y*n.SPACE_SIZE)("r",n.SPACE_SIZE/2-n.STROKE_WIDTH)}}var qse=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).UNOCCUPIED=dse.EMPTY,r.lastMove=RB.empty(),r.lastPieceMove=RB.empty(),r.chosen=RB.empty(),r.chosenAutomatically=!1,r.hasAsymetricBoard=!0,r.rules=new Cse(mse),r.availableMinimaxes=[new wse(r.rules,"KamisadoMinimax")],r.encoder=gse.encoder,r.tutorial=(new Vse).tutorial,r.canPass=!1,r.updateBoard(),r}return dy(n,[{key:"backgroundColor",value:function(e,t){return vse.getColorAt(e,t).rgb}},{key:"isPlayerZero",value:function(e){return e.player===Q7.ZERO}},{key:"pieceColor",value:function(e){return e.color.rgb}},{key:"piecePlayerClass",value:function(e){return this.getPlayerClass(e.player)}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=RB.empty(),this.lastMove.isPresent()){var t=this.lastMove.get();t.isPieceMove()&&(this.lastPieceMove=RB.of(t))}this.canPass=Cse.mustPass(e);var n=this.rules.getGameStatus(this.rules.node)!==Lte.ONGOING;this.canPass||e.coordToPlay.isAbsent()||n?(this.chosenAutomatically=!1,this.chosen=RB.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}},{key:"pass",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(N7(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(gse.PASS,e.rules.node.gameState)));case 1:case"end":return t.stop()}},t)}))()}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new fte(e,t),!n.canPass){r.next=6;break}return r.abrupt("return",n.cancelMove(Cte.MUST_PASS()));case 6:if(!n.chosen.isAbsent()){r.next=8;break}return r.abrupt("return",n.choosePiece(e,t));case 8:if(!1!==n.chosenAutomatically||!n.chosen.equalsValue(a)){r.next=10;break}return r.abrupt("return",(n.cancelMoveAttempt(),DB.SUCCESS));case 10:if(o=n.rules.node.gameState.getPieceAtXY(e,t),s=n.rules.node.gameState.getCurrentPlayer(),!o.belongsTo(s)){r.next=15;break}r.t0=n.chosenAutomatically?n.cancelMove(kse.PLAY_WITH_SELECTED_PIECE()):(n.chosen=RB.of(a),DB.SUCCESS),r.next=18;break;case 15:return r.next=17,n.chooseDestination(e,t);case 17:r.t0=r.sent;case 18:return r.abrupt("return",r.t0);case 19:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){var n=this.rules.node.gameState.getPieceAtXY(e,t),r=this.rules.node.gameState.getCurrentOpponent();return n.belongsTo(r)?this.cancelMove(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=RB.of(new fte(e,t)),DB.SUCCESS)}},{key:"chooseDestination",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return i=n.chosen.get(),a=new fte(e,t),o=gse.of(i,a),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 2:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.chosenAutomatically||(this.chosen=RB.empty())}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-kamisado"]],features:[Qb],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill highlighted",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","highlighted"],["id","selectedPiece",1,"base","mid-stroke","no-fill","highlighted"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,Gse,2,1,"g",1),pS(2,$se,3,8,"g",2),pS(3,Zse,1,3,"circle",3),wS()),2&e&&(lS("viewBox",t.getViewBox())("transform",t.rotation),DE(1),mS("ngForOf",t.board),DE(1),mS("ngIf",t.lastPieceMove.isPresent()),DE(1),mS("ngIf",t.chosen.isPresent()))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Wse=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,null,[{key:"getInitialState",value:function(){var e=K7.NONE,t=K7.ZERO,r=K7.ONE;return new n([[e,t,t,t,t,t,t,e],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[r,e,e,e,e,e,e,r],[e,t,t,t,t,t,t,e]],0)}},{key:"isOnBoard",value:function(e){return e.isInRange(n.SIZE,n.SIZE)}}]),n}(Pte);return e.SIZE=8,e}(),jse=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).direction=i,a.direction=ute.factory.fromMove(e,r).get(),a}return dy(n,[{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"LinesOfActionMove("+this.coord+"->"+this.end+")"}},{key:"encode",value:function(){return n.encoder.encode(this)}},{key:"decode",value:function(e){return n.encoder.decode(e)}}],[{key:"of",value:function(e,t){var r=ute.factory.fromMove(e,t);return r.isFailure()?MB.failure(r.getReason()):e.isNotInRange(Wse.SIZE,Wse.SIZE)?MB.failure("start coord is not in range"):t.isNotInRange(Wse.SIZE,Wse.SIZE)?MB.failure("end coord is not in range"):MB.success(new n(e,t,r.get()))}}]),n}(Mne);jse.encoder=Mne.getEncoder(Wse.SIZE,Wse.SIZE,function(e,t){return jse.of(e,t).get()});var Yse=function(){var e=dy(function e(){fy(this,e)});return e.INVALID_MOVE_LENGTH=function(){return $localize(Xa||(Xa=Hg(["Your move should have a length equal to the number of pieces that exist on the same line."])))},e.CANNOT_JUMP_OVER_OPPONENT=function(){return $localize(Ja||(Ja=Hg(["You cannot jump over the opponent's pieces."])))},e.PIECE_CANNOT_MOVE=function(){return $localize(eo||(eo=Hg(["This piece has no possible move, select another one."])))},e}(),Kse=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCopiedBoard();return r[e.coord.y][e.coord.x]=K7.NONE,r[e.end.y][e.end.x]=t.getCurrentPlayer(),new Wse(r,t.turn+1)}},{key:"isLegal",value:function(e,t){return n.isLegal(e,t)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=qg(n.getNumberOfGroups(t),2),i=r[0],a=r[1];return 1===i&&a>1?Lte.ZERO_WON:i>1&&1===a?Lte.ONE_WON:Lte.ONGOING}}],[{key:"getListMovesFromState",value:function(e){var t=[];if(n.getVictory(e).isPresent())return t;for(var r=0;r<Wse.SIZE;r++)for(var i=0;i<Wse.SIZE;i++){var a=new fte(i,r);if(e.getPieceAt(a).isPlayer()){var o,s=uy(n.possibleTargets(e,a));try{for(s.s();!(o=s.n()).done;){var u=o.value,c=jse.of(a,u).get();t.push(c)}}catch(l){s.e(l)}finally{s.f()}}}return t}},{key:"getNumberOfGroups",value:function(e){for(var t=t9.createTable(Wse.SIZE,Wse.SIZE,-1),r=[0,0],i=0,a=0;a<Wse.SIZE;a++)for(var o=0;o<Wse.SIZE;o++)if(-1===t[a][o]){var s=e.getPieceAt(new fte(o,a));s.isPlayer()&&(i+=1,n.markGroupStartingAt(e,t,new fte(o,a),i),r[s.value]+=1)}return r}},{key:"markGroupStartingAt",value:function(e,t,n,r){for(var i=[n],a=e.getPieceAt(n);i.length>0;){var o=PB.getNonNullable(i.pop());if(-1===t[o.y][o.x]){var s=e.getPieceAt(o);if(s===a){t[o.y][o.x]=r;var u,c=uy(ute.DIRECTIONS);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=o.getNext(l);e.isOnBoard(f)&&i.push(f)}}catch(h){c.e(h)}finally{c.f()}}else s===K7.NONE&&(t[o.y][o.x]=0)}}}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)!==t.getCurrentPlayer()?MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE()):e.length()!==this.numberOfPiecesOnLine(t,e.coord,e.direction)?MB.failure(Yse.INVALID_MOVE_LENGTH()):e.coord.getCoordsToward(e.end).some(function(e){return t.getPieceAt(e)===t.getCurrentOpponent()})?MB.failure(Yse.CANNOT_JUMP_OVER_OPPONENT()):t.getPieceAt(e.end)===t.getCurrentPlayer()?MB.failure(Cte.CANNOT_SELF_CAPTURE()):MB.success(void 0)}},{key:"numberOfPiecesOnLine",value:function(e,t,r){var i,a=0,o=uy(n.getLineCoords(t,r));try{for(o.s();!(i=o.n()).done;){var s=i.value;e.getPieceAt(s).isPlayer()&&(a+=1)}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"getLineCoords",value:function(e,t){for(var r=n.getEntranceAndForwardDirection(e,t),i=r[0],a=r[1],o=[];Wse.isOnBoard(i);)o.push(i),i=i.getNext(a);return o}},{key:"getEntranceAndForwardDirection",value:function(e,t){switch(t){case ute.UP:case ute.DOWN:return[new fte(e.x,0),ute.DOWN];case ute.LEFT:case ute.RIGHT:return[new fte(0,e.y),ute.RIGHT];case ute.UP_RIGHT:case ute.DOWN_LEFT:return[new fte(Math.max(0,e.x+e.y-7),Math.min(7,e.x+e.y)),ute.UP_RIGHT];default:return PB.expectToBeMultiple(t,[ute.UP_LEFT,ute.DOWN_RIGHT]),[new fte(e.x-Math.min(e.x,e.y),e.y-Math.min(e.x,e.y)),ute.DOWN_RIGHT]}}},{key:"getVictory",value:function(e){var t=qg(n.getNumberOfGroups(e),2),r=t[0],i=t[1];return 1===r&&1===i?RB.of(K7.NONE):1===r?RB.of(Q7.ZERO):1===i?RB.of(Q7.ONE):RB.empty()}},{key:"possibleTargets",value:function(e,t){var r,i=[],a=uy(ute.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=n.numberOfPiecesOnLine(e,t,o),u=t.getNext(o,s);if(e.isOnBoard(u)){var c=jse.of(t,u).get();n.isLegal(c,e).isSuccess()&&i.push(u)}}}catch(l){a.e(l)}finally{a.f()}return i}}]),n}(Fte),Qse=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){return Kse.getListMovesFromState(e.gameState)}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=qg(Kse.getNumberOfGroups(t),2),r=n[0],i=n[1];return new _te(1===r&&i>1?Q7.ZERO.getVictoryValue():r>1&&1===i?Q7.ONE.getVictoryValue():100/r*Q7.ZERO.getScoreModifier()+100/i*Q7.ONE.getScoreModifier())}}]),n}(wte),Xse=K7.NONE,Jse=K7.ZERO,eue=K7.ONE,tue=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(to||(to=Hg(["Goal of the game"]))),$localize(no||(no=Hg(["At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.\n        Here, Dark wins the game:\n        Dark's pieces are forming a single group, while Light's pieces form three groups."]))),new Wse([[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[eue,Xse,Xse,Xse,Jse,Xse,Xse,eue],[Xse,Xse,Jse,Jse,eue,Xse,Xse,Xse],[Xse,Xse,Xse,Jse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse]],0)),zte.anyMove($localize(ro||(ro=Hg(["Initial board and initial move"]))),$localize(io||(io=Hg(["Here is the initial board.\n         Moves can be made orthogonally or diagonally.\n         The length of a move is equal to the number of pieces that are on the line of the move.\n         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>\n         You're playing Dark, make the first move!"]))),Wse.getInitialState(),jse.of(new fte(1,7),new fte(1,5)).get(),$localize(ao||(ao=Hg(["Congratulations!"])))),zte.fromMove($localize(oo||(oo=Hg(["Jumping"]))),$localize(so||(so=Hg(["During a move, it is possible to jump above your own pieces.\n        But it is forbidden to jump over the opponent's pieces.<br/><br/>\n        You're playing Dark, make a jump over one of your pieces on the following board."]))),new Wse([[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,eue,Jse,Jse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,eue],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Jse]],0),[jse.of(new fte(3,1),new fte(6,1)).get()],$localize(uo||(uo=Hg(["Congratulations!"]))),$localize(co||(co=Hg(["Failed. You did not jump over one of your pieces."])))),zte.fromMove($localize(lo||(lo=Hg(["Moving"]))),$localize(fo||(fo=Hg(["Here is a different board. Pick the dark piece in the middle (line 4, column 4)\n        and observe its possible moves.\n        Horizontally, this piece can move only of one square because it is the only piece on this line.\n        Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.\n        But it can only go up, as below it the landing square is occupied by one of your pieces.\n        Diagonally, only one move is possible: on the diagonal that contains three pieces,\n        only in the direction where it does not jump over one of the opponent's pieces.\n        On the other diagonal, there are too many pieces to end the move on the board.<br/><br/>\n        Make one of these moves."]))),new Wse([[Xse,Xse,Xse,Xse,Xse,Xse,eue,Xse],[Xse,Xse,Xse,Xse,Xse,Jse,Xse,Xse],[Xse,Xse,Xse,Xse,eue,Xse,Xse,Xse],[Xse,Xse,Xse,Jse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,eue],[Xse,Xse,Xse,Xse,Xse,eue,Xse,eue],[Xse,Xse,Xse,Jse,Xse,Xse,eue,eue],[Xse,Xse,Xse,Jse,Xse,Xse,Xse,Xse]],0),[jse.of(new fte(3,3),new fte(3,0)).get(),jse.of(new fte(3,3),new fte(0,0)).get(),jse.of(new fte(3,3),new fte(2,3)).get(),jse.of(new fte(3,3),new fte(4,3)).get()],$localize(ho||(ho=Hg(["Congratulations!"]))),$localize(vo||(vo=Hg(["Failed. This was not one of the expected moves."])))),zte.fromPredicate($localize(po||(po=Hg(["Capturing"]))),$localize(go||(go=Hg(["If a move ends on an opponent's piece, it is captured and removed from the board.\n        However, a move cannot end on one of the player's pieces.\n        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!\n        If a player has only one piece, that player wins the game.<br/><br/>\n        On the following board, try to capture one piece with Dark."]))),new Wse([[Xse,Jse,Xse,Jse,Jse,Jse,Jse,Xse],[eue,Xse,Xse,Xse,Xse,Xse,Xse,eue],[Xse,Xse,Jse,Xse,eue,Xse,Xse,Xse],[eue,Xse,Xse,Xse,Xse,Xse,Xse,eue],[eue,Xse,Xse,Xse,Xse,Xse,Xse,eue],[eue,Xse,Xse,Xse,Xse,Xse,Xse,eue],[eue,Xse,Xse,Xse,Xse,Xse,Xse,eue],[Xse,Jse,Jse,Jse,Jse,Jse,Jse,Xse]],0),jse.of(new fte(2,2),new fte(4,2)).get(),function(e,t,n){return t.getPieceAt(e.end)===K7.ONE?DB.SUCCESS:DB.failure($localize(yo||(yo=Hg(["Failed!"]))))},$localize(mo||(mo=Hg(["Congratulations!"])))),zte.fromMove($localize(ko||(ko=Hg(["Tie"]))),$localize(Co||(Co=Hg(["In the special case where a move ends up connecting all pieces of both player, simultaneously,\n        then the game ends up with a tie.<br/><br/>\n        You're playing Dark, force the tie in one move."]))),new Wse([[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse],[Jse,Xse,Xse,Jse,eue,Jse,Xse,Xse],[Xse,Xse,Xse,Jse,Xse,Xse,Xse,eue],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,eue],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,eue],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,eue],[Xse,Xse,Xse,Xse,Xse,Xse,Xse,Xse]],0),[jse.of(new fte(0,2),new fte(4,2)).get()],$localize(wo||(wo=Hg(["Congratulations!"]))),$localize(_o||(_o=Hg(["Failed!"]))))]});function nue(e,t){if(1&e&&(IC(),_S(0,"circle",6)),2&e){var n=RS().index,r=RS().index,i=RS();NS("id","piece_",n,"_",r,""),mS("ngClass",i.getPieceClasses(n,r)),lS("cx",i.SPACE_SIZE/2+n*i.SPACE_SIZE)("cy",i.SPACE_SIZE/2+r*i.SPACE_SIZE)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function rue(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"g",3),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),_S(2,"rect",4),pS(3,nue,1,6,"circle",5),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();DE(1),NS("id","click_",i,"_",a,""),DE(1),mS("ngClass",o.getSquareClasses(i,a)),lS("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngIf",r!==o.EMPTY)}}function iue(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,rue,4,8,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function aue(e,t){if(1&e){var n=SS();IC(),CS(0,"rect",7),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e.x,e.y)}),wS()}if(2&e){var r=t.$implicit,i=RS();lS("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}var oue=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.EMPTY=K7.NONE,r.targets=[],r.selected=RB.empty(),r.lastMove=RB.empty(),r.captured=RB.empty(),r.rules=new Kse(Wse),r.availableMinimaxes=[new Qse(r.rules,"LinesOfActionMinimax")],r.encoder=jse.encoder,r.tutorial=(new tue).tutorial,r.updateBoard(),r}return dy(n,[{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(a=new fte(e,t),!n.selected.equalsValue(a)){r.next=6;break}return r.abrupt("return",(n.cancelMoveAttempt(),DB.SUCCESS));case 6:return o=n.getState().getCurrentPlayer(),r.abrupt("return",n.selected.isAbsent()||n.getState().getPieceAt(a)===o?n.select(a):n.concludeMove(a));case 8:case"end":return r.stop()}},r)}))()}},{key:"concludeMove",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=jse.of(t.selected.get(),e),n.abrupt("return",r.isSuccess()?t.chooseMove(r.get(),t.rules.node.gameState):t.cancelMove(r.getReason()));case 2:case"end":return n.stop()}},n)}))()}},{key:"select",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.getState().getPieceAt(e)!==t.getState().getCurrentPlayer()?t.cancelMove(Cte.MUST_CHOOSE_PLAYER_PIECE()):(t.selected=RB.of(e),t.targets=Kse.possibleTargets(t.rules.node.gameState,t.selected.get()),0===t.targets.length?t.cancelMove(Yse.PIECE_CANNOT_MOVE()):DB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"getState",value:function(){return this.rules.node.gameState}},{key:"getPreviousState",value:function(){return this.rules.node.mother.get().gameState}},{key:"updateBoard",value:function(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.end).isPlayer()?RB.of(e.end):RB.empty()}}},{key:"cancelMoveAttempt",value:function(){this.selected=RB.empty(),this.targets=[]}},{key:"getSquareClasses",value:function(e,t){var n=new fte(e,t);if(this.lastMove.isPresent()){var r=this.lastMove.get().coord,i=this.lastMove.get().end;if(this.captured.isPresent()&&n.equals(this.captured.get()))return["captured"];if(n.equals(r)||n.equals(i))return["moved"]}return[]}},{key:"getPieceClasses",value:function(e,t){var n=this.board[t][e],r=new fte(e,t),i=[this.getPlayerClass(n)];return this.selected.isPresent()&&this.selected.get().equals(r)&&i.push("selected"),i}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-linesofaction"]],features:[Qb],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,iue,2,1,"g",1),pS(2,aue,1,4,"rect",2),wS()),2&e&&(DE(1),mS("ngForOf",t.board),DE(1),mS("ngForOf",t.targets))},directives:[nR,eR,iR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),sue=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{top:0,bottom:0,left:0,right:0};return fy(this,n),(a=t.call(this,e.x,e.y)).direction=r,a.orientation=i,a.captures=o,a}return dy(n,[{key:"toString",value:function(){return"LodestoneMove(".concat(this.coord.toString(),", ").concat(this.direction,", ").concat(this.orientation,", { top: ").concat(this.captures.top,", bottom: ").concat(this.captures.bottom,", left: ").concat(this.captures.left,", right: ").concat(this.captures.right," })")}},{key:"equals",value:function(e){return this===e||!(!1===this.coord.equals(e.coord)||this.orientation!==e.orientation||this.direction!==e.direction||this.captures.top!==e.captures.top||this.captures.bottom!==e.captures.bottom||this.captures.left!==e.captures.left||this.captures.right!==e.captures.right)}}]),n}(Ite);sue.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encodeMove",value:function(e){return{coord:fte.encoder.encode(e.coord),direction:e.direction,orientation:e.orientation,captures:e.captures}}},{key:"decodeMove",value:function(e){var t=e;return N7(null!=t.coord,"Invalid encoded LodestoneMove"),N7(null!=t.direction,"Invalid encoded LodestoneMove"),N7(null!=t.orientation,"Invalid encoded LodestoneMove"),N7(null!=t.captures,"Invalid encoded LodestoneMove"),new sue(fte.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}}]),n}(W7));var uue=function(){var e=dy(function e(){fy(this,e)});return e.MUST_FLIP_LODESTONE=function(){return $localize(Eo||(Eo=Hg(["You must flip your lodestone before putting it back on the board."])))},e.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=function(){return $localize(bo||(bo=Hg(["As long as there are pressure plates, you must place all the pieces that you have captured on them."])))},e.TARGET_IS_CRUMBLED=function(){return $localize(So||(So=Hg(["You must place your lodestone on a non-crumbled square!"])))},e.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=function(){return $localize(Po||(Po=Hg(["You placed too many captures on the same pressure plate, which has not enough space left."])))},e.MUST_PLACE_CAPTURES=function(){return $localize(Oo||(Oo=Hg(["You must place your captures on the pressure plates, on the side of the board."])))},e.NO_CAPTURES_TO_PLACE_YET=function(){return $localize(To||(To=Hg(["You cannot place any capture now, you must first place your lodestone on the board!"])))},e}(),cue=function(){function e(t){fy(this,e),this.unreachable=t}return dy(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!0}},{key:"isUnreachable",value:function(){return this.unreachable}},{key:"equals",value:function(e){return this===e}}]),e}();cue.UNREACHABLE=new cue(!0),cue.EMPTY=new cue(!1);var lue=function(){function e(t){fy(this,e),this.owner=t}return dy(e,[{key:"isLodestone",value:function(){return!1}},{key:"isPlayerPiece",value:function(){return!0}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t){return t===Q7.ZERO?e.ZERO:e.ONE}}]),e}();lue.ZERO=new lue(Q7.ZERO),lue.ONE=new lue(Q7.ONE);var fue=function(){function e(t,n,r){fy(this,e),this.owner=t,this.direction=n,this.orientation=r}return dy(e,[{key:"isLodestone",value:function(){return!0}},{key:"isPlayerPiece",value:function(){return!1}},{key:"isEmpty",value:function(){return!1}},{key:"isUnreachable",value:function(){return!1}},{key:"equals",value:function(e){return this===e}}],[{key:"of",value:function(t,n){return e.LODESTONES[t.value][n.direction][n.orientation]}}]),e}();fue.LODESTONES={0:{push:{diagonal:new fue(Q7.ZERO,"push","diagonal"),orthogonal:new fue(Q7.ZERO,"push","orthogonal")},pull:{diagonal:new fue(Q7.ZERO,"pull","diagonal"),orthogonal:new fue(Q7.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new fue(Q7.ONE,"push","diagonal"),orthogonal:new fue(Q7.ONE,"push","orthogonal")},pull:{diagonal:new fue(Q7.ONE,"pull","diagonal"),orthogonal:new fue(Q7.ONE,"pull","orthogonal")}}};var hue=function(){function e(t,n){fy(this,e),this.width=t,this.pieces=n}return dy(e,[{key:"remainingSpaces",value:function(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}},{key:"addCaptured",value:function(t,n){if(this.pieces.length+n>=this.width)return 5===this.width?e.EMPTY_3.addCaptured(t,n+this.pieces.length-5):(N7(this.pieces.length+n===3,"should never put more pieces than the plate can support"),RB.empty());for(var r=t9.copyImmutableArray(this.pieces),i=0;i<n;i++)r.push(lue.of(t));return RB.of(new e(this.width,r))}},{key:"getPieceAt",value:function(e){return e<this.pieces.length?this.pieces[e]:cue.EMPTY}}]),e}();hue.POSITIONS=["top","bottom","left","right"],hue.EMPTY_5=new hue(5,[]),hue.EMPTY_3=new hue(3,[]);var due=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r)).lodestones=i,o.pressurePlates=a,o}return dy(n,[{key:"withBoard",value:function(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}},{key:"remainingSpaces",value:function(){var e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}},{key:"remainingSpacesDetails",value:function(){var e,t={top:0,bottom:0,left:0,right:0},n=uy(hue.POSITIONS);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.pressurePlates[r];i.isPresent()&&(t[r]=i.get().remainingSpaces())}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"numberOfPieces",value:function(){for(var e=[0,0],t=0;t<n.SIZE;t++)for(var r=0;r<n.SIZE;r++){var i=this.getPieceAtXY(r,t);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}},{key:"getScores",value:function(){var e=this.numberOfPieces();return[24-e[1],24-e[0]]}},{key:"nextLodestoneDirection",value:function(){var e=this.getCurrentPlayer(),t=this.lodestones.get(e);if(!t.isPresent())return RB.empty();var n=this.getPieceAt(t.get());switch(N7(n.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+t.get()),n.direction){case"push":return RB.of("pull");case"pull":return RB.of("push")}}}],[{key:"getInitialState",value:function(){var e=cue.EMPTY,t=lue.ZERO,r=lue.ONE;return new n([[e,e,t,r,t,r,e,e],[e,t,r,t,r,t,r,e],[t,r,t,r,t,r,t,r],[r,t,r,e,e,t,r,t],[t,r,t,e,e,r,t,r],[r,t,r,t,r,t,r,t],[e,r,t,r,t,r,t,e],[e,e,r,t,r,t,e,e]],0,new Mte,{top:RB.of(hue.EMPTY_5),bottom:RB.of(hue.EMPTY_5),left:RB.of(hue.EMPTY_5),right:RB.of(hue.EMPTY_5)})}}]),n}(Pte);return e.SIZE=8,e}(),vue=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this,due)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.getCurrentPlayer(),i=r.getOpponent(),a=t9.copyBiArray(n.board),o=t.lodestones.getCopy();o.put(r,e.coord);var s=$g({},t.pressurePlates);return this.updatePressurePlates(a,s,o,i,e.captures),new due(a,t.turn+1,o,s)}},{key:"updatePressurePlates",value:function(e,t,n,r,i){var a,o=uy(hue.POSITIONS);try{for(o.s();!(a=o.n()).done;){var s=a.value;t[s]=this.updatePressurePlate(e,s,t[s],n,r,i[s])}}catch(u){o.e(u)}finally{o.f()}}},{key:"updatePressurePlate",value:function(e,t,r,i,a,o){if(r.isPresent()){var s=r.get().addCaptured(a,o),u=n.THREATENED_COORD_RANGE.get(t).get();return s.isAbsent()?(this.removePressurePlate(e,u.startForBigPlate,u.direction,i),this.removePressurePlate(e,u.startForSmallPlate,u.direction,i)):s.get().width<r.get().width&&this.removePressurePlate(e,u.startForBigPlate,u.direction,i),s}return r}},{key:"removePressurePlate",value:function(e,t,n,r){for(var i=t;i.isInRange(due.SIZE,due.SIZE);i=i.getNext(n)){var a,o=uy(Q7.PLAYERS);try{for(o.s();!(a=o.n()).done;){var s=a.value;r.get(s).equalsValue(i)&&r.delete(s)}}catch(u){o.e(u)}finally{o.f()}e[i.y][i.x]=cue.UNREACHABLE}}},{key:"isLegal",value:function(e,t){var n=this.isLegalWithoutCaptures(t,e.coord,e.direction);if(n.isFailure())return MB.failure(n.getReason());var r=this.applyMoveWithoutPlacingCaptures(t,e.coord,e);if(e.captures.top+e.captures.bottom+e.captures.left+e.captures.right!==Math.min(r.captures.length,t.remainingSpaces()))return MB.failure(uue.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());var i,a=uy(hue.POSITIONS);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=t.pressurePlates[o];if(s.isPresent()&&s.get().remainingSpaces()<e.captures[o])return MB.failure(uue.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}}catch(u){a.e(u)}finally{a.f()}return MB.success(r)}},{key:"applyMoveWithoutPlacingCaptures",value:function(e,t,n){var r,i=t9.copyBiArray(e.board),a=e.lodestones.get(e.getCurrentPlayer());if(a.isPresent()){var o=a.get();i[o.y][o.x]=cue.EMPTY}return(r="pull"===n.direction?this.applyPull(e,i,t,n.orientation):this.applyPush(e,i,t,n.orientation)).board[t.y][t.x]=fue.of(e.getCurrentPlayer(),n),r.moved.push(t),r}},{key:"applyPull",value:function(e,t,n,r){var i,a=e.getCurrentPlayer(),o=a.getOpponent(),s=[],u=[],c=uy("diagonal"===r?ute.DIAGONALS:ute.ORTHOGONALS);try{for(c.s();!(i=c.n()).done;)for(var l=i.value,f=n.getNext(l);e.isOnBoard(f);f=f.getNext(l)){var h=t[f.y][f.x],d=f.getNext(l);if(e.isOnBoard(d)){var v=t[d.y][d.x];v.isPlayerPiece()&&v.owner===a&&(h.isEmpty()?(u.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=cue.EMPTY):h.isPlayerPiece()&&h.owner===o&&(s.push(f),t[f.y][f.x]=v,u.push(d),t[d.y][d.x]=cue.EMPTY))}}}catch(p){c.e(p)}finally{c.f()}return{board:t,captures:s,moved:u}}},{key:"applyPush",value:function(e,t,n,r){var i,a=e.getCurrentPlayer().getOpponent(),o=[],s=[],u=uy("diagonal"===r?ute.DIAGONALS:ute.ORTHOGONALS);try{for(u.s();!(i=u.n()).done;)for(var c=i.value,l=n.getNext(c,due.SIZE);!1===l.equals(n);l=l.getPrevious(c))if(e.isOnBoard(l)){var f=t[l.y][l.x];if(f.isPlayerPiece()&&f.owner===a){var h=l.getNext(c);if(e.isOnBoard(h)){var d=t[h.y][h.x];d.isUnreachable()?(o.push(l),t[l.y][l.x]=cue.EMPTY):d.isEmpty()&&(s.push(h),t[h.y][h.x]=f,s.push(l),t[l.y][l.x]=cue.EMPTY)}else o.push(l),t[l.y][l.x]=cue.EMPTY}}}catch(v){u.e(v)}finally{u.f()}return{board:t,captures:o,moved:s}}},{key:"isLegalWithoutCaptures",value:function(e,t,n){var r=this.isTargetLegal(e,t);if(r.isFailure())return r;var i=e.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(n))?DB.failure(uue.MUST_FLIP_LODESTONE()):DB.SUCCESS}},{key:"isTargetLegal",value:function(e,t){var n=e.getPieceAt(t);if(n.isUnreachable())return DB.failure(uue.TARGET_IS_CRUMBLED());if(n.isPlayerPiece())return DB.failure(Cte.MUST_CLICK_ON_EMPTY_SQUARE());var r=e.getCurrentPlayer();return n.isLodestone()&&n.owner!==r?DB.failure(Cte.MUST_CLICK_ON_EMPTY_SQUARE()):DB.SUCCESS}},{key:"getGameStatus",value:function(e){var t=e.gameState.numberOfPieces();return 0===t[0]&&0===t[1]?Lte.DRAW:0===t[0]?Lte.ONE_WON:0===t[1]?Lte.ZERO_WON:Lte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=RB.of(new n)),n.singleton.get()}}]),n}(Fte);vue.THREATENED_COORD_RANGE=Mte.from({top:{startForBigPlate:new fte(0,0),startForSmallPlate:new fte(0,1),direction:ute.RIGHT},bottom:{startForBigPlate:new fte(0,due.SIZE-1),startForSmallPlate:new fte(0,due.SIZE-2),direction:ute.RIGHT},left:{startForBigPlate:new fte(0,0),startForSmallPlate:new fte(1,0),direction:ute.DOWN},right:{startForBigPlate:new fte(due.SIZE-1,0),startForSmallPlate:new fte(due.SIZE-2,0),direction:ute.DOWN}}),vue.singleton=RB.empty();var pue=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=this,n=e.gameState;return this.flatMapEmptyCoords(n,function(e){var r,i=[],a=uy(t.nextDirection(n));try{for(a.s();!(r=a.n()).done;)for(var o=r.value,s=0,u=["diagonal","orthogonal"];s<u.length;s++){var c,l=u[s],f=vue.get().applyMoveWithoutPlacingCaptures(n,e,{direction:o,orientation:l}).captures.length,h=uy(t.captureCombinations(n,f));try{for(h.s();!(c=h.n()).done;){var d=c.value;i.push(new sue(e,o,l,d))}}catch(v){h.e(v)}finally{h.f()}}}catch(v){a.e(v)}finally{a.f()}return i})}},{key:"captureCombinations",value:function(e,t){if(0===t)return new bte([{top:0,bottom:0,left:0,right:0}]);var n,r=new bte,i=e.remainingSpacesDetails(),a=this.captureCombinations(e,t-1),o=uy(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;s.top+1<=i.top&&r.add($g($g({},s),{},{top:s.top+1})),s.bottom+1<=i.bottom&&r.add($g($g({},s),{},{bottom:s.bottom+1})),s.left+1<=i.left&&r.add($g($g({},s),{},{left:s.left+1})),s.right+1<=i.right&&r.add($g($g({},s),{},{right:s.right+1}))}}catch(u){o.e(u)}finally{o.f()}return 0===r.size()?a:r}},{key:"flatMapEmptyCoords",value:function(e,t){for(var n=[],r=0;r<due.SIZE;r++)for(var i=0;i<due.SIZE;i++){var a=new fte(i,r),o=e.getPieceAt(a);(o.isEmpty()&&!1===o.isUnreachable()||o.isLodestone()&&o.owner===e.getCurrentPlayer())&&(n=n.concat(t(a)))}return n}},{key:"nextDirection",value:function(e){var t=e.nextLodestoneDirection();return t.isPresent()?[t.get()]:["push","pull"]}},{key:"getBoardValue",value:function(e){var t,n=e.gameState.getScores();return t=24===n[0]&&24!==n[1]?Q7.ZERO.getVictoryValue():24!==n[0]&&24===n[1]?Q7.ONE.getVictoryValue():n[0]*Q7.ZERO.getScoreModifier()+n[1]*Q7.ONE.getScoreModifier(),new _te(t)}}]),n}(wte),gue=cue.UNREACHABLE,yue=cue.EMPTY,mue=lue.ZERO,kue=lue.ONE,Cue=fue.of(Q7.ONE,{direction:"push",orientation:"orthogonal"}),wue={top:RB.of(hue.EMPTY_5),bottom:RB.of(hue.EMPTY_5),left:RB.of(hue.EMPTY_5),right:RB.of(hue.EMPTY_5)},_ue=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Io||(Io=Hg(["Board and aim of the game"]))),$localize(Ao||(Ao=Hg(["Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone."]))),due.getInitialState()),zte.forClick($localize(Ro||(Ro=Hg(["Selecting a lodestone"]))),$localize(Mo||(Mo=Hg(["To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally."]))),due.getInitialState(),["#lodestone_push_diagonal"],$localize(xo||(xo=Hg(["Congratulations!"]))),$localize(No||(No=Hg(["This is not the right lodestone, try again."])))),zte.informational($localize(Do||(Do=Hg(["The repelling lodestone"]))),$localize(Lo||(Lo=Hg(["Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured."]))),due.getInitialState()),zte.informational($localize(Fo||(Fo=Hg(["The attracting lodestone"]))),$localize(Uo||(Uo=Hg(["When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it."]))),due.getInitialState()),zte.informational($localize(Vo||(Vo=Hg(["Flipping the lodestone"]))),$localize(Bo||(Bo=Hg(["Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn."]))),due.getInitialState()),zte.fromPredicate($localize(zo||(zo=Hg(["Capturing"]))),$localize(Ho||(Ho=Hg(["To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates."]))),due.getInitialState(),new sue(new fte(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),function(e,t,n){return 32===n.remainingSpaces()?DB.failure($localize(Go||(Go=Hg(["You have not captured any of the opponent's pieces, try again!"])))):DB.SUCCESS},"Congratulations!"),zte.fromPredicate($localize($o||($o=Hg(["Crumbling a first pressure plate"]))),$localize(Zo||(Zo=Hg(["When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble."]))),new due([[yue,yue,yue,yue,kue,yue,yue,yue],[yue,yue,mue,yue,yue,kue,yue,yue],[yue,yue,Cue,yue,yue,yue,yue,mue],[yue,yue,yue,yue,kue,yue,yue,mue],[yue,yue,yue,yue,yue,mue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue]],0,new Mte([{key:Q7.ONE,value:new fte(2,2)}]),$g($g({},wue),{},{top:hue.EMPTY_5.addCaptured(Q7.ONE,4)})),new sue(new fte(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return 5===n.pressurePlates.top.get().width?DB.failure($localize(qo||(qo=Hg(["You must capture and place your capture on the top pressure plate to make it crumble!"])))):DB.SUCCESS},"Congratulations!"),zte.fromPredicate($localize(Wo||(Wo=Hg(["Crumbling a second pressure plate"]))),$localize(jo||(jo=Hg(["Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble."]))),new due([[gue,gue,gue,gue,gue,gue,gue,gue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,mue],[yue,yue,yue,yue,yue,mue,yue,mue],[yue,Cue,yue,yue,kue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,kue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue]],0,new Mte([{key:Q7.ONE,value:new fte(1,4)}]),$g($g({},wue),{},{top:hue.EMPTY_3.addCaptured(Q7.ONE,2)})),new sue(new fte(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),function(e,t,n){return n.pressurePlates.top.isPresent()?DB.failure($localize(Yo||(Yo=Hg(["You must capture and place your capture on the top pressure plate to make it crumble a second time!"])))):DB.SUCCESS},"Congratulations!"),zte.informational($localize(Ko||(Ko=Hg(["Minimal board"]))),$localize(Qo||(Qo=Hg(["After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board."]))),new due([[gue,gue,gue,gue,gue,gue,gue,gue],[gue,gue,gue,gue,gue,gue,gue,gue],[gue,gue,mue,kue,yue,yue,gue,gue],[gue,gue,Cue,kue,yue,yue,gue,gue],[gue,gue,yue,mue,mue,yue,gue,gue],[gue,gue,mue,yue,yue,yue,gue,gue],[gue,gue,gue,gue,gue,gue,gue,gue],[gue,gue,gue,gue,gue,gue,gue,gue]],0,new Mte([{key:Q7.ONE,value:new fte(2,3)}]),{top:RB.empty(),bottom:RB.empty(),left:RB.empty(),right:RB.empty()})),zte.fromMove($localize(Xo||(Xo=Hg(["Making the lodestone fall"]))),$localize(Jo||(Jo=Hg(["If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!"]))),new due([[yue,yue,yue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,kue,yue,yue],[yue,yue,yue,Cue,yue,yue,mue,yue],[yue,yue,mue,mue,kue,yue,yue,mue],[yue,yue,yue,yue,yue,mue,yue,yue],[yue,yue,mue,yue,yue,yue,yue,yue],[yue,yue,kue,yue,yue,yue,yue,yue],[yue,yue,yue,yue,yue,yue,yue,yue]],0,new Mte([{key:Q7.ONE,value:new fte(3,2)}]),$g($g({},wue),{},{top:hue.EMPTY_5.addCaptured(Q7.ONE,4)})),[new sue(new fte(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize(es||(es=Hg(["Congratulations! At your next turn, you will be allowed to place your lodestone on any side."]))),$localize(ts||(ts=Hg(["Failed, try again."])))),zte.fromMove($localize(ns||(ns=Hg(["End of the game"]))),$localize(rs||(rs=Hg(["In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!"]))),new due([[gue,gue,gue,gue,gue,gue,gue,gue],[gue,gue,gue,gue,gue,gue,gue,gue],[gue,kue,mue,kue,yue,yue,gue,gue],[gue,kue,Cue,yue,kue,yue,gue,gue],[gue,yue,yue,mue,mue,yue,gue,gue],[gue,kue,mue,yue,kue,yue,gue,gue],[gue,yue,yue,yue,mue,yue,gue,gue],[gue,gue,gue,gue,gue,gue,gue,gue]],0,new Mte([{key:Q7.ONE,value:new fte(2,3)}]),{top:RB.empty(),bottom:hue.EMPTY_3.addCaptured(Q7.ZERO,2),left:RB.of(hue.EMPTY_3),right:RB.empty()}),[new sue(new fte(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize(is||(is=Hg(["Congratulations, you won!"]))),$localize(as||(as=Hg(["This is not the winning move. Try again."]))))]});function Eue(e,t){if(1&e&&(IC(),_S(0,"circle",10)),2&e){var n=RS(2),r=n.index,i=n.$implicit,a=RS().index,o=RS();NS("id","piece_",r,"_",a,""),mS("ngClass",i.pieceClasses),lS("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function bue(e,t){if(1&e&&(IC(),_S(0,"polygon",15)),2&e){var n=RS().$implicit,r=RS(3).$implicit,i=RS(2);vS("transform","rotate(",90*n,")"),mS("ngClass",r.lodestone.movingClass),lS("points",i.TRIANGLE_OUT)}}function Sue(e,t){if(1&e&&(IC(),_S(0,"polygon",15)),2&e){var n=RS().$implicit,r=RS(3).$implicit,i=RS(2);vS("transform","rotate(",90*n,")"),mS("ngClass",r.lodestone.movingClass),lS("points",i.TRIANGLE_IN)}}function Pue(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,bue,1,3,"polygon",14),pS(2,Sue,1,3,"polygon",14),wS()),2&e){var n=RS(3).$implicit;DE(1),mS("ngIf","push"===n.lodestone.direction),DE(1),mS("ngIf","pull"===n.lodestone.direction)}}var Oue=function(){return[0,1,2,3]};function Tue(e,t){if(1&e&&(IC(),CS(0,"g",11),_S(1,"circle",12),_S(2,"circle",13),CS(3,"g"),pS(4,Pue,3,2,"g",1),wS(),wS()),2&e){var n=RS(2),r=n.index,i=n.$implicit,a=RS().index,o=RS();lS("transform",o.getSquareTransform(r,a)),DE(1),mS("ngClass",i.lodestone.selectedClass),lS("r",o.PIECE_RADIUS),DE(1),mS("ngClass",i.lodestone.pieceClasses),lS("r",o.PIECE_RADIUS/4),DE(1),vS("transform","rotate(","diagonal"===i.lodestone.orientation?45:0,")"),DE(1),mS("ngForOf",ST(7,Oue))}}function Iue(e,t){if(1&e){var n=SS();IC(),CS(0,"g",6),TS("click",function(){eC(n);var e=RS().$implicit;return RS(2).selectCoord(e.coord)}),_S(1,"rect",7),pS(2,Eue,1,6,"circle",8),pS(3,Tue,5,8,"g",9),wS()}if(2&e){var r=RS(),i=r.index,a=r.$implicit,o=RS().index,s=RS();NS("id","square_",i,"_",o,""),DE(1),mS("ngClass",a.squareClasses),lS("x",s.SPACE_SIZE*i+s.STROKE_WIDTH)("y",s.SPACE_SIZE*o+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),DE(1),mS("ngIf",a.hasPiece),DE(1),mS("ngIf",a.lodestone)}}function Aue(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Iue,4,9,"g",5),wS()),2&e){var n=t.$implicit;DE(1),mS("ngIf",!1===n.crumbled)}}function Rue(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Aue,2,1,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function Mue(e,t){if(1&e&&(IC(),CS(0,"g",16),_S(1,"circle",17),wS()),2&e){var n=t.$implicit,r=t.index,i=RS();xS("id","capture_",r,""),lS("transform",i.getCaptureTransform(r)),DE(1),mS("ngClass",n.pieceClasses),lS("r",i.PIECE_RADIUS)}}function xue(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"polygon",15),wS()),2&e){var n=t.$implicit,r=RS().$implicit,i=RS();DE(1),vS("transform","rotate(",90*n,")"),mS("ngClass",r.movingClass),lS("points","push"===r.direction?i.TRIANGLE_OUT:i.TRIANGLE_IN)}}function Nue(e,t){if(1&e){var n=SS();IC(),CS(0,"g",6),TS("click",function(){var e=eC(n).$implicit;return RS().selectLodestone(e)}),_S(1,"circle",12),_S(2,"circle",13),CS(3,"g"),pS(4,xue,2,3,"g",1),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS();NS("id","lodestone_",r.direction,"_",r.orientation,""),lS("transform",a.getAvailableLodestoneTransform(i)),DE(1),mS("ngClass",r.selectedClass),lS("r",a.PIECE_RADIUS),DE(1),mS("ngClass",r.pieceClasses),lS("r",a.PIECE_RADIUS/4),DE(1),vS("transform","rotate(","diagonal"===r.orientation?45:0,")"),DE(1),mS("ngForOf",ST(9,Oue))}}function Due(e,t){if(1&e&&(IC(),_S(0,"circle",10)),2&e){var n=RS(),r=n.index,i=n.$implicit,a=RS().$implicit,o=RS();NS("id","platePiece_",a.position,"_",r,""),mS("ngClass",i.pieceClasses),lS("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*i.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function Lue(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"g",6),TS("click",function(){var e=eC(n),t=e.$implicit,r=e.index,i=RS().$implicit;return RS().onPressurePlateClick(t.temporary,i.position,r)}),_S(2,"rect",18),pS(3,Due,1,6,"circle",8),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().$implicit,o=RS();lS("transform",o.getPressurePlateTransform(a.position)),DE(1),NS("id","plate_",a.position,"_",i,""),DE(1),NS("id","plateSquare_",a.position,"_",i,""),mS("ngClass",r.squareClasses),lS("x",o.SPACE_SIZE*r.coord.x+o.STROKE_WIDTH)("y",o.SPACE_SIZE*r.coord.y+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngIf",r.hasPiece)}}function Fue(e,t){if(1&e&&(IC(),CS(0,"g",16),pS(1,Lue,4,11,"g",1),wS()),2&e){var n=t.$implicit;xS("id","pressurePlate_",n.position,""),DE(1),mS("ngForOf",n.coords)}}function Uue(e,t){if(1&e&&(IC(),_S(0,"rect",19)),2&e){var n=RS();NS("id","selection_",n.viewInfo.selected.get().x,"_",n.viewInfo.selected.get().y,""),lS("x",n.SPACE_SIZE*n.viewInfo.selected.get().x+n.STROKE_WIDTH)("y",n.SPACE_SIZE*n.viewInfo.selected.get().y+n.STROKE_WIDTH)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}var Vue=function(e){Jg(n,e);var t=ty(n);function n(e){var r;fy(this,n),(r=t.call(this,e)).viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:RB.empty(),pressurePlateShift:{top:new ate(0,0),left:new ate(0,0),right:new ate(0,0),bottom:new ate(0,0)}},r.stateAfterPlacingLodestone=RB.empty(),r.lastInfos=RB.empty(),r.capturesToPlace=0,r.selectedCoord=RB.empty(),r.selectedLodestone=RB.empty(),r.captures={top:0,bottom:0,left:0,right:0},r.rules=vue.get(),r.tutorial=(new _ue).tutorial,r.availableMinimaxes=[new pue(r.rules,"LodestoneDummyMinimax")],r.encoder=sue.encoder,r.PIECE_RADIUS=.5*(r.SPACE_SIZE-2*r.STROKE_WIDTH);var i=.8*r.PIECE_RADIUS,a=.3*r.PIECE_RADIUS,o=.2*r.PIECE_RADIUS;return r.TRIANGLE_OUT="".concat(i,",0 ").concat(a,",").concat(o," ").concat(a,",-").concat(o),r.TRIANGLE_IN="".concat(a,",0 ").concat(i,",").concat(a," ").concat(i,",-").concat(a),r.displayedState=r.rules.node.gameState,r.scores=RB.of([0,0]),r}return dy(n,[{key:"ngOnInit",value:function(){this.updateBoard()}},{key:"selectCoord",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#square_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.capturesToPlace>0)){n.next=5;break}return n.abrupt("return",t.cancelMove(uue.MUST_PLACE_CAPTURES()));case 5:return i=vue.get().isTargetLegal(t.getState(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):t.selectedCoord.equalsValue(e)?(t.cancelMoveAttempt(),DB.SUCCESS):(t.selectedCoord=RB.of(e),t.selectedLodestone.isPresent()?t.putLodestone():(t.updateViewInfo(),DB.SUCCESS)));case 7:case"end":return n.stop()}},n)}))()}},{key:"selectLodestone",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#lodestone_"+e.direction+"_"+e.orientation)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return N7(0===t.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed"),i=t.getCurrentPlayer(),a=fue.of(i,e),n.abrupt("return",t.selectedLodestone.equalsValue(a)?(t.cancelMoveAttempt(),DB.SUCCESS):(t.selectedLodestone=RB.of(a),t.selectedCoord.isPresent()?t.putLodestone():(t.updateViewInfo(),DB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"putLodestone",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(e.selectedCoord.isPresent(),"coord should have been selected"),N7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=e.getState(),N7(vue.get().isLegalWithoutCaptures(i,n,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves"),a=vue.get().applyMoveWithoutPlacingCaptures(i,n,r),t.abrupt("return",(e.lastInfos=RB.of(a),e.capturesToPlace=Math.min(a.captures.length,i.remainingSpaces()),0===e.capturesToPlace?e.applyMove():(e.displayedState=e.displayedState.withBoard(a.board),e.stateAfterPlacingLodestone=RB.of(e.displayedState),e.updateViewInfo(),DB.SUCCESS)));case 5:case"end":return t.stop()}},t)}))()}},{key:"applyMove",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(e.selectedCoord.isPresent(),"coord should have been selected"),N7(e.selectedLodestone.isPresent(),"lodestone should have been selected"),n=e.selectedCoord.get(),r=e.selectedLodestone.get(),i=new sue(n,r.direction,r.orientation,e.captures),t.abrupt("return",e.chooseMove(i,e.getState()));case 3:case"end":return t.stop()}},t)}))()}},{key:"onPressurePlateClick",value:function(e,t,n){return e?this.deselectPressurePlate(t,n):this.selectPressurePlate(t,n)}},{key:"selectPressurePlate",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(0!==n.capturesToPlace){r.next=5;break}return r.abrupt("return",n.cancelMove(uue.NO_CAPTURES_TO_PLACE_YET()));case 5:return n.capturesToPlace--,n.captures[e]++,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=t9.copyBiArray(a.board),u=$g({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(vue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new due(s,a.turn,c,u),0===n.capturesToPlace?n.applyMove():(n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),DB.SUCCESS)));case 8:case"end":return r.stop()}},r)}))()}},{key:"deselectPressurePlate",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u,c;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#plate_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return n.capturesToPlace++,n.captures[e]--,a=n.stateAfterPlacingLodestone.get(),o=n.getCurrentPlayer().getOpponent(),s=t9.copyBiArray(a.board),u=$g({},a.pressurePlates),c=a.lodestones.getCopy(),r.abrupt("return",(vue.get().updatePressurePlates(s,u,c,o,n.captures),n.displayedState=new due(s,a.turn,c,u),n.updateViewInfo(),n.showPressurePlateDifferences(n.getState(),n.displayedState,!0),DB.SUCCESS));case 6:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=RB.of(this.getState().getScores())}},{key:"cancelMoveAttempt",value:function(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=RB.empty(),this.lastInfos=RB.empty();var e=this.displayedState.lodestones.get(this.getCurrentPlayer());if(e.isPresent()){var t=t9.copyBiArray(this.displayedState.board);t[e.get().y][e.get().x]=cue.EMPTY,this.displayedState=this.displayedState.withBoard(t)}this.selectedCoord=RB.empty(),this.selectedLodestone=RB.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}},{key:"updateViewInfo",value:function(){var e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}},{key:"showBoard",value:function(){this.viewInfo.boardInfo=[];for(var e=0;e<due.SIZE;e++){this.viewInfo.boardInfo.push([]);for(var t=0;t<due.SIZE;t++){var n=new fte(t,e);this.viewInfo.boardInfo[e].push(this.getSquareInfo(n))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:RB.empty()}},{key:"getSquareInfo",value:function(e){var t=this.displayedState.getPieceAt(e),n={coord:e,squareClasses:[],crumbled:t.isUnreachable(),hasPiece:t.isPlayerPiece(),pieceClasses:[]};return t.isPlayerPiece()&&(n.pieceClasses=[this.getPlayerClass(t.owner)]),t.isLodestone()&&(n.lodestone={direction:t.direction,pieceClasses:[this.getPlayerClass(t.owner)],selectedClass:"",movingClass:"",orientation:t.orientation},n.lodestone.movingClass=this.getPlayerClass("push"===t.direction?t.owner.getOpponent():t.owner)),n}},{key:"showAvailableLodestones",value:function(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{var e=this.getState().getCurrentPlayer(),t=this.getState().nextLodestoneDirection();if(t.isPresent()){var n=t.get();this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:n,orientation:"orthogonal"}),this.nextLodestone(e,{direction:n,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(e,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"push",orientation:"diagonal"}),this.nextLodestone(e,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(e,{direction:"pull",orientation:"diagonal"})]}}},{key:"showCapturesToPlace",value:function(){var e=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(var t=0;t<this.capturesToPlace;t++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(e)]})}},{key:"nextLodestone",value:function(e,t){var n=fue.of(e,t),r={direction:n.direction,orientation:n.orientation,pieceClasses:[this.getPlayerClass(n.owner)],movingClass:"",selectedClass:""};return r.movingClass=this.getPlayerClass("push"===n.direction?n.owner.getOpponent():n.owner),this.selectedLodestone.equalsValue(n)&&(r.selectedClass="selected"),r}},{key:"showPressurePlates",value:function(){this.viewInfo.pressurePlates=[];var e,t=uy(hue.POSITIONS);try{for(t.s();!(e=t.n()).done;){var r=e.value,i=[],a=this.displayedState.pressurePlates[r];if(a.isPresent())for(var o=n.PRESSURE_PLATES_POSITIONS.get(r).get(),s=a.get().width,u=5===s?o.startForBigPlate:o.startForSmallPlate,c=0;c<s;c++){u=u.getNext(o.direction);var l=a.get().getPieceAt(c),f="";l.isPlayerPiece()&&(f=this.getPlayerClass(l.owner)),i.push({coord:u,hasPiece:l.isPlayerPiece(),pieceClasses:[f],squareClasses:[],temporary:!1})}this.viewInfo.pressurePlates.push({position:r,coords:i})}}catch(h){t.e(h)}finally{t.f()}}},{key:"showLastMove",value:function(){var e=this.rules.node.mother.get().gameState,t=this.rules.node.move.get();this.lastInfos=RB.of(vue.get().applyMoveWithoutPlacingCaptures(e,t.coord,t)),this.updateViewInfo();var n=this.getState();this.showPressurePlateDifferences(e,n,!1)}},{key:"showPressurePlateDifferences",value:function(e,t,n){var r,i=uy(hue.POSITIONS);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.showPressurePlateDifference(e.pressurePlates[a],t.pressurePlates[a],a,n)}}catch(o){i.e(o)}finally{i.f()}}},{key:"showPressurePlateDifference",value:function(e,t,n,r){if(e.isPresent()&&t.isPresent()){var i=e.get(),a=t.get(),o=PB.getNonNullable(this.viewInfo.pressurePlates.find(function(e){return e.position===n}));if(i.width===a.width)for(var s=0;s<a.width;s++){var u=i.getPieceAt(s),c=a.getPieceAt(s);!1===u.equals(c)&&(o.coords[s].squareClasses.push("moved"),o.coords[s].temporary=r,r&&o.coords[s].pieceClasses.push("semi-transparent"))}else{var l,f=uy(o.coords);try{for(f.s();!(l=f.n()).done;){l.value.squareClasses.push("moved")}}catch(h){f.e(h)}finally{f.f()}}}}},{key:"showMovedAndCaptured",value:function(e){var t,n=uy(e.moved);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved")}}catch(s){n.e(s)}finally{n.f()}var i,a=uy(e.captures);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.viewInfo.boardInfo[o.y][o.x].squareClasses.push("captured")}}catch(s){a.e(s)}finally{a.f()}}},{key:"computePressurePlateShift",value:function(){var e=this.displayedState,t=this.getPressurePlateShift(e.pressurePlates.left),n=this.getPressurePlateShift(e.pressurePlates.right),r=this.getPressurePlateShift(e.pressurePlates.top),i=this.getPressurePlateShift(e.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new fte(.5*(t-n),0),this.viewInfo.pressurePlateShift.bottom=new fte(.5*(t-n),0),this.viewInfo.pressurePlateShift.left=new fte(0,.5*(r-i)),this.viewInfo.pressurePlateShift.right=new fte(0,.5*(r-i))}},{key:"getPressurePlateShift",value:function(e){return e.isAbsent()?2:3===e.get().width?1:0}},{key:"getSquareTransform",value:function(e,t){return"translate(".concat(e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,", ").concat(t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getCaptureTransform",value:function(e){return"translate(".concat((e+(due.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getAvailableLodestoneTransform",value:function(e){return"translate(".concat((e+(due.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE,", ").concat(30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2,")")}},{key:"getPressurePlateTransform",value:function(e){return"translate(".concat(this.viewInfo.pressurePlateShift[e].x*this.SPACE_SIZE,", ").concat(this.viewInfo.pressurePlateShift[e].y*this.SPACE_SIZE,")")}}]),n}(hte);Vue.PRESSURE_PLATE_EXTRA_SHIFT=.2,Vue.PRESSURE_PLATES_POSITIONS=Mte.from({top:{startForBigPlate:new fte(.5,-1-Vue.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new fte(1.5,0-Vue.PRESSURE_PLATE_EXTRA_SHIFT),direction:ute.RIGHT},bottom:{startForBigPlate:new fte(.5,8+Vue.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new fte(1.5,7+Vue.PRESSURE_PLATE_EXTRA_SHIFT),direction:ute.RIGHT},left:{startForBigPlate:new fte(-1-Vue.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new fte(0-Vue.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:ute.DOWN},right:{startForBigPlate:new fte(8+Vue.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new fte(7+Vue.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:ute.DOWN}}),Vue.\u0275fac=function(e){return new(e||Vue)(yS(M7))},Vue.\u0275cmp=ck({type:Vue,selectors:[["app-lodestone"]],features:[Qb],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected",3,"id"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,Rue,2,1,"g",1),pS(2,Mue,2,4,"g",2),pS(3,Nue,5,10,"g",3),pS(4,Fue,2,2,"g",2),pS(5,Uue,1,6,"rect",4),wS()),2&e&&(DE(1),mS("ngForOf",t.viewInfo.boardInfo),DE(1),mS("ngForOf",t.viewInfo.capturesToPlace),DE(1),mS("ngForOf",t.viewInfo.availableLodestones),DE(1),mS("ngForOf",t.viewInfo.pressurePlates),DE(1),mS("ngIf",t.viewInfo.selected.isPresent()))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Bue=function(){var e=dy(function e(){fy(this,e)});return e.START_COORD_OUT_OF_RANGE=function(){return $localize(os||(os=Hg(["Start coord cannot be out of range"])))},e.END_COORD_OUT_OF_RANGE=function(){return $localize(ss||(ss=Hg(["End coord cannot be out of range"])))},e.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=function(){return $localize(us||(us=Hg(["Pawns must move one step diagonally."])))},e.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=function(){return $localize(cs||(cs=Hg(["Drones must move one or two steps in any direction."])))},e}(),zue=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).calledTheClock=i,a}return dy(n,[{key:"toString",value:function(){return"MartianChessMove(("+this.coord.x+", "+this.coord.y+") -> ("+this.end.x+", "+this.end.y+")"+(this.calledTheClock?", CALL_THE_CLOCK":"")+")"}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.end.equals(e.end)&&this.calledTheClock===e.calledTheClock}},{key:"isValidForPawn",value:function(){var e=Math.abs(this.coord.x-this.end.x),t=Math.abs(this.coord.y-this.end.y);return 1===e&&1===t}},{key:"isValidForDrone",value:function(){return this.coord.getDistance(this.end)<=2}},{key:"isUndoneBy",value:function(e){if(e.isAbsent())return!1;var t=e.get();return t.end.equals(this.coord)&&t.coord.equals(this.end)}}],[{key:"from",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.isNotInRange(4,8))return MB.failure(Bue.START_COORD_OUT_OF_RANGE());if(t.isNotInRange(4,8))return MB.failure(Bue.END_COORD_OUT_OF_RANGE());if(t.equals(e))return MB.failure(Cte.MOVE_CANNOT_BE_STATIC());var i=ute.factory.fromDelta(t.x-e.x,t.y-e.y);return i.isFailure()?MB.failure(i.getReason()):MB.success(new n(e,t,r))}}]),n}(Mne);zue.encoder=j7.tuple([fte.numberEncoder(4,8),fte.numberEncoder(4,8),j7.booleanEncoder],function(e){return[e.coord,e.end,e.calledTheClock]},function(e){return zue.from(e[0],e[1],e[2]).get()});var Hue=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"getValue",value:function(){return this.value}},{key:"equals",value:function(e){return this.getValue()===e.getValue()}}],[{key:"tryMerge",value:function(t,n){N7(t!==e.EMPTY&&n!==e.EMPTY,"tryMerge cannot be called with empty pieces");var r=t.value+n.value;return 2===r||3===r?RB.of(e.from(r)):RB.empty()}},{key:"from",value:function(t){return t===e.DRONE.value?e.DRONE:(PB.expectToBe(t,e.QUEEN.value),e.QUEEN)}}]),e}();Hue.EMPTY=new Hue(0),Hue.PAWN=new Hue(1),Hue.DRONE=new Hue(2),Hue.QUEEN=new Hue(3);var Gue=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,r)).ruler=e,i}return dy(n,[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=n.getCurrentPlayer(),i=[],a=uy(n.getPlayerTerritory(r));try{for(a.s();!(t=a.n()).done;)for(var o=t.value,s=0;s<4;s++)switch(n.getPieceAtXY(s,o)){case Hue.PAWN:i=i.concat(this.getMovesForPawnAt(n,s,o));break;case Hue.DRONE:i=i.concat(this.getMovesForDroneAt(n,s,o));break;case Hue.QUEEN:i=i.concat(this.getMovesForQueenAt(n,s,o))}}catch(u){a.e(u)}finally{a.f()}return i}},{key:"getMovesForPawnAt",value:function(e,t,n){var r,i=new fte(t,n),a=[],o=uy(ute.DIAGONALS);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=i.getNext(s);u.isInRange(4,8)&&a.push(u)}}catch(c){o.e(c)}finally{o.f()}return this.addLegalMoves(e,i,a)}},{key:"addLegalMoves",value:function(e,t,n){var r,i=[],a=e.getPieceAt(t),o=!1===e.isTherePieceOnPlayerSide(Hue.DRONE),s=!1===e.isTherePieceOnPlayerSide(Hue.QUEEN),u=e.lastMove,c=uy(n);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=e.getPieceAt(l);if(f===Hue.EMPTY)this.add(i,zue.from(t,l).get(),u);else if(e.isInPlayerTerritory(l)){var h=Hue.tryMerge(f,a);if(h.isPresent()){var d=h.get(),v=zue.from(t,l).get();(d===Hue.DRONE&&o||d===Hue.QUEEN&&s)&&this.add(i,v,u)}}else this.add(i,zue.from(t,l).get(),u)}}catch(p){c.e(p)}finally{c.f()}return i}},{key:"add",value:function(e,t,n){!1===t.isUndoneBy(n)&&e.push(t)}},{key:"getMovesForDroneAt",value:function(e,t,n){var r=new fte(t,n),i=this.getLandingCoordsForLinearMove(r,e,2);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForLinearMove",value:function(e,t,n){var r,i=[],a=uy(ute.DIRECTIONS);try{for(a.s();!(r=a.n()).done;){for(var o=r.value,s=1,u=e.getNext(o,s),c=t.tryToGetPieceAt(u),l=c.equalsValue(Hue.EMPTY);l;)i.push(u),s++,u=e.getNext(o,s),l=(c=t.tryToGetPieceAt(u)).equalsValue(Hue.EMPTY)&&s<n;c.isPresent()&&i.push(u)}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"getMovesForQueenAt",value:function(e,t,n){var r=new fte(t,n),i=this.getLandingCoordsForQueen(r,e);return this.addLegalMoves(e,r,i)}},{key:"getLandingCoordsForQueen",value:function(e,t){return this.getLandingCoordsForLinearMove(e,t,8)}},{key:"getBoardValue",value:function(e){var t,n=this.ruler.getGameStatus(e);if(n.isEndGame)t=n.toBoardValue();else{var r=e.gameState.getScoreOf(Q7.ZERO);t=e.gameState.getScoreOf(Q7.ONE)-r}return new _te(t)}}]),n}(wte),$ue=function(){function e(t){fy(this,e),this.captures=t,t.makeImmutable()}return dy(e,[{key:"toValue",value:function(){var e=0;return this.captures.forEach(function(t){e+=t.key.getValue()*t.value}),e}},{key:"add",value:function(t){var n=this.captures.getCopy();return e.addToMap(n,t),new e(n)}}],[{key:"from",value:function(t){var n,r=new Mte,i=uy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.addToMap(r,a)}}catch(o){i.e(o)}finally{i.f()}return new e(r)}},{key:"addToMap",value:function(e,t){var n=e.get(t);n.isPresent()?e.replace(t,n.get()+1):e.set(t,1)}}]),e}(),Zue=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:RB.empty(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:RB.empty(),s=arguments.length>4?arguments[4]:void 0;return fy(this,n),(i=t.call(this,e,r)).lastMove=a,i.countDown=o,null==s&&(s=new Mte([{key:Q7.ZERO,value:$ue.from([])},{key:Q7.ONE,value:$ue.from([])}])),s.makeImmutable(),i.captured=s,i}return dy(n,[{key:"getPlayerTerritory",value:function(e){return e===Q7.ZERO?n.PLAYER_ZERO_TERRITORY:n.PLAYER_ONE_TERRITORY}},{key:"isTherePieceOnPlayerSide",value:function(e){var t,n=this.getCurrentPlayer(),r=uy(this.getPlayerTerritory(n));try{for(r.s();!(t=r.n()).done;)for(var i=t.value,a=0;a<4;a++)if(this.getPieceAtXY(a,i)===e)return!0}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getScoreOf",value:function(e){return this.captured.get(e).get().toValue()}},{key:"getEmptyTerritory",value:function(){return this.isTerritoryEmpty(Q7.ZERO)?RB.of(Q7.ZERO):this.isTerritoryEmpty(Q7.ONE)?RB.of(Q7.ONE):RB.empty()}},{key:"isTerritoryEmpty",value:function(e){var t,n=uy(this.getPlayerTerritory(e));try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0;i<4;i++)if(this.getPieceAtXY(i,r)!==Hue.EMPTY)return!1}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"isInOpponentTerritory",value:function(e){var t=this.getCurrentOpponent();return this.getPlayerTerritory(t).contains(e.y)}},{key:"isInPlayerTerritory",value:function(e){var t=this.getCurrentPlayer();return this.getPlayerTerritory(t).contains(e.y)}},{key:"getCapturesOf",value:function(e){var t=this.captured.get(e).get();return[t.captures.get(Hue.PAWN).getOrElse(0),t.captures.get(Hue.DRONE).getOrElse(0),t.captures.get(Hue.QUEEN).getOrElse(0)]}}],[{key:"getInitialState",value:function(){var e=Hue.EMPTY,t=Hue.PAWN,r=Hue.DRONE,i=Hue.QUEEN;return new n([[i,i,r,e],[i,r,t,e],[r,t,t,e],[e,e,e,e],[e,e,e,e],[e,t,t,r],[e,t,r,i],[e,r,i,i]],0,RB.empty())}}]),n}(Pte);Zue.PLAYER_ZERO_TERRITORY=new bte([4,5,6,7]),Zue.PLAYER_ONE_TERRITORY=new bte([0,1,2,3]);var que=function(){var e=dy(function e(){fy(this,e)});return e.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=function(){return $localize(ls||(ls=Hg(["You must pick a piece from your side of the board in order to move it."])))},e.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=function(){return $localize(fs||(fs=Hg(["This is not a valid promotion nor a valid capture."])))},e.CANNOT_UNDO_LAST_MOVE=function(){return $localize(hs||(hs=Hg(["You cannot perform a move that is the reverse of the previous one."])))},e}(),Wue=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,r){var i=t.getCopiedBoard();i[e.coord.y][e.coord.x]=Hue.EMPTY,i[e.end.y][e.end.x]=r.finalPiece;var a=r.score,o=t.countDown;if(o.isPresent())if(this.isCapture(e,t))o=n.STARTING_COUNT_DOWN;else{var s=t.countDown.get();o=RB.of(s-1)}return e.calledTheClock&&(o=n.STARTING_COUNT_DOWN),new Zue(i,t.turn+1,RB.of(e),o,a)}},{key:"isLegal",value:function(e,t){this.assertNonDoubleClockCall(e,t);var n=this.isLegalMove(e,t);if(n.isFailure())return MB.failure(n.getReason());if(e.isUndoneBy(t.lastMove))return MB.failure(que.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(e,t))return this.isLegalFieldPromotion(e,t);var r=t.getPieceAt(e.coord),i=t.captured.getCopy();if(this.isCapture(e,t)){var a=t.getCurrentPlayer(),o=i.get(a).get(),s=t.getPieceAt(e.end);o=o.add(s),i.replace(a,o),i.makeImmutable()}return MB.success({finalPiece:r,score:i})}},{key:"assertNonDoubleClockCall",value:function(e,t){N7(!1===(t.countDown.isPresent()&&e.calledTheClock),"Should not call the clock twice")}},{key:"isCapture",value:function(e,t){var n=t.isInOpponentTerritory(e.end),r=t.getPieceAt(e.end)!==Hue.EMPTY;return n&&r}},{key:"isFieldPromotion",value:function(e,t){var n=t.isInPlayerTerritory(e.end),r=t.getPieceAt(e.end)!==Hue.EMPTY;return n&&r}},{key:"isLegalFieldPromotion",value:function(e,t){var n=this.getPromotedPiece(e,t);if(n.isAbsent())return MB.failure(que.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var r=n.get();if(t.isTherePieceOnPlayerSide(r))return MB.failure(que.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());var i={finalPiece:r,score:t.captured.getCopy()};return MB.success(i)}},{key:"isLegalMove",value:function(e,t){if(!1===t.isInPlayerTerritory(e.coord))return MB.failure(que.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());var n=t.getPieceAt(e.coord);if(n===Hue.EMPTY)return MB.failure(Cte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(n===Hue.PAWN)return e.isValidForPawn()?MB.success(void 0):MB.failure(Bue.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(n===Hue.DRONE&&!1===e.isValidForDrone())return MB.failure(Bue.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());var r,i=uy(e.coord.getUntil(e.end));try{for(i.s();!(r=i.n()).done;){var a=r.value;if(t.getPieceAt(a)!==Hue.EMPTY)return MB.failure(Cte.SOMETHING_IN_THE_WAY())}}catch(o){i.e(o)}finally{i.f()}return MB.success(void 0)}},{key:"getPromotedPiece",value:function(e,t){var n=t.getPieceAt(e.coord),r=t.getPieceAt(e.end);return Hue.tryMerge(n,r)}},{key:"getGameStatus",value:function(e){var t=e.gameState;if(t.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(t,Lte.DRAW);if(t.getEmptyTerritory().isPresent()){var n=t.getCurrentOpponent(),r=Lte.getVictory(n);return this.getGameStatusScoreVictoryOr(t,r)}return Lte.ONGOING}},{key:"getGameStatusScoreVictoryOr",value:function(e,t){var n=e.getScoreOf(Q7.ZERO),r=e.getScoreOf(Q7.ONE);return n>r?Lte.ZERO_WON:r>n?Lte.ONE_WON:t}}]),n}(Fte);Wue.STARTING_COUNT_DOWN=RB.of(7);var jue=function(){var e=dy(function e(){fy(this,e)});return e.YOU_DID_NOT_CAPTURE_ANY_PIECE=function(){return $localize(ds||(ds=Hg(["Failed, you did not capture any piece."])))},e}(),Yue=Hue.EMPTY,Kue=Hue.PAWN,Que=Hue.DRONE,Xue=Hue.QUEEN,Jue=function(){return $localize(vs||(vs=Hg(["This is not a field promotion!"])))},ece=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(ps||(ps=Hg(["Goal of the game"]))),$localize(gs||(gs=Hg(["At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal."]))),Zue.getInitialState()),zte.informational($localize(ys||(ys=Hg(["The pieces"]))),$localize(ms||(ms=Hg(["The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>"]))),Zue.getInitialState()),zte.fromPredicate($localize(ks||(ks=Hg(["Moving pawns"]))),$localize(Cs||(Cs=Hg(["Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn."]))),Zue.getInitialState(),zue.from(new fte(2,5),new fte(1,4)).get(),function(e,t,n){return n.getPieceAt(e.end)===Hue.PAWN?DB.SUCCESS:DB.failure($localize(ws||(ws=Hg(["This is not a pawn!"]))))},$localize(_s||(_s=Hg(["Congratulations!"])))),zte.fromPredicate($localize(Es||(Es=Hg(["Moving drones"]))),$localize(bs||(bs=Hg(["Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone."]))),Zue.getInitialState(),zue.from(new fte(1,7),new fte(0,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===Hue.DRONE?DB.SUCCESS:DB.failure($localize(Ss||(Ss=Hg(["This is not a drone!"]))))},$localize(Ps||(Ps=Hg(["Congratulations!"])))),zte.fromPredicate($localize(Os||(Os=Hg(["Moving queens"]))),$localize(Ts||(Ts=Hg(["Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen."]))),new Zue([[Que,Kue,Yue,Yue],[Xue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Xue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Xue,Que,Kue,Yue]],1),zue.from(new fte(2,3),new fte(2,7)).get(),function(e,t,n){return n.getPieceAt(e.end)===Hue.QUEEN?DB.SUCCESS:DB.failure($localize(Is||(Is=Hg(["This is not a queen!"]))))},$localize(As||(As=Hg(["Congratulations!"])))),zte.fromMove($localize(Rs||(Rs=Hg(["Capture"]))),$localize(Ms||(Ms=Hg(["When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it."]))),new Zue([[Que,Kue,Kue,Yue],[Yue,Yue,Yue,Yue],[Xue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Kue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Que,Kue,Yue]],1),[zue.from(new fte(0,2),new fte(2,4)).get()],$localize(xs||(xs=Hg(["Congratulations! By capturing that pawn, you won one point."]))),jue.YOU_DID_NOT_CAPTURE_ANY_PIECE()),zte.fromMove($localize(Ns||(Ns=Hg(["Field Promotion (1/2)"]))),$localize(Ds||(Ds=Hg(["It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it."]))),new Zue([[Yue,Yue,Yue,Xue],[Yue,Kue,Yue,Yue],[Yue,Yue,Kue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Xue],[Yue,Yue,Que,Yue],[Yue,Kue,Yue,Yue]],1),[zue.from(new fte(1,1),new fte(2,2)).get(),zue.from(new fte(2,2),new fte(1,1)).get()],$localize(Ls||(Ls=Hg(["Congratulations!"]))),Jue()),zte.fromPredicate($localize(Fs||(Fs=Hg(["Field Promotion (2/2)"]))),$localize(Us||(Us=Hg(["The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it."]))),new Zue([[Kue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Que,Yue],[Yue,Kue,Yue,Yue]],0),zue.from(new fte(1,7),new fte(2,6)).get(),function(e,t,n){return n.getPieceAt(e.end)===Hue.QUEEN?DB.SUCCESS:DB.failure(Jue())},$localize(Vs||(Vs=Hg(["Congratulations!"])))),zte.fromPredicate($localize(Bs||(Bs=Hg(["Call the clock"]))),$localize(zs||(zs=Hg(['When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You\'re playing Dark. Call the clock and perform a move.']))),Zue.getInitialState(),zue.from(new fte(1,5),new fte(0,4),!0).get(),function(e,t,n){return e.calledTheClock?DB.SUCCESS:DB.failure($localize(Hs||(Hs=Hg(["You did not call the clock!"]))))},$localize(Gs||(Gs=Hg(["Congratulations!"])))),zte.fromMove($localize($s||($s=Hg(["Restarting the clock"]))),$localize(Zs||(Zs=Hg(["If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You are playing Dark, do a capture to restart the countdown."]))),new Zue([[Yue,Yue,Yue,Yue],[Yue,Kue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Kue],[Yue,Yue,Que,Yue],[Yue,Kue,Yue,Yue]],15,RB.empty(),RB.of(1)),[zue.from(new fte(1,1),new fte(2,2)).get()],$localize(qs||(qs=Hg(["Congratulations!"]))),$localize(Ws||(Ws=Hg(["This is not a capture, the game is now over, please retry!"])))),zte.anyMove($localize(js||(js=Hg(["End game (by clock)"]))),$localize(Ys||(Ys=Hg(["When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You are playing Dark, do the last move."]))),new Zue([[Yue,Yue,Yue,Xue],[Yue,Kue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Que,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Que,Yue,Yue]],15,RB.empty(),RB.of(1)),zue.from(new fte(1,1),new fte(2,2)).get(),$localize(Ks||(Ks=Hg(["Congratulations!"])))),zte.fromPredicate($localize(Qs||(Qs=Hg(["End by emptyness"]))),$localize(Xs||(Xs=Hg(["When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!"]))),new Zue([[Yue,Yue,Yue,Xue],[Yue,Kue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Kue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue],[Yue,Yue,Yue,Yue]],0),zue.from(new fte(2,4),new fte(1,3)).get(),function(e,t,n){return 3===e.end.y?DB.SUCCESS:DB.failure($localize(Js||(Js=Hg(["Your piece is still in you territory!"]))))},$localize(eu||(eu=Hg(["Congratulations!"]))))]});function tce(e,t){if(1&e&&(IC(),_S(0,"g",20)),2&e){var n=RS(2).index,r=RS().index,i=RS();qS(i.style),NS("mainShapeId","pawn_",n,"_",r,""),mS("pieceClasses",i.getPieceClasses(n,r))}}function nce(e,t){if(1&e&&(IC(),_S(0,"g",21)),2&e){var n=RS(2).index,r=RS().index,i=RS();qS(i.style),NS("mainShapeId","drone_",n,"_",r,""),mS("pieceClasses",i.getPieceClasses(n,r))}}function rce(e,t){if(1&e&&(IC(),_S(0,"g",22)),2&e){var n=RS(2).index,r=RS().index,i=RS();qS(i.style),NS("mainShapeId","queen_",n,"_",r,""),mS("pieceClasses",i.getPieceClasses(n,r))}}function ice(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,tce,1,5,"g",17),pS(2,nce,1,5,"g",18),pS(3,rce,1,5,"g",19),wS()),2&e){var n=RS(),r=n.index,i=n.$implicit,a=RS().index,o=RS();lS("transform",o.getPieceLocation(r,a)),DE(1),mS("ngIf",i===o.pieces.PAWN),DE(1),mS("ngIf",i===o.pieces.DRONE),DE(1),mS("ngIf",i===o.pieces.QUEEN)}}function ace(e,t){if(1&e){var n=SS();IC(),CS(0,"g",15),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),_S(1,"rect",16),pS(2,ice,4,4,"g",14),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();NS("id","click_",i,"_",a,""),lS("transform","translate(0,  "+(a<=3?0:2*o.STROKE_WIDTH)+")"),DE(1),NS("id","square_",i,"_",a,""),mS("ngClass",o.getSquareClasses(i,a)),lS("x",i*o.SPACE_SIZE)("y",a*o.SPACE_SIZE)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngIf",r!==o.pieces.EMPTY)}}function oce(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",23),TS("click",function(){var e=eC(n).$implicit;return RS(3).onClick(e.x,e.y)}),wS(),wS()}if(2&e){var r=t.$implicit,i=RS(3);DE(1),NS("id","indicator_",r.x,"_",r.y,""),lS("transform","translate(0,  "+(r.y<=3?0:2*i.STROKE_WIDTH)+")")("x",r.x*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("y",r.y*i.SPACE_SIZE+(i.SPACE_SIZE/2-i.INDICATOR_SIZE/2))("width",i.INDICATOR_SIZE)("height",i.INDICATOR_SIZE)}}function sce(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,oce,2,7,"g",1),wS()),2&e){var n=RS(2);DE(1),mS("ngForOf",n.selectedPieceInfo.get().legalLandings)}}function uce(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,ace,3,11,"g",13),pS(2,sce,2,1,"g",14),wS()),2&e){var n=t.$implicit,r=RS();lS("transform","translate("+r.SPACE_SIZE+", 0)"),DE(1),mS("ngForOf",n),DE(1),mS("ngIf",r.selectedPieceInfo.isPresent())}}function cce(e,t){if(1&e&&(IC(),CS(0,"text",24),rP(1),wS()),2&e){var n=RS();mS("ngClass","player"+n.getCurrentPlayer().value)("ngClass",n.getClockCircleClasses()),lS("x",.5*n.SPACE_SIZE)("y",.5*n.SPACE_SIZE),DE(1),iP(n.countDown.get())}}function lce(e,t){if(1&e&&(IC(),_S(0,"polyline",25)),2&e){var n=RS();mS("ngClass",n.getClockCircleClasses()),lS("points",n.clockNeedlesPoints)}}var fce=function(e){return[e]};function hce(e,t){if(1&e){var n=SS();IC(),ES(0),CS(1,"g",28),TS("click",function(){var e=eC(n).index;return RS(2).chooseStyle(e)}),wS(),bS()}if(2&e){var r=t.$implicit,i=t.index,a=RS(2);DE(1),qS(r.style),mS("id",r.name)("pieceClasses",PT(5,fce,"player"+a.getCurrentPlayer().value)),lS("transform","translate(0, "+-(i+1)*a.SPACE_SIZE+")")}}function dce(e,t){if(1&e&&(IC(),CS(0,"g",26),_S(1,"rect",27),pS(2,hce,2,7,"ng-container",1),wS()),2&e){var n=RS();DE(1),lS("x",0)("y",-n.listOfStyles.length*n.SPACE_SIZE)("width",1*n.SPACE_SIZE)("height",n.listOfStyles.length*n.SPACE_SIZE),DE(1),mS("ngForOf",n.listOfStyles)}}function vce(e,t){if(1&e&&(IC(),CS(0,"text",34),rP(1),wS()),2&e){var n=RS(2).$implicit,r=RS().$implicit,i=RS();mS("ngClass","player"+(0===r.value?1:0)),lS("x",i.SPACE_SIZE/2)("y",i.SPACE_SIZE/2),DE(1),iP(n+" x ")}}function pce(e,t){if(1&e&&(IC(),_S(0,"g",35)),2&e){var n=RS(3).$implicit;qS(RS().style),mS("pieceClasses",PT(3,fce,"player"+(0===n.value?1:0)))}}function gce(e,t){if(1&e&&(IC(),_S(0,"g",36)),2&e){var n=RS(3).$implicit;qS(RS().style),mS("pieceClasses",PT(3,fce,"player"+(0===n.value?1:0)))}}function yce(e,t){if(1&e&&(IC(),_S(0,"g",37)),2&e){var n=RS(3).$implicit;qS(RS().style),mS("pieceClasses",PT(3,fce,"player"+(0===n.value?1:0)))}}function mce(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,vce,2,4,"text",30),CS(2,"g",29),pS(3,pce,1,5,"g",31),pS(4,gce,1,5,"g",32),pS(5,yce,1,5,"g",33),wS(),wS()),2&e){var n=RS(),r=n.index,i=n.$implicit,a=RS().$implicit,o=RS();lS("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),DE(1),mS("ngIf",i>1),DE(1),NS("id","piece_",r,"_player_",a.value,""),lS("transform","translate("+o.SPACE_SIZE+", 0)"),DE(1),mS("ngIf",0===r),DE(1),mS("ngIf",1===r),DE(1),mS("ngIf",2===r)}}function kce(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,mce,6,8,"g",14),wS()),2&e){var n=t.$implicit;DE(1),mS("ngIf",n>0)}}function Cce(e,t){if(1&e&&(IC(),CS(0,"g"),CS(1,"g",29),pS(2,kce,2,1,"g",1),wS(),wS()),2&e){var n=t.$implicit,r=RS();DE(1),xS("id","capture_of_player_",n.value,""),lS("transform","scale(0.5, 0.5) translate("+-r.SPACE_SIZE/2+", "+(r.SPACE_SIZE/2+n.value*(10*r.SPACE_SIZE+4*r.STROKE_WIDTH))+")"),DE(1),mS("ngForOf",r.state.getCapturesOf(n))}}var wce=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).INDICATOR_SIZE=20,r.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,r.UP=-n.STROKE_WIDTH/2,r.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,r.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,r.MartianChessComponent=n,r.style={shape:"Circle",points:"Horizontal Points"},r.pieces=Hue,r.selectedPieceInfo=RB.empty(),r.countDown=RB.empty(),r.callTheClock=!1,r.displayModePanel=!1,r.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],r.hasAsymetricBoard=!0,r.rules=new Wue(Zue),r.availableMinimaxes=[new Gue(r.rules,"Martian Chess Dummy Minimax")],r.SPACE_SIZE=n.SPACE_SIZE,r.configCogTransformation=r.getConfigCogTransformation(),r.configViewTranslation=r.getConfigViewTranslation(),r.clockNeedlesPoints=r.getClockNeedlesPoints(),r.encoder=zue.encoder,r.tutorial=(new ece).tutorial,r.scores=RB.of([0,0]),r.updateBoard(),r}return dy(n,[{key:"getConfigViewTranslation",value:function(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}},{key:"getConfigCogTransformation",value:function(){var e=this.STROKE_WIDTH,t=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+t+" "+t+")"}},{key:"getClockNeedlesPoints",value:function(){var e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board;var e=this.state.getScoreOf(Q7.ZERO),t=this.state.getScoreOf(Q7.ONE);this.countDown=this.state.countDown,this.scores=RB.of([e,t])}},{key:"getPieceLocation",value:function(e,t){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*t+")"}},{key:"getPieceClasses",value:function(e,t){var n=new fte(e,t),r=[];return r.push(t>3?"player0":"player1"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(n)&&r.push("highlighted"),this.rules.node.move.isPresent()&&this.rules.node.move.get().end.equals(n)&&this.rules.node.mother.get().gameState.getPieceAt(n)!==Hue.EMPTY&&this.rules.node.gameState.isInOpponentTerritory(new fte(0,t))&&r.push("highlighted"),r}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(n.displayModePanel=!1,!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=4;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 4:return a=new fte(e,t),r.abrupt("return",n.selectedPieceInfo.isPresent()?n.secondClick(a):n.firstClick(a));case 6:case"end":return r.stop()}},r)}))()}},{key:"firstClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.isOneOfUsersPieces(e)?t.selectAsFirstPiece(e):(t.cancelMoveAttempt(),DB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"selectAsFirstPiece",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.getLegalLandings(e),n.abrupt("return",(t.selectedPieceInfo=RB.of({selectedPiece:e,legalLandings:r}),DB.SUCCESS));case 2:case"end":return n.stop()}},n)}))()}},{key:"getLegalLandings",value:function(e){var t=this,n=this.state.getPieceAt(e);return(n===Hue.PAWN?ute.DIAGONALS.map(function(t){return e.getNext(t)}):this.getValidLinearLandingSquareUntil(e,n===Hue.DRONE?2:8)).filter(function(n){var r=zue.from(e,n);return!!r.isSuccess()&&t.rules.isLegal(r.get(),t.getState()).isSuccess()})}},{key:"getValidLinearLandingSquareUntil",value:function(e,t){var n=this;return ute.DIRECTIONS.flatMap(function(r){for(var i=[],a=e.getNext(r),o=1;a.isInRange(4,8)&&o<=t&&(i.push(a),n.getState().getPieceAt(a)===Hue.EMPTY);)a=a.getNext(r),o++;return i})}},{key:"secondClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.selectedPieceInfo.get()).selectedPiece.equals(e)){n.next=3;break}return n.abrupt("return",(t.cancelMoveAttempt(),DB.SUCCESS));case 3:if(!r.legalLandings.some(function(t){return t.equals(e)})){n.next=8;break}return N7((i=zue.from(r.selectedPiece,e,t.callTheClock)).isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!"),a=t.rules.node.gameState,n.abrupt("return",t.chooseMove(i.get(),a));case 8:if(!t.isOneOfUsersPieces(e)){n.next=10;break}return n.abrupt("return",t.selectAsFirstPiece(e));case 10:return o=zue.from(r.selectedPiece,e,t.callTheClock),n.abrupt("return",o.isSuccess()?t.chooseMove(o.get(),t.getState()):t.cancelMove(o.getReason()));case 12:case"end":return n.stop()}},n)}))()}},{key:"isOneOfUsersPieces",value:function(e){return this.state.getPieceAt(e)!==Hue.EMPTY&&this.state.isInPlayerTerritory(e)}},{key:"cancelMoveAttempt",value:function(){this.selectedPieceInfo=RB.empty(),this.callTheClock=!1}},{key:"onClockClick",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#clockOrCountDownView"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),DB.SUCCESS));case 2:case"end":return t.stop()}},t)}))()}},{key:"getClockCircleClasses",value:function(){var e=["base"];return this.callTheClock&&e.push("highlighted"),this.getCurrentPlayer()===Q7.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}},{key:"getSquareClasses",value:function(e,t){var n=new fte(e,t),r=["base"];if(this.rules.node.move.isPresent()){var i=this.rules.node,a=i.move.get();a.coord.equals(n)?r.push("moved"):a.end.equals(n)&&(i.mother.get().gameState.getPieceAt(n)===Hue.EMPTY||i.gameState.isInOpponentTerritory(new fte(0,t))?r.push("moved"):r.push("captured"))}return r}},{key:"onModeCogClick",value:function(){this.displayModePanel=!this.displayModePanel}},{key:"chooseStyle",value:function(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}}],[{key:"getRegularPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=n.getRegularPolygonCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStar",value:function(e,t){var r=this.getNPointedStarCoords(e,t);return n.mapCoordsToString(r)}},{key:"getNPointedStarCoords",value:function(e,t){var r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE;e*=2;for(var o=0;o<e;o++){var s=(o*(360/e)+t)/180*Math.PI,u=o%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s);r.push(new fte(c,l))}return r}},{key:"getRegularPolygonCoords",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],i=.5*n.SPACE_SIZE,a=.5*n.SPACE_SIZE,o=0;o<e;o++){var s=(o*(360/e)-90)/180*Math.PI,u=.5*n.SPACE_SIZE,c=i+.8*u*Math.cos(s),l=a+.8*u*Math.sin(s)+t;r.push(new fte(c,l))}return r}},{key:"mapCoordsToString",value:function(e){var t,n="",r=uy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;n+=i.x+", "+i.y+" "}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getRadius",value:function(e){return this.SPACE_SIZE*e/10}}]),n}(_ne);return e.SPACE_SIZE=100,e.STROKE_WIDTH=8,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-martian-chess"]],features:[Qb],decls:15,vars:25,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","canal",3,"ngClass"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,uce,3,3,"g",1),CS(2,"g",2),TS("click",function(){return t.onClockClick()}),_S(3,"rect",3),_S(4,"circle",4),pS(5,cce,2,5,"text",5),pS(6,lce,1,2,"polyline",6),wS(),_S(7,"line",7),CS(8,"g",8),CS(9,"g",9),TS("click",function(){return t.onModeCogClick()}),_S(10,"rect",3),_S(11,"path",10),wS(),pS(12,dce,3,5,"g",11),wS(),CS(13,"g",12),pS(14,Cce,3,3,"g",1),wS(),wS()),2&e&&(lS("viewBox",t.LEFT+" "+t.UP+" "+t.WIDTH+" "+t.HEIGHT)("transform",t.rotation),DE(1),mS("ngForOf",t.board),DE(1),lS("transform","translate("+5.25*t.SPACE_SIZE+", 0)"),DE(1),lS("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),DE(1),mS("ngClass",t.getClockCircleClasses()),lS("cx",.5*t.SPACE_SIZE)("cy",.5*t.SPACE_SIZE)("r",.4*t.SPACE_SIZE),DE(1),mS("ngIf",t.countDown.isPresent()),DE(1),mS("ngIf",t.countDown.isAbsent()),DE(1),mS("ngClass","player"+t.getCurrentPlayer().value),lS("x1",t.SPACE_SIZE)("y1",5*t.SPACE_SIZE+8)("x2",5*t.SPACE_SIZE)("y2",5*t.SPACE_SIZE+8)("stroke-width",2*t.STROKE_WIDTH),DE(1),lS("transform",t.configViewTranslation),DE(2),lS("width",t.SPACE_SIZE)("height",t.SPACE_SIZE),DE(1),mS("ngClass","player"+t.getCurrentPlayer().value),lS("transform",t.configCogTransformation),DE(1),mS("ngIf",t.displayModePanel),DE(2),mS("ngForOf",t.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),_ce=Number.MAX_SAFE_INTEGER,Ece=Number.MIN_SAFE_INTEGER,bce=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,t9.copyBiArray(n.initialBoard),e)).turn=e,i.location=r,i}return dy(n,null,[{key:"getInitialState",value:function(){return new n(0,new fte(0,0))}}]),n}(Pte);bce.BOARD_0=[[6,4,3,1],[4,4,3,1],[3,3,2,0],[1,1,0,0]],bce.BOARD_1=[[0,+_ce,-1,-1],[1,2,+_ce,-1],[+Ece,3,4,-1],[-1,+Ece,+Ece,-1]],bce.BOARD_2=[[0,+_ce,-1,-1],[+_ce,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],bce.BOARD_3=[[0,1,+Ece,-1],[1,+Ece,-1,-1],[+Ece,-1,-1,-1],[-1,-1,-1,-1]],bce.BOARD_4=[[0,1,+Ece,-1],[1,+Ece,-1,-1],[+Ece,-1,-1,-1],[-1,-1,-1,1]],bce.initialBoard=bce.BOARD_0;var Sce=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=new fte(t.location.x+(!0===e.right?1:0),t.location.y+(!1===e.right?1:0));return new bce(t.turn+1,r)}},{key:"isLegal",value:function(e,t){var n=t.location,r=t.getCopiedBoard();return n.x+1===r[0].length&&!0===e.right||n.y+1===r.length&&!1===e.right?MB.failure("incorrect move"):MB.success(void 0)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getPieceAt(t.location);return n===Q7.ZERO.getVictoryValue()?Lte.ZERO_WON:n===Q7.ONE.getVictoryValue()?Lte.ONE_WON:t.location.equals(new fte(3,3))?0===n?Lte.DRAW:n>0?Lte.ONE_WON:Lte.ZERO_WON:Lte.ONGOING}}]),n}(Fte),Pce=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).right=e,r}return dy(n,[{key:"equals",value:function(e){return this===e||this.right===e.right}},{key:"toString",value:function(){return this.right?"Move RIGHT":"Move DOWN"}}]),n}(Tte);Pce.RIGHT=new Pce(!0),Pce.DOWN=new Pce(!1),Pce.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 1}},{key:"decodeNumber",value:function(e){return 0===e?Pce.RIGHT:Pce.DOWN}},{key:"encodeNumber",value:function(e){return e.right?0:1}}]),n}(j7));var Oce=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=Sce.getGameStatus(e);if(t.isEndGame)return new _te(t.toBoardValue());var n=e.gameState;return new _te(n.getPieceAt(n.location))}},{key:"getListMoves",value:function(e){var t=[],n=e.gameState;return n.location.x<3&&t.push(Pce.RIGHT),n.location.y<3&&t.push(Pce.DOWN),t}}]),n}(wte);function Tce(e,t){1&e&&(ES(0),rP(1,"("),bS())}function Ice(e,t){1&e&&(ES(0),rP(1,")"),bS())}function Ace(e,t){if(1&e&&(CS(0,"td"),pS(1,Tce,2,0,"ng-container",3),rP(2),pS(3,Ice,2,0,"ng-container",3),wS()),2&e){var n=t.$implicit,r=t.index,i=RS().index,a=RS();DE(1),mS("ngIf",a.coord.x===r&&a.coord.y===i),DE(1),aP(" ",n," "),DE(1),mS("ngIf",a.coord.x===r&&a.coord.y===i)}}function Rce(e,t){if(1&e&&(CS(0,"tr"),pS(1,Ace,4,3,"td",0),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}var Mce=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).coord=new fte(-1,-1),r.rules=new Sce(bce),r.availableMinimaxes=[new Oce(r.rules,"MinimaxTestingMinimax")],r.encoder=Pce.encoder,r}return dy(n,[{key:"chooseRight",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_right"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Pce.RIGHT,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"chooseDown",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.canUserPlay("#click_down"),t.abrupt("return",n.isFailure()?e.cancelMove(n.getReason()):e.chooseMove(Pce.DOWN,e.rules.node.gameState));case 2:case"end":return t.stop()}},t)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.coord=e.location}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-minimax-testing"]],features:[Qb],decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],["id","click_right",3,"click"],["id","click_down",3,"click"],[4,"ngIf"]],template:function(e,t){1&e&&(CS(0,"table"),pS(1,Rce,2,1,"tr",0),CS(2,"div",1),TS("click",function(){return t.chooseRight()}),rP(3," goRight "),wS(),CS(4,"div",2),TS("click",function(){return t.chooseDown()}),rP(5," goDown "),wS(),CS(6,"div"),rP(7),wS(),wS()),2&e&&(DE(1),mS("ngForOf",t.board),DE(6),aP(" ",t.coord," "))},directives:[nR,iR],encapsulation:2}),e}(),xce=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,null,[{key:"getInitialState",value:function(){return new n(t9.createTable(7,6,K7.NONE),0)}}]),n}(Pte),Nce=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this)).x=e,r}return dy(n,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"P4Move("+this.x+")"}}],[{key:"of",value:function(e){switch(e){case 0:return n.ZERO;case 1:return n.ONE;case 2:return n.TWO;case 3:return n.THREE;case 4:return n.FOUR;case 5:return n.FIVE;case 6:return n.SIX;default:throw new Error("Invalid P4Move")}}}]),n}(Tte);Nce.ZERO=new Nce(0),Nce.ONE=new Nce(1),Nce.TWO=new Nce(2),Nce.THREE=new Nce(3),Nce.FOUR=new Nce(4),Nce.FIVE=new Nce(5),Nce.SIX=new Nce(6),Nce.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 6}},{key:"encodeNumber",value:function(e){return e.x}},{key:"decodeNumber",value:function(e){return Nce.of(e)}}]),n}(j7));var Dce=function(){var e=dy(function e(){fy(this,e)});return e.COLUMN_IS_FULL=function(){return $localize(tu||(tu=Hg(["Please put your piece in an incomplete column."])))},e}(),Lce=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,r){var i=e.x,a=t.getCopiedBoard(),o=n.getLowestUnoccupiedCase(a,i),s=t.turn;return a[o][i]=t.getCurrentPlayer(),new xce(a,s+1)}},{key:"isLegal",value:function(e,t){return OB(n.VERBOSE,{context:"P4Rules.isLegal",move:e.toString(),state:t}),t.getPieceAtXY(e.x,0).isPlayer()?MB.failure(Dce.COLUMN_IS_FULL()):MB.success(void 0)}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,r=0;r<7;r++)for(var i=5;i>=0&&t.board[i][r].isPlayer();i--){var a=n.getSquareScore(t.board,new fte(r,i));if(Dte.getScoreStatus(a)===Rte.VICTORY)return Lte.getVictory(t.getCurrentOpponent())}return 42===t.turn?Lte.DRAW:Lte.ONGOING}}],[{key:"getVictoriousCoords",value:function(e){for(var t=[],r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new fte(r,i));(a===Q7.ZERO.getVictoryValue()||a===Q7.ONE.getVictoryValue())&&t.push(new fte(r,i))}return t}},{key:"getBoardValueFromScratch",value:function(e){OB(n.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:e}});for(var t=0,r=0;r<7;r++)for(var i=5;-1!==i&&e.board[i][r].isPlayer();i--){var a=n.getSquareScore(e.board,new fte(r,i));if(Dte.getScoreStatus(a)!==Rte.DEFAULT)return OB(n.VERBOSE,{preVictoryOrVictory:{state:e,tmpScore:a,coord:{x:r,y:i}}}),new _te(a);t+=a}return new _te(t)}},{key:"getLowestUnoccupiedCase",value:function(e,t){for(var n=0;n<6&&e[n][t]===K7.NONE;)n++;return n-1}},{key:"getNumberOfFreeSpacesAndAllies",value:function(e,t,n,r,i){for(var a=0,o=0,s=!0,u=new fte(t.x+n.x,t.y+n.y);u.isInRange(7,6)&&3!==a;){var c=e[u.y][u.x];if(c===r)return[a,o];c===i&&s?o++:s=!1,c!==r&&c!==i&&a++,u=u.getNext(n)}return[a,o]}},{key:"getOpponent",value:function(e,t){var n=e[t.y][t.x];return N7(n.isPlayer(),"getOpponent should not be called with PlayerOrNone.NONE"),n===Q7.ONE?Q7.ZERO:Q7.ONE}},{key:"getSquareScore",value:function(e,t){OB(n.VERBOSE,"getSquareScore(board, "+t.x+", "+t.y+") called"),OB(n.VERBOSE,e);var r,i=0,a=n.getOpponent(e,t),o=a.getOpponent(),s=new Mte,u=new Mte,c=uy(ute.DIRECTIONS);try{for(c.s();!(r=c.n()).done;){var l=r.value,f=n.getNumberOfFreeSpacesAndAllies(e,t,l,a,o);s.set(l,f[0]),u.set(l,f[1])}}catch(y){c.e(y)}finally{c.f()}for(var h=0,d=[ute.UP,ute.UP_RIGHT,ute.RIGHT,ute.DOWN_RIGHT];h<d.length;h++){var v=d[h],p=u.get(v).get()+u.get(v.getOpposite()).get();if(p>2)return OB(n.VERBOSE,{text:"there is some kind of victory here ("+t.x+", "+t.y+")\nline allies : "+p+"\n",board:e}),o.getVictoryValue();var g=s.get(v).get()+s.get(v.getOpposite()).get();3===g?i+=2:g>3&&(i+=g-2)}return i*o.getScoreModifier()}},{key:"getListMoves",value:function(e){OB(n.VERBOSE,{context:"P4Rules.getListMoves",node:e});for(var t=e.gameState,r=[],i=0;i<7;i++)if(t.getPieceAtXY(i,0)===K7.NONE){var a=Nce.of(i);r.push(a)}return r}},{key:"getBoardValue",value:function(e){return OB(n.VERBOSE,{text:"P4Rules.getBoardValue called",board:e.getCopiedBoard()}),n.getBoardValueFromScratch(e)}}]),n}(Fte);return e.VERBOSE=!1,e}(),Fce=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){return Lce.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=e.gameState;return OB(Lce.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:t.getCopiedBoard()}),Lce.getBoardValue(t)}}]),n}(wte),Uce=K7.NONE,Vce=K7.ZERO,Bce=K7.ONE,zce=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(nu||(nu=Hg(["Goal of the game"]))),$localize(ru||(ru=Hg(["The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.\n        The first player plays Dark, the second plays Light.\n        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally)."]))),xce.getInitialState()),zte.anyMove($localize(iu||(iu=Hg(["Dropping a piece"]))),$localize(au||(au=Hg(["Click on any space in any column."]))),xce.getInitialState(),Nce.THREE,$localize(ou||(ou=Hg(["As you can see, the piece falls at the bottom of the column."])))),zte.fromMove($localize(su||(su=Hg(["Victory"]))),$localize(uu||(uu=Hg(["You're playing Dark.\n        Place your piece so that you create a horizontal alignment of 4 of your pieces."]))),new xce([[Uce,Uce,Uce,Uce,Uce,Uce,Uce],[Uce,Uce,Uce,Uce,Uce,Uce,Uce],[Uce,Uce,Uce,Uce,Uce,Uce,Uce],[Uce,Uce,Uce,Bce,Uce,Uce,Uce],[Uce,Uce,Uce,Bce,Uce,Uce,Uce],[Uce,Uce,Vce,Vce,Vce,Bce,Uce]],0),[Nce.of(1)],$localize(cu||(cu=Hg(["You won!"]))),$localize(lu||(lu=Hg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."])))),zte.fromMove($localize(fu||(fu=Hg(["Other victory"]))),$localize(hu||(hu=Hg(["You can also align 4 pieces diagonally or vertically."]))),new xce([[Uce,Uce,Uce,Uce,Uce,Uce,Uce],[Uce,Uce,Uce,Uce,Uce,Uce,Uce],[Uce,Uce,Uce,Uce,Uce,Uce,Uce],[Uce,Uce,Uce,Vce,Bce,Uce,Uce],[Uce,Uce,Vce,Vce,Bce,Uce,Uce],[Uce,Vce,Bce,Vce,Vce,Uce,Uce]],0),[Nce.of(3),Nce.of(4)],$localize(du||(du=Hg(["You won!"]))),$localize(vu||(vu=Hg(["Failed, you have not aligned 4 pieces and missed an opportunity to win."]))))]});function Hce(e,t){if(1&e&&(IC(),_S(0,"circle",8)),2&e){var n=RS().index,r=RS().index,i=RS();mS("ngClass",i.getSquareFillClass(n,r)),lS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Gce(e,t){if(1&e){var n=SS();IC(),CS(0,"g",5),TS("click",function(){var e=eC(n).index;return RS(2).onClick(e)}),_S(1,"rect",6),pS(2,Hce,1,4,"circle",7),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();xS("id","click_",i,""),DE(1),lS("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngIf",r!==o.EMPTY)}}function $ce(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Gce,3,6,"g",4),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function Zce(e,t){if(1&e&&(IC(),_S(0,"rect",9)),2&e){var n=RS();lS("x",n.SPACE_SIZE*n.last.get().x)("y",n.SPACE_SIZE*n.last.get().y)("width",n.SPACE_SIZE)("height",n.SPACE_SIZE)}}function qce(e,t){if(1&e&&(IC(),_S(0,"rect",10)),2&e){var n=t.$implicit,r=RS();NS("id","victory_coord_",n.x,"_",n.y,""),lS("x",r.SPACE_SIZE*n.x)("y",r.SPACE_SIZE*n.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}var Wce=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).EMPTY=K7.NONE,r.victoryCoords=[],r.rules=new Lce(xce),r.availableMinimaxes=[new Fce(r.rules,"P4Minimax")],r.encoder=Nce.encoder,r.tutorial=(new zce).tutorial,r.updateBoard(),r}return dy(n,[{key:"onClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=Nce.of(e),n.next=6,t.chooseMove(i,t.rules.node.gameState);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},n)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.victoryCoords=Lce.getVictoriousCoords(e),this.board=e.board,t.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move,t=Lce.getLowestUnoccupiedCase(this.rules.node.gameState.board,e.get().x)+1;this.last=RB.of(new fte(e.get().x,t))}},{key:"hideLastMove",value:function(){this.last=RB.empty()}},{key:"getSquareFillClass",value:function(e,t){return[this.getPlayerClass(this.board[t][e])]}}]),n}(_ne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-p4"]],features:[Qb],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,$ce,2,1,"g",1),pS(2,Zce,1,4,"rect",2),pS(3,qce,1,6,"rect",3),wS()),2&e&&(DE(1),mS("ngForOf",t.board),DE(1),mS("ngIf",t.last.isPresent()),DE(1),mS("ngForOf",t.victoryCoords))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),jce=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(fy(this,n),(a=t.call(this,e,r)).blockTurned=i,a.turnedClockwise=o,a.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+a.coord.toString());return ny(a)}return dy(n,[{key:"toString",value:function(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}},{key:"equals",value:function(e){return!1!==this.coord.equals(e.coord)&&!1!==this.blockTurned.equals(e.blockTurned)&&this.turnedClockwise===e.turnedClockwise}}],[{key:"withRotation",value:function(e,t,r,i){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new n(e,t,RB.of(r),i)}},{key:"rotationless",value:function(e,t){return new n(e,t,RB.empty())}}]),n}(Ite);jce.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encodeMove",value:function(e){var t={coord:fte.encoder.encode(e.coord)};return e.blockTurned.isPresent()&&(t.blockTurned=e.blockTurned.get(),t.turnedClockwise=e.turnedClockwise),t}},{key:"decodeMove",value:function(e){var t=e,n=fte.encoder.decode(t.coord),r=RB.ofNullable(t.blockTurned);if(r.isPresent()){var i=t.turnedClockwise;return jce.withRotation(n.x,n.y,r.get(),i)}return jce.rotationless(n.x,n.y)}}]),n}(W7));var Yce=function(){var e=dy(function e(){fy(this,e)});return e.CANNOT_ROTATE_NEUTRAL_BLOCK=function(){return $localize(pu||(pu=Hg(["If the quadrant to turn is neutral, please just use move without rotation."])))},e.MUST_CHOOSE_BLOCK_TO_ROTATE=function(){return $localize(gu||(gu=Hg(["No quadrant is neutral, you must pick a quadrant to rotate."])))},e}(),Kce=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e,r)).neutralBlocks=i.getBlocksNeutralities(),i}return dy(n,[{key:"getBlocksNeutralities",value:function(){for(var e=[],t=0;t<4;t++)this.getBlockNeutrality(t)&&e.push(t);return e}},{key:"getBlockNeutrality",value:function(e){var t=n.getBlockCenter(e),r=this.getPieceAt(t.getNext(ute.UP,1)),i=this.getPieceAt(t.getNext(ute.UP_LEFT,1));return this.getPieceAt(t.getNext(ute.RIGHT,1))===r&&this.getPieceAt(t.getNext(ute.DOWN,1))===r&&this.getPieceAt(t.getNext(ute.LEFT,1))===r&&this.getPieceAt(t.getNext(ute.UP_RIGHT,1))===i&&this.getPieceAt(t.getNext(ute.DOWN_RIGHT,1))===i&&this.getPieceAt(t.getNext(ute.DOWN_LEFT,1))===i}},{key:"applyLegalDrop",value:function(e){var t=this.getCopiedBoard();return t[e.coord.y][e.coord.x]=this.getCurrentPlayer(),new n(t,this.turn)}},{key:"applyLegalMove",value:function(e){var t=this.applyLegalDrop(e),r=t.getCopiedBoard();if(e.blockTurned.isPresent()){var i=n.getBlockCenter(e.blockTurned.get());if(e.turnedClockwise){var a,o=uy(n.ROTATION_MAP);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=s[0].getNext(i),c=s[1].getNext(i),l=t.getPieceAt(u);r[c.y][c.x]=l}}catch(y){o.e(y)}finally{o.f()}}else{var f,h=uy(n.ROTATION_MAP);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=d[1].getNext(i),p=d[0].getNext(i),g=t.getPieceAt(v);r[p.y][p.x]=g}}catch(y){h.e(y)}finally{h.f()}}}return new n(r,this.turn+1)}},{key:"blockIsNeutral",value:function(e){return this.neutralBlocks.includes(e)}}],[{key:"getInitialState",value:function(){return new n(t9.createTable(6,6,K7.NONE),0)}},{key:"getBlockCenter",value:function(e){return new fte(1+(e%2==0?0:3),1+(e<2?0:3))}}]),n}(Pte);Kce.ROTATION_MAP=[[new fte(-1,-1),new fte(1,-1)],[new fte(0,-1),new fte(1,0)],[new fte(1,-1),new fte(1,1)],[new fte(1,0),new fte(0,1)],[new fte(1,1),new fte(-1,1)],[new fte(0,1),new fte(-1,0)],[new fte(-1,1),new fte(-1,-1)],[new fte(-1,0),new fte(0,-1)]];var Qce=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).isPlayer())return MB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE());var n=t.applyLegalDrop(e);if(0===n.neutralBlocks.length){if(e.blockTurned.isAbsent())return MB.failure(Yce.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(e.blockTurned.isPresent()){var r=e.blockTurned.get();if(n.neutralBlocks.includes(r))return MB.failure(Yce.CANNOT_ROTATE_NEUTRAL_BLOCK())}return MB.success(void 0)}},{key:"getVictoryCoords",value:function(e){var t,r=[],i=uy(n.VICTORY_SOURCE);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=e.getPieceAt(a[0]),s=[a[0]];if(o.isPlayer()){for(var u=a[0].getNext(a[1]),c=!0,l=0;l<3&&c;l++)e.getPieceAt(u)!==o?c=!1:(s.push(u),u=u.getNext(a[1]));if(c&&(e.getPieceAt(u)===o&&(s.push(u),r=r.concat(s)),a[2])){var f=a[0].getPrevious(a[1],1);e.getPieceAt(f)===o&&(s.push(f),r=r.concat(s))}}}}catch(h){i.e(h)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){for(var t=e.gameState,n=this.getVictoryCoords(t),r=[!1,!1],i=0;i<n.length;i+=5)r[t.getPieceAt(n[i]).value]=!0;return!0===r[0]?!0===r[1]?Lte.DRAW:Lte.ZERO_WON:!0===r[1]?Lte.ONE_WON:36===t.turn?Lte.DRAW:Lte.ONGOING}}],[{key:"get",value:function(){return n.singleton.isAbsent()&&(n.singleton=RB.of(new n(Kce))),n.singleton.get()}}]),n}(Fte);Qce.singleton=RB.empty(),Qce.VICTORY_SOURCE=[[new fte(1,0),new ate(1,1),!1],[new fte(0,1),new ate(1,1),!1],[new fte(4,0),new ate(-1,1),!1],[new fte(5,1),new ate(-1,1),!1],[new fte(1,1),new ate(1,1),!0],[new fte(4,1),new ate(-1,1),!0],[new fte(0,1),new ate(0,1),!0],[new fte(1,1),new ate(0,1),!0],[new fte(2,1),new ate(0,1),!0],[new fte(3,1),new ate(0,1),!0],[new fte(4,1),new ate(0,1),!0],[new fte(5,1),new ate(0,1),!0],[new fte(1,0),new ate(1,0),!0],[new fte(1,1),new ate(1,0),!0],[new fte(1,2),new ate(1,0),!0],[new fte(1,3),new ate(1,0),!0],[new fte(1,4),new ate(1,0),!0],[new fte(1,5),new ate(1,0),!0]];var Xce=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=[],r=e.gameState.neutralBlocks;if(0===e.gameState.turn)return n.FIRST_TURN_MOVES;var i,a=uy(this.getLegalDrops(e.gameState));try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=jce.rotationless(s.x,s.y),c=e.gameState.applyLegalDrop(u),l=uy(this.getLegalRotations(c,r));try{for(l.s();!(o=l.n()).done;){var f=o.value;t.push(jce.withRotation(s.x,s.y,f[0],f[1]))}}catch(h){l.e(h)}finally{l.f()}0===c.neutralBlocks.length==0&&t.push(u)}}catch(h){a.e(h)}finally{a.f()}return t}},{key:"getLegalDrops",value:function(e){for(var t=[],n=0;n<6;n++)for(var r=0;r<6;r++){var i=new fte(r,n);e.getPieceAt(i)===K7.NONE&&t.push(i)}return t}},{key:"getLegalRotations",value:function(e,t){for(var n=0===e.neutralBlocks.length,r=[],i=0;i<4;i++)!1===e.blockIsNeutral(i)&&(t.includes(i)?n&&r.push([i,!0]):r.push([i,!0],[i,!1]));return r}},{key:"getBoardValue",value:function(e){return new _te(Qce.get().getGameStatus(e).toBoardValue())}}]),n}(wte);Xce.FIRST_TURN_MOVES=[jce.rotationless(0,0),jce.rotationless(1,0),jce.rotationless(2,0),jce.rotationless(0,1),jce.rotationless(1,1),jce.rotationless(0,2)];var Jce=K7.NONE,ele=K7.ZERO,tle=K7.ONE,nle=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(yu||(yu=Hg(["Initial board"]))),$localize(mu||(mu=Hg(["The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate."]))),Kce.getInitialState()),zte.informational($localize(ku||(ku=Hg(["Goal of the game"]))),$localize(Cu||(Cu=Hg(["The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins."]))),new Kce([[ele,Jce,Jce,ele,tle,Jce],[ele,tle,Jce,Jce,Jce,Jce],[ele,Jce,tle,Jce,Jce,Jce],[ele,Jce,Jce,Jce,Jce,tle],[ele,Jce,Jce,Jce,tle,Jce],[Jce,Jce,Jce,Jce,Jce,Jce]],10)).withPreviousMove(jce.withRotation(0,0,0,!1)),zte.fromPredicate($localize(wu||(wu=Hg(["Simple move"]))),$localize(_u||(_u=Hg(["At their turn, players put a piece on the board and possibly rotate one quadrant.\n        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.\n        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>\n        Do it."]))),new Kce([[Jce,Jce,Jce,Jce,Jce,Jce],[Jce,ele,Jce,Jce,tle,Jce],[Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Jce,Jce,Jce],[Jce,tle,Jce,Jce,ele,Jce],[Jce,Jce,Jce,Jce,Jce,Jce]],10),jce.rotationless(2,2),function(e,t,n){return e.blockTurned.isPresent()?DB.failure($localize(Eu||(Eu=Hg(["You have made a move with a rotation. This tutorial step is about moves without rotations!"])))):DB.SUCCESS},$localize(bu||(bu=Hg(["Congratulations!"])))),zte.fromPredicate($localize(Su||(Su=Hg(["Move with rotation"]))),$localize(Pu||(Pu=Hg(["After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>\n        Click on one of them and see the rotation!"]))),new Kce([[Jce,Jce,Jce,Jce,Jce,Jce],[Jce,ele,Jce,Jce,tle,Jce],[Jce,Jce,Jce,Jce,Jce,Jce],[Jce,Jce,Jce,Jce,Jce,Jce],[Jce,tle,Jce,Jce,ele,Jce],[Jce,Jce,Jce,Jce,Jce,Jce]],10),jce.withRotation(0,0,0,!0),function(e,t,n){return e.blockTurned.isPresent()?DB.SUCCESS:DB.failure($localize(Ou||(Ou=Hg(["You made a move without rotation, try again!"]))))},$localize(Tu||(Tu=Hg(["Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation."]))))]});function rle(e,t){if(1&e){var n=SS();IC(),ES(0),CS(1,"circle",9),TS("click",function(){var e=eC(n).$implicit,t=RS().$implicit,r=RS().index,i=RS().index;return RS().onClick(3*r+e,3*i+t)}),wS(),bS()}if(2&e){var r=t.$implicit,i=RS().$implicit,a=RS(),o=a.index,s=a.$implicit,u=RS(),c=u.index,l=u.$implicit,f=RS();DE(1),NS("id","click_",3*o+r,"_",3*c+i,""),mS("ngClass",f.getSquareClasses(3*o+r,3*c+i)),lS("cx",s+2*f.STROKE_WIDTH+(r+.5)*f.SPACE_SIZE)("cy",l+2*f.STROKE_WIDTH+(i+.5)*f.SPACE_SIZE)("r",(f.SPACE_SIZE-f.STROKE_WIDTH)/2)}}var ile=function(){return[0,1,2]};function ale(e,t){1&e&&(IC(),ES(0),pS(1,rle,2,6,"ng-container",3),bS()),2&e&&(DE(1),mS("ngForOf",ST(1,ile)))}function ole(e,t){if(1&e&&(IC(),ES(0),_S(1,"rect",8),pS(2,ale,2,2,"ng-container",3),bS()),2&e){var n=t.$implicit,r=t.index,i=RS(),a=i.index,o=i.$implicit,s=RS();DE(1),mS("ngClass",s.getBlockClasses(r,a)),lS("x",s.STROKE_WIDTH+n)("y",s.STROKE_WIDTH+o)("rx",3*s.STROKE_WIDTH)("ry",3*s.STROKE_WIDTH)("width",s.BLOCK_WIDTH)("height",s.BLOCK_WIDTH),DE(1),mS("ngForOf",ST(8,ile))}}var sle=function(e){return[0,e]};function ule(e,t){if(1&e&&(IC(),ES(0),pS(1,ole,3,9,"ng-container",3),bS()),2&e){var n=RS();DE(1),mS("ngForOf",PT(1,sle,n.BLOCK_SEPARATION))}}function cle(e,t){if(1&e&&(IC(),_S(0,"circle",10)),2&e){var n=RS();NS("id","currentDrop_",n.currentDrop.get().x,"_",n.currentDrop.get().y,""),mS("ngClass",n.getPlayerClass(n.rules.node.gameState.getCurrentPlayer())),lS("cx",n.getCenter(n.currentDrop.get().x))("cy",n.getCenter(n.currentDrop.get().y))("r",(n.SPACE_SIZE-n.STROKE_WIDTH)/2)}}function lle(e,t){if(1&e){var n=SS();IC(),CS(0,"path",11),TS("click",function(){var e=eC(n).$implicit;return RS().rotate(e)}),wS()}if(2&e){var r=t.$implicit,i=RS();NS("id","rotate_",r[1],"_",r[2]?"clockwise":"counterclockwise",""),lS("d",r[0])("stroke-width",2*i.STROKE_WIDTH)}}function fle(e,t){if(1&e&&(IC(),_S(0,"circle",12)),2&e){var n=t.$implicit,r=RS();NS("id","victoryCoord_",n.x,"_",n.y,""),mS("ngClass",r.getSquareClasses(n.x,n.y)),lS("cx",r.getCenter(n.x))("cy",r.getCenter(n.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function hle(e,t){if(1&e){var n=SS();IC(),CS(0,"g",13),TS("click",function(){return eC(n),RS().skipRotation()}),_S(1,"circle",14),_S(2,"line",15),wS()}if(2&e){var r=RS();DE(1),lS("cx",r.BLOCK_SEPARATION)("cy",r.BLOCK_SEPARATION)("r",.75*r.SPACE_SIZE)("stroke-width",2*r.STROKE_WIDTH),DE(1),lS("x1",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("y1",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("x2",r.BLOCK_SEPARATION+r.DIAGONAL_BAR_OFFSET)("y2",r.BLOCK_SEPARATION-r.DIAGONAL_BAR_OFFSET)("stroke-width",2*r.STROKE_WIDTH)}}var dle=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).arrows=[],r.victoryCoords=[],r.rules=new Qce(Kce),r.availableMinimaxes=[new Xce(r.rules,"PentagoMinimax")],r.encoder=jce.encoder,r.tutorial=(new nle).tutorial,r.BLOCK_WIDTH=3*r.SPACE_SIZE+2*r.STROKE_WIDTH,r.BLOCK_SEPARATION=r.BLOCK_WIDTH+2*r.STROKE_WIDTH,r.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*r.SPACE_SIZE,r.ARROWS=r.generateArrowsCoord(),r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){this.board=this.rules.node.gameState.getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.rules.node.gameState),this.showLastMove()}},{key:"showLastMove",value:function(){var e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{var t=e.get();this.movedBlock=t.blockTurned;var n=new fte(t.coord.x%3-1,t.coord.y%3-1);if(t.blockTurned.isPresent()&&!1===n.equals(new fte(0,0))&&this.coordBelongToBlock(t)){var r;r=t.turnedClockwise?PB.getNonNullable(Kce.ROTATION_MAP.find(function(e){return e[0].equals(n)}))[1]:PB.getNonNullable(Kce.ROTATION_MAP.find(function(e){return e[1].equals(n)}))[0];var i=t.blockTurned.get();r=r.getNext(new ate(i%2==0?1:4,i<2?1:4),1),this.lastDrop=RB.of(r)}else this.lastDrop=RB.of(t.coord)}}},{key:"coordBelongToBlock",value:function(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}},{key:"hidePreviousMove",value:function(){this.lastDrop=RB.empty(),this.movedBlock=RB.empty(),this.victoryCoords=[]}},{key:"generateArrowsCoord",value:function(){var e=2*this.BLOCK_SEPARATION,t=this.SPACE_SIZE,n=.5*this.SPACE_SIZE;return[["M "+n+" 0 q "+t+" -"+t+" "+2*t+" 0",0,!0],["M 0 "+n+" q -"+t+" "+t+" 0 "+2*t,0,!1],["M "+e+" "+n+" q "+t+" "+t+" 0 "+2*t,1,!0],["M "+(e-n)+" 0 q -"+t+" -"+t+" -"+2*t+" 0",1,!1],["M 0 "+(e-n)+" q -"+t+" -"+t+" 0 -"+2*t,2,!0],["M "+n+" "+e+" q "+t+" "+t+" "+2*t+" 0",2,!1],["M "+(e-n)+" "+e+" q -"+t+" "+t+" -"+2*t+" 0",3,!0],["M "+e+" "+(e-n)+"  q "+t+" -"+t+" 0 -"+2*t,3,!1]]}},{key:"cancelMoveAttempt",value:function(){this.arrows=[],this.currentDrop=RB.empty(),this.canSkipRotation=!1}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(!n.board[t][e].isPlayer()){r.next=5;break}return r.abrupt("return",n.cancelMove(Cte.MUST_LAND_ON_EMPTY_SPACE()));case 5:if(a=jce.rotationless(e,t),o=n.rules.node.gameState,4!==(s=o.applyLegalDrop(a)).neutralBlocks.length){r.next=8;break}return r.abrupt("return",n.chooseMove(a,o));case 8:return u=n.rules.getGameStatus(n.rules.node),r.abrupt("return",(n.canSkipRotation=s.neutralBlocks.length>0&&!1===u.isEndGame,n.currentDrop=RB.of(new fte(e,t)),n.displayArrows(s.neutralBlocks),DB.SUCCESS));case 10:case"end":return r.stop()}},r)}))()}},{key:"getCenter",value:function(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}},{key:"displayArrows",value:function(e){var t=this;this.arrows=[];for(var n=function(n){if(!1===e.includes(n)){var r=t.ARROWS.filter(function(e){return e[1]===n});t.arrows=t.arrows.concat(r)}},r=0;r<4;r++)n(r)}},{key:"getBlockClasses",value:function(e,t){return this.movedBlock.equalsValue(e+2*t)?["moved"]:[]}},{key:"getSquareClasses",value:function(e,t){var n=[],r=this.getPlayerClass(this.board[t][e]);return n.push(r),this.lastDrop.equalsValue(new fte(e,t))&&n.push("last-move"),n}},{key:"rotate",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"))).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return i=t.currentDrop.get(),a=jce.withRotation(i.x,i.y,e[1],e[2]),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 5:case"end":return n.stop()}},n)}))()}},{key:"skipRotation",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.canUserPlay("#skipRotation")).isFailure()){t.next=3;break}return t.abrupt("return",e.cancelMove(n.getReason()));case 3:return r=e.currentDrop.get(),i=jce.rotationless(r.x,r.y),t.abrupt("return",e.chooseMove(i,e.rules.node.gameState));case 5:case"end":return t.stop()}},t)}))()}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-pentago"]],features:[Qb],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"defs"),CS(2,"marker",1),_S(3,"polygon",2),wS(),wS(),pS(4,ule,2,3,"ng-container",3),pS(5,cle,1,6,"circle",4),pS(6,lle,1,4,"path",5),pS(7,fle,1,7,"circle",6),pS(8,hle,3,9,"g",7),wS()),2&e&&(DE(4),mS("ngForOf",PT(5,sle,t.BLOCK_SEPARATION)),DE(1),mS("ngIf",t.currentDrop.isPresent()),DE(1),mS("ngForOf",t.arrows),DE(1),mS("ngForOf",t.victoryCoords),DE(1),mS("ngIf",t.canSkipRotation))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),vle=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;if(fy(this,n),(a=t.call(this,e,r)).z=i,e<0||e>3)throw new Error("PylosCoord: Invalid X: ".concat(e,"."));if(r<0||r>3)throw new Error("PylosCoord: Invalid Y: ".concat(r,"."));if(i<0||i>3)throw new Error("PylosCoord: Invalid Z: ".concat(i,"."));var o=4-i;if(a.isNotInRange(o,o))throw new Error(a.toString()+" is not in range.");return ny(a)}return dy(n,[{key:"toString",value:function(){return"PylosCoord"+this.toShortString()}},{key:"toShortString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"equals",value:function(e){return this===e||e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"isUpperThan",value:function(e){return this.z>e.z}},{key:"getLowerPieces",value:function(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");var e=this.z-1;return[new n(this.x,this.y,e),new n(this.x+1,this.y,e),new n(this.x,this.y+1,e),new n(this.x+1,this.y+1,e)]}},{key:"getHigherCoords",value:function(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");var e=this.z+1,t=new fte(this.x-1,this.y-1),r=new fte(this.x,this.y-1),i=new fte(this.x-1,this.y),a=new fte(this.x,this.y),o=4-e;return[t,r,i,a].filter(function(e){return e.isInRange(o,o)}).map(function(t){return new n(t.x,t.y,e)})}},{key:"getNextValid",value:function(e){var t=new fte(this.x,this.y).getNext(e),r=4-this.z;return t.isNotInRange(r,r)?RB.empty():RB.of(new n(t.x,t.y,this.z))}}],[{key:"encodeOptional",value:function(e){return e.isPresent()?n.encode(e.get())+1:0}},{key:"encode",value:function(e){return 16*e.x+4*e.y+e.z}},{key:"decodeToOptional",value:function(e){return 0===e?RB.empty():RB.of(n.decode(e-1))}},{key:"decode",value:function(e){var t=e%4;e-=t;var r=(e/=4)%4;return e-=r,new n(e/=4,r,t)}}]),n}(fte),ple=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this)).startingCoord=e,o.landingCoord=r,o.firstCapture=i,o.secondCapture=a,o}return dy(n,[{key:"isClimb",value:function(){return this.startingCoord.isPresent()}},{key:"toString",value:function(){var e=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),t=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),n=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+e+", "+this.landingCoord.toShortString()+", "+t+", "+n+")"}},{key:"equals",value:function(e){return e===this||!!(this.startingCoord.equals(e.startingCoord)&&this.landingCoord.equals(e.landingCoord)&&this.firstCapture.equals(e.firstCapture)&&this.secondCapture.equals(e.secondCapture))}}],[{key:"fromClimb",value:function(e,t,r){var i=RB.of(e),a=n.checkCaptures(r),o=new n(i,t,a.firstCapture,a.secondCapture);if(!t.isUpperThan(e))throw new Error("PylosMove: When piece move it must move upward.");return o}},{key:"checkCaptures",value:function(e){var t=RB.empty(),n=RB.empty();if(e.length>0&&(t=RB.of(e[0]),e.length>1)){if(e[1].equals(e[0]))throw new Error("PylosMove: should not capture twice same piece.");if(n=RB.of(e[1]),e[1].isUpperThan(e[0])&&(t=RB.of(e[1]),n=RB.of(e[0])),e.length>2)throw new Error("PylosMove: can't capture that much piece.")}return{firstCapture:t,secondCapture:n}}},{key:"fromDrop",value:function(e,t){var r=RB.empty(),i=n.checkCaptures(t);return new n(r,e,i.firstCapture,i.secondCapture)}},{key:"changeCapture",value:function(e,t){var r=n.checkCaptures(t);return new n(e.startingCoord,e.landingCoord,r.firstCapture,r.secondCapture)}}]),n}(Tte);ple.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 17575999}},{key:"encodeNumber",value:function(e){var t=vle.encode(e.landingCoord),n=vle.encodeOptional(e.startingCoord),r=vle.encodeOptional(e.firstCapture);return 270400*vle.encodeOptional(e.secondCapture)+4160*r+64*n+t}},{key:"decodeNumber",value:function(e){var t=vle.decode(e%64);e-=e%64;var n=vle.decodeToOptional((e/=64)%65);e-=e%65;var r=vle.decodeToOptional((e/=65)%65);e-=e%65;var i=vle.decodeToOptional(e/=65);return new ple(n,t,r,i)}}]),n}(j7));var gle=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,r)).boards=e,i}return dy(n,[{key:"getPieceAt",value:function(e){return this.boards[e.z][e.y][e.x]}},{key:"applyLegalMove",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[];return r.push({coord:e.landingCoord,value:this.getCurrentPlayer()}),e.startingCoord.isPresent()&&r.push({coord:e.startingCoord.get(),value:K7.NONE}),e.firstCapture.isPresent()&&r.push({coord:e.firstCapture.get(),value:K7.NONE}),e.secondCapture.isPresent()&&r.push({coord:e.secondCapture.get(),value:K7.NONE}),t=n?this.turn+1:this.turn,this.setBoardAts(r,t)}},{key:"setBoardAts",value:function(e,t){var r,i=[t9.copyBiArray(this.boards[0]),t9.copyBiArray(this.boards[1]),t9.copyBiArray(this.boards[2]),t9.copyBiArray(this.boards[3])],a=uy(e);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=o.coord;i[s.z][s.y][s.x]=o.value}}catch(u){a.e(u)}finally{a.f()}return new n(i,t)}},{key:"isLandable",value:function(e){if(this.getPieceAt(e).isPlayer())return!1;if(0===e.z)return!0;var t,n=uy(e.getLowerPieces());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r)===K7.NONE)return!1}}catch(i){n.e(i)}finally{n.f()}return!0}},{key:"isSupporting",value:function(e){if(3===e.z)return!1;var t,n=uy(e.getHigherCoords());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.getPieceAt(r).isPlayer())return!0}}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"getPiecesRepartition",value:function(){var e={};e[K7.NONE.value]=0,e[Q7.ZERO.value]=0,e[Q7.ONE.value]=0;for(var t=0;t<3;t++)for(var n=0;n<4-t;n++)for(var r=0;r<4-t;r++){var i=new vle(r,n,t),a=this.getPieceAt(i);e[a.value]=1+e[a.value]}return e}},{key:"removeCoord",value:function(e){return this.setBoardAts([{coord:e,value:K7.NONE}],this.turn)}},{key:"applyDrop",value:function(e){var t={coord:e,value:this.getCurrentPlayer()};return this.setBoardAts([t],this.turn)}},{key:"getFreeToMoves",value:function(){for(var e=[],t=this.getCurrentPlayer(),r=0;r<=2;r++){var i,a=n.getLevelRange(r),o=uy(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=uy(a);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=new vle(l,u,r);this.getPieceAt(f).equals(t)&&!1===this.isSupporting(f)&&e.push(f)}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}}return e}}],[{key:"getInitialState",value:function(){return new n([t9.createTable(4,4,K7.NONE),t9.createTable(3,3,K7.NONE),t9.createTable(2,2,K7.NONE),[[K7.NONE]]],0)}},{key:"getLevelRange",value:function(e){switch(e){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return PB.expectToBe(e,2),[0,1]}}}]),n}(Ste),yle=function(){var e=dy(function e(){fy(this,e)});return e.MUST_MOVE_UPWARD=function(){return $localize(Iu||(Iu=Hg(["You must move your pieces upward."])))},e.SHOULD_HAVE_SUPPORTING_PIECES=function(){return $localize(Au||(Au=Hg(["Your piece must land on the board or on 4 other pieces."])))},e.CANNOT_MOVE_SUPPORTING_PIECE=function(){return $localize(Ru||(Ru=Hg(["You cannot move a supporting piece."])))},e.CANNOT_CAPTURE=function(){return $localize(Mu||(Mu=Hg(["You cannot capture."])))},e.INVALID_FIRST_CAPTURE=function(){return $localize(xu||(xu=Hg(["Your first capture is invalid."])))},e.INVALID_SECOND_CAPTURE=function(){return $localize(Nu||(Nu=Hg(["Your second capture is invalid."])))},e}(),mle=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){var n=this.isLegalStartingCoord(e,t);if(n.isFailure())return MB.failure(n.getReason());var r=n.get(),i=this.isLegalLandingCoord(e,r);if(i.isFailure())return MB.failure(i.getReason());var a=i.get(),o=this.isLegalCaptures(e,a);return o.isFailure()?o:MB.success(void 0)}},{key:"isLegalStartingCoord",value:function(e,t){var n=t.getCurrentOpponent();if(e.startingCoord.isPresent()){var r=e.startingCoord.get(),i=t.getPieceAt(r);if(i===n)return MB.failure(Cte.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===K7.NONE)return MB.failure(Cte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===r.getHigherCoords().filter(function(e){return t.getPieceAt(e).isPlayer()}).length){var a=t.removeCoord(e.startingCoord.get());return MB.success(a)}return MB.failure(yle.CANNOT_MOVE_SUPPORTING_PIECE())}return MB.success(t)}},{key:"isLegalLandingCoord",value:function(e,t){return t.getPieceAt(e.landingCoord).isPlayer()?MB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE()):t.isLandable(e.landingCoord)?MB.success(t.applyDrop(e.landingCoord)):MB.failure(yle.SHOULD_HAVE_SUPPORTING_PIECES())}},{key:"isLegalCaptures",value:function(e,t){if(e.firstCapture.isAbsent())return MB.success(void 0);if(!1===n.canCapture(t,e.landingCoord))return MB.failure(yle.CANNOT_CAPTURE());if(n.isValidCapture(t,e,e.firstCapture.get())){var r=t.removeCoord(e.firstCapture.get());return e.secondCapture.isAbsent()||n.isValidCapture(r,e,e.secondCapture.get())?MB.success(void 0):MB.failure(yle.INVALID_SECOND_CAPTURE())}return MB.failure(yle.INVALID_FIRST_CAPTURE())}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}}],[{key:"getStateInfo",value:function(e){for(var t=[],n=[],r=0;r<3;r++)for(var i=0;i<4-r;i++)for(var a=0;a<4-r;a++){var o=new vle(a,i,r);e.getPieceAt(o)===e.getCurrentPlayer()&&!1===e.isSupporting(o)&&t.push(o),e.isLandable(o)&&n.push(o)}return{freeToMove:t,landable:n}}},{key:"getClimbingMoves",value:function(e){var t,n=[],r=uy(e.freeToMove);try{var i=function(){var r,i=t.value,a=uy(e.landable);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.isUpperThan(i)&&!1===o.getLowerPieces().some(function(e){return i.equals(e)})){var s=ple.fromClimb(i,o,[]);n.push(s)}}}catch(u){a.e(u)}finally{a.f()}};for(r.s();!(t=r.n()).done;)i()}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getDropMoves",value:function(e){var t,n=[],r=uy(e.landable);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=ple.fromDrop(i,[]);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"canCapture",value:function(e,t){for(var n=e.getCurrentPlayer(),r=0,i=[cte.UP,cte.DOWN];r<i.length;r++){var a=i[r],o=t.getNextValid(a);if(o.isPresent()&&e.getPieceAt(o.get())===n)for(var s=0,u=[cte.LEFT,cte.RIGHT];s<u.length;s++){var c=u[s],l=o.get().getNextValid(c);if(l.isPresent()&&e.getPieceAt(l.get())===n){var f=a.getOpposite(),h=l.get().getNextValid(f).get();if(e.getPieceAt(h)===n)return!0}}}return!1}},{key:"getPossibleCaptures",value:function(e){var t,n=new bte,r=uy(e.getFreeToMoves());try{for(r.s();!(t=r.n()).done;){var i=t.value;n.add(new bte([i]));var a,o=uy(e.removeCoord(i).getFreeToMoves());try{for(o.s();!(a=o.n()).done;){var s=a.value,u=new bte([i,s]);n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}},{key:"isValidCapture",value:function(e,t,n){var r=e.getCurrentPlayer();return!(!n.equals(t.landingCoord)&&e.getPieceAt(n)!==r)&&0===n.getHigherCoords().filter(function(n){return e.getPieceAt(n).isPlayer()&&!1===n.equals(t.firstCapture.get())}).length}},{key:"getGameStatus",value:function(e){var t=e.gameState.getPiecesRepartition();return 15===t[Q7.ZERO.value]?Lte.ONE_WON:15===t[Q7.ONE.value]?Lte.ZERO_WON:Lte.ONGOING}}]),n}(Fte),kle=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){return n.getListMoves(e)}},{key:"getBoardValue",value:function(e){var t=mle.getGameStatus(e);if(t.isEndGame)return new _te(t.toBoardValue());var n=e.gameState.getPiecesRepartition();return new _te(n[Q7.ZERO.value]-n[Q7.ONE.value])}}],[{key:"getListMoves",value:function(e){var t,n=e.gameState,r=[],i=mle.getStateInfo(n),a=mle.getClimbingMoves(i),o=mle.getDropMoves(i),s=uy(a.concat(o));try{for(s.s();!(t=s.n()).done;){var u=t.value,c=n.applyLegalMove(u,!1),l=new bte;mle.canCapture(c,u.landingCoord)?l=mle.getPossibleCaptures(c):r.push(u);var f,h=uy(l);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=ple.changeCapture(u,d.toList());r.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return r}}]),n}(wte),Cle=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t=kle.getListMoves(e);return this.orderMoves(t)}},{key:"orderMoves",value:function(e){return e.sort(function(e,t){var r=12*n.countStoneUsed(e),i=12*n.countStoneUsed(t);return r+n.sumMoveEmplacementByValue(e)-(i+n.sumMoveEmplacementByValue(t))})}}],[{key:"countStoneUsed",value:function(e){var t=e.isClimb()?0:1;return e.firstCapture.isPresent()&&(t-=1,e.secondCapture.isPresent()&&(t-=1)),t}},{key:"sumMoveEmplacementByValue",value:function(e){var t=e.landingCoord.z;return e.startingCoord.isPresent()&&(t+=3-e.startingCoord.get().z),e.firstCapture.isPresent()&&(t+=3-e.firstCapture.get().z,e.secondCapture.isPresent()&&(t+=3-e.secondCapture.get().z)),t}}]),n}(kle),wle=K7.NONE,_le=K7.ZERO,Ele=K7.ONE,ble=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Du||(Du=Hg(["Goal of the game"]))),$localize(Lu||(Lu=Hg(["At Pylos, the goal is to be the last to play.\n        To do this, you have to save up your pieces.\n        As soon as a player puts its last piece, that player loses the game immediately.\n        Here is what the initial board looks like, it is a board of 4 x 4 squares.\n        This board will become a pyramid, little by little.\n        It will be filled by the pieces of your stock. Each player has 15 pieces."]))),gle.getInitialState()),zte.anyMove($localize(Fu||(Fu=Hg(["Dropping a piece"]))),$localize(Uu||(Uu=Hg(["When it is your turn, you can always drop one of your piece on an empty square.\n        The gray squares are where you can drop your pieces.<br/><br/>\n        Click on one of the squares to drop a piece there."]))),gle.getInitialState(),ple.fromDrop(new vle(1,1,0),[]),$localize(Vu||(Vu=Hg(["There you go, as simple as that."])))),zte.fromMove($localize(Bu||(Bu=Hg(["Climbing"]))),$localize(zu||(zu=Hg(["When 4 pieces form a square, it is possible to put a fifth piece on top.\n        However, when that happens, you can save a piece by climbing instead of dropping a piece.\n        To climb:\n        <ol>\n            <li>Click on one of your free pieces, which should be lower than the landing square.</li>\n            <li>Click on an empty landing square, higher than your selected piece.</li>\n        </ol><br/>\n        Go ahead, climb!"]))),new gle([[[_le,Ele,wle,wle],[Ele,_le,wle,wle],[wle,wle,wle,wle],[wle,wle,wle,_le]],[[wle,wle,wle],[wle,wle,wle],[wle,wle,wle]],[[wle,wle],[wle,wle]],[[wle]]],0),[ple.fromClimb(new vle(3,3,0),new vle(0,0,1),[])],$localize(Hu||(Hu=Hg(["Congratulations!<br/>\n        Some important notes:\n        <ol>\n            <li>You cannot move a piece that is directly below another one.</li>\n            <li>Of course, you cannot move the opponent's pieces.</li>\n            <li>You can only climb when the landing square is higher than the starting square.</li>\n        </ol>"]))),$localize(Gu||(Gu=Hg(["Failed!"])))),zte.fromMove($localize($u||($u=Hg(["Square (1/2)"]))),$localize(Zu||(Zu=Hg(["When the piece you just moved or dropped is the fourth one of a square of your color,\n        you can choose anywhere on the board one or two of your pieces.\n        These pieces will be removed from the board, allowing you to save up one or two pieces.\n        A chosen piece must not be directly below another piece.\n        A chosen piece can be the piece you just placed.\n        You're playing Dark.<br/><br/>\n        Form a square, then click twice on one of the four pieces to remove only that one."]))),new gle([[[_le,_le,wle,wle],[wle,_le,wle,wle],[wle,wle,wle,wle],[wle,wle,wle,wle]],[[wle,wle,wle],[wle,wle,wle],[wle,wle,wle]],[[wle,wle],[wle,wle]],[[wle]]],0),[ple.fromDrop(new vle(0,1,0),[new vle(0,0,0)]),ple.fromDrop(new vle(0,1,0),[new vle(0,1,0)]),ple.fromDrop(new vle(0,1,0),[new vle(1,0,0)]),ple.fromDrop(new vle(0,1,0),[new vle(1,1,0)])],$localize(qu||(qu=Hg(["Congratulations, you have saved up one piece."]))),$localize(Wu||(Wu=Hg(["Failed!"])))),zte.fromPredicate($localize(ju||(ju=Hg(["Square (2/2)"]))),$localize(Yu||(Yu=Hg(["You're playing Dark.<br/><br/>\n        Do like in the previous step, but this time click on two different pieces."]))),new gle([[[_le,_le,wle,wle],[wle,_le,wle,wle],[wle,wle,wle,wle],[wle,wle,wle,wle]],[[wle,wle,wle],[wle,wle,wle],[wle,wle,wle]],[[wle,wle],[wle,wle]],[[wle]]],0),ple.fromDrop(new vle(0,1,0),[new vle(0,0,0),new vle(1,0,0)]),function(e,t,n){return e.secondCapture.isPresent()?DB.SUCCESS:e.firstCapture.isPresent()?DB.failure($localize(Ku||(Ku=Hg(["Failed, you only captured one piece."])))):DB.failure(jue.YOU_DID_NOT_CAPTURE_ANY_PIECE())},$localize(Qu||(Qu=Hg(["Congratulations, you have saved up two pieces."]))))]});function Sle(e,t){if(1&e&&(IC(),_S(0,"circle",6)),2&e){var n=t.$implicit,r=RS().$implicit,i=RS();NS("id","piece_",r.value,"_",n,""),mS("ngClass",i.getPlayerClass(r)),lS("cx",i.SPACE_SIZE/2+i.STROKE_WIDTH/2+(800-i.SPACE_SIZE)/14*n)("cy",i.getPiecesCyForPlayer(r))("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)}}function Ple(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Sle,1,6,"circle",5),wS()),2&e){var n=t.$implicit,r=RS();DE(1),mS("ngForOf",r.getPlayerSidePieces(n))}}function Ole(e,t){if(1&e){var n=SS();IC(),CS(0,"circle",10),TS("click",function(){eC(n);var e=RS(2).$implicit,t=RS().$implicit,r=RS().$implicit;return RS().onPieceClick(e,t,r)}),wS()}if(2&e){var r=RS(2).$implicit,i=RS().$implicit,a=RS().$implicit,o=RS();DS("id","piece_",r,"_",i,"_",a,""),mS("ngClass",o.getPieceClasses(r,i,a)),lS("r",o.getPieceRadius(a)-o.STROKE_WIDTH)("cx",o.getPieceCx(r,i,a))("cy",o.getPieceCy(r,i,a))}}function Tle(e,t){if(1&e){var n=SS();IC(),CS(0,"rect",10),TS("click",function(){eC(n);var e=RS(2).$implicit,t=RS().$implicit,r=RS().$implicit;return RS().onDrop(e,t,r)}),wS()}if(2&e){var r=RS(2).$implicit,i=RS().$implicit,a=RS().$implicit,o=RS();DS("id","drop_",r,"_",i,"_",a,""),mS("ngClass",o.getSquareClasses(r,i,a)),lS("width",2*o.getPieceRadius(a))("height",2*o.getPieceRadius(a))("x",o.getPieceCx(r,i,a)-o.getPieceRadius(a))("y",o.getPieceCy(r,i,a)-o.getPieceRadius(a))}}function Ile(e,t){if(1&e&&(IC(),ES(0),pS(1,Ole,1,7,"circle",8),pS(2,Tle,1,8,"ng-template",null,9,XT),bS()),2&e){var n=gS(3),r=RS().$implicit,i=RS().$implicit,a=RS().$implicit,o=RS();DE(1),mS("ngIf",o.isOccupied(r,i,a))("ngIfElse",n)}}function Ale(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Ile,4,2,"ng-container",7),wS()),2&e){var n=t.$implicit,r=RS().$implicit,i=RS().$implicit,a=RS();DE(1),mS("ngIf",a.mustDraw(n,r,i))}}function Rle(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Ale,2,1,"g",1),wS()),2&e){var n=RS().$implicit,r=RS();DE(1),mS("ngForOf",r.getLevelRange(n))}}function Mle(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Rle,2,1,"g",1),wS()),2&e){var n=t.$implicit,r=RS();DE(1),mS("ngForOf",r.getLevelRange(n))}}function xle(e,t){if(1&e&&(IC(),_S(0,"rect",11)),2&e){var n=RS();DS("id","highCapture_",n.highCapture.get().x,"_",n.highCapture.get().y,"_",n.highCapture.get().z,""),lS("width",2*n.getPieceRadius(n.highCapture.get().z))("height",2*n.getPieceRadius(n.highCapture.get().z))("x",n.getPieceCx(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))("y",n.getPieceCy(n.highCapture.get().x,n.highCapture.get().y,n.highCapture.get().z)-n.getPieceRadius(n.highCapture.get().z))}}var Nle=function(){return[0,1,2]},Dle=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).BOARD_WIDTH=808,r.PIECE_ROW_HEIGHT=r.SPACE_SIZE,r.BOARD_HEIGHT=r.BOARD_WIDTH+2*r.PIECE_ROW_HEIGHT,r.lastLandingCoord=RB.empty(),r.lastStartingCoord=RB.empty(),r.lastFirstCapture=RB.empty(),r.lastSecondCapture=RB.empty(),r.highCapture=RB.empty(),r.chosenStartingCoord=RB.empty(),r.chosenLandingCoord=RB.empty(),r.chosenFirstCapture=RB.empty(),r.lastMove=RB.empty(),r.remainingPieces={0:15,1:15},r.hasAsymetricBoard=!0,r.rules=new mle(gle),r.availableMinimaxes=[new kle(r.rules,"PylosMinimax"),new Cle(r.rules,"PylosOrderedMinimax")],r.encoder=ple.encoder,r.tutorial=(new ble).tutorial,r.SPACE_SIZE=r.getPieceRadius(0),r.updateBoard(),r}return dy(n,[{key:"getPiecesCyForPlayer",value:function(e){return e===Q7.ONE?this.PIECE_ROW_HEIGHT/2:this.BOARD_WIDTH+1.5*this.PIECE_ROW_HEIGHT}},{key:"getLevelRange",value:function(e){return gle.getLevelRange(e)}},{key:"mustDraw",value:function(e,t,n){var r=new vle(e,t,n);return!!(this.constructedState.getPieceAt(r).isPlayer()||this.justClimbed(r)||this.isCaptured(r))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(r)}},{key:"isCaptured",value:function(e){return this.chosenFirstCapture.equalsValue(e)}},{key:"onPieceClick",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#piece_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new vle(e,t,n),i.abrupt("return",r.state.getPieceAt(o)===r.state.getCurrentOpponent()?r.cancelMove(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()):r.isSupporting(o)?r.cancelMove(yle.CANNOT_MOVE_SUPPORTING_PIECE()):r.chosenStartingCoord.equalsValue(o)?(r.cancelMoveAttempt(),DB.SUCCESS):r.chosenLandingCoord.isAbsent()?r.onClimbClick(o):r.onCaptureClick(o));case 5:case"end":return i.stop()}},i)}))()}},{key:"isSupporting",value:function(e){return this.constructedState.isSupporting(e)}},{key:"onClimbClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(t.chosenStartingCoord=RB.of(e),t.constructedState=t.constructedState.removeCoord(e),DB.SUCCESS));case 1:case"end":return n.stop()}},n)}))()}},{key:"onCaptureClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.chosenFirstCapture.isAbsent()?(t.chosenFirstCapture=RB.of(e),t.constructedState=t.constructedState.removeCoord(e),DB.SUCCESS):t.chosenFirstCapture.equalsValue(e)?t.concludeMoveWithCapture([t.chosenFirstCapture.get()]):t.concludeMoveWithCapture([t.chosenFirstCapture.get(),e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"concludeMoveWithCapture",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(r=t.chosenStartingCoord.isAbsent()?ple.fromDrop(t.chosenLandingCoord.get(),e):ple.fromClimb(t.chosenStartingCoord.get(),t.chosenLandingCoord.get(),e),t.tryMove(r,t.state)));case 1:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",(n.cancelMove(),n.chooseMove(e,t)));case 1:case"end":return r.stop()}},r)}))()}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.state,this.chosenStartingCoord=RB.empty(),this.chosenLandingCoord=RB.empty(),this.chosenFirstCapture=RB.empty()}},{key:"onDrop",value:function(e,t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!(a=r.canUserPlay("#drop_"+e+"_"+t+"_"+n)).isFailure()){i.next=3;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 3:return o=new vle(e,t,n),i.abrupt("return",mle.canCapture(r.constructedState,o)?(r.chosenLandingCoord=RB.of(o),r.constructedState=r.constructedState.applyDrop(o),DB.SUCCESS):r.isCapturelessMoveFinished(o)?(r.chosenLandingCoord=RB.of(o),r.concludeMoveWithCapture([])):r.cancelMove(yle.MUST_MOVE_UPWARD()));case 5:case"end":return i.stop()}},i)}))()}},{key:"isCapturelessMoveFinished",value:function(e){return!!this.chosenStartingCoord.isAbsent()||e.isUpperThan(this.chosenStartingCoord.get())}},{key:"getSquareClasses",value:function(e,t,n){var r=new vle(e,t,n);if(this.lastMove.isPresent()){var i=this.lastMove.get();if(i.firstCapture.equalsValue(r)||i.secondCapture.equalsValue(r))return["captured"];if(r.equals(i.landingCoord)||i.startingCoord.equalsValue(r))return["moved"]}else if(this.justClimbed(r))return["moved"];return[]}},{key:"justClimbed",value:function(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}},{key:"getPieceRadius",value:function(e){return 90+5*e}},{key:"getPieceCx",value:function(e,t,n){return 100+100*n+200*e}},{key:"getPieceCy",value:function(e,t,n){return 100+100*n+200*t}},{key:"isOccupied",value:function(e,t,n){var r=new vle(e,t,n);if(this.justClimbed(r))return!1;var i=this.rules.node.gameState.getPieceAt(r).isPlayer(),a=this.chosenLandingCoord.equalsValue(r);return i||a}},{key:"getPieceClasses",value:function(e,t,n){var r=new vle(e,t,n),i=[this.getPieceFillClass(r)];return(this.lastLandingCoord.equalsValue(r)||this.lastStartingCoord.equalsValue(r))&&i.push("highlighted"),(this.chosenStartingCoord.equalsValue(r)||this.chosenLandingCoord.equalsValue(r))&&i.push("selected"),this.chosenFirstCapture.equalsValue(r)&&i.push("pre-captured"),i}},{key:"getPieceFillClass",value:function(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}},{key:"getPlayerSidePieces",value:function(e){for(var t=this.remainingPieces[e.value],n=[],r=0;r<t;r++)n.push(r);return n}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.constructedState=this.state,this.lastMove=this.rules.node.move;var e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=RB.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}},{key:"showLastMove",value:function(){var e=this.lastMove.get();this.lastLandingCoord=RB.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}},{key:"hideLastMove",value:function(){this.lastStartingCoord=RB.empty(),this.lastLandingCoord=RB.empty(),this.lastFirstCapture=RB.empty(),this.lastSecondCapture=RB.empty()}},{key:"mustDrawCoord",value:function(e){return this.mustDraw(e.x,e.y,e.z)}}]),n}(hte);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-pylos"]],features:[Qb],decls:7,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0","width","800","height","800",1,"base"],["class","base captured",3,"id",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","mid-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base",3,"id","ngClass","click"],[1,"base","captured",3,"id"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,Ple,2,1,"g",1),CS(2,"g",null,2),_S(4,"rect",3),pS(5,Mle,2,1,"g",1),pS(6,xle,1,7,"rect",4),wS(),wS()),2&e&&(lS("viewBox","0 0 "+t.BOARD_WIDTH+" "+t.BOARD_HEIGHT)("transform",t.rotation),DE(1),mS("ngForOf",t.Player.PLAYERS),DE(1),lS("transform","translate("+t.STROKE_WIDTH/2+" "+(t.STROKE_WIDTH/2+t.PIECE_ROW_HEIGHT)+")"),DE(3),mS("ngForOf",ST(6,Nle)),DE(1),mS("ngIf",t.highCapture.isPresent()))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Lle=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"equals",value:function(e){return this===e}},{key:"toString",value:function(){return"QuartoPiece("+this.value+")"}},{key:"isRectangle",value:function(){return this.value%4<2}}],[{key:"fromInt",value:function(t){if(0<=t&&t<=15)return e.pieces[t];if(16===t)return e.EMPTY;throw new Error("Invalid piece ("+t+")")}}]),e}();Lle.AAAA=new Lle(0),Lle.AAAB=new Lle(1),Lle.AABA=new Lle(2),Lle.AABB=new Lle(3),Lle.ABAA=new Lle(4),Lle.ABAB=new Lle(5),Lle.ABBA=new Lle(6),Lle.ABBB=new Lle(7),Lle.BAAA=new Lle(8),Lle.BAAB=new Lle(9),Lle.BABA=new Lle(10),Lle.BABB=new Lle(11),Lle.BBAA=new Lle(12),Lle.BBAB=new Lle(13),Lle.BBBA=new Lle(14),Lle.BBBB=new Lle(15),Lle.EMPTY=new Lle(16),Lle.pieces=[Lle.AAAA,Lle.AAAB,Lle.AABA,Lle.AABB,Lle.ABAA,Lle.ABAB,Lle.ABBA,Lle.ABBB,Lle.BAAA,Lle.BAAB,Lle.BABA,Lle.BABB,Lle.BBAA,Lle.BBAB,Lle.BBBA,Lle.BBBB];var Fle=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).piece=i,a}return dy(n,[{key:"toString",value:function(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}},{key:"equals",value:function(e){return this===e||!!e.coord.equals(this.coord)&&this.piece===e.piece}}]),n}(Ite);Fle.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 496}},{key:"encodeNumber",value:function(e){return 128*e.coord.x+32*e.coord.y+e.piece.value}},{key:"decodeNumber",value:function(e){var t=e%32;e-=t;var n=(e/=32)%4;return e-=n,new Fle(e/=4,n,Lle.fromInt(t))}}]),n}(j7));var Ule=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,e,r)).pieceInHand=i,a}return dy(n,[{key:"getRemainingPieces",value:function(){var e,t=[],r=uy(Lle.pieces);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.isGivable(i,this.board,this.pieceInHand)&&t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"getInitialState",value:function(){return new n(t9.createTable(4,4,Lle.EMPTY),0,Lle.AAAA)}},{key:"isGivable",value:function(e,t,r){return e!==r&&!1===n.isAlreadyOnBoard(e,t)}},{key:"isAlreadyOnBoard",value:function(e,t){for(var n=0;n<4;n++)for(var r=0;r<4;r++)if(t[n][r]===e)return!0;return!1}}]),n}(Pte),Vle=function(){var e=dy(function e(){fy(this,e)});return e.MUST_GIVE_A_PIECE=function(){return $localize(Xu||(Xu=Hg(["You must give a piece."])))},e.PIECE_ALREADY_ON_BOARD=function(){return $localize(Ju||(Ju=Hg(["That piece is already on the board."])))},e.CANNOT_GIVE_PIECE_IN_HAND=function(){return $localize(ec||(ec=Hg(["You cannot give the piece that was in your hands."])))},e}(),Ble=function(){function e(t){fy(this,e),this.subCriterion=[RB.empty(),RB.empty(),RB.empty(),RB.empty()],this.subCriterion[0]=RB.of(8==(8&t.value)),this.subCriterion[1]=RB.of(4==(4&t.value)),this.subCriterion[2]=RB.of(2==(2&t.value)),this.subCriterion[3]=RB.of(1==(1&t.value))}return dy(e,[{key:"mergeWith",value:function(e){for(var t=4,n=0;n<4;n++)!1===this.subCriterion[n].equals(e.subCriterion[n])&&(this.subCriterion[n]=RB.empty()),this.subCriterion[n].isAbsent()&&t--;return t>0}},{key:"mergeWithQuartoPiece",value:function(t){var n=new e(t);return this.mergeWith(n)}},{key:"areAllAbsent",value:function(){for(var e=0;e<4;e++)if(this.subCriterion[e].isPresent())return!1;return!0}},{key:"match",value:function(e){for(var t=0;t<4;t++)if(this.subCriterion[t].equals(e.subCriterion[t]))return!0;return!1}},{key:"matchPiece",value:function(t){return this.match(new e(t))}},{key:"toString",value:function(){return"Criterion{"+this.subCriterion.map(function(e){return e.isPresent()?e.get()?"1":"0":"x"}).join(" ")+"}"}}]),e}(),zle=function(){function e(t,n){fy(this,e),this.initialCoord=t,this.direction=n}return dy(e,[{key:"allCoords",value:function(){for(var e=[],t=0;t<4;t++)e.push(this.initialCoord.getNext(this.direction,t));return e}}]),e}(),Hle=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isLegal",value:function(e,t){return n.isLegal(e,t).toFallible(void 0)}},{key:"applyLegalMove",value:function(e,t){var n=t.getCopiedBoard();return n[e.coord.y][e.coord.x]=t.pieceInHand,new Ule(n,t.turn+1,e.piece)}},{key:"getGameStatus",value:function(e){var t,r=e.gameState,i={score:Rte.DEFAULT,sensitiveSquares:new Wne},a=uy(n.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=n.updateBoardStatus(o,r,i)).score===Rte.VICTORY)return n.scoreToGameStatus(i.score,r.turn)}}catch(s){a.e(s)}finally{a.f()}return n.scoreToGameStatus(i.score,r.turn)}},{key:"getVictoriousCoords",value:function(e){var t,r=uy(n.lines);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(n.isThereAVictoriousLine(i,e))return i.allCoords()}}catch(a){r.e(a)}finally{r.f()}return[]}}],[{key:"isOccupied",value:function(e){return e!==Lle.EMPTY}},{key:"isLegal",value:function(e,t){var r=e.coord.x,i=e.coord.y,a=e.piece,o=t.getCopiedBoard(),s=t.pieceInHand;return n.isOccupied(o[i][r])?DB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE()):a===Lle.EMPTY?15===t.turn?DB.SUCCESS:DB.failure(Vle.MUST_GIVE_A_PIECE()):Ule.isAlreadyOnBoard(a,o)?DB.failure(Vle.PIECE_ALREADY_ON_BOARD()):s===a?DB.failure(Vle.CANNOT_GIVE_PIECE_IN_HAND()):DB.SUCCESS}},{key:"updateBoardStatus",value:function(e,t,n){return n.score===Rte.PRE_VICTORY?this.isThereAVictoriousLine(e,t)?{score:Rte.VICTORY,sensitiveSquares:new Wne}:n:this.searchForVictoryOrPreVictoryInLine(e,t,n)}},{key:"isThereAVictoriousLine",value:function(e,t){for(var r=e.initialCoord,i=t.getPieceAt(r),a=new Ble(i),o=0;o<3&&!1!==n.isOccupied(i)&&!a.areAllAbsent();o++)r=r.getNext(e.direction,1),i=t.getPieceAt(r),a.mergeWithQuartoPiece(i);return!(!n.isOccupied(i)||a.areAllAbsent())}},{key:"searchForVictoryOrPreVictoryInLine",value:function(e,t,r){var i=n.getLineInfos(e,t,r);if(i.boardStatus.isPresent())return i.boardStatus.get();var a=i.commonCriterion,o=i.sensitiveCoord;if(a.isPresent()&&!1===a.get().areAllAbsent()){if(o.isAbsent())return{score:Rte.VICTORY,sensitiveSquares:new Wne};a.get().matchPiece(t.pieceInHand)&&(r.score=Rte.PRE_VICTORY);var s=o.get();r.sensitiveSquares.add(s)}return r}},{key:"getLineInfos",value:function(e,t,r){for(var i=RB.empty(),a=RB.empty(),o=e.initialCoord,s=0;s<4;s++){var u=t.getPieceAt(o);if(u===Lle.EMPTY){if(!i.isAbsent())return{sensitiveCoord:RB.of(o),commonCriterion:a,boardStatus:RB.of(r)};i=RB.of(o)}else a.isAbsent()?(a=RB.of(new Ble(u)),OB(n.VERBOSE,"set commonCrit to "+a.toString())):(a.get().mergeWithQuartoPiece(u),OB(n.VERBOSE,"update commonCrit: "+a.toString()));o=o.getNext(e.direction,1)}return{commonCriterion:a,sensitiveCoord:i,boardStatus:RB.empty()}}},{key:"scoreToGameStatus",value:function(e,t){var n=Q7.of(t%2);return e===Rte.VICTORY?Lte.getDefeat(n):16===t?Lte.DRAW:Lte.ONGOING}}]),n}(Fte);Hle.VERBOSE=!1,Hle.lines=[new zle(new fte(0,0),ute.DOWN),new zle(new fte(1,0),ute.DOWN),new zle(new fte(2,0),ute.DOWN),new zle(new fte(3,0),ute.DOWN),new zle(new fte(0,0),ute.RIGHT),new zle(new fte(0,1),ute.RIGHT),new zle(new fte(0,2),ute.RIGHT),new zle(new fte(0,3),ute.RIGHT),new zle(new fte(0,0),ute.DOWN_RIGHT),new zle(new fte(0,3),ute.UP_RIGHT)];var Gle=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState,r=n.getCopiedBoard(),i=n.getRemainingPieces(),a=n.pieceInHand,o=0;o<4;o++)for(var s=0;s<4;s++)if(r[o][s]===Lle.EMPTY){if(n.getCopiedBoard()[o][s]=a,15===n.turn){var u=new Fle(s,o,Lle.EMPTY);return t.push(u),t}var c,l=uy(i);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=new Fle(s,o,f);t.push(h)}}catch(d){l.e(d)}finally{l.f()}}return t}},{key:"getBoardValue",value:function(e){var t,r=e.gameState,i={score:Rte.DEFAULT,sensitiveSquares:new Wne},a=uy(Hle.lines);try{for(a.s();!(t=a.n()).done;){var o=t.value;if((i=Hle.updateBoardStatus(o,r,i)).score===Rte.VICTORY)break}}catch(s){a.e(s)}finally{a.f()}return n.scoreToBoardValue(i.score,r.turn)}}],[{key:"scoreToBoardValue",value:function(e,t){if(e===Rte.DEFAULT)return new _te(0);var n=Q7.of(t%2);return new _te(e===Rte.PRE_VICTORY?n.getPreVictory():n.getDefeatValue())}}]),n}(wte),$le=Lle.AABA,Zle=Lle.AABB,qle=Lle.ABAA,Wle=Lle.ABAB,jle=Lle.ABBA,Yle=Lle.BAAA,Kle=Lle.BAAB,Qle=Lle.BABB,Xle=Lle.BBAA,Jle=Lle.BBAB,efe=Lle.BBBA,tfe=Lle.BBBB,nfe=Lle.EMPTY,rfe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(tc||(tc=Hg(["Goal of the game"]))),$localize(nc||(nc=Hg(["Quarto is an alignment game.\n        The goal is to align four pieces that have at least one common aspect:\n        <ul>\n          <li>their color (light or dark),</li>\n          <li>their size (big or small),</li>\n          <li>their pattern (empty or dotted),</li>\n          <li>their shape (round or square).</li>\n        </ul>\n        Here, we have a board with a victory by an alignment of dark pieces."]))),new Ule([[efe,Xle,qle,$le],[nfe,nfe,nfe,nfe],[nfe,nfe,nfe,nfe],[nfe,nfe,nfe,nfe]],7,Lle.ABAB)),zte.anyMove($localize(rc||(rc=Hg(["Placement"]))),$localize(ic||(ic=Hg(["Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,\n        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.\n        If you prefer, the order of these two steps can be reversed.\n        Keep in mind that the second click confirms the move.<br/><br/>\n        Make a move."]))),new Ule([[efe,Zle,jle,nfe],[nfe,nfe,nfe,nfe],[nfe,Yle,nfe,nfe],[nfe,nfe,nfe,nfe]],7,Lle.ABAA),new Fle(2,2,Lle.BAAB),$localize(ac||(ac=Hg(["Perfect!"])))),zte.fromMove($localize(oc||(oc=Hg(["Situation"]))),$localize(sc||(sc=Hg(["We have here a tricky situation.<br/><br/>\n        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move."]))),new Ule([[tfe,efe,Jle,nfe],[qle,Qle,Xle,nfe],[Wle,Yle,Kle,nfe],[nfe,nfe,nfe,nfe]],7,Lle.AABA),[new Fle(3,3,Lle.AABB)],$localize(uc||(uc=Hg(["Well done!"]))),$localize(cc||(cc=Hg(["Failed!"]))))]});function ife(e,t){if(1&e&&(IC(),_S(0,"rect",12)),2&e){var n=RS(2),r=n.$implicit,i=n.index,a=RS().index,o=RS();mS("ngClass",o.getPieceClasses(r.value)),lS("x",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*a+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function afe(e,t){if(1&e&&(IC(),_S(0,"circle",12)),2&e){var n=RS(2),r=n.$implicit,i=n.index,a=RS().index,o=RS();mS("ngClass",o.getPieceClasses(r.value)),lS("cx",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*a+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function ofe(e,t){if(1&e&&(IC(),_S(0,"circle")),2&e){var n=RS(2).index,r=RS().index,i=RS();lS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function sfe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,ife,1,5,"rect",10),pS(2,afe,1,4,"ng-template",null,11,XT),pS(4,ofe,1,3,"circle",7),wS()),2&e){var n=gS(3),r=RS().$implicit,i=RS(2);DE(1),mS("ngIf",r.isRectangle())("ngIfElse",n),DE(3),mS("ngIf",i.pieceHasDot(r.value))}}function ufe(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",9),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().chooseCoord(e,t)}),wS(),pS(2,sfe,5,3,"g",7),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();DE(1),NS("id","chooseCoord_",i,"_",a,""),mS("ngClass",o.getSquareClasses(i,a)),lS("x",o.SPACE_SIZE*i)("y",o.SPACE_SIZE*a)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngIf",r!==o.EMPTY)}}function cfe(e,t){if(1&e&&(IC(),CS(0,"g",null,8),pS(2,ufe,3,8,"g",2),wS()),2&e){var n=t.$implicit;DE(2),mS("ngForOf",n)}}function lfe(e,t){if(1&e&&(IC(),_S(0,"rect",17)),2&e){var n=RS(2);mS("ngClass",n.getPieceClasses(n.pieceInHand.value)),lS("x",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("y",n.SPACE_SIZE/2-n.getPieceSize(n.pieceInHand.value))("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function ffe(e,t){if(1&e&&(IC(),_S(0,"circle",12)),2&e){var n=RS(2);mS("ngClass",n.getPieceClasses(n.pieceInHand.value)),lS("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",n.getPieceSize(n.pieceInHand.value))}}function hfe(e,t){if(1&e&&(IC(),_S(0,"circle")),2&e){var n=RS(2);lS("cx",n.SPACE_SIZE/2)("cy",n.SPACE_SIZE/2)("r",10)}}function dfe(e,t){if(1&e){var n=SS();IC(),CS(0,"g",13,14),TS("click",function(){return eC(n),RS().deselectDroppedPiece()}),_S(2,"rect",15),pS(3,lfe,1,5,"rect",16),pS(4,ffe,1,4,"ng-template",null,11,XT),pS(6,hfe,1,3,"circle",7),wS()}if(2&e){var r=gS(5),i=RS();NS("id","droppedPiece_",i.chosen.get().x,"_",i.chosen.get().y,""),lS("transform","translate("+i.chosen.get().x*i.SPACE_SIZE+" "+i.chosen.get().y*i.SPACE_SIZE+")"),DE(2),lS("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),DE(1),mS("ngIf",i.pieceInHand.isRectangle())("ngIfElse",r),DE(3),mS("ngIf",i.pieceHasDot(i.pieceInHand.value))}}function vfe(e,t){if(1&e&&(IC(),CS(0,"g",null,18),_S(2,"rect",19),wS()),2&e){var n=t.$implicit,r=RS();DE(2),lS("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+n.x*r.SPACE_SIZE+" "+n.y*r.SPACE_SIZE+")")}}function pfe(e,t){if(1&e&&(IC(),_S(0,"rect",12)),2&e){var n=RS(2);mS("ngClass",n.getPieceClasses(n.pieceInHand.value)),lS("x",0)("y",.75*n.SPACE_SIZE)("transform","translate("+-n.getPieceSize(n.pieceInHand.value)+", "+-n.getPieceSize(n.pieceInHand.value)+")")("width",2*n.getPieceSize(n.pieceInHand.value))("height",2*n.getPieceSize(n.pieceInHand.value))}}function gfe(e,t){if(1&e&&(IC(),_S(0,"circle",21)),2&e){var n=RS(2);mS("ngClass",n.getPieceClasses(n.pieceInHand.value)),lS("cy",.75*n.SPACE_SIZE)("r",n.getPieceSize(n.pieceInHand.value))}}function yfe(e,t){1&e&&(IC(),_S(0,"circle",22)),2&e&&lS("cy",.75*RS(2).SPACE_SIZE)("r",10)}function mfe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,pfe,1,6,"rect",10),pS(2,gfe,1,3,"ng-template",null,11,XT),pS(4,yfe,1,2,"circle",20),wS()),2&e){var n=gS(3),r=RS();DE(1),mS("ngIf",r.pieceInHand.isRectangle())("ngIfElse",n),DE(3),mS("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function kfe(e,t){if(1&e&&(IC(),_S(0,"rect",27)),2&e){var n=RS(2).index,r=RS().index,i=RS();xS("id","chosenPiece_",4*r+n,""),lS("x",i.SPACE_SIZE*n)("y",i.SPACE_SIZE*r)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}function Cfe(e,t){if(1&e&&(IC(),_S(0,"rect",12)),2&e){var n=RS(2).index,r=RS().index,i=RS();mS("ngClass",i.getPieceClasses(4*r+n)),lS("x",i.SPACE_SIZE*n+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("y",i.SPACE_SIZE*r+i.SPACE_SIZE/2-i.getPieceSize(4*r+n))("width",2*i.getPieceSize(4*r+n))("height",2*i.getPieceSize(4*r+n))}}function wfe(e,t){if(1&e&&(IC(),_S(0,"circle",12)),2&e){var n=RS(2).index,r=RS().index,i=RS();mS("ngClass",i.getPieceClasses(4*r+n)),lS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",i.getPieceSize(4*r+n))}}function _fe(e,t){if(1&e&&(IC(),_S(0,"circle")),2&e){var n=RS(2).index,r=RS().index,i=RS();lS("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)("r",10)}}function Efe(e,t){if(1&e){var n=SS();IC(),CS(0,"g",13),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().choosePiece(4*t+e)}),pS(1,kfe,1,5,"rect",26),pS(2,Cfe,1,5,"rect",10),pS(3,wfe,1,4,"ng-template",null,11,XT),pS(5,_fe,1,3,"circle",7),wS()}if(2&e){var r=gS(4),i=RS().index,a=RS().index,o=RS();xS("id","choosePiece_",4*a+i,""),DE(1),mS("ngIf",o.pieceToGive.equalsValue(o.QuartoPiece.fromInt(4*a+i))),DE(1),mS("ngIf",(4*a+i)%4<2)("ngIfElse",r),DE(3),mS("ngIf",o.pieceHasDot(4*a+i))}}function bfe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Efe,6,5,"g",3),wS()),2&e){var n=t.index,r=RS().index,i=RS();DE(1),mS("ngIf",i.isRemaining(4*r+n))}}function Sfe(e,t){if(1&e&&(IC(),CS(0,"g",null,23),_S(2,"rect",24,25),pS(4,bfe,2,1,"g",2),wS()),2&e){var n=t.$implicit,r=RS();lS("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),DE(2),lS("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),DE(2),mS("ngForOf",n)}}var Pfe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).EMPTY=Lle.EMPTY,r.QuartoPiece=Lle,r.chosen=RB.empty(),r.lastMove=RB.empty(),r.pieceInHand=Lle.EMPTY,r.pieceToGive=RB.empty(),r.victoriousCoords=[],r.rules=new Hle(Ule),r.availableMinimaxes=[new Gle(r.rules,"QuartoMinimax")],r.encoder=Fle.encoder,r.tutorial=(new rfe).tutorial,r.pieceInHand=r.rules.node.gameState.pieceInHand,r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){var e=this.rules.node.gameState,t=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=RB.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=t.map(function(e){return e.coord})}},{key:"chooseCoord",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#chooseCoord_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:if(n.hideLastMove(),n.board[t][e]!==Lle.EMPTY){r.next=11;break}if(n.showPieceInHandOnBoard(e,t),15!==n.rules.node.gameState.turn){r.next=7;break}return a=new Fle(e,t,Lle.EMPTY),r.abrupt("return",n.chooseMove(a,n.rules.node.gameState));case 7:if(!n.pieceToGive.isAbsent()){r.next=9;break}return r.abrupt("return",DB.SUCCESS);case 9:return o=new Fle(e,t,n.pieceToGive.get()),r.abrupt("return",n.chooseMove(o,n.rules.node.gameState));case 11:return r.abrupt("return",n.cancelMove(Cte.MUST_CLICK_ON_EMPTY_SPACE()));case 12:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#choosePiece_"+e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(t.hideLastMove(),!t.pieceToGive.equalsValue(Lle.fromInt(e))){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),DB.SUCCESS));case 5:if(t.pieceToGive=RB.of(Lle.fromInt(e)),!t.chosen.isAbsent()){n.next=7;break}return n.abrupt("return",DB.SUCCESS);case 7:return i=t.chosen.get(),a=new Fle(i.x,i.y,t.pieceToGive.get()),n.abrupt("return",t.chooseMove(a,t.rules.node.gameState));case 9:case"end":return n.stop()}},n)}))()}},{key:"hideLastMove",value:function(){this.lastMove=RB.empty()}},{key:"cancelMoveAttempt",value:function(){this.hideLastMove(),this.pieceToGive=RB.empty(),this.chosen=RB.empty()}},{key:"deselectDroppedPiece",value:function(){var e=this.chosen.getOrElse(new fte(404,404)),t=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return t.isFailure()?this.cancelMove(t.getReason()):(this.cancelMoveAttempt(),DB.SUCCESS)}},{key:"showPieceInHandOnBoard",value:function(e,t){this.chosen=RB.of(new fte(e,t))}},{key:"isRemaining",value:function(e){return Ule.isGivable(Lle.fromInt(e),this.board,this.pieceInHand)}},{key:"getSquareClasses",value:function(e,t){var n=new fte(e,t);return this.lastMove.equalsValue(n)?["moved"]:[]}},{key:"getPieceClasses",value:function(e){var t=[];return t.push(e%2==0?"player0":"player1"),t}},{key:"getPieceSize",value:function(e){return e<8?40:25}},{key:"pieceHasDot",value:function(e){return e!==Lle.EMPTY.value&&e%8<4}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-quarto"]],features:[Qb],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","highlight","x","0","y","0",1,"base","highlighted","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected",3,"id",4,"ngIf"],[1,"base","selected",3,"id"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"g",1),pS(2,cfe,3,1,"g",2),pS(3,dfe,7,8,"g",3),pS(4,vfe,3,3,"g",2),CS(5,"g",null,4),_S(7,"rect",5,6),pS(9,mfe,5,3,"g",7),wS(),pS(10,Sfe,5,6,"g",2),wS(),wS()),2&e&&(lS("viewBox","0 0 "+4.25*t.SPACE_SIZE+" "+10.75*t.SPACE_SIZE),DE(2),mS("ngForOf",t.board),DE(1),mS("ngIf",t.chosen.isPresent()),DE(1),mS("ngForOf",t.victoriousCoords),DE(1),lS("transform","translate("+2*t.SPACE_SIZE+", "+4.5*t.SPACE_SIZE+")"),DE(2),lS("width",1.5*t.SPACE_SIZE)("height",1.5*t.SPACE_SIZE)("transform","translate("+-.75*t.SPACE_SIZE+", 0)"),DE(2),mS("ngIf",t.chosen.isAbsent()),DE(1),mS("ngForOf",t.board))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ofe=function(){var e=dy(function e(){fy(this,e)});return e.NO_INSIDE_CLICK=function(){return $localize(lc||(lc=Hg(["You must pick a space from the edge of the board."])))},e}(),Tfe=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;fy(this,n),(a=t.call(this,e,r)).direction=i;var o=n.isValidCoord(a.coord);if(o.isFailure())throw new Error(o.getReason());if(0===e&&i===cte.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===e&&i===cte.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===r&&i===cte.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===r&&i===cte.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.");return a}return dy(n,[{key:"toString",value:function(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.direction===this.direction}}],[{key:"isValidCoord",value:function(e){return e.isNotInRange(5,5)?DB.failure("Invalid coord for QuixoMove: "+e.toString()+" is outside the board."):0!==e.x&&4!==e.x&&0!==e.y&&4!==e.y?DB.failure(Ofe.NO_INSIDE_CLICK()):DB.SUCCESS}}]),n}(Ite);Tfe.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 128}},{key:"encodeNumber",value:function(e){var t=e.direction.toInt();return 20*e.coord.x+4*e.coord.y+t}},{key:"decodeNumber",value:function(e){var t=cte.factory.fromInt(e%4).get();e-=e%4;var n=(e/=4)%5;return e-=e%5,new Tfe(e/=5,n,t)}}]),n}(j7));var Ife=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e){for(var t=this.getCopiedBoard(),r=this.turn+1,i=e.coord,a=e.coord.getNext(e.direction);a.isInRange(5,5);)t[i.y][i.x]=t[a.y][a.x],i=i.getNext(e.direction),a=a.getNext(e.direction);return t[i.y][i.x]=this.getCurrentPlayer(),new n(t,r)}}],[{key:"getInitialState",value:function(){return new n(t9.createTable(5,5,K7.NONE),0)}}]),n}(Pte),Afe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,r){return n.applyLegalMove(e,t,r)}},{key:"isLegal",value:function(e,t){return t.getPieceAt(e.coord)===t.getCurrentOpponent()?MB.failure(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()):MB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState,r=n.getLinesSums(t),i=n.getFullestLine(r[Q7.ZERO.value]),a=n.getFullestLine(r[Q7.ONE.value]),o=t.getCurrentPlayer();return 5===i&&(o===Q7.ZERO||a<5)?Lte.ZERO_WON:5===a?Lte.ONE_WON:Lte.ONGOING}}],[{key:"getVerticalCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=0;r<5;r++)e.gameState.getPieceAtXY(0,r)!==t&&n.push(new fte(0,r)),e.gameState.getPieceAtXY(4,r)!==t&&n.push(new fte(4,r));return n}},{key:"getHorizontalCenterCoords",value:function(e){for(var t=e.gameState.getCurrentOpponent(),n=[],r=1;r<4;r++)e.gameState.getPieceAtXY(r,0)!==t&&n.push(new fte(r,0)),e.gameState.getPieceAtXY(r,4)!==t&&n.push(new fte(r,4));return n}},{key:"getPossibleDirections",value:function(e){var t=[];return 0!==e.x&&t.push(cte.LEFT),0!==e.y&&t.push(cte.UP),4!==e.x&&t.push(cte.RIGHT),4!==e.y&&t.push(cte.DOWN),t}},{key:"getLinesSums",value:function(e){var t={};t[Q7.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},t[Q7.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(var n=0;n<5;n++)for(var r=0;r<5;r++){var i=e.getPieceAtXY(r,n);if(i.isPlayer()){var a=i.value;t[a].columns[r]=t[a].columns[r]+1,t[a].rows[n]=t[a].rows[n]+1,r===n&&(t[a].diagonals[0]=t[a].diagonals[0]+1),r+n===4&&(t[a].diagonals[1]=t[a].diagonals[1]+1)}}return t}},{key:"getVictoriousCoords",value:function(e){for(var t=n.getLinesSums(e),r=[],i=0;i<2;i++){for(var a=0;a<5;a++){if(5===t[i].columns[a])for(var o=0;o<5;o++)r.push(new fte(a,o));if(5===t[i].rows[a])for(var s=0;s<5;s++)r.push(new fte(s,a))}if(5===t[i].diagonals[0])for(var u=0;u<5;u++)r.push(new fte(u,u));if(5===t[i].diagonals[1])for(var c=0;c<5;c++)r.push(new fte(c,4-c))}return r}},{key:"getFullestLine",value:function(e){var t=e.columns.concat(e.rows.concat(e.diagonals));return Math.max.apply(Math,oy(t))}},{key:"applyLegalMove",value:function(e,t,n){return t.applyLegalMove(e)}}]),n}(Fte),Rfe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t,n=[],r=Afe.getVerticalCoords(e),i=uy(Afe.getHorizontalCenterCoords(e).concat(r));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=uy(Afe.getPossibleDirections(o));try{for(s.s();!(a=s.n()).done;){var u=a.value,c=new Tfe(o.x,o.y,u);n.push(c)}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState,n=Afe.getLinesSums(t),r=Afe.getFullestLine(n[Q7.ZERO.value]),i=Afe.getFullestLine(n[Q7.ONE.value]),a=t.getCurrentPlayer();return new _te(5===r&&(a===Q7.ZERO||i<5)?Q7.ZERO.getVictoryValue():5===i?Q7.ONE.getVictoryValue():i-r)}}]),n}(wte),Mfe=function(){function e(){fy(this,e)}return dy(e,null,[{key:"getArrowTransform",value:function(e,t,n){var r,i,a;switch(n){case cte.UP:r=1,i=0,a=-90;break;case cte.DOWN:r=1,i=2,a=90;break;case cte.LEFT:r=0,i=1,a=180;break;default:PB.expectToBe(n,cte.RIGHT),r=2,i=1,a=0}return["scale("+e/300+")","translate(".concat(100*r," ").concat(100*i,")"),"rotate("+a+" 50 50)"].join(" ")}}]),e}(),xfe=K7.NONE,Nfe=K7.ZERO,Dfe=K7.ONE,Lfe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(fc||(fc=Hg(["Goal of the game."]))),$localize(hc||(hc=Hg(["At Quixo, the goal is to align 5 of your pieces.\n        The first player plays with dark pieces, the second with light pieces.\n        The board is made of 25 spaces spread over a 5x5 square.\n        Every piece has a neutral side, a light side, and a dark side."]))),Ife.getInitialState()),zte.fromMove($localize(dc||(dc=Hg(["What a move looks like (without animation)"]))),$localize(vc||(vc=Hg(["When it is your turn:\n        <ol>\n            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.\n                You can only choose a piece from the edge of the board.</li>\n            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>\n        </ol>\n        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.\n        Once on the other side, all pieces will move by one space in the opposing direction.\n        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>\n        For example, take the bottom right neutral piece, and move it to the left (you're playing Light)."]))),new Ife([[xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe],[xfe,xfe,xfe,xfe,xfe],[Nfe,Nfe,Nfe,Nfe,xfe]],1),[new Tfe(4,4,cte.LEFT)],$localize(pc||(pc=Hg(["See how the four dark pieces have been moved one space to the right.\n        The neutral piece has been move 4 pieces to the left and has become light."]))),$localize(gc||(gc=Hg(["Failed!"])))),zte.fromMove($localize(yc||(yc=Hg(["Victory"]))),$localize(mc||(mc=Hg(["You already know everything you need in order to play, but there is one last particularity.\n        If you create a line of 5 of your pieces, you win.\n        If you create a line of 5 of your opponent's pieces, you lose.\n        If you create both, you lose too!<br/><br/>\n        You can win with this board, try it.\n        You're playing Light."]))),new Ife([[xfe,Dfe,xfe,Dfe,Dfe],[xfe,Nfe,Nfe,xfe,Nfe],[Dfe,Dfe,Dfe,Nfe,Dfe],[Nfe,xfe,Nfe,Dfe,Dfe],[Dfe,Nfe,xfe,Dfe,Nfe]],31),[new Tfe(3,0,cte.DOWN)],$localize(kc||(kc=Hg(["Congratulations, you won!"]))),$localize(Cc||(Cc=Hg(["Failed!"]))))]});function Ffe(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"circle",4),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onBoardClick(e,t)}),wS(),wS()}if(2&e){var r=t.index,i=RS().index,a=RS();DE(1),NS("id","click_",r,"_",i,""),mS("ngClass",a.getPieceClasses(r,i)),lS("r",.45*a.SPACE_SIZE)("cx",(r+.5)*a.SPACE_SIZE)("cy",(i+.5)*a.SPACE_SIZE)}}function Ufe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Ffe,2,6,"g",2),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function Vfe(e,t){if(1&e){var n=SS();IC(),CS(0,"use",6),TS("click",function(){var e=eC(n).$implicit;return RS(2).chooseDirection(e)}),wS()}if(2&e){var r=t.$implicit,i=RS(2);xS("id","chooseDirection_",r,""),lS("transform",i.getArrowTransform(r))}}function Bfe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Vfe,1,2,"use",5),wS()),2&e){var n=RS();DE(1),mS("ngForOf",n.getPossiblesDirections())}}var zfe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).lastMoveCoord=RB.empty(),r.chosenCoord=RB.empty(),r.victoriousCoords=[],r.rules=new Afe(Ife),r.availableMinimaxes=[new Rfe(r.rules,"QuixoMinimax")],r.encoder=Tfe.encoder,r.tutorial=(new Lfe).tutorial,r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(function(e){return e.coord}),this.victoriousCoords=Afe.getVictoriousCoords(this.state)}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=RB.empty()}},{key:"getPieceClasses",value:function(e,t){var n=new fte(e,t),r=[];return r.push(this.getPlayerClass(this.board[t][e])),this.chosenCoord.equalsValue(n)?r.push("selected"):this.lastMoveCoord.equalsValue(n)&&r.push("last-move"),this.victoriousCoords.some(function(e){return e.equals(n)})&&r.push("victory-stroke"),r}},{key:"onBoardClick",value:function(e,t){var n=this.canUserPlay("#click_"+e+"_"+t);if(n.isFailure())return this.cancelMove(n.getReason());var r=new fte(e,t),i=Tfe.isValidCoord(r);return i.isFailure()?this.cancelMove(i.getReason()):this.board[t][e]===this.state.getCurrentOpponent()?this.cancelMove(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(r)?this.cancelMoveAttempt():this.chosenCoord=RB.of(r),DB.SUCCESS)}},{key:"getPossiblesDirections",value:function(){var e=[],t=this.chosenCoord.get();return 4!==t.x&&e.push(cte.RIGHT),0!==t.x&&e.push(cte.LEFT),4!==t.y&&e.push(cte.DOWN),0!==t.y&&e.push(cte.UP),e}},{key:"chooseDirection",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#chooseDirection_"+e.toString())).isFailure()){n.next=5;break}n.t0=t.cancelMove(r.getReason()),n.next=9;break;case 5:return t.chosenDirection=e,n.next=8,t.tryMove();case 8:n.t0=n.sent;case 9:return n.abrupt("return",n.t0);case 10:case"end":return n.stop()}},n)}))()}},{key:"tryMove",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new Tfe(n.x,n.y,e.chosenDirection),t.abrupt("return",(e.cancelMove(),e.chooseMove(r,e.rules.node.gameState)));case 2:case"end":return t.stop()}},t)}))()}},{key:"getArrowTransform",value:function(e){return Mfe.getArrowTransform(5*this.SPACE_SIZE,new fte(0,0),e)}}]),n}(_ne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-quixo"]],features:[Qb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"defs"),_S(2,"polygon",1),wS(),pS(3,Ufe,2,1,"g",2),pS(4,Bfe,2,1,"g",3),wS()),2&e&&(lS("viewBox","0 0 "+5*t.SPACE_SIZE+" "+5*t.SPACE_SIZE),DE(3),mS("ngForOf",t.board),DE(1),mS("ngIf",t.chosenCoord.isPresent()))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Hfe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"countScore",value:function(){for(var e=[0,0],t=0;t<n.BOARD_HEIGHT;t++)for(var r=0;r<n.BOARD_WIDTH;r++){var i=this.board[t][r];i.isPlayer()&&(e[i.value]+=1)}return e}}],[{key:"getInitialState",value:function(){var e=t9.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,K7.NONE);return e[3][3]=Q7.ZERO,e[4][4]=Q7.ZERO,e[3][4]=Q7.ONE,e[4][3]=Q7.ONE,new n(e,0)}},{key:"getNeighboringPawnLike",value:function(e,t,n,r){for(var i,a=[],o=-1;o<2;o++)for(var s=-1;s<2;s++)(i=new fte(n+s,r+o)).isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[i.y][i.x]===t&&a.push(i);return a}}]),n}(Pte);return e.BOARD_WIDTH=8,e.BOARD_HEIGHT=8,e}(),Gfe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"equals",value:function(e){return e===this||e.coord.equals(this.coord)}},{key:"toString",value:function(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}]),n}(Ite);Gfe.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return(Hfe.BOARD_HEIGHT-1)*Hfe.BOARD_WIDTH+(Hfe.BOARD_WIDTH-1)}},{key:"encodeNumber",value:function(e){return e.coord.y*Hfe.BOARD_WIDTH+e.coord.x}},{key:"decodeNumber",value:function(e){var t=e%Hfe.BOARD_WIDTH;return new Gfe(t,(e-t)/Hfe.BOARD_WIDTH)}}]),n}(j7)),Gfe.PASS=new Gfe(-1,-1),Gfe.PASS_NUMBER=Gfe.encoder.encodeNumber(Gfe.PASS);var $fe=function(){var e=dy(function e(){fy(this,e)});return e.NO_ELEMENT_SWITCHED=function(){return $localize(wc||(wc=Hg(["Your move should switch at least one piece."])))},e}(),Zfe=dy(function e(t,n){fy(this,e),this.move=t,this.switched=n}),qfe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){var r=t.turn,i=t.getCurrentPlayer(),a=t.getCopiedBoard();if(e.equals(Gfe.PASS))return new Hfe(a,r+1);var o,s=uy(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u.y][u.x]=i}}catch(c){s.e(c)}finally{s.f()}return a[e.coord.y][e.coord.x]=i,new Hfe(a,r+1)}},{key:"getGameStatus",value:function(e){return n.getGameStatus(e)}},{key:"isLegal",value:function(e,t){if(e.equals(Gfe.PASS))return n.playerCanOnlyPass(t)?MB.success([]):MB.failure(Cte.MUST_PASS());if(t.getPieceAt(e.coord).isPlayer())return OB(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),MB.failure(Cte.MUST_CLICK_ON_EMPTY_SPACE());var r=t.getCopiedBoard(),i=n.getAllSwitcheds(e,t.getCurrentPlayer(),r);return OB(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?MB.failure($fe.NO_ELEMENT_SWITCHED()):MB.success(i)}}],[{key:"getGameStatus",value:function(e){var t=e.gameState;if(!1===n.isGameEnded(t))return Lte.ONGOING;var r=t.countScore(),i=r[1]-r[0];return i<0?Lte.ZERO_WON:i>0?Lte.ONE_WON:Lte.DRAW}},{key:"getAllSwitcheds",value:function(e,t,r){var i,a=[],o=t.getOpponent(),s=uy(ute.DIRECTIONS);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=e.coord.getNext(u);if(c.isInRange(Hfe.BOARD_WIDTH,Hfe.BOARD_HEIGHT)&&r[c.y][c.x]===o){var l,f=uy(n.getSandwicheds(t,u,c,r));try{for(f.s();!(l=f.n()).done;){var h=l.value;a.push(h)}}catch(d){f.e(d)}finally{f.f()}}}}catch(d){s.e(d)}finally{s.f()}return a}},{key:"getSandwicheds",value:function(e,t,n,r){for(var i=[n],a=n.getNext(t);a.isInRange(Hfe.BOARD_WIDTH,Hfe.BOARD_HEIGHT);){var o=r[a.y][a.x];if(o===e)return i;if(o===K7.NONE)return[];i.push(a),a=a.getNext(t)}return[]}},{key:"isGameEnded",value:function(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}},{key:"playerCanOnlyPass",value:function(e){var t=this.getListMoves(e);return 1===t.length&&t[0].move.equals(Gfe.PASS)}},{key:"nextPlayerCantOnlyPass",value:function(e){var t=e.getCopiedBoard(),n=new Hfe(t,e.turn+1);return this.playerCanOnlyPass(n)}},{key:"getListMoves",value:function(e){for(var t,r=[],i=e.getCurrentPlayer(),a=e.getCurrentOpponent(),o=0;o<8;o++)for(var s=0;s<8;s++)if(e.getPieceAtXY(s,o)===K7.NONE&&(t=e.getCopiedBoard(),Hfe.getNeighboringPawnLike(t,a,s,o).length>0)){var u=new Gfe(s,o),c=n.getAllSwitcheds(u,i,t);if(c.length>0){var l,f=uy(c);try{for(f.s();!(l=f.n()).done;){var h=l.value;N7(i!==e.getPieceAt(h),h+"was already switched!"),t[h.y][h.x]=i}}catch(d){f.e(d)}finally{f.f()}t[o][s]=i,r.push(new Zfe(u,c.length))}}return 0===r.length&&r.push(new Zfe(Gfe.PASS,0)),r}}]),n}(Fte);return e.VERBOSE=!1,e}(),Wfe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=qfe.getGameStatus(e);if(t.isEndGame)return _te.fromWinner(t.winner);for(var n=e.gameState.getCopiedBoard(),r=0,i=0,a=0;a<Hfe.BOARD_HEIGHT;a++)for(var o=0;o<Hfe.BOARD_WIDTH;o++){var s=(0===o||o===Hfe.BOARD_WIDTH-1?4:1)*(0===a||a===Hfe.BOARD_HEIGHT-1?4:1);n[a][o]===Q7.ZERO&&(r+=s),n[a][o]===Q7.ONE&&(i+=s)}return r*=Q7.ZERO.getScoreModifier(),i*=Q7.ONE.getScoreModifier(),new _te(i+r)}},{key:"getListMoves",value:function(e){var t=qfe.getListMoves(e.gameState);return t9.sortByDescending(t,function(e){return n.bestCoords.some(function(t){return e.move.coord.equals(t)})?100:e.switched}),t.map(function(e){return e.move})}}]),n}(wte);Wfe.bestCoords=[new fte(0,0),new fte(0,Hfe.BOARD_HEIGHT-1),new fte(Hfe.BOARD_WIDTH-1,0),new fte(Hfe.BOARD_WIDTH-1,Hfe.BOARD_HEIGHT-1)];var jfe=K7.NONE,Yfe=K7.ZERO,Kfe=K7.ONE,Qfe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(_c||(_c=Hg(["Goal of the game"]))),$localize(Ec||(Ec=Hg(["At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.\n        When one piece is flipped, its owner changes.\n        The player owning the most pieces at the end of the game wins.\n        Here, Dark has 28 points and Light has 36, hence Light wins."]))),new Hfe([[Yfe,Yfe,Yfe,Yfe,Yfe,Yfe,Yfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Yfe,Yfe,Yfe,Yfe,Yfe,Yfe,Yfe]],60)),zte.anyMove($localize(bc||(bc=Hg(["Capture (1/2)"]))),$localize(Sc||(Sc=Hg(["At the beginning of the game, pieces are placed as shown here.\n        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>\n        Do any move by clicking to put your piece\n        Dark plays first."]))),Hfe.getInitialState(),new Gfe(2,4),$localize(Pc||(Pc=Hg(["Congratulations!"])))),zte.fromMove($localize(Oc||(Oc=Hg(["Capture (2/2)"]))),$localize(Tc||(Tc=Hg(["A move can also capture a bigger line, and more than one lines at a time\n        You're playing light here.<br/><br/>\n        Play on the bottom left to see an example."]))),new Hfe([[jfe,jfe,jfe,jfe,jfe,jfe,jfe,jfe],[jfe,jfe,jfe,jfe,jfe,jfe,jfe,jfe],[jfe,jfe,jfe,jfe,jfe,jfe,jfe,jfe],[jfe,jfe,jfe,jfe,Kfe,jfe,jfe,jfe],[jfe,jfe,jfe,Yfe,jfe,jfe,jfe,jfe],[jfe,jfe,Yfe,jfe,jfe,jfe,jfe,jfe],[Yfe,Yfe,jfe,jfe,jfe,jfe,jfe,jfe],[jfe,Yfe,Kfe,Yfe,Kfe,Yfe,jfe,jfe]],1),[new Gfe(0,7)],$localize(Ic||(Ic=Hg(["Congratulations!"]))),$localize(Ac||(Ac=Hg(["Lower and more to the left, please."])))),zte.informational($localize(Rc||(Rc=Hg(["Passing a turn"]))),$localize(Mc||(Mc=Hg(["If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass\n        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way."]))),new Hfe([[Kfe,Yfe,Yfe,Yfe,Yfe,Yfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Yfe,Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,Yfe],[Kfe,Kfe,Kfe,Kfe,Kfe,Kfe,jfe,jfe],[Yfe,Yfe,Yfe,Yfe,Yfe,Yfe,jfe,jfe]],60))]});function Xfe(e,t){if(1&e&&(IC(),_S(0,"circle",4)),2&e){var n=RS().index,r=RS().index,i=RS();mS("ngClass",i.getPieceClass(n,r)),lS("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",i.SPACE_SIZE*n+i.SPACE_SIZE/2)("cy",i.SPACE_SIZE*r+i.SPACE_SIZE/2)}}function Jfe(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",2),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),wS(),pS(2,Xfe,1,4,"circle",3),wS()}if(2&e){var r=t.index,i=RS().index,a=RS();DE(1),NS("id","click_",r,"_",i,""),mS("ngClass",a.getRectClasses(r,i)),lS("x",a.SPACE_SIZE*r)("y",a.SPACE_SIZE*i)("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),DE(1),mS("ngIf",a.board[i][r]!==a.EMPTY)}}function ehe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Jfe,3,8,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}var the=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).EMPTY=K7.NONE,r.lastMove=new fte(-2,-2),r.captureds=[],r.scores=RB.of([2,2]),r.rules=new qfe(Hfe),r.availableMinimaxes=[new Wfe(r.rules,"ReversiMinimax")],r.encoder=Gfe.encoder,r.tutorial=(new Qfe).tutorial,r.canPass=!1,r.updateBoard(),r}return dy(n,[{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=new Gfe(e,t),r.next=6,n.chooseMove(a,n.rules.node.gameState,n.scores.get());case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.gameState;this.board=e.getCopiedBoard(),this.captureds=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new fte(-2,-2),this.scores=RB.of(e.countScore()),this.canPass=qfe.playerCanOnlyPass(e)}},{key:"showPreviousMove",value:function(){this.lastMove=this.rules.node.move.get().coord;var e,t=this.rules.node.gameState.getCurrentPlayer(),n=this.rules.node.gameState.getCurrentOpponent(),r=uy(ute.DIRECTIONS);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=this.lastMove.getNext(i,1);a.isInRange(Hfe.BOARD_WIDTH,Hfe.BOARD_HEIGHT)&&this.rules.node.gameState.getPieceAt(a)===n&&this.rules.node.mother.get().gameState.getPieceAt(a)===t;)this.captureds.push(a),a=a.getNext(i,1)}catch(o){r.e(o)}finally{r.f()}}},{key:"getRectClasses",value:function(e,t){var n=new fte(e,t);return this.captureds.some(function(e){return e.equals(n)})?["captured"]:n.equals(this.lastMove)?["moved"]:[]}},{key:"getPieceClass",value:function(e,t){return this.getPlayerClass(this.board[t][e])}},{key:"pass",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(N7(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Gfe.PASS.coord.x,Gfe.PASS.coord.y)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(_ne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-reversi"]],features:[Qb],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,ehe,2,1,"g",1),wS()),2&e&&(lS("viewBox","0 -4 "+8*t.SPACE_SIZE+" "+(10+8*t.SPACE_SIZE)),DE(1),mS("ngForOf",t.board))},directives:[nR,eR,iR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),nhe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,null,[{key:"getInitialState",value:function(){var e=vte.UNREACHABLE,t=vte.ZERO,r=vte.ONE,i=vte.EMPTY;return new n([[e,e,t,r,i,i,i,t,r,e,e],[e,i,i,i,i,i,i,i,i,i,e],[r,i,i,i,i,i,i,i,i,i,t],[t,i,i,i,i,i,i,i,i,i,r],[e,i,i,i,i,i,i,i,i,i,e],[e,e,r,t,i,i,i,r,t,e,e]],0)}}]),n}(kre);return e.HEIGHT=6,e.WIDTH=11,e}(),rhe=function(){var e=dy(function e(){fy(this,e)});return e.CAN_ONLY_REBOUND_ON_BLACK=function(){return $localize(xc||(xc=Hg(["You can only rebound on dark spaces."])))},e.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=function(){return $localize(Nc||(Nc=Hg(["You can only rebound on empty spaces."])))},e.MUST_CHOOSE_PYRAMID_FIRST=function(){return $localize(Dc||(Dc=Hg(["You must pick one of your pyramids first."])))},e.MUST_CHOOSE_OWN_PYRAMID=function(){return $localize(Lc||(Lc=Hg(["You must pick one of your pyramids."])))},e.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=function(){return $localize(Fc||(Fc=Hg(["Those two spaces are not neighbors."])))},e.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=function(){return $localize(Uc||(Uc=Hg(["Those two spaces have no intermediary neighbor."])))},e}(),ihe=function(e){Jg(n,e);var t=ty(n);function n(e,r){return fy(this,n),t.call(this,e,r)}return dy(n,[{key:"isSimpleStep",value:function(){return Math.abs(this.coord.x-this.end.x)+Math.abs(this.coord.y-this.end.y)===1}},{key:"equals",value:function(e){return e===this||!!e.coord.equals(this.coord)&&e.end.equals(this.end)}},{key:"toString",value:function(){return"SaharaMove("+this.coord+"->"+this.end+")"}}],[{key:"checkDistanceAndLocation",value:function(e,t){var n=Math.abs(e.x-t.x)+Math.abs(e.y-t.y);if(0===n)return DB.failure(Cte.MOVE_CANNOT_BE_STATIC());if(1===n){var r=mre.getFakeNeighbors(e);if(t.equals(r))return DB.failure(rhe.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==n)return DB.failure($localize(Vc||(Vc=Hg(["You can move one or two spaces, not ","."])),n));if(mre.isSpaceDark(e))return DB.failure(rhe.CAN_ONLY_REBOUND_ON_BLACK());if(e.x===t.x)return DB.failure(rhe.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return DB.SUCCESS}},{key:"from",value:function(e,t){if(!e.isInRange(nhe.WIDTH,nhe.HEIGHT))throw new Error("Move must start inside the board not at "+e.toString()+".");if(!t.isInRange(nhe.WIDTH,nhe.HEIGHT))throw new Error("Move must end inside the board not at "+t.toString()+".");var r=n.checkDistanceAndLocation(e,t);return r.isFailure()?r.toFailedFallible():MB.success(new n(e,t))}}]),n}(Mne);ihe.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 396*nhe.WIDTH+66*nhe.HEIGHT+6*nhe.WIDTH+nhe.HEIGHT}},{key:"encodeNumber",value:function(e){return 396*e.coord.x+66*e.coord.y+6*e.end.x+e.end.y}},{key:"decodeNumber",value:function(e){var t=e%6;e-=t;var n=(e/=6)%11;e-=n;var r=(e/=11)%6;return e-=r,ihe.from(new fte(e/=6,r),new fte(n,t)).get()}}]),n}(j7));var ahe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,r){OB(n.VERBOSE,"Legal move "+e.toString()+" applied");var i=t.getCopiedBoard();return i[e.end.y][e.end.x]=i[e.coord.y][e.coord.x],i[e.coord.y][e.coord.x]=vte.EMPTY,new nhe(i,t.turn+1)}},{key:"isLegal",value:function(e,t){if(t.getPieceAt(e.coord).value!==t.getCurrentPlayer().value)return MB.failure(Cte.CANNOT_CHOOSE_OPPONENT_PIECE());if(t.getPieceAt(e.end)!==vte.EMPTY)return MB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE());var n=mre.getCommonNeighbor(e.coord,e.end);return n.isPresent()?t.getPieceAt(n.get())===vte.EMPTY?MB.success(void 0):MB.failure(rhe.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):MB.success(void 0)}},{key:"getGameStatus",value:function(e){var t=e.gameState.getCopiedBoard(),r=n.getBoardValuesFor(t,Q7.ZERO),i=n.getBoardValuesFor(t,Q7.ONE);return n.getGameStatusFromFreedoms(r,i)}},{key:"getLandingCoords",value:function(e,t){var n=function(t){return t.isInRange(nhe.WIDTH,nhe.HEIGHT)&&e[t.y][t.x]===vte.EMPTY},r=new bte(mre.getNeighbors(t).filter(n));if(!0===mre.isSpaceDark(t))return r.toList();var i,a=new bte(r.toList()),o=uy(r);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=uy(mre.getNeighbors(u).filter(n));try{for(c.s();!(s=c.n()).done;){var l=s.value;a.add(l)}}catch(f){c.e(f)}finally{c.f()}}}catch(f){o.e(f)}finally{o.f()}return a.toList()}}],[{key:"getStartingCoords",value:function(e,t){for(var n=[],r=0;r<nhe.HEIGHT;r++)for(var i=0;i<nhe.WIDTH;i++)e[r][i].is(t)&&n.push(new fte(i,r));return n}},{key:"getBoardValuesFor",value:function(e,t){var r,i=[],a=uy(n.getStartingCoords(e,t));try{for(a.s();!(r=a.n()).done;){var o=r.value,s=kre.getEmptyNeighbors(e,o,vte.EMPTY).length;if(0===s)return[0];i.push(s)}}catch(u){a.e(u)}finally{a.f()}return i.sort(function(e,t){return e-t})}},{key:"getGameStatusFromFreedoms",value:function(e,t){return 0===e[0]?Lte.ONE_WON:0===t[0]?Lte.ZERO_WON:Lte.ONGOING}}]),n}(Fte);return e.VERBOSE=!1,e}(),ohe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getListMoves",value:function(e){var t,n=[],r=e.gameState.getCopiedBoard(),i=e.gameState.getCurrentPlayer(),a=uy(ahe.getStartingCoords(r,i));try{for(a.s();!(t=a.n()).done;){var o,s=t.value,u=uy(kre.getEmptyNeighbors(r,s,vte.EMPTY));try{for(u.s();!(o=u.n()).done;){var c=o.value,l=ihe.from(s,c).get();if(r[c.y][c.x]=r[s.y][s.x],r[s.y][s.x]=vte.EMPTY,n.push(l),(c.y+c.x)%2==0){var f,h=uy(kre.getEmptyNeighbors(r,c,vte.EMPTY));try{for(h.s();!(f=h.n()).done;){var d=f.value;if(!d.equals(s)){var v=ihe.from(s,d).get();r[d.y][d.x]=r[c.y][c.x],r[c.y][c.x]=vte.EMPTY,n.push(v),r[c.y][c.x]=r[d.y][d.x],r[d.y][d.x]=vte.EMPTY}}}catch(p){h.e(p)}finally{h.f()}}r[s.y][s.x]=r[c.y][c.x],r[c.y][c.x]=vte.EMPTY}}catch(p){u.e(p)}finally{u.f()}}}catch(p){a.e(p)}finally{a.f()}return n}},{key:"getBoardValue",value:function(e){var t=e.gameState.getCopiedBoard(),n=ahe.getBoardValuesFor(t,Q7.ZERO),r=ahe.getBoardValuesFor(t,Q7.ONE),i=ahe.getGameStatusFromFreedoms(n,r);if(i.isEndGame)return _te.fromWinner(i.winner);for(var a=0;a<6&&n[a]===r[a];)a++;return new _te(r[a%6]-n[a%6])}}]),n}(wte),she=vte.UNREACHABLE,uhe=vte.ZERO,che=vte.ONE,lhe=vte.EMPTY,fhe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Bc||(Bc=Hg(["Initial board"]))),$localize(zc||(zc=Hg(["S\xe2h\xe2r\xe2 is played on a board where each space is a triangle.\n        Each player has six pyramids."]))),nhe.getInitialState()),zte.informational($localize(Hc||(Hc=Hg(["Goal of the game"]))),$localize(Gc||(Gc=Hg(["At S\xe2h\xe2r\xe2, the goal of the game is to immobilize one of the opponent's pyramids.\n        To do so, you have to occupy all neighboring space of that pyramid.\n        Here, Light has lost because its leftmost pyramid is immobilized."]))),new nhe([[she,she,lhe,lhe,che,lhe,lhe,uhe,che,she,she],[she,lhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,she],[che,uhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,uhe],[uhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,che],[she,lhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,lhe,she],[she,she,che,uhe,lhe,lhe,lhe,che,uhe,she,she]],3)),zte.fromPredicate($localize($c||($c=Hg(["Simple step"]))),$localize(Zc||(Zc=Hg(["To immobilize your opponent, you have to move your pyramids.\n        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).\n        You're the first player, playing with the dark pyramids.\n        <ol>\n            <li>Click on one of your pyramids.</li>\n            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>\n        </ol><br/>\n        Do any simple step."]))),nhe.getInitialState(),ihe.from(new fte(2,0),new fte(2,1)).get(),function(e,t,n){return e.isSimpleStep()?DB.SUCCESS:DB.failure($localize(qc||(qc=Hg(["You have made a double step, which is good but it is the next exercise!"]))))},$localize(Wc||(Wc=Hg(["Congratulations!"])))),zte.fromPredicate($localize(jc||(jc=Hg(["Double step"]))),$localize(Yc||(Yc=Hg(["When a pyramid shares its vertices with dark spaces, it can move one or two steps.\n        To do so:\n        <ol>\n            <li>Click on the pyramid to move.</li>\n            <li>Click on one of the 6 destinations that you can reach in two steps:\n                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.\n        </ol>"]))),nhe.getInitialState(),ihe.from(new fte(7,0),new fte(5,0)).get(),function(e,t,n){return e.isSimpleStep()?DB.failure($localize(Kc||(Kc=Hg(["Failed! You have made a single step."])))):DB.SUCCESS},$localize(Qc||(Qc=Hg(["Congratulations!"]))))]});function hhe(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"polygon",7),wS()),2&e){var n=RS().index,r=RS().index,i=RS();DE(1),mS("ngClass",i.getPlayerClassFor(n,r)),lS("points",i.getPyramidCoordinate(n,r))}}function dhe(e,t){if(1&e&&(IC(),_S(0,"polygon",10)),2&e){var n=RS(2).index,r=RS().index;lS("points",RS().getTriangleCoordinate(n,r))}}function vhe(e,t){if(1&e&&(IC(),_S(0,"polygon",11)),2&e){var n=RS(2).index,r=RS().index;lS("points",RS().getTriangleCoordinate(n,r))}}function phe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,dhe,1,1,"polygon",8),pS(2,vhe,1,1,"polygon",9),wS()),2&e){var n=RS().index,r=RS().index;DE(1),mS("ngIf",(n+r)%2==1),DE(1),mS("ngIf",(n+r)%2==0)}}function ghe(e,t){if(1&e){var n=SS();IC(),CS(0,"g",5),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),pS(1,hhe,2,2,"g",6),pS(2,phe,3,2,"g",6),wS()}if(2&e){var r=t.$implicit;NS("id","click_",t.index,"_",RS().index,""),DE(1),mS("ngIf",r.isPlayer()),DE(1),mS("ngIf",2===r.value)}}function yhe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,ghe,3,4,"g",4),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function mhe(e,t){if(1&e&&(IC(),_S(0,"polygon",14)),2&e){var n=t.$implicit,r=RS(2);NS("id","possible_landing_",n.x,"_",n.y,""),lS("points",r.getTriangleCoordinate(n.x,n.y))}}function khe(e,t){if(1&e&&(IC(),_S(0,"polygon",15)),2&e){var n=RS(2);NS("id","chosen_coord_",n.chosenCoord.get().x,"_",n.chosenCoord.get().y,""),lS("points",n.getTriangleCoordinate(n.chosenCoord.get().x,n.chosenCoord.get().y))}}function Che(e,t){if(1&e&&(IC(),ES(0),pS(1,mhe,1,3,"polygon",12),pS(2,khe,1,3,"polygon",13),bS()),2&e){var n=RS();DE(1),mS("ngForOf",n.possibleLandings),DE(1),mS("ngIf",n.chosenCoord.isPresent())}}function whe(e,t){if(1&e&&(IC(),ES(0),_S(1,"polygon",16),_S(2,"polygon",16),bS()),2&e){var n=RS(2);DE(1),lS("points",n.getTriangleCoordinate(n.lastCoord.get().x,n.lastCoord.get().y)),DE(1),lS("points",n.getTriangleCoordinate(n.lastMoved.get().x,n.lastMoved.get().y))}}function _he(e,t){1&e&&(IC(),pS(0,whe,3,2,"ng-container",6)),2&e&&mS("ngIf",RS().lastMoved.isPresent())}var Ehe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).lastCoord=RB.empty(),r.lastMoved=RB.empty(),r.chosenCoord=RB.empty(),r.possibleLandings=[],r.rules=new ahe(nhe),r.availableMinimaxes=[new ohe(r.rules,"SaharaMinimax")],r.encoder=ihe.encoder,r.tutorial=(new fhe).tutorial,r.updateBoard(),r}return dy(n,[{key:"cancelMoveAttempt",value:function(){this.possibleLandings=[],this.chosenCoord=RB.empty()}},{key:"onClick",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i=n.canUserPlay("#click_"+e+"_"+t)).isFailure()){r.next=3;break}return r.abrupt("return",n.cancelMove(i.getReason()));case 3:return a=n.rules.node.gameState.getCurrentPlayer(),o=vte.ofPlayer(a),r.abrupt("return",n.chosenCoord.equalsValue(new fte(e,t))?(n.cancelMoveAttempt(),DB.SUCCESS):n.chosenCoord.isAbsent()||n.board[t][e]===o?n.choosePiece(e,t):n.chooseLandingCoord(e,t));case 5:case"end":return r.stop()}},r)}))()}},{key:"choosePiece",value:function(e,t){if(this.board[t][e]===vte.EMPTY)return this.cancelMove(rhe.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[t][e].is(Q7.fromTurn(this.getTurn()))){var n=new fte(e,t);return this.selectPiece(n),DB.SUCCESS}return this.cancelMove(rhe.MUST_CHOOSE_OWN_PYRAMID())}},{key:"selectPiece",value:function(e){this.chosenCoord=RB.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}},{key:"chooseLandingCoord",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=new fte(e,t),!(a=ihe.from(n.chosenCoord.get(),i)).isFailure()){r.next=5;break}r.t0=n.cancelMove(a.getReason()),r.next=8;break;case 5:return r.next=7,n.chooseMove(a.get(),n.rules.node.gameState);case 7:r.t0=r.sent;case 8:return r.abrupt("return",r.t0);case 9:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){var e=this.rules.node.move;this.lastCoord=e.map(function(e){return e.coord}),this.lastMoved=e.map(function(e){return e.end}),this.board=this.rules.node.gameState.board}},{key:"getPlayerClassFor",value:function(e,t){return this.getPlayerClass(Q7.of(this.board[t][e].value))}}]),n}(vre);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-sahara"]],features:[Qb],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke highlighted",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","highlighted",3,"id"],[1,"base","no-fill","small-stroke","selected",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,t){if(1&e&&(IC(),CS(0,"svg",0),pS(1,yhe,2,1,"g",1),pS(2,Che,3,2,"ng-container",2),pS(3,_he,1,1,"ng-template",null,3,XT),wS()),2&e){var n=gS(4);DE(1),mS("ngForOf",t.board),DE(1),mS("ngIf",t.chosenCoord.isPresent())("ngIfElse",n)}},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),bhe=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this,e,r)).x=e,o.y=r,o.moveDirection=i,o.landingOrientation=a,o.checkValidity(),o}return dy(n,[{key:"checkValidity",value:function(){var e=this.coord.isInRange(5,5);if(this.isRotation()){if(!e)throw new Error("Cannot rotate piece outside the board: "+this.toString()+".")}else if(this.coord.getNext(this.moveDirection.get()).isNotInRange(5,5)){if(!e)throw new Error("SiamMove should end or start on the board: "+this.toString()+".");if(this.moveDirection.get()!==this.landingOrientation)throw new Error("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+this.toString()+".")}}},{key:"isRotation",value:function(){return this.moveDirection.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!this.coord.equals(e.coord)||!1===this.moveDirection.equals(e.moveDirection))&&this.landingOrientation===e.landingOrientation}},{key:"toString",value:function(){var e=this.moveDirection.isAbsent()?"-":this.moveDirection.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+e+", "+this.landingOrientation+")"}},{key:"isInsertion",value:function(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}]),n}(Ite);bhe.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"maxValue",value:function(){return 2408}},{key:"encodeNumber",value:function(e){var t=e.coord.y+1,n=e.coord.x+1,r=e.moveDirection.isAbsent()?4:e.moveDirection.get().toInt();return 245*e.landingOrientation.toInt()+49*r+7*n+t}},{key:"decodeNumber",value:function(e){var t=e%7;e-=t;var n=(e/=7)%7;e-=n;var r=(e/=7)%5,i=4===r?RB.empty():cte.factory.fromInt(r).toOptional();e-=r;var a=cte.factory.fromInt(e/=5).get();return new bhe(n-1,t-1,i,a)}}]),n}(j7));var She=function(){function e(t){fy(this,e),this.value=t}return dy(e,[{key:"belongTo",value:function(e){return e===Q7.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}},{key:"isEmptyOrMountain",value:function(){return 0===this.value||9===this.value}},{key:"isPiece",value:function(){return!this.isEmptyOrMountain()}},{key:"getOwner",value:function(){return 1<=this.value&&this.value<=4?Q7.ZERO:5<=this.value&&this.value<=8?Q7.ONE:K7.NONE}},{key:"getOptionalDirection",value:function(){switch(this.value){case 0:return RB.empty();case 1:case 5:return RB.of(cte.UP);case 2:case 6:return RB.of(cte.RIGHT);case 3:case 7:return RB.of(cte.DOWN);case 4:case 8:return RB.of(cte.LEFT);default:return PB.expectToBe(this.value,9),RB.empty()}}},{key:"getDirection",value:function(){return this.getOptionalDirection().get()}},{key:"toString",value:function(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return PB.expectToBe(this.value,9),"MOUNTAIN"}}}],[{key:"decode",value:function(t){switch(t){case 0:return e.EMPTY;case 1:return e.LIGHT_UP;case 2:return e.LIGHT_RIGHT;case 3:return e.LIGHT_DOWN;case 4:return e.LIGHT_LEFT;case 5:return e.DARK_UP;case 6:return e.DARK_RIGHT;case 7:return e.DARK_DOWN;case 8:return e.DARK_LEFT;case 9:return e.MOUNTAIN}}},{key:"of",value:function(t,n){return n===Q7.ZERO?t===cte.UP?e.LIGHT_UP:t===cte.RIGHT?e.LIGHT_RIGHT:t===cte.DOWN?e.LIGHT_DOWN:e.LIGHT_LEFT:t===cte.UP?e.DARK_UP:t===cte.RIGHT?e.DARK_RIGHT:t===cte.DOWN?e.DARK_DOWN:e.DARK_LEFT}}]),e}();She.EMPTY=new She(0),She.LIGHT_UP=new She(1),She.LIGHT_RIGHT=new She(2),She.LIGHT_DOWN=new She(3),She.LIGHT_LEFT=new She(4),She.DARK_UP=new She(5),She.DARK_RIGHT=new She(6),She.DARK_DOWN=new She(7),She.DARK_LEFT=new She(8),She.MOUNTAIN=new She(9);var Phe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"countPlayerPawn",value:function(){for(var e=0,t=0;t<5;t++)for(var n=0;n<5;n++)this.board[t][n].belongTo(this.getCurrentPlayer())&&e++;return e}}],[{key:"getInitialState",value:function(){var e=t9.createTable(5,5,She.EMPTY);return e[2][1]=She.MOUNTAIN,e[2][2]=She.MOUNTAIN,e[2][3]=She.MOUNTAIN,new n(e,0)}}]),n}(Pte),Ohe=function(){var e=dy(function e(){fy(this,e)});return e.CANNOT_INSERT_WHEN_SELECTED=function(){return $localize(Xc||(Xc=Hg(["You cannot insert a piece when you have already selected a piece."])))},e.NO_REMAINING_PIECE_TO_INSERT=function(){return $localize(Jc||(Jc=Hg(["You cannot insert a piece, all your pieces are already on the board."])))},e.NOT_ENOUGH_FORCE_TO_PUSH=function(){return $localize(el||(el=Hg(["You do not have enough strength to push."])))},e.MUST_MOVE_OR_ROTATE=function(){return $localize(tl||(tl=Hg(["You must move or rotate your piece."])))},e.ILLEGAL_PUSH=function(){return $localize(nl||(nl=Hg(["Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board."])))},e.MUST_INSERT_OR_CHOOSE_YOUR_PIECE=function(){return $localize(rl||(rl=Hg(["You should insert or choose one of your pieces!"])))},e}(),The=dy(function e(t,n){fy(this,e),this.resultingBoard=t,this.moved=n}),Ihe=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"isLegal",value:function(e,t){if(OB(n.VERBOSE,{SiamRules_isLegal:{move:e,state:t}}),!e.isInsertion()&&!t.getPieceAt(e.coord).belongTo(t.getCurrentPlayer()))return MB.failure(Cte.MUST_CHOOSE_PLAYER_PIECE());if(e.isRotation())return OB(n.VERBOSE,"Move is rotation"),this.isLegalRotation(e,t);var r;if(e.isInsertion()){OB(n.VERBOSE,"Move is insertion");var i=this.isLegalInsertion(e.coord,t);if(i.legal.isFailure())return MB.failure(i.legal.getReason());r=i.insertedPiece}else OB(n.VERBOSE,"Move is forward"),r=t.getPieceAt(e.coord);return n.isLegalForwarding(e,t,r)}},{key:"isLegalInsertion",value:function(e,t){var r=t.countPlayerPawn(),i=t.getCurrentPlayer(),a=r<5?DB.SUCCESS:DB.failure(Ohe.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:n.getInsertedPiece(e,i),legal:a}}},{key:"isLegalRotation",value:function(e,t){OB(n.VERBOSE,{isLegalRotation:{rotation:e,state:t}});var r=e.coord,i=t.getPieceAt(r),a=t.getCurrentPlayer();if(i.getDirection()===e.landingOrientation)return MB.failure(Ohe.MUST_MOVE_OR_ROTATE());var o=t.getCopiedBoard();return o[r.y][r.x]=She.of(e.landingOrientation,a),MB.success(new The(o,[r]))}},{key:"applyLegalMove",value:function(e,t,n){var r=t9.copyBiArray(n.resultingBoard);return new Phe(r,t.turn+1)}},{key:"getGameStatus",value:function(e){var t=n.getMountainsRowsAndColumns(e.gameState),r=n.getWinner(e.gameState,e.move,t.nbMountain);return r.isPlayer()?Lte.getVictory(r):Lte.ONGOING}}],[{key:"getInsertedPiece",value:function(e,t){return She.of(-1===e.x?cte.RIGHT:-1===e.y?cte.DOWN:5===e.x?cte.LEFT:cte.UP,t)}},{key:"isLegalForwarding",value:function(e,t,r){OB(n.VERBOSE,{isLegalForwarding:{move:e.toString(),state:t,firstPiece:r}});var i=[],a=She.of(e.landingOrientation,t.getCurrentPlayer()),o=e.moveDirection.get(),s=e.coord.getNext(o);if(s.isInRange(5,5)&&t.getPieceAt(s)!==She.EMPTY&&!1===n.isStraight(r,e))return OB(n.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),MB.failure(Ohe.ILLEGAL_PUSH());var u=RB.of(o),c=o.getOpposite(),l=0,f=t.getCopiedBoard();e.coord.isInRange(5,5)&&(f[e.coord.y][e.coord.x]=She.EMPTY,i.push(e.coord));for(var h=s.isInRange(5,5)&&a!==She.EMPTY;h;){u.equalsValue(o)?l++:u.equalsValue(c)&&l--,OB(n.VERBOSE,{totalForce:l,movingPiece:a,landingCoord:s});var d=f[s.y][s.x];d===She.MOUNTAIN&&(l-=.9),f[s.y][s.x]=a,i.push(s),a=d,s=s.getNext(o),u=a.getOptionalDirection(),h=s.isInRange(5,5)&&a!==She.EMPTY&&l>0}return s.isNotInRange(5,5)&&(OB(n.VERBOSE,"This movement would push "+a+" outside the board"),u.equalsValue(o)?l++:u.equalsValue(c)&&l--),l<=0?(OB(n.VERBOSE,"This move is an illegal push: "+f),MB.failure(Ohe.NOT_ENOUGH_FORCE_TO_PUSH())):(OB(n.VERBOSE,"This move is a legal push: "+f),MB.success(new The(f,i)))}},{key:"isStraight",value:function(e,t){var n=e.getDirection();return t.moveDirection.equalsValue(n)&&n===t.landingOrientation}},{key:"getBoardValueInfo",value:function(e,t){var r=n.getMountainsRowsAndColumns(t),i=r.rows,a=r.columns,o=n.getWinner(t,e,r.nbMountain);if(o.isPlayer())return o===Q7.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};var s,u=n.getPushers(t,a,i),c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,f=t.getCurrentPlayer(),h=uy(u);try{for(h.s();!(s=h.n()).done;){var d=s.value;d.coord.isInRange(5,5)?t.getPieceAt(d.coord).belongTo(Q7.ZERO)?c=Math.min(c,d.distance):l=Math.min(l,d.distance):f===Q7.ZERO?c=Math.min(c,d.distance):l=Math.min(l,d.distance)}}catch(v){h.e(v)}finally{h.f()}return{shortestZero:c,shortestOne:l,boardValue:n.getScoreFromShortestDistances(c,l,f)}}},{key:"getScoreFromShortestDistances",value:function(e,t,n){e===Number.MAX_SAFE_INTEGER&&(e=6),t===Number.MAX_SAFE_INTEGER&&(t=6);var r=6-e,i=6-t;return r===i?n.getScoreModifier():r>i?-10*(r+1)+(i+1):10*(i+1)-(r+1)}},{key:"getMountainsRowsAndColumns",value:function(e){for(var t=[],n=[],r=0,i=0;i<5;i++)for(var a=0;a<5;a++)e.getPieceAtXY(a,i)===She.MOUNTAIN&&(t.includes(i)||t.push(i),n.includes(a)||n.push(a),r++);return{rows:t,columns:n,nbMountain:r}}},{key:"getWinner",value:function(e,t,r){return 2===r?n.getPusher(e,t.get()):K7.NONE}},{key:"getPusher",value:function(e,t){var r=t.coord,i=(r.isInRange(5,5)?e.getPieceAt(r.getNext(t.landingOrientation)):n.getInsertedPiece(r,e.getCurrentOpponent())).getDirection(),a=n.getPusherCoord(e,i,r),o=e.getPieceAt(a).getOwner();return OB(n.VERBOSE,r.toString()+" belong to "+e.getCurrentOpponent().value+", "+a.toString()+" belong to "+o.value+", "+o.value+" win"),o}},{key:"getPusherCoord",value:function(e,t,n){for(var r=n.getNext(t),i=n;r.isInRange(5,5);){n=r,r=r.getNext(t);var a=e.getPieceAt(n);a!==She.MOUNTAIN&&a.getDirection()===t&&(i=n)}return i}},{key:"getPushers",value:function(e,t,r){OB(n.VERBOSE,{getPushers:{state:e,mountainsColumn:t,mountainsRow:r}});var i,a=[],o=[],s=uy(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=cte.DOWN,l=new fte(u,4);o.push({direction:c,fallingCoord:l}),c=cte.UP,l=new fte(u,0),o.push({direction:c,fallingCoord:l})}}catch(k){s.e(k)}finally{s.f()}var f,h=uy(r);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=cte.LEFT,p=new fte(0,d);o.push({direction:v,fallingCoord:p}),v=cte.RIGHT,p=new fte(4,d),o.push({direction:v,fallingCoord:p})}}catch(k){h.e(k)}finally{h.f()}for(var g=0,y=o;g<y.length;g++){var m=y[g];a=n.addPotentialDirectionPusher(e,m.fallingCoord,m.direction,a)}return a}},{key:"addPotentialDirectionPusher",value:function(e,t,r,i){var a=n.getLineClosestPusher(e,t,r);if(a.isAbsent())return i;var o=a.get(),s=o.distance;return OB(n.VERBOSE,"new closest challenger"),i.push({coord:o.coord,distance:s}),i}},{key:"getLineClosestPusher",value:function(e,t,r){OB(n.VERBOSE,{getDirectionClosestPusher:{state:e,fallingCoord:t,direction:r.toString()}});for(var i=r.getOpposite(),a=1,o=e.getPieceAt(t),s=t,u=RB.empty(),c=!1,l=!1,f=0;s.isInRange(5,5)&&!1===c;){var h=e.getPieceAt(s);if(h.isEmptyOrMountain())h===She.MOUNTAIN?(f+=.9,l=!0):a++;else{var d=h.getDirection();d===r?l&&((f-=1)<=0&&(c=!0,s=s.getNext(r))):d===i?(f+=1,l||a++):l?(u=RB.of(s),o!==She.EMPTY&&a++):a++}o=h,s=s.getPrevious(r)}if(!1===c&&u.isPresent())for(a++,f-=1;!1===s.equals(u.get());)s=s.getNext(r),a--;return s.isNotInRange(5,5)&&(f-=1,5===e.countPlayerPawn())||f>0?RB.empty():RB.of({distance:a,coord:s})}},{key:"getPushingInsertions",value:function(e){for(var t=[],n=e.getCurrentPlayer(),r=[],i=[],a=0;a<5;a++)r.push(new bhe(-1,a,RB.of(cte.RIGHT),cte.RIGHT)),i.push(She.of(cte.RIGHT,n)),r.push(new bhe(5,a,RB.of(cte.LEFT),cte.LEFT)),i.push(She.of(cte.LEFT,n)),r.push(new bhe(a,-1,RB.of(cte.DOWN),cte.DOWN)),i.push(She.of(cte.DOWN,n)),r.push(new bhe(a,5,RB.of(cte.UP),cte.UP)),i.push(She.of(cte.UP,n));for(var o=0;o<r.length;o++)this.isLegalForwarding(r[o],e,i[o]).isSuccess()&&t.push(r[o]);return t}},{key:"getDerapingInsertions",value:function(e){for(var t,n,r=[],i=e.getCurrentPlayer(),a=1;a<=3;a++)t=new bhe(-1,a,RB.of(cte.RIGHT),cte.UP),n=She.of(cte.UP,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new bhe(-1,a,RB.of(cte.RIGHT),cte.DOWN),n=She.of(cte.DOWN,i),this.isLegalForwarding(t,e,n),r.push(t)),t=new bhe(5,a,RB.of(cte.LEFT),cte.UP),n=She.of(cte.UP,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new bhe(5,a,RB.of(cte.LEFT),cte.DOWN),n=She.of(cte.DOWN,i),this.isLegalForwarding(t,e,n),r.push(t));for(var o=1;o<=3;o++)t=new bhe(o,-1,RB.of(cte.DOWN),cte.LEFT),n=She.of(cte.LEFT,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new bhe(o,-1,RB.of(cte.DOWN),cte.RIGHT),n=She.of(cte.RIGHT,i),this.isLegalForwarding(t,e,n),r.push(t)),t=new bhe(o,5,RB.of(cte.UP),cte.LEFT),n=She.of(cte.LEFT,i),this.isLegalForwarding(t,e,n).isSuccess()&&(r.push(t),t=new bhe(o,5,RB.of(cte.UP),cte.RIGHT),n=She.of(cte.RIGHT,i),this.isLegalForwarding(t,e,n),r.push(t));return r}},{key:"getCoordDirection",value:function(e,t,n){var r=new fte(t,n);return this.getInsertedPiece(r,e.getCurrentPlayer()).getDirection()}},{key:"getMovesFrom",value:function(e,t,r,i){var a,o=[],s=t.getDirection(),u=uy(cte.ORTHOGONALS);try{for(u.s();!(a=u.n()).done;){var c=a.value;if(c!==s){var l=new bhe(r,i,RB.empty(),c);o.push(l)}var f,h=uy(new fte(r+c.x,i+c.y).isInRange(5,5)?cte.ORTHOGONALS:[c]);try{for(h.s();!(f=h.n()).done;){var d=f.value,v=new bhe(r,i,RB.of(c),d);n.isLegalForwarding(v,e,t).isSuccess()&&o.push(v)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){u.e(p)}finally{u.f()}return o}}]),n}(Fte);return e.VERBOSE=!1,e}(),Ahe=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){return new _te(Ihe.getBoardValueInfo(e.move,e.gameState).boardValue)}},{key:"getListMoves",value:function(e){for(var t=[],n=e.gameState.getCurrentPlayer(),r=0;r<5;r++)for(var i=0;i<5;i++){var a=e.gameState.getPieceAtXY(i,r);a.belongTo(n)&&(t=t.concat(Ihe.getMovesFrom(e.gameState,a,i,r)))}return e.gameState.countPlayerPawn()<5&&(t=(t=t.concat(Ihe.getPushingInsertions(e.gameState))).concat(Ihe.getDerapingInsertions(e.gameState))),OB(Ihe.VERBOSE,{getListMovesResult:t}),t}}]),n}(wte),Rhe=She.EMPTY,Mhe=She.MOUNTAIN,xhe=She.LIGHT_UP,Nhe=She.LIGHT_LEFT,Dhe=She.LIGHT_RIGHT,Lhe=She.LIGHT_DOWN,Fhe=She.DARK_UP,Uhe=She.DARK_LEFT,Vhe=She.DARK_RIGHT,Bhe=She.DARK_DOWN,zhe=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(il||(il=Hg(["Goal of the game"]))),$localize(al||(al=Hg(["The goal at Siam is to be the first to push a mountain out of the board.\n        The initial board contains three mountains, and no pieces are initially on the board.\n        During its turn, a player can do one of the following three actions:\n        <ol>\n            <li>Put a new piece on the board.</li>\n            <li>Change the orientation of one of its piece, and optionally move it.</li>\n            <li>Take one of its pieces out of the board.</li>\n        </ol>"]))),Phe.getInitialState()),zte.anyMove($localize(ol||(ol=Hg(["Inserting a piece"]))),$localize(sl||(sl=Hg(["Each player has 5 pieces in total.\n        As long as you do not have 5 pieces on the board, you can insert new pieces. To do so:\n        <ol>\n            <li>Click on one of the big arrows alongside the board.</li>\n            <li>Click on one of the small arrows that appeared on the landing square of your piece.\n                This is the direction in which your piece will be oriented.</li>\n        </ol><br/>\n        Insert a piece on the board."]))),Phe.getInitialState(),new bhe(2,-1,RB.of(cte.DOWN),cte.DOWN),$localize(ul||(ul=Hg(["Congratulations!"])))),zte.fromMove($localize(cl||(cl=Hg(["Moving a piece"]))),$localize(ll||(ll=Hg(['We will distinguish here "moving" and "pushing".\n        A move is made from a piece\'s square to an empty neighboring square, horizontally or vertically.\n        During that move, you can also move the piece out of the board.\n        To move a piece:\n        <ol>\n            <li>Click on it.</li>\n            <li>Click on one of the 4 arrows to pick the direction in which it will move.\n                You can also click on the middle dot to change the piece\'s orientation without moving it.</li>\n            <li>Click on one of the 4 arrows on the landing square to pick its orientation.</li>\n        </ol><br/>\n        Try to move the piece that is on the board one square upwards and to orient it downwards.']))),new Phe([[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Mhe,Mhe,Mhe,Rhe],[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Rhe,xhe,Rhe,Rhe]],0),[new bhe(2,4,RB.of(cte.UP),cte.DOWN)],$localize(fl||(fl=Hg(["Congratulations, you made a side-slip!"]))),$localize(hl||(hl=Hg(["Failed!"])))),zte.fromMove($localize(dl||(dl=Hg(["Moving a piece out of the board"]))),$localize(vl||(vl=Hg(["To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>\n        Get that piece out of the board!"]))),new Phe([[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Mhe,Mhe,Mhe,Rhe],[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Rhe,xhe,Rhe,Rhe]],0),[new bhe(2,4,RB.of(cte.DOWN),cte.DOWN)],$localize(pl||(pl=Hg(["Congratulations, even if in this context it was not a useful move."]))),$localize(gl||(gl=Hg(["Failed, the piece is still on the board."])))),zte.fromMove($localize(yl||(yl=Hg(["Pushing"]))),$localize(ml||(ml=Hg(['When the landing square of your move is occupied, we use the term "push".\n        In order to push, multiple conditions must hold:\n        <ol>\n            <li>Your piece must already be oriented in the direction of the push.</li>\n            <li>The number of the pieces (opponent\'s or not) that are facing yours (called the resistants)\n                must be smaller than the number of pieces that are oriented in the same direction as the push, yourself included (the pushers).</li>\n            <li>The number of mountains on that line must be smaller or equal to the difference between the pushers and the resistants.</li>\n        </ol>\n        Your piece on the top right cannot push because there is one mountain too much.\n        Your piece on the bottom right can push.<br/><br/>\n        Do it.']))),new Phe([[Dhe,Mhe,Mhe,Uhe,Nhe],[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Rhe,Rhe,Mhe,Rhe],[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Rhe,Vhe,Uhe,Nhe]],0),[new bhe(4,4,RB.of(cte.LEFT),cte.LEFT)],$localize(kl||(kl=Hg(["Congratulations!"]))),$localize(Cl||(Cl=Hg(["Failed!"])))),zte.fromMove($localize(wl||(wl=Hg(["Victory"]))),$localize(_l||(_l=Hg(["The game ends when a mountain is pushed out of the board.\n        If you pushed it and nobody is in front of you, you're the winner.\n        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.\n        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>\n        You have two ways of ending the game here: you can either win, or lose. Choose correctly!"]))),new Phe([[Rhe,Rhe,Rhe,Rhe,Rhe],[Rhe,Rhe,Rhe,Rhe,Rhe],[Mhe,Fhe,Nhe,Rhe,Lhe],[Rhe,Rhe,Rhe,Rhe,Bhe],[Rhe,Rhe,Rhe,Rhe,Mhe]],0),[new bhe(2,2,RB.of(cte.LEFT),cte.LEFT)],$localize(El||(El=Hg(["Congratulations, you won!"]))),$localize(bl||(bl=Hg(["Failed, you lost."]))))]});function Hhe(e,t){if(1&e){var n=SS();IC(),CS(0,"use",7),TS("click",function(){var e=eC(n).$implicit;return RS(3).insertAt(e.x,e.y)}),wS()}if(2&e){var r=t.$implicit,i=RS(3);NS("id","insertAt_",r.x,"_",r.y,""),lS("transform",i.getInsertionArrowTransform(r.x+1,r.y+1,r.dir))}}var Ghe=function(e,t){return{dir:"DOWN",x:e,y:t}},$he=function(e){return{dir:"UP",x:e,y:5}},Zhe=function(e,t){return{dir:"RIGHT",x:e,y:t}},qhe=function(e){return{dir:"LEFT",x:5,y:e}},Whe=function(e,t,n,r){return[e,t,n,r]};function jhe(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Hhe,1,3,"use",6),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",function(e,t,n,r,i,a,o){return function(e,t,n,r,i,a,o,s,u){var c=t+n;return function(e,t,n,r,i,a){var o=cS(e,t,n,r);return cS(e,t+2,i,a)||o}(e,c,i,a,o,s)?sS(e,c+4,u?r.call(u,i,a,o,s):r(i,a,o,s)):TT(e,c+4)}(Xk(),cC(),e,t,n,r,i,a,o)}(11,Whe,OT(1,Ghe,n,-1),PT(4,$he,n),OT(6,Zhe,-1,n),PT(9,qhe,n)))}}var Yhe=function(){return[0,1,2,3,4]};function Khe(e,t){1&e&&(IC(),ES(0),pS(1,jhe,2,16,"g",5),bS()),2&e&&(DE(1),mS("ngForOf",ST(1,Yhe)))}function Qhe(e,t){if(1&e){var n=SS();IC(),CS(0,"use",13),TS("click",function(){var e=eC(n).$implicit;return RS(5).chooseDirection(e)}),wS()}if(2&e){var r=t.$implicit,i=RS(3).index,a=RS().index,o=RS();xS("id","chooseDirection_",r,""),lS("transform",o.getArrowTransform(i+1,a+1,r))}}var Xhe=function(){return["RIGHT","DOWN","LEFT","UP"]};function Jhe(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"circle",11),TS("click",function(){return eC(n),RS(4).chooseDirection("")}),wS(),pS(2,Qhe,1,2,"use",12),wS()}if(2&e){var r=RS(2).index,i=RS().index,a=RS();DE(1),lS("cx",(r+1)*a.SPACE_SIZE+a.SPACE_SIZE/2)("cy",(i+1)*a.SPACE_SIZE+a.SPACE_SIZE/2),DE(1),mS("ngForOf",ST(3,Xhe))}}function ede(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"use",10),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().clickPiece(e,t)}),wS(),pS(2,Jhe,3,4,"g",4),wS()}if(2&e){var r=RS(),i=r.index,a=r.$implicit,o=RS().index,s=RS();DE(1),NS("id","clickPiece_",i,"_",o,""),mS("ngClass",s.getPieceClasses(a)),lS("transform",s.getPieceTransform(i,o)),DE(1),mS("ngIf",s.choosingDirection(i,o))}}function tde(e,t){if(1&e){var n=SS();IC(),CS(0,"use",14),TS("click",function(){eC(n);var e=RS().index,t=RS().index;return RS().clickPiece(e,t)}),wS()}if(2&e){var r=RS().index,i=RS().index,a=RS();lS("transform","translate("+(r+1)*a.SPACE_SIZE+" "+(i+1)*a.SPACE_SIZE+")")}}function nde(e,t){if(1&e){var n=SS();IC(),CS(0,"use",13),TS("click",function(){var e=eC(n).$implicit;return RS(4).chooseOrientation(e)}),wS()}if(2&e){var r=t.$implicit,i=RS(2).index,a=RS().index,o=RS();xS("id","chooseOrientation_",r,""),lS("transform",o.getArrowTransform(i+1,a+1,r))}}function rde(e,t){1&e&&(IC(),CS(0,"g"),pS(1,nde,1,2,"use",12),wS()),2&e&&(DE(1),mS("ngForOf",ST(1,Xhe)))}function ide(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",8),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().insertAt(e,t)}),wS(),pS(2,ede,3,5,"g",4),pS(3,tde,1,1,"use",9),pS(4,rde,2,2,"g",4),wS()}if(2&e){var r=t.$implicit,i=t.index,a=RS().index,o=RS();DE(1),NS("id","insertAt_",i,"_",a,""),mS("ngClass",o.getSquareClasses(i,a)),lS("x",o.SPACE_SIZE*(i+1))("y",o.SPACE_SIZE*(a+1))("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),DE(1),mS("ngIf",r.isPiece()),DE(1),mS("ngIf",o.isMountain(r)),DE(1),mS("ngIf",o.choosingOrientation(i,a))}}function ade(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,ide,5,10,"g",5),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}var ode=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).lastMove=RB.empty(),r.chosenCoord=RB.empty(),r.landingCoord=RB.empty(),r.chosenDirection=RB.empty(),r.chosenOrientation=RB.empty(),r.movedPieces=[],r.rules=new Ihe(Phe),r.availableMinimaxes=[new Ahe(r.rules,"SiamMinimax")],r.encoder=bhe.encoder,r.tutorial=(new zhe).tutorial,r.updateBoard(),r}return dy(n,[{key:"updateBoard",value:function(){if(OB(n.VERBOSE,"updateBoard"),this.board=this.rules.node.gameState.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){var e=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),e).get().moved}else this.movedPieces=[]}},{key:"cancelMoveAttempt",value:function(){this.chosenCoord=RB.empty(),this.chosenDirection=RB.empty(),this.landingCoord=RB.empty(),this.chosenOrientation=RB.empty()}},{key:"clickPiece",value:function(e,t){var n=this.canUserPlay("#clickPiece_"+e+"_"+t);return n.isFailure()?this.cancelMove(n.getReason()):this.board[t][e].getOwner()!==this.getCurrentPlayer()?this.cancelMove(Cte.MUST_CHOOSE_PLAYER_PIECE()):(this.chosenCoord=RB.of(new fte(e,t)),DB.SUCCESS)}},{key:"chooseDirection",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(OB(n.VERBOSE,"SiamComponent.chooseDirection("+e+")"),!(i=t.canUserPlay("#chooseDirection_"+e)).isFailure()){r.next=4;break}return r.abrupt("return",t.cancelMove(i.getReason()));case 4:if(""!==e){r.next=8;break}t.chosenDirection=RB.empty(),t.landingCoord=t.chosenCoord,r.next=15;break;case 8:if(a=cte.factory.fromString(e).get(),t.chosenDirection=RB.of(a),t.landingCoord=RB.of(t.chosenCoord.get().getNext(a)),!t.landingCoord.get().isNotInRange(5,5)){r.next=15;break}return OB(n.VERBOSE,"orientation and direction should be the same: "+a),t.chosenOrientation=RB.of(a),r.next=14,t.tryMove();case 14:return r.abrupt("return",r.sent);case 15:return r.abrupt("return",DB.SUCCESS);case 16:case"end":return r.stop()}},r)}))()}},{key:"chooseOrientation",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(OB(n.VERBOSE,"SiamComponent.chooseOrientation("+e+")"),!(i=t.canUserPlay("#chooseOrientation_"+e)).isFailure()){r.next=6;break}r.t0=t.cancelMove(i.getReason()),r.next=10;break;case 6:return t.chosenOrientation=RB.of(cte.factory.fromString(e).get()),r.next=9,t.tryMove();case 9:r.t0=r.sent;case 10:return r.abrupt("return",r.t0);case 11:case"end":return r.stop()}},r)}))()}},{key:"insertAt",value:function(e,t){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(OB(n.VERBOSE,"SiamComponent.insertAt("+e+", "+t+")"),!(a=r.canUserPlay("#insertAt_"+e+"_"+t)).isFailure()){i.next=4;break}return i.abrupt("return",r.cancelMove(a.getReason()));case 4:if(!r.chosenCoord.isPresent()){i.next=6;break}return i.abrupt("return",r.cancelMove(Ohe.CANNOT_INSERT_WHEN_SELECTED()));case 6:if(o=new fte(e,t),!r.getState().isOnBoard(o)||!r.getState().getPieceAtXY(e,t).isEmptyOrMountain()){i.next=9;break}return i.abrupt("return",r.cancelMove(Ohe.MUST_INSERT_OR_CHOOSE_YOUR_PIECE()));case 9:return r.chosenCoord=RB.of(o),s=Ihe.getCoordDirection(r.getState(),e,t),i.abrupt("return",(r.chosenDirection=RB.of(s),r.landingCoord=RB.of(r.chosenCoord.get().getNext(s)),DB.SUCCESS));case 12:case"end":return i.stop()}},i)}))()}},{key:"tryMove",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.chosenCoord.get(),r=new bhe(n.x,n.y,e.chosenDirection,e.chosenOrientation.get()),e.cancelMove(),t.next=4,e.chooseMove(r,e.rules.node.gameState);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}},t)}))()}},{key:"isMountain",value:function(e){return e===She.MOUNTAIN}},{key:"choosingOrientation",value:function(e,t){var r=new fte(e,t);return!!(this.chosenCoord.isPresent()&&this.landingCoord.equalsValue(r)&&this.chosenOrientation.isAbsent())&&(OB(n.VERBOSE,"choosing orientation now"),!0)}},{key:"choosingDirection",value:function(e,t){var r=new fte(e,t);return!!(this.chosenCoord.equalsValue(r)&&this.chosenDirection.isAbsent()&&this.landingCoord.isAbsent()&&this.chosenOrientation.isAbsent())&&(OB(n.VERBOSE,"choosing direction now"),!0)}},{key:"getInsertionArrowTransform",value:function(e,t,n){var r="rotate(".concat(90*(cte.factory.fromString(n).get().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+e*this.SPACE_SIZE+", "+t*this.SPACE_SIZE+")",r].join(" ")}},{key:"getPieceTransform",value:function(e,t){var n="rotate(".concat(90*(this.board[t][e].getDirection().toInt()-2)," ").concat(this.SPACE_SIZE/2," ").concat(this.SPACE_SIZE/2,")");return["translate("+(e+1)*this.SPACE_SIZE+", "+(t+1)*this.SPACE_SIZE+")",n].join(" ")}},{key:"getArrowTransform",value:function(e,t,n){return Mfe.getArrowTransform(this.SPACE_SIZE,new fte(e,t),cte.factory.fromString(n).get())}},{key:"getPieceClasses",value:function(e){return[this.getPlayerClass(e.getOwner())]}},{key:"getSquareClasses",value:function(e,t){var n=new fte(e,t);return this.movedPieces.some(function(e){return e.equals(n)})?["moved"]:[]}}]),n}(_ne);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-siam"]],features:[Qb],decls:7,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 0 700 700","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 93, 90 50, 70 50, 70 7, 27.5 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngIf"],[4,"ngFor","ngForOf"],[0,"xlink","href","#arrow","class","base mid-stroke",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","click"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#mountain","fill","brown",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],["id","chooseDirection_","r","8",1,"arrow","selected-fill","no-stroke",3,"click"],["class","arrow selected-fill no-stroke",0,"xlink","href","#triangle",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"arrow","selected-fill","no-stroke",3,"id","click"],[0,"xlink","href","#mountain","fill","brown",3,"click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),CS(1,"defs"),_S(2,"polygon",1),_S(3,"polygon",2),_S(4,"polygon",3),wS(),pS(5,Khe,2,2,"ng-container",4),pS(6,ade,2,1,"g",5),wS()),2&e&&(DE(5),mS("ngIf",t.isPlayerTurn()),DE(1),mS("ngForOf",t.board))},directives:[iR,nR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),sde=function(){var e=dy(function e(){fy(this,e)});return e.NO_MOVEMENT_BEFORE_TURN_40=function(){return $localize(Sl||(Sl=Hg(["You cannot move yet. Pick a space where you will put a new piece."])))},e.MUST_CUT=function(){return $localize(Pl||(Pl=Hg(["Several groups are of the same size, you must pick the one to keep."])))},e.CANNOT_CHOOSE_TO_KEEP=function(){return $localize(Ol||(Ol=Hg(["You cannot choose which part to keep when one is smaller than the other."])))},e.CAN_NO_LONGER_DROP=function(){return $localize(Tl||(Tl=Hg(["You cannot put new pieces anymore. Pick a piece to move."])))},e.MUST_CAPTURE_BIGGEST_GROUPS=function(){return $localize(Il||(Il=Hg(["You must choose one of the biggest groups to keep it."])))},e.CANNOT_KEEP_EMPTY_COORD=function(){return $localize(Al||(Al=Hg(["You cannot pick an empty space. Pick one of the biggest groups."])))},e.MUST_DROP_NEXT_TO_OTHER_PIECE=function(){return $localize(Rl||(Rl=Hg(["You must put this piece next to another piece."])))},e}(),ude=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;fy(this,n),(a=t.call(this,r)).pieces=e;var o=a.getCalculatedScale();return a.pieces=o.pieces,a.width=o.width,a.height=o.height,a.offset=null!=i?i:o.offset,a.pieces.makeImmutable(),a}return dy(n,[{key:"getCalculatedScale",value:function(){var e,t=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER,a=uy(this.pieces.listKeys());try{for(a.s();!(e=a.n()).done;){var o=e.value;t=Math.min(o.x,t),n=Math.max(o.x,n),r=Math.min(o.y,r),i=Math.max(o.y,i)}}catch(v){a.e(v)}finally{a.f()}var s=new xte,u=new ate(-t,-r);if(0!==t||0!==r){var c,l=uy(this.pieces.listKeys());try{for(l.s();!(c=l.n()).done;){var f=c.value,h=this.pieces.delete(f),d=f.getNext(u);s.set(d,h)}}catch(v){l.e(v)}finally{l.f()}}else s=this.pieces;return{width:n+1-t,height:i+1-r,pieces:s,offset:u}}},{key:"toRepresentation",value:function(){var e,t=t9.createTable(this.width,this.height,K7.NONE.value),n=uy(this.pieces.listKeys());try{for(n.s();!(e=n.n()).done;){var r=e.value,i=this.getPieceAt(r).value;t[r.y][r.x]=i}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"isIllegalLandingZone",value:function(e,t){return this.pieces.containsKey(e)?DB.failure(Cte.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(e,t)?DB.SUCCESS:DB.failure(sde.MUST_DROP_NEXT_TO_OTHER_PIECE())}},{key:"isCoordConnected",value:function(e,t){var n,r=uy(pte.factory.all);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e.getNext(i,1);if(this.pieces.containsKey(a)&&!1===t.equalsValue(a))return!0}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"isOnBoard",value:function(e){return this.pieces.containsKey(e)}},{key:"getPieceAt",value:function(e){return this.isOnBoard(e)?this.pieces.get(e).get():K7.NONE}},{key:"applyLegalDrop",value:function(e){var t=this.pieces.getCopy();return t.put(e,this.getCurrentPlayer()),new n(t,this.turn+1)}},{key:"applyLegalDeplacement",value:function(e,t){var r=n.deplacePiece(this,e),i=new xte;if(t.size()>0){i=new xte;var a,o=uy(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.set(s,r.get(s).get())}}catch(u){o.e(u)}finally{o.f()}}else i=r.getCopy();return new n(i,this.turn+1)}},{key:"countPieces",value:function(){var e=this.pieces.reverse(),t=e.get(Q7.ZERO).getOrElse(new Wne),n=e.get(Q7.ONE).getOrElse(new Wne);return[t.size(),n.size()]}},{key:"switchPiece",value:function(e){var t=this.pieces.getCopy(),r=this.getPieceAt(e);if(r.isPlayer())return t.replace(e,r.getOpponent()),new n(t,this.turn,this.offset);x7.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:e.toString()})}},{key:"equals",value:function(e){return this.turn===e.turn&&this.pieces.equals(e.pieces)}}],[{key:"getInitialState",value:function(){return n.fromRepresentation([[Q7.ZERO.value],[Q7.ONE.value]],0)}},{key:"fromRepresentation",value:function(e,t,r){for(var i=new xte,a=0;a<e.length;a++)for(var o=0;o<e[0].length;o++)e[a][o]!==K7.NONE.value&&i.set(new fte(o,a),Q7.of(e[a][o]));return new n(i,t,r)}},{key:"deplacePiece",value:function(e,t){var n=e.pieces.getCopy();return n.delete(t.start.get()),n.set(t.landing,e.getCurrentPlayer()),n}},{key:"getGroups",value:function(e,t){var r,i=new xte,a=0,o=uy(pte.factory.all);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=t.getNext(s,1);i=n.putCoordInGroup(e,u,i,""+a),a++}}catch(h){o.e(h)}finally{o.f()}for(var c=i.reverse(),l=new bte,f=0;f<c.size();f++)l.add(c.getByIndex(f).value);return l}},{key:"putCoordInGroup",value:function(e,t,r,i){if(e.get(t).isPresent()&&r.get(t).isAbsent()){r.set(t,i);var a,o=uy(pte.factory.all);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=t.getNext(s,1);r=n.putCoordInGroup(e,u,r,i)}}catch(c){o.e(c)}finally{o.f()}}return r}}]),n}(Ste),cde=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;if(fy(this,n),(a=t.call(this)).start=e,a.landing=r,a.keep=i,e.equalsValue(r))throw new Error("Deplacement cannot be static!");if(e.isPresent()&&e.equals(i))throw new Error("Cannot keep starting coord, since it will always be empty after move!");return ny(a)}return dy(n,[{key:"isDrop",value:function(){return this.start.isAbsent()}},{key:"isCut",value:function(){return this.keep.isPresent()}},{key:"toString",value:function(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}},{key:"equals",value:function(e){return!1!==this.landing.equals(e.landing)&&!1!==this.start.equals(e.start)&&this.keep.equals(e.keep)}}],[{key:"fromDrop",value:function(e){return new n(RB.empty(),e,RB.empty())}},{key:"fromMovement",value:function(e,t){return new n(RB.of(e),t,RB.empty())}},{key:"fromCut",value:function(e,t,r){return new n(RB.of(e),t,RB.of(r))}}]),n}(Tte);cde.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encodeMove",value:function(e){return{start:e.start.isPresent()?fte.encoder.encode(e.start.get()):null,landing:fte.encoder.encode(e.landing),keep:e.keep.isPresent()?fte.encoder.encode(e.keep.get()):null}}},{key:"decodeMove",value:function(e){var t=e;if("object"!=typeof e)throw new Error("Invalid encodedMove of type "+typeof e+"!");var n=fte.encoder.decode(t.landing);if(null==t.start)return cde.fromDrop(n);var r=fte.encoder.decode(t.start);if(null==t.keep)return cde.fromMovement(r,n);var i=fte.encoder.decode(t.keep);return cde.fromCut(r,n,i)}}]),n}(W7));var lde=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return t.turn<40?t.applyLegalDrop(e.landing):t.applyLegalDeplacement(e,n)}},{key:"isLegal",value:function(e,t){OB(this.VERBOSE,{called:"SixRules.isLegal",move:e,state:t});var r=t.isIllegalLandingZone(e.landing,e.start);return r.isFailure()?r.toFailedFallible():t.turn<40?this.isLegalDrop(e,t):n.isLegalPhaseTwoMove(e,t)}},{key:"isLegalDrop",value:function(e,t){return!1===e.isDrop()?MB.failure(sde.NO_MOVEMENT_BEFORE_TURN_40()):MB.success(t.pieces.getKeySet())}},{key:"getGameStatus",value:function(e){var t=e.gameState,n=t.getCurrentOpponent(),r=[];if(e.move.isPresent()&&(r=this.getShapeVictory(e.move.get(),t)),6===r.length)return Lte.getVictory(n);if(t.turn>39){var i=t.countPieces(),a=i[0],o=i[1];return a<6&&o<6?a<o?Lte.ONE_WON:o<a?Lte.ZERO_WON:Lte.DRAW:a<6?Lte.getDefeat(Q7.ZERO):o<6?Lte.getDefeat(Q7.ONE):Lte.ONGOING}return Lte.ONGOING}},{key:"startSearchingVictorySources",value:function(){OB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"getShapeVictory",value:function(e,t){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();var n=this.searchVictoryOnly(this.currentVictorySource,e,t);if(6===n.length)return n}return[]}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(OB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){OB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(pte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return[];var o=(e+i.length)%6;i.push(a),a=a.getNext(pte.factory.all[o],1)}return i}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=pte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return[];s=!0,i=i.getOpposite(),a=a.getNext(i,o.length)}a=a.getNext(i,1)}return o}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){OB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=pte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.length%2==0&&(i=pte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return a}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){OB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=pte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return[];a.push(o),a.length%2==0&&(i=pte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return a}}],[{key:"getLegalLandings",value:function(e){var t,n=new Wne,r=uy(e.pieces.listKeys());try{for(r.s();!(t=r.n()).done;){var i,a=t.value,o=uy(pte.factory.all);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=a.getNext(s,1);e.getPieceAt(u)===K7.NONE&&n.add(u)}}catch(c){o.e(c)}finally{o.f()}}}catch(c){r.e(c)}finally{r.f()}return n.toList()}},{key:"isLegalPhaseTwoMove",value:function(e,t){if(e.isDrop())return MB.failure(sde.CAN_NO_LONGER_DROP());switch(t.getPieceAt(e.start.get())){case K7.NONE:return MB.failure(Cte.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case t.getCurrentOpponent():return MB.failure(Cte.CANNOT_CHOOSE_OPPONENT_PIECE())}var r=ude.deplacePiece(t,e),i=ude.getGroups(r,e.start.get());if(n.isSplit(i)){var a=this.getBiggerGroups(i);return 1===a.size()?e.keep.isPresent()?MB.failure(sde.CANNOT_CHOOSE_TO_KEEP()):MB.success(a.getAnyElement().get()):this.moveKeepBiggerGroup(e.keep,a,r)}return MB.success(new Wne)}},{key:"isSplit",value:function(e){return e.size()>1}},{key:"getBiggerGroups",value:function(e){var t,n=0,r=new bte,i=uy(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.size();o>n?(n=o,r=new bte([a])):o===n&&r.add(a)}}catch(s){i.e(s)}finally{i.f()}return r}},{key:"moveKeepBiggerGroup",value:function(e,t,n){if(e.isAbsent())return MB.failure(sde.MUST_CUT());if(n.get(e.get()).isAbsent())return MB.failure(sde.CANNOT_KEEP_EMPTY_COORD());var r,i=e.get(),a=uy(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.contains(i))return MB.success(o)}}catch(s){a.e(s)}finally{a.f()}return MB.failure(sde.MUST_CAPTURE_BIGGEST_GROUPS())}}]),n}(Fte),fde=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"calculateBoardValue",value:function(e,t){this.startSearchingVictorySources();for(var n={status:Rte.DEFAULT,victory:RB.empty(),preVictory:RB.empty(),sum:0};this.hasNextVictorySource();){var r,i=this.getNextVictorySource();if((r=n.status===Rte.PRE_VICTORY?this.searchVictoryOnly(i,e,t):this.getBoardInfo(i,e,t,n)).status===Rte.VICTORY)return r;n={status:r.status,victory:RB.empty(),preVictory:r.preVictory,sum:n.sum+r.sum}}return n}}]),n}(wte),hde=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e)).value=e,i.preVictory=r,i}return dy(n)}(_te),dde=function(e){Jg(n,e);var t=ty(n);function n(){var e;return fy(this,n),(e=t.apply(this,arguments)).VERBOSE=!1,e}return dy(n,[{key:"getListMoves",value:function(e){var t=n.get(),r=e.getOwnValue(t);if(r.preVictory.isPresent())return e.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(e,r);var i=lde.getLegalLandings(e.gameState);return e.gameState.turn<40?this.getListDrop(i):this.getListDeplacement(e.gameState,i)}},{key:"createForcedDrop",value:function(e){OB(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:e});var t=[],n=cde.fromDrop(e.preVictory.get());return t.push(n),t}},{key:"createForcedDeplacement",value:function(e,t){OB(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:e});var n=this.getSafelyMovablePieceOrFirstOne(e),r=[t.preVictory.get()];return this.getDeplacementFrom(e.gameState,n,r)}},{key:"getDeplacementFrom",value:function(e,t,n){var r,i=[],a=uy(t);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,u=uy(n);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=cde.fromMovement(s,c);if(e.isCoordConnected(c,RB.of(s))){var f=ude.deplacePiece(e,l),h=ude.getGroups(f,l.start.get());if(lde.isSplit(h)){var d,v=uy(h);try{for(v.s();!(d=v.n()).done;){var p=d.value.getAnyElement().get(),g=cde.fromCut(s,c,p);i.push(g)}}catch(y){v.e(y)}finally{v.f()}}else i.push(l)}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}return i}},{key:"getSafelyMovablePieceOrFirstOne",value:function(e){var t,n=e.gameState,r=n.pieces.reverse(),i=n.getCurrentPlayer(),a=r.get(i).get(),o=a.getAnyElement().get(),s=[],u=uy(a);try{for(u.s();!(t=u.n()).done;){var c=t.value;!1===this.isPieceBlockingAVictory(n,c)&&s.push(c)}}catch(l){u.e(l)}finally{u.f()}return new Wne(0===s.length?[o]:s)}},{key:"isPieceBlockingAVictory",value:function(e,t){var n=e.switchPiece(t),r=cde.fromDrop(t);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,r,n).status===Rte.VICTORY)return!0;return!1}},{key:"getListDrop",value:function(e){var t,n=[],r=uy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=cde.fromDrop(i);n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n}},{key:"getListDeplacement",value:function(e,t){var n=e.getCurrentPlayer(),r=e.pieces.reverse().get(n).get();return this.getDeplacementFrom(e,r,t)}},{key:"getBoardValue",value:function(e){var t=e.move,n=e.gameState,r=n.getCurrentOpponent(),i=r.getVictoryValue(),a={status:Rte.DEFAULT,victory:RB.empty(),preVictory:RB.empty(),sum:0};t.isPresent()&&(a=this.calculateBoardValue(t.get(),n));var o=RB.empty();if(a.status===Rte.DEFAULT&&a.preVictory.isPresent()&&(o=RB.of(a.preVictory.get())),a.status===Rte.VICTORY)return new hde(i,RB.empty());if(n.turn>39){var s=n.countPieces(),u=s[0],c=s[1];return u<6&&c<6?new hde(u<c?Q7.ONE.getVictoryValue():c<u?Q7.ZERO.getVictoryValue():0,RB.empty()):u<6?new hde(Q7.ZERO.getDefeatValue(),RB.empty()):c<6?new hde(Q7.ONE.getDefeatValue(),RB.empty()):new hde(u-c,o)}return new hde(a.status===Rte.PRE_VICTORY?r.getPreVictory():a.sum*r.getScoreModifier(),o)}},{key:"startSearchingVictorySources",value:function(){OB(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}},{key:"hasNextVictorySource",value:function(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}},{key:"getNextVictorySource",value:function(){if(5===this.currentVictorySource.index){var e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{var t=1;"LINE"===this.currentVictorySource.typeSource&&(t=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+t}}return this.currentVictorySource}},{key:"searchVictoryOnly",value:function(e,t,n){var r=t.landing.getNext(n.offset,1);switch(OB(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:e,move:t,state:n}),e.typeSource){case"LINE":return this.searchVictoryOnlyForLine(e.index,r,n);case"CIRCLE":return this.searchVictoryOnlyForCircle(e.index,r,n);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(e.index,r,n);default:return this.searchVictoryOnlyForTriangleEdge(e.index,r,n)}}},{key:"searchVictoryOnlyForCircle",value:function(e,t,n){OB(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=[t],a=t.getNext(pte.factory.all[e],1);i.length<6;){if(n.getPieceAt(a)!==r)return{status:Rte.PRE_VICTORY,victory:RB.empty(),preVictory:RB.empty(),sum:0};var o=(e+i.length)%6;i.push(a),a=a.getNext(pte.factory.all[o],1)}return{status:Rte.VICTORY,victory:RB.of(i),preVictory:RB.empty(),sum:0}}},{key:"searchVictoryOnlyForLine",value:function(e,t,n){for(var r=n.getCurrentOpponent(),i=pte.factory.all[e],a=t.getNext(i,1),o=[t],s=!1;o.length<6;){if(n.getPieceAt(a)===r)o.push(a);else{if(s)return{status:Rte.PRE_VICTORY,victory:RB.empty(),preVictory:RB.empty(),sum:0};s=!0,i=i.getOpposite(),a=a.getNext(i,o.length-1)}a=a.getNext(i,1)}return{status:Rte.VICTORY,victory:RB.of(o),preVictory:RB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleCorner",value:function(e,t,n){OB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=pte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Rte.PRE_VICTORY,victory:RB.empty(),preVictory:RB.empty(),sum:0};a.length%2==0&&(i=pte.factory.all[(e+a.length)%6]),a.push(o),o=o.getNext(i,1)}return{status:Rte.VICTORY,victory:RB.of(a),preVictory:RB.empty(),sum:0}}},{key:"searchVictoryOnlyForTriangleEdge",value:function(e,t,n){OB(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:e,lastDrop:t,state:n});for(var r=n.getCurrentOpponent(),i=pte.factory.all[e],a=[t],o=t.getNext(i,1);a.length<6;){if(n.getPieceAt(o)!==r)return{status:Rte.PRE_VICTORY,victory:RB.empty(),preVictory:RB.empty(),sum:0};a.push(o),a.length%2==0&&(i=pte.factory.all[(e+a.length)%6]),o=o.getNext(i,1)}return{status:Rte.VICTORY,victory:RB.of(a),preVictory:RB.empty(),sum:0}}},{key:"getBoardInfo",value:function(e,t,n,r){OB(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:e,move:t,state:n,boardInfo:r});var i=t.landing.getNext(n.offset,1);switch(e.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(e.index,i,n,r);case"LINE":return this.getBoardInfoForLine(e.index,i,n,r);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(e.index,i,n,r);default:return this.getBoardInfoForTriangleEdge(e.index,i,n,r)}}},{key:"getBoardInfoForCircle",value:function(e,t,n,r){OB(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=[t],o=t.getNext(pte.factory.all[e],1),s=0,u=RB.empty();a.length<6;){var c=n.getPieceAt(o);if(c===i)return r;var l=(e+a.length)%6;a.push(o);var f=pte.factory.all[l];c===K7.NONE?(s+=.16,u=RB.of(o)):s++,o=o.getNext(f,1)}return this.getBoardInfoResult(s,u,a,r)}},{key:"getBoardInfoResult",value:function(e,t,n,r){var i=r.preVictory;if(4.16===e){if(OB(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(t))return{status:Rte.PRE_VICTORY,victory:RB.empty(),preVictory:RB.empty(),sum:0};i=t}else if(5===e)return{status:Rte.VICTORY,victory:RB.of(n),preVictory:RB.empty(),sum:0};return{status:r.status,victory:RB.empty(),preVictory:i,sum:r.sum+e}}},{key:"getBoardInfoForLine",value:function(e,t,n,r){OB(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=pte.factory.all[e],a=t.getPrevious(i,5),o=[],s=[],u=RB.empty(),c=0;c<6;c++){var l=this.updateEncounterAndReturnLastEmpty(n,a,s);l.isPresent()&&(u=l),o.push(a),a=a.getNext(i,1)}for(var f=r.status,h=r.preVictory,d=0,v=0;d<6;){var p=s.reduce(function(e,t){return e+t});if(6===p)return{status:Rte.VICTORY,victory:RB.of(o),preVictory:RB.empty(),sum:0};5.16===p&&f===Rte.DEFAULT&&(h.isPresent()?(N7(!1===h.equals(u),"Impossible to have point aligned with differents line to a same point"),f=Rte.PRE_VICTORY):h=u),v=Math.max(v,p),(o=o.slice(1,6)).push(a),s=s.slice(1,6);var g=this.updateEncounterAndReturnLastEmpty(n,a,s);g.isPresent()&&(u=g),d++,a=a.getNext(i,1)}var y={status:f,victory:RB.of(o),preVictory:h,sum:v};return this.getBoardInfoResult(v,u,o,y)}},{key:"updateEncounterAndReturnLastEmpty",value:function(e,t,n){var r=e.getCurrentPlayer();switch(e.getPieceAt(t)){case r:return n.push(-7),RB.empty();case K7.NONE:return n.push(.16),RB.of(t);default:return n.push(1),RB.empty()}}},{key:"getBoardInfoForTriangleCorner",value:function(e,t,n,r){OB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=pte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=RB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===K7.NONE?(u+=.16,c=RB.of(s)):u++,o.length%2==0&&(a=pte.factory.all[(e+o.length)%6]),o.push(s),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}},{key:"getBoardInfoForTriangleEdge",value:function(e,t,n,r){OB(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:e,lastDrop:t,state:n,boardInfo:r});for(var i=n.getCurrentPlayer(),a=pte.factory.all[e],o=[t],s=t.getNext(a,1),u=0,c=RB.empty();o.length<6;){var l=n.getPieceAt(s);if(l===i)return r;l===K7.NONE?(u+=.16,c=RB.of(s)):u++,o.push(s),o.length%2==0&&(a=pte.factory.all[(e+o.length)%6]),s=s.getNext(a,1)}return this.getBoardInfoResult(u,c,o,r)}}],[{key:"get",value:function(){if(n.singleton.isAbsent()){var e=new lde(ude);n.singleton=RB.of(new n(e,"SixMinimax"))}return n.singleton.get()}}]),n}(fde);dde.singleton=RB.empty();var vde=K7.NONE.value,pde=Q7.ZERO.value,gde=Q7.ONE.value,yde=function(){var e=dy(function e(){fy(this,e)});return e.MOVEMENT_NOT_DISCONNECTING=function(){return $localize(Ml||(Ml=Hg(["This move does not disconnect your opponent's pieces. Try again with another piece."])))},e.MOVEMENT_SELF_DISCONNECTING=function(){return $localize(xl||(xl=Hg(["You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!"])))},e}(),mde=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Nl||(Nl=Hg(["Six"]))),$localize(Dl||(Dl=Hg(["Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.\n        Each player has 21 pieces, with one for each player already on the board.\n        The goal of the game is to form one of the three winning shapes with your pieces."]))),ude.getInitialState()),zte.fromMove($localize(Ll||(Ll=Hg(["Victory (line)"]))),$localize(Fl||(Fl=Hg(["On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>\n        Find the victory. You're playing Dark."]))),ude.fromRepresentation([[pde,gde,gde,gde,gde,pde],[vde,pde,gde,vde,pde,vde],[gde,gde,pde,vde,vde,vde],[vde,vde,pde,vde,vde,vde],[vde,pde,vde,vde,vde,vde],[pde,vde,vde,vde,vde,vde]],0),[cde.fromDrop(new fte(3,2))],$localize(Ul||(Ul=Hg(["Congratulations!"]))),$localize(Vl||(Vl=Hg(["Failed!"])))),zte.fromMove($localize(Bl||(Bl=Hg(["Victory (circle)"]))),$localize(zl||(zl=Hg(["On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),ude.fromRepresentation([[vde,vde,vde,gde,vde,vde],[vde,vde,gde,gde,pde,pde],[vde,gde,vde,pde,gde,vde],[gde,pde,pde,pde,pde,gde]],0),[cde.fromDrop(new fte(5,2))],$localize(Hl||(Hl=Hg(["Congratulations! Note that if a piece is inside the circle, it does not change anything."]))),$localize(Gl||(Gl=Hg(["Failed!"])))),zte.fromMove($localize($l||($l=Hg(["Victory (triangle)"]))),$localize(Zl||(Zl=Hg(["On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>\n        Find the victory. You're playing Dark."]))),ude.fromRepresentation([[vde,vde,vde,gde,vde,vde],[vde,pde,gde,pde,pde,pde],[vde,pde,vde,pde,pde,vde],[gde,gde,gde,vde,gde,vde]],0),[cde.fromDrop(new fte(3,3))],$localize(ql||(ql=Hg(["Congratulations!"]))),$localize(Wl||(Wl=Hg(["Failed!"])))),zte.fromPredicate($localize(jl||(jl=Hg(["Second phase"]))),$localize(Yl||(Yl=Hg(["After 40 turns, your pieces have all been placed and we move on to the second phase of the game.\n        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.\n        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>\n        You're playing Dark. Make a move that disconnects one of your opponent's pieces."]))),ude.fromRepresentation([[vde,vde,vde,vde,vde,vde,vde,gde,vde],[vde,vde,vde,vde,vde,vde,pde,vde,vde],[vde,vde,vde,vde,pde,pde,pde,vde,vde],[vde,vde,vde,vde,gde,gde,vde,gde,pde],[vde,pde,gde,gde,pde,pde,gde,vde,vde],[pde,pde,pde,pde,gde,gde,gde,pde,vde],[gde,gde,pde,vde,gde,gde,pde,vde,vde],[vde,pde,vde,pde,pde,vde,vde,vde,vde],[gde,gde,gde,gde,vde,vde,vde,vde,vde],[vde,pde,vde,gde,vde,vde,vde,vde,vde]],40),cde.fromMovement(new fte(6,1),new fte(5,1)),function(e,t,n){var r=n.countPieces();return 19===r[0]?18===r[1]?DB.SUCCESS:DB.failure(yde.MOVEMENT_NOT_DISCONNECTING()):DB.failure(yde.MOVEMENT_SELF_DISCONNECTING())},$localize(Kl||(Kl=Hg(["Congratulations, your opponent now has one piece less and you're closer to victory!"])))),zte.fromPredicate($localize(Ql||(Ql=Hg(["Victory by disconnection"]))),$localize(Xl||(Xl=Hg(["During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.\n        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.\n        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>\n        Here, you're playing Dark and you can win. Do it!"]))),ude.fromRepresentation([[vde,vde,vde,vde,vde,gde],[vde,vde,vde,vde,pde,gde],[vde,vde,vde,gde,pde,pde],[vde,vde,pde,vde,gde,pde],[gde,gde,vde,vde,vde,pde],[pde,gde,vde,vde,vde,vde],[pde,vde,vde,vde,vde,vde]],40),cde.fromMovement(new fte(2,3),new fte(3,3)),function(e,t,n){return e.start.equalsValue(new fte(2,3))?DB.SUCCESS:DB.failure(yde.MOVEMENT_NOT_DISCONNECTING())},$localize(Jl||(Jl=Hg(["Congratulations, you won!"])))),zte.fromPredicate($localize(ef||(ef=Hg(["Special disconnection"]))),$localize(tf||(tf=Hg(["During a disconnection, two or more groups could have the same size,\n        in which case you will have to click on the group you wish to keep.<br/><br/>\n        You're playing Dark, play such a move!"]))),ude.fromRepresentation([[vde,vde,vde,vde,vde,gde],[vde,vde,vde,vde,pde,gde],[vde,vde,vde,gde,pde,pde],[pde,vde,pde,vde,vde,gde],[gde,gde,vde,vde,vde,vde],[pde,pde,vde,vde,vde,vde],[pde,vde,vde,vde,vde,vde]],40),cde.fromCut(new fte(2,3),new fte(2,5),new fte(2,5)),function(e,t,n){return e.keep.isAbsent()?DB.failure($localize(nf||(nf=Hg(["This move has not cut the board in two equal halves."])))):n.getPieceAt(e.landing.getNext(n.offset))===K7.NONE?DB.failure($localize(rf||(rf=Hg(["Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again."])))):DB.SUCCESS},$localize(af||(af=Hg(["Congratulations, you won!"]))))]});function kde(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",10),TS("click",function(){var e=eC(n).$implicit;return RS().onPieceClick(e)}),wS()}if(2&e){var r=t.$implicit,i=RS();NS("id","piece_",r.x,"_",r.y,""),mS("ngClass",i.getPieceClass(r)),lS("points",i.getHexaCoordsAt(r))}}function Cde(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",11),TS("click",function(){var e=eC(n).$implicit;return RS().onNeighborClick(e)}),wS()}if(2&e){var r=t.$implicit,i=RS();NS("id","neighbor_",r.x,"_",r.y,""),lS("points",i.getHexaCoordsAt(r))}}function wde(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",10),TS("click",function(){eC(n);var e=RS();return e.onPieceClick(e.chosenLanding.get())}),wS()}if(2&e){var r=RS();NS("id","chosenLanding_",r.chosenLanding.get().x,"_",r.chosenLanding.get().y,""),mS("ngClass",r.getPlayerClass(r.state.getCurrentPlayer())),lS("points",r.getHexaCoordsAt(r.chosenLanding.get()))}}function _de(e,t){if(1&e&&(IC(),_S(0,"polygon",12)),2&e){var n=t.$implicit,r=RS();NS("id","disconnected_",n.x,"_",n.y,""),lS("points",r.getHexaCoordsAt(n))}}function Ede(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",13),TS("click",function(){eC(n);var e=RS();return e.onNeighborClick(e.leftCoord.get())}),wS()}if(2&e){var r=RS();NS("id","leftCoord_",r.leftCoord.get().x,"_",r.leftCoord.get().y,""),lS("points",r.getHexaCoordsAt(r.leftCoord.get()))}}function bde(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",14),TS("click",function(){eC(n);var e=RS();return e.onPieceClick(e.lastDrop.get())}),wS()}if(2&e){var r=RS();NS("id","lastDrop_",r.lastDrop.get().x,"_",r.lastDrop.get().y,""),lS("points",r.getHexaCoordsAt(r.lastDrop.get()))}}function Sde(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",15),TS("click",function(){eC(n);var e=RS();return e.onPieceClick(e.selectedPiece.get())}),wS()}if(2&e){var r=RS();NS("id","selectedPiece_",r.selectedPiece.get().x,"_",r.selectedPiece.get().y,""),mS("ngClass",r.getSelectedPieceClass()),lS("points",r.getHexaCoordsAt(r.selectedPiece.get()))}}function Pde(e,t){if(1&e&&(IC(),_S(0,"polygon",16)),2&e){var n=t.$implicit,r=RS();NS("id","victoryCoord_",n.x,"_",n.y,""),lS("points",r.getHexaCoordsAt(n))}}function Ode(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",19),TS("click",function(){var e=eC(n).$implicit;return RS(2).onPieceClick(e)}),wS()}if(2&e){var r=t.$implicit,i=RS(2);NS("id","cuttable_",r.x,"_",r.y,""),lS("points",i.getHexaCoordsAt(r))}}function Tde(e,t){if(1&e&&(IC(),CS(0,"g",17),pS(1,Ode,1,3,"polygon",18),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}var Ide=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).disconnecteds=[],r.cuttableGroups=[],r.leftCoord=RB.empty(),r.lastDrop=RB.empty(),r.selectedPiece=RB.empty(),r.chosenLanding=RB.empty(),r.nextClickShouldSelectGroup=!1,r.rules=new lde(ude),r.availableMinimaxes=[new dde(r.rules,"SixMinimax")],r.encoder=cde.encoder,r.tutorial=(new mde).tutorial,r.SPACE_SIZE=30,r.hexaLayout=new gte(1.5*r.SPACE_SIZE,new fte(2*r.SPACE_SIZE,0),kte.INSTANCE),r.updateBoard(),r}return dy(n,[{key:"cancelMoveAttempt",value:function(){this.selectedPiece=RB.empty(),this.chosenLanding=RB.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}},{key:"updateBoard",value:function(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=RB.empty(),this.lastDrop=RB.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.pieces.listKeys(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}},{key:"getViewBox",value:function(){var e=this.mapAbstractCoordToCornerCoords(),t=this.getLimits(e);return t.minX-this.STROKE_WIDTH/2+" "+(t.minY-this.STROKE_WIDTH/2)+" "+(this.STROKE_WIDTH+t.maxX-t.minX)+" "+(this.STROKE_WIDTH+t.maxY-t.minY)}},{key:"mapAbstractCoordToCornerCoords",value:function(){var e,t=this,n=[],r=uy(this.pieces.concat(this.disconnecteds).concat(this.neighbors).map(function(e){return t.hexaLayout.getHexaCoordsAt(e)}));try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n.concat(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"getLimits",value:function(e){var t,n=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER,o=uy(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.x<i&&(i=s.x),s.y<a&&(a=s.y),n=Math.max(n,s.x),r=Math.max(r,s.y)}}catch(u){o.e(u)}finally{o.f()}return{minX:i,minY:a,maxX:n,maxY:r}}},{key:"showLastMove",value:function(){var e=this.rules.node.move.get();this.lastDrop=RB.of(e.landing.getNext(this.state.offset,1)),this.leftCoord=!1===e.isDrop()?RB.of(e.start.get().getNext(this.state.offset,1)):RB.empty();var t=this.rules.node.gameState;this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,t)),this.disconnecteds=this.getDisconnected()}},{key:"getDisconnected",value:function(){var e,t=this,n=this.rules.node.mother.get().gameState.pieces.listKeys(),r=this.rules.node.gameState.pieces.listKeys(),i=[],a=uy(n);try{var o=function(){var n=e.value;!1===t.rules.node.move.get().start.equalsValue(n)&&!1===r.some(function(e){return e.equals(n.getNext(t.state.offset,1))})&&i.push(n.getNext(t.state.offset,1))};for(a.s();!(e=a.n()).done;)o()}catch(u){a.e(u)}finally{a.f()}var s=this.lastDrop.get();return!1===this.pieces.some(function(e){return e.equals(s)})&&!1===r.some(function(e){return e.equals(s)})&&i.push(s),i}},{key:"getEmptyNeighbors",value:function(){var e=lde.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){var t=this.chosenLanding.get();e=e.filter(function(e){return!1===e.equals(t)})}return e}},{key:"getPieceClass",value:function(e){var t=this.rules.node.gameState.getPieceAt(e);return this.getPlayerClass(t)}},{key:"onPieceClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#piece_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!(t.state.turn<40)){n.next=5;break}return n.abrupt("return",t.cancelMove(sde.NO_MOVEMENT_BEFORE_TURN_40()));case 5:if(!t.chosenLanding.isAbsent()){n.next=7;break}return n.abrupt("return",t.state.getPieceAt(e)===t.state.getCurrentOpponent()?t.cancelMove(Cte.CANNOT_CHOOSE_OPPONENT_PIECE()):(t.selectedPiece=t.selectedPiece.equalsValue(e)?RB.empty():RB.of(e),DB.SUCCESS));case 7:return i=cde.fromCut(t.selectedPiece.get(),t.chosenLanding.get(),e),n.abrupt("return",t.chooseMove(i,t.state));case 9:case"end":return n.stop()}},n)}))()}},{key:"onNeighborClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#neighbor_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:if(!t.nextClickShouldSelectGroup){n.next=5;break}return n.abrupt("return",t.cancelMove(sde.MUST_CUT()));case 5:if(!(t.state.turn<40)){n.next=7;break}return n.abrupt("return",t.chooseMove(cde.fromDrop(e),t.state));case 7:if(!t.selectedPiece.isAbsent()){n.next=9;break}return n.abrupt("return",t.cancelMove(sde.CAN_NO_LONGER_DROP()));case 9:return i=cde.fromMovement(t.selectedPiece.get(),e),a=lde.isLegalPhaseTwoMove(i,t.state),n.abrupt("return",t.neededCutting(a)?(t.chosenLanding=RB.of(e),t.moveVirtuallyPiece(),t.showCuttable(),t.nextClickShouldSelectGroup=!0,DB.SUCCESS):t.chooseMove(i,t.state));case 11:case"end":return n.stop()}},n)}))()}},{key:"neededCutting",value:function(e){return e.isFailure()&&e.getReason()===sde.MUST_CUT()}},{key:"moveVirtuallyPiece",value:function(){var e=this.selectedPiece.get();this.pieces=this.pieces.filter(function(t){return!1===t.equals(e)}),this.neighbors=this.getEmptyNeighbors()}},{key:"showCuttable",value:function(){var e=cde.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),t=ude.deplacePiece(this.state,e),n=ude.getGroups(t,e.start.get()),r=lde.getBiggerGroups(n);this.cuttableGroups=[];var i,a=uy(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.cuttableGroups.push(o.toList())}}catch(s){a.e(s)}finally{a.f()}}},{key:"getSelectedPieceClass",value:function(){return this.chosenLanding.isPresent()?"moved":"selected"}}]),n}(dte);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-six"]],features:[Qb],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured",3,"id",4,"ngFor","ngForOf"],["class","base round moved mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round highlighted mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured",3,"id"],[1,"base","round","moved","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","highlighted","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,kde,1,4,"polygon",1),pS(2,Cde,1,3,"polygon",2),pS(3,wde,1,4,"polygon",3),pS(4,_de,1,3,"polygon",4),pS(5,Ede,1,3,"polygon",5),pS(6,bde,1,3,"polygon",6),pS(7,Sde,1,4,"polygon",7),pS(8,Pde,1,3,"polygon",8),pS(9,Tde,2,1,"g",9),wS()),2&e&&(lS("viewBox",t.viewBox),DE(1),mS("ngForOf",t.pieces),DE(1),mS("ngForOf",t.neighbors),DE(1),mS("ngIf",t.chosenLanding.isPresent()),DE(1),mS("ngForOf",t.disconnecteds),DE(1),mS("ngIf",t.leftCoord.isPresent()),DE(1),mS("ngIf",t.lastDrop.isPresent()),DE(1),mS("ngIf",t.selectedPiece.isPresent()),DE(1),mS("ngForOf",t.victoryCoords),DE(1),mS("ngForOf",t.cuttableGroups))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Ade=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getMaximalDistance",value:function(){return 9}}],[{key:"of",value:function(e,t){return new n(e,t)}},{key:"from",value:function(e,t){try{var r=new n(e,t);return MB.success(r)}catch(r){return MB.failure(r.message)}}}]),n}(Nne);Ade.encoder=Mne.getEncoder(9,9,Ade.of);var Rde={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:Q7.ZERO},Mde=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"from",value:function(e,t){return new n(e,t)}}],[{key:"getInitialState",value:function(){var e=Fne.UNOCCUPIED,t=Fne.INVADERS,r=Fne.DEFENDERS;return new n([[e,e,e,t,t,t,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,e,r,e,e,e,e],[t,e,e,e,r,e,e,e,t],[t,t,r,r,Fne.PLAYER_ONE_KING,r,r,t,t],[t,e,e,e,r,e,e,e,t],[e,e,e,e,r,e,e,e,e],[e,e,e,e,t,e,e,e,e],[e,e,e,t,t,t,e,e,e]],0)}}]),n}(Vne),xde=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.call(this,Mde,Rde,Ade.of)}return dy(n,null,[{key:"get",value:function(){return null==n.singleton&&(n.singleton=new n),Dte.ruler=this.singleton,n.singleton}}]),n}(zne),Nde=Fne.UNOCCUPIED,Dde=Fne.INVADERS,Lde=Fne.DEFENDERS,Fde=Fne.PLAYER_ONE_KING,Ude=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(of||(of=Hg(["Goal of the game"]))),$localize(sf||(sf=Hg(["Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne."]))),Mde.getInitialState()),zte.anyMove($localize(uf||(uf=Hg(["Moving"]))),$localize(cf||(cf=Hg(["All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move."]))),Mde.getInitialState(),Ade.of(new fte(4,1),new fte(1,1)),$localize(lf||(lf=Hg(["Congratulations!"])))),zte.fromMove($localize(ff||(ff=Hg(["Capturing a soldier (1/2)"]))),$localize(hf||(hf=Hg(["All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>Capture it."]))),new Mde([[Nde,Nde,Nde,Dde,Dde,Dde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Dde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Lde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Dde,Lde,Nde,Nde,Nde,Dde],[Dde,Dde,Lde,Lde,Fde,Lde,Lde,Dde,Dde],[Nde,Nde,Nde,Nde,Lde,Nde,Nde,Nde,Dde],[Nde,Nde,Nde,Nde,Lde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Dde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Dde,Dde,Dde,Nde,Nde,Nde]],1),[Ade.of(new fte(2,4),new fte(2,3)),Ade.of(new fte(4,2),new fte(3,2))],$localize(df||(df=Hg(["Congratulations, that will teach him a lesson!"]))),$localize(vf||(vf=Hg(["Failed, you missed an opportunity to capture a piece of the opponent."])))),zte.fromMove($localize(pf||(pf=Hg(["Capturing a soldier (2/2)"]))),$localize(gf||(gf=Hg(["A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>Capture it."]))),new Mde([[Nde,Nde,Nde,Dde,Dde,Dde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Dde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Lde,Nde,Nde,Nde,Nde],[Nde,Nde,Lde,Nde,Fde,Nde,Lde,Nde,Dde],[Dde,Dde,Nde,Lde,Nde,Lde,Lde,Dde,Dde],[Nde,Nde,Nde,Nde,Lde,Nde,Nde,Nde,Dde],[Nde,Nde,Nde,Nde,Lde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Dde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Dde,Dde,Dde,Nde,Nde,Nde]],12),[Ade.of(new fte(1,4),new fte(2,4))],$localize(yf||(yf=Hg(["Congratulations, one less defender. But keep an eye on the king, it is the most important."]))),$localize(mf||(mf=Hg(["Failed, you did not do the expected move."])))),zte.fromMove($localize(kf||(kf=Hg(["Capturing the king (1/2)"]))),$localize(Cf||(Cf=Hg(["To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>Capture the king."]))),new Mde([[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Dde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Dde,Fde,Nde,Dde,Nde,Nde,Nde,Nde,Nde],[Nde,Dde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde]],72),[Ade.of(new fte(3,4),new fte(2,4))],$localize(wf||(wf=Hg(["Congratulations, you won!"]))),$localize(_f||(_f=Hg(["Failed, you let the king run away."])))),zte.fromMove($localize(Ef||(Ef=Hg(["Capturing the king (2/2)"]))),$localize(bf||(bf=Hg(["Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>Capture the king."]))),new Mde([[Nde,Nde,Dde,Fde,Dde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Dde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde],[Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde,Nde]],72),[Ade.of(new fte(3,3),new fte(3,1))],$localize(Sf||(Sf=Hg(["The king is dead, long live the king. Congratulations, you won."]))),$localize(Pf||(Pf=Hg(["Failed!"]))))]});function Vde(e,t){1&e&&(IC(),_S(0,"polygon",8))}function Bde(e,t){1&e&&(IC(),_S(0,"rect",9))}function zde(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Vde,1,0,"polygon",6),pS(2,Bde,1,0,"ng-template",null,7,XT),wS()),2&e){var n=gS(3),r=RS().index,i=RS().index,a=RS();DE(1),mS("ngIf",a.isCentralThrone(r,i))("ngIfElse",n)}}function Hde(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"line",13),_S(2,"line",13),_S(3,"line",13),_S(4,"line",13),_S(5,"line",13),wS()),2&e){var n=RS(2).index,r=RS().index,i=RS();DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.1*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.9*i.SPACE_SIZE)("y2",.6*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.15*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.4*i.SPACE_SIZE)("x2",.85*i.SPACE_SIZE)("y2",.75*i.SPACE_SIZE)}}function Gde(e,t){if(1&e&&(IC(),_S(0,"polyline",16)),2&e){var n=RS(3).index,r=RS().index;mS("ngClass",RS().viewInfo.pieceClasses[r][n])}}function $de(e,t){if(1&e&&(IC(),_S(0,"line",13),_S(1,"line",13),_S(2,"line",13),_S(3,"line",13)),2&e){var n=RS(3).index,r=RS().index,i=RS();mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.5*i.SPACE_SIZE)("y1",.04*i.SPACE_SIZE)("x2",.5*i.SPACE_SIZE)("y2",.96*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.04*i.SPACE_SIZE)("y1",.5*i.SPACE_SIZE)("x2",.96*i.SPACE_SIZE)("y2",.5*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.2*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.8*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE),DE(1),mS("ngClass",i.viewInfo.pieceClasses[r][n]),lS("x1",.8*i.SPACE_SIZE)("y1",.2*i.SPACE_SIZE)("x2",.2*i.SPACE_SIZE)("y2",.8*i.SPACE_SIZE)}}function Zde(e,t){if(1&e&&(IC(),pS(0,Gde,1,1,"polyline",14),pS(1,$de,4,20,"ng-template",null,15,XT)),2&e){var n=gS(2),r=RS(2).index,i=RS().index;mS("ngIf",RS().isKing(r,i))("ngIfElse",n)}}function qde(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"circle",10),pS(2,Hde,6,25,"g",11),pS(3,Zde,3,2,"ng-template",null,12,XT),wS()),2&e){var n=gS(4),r=RS().index,i=RS().index,a=RS();DE(1),NS("id","piece_",r,"_",i,""),mS("ngClass",a.viewInfo.pieceClasses[i][r]),lS("r",a.SPACE_SIZE/2-a.STROKE_WIDTH)("cx",.5*a.SPACE_SIZE)("cy",.5*a.SPACE_SIZE),DE(1),mS("ngIf",a.isInvader(r,i))("ngIfElse",n)}}function Wde(e,t){if(1&e){var n=SS();IC(),CS(0,"g",3),TS("click",function(){var e=eC(n).index,t=RS().index;return RS().onClick(e,t)}),_S(1,"rect",4),pS(2,zde,4,2,"g",5),pS(3,qde,5,8,"g",5),wS()}if(2&e){var r=t.index,i=RS().index,a=RS();NS("id","click_",r,"_",i,""),lS("transform","translate("+a.SPACE_SIZE*r+", "+a.SPACE_SIZE*i+")"),DE(1),mS("ngClass",a.getRectClasses(r,i)),lS("width",a.SPACE_SIZE)("height",a.SPACE_SIZE),DE(1),mS("ngIf",a.board[i][r]===a.EMPTY&&a.isThrone(r,i)),DE(1),mS("ngIf",a.board[i][r]!==a.EMPTY)}}function jde(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Wde,4,8,"g",2),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function Yde(e,t){if(1&e){var n=SS();IC(),CS(0,"g"),CS(1,"rect",17),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e.x,e.y)}),wS(),wS()}if(2&e){var r=t.$implicit,i=RS();DE(1),NS("id","click_",r.x,"_",r.y,""),lS("x",i.SPACE_SIZE*r.x)("y",i.SPACE_SIZE*r.y)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)}}var Kde=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e,!1,Ade.from)).rules=xde.get(),r.availableMinimaxes=[new $ne(r.rules,"DummyBot"),new jne(r.rules,"Piece > Influence"),new Yne(r.rules,"Piece > Control"),new Kne(r.rules,"Escape > Piece > Control")],r.encoder=Ade.encoder,r.tutorial=(new Ude).tutorial,r.updateBoard(),r}return dy(n)}(Gne);return e.\u0275fac=function(t){return new(t||e)(yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["app-tablut"]],features:[Qb],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable",3,"id","click"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,jde,2,1,"g",1),pS(2,Yde,2,6,"g",1),wS()),2&e&&(lS("viewBox",t.getViewBox()),DE(1),mS("ngForOf",t.board),DE(1),mS("ngForOf",t.getClickables()))},directives:[nR,eR,iR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),e}(),Qde=dy(function e(){fy(this,e)});Qde.PLACEMENT_AFTER_INITIAL_PHASE=function(){return $localize(Of||(Of=Hg(["You cannot put a new ring after the tenth turn."])))},Qde.NO_MARKERS_IN_INITIAL_PHASE=function(){return $localize(Tf||(Tf=Hg(["You cannot put a marker in a ring before placing all of your rings."])))},Qde.MISSING_CAPTURES=Jae.MISSING_CAPTURES,Qde.MOVE_DIRECTION_INVALID=function(){return $localize(If||(If=Hg(["The direction of your move is invalid: a move is made along a straight line."])))},Qde.CAN_ONLY_CAPTURE_YOUR_MARKERS=function(){return $localize(Af||(Af=Hg(["You can only capture your own markers."])))},Qde.SHOULD_SELECT_PLAYER_RING=function(){return $localize(Rf||(Rf=Hg(["You must pick one of your own rings to move."])))},Qde.SHOULD_END_MOVE_ON_EMPTY_SPACE=function(){return $localize(Mf||(Mf=Hg(["Your ring must land on an empty space."])))},Qde.MOVE_SHOULD_NOT_PASS_ABOVE_RING=function(){return $localize(xf||(xf=Hg(["A ring can only jump over markers or empty spaces, not over another ring."])))},Qde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=function(){return $localize(Nf||(Nf=Hg(["Your ring must land on the first empty space after a group of markers."])))},Qde.AMBIGUOUS_CAPTURE_COORD=Jae.AMBIGUOUS_CAPTURE_COORD,Qde.CAPTURE_SHOULD_TAKE_RING=function(){return $localize(Df||(Df=Hg(["When you capture markers, you must take one of your ring as well by clicking on it."])))};var Xde=function(){function e(t,n){fy(this,e),this.player=t,this.isRing=n}return dy(e,[{key:"equals",value:function(e){return this===e}},{key:"flip",value:function(){return N7(!1===this.isRing,"cannot flip a ring (it should never happen)"),N7(this.player.isPlayer(),"cannot flip a non-player piece"),e.of(this.player.getOpponent(),this.isRing)}},{key:"toString",value:function(){switch(this){case e.UNREACHABLE:return"NONE";case e.EMPTY:return"EMPTY";case e.MARKER_ZERO:return"MARKER_ZERO";case e.MARKER_ONE:return"MARKER_ONE";case e.RING_ZERO:return"RING_ZERO";default:return PB.expectToBe(this,e.RING_ONE),"RING_ONE"}}}],[{key:"of",value:function(t,n){return t===K7.NONE?e.EMPTY:n?e.RINGS[t.value]:e.MARKERS[t.value]}}]),e}();Xde.encoder=j7.tuple([Q7.numberEncoder,j7.booleanEncoder],function(e){return[e.player,e.isRing]},function(e){return Xde.of(e[0],e[1])}),Xde.UNREACHABLE=new Xde(K7.NONE,!1),Xde.EMPTY=new Xde(K7.NONE,!1),Xde.MARKER_ZERO=new Xde(Q7.ZERO,!1),Xde.MARKER_ONE=new Xde(Q7.ONE,!1),Xde.MARKERS=[Xde.MARKER_ZERO,Xde.MARKER_ONE],Xde.RING_ZERO=new Xde(Q7.ZERO,!0),Xde.RING_ONE=new Xde(Q7.ONE,!0),Xde.RINGS=[Xde.RING_ZERO,Xde.RING_ONE];var Jde=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i){var a;return fy(this,n),(a=t.call(this,i,e,n.SIZE,n.SIZE,[6,4,3,2,1],Xde.EMPTY)).sideRings=r,a}return dy(n,[{key:"isInitialPlacementPhase",value:function(){return this.turn<10}},{key:"countScores",value:function(){return this.turn<10?[0,0]:this.sideRings}},{key:"equals",value:function(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&t9.compareTable(this.board,e.board)}},{key:"getRingCoords",value:function(e){var t=[];return this.forEachCoord(function(n,r){r.isRing&&r.player===e&&t.push(n)}),t}},{key:"isOnBoard",value:function(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Xde.UNREACHABLE}},{key:"setAtUnsafe",value:function(e,t){var r=t9.copyBiArray(this.board);return r[e.y][e.x]=t,new n(r,this.sideRings,this.turn)}}],[{key:"getInitialState",value:function(){var e=Xde.EMPTY,t=Xde.UNREACHABLE;return new n([[t,t,t,t,t,t,e,e,e,e,t],[t,t,t,t,e,e,e,e,e,e,e],[t,t,t,e,e,e,e,e,e,e,e],[t,t,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,e],[t,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,e,t],[e,e,e,e,e,e,e,e,e,t,t],[e,e,e,e,e,e,e,e,t,t,t],[e,e,e,e,e,e,e,t,t,t,t],[t,e,e,e,e,t,t,t,t,t,t]],[5,5],0)}}]),n}(xie);return e.SIZE=11,e}(),eve=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;if(fy(this,n),i=t.call(this,e),5!==e.length)throw new Error("YinshCapture must capture exactly 5 pieces");return i.ringTaken=RB.ofNullable(r),ny(i)}return dy(n,[{key:"setRingTaken",value:function(e){return new n(this.capturedSpaces,e)}},{key:"equals",value:function(e){return!(!1===Qg(ay(n.prototype),"equals",this).call(this,e)||!1===this.ringTaken.equals(e.ringTaken))}}],[{key:"of",value:function(e,t,r){for(var i=[],a=pte.factory.fromMove(e,t).get(),o=e;!1===o.equals(t);o=o.getNext(a))i.push(o);return i.push(t),new n(i,r)}}]),n}(Yae);eve.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encode",value:function(e){return{captured:e.capturedSpaces.map(function(e){return fte.encoder.encode(e)}),ringTaken:fte.encoder.encode(e.ringTaken.get())}}},{key:"decode",value:function(e){var t=e;return N7(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new eve(t.captured.map(function(e){return fte.encoder.decode(e)}),fte.encoder.decode(t.ringTaken))}}]),n}(q7));var tve=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a){var o;return fy(this,n),(o=t.call(this)).initialCaptures=e,o.start=r,o.end=i,o.finalCaptures=a,o}return dy(n,[{key:"isInitialPlacement",value:function(){return this.end.isAbsent()}},{key:"equals",value:function(e){return this===e||!(!1===this.start.equals(e.start)||!1===this.end.equals(e.end)||!1===t9.compareArray(this.initialCaptures,e.initialCaptures)||!1===t9.compareArray(this.finalCaptures,e.finalCaptures))}},{key:"toString",value:function(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}},{key:"capturesToString",value:function(e){var t,n="",r=uy(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;""!==n&&(n+=","),n+="["+i.toString()+"]"}}catch(a){r.e(a)}finally{r.f()}return n}}]),n}(Tte);tve.coordOptionalEncoder=jae(fte.encoder),tve.encoder=new(function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"encodeMove",value:function(e){var t={moveStart:fte.encoder.encode(e.start),moveEnd:tve.coordOptionalEncoder.encode(e.end)};return e.initialCaptures.map(function(e,n){t["initialCapture"+n]=eve.encoder.encode(e)}),e.finalCaptures.map(function(e,n){t["finalCapture"+n]=eve.encoder.encode(e)}),t}},{key:"decodeMove",value:function(e){var t=e;return N7(null!=t.moveStart,"Invalid encoded YinshMove"),new tve(this.decodeArray(t,"initialCapture",eve.encoder.decode),fte.encoder.decode(t.moveStart),tve.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",eve.encoder.decode))}},{key:"decodeArray",value:function(e,t,n){for(var r=[],i=0;null!=e[t+i];i++)r.push(n(e[t+i]));return r}}]),n}(W7));var nve=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"getBoardValue",value:function(e){var t=this.ruler.getGameStatus(e);return t.isEndGame?_te.fromWinner(t.winner):new _te(e.gameState.sideRings[0]*Q7.ZERO.getScoreModifier()+e.gameState.sideRings[1]*Q7.ONE.getScoreModifier())}},{key:"getListMoves",value:function(e){var t=this,n=[],r=e.gameState;if(r.isInitialPlacementPhase()){var i,a=uy(r.getCoordsAndContents());try{for(a.s();!(i=a.n()).done;){var o=qg(i.value,2),s=o[0];o[1]===Xde.EMPTY&&n.push(new tve([],s,RB.empty(),[]))}}catch(c){a.e(c)}finally{a.f()}}else{var u=this.ruler;this.getPossibleCaptureCombinations(r).forEach(function(e){var i=u.applyCaptures(e,r);t.getRingMoves(i).forEach(function(r){var a=u.applyRingMoveAndFlip(r.start,r.end,i);t.getPossibleCaptureCombinations(a).forEach(function(t){var i=new tve(e,r.start,RB.of(r.end),t);n.push(i)})})})}return n}},{key:"getPossibleCaptureCombinations",value:function(e){var t=this.ruler.getPossibleCaptures(e),n=this.getRingCoords(e);return toe.getPossibleCaptureCombinationsFromPossibleCaptures(t).map(function(e){return function(){function e(){fy(this,e)}return dy(e,null,[{key:"getCombinations",value:function(e,t){var n=this;return N7(e.length>=t,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(e,t).map(function(e){return n.getPermutations(e)}).reduce(function(e,t){return e.concat(t)})}},{key:"getPermutations",value:function(e){for(var t=e.length,n=[e.slice()],r=new Array(t).fill(0),i=1;i<t;)if(r[i]<i){var a=i%2&&r[i],o=e[i];e[i]=e[a],e[a]=o,++r[i],i=1,n.push(e.slice())}else r[i]=0,++i;return n}},{key:"getSubsetsOfSize",value:function(e,t){return function t(n,r){if(r>=e.length||n<1)return[[]];for(var i=[];r<=e.length-n;){var a,o=e[r],s=uy(t(n-1,r+1));try{for(s.s();!(a=s.n()).done;){var u=a.value;u.push(o),i.push(u)}}catch(c){s.e(c)}finally{s.f()}++r}return i}(t,0)}}]),e}().getCombinations(n,e.length).map(function(t){return e.map(function(e,n){return new eve(e.capturedSpaces,t[n])})})}).reduce(function(e,t){return e.concat(t)},[])}},{key:"getRingMoves",value:function(e){var t,n=this.ruler,r=[],i=uy(this.getRingCoords(e));try{for(i.s();!(t=i.n()).done;){var a,o=t.value,s=uy(n.getRingTargets(e,o));try{for(s.s();!(a=s.n()).done;){var u=a.value;r.push({start:o,end:u})}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getRingCoords",value:function(e){var t=e.getCurrentPlayer().value,n=[];return e.forEachCoord(function(e,r){r===Xde.RINGS[t]&&n.push(e)}),n}}]),n}(wte),rve=function(e){Jg(n,e);var t=ty(n);function n(){return fy(this,n),t.apply(this,arguments)}return dy(n,[{key:"applyLegalMove",value:function(e,t,n){return new Jde(n.board,n.sideRings,n.turn+1)}},{key:"applyCaptures",value:function(e,t){var n=this,r=t;return e.forEach(function(e){r=n.applyCapture(e,r)}),r}},{key:"applyCapture",value:function(e,t){var n=this.applyCaptureWithoutTakingRing(t,e);return this.takeRing(new Jde(n,t.sideRings,t.turn),e.ringTaken.get())}},{key:"takeRing",value:function(e,t){var n=e.getCurrentPlayer().value,r=e.setAt(t,Xde.EMPTY).board,i=[e.sideRings[0],e.sideRings[1]];return i[n]+=1,new Jde(r,i,e.turn)}},{key:"applyCaptureWithoutTakingRing",value:function(e,t){return t.forEach(function(t){e=e.setAt(t,Xde.EMPTY)}),e.board}},{key:"ringSelectionValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)===Xde.RINGS[n]?DB.SUCCESS:DB.failure(Qde.CAPTURE_SHOULD_TAKE_RING())}},{key:"applyRingMoveAndFlip",value:function(e,t,n){var r=n.getCurrentPlayer().value,i=n.setAt(e,Xde.MARKERS[r]);i=i.setAt(t,Xde.RINGS[r]);for(var a=pte.factory.fromMove(e,t).get(),o=e.getNext(a);!1===o.equals(t);o=o.getNext(a)){var s=i.getPieceAt(o);s!==Xde.EMPTY&&(i=i.setAt(o,s.flip()))}return i}},{key:"isLegal",value:function(e,t){if(e.isInitialPlacement())return this.initialPlacementValidity(t,e.start);if(t.isInitialPlacementPhase())return MB.failure(Qde.NO_MARKERS_IN_INITIAL_PHASE());var n=this.capturesValidity(t,e.initialCaptures);if(n.isFailure())return n.toFailedFallible();var r=this.applyCaptures(e.initialCaptures,t),i=this.moveValidity(r,e.start,e.end.get());if(i.isFailure())return i.toFailedFallible();var a=this.applyRingMoveAndFlip(e.start,e.end.get(),r),o=this.capturesValidity(a,e.finalCaptures);if(o.isFailure())return o.toFailedFallible();var s=this.applyCaptures(e.finalCaptures,a),u=this.noMoreCapturesValidity(s);return u.isFailure()?u.toFailedFallible():MB.success(s)}},{key:"initialPlacementValidity",value:function(e,t){if(!0!==e.isInitialPlacementPhase())return MB.failure(Qde.PLACEMENT_AFTER_INITIAL_PHASE());if(e.getPieceAt(t)!==Xde.EMPTY)return MB.failure(Cte.MUST_CLICK_ON_EMPTY_SPACE());var n=e.getCurrentPlayer(),r=[e.sideRings[0],e.sideRings[1]];r[n.value]-=1;var i=e.setAt(t,Xde.of(n,!0)).board,a=new Jde(i,r,e.turn);return MB.success(a)}},{key:"moveStartValidity",value:function(e,t){var n=e.getCurrentPlayer().value;return e.getPieceAt(t)!==Xde.RINGS[n]?DB.failure(Qde.SHOULD_SELECT_PLAYER_RING()):DB.SUCCESS}},{key:"moveValidity",value:function(e,t,n){var r=this.moveStartValidity(e,t);if(r.isFailure())return r;if(e.getPieceAt(n)!==Xde.EMPTY)return DB.failure(Qde.SHOULD_END_MOVE_ON_EMPTY_SPACE());var i=pte.factory.fromMove(t,n);if(i.isFailure())return DB.failure(Qde.MOVE_DIRECTION_INVALID());for(var a=i.get(),o=!1,s=t.getNext(a);!1===s.equals(n);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===Xde.EMPTY){if(o)return DB.failure(Qde.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(u.isRing)return DB.failure(Qde.MOVE_SHOULD_NOT_PASS_ABOVE_RING());o=!0}}return DB.SUCCESS}},{key:"capturesValidity",value:function(e,t){var n,r=e,i=uy(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.captureValidity(r,a);if(o.isFailure())return o;r=this.applyCapture(a,r)}}catch(s){i.e(s)}finally{i.f()}return DB.SUCCESS}},{key:"captureValidity",value:function(e,t){var n,r=e.getCurrentPlayer().value,i=uy(t.capturedSpaces);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(e.getPieceAt(a)!==Xde.MARKERS[r])return DB.failure(Qde.CAN_ONLY_CAPTURE_YOUR_MARKERS())}}catch(o){i.e(o)}finally{i.f()}return e.getPieceAt(t.ringTaken.get())!==Xde.RINGS[r]?DB.failure(Qde.CAPTURE_SHOULD_TAKE_RING()):DB.SUCCESS}},{key:"noMoreCapturesValidity",value:function(e){var t=e.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).length?DB.SUCCESS:DB.failure(Qde.MISSING_CAPTURES())}},{key:"getLinePortionsWithAtLeastFivePiecesOfPlayer",value:function(e,t){var n=this,r=[];return e.allLines().forEach(function(i){var a=n.getLinePortionWithAtLeastFivePiecesOfPlayer(e,t,i);a.isPresent()&&r.push(a.get())}),r}},{key:"getLinePortionWithAtLeastFivePiecesOfPlayer",value:function(e,t,n){var r,i=0,a=e.getEntranceOnLine(n),o=n.getDirection(),s=a;for(r=a;e.isOnBoard(r);r=r.getNext(o)){var u=e.getPieceAt(r);if(u.player===t&&!1===u.isRing)0===i&&(s=r),i+=1;else{if(i>=5)break;i=0}}return i>=5?RB.of({start:s,end:r,dir:o}):RB.empty()}},{key:"getPossibleCaptures",value:function(e){var t=e.getCurrentPlayer(),n=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(e,t).forEach(function(e){for(var t=e.start;t.getDistance(e.end)>=5;t=t.getNext(e.dir))n.push(eve.of(t,t.getNext(e.dir,4)))}),n}},{key:"getRingTargets",value:function(e,t){var n,r=[],i=uy(pte.factory.all);try{for(i.s();!(n=i.n()).done;)for(var a=n.value,o=!1,s=t.getNext(a);e.isOnBoard(s);s=s.getNext(a)){var u=e.getPieceAt(s);if(u===Xde.EMPTY){if(r.push(s),o)break}else{if(u.isRing)break;o=!0}}}catch(c){i.e(c)}finally{i.f()}return r}},{key:"getGameStatus",value:function(e){return e.gameState.isInitialPlacementPhase()?Lte.ONGOING:e.gameState.sideRings[0]>=3?Lte.ZERO_WON:e.gameState.sideRings[1]>=3?Lte.ONE_WON:Lte.ONGOING}}]),n}(Fte),ive=Xde.EMPTY,ave=Xde.UNREACHABLE,ove=Xde.MARKER_ZERO,sve=Xde.RING_ZERO,uve=Xde.MARKER_ONE,cve=Xde.RING_ONE,lve=function(){var e=dy(function e(){fy(this,e)});return e.MUST_ALIGN_FIVE=function(){return $localize(Lf||(Lf=Hg(["Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time."])))},e.MUST_CAPTURE_TWO=function(){return $localize(Ff||(Ff=Hg(["Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again."])))},e}(),fve=dy(function e(){fy(this,e),this.tutorial=[zte.informational($localize(Uf||(Uf=Hg(["Goal of the game"]))),$localize(Vf||(Vf=Hg(["The goal at Yinsh is to capture three rings in total.\n        The rings taken are shown on the top left for the dark player,\n        and on the bottom right for the light player. Here, Dark won the game.\n        Note that on the board you have two types of pieces for each player:\n        rings (empty circles) and markers (full circles)."]))),new Jde([[ave,ave,ave,ave,ave,ave,ive,ive,ive,ive,ave],[ave,ave,ave,ave,ive,ive,ive,ive,ive,ive,ive],[ave,ave,ave,ove,cve,ive,ive,ive,ive,ive,ive],[ave,ave,ive,ove,ive,cve,ive,uve,ive,ive,ive],[ave,ive,sve,uve,ive,ive,cve,ove,ive,ive,ive],[ave,ive,ive,ove,uve,ive,ive,ive,ive,ive,ave],[ive,ive,ive,ove,ive,ive,ive,cve,ive,ive,ave],[ive,ive,ive,uve,ove,sve,ive,ive,ive,ave,ave],[ive,ive,ive,ive,ive,ive,ive,ive,ave,ave,ave],[ive,ive,ive,ive,ive,ive,ive,ave,ave,ave,ave],[ave,ive,ive,ive,ive,ave,ave,ave,ave,ave,ave]],[3,1],20)),zte.anyMove($localize(Bf||(Bf=Hg(["Initial board and placement phase"]))),$localize(zf||(zf=Hg(["The initial board is empty.\n        At the beginning of the game, each player puts one of its ring on the board at their turn.\n        This phase stops when all rings have been placed on the board.\n        Put one of your ring on the board by clicking the space where you want to place it."]))),new Jde(Jde.getInitialState().board,[5,5],0),new tve([],new fte(5,5),RB.empty(),[]),$localize(Hf||(Hf=Hg(["Congratulations!"])))),zte.anyMove($localize(Gf||(Gf=Hg(["Putting a marker"]))),$localize($f||($f=Hg(["Once the initial phase is done and all rings are on the board, you need to place markers on the board.\n        To do so, put a marker in a ring by clicking on that ring.\n        Then, the ring must be moved in a straight line, in any direction.\n        A ring cannot pass through other rings during its move.\n        If it goes over a group of markers, your move must stop at the first empty space after that group.\n        All markers in the group are then flipped and their color change.<br/><br/>\n        You're playing Dark, do a move."]))),new Jde([[ave,ave,ave,ave,ave,ave,ive,ive,ive,ive,ave],[ave,ave,ave,ave,ive,ive,ive,ive,ive,ive,ive],[ave,ave,ave,cve,ive,ive,ive,ive,ive,ive,ive],[ave,ave,cve,ive,ive,cve,ive,ive,ive,ive,ive],[ave,ive,sve,uve,ive,ive,cve,ive,ive,ive,ive],[ave,ive,ive,uve,ive,ive,ive,ive,ive,ive,ave],[ive,ive,ive,ive,sve,ive,ive,cve,ive,ive,ave],[ive,ive,ive,ive,ive,sve,ive,ive,ive,ave,ave],[ive,ive,ive,sve,ive,ive,ive,ave,ave,ave,ave],[ive,ive,ive,ive,ive,ive,ive,ave,ave,ave,ave],[ave,ive,ive,ive,ive,ave,ave,ave,ave,ave,ave]],[0,0],20),new tve([],new fte(2,4),RB.of(new fte(4,4)),[]),$localize(Zf||(Zf=Hg(["Congratulations!"])))),zte.fromPredicate($localize(qf||(qf=Hg(["Getting a ring by aligning 5 markers"]))),$localize(Wf||(Wf=Hg(["Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.\n        To do so, you need to align 5 markers of your color.\n        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.\n        You will then have one more point.\n        You must capture when you can.<br/><br/>\n        You're playing Dark, perform a capture!"]))),new Jde([[ave,ave,ave,ave,ave,ave,ive,ive,ive,ive,ave],[ave,ave,ave,ave,ive,ive,ive,ive,ive,ive,ive],[ave,ave,ave,cve,ive,ive,ive,ive,ive,ive,ive],[ave,ave,cve,ive,ive,cve,ive,ive,ive,ive,ive],[ave,ive,ove,ove,sve,uve,uve,ive,ive,ive,ive],[ave,ive,ive,cve,ive,ive,ive,ive,ive,ive,ave],[ive,ive,ive,ive,sve,ive,ive,cve,ive,ive,ave],[ive,ive,ive,ive,ive,sve,ive,ive,ive,ave,ave],[ive,ive,ive,sve,ive,ive,ive,sve,ave,ave,ave],[ive,ive,ive,ive,ive,ive,ive,ave,ave,ave,ave],[ave,ive,ive,ive,ive,ave,ave,ave,ave,ave,ave]],[0,0],20),new tve([],new fte(4,4),RB.of(new fte(7,4)),[eve.of(new fte(2,4),new fte(6,4),new fte(7,4))]),function(e,t,n){return 1===n.sideRings[Q7.ZERO.value]?DB.SUCCESS:DB.failure(lve.MUST_ALIGN_FIVE())},$localize(jf||(jf=Hg(["Congratulations!"])))),zte.fromPredicate($localize(Yf||(Yf=Hg(["Compound captures"]))),$localize(Kf||(Kf=Hg(["During a turn, you could have to choose between multiple captures,\n        or you could even capture multiple times!\n        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>\n        Here, you can capture two rings, do it!"]))),new Jde([[ave,ave,ave,ave,ave,ave,ive,ive,ive,ive,ave],[ave,ave,ave,ave,sve,ive,ive,cve,cve,sve,ive],[ave,ave,ave,sve,ive,ive,uve,cve,ive,sve,ive],[ave,ave,ive,sve,ive,ive,ive,ive,ive,cve,ive],[ave,ive,ive,ive,ive,ove,ive,ive,cve,ive,ive],[ave,ive,ive,ive,ove,ove,ive,uve,ive,ive,ave],[ive,ive,ive,ove,ive,ove,ive,ive,ive,ive,ave],[ive,ive,ove,ive,ive,ove,ive,ive,ive,ave,ave],[ive,ove,ive,ive,ive,ove,ive,ive,ave,ave,ave],[ive,ive,ive,ive,ive,ove,ive,ave,ave,ave,ave],[ave,ive,ive,ive,ive,ave,ave,ave,ave,ave,ave]],[0,0],10),new tve([eve.of(new fte(5,4),new fte(1,8),new fte(3,2)),eve.of(new fte(5,9),new fte(5,5),new fte(3,3))],new fte(4,1),RB.of(new fte(4,2)),[]),function(e,t,n){return 2===n.sideRings[Q7.ZERO.value]?DB.SUCCESS:DB.failure(lve.MUST_CAPTURE_TWO())},$localize(Qf||(Qf=Hg(["Congratulations!"]))))]});function hve(e,t){if(1&e&&(IC(),_S(0,"circle",12)),2&e){var n=RS(2).$implicit,r=RS(2);lS("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringOuterSize)}}function dve(e,t){if(1&e&&(IC(),_S(0,"circle",13)),2&e){var n=RS(2),r=n.index,i=n.$implicit,a=RS().index,o=RS();NS("id","ring_",r,"_",a,""),mS("ngClass",i.ringClasses),lS("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.ringMidSize)}}function vve(e,t){if(1&e&&(IC(),_S(0,"circle",12)),2&e){var n=RS(2).$implicit,r=RS(2);lS("cx",n.center.x)("cy",n.center.y)("r",r.viewInfo.ringInnerSize)}}function pve(e,t){if(1&e&&(IC(),_S(0,"circle",14)),2&e){var n=RS(2),r=n.index,i=n.$implicit,a=RS().index,o=RS();NS("id","marker_",r,"_",a,""),mS("ngClass",i.markerClasses),lS("cx",i.center.x)("cy",i.center.y)("r",o.viewInfo.markerSize)}}function gve(e,t){if(1&e){var n=SS();IC(),CS(0,"g",6),TS("click",function(){eC(n);var e=RS().$implicit;return RS(2).onClick(e.coord)}),_S(1,"polygon",7),CS(2,"g",8),pS(3,hve,1,3,"circle",9),pS(4,dve,1,6,"circle",10),pS(5,vve,1,3,"circle",9),pS(6,pve,1,6,"circle",11),wS(),wS()}if(2&e){var r=RS(),i=r.index,a=r.$implicit,o=RS().index;NS("id","click_",i,"_",o,""),DE(1),NS("id","space_",i,"_",o,""),mS("ngClass",a.spaceClasses),lS("points",a.coordinates),DE(1),NS("id","pieceGroup_",i,"_",o,""),mS("ngClass",a.removedClass),DE(1),mS("ngIf",a.isRing),DE(1),mS("ngIf",a.isRing),DE(1),mS("ngIf",a.isRing),DE(1),mS("ngIf",a.isMarker)}}function yve(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,gve,7,13,"g",5),wS()),2&e){var n=t.$implicit;DE(1),mS("ngIf",null!=n)}}function mve(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,yve,2,1,"g",1),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}function kve(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",15),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e)}),wS()}if(2&e){var r=t.$implicit,i=RS();NS("id","selected_",r.x,"_",r.y,""),lS("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function Cve(e,t){if(1&e){var n=SS();IC(),CS(0,"polygon",17),TS("click",function(){var e=eC(n).$implicit;return RS(2).onClick(e)}),wS()}if(2&e){var r=t.$implicit,i=RS(2);NS("id","selectable_",r.x,"_",r.y,""),lS("points",i.viewInfo.spaceInfo[r.y][r.x].coordinates)}}function wve(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Cve,1,3,"polygon",16),wS()),2&e){var n=RS();DE(1),mS("ngForOf",n.viewInfo.selectableCoords)}}function _ve(e,t){if(1&e){var n=SS();IC(),CS(0,"rect",18),TS("click",function(){var e=eC(n).$implicit;return RS().onClick(e)}),wS()}if(2&e){var r=t.$implicit,i=RS();NS("id","indicator_",r.x,"_",r.y,""),lS("x",i.viewInfo.spaceInfo[r.y][r.x].center.x-i.viewInfo.indicatorSize/2)("y",i.viewInfo.spaceInfo[r.y][r.x].center.y-i.viewInfo.indicatorSize/2)("width",i.viewInfo.indicatorSize)("height",i.viewInfo.indicatorSize)}}function Eve(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"circle",19),_S(2,"circle",12),_S(3,"circle",20),wS()),2&e){var n=t.index,r=RS().$implicit,i=RS();DE(1),NS("id","player_",r.value,"_sideRing_",n+1,""),lS("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringOuterSize),DE(1),lS("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringInnerSize),DE(1),mS("ngClass",i.viewInfo.sideRingClass[r.value]),lS("cx",(0===r.value?0:1050)+1.2*(0===r.value?1:-1)*i.viewInfo.ringOuterSize*(n+1))("cy",0===r.value?300:1260)("r",i.viewInfo.ringMidSize)}}var bve=function(){return[]};function Sve(e,t){if(1&e&&(IC(),CS(0,"g"),pS(1,Eve,4,12,"g",1),wS()),2&e){var n=t.$implicit,r=RS();lS("transform","rotate("+180*r.role.value+" 532.5 780)"),DE(1),mS("ngForOf",ST(2,bve).constructor(r.viewInfo.sideRings[n.value]))}}var Pve=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,e)).movePhase="MOVE_START",r.moveStart=RB.empty(),r.moveEnd=RB.empty(),r.currentlyMoved=[],r.currentCapture=RB.empty(),r.initialCaptures=[],r.finalCaptures=[],r.possibleCaptures=[],r.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:n.MARKER_SIZE,ringOuterSize:n.RING_OUTER_SIZE,ringMidSize:n.RING_MID_SIZE,ringInnerSize:n.RING_INNER_SIZE,indicatorSize:n.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},r.scores=RB.of([0,0]),r.rules=new rve(Jde),r.availableMinimaxes=[new nve(r.rules,"YinshMinimax")],r.encoder=tve.encoder,r.tutorial=(new fve).tutorial,r.hexaLayout=new gte(1.5*n.RING_OUTER_SIZE,new fte(2*n.RING_OUTER_SIZE,0),kte.INSTANCE),r.constructedState=r.rules.node.gameState,r.constructedState.allCoords().forEach(function(e){null==r.viewInfo.spaceInfo[e.y]&&(r.viewInfo.spaceInfo[e.y]=[]),r.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:r.getHexaCoordsAt(e),center:r.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}}),r}return dy(n,[{key:"updateBoard",value:function(){this.cancelMoveAttempt(),this.scores=RB.of(this.rules.node.gameState.countScores())}},{key:"updateViewInfo",value:function(){var e=this;this.constructedState.allCoords().forEach(function(t){e.viewInfo.spaceInfo[t.y][t.x].spaceClasses=e.getSpaceClasses(t);var n=e.constructedState.getPieceAt(t);e.viewInfo.spaceInfo[t.y][t.x].removedClass="",e.setRingInfo(t,n),e.setMarkerInfo(t,n)});var t,n=uy(Q7.PLAYERS);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.sideRings[r.value]=this.constructedState.sideRings[r.value]}}catch(c){n.e(c)}finally{n.f()}switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];var i,a=uy(this.possibleCaptures);try{for(a.s();!(i=a.n()).done;){var o,s=uy(i.value.capturedSpaces);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.viewInfo.selectableCoords.push(u)}}catch(c){s.e(c)}finally{s.f()}}}catch(c){a.e(c)}finally{a.f()}break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.rules.node.gameState.isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}},{key:"showCurrentMoveCaptures",value:function(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());var e,t=uy(this.initialCaptures);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.markCurrentCapture(n)}}catch(o){t.e(o)}finally{t.f()}var r,i=uy(this.finalCaptures);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.markCurrentCapture(a)}}catch(o){i.e(o)}finally{i.f()}}},{key:"getSpaceClasses",value:function(e){return this.currentlyMoved.some(function(t){return t.equals(e)})?["moved"]:[]}},{key:"setRingInfo",value:function(e,t){if(t.isRing){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isRing=!0,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[n+"-stroke"]}else this.viewInfo.spaceInfo[e.y][e.x].isRing=!1,this.viewInfo.spaceInfo[e.y][e.x].ringClasses=[]}},{key:"setMarkerInfo",value:function(e,t){if(this.viewInfo.spaceInfo[e.y][e.x].isMarker=!1,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[],t!==Xde.EMPTY&&(!t.isRing||t.isRing&&this.moveStart.equalsValue(e))){var n=this.getPlayerClass(t.player);this.viewInfo.spaceInfo[e.y][e.x].isMarker=!0,this.viewInfo.spaceInfo[e.y][e.x].markerClasses=[n]}}},{key:"cancelMoveAttempt",value:function(){this.constructedState=this.rules.node.gameState,this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=RB.empty(),this.moveStart=RB.empty(),this.moveEnd=RB.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}},{key:"showLastMove",value:function(){var e=this,t=this.rules.node.move;if(t.isPresent()){var n=t.get();if(n.isInitialPlacement())this.viewInfo.spaceInfo[n.start.y][n.start.x].spaceClasses=["moved"];else{var r,i=uy(this.coordsBetween(n.start,n.end.get()));try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.spaceInfo[a.y][a.x].spaceClasses=["moved"]}}catch(s){i.e(s)}finally{i.f()}var o=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();n.initialCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)}),n.finalCaptures.forEach(function(t){return e.showLastMoveCapture(t,o)})}}}},{key:"coordsBetween",value:function(e,t){for(var n=[],r=pte.factory.fromMove(e,t).get(),i=e;!i.equals(t);i=i.getNext(r))this.constructedState.getPieceAt(i)!==Xde.EMPTY&&n.push(i),n.push(t);return n}},{key:"showLastMoveCapture",value:function(e,t){var n,r=uy(e.capturedSpaces);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.viewInfo.spaceInfo[i.y][i.x].spaceClasses=["captured"],t&&this.markRemovedMarker(i,this.rules.node.gameState.getCurrentPlayer().getOpponent())}}catch(a){r.e(a)}finally{r.f()}this.viewInfo.spaceInfo[e.ringTaken.get().y][e.ringTaken.get().x].spaceClasses=["captured"],t&&this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer().getOpponent())}},{key:"moveToInitialCaptureOrMovePhase",value:function(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),DB.SUCCESS}},{key:"onClick",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.canUserPlay("#click_"+e.x+"_"+e.y)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:n.t0=t.movePhase,n.next="INITIAL_CAPTURE_SELECT_FIRST"===n.t0||"FINAL_CAPTURE_SELECT_FIRST"===n.t0?6:"INITIAL_CAPTURE_SELECT_LAST"===n.t0||"FINAL_CAPTURE_SELECT_LAST"===n.t0?7:"INITIAL_CAPTURE_SELECT_RING"===n.t0||"FINAL_CAPTURE_SELECT_RING"===n.t0?8:"MOVE_START"===n.t0?9:"MOVE_END"===n.t0?10:11;break;case 6:return n.abrupt("return",t.selectCaptureFirstCoord(e));case 7:return n.abrupt("return",t.selectCaptureLastCoord(e));case 8:return n.abrupt("return",t.selectRing(e));case 9:return n.abrupt("return",t.selectMoveStart(e));case 10:return n.abrupt("return",t.selectMoveEnd(e));case 11:case"end":return n.stop()}},n)}))()}},{key:"selectCaptureFirstCoord",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=[],t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),!(r.length>1)){n.next=5;break}t.viewInfo.selectedCoords.push(e),t.moveToCaptureSelectLast(r),n.next=8;break;case 5:if(0!==r.length){n.next=7;break}return n.abrupt("return",t.cancelMove(Qde.MISSING_CAPTURES()));case 7:t.selectCapture(r[0]);case 8:return n.abrupt("return",DB.SUCCESS);case 9:case"end":return n.stop()}},n)}))()}},{key:"moveToCaptureSelectLast",value:function(e){this.viewInfo.selectableCoords=[],this.possibleCaptures=e;var t,n=uy(e);try{for(n.s();!(t=n.n()).done;){var r,i=uy(t.value.capturedSpaces);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.viewInfo.selectableCoords.push(a)}}catch(o){i.e(o)}finally{i.f()}}}catch(o){n.e(o)}finally{n.f()}"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(PB.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}},{key:"selectCaptureLastCoord",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=[],n.abrupt("return",(t.possibleCaptures.forEach(function(t){t.contains(e)&&r.push(t)}),r.length>1?t.cancelMove(Qde.AMBIGUOUS_CAPTURE_COORD()):0===r.length?t.cancelMove(Qde.MISSING_CAPTURES()):t.selectCapture(r[0])));case 2:case"end":return n.stop()}},n)}))()}},{key:"selectCapture",value:function(e){return this.currentCapture=RB.of(e),this.constructedState=new Jde(this.rules.applyCaptureWithoutTakingRing(this.constructedState,e),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(N7("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),DB.SUCCESS}},{key:"markCurrentCapture",value:function(e){var t,n=uy(e.capturedSpaces);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.viewInfo.selectedCoords.push(r),this.markRemovedMarker(r,this.rules.node.gameState.getCurrentPlayer())}}catch(i){n.e(i)}finally{n.f()}e.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(e.ringTaken.get()),this.markRemovedRing(e.ringTaken.get(),this.rules.node.gameState.getCurrentPlayer()))}},{key:"markRemovedMarker",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setMarkerInfo(e,Xde.MARKERS[t.value])}},{key:"markRemovedRing",value:function(e,t){this.viewInfo.spaceInfo[e.y][e.x].removedClass="semi-transparent",this.setRingInfo(e,Xde.RINGS[t.value])}},{key:"selectRing",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.rules.ringSelectionValidity(t.constructedState,e)).isFailure()){n.next=3;break}return n.abrupt("return",t.cancelMove(r.getReason()));case 3:return t.constructedState=t.rules.takeRing(t.constructedState,e),i=t.currentCapture.get().setRingTaken(e),n.abrupt("return","INITIAL_CAPTURE_SELECT_RING"===(t.currentCapture=RB.empty(),t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),t.movePhase)?(t.initialCaptures.push(i),0===t.possibleCaptures.length?t.moveToMovePhase():(t.movePhase="INITIAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),DB.SUCCESS)):(PB.expectToBe(t.movePhase,"FINAL_CAPTURE_SELECT_RING"),t.finalCaptures.push(i),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),DB.SUCCESS)));case 6:case"end":return n.stop()}},n)}))()}},{key:"moveToMovePhase",value:function(){return this.movePhase="MOVE_START",this.updateViewInfo(),DB.SUCCESS}},{key:"tryMove",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new tve(e.initialCaptures,e.moveStart.get(),e.moveEnd,e.finalCaptures),t.next=3,e.chooseMove(n,e.rules.node.gameState,e.scores.get());case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t)}))()}},{key:"selectMoveStart",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.constructedState.isInitialPlacementPhase()){n.next=3;break}return r=t.rules.initialPlacementValidity(t.constructedState,e),n.abrupt("return",r.isFailure()?t.cancelMove(r.getReason()):(t.moveStart=RB.of(e),t.tryMove()));case 3:if(!(i=t.rules.moveStartValidity(t.constructedState,e)).isFailure()){n.next=6;break}return n.abrupt("return",t.cancelMove(i.getReason()));case 6:return t.moveStart=RB.of(e),t.movePhase="MOVE_END",t.updateViewInfo(),n.abrupt("return",DB.SUCCESS);case 8:case"end":return n.stop()}},n)}))()}},{key:"selectMoveEnd",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.moveStart.equalsValue(e)){n.next=2;break}return n.abrupt("return",(t.cancelMoveAttempt(),DB.SUCCESS));case 2:if(r=Xde.RINGS[t.getState().getCurrentPlayer().value],t.constructedState.getPieceAt(e)!==r){n.next=5;break}return n.abrupt("return",(t.cancelMoveAttempt(),t.selectMoveStart(e)));case 5:return i=t.rules.moveValidity(t.constructedState,t.moveStart.get(),e),n.abrupt("return",i.isFailure()?t.cancelMove(i.getReason()):(t.moveEnd=RB.of(e),t.currentlyMoved=t.coordsBetween(t.moveStart.get(),e),t.constructedState=t.rules.applyRingMoveAndFlip(t.moveStart.get(),e,t.constructedState),t.updateViewInfo(),t.moveToFinalCapturePhaseOrTryMove()));case 7:case"end":return n.stop()}},n)}))()}},{key:"moveToFinalCapturePhaseOrTryMove",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),DB.SUCCESS)));case 1:case"end":return t.stop()}},t)}))()}}]),n}(dte);function Ove(e,t){if(1&e&&(CS(0,"option",5),rP(1),wS()),2&e){var n=t.$implicit;mS("value",n.urlName),DE(1),iP(n.name)}}Pve.RING_OUTER_SIZE=40,Pve.RING_MID_SIZE=34,Pve.RING_INNER_SIZE=28,Pve.MARKER_SIZE=Pve.RING_INNER_SIZE,Pve.INDICATOR_SIZE=10,Pve.\u0275fac=function(e){return new(e||Pve)(yS(M7))},Pve.\u0275cmp=ck({type:Pve,selectors:[["app-yinsh"]],features:[Qb],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","auto","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected",3,"id","click"],["class","base no-fill capturable","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(e,t){1&e&&(IC(),CS(0,"svg",0),pS(1,mve,2,1,"g",1),pS(2,kve,1,3,"polygon",2),pS(3,wve,2,1,"g",3),pS(4,_ve,1,6,"rect",4),pS(5,Sve,2,3,"g",1),wS()),2&e&&(DE(1),mS("ngForOf",t.viewInfo.spaceInfo),DE(1),mS("ngForOf",t.viewInfo.selectedCoords),DE(1),mS("ngIf",t.isPlayerTurn()),DE(1),mS("ngForOf",t.viewInfo.targets),DE(1),mS("ngForOf",t.Player.PLAYERS))},directives:[nR,iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Tve=function(){var e=dy(function e(){fy(this,e)});return e.ABALONE=function(){return $localize(Xf||(Xf=Hg(["Use simple mechanics to push 6 of the opponent's pieces out of the board!"])))},e.APAGOS=function(){return $localize(Jf||(Jf=Hg(["Very simple game, but, will you be able to win everytime?"])))},e.AWALE=function(){return $localize(eh||(eh=Hg(["The international version of the famous African strategy game!"])))},e.BRANDHUB=function(){return $localize(th||(th=Hg(["The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.COERCEO=function(){return $localize(nh||(nh=Hg(["Get rid of all of your opponent's pieces on a board that shrinks little by little!"])))},e.CONSPIRATEURS=function(){return $localize(rh||(rh=Hg(["Hide all of your pieces before your opponent does, or risk to be discovered!"])))},e.DIAM=function(){return $localize(ih||(ih=Hg(["Drop your pieces and move them around to align two pieces of the same color across the board to win!"])))},e.DVONN=function(){return $localize(ah||(ah=Hg(["Stack your pieces and control as many stacks as you can to win!"])))},e.ENCAPSULE=function(){return $localize(oh||(oh=Hg(["An enhanced tic-tac-toe where piece can encapsule other and prevent them to win."])))},e.EPAMINONDAS=function(){return $localize(sh||(sh=Hg(["An antiquity-war inspired game. Be the first to pierce your opponent's lines!"])))},e.GIPF=function(){return $localize(uh||(uh=Hg(["A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!"])))},e.GO=function(){return $localize(ch||(ch=Hg(["The oldest strategy game still practiced widely. A territory control game."])))},e.HNEFATAFL=function(){return $localize(lh||(lh=Hg(["The Viking board game! Invaders must capture the king, defender must make him escape!"])))},e.KAMISADO=function(){return $localize(fh||(fh=Hg(["Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!"])))},e.LINES_OF_ACTION=function(){return $localize(hh||(hh=Hg(["Regroup your pieces to win. But your possible moves will often change!"])))},e.LODESTONE=function(){return $localize(dh||(dh=Hg(["Push and crush your opponent's pieces using magnetic forces!"])))},e.MARTIAN_CHESS=function(){return $localize(vh||(vh=Hg(["Win points by capturing pieces, but you only control pieces on your side of the board!"])))},e.P4=function(){return $localize(ph||(ph=Hg(["The classical 4 in a row game!"])))},e.PENTAGO=function(){return $localize(gh||(gh=Hg(["Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!"])))},e.PYLOS=function(){return $localize(yh||(yh=Hg(["Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!"])))},e.QUARTO=function(){return $localize(mh||(mh=Hg(["Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!"])))},e.QUIXO=function(){return $localize(kh||(kh=Hg(["Align 5 of your pieces on a board where pieces slide!"])))},e.REVERSI=function(){return $localize(Ch||(Ch=Hg(["Sandwich your opponent's pieces to dominate the board!"])))},e.SAHARA=function(){return $localize(wh||(wh=Hg(["Immobilize one of your opponent's pyramids before your opponent does!"])))},e.SIAM=function(){return $localize(_h||(_h=Hg(["Be the first to push a mountain out of the board!"])))},e.SIX=function(){return $localize(Eh||(Eh=Hg(["Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!"])))},e.TABLUT=function(){return $localize(bh||(bh=Hg(["Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!"])))},e.YINSH=function(){return $localize(Sh||(Sh=Hg(["Align your pieces to score points, but beware, pieces can flip!"])))},e}(),Ive=function(){var e=dy(function e(t,n,r,i,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];fy(this,e),this.name=t,this.urlName=n,this.component=r,this.creationDate=i,this.description=a,this.display=o});return e.ALL_GAMES=function(){return[new e("MinimaxTesting","MinimaxTesting",Mce,new Date("1970-01-01"),"",!1),new e($localize(Ph||(Ph=Hg(["Four in a Row"]))),"P4",Wce,new Date("2018-08-28"),Tve.P4()),new e($localize(Oh||(Oh=Hg(["Awal\xe9"]))),"Awale",Rne,new Date("2018-11-29"),Tve.AWALE()),new e($localize(Th||(Th=Hg(["Quarto"]))),"Quarto",Pfe,new Date("2018-12-09"),Tve.QUARTO()),new e($localize(Ih||(Ih=Hg(["Tablut"]))),"Tablut",Kde,new Date("2018-12-27"),Tve.TABLUT()),new e($localize(Ah||(Ah=Hg(["Reversi"]))),"Reversi",the,new Date("2019-01-16"),Tve.REVERSI()),new e($localize(Rh||(Rh=Hg(["Go"]))),"Go",$oe,new Date("2019-12-21"),Tve.GO()),new e($localize(Mh||(Mh=Hg(["Encapsule"]))),"Encapsule",Rae,new Date("2019-12-30"),Tve.ENCAPSULE()),new e($localize(xh||(xh=Hg(["Siam"]))),"Siam",ode,new Date("2020-01-11"),Tve.SIAM()),new e($localize(Nh||(Nh=Hg(["Sahara"]))),"Sahara",Ehe,new Date("2020-02-29"),Tve.SAHARA()),new e($localize(Dh||(Dh=Hg(["Pylos"]))),"Pylos",Dle,new Date("2020-10-02"),Tve.PYLOS()),new e($localize(Lh||(Lh=Hg(["Kamisado"]))),"Kamisado",qse,new Date("2020-10-03"),Tve.KAMISADO()),new e($localize(Fh||(Fh=Hg(["Quixo"]))),"Quixo",zfe,new Date("2020-10-15"),Tve.QUIXO()),new e($localize(Uh||(Uh=Hg(["Dvonn"]))),"Dvonn",sae,new Date("2020-10-21"),Tve.DVONN()),new e($localize(Vh||(Vh=Hg(["Epaminondas"]))),"Epaminondas",Wae,new Date("2021-01-16"),Tve.EPAMINONDAS()),new e($localize(Bh||(Bh=Hg(["Gipf"]))),"Gipf",goe,new Date("2021-02-22"),Tve.GIPF()),new e($localize(zh||(zh=Hg(["Coerceo"]))),"Coerceo",Hre,new Date("2021-03-21"),Tve.COERCEO()),new e($localize(Hh||(Hh=Hg(["Six"]))),"Six",Ide,new Date("2021-04-08"),Tve.SIX()),new e($localize(Gh||(Gh=Hg(["Lines of Action"]))),"LinesOfAction",oue,new Date("2021-04-28"),Tve.LINES_OF_ACTION()),new e($localize($h||($h=Hg(["Pentago"]))),"Pentago",dle,new Date("2021-05-23"),Tve.PENTAGO()),new e($localize(Zh||(Zh=Hg(["Abalone"]))),"Abalone",one,new Date("2021-07-13"),Tve.ABALONE()),new e($localize(qh||(qh=Hg(["Yinsh"]))),"Yinsh",Pve,new Date("2021-07-31"),Tve.YINSH()),new e($localize(Wh||(Wh=Hg(["Apagos"]))),"Apagos",wne,new Date("2021-11-04"),Tve.APAGOS()),new e($localize(jh||(jh=Hg(["Diam"]))),"Diam",Rie,new Date("2021-11-30"),Tve.DIAM()),new e($localize(Yh||(Yh=Hg(["Brandhub"]))),"Brandhub",dre,new Date("2021-12-07"),Tve.BRANDHUB()),new e($localize(Kh||(Kh=Hg(["Conspirateurs"]))),"Conspirateurs",cie,new Date("2021-12-30"),Tve.CONSPIRATEURS()),new e($localize(Qh||(Qh=Hg(["Lodestone"]))),"Lodestone",Vue,new Date("2022-06-24"),Tve.LODESTONE()),new e($localize(Xh||(Xh=Hg(["Martian Chess"]))),"MartianChess",wce,new Date("2022-07-01"),Tve.MARTIAN_CHESS()),new e($localize(Jh||(Jh=Hg(["Hnefatafl"]))),"Hnefatafl",fse,new Date("2022-09-21"),Tve.HNEFATAFL())].sort(function(e,t){return e.name.localeCompare(t.name)})},e}(),Ave=function(){var e=function(){function e(){fy(this,e),this.games=Ive.ALL_GAMES().filter(function(e){return!0===e.display}),this.pickGame=new LT}return dy(e,[{key:"onChange",value:function(e){this.pickGame.emit(e.target.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ck({type:e,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){return[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],$localize(ed||(ed=Hg(["Pick a game"]))),[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"select",1),TS("change",function(e){return t.onChange(e)}),CS(2,"option",2),fO(3,3),wS(),pS(4,Ove,2,2,"option",4),wS(),wS()),2&e&&(DE(4),mS("ngForOf",t.games))},directives:[Px,Ax,nR],encapsulation:2}),e}();function Rve(e,t){if(1&e){var n=SS();CS(0,"div",26),CS(1,"div",27),TS("click",function(){return eC(n),RS().closeInfo()}),wS(),CS(2,"div",28),CS(3,"header",29),CS(4,"p",30),rP(5),wS(),CS(6,"button",31),TS("click",function(){return eC(n),RS().closeInfo()}),wS(),wS(),CS(7,"section",32),CS(8,"div",6),CS(9,"div",33),CS(10,"p",34),_S(11,"img",35),wS(),wS(),CS(12,"div",7),CS(13,"div",13),rP(14),wS(),wS(),wS(),CS(15,"div",6),CS(16,"div",33),CS(17,"a",36),TS("click",function(){eC(n);var e=RS();return e.createGame(e.gameInfoDetails.get().urlName)}),_S(18,"fa-icon",37),rP(19,"\xa0"),CS(20,"span"),fO(21,38),wS(),wS(),wS(),CS(22,"div",33),CS(23,"a",36),TS("click",function(){eC(n);var e=RS();return e.createLocalGame(e.gameInfoDetails.get().urlName)}),_S(24,"fa-icon",37),rP(25,"\xa0"),CS(26,"span"),fO(27,39),wS(),wS(),wS(),CS(28,"div",33),CS(29,"a",36),TS("click",function(){eC(n);var e=RS();return e.createTutorial(e.gameInfoDetails.get().urlName)}),_S(30,"fa-icon",37),rP(31,"\xa0"),CS(32,"span"),fO(33,40),wS(),wS(),wS(),wS(),wS(),wS(),wS()}if(2&e){var r=RS();DE(5),iP(r.gameInfoDetails.get().name),DE(6),NS("src","assets/images/",r.theme,"/",r.gameInfoDetails.get().urlName,".png",T_),DE(3),aP(" ",r.gameInfoDetails.get().description," "),DE(4),mS("icon",r.iconOnlineGame),DE(6),mS("icon",r.iconLocalGame),DE(6),mS("icon",r.iconTutorial)}}function Mve(e,t){if(1&e){var n=SS();CS(0,"div",8),CS(1,"div",9),CS(2,"p",10),rP(3),wS(),wS(),CS(4,"div",42),CS(5,"figure",34),CS(6,"img",43),TS("click",function(){var e=eC(n).$implicit;return RS(2).openInfo(e)}),wS(),CS(7,"figcaption",44),TS("click",function(){var e=eC(n).$implicit;return RS(2).openInfo(e)}),CS(8,"div",45),rP(9,"?"),wS(),wS(),CS(10,"figcaption",46),CS(11,"a",47),TS("click",function(){var e=eC(n).$implicit;return RS(2).createGame(e.urlName)}),_S(12,"fa-icon",37),wS(),CS(13,"a",48),TS("click",function(){var e=eC(n).$implicit;return RS(2).createLocalGame(e.urlName)}),_S(14,"fa-icon",37),wS(),CS(15,"a",49),TS("click",function(){var e=eC(n).$implicit;return RS(2).createTutorial(e.urlName)}),_S(16,"fa-icon",37),wS(),wS(),wS(),wS(),CS(17,"div",50),rP(18),wS(),wS()}if(2&e){var r=t.$implicit,i=RS(2);DE(3),iP(r.name),DE(3),xS("id","image_",r.urlName,""),NS("src","assets/images/",i.theme,"/",r.urlName,".png",T_),DE(5),xS("id","playOnline_",r.urlName,""),DE(1),mS("icon",i.iconOnlineGame),DE(1),xS("id","playLocally_",r.urlName,""),DE(1),mS("icon",i.iconLocalGame),DE(1),xS("id","startTutorial_",r.urlName,""),DE(1),mS("icon",i.iconTutorial),DE(2),aP(" ",r.description," ")}}function xve(e,t){if(1&e&&(CS(0,"div",7),pS(1,Mve,19,11,"div",41),wS()),2&e){var n=t.$implicit;DE(1),mS("ngForOf",n)}}var Nve=function(){var e=function(){function e(t,n){fy(this,e),this.router=t,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=y9,this.iconLocalGame=p9,this.iconTutorial=d9,this.gameInfoDetails=RB.empty(),this.theme=n.getTheme();for(var r=Ive.ALL_GAMES().filter(function(e){return!0===e.display}),i=0,a=0;a<r.length;a++)a<this.numberOfColumns&&this.games.push([]),this.games[i].push(r[a]),i=(i+1)%this.numberOfColumns}return dy(e,[{key:"createGame",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/play",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createLocalGame",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t.router.navigate(["/local",e]));case 1:case"end":return n.stop()}},n)}))()}},{key:"createTutorial",value:function(e){return this.router.navigate(["/tutorial",e])}},{key:"openInfo",value:function(e){this.gameInfoDetails=RB.of(e)}},{key:"closeInfo",value:function(){this.gameInfoDetails=RB.empty()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF),yS(h9))},e.\u0275cmp=ck({type:e,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){return[[1,"hero"],[1,"hero-body"],[1,"title"],$localize(td||(td=Hg(["EveryBoard"]))),[1,"subtitle"],$localize(nd||(nd=Hg(["EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.",":LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn."])),"\ufffd#6\ufffd\ufffd/#6\ufffd"),[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],$localize(rd||(rd=Hg(["Play online"]))),[1,"card-content"],[1,"content"],["id","createOnlineGame","routerLink","/play",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(id||(id=Hg(["Create an online game"]))),["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],$localize(ad||(ad=Hg(["See the game list"]))),$localize(od||(od=Hg(["Play offline"]))),[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],$localize(sd||(sd=Hg(["Play"]))),["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],$localize(ud||(ud=Hg(["Learn"]))),["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],$localize(cd||(cd=Hg(["Play online"]))),$localize(ld||(ld=Hg(["Play offline"]))),$localize(fd||(fd=Hg(["Learn the rules"]))),["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",$localize(hd||(hd=Hg(["Play online"]))),1,"button",3,"id","click"],["data-tooltip",$localize(dd||(dd=Hg(["Play offline"]))),1,"button",3,"id","click"],["data-tooltip",$localize(vd||(vd=Hg(["Learn the rules"]))),1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,t){1&e&&(CS(0,"section",0),CS(1,"div",1),CS(2,"p",2),fO(3,3),wS(),CS(4,"p",4),cO(5,5),_S(6,"br"),lO(),wS(),wS(),CS(7,"div",6),CS(8,"div",7),CS(9,"div",8),CS(10,"header",9),CS(11,"p",10),fO(12,11),wS(),wS(),CS(13,"div",12),CS(14,"div",13),CS(15,"button",14),fO(16,15),wS(),CS(17,"button",16),fO(18,17),wS(),wS(),wS(),wS(),wS(),CS(19,"div",7),CS(20,"div",8),CS(21,"header",9),CS(22,"p",10),fO(23,18),wS(),wS(),CS(24,"div",12),CS(25,"div",19),CS(26,"button",20),fO(27,21),wS(),CS(28,"button",22),fO(29,23),wS(),wS(),wS(),wS(),wS(),wS(),pS(30,Rve,34,7,"div",24),CS(31,"div",6),pS(32,xve,2,1,"div",25),wS(),wS()),2&e&&(DE(30),mS("ngIf",t.gameInfoDetails.isPresent()),DE(2),mS("ngForOf",t.games))},directives:[gF,iR,nR,Gee],encapsulation:2}),e}(),Dve=function(){var e=function(){function e(t){fy(this,e),this.element=t}return dy(e,[{key:"ngAfterViewInit",value:function(){this.element.nativeElement.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(TO))},e.\u0275dir=pk({type:e,selectors:[["","autofocus",""]]}),e}(),Lve=function(){var e=function(){function e(t){var n=this;fy(this,e),this.shown=!1,this.input=t.nativeElement.parentNode.previousSibling,t.nativeElement.addEventListener("click",function(e){n.toggle()})}return dy(e,[{key:"toggle",value:function(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(TO))},e.\u0275dir=pk({type:e,selectors:[["","toggleVisibility",""]]}),e}();function Fve(e,t){if(1&e&&(CS(0,"div",29),CS(1,"div",30),fO(2,31),wS(),CS(3,"div",32),rP(4),wS(),wS()),2&e){var n=RS();DE(4),iP(n.errorMessage)}}var Uve=function(){return["/register"]},Vve=function(){return["/reset-password"]},Bve=function(){var e=function(){function e(t,n){fy(this,e),this.router=t,this.connectedUserService=n,this.faEye=g9,this.loginForm=new ox({email:new ax,password:new ax})}return dy(e,[{key:"ngOnInit",value:function(){var e,t=this;this.userSubscription=this.connectedUserService.subscribeToUser((e=SB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n!==V7.NOT_CONNECTED,!e.t0){e.next=4;break}return e.next=4,t.redirect();case 4:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"loginWithEmail",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.doEmailLogin(e.email,e.password);case 2:(r=n.sent).isFailure()&&(t.errorMessage=r.getReason());case 4:case"end":return n.stop()}},n)}))()}},{key:"loginWithGoogle",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connectedUserService.doGoogleLogin();case 2:(n=t.sent).isFailure()&&(e.errorMessage=n.getReason());case 4:case"end":return t.stop()}},t)}))()}},{key:"redirect",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.router.navigate(["/lobby"]));case 1:case"end":return t.stop()}},t)}))()}},{key:"canLogin",value:function(){var e,t;return!(""===(null!==(e=this.loginForm.value.email)&&void 0!==e?e:"")||""===(null!==(t=this.loginForm.value.password)&&void 0!==t?t:""))}},{key:"ngOnDestroy",value:function(){this.userSubscription.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF),yS(B7))},e.\u0275cmp=ck({type:e,selectors:[["app-login"]],decls:49,vars:8,consts:function(){return[[1,"box"],[1,"title"],$localize(pd||(pd=Hg(["Log in"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(gd||(gd=Hg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",$localize(yd||(yd=Hg(["Email"]))),"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],$localize(md||(md=Hg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",$localize(kd||(kd=Hg(["Password"]))),"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Cd||(Cd=Hg(["Log in"]))),["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(wd||(wd=Hg(["Log in with Google"]))),["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],$localize(_d||(_d=Hg(["No account?"]))),[3,"routerLink"],$localize(Ed||(Ed=Hg(["Register"]))),$localize(bd||(bd=Hg(["Forgot your password?"]))),$localize(Sd||(Sd=Hg(["Reset your password"]))),["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Pd||(Pd=Hg(["Connection error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"p",1),fO(2,2),wS(),CS(3,"form",3),CS(4,"div",4),CS(5,"div",5),CS(6,"label",6),fO(7,7),wS(),wS(),CS(8,"div",8),CS(9,"div",9),CS(10,"div",10),_S(11,"input",11),wS(),wS(),wS(),wS(),CS(12,"div",4),CS(13,"div",5),CS(14,"label",12),fO(15,13),wS(),wS(),CS(16,"div",8),CS(17,"div",9),CS(18,"div",14),_S(19,"input",15),CS(20,"span",16),_S(21,"fa-icon",17),wS(),wS(),wS(),wS(),wS(),CS(22,"div",4),_S(23,"div",5),CS(24,"div",8),CS(25,"div",9),CS(26,"div",10),CS(27,"button",18),TS("click",function(){return t.loginWithEmail(t.loginForm.value)}),fO(28,19),wS(),wS(),wS(),wS(),wS(),CS(29,"div",4),_S(30,"div",5),CS(31,"div",8),CS(32,"div",9),CS(33,"div",10),CS(34,"button",20),TS("click",function(){return t.loginWithGoogle()}),fO(35,21),wS(),wS(),wS(),wS(),wS(),pS(36,Fve,5,1,"div",22),CS(37,"p",23),ES(38),fO(39,24),bS(),rP(40,"\xa0 "),CS(41,"a",25),fO(42,26),wS(),wS(),CS(43,"p",23),ES(44),fO(45,27),bS(),rP(46,"\xa0 "),CS(47,"a",25),fO(48,28),wS(),wS(),wS(),wS()),2&e&&(DE(3),mS("formGroup",t.loginForm),DE(18),mS("icon",t.faEye),DE(6),mS("disabled",!t.canLogin()),DE(9),mS("ngIf",t.errorMessage),DE(5),mS("routerLink",ST(6,Uve)),DE(6),mS("routerLink",ST(7,Vve)))},directives:[vx,LM,Cx,aM,DM,_x,Dve,Mx,Gee,Lve,iR,yF],encapsulation:2}),e}(),zve=function(){var e=function(){function e(t){fy(this,e),this.userDAO=t}return dy(e,[{key:"subscribeToActiveUsers",value:function(t){var n=this;OB(e.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");var r=[],i=new r9(function(i){var a;OB(e.VERBOSE,"our DAO gave us "+i.length+" new user(s)"),r=n.sort((a=r).concat.apply(a,oy(i))),t(r)},function(i){var a=r;OB(e.VERBOSE,"our DAO updated "+i.length+" user(s)");var o,s=uy(i);try{var u=function(){var e=o.value;a.forEach(function(t){t.id===e.id&&(t.data=e.data)}),a=n.sort(a)};for(s.s();!(o=s.n()).done;)u()}catch(c){s.e(c)}finally{s.f()}t(r=a)},function(e){r=r.filter(function(t){return!e.some(function(e){return e.id===t.id})}),t(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],i)}},{key:"sort",value:function(e){return e.sort(function(e,t){var n=PB.getNonNullable(e.data).lastUpdateTime,r=PB.getNonNullable(n).seconds,i=PB.getNonNullable(t.data).lastUpdateTime;return r-PB.getNonNullable(i).seconds})}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(Dw(D7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Hve=function(){var e=function(){function e(t){fy(this,e),this.partDAO=t}return dy(e,[{key:"subscribeToActiveParts",value:function(e){var t=[],n=new r9(function(n){var r;t=(r=t).concat.apply(r,oy(n)),e(t)},function(n){var r,i=t,a=uy(n);try{var o=function(){var e=r.value;i.forEach(function(t){t.id===e.id&&(t.data=e.data)})};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)},function(n){var r,i=[],a=uy(t);try{var o=function(){var e=r.value;n.some(function(t){return t.id===e.id})||i.push(e)};for(a.s();!(r=a.n()).done;)o()}catch(s){a.e(s)}finally{a.f()}e(t=i)});return this.partDAO.observingWhere([["result","==",z7.UNACHIEVED.value]],n)}},{key:"userHasActivePart",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.partDAO.findWhere([["playerZero","==",e],["result","==",z7.UNACHIEVED.value]]);case 2:return r=n.sent,n.next=5,t.partDAO.findWhere([["playerOne","==",e],["result","==",z7.UNACHIEVED.value]]);case 5:return i=n.sent,n.abrupt("return",r.length>0||i.length>0);case 7:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(n9))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"any"}),e}(),Gve=function(){var e=function(){function e(t){fy(this,e),this.router=t}return dy(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"navigateToOnlineGameCreation",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/play",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF))},e.\u0275cmp=ck({type:e,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playOnline",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(Od||(Od=Hg(["Create an online game"])))]},template:function(e,t){1&e&&(CS(0,"app-pick-game",0),TS("pickGame",function(e){return t.pickGame(e)}),wS(),CS(1,"button",1),TS("click",function(){return t.navigateToOnlineGameCreation()}),fO(2,2),wS()),2&e&&(DE(1),mS("disabled",!t.selectedGame))},directives:[Ave],encapsulation:2}),e}(),$ve=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"transform",value:function(e){return DA(1e3*e.seconds,"HH:mm:ss","en-US")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=gk({name:"firebaseDate",type:e,pure:!0}),e}(),Zve=["chatDiv"];function qve(e,t){1&e&&(ES(0),fO(1,5),bS())}function Wve(e,t){1&e&&fO(0,6),2&e&&(hO(RS().unreadMessagesText),dO(0))}function jve(e,t){if(1&e){var n=SS();CS(0,"button",11),TS("click",function(){return eC(n),RS(2).scrollToBottom()}),rP(1),wS()}if(2&e){var r=RS(2);DE(1),aP("",r.unreadMessagesText," \u2193")}}function Yve(e,t){if(1&e&&(CS(0,"p"),rP(1),RT(2,"firebaseDate"),CS(3,"b",12),rP(4),wS(),CS(5,"span",13),rP(6),wS(),wS()),2&e){var n=t.$implicit;DE(1),aP(" [",MT(2,3,n.postedTime),"] "),DE(3),aP("",n.sender.name," : "),DE(2),iP(n.content)}}function Kve(e,t){if(1&e){var n=SS();CS(0,"div"),pS(1,jve,2,1,"button",7),CS(2,"div",8,9),TS("scroll",function(){return eC(n),RS().updateCurrentScrollPosition()}),pS(4,Yve,7,5,"p",10),wS(),wS()}if(2&e){var r=RS();DE(1),mS("ngIf",r.showUnreadMessagesButton),DE(3),mS("ngForOf",r.chat)}}var Qve=function(){return{standalone:!0}};function Xve(e,t){if(1&e){var n=SS();CS(0,"form",14),TS("onSubmit",function(){return eC(n),RS().sendMessage()}),CS(1,"div",15),CS(2,"div",16),CS(3,"input",17,18),TS("ngModelChange",function(e){return eC(n),RS().userMessage=e}),wS(),CS(5,"p",19),rP(6),wS(),wS(),CS(7,"div",20),CS(8,"button",21),TS("click",function(){return eC(n),RS().sendMessage()}),_S(9,"fa-icon",22),wS(),wS(),wS(),CS(10,"div",23),CS(11,"p"),CS(12,"strong"),fO(13,24),wS(),wS(),wS(),wS()}if(2&e){var r=gS(4),i=RS();DE(3),mS("ngModel",i.userMessage)("ngModelOptions",ST(4,Qve)),DE(3),aP("",r.value.length,"/128"),DE(3),mS("icon",i.faReply)}}var Jve=function(){var e=function(){function e(t,n){fy(this,e),this.chatService=t,this.connectedUserService=n,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=m9,this.isNearBottom=!0,this.notYetScrolled=!0,OB(e.VERBOSE,"ChatComponent constructor")}return dy(e,[{key:"ngOnInit",value:function(){OB(e.VERBOSE,"ChatComponent.ngOnInit for chat ".concat(this.chatId)),N7(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}},{key:"ngAfterViewChecked",value:function(){this.scrollToBottomIfNeeded()}},{key:"loadChatContent",value:function(){var e=this,t=function(t){e.updateMessages(t.flatMap(function(e){return null==e.data.postedTime?[]:[e.data]}))},n=new r9(t,t,function(){});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,n)}},{key:"updateMessages",value:function(e){this.chat=this.chat.concat(e);var t=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=t,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(t-this.readMessages)}},{key:"updateUnreadMessagesText",value:function(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize(Td||(Td=Hg(["no new message"]))),this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize(Id||(Id=Hg(["1 new message"]))):$localize(Ad||(Ad=Hg([""," new messages"])),e)}},{key:"scrollToBottomIfNeeded",value:function(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}},{key:"updateCurrentScrollPosition",value:function(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}},{key:"scrollToBottom",value:function(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}},{key:"scrollTo",value:function(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}},{key:"sendMessage",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.userMessage,e.userMessage="",r=e.connectedUserService.user.get().toMinimalUser(),t.next=5,e.chatService.sendMessage(e.chatId,r,n,e.turn);case 5:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.chatSubscription.unsubscribe()}},{key:"switchChatVisibility",value:function(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(I7),yS(B7))},e.\u0275cmp=ck({type:e,selectors:[["app-chat"]],viewQuery:function(e,t){var n;(1&e&&YT(Zve,5),2&e)&&(jT(n=KT())&&(t.chatDiv=n.first))},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){return[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],$localize(Rd||(Rd=Hg(["Hide chat"]))),$localize(Md||(Md=Hg(["Show chat (",":INTERPOLATION:)"])),"\ufffd0\ufffd"),["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",$localize(xd||(xd=Hg(["Type your message here"]))),"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],$localize(Nd||(Nd=Hg(["Be polite"])))]},template:function(e,t){if(1&e&&(CS(0,"div"),CS(1,"button",0),TS("click",function(){return t.switchChatVisibility()}),pS(2,qve,2,0,"ng-container",1),pS(3,Wve,1,1,"ng-template",null,2,XT),wS(),pS(5,Kve,5,2,"div",3),pS(6,Xve,14,5,"form",4),wS()),2&e){var n=gS(4);DE(2),mS("ngIf",t.visible)("ngIfElse",n),DE(3),mS("ngIf",t.visible),DE(1),mS("ngIf",t.visible)}},directives:[iR,nR,vx,LM,lx,aM,Nx,DM,dx,Gee],pipes:[$ve],encapsulation:2}),e}();function epe(e,t){if(1&e&&(ES(0),rP(1),bS()),2&e){var n=RS().$implicit;DE(1),iP(n.data.playerOne.name)}}function tpe(e,t){1&e&&(ES(0),fO(1,26),bS())}function npe(e,t){if(1&e){var n=SS();CS(0,"tr",22),TS("click",function(){var e=eC(n).$implicit;return RS(2).joinGame(e.id,e.data.typeGame)}),CS(1,"td",23),rP(2),wS(),CS(3,"td",23),rP(4),wS(),CS(5,"td",23),pS(6,epe,2,1,"ng-container",24),pS(7,tpe,2,0,"ng-template",null,25,XT),wS(),CS(9,"td",23),rP(10),wS(),wS()}if(2&e){var r=t.$implicit,i=t.index,a=gS(8);xS("id","part_",i,""),DE(2),iP(r.data.typeGame),DE(2),iP(r.data.playerZero.name),DE(2),mS("ngIf",r.data.playerOne)("ngIfElse",a),DE(4),iP(r.data.turn)}}function rpe(e,t){if(1&e&&(CS(0,"div",13),CS(1,"div",14),CS(2,"table",15),CS(3,"thead"),CS(4,"tr"),CS(5,"th",16),fO(6,17),wS(),CS(7,"th",16),fO(8,18),wS(),CS(9,"th",16),fO(10,19),wS(),CS(11,"th",16),fO(12,20),wS(),wS(),wS(),CS(13,"tbody"),pS(14,npe,11,6,"tr",21),wS(),wS(),wS(),wS()),2&e){var n=RS();DE(14),mS("ngForOf",n.activeParts)}}function ipe(e,t){1&e&&(CS(0,"div",27),_S(1,"app-online-game-selection",28),wS())}function ape(e,t){if(1&e&&(CS(0,"li",39),rP(1),RT(2,"firebaseDate"),wS()),2&e){var n=RS().$implicit;MS("id",n.data.username),DE(1),oP("",n.data.username,": ",MT(2,3,n.data.lastUpdateTime),"")}}function ope(e,t){if(1&e&&(ES(0),pS(1,ape,3,5,"li",38),bS()),2&e){var n=t.$implicit;DE(1),mS("ngIf",n.data.lastUpdateTime)}}function spe(e,t){if(1&e&&(CS(0,"div",29),CS(1,"div",30),CS(2,"div",31),_S(3,"app-chat",32),wS(),wS(),CS(4,"div",33),CS(5,"div",34),CS(6,"p"),fO(7,35),wS(),CS(8,"ul",36),pS(9,ope,2,1,"ng-container",37),wS(),wS(),wS(),wS()),2&e){var n=RS();DE(3),mS("turn",-1),DE(6),mS("ngForOf",n.activeUsers)}}var upe=function(){var e=function(){function e(t,n,r){fy(this,e),this.router=t,this.activeUsersService=n,this.activePartsService=r,this.activeUsers=[],this.activeParts=[],this.currentTab="games"}return dy(e,[{key:"ngOnInit",value:function(){var t=this;OB(e.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(function(e){t.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(function(e){t.activeParts=e})}},{key:"ngOnDestroy",value:function(){OB(e.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}},{key:"joinGame",value:function(e,t){var n=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.router.navigate(["/play",t,e]);case 2:case"end":return r.stop()}},r)}))()}},{key:"selectTab",value:function(e){this.currentTab=e}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(vF),yS(zve),yS(Hve))},e.\u0275cmp=ck({type:e,selectors:[["app-lobby"]],decls:14,vars:3,consts:function(){return[[1,"tabs","is-centered"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],$localize(Dd||(Dd=Hg(["Games"]))),["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"click"],$localize(Ld||(Ld=Hg(["Create"]))),["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],$localize(Fd||(Fd=Hg(["Chat"]))),["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Ud||(Ud=Hg(["Game"]))),$localize(Vd||(Vd=Hg(["First player"]))),$localize(Bd||(Bd=Hg(["Second player"]))),$localize(zd||(zd=Hg(["Turn"]))),[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],$localize(Hd||(Hd=Hg(["Waiting for opponent"]))),["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],$localize(Gd||(Gd=Hg(["Connected users:"]))),["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"ul"),CS(2,"li",1),CS(3,"a",2),TS("click",function(){return t.selectTab("games")}),fO(4,3),wS(),wS(),CS(5,"li",4),CS(6,"a",5),TS("click",function(){return t.selectTab("create")}),fO(7,6),wS(),wS(),CS(8,"li",7),CS(9,"a",8),TS("click",function(){return t.selectTab("chat")}),fO(10,9),wS(),wS(),wS(),wS(),pS(11,rpe,15,1,"div",10),pS(12,ipe,2,0,"div",11),pS(13,spe,10,2,"div",12)),2&e&&(DE(11),mS("ngIf","games"===t.currentTab),DE(1),mS("ngIf","create"===t.currentTab),DE(1),mS("ngIf","chat"===t.currentTab))},directives:[eR,iR,nR,Gve,Jve],pipes:[$ve],encapsulation:2}),e}(),cpe=function(){var e=dy(function e(t){var n;fy(this,e),this.route=t,this.message=null!==(n=t.snapshot.paramMap.get("message"))&&void 0!==n?n:$localize($d||($d=Hg(["This page does not exist."])))});return e.\u0275fac=function(t){return new(t||e)(yS(WD))},e.\u0275cmp=ck({type:e,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){return[[1,"message","is-danger"],[1,"message-header"],$localize(Zd||(Zd=Hg(["Not found"]))),[1,"message-body"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"div",1),fO(2,2),wS(),CS(3,"div",3),rP(4),wS(),wS()),2&e&&(DE(4),iP(t.message))},encapsulation:2}),e}();function lpe(e,t){}var fpe=function(){var e=dy(function e(t){fy(this,e),this.viewContainerRef=t,OB(e.VERBOSE,"GameIncluderComponent constructor")});return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(fT))},e.\u0275cmp=ck({type:e,selectors:[["app-game-includer"]],decls:1,vars:0,template:function(e,t){1&e&&pS(0,lpe,0,0,"ng-template")},encapsulation:2}),e}(),hpe=function(){var e=function(){function e(){fy(this,e)}return dy(e,null,[{key:"NO_MATCHING_GAME",value:function(e){return $localize(qd||(qd=Hg(["This game (",") does not exist."])),e)}}]),e}();return e.NOT_YOUR_TURN=function(){return $localize(Wd||(Wd=Hg(["It is not your turn!"])))},e.NO_CLONING_FEATURE=function(){return $localize(jd||(jd=Hg(["You cannot clone a game. This feature might be implemented later."])))},e}(),dpe=function(){var e=function(){function e(t,n,r,i,a){fy(this,e),this.componentFactoryResolver=t,this.actRoute=n,this.connectedUserService=r,this.router=i,this.messageDisplayer=a,this.players=[RB.empty(),RB.empty()],this.role=K7.NONE,this.endGame=!1,this.Player=Q7,OB(e.VERBOSE,"GameWrapper.constructed: "+(null!=this.gameIncluder))}return dy(e,[{key:"getMatchingComponent",value:function(t){return OB(e.VERBOSE,"GameWrapper.getMatchingComponent"),RB.ofNullable(Ive.ALL_GAMES().find(function(e){return e.urlName===t})).map(function(e){return e.component})}},{key:"afterGameIncluderViewInit",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return OB(e.VERBOSE,"GameWrapper.afterGameIncluderViewInit"),n.next=3,t.createGameComponent();case 3:return r=n.sent,n.abrupt("return",(r&&t.gameComponent.rules.setInitialBoard(),r));case 5:case"end":return n.stop()}},n)}))()}},{key:"createGameComponent",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(OB(e.VERBOSE,"GameWrapper.createGameComponent"),r=PB.getNonNullable(t.actRoute.snapshot.paramMap.get("compo")),!(i=t.getMatchingComponent(r)).isAbsent()){n.next=6;break}return n.next=5,t.router.navigate(["/notFound",hpe.NO_MATCHING_GAME(r)],{skipLocationChange:!0});case 5:return n.abrupt("return",!1);case 6:return N7(null!=t.gameIncluder,"GameIncluder should be present"),a=t.componentFactoryResolver.resolveComponentFactory(i.get()),o=t.gameIncluder.viewContainerRef.createComponent(a),n.abrupt("return",(t.gameComponent=o.instance,t.gameComponent.chooseMove=function(e,n,r){return t.receiveValidMove(e,n,r)},t.gameComponent.canUserPlay=function(e){return t.onUserClick(e)},t.gameComponent.isPlayerTurn=function(){return t.isPlayerTurn()},t.gameComponent.cancelMoveOnWrapper=function(e){t.onCancelMove(e)},t.setRole(t.role),t.canPass=t.gameComponent.canPass,!0));case 9:case"end":return n.stop()}},n)}))()}},{key:"setRole",value:function(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")")}},{key:"receiveValidMove",value:function(t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(OB(e.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:t,state:n,scores:r}}),i.isPlayerTurn()){a.next=2;break}return a.abrupt("return",DB.failure(hpe.NOT_YOUR_TURN()));case 2:if(!i.endGame){a.next=4;break}return a.abrupt("return",DB.failure($localize(Yd||(Yd=Hg(["The game has ended."])))));case 4:if(!(o=i.gameComponent.rules.isLegal(t,n)).isFailure()){a.next=9;break}a.t0=(i.gameComponent.cancelMove(o.getReason()),DB.ofFallible(o)),a.next=14;break;case 9:return i.gameComponent.cancelMoveAttempt(),a.next=12,i.onLegalUserMove(t,r);case 12:OB(e.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),a.t0=DB.SUCCESS;case 14:return a.abrupt("return",a.t0);case 15:case"end":return a.stop()}},a)}))()}},{key:"onUserClick",value:function(e){if(this.role===K7.NONE){var t=hpe.NO_CLONING_FEATURE();return DB.failure(t)}return this.isPlayerTurn()?DB.SUCCESS:DB.failure(hpe.NOT_YOUR_TURN())}},{key:"onCancelMove",value:function(e){}},{key:"isPlayerTurn",value:function(){if(this.role===K7.NONE||null==this.gameComponent)return!1;var t=this.gameComponent.rules.node.gameState.turn,n=t%2,r=this.getPlayer();return OB(e.VERBOSE,{isPlayerTurn:{turn:t,players:this.players,player:r,observer:this.role,areYouPlayer:this.players[n].isPresent()&&AB(this.players[n].get(),r),isThereAPlayer:this.players[n]}}),!this.players[n].isPresent()||this.players[n].equalsValue(r)}},{key:"getBoardHighlight",value:function(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.rules.node.gameState.turn%2+"-bg"]:[]}}]),e}();return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(bO),yS(WD),yS(B7),yS(vF),yS(M7))},e.\u0275cmp=ck({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&YT(fpe,5),2&e)&&(jT(n=KT())&&(t.gameIncluder=n.first))},decls:0,vars:0,template:function(e,t){},encapsulation:2}),e}(),vpe=function(){function e(t,n,r){fy(this,e),this.added=t,this.modified=n,this.removed=r}return dy(e,[{key:"addNewKeys",value:function(e,t){var n,r=uy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;null!=t[i]&&(this.added[i]=t[i])}}catch(a){r.e(a)}finally{r.f()}}},{key:"addCommonKeys",value:function(e,t,n){var r,i=uy(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.addCommonKey(a,n[a],t[a])}}catch(o){i.e(o)}finally{i.f()}}},{key:"addCommonKey",value:function(t,n,r){if(null==r)null!=n&&(this.removed[t]=n);else if(null==n)this.added[t]=r;else if(["string","boolean","number"].includes(typeof n))n!==r&&(this.modified[t]=r);else if(Array.isArray(n)){if(!Array.isArray(r))throw new Error("Thing should not change type");n.length===r.length?this.addCommonKeyList(t,n,r):this.modified[t]=r}else{N7("object"==typeof n,"ObjectDifference: expected JSON, but got a ".concat(typeof n," in ").concat(t)),N7("object"==typeof r,"ObjectDifference: expected JSON, but got a ".concat(typeof r," in ").concat(t));var i=e.from(n,r);i.countChanges()>0&&(this.modified[t]=i)}}},{key:"addCommonKeyList",value:function(t,n,r){for(var i=!0,a=0;i&&a<n.length;a++)typeof n[a]==typeof r[a]&&"object"==typeof n[a]?e.differs(n[a],r[a])&&(i=!1,this.modified[t]=r):n[a]!==r[a]&&(i=!1,this.modified[t]=r)}},{key:"addRemovedKeys",value:function(e,t){var n,r=uy(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.removed[i]=t[i]}}catch(a){r.e(a)}finally{r.f()}}},{key:"countChanges",value:function(){var e=Object.keys(this.removed).length,t=Object.keys(this.modified).length;return Object.keys(this.added).length+t+e}},{key:"isPresent",value:function(e){return null!=this.added[e]?{state:"added",present:!0}:null!=this.modified[e]?{state:"modified",present:!0}:null!=this.removed[e]?{state:"removed",present:!0}:{state:null,present:!1}}}],[{key:"from",value:function(t,n){var r=new e({},{},{});if(null==t)return r.added=$g({},n),r;if(null==n)return r.removed=$g({},t),r;var i=Object.keys(t),a=Object.keys(n),o=i.filter(function(e){return!1===a.includes(e)}),s=i.filter(function(e){return a.includes(e)}),u=a.filter(function(e){return!1===i.includes(e)});return r.addNewKeys(u,n),r.addCommonKeys(s,n,t),r.addRemovedKeys(o,t),r}},{key:"differs",value:function(t,n){return e.from(t,n).countChanges()>0}}]),e}();function ppe(e){return 1e3*e.seconds+e.nanoseconds/1e6}function gpe(e,t){return ppe(t)-ppe(e)}function ype(e){return Gy(function(t,n){am(e).subscribe(new $y(n,function(){return n.complete()},by)),!n.closed&&t.subscribe(n)})}var mpe=function(){var e=function(){function e(){fy(this,e)}return dy(e,[{key:"transform",value:function(e){var t=e%60,n=(e-t)%3600/60,r=(e-60*n-t)/3600,i=[];if(r>1?i.push($localize(Kd||(Kd=Hg([""," hours"])),r)):1===r&&i.push($localize(Qd||(Qd=Hg(["1 hour"])))),n>1?i.push($localize(Xd||(Xd=Hg([""," minutes"])),n)):1===n&&i.push($localize(Jd||(Jd=Hg(["1 minute"])))),t>1?i.push($localize(ev||(ev=Hg([""," seconds"])),t)):1===t&&i.push($localize(tv||(tv=Hg(["1 second"])))),0===i.length)return $localize(nv||(nv=Hg(["0 seconds"])));if(1===i.length)return i[0];var a=i.slice(0,-1).join(", "),o=i.slice(-1)[0];return $localize(rv||(rv=Hg([""," and ",""])),a,o)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=gk({name:"humanDuration",type:e,pure:!0}),e}();function kpe(e,t){if(1&e&&(ES(0),rP(1),bS()),2&e){var n=RS(3);DE(1),iP(n.viewInfo.chosenOpponent)}}function Cpe(e,t){1&e&&fO(0,44)}function wpe(e,t){if(1&e&&(CS(0,"div",45),CS(1,"div",8),CS(2,"label",46),ES(3),fO(4,47),bS(),CS(5,"output"),rP(6),RT(7,"humanDuration"),wS(),wS(),CS(8,"div",37),_S(9,"input",48),wS(),wS(),CS(10,"div",8),CS(11,"label",49),cO(12,50),_S(13,"output"),RT(14,"humanDuration"),lO(),wS(),CS(15,"div",37),_S(16,"input",51),wS(),wS(),wS()),2&e){var n=RS(3);DE(6),iP(MT(7,2,n.viewInfo.maximalMoveDuration||0)),DE(8),hO(MT(14,4,n.viewInfo.totalPartDuration||0)),dO(12)}}function _pe(e,t){1&e&&(CS(0,"div"),cO(1,52),_S(2,"br"),lO(),wS())}function Epe(e,t){1&e&&(CS(0,"button",64),fO(1,65),wS())}function bpe(e,t){if(1&e){var n=SS();CS(0,"tr",60),TS("click",function(){var e=eC(n).$implicit;return RS(4).selectOpponent(e)}),CS(1,"td",61),rP(2),wS(),CS(3,"td",62),pS(4,Epe,2,0,"button",63),wS(),wS()}if(2&e){var r=t.$implicit,i=RS(4);xS("id","presenceOf_",r,""),mS("ngClass",i.viewInfo.candidateClasses[r]),DE(1),mS("id",i.viewInfo.chosenOpponent===r?"selected_"+r:"candidate_"+r),DE(1),iP(r),DE(2),mS("ngIf",i.viewInfo.chosenOpponent!==r)}}function Spe(e,t){if(1&e&&(ES(0),fO(1,53),bS(),CS(2,"div",54),CS(3,"table",55),CS(4,"thead"),CS(5,"tr"),CS(6,"th",56),fO(7,57),wS(),CS(8,"th",56),fO(9,58),wS(),wS(),wS(),CS(10,"tbody"),pS(11,bpe,5,5,"tr",59),wS(),wS(),wS()),2&e){var n=RS(3);DE(11),mS("ngForOf",n.viewInfo.candidates)}}function Ppe(e,t){if(1&e){var n=SS();CS(0,"button",66),TS("click",function(){return eC(n),RS(3).changeConfig()}),fO(1,67),wS()}}function Ope(e,t){if(1&e){var n=SS();CS(0,"div"),CS(1,"h1",4),fO(2,5),wS(),CS(3,"form",6),CS(4,"fieldset",7),CS(5,"div",8),CS(6,"label",9),fO(7,10),wS(),CS(8,"div",11),CS(9,"button",12),TS("click",function(){return eC(n),RS(2).selectFirstPlayer("RANDOM")}),fO(10,13),wS(),CS(11,"button",14),TS("click",function(){return eC(n),RS(2).selectFirstPlayer("CREATOR")}),fO(12,15),wS(),CS(13,"button",16),TS("click",function(){return eC(n),RS(2).selectFirstPlayer("CHOSEN_PLAYER")}),pS(14,kpe,2,1,"ng-container",17),pS(15,Cpe,1,0,"ng-template",null,18,XT),wS(),wS(),wS(),CS(17,"div",8),CS(18,"label",9),fO(19,19),wS(),CS(20,"div",11),CS(21,"div",20),TS("click",function(){return eC(n),RS(2).selectPartType("STANDARD")}),CS(22,"div",21),CS(23,"span"),fO(24,22),wS(),wS(),CS(25,"div",23),CS(26,"div",24),CS(27,"div",25),CS(28,"p"),ES(29),fO(30,26),bS(),CS(31,"strong"),rP(32),RT(33,"humanDuration"),wS(),_S(34,"br"),ES(35),cO(36,27),_S(37,"strong"),RT(38,"humanDuration"),lO(),bS(),wS(),wS(),wS(),wS(),wS(),CS(39,"div",28),TS("click",function(){return eC(n),RS(2).selectPartType("BLITZ")}),CS(40,"div",21),CS(41,"span"),fO(42,29),wS(),wS(),CS(43,"div",23),CS(44,"div",24),CS(45,"div",25),CS(46,"p"),ES(47),fO(48,30),bS(),CS(49,"strong"),rP(50),RT(51,"humanDuration"),wS(),_S(52,"br"),ES(53),cO(54,31),_S(55,"strong"),RT(56,"humanDuration"),lO(),bS(),wS(),wS(),wS(),wS(),wS(),CS(57,"button",32),TS("click",function(){return eC(n),RS(2).selectPartType("CUSTOM")}),fO(58,33),wS(),wS(),wS(),pS(59,wpe,17,6,"div",34),CS(60,"div",8),CS(61,"label",35),fO(62,36),wS(),CS(63,"div",37),pS(64,_pe,3,0,"div",17),pS(65,Spe,12,1,"ng-template",null,38,XT),wS(),wS(),wS(),CS(67,"div",8),CS(68,"div",11),CS(69,"button",39),TS("click",function(){return eC(n),RS(2).proposeConfig()}),fO(70,40),wS(),pS(71,Ppe,2,0,"button",41),CS(72,"button",42),TS("click",function(){return eC(n),RS(2).cancelGameCreation()}),fO(73,43),wS(),wS(),wS(),wS(),wS()}if(2&e){var r=gS(16),i=gS(66),a=RS(2);DE(3),mS("formGroup",a.configFormGroup),DE(1),mS("disabled",!a.viewInfo.canEditConfig),DE(5),mS("ngClass",a.viewInfo.firstPlayerClasses.RANDOM),DE(2),mS("ngClass",a.viewInfo.firstPlayerClasses.CREATOR),DE(2),mS("ngClass",a.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),DE(1),mS("ngIf",a.viewInfo.chosenOpponent)("ngIfElse",r),DE(7),mS("ngClass",a.viewInfo.partTypeClasses.STANDARD),DE(11),iP(MT(33,19,a.partType.NORMAL_MOVE_DURATION)),DE(6),hO(MT(38,21,a.partType.NORMAL_PART_DURATION)),dO(36),DE(1),mS("ngClass",a.viewInfo.partTypeClasses.BLITZ),DE(11),iP(MT(51,23,a.partType.BLITZ_MOVE_DURATION)),DE(6),hO(MT(56,25,a.partType.BLITZ_PART_DURATION)),dO(54),DE(1),mS("ngClass",a.viewInfo.partTypeClasses.CUSTOM),DE(2),mS("ngIf",a.viewInfo.showCustomTime),DE(5),mS("ngIf",0===a.viewInfo.candidates.length)("ngIfElse",i),DE(5),mS("disabled",!a.viewInfo.canProposeConfig),DE(2),mS("ngIf",a.viewInfo.canReviewConfig)}}function Tpe(e,t){if(1&e&&(CS(0,"div",74),CS(1,"p"),cO(2,75),_S(3,"br"),lO(),wS(),wS()),2&e){var n=RS(3);DE(3),hO(n.viewInfo.creator),dO(2)}}function Ipe(e,t){if(1&e&&(CS(0,"span"),fO(1,81),wS()),2&e){var n=RS(4);DE(1),hO(n.viewInfo.creator),dO(1)}}function Ape(e,t){1&e&&(CS(0,"span"),fO(1,82),wS())}function Rpe(e,t){1&e&&(CS(0,"span"),fO(1,83),wS())}function Mpe(e,t){if(1&e){var n=SS();CS(0,"div",74),CS(1,"p"),fO(2,76),wS(),CS(3,"ul"),CS(4,"li"),pS(5,Ipe,2,1,"span",2),pS(6,Ape,2,0,"span",2),pS(7,Rpe,2,0,"span",2),wS(),CS(8,"li"),cO(9,77),_S(10,"strong"),RT(11,"humanDuration"),lO(),wS(),CS(12,"li"),cO(13,78),_S(14,"strong"),RT(15,"humanDuration"),lO(),wS(),wS(),CS(16,"button",79),TS("click",function(){return eC(n),RS(3).acceptConfig()}),fO(17,80),wS(),wS()}if(2&e){var r=RS(3);DE(2),hO(r.viewInfo.creator)(r.viewInfo.partTypeName),dO(2),DE(3),mS("ngIf","CREATOR"===r.viewInfo.firstPlayer),DE(1),mS("ngIf","CHOSEN_PLAYER"===r.viewInfo.firstPlayer),DE(1),mS("ngIf","RANDOM"===r.viewInfo.firstPlayer),DE(4),hO(MT(11,7,r.viewInfo.maximalMoveDuration||0)),dO(9),DE(4),hO(MT(15,9,r.viewInfo.totalPartDuration||0)),dO(13)}}function xpe(e,t){if(1&e&&(CS(0,"div"),CS(1,"div",68),CS(2,"div",69),CS(3,"p"),fO(4,70),wS(),wS(),CS(5,"div",71),pS(6,Tpe,4,1,"div",72),pS(7,Mpe,18,11,"ng-template",null,73,XT),wS(),wS(),wS()),2&e){var n=gS(8),r=RS(2);DE(6),mS("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Npe(e,t){if(1&e&&(ES(0),fO(1,86),bS()),2&e){var n=RS(3);DE(1),hO(n.viewInfo.creator),dO(1)}}function Dpe(e,t){if(1&e&&fO(0,87),2&e){var n=RS(3);hO(n.viewInfo.creator)(n.viewInfo.chosenOpponent),dO(0)}}function Lpe(e,t){if(1&e&&(CS(0,"div",68),CS(1,"div",69),CS(2,"p"),fO(3,84),wS(),wS(),CS(4,"div",71),CS(5,"p"),pS(6,Npe,2,1,"ng-container",17),pS(7,Dpe,1,2,"ng-template",null,85,XT),wS(),wS(),wS()),2&e){var n=gS(8),r=RS(2);DE(6),mS("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",n)}}function Fpe(e,t){if(1&e&&(CS(0,"div",1),pS(1,Ope,74,27,"div",2),pS(2,xpe,9,2,"div",2),pS(3,Lpe,9,2,"div",3),wS()),2&e){var n=RS();DE(1),mS("ngIf",n.viewInfo.userIsCreator),DE(1),mS("ngIf",n.viewInfo.userIsChosenOpponent),DE(1),mS("ngIf",n.viewInfo.userIsObserver)}}var Upe=function(){function e(t,n,r,i,a,o,s,u){fy(this,e),this.router=t,this.connectedUserService=n,this.gameService=r,this.configRoomService=i,this.chatService=a,this.userService=o,this.formBuilder=s,this.messageDisplayer=u,this.partType=$7,this.gameStartNotification=new LT,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new By,this.allUserInterval=RB.empty(),this.ownTokenInterval=RB.empty(),this.selfSubscription=new hy,this.configRoomSubscription=new hy,this.candidatesSubscription=new hy,this.allDocDeleted=!1,OB(e.VERBOSE,"PartCreationComponent constructed")}return dy(e,[{key:"ngOnInit",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return OB(e.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms(),n.next=3,t.configRoomService.joinGame(t.partId);case 3:if(!(r=n.sent).isFailure()){n.next=9;break}i=r.getReason(),t.messageDisplayer.criticalMessage(i),n.next=16;break;case 9:return n.next=11,t.updateUserDocWithObservedPart();case 11:return n.next=13,t.startSendingPresenceTokens();case 13:t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),OB(e.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds");case 16:case"end":return n.stop()}},n)}))()}},{key:"checkInputs",value:function(){var e=this.connectedUserService.user;N7(e.isPresent()&&e.get()!==V7.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),N7(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}},{key:"createForms",value:function(){this.configFormGroup=this.formBuilder.group({firstPlayer:[G7.RANDOM.value,fM.required],maximalMoveDuration:[$7.NORMAL_MOVE_DURATION,fM.required],partType:["STANDARD",fM.required],totalPartDuration:[$7.NORMAL_PART_DURATION,fM.required],chosenOpponent:["",fM.required]})}},{key:"updateUserDocWithObservedPart",value:function(){return OB(e.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'"),this.connectedUserService.updateObservedPart(this.partId)}},{key:"subscribeToConfigRoomDoc",value:function(){var e,t=this,n=(e=SB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCurrentConfigRoomUpdate(n);case 2:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}),r=function(){var e=SB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.onCandidatesUpdate(n);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,n),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}},{key:"getForm",value:function(e){return PB.getNonNullable(this.configFormGroup.get(e))}},{key:"subscribeToFormElements",value:function(){var e=this;this.getForm("chosenOpponent").valueChanges.pipe(ype(this.ngUnsubscribe)).subscribe(function(t){void 0!==e.viewInfo.chosenOpponent&&(e.viewInfo.candidateClasses[e.viewInfo.chosenOpponent]=[]),e.viewInfo.candidateClasses[t]=["is-selected"],e.viewInfo.chosenOpponent=t;var n=PB.getNonNullable(e.currentConfigRoom).partStatus;e.viewInfo.canProposeConfig=n!==Z7.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(ype(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.partTypeClasses[e.viewInfo.partType]=[],e.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],e.viewInfo.partType=t,e.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(ype(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(ype(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(ype(this.ngUnsubscribe)).subscribe(function(t){e.viewInfo.firstPlayerClasses[e.viewInfo.firstPlayer]=[],e.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],e.viewInfo.firstPlayer=t})}},{key:"updateViewInfo",value:function(){var e,t,n=PB.getNonNullable(this.currentConfigRoom),r=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=n.partStatus===Z7.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=n.partStatus!==Z7.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=r.id===n.creator.id,this.viewInfo.userIsChosenOpponent=r.id===(null===(e=n.chosenOpponent)||void 0===e?void 0:e.id),this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=n.partStatus!==Z7.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=n.creator.name,this.viewInfo.candidates=this.candidates.map(function(e){return e.name}),r.id===n.creator.id?this.setDataForCreator(n):(this.viewInfo.maximalMoveDuration=n.maximalMoveDuration,this.viewInfo.totalPartDuration=n.totalPartDuration,this.viewInfo.partType=n.partType,this.viewInfo.chosenOpponent=null===(t=n.chosenOpponent)||void 0===t?void 0:t.name,this.viewInfo.firstPlayer=n.firstPlayer),n.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize(iv||(iv=Hg(["custom"])));break;case"BLITZ":this.viewInfo.partTypeName=$localize(av||(av=Hg(["blitz"])));break;case"STANDARD":this.viewInfo.partTypeName=$localize(ov||(ov=Hg(["standard"])))}}},{key:"setDataForCreator",value:function(e){var t,n,r,i;this.viewInfo.maximalMoveDuration=null!==(t=this.viewInfo.maximalMoveDuration)&&void 0!==t?t:e.maximalMoveDuration,this.viewInfo.totalPartDuration=null!==(n=this.viewInfo.totalPartDuration)&&void 0!==n?n:e.totalPartDuration;var a=this.viewInfo.chosenOpponent;null==a||""===a?a=null!==(r=null===(i=e.chosenOpponent)||void 0===i?void 0:i.name)&&void 0!==r?r:"":!1===this.candidates.some(function(e){return e.name===a})&&(a=""),this.getForm("chosenOpponent").setValue(a)}},{key:"selectFirstPlayer",value:function(e){this.getForm("firstPlayer").setValue(e)}},{key:"selectPartType",value:function(e){"STANDARD"===e?(this.getForm("maximalMoveDuration").setValue($7.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue($7.NORMAL_PART_DURATION)):"BLITZ"===e&&(this.getForm("maximalMoveDuration").setValue($7.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue($7.BLITZ_PART_DURATION)),this.getForm("partType").setValue(e)}},{key:"selectOpponent",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return OB(e.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")"),i=n.getUserFromName(t),r.abrupt("return",n.configRoomService.setChosenOpponent(n.partId,i));case 3:case"end":return r.stop()}},r)}))()}},{key:"getUserFromName",value:function(e){var t=this.candidates.find(function(t){return t.name===e});return PB.getNonNullable(t)}},{key:"changeConfig",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.configRoomService.reviewConfig(e.partId));case 1:case"end":return t.stop()}},t)}))()}},{key:"proposeConfig",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getForm("chosenOpponent").value,r=e.getForm("partType").value,i=e.getForm("maximalMoveDuration").value,a=e.getForm("firstPlayer").value,o=e.getForm("totalPartDuration").value,s=e.getUserFromName(n),t.abrupt("return",e.configRoomService.proposeConfig(e.partId,s,$7.of(r),i,G7.of(a),o));case 2:case"end":return t.stop()}},t)}))()}},{key:"cancelGameCreation",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.allDocDeleted=!0,n.next=3,t.connectedUserService.removeObservedPart();case 3:return OB(e.VERBOSE,"PartCreationComponent.cancelGameCreation"),n.next=6,t.chatService.deleteChat(t.partId);case 6:return OB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),n.next=9,t.gameService.deletePart(t.partId);case 9:return OB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),n.next=12,t.configRoomService.deleteConfigRoom(t.partId,t.candidates);case 12:OB(e.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted");case 13:case"end":return n.stop()}},n)}))()}},{key:"onCurrentConfigRoomUpdate",value:function(t){var n=this;return SB(regeneratorRuntime.mark(function r(){var i,a;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(OB(e.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(n.currentConfigRoom),then:JSON.stringify(t)}}),!t.isAbsent()){r.next=2;break}return r.abrupt("return",(OB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),n.onGameCancelled()));case 2:if(n.chosenOpponentJustLeft(t.get())&&(i=PB.getNonNullable(n.currentConfigRoom),a=PB.getNonNullable(i.chosenOpponent).name,n.messageDisplayer.infoMessage($localize(sv||(sv=Hg([""," left the game, please pick another opponent."])),a))),n.currentConfigRoom=t.get(),r.t0=n.allUserInterval.isAbsent(),!r.t0){r.next=8;break}return r.next=8,n.observePlayers();case 8:n.updateViewInfo(),n.isGameStarted()&&(OB(e.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),n.onGameStarted());case 10:case"end":return r.stop()}},r)}))()}},{key:"onCandidatesUpdate",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t.candidates=e,t.updateViewInfo();case 1:case"end":return n.stop()}},n)}))()}},{key:"chosenOpponentJustLeft",value:function(e){return null!=this.currentConfigRoom&&null!=this.currentConfigRoom.chosenOpponent&&null==e.chosenOpponent}},{key:"onGameCancelled",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return OB(e.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize(uv||(uv=Hg(["The game has been canceled!"])))),n.next=4,t.router.navigate(["/lobby"]);case 4:case"end":return n.stop()}},n)}))()}},{key:"isGameStarted",value:function(){return PB.getNonNullable(this.currentConfigRoom).partStatus===Z7.PART_STARTED.value}},{key:"onGameStarted",value:function(){var t=PB.getNonNullable(this.currentConfigRoom);OB(e.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,OB(e.VERBOSE,"PartCreationComponent.onGameStarted finished")}},{key:"observePlayers",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:N7(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),r=t.connectedUserService.user.get().id,t.allUserInterval=RB.of(window.setInterval(SB(regeneratorRuntime.mark(function e(){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=PB.getNonNullable(t.currentConfigRoom),i=t.lastToken,r!==n.creator.id){e.next=6;break}return e.next=4,t.checkCandidatesTokensFreshness(i);case 4:e.next=8;break;case 6:return e.next=8,t.checkCreatorTokenFreshness(i);case 8:case"end":return e.stop()}},e)})),e.TOKEN_INTERVAL));case 3:case"end":return n.stop()}},n)}))()}},{key:"checkCreatorTokenFreshness",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=PB.getNonNullable(t.currentConfigRoom),n.next=3,t.didUserTimeout(r.creator.id,e);case 3:if(n.t0=n.sent,!n.t0){n.next=7;break}return n.next=7,t.destroyDocIfPartDidNotStart();case 7:case"end":return n.stop()}},n)}))()}},{key:"destroyDocIfPartDidNotStart",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(0==(PB.getNonNullable(e.currentConfigRoom).partStatus===Z7.PART_STARTED.value),"Should not try to cancelGameCreation when part started!"),N7(!1===e.allDocDeleted,"Should not delete doc twice"),t.next=4,e.cancelGameCreation();case 4:case"end":return t.stop()}},t)}))()}},{key:"checkCandidatesTokensFreshness",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=uy(t.candidates),n.prev=1,r.s();case 3:if((i=r.n()).done){n.next=13;break}return a=i.value,n.next=7,t.didUserTimeout(a.id,e);case 7:if(n.t0=n.sent,!n.t0){n.next=11;break}return n.next=11,t.removeCandidateFromLobby(a);case 11:n.next=3;break;case 13:n.next=18;break;case 15:n.prev=15,n.t1=n.catch(1),r.e(n.t1);case 18:return n.prev=18,r.f(),n.finish(18);case 21:case"end":return n.stop()}},n,null,[[1,15,18,21]])}))()}},{key:"didUserTimeout",value:function(t,n){var r=this;return SB(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,r.userService.getUserLastUpdateTime(t);case 2:return a=i.sent,i.abrupt("return",a.isAbsent()?(x7.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):gpe(a.get(),n)>e.TOKEN_TIMEOUT);case 4:case"end":return i.stop()}},i)}))()}},{key:"removeCandidateFromLobby",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=PB.getNonNullable(t.currentConfigRoom),n.t0=e.id===(null===(r=i.chosenOpponent)||void 0===r?void 0:r.id),!n.t0){n.next=5;break}return n.next=5,t.configRoomService.reviewConfigAndRemoveChosenOpponent(t.partId);case 5:return n.abrupt("return",t.configRoomService.removeCandidate(t.partId,e));case 6:case"end":return n.stop()}},n)}))()}},{key:"startSendingPresenceTokens",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.connectedUserService.sendPresenceToken();case 2:N7(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=RB.of(window.setInterval(function(){t.connectedUserService.sendPresenceToken()},e.TOKEN_INTERVAL)),r=t.connectedUserService.user.get().id,t.selfSubscription=t.userService.observeUser(r,function(e){N7(e.isPresent(),"connected user should exist");var n=e.get();null!=n.lastUpdateTime&&(t.lastToken=n.lastUpdateTime)});case 6:case"end":return n.stop()}},n)}))()}},{key:"stopSendingPresenceTokensAndObservingUsersIfNeeded",value:function(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=RB.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}},{key:"acceptConfig",value:function(){return OB(e.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,PB.getNonNullable(this.currentConfigRoom))}},{key:"ngOnDestroy",value:function(){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(OB(e.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded(),r=t.connectedUserService.user.get(),n.t0=!0!==t.gameStarted,!n.t0){n.next=23;break}if(null!==t.currentConfigRoom){n.next=8;break}OB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"),n.next=23;break;case 8:if(!0!==t.allDocDeleted){n.next=12;break}OB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"),n.next=23;break;case 12:if(r.id!==t.currentConfigRoom.creator.id){n.next=18;break}return OB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),n.next=16,t.cancelGameCreation();case 16:n.next=23;break;case 18:return OB(e.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),n.next=21,t.connectedUserService.removeObservedPart();case 21:return n.next=23,t.configRoomService.cancelJoining(t.partId);case 23:case"end":return n.stop()}},n)}))()}}]),e}();function Vpe(e,t){if(1&e){var n=SS();CS(0,"button",3),TS("click",function(){return eC(n),RS().addTime()}),fO(1,4),wS()}if(2&e){var r=RS();DE(1),hO(r.timeToAdd),dO(1)}}Upe.VERBOSE=!1,Upe.TOKEN_INTERVAL=5e3,Upe.TOKEN_TIMEOUT=2*Upe.TOKEN_INTERVAL,Upe.\u0275fac=function(e){return new(e||Upe)(yS(vF),yS(B7),yS(o9),yS(a9),yS(I7),yS(L7),yS(Ux),yS(M7))},Upe.\u0275cmp=ck({type:Upe,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){return[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],$localize(cv||(cv=Hg(["Game creation"]))),[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],$localize(lv||(lv=Hg(["First player"]))),[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],$localize(fv||(fv=Hg(["Random"]))),["id","firstPlayerCreator",1,"button",3,"ngClass","click"],$localize(hv||(hv=Hg(["You"]))),["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],$localize(dv||(dv=Hg(["Game type"]))),["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],$localize(vv||(vv=Hg(["Standard"]))),["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],$localize(pv||(pv=Hg(["Maximal turn duration: "]))),$localize(gv||(gv=Hg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#37\ufffd","\ufffd0\ufffd","\ufffd/#37\ufffd"),["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],$localize(yv||(yv=Hg(["Blitz"]))),$localize(mv||(mv=Hg(["Maximal turn duration: "]))),$localize(kv||(kv=Hg(["Maximal game duration: ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#55\ufffd","\ufffd0\ufffd","\ufffd/#55\ufffd"),["id","partTypeCustom",1,"button",3,"ngClass","click"],$localize(Cv||(Cv=Hg(["Custom"]))),["id","customTime",4,"ngIf"],[1,"label"],$localize(wv||(wv=Hg(["Opponents"]))),[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],$localize(_v||(_v=Hg(["Propose configuration"]))),["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],$localize(Ev||(Ev=Hg(["Cancel game"]))),$localize(bv||(bv=Hg(["The opponent"]))),["id","customTime"],["for","maximalMoveDuration",1,"label"],$localize(Sv||(Sv=Hg(["Maximal turn duration: "]))),["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],$localize(Pv||(Pv=Hg(["Maximal game duration: ",":START_TAG_OUTPUT:",":INTERPOLATION: per player",":CLOSE_TAG_OUTPUT:"])),"\ufffd#13\ufffd","\ufffd0\ufffd","\ufffd/#13\ufffd"),["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],$localize(Ov||(Ov=Hg(["Potential opponents that join the game will appear here.",":LINE_BREAK:Wait for an opponent to join, so that you can pick one."])),"\ufffd#2\ufffd\ufffd/#2\ufffd"),$localize(Tv||(Tv=Hg(["Click on the opponent against which you would like to play."]))),["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],$localize(Iv||(Iv=Hg(["Name"]))),$localize(Av||(Av=Hg(["Actions"]))),[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],$localize(Rv||(Rv=Hg(["Pick"]))),["id","reviewConfig",1,"button",3,"click"],$localize(Mv||(Mv=Hg(["Change configuration"]))),[1,"message","is-primary"],[1,"message-header"],$localize(xv||(xv=Hg(["Configuration proposal"]))),[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],$localize(Nv||(Nv=Hg(["You have been selected as the opponent.",":LINE_BREAK: ",":INTERPOLATION: is modifying the configuration."])),"\ufffd#3\ufffd\ufffd/#3\ufffd","\ufffd0\ufffd"),$localize(Dv||(Dv=Hg(["",":INTERPOLATION: proposes to play a ",":INTERPOLATION_1: game"])),"\ufffd0\ufffd","\ufffd1\ufffd"),$localize(Lv||(Lv=Hg(["a turn lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: ",":CLOSE_TAG_STRONG:"])),"\ufffd#10\ufffd","\ufffd0\ufffd","\ufffd/#10\ufffd"),$localize(Fv||(Fv=Hg(["the game lasts at most ",":START_TAG_STRONG:",":INTERPOLATION: per player",":CLOSE_TAG_STRONG:"])),"\ufffd#14\ufffd","\ufffd0\ufffd","\ufffd/#14\ufffd"),["id","acceptConfig",1,"button","is-primary",3,"click"],$localize(Uv||(Uv=Hg(["Accept and start"]))),$localize(Vv||(Vv=Hg(["",":INTERPOLATION: plays first"])),"\ufffd0\ufffd"),$localize(Bv||(Bv=Hg(["you play first"]))),$localize(zv||(zv=Hg(["the first player is selected randomly"]))),$localize(Hv||(Hv=Hg(["One moment..."]))),["proposalSent",""],$localize(Gv||(Gv=Hg(["",":INTERPOLATION: is configuring the game."])),"\ufffd0\ufffd"),$localize($v||($v=Hg(["",":INTERPOLATION: has proposed a configuration to ",":INTERPOLATION_1:."])),"\ufffd0\ufffd","\ufffd1\ufffd")]},template:function(e,t){1&e&&pS(0,Fpe,4,3,"div",0),2&e&&mS("ngIf",t.viewInfo)},directives:[iR,vx,LM,Cx,eR,aM,yx,DM,_x,nR],pipes:[mpe],encapsulation:2});var Bpe=function(){var e=function(){function e(){fy(this,e),this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new LT,this.addTimeToOpponent=new LT,this.cssClasses=e.SAFE_TIME}return dy(e,[{key:"ngOnInit",value:function(){OB(e.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}},{key:"setDuration",value:function(t){if(OB(e.VERBOSE,this.debugName+".set("+t+"ms)"),this.started)throw new Error("Should not set a chrono that has already been started ("+this.debugName+")!");this.isSet=!0,this.changeDuration(t)}},{key:"changeDuration",value:function(e){var t=!1;!1===this.isPaused&&(this.pause(),t=!0),this.remainingMs=e,this.displayDuration(),t&&this.resume()}},{key:"displayDuration",value:function(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}},{key:"start",value:function(){if(OB(e.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),!1===this.isSet)throw new Error("Should not start a chrono that has not been set!");if(this.started)throw new Error("Should not start chrono that has already been started ("+this.debugName+")");this.started=!0,this.resume()}},{key:"resume",value:function(){var t=this;if(OB(e.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),!1===this.isPaused||!1===this.started)throw new Error("Should only resume chrono that are started and paused!");this.startTime=Date.now();var n=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(function(){t.onEndReached()},n),this.countSeconds()}},{key:"onEndReached",value:function(){OB(e.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}},{key:"countSeconds",value:function(){var e=this;this.timeoutHandleSec=window.setTimeout(function(){e.updateShownTime()},1e3)}},{key:"isIdle",value:function(){return!1===this.started||this.isPaused}},{key:"pause",value:function(){if(OB(e.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),!this.started)throw new Error("Should not pause not started chrono ("+this.debugName+")");if(this.isPaused)throw new Error("Should not pause already paused chrono ("+this.debugName+")");this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}},{key:"stop",value:function(){if(OB(e.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),!1===this.started)throw new Error("Should only stop chrono that are started!");this.pause(),this.started=!1,this.isSet=!1}},{key:"isStarted",value:function(){return this.started}},{key:"getTimeClass",value:function(){return!1===this.active?e.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?e.DANGER_TIME_ODD:e.DANGER_TIME_EVEN:e.SAFE_TIME}},{key:"updateShownTime",value:function(){var e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}},{key:"clearTimeouts",value:function(){OB(e.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}},{key:"addTime",value:function(){this.addTimeToOpponent.emit()}},{key:"ngOnDestroy",value:function(){this.clearTimeouts()}}]),e}();return e.VERBOSE=!1,e.DANGER_TIME_EVEN="has-background-danger has-text-white",e.DANGER_TIME_ODD="has-background-warning has-text-white",e.PASSIVE_STYLE="has-text-passive is-italic",e.SAFE_TIME="",e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ck({type:e,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){return[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],$localize(Zv||(Zv=Hg(["Add ",":INTERPOLATION:"])),"\ufffd0\ufffd")]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"p",1),rP(2),RT(3,"number"),wS(),pS(4,Vpe,2,1,"button",2),wS()),2&e&&(mS("ngClass",t.getTimeClass()),DE(2),oP("",t.displayedMinute,":",function(e,t,n,r){var i=Xk(),a=Gk(i,23);return NT(i,xT(i,23)?AT(i,cC(),4,a.transform,n,r,a):a.transform(n,r))}(0,0,t.displayedSec,"2.0-0"),""),DE(2),mS("ngIf",t.canAddTime))},directives:[eR,iR],pipes:[sR],encapsulation:2}),e}(),zpe=["partCreation"],Hpe=["chatComponent"],Gpe=["chronoZeroGlobal"],$pe=["chronoOneGlobal"],Zpe=["chronoZeroTurn"],qpe=["chronoOneTurn"];function Wpe(e,t){if(1&e){var n=SS();CS(0,"app-part-creation",5,6),TS("gameStartNotification",function(e){return eC(n),RS().startGame(e)}),wS()}2&e&&mS("partId",RS().currentPartId)}function jpe(e,t){1&e&&(ES(0),fO(1,40),bS())}function Ype(e,t){if(1&e&&(ES(0),fO(1,41),bS()),2&e){var n=RS(4);DE(1),hO(null==n.currentPlayer?null:n.currentPlayer.name),dO(1)}}function Kpe(e,t){if(1&e&&(CS(0,"p",37),pS(1,jpe,2,0,"ng-container",38),pS(2,Ype,2,1,"ng-template",null,39,XT),wS()),2&e){var n=gS(3),r=RS(3);DE(1),mS("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",n)}}function Qpe(e,t){if(1&e&&(CS(0,"div",33),CS(1,"p",34),fO(2,35),wS(),pS(3,Kpe,4,2,"p",36),wS()),2&e){var n=RS(2);DE(2),hO(n.currentPart.getTurn()+1),dO(2),DE(1),mS("ngIf",!1===n.endGame)}}function Xpe(e,t){if(1&e&&(CS(0,"p",42),rP(1),wS()),2&e){var n=RS(2);mS("ngClass",n.getPlayerNameClass(n.Player.ZERO)),DE(1),iP(n.players[0].get().name)}}function Jpe(e,t){if(1&e&&(CS(0,"p",43),fO(1,44),wS()),2&e){var n=RS(2);DE(1),hO(n.gameComponent.scores.get()[0]),dO(1)}}function ege(e,t){if(1&e&&(CS(0,"p",45),rP(1),wS()),2&e){var n=RS(2);mS("ngClass",n.getPlayerNameClass(n.Player.ONE)),DE(1),iP(n.players[1].get().name)}}function tge(e,t){if(1&e&&(CS(0,"p",46),fO(1,47),wS()),2&e){var n=RS(2);DE(1),hO(n.gameComponent.scores.get()[1]),dO(1)}}function nge(e,t){if(1&e){var n=SS();CS(0,"button",56),TS("click",function(){return eC(n),RS(3).resign()}),fO(1,57),wS()}}function rge(e,t){if(1&e){var n=SS();CS(0,"button",58),TS("click",function(){return eC(n),RS(3).proposeDraw()}),fO(1,59),wS()}}function ige(e,t){if(1&e){var n=SS();CS(0,"button",60),TS("click",function(){return eC(n),RS(3).acceptDraw()}),fO(1,61),wS()}}function age(e,t){if(1&e){var n=SS();CS(0,"button",62),TS("click",function(){return eC(n),RS(3).refuseDraw()}),fO(1,63),wS()}}function oge(e,t){if(1&e){var n=SS();CS(0,"button",64),TS("click",function(){return eC(n),RS(3).gameComponent.pass()}),fO(1,65),wS()}}function sge(e,t){if(1&e){var n=SS();CS(0,"button",66),TS("click",function(){return eC(n),RS(3).acceptTakeBack()}),fO(1,67),wS()}}function uge(e,t){if(1&e){var n=SS();CS(0,"button",68),TS("click",function(){return eC(n),RS(3).refuseTakeBack()}),fO(1,69),wS()}}function cge(e,t){if(1&e){var n=SS();CS(0,"button",70),TS("click",function(){return eC(n),RS(3).askTakeBack()}),fO(1,71),wS()}}function lge(e,t){if(1&e&&(ES(0),pS(1,nge,2,0,"button",48),pS(2,rge,2,0,"button",49),pS(3,ige,2,0,"button",50),pS(4,age,2,0,"button",51),pS(5,oge,2,0,"button",52),pS(6,sge,2,0,"button",53),pS(7,uge,2,0,"button",54),pS(8,cge,2,0,"button",55),bS()),2&e){var n=RS(2);DE(1),mS("ngIf",n.canResign()),DE(1),mS("ngIf",n.canProposeDraw()),DE(1),mS("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),DE(1),mS("ngIf",!1===n.endGame&&n.isOpponentWaitingForDrawResponse()),DE(1),mS("ngIf",!1===n.endGame&&n.isPlaying()&&n.gameComponent.canPass&&(null==n.currentPlayer?null:n.currentPlayer.name)===n.getPlayer().name),DE(1),mS("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),DE(1),mS("ngIf",!1===n.endGame&&n.isOpponentWaitingForTakeBackResponse()),DE(1),mS("ngIf",!1===n.endGame&&!1===n.isOpponentWaitingForTakeBackResponse()&&n.canAskTakeBack())}}function fge(e,t){1&e&&(CS(0,"div"),CS(1,"p",73),fO(2,74),wS(),wS())}function hge(e,t){1&e&&(CS(0,"p",78),fO(1,79),wS())}function dge(e,t){1&e&&(CS(0,"p",80),fO(1,81),wS())}function vge(e,t){1&e&&(CS(0,"p",82),fO(1,83),wS())}function pge(e,t){if(1&e&&(CS(0,"div"),pS(1,hge,2,0,"p",75),pS(2,dge,2,0,"p",76),pS(3,vge,2,0,"p",77),wS()),2&e){var n=RS(3);DE(1),mS("ngIf",n.currentPart.getDrawAccepter().name===n.getPlayer().name),DE(1),mS("ngIf",n.currentPart.getDrawAccepter().name!==n.getPlayer().name&&n.isPlaying()),DE(1),mS("ngIf",!1===n.isPlaying())}}function gge(e,t){1&e&&(CS(0,"p",86),fO(1,87),wS())}function yge(e,t){1&e&&(CS(0,"p",88),fO(1,89),wS())}function mge(e,t){if(1&e&&(CS(0,"p",88),fO(1,90),wS()),2&e){var n=RS(4);DE(1),hO(n.currentPart.getWinner().get().name),dO(1)}}function kge(e,t){if(1&e&&(CS(0,"div"),pS(1,gge,2,0,"p",84),pS(2,yge,2,0,"p",85),pS(3,mge,2,1,"p",85),wS()),2&e){var n=RS(3);DE(1),mS("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),DE(1),mS("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),DE(1),mS("ngIf",!1===n.isPlaying())}}function Cge(e,t){if(1&e&&(CS(0,"p",86),fO(1,91),wS()),2&e){var n=RS(4);DE(1),hO(n.currentPart.getLoser().get().name),dO(1)}}function wge(e,t){1&e&&(CS(0,"p",88),fO(1,92),wS())}function _ge(e,t){if(1&e&&(CS(0,"p",88),fO(1,93),wS()),2&e){var n=RS(4);DE(1),hO(n.currentPart.getLoser().get().name),dO(1)}}function Ege(e,t){if(1&e&&(CS(0,"div"),pS(1,Cge,2,1,"p",84),pS(2,wge,2,0,"p",85),pS(3,_ge,2,1,"p",85),wS()),2&e){var n=RS(3);DE(1),mS("ngIf",n.currentPart.getWinner().get().name===n.getPlayer().name),DE(1),mS("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),DE(1),mS("ngIf",!1===n.isPlaying())}}function bge(e,t){1&e&&(CS(0,"p",95),fO(1,96),wS())}function Sge(e,t){if(1&e&&(CS(0,"p",95),fO(1,97),wS()),2&e){var n=RS(4);DE(1),hO(n.currentPart.getLoser().get().name),dO(1)}}function Pge(e,t){if(1&e&&(CS(0,"div"),pS(1,bge,2,0,"p",94),pS(2,Sge,2,1,"p",94),wS()),2&e){var n=RS(3);DE(1),mS("ngIf",n.currentPart.getWinner().get().name!==n.getPlayer().name&&n.isPlaying()),DE(1),mS("ngIf",!1===n.isPlaying()||n.currentPart.getWinner().get().name===n.getPlayer().name)}}function Oge(e,t){if(1&e&&(CS(0,"div",72),_S(1,"hr"),pS(2,fge,3,0,"div",26),pS(3,pge,4,3,"div",26),pS(4,kge,4,3,"div",26),pS(5,Ege,4,3,"div",26),pS(6,Pge,3,2,"div",26),wS()),2&e){var n=RS(2);DE(2),mS("ngIf",n.currentPart.isHardDraw()),DE(1),mS("ngIf",n.currentPart.isAgreedDraw()),DE(1),mS("ngIf",n.currentPart.isWin()),DE(1),mS("ngIf",n.currentPart.isTimeout()),DE(1),mS("ngIf",n.currentPart.isResign())}}function Tge(e,t){1&e&&(CS(0,"button",98),fO(1,99),wS())}function Ige(e,t){if(1&e){var n=SS();CS(0,"button",100),TS("click",function(){return eC(n),RS(2).proposeRematch()}),fO(1,101),wS()}}function Age(e,t){if(1&e){var n=SS();CS(0,"button",102),TS("click",function(){return eC(n),RS(2).acceptRematch()}),fO(1,103),wS()}}function Rge(e,t){if(1&e){var n=SS();CS(0,"div",7),CS(1,"div",8),CS(2,"div",9),pS(3,Qpe,4,2,"div",10),CS(4,"div",11),pS(5,Xpe,2,2,"p",12),pS(6,Jpe,2,1,"p",13),CS(7,"app-count-down",14,15),TS("outOfTimeAction",function(){eC(n);var e=RS();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return eC(n),RS().addGlobalTime()}),wS(),CS(9,"app-count-down",16,17),TS("outOfTimeAction",function(){eC(n);var e=RS();return e.reachedOutOfTime(e.Player.ZERO)})("addTimeToOpponent",function(){return eC(n),RS().addTurnTime()}),wS(),wS(),CS(11,"p",18),fO(12,19),wS(),CS(13,"div",11),pS(14,ege,2,2,"p",20),pS(15,tge,2,1,"p",21),CS(16,"app-count-down",22,23),TS("outOfTimeAction",function(){eC(n);var e=RS();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return eC(n),RS().addGlobalTime()}),wS(),CS(18,"app-count-down",24,25),TS("outOfTimeAction",function(){eC(n);var e=RS();return e.reachedOutOfTime(e.Player.ONE)})("addTimeToOpponent",function(){return eC(n),RS().addTurnTime()}),wS(),wS(),_S(20,"hr"),pS(21,lge,9,8,"ng-container",26),pS(22,Oge,7,5,"div",27),pS(23,Tge,2,0,"button",28),pS(24,Ige,2,0,"button",29),pS(25,Age,2,0,"button",30),wS(),wS(),CS(26,"div",31),CS(27,"div",32),_S(28,"app-game-includer"),wS(),wS(),wS()}if(2&e){var r=RS();DE(3),mS("ngIf",r.currentPart),DE(2),mS("ngIf",r.players[0].isPresent()),DE(1),mS("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),DE(1),mS("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),DE(2),mS("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==0)("canAddTime",r.role===r.Player.ONE&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),DE(5),mS("ngIf",r.players[1].isPresent()),DE(1),mS("ngIf",r.currentPart&&r.gameComponent&&r.gameComponent.scores.isPresent()),DE(1),mS("dangerTimeLimit",6e4)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.globalTimeMessage),DE(2),mS("dangerTimeLimit",15e3)("active",null!=r.currentPart&&r.currentPart.getTurn()%2==1)("canAddTime",r.role===r.Player.ZERO&&!1===r.endGame)("timeToAdd",r.turnTimeMessage),DE(3),mS("ngIf",r.isPlaying()),DE(1),mS("ngIf",r.endGame),DE(1),mS("ngIf",r.endGame),DE(1),mS("ngIf",r.endGame&&r.isPlaying()&&!1===r.rematchProposed),DE(1),mS("ngIf",r.endGame&&r.isPlaying()&&r.rematchProposed&&r.opponentProposedRematch),DE(1),mS("ngClass",r.getBoardHighlight())}}var Mge=function(){var e=dy(function e(){fy(this,e)});return e.NO_MATCHING_PART=function(){return $localize(qv||(qv=Hg(["The game you tried to join does not exist."])))},e}(),xge=dy(function e(t){fy(this,e),this.value=t});xge.PRE_START_DOC=new xge("PRE_START_DOC"),xge.STARTING_DOC=new xge("STARTING_DOC"),xge.DUPLICATE=new xge("DUPLICATE"),xge.MOVE_WITHOUT_TIME=new xge("MOVE_WITHOUT_TIME"),xge.MOVE=new xge("MOVE"),xge.REQUEST=new xge("REQUEST"),xge.END_GAME=new xge("END_GAME"),xge.END_GAME_WITHOUT_TIME=new xge("END_GAME_WITHOUT_TIME"),xge.ACCEPT_TAKE_BACK_WITHOUT_TIME=new xge("ACCEPT_TAKE_BACK_WITHOUT_TIME");var Nge=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s,u){var c;return fy(this,n),(c=t.call(this,e,r,o,i,a)).userService=s,c.gameService=u,c.gameStarted=!1,c.opponent=null,c.rematchProposed=!1,c.opponentProposedRematch=!1,c.hasUserPlayed=[!1,!1],c.msToSubstract=[0,0],c.opponentSubscription=new hy,c.partSubscription=new hy,c.OFFLINE_FONT_COLOR={color:"lightgrey"},c.globalTimeMessage=$localize(Wv||(Wv=Hg(["5 minutes"]))),c.turnTimeMessage=$localize(jv||(jv=Hg(["30 seconds"]))),OB(n.VERBOSE,"OnlineGameWrapperComponent constructed"),c}return dy(n,[{key:"extractPartIdFromURL",value:function(){return PB.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}},{key:"extractGameNameFromURL",value:function(){return PB.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}},{key:"isPlaying",value:function(){return this.role.isPlayer()}},{key:"getPlayer",value:function(){return this.authUser.toMinimalUser()}},{key:"isPlayer",value:function(e){return this.role===e}},{key:"isOpponent",value:function(e){return this.role!==e}},{key:"redirectIfPartOrGameIsInvalid",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.extractGameNameFromURL(),!Ive.ALL_GAMES().some(function(e){return e.urlName===n})){t.next=11;break}return t.next=4,e.gameService.getPartValidity(e.currentPartId,n);case 4:if(!t.sent.isFailure()){t.next=9;break}return e.routerEventsSub.unsubscribe(),r=Mge.NO_MATCHING_PART(),t.next=9,e.router.navigate(["/notFound",r],{skipLocationChange:!0});case 9:t.next=15;break;case 11:return e.routerEventsSub.unsubscribe(),i=hpe.NO_MATCHING_GAME(n),t.next=15,e.router.navigate(["/notFound",i],{skipLocationChange:!0});case 15:case"end":return t.stop()}},t)}))()}},{key:"setCurrentPartIdOrRedirect",value:function(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}},{key:"ngOnInit",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return OB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSub=e.router.events.subscribe(function(){var t=SB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=n instanceof zN,!t.t0){t.next=4;break}return t.next=4,e.setCurrentPartIdOrRedirect();case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),e.userSub=e.connectedUserService.subscribeToUser(function(t){e.authUser=t}),t.next=5,e.setCurrentPartIdOrRedirect();case 5:OB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done");case 6:case"end":return t.stop()}},t)}))()}},{key:"startGame",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:OB(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),N7(!1===t.gameStarted,"Should not start already started game"),t.configRoom=e,t.gameStarted=!0,window.setTimeout(SB(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=N7,e.next=3,t.afterGameIncluderViewInit();case 3:e.t1=e.sent,(0,e.t0)(e.t1,"Game should be created successfully, otherwise part-creation would have redirected"),t.startPart();case 6:case"end":return e.stop()}},e)})),1);case 1:case"end":return r.stop()}},r)}))()}},{key:"startPart",value:function(){var e,t=this;OB(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,(e=SB(regeneratorRuntime.mark(function e(n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return N7(n.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),e.next=3,t.onCurrentPartUpdate(n.get());case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)}))}},{key:"onCurrentPartUpdate",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:i=new H7(t.currentPartId,e),OB(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:t.currentPart,then:e.data,before_part_turn:i.data.turn,before_state_turn:t.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),a=t.getUpdateType(i),o=e.turn,OB(n.VERBOSE,a===xge.REQUEST?"UpdateType: Request("+PB.getNonNullable(i.data.request).code+") ("+o+")":"UpdateType: "+a.value+"("+o+")"),s=t.currentPart,r.t0=(t.currentPart=i,a),r.next=r.t0===xge.REQUEST?8:r.t0===xge.ACCEPT_TAKE_BACK_WITHOUT_TIME?11:r.t0===xge.DUPLICATE?12:r.t0===xge.END_GAME_WITHOUT_TIME?13:r.t0===xge.END_GAME?14:r.t0===xge.MOVE_WITHOUT_TIME?15:r.t0===xge.MOVE?16:r.t0===xge.PRE_START_DOC?17:19;break;case 8:return r.next=10,t.onRequest(PB.getNonNullable(i.data.request),s);case 10:return r.abrupt("return",r.sent);case 11:case 13:case 15:return r.abrupt("return",void(t.currentPart=s));case 12:return r.abrupt("return");case 14:return r.abrupt("return",t.applyEndGame());case 16:return r.abrupt("return",(t.msToSubstract=t.getLastUpdateTime(s,i,a),t.doNewMoves(i)));case 17:return u=null==t.currentPart||null!=t.currentPart.data.beginning,r.abrupt("return",void N7(null==s||null==s.data.beginning||u,"old part had no beginning time or new part has, we did not expect this!"));case 19:return r.abrupt("return",(N7(a===xge.STARTING_DOC,"Unexpected update type "+a),t.setChronos(),t.setPlayersDatas(i),t.startCountDownFor(Q7.ZERO)));case 20:case"end":return r.stop()}},r)}))()}},{key:"getUpdateType",value:function(e){var t=vpe.from(null!=this.currentPart?this.currentPart.data:null,e.data);OB(n.VERBOSE,{diff:t});var r=t.countChanges();if(0===r)return xge.DUPLICATE;if(e.data.request){var i=null!=t.removed.lastUpdateTime;return"TakeBackAccepted"===e.data.request.code&&i?xge.ACCEPT_TAKE_BACK_WITHOUT_TIME:xge.REQUEST}if(this.isMove(t,r))return 1===e.data.turn?null==e.data.lastUpdateTime?xge.MOVE_WITHOUT_TIME:xge.MOVE:null==t.modified.lastUpdateTime?xge.MOVE_WITHOUT_TIME:xge.MOVE;if(null==e.data.beginning)return xge.PRE_START_DOC;if(e.data.result!==z7.UNACHIEVED.value){var a=null==t.modified.lastUpdateTime;return null!=t.modified.turn&&a?xge.END_GAME_WITHOUT_TIME:xge.END_GAME}return N7(null!=e.data.beginning&&0===e.data.listMoves.length,"Unexpected update: "+JSON.stringify(t)),xge.STARTING_DOC}},{key:"isMove",value:function(e,t){if(null!=e.modified.listMoves&&null!=e.modified.turn){return t===(e.isPresent("lastUpdateTime").present?1:0)+(e.isPresent("scorePlayerZero").present?1:0)+(e.isPresent("scorePlayerOne").present?1:0)+(e.isPresent("remainingMsForZero").present?1:0)+(e.isPresent("remainingMsForOne").present?1:0)+(null==e.removed.request?0:1)+3}return!1}},{key:"getLastUpdateTime",value:function(e,t,n){var r=this.getMoreRecentTime(e),i=this.getMoreRecentTime(t);N7(null!=r,"oldTime should not be null"),N7(null!=i,"updateTime should not be null");var a=Q7.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(PB.getNonNullable(r),PB.getNonNullable(i),n,a)}},{key:"getMoreRecentTime",value:function(e){var t;return null!==(t=e.data.lastUpdateTime)&&void 0!==t?t:e.data.beginning}},{key:"getTimeUsedForLastTurn",value:function(e,t,n,r){var i=gpe(e,t),a=[0,0];return a[r.value]=i,a}},{key:"setChronos",value:function(){OB(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}},{key:"didUserPlay",value:function(e){return this.hasUserPlayed[e.value]}},{key:"doNewMoves",value:function(e){OB(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"),this.switchPlayer();for(var t=t9.copyImmutableArray(e.data.listMoves),r=this.gameComponent.rules;r.node.gameState.turn<t.length;){var i=r.node.gameState.turn,a=this.gameComponent.encoder.decode(t[i]),o=r.isLegal(a,r.node.gameState),s="We received an incorrect db move: "+a.toString()+" in "+t+" at turn "+i+'because "'+o.getReasonOr("")+'"';N7(o.isSuccess(),s),r.choose(a)}this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get(),this.gameComponent.updateBoard()}},{key:"switchPlayer",value:function(){OB(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");var e=Q7.fromTurn(this.currentPart.data.turn);this.currentPlayer=this.players[this.gameComponent.rules.node.gameState.turn%2].get();var t=e.getOpponent();this.didUserPlay(t)&&this.pauseCountDownsFor(t),this.didUserPlay(e)?(OB(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(e)):this.startCountDownFor(e)}},{key:"resetChronoFor",value:function(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}},{key:"applyEndGame",value:function(){var e=this.currentPart,t=Q7.fromTurn(e.data.turn);this.endGame=!0,[z7.VICTORY,z7.HARD_DRAW].some(function(t){return t.value===e.data.result})?this.doNewMoves(this.currentPart):(N7(!0===[z7.RESIGN,z7.TIMEOUT,z7.HARD_DRAW,z7.AGREED_DRAW_BY_ZERO,z7.AGREED_DRAW_BY_ONE].some(function(t){return t.value===e.data.result}),"Unknown type of end game ("+e.data.result+")"),OB(n.VERBOSE,"endGame est true et winner est "+e.getWinner())),this.stopCountdownsFor(t)}},{key:"notifyDraw",value:function(e,t){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!0)}},{key:"notifyTimeoutVictory",value:function(e,t,n,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i.endGame=!0,o=i.currentPart.setWinnerAndLoser(e,r),i.currentPart=o,a.next=5,i.gameService.notifyTimeout(i.currentPartId,t,n,e,r);case 5:case"end":return a.stop()}},a)}))()}},{key:"notifyVictory",value:function(e,t){OB(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");var r=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);return r===Lte.ONE_WON?this.currentPart=this.currentPart.setWinnerAndLoser(this.players[1].get(),this.players[0].get()):(N7(r===Lte.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=this.currentPart.setWinnerAndLoser(this.players[0].get(),this.players[1].get())),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],t,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}},{key:"canAskTakeBack",value:function(){return N7(this.isPlaying(),"Non playing should not call canAskTakeBack"),!(null==this.currentPart||this.currentPart.data.turn<=this.role.value||this.currentPart.data.request&&"TakeBackRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&this.currentPart.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===K7.NONE}},{key:"isOpponentWaitingForTakeBackResponse",value:function(){var e=this.getTakeBackRequester();return!!e.isPlayer()&&this.isOpponent(e)}},{key:"getTakeBackRequester",value:function(){if(null==this.currentPart)return K7.NONE;var e=this.currentPart.data.request;return e&&"TakeBackAsked"===e.code?X7.getPlayer(e):K7.NONE}},{key:"canProposeDraw",value:function(){return N7(this.isPlaying(),"Non playing should not call canProposeDraw"),!(this.endGame||null==this.currentPart||this.currentPart.data.request&&"DrawRefused"===this.currentPart.data.request.code&&this.role.isPlayer()&&X7.getPlayer(this.currentPart.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===K7.NONE}},{key:"isOpponentWaitingForDrawResponse",value:function(){var e=this.getDrawRequester();return e!==K7.NONE&&this.isOpponent(e)}},{key:"getDrawRequester",value:function(){if(null==this.currentPart)return K7.NONE;var e=this.currentPart.data.request;return e&&"DrawProposed"===e.code?X7.getPlayer(e):K7.NONE}},{key:"onRequest",value:function(e,t){var r=this;return SB(regeneratorRuntime.mark(function i(){var a,o,s;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=(OB(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:t}),e.code),i.next="TakeBackAsked"===i.t0||"TakeBackRefused"===i.t0||"DrawProposed"===i.t0||"DrawRefused"===i.t0?3:"TakeBackAccepted"===i.t0?4:"RematchProposed"===i.t0?6:"RematchAccepted"===i.t0?10:"AddTurnTime"===i.t0?15:"AddGlobalTime"===i.t0?18:21;break;case 3:case 14:return i.abrupt("break",24);case 4:return r.takeBackTo(r.currentPart.data.turn),i.abrupt("break",24);case 6:return r.rematchProposed=!0,a=X7.getPlayer(e).getOpponent(),r.isPlayer(a)&&(OB(n.VERBOSE,"ton adversaire te propose une revanche"),r.opponentProposedRematch=!0),i.abrupt("break",24);case 10:return i.next=12,r.router.navigate(["/nextGameLoading"]);case 12:return i.next=14,r.router.navigate(["/play",X7.getTypeGame(e),X7.getPartId(e)]);case 15:return 3e4,o=Q7.of(e.data.player),r.addTurnTimeTo(o,3e4),i.abrupt("break",24);case 18:return 3e5,s=Q7.of(e.data.player),r.addGlobalTimeTo(s,3e5),i.abrupt("break",24);case 21:return PB.expectToBe(e.code,"DrawAccepted","Unknown RequestType : "+e.code+" for "+JSON.stringify(e)),i.next=24,r.acceptDraw();case 24:case"end":return i.stop()}},i)}))()}},{key:"takeBackTo",value:function(e){if(OB(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.rules.node.gameState.turn===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();var t=Q7.fromTurn(e);this.resetChronoFor(t)}this.gameComponent.updateBoard()}},{key:"setPlayersDatas",value:function(e){var t=this;OB(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),this.players=[RB.of(e.data.playerZero),RB.ofNullable(e.data.playerOne)],N7(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),this.currentPlayer=this.players[e.data.turn%2].get();var r=RB.empty();if(this.players[0].get().id===this.authUser.id?(this.setRole(Q7.ZERO),r=this.players[1]):this.players[1].get().id===this.authUser.id?(this.setRole(Q7.ONE),r=this.players[0]):this.setRole(K7.NONE),r.isPresent()){this.opponentSubscription=this.userService.observeUser(r.get().id,function(e){N7(e.isPresent(),"opponent was deleted, what sorcery is this"),t.opponent={id:r.get().id,name:PB.getNonNullable(e.get().username)}})}}},{key:"onLegalUserMove",value:function(e,t){var r=this;return SB(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(OB(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),r.isOpponentWaitingForTakeBackResponse()){i.next=2;break}return i.abrupt("return",r.updateDBBoard(e,r.msToSubstract,t));case 2:r.gameComponent.message("You must answer to take back request");case 3:case"end":return i.stop()}},i)}))()}},{key:"updateDBBoard",value:function(e,t,r){var i=this;return SB(regeneratorRuntime.mark(function a(){var o,s;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return o=i.gameComponent.encoder.encodeMove(e),OB(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+r+")"),i.gameComponent.rules.choose(e),s=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node),a.abrupt("return",s.isEndGame?s===Lte.DRAW?i.notifyDraw(o,r):i.notifyVictory(o,r):i.gameService.updateDBBoard(i.currentPartId,i.role,o,t,r));case 4:case"end":return a.stop()}},a)}))()}},{key:"resign",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return OB(n.VERBOSE,"OnlineGameWrapperComponent.resign"),r=e.getLastIndex(),i=e.role,a=e.getPlayer(),o=e.players[(e.role.value+1)%2].get(),t.next=4,e.gameService.resign(e.currentPartId,r,i,o,a);case 4:case"end":return t.stop()}},t)}))()}},{key:"getLastIndex",value:function(){return this.currentPart.data.lastUpdate.index}},{key:"reachedOutOfTime",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(OB(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")"),i=t.getLastIndex(),a=t.role,t.stopCountdownsFor(e),e!==t.role){r.next=8;break}return o=PB.getNonNullable(t.opponent),r.next=6,t.notifyTimeoutVictory(o,a,i,t.authUser.toMinimalUser());case 6:r.next=13;break;case 8:if(N7(!1===t.endGame,"time might be better handled in the future"),!t.opponentIsOffline()){r.next=13;break}return s=PB.getNonNullable(t.opponent),r.next=12,t.notifyTimeoutVictory(t.authUser.toMinimalUser(),a,e.value,s);case 12:t.endGame=!0;case 13:case"end":return r.stop()}},r)}))()}},{key:"acceptRematch",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(e.isPlaying(),"Non playing should not call acceptRematch"),n=new H7(e.currentPartId,e.currentPart.data),t.next=4,e.gameService.acceptRematch(n,e.getLastIndex(),e.role);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}},t)}))()}},{key:"proposeRematch",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(e.isPlaying(),"Non playing should not call proposeRematch"),t.next=3,e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role);case 3:return t.abrupt("return",!0);case 4:case"end":return t.stop()}},t)}))()}},{key:"proposeDraw",value:function(){return N7(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptDraw",value:function(){return N7(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"refuseDraw",value:function(){return N7(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}},{key:"askTakeBack",value:function(){return N7(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"acceptTakeBack",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(e.isPlaying(),"Non playing should not call acceptTakeBack"),n=e.role,t.next=4,e.gameService.acceptTakeBack(e.currentPartId,e.currentPart,n,e.msToSubstract);case 4:e.msToSubstract=[0,0];case 5:case"end":return t.stop()}},t)}))()}},{key:"refuseTakeBack",value:function(){return N7(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}},{key:"startCountDownFor",value:function(e){OB(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),this.hasUserPlayed[e.value]=!0,e===Q7.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}},{key:"resumeCountDownFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];OB(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===Q7.ZERO?(this.chronoZeroGlobal.changeDuration(PB.getNonNullable(this.currentPart.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),t=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(PB.getNonNullable(this.currentPart.data.remainingMsForOne)),this.chronoOneGlobal.resume(),t=this.chronoOneTurn),r?(t.setDuration(1e3*this.configRoom.maximalMoveDuration),t.start()):t.resume()}},{key:"pauseCountDownsFor",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];OB(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart.data.turn+")"),e===Q7.ZERO?(this.chronoZeroGlobal.pause(),t=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),t=this.chronoOneTurn),r?t.stop():t.pause()}},{key:"stopCountdownsFor",value:function(e){OB(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart.data.turn+")"),e===Q7.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}},{key:"getPlayerNameClass",value:function(e){return this.opponentIsOffline()?"has-text-grey-light":e===Q7.ZERO?"has-text-white":"has-text-black"}},{key:"opponentIsOffline",value:function(){return!1}},{key:"canResign",value:function(){return N7(this.isPlaying(),"Non playing should not call canResign"),!(!0===this.endGame||null==this.opponent)}},{key:"addGlobalTime",value:function(){var e=this.role,t=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,t,this.currentPart.data,e)}},{key:"addTurnTime",value:function(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}},{key:"addTurnTimeTo",value:function(e,t){var n=Q7.fromTurn(this.currentPart.getTurn());this.pauseCountDownsFor(n,!1),e===Q7.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+t):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+t),this.resumeCountDownFor(n,!1)}},{key:"addGlobalTimeTo",value:function(e,t){e===Q7.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+t):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+t)}},{key:"ngOnDestroy",value:function(){OB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),this.routerEventsSub.unsubscribe(),this.userSub.unsubscribe(),!0===this.gameStarted&&(this.opponentSubscription.unsubscribe(),this.partSubscription.unsubscribe()),OB(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")}}]),n}(dpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(bO),yS(WD),yS(vF),yS(M7),yS(B7),yS(L7),yS(o9))},e.\u0275cmp=ck({type:e,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,t){var n;(1&e&&(YT(zpe,5),YT(Hpe,5),YT(Gpe,5),YT($pe,5),YT(Zpe,5),YT(qpe,5)),2&e)&&(jT(n=KT())&&(t.partCreation=n.first),jT(n=KT())&&(t.chatComponent=n.first),jT(n=KT())&&(t.chronoZeroGlobal=n.first),jT(n=KT())&&(t.chronoOneGlobal=n.first),jT(n=KT())&&(t.chronoZeroTurn=n.first),jT(n=KT())&&(t.chronoOneTurn=n.first))},features:[Qb],decls:5,vars:4,consts:function(){return[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],$localize(Yv||(Yv=Hg(["vs."]))),["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Kv||(Kv=Hg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],$localize(Qv||(Qv=Hg(["It is your turn."]))),$localize(Xv||(Xv=Hg(["It is ",":INTERPOLATION:'s turn."])),"\ufffd0\ufffd"),["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],$localize(Jv||(Jv=Hg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],$localize(ep||(ep=Hg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(tp||(tp=Hg(["Resign"]))),["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(np||(np=Hg(["Propose a draw"]))),["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(rp||(rp=Hg(["Accept draw"]))),["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(ip||(ip=Hg(["Reject draw"]))),["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(ap||(ap=Hg(["Pass a turn"]))),["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(op||(op=Hg(["Accept take back"]))),["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],$localize(sp||(sp=Hg(["Reject take back"]))),["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],$localize(up||(up=Hg(["Ask to take back one move"]))),["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],$localize(cp||(cp=Hg(["Draw"]))),["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],$localize(lp||(lp=Hg(["You agreed to draw."]))),["id","yourOpponentAgreedToDrawIndicator",1,"title"],$localize(fp||(fp=Hg(["Your draw proposal has been accepted."]))),["id","playersAgreedToDraw",1,"title"],$localize(hp||(hp=Hg(["Players agreed to draw."]))),["class","title","id","youWonIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],$localize(dp||(dp=Hg(["You won."]))),[1,"title"],$localize(vp||(vp=Hg(["You lost."]))),$localize(pp||(pp=Hg(["",":INTERPOLATION: won."])),"\ufffd0\ufffd"),$localize(gp||(gp=Hg(["",":INTERPOLATION: has reached their time limit. You won."])),"\ufffd0\ufffd"),$localize(yp||(yp=Hg(["You reached your time limit."]))),$localize(mp||(mp=Hg(["",":INTERPOLATION: has reached their time limit."])),"\ufffd0\ufffd"),["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],$localize(kp||(kp=Hg(["You resigned."]))),$localize(Cp||(Cp=Hg(["",":INTERPOLATION: has resigned."])),"\ufffd0\ufffd"),["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],$localize(wp||(wp=Hg(["Go back to the game list"]))),["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],$localize(_p||(_p=Hg(["Propose to play again"]))),["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],$localize(Ep||(Ep=Hg(["Accept to play again"])))]},template:function(e,t){1&e&&(pS(0,Wpe,2,1,"app-part-creation",0),pS(1,Rge,29,27,"div",1),CS(2,"div",2),CS(3,"div",3),_S(4,"app-chat",4),wS(),wS()),2&e&&(mS("ngIf",!1===t.gameStarted),DE(1),mS("ngIf",t.gameStarted),DE(3),mS("chatId",t.currentPartId)("turn",null==t.currentPart?null:t.currentPart.getTurn()))},directives:[iR,Jve,Upe,Bpe,eR,fpe,gF],encapsulation:2}),e}();function Dge(e,t){if(1&e&&(CS(0,"option",25),rP(1),wS()),2&e){var n=t.$implicit;mS("value",n.name),DE(1),iP(n.name)}}function Lge(e,t){if(1&e&&(CS(0,"option",25),fO(1,29),wS()),2&e){var n=t.$implicit;mS("value",n),DE(1),hO(n),dO(1)}}var Fge=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function Uge(e,t){if(1&e){var n=SS();CS(0,"select",26),TS("ngModelChange",function(e){return eC(n),RS(2).aiDepths[0]=e})("change",function(){eC(n);var e=RS(2);return e.updatePlayer(e.Player.ZERO)}),CS(1,"option",27),fO(2,28),wS(),pS(3,Lge,2,2,"option",16),wS()}2&e&&(mS("ngModel",RS(2).aiDepths[0]),DE(3),mS("ngForOf",ST(2,Fge)))}function Vge(e,t){if(1&e&&(CS(0,"p",30),fO(1,31),wS()),2&e){var n=RS(2);DE(1),hO(n.gameComponent.scores.get()[0]),dO(1)}}function Bge(e,t){if(1&e&&(CS(0,"option",25),rP(1),wS()),2&e){var n=t.$implicit;mS("value",n.name),DE(1),iP(n.name)}}function zge(e,t){if(1&e&&(CS(0,"option",25),fO(1,34),wS()),2&e){var n=t.$implicit;mS("value",n),DE(1),hO(n),dO(1)}}function Hge(e,t){if(1&e){var n=SS();CS(0,"select",32),TS("ngModelChange",function(e){return eC(n),RS(2).aiDepths[1]=e})("change",function(){eC(n);var e=RS(2);return e.updatePlayer(e.Player.ONE)}),CS(1,"option",27),fO(2,33),wS(),pS(3,zge,2,2,"option",16),wS()}2&e&&(mS("ngModel",RS(2).aiDepths[1]),DE(3),mS("ngForOf",ST(2,Fge)))}function Gge(e,t){if(1&e&&(CS(0,"p",35),fO(1,36),wS()),2&e){var n=RS(2);DE(1),hO(n.gameComponent.scores.get()[1]),dO(1)}}function $ge(e,t){if(1&e&&(CS(0,"h4"),fO(1,40),wS()),2&e){var n=RS(3);DE(1),hO(n.winner.get()),dO(1)}}function Zge(e,t){1&e&&(CS(0,"h4",41),fO(1,42),wS())}function qge(e,t){if(1&e&&(CS(0,"div",37),pS(1,$ge,2,1,"h4",38),pS(2,Zge,2,0,"h4",39),wS()),2&e){var n=RS(2);DE(1),mS("ngIf",n.winner.isPresent()),DE(1),mS("ngIf",n.winner.isAbsent())}}function Wge(e,t){if(1&e){var n=SS();CS(0,"div",6),CS(1,"div",7),CS(2,"p",8),fO(3,9),wS(),wS(),CS(4,"div",10),CS(5,"div",11),CS(6,"div",12),CS(7,"select",13),TS("change",function(){eC(n);var e=RS();return e.updatePlayer(e.Player.ZERO)})("ngModelChange",function(e){return eC(n),RS().playerSelection[0]=e}),CS(8,"option",14),fO(9,15),wS(),pS(10,Dge,2,2,"option",16),wS(),wS(),CS(11,"div",12),pS(12,Uge,4,3,"select",17),wS(),pS(13,Vge,2,1,"p",18),wS(),CS(14,"div",19),CS(15,"div",12),CS(16,"select",20),TS("change",function(){eC(n);var e=RS();return e.updatePlayer(e.Player.ONE)})("ngModelChange",function(e){return eC(n),RS().playerSelection[1]=e}),CS(17,"option",14),fO(18,21),wS(),pS(19,Bge,2,2,"option",16),wS(),wS(),CS(20,"div",12),pS(21,Hge,4,3,"select",22),wS(),pS(22,Gge,2,1,"p",23),wS(),wS(),pS(23,qge,3,2,"div",24),wS()}if(2&e){var r=RS();DE(3),hO(r.gameComponent.rules.node.gameState.turn+1),dO(3),DE(4),mS("ngModel",r.playerSelection[0]),DE(3),mS("ngForOf",r.gameComponent.availableMinimaxes),DE(2),mS("ngIf",!1===r.players[0].equalsValue("human")),DE(1),mS("ngIf",r.gameComponent.scores.isPresent()),DE(3),mS("ngModel",r.playerSelection[1]),DE(3),mS("ngForOf",r.gameComponent.availableMinimaxes),DE(2),mS("ngIf",!1===r.players[1].equalsValue("human")),DE(1),mS("ngIf",r.gameComponent.scores.isPresent()),DE(1),mS("ngIf",r.endGame)}}function jge(e,t){if(1&e&&(ES(0),rP(1),_S(2,"br"),bS()),2&e){var n=t.$implicit,r=RS(3);DE(1),aP(" ",n.name+": "+n.getBoardValue(r.gameComponent.rules.node)," ")}}function Yge(e,t){if(1&e&&(ES(0),pS(1,jge,3,1,"ng-container",48),rP(2),_S(3,"br"),rP(4),_S(5,"br"),bS()),2&e){var n=RS(2);DE(1),mS("ngForOf",n.gameComponent.availableMinimaxes),DE(1),aP(" Created ",n.getCreatedNodes()," nodes."),DE(2),aP(" Minimax time: ",n.getMinimaxTime(),"ms.")}}function Kge(e,t){if(1&e){var n=SS();CS(0,"button",49),TS("click",function(){return eC(n),RS(2).gameComponent.pass()}),fO(1,50),wS()}}function Qge(e,t){if(1&e){var n=SS();CS(0,"button",51),TS("click",function(){return eC(n),RS(2).takeBack()}),fO(1,52),wS()}}function Xge(e,t){if(1&e){var n=SS();CS(0,"div",43),pS(1,Yge,6,3,"ng-container",38),pS(2,Kge,2,0,"button",44),pS(3,Qge,2,0,"button",45),CS(4,"button",46),TS("click",function(){return eC(n),RS().restartGame()}),fO(5,47),wS(),wS()}if(2&e){var r=RS();DE(1),mS("ngIf",r.gameComponent.rules.node.move),DE(1),mS("ngIf",!1===r.endGame&&r.gameComponent.canPass),DE(1),mS("ngIf",r.canTakeBack())}}var Jge=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,r,i,a,o)).cdr=s,u.aiDepths=["0","0"],u.playerSelection=["human","human"],u.winner=RB.empty(),u.botTimeOut=1e3,u.players=[RB.of(u.playerSelection[0]),RB.of(u.playerSelection[1])],u.role=Q7.ZERO,OB(n.VERBOSE,"LocalGameWrapper.constructor"),u}return dy(n,[{key:"getCreatedNodes",value:function(){return Nte.createdNodes}},{key:"getMinimaxTime",value:function(){return Nte.minimaxTime}},{key:"ngAfterViewInit",value:function(){var e=this;setTimeout(SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.afterGameIncluderViewInit();case 2:if(t.t0=t.sent,!t.t0){t.next=5;break}e.restartGame(),e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)})),1)}},{key:"updatePlayer",value:function(e){this.players[e.value]=RB.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?Q7.ONE:Q7.ZERO),this.proposeAIToPlay()}},{key:"onLegalUserMove",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:OB(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),t.gameComponent.rules.choose(e),t.updateBoard(),t.proposeAIToPlay();case 1:case"end":return r.stop()}},r)}))()}},{key:"updateBoard",value:function(){this.gameComponent.updateBoard();var e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer()&&(this.winner=RB.of($localize(bp||(bp=Hg(["Player ",""])),e.winner.value+1))))}},{key:"proposeAIToPlay",value:function(){var e=this,t=this.getPlayingAI();t.isPresent()&&window.setTimeout(SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.doAIMove(t.get());case 2:case"end":return n.stop()}},n)})),this.botTimeOut)}},{key:"getPlayingAI",value:function(){var e=this;if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return RB.empty();var t=this.gameComponent.rules.node.gameState.turn%2;return"0"===this.aiDepths[t]?RB.empty():RB.ofNullable(this.gameComponent.availableMinimaxes.find(function(n){return e.players[t].isPresent()&&e.players[t].get()===n.name}))}},{key:"doAIMove",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return N7((r=t.gameComponent.rules).getGameStatus(r.node)===Lte.ONGOING,"AI should not try to play when game is over!"),i=Number.parseInt(t.aiDepths[r.node.gameState.turn%2%2]),a=r.node.findBestMove(i,e,!0),n.abrupt("return",r.choose(a)?(t.updateBoard(),t.cdr.detectChanges(),t.proposeAIToPlay(),DB.SUCCESS):(t.messageDisplayer.criticalMessage($localize(Sp||(Sp=Hg(["The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!"])))),x7.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:a.toString()})));case 4:case"end":return n.stop()}},n)}))()}},{key:"canTakeBack",value:function(){return this.gameComponent.rules.node.gameState.turn>0}},{key:"takeBack",value:function(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}},{key:"isAITurn",value:function(){return this.getPlayingAI().isPresent()}},{key:"restartGame",value:function(){var e=this.gameComponent.rules.stateType.getInitialState();this.gameComponent.rules.node=new Dte(e),this.gameComponent.updateBoard(),this.endGame=!1,this.winner=RB.empty(),this.proposeAIToPlay()}},{key:"getPlayer",value:function(){return"human"}}]),n}(dpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(bO),yS(WD),yS(B7),yS(vF),yS(M7),yS(eT))},e.\u0275cmp=ck({type:e,selectors:[["app-local-game-wrapper"]],features:[Qb],decls:7,vars:3,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],$localize(Pp||(Pp=Hg(["Turn n\xb0",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],$localize(Op||(Op=Hg(["Human"]))),[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],$localize(Tp||(Tp=Hg(["Human"]))),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["class","block","id","gameResult",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],$localize(Ip||(Ip=Hg(["Pick the level"]))),$localize(Ap||(Ap=Hg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreOne",1,"block"],$localize(Rp||(Rp=Hg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],$localize(Mp||(Mp=Hg(["Pick the level"]))),$localize(xp||(xp=Hg(["Level ",":INTERPOLATION:"])),"\ufffd0\ufffd"),["id","scoreZero",1,"block"],$localize(Np||(Np=Hg(["",":INTERPOLATION: points"])),"\ufffd0\ufffd"),["id","gameResult",1,"block"],[4,"ngIf"],["id","draw",4,"ngIf"],$localize(Dp||(Dp=Hg(["",":INTERPOLATION: won"])),"\ufffd0\ufffd"),["id","draw"],$localize(Lp||(Lp=Hg(["Draw"]))),[1,"tile","is-child","box","is-vcentered"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],$localize(Fp||(Fp=Hg(["Start a new game"]))),[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],$localize(Up||(Up=Hg(["Pass a turn"]))),["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],$localize(Vp||(Vp=Hg(["Take back move"])))]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"div",1),pS(2,Wge,24,10,"div",2),pS(3,Xge,6,3,"div",3),wS(),CS(4,"div",4),CS(5,"div",5),_S(6,"app-game-includer"),wS(),wS(),wS()),2&e&&(DE(2),mS("ngIf",t.gameComponent),DE(1),mS("ngIf",t.gameComponent),DE(1),mS("ngClass",t.getBoardHighlight()))},directives:[iR,eR,fpe,Sx,DM,dx,Px,Ax,nR],encapsulation:2,changeDetection:0}),e}(),eye=function(){var e=dy(function e(){fy(this,e)});return e.STEP_FINISHED=function(){return $localize(Bp||(Bp=Hg(["Step finished!"])))},e.INFORMATIONAL_STEP=function(){return $localize(zp||(zp=Hg(["This step is not expecting any move from your part."])))},e}();function tye(e,t){if(1&e&&(CS(0,"div",20),CS(1,"div",21),fO(2,22),wS(),CS(3,"div",23),rP(4),wS(),wS()),2&e){var n=RS();DE(4),iP(n.currentReason.get())}}function nye(e,t){if(1&e){var n=SS();CS(0,"button",24),TS("click",function(){return eC(n),RS().retry()}),fO(1,25),wS()}}function rye(e,t){1&e&&(ES(0),fO(1,30),bS())}function iye(e,t){1&e&&(ES(0),fO(1,31),bS())}function aye(e,t){if(1&e&&pS(0,iye,2,0,"ng-container",27),2&e){RS();var n=gS(5),r=RS();mS("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",n)}}function oye(e,t){1&e&&(ES(0),fO(1,32),bS())}function sye(e,t){if(1&e){var n=SS();CS(0,"button",26),TS("click",function(){return eC(n),RS().next()}),pS(1,rye,2,0,"ng-container",27),pS(2,aye,1,2,"ng-template",null,28,XT),pS(4,oye,2,0,"ng-template",null,29,XT),wS()}if(2&e){var r=gS(3),i=RS();DE(1),mS("ngIf",i.steps[i.stepIndex]&&i.steps[i.stepIndex].isInformation())("ngIfElse",r)}}function uye(e,t){if(1&e){var n=SS();CS(0,"button",33),TS("click",function(){return eC(n),RS().start()}),fO(1,34),wS()}}function cye(e,t){if(1&e){var n=SS();CS(0,"button",35),TS("click",function(){return eC(n),RS().playLocally()}),fO(1,36),wS()}}function lye(e,t){if(1&e){var n=SS();CS(0,"button",37),TS("click",function(){return eC(n),RS().createGame()}),fO(1,38),wS()}}function fye(e,t){if(1&e){var n=SS();CS(0,"button",39),TS("click",function(){return eC(n),RS().showSolution()}),fO(1,40),wS()}}function hye(e,t){if(1&e&&(ES(0),CS(1,"option",42),rP(2),wS(),bS()),2&e){var n=RS(),r=n.index,i=n.$implicit;DE(1),xS("id","step_",r,""),mS("value",r),DE(1),iP(i.title)}}function dye(e,t){1&e&&(ES(0),rP(1,"v "),bS())}function vye(e,t){1&e&&rP(0,"x ")}function pye(e,t){if(1&e&&(CS(0,"option",43),pS(1,dye,2,0,"ng-container",27),pS(2,vye,1,0,"ng-template",null,44,XT),CS(4,"span",45),rP(5),wS(),wS()),2&e){var n=gS(3),r=RS(),i=r.index,a=r.$implicit,o=RS();mS("value",i),DE(1),mS("ngIf",o.stepFinished[i])("ngIfElse",n),DE(3),xS("id","step_",i,""),DE(1),iP(a.title)}}function gye(e,t){if(1&e&&(ES(0),pS(1,hye,3,3,"ng-container",27),pS(2,pye,6,5,"ng-template",null,41,XT),bS()),2&e){var n=t.index,r=gS(3),i=RS();DE(1),mS("ngIf",n===i.stepIndex)("ngIfElse",r)}}var yye=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r,i,a,o,s){var u;return fy(this,n),(u=t.call(this,e,r,s,i,a)).cdr=o,u.connectedUserService=s,u.COMPLETED_TUTORIAL_MESSAGE=$localize(Hp||(Hp=Hg(["Congratulations, you completed the tutorial."]))),u.steps=[],u.successfulSteps=0,u.stepIndex=-1,u.currentMessage="",u.currentReason=RB.empty(),u.moveAttemptMade=!1,u.stepFinished=[],u.tutorialOver=!1,OB(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),u.role=Q7.ZERO,u}return dy(n,[{key:"getNumberOfSteps",value:function(){return this.steps.length}},{key:"getCurrentStepTitle",value:function(){return this.steps.length>0?this.steps[this.stepIndex].title:""}},{key:"ngAfterViewInit",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return OB(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),t.next=3,e.afterGameIncluderViewInit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}e.start();case 6:case"end":return t.stop()}},t)}))()}},{key:"start",value:function(){this.startTutorial(this.gameComponent.tutorial)}},{key:"startTutorial",value:function(e){OB(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}},{key:"getCompletionArray",value:function(){return this.steps.map(function(){return!1})}},{key:"changeStep",value:function(e){this.showStep(Number.parseInt(e.target.value,10))}},{key:"showStep",value:function(e){OB(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;var t,r=this.steps[this.stepIndex];if(this.currentMessage=r.instruction,this.currentReason=RB.empty(),r.previousState.isPresent()){var i=new Dte(r.previousState.get());t=RB.of(i)}else t=RB.empty();this.gameComponent.rules.node=new Dte(r.state,t,r.previousMove),this.gameComponent.updateBoard(),this.cdr.detectChanges()}},{key:"onLegalUserMove",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function r(){var i,a,o,s,u;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:OB(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}}),i=t.steps[t.stepIndex],N7(t.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),OB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),t.gameComponent.updateBoard(),t.moveAttemptMade=!0,i.isPredicate()?(a=t.gameComponent.rules.node.mother.get().gameState,o=t.gameComponent.rules.node.gameState,(s=PB.getNonNullable(i.predicate)(e,a,o)).isSuccess()?t.showStepSuccess(i.getSuccessMessage()):t.currentReason=RB.of(s.getReason())):i.isAnyMove()?(OB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(i.getSuccessMessage())):(N7(i.isMove(),"cannot reach here with a click step"),(u=i).acceptedMoves.some(function(t){return t.equals(e)})?(OB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),t.showStepSuccess(u.getSuccessMessage())):(OB(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),t.currentReason=RB.of(u.getFailureMessage()))),t.cdr.detectChanges();case 4:case"end":return r.stop()}},r)}))()}},{key:"retry",value:function(){OB(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}},{key:"onUserClick",value:function(e){var t=this;if(OB(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=RB.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return DB.failure(eye.STEP_FINISHED());var r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,PB.getNonNullable(r.acceptedClicks).some(function(t){return t===e})?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),DB.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(function(){t.cdr.detectChanges()},10),DB.SUCCESS):DB.failure(eye.INFORMATIONAL_STEP())}},{key:"onCancelMove",value:function(e){OB(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=RB.of(e)),this.cdr.detectChanges()}},{key:"showStepSuccess",value:function(e){OB(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}},{key:"updateSuccessCount",value:function(){var e,t=0,n=uy(this.stepFinished);try{for(n.s();!(e=n.n()).done;){e.value&&t++}}catch(r){n.e(r)}finally{n.f()}this.successfulSteps=t}},{key:"next",value:function(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{for(var e=(this.stepIndex+1)%this.steps.length;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}},{key:"showSolution",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var r,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:OB(n.VERBOSE,"tutorialGameWrapper.showSolution()"),N7((r=e.steps[e.stepIndex]).hasSolution(),"step must have solution"),(a=(i=r).getSolution())instanceof Tte?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(a),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(a).dispatchEvent(new Event("click"))),e.currentMessage=i.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges();case 5:case"end":return t.stop()}},t)}))()}},{key:"playLocally",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=PB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/local",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"createGame",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=PB.getNonNullable(e.actRoute.snapshot.paramMap.get("compo")),t.next=3,e.router.navigate(["/play",n]);case 3:case"end":return t.stop()}},t)}))()}},{key:"getPlayer",value:function(){return"tutorial-player"}}]),n}(dpe);return e.VERBOSE=!1,e.\u0275fac=function(t){return new(t||e)(yS(bO),yS(WD),yS(vF),yS(M7),yS(eT),yS(B7))},e.\u0275cmp=ck({type:e,selectors:[["app-tutorial-game-wrapper"]],features:[Qb],decls:22,vars:15,consts:function(){return[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["role","alert",1,"message","is-danger"],[1,"message-header"],$localize(Gp||(Gp=Hg(["Failure"]))),["id","currentReason",1,"message-body"],["id","retryButton",1,"button","mr-3",3,"click"],$localize($p||($p=Hg(["Try again"]))),["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],$localize(Zp||(Zp=Hg(["Ok"]))),$localize(qp||(qp=Hg(["Continue"]))),$localize(Wp||(Wp=Hg(["Skip"]))),["id","restartButton",1,"button",3,"click"],$localize(jp||(jp=Hg(["Try again"]))),["id","playLocallyButton",1,"button",3,"click"],$localize(Yp||(Yp=Hg(["Play locally"]))),["id","playOnlineButton",1,"button",3,"click"],$localize(Kp||(Kp=Hg(["Create an online game"]))),["id","showSolutionButton",1,"button",3,"click"],$localize(Qp||(Qp=Hg(["See solution"]))),["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"div",1),CS(2,"div",2),_S(3,"progress",3),CS(4,"div",4),CS(5,"p",5),rP(6),wS(),_S(7,"p",6),wS(),pS(8,tye,5,1,"div",7),CS(9,"div",8),pS(10,nye,2,0,"button",9),pS(11,sye,6,2,"button",10),pS(12,uye,2,0,"button",11),pS(13,cye,2,0,"button",12),pS(14,lye,2,0,"button",13),pS(15,fye,2,0,"button",14),CS(16,"div",15),CS(17,"select",16),TS("change",function(e){return t.changeStep(e)}),pS(18,gye,4,2,"ng-container",17),wS(),wS(),wS(),wS(),wS(),CS(19,"div",18),CS(20,"div",19),_S(21,"app-game-includer"),wS(),wS(),wS()),2&e&&(DE(3),lS("value",t.successfulSteps)("max",t.getNumberOfSteps()),DE(3),sP("",t.getCurrentStepTitle()," [",t.stepIndex+1,"/",t.getNumberOfSteps(),"]"),DE(1),mS("innerHTML",t.currentMessage,O_),DE(1),mS("ngIf",t.currentReason.isPresent()),DE(2),mS("ngIf",!1===t.tutorialOver&&(t.stepFinished&&!0===t.stepFinished[t.stepIndex]||t.moveAttemptMade)),DE(1),mS("ngIf",!1===t.tutorialOver),DE(1),mS("ngIf",t.tutorialOver),DE(1),mS("ngIf",t.tutorialOver),DE(1),mS("ngIf",t.tutorialOver),DE(1),mS("ngIf",t.moveAttemptMade&&!1===t.stepFinished[t.stepIndex]),DE(3),mS("ngForOf",t.steps),DE(1),mS("ngClass",t.getBoardHighlight()))},directives:[iR,nR,eR,fpe,Px,Ax],encapsulation:2,changeDetection:0}),e}();function mye(e,t){if(1&e&&(CS(0,"div",35),CS(1,"div",36),fO(2,37),wS(),CS(3,"div",38),rP(4),wS(),wS()),2&e){var n=RS();DE(4),iP(n.errorMessage)}}var kye=function(){return["/login"]},Cye=function(){var e=function(){function e(t,n){fy(this,e),this.authService=t,this.router=n,this.faEye=g9,this.registrationForm=new ox({email:new ax,username:new ax,password:new ax})}return dy(e,[{key:"registerWithEmail",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n,r,i,a,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.registrationForm.value.username,r=e.registrationForm.value.email,i=e.registrationForm.value.password,null!=n&&null!=r&&null!=i){t.next=5;break}e.errorMessage=$localize(Xp||(Xp=Hg(["There are missing fields in the registration form, please check that you filled in all fields."]))),t.next=21;break;case 5:return t.next=7,e.authService.doRegister(n,r,i);case 7:if(!(a=t.sent).isSuccess()){t.next=20;break}return t.next=11,e.authService.sendEmailVerification();case 11:if(!(o=t.sent).isSuccess()){t.next=17;break}return t.next=15,e.router.navigate(["/verify-account"]);case 15:t.next=18;break;case 17:e.errorMessage=o.getReason();case 18:t.next=21;break;case 20:e.errorMessage=a.getReason();case 21:case"end":return t.stop()}},t)}))()}},{key:"registerWithGoogle",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.doGoogleLogin();case 2:if(!(n=t.sent).isSuccess()){t.next=8;break}return t.next=6,e.router.navigate(["/verify-account"]);case 6:t.next=9;break;case 8:e.errorMessage=n.getReason();case 9:case"end":return t.stop()}},t)}))()}},{key:"getPasswordHelpClass",value:function(){var e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}},{key:"canRegister",value:function(){var e,t,n,r=null!==(e=this.registrationForm.value.password)&&void 0!==e?e:"";return!(""===(null!==(t=this.registrationForm.value.email)&&void 0!==t?t:"")||""===(null!==(n=this.registrationForm.value.username)&&void 0!==n?n:"")||""===r||r.length<6)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(B7),yS(vF))},e.\u0275cmp=ck({type:e,selectors:[["app-register"]],decls:56,vars:7,consts:function(){return[[1,"box"],[1,"title"],$localize(Jp||(Jp=Hg(["Registering"]))),[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],$localize(eg||(eg=Hg(["Email"]))),[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",$localize(tg||(tg=Hg(["Email"]))),"type","email","autofocus","","required","",1,"input"],[1,"help"],$localize(ng||(ng=Hg(["A confirmation email will be sent to validate your account."]))),["for","username",1,"label"],$localize(rg||(rg=Hg(["Username"]))),["id","username","formControlName","username","name","username","placeholder",$localize(ig||(ig=Hg(["Username"]))),"type","text","required","",1,"input"],["for","password",1,"label"],$localize(ag||(ag=Hg(["Password"]))),[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",$localize(og||(og=Hg(["Password"]))),"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],$localize(sg||(sg=Hg(["The password should be at least 6 characters long"]))),["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(ug||(ug=Hg(["Register"]))),[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],$localize(cg||(cg=Hg(["Register with Google"]))),[1,"help","level-right"],$localize(lg||(lg=Hg(["Have an account?"]))),[3,"routerLink"],$localize(fg||(fg=Hg(["Log in"]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(hg||(hg=Hg(["Registration error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"p",1),fO(2,2),wS(),CS(3,"form",3),CS(4,"div",4),CS(5,"div",5),CS(6,"label",6),fO(7,7),wS(),wS(),CS(8,"div",8),CS(9,"div",9),CS(10,"div",10),_S(11,"input",11),CS(12,"p",12),fO(13,13),wS(),wS(),wS(),wS(),wS(),CS(14,"div",4),CS(15,"div",5),CS(16,"label",14),fO(17,15),wS(),wS(),CS(18,"div",8),CS(19,"div",9),CS(20,"div",10),_S(21,"input",16),wS(),wS(),wS(),wS(),CS(22,"div",4),CS(23,"div",5),CS(24,"label",17),fO(25,18),wS(),wS(),CS(26,"div",8),CS(27,"div",9),CS(28,"div",19),_S(29,"input",20),CS(30,"span",21),_S(31,"fa-icon",22),wS(),CS(32,"p",23),fO(33,24),wS(),wS(),wS(),wS(),wS(),CS(34,"div",4),_S(35,"div",5),CS(36,"div",8),CS(37,"div",9),CS(38,"div",10),CS(39,"button",25),TS("click",function(){return t.registerWithEmail()}),fO(40,26),wS(),wS(),wS(),wS(),wS(),CS(41,"div",4),_S(42,"div",5),CS(43,"div",27),pS(44,mye,5,1,"div",28),wS(),wS(),CS(45,"div",4),_S(46,"div",5),CS(47,"div",8),CS(48,"button",29),TS("click",function(){return t.registerWithGoogle()}),fO(49,30),wS(),wS(),wS(),CS(50,"p",31),ES(51),fO(52,32),bS(),rP(53,"\xa0 "),CS(54,"a",33),fO(55,34),wS(),wS(),wS(),wS()),2&e&&(DE(3),mS("formGroup",t.registrationForm),DE(28),mS("icon",t.faEye),DE(1),mS("ngClass",t.getPasswordHelpClass()),DE(7),mS("disabled",!t.canRegister()),DE(5),mS("ngIf",t.errorMessage),DE(10),mS("routerLink",ST(6,kye)))},directives:[vx,LM,Cx,aM,DM,_x,Dve,Mx,Gee,Lve,eR,iR,yF],encapsulation:2}),e}(),wye=function(){var e=function(){function e(t){fy(this,e),this.router=t}return dy(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"playLocally",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["local/"+e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF))},e.\u0275cmp=ck({type:e,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","playLocally",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(dg||(dg=Hg(["Play offline"])))]},template:function(e,t){1&e&&(CS(0,"app-pick-game",0),TS("pickGame",function(e){return t.pickGame(e)}),wS(),CS(1,"button",1),TS("click",function(){return t.playLocally()}),fO(2,2),wS()),2&e&&(DE(1),mS("disabled",!t.selectedGame))},directives:[Ave],encapsulation:2}),e}(),_ye=function(){var e=function(){function e(t){fy(this,e),this.router=t}return dy(e,[{key:"pickGame",value:function(e){this.selectedGame=e}},{key:"launchTutorial",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.router.navigate(["/tutorial/",e.selectedGame]);case 2:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(vF))},e.\u0275cmp=ck({type:e,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){return[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],$localize(vg||(vg=Hg(["Learn the rules"])))]},template:function(e,t){1&e&&(CS(0,"app-pick-game",0),TS("pickGame",function(e){return t.pickGame(e)}),wS(),CS(1,"button",1),TS("click",function(){return t.launchTutorial()}),fO(2,2),wS()),2&e&&(DE(1),mS("disabled",!t.selectedGame))},directives:[Ave],encapsulation:2}),e}(),Eye=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=ck({type:e,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){return[$localize(pg||(pg=Hg(["The replay game is loading, please wait, it should not take long."])))]},template:function(e,t){1&e&&(CS(0,"p"),fO(1,0),wS())},encapsulation:2}),e}();function bye(e,t){if(1&e&&(IC(),_S(0,"polygon",4)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("points",n.MartianChessQueenComponent.HEPTAGON)}}function Sye(e,t){if(1&e&&(IC(),_S(0,"polygon",4)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("points",n.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function Pye(e,t){if(1&e&&(IC(),_S(0,"circle",5)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Oye(e,t){if(1&e&&(ES(0),IC(),_S(1,"circle",6),_S(2,"circle",6),_S(3,"circle",6),bS()),2&e){var n=RS();DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(3)),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Tye(e,t){if(1&e&&(IC(),CS(0,"g"),_S(1,"circle",7),_S(2,"circle",7),_S(3,"circle",7),wS()),2&e){var n=RS();DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.45*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),DE(1),lS("cx",.45*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),DE(1),lS("cx",.55*n.MartianChessComponent.SPACE_SIZE)("cy",.55*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Iye(e,t){if(1&e&&(IC(),CS(0,"g",8),_S(1,"circle",9),_S(2,"circle",9),_S(3,"circle",9),wS()),2&e){var n=RS();mS("ngClass",n.pieceClasses),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE-3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE+3*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}var Aye=dy(function e(){fy(this,e),this.MartianChessQueenComponent=e,this.MartianChessComponent=wce,this.horizontalDotsRadius=wce.SPACE_SIZE/15});function Rye(e,t){if(1&e&&(IC(),_S(0,"polygon",4)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("points",n.MartianChessDroneComponent.PENTAGON)}}function Mye(e,t){if(1&e&&(IC(),_S(0,"polygon",4)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("points",n.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function xye(e,t){if(1&e&&(IC(),_S(0,"circle",5)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function Nye(e,t){if(1&e&&(ES(0),IC(),_S(1,"circle",6),_S(2,"circle",6),bS()),2&e){var n=RS();DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(2)),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",n.MartianChessComponent.getRadius(1))}}function Dye(e,t){if(1&e&&(IC(),CS(0,"g",7),_S(1,"circle",8),_S(2,"circle",8),wS()),2&e){var n=RS();mS("ngClass",n.pieceClasses),DE(1),lS("cx",.4*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE),DE(1),lS("cx",.6*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Lye(e,t){if(1&e&&(IC(),CS(0,"g",7),_S(1,"circle",9),_S(2,"circle",9),wS()),2&e){var n=RS();mS("ngClass",n.pieceClasses),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE-2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE+2*n.horizontalDotsRadius)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}Aye.HEPTAGON=wce.getRegularPolygon(7),Aye.EIGHT_POINTED_STAR=wce.getNPointedStar(8,0),Aye.\u0275fac=function(e){return new(e||Aye)},Aye.\u0275cmp=ck({type:Aye,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(pS(0,bye,1,3,"polygon",0),pS(1,Sye,1,3,"polygon",0),pS(2,Pye,1,5,"circle",1),pS(3,Oye,4,9,"ng-container",2),pS(4,Tye,4,9,"g",2),pS(5,Iye,4,10,"g",3)),2&e&&(mS("ngIf","Polygon"===t.style.shape),DE(1),mS("ngIf","Star"===t.style.shape),DE(1),mS("ngIf","Circle"===t.style.shape),DE(1),mS("ngIf","Concentric Circles"===t.style.points),DE(1),mS("ngIf","Dots"===t.style.points),DE(1),mS("ngIf","Horizontal Points"===t.style.points))},directives:[iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Fye=dy(function e(){fy(this,e),this.MartianChessComponent=wce,this.MartianChessDroneComponent=e,this.horizontalDotsRadius=wce.SPACE_SIZE/15});function Uye(e,t){if(1&e&&(IC(),_S(0,"polygon",5)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("points",n.MartianChessPawnComponent.TRIANGLE)}}function Vye(e,t){if(1&e&&(IC(),_S(0,"polygon",5)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("points",n.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function Bye(e,t){if(1&e&&(IC(),_S(0,"circle",6)),2&e){var n=RS();mS("id",n.mainShapeId)("ngClass",n.pieceClasses),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.5*n.MartianChessComponent.SPACE_SIZE-n.MartianChessComponent.STROKE_WIDTH)}}function zye(e,t){if(1&e&&(IC(),_S(0,"circle",7)),2&e){var n=RS();lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE+n.getConcreteTriangleYOffset())("r",n.MartianChessComponent.getRadius(1))}}function Hye(e,t){if(1&e&&(IC(),_S(0,"circle",8)),2&e){var n=RS();lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",.2/3*n.MartianChessComponent.SPACE_SIZE)}}function Gye(e,t){if(1&e&&(IC(),CS(0,"g",9),_S(1,"circle",10),wS()),2&e){var n=RS();mS("ngClass",n.pieceClasses),DE(1),lS("cx",.5*n.MartianChessComponent.SPACE_SIZE)("cy",.5*n.MartianChessComponent.SPACE_SIZE)("r",1.5*n.horizontalDotsRadius)}}Fye.FOUR_POINTED_STAR_VERTICAL=wce.getNPointedStar(4,0),Fye.PENTAGON=wce.getRegularPolygon(5),Fye.\u0275fac=function(e){return new(e||Fye)},Fye.\u0275cmp=ck({type:Fye,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(pS(0,Rye,1,3,"polygon",0),pS(1,Mye,1,3,"polygon",0),pS(2,xye,1,5,"circle",1),pS(3,Nye,3,6,"ng-container",2),pS(4,Dye,3,7,"g",3),pS(5,Lye,3,7,"g",3)),2&e&&(mS("ngIf","Polygon"===t.style.shape),DE(1),mS("ngIf","Star"===t.style.shape),DE(1),mS("ngIf","Circle"===t.style.shape),DE(1),mS("ngIf","Concentric Circles"===t.style.points),DE(1),mS("ngIf","Dots"===t.style.points),DE(1),mS("ngIf","Horizontal Points"===t.style.points))},directives:[iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var $ye=function(){function e(){fy(this,e),this.MartianChessComponent=wce,this.MartianChessPawnComponent=e,this.horizontalDotsRadius=wce.SPACE_SIZE/15}return dy(e,[{key:"getConcreteTriangleYOffset",value:function(){return"Polygon"===this.style.shape?e.TRIANGLE_Y_OFFSET:0}}],[{key:"getTriangle",value:function(){return wce.getRegularPolygon(3,e.TRIANGLE_Y_OFFSET)}},{key:"yOffsetForVerticalCentering",value:function(){var e=wce.getRegularPolygonCoords(3).map(function(e){return e.y});return(e.reduce(function(e,t){return Math.min(e,t)})+(100-e.reduce(function(e,t){return Math.max(e,t)})))/4}}]),e}();$ye.FOUR_POINTED_STAR_DIAGONAL=wce.getNPointedStar(4,45),$ye.TRIANGLE_Y_OFFSET=$ye.yOffsetForVerticalCentering(),$ye.TRIANGLE=$ye.getTriangle(),$ye.\u0275fac=function(e){return new(e||$ye)},$ye.\u0275cmp=ck({type:$ye,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(e,t){1&e&&(pS(0,Uye,1,3,"polygon",0),pS(1,Vye,1,3,"polygon",0),pS(2,Bye,1,5,"circle",1),pS(3,zye,1,3,"circle",2),pS(4,Hye,1,3,"circle",3),pS(5,Gye,2,4,"g",4)),2&e&&(mS("ngIf","Polygon"===t.style.shape),DE(1),mS("ngIf","Star"===t.style.shape),DE(1),mS("ngIf","Circle"===t.style.shape),DE(1),mS("ngIf","Concentric Circles"===t.style.points),DE(1),mS("ngIf","Dots"===t.style.points),DE(1),mS("ngIf","Horizontal Points"===t.style.points))},directives:[iR,eR],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.other-piece[_ngcontent-%COMP%]{fill:var(--nonplayer)}.other-piece-light[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.other-piece-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured[_ngcontent-%COMP%]{fill:var(--captured)}.captured2[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.highlighted[_ngcontent-%COMP%]{stroke:var(--selectable)}.highlighted[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move[_ngcontent-%COMP%]{stroke:var(--last-move)}.victory[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.selected[_ngcontent-%COMP%]{stroke:var(--selected)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.clickable[_ngcontent-%COMP%]{stroke:var(--clickable)}.clickable-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-giant[_ngcontent-%COMP%]{font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-bold[_ngcontent-%COMP%]{font-weight:bold}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});var Zye={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"},qye=function(){var e=function(){function e(t){fy(this,e),this.authService=t}return dy(e,[{key:"canActivate",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t){var n;e.userSub=e.authService.subscribeToUser((n=SB(regeneratorRuntime.mark(function n(r){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.evaluateUserPermission(r).then(t);case 2:case"end":return n.stop()}},n)})),function(e){return n.apply(this,arguments)}))}));case 1:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Dw(B7))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Wye=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e)).router=r,i}return dy(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!1!==e.verified||t.router.parseUrl("/verify-account"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(qye);return e.\u0275fac=function(t){return new(t||e)(Dw(B7),Dw(vF))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function jye(e,t){1&e&&(CS(0,"p",20),fO(1,21),wS())}function Yye(e,t){if(1&e){var n=SS();CS(0,"div",7),CS(1,"p",8),fO(2,9),wS(),CS(3,"div",10),CS(4,"p",11),fO(5,12),wS(),CS(6,"button",13),TS("click",function(){return eC(n),RS().finalizeEmailVerification()}),fO(7,14),wS(),wS(),CS(8,"div",15),CS(9,"p",11),fO(10,16),wS(),CS(11,"button",17),TS("click",function(){return eC(n),RS().sendEmailVerification()}),fO(12,18),wS(),wS(),pS(13,jye,2,0,"p",19),wS()}if(2&e){var r=RS();DE(2),hO(r.emailAddress),dO(2),DE(11),mS("ngIf",r.success)}}function Kye(e,t){if(1&e){var n=SS();CS(0,"div",24),CS(1,"div",8),fO(2,25),wS(),CS(3,"form",26),CS(4,"div",27),CS(5,"div",28),_S(6,"input",29),wS(),CS(7,"div",28),CS(8,"button",30),TS("click",function(){eC(n);var e=RS(2);return e.pickUsername(e.usernameForm.value)}),fO(9,31),wS(),wS(),wS(),wS(),wS()}if(2&e){var r=RS(2);DE(3),mS("formGroup",r.usernameForm)}}var Qye=function(){return["/lobby"]};function Xye(e,t){1&e&&(CS(0,"div",32),cO(1,33),_S(2,"a",34),lO(),wS()),2&e&&(DE(2),mS("routerLink",ST(1,Qye)))}function Jye(e,t){if(1&e&&(ES(0),pS(1,Kye,10,1,"div",22),pS(2,Xye,3,2,"div",23),bS()),2&e){var n=RS();DE(1),mS("ngIf",!n.success),DE(1),mS("ngIf",n.success)}}function eme(e,t){if(1&e&&(CS(0,"div",35),CS(1,"div",36),rP(2),wS(),wS()),2&e){var n=RS();DE(2),iP(n.errorMessage)}}var tme=function(){var e=function(){function e(t,n){fy(this,e),this.authService=t,this.router=n,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new ox({username:new ax})}return dy(e,[{key:"ngOnInit",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.userSub=e.authService.subscribeToUser(function(){var t=SB(regeneratorRuntime.mark(function t(n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.emailAddress=n.email.get(),!n.username.isAbsent()){t.next=5;break}e.verificationType="enter-username",t.next=11;break;case 5:if(e.verificationType="send-email",!0===e.triedToFinalize&&!1===n.verified&&(e.errorMessage=$localize(gg||(gg=Hg(["You have not verified your email! Click on the link in the verification email."])))),t.t0=!0===n.verified,!t.t0){t.next=11;break}return t.next=11,e.router.navigate(["/lobby"]);case 11:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}},t)}))()}},{key:"pickUsername",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.authService.setUsername(e.username);case 2:(r=n.sent).isSuccess()?t.success=!0:t.errorMessage=r.getReason();case 4:case"end":return n.stop()}},n)}))()}},{key:"sendEmailVerification",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authService.sendEmailVerification();case 2:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=n.getReason();case 4:case"end":return t.stop()}},t)}))()}},{key:"finalizeEmailVerification",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.triedToFinalize=!0,t.next=3,e.authService.reloadUser();case 3:window.open(window.location.href,"_self");case 4:case"end":return t.stop()}},t)}))()}},{key:"ngOnDestroy",value:function(){null!=this.userSub&&null!=this.userSub.unsubscribe&&this.userSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(B7),yS(vF))},e.\u0275cmp=ck({type:e,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){return[[1,"box"],[1,"message","is-info"],[1,"message-header"],$localize(yg||(yg=Hg(["Account verification"]))),["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],$localize(mg||(mg=Hg(["In order to finalize your account, you must click on the link that you should have received on your email address (",":INTERPOLATION:). The email could be in your spam folder."])),"\ufffd0\ufffd"),[1,"block","level-left"],[1,"level-item"],$localize(kg||(kg=Hg(["Once you have verified your email, click on the following button:"]))),["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],$localize(Cg||(Cg=Hg(["Finalize email verification"]))),[1,"level-left"],$localize(wg||(wg=Hg(["If you have not received the verification email, click on the following button:"]))),["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],$localize(_g||(_g=Hg(["Send verification email again"]))),["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],$localize(Eg||(Eg=Hg(["The email has been sent"]))),["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],$localize(bg||(bg=Hg(["In order to finalize your account, you must choose a username."]))),[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",$localize(Sg||(Sg=Hg(["Username"]))),"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],$localize(Pg||(Pg=Hg(["Pick username"]))),["id","success",1,"message-body"],$localize(Og||(Og=Hg(["Your account has now been finalized, you can go back to the ",":START_LINK:list of games",":CLOSE_LINK:."])),"\ufffd#2\ufffd","\ufffd/#2\ufffd"),[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"div",1),CS(2,"div",2),fO(3,3),wS(),pS(4,Yye,14,2,"div",4),pS(5,Jye,3,2,"ng-container",5),wS(),pS(6,eme,3,1,"div",6),wS()),2&e&&(DE(4),mS("ngIf","send-email"===t.verificationType),DE(1),mS("ngIf","enter-username"===t.verificationType),DE(1),mS("ngIf",t.errorMessage))},directives:[iR,vx,LM,Cx,aM,Mx,DM,_x,yF],encapsulation:2}),e}(),nme=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e)).router=r,i}return dy(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()?t.router.parseUrl("/login"):!e.verified||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(qye);return e.\u0275fac=function(t){return new(t||e)(Dw(B7),Dw(vF))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),rme=function(){var e=function(e){Jg(n,e);var t=ty(n);function n(e,r){var i;return fy(this,n),(i=t.call(this,e)).router=r,i}return dy(n,[{key:"evaluateUserPermission",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",!1===e.isConnected()||t.router.parseUrl("/"));case 1:case"end":return n.stop()}},n)}))()}}]),n}(qye);return e.\u0275fac=function(t){return new(t||e)(Dw(B7),Dw(vF))},e.\u0275prov=xm({token:e,factory:e.\u0275fac,providedIn:"root"}),e}();function ime(e,t){1&e&&(CS(0,"p",12),fO(1,13),wS())}function ame(e,t){if(1&e&&(CS(0,"div",14),CS(1,"div",15),fO(2,16),wS(),CS(3,"div",17),rP(4),wS(),wS()),2&e){var n=RS();DE(4),iP(n.errorMessage.get())}}var ome=function(){return{standalone:!0}},sme=function(){var e=function(){function e(t){fy(this,e),this.authService=t,this.success=!1,this.errorMessage=RB.empty(),this.email=""}return dy(e,[{key:"resetPassword",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return N7(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=RB.empty(),e.success=!1,t.next=3,e.authService.sendPasswordResetEmail(e.email);case 3:(n=t.sent).isSuccess()?e.success=!0:e.errorMessage=RB.of(n.getReason());case 5:case"end":return t.stop()}},t)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(B7))},e.\u0275cmp=ck({type:e,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){return[[1,"box"],[1,"title"],$localize(Tg||(Tg=Hg(["Password reset"]))),[1,"field"],[1,"control"],["id","email","name","email","placeholder",$localize(Ig||(Ig=Hg(["Email"]))),"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],$localize(Ag||(Ag=Hg(["An email will be sent with instruction to reset your password."]))),["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],$localize(Rg||(Rg=Hg(["Reset password"]))),["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],$localize(Mg||(Mg=Hg(["The email has been sent, please follow the instructions from that email."]))),["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],$localize(xg||(xg=Hg(["Error"]))),["id","errorMessage",1,"message-body"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"p",1),fO(2,2),wS(),CS(3,"div",3),CS(4,"div",4),CS(5,"input",5),TS("ngModelChange",function(e){return t.email=e}),wS(),CS(6,"p",6),fO(7,7),wS(),pS(8,ime,2,0,"p",8),wS(),wS(),CS(9,"button",9),TS("click",function(){return t.resetPassword()}),fO(10,10),wS(),pS(11,ame,5,1,"div",11),wS()),2&e&&(DE(5),mS("ngModel",t.email)("ngModelOptions",ST(5,ome)),DE(3),mS("ngIf",t.success),DE(1),mS("disabled",""===t.email),DE(2),mS("ngIf",t.errorMessage.isPresent()))},directives:[aM,Dve,Mx,DM,dx,iR],encapsulation:2}),e}();function ume(e,t){if(1&e&&(CS(0,"option",13),rP(1),wS()),2&e){var n=t.$implicit,r=RS();mS("value",n.value)("selected",n.value===r.currentTheme),DE(1),aP(" ",n.name," ")}}function cme(e,t){if(1&e&&(CS(0,"option",13),rP(1),wS()),2&e){var n=t.$implicit,r=RS();mS("value",n.value)("selected",n.value===r.currentLanguage),DE(1),aP(" ",n.name," ")}}var lme=function(){var e=function(){function e(t,n){fy(this,e),this.userSettingsService=t,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize(Ng||(Ng=Hg(["Light"])))},{value:"dark",name:$localize(Dg||(Dg=Hg(["Dark"])))}],this.currentTheme=n.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}return dy(e,[{key:"changeLanguage",value:function(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}},{key:"changeTheme",value:function(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}},{key:"reload",value:function(){window.open(window.location.href,"_self")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(f9),yS(h9))},e.\u0275cmp=ck({type:e,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){return[[1,"box"],[1,"title"],$localize(Lg||(Lg=Hg(["User settings"]))),[1,"field"],["for","theme",1,"label"],$localize(Fg||(Fg=Hg(["Theme"]))),[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],$localize(Ug||(Ug=Hg(["Language"]))),["id","language",3,"change"],[3,"value","selected"]]},template:function(e,t){1&e&&(CS(0,"div",0),CS(1,"p",1),fO(2,2),wS(),CS(3,"div",3),CS(4,"label",4),fO(5,5),wS(),CS(6,"div",6),CS(7,"div",7),CS(8,"select",8),TS("change",function(e){return t.changeTheme(e)}),pS(9,ume,2,3,"option",9),wS(),wS(),wS(),wS(),CS(10,"div",3),CS(11,"label",10),fO(12,11),wS(),CS(13,"div",6),CS(14,"div",7),CS(15,"select",12),TS("change",function(e){return t.changeLanguage(e)}),pS(16,cme,2,3,"option",9),wS(),wS(),wS(),wS(),wS()),2&e&&(DE(9),mS("ngForOf",t.availableThemes),DE(7),mS("ngForOf",t.availableLanguages))},directives:[nR,Px,Ax],encapsulation:2}),e}(),fme=function(){var e=dy(function e(){fy(this,e)});return e.ALREADY_INGAME=function(){return $localize(Vg||(Vg=Hg(["You are already in a game. Finish it or cancel it first."])))},e}(),hme=function(){var e=function(){function e(t,n,r,i,a,o){fy(this,e),this.route=t,this.router=n,this.connectedUserService=r,this.messageDisplayer=i,this.activePartsService=a,this.gameService=o}return dy(e,[{key:"ngOnInit",value:function(){var e=this;return SB(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createGameAndRedirectOrShowError(e.extractGameFromURL());case 2:case"end":return t.stop()}},t)}))()}},{key:"extractGameFromURL",value:function(){return PB.getNonNullable(this.route.snapshot.paramMap.get("compo"))}},{key:"createGameAndRedirectOrShowError",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){var r,i,a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(N7((r=t.connectedUserService.user.get()).isConnected(),"User must be connected and have a username to reach this page"),i=r.toMinimalUser(),!1!==t.gameExists(e)){n.next=7;break}return n.next=6,t.router.navigate(["/notFound",hpe.NO_MATCHING_GAME(e)],{skipLocationChange:!0});case 6:case 19:return n.abrupt("return",!1);case 7:return n.next=9,t.canCreateOnlineGame(i);case 9:if(!n.sent){n.next=16;break}return n.next=12,t.gameService.createPartConfigRoomAndChat(e);case 12:return a=n.sent,n.next=15,t.router.navigate(["/play",e,a]);case 15:return n.abrupt("return",!0);case 16:return t.messageDisplayer.infoMessage(fme.ALREADY_INGAME()),n.next=19,t.router.navigate(["/lobby"]);case 20:case"end":return n.stop()}},n)}))()}},{key:"gameExists",value:function(e){return RB.ofNullable(Ive.ALL_GAMES().find(function(t){return t.urlName===e})).isPresent()}},{key:"canCreateOnlineGame",value:function(e){var t=this;return SB(regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=!1,n.next=3,t.activePartsService.userHasActivePart(e);case 3:return n.t1=n.sent,n.abrupt("return",n.t0===n.t1);case 5:case"end":return n.stop()}},n)}))()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(yS(WD),yS(vF),yS(B7),yS(M7),yS(Hve),yS(o9))},e.\u0275cmp=ck({type:e,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){return[$localize(Bg||(Bg=Hg(["Creating online game, please wait, it should not take long."])))]},template:function(e,t){1&e&&(CS(0,"p"),fO(1,0),wS())},encapsulation:2}),e}();!function(e,t,n){!function(e,t,n){"string"!=typeof t&&(n=t,t=e[pP.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),fP[t]=e,n&&(fP[t][pP.ExtraData]=n)}(e,void 0,void 0)}(EB());var dme=[{path:"login",component:Bve},{path:"lobby",component:upe,canActivate:[Wye]},{path:"settings",component:lme},{path:"register",component:Cye,canActivate:[rme]},{path:"reset-password",component:sme,canActivate:[rme]},{path:"notFound/:message",component:cpe},{path:"nextGameLoading",component:Eye,canActivate:[Wye]},{path:"verify-account",component:tme,canActivate:[nme]},{path:"play",component:Gve,canActivate:[Wye]},{path:"play/:compo",component:hme,canActivate:[Wye]},{path:"play/:compo/:id",component:Nge,canActivate:[Wye]},{path:"local",component:wye},{path:"local/:compo",component:Jge},{path:"tutorial",component:_ye},{path:"tutorial/:compo",component:yye},{path:"",component:Nve},{path:"**",component:cpe}],vme=function(){function e(){fy(this,e)}return dy(e,null,[{key:"app",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:J3,providers:[{provide:Y3,useFactory:X3(e),multi:!0,deps:[CI,Yb,B3].concat(n)}]}}(function(){return e4(Zye)})}},{key:"firestore",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:f7,providers:[{provide:s7,useFactory:u7(e),multi:!0,deps:[CI,Yb,B3,j3,[new Gw,q8],[new Gw,x4]].concat(n)}]}}(function(){var e=m7();return e.toJSON(),e})}},{key:"auth",value:function(){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{ngModule:Q8,providers:[{provide:W8,useFactory:j8(e),multi:!0,deps:[CI,Yb,B3,j3,[new Gw,x4]].concat(n)}]}}(function(){return J8()})}}]),e}(),pme=function(){var e=dy(function e(){fy(this,e)});return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=dk({type:e,bootstrap:[ite]}),e.\u0275inj=Nm({providers:[B7,o9,a9,L7,I7,h9,{provide:uI,useValue:l9.getLocale()}],imports:[[vme.app(),vme.firestore(),vme.auth(),ZR,wN,IF.forRoot(dme,{useHash:!1}),Fx,Lx,wB,$ee]]}),e}();!function(e,t,n){var r=e.\u0275cmp;r.directiveDefs=function(){return t.map(lk)},r.pipeDefs=function(){return n.map(fk)}}(wce,[nR,eR,iR,$ye,Fye,Aye],[]),"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,"undefined"!=typeof global&&global;var gme=function(){function e(t){fy(this,e),this.digits=t}return dy(e,[{key:"clone",value:function(){return new e(this.digits.slice())}},{key:"add",value:function(e){var t=this.clone();return t.addToSelf(e),t}},{key:"addToSelf",value:function(e){for(var t=Math.max(this.digits.length,e.digits.length),n=0,r=0;r<t;r++){var i=n;r<this.digits.length&&(i+=this.digits[r]),r<e.digits.length&&(i+=e.digits[r]),i>=10?(this.digits[r]=i-10,n=1):(this.digits[r]=i,n=0)}n>0&&(this.digits[t]=1)}},{key:"toString",value:function(){for(var e="",t=this.digits.length-1;t>=0;t--)e+=this.digits[t];return e}}],[{key:"zero",value:function(){return new e([0])}},{key:"one",value:function(){return new e([1])}}]),e}(),yme=function(){function e(t){fy(this,e),this.powerOfTwos=[t]}return dy(e,[{key:"getValue",value:function(){return this.powerOfTwos[0]}},{key:"multiplyBy",value:function(e){var t=gme.zero();return this.multiplyByAndAddTo(e,t),t}},{key:"multiplyByAndAddTo",value:function(e,t){for(var n=0;0!==e;e>>>=1,n++)if(1&e){var r=this.getMultipliedByPowerOfTwo(n);t.addToSelf(r)}}},{key:"getMultipliedByPowerOfTwo",value:function(e){for(var t=this.powerOfTwos.length;t<=e;t++){var n=this.powerOfTwos[t-1];this.powerOfTwos[t]=n.add(n)}return this.powerOfTwos[e]}}]),e}(),mme=function(){function e(t){fy(this,e),this.base=t,this.exponents=[new yme(gme.one())]}return dy(e,[{key:"toThePowerOf",value:function(e){for(var t=this.exponents.length;t<=e;t++){var n=this.exponents[t-1].multiplyBy(this.base);this.exponents[t]=new yme(n)}return this.exponents[e]}}]),e}();function kme(e){var t=function(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r>=55296&&r<=56319&&e.length>n+1){var i=e.charCodeAt(n+1);i>=56320&&i<=57343&&(n++,r=(r-55296<<10)+i-56320+65536)}r<=127?t.push(r):r<=2047?t.push(r>>6&31|192,63&r|128):r<=65535?t.push(r>>12|224,r>>6&63|128,63&r|128):r<=2097151&&t.push(r>>18&7|240,r>>12&63|128,r>>6&63|128,63&r|128)}return t}(e),n=Cme(t,0),r=Cme(t,102072);return 0==n&&(0==r||1==r)&&(n^=319790063,r^=-1801410264),[n,r]}function Cme(e,t){var n,r=2654435769,i=2654435769,a=e.length;for(n=0;n+12<=a;n+=12){var o=wme(r=Eme(r,Ome(e,n,_me.Little)),i=Eme(i,Ome(e,n+4,_me.Little)),t=Eme(t,Ome(e,n+8,_me.Little)));r=o[0],i=o[1],t=o[2]}return r=Eme(r,Ome(e,n,_me.Little)),i=Eme(i,Ome(e,n+4,_me.Little)),t=Eme(t,a),wme(r,i,t=Eme(t,Ome(e,n+8,_me.Little)<<8))[2]}function wme(e,t,n){return e=Sme(e,t),e=Sme(e,n),e^=n>>>13,t=Sme(t,n),t=Sme(t,e),t^=e<<8,n=Sme(n,e),n=Sme(n,t),n^=t>>>13,e=Sme(e,t),e=Sme(e,n),e^=n>>>12,t=Sme(t,n),t=Sme(t,e),t^=e<<16,n=Sme(n,e),n=Sme(n,t),n^=t>>>5,e=Sme(e,t),e=Sme(e,n),e^=n>>>3,t=Sme(t,n),t=Sme(t,e),t^=e<<10,n=Sme(n,e),n=Sme(n,t),[e,t,n^=t>>>15]}var _me=((_me=_me||{})[_me.Little=0]="Little",_me[_me.Big=1]="Big",_me);function Eme(e,t){return bme(e,t)[1]}function bme(e,t){var n=(65535&e)+(65535&t),r=(e>>>16)+(t>>>16)+(n>>>16);return[r>>>16,r<<16|65535&n]}function Sme(e,t){var n=(65535&e)-(65535&t);return(e>>16)-(t>>16)+(n>>16)<<16|65535&n}function Pme(e,t){return t>=e.length?0:e[t]}function Ome(e,t,n){var r=0;if(n===_me.Big)for(var i=0;i<4;i++)r+=Pme(e,t+i)<<24-8*i;else for(var a=0;a<4;a++)r+=Pme(e,t+a)<<8*a;return r}var Tme=new mme(256);function Ime(e,t){if(":"!==t.charAt(0))return{text:e};var n=function(e,t){for(var n=1,r=1;n<e.length;n++,r++)if("\\"===t[r])r++;else if(":"===e[n])return n;throw new Error('Unterminated $localize metadata block in "'.concat(t,'".'))}(e,t);return{block:e.substring(1,n),text:e.substring(n+1)}}function Ame(e){return 1===e?"PH":"PH_"+(e-1)}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var Rme=function(e){Jg(n,e);var t=ty(n);function n(e){var r;return fy(this,n),(r=t.call(this,"No translation found for ".concat(xme(e),"."))).parsedMessage=e,r.type="MissingTranslationError",r}return dy(n)}(Yg(Error));function Mme(e,t){return Object.defineProperty(e,"raw",{value:t}),e}function xme(e){var t=e.meaning&&' - "'.concat(e.meaning,'"'),n=e.legacyIds&&e.legacyIds.length>0?" [".concat(e.legacyIds.map(function(e){return'"'.concat(e,'"')}).join(", "),"]"):"";return'"'.concat(e.id,'"').concat(n,' ("').concat(e.text,'"').concat(t,")")}function Nme(e,t){try{return function(e,t,n){var r=function(e,t,n,r){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a={},o={},s=function(e,t){var n=Ime(e,t),r=n.text,i=n.block;if(void 0===i)return{text:r};var a=zg(i.split("\u241f")),o=a[0],s=a.slice(1),u=qg(o.split("@@",2),2),c=u[0],l=u[1],f=qg(c.split("|",2),2),h=f[0],d=f[1];return void 0===d&&(d=h,h=void 0),""===d&&(d=void 0),{text:r,meaning:h,description:d,customId:l,legacyIds:s}}(e[0],e.raw[0]),u=[s.text],c=[],l=s.text,f=1;f<e.length;f++){var h=Ime(e[f],e.raw[f]),d=h.text,v=h.block,p=void 0===v?Ame(f):v;l+="{$".concat(p,"}").concat(d),void 0!==t&&(a[p]=t[f-1],o[p]=i[f-1]),c.push(p),u.push(d)}var g=s.customId||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=kme(e);if(t){var r=kme(t);n=function(e,t){var n=e[0],r=t[0],i=bme(e[1],t[1]),a=i[0],o=i[1];return[Eme(Eme(n,r),a),o]}(function(e,t){var n=e[0],r=e[1];return[n<<1|r>>>31,r<<1|n>>>31]}(n),r)}return function(e,t){var n=Tme.toThePowerOf(0).multiplyBy(t);return Tme.toThePowerOf(4).multiplyByAndAddTo(e,n),n.toString()}(2147483647&n[0],n[1])}(l,s.meaning||""),y=s.legacyIds?s.legacyIds.filter(function(e){return e!==g}):[];return{id:g,legacyIds:y,substitutions:a,substitutionLocations:o,text:l,customId:s.customId,meaning:s.meaning||"",description:s.description||"",messageParts:u,messagePartLocations:r,placeholderNames:c,location:n}}(t,n),i=e[r.id];if(void 0!==r.legacyIds)for(var a=0;a<r.legacyIds.length&&void 0===i;a++)i=e[r.legacyIds[a]];if(void 0===i)throw new Rme(r);return[i.messageParts,i.placeholderNames.map(function(e){if(r.substitutions.hasOwnProperty(e))return r.substitutions[e];throw new Error("There is a placeholder name mismatch with the translation provided for the message ".concat(xme(r),".\nThe translation contains a placeholder with name ").concat(e,", which does not exist in the message."))})]}($localize.TRANSLATIONS,e,t)}catch(n){return console.warn(n.message),[e,t]}}function Dme(){(function(){if(MI)throw new Error("Cannot enable prod mode after platform setup.");RI=!1})(),GR().bootstrapModule(pme).catch(function(e){return console.error(e)})}var Lme=l9.getLocale();"en"!==Lme?fetch("/assets/"+Lme+".json").then(function(e){return e.ok?e.json():{locale:"en",translations:{}}}).then(function(e){(function(e){$localize.translate||($localize.translate=Nme),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(e).forEach(function(t){$localize.TRANSLATIONS[t]=function(e){for(var t=e.split(/{\$([^}]*)}/),n=[t[0]],r=[],i=1;i<t.length-1;i+=2)r.push(t[i]),n.push("".concat(t[i+1]));var a=n.map(function(e){return":"===e.charAt(0)?"\\"+e:e});return{text:e,messageParts:Mme(n,a),placeholderNames:r}}(e[t])})})(e.translations),$localize.locale=e.locale,Dme()}).catch(function(e){console.log(e)}):Dme()}},function(e){e(e.s=4975)}])}();