(self.webpackChunkeveryboard=self.webpackChunkeveryboard||[]).push([[179],{6594:(V9,P5,tc)=>{"use strict";function on(n){return"function"==typeof n}function is(n){const e=n(r=>{Error.call(r),r.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const F3=is(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((r,s)=>`${s+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function Uc(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class q1{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const i of e)i.remove(this);else e.remove(this);const{initialTeardown:r}=this;if(on(r))try{r()}catch(i){t=i instanceof F3?i.errors:[i]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const i of s)try{dn(i)}catch(o){t=t??[],o instanceof F3?t=[...t,...o.errors]:t.push(o)}}if(t)throw new F3(t)}}add(t){var e;if(t&&t!==this)if(this.closed)dn(t);else{if(t instanceof q1){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Uc(e,t)}remove(t){const{_finalizers:e}=this;e&&Uc(e,t),t instanceof q1&&t._removeParent(this)}}q1.EMPTY=(()=>{const n=new q1;return n.closed=!0,n})();const l8=q1.EMPTY;function Gc(n){return n instanceof q1||n&&"closed"in n&&on(n.remove)&&on(n.add)&&on(n.unsubscribe)}function dn(n){on(n)?n():n.unsubscribe()}const nc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Wc={setTimeout(n,t,...e){const{delegate:r}=Wc;return r?.setTimeout?r.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=Wc;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function B3(n){Wc.setTimeout(()=>{const{onUnhandledError:t}=nc;if(!t)throw n;t(n)})}function io(){}const ti=u8("C",void 0,void 0);function u8(n,t,e){return{kind:n,value:t,error:e}}let qc=null;function ht(n){if(nc.useDeprecatedSynchronousErrorHandling){const t=!qc;if(t&&(qc={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:r}=qc;if(qc=null,e)throw r}}else n()}class Jt extends q1{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Gc(t)&&t.add(this)):this.destination=w5}static create(t,e,r){return new lr(t,e,r)}next(t){this.isStopped?F9(function H9(n){return u8("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?F9(function W4(n){return u8("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?F9(ti,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const i1=Function.prototype.bind;function zs(n,t){return i1.call(n,t)}class On{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(r){$3(r)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(r){$3(r)}else $3(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){$3(e)}}}class lr extends Jt{constructor(t,e,r){let s;if(super(),on(t)||!t)s={next:t??void 0,error:e??void 0,complete:r??void 0};else{let i;this&&nc.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),s={next:t.next&&zs(t.next,i),error:t.error&&zs(t.error,i),complete:t.complete&&zs(t.complete,i)}):s=t}this.destination=new On(s)}}function $3(n){nc.useDeprecatedSynchronousErrorHandling?function at(n){nc.useDeprecatedSynchronousErrorHandling&&qc&&(qc.errorThrown=!0,qc.error=n)}(n):B3(n)}function F9(n,t){const{onStoppedNotification:e}=nc;e&&Wc.setTimeout(()=>e(n,t))}const w5={closed:!0,next:io,error:function T5(n){throw n},complete:io},Qm="function"==typeof Symbol&&Symbol.observable||"@@observable";function q4(n){return n}function Jm(n){return 0===n.length?q4:1===n.length?n[0]:function(e){return n.reduce((r,s)=>s(r),e)}}let Er=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const r=new n;return r.source=this,r.operator=e,r}subscribe(e,r,s){const i=function b5(n){return n&&n instanceof Jt||function YP(n){return n&&on(n.next)&&on(n.error)&&on(n.complete)}(n)&&Gc(n)}(e)?e:new lr(e,r,s);return ht(()=>{const{operator:o,source:c}=this;i.add(o?o.call(i,c):c?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(e){try{return this._subscribe(e)}catch(r){e.error(r)}}forEach(e,r){return new(r=B9(r))((s,i)=>{const o=new lr({next:c=>{try{e(c)}catch(u){i(u),o.unsubscribe()}},error:i,complete:s});this.subscribe(o)})}_subscribe(e){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(e)}[Qm](){return this}pipe(...e){return Jm(e)(this)}toPromise(e){return new(e=B9(e))((r,s)=>{let i;this.subscribe(o=>i=o,o=>s(o),()=>r(i))})}}return n.create=t=>new n(t),n})();function B9(n){var t;return null!==(t=n??nc.Promise)&&void 0!==t?t:Promise}const WH=is(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let z2=(()=>{class n extends Er{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const r=new $9(this,this);return r.operator=e,r}_throwIfClosed(){if(this.closed)throw new WH}next(e){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(e)}})}error(e){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:r}=this;for(;r.length;)r.shift().error(e)}})}complete(){ht(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:r,isStopped:s,observers:i}=this;return r||s?l8:(this.currentObservers=null,i.push(e),new q1(()=>{this.currentObservers=null,Uc(i,e)}))}_checkFinalizedStatuses(e){const{hasError:r,thrownError:s,isStopped:i}=this;r?e.error(s):i&&e.complete()}asObservable(){const e=new Er;return e.source=this,e}}return n.create=(t,e)=>new $9(t,e),n})();class $9 extends z2{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===r||r.call(e,t)}error(t){var e,r;null===(r=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===r||r.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,r;return null!==(r=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==r?r:l8}}function e_(n){return on(n?.lift)}function pr(n){return t=>{if(e_(t))return t.lift(function(e){try{return n(e,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function os(n,t,e,r,s){return new KP(n,t,e,r,s)}class KP extends Jt{constructor(t,e,r,s,i,o){super(t),this.onFinalize=i,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(u){t.error(u)}}:super._next,this._error=s?function(c){try{s(c)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function pn(n,t){return pr((e,r)=>{let s=0;e.subscribe(os(r,i=>{r.next(n.call(t,i,s++))}))})}function N5(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(n);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(e[r[s]]=n[r[s]])}return e}function Wr(n){return this instanceof Wr?(this.v=n,this):new Wr(n)}function Zi(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=e.apply(n,t||[]),i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(C){r[C]&&(s[C]=function(w){return new Promise(function(I,H){i.push([C,w,I,H])>1||c(C,w)})})}function c(C,w){try{!function u(C){C.value instanceof Wr?Promise.resolve(C.value.v).then(h,p):m(i[0][2],C)}(r[C](w))}catch(I){m(i[0][3],I)}}function h(C){c("next",C)}function p(C){c("throw",C)}function m(C,w){C(w),i.shift(),i.length&&c(i[0][0],i[0][1])}}function rT(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function r_(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],r=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(o){return new Promise(function(c,u){!function s(i,o,c,u){Promise.resolve(u).then(function(h){i({value:h,done:c})},o)}(c,u,(o=n[i](o)).done,o.value)})}}}const a_=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function c_(n){return on(n?.then)}function W9(n){return on(n[Qm])}function l_(n){return Symbol.asyncIterator&&on(n?.[Symbol.asyncIterator])}function rc(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const O1=function f8(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function sc(n){return on(n?.[O1])}function va(n){return Zi(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:r,done:s}=yield Wr(e.read());if(s)return yield Wr(void 0);yield yield Wr(r)}}finally{e.releaseLock()}})}function u_(n){return on(n?.getReader)}function oo(n){if(n instanceof Er)return n;if(null!=n){if(W9(n))return function j4(n){return new Er(t=>{const e=n[Qm]();if(on(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(a_(n))return function Yi(n){return new Er(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(c_(n))return function f_(n){return new Er(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,B3)})}(n);if(l_(n))return Z4(n);if(sc(n))return function sT(n){return new Er(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(u_(n))return function q9(n){return Z4(va(n))}(n)}throw rc(n)}function Z4(n){return new Er(t=>{(function iT(n,t){var e,r,s,i;return function JP(n,t,e,r){return new(e||(e=Promise))(function(i,o){function c(p){try{h(r.next(p))}catch(m){o(m)}}function u(p){try{h(r.throw(p))}catch(m){o(m)}}function h(p){p.done?i(p.value):function s(i){return i instanceof e?i:new e(function(o){o(i)})}(p.value).then(c,u)}h((r=r.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=rT(n);!(r=yield e.next()).done;)if(t.next(r.value),t.closed)return}catch(o){s={error:o}}finally{try{r&&!r.done&&(i=e.return)&&(yield i.call(e))}finally{if(s)throw s.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Vs(n,t,e,r=0,s=!1){const i=t.schedule(function(){e(),s?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(i),!s)return i}function De(n,t,e=1/0){return on(t)?De((r,s)=>pn((i,o)=>t(r,i,s,o))(oo(n(r,s))),e):("number"==typeof t&&(e=t),pr((r,s)=>function Bo(n,t,e,r,s,i,o,c){const u=[];let h=0,p=0,m=!1;const C=()=>{m&&!u.length&&!h&&t.complete()},w=H=>h<r?I(H):u.push(H),I=H=>{i&&t.next(H),h++;let Y=!1;oo(e(H,p++)).subscribe(os(t,ee=>{s?.(ee),i?w(ee):t.next(ee)},()=>{Y=!0},void 0,()=>{if(Y)try{for(h--;u.length&&h<r;){const ee=u.shift();o?Vs(t,o,()=>I(ee)):I(ee)}C()}catch(ee){t.error(ee)}}))};return n.subscribe(os(t,w,()=>{m=!0,C()})),()=>{c?.()}}(r,s,n,e)))}function Y4(n=1/0){return De(q4,n)}const ic=new Er(n=>n.complete());function K4(n){return n[n.length-1]}function Xt(n){return on(K4(n))?n.pop():void 0}function U3(n){return function _6(n){return n&&on(n.schedule)}(K4(n))?n.pop():void 0}function X4(n,t=0){return pr((e,r)=>{e.subscribe(os(r,s=>Vs(r,n,()=>r.next(s),t),()=>Vs(r,n,()=>r.complete(),t),s=>Vs(r,n,()=>r.error(s),t)))})}function oc(n,t=0){return pr((e,r)=>{r.add(n.schedule(()=>e.subscribe(r),t))})}function x5(n,t){if(!n)throw new Error("Iterable cannot be null");return new Er(e=>{Vs(e,t,()=>{const r=n[Symbol.asyncIterator]();Vs(e,t,()=>{r.next().then(s=>{s.done?e.complete():e.next(s.value)})},0,!0)})})}function as(n,t){return t?function h8(n,t){if(null!=n){if(W9(n))return function I5(n,t){return oo(n).pipe(oc(t),X4(t))}(n,t);if(a_(n))return function Uo(n,t){return new Er(e=>{let r=0;return t.schedule(function(){r===n.length?e.complete():(e.next(n[r++]),e.closed||this.schedule())})})}(n,t);if(c_(n))return function v6(n,t){return oo(n).pipe(oc(t),X4(t))}(n,t);if(l_(n))return x5(n,t);if(sc(n))return function j9(n,t){return new Er(e=>{let r;return Vs(e,t,()=>{r=n[O1](),Vs(e,t,()=>{let s,i;try{({value:s,done:i}=r.next())}catch(o){return void e.error(o)}i?e.complete():e.next(s)},0,!0)}),()=>on(r?.return)&&r.return()})}(n,t);if(u_(n))return function C6(n,t){return x5(va(n),t)}(n,t)}throw rc(n)}(n,t):oo(n)}function k5(n,t,...e){if(!0===t)return void n();if(!1===t)return;const r=new lr({next:()=>{r.unsubscribe(),n()}});return oo(t(...e)).subscribe(r)}function y1(n){for(let t in n)if(n[t]===y1)return t;throw Error("Could not find renamed property on target object.")}function Z9(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function j1(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(j1).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function d8(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const d_=y1({__forward_ref__:y1});function E1(n){return n.__forward_ref__=E1,n.toString=function(){return j1(this())},n}function en(n){return y6(n)?n():n}function y6(n){return"function"==typeof n&&n.hasOwnProperty(d_)&&n.__forward_ref__===E1}class Ne extends Error{constructor(t,e){super(function jc(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}(t,e)),this.code=t}}function tn(n){return"string"==typeof n?n:null==n?"":String(n)}function M6(n,t){throw new Ne(-201,!1)}function M1(n,t,e,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${e} ${r} ${t} <=Actual]`))}function et(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function qr(n){return{providers:n.providers||[],imports:n.imports||[]}}function In(n){return __(n,S6)||__(n,Q9)}function __(n,t){return n.hasOwnProperty(t)?n[t]:null}function m8(n){return n&&(n.hasOwnProperty(Ce)||n.hasOwnProperty(J9))?n[Ce]:null}const S6=y1({\u0275prov:y1}),Ce=y1({\u0275inj:y1}),Q9=y1({ngInjectableDef:y1}),J9=y1({ngInjectorDef:y1});var qt=(()=>((qt=qt||{})[qt.Default=0]="Default",qt[qt.Host=1]="Host",qt[qt.Self=2]="Self",qt[qt.SkipSelf=4]="SkipSelf",qt[qt.Optional=8]="Optional",qt))();let eh;function Go(n){const t=eh;return eh=n,t}function th(n,t,e){const r=In(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:e&qt.Optional?null:void 0!==t?t:void M6(j1(n))}function q3(n){return{toString:n}.toString()}var F2=(()=>((F2=F2||{})[F2.OnPush=0]="OnPush",F2[F2.Default=1]="Default",F2))(),D1=(()=>{return(n=D1||(D1={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",D1;var n})();const Q1=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Z={},v1=[],z5=y1({\u0275cmp:y1}),nh=y1({\u0275dir:y1}),rh=y1({\u0275pipe:y1}),_8=y1({\u0275mod:y1}),Zc=y1({\u0275fac:y1}),Yc=y1({__NG_ELEMENT_ID__:y1});let fT=0;function gt(n){return q3(()=>{const e=!0===n.standalone,r={},s={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===F2.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||v1,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||D1.Emulated,id:"c"+fT++,styles:n.styles||v1,_:null,setInput:null,schemas:n.schemas||null,tView:null},i=n.dependencies,o=n.features;return s.inputs=ih(n.inputs,r),s.outputs=ih(n.outputs),o&&o.forEach(c=>c(s)),s.directiveDefs=i?()=>("function"==typeof i?i():i).map(sh).filter(V5):null,s.pipeDefs=i?()=>("function"==typeof i?i():i).map(Xi).filter(V5):null,s})}function v8(n,t,e){const r=n.\u0275cmp;r.directiveDefs=()=>("function"==typeof t?t():t).map(sh),r.pipeDefs=()=>("function"==typeof e?e():e).map(Xi)}function sh(n){return S1(n)||Ki(n)}function V5(n){return null!==n}function ii(n){return q3(()=>({type:n.type,bootstrap:n.bootstrap||v1,declarations:n.declarations||v1,imports:n.imports||v1,exports:n.exports||v1,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function ih(n,t){if(null==n)return Z;const e={};for(const r in n)if(n.hasOwnProperty(r)){let s=n[r],i=s;Array.isArray(s)&&(i=s[1],s=s[0]),e[s]=r,t&&(t[s]=i)}return e}const $t=gt;function oi(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function S1(n){return n[z5]||null}function Ki(n){return n[nh]||null}function Xi(n){return n[rh]||null}function co(n,t){const e=n[_8]||null;if(!e&&!0===t)throw new Error(`Type ${j1(n)} does not have '\u0275mod' property.`);return e}function lo(n){return Array.isArray(n)&&"object"==typeof n[1]}function Mr(n){return Array.isArray(n)&&!0===n[1]}function $2(n){return 0!=(8&n.flags)}function Zo(n){return 2==(2&n.flags)}function Yo(n){return 1==(1&n.flags)}function ys(n){return null!==n.template}function O6(n){return 0!=(256&n[2])}function ya(n,t){return n.hasOwnProperty(Zc)?n[Zc]:null}class pT{constructor(t,e,r){this.previousValue=t,this.currentValue=e,this.firstChange=r}isFirstChange(){return this.firstChange}}function e2(){return S_}function S_(n){return n.type.prototype.ngOnChanges&&(n.setInput=P_),gT}function gT(){const n=G5(this),t=n?.current;if(t){const e=n.previous;if(e===Z)n.previous=t;else for(let r in t)e[r]=t[r];n.current=null,this.ngOnChanges(t)}}function P_(n,t,e,r){const s=G5(n)||function mT(n,t){return n[T_]=t}(n,{previous:Z,current:null}),i=s.current||(s.current={}),o=s.previous,c=this.declaredInputs[e],u=o[c];i[c]=new pT(u&&u.currentValue,t,o===Z),n[r]=t}e2.ngInherit=!0;const T_="__ngSimpleChanges__";function G5(n){return n[T_]||null}function Sr(n){for(;Array.isArray(n);)n=n[0];return n}function E8(n,t){return Sr(t[n])}function t2(n,t){return Sr(t[n.index])}function uh(n,t){return n.data[t]}function el(n,t){return n[t]}function Ni(n,t){const e=t[n];return lo(e)?e:e[0]}function I6(n){return 64==(64&n[2])}function Xc(n,t){return null==t?null:n[t]}function N_(n){n[18]=0}function fh(n,t){n[5]+=t;let e=n,r=n[3];for(;null!==r&&(1===t&&1===e[5]||-1===t&&0===e[5]);)r[5]+=t,e=r,r=r[3]}const an={lFrame:vh(null),bindingsEnabled:!0};function hh(){return an.bindingsEnabled}function Le(){return an.lFrame.lView}function Kn(){return an.lFrame.tView}function fe(n){return an.lFrame.contextLView=n,n[8]}function ae(n){return an.lFrame.contextLView=null,n}function Rr(){let n=A_();for(;null!==n&&64===n.type;)n=n.parent;return n}function A_(){return an.lFrame.currentTNode}function tl(){const n=an.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function ac(n,t){const e=an.lFrame;e.currentTNode=n,e.isParent=t}function jr(){return an.lFrame.isParent}function dh(){an.lFrame.isParent=!1}function Ai(){const n=an.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function cc(){return an.lFrame.bindingIndex}function k6(){return an.lFrame.bindingIndex++}function Xo(n){const t=an.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function n2(n){an.lFrame.inI18n=n}function wT(n,t){const e=an.lFrame;e.bindingIndex=e.bindingRootIndex=n,Qc(t)}function Qc(n){an.lFrame.currentDirectiveIndex=n}function mh(){return an.lFrame.currentQueryIndex}function S8(n){an.lFrame.currentQueryIndex=n}function x_(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function K5(n,t,e){if(e&qt.SkipSelf){let s=t,i=n;for(;!(s=s.parent,null!==s||e&qt.Host||(s=x_(i),null===s||(i=i[15],10&s.type))););if(null===s)return!1;t=s,n=i}const r=an.lFrame=_h();return r.currentTNode=t,r.lView=n,!0}function nl(n){const t=_h(),e=n[1];an.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function _h(){const n=an.lFrame,t=null===n?null:n.child;return null===t?vh(n):t}function vh(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function k_(){const n=an.lFrame;return an.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const P8=k_;function rl(){const n=k_();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function r2(){return an.lFrame.selectedIndex}function Jc(n){an.lFrame.selectedIndex=n}function P1(){const n=an.lFrame;return uh(n.tView,n.selectedIndex)}function B(){an.lFrame.currentNamespace="svg"}function n3(n,t){for(let e=t.directiveStart,r=t.directiveEnd;e<r;e++){const i=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:u,ngAfterViewChecked:h,ngOnDestroy:p}=i;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),u&&(n.viewHooks||(n.viewHooks=[])).push(-e,u),h&&((n.viewHooks||(n.viewHooks=[])).push(e,h),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,h)),null!=p&&(n.destroyHooks||(n.destroyHooks=[])).push(e,p)}}function Ea(n,t,e){L_(n,t,3,e)}function w8(n,t,e,r){(3&n[2])===e&&L_(n,t,e,r)}function b8(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function L_(n,t,e,r){const i=r??-1,o=t.length-1;let c=0;for(let u=void 0!==r?65535&n[18]:0;u<o;u++)if("number"==typeof t[u+1]){if(c=t[u],null!=r&&c>=r)break}else t[u]<0&&(n[18]+=65536),(c<i||-1==i)&&(R_(n,e,t,u),n[18]=(4294901760&n[18])+u+2),u++}function R_(n,t,e,r){const s=e[r]<0,i=e[r+1],c=n[s?-e[r]:e[r]];if(s){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{i.call(c)}finally{}}}else try{i.call(c)}finally{}}class O8{constructor(t,e,r){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=r}}function lc(n,t,e){let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const i=e[r++],o=e[r++],c=e[r++];n.setAttribute(t,o,c,i)}else{const i=s,o=e[++r];V_(i)?n.setProperty(t,i,o):n.setAttribute(t,i,o),r++}}return r}function z_(n){return 3===n||4===n||6===n}function V_(n){return 64===n.charCodeAt(0)}function D6(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?e=s:0===e||yh(n,e,s,null,-1===e||2===e?t[++r]:null)}}return n}function yh(n,t,e,r,s){let i=0,o=n.length;if(-1===t)o=-1;else for(;i<n.length;){const c=n[i++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=i-1;break}}}for(;i<n.length;){const c=n[i];if("number"==typeof c)break;if(c===e){if(null===r)return void(null!==s&&(n[i+1]=s));if(r===n[i+1])return void(n[i+2]=s)}i++,null!==r&&i++,null!==s&&i++}-1!==o&&(n.splice(o,0,t),i=o+1),n.splice(i++,0,e),null!==r&&n.splice(i++,0,r),null!==s&&n.splice(i++,0,s)}function Eh(n){return-1!==n}function il(n){return 32767&n}function ol(n,t){let e=function H_(n){return n>>16}(n),r=t;for(;e>0;)r=r[15],e--;return r}let Q5=!0;function Q3(n){const t=Q5;return Q5=n,t}let F_=0;const r3={};function J5(n,t){const e=A8(n,t);if(-1!==e)return e;const r=t[1];r.firstCreatePass&&(n.injectorIndex=t.length,Sh(r.data,n),Sh(t,null),Sh(r.blueprint,null));const s=Sa(n,t),i=n.injectorIndex;if(Eh(s)){const o=il(s),c=ol(s,t),u=c[1].data;for(let h=0;h<8;h++)t[i+h]=c[o+h]|u[o+h]}return t[i+8]=s,i}function Sh(n,t){n.push(0,0,0,0,0,0,0,0,t)}function A8(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Sa(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,r=null,s=t;for(;null!==s;){if(r=U_(s),null===r)return-1;if(e++,s=s[15],-1!==r.injectorIndex)return r.injectorIndex|e<<16}return-1}function z6(n,t,e){!function lF(n,t,e){let r;"string"==typeof e?r=e.charCodeAt(0)||0:e.hasOwnProperty(Yc)&&(r=e[Yc]),null==r&&(r=e[Yc]=F_++);const s=255&r;t.data[n+(s>>5)]|=1<<s}(n,t,e)}function Ph(n,t,e){if(e&qt.Optional||void 0!==n)return n;M6()}function Th(n,t,e,r){if(e&qt.Optional&&void 0===r&&(r=null),0==(e&(qt.Self|qt.Host))){const s=n[9],i=Go(void 0);try{return s?s.get(t,r,e&qt.Optional):th(t,r,e&qt.Optional)}finally{Go(i)}}return Ph(r,0,e)}function e7(n,t,e,r=qt.Default,s){if(null!==n){if(1024&t[2]){const o=function t7(n,t,e,r,s){let i=n,o=t;for(;null!==i&&null!==o&&1024&o[2]&&!(256&o[2]);){const c=J3(i,o,e,r|qt.Self,r3);if(c!==r3)return c;let u=i.parent;if(!u){const h=o[21];if(h){const p=h.get(e,r3,r);if(p!==r3)return p}u=U_(o),o=o[15]}i=u}return s}(n,t,e,r,r3);if(o!==r3)return o}const i=J3(n,t,e,r,r3);if(i!==r3)return i}return Th(t,e,r,s)}function J3(n,t,e,r,s){const i=function I8(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Yc)?n[Yc]:void 0;return"number"==typeof t?t>=0?255&t:H6:t}(e);if("function"==typeof i){if(!K5(t,n,r))return r&qt.Host?Ph(s,0,r):Th(t,e,r,s);try{const o=i(r);if(null!=o||r&qt.Optional)return o;M6()}finally{P8()}}else if("number"==typeof i){let o=null,c=A8(n,t),u=-1,h=r&qt.Host?t[16][6]:null;for((-1===c||r&qt.SkipSelf)&&(u=-1===c?Sa(n,t):t[c+8],-1!==u&&$_(r,!1)?(o=t[1],c=il(u),t=ol(u,t)):c=-1);-1!==c;){const p=t[1];if(B_(i,c,p.data)){const m=wh(c,t,e,o,r,h);if(m!==r3)return m}u=t[c+8],-1!==u&&$_(r,t[1].data[c+8]===h)&&B_(i,c,t)?(o=p,c=il(u),t=ol(u,t)):c=-1}}return s}function wh(n,t,e,r,s,i){const o=t[1],c=o.data[n+8],p=Zr(c,o,e,null==r?Zo(c)&&Q5:r!=o&&0!=(3&c.type),s&qt.Host&&i===c);return null!==p?Hs(t,o,p,c):r3}function Zr(n,t,e,r,s){const i=n.providerIndexes,o=t.data,c=1048575&i,u=n.directiveStart,p=i>>20,C=s?c+p:n.directiveEnd;for(let w=r?c:c+p;w<C;w++){const I=o[w];if(w<u&&e===I||w>=u&&I.type===e)return w}if(s){const w=o[u];if(w&&ys(w)&&w.type===e)return u}return null}function Hs(n,t,e,r){let s=n[e];const i=t.data;if(function bT(n){return n instanceof O8}(s)){const o=s;o.resolving&&function p8(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Ne(-200,`Circular dependency in DI detected for ${n}${e}`)}(function Lt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():tn(n)}(i[e]));const c=Q3(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Go(o.injectImpl):null;K5(n,r,qt.Default);try{s=n[e]=o.factory(void 0,i,n,r),t.firstCreatePass&&e>=r.directiveStart&&function R6(n,t,e){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:i}=t.type.prototype;if(r){const o=S_(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}s&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,s),i&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,i),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,i))}(e,i[e],t)}finally{null!==u&&Go(u),Q3(c),o.resolving=!1,P8()}}return s}function B_(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function $_(n,t){return!(n&qt.Self||n&qt.Host&&t)}class V6{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,r){return e7(this._tNode,this._lView,t,r,e)}}function H6(){return new V6(Rr(),Le())}function Dr(n){return q3(()=>{const t=n.prototype.constructor,e=t[Zc]||bh(t),r=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==r;){const i=s[Zc]||bh(s);if(i&&i!==e)return i;s=Object.getPrototypeOf(s)}return i=>new i})}function bh(n){return y6(n)?()=>{const t=bh(en(n));return t&&t()}:ya(n)}function U_(n){const t=n[1],e=t.type;return 2===e?t.declTNode:1===e?n[6]:null}function x8(n){return function NT(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const r=e.length;let s=0;for(;s<r;){const i=e[s];if(z_(i))break;if(0===i)s+=2;else if("number"==typeof i)for(s++;s<r&&"string"==typeof e[s];)s++;else{if(i===t)return e[s+1];s+=2}}}return null}(Rr(),n)}const F6="__parameters__";function ll(n,t,e){return q3(()=>{const r=function n7(n){return function(...e){if(n){const r=n(...e);for(const s in r)this[s]=r[s]}}}(t);function s(...i){if(this instanceof s)return r.apply(this,i),this;const o=new s(...i);return c.annotation=o,c;function c(u,h,p){const m=u.hasOwnProperty(F6)?u[F6]:Object.defineProperty(u,F6,{value:[]})[F6];for(;m.length<=p;)m.push(null);return(m[p]=m[p]||[]).push(o),u}}return e&&(s.prototype=Object.create(e.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class xt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=et({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function s2(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let r=n[e];Array.isArray(r)?(t===n&&(t=n.slice(0,e)),s2(r,t)):t!==n&&t.push(r)}return t}function Pa(n,t){n.forEach(e=>Array.isArray(e)?Pa(e,t):t(e))}function s3(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function U6(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function ul(n,t){const e=[];for(let r=0;r<n;r++)e.push(t);return e}function o2(n,t,e){let r=a2(n,t);return r>=0?n[1|r]=e:(r=~r,function Nh(n,t,e,r){let s=n.length;if(s==t)n.push(e,r);else if(1===s)n.push(r,n[0]),n[0]=e;else{for(s--,n.push(n[s-1],n[s]);s>t;)n[s]=n[s-2],s--;n[t]=e,n[t+1]=r}}(n,r,t,e)),r}function ai(n,t){const e=a2(n,t);if(e>=0)return n[1|e]}function a2(n,t){return function i7(n,t,e){let r=0,s=n.length>>e;for(;s!==r;){const i=r+(s-r>>1),o=n[i<<e];if(t===o)return i<<e;o>t?s=i:r=i+1}return~(s<<e)}(n,t,1)}const D8={},z8="__NG_DI_FLAG__",ci="ngTempTokenPath",kT=/\n/gm,c7="__source";let V8;function W6(n){const t=V8;return V8=n,t}function LT(n,t=qt.Default){if(void 0===V8)throw new Ne(-203,!1);return null===V8?th(n,void 0,t):V8.get(n,t&qt.Optional?null:void 0,t)}function Re(n,t=qt.Default){return(function QH(){return eh}()||LT)(en(n),t)}function zr(n,t=qt.Default){return"number"!=typeof t&&(t=0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)),Re(n,t)}function Lh(n){const t=[];for(let e=0;e<n.length;e++){const r=en(n[e]);if(Array.isArray(r)){if(0===r.length)throw new Ne(900,!1);let s,i=qt.Default;for(let o=0;o<r.length;o++){const c=r[o],u=K_(c);"number"==typeof u?-1===u?s=c.token:i|=u:s=c}t.push(Re(s,i))}else t.push(Re(r))}return t}function fl(n,t){return n[z8]=t,n.prototype[z8]=t,n}function K_(n){return n[z8]}const li=fl(ll("Optional"),8),H8=fl(ll("SkipSelf"),4);let $h,u7,f7;function Q_(){return void 0!==$h?$h:typeof document<"u"?document:void 0}function n4(n){return function Uh(){if(void 0===u7&&(u7=null,Q1.trustedTypes))try{u7=Q1.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return u7}()?.createHTML(n)||n}function h7(n){return function Gh(){if(void 0===f7&&(f7=null,Q1.trustedTypes))try{f7=Q1.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return f7}()?.createHTML(n)||n}class r4{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class qT extends r4{getTypeName(){return"HTML"}}class jT extends r4{getTypeName(){return"Style"}}class ZT extends r4{getTypeName(){return"Script"}}class ev extends r4{getTypeName(){return"URL"}}class tv extends r4{getTypeName(){return"ResourceURL"}}function fo(n){return n instanceof r4?n.changingThisBreaksApplicationSecurity:n}function ho(n,t){const e=function nv(n){return n instanceof r4&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function iv(n){const t=new kt(n);return function QT(){try{return!!(new window.DOMParser).parseFromString(n4(""),"text/html")}catch{return!1}}()?new ov(t):t}class ov{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(n4(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class kt{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const r=this.inertDocument.createElement("body");e.appendChild(r)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=n4(t),e;const r=this.inertDocument.createElement("body");return r.innerHTML=n4(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}stripCustomNsAttrs(t){const e=t.attributes;for(let s=e.length-1;0<s;s--){const o=e.item(s).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let r=t.firstChild;for(;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}const av=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function ta(n){return(n=String(n)).match(av)?n:"unsafe:"+n}function fc(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function $8(...n){const t={};for(const e of n)for(const r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}const cv=fc("area,br,col,hr,img,wbr"),lv=fc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),d7=fc("rp,rt"),U8=$8(cv,$8(lv,fc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$8(d7,fc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),$8(d7,lv)),p7=fc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),g7=$8(p7,fc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),fc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),JT=fc("script,style,template");class ew{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,r=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?r=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,r&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let s=this.checkClobberedElement(e,e.nextSibling);if(s){e=s;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!U8.hasOwnProperty(e))return this.sanitizedSomething=!0,!JT.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const r=t.attributes;for(let s=0;s<r.length;s++){const i=r.item(s),o=i.name,c=o.toLowerCase();if(!g7.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let u=i.value;p7[c]&&(u=ta(u)),this.buf.push(" ",o,'="',fv(u),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();U8.hasOwnProperty(e)&&!cv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(fv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const tw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,nw=/([^\#-~ |!])/g;function fv(n){return n.replace(/&/g,"&amp;").replace(tw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(nw,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let m7;function qh(n,t){let e=null;try{m7=m7||iv(n);let r=t?String(t):"";e=m7.getInertBodyElement(r);let s=5,i=r;do{if(0===s)throw new Error("Failed to sanitize html because the input is unstable");s--,r=i,i=e.innerHTML,e=m7.getInertBodyElement(r)}while(r!==i);return n4((new ew).sanitizeChildren(po(e)||e))}finally{if(e){const r=po(e)||e;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function po(n){return"content"in n&&function G8(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var J1=(()=>((J1=J1||{})[J1.NONE=0]="NONE",J1[J1.HTML=1]="HTML",J1[J1.STYLE=2]="STYLE",J1[J1.SCRIPT=3]="SCRIPT",J1[J1.URL=4]="URL",J1[J1.RESOURCE_URL=5]="RESOURCE_URL",J1))();function W8(n){const t=Y6();return t?h7(t.sanitize(J1.HTML,n)||""):ho(n,"HTML")?h7(fo(n)):qh(Q_(),tn(n))}function i3(n){const t=Y6();return t?t.sanitize(J1.URL,n)||"":ho(n,"URL")?fo(n):ta(tn(n))}function Y6(){const n=Le();return n&&n[12]}const Y8=new xt("ENVIRONMENT_INITIALIZER"),dv=new xt("INJECTOR",-1),pv=new xt("INJECTOR_DEF_TYPES");class gv{get(t,e=D8){if(e===D8){const r=new Error(`NullInjectorError: No provider for ${j1(t)}!`);throw r.name="NullInjectorError",r}return e}}function K8(...n){return{\u0275providers:Zh(0,n)}}function Zh(n,...t){const e=[],r=new Set;let s;return Pa(t,i=>{const o=i;o3(o,e,[],r)&&(s||(s=[]),s.push(o))}),void 0!==s&&mv(s,e),e}function mv(n,t){for(let e=0;e<n.length;e++){const{providers:s}=n[e];Pa(s,i=>{t.push(i)})}}function o3(n,t,e,r){if(!(n=en(n)))return!1;let s=null,i=m8(n);const o=!i&&S1(n);if(i||o){if(o&&!o.standalone)return!1;s=n}else{const u=n.ngModule;if(i=m8(u),!i)return!1;s=u}const c=r.has(s);if(o){if(c)return!1;if(r.add(s),o.dependencies){const u="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const h of u)o3(h,t,e,r)}}else{if(!i)return!1;{if(null!=i.imports&&!c){let h;r.add(s);try{Pa(i.imports,p=>{o3(p,t,e,r)&&(h||(h=[]),h.push(p))})}finally{}void 0!==h&&mv(h,t)}if(!c){const h=ya(s)||(()=>new s);t.push({provide:s,useFactory:h,deps:v1},{provide:pv,useValue:s,multi:!0},{provide:Y8,useValue:()=>Re(s),multi:!0})}const u=i.providers;null==u||c||Pa(u,p=>{t.push(p)})}}return s!==n&&void 0!==n.providers}const rw=y1({provide:String,useValue:y1});function c2(n){return null!==n&&"object"==typeof n&&rw in n}function pl(n){return"function"==typeof n}const Kh=new xt("Set Injector scope."),v7={},Cv={};let Xh;function s4(){return void 0===Xh&&(Xh=new gv),Xh}class wa{}class C7 extends wa{constructor(t,e,r,s){super(),this.parent=e,this.source=r,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,E7(t,o=>this.processProvider(o)),this.records.set(dv,gl(void 0,this)),s.has("environment")&&this.records.set(wa,gl(void 0,this));const i=this.records.get(Kh);null!=i&&"string"==typeof i.value&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(pv.multi,v1,qt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=W6(this),r=Go(void 0);try{return t()}finally{W6(e),Go(r)}}get(t,e=D8,r=qt.Default){this.assertNotDestroyed();const s=W6(this),i=Go(void 0);try{if(!(r&qt.SkipSelf)){let c=this.records.get(t);if(void 0===c){const u=function Mv(n){return"function"==typeof n||"object"==typeof n&&n instanceof xt}(t)&&In(t);c=u&&this.injectableDefInScope(u)?gl(go(t),v7):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(r&qt.Self?s4():this.parent).get(t,e=r&qt.Optional&&e===D8?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[ci]=o[ci]||[]).unshift(j1(t)),s)throw o;return function RT(n,t,e,r){const s=n[ci];throw t[c7]&&s.unshift(t[c7]),n.message=function Wn(n,t,e,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let s=j1(t);if(Array.isArray(t))s=t.map(j1).join(" -> ");else if("object"==typeof t){let i=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];i.push(o+":"+("string"==typeof c?JSON.stringify(c):j1(c)))}s=`{${i.join(", ")}}`}return`${e}${r?"("+r+")":""}[${s}]: ${n.replace(kT,"\n  ")}`}("\n"+n.message,s,e,r),n.ngTokenPath=s,n[ci]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{Go(i),W6(s)}}resolveInjectorInitializers(){const t=W6(this),e=Go(void 0);try{const r=this.get(Y8.multi,v1,qt.Self);for(const s of r)s()}finally{W6(t),Go(e)}}toString(){const t=[],e=this.records;for(const r of e.keys())t.push(j1(r));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ne(205,!1)}processProvider(t){let e=pl(t=en(t))?t:en(t&&t.provide);const r=function iw(n){return c2(n)?gl(void 0,n.useValue):gl(y7(n),v7)}(t);if(pl(t)||!0!==t.multi)this.records.get(e);else{let s=this.records.get(e);s||(s=gl(void 0,v7,!0),s.factory=()=>Lh(s.multi),this.records.set(e,s)),e=t,s.multi.push(t)}this.records.set(e,r)}hydrate(t,e){return e.value===v7&&(e.value=Cv,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Ev(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=en(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function go(n){const t=In(n),e=null!==t?t.factory:ya(n);if(null!==e)return e;if(n instanceof xt)throw new Ne(204,!1);if(n instanceof Function)return function X8(n){const t=n.length;if(t>0)throw ul(t,"?"),new Ne(204,!1);const e=function v_(n){const t=n&&(n[S6]||n[Q9]);if(t){const e=function si(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Ne(204,!1)}function y7(n,t,e){let r;if(pl(n)){const s=en(n);return ya(s)||go(s)}if(c2(n))r=()=>en(n.useValue);else if(function vv(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...Lh(n.deps||[]));else if(function Yh(n){return!(!n||!n.useExisting)}(n))r=()=>Re(en(n.useExisting));else{const s=en(n&&(n.useClass||n.provide));if(!function yv(n){return!!n.deps}(n))return ya(s)||go(s);r=()=>new s(...Lh(n.deps))}return r}function gl(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function ow(n){return!!n.\u0275providers}function E7(n,t){for(const e of n)Array.isArray(e)?E7(e,t):ow(e)?E7(e.\u0275providers,t):t(e)}class Sv{}class uw{resolveComponentFactory(t){throw function cw(n){const t=Error(`No component factory found for ${j1(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let ba=(()=>{class n{}return n.NULL=new uw,n})();function EF(){return K6(Rr(),Le())}function K6(n,t){return new l2(t2(n,t))}let l2=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=EF,n})();function M7(n){return n instanceof l2?n.nativeElement:n}class X6{}let mo=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function fw(){const n=Le(),e=Ni(Rr().index,n);return(lo(e)?e:n)[11]}(),n})(),MF=(()=>{class n{}return n.\u0275prov=et({token:n,providedIn:"root",factory:()=>null}),n})();class Q6{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Pv=new Q6("14.2.10"),ed={};function nd(n){return n.ngOriginalError}class J6{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&nd(t);for(;e&&nd(e);)e=nd(e);return e||null}}const yw=/^>|^->|<!--|-->|--!>|<!-$/g,Ew=/(<|>)/;const rd=new Map;let Ov=0;const w7="__ngContext__";function Li(n,t){lo(t)?(n[w7]=t[20],function bw(n){rd.set(n[20],n)}(t)):n[w7]=t}function Oa(n){return n instanceof Function?n():n}var f2=(()=>((f2=f2||{})[f2.Important=1]="Important",f2[f2.DashCase=2]="DashCase",f2))();let od;function ad(n,t){return od(n,t)}function eu(n){const t=n[3];return Mr(t)?t[3]:t}function cd(n){return hc(n[13])}function ld(n){return hc(n[4])}function hc(n){for(;null!==n&&!Mr(n);)n=n[4];return n}function ml(n,t,e,r,s){if(null!=r){let i,o=!1;Mr(r)?i=r:lo(r)&&(o=!0,r=r[0]);const c=Sr(r);0===n&&null!==e?null==s?Uv(t,e,c):l3(t,e,c,s||null,!0):1===n&&null!==e?l3(t,e,c,s||null,!0):2===n?Yv(t,c,o):3===n&&t.destroyNode(c),null!=i&&function Zw(n,t,e,r,s){const i=e[7];i!==Sr(e)&&ml(t,n,r,i,s);for(let c=10;c<e.length;c++){const u=e[c];n0(u[1],u,n,t,r,i)}}(t,n,i,e,s)}}function ud(n,t){return n.createText(t)}function Hv(n,t,e){n.setValue(t,e)}function Hw(n,t){return n.createComment(function bv(n){return n.replace(yw,t=>t.replace(Ew,"\u200b$1\u200b"))}(t))}function fd(n,t,e){return n.createElement(t,e)}function Fv(n,t){const e=n[9],r=e.indexOf(t),s=t[3];512&t[2]&&(t[2]&=-513,fh(s,-1)),e.splice(r,1)}function hd(n,t){if(n.length<=10)return;const e=10+t,r=n[e];if(r){const s=r[17];null!==s&&s!==n&&Fv(s,r),t>0&&(n[e-1][4]=r[4]);const i=U6(n,10+t);!function Fw(n,t){n0(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(r[1],r);const o=i[19];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-65}return r}function Bv(n,t){if(!(128&t[2])){const e=t[11];e.destroyNode&&n0(n,t,e,3,null,null),function Uw(n){let t=n[13];if(!t)return dd(n[1],n);for(;t;){let e=null;if(lo(t))e=t[13];else{const r=t[10];r&&(e=r)}if(!e){for(;t&&!t[4]&&t!==n;)lo(t)&&dd(t[1],t),t=t[3];null===t&&(t=n),lo(t)&&dd(t[1],t),e=t&&t[4]}t=e}}(t)}}function dd(n,t){if(!(128&t[2])){t[2]&=-65,t[2]|=128,function qw(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let r=0;r<e.length;r+=2){const s=t[e[r]];if(!(s instanceof O8)){const i=e[r+1];if(Array.isArray(i))for(let o=0;o<i.length;o+=2){const c=s[i[o]],u=i[o+1];try{u.call(c)}finally{}}else try{i.call(s)}finally{}}}}(n,t),function pd(n,t){const e=n.cleanup,r=t[7];let s=-1;if(null!==e)for(let i=0;i<e.length-1;i+=2)if("string"==typeof e[i]){const o=e[i+1],c="function"==typeof o?o(t):Sr(t[o]),u=r[s=e[i+2]],h=e[i+3];"boolean"==typeof h?c.removeEventListener(e[i],u,h):h>=0?r[s=h]():r[s=-h].unsubscribe(),i+=2}else{const o=r[s=e[i+1]];e[i].call(o)}if(null!==r){for(let i=s+1;i<r.length;i++)(0,r[i])();t[7]=null}}(n,t),1===t[1].type&&t[11].destroy();const e=t[17];if(null!==e&&Mr(t[3])){e!==t[3]&&Fv(e,t);const r=t[19];null!==r&&r.detachView(n)}!function Ow(n){rd.delete(n[20])}(t)}}function $v(n,t,e){return gd(n,t.parent,e)}function gd(n,t,e){let r=t;for(;null!==r&&40&r.type;)r=(t=r).parent;if(null===r)return e[0];if(2&r.flags){const s=n.data[r.directiveStart].encapsulation;if(s===D1.None||s===D1.Emulated)return null}return t2(r,e)}function l3(n,t,e,r,s){n.insertBefore(t,e,r,s)}function Uv(n,t,e){n.appendChild(t,e)}function u3(n,t,e,r,s){null!==r?l3(n,t,e,r,s):Uv(n,t,e)}function e0(n,t){return n.parentNode(t)}function qv(n,t,e){return Zv(n,t,e)}function jv(n,t,e){return 40&n.type?t2(n,e):null}let md,Zv=jv;function O7(n,t){Zv=n,md=t}function tu(n,t,e,r){const s=$v(n,r,t),i=t[11],c=qv(r.parent||t[6],r,t);if(null!=s)if(Array.isArray(e))for(let u=0;u<e.length;u++)u3(i,s,e[u],c,!1);else u3(i,s,e,c,!1);void 0!==md&&md(i,r,t,e,s)}function nu(n,t){if(null!==t){const e=t.type;if(3&e)return t2(t,n);if(4&e)return t0(-1,n[t.index]);if(8&e){const r=t.child;if(null!==r)return nu(n,r);{const s=n[t.index];return Mr(s)?t0(-1,s):Sr(s)}}if(32&e)return ad(t,n)()||Sr(n[t.index]);{const r=_l(n,t);return null!==r?Array.isArray(r)?r[0]:nu(eu(n[16]),r):nu(n,t.next)}}return null}function _l(n,t){return null!==t?n[16][6].projection[t.projection]:null}function t0(n,t){const e=10+n+1;if(e<t.length){const r=t[e],s=r[1].firstChild;if(null!==s)return nu(r,s)}return t[7]}function Yv(n,t,e){const r=e0(n,t);r&&function Gv(n,t,e,r){n.removeChild(t,e,r)}(n,r,t,e)}function _d(n,t,e,r,s,i,o){for(;null!=e;){const c=r[e.index],u=e.type;if(o&&0===t&&(c&&Li(Sr(c),r),e.flags|=4),64!=(64&e.flags))if(8&u)_d(n,t,e.child,r,s,i,!1),ml(t,n,s,c,i);else if(32&u){const h=ad(e,r);let p;for(;p=h();)ml(t,n,s,p,i);ml(t,n,s,c,i)}else 16&u?Kv(n,t,r,e,s,i):ml(t,n,s,c,i);e=o?e.projectionNext:e.next}}function n0(n,t,e,r,s,i){_d(e,r,n.firstChild,t,s,i,!1)}function Kv(n,t,e,r,s,i){const o=e[16],u=o[6].projection[r.projection];if(Array.isArray(u))for(let h=0;h<u.length;h++)ml(t,n,s,u[h],i);else _d(n,t,u,o[3],s,i,!0)}function ru(n,t,e){n.setAttribute(t,"style",e)}function N7(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function Qv(n,t,e){let r=n.length;for(;;){const s=n.indexOf(t,e);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const i=t.length;if(s+i===r||n.charCodeAt(s+i)<=32)return s}e=s+1}}const Jv="ng-template";function vd(n,t,e){let r=0;for(;r<n.length;){let s=n[r++];if(e&&"class"===s){if(s=n[r],-1!==Qv(s.toLowerCase(),t,0))return!0}else if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===t)return!0;return!1}}return!1}function su(n){return 4===n.type&&n.value!==Jv}function eC(n,t,e){return t===(4!==n.type||e?n.value:Jv)}function Yw(n,t,e){let r=4;const s=n.attrs||[],i=function Kw(n){for(let t=0;t<n.length;t++)if(z_(n[t]))return t;return n.length}(s);let o=!1;for(let c=0;c<t.length;c++){const u=t[c];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!eC(n,u,e)||""===u&&1===t.length){if(Na(r))return!1;o=!0}}else{const h=8&r?u:t[++c];if(8&r&&null!==n.attrs){if(!vd(n.attrs,h,e)){if(Na(r))return!1;o=!0}continue}const m=tC(8&r?"class":u,s,su(n),e);if(-1===m){if(Na(r))return!1;o=!0;continue}if(""!==h){let C;C=m>i?"":s[m+1].toLowerCase();const w=8&r?C:null;if(w&&-1!==Qv(w,h,0)||2&r&&h!==C){if(Na(r))return!1;o=!0}}}}else{if(!o&&!Na(r)&&!Na(u))return!1;if(o&&Na(u))continue;o=!1,r=u|1&r}}return Na(r)||o}function Na(n){return 0==(1&n)}function tC(n,t,e,r){if(null===t)return-1;let s=0;if(r||!e){let i=!1;for(;s<t.length;){const o=t[s];if(o===n)return s;if(3===o||6===o)i=!0;else{if(1===o||2===o){let c=t[++s];for(;"string"==typeof c;)c=t[++s];continue}if(4===o)break;if(0===o){s+=4;continue}}s+=i?1:2}return-1}return function Xw(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const r=n[e];if("number"==typeof r)return-1;if(r===t)return e;e++}return-1}(t,n)}function nC(n,t,e=!1){for(let r=0;r<t.length;r++)if(Yw(n,t[r],e))return!0;return!1}function sC(n,t){e:for(let e=0;e<t.length;e++){const r=t[e];if(n.length===r.length){for(let s=0;s<n.length;s++)if(n[s]!==r[s])continue e;return!0}}return!1}function Cd(n,t){return n?":not("+t.trim()+")":t}function Qw(n){let t=n[0],e=1,r=2,s="",i=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&r){const c=n[++e];s+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&r?s+="."+o:4&r&&(s+=" "+o);else""!==s&&!Na(o)&&(t+=Cd(i,s),s=""),r=o,i=i||!Na(r);e++}return""!==s&&(t+=Cd(i,s)),t}const fn={};function S(n){oC(Kn(),Le(),r2()+n,!1)}function oC(n,t,e,r){if(!r)if(3==(3&t[2])){const i=n.preOrderCheckHooks;null!==i&&Ea(t,i,e)}else{const i=n.preOrderHooks;null!==i&&w8(t,i,0,e)}Jc(e)}function Sd(n,t=null,e=null,r){const s=lC(n,t,e,r);return s.resolveInjectorInitializers(),s}function lC(n,t=null,e=null,r,s=new Set){const i=[e||v1,K8(n)];return r=r||("object"==typeof n?void 0:j1(n)),new C7(i,t||s4(),r||null,s)}let ui=(()=>{class n{static create(e,r){if(Array.isArray(e))return Sd({name:""},r,e,"");{const s=e.name??"";return Sd({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=D8,n.NULL=new gv,n.\u0275prov=et({token:n,providedIn:"any",factory:()=>Re(dv)}),n.__NG_ELEMENT_ID__=-1,n})();function Q(n,t=qt.Default){const e=Le();return null===e?Re(n,t):e7(Rr(),e,en(n),t)}function k7(){throw new Error("invalid")}function L7(n,t){return n<<17|t<<2}function Aa(n){return n>>17&32767}function Id(n){return 2|n}function dc(n){return(131068&n)>>2}function Cl(n,t){return-131069&n|t<<2}function xd(n){return 1|n}function MC(n,t){const e=n.contentQueries;if(null!==e)for(let r=0;r<e.length;r+=2){const s=e[r],i=e[r+1];if(-1!==i){const o=n.data[i];S8(s),o.contentQueries(2,t[i],i)}}}function H7(n,t,e,r,s,i,o,c,u,h,p){const m=t.blueprint.slice();return m[0]=s,m[2]=76|r,(null!==p||n&&1024&n[2])&&(m[2]|=1024),N_(m),m[3]=m[15]=n,m[8]=e,m[10]=o||n&&n[10],m[11]=c||n&&n[11],m[12]=u||n&&n[12]||null,m[9]=h||n&&n[9]||null,m[6]=i,m[20]=function fr(){return Ov++}(),m[21]=p,m[16]=2==t.type?n[16]:m,m}function s0(n,t,e,r,s){let i=n.data[t];if(null===i)i=F7(n,t,e,r,s),function Qo(){return an.lFrame.inI18n}()&&(i.flags|=64);else if(64&i.type){i.type=e,i.value=r,i.attrs=s;const o=tl();i.injectorIndex=null===o?-1:o.injectorIndex}return ac(i,!0),i}function F7(n,t,e,r,s){const i=A_(),o=jr(),u=n.data[t]=function YF(n,t,e,r,s,i){return{type:e,index:r,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?i:i&&i.parent,e,t,r,s);return null===n.firstChild&&(n.firstChild=u),null!==i&&(o?null==i.child&&null!==u.parent&&(i.child=u):null===i.next&&(i.next=u)),u}function yl(n,t,e,r){if(0===e)return-1;const s=t.length;for(let i=0;i<e;i++)t.push(r),n.blueprint.push(r),n.data.push(null);return s}function B7(n,t,e){nl(t);try{const r=n.viewQuery;null!==r&&Gd(1,r,e);const s=n.template;null!==s&&SC(n,t,s,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&MC(n,t),n.staticViewQueries&&Gd(2,n.viewQuery,e);const i=n.components;null!==i&&function Pb(n,t){for(let e=0;e<t.length;e++)nB(n,t[e])}(t,i)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{t[2]&=-5,rl()}}function $7(n,t,e,r){const s=t[2];if(128!=(128&s)){nl(t);try{N_(t),function I_(n){return an.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&SC(n,t,e,2,r);const o=3==(3&s);if(o){const h=n.preOrderCheckHooks;null!==h&&Ea(t,h,null)}else{const h=n.preOrderHooks;null!==h&&w8(t,h,0,null),b8(t,0)}if(function tB(n){for(let t=cd(n);null!==t;t=ld(t)){if(!t[2])continue;const e=t[9];for(let r=0;r<e.length;r++){const s=e[r],i=s[3];0==(512&s[2])&&fh(i,1),s[2]|=512}}}(t),function Lb(n){for(let t=cd(n);null!==t;t=ld(t))for(let e=10;e<t.length;e++){const r=t[e],s=r[1];I6(r)&&$7(s,r,s.template,r[8])}}(t),null!==n.contentQueries&&MC(n,t),o){const h=n.contentCheckHooks;null!==h&&Ea(t,h)}else{const h=n.contentHooks;null!==h&&w8(t,h,1),b8(t,1)}!function Hd(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let r=0;r<e.length;r++){const s=e[r];if(s<0)Jc(~s);else{const i=s,o=e[++r],c=e[++r];wT(o,i),c(2,t[i])}}}finally{Jc(-1)}}(n,t);const c=n.components;null!==c&&function Sb(n,t){for(let e=0;e<t.length;e++)Rb(n,t[e])}(t,c);const u=n.viewQuery;if(null!==u&&Gd(2,u,r),o){const h=n.viewCheckHooks;null!==h&&Ea(t,h)}else{const h=n.viewHooks;null!==h&&w8(t,h,2),b8(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-41,512&t[2]&&(t[2]&=-513,fh(t[3],-1))}finally{rl()}}}function SC(n,t,e,r,s){const i=r2(),o=2&r;try{Jc(-1),o&&t.length>22&&oC(n,t,22,!1),e(r,s)}finally{Jc(i)}}function PC(n,t,e){if($2(t)){const s=t.directiveEnd;for(let i=t.directiveStart;i<s;i++){const o=n.data[i];o.contentQueries&&o.contentQueries(1,e[i],i)}}}function Fd(n,t,e){!hh()||(function OC(n,t,e,r){const s=e.directiveStart,i=e.directiveEnd;n.firstCreatePass||J5(e,t),Li(r,t);const o=e.initialInputs;for(let c=s;c<i;c++){const u=n.data[c],h=ys(u);h&&xb(t,e,u);const p=Hs(t,n,c,e);Li(p,t),null!==o&&eB(0,c-s,p,u,0,o),h&&(Ni(e.index,t)[8]=p)}}(n,t,e,t2(e,t)),128==(128&e.flags)&&function Nb(n,t,e){const r=e.directiveStart,s=e.directiveEnd,i=e.index,o=function gh(){return an.lFrame.currentDirectiveIndex}();try{Jc(i);for(let c=r;c<s;c++){const u=n.data[c],h=t[c];Qc(c),(null!==u.hostBindings||0!==u.hostVars||null!==u.hostAttrs)&&Ab(u,h)}}finally{Jc(-1),Qc(o)}}(n,t,e))}function o0(n,t,e=t2){const r=t.localNames;if(null!==r){let s=t.index+1;for(let i=0;i<r.length;i+=2){const o=r[i+1],c=-1===o?e(t,n):n[o];n[s++]=c}}}function TC(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=wC(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function wC(n,t,e,r,s,i,o,c,u,h){const p=22+r,m=p+s,C=function Tb(n,t){const e=[];for(let r=0;r<t;r++)e.push(r<n?null:fn);return e}(p,m),w="function"==typeof h?h():h;return C[1]={type:n,blueprint:C,template:e,queries:null,viewQuery:c,declTNode:t,data:C.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:w,incompleteFirstPass:!1}}function bb(n,t,e,r){const s=RC(t);null===e?s.push(r):(s.push(e),n.firstCreatePass&&DC(n).push(r,s.length-1))}function a0(n,t,e){for(let r in n)if(n.hasOwnProperty(r)){const s=n[r];(e=null===e?{}:e).hasOwnProperty(r)?e[r].push(t,s):e[r]=[t,s]}return e}function U7(n,t){const r=t.directiveEnd,s=n.data,i=t.attrs,o=[];let c=null,u=null;for(let h=t.directiveStart;h<r;h++){const p=s[h],m=p.inputs,C=null===i||su(t)?null:kb(m,i);o.push(C),c=a0(m,h,c),u=a0(p.outputs,h,u)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=u}function _o(n,t,e,r,s,i,o,c){const u=t2(t,e);let p,h=t.inputs;!c&&null!=h&&(p=h[r])?(Z7(n,e,p,r,s),Zo(t)&&bC(e,t.index)):3&t.type&&(r=function G7(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),s=null!=o?o(s,t.value||"",r):s,i.setProperty(u,r,s))}function bC(n,t){const e=Ni(t,n);16&e[2]||(e[2]|=32)}function El(n,t,e,r){let s=!1;if(hh()){const i=function NC(n,t,e){const r=n.directiveRegistry;let s=null;if(r)for(let i=0;i<r.length;i++){const o=r[i];nC(e,o.selectors,!1)&&(s||(s=[]),z6(J5(e,t),n,o.type),ys(o)?(Bd(n,e),s.unshift(o)):s.push(o))}return s}(n,t,e),o=null===r?null:{"":-1};if(null!==i){s=!0,AC(e,n.data.length,i.length);for(let p=0;p<i.length;p++){const m=i[p];m.providersResolver&&m.providersResolver(m)}let c=!1,u=!1,h=yl(n,t,i.length,null);for(let p=0;p<i.length;p++){const m=i[p];e.mergedAttrs=D6(e.mergedAttrs,m.hostAttrs),IC(n,e,t,h,m),JF(h,m,o),null!==m.contentQueries&&(e.flags|=8),(null!==m.hostBindings||null!==m.hostAttrs||0!==m.hostVars)&&(e.flags|=128);const C=m.type.prototype;!c&&(C.ngOnChanges||C.ngOnInit||C.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!u&&(C.ngOnChanges||C.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),u=!0),h++}U7(n,e)}o&&function Ib(n,t,e){if(t){const r=n.localNames=[];for(let s=0;s<t.length;s+=2){const i=e[t[s+1]];if(null==i)throw new Ne(-301,!1);r.push(t[s],i)}}}(e,r,o)}return e.mergedAttrs=D6(e.mergedAttrs,e.attrs),s}function W7(n,t,e,r,s,i){const o=i.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const u=~t.index;(function Ob(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=u&&c.push(u),c.push(r,s,o)}}function Ab(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function Bd(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function JF(n,t,e){if(e){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)e[t.exportAs[r]]=n;ys(t)&&(e[""]=n)}}function AC(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function IC(n,t,e,r,s){n.data[r]=s;const i=s.factory||(s.factory=ya(s.type)),o=new O8(i,ys(s),Q);n.blueprint[r]=o,e[r]=o,W7(n,t,0,r,yl(n,e,s.hostVars,fn),s)}function xb(n,t,e){const r=t2(t,n),s=TC(e),i=n[10],o=q7(n,H7(n,s,null,e.onPush?32:16,r,t,i,i.createRenderer(r,e),null,null,null));n[t.index]=o}function pc(n,t,e,r,s,i){const o=t2(n,t);$d(t[11],o,i,n.value,e,r,s)}function $d(n,t,e,r,s,i,o){if(null==i)n.removeAttribute(t,s,e);else{const c=null==o?tn(i):o(i,r||"",s);n.setAttribute(t,s,c,e)}}function eB(n,t,e,r,s,i){const o=i[t];if(null!==o){const c=r.setInput;for(let u=0;u<o.length;){const h=o[u++],p=o[u++],m=o[u++];null!==c?r.setInput(e,m,h,p):e[p]=m}}}function kb(n,t){let e=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;n.hasOwnProperty(s)&&(null===e&&(e=[]),e.push(s,n[s],t[r+1])),r+=2}else r+=2;else r+=4}return e}function xC(n,t,e,r){return new Array(n,!0,!1,t,null,0,r,e,null,null)}function Rb(n,t){const e=Ni(t,n);if(I6(e)){const r=e[1];48&e[2]?$7(r,e,r.template,e[8]):e[5]>0&&Ud(e)}}function Ud(n){for(let r=cd(n);null!==r;r=ld(r))for(let s=10;s<r.length;s++){const i=r[s];if(I6(i))if(512&i[2]){const o=i[1];$7(o,i,o.template,i[8])}else i[5]>0&&Ud(i)}const e=n[1].components;if(null!==e)for(let r=0;r<e.length;r++){const s=Ni(e[r],n);I6(s)&&s[5]>0&&Ud(s)}}function nB(n,t){const e=Ni(t,n),r=e[1];(function Db(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(r,e),B7(r,e,e[8])}function q7(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function kC(n){for(;n;){n[2]|=32;const t=eu(n);if(O6(n)&&!t)return n;n=t}return null}function j7(n,t,e,r=!0){const s=t[10];s.begin&&s.begin();try{$7(n,t,n.template,e)}catch(o){throw r&&VC(t,o),o}finally{s.end&&s.end()}}function Gd(n,t,e){S8(0),t(n,e)}function RC(n){return n[7]||(n[7]=[])}function DC(n){return n.cleanup||(n.cleanup=[])}function VC(n,t){const e=n[9],r=e?e.get(J6,null):null;r&&r.handleError(t)}function Z7(n,t,e,r,s){for(let i=0;i<e.length;){const o=e[i++],c=e[i++],u=t[o],h=n.data[o];null!==h.setInput?h.setInput(u,s,r,c):u[c]=s}}function h3(n,t,e){const r=E8(t,n);Hv(n[11],r,e)}function ou(n,t,e){let r=e?n.styles:null,s=e?n.classes:null,i=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?i=c:1==i?s=d8(s,c):2==i&&(r=d8(r,c+": "+t[++o]+";"))}e?n.styles=r:n.stylesWithoutHost=r,e?n.classes=s:n.classesWithoutHost=s}function Y7(n,t,e,r,s=!1){for(;null!==e;){const i=t[e.index];if(null!==i&&r.push(Sr(i)),Mr(i))for(let c=10;c<i.length;c++){const u=i[c],h=u[1].firstChild;null!==h&&Y7(u[1],u,h,r)}const o=e.type;if(8&o)Y7(n,t,e.child,r);else if(32&o){const c=ad(e,t);let u;for(;u=c();)r.push(u)}else if(16&o){const c=_l(t,e);if(Array.isArray(c))r.push(...c);else{const u=eu(t[16]);Y7(u[1],u,c,r,!0)}}e=s?e.projectionNext:e.next}return r}class K7{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Y7(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Mr(t)){const e=t[8],r=e?e.indexOf(this):-1;r>-1&&(hd(t,r),U6(e,r))}this._attachedToViewContainer=!1}Bv(this._lView[1],this._lView)}onDestroy(t){bb(this._lView[1],this._lView,null,t)}markForCheck(){kC(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){j7(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ne(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function $w(n,t){n0(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Ne(902,!1);this._appRef=t}}class Vb extends K7{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;j7(t[1],t,t[8],!1)}checkNoChanges(){}get context(){return null}}class Wd extends ba{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=S1(t);return new au(e,this.ngModule)}}function Hb(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class FC{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,r){const s=this.injector.get(t,ed,r);return s!==ed||e===ed?s:this.parentInjector.get(t,e,r)}}class au extends Sv{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function Jw(n){return n.map(Qw).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Hb(this.componentDef.inputs)}get outputs(){return Hb(this.componentDef.outputs)}create(t,e,r,s){let i=(s=s||this.ngModule)instanceof wa?s:s?.injector;i&&null!==this.componentDef.getStandaloneInjector&&(i=this.componentDef.getStandaloneInjector(i)||i);const o=i?new FC(t,i):t,c=o.get(X6,null);if(null===c)throw new Ne(407,!1);const u=o.get(MF,null),h=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",m=r?function wb(n,t,e){return n.selectRootElement(t,e===D1.ShadowDom)}(h,r,this.componentDef.encapsulation):fd(h,p,function HC(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(p)),C=this.componentDef.onPush?288:272,w=wC(0,null,null,1,0,null,null,null,null,null),I=H7(null,w,null,C,null,null,c,h,u,o,null);let H,Y;nl(I);try{const ee=function Bb(n,t,e,r,s,i){const o=e[1];e[22]=n;const u=s0(o,22,2,"#host",null),h=u.mergedAttrs=t.hostAttrs;null!==h&&(ou(u,h,!0),null!==n&&(lc(s,n,h),null!==u.classes&&N7(s,n,u.classes),null!==u.styles&&ru(s,n,u.styles)));const p=r.createRenderer(n,t),m=H7(e,TC(t),null,t.onPush?32:16,e[22],u,r,p,i||null,null,null);return o.firstCreatePass&&(z6(J5(u,e),o,t.type),Bd(o,u),AC(u,e.length,1)),q7(e,m),e[22]=m}(m,this.componentDef,I,c,h);if(m)if(r)lc(h,m,["ng-version",Pv.full]);else{const{attrs:ve,classes:te}=function iC(n){const t=[],e=[];let r=1,s=2;for(;r<n.length;){let i=n[r];if("string"==typeof i)2===s?""!==i&&t.push(i,n[++r]):8===s&&e.push(i);else{if(!Na(s))break;s=i}r++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);ve&&lc(h,m,ve),te&&te.length>0&&N7(h,m,te.join(" "))}if(Y=uh(w,22),void 0!==e){const ve=Y.projection=[];for(let te=0;te<this.ngContentSelectors.length;te++){const Ie=e[te];ve.push(null!=Ie?Array.from(Ie):null)}}H=function $C(n,t,e,r){const s=e[1],i=function QF(n,t,e){const r=Rr();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),IC(n,r,t,yl(n,t,1,null),e),U7(n,r));const s=Hs(t,n,r.directiveStart,r);Li(s,t);const i=t2(r,t);return i&&Li(i,t),s}(s,e,t);if(n[8]=e[8]=i,null!==r)for(const c of r)c(i,t);if(t.contentQueries){const c=Rr();t.contentQueries(1,i,c.directiveStart)}const o=Rr();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Jc(o.index),W7(e[1],o,0,o.directiveStart,o.directiveEnd,t),Ab(t,i)),i}(ee,this.componentDef,I,[d]),B7(w,I,null)}finally{rl()}return new Fb(this.componentType,H,K6(Y,I),I,Y)}}class Fb extends class aw{}{constructor(t,e,r,s,i){super(),this.location=r,this._rootLView=s,this._tNode=i,this.instance=e,this.hostView=this.changeDetectorRef=new Vb(s),this.componentType=t}setInput(t,e){const r=this._tNode.inputs;let s;if(null!==r&&(s=r[t])){const i=this._rootLView;Z7(i[1],i,s,t,e),bC(i,this._tNode.index)}}get injector(){return new V6(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function d(){const n=Rr();n3(Le()[1],n)}function l(n){let t=function a(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const r=[n];for(;t;){let s;if(ys(n))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Ne(903,!1);s=t.\u0275dir}if(s){if(e){r.push(s);const o=n;o.inputs=g(n.inputs),o.declaredInputs=g(n.declaredInputs),o.outputs=g(n.outputs);const c=s.hostBindings;c&&N(n,c);const u=s.viewQuery,h=s.contentQueries;if(u&&_(n,u),h&&y(n,h),Z9(n.inputs,s.inputs),Z9(n.declaredInputs,s.declaredInputs),Z9(n.outputs,s.outputs),ys(s)&&s.data.animation){const p=n.data;p.animation=(p.animation||[]).concat(s.data.animation)}}const i=s.features;if(i)for(let o=0;o<i.length;o++){const c=i[o];c&&c.ngInherit&&c(n),c===l&&(e=!1)}}t=Object.getPrototypeOf(t)}!function f(n){let t=0,e=null;for(let r=n.length-1;r>=0;r--){const s=n[r];s.hostVars=t+=s.hostVars,s.hostAttrs=D6(s.hostAttrs,e=D6(e,s.hostAttrs))}}(r)}function g(n){return n===Z?{}:n===v1?[]:n}function _(n,t){const e=n.viewQuery;n.viewQuery=e?(r,s)=>{t(r,s),e(r,s)}:t}function y(n,t){const e=n.contentQueries;n.contentQueries=e?(r,s,i)=>{t(r,s,i),e(r,s,i)}:t}function N(n,t){const e=n.hostBindings;n.hostBindings=e?(r,s)=>{t(r,s),e(r,s)}:t}let se=null;function Pe(){if(!se){const n=Q1.Symbol;if(n&&n.iterator)se=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const r=t[e];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(se=r)}}}return se}function ze(n){return!!_t(n)&&(Array.isArray(n)||!(n instanceof Map)&&Pe()in n)}function _t(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function gn(n,t,e){return n[t]=e}function A1(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function h2(n,t,e,r){const s=A1(n,t,e);return A1(n,t+1,r)||s}function D(n,t,e,r){const s=Le();return A1(s,k6(),t)&&(Kn(),pc(P1(),s,n,t,e,r)),D}function d1(n,t,e,r){return A1(n,k6(),e)?t+tn(e)+r:fn}function Fs(n,t,e,r,s,i){const c=h2(n,cc(),e,s);return Xo(2),c?t+tn(e)+r+tn(s)+i:fn}function na(n,t,e,r,s,i,o,c){const h=function xa(n,t,e,r,s){const i=h2(n,t,e,r);return A1(n,t+2,s)||i}(n,cc(),e,s,o);return Xo(3),h?t+tn(e)+r+tn(s)+i+tn(o)+c:fn}function cu(n,t,e,r,s,i){const o=Le(),c=d1(o,t,e,r);return c!==fn&&pc(P1(),o,n,c,s,i),cu}function x(n,t,e,r,s,i,o,c){const u=Le(),h=Kn(),p=n+22,m=h.firstCreatePass?function h4e(n,t,e,r,s,i,o,c,u){const h=t.consts,p=s0(t,n,4,o||null,Xc(h,c));El(t,e,p,Xc(h,u)),n3(t,p);const m=p.tViews=wC(2,p,r,s,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,h);return null!==t.queries&&(t.queries.template(t,p),m.queries=t.queries.embeddedTView(p)),p}(p,h,u,t,e,r,s,i,o):h.data[p];ac(m,!1);const C=u[11].createComment("");tu(h,u,C,m),Li(C,u),q7(u,u[p]=xC(C,u,C,m)),Yo(m)&&Fd(h,u,m),null!=o&&o0(u,m,c)}function t1(n){return el(function Z5(){return an.lFrame.contextLView}(),22+n)}function T(n,t,e){const r=Le();return A1(r,k6(),t)&&_o(Kn(),P1(),r,n,t,r[11],e,!1),T}function $b(n,t,e,r,s){const o=s?"class":"style";Z7(n,e,t.inputs[o],o,r)}function b(n,t,e,r){const s=Le(),i=Kn(),o=22+n,c=s[11],u=s[o]=fd(c,t,function t3(){return an.lFrame.currentNamespace}()),h=i.firstCreatePass?function p4e(n,t,e,r,s,i,o){const c=t.consts,h=s0(t,n,2,s,Xc(c,i));return El(t,e,h,Xc(c,o)),null!==h.attrs&&ou(h,h.attrs,!1),null!==h.mergedAttrs&&ou(h,h.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,h),h}(o,i,s,0,t,e,r):i.data[o];ac(h,!0);const p=h.mergedAttrs;null!==p&&lc(c,u,p);const m=h.classes;null!==m&&N7(c,u,m);const C=h.styles;return null!==C&&ru(c,u,C),64!=(64&h.flags)&&tu(i,s,u,h),0===function yT(){return an.lFrame.elementDepthCount}()&&Li(u,s),function ET(){an.lFrame.elementDepthCount++}(),Yo(h)&&(Fd(i,s,h),PC(i,h,s)),null!==r&&o0(s,h),b}function O(){let n=Rr();jr()?dh():(n=n.parent,ac(n,!1));const t=n;!function MT(){an.lFrame.elementDepthCount--}();const e=Kn();return e.firstCreatePass&&(n3(e,n),$2(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function Ch(n){return 0!=(16&n.flags)}(t)&&$b(e,t,Le(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function N8(n){return 0!=(32&n.flags)}(t)&&$b(e,t,Le(),t.stylesWithoutHost,!1),O}function X(n,t,e,r){return b(n,t,e,r),O(),X}function ln(n,t,e){const r=Le(),s=Kn(),i=n+22,o=s.firstCreatePass?function g4e(n,t,e,r,s){const i=t.consts,o=Xc(i,r),c=s0(t,n,8,"ng-container",o);return null!==o&&ou(c,o,!0),El(t,e,c,Xc(i,s)),null!==t.queries&&t.queries.elementStart(t,c),c}(i,s,r,t,e):s.data[i];ac(o,!0);const c=r[i]=r[11].createComment("");return tu(s,r,c,o),Li(c,r),Yo(o)&&(Fd(s,r,o),PC(s,o,r)),null!=e&&o0(r,o),ln}function un(){let n=Rr();const t=Kn();return jr()?dh():(n=n.parent,ac(n,!1)),t.firstCreatePass&&(n3(t,n),$2(n)&&t.queries.elementEnd(n)),un}function Oe(){return Le()}function qd(n){return!!n&&"function"==typeof n.then}const Ub=function pB(n){return!!n&&"function"==typeof n.subscribe};function J(n,t,e,r){const s=Le(),i=Kn(),o=Rr();return function mB(n,t,e,r,s,i,o,c){const u=Yo(r),p=n.firstCreatePass&&DC(n),m=t[8],C=RC(t);let w=!0;if(3&r.type||c){const Y=t2(r,t),ee=c?c(Y):Y,ve=C.length,te=c?Be=>c(Sr(Be[r.index])):r.index;let Ie=null;if(!c&&u&&(Ie=function m4e(n,t,e,r){const s=n.cleanup;if(null!=s)for(let i=0;i<s.length-1;i+=2){const o=s[i];if(o===e&&s[i+1]===r){const c=t[7],u=s[i+2];return c.length>u?c[u]:null}"string"==typeof o&&(i+=2)}return null}(n,t,s,r.index)),null!==Ie)(Ie.__ngLastListenerFn__||Ie).__ngNextListenerFn__=i,Ie.__ngLastListenerFn__=i,w=!1;else{i=vB(r,t,m,i,!1);const Be=e.listen(ee,s,i);C.push(i,Be),p&&p.push(s,te,ve,ve+1)}}else i=vB(r,t,m,i,!1);const I=r.outputs;let H;if(w&&null!==I&&(H=I[s])){const Y=H.length;if(Y)for(let ee=0;ee<Y;ee+=2){const Ye=t[H[ee]][H[ee+1]].subscribe(i),Vt=C.length;C.push(i,Ye),p&&p.push(s,r.index,Vt,-(Vt+1))}}}(i,s,s[11],o,n,t,0,r),J}function _B(n,t,e,r){try{return!1!==e(r)}catch(s){return VC(n,s),!1}}function vB(n,t,e,r,s){return function i(o){if(o===Function)return r;kC(2&n.flags?Ni(n.index,t):t);let u=_B(t,0,r,o),h=i.__ngNextListenerFn__;for(;h;)u=_B(t,0,h,o)&&u,h=h.__ngNextListenerFn__;return s&&!1===u&&(o.preventDefault(),o.returnValue=!1),u}}function v(n=1){return function X5(n){return(an.lFrame.contextLView=function T8(n,t){for(;n>0;)t=t[15],n--;return t}(n,an.lFrame.contextLView))[8]}(n)}function _4e(n,t){let e=null;const r=function rC(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let s=0;s<t.length;s++){const i=t[s];if("*"!==i){if(null===r?nC(n,i,!0):sC(r,i))return s}else e=s}return e}function Gb(n,t,e){return C1(n,"",t,"",e),Gb}function C1(n,t,e,r,s){const i=Le(),o=d1(i,t,e,r);return o!==fn&&_o(Kn(),P1(),i,n,o,i[11],s,!1),C1}function We(n,t,e,r,s,i,o){const c=Le(),u=Fs(c,t,e,r,s,i);return u!==fn&&_o(Kn(),P1(),c,n,u,c[11],o,!1),We}function G2(n,t,e,r,s,i,o,c,u){const h=Le(),p=na(h,t,e,r,s,i,o,c);return p!==fn&&_o(Kn(),P1(),h,n,p,h[11],u,!1),G2}function bB(n,t,e,r,s){const i=n[e+1],o=null===t;let c=r?Aa(i):dc(i),u=!1;for(;0!==c&&(!1===u||o);){const p=n[c+1];y4e(n[c],t)&&(u=!0,n[c+1]=r?xd(p):Id(p)),c=r?Aa(p):dc(p)}u&&(n[e+1]=r?Id(i):xd(i))}function y4e(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&a2(n,t)>=0}const fi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function OB(n){return n.substring(fi.key,fi.keyEnd)}function E4e(n){return n.substring(fi.value,fi.valueEnd)}function AB(n,t){const e=fi.textEnd;let r=fi.key=X7(n,t,e);return e===r?-1:(r=fi.keyEnd=function T4e(n,t,e){let r;for(;t<e&&(45===(r=n.charCodeAt(t))||95===r||(-33&r)>=65&&(-33&r)<=90||r>=48&&r<=57);)t++;return t}(n,r,e),r=xB(n,r,e),r=fi.value=X7(n,r,e),r=fi.valueEnd=function w4e(n,t,e){let r=-1,s=-1,i=-1,o=t,c=o;for(;o<e;){const u=n.charCodeAt(o++);if(59===u)return c;34===u||39===u?c=o=kB(n,u,o,e):t===o-4&&85===i&&82===s&&76===r&&40===u?c=o=kB(n,41,o,e):u>32&&(c=o),i=s,s=r,r=-33&u}return c}(n,r,e),xB(n,r,e))}function X7(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function xB(n,t,e,r){return(t=X7(n,t,e))<e&&t++,t}function kB(n,t,e,r){let s=-1,i=e;for(;i<r;){const o=n.charCodeAt(i++);if(o==t&&92!==s)return i;s=92==o&&92===s?0:o}throw new Error}function UC(n,t){return function d3(n,t,e,r){const s=Le(),i=Kn(),o=Xo(2);i.firstUpdatePass&&DB(i,n,o,r),t!==fn&&A1(s,o,t)&&VB(i,i.data[r2()],s,s[11],n,s[o+1]=function R4e(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=j1(fo(n)))),n}(t,e),r,o)}(n,t,null,!0),UC}function p2(n){!function p3(n,t,e,r){const s=Kn(),i=Xo(2);s.firstUpdatePass&&DB(s,null,i,r);const o=Le();if(e!==fn&&A1(o,i,e)){const c=s.data[r2()];if(FB(c,r)&&!RB(s,i)){let u=r?c.classesWithoutHost:c.stylesWithoutHost;null!==u&&(e=d8(u,e||"")),$b(s,c,o,e,r)}else!function L4e(n,t,e,r,s,i,o,c){s===fn&&(s=v1);let u=0,h=0,p=0<s.length?s[0]:null,m=0<i.length?i[0]:null;for(;null!==p||null!==m;){const C=u<s.length?s[u+1]:void 0,w=h<i.length?i[h+1]:void 0;let H,I=null;p===m?(u+=2,h+=2,C!==w&&(I=m,H=w)):null===m||null!==p&&p<m?(u+=2,I=p):(h+=2,I=m,H=w),null!==I&&VB(n,t,e,r,I,H,o,c),p=u<s.length?s[u]:null,m=h<i.length?i[h]:null}}(s,c,o,o[11],o[i+1],o[i+1]=function k4e(n,t,e){if(null==e||""===e)return v1;const r=[],s=fo(e);if(Array.isArray(s))for(let i=0;i<s.length;i++)n(r,s[i],!0);else if("object"==typeof s)for(const i in s)s.hasOwnProperty(i)&&n(r,i,s[i]);else"string"==typeof s&&t(r,s);return r}(n,t,e),r,i)}}(zB,b4e,n,!1)}function b4e(n,t){for(let e=function S4e(n){return function IB(n){fi.key=0,fi.keyEnd=0,fi.value=0,fi.valueEnd=0,fi.textEnd=n.length}(n),AB(n,X7(n,0,fi.textEnd))}(t);e>=0;e=AB(t,e))zB(n,OB(t),E4e(t))}function RB(n,t){return t>=n.expandoStartIndex}function DB(n,t,e,r){const s=n.data;if(null===s[e+1]){const i=s[r2()],o=RB(n,e);FB(i,r)&&null===t&&!o&&(t=!1),t=function N4e(n,t,e,r){const s=function Y5(n){const t=an.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let i=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(e=jd(e=Wb(null,n,t,e,r),t.attrs,r),i=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==s)if(e=Wb(s,n,t,e,r),null===i){let u=function A4e(n,t,e){const r=e?t.classBindings:t.styleBindings;if(0!==dc(r))return n[Aa(r)]}(n,t,r);void 0!==u&&Array.isArray(u)&&(u=Wb(null,n,t,u[1],r),u=jd(u,t.attrs,r),function I4e(n,t,e,r){n[Aa(e?t.classBindings:t.styleBindings)]=r}(n,t,r,u))}else i=function x4e(n,t,e){let r;const s=t.directiveEnd;for(let i=1+t.directiveStylingLast;i<s;i++)r=jd(r,n[i].hostAttrs,e);return jd(r,t.attrs,e)}(n,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),e}(s,i,t,r),function v4e(n,t,e,r,s,i){let o=i?t.classBindings:t.styleBindings,c=Aa(o),u=dc(o);n[r]=e;let p,h=!1;if(Array.isArray(e)){const m=e;p=m[1],(null===p||a2(m,p)>0)&&(h=!0)}else p=e;if(s)if(0!==u){const C=Aa(n[c+1]);n[r+1]=L7(C,c),0!==C&&(n[C+1]=Cl(n[C+1],r)),n[c+1]=function zF(n,t){return 131071&n|t<<17}(n[c+1],r)}else n[r+1]=L7(c,0),0!==c&&(n[c+1]=Cl(n[c+1],r)),c=r;else n[r+1]=L7(u,0),0===c?c=r:n[u+1]=Cl(n[u+1],r),u=r;h&&(n[r+1]=Id(n[r+1])),bB(n,p,r,!0),bB(n,p,r,!1),function C4e(n,t,e,r,s){const i=s?n.residualClasses:n.residualStyles;null!=i&&"string"==typeof t&&a2(i,t)>=0&&(e[r+1]=xd(e[r+1]))}(t,p,n,r,i),o=L7(c,u),i?t.classBindings=o:t.styleBindings=o}(s,i,t,e,o,r)}}function Wb(n,t,e,r,s){let i=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(i=t[c],r=jd(r,i.hostAttrs,s),i!==n);)c++;return null!==n&&(e.directiveStylingLast=c),r}function jd(n,t,e){const r=e?1:2;let s=-1;if(null!==t)for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?s=o:s===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),o2(n,o,!!e||t[++i]))}return void 0===n?null:n}function zB(n,t,e){o2(n,t,fo(e))}function VB(n,t,e,r,s,i,o,c){if(!(3&t.type))return;const u=n.data,h=u[c+1];GC(function mC(n){return 1==(1&n)}(h)?HB(u,t,e,s,dc(h),o):void 0)||(GC(i)||function hb(n){return 2==(2&n)}(h)&&(i=HB(u,null,e,s,c,o)),function Xv(n,t,e,r,s){if(t)s?n.addClass(e,r):n.removeClass(e,r);else{let i=-1===r.indexOf("-")?void 0:f2.DashCase;null==s?n.removeStyle(e,r,i):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),i|=f2.Important),n.setStyle(e,r,s,i))}}(r,o,E8(r2(),e),s,i))}function HB(n,t,e,r,s,i){const o=null===t;let c;for(;s>0;){const u=n[s],h=Array.isArray(u),p=h?u[1]:u,m=null===p;let C=e[s+1];C===fn&&(C=m?v1:void 0);let w=m?ai(C,r):p===r?C:void 0;if(h&&!GC(w)&&(w=ai(u,r)),GC(w)&&(c=w,o))return c;const I=n[s+1];s=o?Aa(I):dc(I)}if(null!==t){let u=i?t.residualClasses:t.residualStyles;null!=u&&(c=ai(u,r))}return c}function GC(n){return void 0!==n}function FB(n,t){return 0!=(n.flags&(t?16:32))}function Pt(n,t=""){const e=Le(),r=Kn(),s=n+22,i=r.firstCreatePass?s0(r,s,1,t,null):r.data[s],o=e[s]=ud(e[11],t);tu(r,e,o,i),ac(i,!1)}function a1(n){return W2("",n,""),a1}function W2(n,t,e){const r=Le(),s=d1(r,n,t,e);return s!==fn&&h3(r,r2(),s),W2}function WC(n,t,e,r,s){const i=Le(),o=Fs(i,n,t,e,r,s);return o!==fn&&h3(i,r2(),o),WC}function qb(n,t,e,r,s,i,o){const c=Le(),u=na(c,n,t,e,r,s,i,o);return u!==fn&&h3(c,r2(),u),qb}function jb(n,t,e){const r=Le();return A1(r,k6(),t)&&_o(Kn(),P1(),r,n,t,r[11],e,!0),jb}const lu=void 0;var tle=["en",[["a","p"],["AM","PM"],lu],[["AM","PM"],lu,lu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],lu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],lu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",lu,"{1} 'at' {0}",lu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function ele(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===r?1:5}];let Q7={};function yo(n){const t=function rle(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=s$(t);if(e)return e;const r=t.split("-")[0];if(e=s$(r),e)return e;if("en"===r)return tle;throw new Ne(701,!1)}function s$(n){return n in Q7||(Q7[n]=Q1.ng&&Q1.ng.common&&Q1.ng.common.locales&&Q1.ng.common.locales[n]),Q7[n]}var mt=(()=>((mt=mt||{})[mt.LocaleId=0]="LocaleId",mt[mt.DayPeriodsFormat=1]="DayPeriodsFormat",mt[mt.DayPeriodsStandalone=2]="DayPeriodsStandalone",mt[mt.DaysFormat=3]="DaysFormat",mt[mt.DaysStandalone=4]="DaysStandalone",mt[mt.MonthsFormat=5]="MonthsFormat",mt[mt.MonthsStandalone=6]="MonthsStandalone",mt[mt.Eras=7]="Eras",mt[mt.FirstDayOfWeek=8]="FirstDayOfWeek",mt[mt.WeekendRange=9]="WeekendRange",mt[mt.DateFormat=10]="DateFormat",mt[mt.TimeFormat=11]="TimeFormat",mt[mt.DateTimeFormat=12]="DateTimeFormat",mt[mt.NumberSymbols=13]="NumberSymbols",mt[mt.NumberFormats=14]="NumberFormats",mt[mt.CurrencyCode=15]="CurrencyCode",mt[mt.CurrencySymbol=16]="CurrencySymbol",mt[mt.CurrencyName=17]="CurrencyName",mt[mt.Currencies=18]="Currencies",mt[mt.Directionality=19]="Directionality",mt[mt.PluralCase=20]="PluralCase",mt[mt.ExtraData=21]="ExtraData",mt))();const sle=["zero","one","two","few","many"],J7="en-US",qC={marker:"element"},jC={marker:"ICU"};var cs=(()=>((cs=cs||{})[cs.SHIFT=2]="SHIFT",cs[cs.APPEND_EAGERLY=1]="APPEND_EAGERLY",cs[cs.COMMENT=2]="COMMENT",cs))();let i$=J7;function o$(n){(function ao(n,t){null==n&&M1(t,n,null,"!=")})(n,"Expected localeId to be defined"),"string"==typeof n&&(i$=n.toLowerCase().replace(/_/g,"-"))}function a$(n,t,e){const r=t.insertBeforeIndex,s=Array.isArray(r)?r[0]:r;return null===s?jv(n,0,e):Sr(e[s])}function c$(n,t,e,r,s){const i=t.insertBeforeIndex;if(Array.isArray(i)){let o=r,c=null;if(3&t.type||(c=o,o=s),null!==o&&0==(2&t.flags))for(let u=1;u<i.length;u++)l3(n,o,e[i[u]],c,!1)}}function l$(n,t){if(n.push(t),n.length>1)for(let e=n.length-2;e>=0;e--){const r=n[e];u$(r)||cle(r,t)&&null===lle(r)&&ule(r,t.index)}}function u$(n){return!(64&n.type)}function cle(n,t){return u$(t)||n.index>t.index}function lle(n){const t=n.insertBeforeIndex;return Array.isArray(t)?t[0]:t}function ule(n,t){const e=n.insertBeforeIndex;Array.isArray(e)?e[0]=t:(O7(a$,c$),n.insertBeforeIndex=t)}function Zd(n,t){const e=n.data[t];return null===e||"string"==typeof e?null:e.hasOwnProperty("currentCaseLViewIndex")?e:e.value}function dle(n,t,e){const r=F7(n,e,64,null,null);return l$(t,r),r}function ZC(n,t){const e=t[n.currentCaseLViewIndex];return null===e?e:e<0?~e:e}function f$(n){return n>>>17}function h$(n){return(131070&n)>>>1}let Yd=0,Kd=0;function p$(n,t,e,r){const s=e[11];let o,i=null;for(let c=0;c<t.length;c++){const u=t[c];if("string"==typeof u){const h=t[++c];null===e[h]&&(e[h]=ud(s,u))}else if("number"==typeof u)switch(1&u){case 0:const h=f$(u);let p,m;if(null===i&&(i=h,o=e0(s,r)),h===i?(p=r,m=o):(p=null,m=Sr(e[h])),null!==m){const H=h$(u);l3(s,m,e[H],p,!1);const ee=Zd(n,H);if(null!==ee&&"object"==typeof ee){const ve=ZC(ee,e);null!==ve&&p$(n,ee.create[ve],e,e[ee.anchorIdx])}}break;case 1:const w=t[++c],I=t[++c];$d(s,E8(u>>>1,e),null,null,w,I,null)}else switch(u){case jC:const h=t[++c],p=t[++c];null===e[p]&&Li(e[p]=Hw(s,h),e);break;case qC:const m=t[++c],C=t[++c];null===e[C]&&Li(e[C]=fd(s,m,null),e)}}}function g$(n,t,e,r,s){for(let i=0;i<e.length;i++){const o=e[i],c=e[++i];if(o&s){let u="";for(let h=i+1;h<=i+c;h++){const p=e[h];if("string"==typeof p)u+=p;else if("number"==typeof p)if(p<0)u+=tn(t[r-p]);else{const m=p>>>2;switch(3&p){case 1:const C=e[++h],w=e[++h],I=n.data[m];"string"==typeof I?$d(t[11],t[m],null,I,C,u,w):_o(n,I,t,C,u,t[11],w,!1);break;case 0:const H=t[m];null!==H&&Hv(t[11],H,u);break;case 2:vle(n,Zd(n,m),t,u);break;case 3:m$(n,Zd(n,m),r,t)}}}}else{const u=e[i+1];if(u>0&&3==(3&u)){const p=Zd(n,u>>>2);t[p.currentCaseLViewIndex]<0&&m$(n,p,r,t)}}i+=c}}function m$(n,t,e,r){let s=r[t.currentCaseLViewIndex];if(null!==s){let i=Yd;s<0&&(s=r[t.currentCaseLViewIndex]=~s,i=-1),g$(n,r,t.update[s],e,i)}}function vle(n,t,e,r){const s=function Cle(n,t){let e=n.cases.indexOf(t);if(-1===e)switch(n.type){case 1:{const r=function ile(n,t){const e=function r$(n){return yo(n)[mt.PluralCase]}(t)(parseInt(n,10)),r=sle[e];return void 0!==r?r:"other"}(t,function ale(){return i$}());e=n.cases.indexOf(r),-1===e&&"other"!==r&&(e=n.cases.indexOf("other"));break}case 0:e=n.cases.indexOf("other")}return-1===e?null:e}(t,r);if(ZC(t,e)!==s&&(_$(n,t,e),e[t.currentCaseLViewIndex]=null===s?null:~s,null!==s)){const o=e[t.anchorIdx];o&&p$(n,t.create[s],e,o)}}function _$(n,t,e){let r=ZC(t,e);if(null!==r){const s=t.remove[r];for(let i=0;i<s.length;i++){const o=s[i];if(o>0){const c=E8(o,e);null!==c&&Yv(e[11],c)}else _$(n,Zd(n,~o),e)}}}function yle(){const n=[];let e,r,t=-1;function i(c,u){t=0;const h=ZC(c,u);r=null!==h?c.remove[h]:v1}function o(){if(t<r.length){const c=r[t++];return c>0?e[c]:(n.push(t,r),i(e[1].data[~c],e),o())}return 0===n.length?null:(r=n.pop(),t=n.pop(),o())}return function s(c,u){for(e=u;n.length;)n.pop();return i(c.value,u),o}}const YC=/\ufffd(\d+):?\d*\ufffd/gi,Mle=/\ufffd(\d+)\ufffd/,C$=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Sle=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,Ple=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Tle=/\uE500/g;function y$(n,t,e,r,s,i,o){const c=yl(n,r,1,null);let u=c<<cs.SHIFT,h=tl();t===h&&(h=null),null===h&&(u|=cs.APPEND_EAGERLY),o&&(u|=cs.COMMENT,function zv(n){void 0===od&&(od=n())}(yle)),s.push(u,null===i?"":i);const p=F7(n,c,o?32:1,null===i?"":i,null);l$(e,p);const m=p.index;return ac(p,!1),null!==h&&t!==h&&function hle(n,t){let e=n.insertBeforeIndex;null===e?(O7(a$,c$),e=n.insertBeforeIndex=[null,t]):(function h1(n,t,e){n!=t&&M1(e,n,t,"==")}(Array.isArray(e),!0,"Expecting array here"),e.push(t))}(h,m),p}function Ole(n,t,e,r,s,i,o){const c=o.match(YC),u=y$(n,t,e,i,r,c?null:o,!1);c&&Qd(s,o,u.index,null,0,null)}function Qd(n,t,e,r,s,i){const o=n.length,c=o+1;n.push(null,null);const u=o+2,h=t.split(YC);let p=0;for(let m=0;m<h.length;m++){const C=h[m];if(1&m){const w=s+parseInt(C,10);n.push(-1-w),p|=E$(w)}else""!==C&&n.push(C)}return n.push(e<<2|(r?1:0)),r&&n.push(r,i),n[o]=p,n[c]=n.length-u,p}function E$(n){return 1<<Math.min(n,31)}function M$(n){let t,i,e="",r=0,s=!1;for(;null!==(t=Sle.exec(n));)s?t[0]===`\ufffd/*${i}\ufffd`&&(r=t.index,s=!1):(e+=n.substring(r,t.index+t[0].length),i=t[1],s=!0);return e+=n.slice(r),e}function S$(n,t,e,r,s,i){let o=0;const c={type:s.type,currentCaseLViewIndex:yl(n,t,1,null),anchorIdx:i,cases:[],create:[],remove:[],update:[]};(function Dle(n,t,e){n.push(E$(t.mainBinding),2,-1-t.mainBinding,e<<2|2)})(e,s,i),function fle(n,t,e){const r=n.data[t];null===r?n.data[t]=e:r.value=e}(n,i,c);const u=s.values;for(let h=0;h<u.length;h++){const p=u[h],m=[];for(let C=0;C<p.length;C++){const w=p[C];if("string"!=typeof w){const I=m.push(w)-1;p[C]=`\x3c!--\ufffd${I}\ufffd--\x3e`}}o=Lle(n,c,t,e,r,s.cases[h],p.join(""),m)|o}o&&function zle(n,t,e){n.push(t,1,e<<2|3)}(e,o,i)}function kle(n){const t=[],e=[];let r=1,s=0;const i=Zb(n=n.replace(C$,function(o,c,u){return r="select"===u?0:1,s=parseInt(c.slice(1),10),""}));for(let o=0;o<i.length;){let c=i[o++].trim();1===r&&(c=c.replace(/\s*(?:=)?(\w+)\s*/,"$1")),c.length&&t.push(c);const u=Zb(i[o++]);t.length>e.length&&e.push(u)}return{type:r,mainBinding:s,cases:t,values:e}}function Zb(n){if(!n)return[];let t=0;const e=[],r=[],s=/[{}]/g;let i;for(s.lastIndex=0;i=s.exec(n);){const c=i.index;if("}"==i[0]){if(e.pop(),0==e.length){const u=n.substring(t,c);C$.test(u)?r.push(kle(u)):r.push(u),t=c+1}}else{if(0==e.length){const u=n.substring(t,c);r.push(u),t=c+1}e.push("{")}}const o=n.substring(t);return r.push(o),r}function Lle(n,t,e,r,s,i,o,c){const u=[],h=[],p=[];t.cases.push(i),t.create.push(u),t.remove.push(h),t.update.push(p);const C=iv(Q_()).getInertBodyElement(o),w=po(C)||C;return w?P$(n,t,e,r,u,h,p,w,s,c,0):0}function P$(n,t,e,r,s,i,o,c,u,h,p){let m=0,C=c.firstChild;for(;C;){const w=yl(n,e,1,null);switch(C.nodeType){case Node.ELEMENT_NODE:const I=C,H=I.tagName.toLowerCase();if(U8.hasOwnProperty(H)){Yb(s,qC,H,u,w),n.data[w]=H;const te=I.attributes;for(let Ie=0;Ie<te.length;Ie++){const Be=te.item(Ie),Ye=Be.name.toLowerCase();Be.value.match(YC)?g7.hasOwnProperty(Ye)&&Qd(o,Be.value,w,Be.name,0,p7[Ye]?ta:null):Vle(s,w,Be)}m=P$(n,t,e,r,s,i,o,C,w,h,p+1)|m,T$(i,w,p)}break;case Node.TEXT_NODE:const Y=C.textContent||"",ee=Y.match(YC);Yb(s,null,ee?"":Y,u,w),T$(i,w,p),ee&&(m=Qd(o,Y,w,null,0,null)|m);break;case Node.COMMENT_NODE:const ve=Mle.exec(C.textContent||"");if(ve){const Ie=h[parseInt(ve[1],10)];Yb(s,jC,"",u,w),S$(n,e,r,u,Ie,w),Rle(i,w,p)}}C=C.nextSibling}return m}function T$(n,t,e){0===e&&n.push(t)}function Rle(n,t,e){0===e&&(n.push(~t),n.push(t))}function Yb(n,t,e,r,s){null!==t&&n.push(t),n.push(e,s,function ple(n,t,e){return n|t<<17|e<<1}(0,r,s))}function Vle(n,t,e){n.push(t<<1|1,e.name,e.value)}function gc(n,t,e=-1){const r=Kn(),s=Le(),i=22+n,o=Xc(r.consts,t),c=tl();r.firstCreatePass&&function ble(n,t,e,r,s,i){const o=tl(),c=[],u=[],h=[[]];s=function xle(n,t){if(function Ile(n){return-1===n}(t))return M$(n);{const e=n.indexOf(`:${t}\ufffd`)+2+t.toString().length,r=n.search(new RegExp(`\ufffd\\/\\*\\d+:${t}\ufffd`));return M$(n.substring(e,r))}}(s,i);const p=function wle(n){return n.replace(Tle," ")}(s).split(Ple);for(let m=0;m<p.length;m++){let C=p[m];if(0==(1&m)){const w=Zb(C);for(let I=0;I<w.length;I++){let H=w[I];if(0==(1&I)){const Y=H;""!==Y&&Ole(n,o,h[0],c,u,e,Y)}else{const Y=H;if("object"!=typeof Y)throw new Error(`Unable to parse ICU expression in "${s}" message.`);S$(n,e,u,t,Y,y$(n,o,h[0],e,c,"",!0).index)}}}else{const w=47===C.charCodeAt(0),H=(C.charCodeAt(w?1:0),22+Number.parseInt(C.substring(w?2:1)));if(w)h.shift(),ac(tl(),!1);else{const Y=dle(n,h[0],H);h.unshift([]),ac(Y,!0)}}}n.data[r]={create:c,update:u}}(r,null===c?0:c.index,s,i,o,e);const u=r.data[i],p=gd(r,c===s[6]?null:c,s);(function _le(n,t,e,r){const s=n[11];for(let i=0;i<t.length;i++){const o=t[i++],c=t[i],u=(o&cs.COMMENT)===cs.COMMENT,h=(o&cs.APPEND_EAGERLY)===cs.APPEND_EAGERLY,p=o>>>cs.SHIFT;let m=n[p];null===m&&(m=n[p]=u?s.createComment(c):ud(s,c)),h&&null!==e&&l3(s,e,m,r,!1)}})(s,u.create,p,c&&8&c.type?s[c.index]:null),n2(!0)}function mc(){n2(!1)}function me(n,t,e){gc(n,t,e),mc()}function I1(n){return function gle(n){n&&(Yd|=1<<Math.min(Kd,31)),Kd++}(A1(Le(),k6(),n)),I1}function H1(n){!function mle(n,t,e){if(Kd>0){const r=n.data[e];g$(n,t,Array.isArray(r)?r:r.update,cc()-Kd-1,Yd)}Yd=0,Kd=0}(Kn(),Le(),n+22)}function Kb(n,t,e,r,s){if(n=en(n),Array.isArray(n))for(let i=0;i<n.length;i++)Kb(n[i],t,e,r,s);else{const i=Kn(),o=Le();let c=pl(n)?n:en(n.provide),u=y7(n);const h=Rr(),p=1048575&h.providerIndexes,m=h.directiveStart,C=h.providerIndexes>>20;if(pl(n)||!n.multi){const w=new O8(u,s,Q),I=Qb(c,t,s?p:p+C,m);-1===I?(z6(J5(h,o),i,c),Xb(i,n,t.length),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(w),o.push(w)):(e[I]=w,o[I]=w)}else{const w=Qb(c,t,p+C,m),I=Qb(c,t,p,p+C),H=w>=0&&e[w],Y=I>=0&&e[I];if(s&&!Y||!s&&!H){z6(J5(h,o),i,c);const ee=function Qle(n,t,e,r,s){const i=new O8(n,e,Q);return i.multi=[],i.index=t,i.componentProviders=0,b$(i,s,r&&!e),i}(s?Xle:Kle,e.length,s,r,u);!s&&Y&&(e[I].providerFactory=ee),Xb(i,n,t.length,0),t.push(c),h.directiveStart++,h.directiveEnd++,s&&(h.providerIndexes+=1048576),e.push(ee),o.push(ee)}else Xb(i,n,w>-1?w:I,b$(e[s?I:w],u,!s&&r));!s&&r&&Y&&e[I].componentProviders++}}}function Xb(n,t,e,r){const s=pl(t),i=function sw(n){return!!n.useClass}(t);if(s||i){const u=(i?en(t.useClass):t).prototype.ngOnDestroy;if(u){const h=n.destroyHooks||(n.destroyHooks=[]);if(!s&&t.multi){const p=h.indexOf(e);-1===p?h.push(e,[r,u]):h[p+1].push(r,u)}else h.push(e,u)}}}function b$(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function Qb(n,t,e,r){for(let s=e;s<r;s++)if(t[s]===n)return s;return-1}function Kle(n,t,e,r){return Jb(this.multi,[])}function Xle(n,t,e,r){const s=this.multi;let i;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Hs(e,e[1],this.providerFactory.index,r);i=c.slice(0,o),Jb(s,i);for(let u=o;u<c.length;u++)i.push(c[u])}else i=[],Jb(s,i);return i}function Jb(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Vr(n,t=[]){return e=>{e.providersResolver=(r,s)=>function Yle(n,t,e){const r=Kn();if(r.firstCreatePass){const s=ys(n);Kb(e,r.data,r.blueprint,s,!0),Kb(t,r.data,r.blueprint,s,!1)}}(r,s?s(n):n,t)}}class uu{}class O${}class N$ extends uu{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Wd(this);const r=co(t);this._bootstrapComponents=Oa(r.bootstrap),this._r3Injector=lC(t,e,[{provide:uu,useValue:this},{provide:ba,useValue:this.componentFactoryResolver}],j1(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class eO extends O${constructor(t){super(),this.moduleType=t}create(t){return new N$(this.moduleType,t)}}class e6e extends uu{constructor(t,e,r){super(),this.componentFactoryResolver=new Wd(this),this.instance=null;const s=new C7([...t,{provide:uu,useValue:this},{provide:ba,useValue:this.componentFactoryResolver}],e||s4(),r,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function KC(n,t,e=null){return new e6e(n,t,e).injector}let t6e=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const r=Zh(0,e.type),s=r.length>0?KC([r],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,s)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=et({token:n,providedIn:"environment",factory:()=>new n(Re(wa))}),n})();function A$(n){n.getStandaloneInjector=t=>t.get(t6e).getOrCreateStandaloneInjector(n)}function tr(n,t,e){const r=Ai()+n,s=Le();return s[r]===fn?gn(s,r,e?t.call(e):t()):function er(n,t){return n[t]}(s,r)}function g3(n,t,e,r){return z$(Le(),Ai(),n,t,e,r)}function Jd(n,t){const e=n[t];return e===fn?void 0:e}function z$(n,t,e,r,s,i){const o=t+e;return A1(n,o,s)?gn(n,o+1,i?r.call(i,s):r(s)):Jd(n,o+1)}function _c(n,t){const e=Kn();let r;const s=n+22;e.firstCreatePass?(r=function v6e(n,t){if(t)for(let e=t.length-1;e>=0;e--){const r=t[e];if(n===r.name)return r}}(t,e.pipeRegistry),e.data[s]=r,r.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(s,r.onDestroy)):r=e.data[s];const i=r.factory||(r.factory=ya(r.type)),o=Go(Q);try{const c=Q3(!1),u=i();return Q3(c),function d4e(n,t,e,r){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=r}(e,Le(),s,u),u}finally{Go(o)}}function m3(n,t,e){const r=n+22,s=Le(),i=el(s,r);return ep(s,r)?z$(s,Ai(),t,i.transform,e,i):i.transform(e)}function $$(n,t,e,r){const s=n+22,i=Le(),o=el(i,s);return ep(i,s)?function V$(n,t,e,r,s,i,o){const c=t+e;return h2(n,c,s,i)?gn(n,c+2,o?r.call(o,s,i):r(s,i)):Jd(n,c+2)}(i,Ai(),t,o.transform,e,r,o):o.transform(e,r)}function ep(n,t){return n[1].data[t].pure}function nO(n){return t=>{setTimeout(n,void 0,t)}}const gr=class M6e extends z2{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,r){let s=t,i=e||(()=>null),o=r;if(t&&"object"==typeof t){const u=t;s=u.next?.bind(u),i=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(i=nO(i),s&&(s=nO(s)),o&&(o=nO(o)));const c=super.subscribe({next:s,error:i,complete:o});return t instanceof q1&&t.add(c),c}};function S6e(){return this._results[Pe()]()}class rO{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Pe(),r=rO.prototype;r[e]||(r[e]=S6e)}get changes(){return this._changes||(this._changes=new gr)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const r=this;r.dirty=!1;const s=s2(t);(this._changesDetected=!function Oh(n,t,e){if(n.length!==t.length)return!1;for(let r=0;r<n.length;r++){let s=n[r],i=t[r];if(e&&(s=e(s),i=e(i)),i!==s)return!1}return!0}(r._results,s,e))&&(r._results=s,r.length=s.length,r.last=s[this.length-1],r.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ml=(()=>{class n{}return n.__NG_ELEMENT_ID__=w6e,n})();const P6e=Ml,T6e=class extends P6e{constructor(t,e,r){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=r}createEmbeddedView(t,e){const r=this._declarationTContainer.tViews,s=H7(this._declarationLView,r,t,16,null,r.declTNode,null,null,null,null,e||null);s[17]=this._declarationLView[this._declarationTContainer.index];const o=this._declarationLView[19];return null!==o&&(s[19]=o.createEmbeddedView(r)),B7(r,s,t),new K7(s)}};function w6e(){return XC(Rr(),Le())}function XC(n,t){return 4&n.type?new T6e(t,n,K6(n,t)):null}let ka=(()=>{class n{}return n.__NG_ELEMENT_ID__=b6e,n})();function b6e(){return W$(Rr(),Le())}const O6e=ka,U$=class extends O6e{constructor(t,e,r){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=r}get element(){return K6(this._hostTNode,this._hostLView)}get injector(){return new V6(this._hostTNode,this._hostLView)}get parentInjector(){const t=Sa(this._hostTNode,this._hostLView);if(Eh(t)){const e=ol(t,this._hostLView),r=il(t);return new V6(e[1].data[r+8],e)}return new V6(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=G$(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,r){let s,i;"number"==typeof r?s=r:null!=r&&(s=r.index,i=r.injector);const o=t.createEmbeddedView(e||{},i);return this.insert(o,s),o}createComponent(t,e,r,s,i){const o=t&&!function Ii(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const m=e||{};c=m.index,r=m.injector,s=m.projectableNodes,i=m.environmentInjector||m.ngModuleRef}const u=o?t:new au(S1(t)),h=r||this.parentInjector;if(!i&&null==u.ngModule){const C=(o?h:this.parentInjector).get(wa,null);C&&(i=C)}const p=u.create(h,s,void 0,i);return this.insert(p.hostView,c),p}insert(t,e){const r=t._lView,s=r[1];if(function M8(n){return Mr(n[3])}(r)){const p=this.indexOf(t);if(-1!==p)this.detach(p);else{const m=r[3],C=new U$(m,m[6],m[3]);C.detach(C.indexOf(t))}}const i=this._adjustIndex(e),o=this._lContainer;!function Gw(n,t,e,r){const s=10+r,i=e.length;r>0&&(e[s-1][4]=t),r<i-10?(t[4]=e[s],s3(e,10+r,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function Ww(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=64}(s,r,o,i);const c=t0(i,o),u=r[11],h=e0(u,o[7]);return null!==h&&function Bw(n,t,e,r,s,i){r[0]=s,r[6]=t,n0(n,r,e,1,s,i)}(s,o[6],u,r,h,c),t.attachToViewContainerRef(),s3(sO(o),i,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=G$(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),r=hd(this._lContainer,e);r&&(U6(sO(this._lContainer),e),Bv(r[1],r))}detach(t){const e=this._adjustIndex(t,-1),r=hd(this._lContainer,e);return r&&null!=U6(sO(this._lContainer),e)?new K7(r):null}_adjustIndex(t,e=0){return t??this.length+e}};function G$(n){return n[8]}function sO(n){return n[8]||(n[8]=[])}function W$(n,t){let e;const r=t[n.index];if(Mr(r))e=r;else{let s;if(8&n.type)s=Sr(r);else{const i=t[11];s=i.createComment("");const o=t2(n,t);l3(i,e0(i,o),s,function Wv(n,t){return n.nextSibling(t)}(i,o),!1)}t[n.index]=e=xC(r,t,s,n),q7(t,e)}return new U$(e,n,t)}class iO{constructor(t){this.queryList=t,this.matches=null}clone(){return new iO(this.queryList)}setDirty(){this.queryList.setDirty()}}class oO{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const r=null!==t.contentQueries?t.contentQueries[0]:e.length,s=[];for(let i=0;i<r;i++){const o=e.getByIndex(i);s.push(this.queries[o.indexInDeclarationView].clone())}return new oO(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==K$(t,e).matches&&this.queries[e].setDirty()}}class q${constructor(t,e,r=null){this.predicate=t,this.flags=e,this.read=r}}class aO{constructor(t=[]){this.queries=t}elementStart(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let r=0;r<this.length;r++){const s=null!==e?e.length:0,i=this.getByIndex(r).embeddedTView(t,s);i&&(i.indexInDeclarationView=r,null!==e?e.push(i):e=[i])}return null!==e?new aO(e):null}template(t,e){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class cO{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new cO(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==e;)r=r.parent;return e===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const i=r[s];this.matchTNodeWithReadOption(t,e,I6e(e,i)),this.matchTNodeWithReadOption(t,e,Zr(e,t,i,!1,!1))}else r===Ml?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Zr(e,t,r,!1,!1))}matchTNodeWithReadOption(t,e,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===l2||s===ka||s===Ml&&4&e.type)this.addMatch(e.index,-2);else{const i=Zr(e,t,s,!1,!1);null!==i&&this.addMatch(e.index,i)}else this.addMatch(e.index,r)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function I6e(n,t){const e=n.localNames;if(null!==e)for(let r=0;r<e.length;r+=2)if(e[r]===t)return e[r+1];return null}function k6e(n,t,e,r){return-1===e?function x6e(n,t){return 11&n.type?K6(n,t):4&n.type?XC(n,t):null}(t,n):-2===e?function L6e(n,t,e){return e===l2?K6(t,n):e===Ml?XC(t,n):e===ka?W$(t,n):void 0}(n,t,r):Hs(n,n[1],e,t)}function j$(n,t,e,r){const s=t[19].queries[r];if(null===s.matches){const i=n.data,o=e.matches,c=[];for(let u=0;u<o.length;u+=2){const h=o[u];c.push(h<0?null:k6e(t,i[h],o[u+1],e.metadata.read))}s.matches=c}return s.matches}function lO(n,t,e,r){const s=n.queries.getByIndex(e),i=s.matches;if(null!==i){const o=j$(n,t,s,e);for(let c=0;c<i.length;c+=2){const u=i[c];if(u>0)r.push(o[c/2]);else{const h=i[c+1],p=t[-u];for(let m=10;m<p.length;m++){const C=p[m];C[17]===C[3]&&lO(C[1],C,h,r)}if(null!==p[9]){const m=p[9];for(let C=0;C<m.length;C++){const w=m[C];lO(w[1],w,h,r)}}}}}return r}function vc(n){const t=Le(),e=Kn(),r=mh();S8(r+1);const s=K$(e,r);if(n.dirty&&function O_(n){return 4==(4&n[2])}(t)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const i=s.crossesNgTemplate?lO(e,t,r,[]):j$(e,t,s,r);n.reset(i,M7),n.notifyOnChanges()}return!0}return!1}function f4(n,t,e){const r=Kn();r.firstCreatePass&&(function Y$(n,t,e){null===n.queries&&(n.queries=new aO),n.queries.track(new cO(t,e))}(r,new q$(n,t,e),-1),2==(2&t)&&(r.staticViewQueries=!0)),function Z$(n,t,e){const r=new rO(4==(4&e));bb(n,t,r,r.destroy),null===t[19]&&(t[19]=new oO),t[19].queries.push(new iO(r))}(r,Le(),t)}function Cc(){return function R6e(n,t){return n[19].queries[t].queryList}(Le(),mh())}function K$(n,t){return n.queries.getByIndex(t)}function c1(n,t){return XC(n,t)}function JC(...n){}const ey=new xt("Application Initializer");let ty=(()=>{class n{constructor(e){this.appInits=e,this.resolve=JC,this.reject=JC,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,s)=>{this.resolve=r,this.reject=s})}runInitializers(){if(this.initialized)return;const e=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const i=this.appInits[s]();if(qd(i))e.push(i);else if(Ub(i)){const o=new Promise((c,u)=>{i.subscribe({complete:c,error:u})});e.push(o)}}Promise.all(e).then(()=>{r()}).catch(s=>{this.reject(s)}),0===e.length&&r(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(Re(ey,8))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const np=new xt("AppId",{providedIn:"root",factory:function gU(){return`${gO()}${gO()}${gO()}`}});function gO(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const mU=new xt("Platform Initializer"),rp=new xt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),_U=new xt("appBootstrapListener"),vU=new xt("AnimationModuleType");let n0e=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const h4=new xt("LocaleId",{providedIn:"root",factory:()=>zr(h4,qt.Optional|qt.SkipSelf)||function r0e(){return typeof $localize<"u"&&$localize.locale||J7}()});class i0e{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let mO=(()=>{class n{compileModuleSync(e){return new eO(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const r=this.compileModuleSync(e),i=Oa(co(e).declarations).reduce((o,c)=>{const u=S1(c);return u&&o.push(new au(u)),o},[]);return new i0e(r,i)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const c0e=(()=>Promise.resolve(0))();function _O(n){typeof Zone>"u"?c0e.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Pr{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new gr(!1),this.onMicrotaskEmpty=new gr(!1),this.onStable=new gr(!1),this.onError=new gr(!1),typeof Zone>"u")throw new Ne(908,!1);Zone.assertZonePatched();const s=this;if(s._nesting=0,s._outer=s._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const i=Zone.AsyncStackTaggingZoneSpec;s._inner=s._inner.fork(new i("Angular"))}Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&e,s.shouldCoalesceRunChangeDetection=r,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function l0e(){let n=Q1.requestAnimationFrame,t=Q1.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function h0e(n){const t=()=>{!function f0e(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Q1,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,CO(n),n.isCheckStableRunning=!0,vO(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),CO(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,r,s,i,o,c)=>{try{return EU(n),e.invokeTask(s,i,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===i.type||n.shouldCoalesceRunChangeDetection)&&t(),MU(n)}},onInvoke:(e,r,s,i,o,c,u)=>{try{return EU(n),e.invoke(s,i,o,c,u)}finally{n.shouldCoalesceRunChangeDetection&&t(),MU(n)}},onHasTask:(e,r,s,i)=>{e.hasTask(s,i),r===s&&("microTask"==i.change?(n._hasPendingMicrotasks=i.microTask,CO(n),vO(n)):"macroTask"==i.change&&(n.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,r,s,i)=>(e.handleError(s,i),n.runOutsideAngular(()=>n.onError.emit(i)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Pr.isInAngularZone())throw new Ne(909,!1)}static assertNotInAngularZone(){if(Pr.isInAngularZone())throw new Ne(909,!1)}run(t,e,r){return this._inner.run(t,e,r)}runTask(t,e,r,s){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+s,t,u0e,JC,JC);try{return i.runTask(o,e,r)}finally{i.cancelTask(o)}}runGuarded(t,e,r){return this._inner.runGuarded(t,e,r)}runOutsideAngular(t){return this._outer.run(t)}}const u0e={};function vO(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function CO(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function EU(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function MU(n){n._nesting--,vO(n)}class d0e{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new gr,this.onMicrotaskEmpty=new gr,this.onStable=new gr,this.onError=new gr}run(t,e,r){return t.apply(e,r)}runGuarded(t,e,r){return t.apply(e,r)}runOutsideAngular(t){return t()}runTask(t,e,r,s){return t.apply(e,r)}}const SU=new xt(""),ny=new xt("");let MO,yO=(()=>{class n{constructor(e,r,s){this._ngZone=e,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,MO||(function p0e(n){MO=n}(s),s.addToWindow(r)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Pr.assertNotInAngularZone(),_O(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())_O(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(e)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,r,s){let i=-1;r&&r>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==i),e(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:s})}whenStable(e,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,r,s){return[]}}return n.\u0275fac=function(e){return new(e||n)(Re(Pr),Re(EO),Re(ny))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),EO=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,r){this._applications.set(e,r)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,r=!0){return MO?.findTestabilityInTree(this,e,r)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),l0=null;const PU=new xt("AllowMultipleToken"),SO=new xt("PlatformDestroyListeners");class TU{constructor(t,e){this.name=t,this.token=e}}function bU(n,t,e=[]){const r=`Platform: ${t}`,s=new xt(r);return(i=[])=>{let o=PO();if(!o||o.injector.get(PU,!1)){const c=[...e,...i,{provide:s,useValue:!0}];n?n(c):function _0e(n){if(l0&&!l0.get(PU,!1))throw new Ne(400,!1);l0=n;const t=n.get(NU);(function wU(n){const t=n.get(mU,null);t&&t.forEach(e=>e())})(n)}(function OU(n=[],t){return ui.create({name:t,providers:[{provide:Kh,useValue:"platform"},{provide:SO,useValue:new Set([()=>l0=null])},...n]})}(c,r))}return function C0e(n){const t=PO();if(!t)throw new Ne(401,!1);return t}()}}function PO(){return l0?.get(NU)??null}let NU=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,r){const s=function IU(n,t){let e;return e="noop"===n?new d0e:("zone.js"===n?void 0:n)||new Pr(t),e}(r?.ngZone,function AU(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(r)),i=[{provide:Pr,useValue:s}];return s.run(()=>{const o=ui.create({providers:i,parent:this.injector,name:e.moduleType.name}),c=e.create(o),u=c.injector.get(J6,null);if(!u)throw new Ne(402,!1);return s.runOutsideAngular(()=>{const h=s.onError.subscribe({next:p=>{u.handleError(p)}});c.onDestroy(()=>{ry(this._modules,c),h.unsubscribe()})}),function xU(n,t,e){try{const r=e();return qd(r)?r.catch(s=>{throw t.runOutsideAngular(()=>n.handleError(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>n.handleError(r)),r}}(u,s,()=>{const h=c.injector.get(ty);return h.runInitializers(),h.donePromise.then(()=>(o$(c.injector.get(h4,J7)||J7),this._moduleDoBootstrap(c),c))})})}bootstrapModule(e,r=[]){const s=kU({},r);return function g0e(n,t,e){const r=new eO(e);return Promise.resolve(r)}(0,0,e).then(i=>this.bootstrapModuleFactory(i,s))}_moduleDoBootstrap(e){const r=e.injector.get(sp);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(s=>r.bootstrap(s));else{if(!e.instance.ngDoBootstrap)throw new Ne(403,!1);e.instance.ngDoBootstrap(r)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ne(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const e=this._injector.get(SO,null);e&&(e.forEach(r=>r()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(Re(ui))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function kU(n,t){return Array.isArray(t)?t.reduce(kU,n):{...n,...t}}let sp=(()=>{class n{constructor(e,r,s){this._zone=e,this._injector=r,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const i=new Er(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),o=new Er(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{Pr.assertNotInAngularZone(),_O(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{Pr.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function h_(...n){const t=U3(n),e=function A5(n,t){return"number"==typeof K4(n)?n.pop():t}(n,1/0),r=n;return r.length?1===r.length?oo(r[0]):Y4(e)(as(r,t)):ic}(i,o.pipe(function oT(n={}){const{connector:t=(()=>new z2),resetOnError:e=!0,resetOnComplete:r=!0,resetOnRefCountZero:s=!0}=n;return i=>{let o,c,u,h=0,p=!1,m=!1;const C=()=>{c?.unsubscribe(),c=void 0},w=()=>{C(),o=u=void 0,p=m=!1},I=()=>{const H=o;w(),H?.unsubscribe()};return pr((H,Y)=>{h++,!m&&!p&&C();const ee=u=u??t();Y.add(()=>{h--,0===h&&!m&&!p&&(c=k5(I,s))}),ee.subscribe(Y),!o&&h>0&&(o=new lr({next:ve=>ee.next(ve),error:ve=>{m=!0,C(),c=k5(w,e,ve),ee.error(ve)},complete:()=>{p=!0,C(),c=k5(w,r),ee.complete()}}),oo(H).subscribe(o))})(i)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,r){const s=e instanceof Sv;if(!this._injector.get(ty).done)throw!s&&function J4(n){const t=S1(n)||Ki(n)||Xi(n);return null!==t&&t.standalone}(e),new Ne(405,false);let o;o=s?e:this._injector.get(ba).resolveComponentFactory(e),this.componentTypes.push(o.componentType);const c=function m0e(n){return n.isBoundToModule}(o)?void 0:this._injector.get(uu),h=o.create(ui.NULL,[],r||o.selector,c),p=h.location.nativeElement,m=h.injector.get(SU,null);return m?.registerApplication(p),h.onDestroy(()=>{this.detachView(h.hostView),ry(this.components,h),m?.unregisterApplication(p)}),this._loadComponent(h),h}tick(){if(this._runningTick)throw new Ne(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const r=e;this._views.push(r),r.attachToAppRef(this)}detachView(e){const r=e;ry(this._views,r),r.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(_U,[]).concat(this._bootstrapListeners).forEach(s=>s(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>ry(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new Ne(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(Re(Pr),Re(wa),Re(J6))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function ry(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let RU=!0,fu=(()=>{class n{}return n.__NG_ELEMENT_ID__=M0e,n})();function M0e(n){return function S0e(n,t,e){if(Zo(n)&&!e){const r=Ni(n.index,t);return new K7(r,r)}return 47&n.type?new K7(t[16],t):null}(Rr(),Le(),16==(16&n))}class FU{constructor(){}supports(t){return ze(t)}create(t){return new N0e(t)}}const O0e=(n,t)=>t;class N0e{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||O0e}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,r=this._removalsHead,s=0,i=null;for(;e||r;){const o=!r||e&&e.currentIndex<$U(r,s,i)?e:r,c=$U(o,s,i),u=o.currentIndex;if(o===r)s--,r=r._nextRemoved;else if(e=e._next,null==o.previousIndex)s++;else{i||(i=[]);const h=c-s,p=u-s;if(h!=p){for(let C=0;C<h;C++){const w=C<i.length?i[C]:i[C]=0,I=w+C;p<=I&&I<h&&(i[C]=w+1)}i[o.previousIndex]=p-h}}c!==u&&t(o,c,u)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ze(t))throw new Ne(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let s,i,o,e=this._itHead,r=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)i=t[c],o=this._trackByFn(c,i),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,i,o,c)),Object.is(e.item,i)||this._addIdentityChange(e,i)):(e=this._mismatch(e,i,o,c),r=!0),e=e._next}else s=0,function nt(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Pe()]();let r;for(;!(r=e.next()).done;)t(r.value)}}(t,c=>{o=this._trackByFn(s,c),null!==e&&Object.is(e.trackById,o)?(r&&(e=this._verifyReinsertion(e,c,o,s)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,s),r=!0),e=e._next,s++}),this.length=s;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,r,s){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,s)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(r,s))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,s)):t=this._addAfter(new A0e(e,r),i,s),t}_verifyReinsertion(t,e,r,s){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==i?t=this._reinsertAfter(i,t._prev,s):t.currentIndex!=s&&(t.currentIndex=s,this._addToMoves(t,s)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const s=t._prevRemoved,i=t._nextRemoved;return null===s?this._removalsHead=i:s._nextRemoved=i,null===i?this._removalsTail=s:i._prevRemoved=s,this._insertAfter(t,e,r),this._addToMoves(t,r),t}_moveAfter(t,e,r){return this._unlink(t),this._insertAfter(t,e,r),this._addToMoves(t,r),t}_addAfter(t,e,r){return this._insertAfter(t,e,r),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,r){const s=null===e?this._itHead:e._next;return t._next=s,t._prev=e,null===s?this._itTail=t:s._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new BU),this._linkedRecords.put(t),t.currentIndex=r,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,r=t._next;return null===e?this._itHead=r:e._next=r,null===r?this._itTail=e:r._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new BU),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class A0e{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class I0e{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===e||e<=r.currentIndex)&&Object.is(r.trackById,t))return r;return null}remove(t){const e=t._prevDup,r=t._nextDup;return null===e?this._head=r:e._nextDup=r,null===r?this._tail=e:r._prevDup=e,null===this._head}}class BU{constructor(){this.map=new Map}put(t){const e=t.trackById;let r=this.map.get(e);r||(r=new I0e,this.map.set(e,r)),r.add(t)}get(t,e){const s=this.map.get(t);return s?s.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $U(n,t,e){const r=n.previousIndex;if(null===r)return r;let s=0;return e&&r<e.length&&(s=e[r]),r+t+s}class UU{constructor(){}supports(t){return t instanceof Map||_t(t)}create(){return new x0e}}class x0e{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||_t(t)))throw new Ne(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(e&&e.key===s)this._maybeAddToChanges(e,r),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(s,r);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let r=e;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const r=t._prev;return e._next=t,e._prev=r,t._prev=e,r&&(r._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,e);const i=s._prev,o=s._next;return i&&(i._next=o),o&&(o._prev=i),s._next=null,s._prev=null,s}const r=new k0e(t);return this._records.set(t,r),r.currentValue=e,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(r=>e(t[r],r))}}class k0e{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function GU(){return new oy([new FU])}let oy=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(null!=r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||GU()),deps:[[n,new H8,new li]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(null!=r)return r;throw new Ne(901,!1)}}return n.\u0275prov=et({token:n,providedIn:"root",factory:GU}),n})();function WU(){return new ip([new UU])}let ip=(()=>{class n{constructor(e){this.factories=e}static create(e,r){if(r){const s=r.factories.slice();e=e.concat(s)}return new n(e)}static extend(e){return{provide:n,useFactory:r=>n.create(e,r||WU()),deps:[[n,new H8,new li]]}}find(e){const r=this.factories.find(s=>s.supports(e));if(r)return r;throw new Ne(901,!1)}}return n.\u0275prov=et({token:n,providedIn:"root",factory:WU}),n})();const D0e=bU(null,"core",[]);let z0e=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(Re(sp))},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({}),n})();function Pl(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let ay=null;function d4(){return ay}const Bs=new xt("DocumentToken");let NO=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return function B0e(){return Re(qU)}()},providedIn:"platform"}),n})();const $0e=new xt("Location Initialized");let qU=(()=>{class n extends NO{constructor(e){super(),this._doc=e,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return d4().getBaseHref(this._doc)}onPopState(e){const r=d4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",e,!1),()=>r.removeEventListener("popstate",e)}onHashChange(e){const r=d4().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",e,!1),()=>r.removeEventListener("hashchange",e)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(e){this.location.pathname=e}pushState(e,r,s){jU()?this._history.pushState(e,r,s):this.location.hash=s}replaceState(e,r,s){jU()?this._history.replaceState(e,r,s):this.location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs))},n.\u0275prov=et({token:n,factory:function(){return function U0e(){return new qU(Re(Bs))}()},providedIn:"platform"}),n})();function jU(){return!!window.history.pushState}function AO(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function ZU(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function Tl(n){return n&&"?"!==n[0]?"?"+n:n}let du=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return zr(KU)},providedIn:"root"}),n})();const YU=new xt("appBaseHref");let KU=(()=>{class n extends du{constructor(e,r){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??zr(Bs).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return AO(this._baseHref,e)}path(e=!1){const r=this._platformLocation.pathname+Tl(this._platformLocation.search),s=this._platformLocation.hash;return s&&e?`${r}${s}`:r}pushState(e,r,s,i){const o=this.prepareExternalUrl(s+Tl(i));this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){const o=this.prepareExternalUrl(s+Tl(i));this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Re(NO),Re(YU,8))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),G0e=(()=>{class n extends du{constructor(e,r){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(e){const r=AO(this._baseHref,e);return r.length>0?"#"+r:r}pushState(e,r,s,i){let o=this.prepareExternalUrl(s+Tl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(e,r,o)}replaceState(e,r,s,i){let o=this.prepareExternalUrl(s+Tl(i));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(e,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(Re(NO),Re(YU,8))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),IO=(()=>{class n{constructor(e){this._subject=new gr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const r=this._locationStrategy.getBaseHref();this._baseHref=ZU(XU(r)),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,r=""){return this.path()==this.normalize(e+Tl(r))}normalize(e){return n.stripTrailingSlash(function q0e(n,t){return n&&t.startsWith(n)?t.substring(n.length):t}(this._baseHref,XU(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,r="",s=null){this._locationStrategy.pushState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Tl(r)),s)}replaceState(e,r="",s=null){this._locationStrategy.replaceState(s,"",e,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Tl(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",r){this._urlChangeListeners.forEach(s=>s(e,r))}subscribe(e,r,s){return this._subject.subscribe({next:e,error:r,complete:s})}}return n.normalizeQueryParams=Tl,n.joinWithSlash=AO,n.stripTrailingSlash=ZU,n.\u0275fac=function(e){return new(e||n)(Re(du))},n.\u0275prov=et({token:n,factory:function(){return function W0e(){return new IO(Re(du))}()},providedIn:"root"}),n})();function XU(n){return n.replace(/\/index.html$/,"")}var sa=(()=>((sa=sa||{})[sa.Decimal=0]="Decimal",sa[sa.Percent=1]="Percent",sa[sa.Currency=2]="Currency",sa[sa.Scientific=3]="Scientific",sa))(),Ms=(()=>((Ms=Ms||{})[Ms.Format=0]="Format",Ms[Ms.Standalone=1]="Standalone",Ms))(),Xn=(()=>((Xn=Xn||{})[Xn.Narrow=0]="Narrow",Xn[Xn.Abbreviated=1]="Abbreviated",Xn[Xn.Wide=2]="Wide",Xn[Xn.Short=3]="Short",Xn))(),Kr=(()=>((Kr=Kr||{})[Kr.Short=0]="Short",Kr[Kr.Medium=1]="Medium",Kr[Kr.Long=2]="Long",Kr[Kr.Full=3]="Full",Kr))(),Qt=(()=>((Qt=Qt||{})[Qt.Decimal=0]="Decimal",Qt[Qt.Group=1]="Group",Qt[Qt.List=2]="List",Qt[Qt.PercentSign=3]="PercentSign",Qt[Qt.PlusSign=4]="PlusSign",Qt[Qt.MinusSign=5]="MinusSign",Qt[Qt.Exponential=6]="Exponential",Qt[Qt.SuperscriptingExponent=7]="SuperscriptingExponent",Qt[Qt.PerMille=8]="PerMille",Qt[Qt.Infinity=9]="Infinity",Qt[Qt.NaN=10]="NaN",Qt[Qt.TimeSeparator=11]="TimeSeparator",Qt[Qt.CurrencyDecimal=12]="CurrencyDecimal",Qt[Qt.CurrencyGroup=13]="CurrencyGroup",Qt))();function cy(n,t){return Ec(yo(n)[mt.DateFormat],t)}function ly(n,t){return Ec(yo(n)[mt.TimeFormat],t)}function uy(n,t){return Ec(yo(n)[mt.DateTimeFormat],t)}function yc(n,t){const e=yo(n),r=e[mt.NumberSymbols][t];if(typeof r>"u"){if(t===Qt.CurrencyDecimal)return e[mt.NumberSymbols][Qt.Decimal];if(t===Qt.CurrencyGroup)return e[mt.NumberSymbols][Qt.Group]}return r}function JU(n){if(!n[mt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[mt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ec(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function kO(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const i8e=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,op={},o8e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var hi=(()=>((hi=hi||{})[hi.Short=0]="Short",hi[hi.ShortGMT=1]="ShortGMT",hi[hi.Long=2]="Long",hi[hi.Extended=3]="Extended",hi))(),cn=(()=>((cn=cn||{})[cn.FullYear=0]="FullYear",cn[cn.Month=1]="Month",cn[cn.Date=2]="Date",cn[cn.Hours=3]="Hours",cn[cn.Minutes=4]="Minutes",cn[cn.Seconds=5]="Seconds",cn[cn.FractionalSeconds=6]="FractionalSeconds",cn[cn.Day=7]="Day",cn))(),kn=(()=>((kn=kn||{})[kn.DayPeriods=0]="DayPeriods",kn[kn.Days=1]="Days",kn[kn.Months=2]="Months",kn[kn.Eras=3]="Eras",kn))();function eG(n,t,e,r){let s=function g8e(n){if(rG(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,i=1,o=1]=n.split("-").map(c=>+c);return fy(s,i-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let r;if(r=n.match(i8e))return function m8e(n){const t=new Date(0);let e=0,r=0;const s=n[8]?t.setUTCFullYear:t.setFullYear,i=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),r=Number(n[9]+n[11])),s.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-r,u=Number(n[6]||0),h=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return i.call(t,o,c,u,h),t}(r)}const t=new Date(n);if(!rG(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=wl(e,t)||t;let c,o=[];for(;t;){if(c=o8e.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const p=o.pop();if(!p)break;t=p}}let u=s.getTimezoneOffset();r&&(u=nG(r,u),s=function p8e(n,t,e){const r=e?-1:1,s=n.getTimezoneOffset();return function d8e(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,r*(nG(t,s)-s))}(s,r,!0));let h="";return o.forEach(p=>{const m=function h8e(n){if(RO[n])return RO[n];let t;switch(n){case"G":case"GG":case"GGG":t=mr(kn.Eras,Xn.Abbreviated);break;case"GGGG":t=mr(kn.Eras,Xn.Wide);break;case"GGGGG":t=mr(kn.Eras,Xn.Narrow);break;case"y":t=Us(cn.FullYear,1,0,!1,!0);break;case"yy":t=Us(cn.FullYear,2,0,!0,!0);break;case"yyy":t=Us(cn.FullYear,3,0,!1,!0);break;case"yyyy":t=Us(cn.FullYear,4,0,!1,!0);break;case"Y":t=gy(1);break;case"YY":t=gy(2,!0);break;case"YYY":t=gy(3);break;case"YYYY":t=gy(4);break;case"M":case"L":t=Us(cn.Month,1,1);break;case"MM":case"LL":t=Us(cn.Month,2,1);break;case"MMM":t=mr(kn.Months,Xn.Abbreviated);break;case"MMMM":t=mr(kn.Months,Xn.Wide);break;case"MMMMM":t=mr(kn.Months,Xn.Narrow);break;case"LLL":t=mr(kn.Months,Xn.Abbreviated,Ms.Standalone);break;case"LLLL":t=mr(kn.Months,Xn.Wide,Ms.Standalone);break;case"LLLLL":t=mr(kn.Months,Xn.Narrow,Ms.Standalone);break;case"w":t=LO(1);break;case"ww":t=LO(2);break;case"W":t=LO(1,!0);break;case"d":t=Us(cn.Date,1);break;case"dd":t=Us(cn.Date,2);break;case"c":case"cc":t=Us(cn.Day,1);break;case"ccc":t=mr(kn.Days,Xn.Abbreviated,Ms.Standalone);break;case"cccc":t=mr(kn.Days,Xn.Wide,Ms.Standalone);break;case"ccccc":t=mr(kn.Days,Xn.Narrow,Ms.Standalone);break;case"cccccc":t=mr(kn.Days,Xn.Short,Ms.Standalone);break;case"E":case"EE":case"EEE":t=mr(kn.Days,Xn.Abbreviated);break;case"EEEE":t=mr(kn.Days,Xn.Wide);break;case"EEEEE":t=mr(kn.Days,Xn.Narrow);break;case"EEEEEE":t=mr(kn.Days,Xn.Short);break;case"a":case"aa":case"aaa":t=mr(kn.DayPeriods,Xn.Abbreviated);break;case"aaaa":t=mr(kn.DayPeriods,Xn.Wide);break;case"aaaaa":t=mr(kn.DayPeriods,Xn.Narrow);break;case"b":case"bb":case"bbb":t=mr(kn.DayPeriods,Xn.Abbreviated,Ms.Standalone,!0);break;case"bbbb":t=mr(kn.DayPeriods,Xn.Wide,Ms.Standalone,!0);break;case"bbbbb":t=mr(kn.DayPeriods,Xn.Narrow,Ms.Standalone,!0);break;case"B":case"BB":case"BBB":t=mr(kn.DayPeriods,Xn.Abbreviated,Ms.Format,!0);break;case"BBBB":t=mr(kn.DayPeriods,Xn.Wide,Ms.Format,!0);break;case"BBBBB":t=mr(kn.DayPeriods,Xn.Narrow,Ms.Format,!0);break;case"h":t=Us(cn.Hours,1,-12);break;case"hh":t=Us(cn.Hours,2,-12);break;case"H":t=Us(cn.Hours,1);break;case"HH":t=Us(cn.Hours,2);break;case"m":t=Us(cn.Minutes,1);break;case"mm":t=Us(cn.Minutes,2);break;case"s":t=Us(cn.Seconds,1);break;case"ss":t=Us(cn.Seconds,2);break;case"S":t=Us(cn.FractionalSeconds,1);break;case"SS":t=Us(cn.FractionalSeconds,2);break;case"SSS":t=Us(cn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=dy(hi.Short);break;case"ZZZZZ":t=dy(hi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=dy(hi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=dy(hi.Long);break;default:return null}return RO[n]=t,t}(p);h+=m?m(s,e,u):"''"===p?"'":p.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),h}function fy(n,t,e){const r=new Date(0);return r.setFullYear(n,t,e),r.setHours(0,0,0),r}function wl(n,t){const e=function j0e(n){return yo(n)[mt.LocaleId]}(n);if(op[e]=op[e]||{},op[e][t])return op[e][t];let r="";switch(t){case"shortDate":r=cy(n,Kr.Short);break;case"mediumDate":r=cy(n,Kr.Medium);break;case"longDate":r=cy(n,Kr.Long);break;case"fullDate":r=cy(n,Kr.Full);break;case"shortTime":r=ly(n,Kr.Short);break;case"mediumTime":r=ly(n,Kr.Medium);break;case"longTime":r=ly(n,Kr.Long);break;case"fullTime":r=ly(n,Kr.Full);break;case"short":const s=wl(n,"shortTime"),i=wl(n,"shortDate");r=hy(uy(n,Kr.Short),[s,i]);break;case"medium":const o=wl(n,"mediumTime"),c=wl(n,"mediumDate");r=hy(uy(n,Kr.Medium),[o,c]);break;case"long":const u=wl(n,"longTime"),h=wl(n,"longDate");r=hy(uy(n,Kr.Long),[u,h]);break;case"full":const p=wl(n,"fullTime"),m=wl(n,"fullDate");r=hy(uy(n,Kr.Full),[p,m])}return r&&(op[e][t]=r),r}function hy(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,r){return null!=t&&r in t?t[r]:e})),n}function v3(n,t,e="-",r,s){let i="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,i=e));let o=String(n);for(;o.length<t;)o="0"+o;return r&&(o=o.slice(o.length-t)),i+o}function Us(n,t,e=0,r=!1,s=!1){return function(i,o){let c=function c8e(n,t){switch(n){case cn.FullYear:return t.getFullYear();case cn.Month:return t.getMonth();case cn.Date:return t.getDate();case cn.Hours:return t.getHours();case cn.Minutes:return t.getMinutes();case cn.Seconds:return t.getSeconds();case cn.FractionalSeconds:return t.getMilliseconds();case cn.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,i);if((e>0||c>-e)&&(c+=e),n===cn.Hours)0===c&&-12===e&&(c=12);else if(n===cn.FractionalSeconds)return function a8e(n,t){return v3(n,3).substring(0,t)}(c,t);const u=yc(o,Qt.MinusSign);return v3(c,t,u,r,s)}}function mr(n,t,e=Ms.Format,r=!1){return function(s,i){return function l8e(n,t,e,r,s,i){switch(e){case kn.Months:return function K0e(n,t,e){const r=yo(n),i=Ec([r[mt.MonthsFormat],r[mt.MonthsStandalone]],t);return Ec(i,e)}(t,s,r)[n.getMonth()];case kn.Days:return function Y0e(n,t,e){const r=yo(n),i=Ec([r[mt.DaysFormat],r[mt.DaysStandalone]],t);return Ec(i,e)}(t,s,r)[n.getDay()];case kn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(i){const h=function e8e(n){const t=yo(n);return JU(t),(t[mt.ExtraData][2]||[]).map(r=>"string"==typeof r?kO(r):[kO(r[0]),kO(r[1])])}(t),p=function t8e(n,t,e){const r=yo(n);JU(r);const i=Ec([r[mt.ExtraData][0],r[mt.ExtraData][1]],t)||[];return Ec(i,e)||[]}(t,s,r),m=h.findIndex(C=>{if(Array.isArray(C)){const[w,I]=C,H=o>=w.hours&&c>=w.minutes,Y=o<I.hours||o===I.hours&&c<I.minutes;if(w.hours<I.hours){if(H&&Y)return!0}else if(H||Y)return!0}else if(C.hours===o&&C.minutes===c)return!0;return!1});if(-1!==m)return p[m]}return function Z0e(n,t,e){const r=yo(n),i=Ec([r[mt.DayPeriodsFormat],r[mt.DayPeriodsStandalone]],t);return Ec(i,e)}(t,s,r)[o<12?0:1];case kn.Eras:return function X0e(n,t){return Ec(yo(n)[mt.Eras],t)}(t,r)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(s,i,n,t,e,r)}}function dy(n){return function(t,e,r){const s=-1*r,i=yc(e,Qt.MinusSign),o=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case hi.Short:return(s>=0?"+":"")+v3(o,2,i)+v3(Math.abs(s%60),2,i);case hi.ShortGMT:return"GMT"+(s>=0?"+":"")+v3(o,1,i);case hi.Long:return"GMT"+(s>=0?"+":"")+v3(o,2,i)+":"+v3(Math.abs(s%60),2,i);case hi.Extended:return 0===r?"Z":(s>=0?"+":"")+v3(o,2,i)+":"+v3(Math.abs(s%60),2,i);default:throw new Error(`Unknown zone width "${n}"`)}}}function tG(n){return fy(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function LO(n,t=!1){return function(e,r){let s;if(t){const i=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();s=1+Math.floor((o+i)/7)}else{const i=tG(e),o=function f8e(n){const t=fy(n,0,1).getDay();return fy(n,0,1+(t<=4?4:11)-t)}(i.getFullYear()),c=i.getTime()-o.getTime();s=1+Math.round(c/6048e5)}return v3(s,n,yc(r,Qt.MinusSign))}}function gy(n,t=!1){return function(e,r){return v3(tG(e).getFullYear(),n,yc(r,Qt.MinusSign),t)}}const RO={};function nG(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function rG(n){return n instanceof Date&&!isNaN(n.valueOf())}const _8e=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function HO(n){const t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}function aG(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const r=e.indexOf("="),[s,i]=-1==r?[e,""]:[e.slice(0,r),e.slice(r+1)];if(s.trim()===t)return decodeURIComponent(i)}return null}let mn=(()=>{class n{constructor(e,r,s,i){this._iterableDiffers=e,this._keyValueDiffers=r,this._ngEl=s,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(ze(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachChangedItem(r=>this._toggleClass(r.key,r.currentValue)),e.forEachRemovedItem(r=>{r.previousValue&&this._toggleClass(r.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(r=>{if("string"!=typeof r.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${j1(r.item)}`);this._toggleClass(r.item,!0)}),e.forEachRemovedItem(r=>this._toggleClass(r.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!0)):Object.keys(e).forEach(r=>this._toggleClass(r,!!e[r])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(r=>this._toggleClass(r,!1)):Object.keys(e).forEach(r=>this._toggleClass(r,!1)))}_toggleClass(e,r){(e=e.trim())&&e.split(/\s+/g).forEach(s=>{r?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}}return n.\u0275fac=function(e){return new(e||n)(Q(oy),Q(ip),Q(l2),Q(mo))},n.\u0275dir=$t({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class A8e{constructor(t,e,r,s){this.$implicit=t,this.ngForOf=e,this.index=r,this.count=s}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ln=(()=>{class n{constructor(e,r,s){this._viewContainer=e,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const r=this._viewContainer;e.forEachOperation((s,i,o)=>{if(null==s.previousIndex)r.createEmbeddedView(this._template,new A8e(s.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===i?void 0:i);else if(null!==i){const c=r.get(i);r.move(c,o),uG(c,s)}});for(let s=0,i=r.length;s<i;s++){const c=r.get(s).context;c.index=s,c.count=i,c.ngForOf=this._ngForOf}e.forEachIdentityChange(s=>{uG(r.get(s.currentIndex),s)})}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(ka),Q(Ml),Q(oy))},n.\u0275dir=$t({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function uG(n,t){n.context.$implicit=t.item}let nn=(()=>{class n{constructor(e,r){this._viewContainer=e,this._context=new x8e,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){fG("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){fG("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,r){return!0}}return n.\u0275fac=function(e){return new(e||n)(Q(ka),Q(Ml))},n.\u0275dir=$t({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class x8e{constructor(){this.$implicit=null,this.ngIf=null}}function fG(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${j1(t)}'.`)}let pG=(()=>{class n{constructor(e){this._locale=e}transform(e,r,s){if(!function UO(n){return!(null==n||""===n||n!=n)}(e))return null;s=s||this._locale;try{return function S8e(n,t,e){return function zO(n,t,e,r,s,i,o=!1){let c="",u=!1;if(isFinite(n)){let h=function T8e(n){let r,s,i,o,c,t=Math.abs(n)+"",e=0;for((s=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(s<0&&(s=i),s+=+t.slice(i+1),t=t.substring(0,i)):s<0&&(s=t.length),i=0;"0"===t.charAt(i);i++);if(i===(c=t.length))r=[0],s=1;else{for(c--;"0"===t.charAt(c);)c--;for(s-=i,r=[],o=0;i<=c;i++,o++)r[o]=Number(t.charAt(i))}return s>22&&(r=r.splice(0,21),e=s-1,s=1),{digits:r,exponent:e,integerLen:s}}(n);o&&(h=function P8e(n){if(0===n.digits[0])return n;const t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(0===t?n.digits.push(0,0):1===t&&n.digits.push(0),n.integerLen+=2),n}(h));let p=t.minInt,m=t.minFrac,C=t.maxFrac;if(i){const ve=i.match(_8e);if(null===ve)throw new Error(`${i} is not a valid digit info`);const te=ve[1],Ie=ve[3],Be=ve[5];null!=te&&(p=HO(te)),null!=Ie&&(m=HO(Ie)),null!=Be?C=HO(Be):null!=Ie&&m>C&&(C=m)}!function w8e(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let r=n.digits,s=r.length-n.integerLen;const i=Math.min(Math.max(t,s),e);let o=i+n.integerLen,c=r[o];if(o>0){r.splice(Math.max(n.integerLen,o));for(let m=o;m<r.length;m++)r[m]=0}else{s=Math.max(0,s),n.integerLen=1,r.length=Math.max(1,o=i+1),r[0]=0;for(let m=1;m<o;m++)r[m]=0}if(c>=5)if(o-1<0){for(let m=0;m>o;m--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[o-1]++;for(;s<Math.max(0,i);s++)r.push(0);let u=0!==i;const h=t+n.integerLen,p=r.reduceRight(function(m,C,w,I){return I[w]=(C+=m)<10?C:C-10,u&&(0===I[w]&&w>=h?I.pop():u=!1),C>=10?1:0},0);p&&(r.unshift(p),n.integerLen++)}(h,m,C);let w=h.digits,I=h.integerLen;const H=h.exponent;let Y=[];for(u=w.every(ve=>!ve);I<p;I++)w.unshift(0);for(;I<0;I++)w.unshift(0);I>0?Y=w.splice(I,w.length):(Y=w,w=[0]);const ee=[];for(w.length>=t.lgSize&&ee.unshift(w.splice(-t.lgSize,w.length).join(""));w.length>t.gSize;)ee.unshift(w.splice(-t.gSize,w.length).join(""));w.length&&ee.unshift(w.join("")),c=ee.join(yc(e,r)),Y.length&&(c+=yc(e,s)+Y.join("")),H&&(c+=yc(e,Qt.Exponential)+"+"+H)}else c=yc(e,Qt.Infinity);return c=n<0&&!u?t.negPre+c+t.negSuf:t.posPre+c+t.posSuf,c}(n,function VO(n,t="-"){const e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(";"),s=r[0],i=r[1],o=-1!==s.indexOf(".")?s.split("."):[s.substring(0,s.lastIndexOf("0")+1),s.substring(s.lastIndexOf("0")+1)],c=o[0],u=o[1]||"";e.posPre=c.substring(0,c.indexOf("#"));for(let p=0;p<u.length;p++){const m=u.charAt(p);"0"===m?e.minFrac=e.maxFrac=p+1:"#"===m?e.maxFrac=p+1:e.posSuf+=m}const h=c.split(",");if(e.gSize=h[1]?h[1].length:0,e.lgSize=h[2]||h[1]?(h[2]||h[1]).length:0,i){const p=s.length-e.posPre.length-e.posSuf.length,m=i.indexOf("#");e.negPre=i.substring(0,m).replace(/'/g,""),e.negSuf=i.slice(m+p).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}(function xO(n,t){return yo(n)[mt.NumberFormats][t]}(t,sa.Decimal),yc(t,Qt.MinusSign)),t,Qt.Group,Qt.Decimal,e)}(function GO(n){if("string"==typeof n&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if("number"!=typeof n)throw new Error(`${n} is not a number`);return n}(e),s,r)}catch(i){throw function C3(n,t){return new Ne(2100,!1)}()}}}return n.\u0275fac=function(e){return new(e||n)(Q(h4,16))},n.\u0275pipe=oi({name:"number",type:n,pure:!0,standalone:!0}),n})();let sue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({}),n})();let cue=(()=>{class n{}return n.\u0275prov=et({token:n,providedIn:"root",factory:()=>new lue(Re(Bs),window)}),n})();class lue{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function uue(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=r.currentNode;for(;s;){const i=s.shadowRoot;if(i){const o=i.getElementById(t)||i.querySelector(`[name="${t}"]`);if(o)return o}s=r.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),r=e.left+this.window.pageXOffset,s=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(r-i[0],s-i[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=mG(this.window.history)||mG(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function mG(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class _G{}class jO extends class Oue extends class F0e{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function H0e(n){ay||(ay=n)}(new jO)}onAndCancel(t,e,r){return t.addEventListener(e,r,!1),()=>{t.removeEventListener(e,r,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function Nue(){return lp=lp||document.querySelector("base"),lp?lp.getAttribute("href"):null}();return null==e?null:function Aue(n){vy=vy||document.createElement("a"),vy.setAttribute("href",n);const t=vy.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){lp=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return aG(document.cookie,t)}}let vy,lp=null;const EG=new xt("TRANSITION_ID"),xue=[{provide:ey,useFactory:function Iue(n,t,e){return()=>{e.get(ty).donePromise.then(()=>{const r=d4(),s=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let i=0;i<s.length;i++)r.remove(s[i])})}},deps:[EG,Bs,ui],multi:!0}];let Lue=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const Cy=new xt("EventManagerPlugins");let yy=(()=>{class n{constructor(e,r){this._zone=r,this._eventNameToPlugin=new Map,e.forEach(s=>s.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,r,s){return this._findPluginFor(r).addEventListener(e,r,s)}addGlobalEventListener(e,r,s){return this._findPluginFor(r).addGlobalEventListener(e,r,s)}getZone(){return this._zone}_findPluginFor(e){const r=this._eventNameToPlugin.get(e);if(r)return r;const s=this._plugins;for(let i=0;i<s.length;i++){const o=s[i];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(Re(Cy),Re(Pr))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class MG{constructor(t){this._doc=t}addGlobalEventListener(t,e,r){const s=d4().getGlobalEventTarget(this._doc,t);if(!s)throw new Error(`Unsupported event target ${s} for event ${e}`);return this.addEventListener(s,e,r)}}let SG=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const r=new Set;e.forEach(s=>{this._stylesSet.has(s)||(this._stylesSet.add(s),r.add(s))}),this.onStylesAdded(r)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),up=(()=>{class n extends SG{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,r,s){e.forEach(i=>{const o=this._doc.createElement("style");o.textContent=i,s.push(r.appendChild(o))})}addHost(e){const r=[];this._addStylesToHost(this._stylesSet,e,r),this._hostNodes.set(e,r)}removeHost(e){const r=this._hostNodes.get(e);r&&r.forEach(PG),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((r,s)=>{this._addStylesToHost(e,s,r)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(PG))}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();function PG(n){d4().remove(n)}const ZO={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},YO=/%COMP%/g;function Ey(n,t,e){for(let r=0;r<t.length;r++){let s=t[r];Array.isArray(s)?Ey(n,s,e):(s=s.replace(YO,n),e.push(s))}return e}function bG(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let My=(()=>{class n{constructor(e,r,s){this.eventManager=e,this.sharedStylesHost=r,this.appId=s,this.rendererByCompId=new Map,this.defaultRenderer=new KO(e)}createRenderer(e,r){if(!e||!r)return this.defaultRenderer;switch(r.encapsulation){case D1.Emulated:{let s=this.rendererByCompId.get(r.id);return s||(s=new Fue(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,s)),s.applyToHost(e),s}case 1:case D1.ShadowDom:return new Bue(this.eventManager,this.sharedStylesHost,e,r);default:if(!this.rendererByCompId.has(r.id)){const s=Ey(r.id,r.styles,[]);this.sharedStylesHost.addStyles(s),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(Re(yy),Re(up),Re(np))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class KO{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(ZO[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(NG(t)?t.content:t).appendChild(e)}insertBefore(t,e,r){t&&(NG(t)?t.content:t).insertBefore(e,r)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let r="string"==typeof t?document.querySelector(t):t;if(!r)throw new Error(`The selector "${t}" did not match any elements`);return e||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,r,s){if(s){e=s+":"+e;const i=ZO[s];i?t.setAttributeNS(i,e,r):t.setAttribute(e,r)}else t.setAttribute(e,r)}removeAttribute(t,e,r){if(r){const s=ZO[r];s?t.removeAttributeNS(s,e):t.removeAttribute(`${r}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,r,s){s&(f2.DashCase|f2.Important)?t.style.setProperty(e,r,s&f2.Important?"important":""):t.style[e]=r}removeStyle(t,e,r){r&f2.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,r){t[e]=r}setValue(t,e){t.nodeValue=e}listen(t,e,r){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,bG(r)):this.eventManager.addEventListener(t,e,bG(r))}}function NG(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class Fue extends KO{constructor(t,e,r,s){super(t),this.component=r;const i=Ey(s+"-"+r.id,r.styles,[]);e.addStyles(i),this.contentAttr=function zue(n){return"_ngcontent-%COMP%".replace(YO,n)}(s+"-"+r.id),this.hostAttr=function Vue(n){return"_nghost-%COMP%".replace(YO,n)}(s+"-"+r.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const r=super.createElement(t,e);return super.setAttribute(r,this.contentAttr,""),r}}class Bue extends KO{constructor(t,e,r,s){super(t),this.sharedStylesHost=e,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const i=Ey(s.id,s.styles,[]);for(let o=0;o<i.length;o++){const c=document.createElement("style");c.textContent=i[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,r){return super.insertBefore(this.nodeOrShadowRoot(t),e,r)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let $ue=(()=>{class n extends MG{constructor(e){super(e)}supports(e){return!0}addEventListener(e,r,s){return e.addEventListener(r,s,!1),()=>this.removeEventListener(e,r,s)}removeEventListener(e,r,s){return e.removeEventListener(r,s)}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const AG=["alt","control","meta","shift"],Uue={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Gue={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Wue=(()=>{class n extends MG{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,r,s){const i=n.parseEventName(r),o=n.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>d4().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const r=e.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const i=n._normalizeKey(r.pop());let o="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),o="code."),AG.forEach(h=>{const p=r.indexOf(h);p>-1&&(r.splice(p,1),o+=h+".")}),o+=i,0!=r.length||0===i.length)return null;const u={};return u.domEventName=s,u.fullKey=o,u}static matchEventFullKeyCode(e,r){let s=Uue[e.key]||e.key,i="";return r.indexOf("code.")>-1&&(s=e.code,i="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),AG.forEach(o=>{o!==s&&(0,Gue[o])(e)&&(i+=o+".")}),i+=s,i===r)}static eventCallback(e,r,s){return i=>{n.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>r(i))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const xG=[{provide:rp,useValue:"browser"},{provide:mU,useValue:function que(){jO.makeCurrent()},multi:!0},{provide:Bs,useFactory:function Zue(){return function UT(n){$h=n}(document),document},deps:[]}],Yue=bU(D0e,"browser",xG),kG=new xt(""),LG=[{provide:ny,useClass:class kue{addToWindow(t){Q1.getAngularTestability=(r,s=!0)=>{const i=t.findTestabilityInTree(r,s);if(null==i)throw new Error("Could not find testability for element.");return i},Q1.getAllAngularTestabilities=()=>t.getAllTestabilities(),Q1.getAllAngularRootElements=()=>t.getAllRootElements(),Q1.frameworkStabilizers||(Q1.frameworkStabilizers=[]),Q1.frameworkStabilizers.push(r=>{const s=Q1.getAllAngularTestabilities();let i=s.length,o=!1;const c=function(u){o=o||u,i--,0==i&&r(o)};s.forEach(function(u){u.whenStable(c)})})}findTestabilityInTree(t,e,r){return null==e?null:t.getTestability(e)??(r?d4().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:SU,useClass:yO,deps:[Pr,EO,ny]},{provide:yO,useClass:yO,deps:[Pr,EO,ny]}],RG=[{provide:Kh,useValue:"root"},{provide:J6,useFactory:function jue(){return new J6},deps:[]},{provide:Cy,useClass:$ue,multi:!0,deps:[Bs,Pr,rp]},{provide:Cy,useClass:Wue,multi:!0,deps:[Bs]},{provide:My,useClass:My,deps:[yy,up,np]},{provide:X6,useExisting:My},{provide:SG,useExisting:up},{provide:up,useClass:up,deps:[Bs]},{provide:yy,useClass:yy,deps:[Cy,Pr]},{provide:_G,useClass:Lue,deps:[]},[]];let DG=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:np,useValue:e.appId},{provide:EG,useExisting:np},xue]}}}return n.\u0275fac=function(e){return new(e||n)(Re(kG,12))},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({providers:[...RG,...LG],imports:[sue,z0e]}),n})(),zG=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs))},n.\u0275prov=et({token:n,factory:function(e){let r=null;return r=e?new e:function Xue(){return new zG(Re(Bs))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;let FG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(e){let r=null;return r=e?new(e||n):Re(BG),r},providedIn:"root"}),n})(),BG=(()=>{class n extends FG{constructor(e){super(),this._doc=e}sanitize(e,r){if(null==r)return null;switch(e){case J1.NONE:return r;case J1.HTML:return ho(r,"HTML")?fo(r):qh(this._doc,String(r)).toString();case J1.STYLE:return ho(r,"Style")?fo(r):r;case J1.SCRIPT:if(ho(r,"Script"))return fo(r);throw new Error("unsafe value used in a script context");case J1.URL:return ho(r,"URL")?fo(r):ta(String(r));case J1.RESOURCE_URL:if(ho(r,"ResourceURL"))return fo(r);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function rv(n){return new qT(n)}(e)}bypassSecurityTrustStyle(e){return function sv(n){return new jT(n)}(e)}bypassSecurityTrustScript(e){return function YT(n){return new ZT(n)}(e)}bypassSecurityTrustUrl(e){return function KT(n){return new ev(n)}(e)}bypassSecurityTrustResourceUrl(e){return function XT(n){return new tv(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs))},n.\u0275prov=et({token:n,factory:function(e){let r=null;return r=e?new e:function s5e(n){return new BG(n.get(Bs))}(Re(ui)),r},providedIn:"root"}),n})();const{isArray:i5e}=Array,{getPrototypeOf:o5e,prototype:a5e,keys:c5e}=Object;function $G(n){if(1===n.length){const t=n[0];if(i5e(t))return{args:t,keys:null};if(function l5e(n){return n&&"object"==typeof n&&o5e(n)===a5e}(t)){const e=c5e(t);return{args:e.map(r=>t[r]),keys:e}}}return{args:n,keys:null}}const{isArray:u5e}=Array;function UG(n){return pn(t=>function f5e(n,t){return u5e(t)?n(...t):n(t)}(n,t))}function GG(n,t){return n.reduce((e,r,s)=>(e[r]=t[s],e),{})}let WG=(()=>{class n{constructor(e,r){this._renderer=e,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(e,r){this._renderer.setProperty(this._elementRef.nativeElement,e,r)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Q(mo),Q(l2))},n.\u0275dir=$t({type:n}),n})(),pu=(()=>{class n extends WG{}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=$t({type:n,features:[l]}),n})();const p4=new xt("NgValueAccessor"),d5e={provide:p4,useExisting:E1(()=>JO),multi:!0};let JO=(()=>{class n extends pu{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=$t({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target.checked)})("blur",function(){return r.onTouched()})},features:[Vr([d5e]),l]}),n})();const p5e={provide:p4,useExisting:E1(()=>g4),multi:!0},m5e=new xt("CompositionEventMode");let g4=(()=>{class n extends WG{constructor(e,r,s){super(e,r),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function g5e(){const n=d4()?d4().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(mo),Q(l2),Q(m5e,8))},n.\u0275dir=$t({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,r){1&e&&J("input",function(i){return r._handleInput(i.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(i){return r._compositionEnd(i.target.value)})},features:[Vr([p5e]),l]}),n})();function f0(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function qG(n){return null!=n&&"number"==typeof n.length}const j2=new xt("NgValidators"),h0=new xt("NgAsyncValidators"),v5e=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class fp{static min(t){return function jG(n){return t=>{if(f0(t.value)||f0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function ZG(n){return t=>{if(f0(t.value)||f0(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return YG(t)}static requiredTrue(t){return function KG(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function XG(n){return f0(n.value)||v5e.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function QG(n){return t=>f0(t.value)||!qG(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return JG(t)}static pattern(t){return function eW(n){if(!n)return Sy;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),r=>{if(f0(r.value))return null;const s=r.value;return t.test(s)?null:{pattern:{requiredPattern:e,actualValue:s}}}}(t)}static nullValidator(t){return null}static compose(t){return oW(t)}static composeAsync(t){return aW(t)}}function YG(n){return f0(n.value)?{required:!0}:null}function JG(n){return t=>qG(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}function Sy(n){return null}function tW(n){return null!=n}function nW(n){return qd(n)?as(n):n}function rW(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function sW(n,t){return t.map(e=>e(n))}function iW(n){return n.map(t=>function C5e(n){return!n.validate}(t)?t:e=>t.validate(e))}function oW(n){if(!n)return null;const t=n.filter(tW);return 0==t.length?null:function(e){return rW(sW(e,t))}}function eN(n){return null!=n?oW(iW(n)):null}function aW(n){if(!n)return null;const t=n.filter(tW);return 0==t.length?null:function(e){return function h5e(...n){const t=Xt(n),{args:e,keys:r}=$G(n),s=new Er(i=>{const{length:o}=e;if(!o)return void i.complete();const c=new Array(o);let u=o,h=o;for(let p=0;p<o;p++){let m=!1;oo(e[p]).subscribe(os(i,C=>{m||(m=!0,h--),c[p]=C},()=>u--,void 0,()=>{(!u||!m)&&(h||i.next(r?GG(r,c):c),i.complete())}))}});return t?s.pipe(UG(t)):s}(sW(e,t).map(nW)).pipe(pn(rW))}}function tN(n){return null!=n?aW(iW(n)):null}function cW(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function lW(n){return n._rawValidators}function uW(n){return n._rawAsyncValidators}function nN(n){return n?Array.isArray(n)?n:[n]:[]}function Py(n,t){return Array.isArray(n)?n.includes(t):n===t}function fW(n,t){const e=nN(t);return nN(n).forEach(s=>{Py(e,s)||e.push(s)}),e}function hW(n,t){return nN(t).filter(e=>!Py(n,e))}class dW{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=eN(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=tN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Mo extends dW{get formDirective(){return null}get path(){return null}}class d0 extends dW{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class pW{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let bl=(()=>{class n extends pW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(d0,2))},n.\u0275dir=$t({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,r){2&e&&UC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[l]}),n})(),gu=(()=>{class n extends pW{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Q(Mo,10))},n.\u0275dir=$t({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,r){2&e&&UC("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[l]}),n})();const hp="VALID",wy="INVALID",nf="PENDING",dp="DISABLED";function oN(n){return(by(n)?n.validators:n)||null}function mW(n){return Array.isArray(n)?eN(n):n||null}function aN(n,t){return(by(t)?t.asyncValidators:n)||null}function _W(n){return Array.isArray(n)?tN(n):n||null}function by(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function vW(n,t,e){const r=n.controls;if(!(t?Object.keys(r):r).length)throw new Ne(1e3,"");if(!r[e])throw new Ne(1001,"")}function CW(n,t,e){n._forEachChild((r,s)=>{if(void 0===e[s])throw new Ne(1002,"")})}class Oy{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=mW(this._rawValidators),this._composedAsyncValidatorFn=_W(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===hp}get invalid(){return this.status===wy}get pending(){return this.status==nf}get disabled(){return this.status===dp}get enabled(){return this.status!==dp}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=mW(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=_W(t)}addValidators(t){this.setValidators(fW(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(fW(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(hW(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(hW(t,this._rawAsyncValidators))}hasValidator(t){return Py(this._rawValidators,t)}hasAsyncValidator(t){return Py(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=nf,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=dp,this.errors=null,this._forEachChild(r=>{r.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=hp,this._forEachChild(r=>{r.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===hp||this.status===nf)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?dp:hp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=nf,this._hasOwnPendingAsyncValidator=!0;const e=nW(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((r,s)=>r&&r._find(s),this)}getError(t,e){const r=e?this.get(e):this;return r&&r.errors?r.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new gr,this.statusChanges=new gr}_calculateStatus(){return this._allControlsDisabled()?dp:this.errors?wy:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(nf)?nf:this._anyControlsHaveStatus(wy)?wy:hp}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){by(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}}class p0 extends Oy{constructor(t,e,r){super(oN(e),aN(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,r={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,r={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){CW(this,0,t),Object.keys(t).forEach(r=>{vW(this,!0,r),this.controls[r].setValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(r=>{const s=this.controls[r];s&&s.patchValue(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,r)=>(t[r]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,r)=>!!r._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const r=this.controls[e];r&&t(r,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,r]of Object.entries(this.controls))if(this.contains(e)&&t(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,r,s)=>((r.enabled||this.disabled)&&(e[s]=r.value),e))}_reduceChildren(t,e){let r=t;return this._forEachChild((s,i)=>{r=e(r,s,i)}),r}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}class yW extends p0{}function Ny(n,t){return[...t.path,n]}function pp(n,t){cN(n,t),t.valueAccessor.writeValue(n.value),n.disabled&&t.valueAccessor.setDisabledState?.(!0),function b5e(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&EW(n,t)})}(n,t),function N5e(n,t){const e=(r,s)=>{t.valueAccessor.writeValue(r),s&&t.viewToModelUpdate(r)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function O5e(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&EW(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function w5e(n,t){if(t.valueAccessor.setDisabledState){const e=r=>{t.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function Ay(n,t,e=!0){const r=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(r),t.valueAccessor.registerOnTouched(r)),xy(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function Iy(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function cN(n,t){const e=lW(n);null!==t.validator?n.setValidators(cW(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const r=uW(n);null!==t.asyncValidator?n.setAsyncValidators(cW(r,t.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const s=()=>n.updateValueAndValidity();Iy(t._rawValidators,s),Iy(t._rawAsyncValidators,s)}function xy(n,t){let e=!1;if(null!==n){if(null!==t.validator){const s=lW(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.validator);i.length!==s.length&&(e=!0,n.setValidators(i))}}if(null!==t.asyncValidator){const s=uW(n);if(Array.isArray(s)&&s.length>0){const i=s.filter(o=>o!==t.asyncValidator);i.length!==s.length&&(e=!0,n.setAsyncValidators(i))}}}const r=()=>{};return Iy(t._rawValidators,r),Iy(t._rawAsyncValidators,r),e}function EW(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function MW(n,t){cN(n,t)}function lN(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}function PW(n,t){n._syncPendingControls(),t.forEach(e=>{const r=e.control;"submit"===r.updateOn&&r._pendingChange&&(e.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function uN(n,t){if(!t)return null;let e,r,s;return Array.isArray(t),t.forEach(i=>{i.constructor===g4?e=i:function x5e(n){return Object.getPrototypeOf(n.constructor)===pu}(i)?r=i:s=i}),s||r||e||null}const L5e={provide:Mo,useExisting:E1(()=>mp)},gp=(()=>Promise.resolve())();let mp=(()=>{class n extends Mo{constructor(e,r){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new gr,this.form=new p0({},eN(e),tN(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){gp.then(()=>{const r=this._findContainer(e.path);e.control=r.registerControl(e.name,e.control),pp(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){gp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){gp.then(()=>{const r=this._findContainer(e.path),s=new p0({});MW(s,e),r.registerControl(e.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){gp.then(()=>{const r=this._findContainer(e.path);r&&r.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,r){gp.then(()=>{this.form.get(e.path).setValue(r)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,PW(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Q(j2,10),Q(h0,10))},n.\u0275dir=$t({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,r){1&e&&J("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vr([L5e]),l]}),n})();function TW(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function wW(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const La=class extends Oy{constructor(t=null,e,r){super(oN(e),aN(r,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),by(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=wW(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){TW(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){TW(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){wW(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},z5e={provide:d0,useExisting:E1(()=>_p)},NW=(()=>Promise.resolve())();let _p=(()=>{class n extends d0{constructor(e,r,s,i,o){super(),this._changeDetectorRef=o,this.control=new La,this._registered=!1,this.update=new gr,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=uN(0,i)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const r=e.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),lN(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){pp(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){NW.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const r=e.isDisabled.currentValue,s=0!==r&&Pl(r);NW.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?Ny(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(Mo,9),Q(j2,10),Q(h0,10),Q(p4,10),Q(fu,8))},n.\u0275dir=$t({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Vr([z5e]),l,e2]}),n})(),mu=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=$t({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),IW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({}),n})();const B5e={provide:p4,useExisting:E1(()=>ky),multi:!0};let ky=(()=>{class n extends pu{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=r=>{e(""==r?null:parseFloat(r))}}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=$t({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target.value)})("input",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},features:[Vr([B5e]),l]}),n})();const fN=new xt("NgModelWithFormControlWarning"),$5e={provide:d0,useExisting:E1(()=>hN)};let hN=(()=>{class n extends d0{constructor(e,r,s,i){super(),this._ngModelWarningConfig=i,this.update=new gr,this._ngModelWarningSent=!1,this._setValidators(e),this._setAsyncValidators(r),this.valueAccessor=uN(0,s)}set isDisabled(e){}ngOnChanges(e){if(this._isControlChanged(e)){const r=e.form.previousValue;r&&Ay(r,this,!1),pp(this.form,this),this.form.updateValueAndValidity({emitEvent:!1})}lN(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&Ay(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(j2,10),Q(h0,10),Q(p4,10),Q(fN,8))},n.\u0275dir=$t({type:n,selectors:[["","formControl",""]],inputs:{form:["formControl","form"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],features:[Vr([$5e]),l,e2]}),n})();const U5e={provide:Mo,useExisting:E1(()=>_u)};let _u=(()=>{class n extends Mo{constructor(e,r){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new gr,this._setValidators(e),this._setAsyncValidators(r)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(xy(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const r=this.form.get(e.path);return pp(r,e),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),r}getControl(e){return this.form.get(e.path)}removeControl(e){Ay(e.control||null,e,!1),function k5e(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,r){this.form.get(e.path).setValue(r)}onSubmit(e){return this.submitted=!0,PW(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const r=e.control,s=this.form.get(e.path);r!==s&&(Ay(r||null,e),(n=>n instanceof La)(s)&&(pp(s,e),e.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const r=this.form.get(e.path);MW(r,e),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const r=this.form.get(e.path);r&&function A5e(n,t){return xy(n,t)}(r,e)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){cN(this.form,this),this._oldForm&&xy(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(Q(j2,10),Q(h0,10))},n.\u0275dir=$t({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,r){1&e&&J("submit",function(i){return r.onSubmit(i)})("reset",function(){return r.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vr([U5e]),l,e2]}),n})();const q5e={provide:d0,useExisting:E1(()=>rf)};let rf=(()=>{class n extends d0{constructor(e,r,s,i,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.update=new gr,this._ngModelWarningSent=!1,this._parent=e,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=uN(0,i)}set isDisabled(e){}ngOnChanges(e){this._added||this._setUpControl(),lN(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return Ny(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(e){return new(e||n)(Q(Mo,13),Q(j2,10),Q(h0,10),Q(p4,10),Q(fN,8))},n.\u0275dir=$t({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Vr([q5e]),l,e2]}),n})();const j5e={provide:p4,useExisting:E1(()=>Ly),multi:!0};function LW(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let Ly=(()=>{class n extends pu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const s=LW(this._getOptionId(e),e);this.setProperty("value",s)}registerOnChange(e){this.onChange=r=>{this.value=this._getOptionValue(r),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),e))return r;return null}_getOptionValue(e){const r=function Z5e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r):e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=$t({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Vr([j5e]),l]}),n})(),vp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(LW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(l2),Q(mo),Q(Ly,9))},n.\u0275dir=$t({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const Y5e={provide:p4,useExisting:E1(()=>gN),multi:!0};function RW(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let gN=(()=>{class n extends pu{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let r;if(this.value=e,Array.isArray(e)){const s=e.map(i=>this._getOptionId(i));r=(i,o)=>{i._setSelected(s.indexOf(o.toString())>-1)}}else r=(s,i)=>{s._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(e){this.onChange=r=>{const s=[],i=r.selectedOptions;if(void 0!==i){const o=i;for(let c=0;c<o.length;c++){const h=this._getOptionValue(o[c].value);s.push(h)}}else{const o=r.options;for(let c=0;c<o.length;c++){const u=o[c];if(u.selected){const h=this._getOptionValue(u.value);s.push(h)}}}this.value=s,e(s)}}_registerOption(e){const r=(this._idCounter++).toString();return this._optionMap.set(r,e),r}_getOptionId(e){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,e))return r;return null}_getOptionValue(e){const r=function K5e(n){return n.split(":")[0]}(e);return this._optionMap.has(r)?this._optionMap.get(r)._value:e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=$t({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,r){1&e&&J("change",function(i){return r.onChange(i.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Vr([Y5e]),l]}),n})(),Cp=(()=>{class n{constructor(e,r,s){this._element=e,this._renderer=r,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(RW(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(RW(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Q(l2),Q(mo),Q(gN,9))},n.\u0275dir=$t({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();let vu=(()=>{class n{constructor(){this._validator=Sy}ngOnChanges(e){if(this.inputName in e){const r=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):Sy,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=$t({type:n,features:[e2]}),n})();const J5e={provide:j2,useExisting:E1(()=>Cu),multi:!0};let Cu=(()=>{class n extends vu{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Pl,this.createValidator=e=>YG}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=$t({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,r){2&e&&D("required",r._enabled?"":null)},inputs:{required:"required"},features:[Vr([J5e]),l]}),n})();const r7e={provide:j2,useExisting:E1(()=>mN),multi:!0};let mN=(()=>{class n extends vu{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>function DW(n){return"number"==typeof n?n:parseInt(n,10)}(e),this.createValidator=e=>JG(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275dir=$t({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,r){2&e&&D("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Vr([r7e]),l]}),n})(),GW=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({imports:[IW]}),n})(),i7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({imports:[GW]}),n})(),WW=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:fN,useValue:e.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({imports:[GW]}),n})();class qW extends Oy{constructor(t,e,r){super(oN(e),aN(r,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,r={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(t,e={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,r={}){let s=this._adjustIndex(t);s<0&&(s=0),this.controls[s]&&this.controls[s]._registerOnCollectionChange(()=>{}),this.controls.splice(s,1),e&&(this.controls.splice(s,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){CW(this,0,t),t.forEach((r,s)=>{vW(this,!1,s),this.at(s).setValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((r,s)=>{this.at(s)&&this.at(s).patchValue(r,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((r,s)=>{r.reset(t[s],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,r)=>!!r._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,r)=>{t(e,r)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}}function jW(n){return!!n&&(void 0!==n.asyncValidators||void 0!==n.validators||void 0!==n.updateOn)}let o7e=(()=>{class n{constructor(){this.useNonNullable=!1}get nonNullable(){const e=new n;return e.useNonNullable=!0,e}group(e,r=null){const s=this._reduceControls(e);let i={};return jW(r)?i=r:null!==r&&(i.validators=r.validator,i.asyncValidators=r.asyncValidator),new p0(s,i)}record(e,r=null){const s=this._reduceControls(e);return new yW(s,r)}control(e,r,s){let i={};return this.useNonNullable?(jW(r)?i=r:(i.validators=r,i.asyncValidators=s),new La(e,{...i,nonNullable:!0})):new La(e,r,s)}array(e,r,s){const i=e.map(o=>this._createControl(o));return new qW(i,r,s)}_reduceControls(e){const r={};return Object.keys(e).forEach(s=>{r[s]=this._createControl(e[s])}),r}_createControl(e){return e instanceof La||e instanceof Oy?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:WW}),n})();function jt(...n){return as(n,U3(n))}function g0(n,t){return on(t)?De(n,t,1):De(n,1)}function Ol(n,t){return pr((e,r)=>{let s=0;e.subscribe(os(r,i=>n.call(t,i,s++)&&r.next(i)))})}class ZW{}class YW{}class Nl{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(e=>{const r=e.indexOf(":");if(r>0){const s=e.slice(0,r),i=s.toLowerCase(),o=e.slice(r+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let r=t[e];const s=e.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(s,r),this.maybeSetNormalizedName(e,s))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof Nl?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new Nl;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof Nl?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let r=t.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(t.name,e);const s=("a"===t.op?this.headers.get(e):void 0)||[];s.push(...r),this.headers.set(e,s);break;case"d":const i=t.value;if(i){let o=this.headers.get(e);if(!o)return;o=o.filter(c=>-1===i.indexOf(c)),0===o.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class a7e{encodeKey(t){return KW(t)}encodeValue(t){return KW(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}const l7e=/%(\d[a-f0-9])/gi,u7e={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function KW(n){return encodeURIComponent(n).replace(l7e,(t,e)=>u7e[e]??t)}function Ry(n){return`${n}`}class m0{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new a7e,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function c7e(n,t){const e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const i=s.indexOf("="),[o,c]=-1==i?[t.decodeKey(s),""]:[t.decodeKey(s.slice(0,i)),t.decodeValue(s.slice(i+1))],u=e.get(o)||[];u.push(c),e.set(o,u)}),e}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const r=t.fromObject[e],s=Array.isArray(r)?r.map(Ry):[Ry(r)];this.map.set(e,s)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(r=>{const s=t[r];Array.isArray(s)?s.forEach(i=>{e.push({param:r,value:i,op:"a"})}):e.push({param:r,value:s,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(r=>e+"="+this.encoder.encodeValue(r)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new m0({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(Ry(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let r=this.map.get(t.param)||[];const s=r.indexOf(Ry(t.value));-1!==s&&r.splice(s,1),r.length>0?this.map.set(t.param,r):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class f7e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}}function XW(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function QW(n){return typeof Blob<"u"&&n instanceof Blob}function JW(n){return typeof FormData<"u"&&n instanceof FormData}class yp{constructor(t,e,r,s){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function h7e(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==r?r:null,i=s):i=r,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params)),this.headers||(this.headers=new Nl),this.context||(this.context=new f7e),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=e;else{const c=e.indexOf("?");this.urlWithParams=e+(-1===c?"?":c<e.length-1?"&":"")+o}}else this.params=new m0,this.urlWithParams=e}serializeBody(){return null===this.body?null:XW(this.body)||QW(this.body)||JW(this.body)||function d7e(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof m0?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||JW(this.body)?null:QW(this.body)?this.body.type||null:XW(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof m0?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){const e=t.method||this.method,r=t.url||this.url,s=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,c=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let u=t.headers||this.headers,h=t.params||this.params;const p=t.context??this.context;return void 0!==t.setHeaders&&(u=Object.keys(t.setHeaders).reduce((m,C)=>m.set(C,t.setHeaders[C]),u)),t.setParams&&(h=Object.keys(t.setParams).reduce((m,C)=>m.set(C,t.setParams[C]),h)),new yp(e,r,i,{params:h,headers:u,context:p,reportProgress:c,responseType:s,withCredentials:o})}}var Gs=(()=>((Gs=Gs||{})[Gs.Sent=0]="Sent",Gs[Gs.UploadProgress=1]="UploadProgress",Gs[Gs.ResponseHeader=2]="ResponseHeader",Gs[Gs.DownloadProgress=3]="DownloadProgress",Gs[Gs.Response=4]="Response",Gs[Gs.User=5]="User",Gs))();class _N{constructor(t,e=200,r="OK"){this.headers=t.headers||new Nl,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||r,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class vN extends _N{constructor(t={}){super(t),this.type=Gs.ResponseHeader}clone(t={}){return new vN({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Dy extends _N{constructor(t={}){super(t),this.type=Gs.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Dy({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class eq extends _N{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function CN(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let p7e=(()=>{class n{constructor(e){this.handler=e}request(e,r,s={}){let i;if(e instanceof yp)i=e;else{let u,h;u=s.headers instanceof Nl?s.headers:new Nl(s.headers),s.params&&(h=s.params instanceof m0?s.params:new m0({fromObject:s.params})),i=new yp(e,r,void 0!==s.body?s.body:null,{headers:u,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const o=jt(i).pipe(g0(u=>this.handler.handle(u)));if(e instanceof yp||"events"===s.observe)return o;const c=o.pipe(Ol(u=>u instanceof Dy));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(pn(u=>{if(null!==u.body&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(pn(u=>{if(null!==u.body&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(pn(u=>{if(null!==u.body&&"string"!=typeof u.body)throw new Error("Response is not a string.");return u.body}));default:return c.pipe(pn(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,r={}){return this.request("DELETE",e,r)}get(e,r={}){return this.request("GET",e,r)}head(e,r={}){return this.request("HEAD",e,r)}jsonp(e,r){return this.request("JSONP",e,{params:(new m0).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,r={}){return this.request("OPTIONS",e,r)}patch(e,r,s={}){return this.request("PATCH",e,CN(s,r))}post(e,r,s={}){return this.request("POST",e,CN(s,r))}put(e,r,s={}){return this.request("PUT",e,CN(s,r))}}return n.\u0275fac=function(e){return new(e||n)(Re(ZW))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class tq{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const nq=new xt("HTTP_INTERCEPTORS");let g7e=(()=>{class n{intercept(e,r){return r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const m7e=/^\)\]\}',?\n/;let rq=(()=>{class n{constructor(e){this.xhrFactory=e}handle(e){if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Er(r=>{const s=this.xhrFactory.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((w,I)=>s.setRequestHeader(w,I.join(","))),e.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){const w=e.detectContentTypeHeader();null!==w&&s.setRequestHeader("Content-Type",w)}if(e.responseType){const w=e.responseType.toLowerCase();s.responseType="json"!==w?w:"text"}const i=e.serializeBody();let o=null;const c=()=>{if(null!==o)return o;const w=s.statusText||"OK",I=new Nl(s.getAllResponseHeaders()),H=function _7e(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||e.url;return o=new vN({headers:I,status:s.status,statusText:w,url:H}),o},u=()=>{let{headers:w,status:I,statusText:H,url:Y}=c(),ee=null;204!==I&&(ee=typeof s.response>"u"?s.responseText:s.response),0===I&&(I=ee?200:0);let ve=I>=200&&I<300;if("json"===e.responseType&&"string"==typeof ee){const te=ee;ee=ee.replace(m7e,"");try{ee=""!==ee?JSON.parse(ee):null}catch(Ie){ee=te,ve&&(ve=!1,ee={error:Ie,text:ee})}}ve?(r.next(new Dy({body:ee,headers:w,status:I,statusText:H,url:Y||void 0})),r.complete()):r.error(new eq({error:ee,headers:w,status:I,statusText:H,url:Y||void 0}))},h=w=>{const{url:I}=c(),H=new eq({error:w,status:s.status||0,statusText:s.statusText||"Unknown Error",url:I||void 0});r.error(H)};let p=!1;const m=w=>{p||(r.next(c()),p=!0);let I={type:Gs.DownloadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),"text"===e.responseType&&!!s.responseText&&(I.partialText=s.responseText),r.next(I)},C=w=>{let I={type:Gs.UploadProgress,loaded:w.loaded};w.lengthComputable&&(I.total=w.total),r.next(I)};return s.addEventListener("load",u),s.addEventListener("error",h),s.addEventListener("timeout",h),s.addEventListener("abort",h),e.reportProgress&&(s.addEventListener("progress",m),null!==i&&s.upload&&s.upload.addEventListener("progress",C)),s.send(i),r.next({type:Gs.Sent}),()=>{s.removeEventListener("error",h),s.removeEventListener("abort",h),s.removeEventListener("load",u),s.removeEventListener("timeout",h),e.reportProgress&&(s.removeEventListener("progress",m),null!==i&&s.upload&&s.upload.removeEventListener("progress",C)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(e){return new(e||n)(Re(_G))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const yN=new xt("XSRF_COOKIE_NAME"),EN=new xt("XSRF_HEADER_NAME");class sq{}let v7e=(()=>{class n{constructor(e,r,s){this.doc=e,this.platform=r,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=aG(e,this.cookieName),this.lastCookieString=e),this.lastToken}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs),Re(rp),Re(yN))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),MN=(()=>{class n{constructor(e,r){this.tokenService=e,this.headerName=r}intercept(e,r){const s=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||s.startsWith("http://")||s.startsWith("https://"))return r.handle(e);const i=this.tokenService.getToken();return null!==i&&!e.headers.has(this.headerName)&&(e=e.clone({headers:e.headers.set(this.headerName,i)})),r.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Re(sq),Re(EN))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),C7e=(()=>{class n{constructor(e,r){this.backend=e,this.injector=r,this.chain=null}handle(e){if(null===this.chain){const r=this.injector.get(nq,[]);this.chain=r.reduceRight((s,i)=>new tq(s,i),this.backend)}return this.chain.handle(e)}}return n.\u0275fac=function(e){return new(e||n)(Re(YW),Re(ui))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),y7e=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:MN,useClass:g7e}]}}static withOptions(e={}){return{ngModule:n,providers:[e.cookieName?{provide:yN,useValue:e.cookieName}:[],e.headerName?{provide:EN,useValue:e.headerName}:[]]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({providers:[MN,{provide:nq,useExisting:MN,multi:!0},{provide:sq,useClass:v7e},{provide:yN,useValue:"XSRF-TOKEN"},{provide:EN,useValue:"X-XSRF-TOKEN"}]}),n})(),E7e=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({providers:[p7e,{provide:ZW,useClass:C7e},rq,{provide:YW,useExisting:rq}],imports:[y7e.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();class y3 extends z2{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:r}=this;if(t)throw e;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}}const zy=is(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function iq(...n){const t=U3(n),e=Xt(n),{args:r,keys:s}=$G(n);if(0===r.length)return as([],t);const i=new Er(function M7e(n,t,e=q4){return r=>{oq(t,()=>{const{length:s}=n,i=new Array(s);let o=s,c=s;for(let u=0;u<s;u++)oq(t,()=>{const h=as(n[u],t);let p=!1;h.subscribe(os(r,m=>{i[u]=m,p||(p=!0,c--),c||r.next(e(i.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,t,s?o=>GG(s,o):q4));return e?i.pipe(UG(e)):i}function oq(n,t,e){n?Vs(e,n,t):t()}function SN(...n){return function S7e(){return Y4(1)}()(as(n,U3(n)))}function aq(n){return new Er(t=>{oo(n()).subscribe(t)})}function Ep(n,t){const e=on(n)?n:()=>n,r=s=>s.error(e());return new Er(t?s=>t.schedule(r,0,s):r)}function PN(){return pr((n,t)=>{let e=null;n._refCount++;const r=os(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const s=n._connection,i=e;e=null,s&&(!i||s===i)&&s.unsubscribe(),t.unsubscribe()});n.subscribe(r),r.closed||(e=n.connect())})}class cq extends Er{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,e_(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new q1;const e=this.getSubject();t.add(this.source.subscribe(os(e,void 0,()=>{this._teardown(),e.complete()},r=>{this._teardown(),e.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=q1.EMPTY)}return t}refCount(){return PN()(this)}}function m4(n,t){return pr((e,r)=>{let s=null,i=0,o=!1;const c=()=>o&&!s&&r.complete();e.subscribe(os(r,u=>{s?.unsubscribe();let h=0;const p=i++;oo(n(u,p)).subscribe(s=os(r,m=>r.next(t?t(u,m,p,h++):m),()=>{s=null,c()}))},()=>{o=!0,c()}))})}function Mp(n){return n<=0?()=>ic:pr((t,e)=>{let r=0;t.subscribe(os(e,s=>{++r<=n&&(e.next(s),n<=r&&e.complete())}))})}function Vy(n){return pr((t,e)=>{let r=!1;t.subscribe(os(e,s=>{r=!0,e.next(s)},()=>{r||e.next(n),e.complete()}))})}function lq(n=T7e){return pr((t,e)=>{let r=!1;t.subscribe(os(e,s=>{r=!0,e.next(s)},()=>r?e.complete():e.error(n())))})}function T7e(){return new zy}function _0(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Ol((s,i)=>n(s,i,r)):q4,Mp(1),e?Vy(t):lq(()=>new zy))}function g2(n,t,e){const r=on(n)||t||e?{next:n,error:t,complete:e}:n;return r?pr((s,i)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let c=!0;s.subscribe(os(i,u=>{var h;null===(h=r.next)||void 0===h||h.call(r,u),i.next(u)},()=>{var u;c=!1,null===(u=r.complete)||void 0===u||u.call(r),i.complete()},u=>{var h;c=!1,null===(h=r.error)||void 0===h||h.call(r,u),i.error(u)},()=>{var u,h;c&&(null===(u=r.unsubscribe)||void 0===u||u.call(r)),null===(h=r.finalize)||void 0===h||h.call(r)}))}):q4}function v0(n){return pr((t,e)=>{let i,r=null,s=!1;r=t.subscribe(os(e,void 0,void 0,o=>{i=oo(n(o,v0(n)(t))),r?(r.unsubscribe(),r=null,i.subscribe(e)):s=!0})),s&&(r.unsubscribe(),r=null,i.subscribe(e))})}function w7e(n,t,e,r,s){return(i,o)=>{let c=e,u=t,h=0;i.subscribe(os(o,p=>{const m=h++;u=c?n(u,p,m):(c=!0,p),r&&o.next(u)},s&&(()=>{c&&o.next(u),o.complete()})))}}function uq(n,t){return pr(w7e(n,t,arguments.length>=2,!0))}function TN(n){return n<=0?()=>ic:pr((t,e)=>{let r=[];t.subscribe(os(e,s=>{r.push(s),n<r.length&&r.shift()},()=>{for(const s of r)e.next(s);e.complete()},void 0,()=>{r=null}))})}function fq(n,t){const e=arguments.length>=2;return r=>r.pipe(n?Ol((s,i)=>n(s,i,r)):q4,TN(1),e?Vy(t):lq(()=>new zy))}function wN(n){return pr((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Bn="primary",Sp=Symbol("RouteTitle");class N7e{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function sf(n){return new N7e(n)}function A7e(n,t,e){const r=e.path.split("/");if(r.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||r.length<n.length))return null;const s={};for(let i=0;i<r.length;i++){const o=r[i],c=n[i];if(o.startsWith(":"))s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:s}}function _4(n,t){const e=n?Object.keys(n):void 0,r=t?Object.keys(t):void 0;if(!e||!r||e.length!=r.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!hq(n[s],t[s]))return!1;return!0}function hq(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),r=[...t].sort();return e.every((s,i)=>r[i]===s)}return n===t}function dq(n){return Array.prototype.concat.apply([],n)}function pq(n){return n.length>0?n[n.length-1]:null}function m2(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function C0(n){return Ub(n)?n:qd(n)?as(Promise.resolve(n)):jt(n)}const k7e={exact:function _q(n,t,e){if(!Eu(n.segments,t.segments)||!Hy(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!n.children[r]||!_q(n.children[r],t.children[r],e))return!1;return!0},subset:vq},gq={exact:function L7e(n,t){return _4(n,t)},subset:function R7e(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>hq(n[e],t[e]))},ignored:()=>!0};function mq(n,t,e){return k7e[e.paths](n.root,t.root,e.matrixParams)&&gq[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function vq(n,t,e){return Cq(n,t,t.segments,e)}function Cq(n,t,e,r){if(n.segments.length>e.length){const s=n.segments.slice(0,e.length);return!(!Eu(s,e)||t.hasChildren()||!Hy(s,e,r))}if(n.segments.length===e.length){if(!Eu(n.segments,e)||!Hy(n.segments,e,r))return!1;for(const s in t.children)if(!n.children[s]||!vq(n.children[s],t.children[s],r))return!1;return!0}{const s=e.slice(0,n.segments.length),i=e.slice(n.segments.length);return!!(Eu(n.segments,s)&&Hy(n.segments,s,r)&&n.children[Bn])&&Cq(n.children[Bn],t,i,r)}}function Hy(n,t,e){return t.every((r,s)=>gq[e](n[s].parameters,r.parameters))}class yu{constructor(t,e,r){this.root=t,this.queryParams=e,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=sf(this.queryParams)),this._queryParamMap}toString(){return V7e.serialize(this)}}class qn{constructor(t,e){this.segments=t,this.children=e,this.parent=null,m2(e,(r,s)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Fy(this)}}class Pp{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=sf(this.parameters)),this._parameterMap}toString(){return Sq(this)}}function Eu(n,t){return n.length===t.length&&n.every((e,r)=>e.path===t[r].path)}let yq=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return new ON},providedIn:"root"}),n})();class ON{parse(t){const e=new j7e(t);return new yu(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${Tp(t.root,!0)}`,r=function B7e(n){const t=Object.keys(n).map(e=>{const r=n[e];return Array.isArray(r)?r.map(s=>`${By(e)}=${By(s)}`).join("&"):`${By(e)}=${By(r)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${r}${"string"==typeof t.fragment?`#${function H7e(n){return encodeURI(n)}(t.fragment)}`:""}`}}const V7e=new ON;function Fy(n){return n.segments.map(t=>Sq(t)).join("/")}function Tp(n,t){if(!n.hasChildren())return Fy(n);if(t){const e=n.children[Bn]?Tp(n.children[Bn],!1):"",r=[];return m2(n.children,(s,i)=>{i!==Bn&&r.push(`${i}:${Tp(s,!1)}`)}),r.length>0?`${e}(${r.join("//")})`:e}{const e=function z7e(n,t){let e=[];return m2(n.children,(r,s)=>{s===Bn&&(e=e.concat(t(r,s)))}),m2(n.children,(r,s)=>{s!==Bn&&(e=e.concat(t(r,s)))}),e}(n,(r,s)=>s===Bn?[Tp(n.children[Bn],!1)]:[`${s}:${Tp(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Bn]?`${Fy(n)}/${e[0]}`:`${Fy(n)}/(${e.join("//")})`}}function Eq(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function By(n){return Eq(n).replace(/%3B/gi,";")}function NN(n){return Eq(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $y(n){return decodeURIComponent(n)}function Mq(n){return $y(n.replace(/\+/g,"%20"))}function Sq(n){return`${NN(n.path)}${function F7e(n){return Object.keys(n).map(t=>`;${NN(t)}=${NN(n[t])}`).join("")}(n.parameters)}`}const $7e=/^[^\/()?;=#]+/;function Uy(n){const t=n.match($7e);return t?t[0]:""}const U7e=/^[^=?&#]+/,W7e=/^[^&#]+/;class j7e{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new qn([],{}):new qn([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(r[Bn]=new qn(t,e)),r}parseSegment(){const t=Uy(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Ne(4009,!1);return this.capture(t),new Pp($y(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Uy(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const s=Uy(this.remaining);s&&(r=s,this.capture(r))}t[$y(e)]=$y(r)}parseQueryParam(t){const e=function G7e(n){const t=n.match(U7e);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let r="";if(this.consumeOptional("=")){const o=function q7e(n){const t=n.match(W7e);return t?t[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const s=Mq(e),i=Mq(r);if(t.hasOwnProperty(s)){let o=t[s];Array.isArray(o)||(o=[o],t[s]=o),o.push(i)}else t[s]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Uy(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new Ne(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=Bn);const o=this.parseChildren();e[i]=1===Object.keys(o).length?o[Bn]:new qn([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Ne(4011,!1)}}function AN(n){return n.segments.length>0?new qn([],{[Bn]:n}):n}function Gy(n){const t={};for(const r of Object.keys(n.children)){const i=Gy(n.children[r]);(i.segments.length>0||i.hasChildren())&&(t[r]=i)}return function Z7e(n){if(1===n.numberOfChildren&&n.children[Bn]){const t=n.children[Bn];return new qn(n.segments.concat(t.segments),t.children)}return n}(new qn(n.segments,t))}function Mu(n){return n instanceof yu}function X7e(n,t,e,r,s){if(0===e.length)return af(t.root,t.root,t.root,r,s);const i=function wq(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new Tq(!0,0,n);let t=0,e=!1;const r=n.reduce((s,i,o)=>{if("object"==typeof i&&null!=i){if(i.outlets){const c={};return m2(i.outlets,(u,h)=>{c[h]="string"==typeof u?u.split("/"):u}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return"string"!=typeof i?[...s,i]:0===o?(i.split("/").forEach((c,u)=>{0==u&&"."===c||(0==u&&""===c?e=!0:".."===c?t++:""!=c&&s.push(c))}),s):[...s,i]},[]);return new Tq(e,t,r)}(e);return i.toRoot()?af(t.root,t.root,new qn([],{}),r,s):function o(u){const h=function J7e(n,t,e,r){if(n.isAbsolute)return new cf(t.root,!0,0);if(-1===r)return new cf(e,e===t.root,0);return function bq(n,t,e){let r=n,s=t,i=e;for(;i>s;){if(i-=s,r=r.parent,!r)throw new Ne(4005,!1);s=r.segments.length}return new cf(r,!1,s-i)}(e,r+(wp(n.commands[0])?0:1),n.numberOfDoubleDots)}(i,t,n.snapshot?._urlSegment,u),p=h.processChildren?Op(h.segmentGroup,h.index,i.commands):xN(h.segmentGroup,h.index,i.commands);return af(t.root,h.segmentGroup,p,r,s)}(n.snapshot?._lastPathIndex)}function wp(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function bp(n){return"object"==typeof n&&null!=n&&n.outlets}function af(n,t,e,r,s){let o,i={};r&&m2(r,(u,h)=>{i[h]=Array.isArray(u)?u.map(p=>`${p}`):`${u}`}),o=n===t?e:Pq(n,t,e);const c=AN(Gy(o));return new yu(c,i,s)}function Pq(n,t,e){const r={};return m2(n.children,(s,i)=>{r[i]=s===t?e:Pq(s,t,e)}),new qn(n.segments,r)}class Tq{constructor(t,e,r){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=r,t&&r.length>0&&wp(r[0]))throw new Ne(4003,!1);const s=r.find(bp);if(s&&s!==pq(r))throw new Ne(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class cf{constructor(t,e,r){this.segmentGroup=t,this.processChildren=e,this.index=r}}function xN(n,t,e){if(n||(n=new qn([],{})),0===n.segments.length&&n.hasChildren())return Op(n,t,e);const r=function tfe(n,t,e){let r=0,s=t;const i={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(r>=e.length)return i;const o=n.segments[s],c=e[r];if(bp(c))break;const u=`${c}`,h=r<e.length-1?e[r+1]:null;if(s>0&&void 0===u)break;if(u&&h&&"object"==typeof h&&void 0===h.outlets){if(!Nq(u,h,o))return i;r+=2}else{if(!Nq(u,{},o))return i;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(n,t,e),s=e.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const i=new qn(n.segments.slice(0,r.pathIndex),{});return i.children[Bn]=new qn(n.segments.slice(r.pathIndex),n.children),Op(i,0,s)}return r.match&&0===s.length?new qn(n.segments,{}):r.match&&!n.hasChildren()?kN(n,t,e):r.match?Op(n,0,s):kN(n,t,e)}function Op(n,t,e){if(0===e.length)return new qn(n.segments,{});{const r=function efe(n){return bp(n[0])?n[0].outlets:{[Bn]:n}}(e),s={};return m2(r,(i,o)=>{"string"==typeof i&&(i=[i]),null!==i&&(s[o]=xN(n.children[o],t,i))}),m2(n.children,(i,o)=>{void 0===r[o]&&(s[o]=i)}),new qn(n.segments,s)}}function kN(n,t,e){const r=n.segments.slice(0,t);let s=0;for(;s<e.length;){const i=e[s];if(bp(i)){const u=nfe(i.outlets);return new qn(r,u)}if(0===s&&wp(e[0])){r.push(new Pp(n.segments[t].path,Oq(e[0]))),s++;continue}const o=bp(i)?i.outlets[Bn]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&wp(c)?(r.push(new Pp(o,Oq(c))),s+=2):(r.push(new Pp(o,{})),s++)}return new qn(r,{})}function nfe(n){const t={};return m2(n,(e,r)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[r]=kN(new qn([],{}),0,e))}),t}function Oq(n){const t={};return m2(n,(e,r)=>t[r]=`${e}`),t}function Nq(n,t,e){return n==e.path&&_4(t,e.parameters)}class Al{constructor(t,e){this.id=t,this.url=e}}class LN extends Al{constructor(t,e,r="imperative",s=null){super(t,e),this.type=0,this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class y0 extends Al{constructor(t,e,r){super(t,e),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Wy extends Al{constructor(t,e,r,s){super(t,e),this.reason=r,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Aq extends Al{constructor(t,e,r,s){super(t,e),this.error=r,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class rfe extends Al{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class sfe extends Al{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ife extends Al{constructor(t,e,r,s,i){super(t,e),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=i,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ofe extends Al{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class afe extends Al{constructor(t,e,r,s){super(t,e),this.urlAfterRedirects=r,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cfe{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class lfe{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ufe{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ffe{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hfe{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dfe{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Iq{constructor(t,e,r){this.routerEvent=t,this.position=e,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class xq{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=RN(t,this._root);return e?e.children.map(r=>r.value):[]}firstChild(t){const e=RN(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=DN(t,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return DN(t,this._root).map(e=>e.value)}}function RN(n,t){if(n===t.value)return t;for(const e of t.children){const r=RN(n,e);if(r)return r}return null}function DN(n,t){if(n===t.value)return[t];for(const e of t.children){const r=DN(n,e);if(r.length)return r.unshift(t),r}return[]}class Il{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function lf(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class kq extends xq{constructor(t,e){super(t),this.snapshot=e,zN(this,t)}toString(){return this.snapshot.toString()}}function Lq(n,t){const e=function gfe(n,t){const o=new qy([],{},{},"",{},Bn,t,null,n.root,-1,{});return new Dq("",new Il(o,[]))}(n,t),r=new y3([new Pp("",{})]),s=new y3({}),i=new y3({}),o=new y3({}),c=new y3(""),u=new So(r,s,o,c,i,Bn,t,e.root);return u.snapshot=e.root,new kq(new Il(u,[]),e)}class So{constructor(t,e,r,s,i,o,c,u){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.pipe(pn(h=>h[Sp]))??jt(void 0),this._futureSnapshot=u}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(pn(t=>sf(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(pn(t=>sf(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Rq(n,t="emptyOnly"){const e=n.pathFromRoot;let r=0;if("always"!==t)for(r=e.length-1;r>=1;){const s=e[r],i=e[r-1];if(s.routeConfig&&""===s.routeConfig.path)r--;else{if(i.component)break;r--}}return function mfe(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(r))}class qy{constructor(t,e,r,s,i,o,c,u,h,p,m,C){this.url=t,this.params=e,this.queryParams=r,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.title=this.data?.[Sp],this.routeConfig=u,this._urlSegment=h,this._lastPathIndex=p,this._correctedLastPathIndex=C??p,this._resolve=m}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=sf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=sf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Dq extends xq{constructor(t,e){super(e),this.url=t,zN(this,e)}toString(){return zq(this._root)}}function zN(n,t){t.value._routerState=n,t.children.forEach(e=>zN(n,e))}function zq(n){const t=n.children.length>0?` { ${n.children.map(zq).join(", ")} } `:"";return`${n.value}${t}`}function VN(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,_4(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),_4(t.params,e.params)||n.params.next(e.params),function I7e(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!_4(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),_4(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function HN(n,t){const e=_4(n.params,t.params)&&function D7e(n,t){return Eu(n,t)&&n.every((e,r)=>_4(e.parameters,t[r].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||HN(n.parent,t.parent))}function Np(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const r=e.value;r._futureSnapshot=t.value;const s=function vfe(n,t,e){return t.children.map(r=>{for(const s of e.children)if(n.shouldReuseRoute(r.value,s.value.snapshot))return Np(n,r,s);return Np(n,r)})}(n,t,e);return new Il(r,s)}{if(n.shouldAttach(t.value)){const i=n.retrieve(t.value);if(null!==i){const o=i.route;return o.value._futureSnapshot=t.value,o.children=t.children.map(c=>Np(n,c)),o}}const r=function Cfe(n){return new So(new y3(n.url),new y3(n.params),new y3(n.queryParams),new y3(n.fragment),new y3(n.data),n.outlet,n.component,n)}(t.value),s=t.children.map(i=>Np(n,i));return new Il(r,s)}}const FN="ngNavigationCancelingError";function Vq(n,t){const{redirectTo:e,navigationBehaviorOptions:r}=Mu(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=Hq(!1,0,t);return s.url=e,s.navigationBehaviorOptions=r,s}function Hq(n,t,e){const r=new Error("NavigationCancelingError: "+(n||""));return r[FN]=!0,r.cancellationCode=t,e&&(r.url=e),r}function Fq(n){return Bq(n)&&Mu(n.url)}function Bq(n){return n&&n[FN]}class yfe{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ap,this.attachRef=null}}let Ap=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,r){const s=this.getOrCreateContext(e);s.outlet=r,this.contexts.set(e,s)}onChildOutletDestroyed(e){const r=this.getContext(e);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let r=this.getContext(e);return r||(r=new yfe,this.contexts.set(e,r)),r}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const jy=!1;let BN=(()=>{class n{constructor(e,r,s,i,o){this.parentContexts=e,this.location=r,this.changeDetector=i,this.environmentInjector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new gr,this.deactivateEvents=new gr,this.attachEvents=new gr,this.detachEvents=new gr,this.name=s||Bn,e.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ne(4012,jy);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ne(4012,jy);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ne(4012,jy);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,r){this.activated=e,this._activatedRoute=r,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,r){if(this.isActivated)throw new Ne(4013,jy);this._activatedRoute=e;const s=this.location,o=e._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Efe(e,c,s.injector);if(r&&function Mfe(n){return!!n.resolveComponentFactory}(r)){const h=r.resolveComponentFactory(o);this.activated=s.createComponent(h,s.length,u)}else this.activated=s.createComponent(o,{index:s.length,injector:u,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)(Q(Ap),Q(ka),x8("name"),Q(fu),Q(wa))},n.\u0275dir=$t({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class Efe{constructor(t,e,r){this.route=t,this.childContexts=e,this.parent=r}get(t,e){return t===So?this.route:t===Ap?this.childContexts:this.parent.get(t,e)}}let $N=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],standalone:!0,features:[A$],decls:1,vars:0,template:function(e,r){1&e&&X(0,"router-outlet")},dependencies:[BN],encapsulation:2}),n})();function $q(n,t){return n.providers&&!n._injector&&(n._injector=KC(n.providers,t,`Route: ${n.path}`)),n._injector??t}function GN(n){const t=n.children&&n.children.map(GN),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Bn&&(e.component=$N),e}function Mc(n){return n.outlet||Bn}function Uq(n,t){const e=n.filter(r=>Mc(r)===t);return e.push(...n.filter(r=>Mc(r)!==t)),e}function Ip(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class bfe{constructor(t,e,r,s){this.routeReuseStrategy=t,this.futureState=e,this.currState=r,this.forwardEvent=s}activate(t){const e=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,r,t),VN(this.futureState.root),this.activateChildRoutes(e,r,t)}deactivateChildRoutes(t,e,r){const s=lf(e);t.children.forEach(i=>{const o=i.value.outlet;this.deactivateRoutes(i,s[o],r),delete s[o]}),m2(s,(i,o)=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(s===i)if(s.component){const o=r.getContext(s.outlet);o&&this.deactivateChildRoutes(t,e,o.children)}else this.deactivateChildRoutes(t,e,r);else i&&this.deactivateRouteAndItsChildren(e,r)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=lf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);if(r&&r.outlet){const o=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:o,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){const r=e.getContext(t.value.outlet),s=r&&t.value.component?r.children:e,i=lf(t);for(const o of Object.keys(i))this.deactivateRouteAndItsChildren(i[o],s);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(t,e,r){const s=lf(e);t.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],r),this.forwardEvent(new dfe(i.value.snapshot))}),t.children.length&&this.forwardEvent(new ffe(t.value.snapshot))}activateRoutes(t,e,r){const s=t.value,i=e?e.value:null;if(VN(s),s===i)if(s.component){const o=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,e,o.children)}else this.activateChildRoutes(t,e,r);else if(s.component){const o=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),VN(c.route.value),this.activateChildRoutes(t,null,o.children)}else{const c=Ip(s.snapshot),u=c?.get(ba)??null;o.attachRef=null,o.route=s,o.resolver=u,o.injector=c,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(t,null,o.children)}}else this.activateChildRoutes(t,null,r)}}class Gq{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Zy{constructor(t,e){this.component=t,this.route=e}}function Ofe(n,t,e){const r=n._root;return xp(r,t?t._root:null,e,[r.value])}function uf(n,t){const e=Symbol(),r=t.get(n,e);return r===e?"function"!=typeof n||function H2(n){return null!==In(n)}(n)?t.get(n):n:r}function xp(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=lf(t);return n.children.forEach(o=>{(function Afe(n,t,e,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const i=n.value,o=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){const u=function Ife(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!Eu(n.url,t.url);case"pathParamsOrQueryParamsChange":return!Eu(n.url,t.url)||!_4(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!HN(n,t)||!_4(n.queryParams,t.queryParams);default:return!HN(n,t)}}(o,i,i.routeConfig.runGuardsAndResolvers);u?s.canActivateChecks.push(new Gq(r)):(i.data=o.data,i._resolvedData=o._resolvedData),xp(n,t,i.component?c?c.children:null:e,r,s),u&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new Zy(c.outlet.component,o))}else o&&kp(t,c,s),s.canActivateChecks.push(new Gq(r)),xp(n,null,i.component?c?c.children:null:e,r,s)})(o,i[o.value.outlet],e,r.concat([o.value]),s),delete i[o.value.outlet]}),m2(i,(o,c)=>kp(o,e.getContext(c),s)),s}function kp(n,t,e){const r=lf(n),s=n.value;m2(r,(i,o)=>{kp(i,s.component?t?t.children.getContext(o):null:t,e)}),e.canDeactivateChecks.push(new Zy(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function Lp(n){return"function"==typeof n}function WN(n){return n instanceof zy||"EmptyError"===n?.name}const Yy=Symbol("INITIAL_VALUE");function ff(){return m4(n=>iq(n.map(t=>t.pipe(Mp(1),function P7e(...n){const t=U3(n);return pr((e,r)=>{(t?SN(n,e,t):SN(n,e)).subscribe(r)})}(Yy)))).pipe(pn(t=>{for(const e of t)if(!0!==e){if(e===Yy)return Yy;if(!1===e||e instanceof yu)return e}return!0}),Ol(t=>t!==Yy),Mp(1)))}function Wq(n){return function ZP(...n){return Jm(n)}(g2(t=>{if(Mu(t))throw Vq(0,t)}),pn(t=>!0===t))}const qN={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function qq(n,t,e,r,s){const i=jN(n,t,e);return i.matched?function Zfe(n,t,e,r){const s=t.canMatch;return s&&0!==s.length?jt(s.map(o=>{const c=uf(o,n);return C0(function zfe(n){return n&&Lp(n.canMatch)}(c)?c.canMatch(t,e):n.runInContext(()=>c(t,e)))})).pipe(ff(),Wq()):jt(!0)}(r=$q(t,r),t,e).pipe(pn(o=>!0===o?i:{...qN})):jt(i)}function jN(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...qN}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const s=(t.matcher||A7e)(e,n,t);if(!s)return{...qN};const i={};m2(s.posParams,(c,u)=>{i[u]=c.path});const o=s.consumed.length>0?{...i,...s.consumed[s.consumed.length-1].parameters}:i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function Ky(n,t,e,r,s="corrected"){if(e.length>0&&function Xfe(n,t,e){return e.some(r=>Xy(n,t,r)&&Mc(r)!==Bn)}(n,e,r)){const o=new qn(t,function Kfe(n,t,e,r){const s={};s[Bn]=r,r._sourceSegment=n,r._segmentIndexShift=t.length;for(const i of e)if(""===i.path&&Mc(i)!==Bn){const o=new qn([],{});o._sourceSegment=n,o._segmentIndexShift=t.length,s[Mc(i)]=o}return s}(n,t,r,new qn(e,n.children)));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===e.length&&function Qfe(n,t,e){return e.some(r=>Xy(n,t,r))}(n,e,r)){const o=new qn(n.segments,function Yfe(n,t,e,r,s,i){const o={};for(const c of r)if(Xy(n,e,c)&&!s[Mc(c)]){const u=new qn([],{});u._sourceSegment=n,u._segmentIndexShift="legacy"===i?n.segments.length:t.length,o[Mc(c)]=u}return{...s,...o}}(n,t,e,r,n.children,s));return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}const i=new qn(n.segments,n.children);return i._sourceSegment=n,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:e}}function Xy(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function jq(n,t,e,r){return!!(Mc(n)===r||r!==Bn&&Xy(t,e,n))&&("**"===n.path||jN(t,n,e).matched)}function Zq(n,t,e){return 0===t.length&&!n.children[e]}const Qy=!1;class Jy{constructor(t){this.segmentGroup=t||null}}class Yq{constructor(t){this.urlTree=t}}function Rp(n){return Ep(new Jy(n))}function Kq(n){return Ep(new Yq(n))}class n9e{constructor(t,e,r,s,i){this.injector=t,this.configLoader=e,this.urlSerializer=r,this.urlTree=s,this.config=i,this.allowRedirects=!0}apply(){const t=Ky(this.urlTree.root,[],[],this.config).segmentGroup,e=new qn(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Bn).pipe(pn(i=>this.createUrlTree(Gy(i),this.urlTree.queryParams,this.urlTree.fragment))).pipe(v0(i=>{if(i instanceof Yq)return this.allowRedirects=!1,this.match(i.urlTree);throw i instanceof Jy?this.noMatchError(i):i}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Bn).pipe(pn(s=>this.createUrlTree(Gy(s),t.queryParams,t.fragment))).pipe(v0(s=>{throw s instanceof Jy?this.noMatchError(s):s}))}noMatchError(t){return new Ne(4002,Qy)}createUrlTree(t,e,r){const s=AN(t);return new yu(s,e,r)}expandSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(t,e,r).pipe(pn(i=>new qn([],i))):this.expandSegment(t,r,e,r.segments,s,!0)}expandChildren(t,e,r){const s=[];for(const i of Object.keys(r.children))"primary"===i?s.unshift(i):s.push(i);return as(s).pipe(g0(i=>{const o=r.children[i],c=Uq(e,i);return this.expandSegmentGroup(t,c,o,i).pipe(pn(u=>({segment:u,outlet:i})))}),uq((i,o)=>(i[o.outlet]=o.segment,i),{}),fq())}expandSegment(t,e,r,s,i,o){return as(r).pipe(g0(c=>this.expandSegmentAgainstRoute(t,e,r,c,s,i,o).pipe(v0(h=>{if(h instanceof Jy)return jt(null);throw h}))),_0(c=>!!c),v0((c,u)=>{if(WN(c))return Zq(e,s,i)?jt(new qn([],{})):Rp(e);throw c}))}expandSegmentAgainstRoute(t,e,r,s,i,o,c){return jq(s,e,i,o)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(t,e,s,i,o):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o):Rp(e):Rp(e)}expandSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,r,s,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,r,s){const i=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Kq(i):this.lineralizeSegments(r,i).pipe(De(o=>{const c=new qn(o,{});return this.expandSegment(t,c,e,o,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,r,s,i,o){const{matched:c,consumedSegments:u,remainingSegments:h,positionalParamSegments:p}=jN(e,s,i);if(!c)return Rp(e);const m=this.applyRedirectCommands(u,s.redirectTo,p);return s.redirectTo.startsWith("/")?Kq(m):this.lineralizeSegments(s,m).pipe(De(C=>this.expandSegment(t,e,r,C.concat(h),o,!1)))}matchSegmentAgainstRoute(t,e,r,s,i){return"**"===r.path?(t=$q(r,t),r.loadChildren?(r._loadedRoutes?jt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(t,r)).pipe(pn(c=>(r._loadedRoutes=c.routes,r._loadedInjector=c.injector,new qn(s,{})))):jt(new qn(s,{}))):qq(e,r,s,t).pipe(m4(({matched:o,consumedSegments:c,remainingSegments:u})=>o?this.getChildConfig(t=r._injector??t,r,s).pipe(De(p=>{const m=p.injector??t,C=p.routes,{segmentGroup:w,slicedSegments:I}=Ky(e,c,u,C),H=new qn(w.segments,w.children);if(0===I.length&&H.hasChildren())return this.expandChildren(m,C,H).pipe(pn(te=>new qn(c,te)));if(0===C.length&&0===I.length)return jt(new qn(c,{}));const Y=Mc(r)===i;return this.expandSegment(m,H,C,I,Y?Bn:i,!0).pipe(pn(ve=>new qn(c.concat(ve.segments),ve.children)))})):Rp(e)))}getChildConfig(t,e,r){return e.children?jt({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?jt({routes:e._loadedRoutes,injector:e._loadedInjector}):function jfe(n,t,e,r){const s=t.canLoad;return void 0===s||0===s.length?jt(!0):jt(s.map(o=>{const c=uf(o,n);return C0(function kfe(n){return n&&Lp(n.canLoad)}(c)?c.canLoad(t,e):n.runInContext(()=>c(t,e)))})).pipe(ff(),Wq())}(t,e,r).pipe(De(s=>s?this.configLoader.loadChildren(t,e).pipe(g2(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):function e9e(n){return Ep(Hq(Qy,3))}())):jt({routes:[],injector:t})}lineralizeSegments(t,e){let r=[],s=e.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return jt(r);if(s.numberOfChildren>1||!s.children[Bn])return Ep(new Ne(4e3,Qy));s=s.children[Bn]}}applyRedirectCommands(t,e,r){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,r)}applyRedirectCreateUrlTree(t,e,r,s){const i=this.createSegmentGroup(t,e.root,r,s);return new yu(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const r={};return m2(t,(s,i)=>{if("string"==typeof s&&s.startsWith(":")){const c=s.substring(1);r[i]=e[c]}else r[i]=s}),r}createSegmentGroup(t,e,r,s){const i=this.createSegments(t,e.segments,r,s);let o={};return m2(e.children,(c,u)=>{o[u]=this.createSegmentGroup(t,c,r,s)}),new qn(i,o)}createSegments(t,e,r,s){return e.map(i=>i.path.startsWith(":")?this.findPosParam(t,i,s):this.findOrReturn(i,r))}findPosParam(t,e,r){const s=r[e.path.substring(1)];if(!s)throw new Ne(4001,Qy);return s}findOrReturn(t,e){let r=0;for(const s of e){if(s.path===t.path)return e.splice(r),s;r++}return t}}class s9e{}class a9e{constructor(t,e,r,s,i,o,c,u){this.injector=t,this.rootComponentType=e,this.config=r,this.urlTree=s,this.url=i,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=c,this.urlSerializer=u}recognize(){const t=Ky(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Bn).pipe(pn(e=>{if(null===e)return null;const r=new qy([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Bn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new Il(r,e),i=new Dq(this.url,s);return this.inheritParamsAndData(i._root),i}))}inheritParamsAndData(t){const e=t.value,r=Rq(e,this.paramsInheritanceStrategy);e.params=Object.freeze(r.params),e.data=Object.freeze(r.data),t.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(t,e,r,s){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,e,r):this.processSegment(t,e,r,r.segments,s)}processChildren(t,e,r){return as(Object.keys(r.children)).pipe(g0(s=>{const i=r.children[s],o=Uq(e,s);return this.processSegmentGroup(t,o,i,s)}),uq((s,i)=>s&&i?(s.push(...i),s):null),function b7e(n,t=!1){return pr((e,r)=>{let s=0;e.subscribe(os(r,i=>{const o=n(i,s++);(o||t)&&r.next(i),!o&&r.complete()}))})}(s=>null!==s),Vy(null),fq(),pn(s=>{if(null===s)return null;const i=Xq(s);return function c9e(n){n.sort((t,e)=>t.value.outlet===Bn?-1:e.value.outlet===Bn?1:t.value.outlet.localeCompare(e.value.outlet))}(i),i}))}processSegment(t,e,r,s,i){return as(e).pipe(g0(o=>this.processSegmentAgainstRoute(o._injector??t,o,r,s,i)),_0(o=>!!o),v0(o=>{if(WN(o))return Zq(r,s,i)?jt([]):jt(null);throw o}))}processSegmentAgainstRoute(t,e,r,s,i){if(e.redirectTo||!jq(e,r,s,i))return jt(null);let o;if("**"===e.path){const c=s.length>0?pq(s).parameters:{},u=Jq(r)+s.length;o=jt({snapshot:new qy(s,c,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tj(e),Mc(e),e.component??e._loadedComponent??null,e,Qq(r),u,nj(e),u),consumedSegments:[],remainingSegments:[]})}else o=qq(r,e,s,t).pipe(pn(({matched:c,consumedSegments:u,remainingSegments:h,parameters:p})=>{if(!c)return null;const m=Jq(r)+u.length;return{snapshot:new qy(u,p,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tj(e),Mc(e),e.component??e._loadedComponent??null,e,Qq(r),m,nj(e),m),consumedSegments:u,remainingSegments:h}}));return o.pipe(m4(c=>{if(null===c)return jt(null);const{snapshot:u,consumedSegments:h,remainingSegments:p}=c;t=e._injector??t;const m=e._loadedInjector??t,C=function l9e(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:w,slicedSegments:I}=Ky(r,h,p,C.filter(Y=>void 0===Y.redirectTo),this.relativeLinkResolution);if(0===I.length&&w.hasChildren())return this.processChildren(m,C,w).pipe(pn(Y=>null===Y?null:[new Il(u,Y)]));if(0===C.length&&0===I.length)return jt([new Il(u,[])]);const H=Mc(e)===i;return this.processSegment(m,C,w,I,H?Bn:i).pipe(pn(Y=>null===Y?null:[new Il(u,Y)]))}))}}function u9e(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function Xq(n){const t=[],e=new Set;for(const r of n){if(!u9e(r)){t.push(r);continue}const s=t.find(i=>r.value.routeConfig===i.value.routeConfig);void 0!==s?(s.children.push(...r.children),e.add(s)):t.push(r)}for(const r of e){const s=Xq(r.children);t.push(new Il(r.value,s))}return t.filter(r=>!e.has(r))}function Qq(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function Jq(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function tj(n){return n.data||{}}function nj(n){return n.resolve||{}}function rj(n){return"string"==typeof n.title||null===n.title}function ZN(n){return m4(t=>{const e=n(t);return e?as(e).pipe(pn(()=>t)):jt(t)})}let sj=(()=>{class n{buildTitle(e){let r,s=e.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(i=>i.outlet===Bn);return r}getResolvedTitleForRoute(e){return e.data[Sp]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:function(){return zr(ij)},providedIn:"root"}),n})(),ij=(()=>{class n extends sj{constructor(e){super(),this.title=e}updateTitle(e){const r=this.buildTitle(e);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(e){return new(e||n)(Re(zG))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class v9e{}class y9e extends class C9e{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const tE=new xt("",{providedIn:"root",factory:()=>({})}),YN=new xt("ROUTES");let KN=(()=>{class n{constructor(e,r){this.injector=e,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return jt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const r=C0(e.loadComponent()).pipe(g2(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),wN(()=>{this.componentLoaders.delete(e)})),s=new cq(r,()=>new z2).pipe(PN());return this.componentLoaders.set(e,s),s}loadChildren(e,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return jt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const i=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(pn(c=>{this.onLoadEndListener&&this.onLoadEndListener(r);let u,h,p=!1;Array.isArray(c)?h=c:(u=c.create(e).injector,h=dq(u.get(YN,[],qt.Self|qt.Optional)));return{routes:h.map(GN),injector:u}}),wN(()=>{this.childrenLoaders.delete(r)})),o=new cq(i,()=>new z2).pipe(PN());return this.childrenLoaders.set(r,o),o}loadModuleFactoryOrRoutes(e){return C0(e()).pipe(De(r=>r instanceof O$||Array.isArray(r)?jt(r):as(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(e){return new(e||n)(Re(ui),Re(mO))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class M9e{}class S9e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function P9e(n){throw n}function T9e(n,t,e){return t.parse("/")}const w9e={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},b9e={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function aj(){const n=zr(yq),t=zr(Ap),e=zr(IO),r=zr(ui),s=zr(mO),i=zr(YN,{optional:!0})??[],o=zr(tE,{optional:!0})??{},c=zr(ij),u=zr(sj,{optional:!0}),h=zr(M9e,{optional:!0}),p=zr(v9e,{optional:!0}),m=new jn(null,n,t,e,r,s,dq(i));return h&&(m.urlHandlingStrategy=h),p&&(m.routeReuseStrategy=p),m.titleStrategy=u??c,function O9e(n,t){n.errorHandler&&(t.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(t.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(t.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(t.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(t.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(t.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(t.canceledNavigationResolution=n.canceledNavigationResolution)}(o,m),m}let jn=(()=>{class n{constructor(e,r,s,i,o,c,u){this.rootComponentType=e,this.urlSerializer=r,this.rootContexts=s,this.location=i,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new z2,this.errorHandler=P9e,this.malformedUriErrorHandler=T9e,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>jt(void 0),this.urlHandlingStrategy=new S9e,this.routeReuseStrategy=new y9e,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=o.get(KN),this.configLoader.onLoadEndListener=C=>this.triggerEvent(new lfe(C)),this.configLoader.onLoadStartListener=C=>this.triggerEvent(new cfe(C)),this.ngModule=o.get(uu),this.console=o.get(n0e);const m=o.get(Pr);this.isNgZoneEnabled=m instanceof Pr&&Pr.isInAngularZone(),this.resetConfig(u),this.currentUrlTree=function x7e(){return new yu(new qn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Lq(this.currentUrlTree,this.rootComponentType),this.transitions=new y3({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(e){const r=this.events;return e.pipe(Ol(s=>0!==s.id),pn(s=>({...s,extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),m4(s=>{let i=!1,o=!1;return jt(s).pipe(g2(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),m4(c=>{const u=this.browserUrlTree.toString(),h=!this.navigated||c.extractedUrl.toString()!==u||u!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||h)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return cj(c.source)&&(this.browserUrlTree=c.extractedUrl),jt(c).pipe(m4(m=>{const C=this.transitions.getValue();return r.next(new LN(m.id,this.serializeUrl(m.extractedUrl),m.source,m.restoredState)),C!==this.transitions.getValue()?ic:Promise.resolve(m)}),function r9e(n,t,e,r){return m4(s=>function t9e(n,t,e,r,s){return new n9e(n,t,e,r,s).apply()}(n,t,e,s.extractedUrl,r).pipe(pn(i=>({...s,urlAfterRedirects:i}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),g2(m=>{this.currentNavigation={...this.currentNavigation,finalUrl:m.urlAfterRedirects},s.urlAfterRedirects=m.urlAfterRedirects}),function h9e(n,t,e,r,s,i){return De(o=>function o9e(n,t,e,r,s,i,o="emptyOnly",c="legacy"){return new a9e(n,t,e,r,s,o,c,i).recognize().pipe(m4(u=>null===u?function i9e(n){return new Er(t=>t.error(n))}(new s9e):jt(u)))}(n,t,e,o.urlAfterRedirects,r.serialize(o.urlAfterRedirects),r,s,i).pipe(pn(c=>({...o,targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),g2(m=>{if(s.targetSnapshot=m.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!m.extras.skipLocationChange){const w=this.urlHandlingStrategy.merge(m.urlAfterRedirects,m.rawUrl);this.setBrowserUrl(w,m)}this.browserUrlTree=m.urlAfterRedirects}const C=new rfe(m.id,this.serializeUrl(m.extractedUrl),this.serializeUrl(m.urlAfterRedirects),m.targetSnapshot);r.next(C)}));if(h&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:C,extractedUrl:w,source:I,restoredState:H,extras:Y}=c,ee=new LN(C,this.serializeUrl(w),I,H);r.next(ee);const ve=Lq(w,this.rootComponentType).snapshot;return jt(s={...c,targetSnapshot:ve,urlAfterRedirects:w,extras:{...Y,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=c.rawUrl,c.resolve(null),ic}),g2(c=>{const u=new sfe(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(u)}),pn(c=>s={...c,guards:Ofe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),function Hfe(n,t){return De(e=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return 0===o.length&&0===i.length?jt({...e,guardsResult:!0}):function Ffe(n,t,e,r){return as(n).pipe(De(s=>function qfe(n,t,e,r,s){const i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?jt(i.map(c=>{const u=Ip(t)??s,h=uf(c,u);return C0(function Dfe(n){return n&&Lp(n.canDeactivate)}(h)?h.canDeactivate(n,t,e,r):u.runInContext(()=>h(n,t,e,r))).pipe(_0())})).pipe(ff()):jt(!0)}(s.component,s.route,e,t,r)),_0(s=>!0!==s,!0))}(o,r,s,n).pipe(De(c=>c&&function xfe(n){return"boolean"==typeof n}(c)?function Bfe(n,t,e,r){return as(t).pipe(g0(s=>SN(function Ufe(n,t){return null!==n&&t&&t(new ufe(n)),jt(!0)}(s.route.parent,r),function $fe(n,t){return null!==n&&t&&t(new hfe(n)),jt(!0)}(s.route,r),function Wfe(n,t,e){const r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(o=>function Nfe(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(o)).filter(o=>null!==o).map(o=>aq(()=>jt(o.guards.map(u=>{const h=Ip(o.node)??e,p=uf(u,h);return C0(function Rfe(n){return n&&Lp(n.canActivateChild)}(p)?p.canActivateChild(r,n):h.runInContext(()=>p(r,n))).pipe(_0())})).pipe(ff())));return jt(i).pipe(ff())}(n,s.path,e),function Gfe(n,t,e){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return jt(!0);const s=r.map(i=>aq(()=>{const o=Ip(t)??e,c=uf(i,o);return C0(function Lfe(n){return n&&Lp(n.canActivate)}(c)?c.canActivate(t,n):o.runInContext(()=>c(t,n))).pipe(_0())}));return jt(s).pipe(ff())}(n,s.route,e))),_0(s=>!0!==s,!0))}(r,i,n,t):jt(c)),pn(c=>({...e,guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),g2(c=>{if(s.guardsResult=c.guardsResult,Mu(c.guardsResult))throw Vq(0,c.guardsResult);const u=new ife(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(u)}),Ol(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),ZN(c=>{if(c.guards.canActivateChecks.length)return jt(c).pipe(g2(u=>{const h=new ofe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}),m4(u=>{let h=!1;return jt(u).pipe(function d9e(n,t){return De(e=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=e;if(!s.length)return jt(e);let i=0;return as(s).pipe(g0(o=>function p9e(n,t,e,r){const s=n.routeConfig,i=n._resolve;return void 0!==s?.title&&!rj(s)&&(i[Sp]=s.title),function g9e(n,t,e,r){const s=function m9e(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return jt({});const i={};return as(s).pipe(De(o=>function _9e(n,t,e,r){const s=Ip(t)??r,i=uf(n,s);return C0(i.resolve?i.resolve(t,e):s.runInContext(()=>i(t,e)))}(n[o],t,e,r).pipe(_0(),g2(c=>{i[o]=c}))),TN(1),function O7e(n){return pn(()=>n)}(i),v0(o=>WN(o)?ic:Ep(o)))}(i,n,t,r).pipe(pn(o=>(n._resolvedData=o,n.data=Rq(n,e).resolve,s&&rj(s)&&(n.data[Sp]=s.title),null)))}(o.route,r,n,t)),g2(()=>i++),TN(1),De(o=>i===s.length?jt(e):ic))})}(this.paramsInheritanceStrategy,this.ngModule.injector),g2({next:()=>h=!0,complete:()=>{h||(this.restoreHistory(u),this.cancelNavigationTransition(u,"",2))}}))}),g2(u=>{const h=new afe(u.id,this.serializeUrl(u.extractedUrl),this.serializeUrl(u.urlAfterRedirects),u.targetSnapshot);this.triggerEvent(h)}))}),ZN(c=>{const u=h=>{const p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(g2(m=>{h.component=m}),pn(()=>{})));for(const m of h.children)p.push(...u(m));return p};return iq(u(c.targetSnapshot.root)).pipe(Vy(),Mp(1))}),ZN(()=>this.afterPreactivation()),pn(c=>{const u=function _fe(n,t,e){const r=Np(n,t._root,e?e._root:void 0);return new kq(r,t)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return s={...c,targetRouterState:u}}),g2(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,t,e)=>pn(r=>(new bfe(t,r.targetRouterState,r.currentRouterState,e).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),g2({next(){i=!0},complete(){i=!0}}),wN(()=>{i||o||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),v0(c=>{if(o=!0,Bq(c)){Fq(c)||(this.navigated=!0,this.restoreHistory(s,!0));const u=new Wy(s.id,this.serializeUrl(s.extractedUrl),c.message,c.cancellationCode);if(r.next(u),Fq(c)){const h=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),p={skipLocationChange:s.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||cj(s.source)};this.scheduleNavigation(h,"imperative",null,p,{resolve:s.resolve,reject:s.reject,promise:s.promise})}else s.resolve(!1)}else{this.restoreHistory(s,!0);const u=new Aq(s.id,this.serializeUrl(s.extractedUrl),c,s.targetSnapshot??void 0);r.next(u);try{s.resolve(this.errorHandler(c))}catch(h){s.reject(h)}}return ic}))}))}resetRootComponentType(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}setTransition(e){this.transitions.next({...this.transitions.value,...e})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const r="popstate"===e.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const s={replaceUrl:!0},i=e.state?.navigationId?e.state:null;if(i){const c={...i};delete c.navigationId,delete c.\u0275routerPageId,0!==Object.keys(c).length&&(s.state=c)}const o=this.parseUrl(e.url);this.scheduleNavigation(o,r,i,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(e){this.events.next(e)}resetConfig(e){this.config=e.map(GN),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,r={}){const{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:u}=r,h=s||this.routerState.root,p=u?this.currentUrlTree.fragment:o;let m=null;switch(c){case"merge":m={...this.currentUrlTree.queryParams,...i};break;case"preserve":m=this.currentUrlTree.queryParams;break;default:m=i||null}return null!==m&&(m=this.removeEmptyProps(m)),X7e(h,this.currentUrlTree,e,m,p??null)}navigateByUrl(e,r={skipLocationChange:!1}){const s=Mu(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,"imperative",null,r)}navigate(e,r={skipLocationChange:!1}){return function N9e(n){for(let t=0;t<n.length;t++){if(null==n[t])throw new Ne(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,r),r)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let r;try{r=this.urlSerializer.parse(e)}catch(s){r=this.malformedUriErrorHandler(s,this.urlSerializer,e)}return r}isActive(e,r){let s;if(s=!0===r?{...w9e}:!1===r?{...b9e}:r,Mu(e))return mq(this.currentUrlTree,e,s);const i=this.parseUrl(e);return mq(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.keys(e).reduce((r,s)=>{const i=e[s];return null!=i&&(r[s]=i),r},{})}processNavigations(){this.navigations.subscribe(e=>{this.navigated=!0,this.lastSuccessfulId=e.id,this.currentPageId=e.targetPageId,this.events.next(new y0(e.id,this.serializeUrl(e.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),e.resolve(!0)},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}scheduleNavigation(e,r,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((C,w)=>{c=C,u=w});const p=++this.navigationId;let m;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(s=this.location.getState()),m=s&&s.\u0275routerPageId?s.\u0275routerPageId:i.replaceUrl||i.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):m=0,this.setTransition({id:p,targetPageId:m,source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:i,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(C=>Promise.reject(C))}setBrowserUrl(e,r){const s=this.urlSerializer.serialize(e),i={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl?this.location.replaceState(s,"",i):this.location.go(s,"",i)}restoreHistory(e,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-e.targetPageId;"popstate"!==e.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===s?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===s&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(s)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(e,r,s){const i=new Wy(e.id,this.serializeUrl(e.extractedUrl),r,s);this.triggerEvent(i),e.resolve(!1)}generateNgRouterState(e,r){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:r}:{navigationId:e}}}return n.\u0275fac=function(e){k7()},n.\u0275prov=et({token:n,factory:function(){return aj()},providedIn:"root"}),n})();function cj(n){return"imperative"!==n}let Dp=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.route=r,this.tabIndexAttribute=s,this.renderer=i,this.el=o,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new z2,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=Pl(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Pl(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Pl(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){if(null!=this.tabIndexAttribute)return;const r=this.renderer,s=this.el.nativeElement;null!==e?r.setAttribute(s,"tabindex",e):r.removeAttribute(s,"tabindex")}ngOnChanges(e){this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(So),x8("tabindex"),Q(mo),Q(l2))},n.\u0275dir=$t({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(e,r){1&e&&J("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[e2]}),n})(),Su=(()=>{class n{constructor(e,r,s){this.router=e,this.route=r,this.locationStrategy=s,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new z2,this.subscription=e.events.subscribe(i=>{i instanceof y0&&this.updateTargetUrlAndHref()})}set preserveFragment(e){this._preserveFragment=Pl(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Pl(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Pl(e)}get replaceUrl(){return this._replaceUrl}set routerLink(e){this.commands=null!=e?Array.isArray(e)?e:[e]:null}ngOnChanges(e){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(e,r,s,i,o){return!!(0!==e||r||s||i||o||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(So),Q(du))},n.\u0275dir=$t({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,r){1&e&&J("click",function(i){return r.onClick(i.button,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey)}),2&e&&D("target",r.target)("href",r.href,i3)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[e2]}),n})();class lj{}let x9e=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.injector=s,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ol(e=>e instanceof y0),g0(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,r){const s=[];for(const i of r){i.providers&&!i._injector&&(i._injector=KC(i.providers,e,`Route: ${i.path}`));const o=i._injector??e,c=i._loadedInjector??o;i.loadChildren&&!i._loadedRoutes&&void 0===i.canLoad||i.loadComponent&&!i._loadedComponent?s.push(this.preloadConfig(o,i)):(i.children||i._loadedRoutes)&&s.push(this.processRoutes(c,i.children??i._loadedRoutes))}return as(s).pipe(Y4())}preloadConfig(e,r){return this.preloadingStrategy.preload(r,()=>{let s;s=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(e,r):jt(null);const i=s.pipe(De(o=>null===o?jt(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??e,o.routes))));return r.loadComponent&&!r._loadedComponent?as([i,this.loader.loadComponent(r)]).pipe(Y4()):i})}}return n.\u0275fac=function(e){return new(e||n)(Re(jn),Re(mO),Re(wa),Re(lj),Re(KN))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const XN=new xt("");let uj=(()=>{class n{constructor(e,r,s={}){this.router=e,this.viewportScroller=r,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration=s.scrollPositionRestoration||"disabled",s.anchorScrolling=s.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(e=>{e instanceof LN?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof y0&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.router.parseUrl(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(e=>{e instanceof Iq&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,r){this.router.triggerEvent(new Iq(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(e){k7()},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();function hf(n,t){return{\u0275kind:n,\u0275providers:t}}function QN(n){return[{provide:YN,multi:!0,useValue:n}]}function hj(){const n=zr(ui);return t=>{const e=n.get(sp);if(t!==e.components[0])return;const r=n.get(jn),s=n.get(dj);1===n.get(JN)&&r.initialNavigation(),n.get(pj,null,qt.Optional)?.setUpPreloading(),n.get(XN,null,qt.Optional)?.init(),r.resetRootComponentType(e.componentTypes[0]),s.next(),s.complete()}}const dj=new xt("",{factory:()=>new z2}),JN=new xt("",{providedIn:"root",factory:()=>1});const pj=new xt("");function D9e(n){return hf(0,[{provide:pj,useExisting:x9e},{provide:lj,useExisting:n}])}const gj=new xt("ROUTER_FORROOT_GUARD"),z9e=[IO,{provide:yq,useClass:ON},{provide:jn,useFactory:aj},Ap,{provide:So,useFactory:function fj(n){return n.routerState.root},deps:[jn]},KN];function V9e(){return new TU("Router",jn)}let H9e=(()=>{class n{constructor(e){}static forRoot(e,r){return{ngModule:n,providers:[z9e,[],QN(e),{provide:gj,useFactory:U9e,deps:[[jn,new li,new H8]]},{provide:tE,useValue:r||{}},r?.useHash?{provide:du,useClass:G0e}:{provide:du,useClass:KU},{provide:XN,useFactory:()=>{const n=zr(jn),t=zr(cue),e=zr(tE);return e.scrollOffset&&t.setOffset(e.scrollOffset),new uj(n,t,e)}},r?.preloadingStrategy?D9e(r.preloadingStrategy).\u0275providers:[],{provide:TU,multi:!0,useFactory:V9e},r?.initialNavigation?G9e(r):[],[{provide:mj,useFactory:hj},{provide:_U,multi:!0,useExisting:mj}]]}}static forChild(e){return{ngModule:n,providers:[QN(e)]}}}return n.\u0275fac=function(e){return new(e||n)(Re(gj,8))},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({imports:[$N]}),n})();function U9e(n){return"guarded"}function G9e(n){return["disabled"===n.initialNavigation?hf(3,[{provide:ey,multi:!0,useFactory:()=>{const t=zr(jn);return()=>{t.setUpLocationChangeListener()}}},{provide:JN,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?hf(2,[{provide:JN,useValue:0},{provide:ey,multi:!0,deps:[ui],useFactory:t=>{const e=t.get($0e,Promise.resolve());let r=!1;return()=>e.then(()=>new Promise(i=>{const o=t.get(jn),c=t.get(dj);(function s(i){t.get(jn).events.pipe(Ol(c=>c instanceof y0||c instanceof Wy||c instanceof Aq),pn(c=>c instanceof y0||c instanceof Wy&&(0===c.code||1===c.code)&&null),Ol(c=>null!==c),Mp(1)).subscribe(()=>{i()})})(()=>{i(!0),r=!0}),o.afterPreactivation=()=>(i(!0),r||c.closed?jt(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const mj=new xt("");class _j{}const xl="*";function vj(n,t=null){return{type:2,steps:n,options:t}}function Cj(n){return{type:6,styles:n,offset:null}}function yj(n){Promise.resolve().then(n)}class zp{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){yj(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Ej{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,r=0,s=0;const i=this.players.length;0==i?yj(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==i&&this._onFinish()}),o.onDestroy(()=>{++r==i&&this._onDestroy()}),o.onStart(()=>{++s==i&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(r=>{const s=r.totalTime?Math.min(1,e/r.totalTime):1;r.setPosition(s)})}getPosition(){const t=this.players.reduce((e,r)=>null===e||r.totalTime>e.totalTime?r:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}function Mj(n){return new Ne(3e3,!1)}function bhe(){return typeof window<"u"&&typeof window.document<"u"}function tA(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function E0(n){switch(n.length){case 0:return new zp;case 1:return n[0];default:return new Ej(n)}}function Sj(n,t,e,r,s=new Map,i=new Map){const o=[],c=[];let u=-1,h=null;if(r.forEach(p=>{const m=p.get("offset"),C=m==u,w=C&&h||new Map;p.forEach((I,H)=>{let Y=H,ee=I;if("offset"!==H)switch(Y=t.normalizePropertyName(Y,o),ee){case"!":ee=s.get(H);break;case xl:ee=i.get(H);break;default:ee=t.normalizeStyleValue(H,Y,ee,o)}w.set(Y,ee)}),C||c.push(w),h=w,u=m}),o.length)throw function ghe(n){return new Ne(3502,!1)}();return c}function nA(n,t,e,r){switch(t){case"start":n.onStart(()=>r(e&&rA(e,"start",n)));break;case"done":n.onDone(()=>r(e&&rA(e,"done",n)));break;case"destroy":n.onDestroy(()=>r(e&&rA(e,"destroy",n)))}}function rA(n,t,e){const i=sA(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),o=n._data;return null!=o&&(i._data=o),i}function sA(n,t,e,r,s="",i=0,o){return{element:n,triggerName:t,fromState:e,toState:r,phaseName:s,totalTime:i,disabled:!!o}}function Ra(n,t,e){let r=n.get(t);return r||n.set(t,r=e),r}function Pj(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let iA=(n,t)=>!1,Tj=(n,t,e)=>[],wj=null;function oA(n){const t=n.parentNode||n.host;return t===wj?null:t}(tA()||typeof Element<"u")&&(bhe()?(wj=(()=>document.documentElement)(),iA=(n,t)=>{for(;t;){if(t===n)return!0;t=oA(t)}return!1}):iA=(n,t)=>n.contains(t),Tj=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const r=n.querySelector(t);return r?[r]:[]});let Pu=null,bj=!1;const Oj=iA,Nj=Tj;let Aj=(()=>{class n{validateStyleProperty(e){return function Nhe(n){Pu||(Pu=function Ahe(){return typeof document<"u"?document.body:null}()||{},bj=!!Pu.style&&"WebkitAppearance"in Pu.style);let t=!0;return Pu.style&&!function Ohe(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Pu.style,!t&&bj&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Pu.style)),t}(e)}matchesElement(e,r){return!1}containsElement(e,r){return Oj(e,r)}getParentElement(e){return oA(e)}query(e,r,s){return Nj(e,r,s)}computeStyle(e,r,s){return s||""}animate(e,r,s,i,o,c=[],u){return new zp(s,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})(),aA=(()=>{class n{}return n.NOOP=new Aj,n})();const cA="ng-enter",iE="ng-leave",oE="ng-trigger",aE=".ng-trigger",xj="ng-animating",lA=".ng-animating";function kl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:uA(parseFloat(t[1]),t[2])}function uA(n,t){return"s"===t?1e3*n:n}function cE(n,t,e){return n.hasOwnProperty("duration")?n:function khe(n,t,e){let s,i=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(Mj()),{duration:0,delay:0,easing:""};s=uA(parseFloat(c[1]),c[2]);const u=c[3];null!=u&&(i=uA(parseFloat(u),c[4]));const h=c[5];h&&(o=h)}else s=n;if(!e){let c=!1,u=t.length;s<0&&(t.push(function j9e(){return new Ne(3100,!1)}()),c=!0),i<0&&(t.push(function Z9e(){return new Ne(3101,!1)}()),c=!0),c&&t.splice(u,0,Mj())}return{duration:s,delay:i,easing:o}}(n,t,e)}function Vp(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function kj(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function M0(n,t=new Map,e){if(e)for(let[r,s]of e)t.set(r,s);for(let[r,s]of n)t.set(r,s);return t}function Rj(n,t,e){return e?t+":"+e+";":""}function Dj(n){let t="";for(let e=0;e<n.style.length;e++){const r=n.style.item(e);t+=Rj(0,r,n.style.getPropertyValue(r))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Rj(0,zhe(e),n.style[e]));n.setAttribute("style",t)}function v4(n,t,e){n.style&&(t.forEach((r,s)=>{const i=hA(s);e&&!e.has(s)&&e.set(s,n.style[i]),n.style[i]=r}),tA()&&Dj(n))}function Tu(n,t){n.style&&(t.forEach((e,r)=>{const s=hA(r);n.style[s]=""}),tA()&&Dj(n))}function Hp(n){return Array.isArray(n)?1==n.length?n[0]:vj(n):n}const fA=new RegExp("{{\\s*(.+?)\\s*}}","g");function zj(n){let t=[];if("string"==typeof n){let e;for(;e=fA.exec(n);)t.push(e[1]);fA.lastIndex=0}return t}function Fp(n,t,e){const r=n.toString(),s=r.replace(fA,(i,o)=>{let c=t[o];return null==c&&(e.push(function K9e(n){return new Ne(3003,!1)}()),c=""),c.toString()});return s==r?n:s}function lE(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const Dhe=/-+([a-z0-9])/g;function hA(n){return n.replace(Dhe,(...t)=>t[1].toUpperCase())}function zhe(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Da(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function X9e(n){return new Ne(3004,!1)}()}}function Vj(n,t){return window.getComputedStyle(n)[t]}function Uhe(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(r=>function Ghe(n,t,e){if(":"==n[0]){const u=function Whe(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,r)=>parseFloat(r)>parseFloat(e);case":decrement":return(e,r)=>parseFloat(r)<parseFloat(e);default:return t.push(function fhe(n){return new Ne(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof u)return void t.push(u);n=u}const r=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return e.push(function uhe(n){return new Ne(3015,!1)}()),t;const s=r[1],i=r[2],o=r[3];t.push(Hj(s,o));"<"==i[0]&&!("*"==s&&"*"==o)&&t.push(Hj(o,s))}(r,e,t)):e.push(n),e}const dE=new Set(["true","1"]),pE=new Set(["false","0"]);function Hj(n,t){const e=dE.has(n)||pE.has(n),r=dE.has(t)||pE.has(t);return(s,i)=>{let o="*"==n||n==s,c="*"==t||t==i;return!o&&e&&"boolean"==typeof s&&(o=s?dE.has(n):pE.has(n)),!c&&r&&"boolean"==typeof i&&(c=i?dE.has(t):pE.has(t)),o&&c}}const qhe=new RegExp("s*:selfs*,?","g");function dA(n,t,e,r){return new jhe(n).build(t,e,r)}class jhe{constructor(t){this._driver=t}build(t,e,r){const s=new Khe(e);return this._resetContextStyleTimingState(s),Da(this,Hp(t),s)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let r=e.queryCount=0,s=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function J9e(){return new Ne(3006,!1)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const u=c,h=u.name;h.toString().split(/\s*,\s*/).forEach(p=>{u.name=p,i.push(this.visitState(u,e))}),u.name=h}else if(1==c.type){const u=this.visitTransition(c,e);r+=u.queryCount,s+=u.depCount,o.push(u)}else e.errors.push(function ehe(){return new Ne(3007,!1)}())}),{type:7,name:t.name,states:i,transitions:o,queryCount:r,depCount:s,options:null}}visitState(t,e){const r=this.visitStyle(t.styles,e),s=t.options&&t.options.params||null;if(r.containsDynamicStyles){const i=new Set,o=s||{};r.styles.forEach(c=>{c instanceof Map&&c.forEach(u=>{zj(u).forEach(h=>{o.hasOwnProperty(h)||i.add(h)})})}),i.size&&(lE(i.values()),e.errors.push(function the(n,t){return new Ne(3008,!1)}()))}return{type:0,name:t.name,style:r,options:s?{params:s}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const r=Da(this,Hp(t.animation),e);return{type:1,matchers:Uhe(t.expr,e.errors),animation:r,queryCount:e.queryCount,depCount:e.depCount,options:wu(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(r=>Da(this,r,e)),options:wu(t.options)}}visitGroup(t,e){const r=e.currentTime;let s=0;const i=t.steps.map(o=>{e.currentTime=r;const c=Da(this,o,e);return s=Math.max(s,e.currentTime),c});return e.currentTime=s,{type:3,steps:i,options:wu(t.options)}}visitAnimate(t,e){const r=function Qhe(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return pA(cE(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(i=>"{"==i.charAt(0)&&"{"==i.charAt(1))){const i=pA(0,0,"");return i.dynamic=!0,i.strValue=e,i}const s=cE(e,t);return pA(s.duration,s.delay,s.easing)}(t.timings,e.errors);e.currentAnimateTimings=r;let s,i=t.styles?t.styles:Cj({});if(5==i.type)s=this.visitKeyframes(i,e);else{let o=t.styles,c=!1;if(!o){c=!0;const h={};r.easing&&(h.easing=r.easing),o=Cj(h)}e.currentTime+=r.duration+r.delay;const u=this.visitStyle(o,e);u.isEmptyStep=c,s=u}return e.currentAnimateTimings=null,{type:4,timings:r,style:s,options:null}}visitStyle(t,e){const r=this._makeStyleAst(t,e);return this._validateStyleAst(r,e),r}_makeStyleAst(t,e){const r=[],s=Array.isArray(t.styles)?t.styles:[t.styles];for(let c of s)"string"==typeof c?c===xl?r.push(c):e.errors.push(new Ne(3002,!1)):r.push(kj(c));let i=!1,o=null;return r.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(o=c.get("easing"),c.delete("easing")),!i))for(let u of c.values())if(u.toString().indexOf("{{")>=0){i=!0;break}}),{type:6,styles:r,easing:o,offset:t.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(t,e){const r=e.currentAnimateTimings;let s=e.currentTime,i=e.currentTime;r&&i>0&&(i-=r.duration+r.delay),t.styles.forEach(o=>{"string"!=typeof o&&o.forEach((c,u)=>{const h=e.collectedStyles.get(e.currentQuerySelector),p=h.get(u);let m=!0;p&&(i!=s&&i>=p.startTime&&s<=p.endTime&&(e.errors.push(function rhe(n,t,e,r,s){return new Ne(3010,!1)}()),m=!1),i=p.startTime),m&&h.set(u,{startTime:i,endTime:s}),e.options&&function Rhe(n,t,e){const r=t.params||{},s=zj(n);s.length&&s.forEach(i=>{r.hasOwnProperty(i)||e.push(function Y9e(n){return new Ne(3001,!1)}())})}(c,e.options,e.errors)})})}visitKeyframes(t,e){const r={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function she(){return new Ne(3011,!1)}()),r;let i=0;const o=[];let c=!1,u=!1,h=0;const p=t.steps.map(ee=>{const ve=this._makeStyleAst(ee,e);let te=null!=ve.offset?ve.offset:function Xhe(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const r=e;t=parseFloat(r.get("offset")),r.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(ve.styles),Ie=0;return null!=te&&(i++,Ie=ve.offset=te),u=u||Ie<0||Ie>1,c=c||Ie<h,h=Ie,o.push(Ie),ve});u&&e.errors.push(function ihe(){return new Ne(3012,!1)}()),c&&e.errors.push(function ohe(){return new Ne(3200,!1)}());const m=t.steps.length;let C=0;i>0&&i<m?e.errors.push(function ahe(){return new Ne(3202,!1)}()):0==i&&(C=1/(m-1));const w=m-1,I=e.currentTime,H=e.currentAnimateTimings,Y=H.duration;return p.forEach((ee,ve)=>{const te=C>0?ve==w?1:C*ve:o[ve],Ie=te*Y;e.currentTime=I+H.delay+Ie,H.duration=Ie,this._validateStyleAst(ee,e),ee.offset=te,r.styles.push(ee)}),r}visitReference(t,e){return{type:8,animation:Da(this,Hp(t.animation),e),options:wu(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:wu(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:wu(t.options)}}visitQuery(t,e){const r=e.currentQuerySelector,s=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function Zhe(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(qhe,"")),n=n.replace(/@\*/g,aE).replace(/@\w+/g,e=>aE+"-"+e.slice(1)).replace(/:animating/g,lA),[n,t]}(t.selector);e.currentQuerySelector=r.length?r+" "+i:i,Ra(e.collectedStyles,e.currentQuerySelector,new Map);const c=Da(this,Hp(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=r,{type:11,selector:i,limit:s.limit||0,optional:!!s.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:wu(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function che(){return new Ne(3013,!1)}());const r="full"===t.timings?{duration:0,delay:0,easing:"full"}:cE(t.timings,e.errors,!0);return{type:12,animation:Da(this,Hp(t.animation),e),timings:r,options:null}}}class Khe{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function wu(n){return n?(n=Vp(n)).params&&(n.params=function Yhe(n){return n?Vp(n):null}(n.params)):n={},n}function pA(n,t,e){return{duration:n,delay:t,easing:e}}function gA(n,t,e,r,s,i,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:r,duration:s,delay:i,totalTime:s+i,easing:o,subTimeline:c}}class gE{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let r=this._map.get(t);r||this._map.set(t,r=[]),r.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const tde=new RegExp(":enter","g"),rde=new RegExp(":leave","g");function mA(n,t,e,r,s,i=new Map,o=new Map,c,u,h=[]){return(new sde).buildKeyframes(n,t,e,r,s,i,o,c,u,h)}class sde{buildKeyframes(t,e,r,s,i,o,c,u,h,p=[]){h=h||new gE;const m=new _A(t,e,h,s,i,p,[]);m.options=u;const C=u.delay?kl(u.delay):0;m.currentTimeline.delayNextStep(C),m.currentTimeline.setStyles([o],null,m.errors,u),Da(this,r,m);const w=m.timelines.filter(I=>I.containsAnimation());if(w.length&&c.size){let I;for(let H=w.length-1;H>=0;H--){const Y=w[H];if(Y.element===e){I=Y;break}}I&&!I.allowOnlyTimelineStyles()&&I.setStyles([c],null,m.errors,u)}return w.length?w.map(I=>I.buildKeyframes()):[gA(e,[],[],[],0,C,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const r=e.subInstructions.get(e.element);if(r){const s=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(r,s,s.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const r=e.createSubContext(t.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,r),this.visitReference(t.animation,r),e.transformIntoNewTimeline(r.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,r){for(const s of t){const i=s?.delay;if(i){const o="number"==typeof i?i:kl(Fp(i,s?.params??{},e.errors));r.delayNextStep(o)}}}_visitSubInstructions(t,e,r){let i=e.currentTimeline.currentTime;const o=null!=r.duration?kl(r.duration):null,c=null!=r.delay?kl(r.delay):null;return 0!==o&&t.forEach(u=>{const h=e.appendInstructionToTimeline(u,o,c);i=Math.max(i,h.duration+h.delay)}),i}visitReference(t,e){e.updateOptions(t.options,!0),Da(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const r=e.subContextCount;let s=e;const i=t.options;if(i&&(i.params||i.delay)&&(s=e.createSubContext(i),s.transformIntoNewTimeline(),null!=i.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=mE);const o=kl(i.delay);s.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>Da(this,o,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>r&&s.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const r=[];let s=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?kl(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);i&&c.delayNextStep(i),Da(this,o,c),s=Math.max(s,c.currentTimeline.currentTime),r.push(c.currentTimeline)}),r.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(s),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const r=t.strValue;return cE(e.params?Fp(r,e.params,e.errors):r,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const r=e.currentAnimateTimings=this._visitTiming(t.timings,e),s=e.currentTimeline;r.delay&&(e.incrementTime(r.delay),s.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(r.duration),this.visitStyle(i,e),s.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const r=e.currentTimeline,s=e.currentAnimateTimings;!s&&r.hasCurrentStyleProperties()&&r.forwardFrame();const i=s&&s.easing||t.easing;t.isEmptyStep?r.applyEmptyStep(i):r.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const r=e.currentAnimateTimings,s=e.currentTimeline.duration,i=r.duration,c=e.createSubContext().currentTimeline;c.easing=r.easing,t.styles.forEach(u=>{c.forwardTime((u.offset||0)*i),c.setStyles(u.styles,u.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(s+i),e.previousNode=t}visitQuery(t,e){const r=e.currentTimeline.currentTime,s=t.options||{},i=s.delay?kl(s.delay):0;i&&(6===e.previousNode.type||0==r&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=mE);let o=r;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!s.optional,e.errors);e.currentQueryTotal=c.length;let u=null;c.forEach((h,p)=>{e.currentQueryIndex=p;const m=e.createSubContext(t.options,h);i&&m.delayNextStep(i),h===e.element&&(u=m.currentTimeline),Da(this,t.animation,m),m.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,m.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),u&&(e.currentTimeline.mergeTimelineCollectedStyles(u),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const r=e.parentContext,s=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),c=o*(e.currentQueryTotal-1);let u=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":u=c-u;break;case"full":u=r.currentStaggerTime}const p=e.currentTimeline;u&&p.delayNextStep(u);const m=p.currentTime;Da(this,t.animation,e),e.previousNode=t,r.currentStaggerTime=s.currentTime-m+(s.startTime-r.currentTimeline.startTime)}}const mE={};class _A{constructor(t,e,r,s,i,o,c,u){this._driver=t,this.element=e,this.subInstructions=r,this._enterClassName=s,this._leaveClassName=i,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=mE,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=u||new _E(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const r=t;let s=this.options;null!=r.duration&&(s.duration=kl(r.duration)),null!=r.delay&&(s.delay=kl(r.delay));const i=r.params;if(i){let o=s.params;o||(o=this.options.params={}),Object.keys(i).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=Fp(i[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const r=t.params={};Object.keys(e).forEach(s=>{r[s]=e[s]})}}return t}createSubContext(t=null,e,r){const s=e||this.element,i=new _A(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,r||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=mE,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,r){const s={duration:e??t.duration,delay:this.currentTimeline.currentTime+(r??0)+t.delay,easing:""},i=new ide(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,s,t.stretchStartingKeyframe);return this.timelines.push(i),s}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,r,s,i,o){let c=[];if(s&&c.push(this.element),t.length>0){t=(t=t.replace(tde,"."+this._enterClassName)).replace(rde,"."+this._leaveClassName);let h=this._driver.query(this.element,t,1!=r);0!==r&&(h=r<0?h.slice(h.length+r,h.length):h.slice(0,r)),c.push(...h)}return!i&&0==c.length&&o.push(function lhe(n){return new Ne(3014,!1)}()),c}}class _E{constructor(t,e,r,s){this._driver=t,this.element=e,this.startTime=r,this._elementTimelineStylesLookup=s,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new _E(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,r]of this._globalTimelineStyles)this._backFill.set(e,r||xl),this._currentKeyframe.set(e,xl);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,r,s){e&&this._previousKeyframe.set("easing",e);const i=s&&s.params||{},o=function ode(n,t){const e=new Map;let r;return n.forEach(s=>{if("*"===s){r=r||t.keys();for(let i of r)e.set(i,xl)}else M0(s,e)}),e}(t,this._globalTimelineStyles);for(let[c,u]of o){const h=Fp(u,i,r);this._pendingStyles.set(c,h),this._localTimelineStyles.has(c)||this._backFill.set(c,this._globalTimelineStyles.get(c)??xl),this._updateStyle(c,h)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,r)=>{const s=this._styleSummary.get(r);(!s||e.time>s.time)&&this._updateStyle(r,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,r=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((c,u)=>{const h=M0(c,new Map,this._backFill);h.forEach((p,m)=>{"!"===p?t.add(m):p===xl&&e.add(m)}),r||h.set("offset",u/this.duration),s.push(h)});const i=t.size?lE(t.values()):[],o=e.size?lE(e.values()):[];if(r){const c=s[0],u=new Map(c);c.set("offset",0),u.set("offset",1),s=[c,u]}return gA(this.element,s,i,o,this.duration,this.startTime,this.easing,!1)}}class ide extends _E{constructor(t,e,r,s,i,o,c=!1){super(t,e,o.delay),this.keyframes=r,this.preStyleProps=s,this.postStyleProps=i,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:r,easing:s}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=r+e,c=e/o,u=M0(t[0]);u.set("offset",0),i.push(u);const h=M0(t[0]);h.set("offset",$j(c)),i.push(h);const p=t.length-1;for(let m=1;m<=p;m++){let C=M0(t[m]);const w=C.get("offset");C.set("offset",$j((e+w*r)/o)),i.push(C)}r=o,e=0,s="",t=i}return gA(this.element,t,this.preStyleProps,this.postStyleProps,r,e,s,!0)}}function $j(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class vA{}const ade=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class cde extends vA{normalizePropertyName(t,e){return hA(t)}normalizeStyleValue(t,e,r,s){let i="";const o=r.toString().trim();if(ade.has(e)&&0!==r&&"0"!==r)if("number"==typeof r)i="px";else{const c=r.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&s.push(function Q9e(n,t){return new Ne(3005,!1)}())}return o+i}}function Uj(n,t,e,r,s,i,o,c,u,h,p,m,C){return{type:0,element:n,triggerName:t,isRemovalTransition:s,fromState:e,fromStyles:i,toState:r,toStyles:o,timelines:c,queriedElements:u,preStyleProps:h,postStyleProps:p,totalTime:m,errors:C}}const CA={};class Gj{constructor(t,e,r){this._triggerName=t,this.ast=e,this._stateStyles=r}match(t,e,r,s){return function lde(n,t,e,r,s){return n.some(i=>i(t,e,r,s))}(this.ast.matchers,t,e,r,s)}buildStyles(t,e,r){let s=this._stateStyles.get("*");return void 0!==t&&(s=this._stateStyles.get(t?.toString())||s),s?s.buildStyles(e,r):new Map}build(t,e,r,s,i,o,c,u,h,p){const m=[],C=this.ast.options&&this.ast.options.params||CA,I=this.buildStyles(r,c&&c.params||CA,m),H=u&&u.params||CA,Y=this.buildStyles(s,H,m),ee=new Set,ve=new Map,te=new Map,Ie="void"===s,Be={params:ude(H,C),delay:this.ast.options?.delay},Ye=p?[]:mA(t,e,this.ast.animation,i,o,I,Y,Be,h,m);let Vt=0;if(Ye.forEach(b1=>{Vt=Math.max(b1.duration+b1.delay,Vt)}),m.length)return Uj(e,this._triggerName,r,s,Ie,I,Y,[],[],ve,te,Vt,m);Ye.forEach(b1=>{const rs=b1.element,Bc=Ra(ve,rs,new Set);b1.preStyleProps.forEach(D2=>Bc.add(D2));const Fo=Ra(te,rs,new Set);b1.postStyleProps.forEach(D2=>Fo.add(D2)),rs!==e&&ee.add(rs)});const R1=lE(ee.values());return Uj(e,this._triggerName,r,s,Ie,I,Y,Ye,R1,ve,te,Vt)}}function ude(n,t){const e=Vp(t);for(const r in n)n.hasOwnProperty(r)&&null!=n[r]&&(e[r]=n[r]);return e}class fde{constructor(t,e,r){this.styles=t,this.defaultParams=e,this.normalizer=r}buildStyles(t,e){const r=new Map,s=Vp(this.defaultParams);return Object.keys(t).forEach(i=>{const o=t[i];null!==o&&(s[i]=o)}),this.styles.styles.forEach(i=>{"string"!=typeof i&&i.forEach((o,c)=>{o&&(o=Fp(o,s,e));const u=this.normalizer.normalizePropertyName(c,e);o=this.normalizer.normalizeStyleValue(c,u,o,e),r.set(u,o)})}),r}}class dde{constructor(t,e,r){this.name=t,this.ast=e,this._normalizer=r,this.transitionFactories=[],this.states=new Map,e.states.forEach(s=>{this.states.set(s.name,new fde(s.style,s.options&&s.options.params||{},r))}),Wj(this.states,"true","1"),Wj(this.states,"false","0"),e.transitions.forEach(s=>{this.transitionFactories.push(new Gj(t,s,this.states))}),this.fallbackTransition=function pde(n,t,e){return new Gj(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,r,s){return this.transitionFactories.find(o=>o.match(t,e,r,s))||null}matchStyles(t,e,r){return this.fallbackTransition.buildStyles(t,e,r)}}function Wj(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const gde=new gE;class mde{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const r=[],i=dA(this._driver,e,r,[]);if(r.length)throw function mhe(n){return new Ne(3503,!1)}();this._animations.set(t,i)}_buildPlayer(t,e,r){const s=t.element,i=Sj(0,this._normalizer,0,t.keyframes,e,r);return this._driver.animate(s,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,r={}){const s=[],i=this._animations.get(t);let o;const c=new Map;if(i?(o=mA(this._driver,e,i,cA,iE,new Map,new Map,r,gde,s),o.forEach(p=>{const m=Ra(c,p.element,new Map);p.postStyleProps.forEach(C=>m.set(C,null))})):(s.push(function _he(){return new Ne(3300,!1)}()),o=[]),s.length)throw function vhe(n){return new Ne(3504,!1)}();c.forEach((p,m)=>{p.forEach((C,w)=>{p.set(w,this._driver.computeStyle(m,w,xl))})});const h=E0(o.map(p=>{const m=c.get(p.element);return this._buildPlayer(p,new Map,m)}));return this._playersById.set(t,h),h.onDestroy(()=>this.destroy(t)),this.players.push(h),h}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const r=this.players.indexOf(e);r>=0&&this.players.splice(r,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function Che(n){return new Ne(3301,!1)}();return e}listen(t,e,r,s){const i=sA(e,"","","");return nA(this._getPlayer(t),r,i,s),()=>{}}command(t,e,r,s){if("register"==r)return void this.register(t,s[0]);if("create"==r)return void this.create(t,e,s[0]||{});const i=this._getPlayer(t);switch(r){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(t)}}}const qj="ng-animate-queued",yA="ng-animate-disabled",Ede=[],jj={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Mde={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Sc="__ng_removed";class EA{constructor(t,e=""){this.namespaceId=e;const r=t&&t.hasOwnProperty("value");if(this.value=function wde(n){return n??null}(r?t.value:t),r){const i=Vp(t);delete i.value,this.options=i}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const r=this.options.params;Object.keys(e).forEach(s=>{null==r[s]&&(r[s]=e[s])})}}}const Bp="void",MA=new EA(Bp);class Sde{constructor(t,e,r){this.id=t,this.hostElement=e,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Pc(e,this._hostClassName)}listen(t,e,r,s){if(!this._triggers.has(e))throw function yhe(n,t){return new Ne(3302,!1)}();if(null==r||0==r.length)throw function Ehe(n){return new Ne(3303,!1)}();if(!function bde(n){return"start"==n||"done"==n}(r))throw function Mhe(n,t){return new Ne(3400,!1)}();const i=Ra(this._elementListeners,t,[]),o={name:e,phase:r,callback:s};i.push(o);const c=Ra(this._engine.statesByElement,t,new Map);return c.has(e)||(Pc(t,oE),Pc(t,oE+"-"+e),c.set(e,MA)),()=>{this._engine.afterFlush(()=>{const u=i.indexOf(o);u>=0&&i.splice(u,1),this._triggers.has(e)||c.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function She(n){return new Ne(3401,!1)}();return e}trigger(t,e,r,s=!0){const i=this._getTrigger(e),o=new SA(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(Pc(t,oE),Pc(t,oE+"-"+e),this._engine.statesByElement.set(t,c=new Map));let u=c.get(e);const h=new EA(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&u&&h.absorbOptions(u.options),c.set(e,h),u||(u=MA),h.value!==Bp&&u.value===h.value){if(!function Ade(n,t){const e=Object.keys(n),r=Object.keys(t);if(e.length!=r.length)return!1;for(let s=0;s<e.length;s++){const i=e[s];if(!t.hasOwnProperty(i)||n[i]!==t[i])return!1}return!0}(u.params,h.params)){const H=[],Y=i.matchStyles(u.value,u.params,H),ee=i.matchStyles(h.value,h.params,H);H.length?this._engine.reportError(H):this._engine.afterFlush(()=>{Tu(t,Y),v4(t,ee)})}return}const C=Ra(this._engine.playersByElement,t,[]);C.forEach(H=>{H.namespaceId==this.id&&H.triggerName==e&&H.queued&&H.destroy()});let w=i.matchTransition(u.value,h.value,t,h.params),I=!1;if(!w){if(!s)return;w=i.fallbackTransition,I=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:w,fromState:u,toState:h,player:o,isFallbackTransition:I}),I||(Pc(t,qj),o.onStart(()=>{df(t,qj)})),o.onDone(()=>{let H=this.players.indexOf(o);H>=0&&this.players.splice(H,1);const Y=this._engine.playersByElement.get(t);if(Y){let ee=Y.indexOf(o);ee>=0&&Y.splice(ee,1)}}),this.players.push(o),C.push(o),o}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,r)=>{this._elementListeners.set(r,e.filter(s=>s.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(r=>r.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const r=this._engine.driver.query(t,aE,!0);r.forEach(s=>{if(s[Sc])return;const i=this._engine.fetchNamespacesByElement(s);i.size?i.forEach(o=>o.triggerLeaveAnimation(s,e,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(t,e,r,s){const i=this._engine.statesByElement.get(t),o=new Map;if(i){const c=[];if(i.forEach((u,h)=>{if(o.set(h,u.value),this._triggers.has(h)){const p=this.trigger(t,h,Bp,s);p&&c.push(p)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),r&&E0(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),r=this._engine.statesByElement.get(t);if(e&&r){const s=new Set;e.forEach(i=>{const o=i.name;if(s.has(o))return;s.add(o);const u=this._triggers.get(o).fallbackTransition,h=r.get(o)||MA,p=new EA(Bp),m=new SA(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:u,fromState:h,toState:p,player:m,isFallbackTransition:!0})})}}removeNode(t,e){const r=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let s=!1;if(r.totalAnimations){const i=r.players.length?r.playersByQueriedElement.get(t):[];if(i&&i.length)s=!0;else{let o=t;for(;o=o.parentNode;)if(r.statesByElement.get(o)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(t),s)r.markElementAsRemoved(this.id,t,!1,e);else{const i=t[Sc];(!i||i===jj)&&(r.afterFlush(()=>this.clearElementCache(t)),r.destroyInnerAnimations(t),r._onRemovalComplete(t,e))}}insertNode(t,e){Pc(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(r=>{const s=r.player;if(s.destroyed)return;const i=r.element,o=this._elementListeners.get(i);o&&o.forEach(c=>{if(c.name==r.triggerName){const u=sA(i,r.triggerName,r.fromState.value,r.toState.value);u._data=t,nA(r.player,c.phase,u,c.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):e.push(r)}),this._queue=[],e.sort((r,s)=>{const i=r.transition.ast.depCount,o=s.transition.ast.depCount;return 0==i||0==o?i-o:this._engine.driver.containsElement(r.element,s.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(r=>r.element===t)||e,e}}class Pde{constructor(t,e,r){this.bodyNode=t,this.driver=e,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,i)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(r=>{r.queued&&t.push(r)})}),t}createNamespace(t,e){const r=new Sde(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(r,e):(this.newHostElements.set(e,r),this.collectEnterElement(e)),this._namespaceLookup[t]=r}_balanceNamespaceList(t,e){const r=this._namespaceList,s=this.namespacesByHostElement;if(r.length-1>=0){let o=!1,c=this.driver.getParentElement(e);for(;c;){const u=s.get(c);if(u){const h=r.indexOf(u);r.splice(h+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}o||r.unshift(t)}else r.push(t);return s.set(e,t),t}register(t,e){let r=this._namespaceLookup[t];return r||(r=this.createNamespace(t,e)),r}registerTrigger(t,e,r){let s=this._namespaceLookup[t];s&&s.register(e,r)&&this.totalAnimations++}destroy(t,e){if(!t)return;const r=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[t];const s=this._namespaceList.indexOf(r);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>r.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,r=this.statesByElement.get(t);if(r)for(let s of r.values())if(s.namespaceId){const i=this._fetchNamespace(s.namespaceId);i&&e.add(i)}return e}trigger(t,e,r,s){if(vE(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,r,s),!0}return!1}insertNode(t,e,r,s){if(!vE(e))return;const i=e[Sc];if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,r)}s&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Pc(t,yA)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),df(t,yA))}removeNode(t,e,r,s){if(vE(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,s):this.markElementAsRemoved(t,e,!1,s),r){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,s)}}else this._onRemovalComplete(e,s)}markElementAsRemoved(t,e,r,s,i){this.collectedLeaveElements.push(e),e[Sc]={namespaceId:t,setForRemoval:s,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:i}}listen(t,e,r,s,i){return vE(e)?this._fetchNamespace(t).listen(e,r,s,i):()=>{}}_buildInstruction(t,e,r,s,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,r,s,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,aE,!0);e.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,lA,!0),e.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return E0(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[Sc];if(e&&e.setForRemoval){if(t[Sc]=jj,e.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(e.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(yA)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,s)=>this._balanceNamespaceList(r,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Pc(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{e=this._flushAnimations(r,t)}finally{for(let s=0;s<r.length;s++)r[s]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],e.length?E0(e).onDone(()=>{r.forEach(s=>s())}):r.forEach(s=>s())}}reportError(t){throw function Phe(n){return new Ne(3402,!1)}()}_flushAnimations(t,e){const r=new gE,s=[],i=new Map,o=[],c=new Map,u=new Map,h=new Map,p=new Set;this.disabledNodes.forEach(Et=>{p.add(Et);const Gt=this.driver.query(Et,".ng-animate-queued",!0);for(let Kt=0;Kt<Gt.length;Kt++)p.add(Gt[Kt])});const m=this.bodyNode,C=Array.from(this.statesByElement.keys()),w=Kj(C,this.collectedEnterElements),I=new Map;let H=0;w.forEach((Et,Gt)=>{const Kt=cA+H++;I.set(Gt,Kt),Et.forEach(s1=>Pc(s1,Kt))});const Y=[],ee=new Set,ve=new Set;for(let Et=0;Et<this.collectedLeaveElements.length;Et++){const Gt=this.collectedLeaveElements[Et],Kt=Gt[Sc];Kt&&Kt.setForRemoval&&(Y.push(Gt),ee.add(Gt),Kt.hasAnimation?this.driver.query(Gt,".ng-star-inserted",!0).forEach(s1=>ee.add(s1)):ve.add(Gt))}const te=new Map,Ie=Kj(C,Array.from(ee));Ie.forEach((Et,Gt)=>{const Kt=iE+H++;te.set(Gt,Kt),Et.forEach(s1=>Pc(s1,Kt))}),t.push(()=>{w.forEach((Et,Gt)=>{const Kt=I.get(Gt);Et.forEach(s1=>df(s1,Kt))}),Ie.forEach((Et,Gt)=>{const Kt=te.get(Gt);Et.forEach(s1=>df(s1,Kt))}),Y.forEach(Et=>{this.processLeaveNode(Et)})});const Be=[],Ye=[];for(let Et=this._namespaceList.length-1;Et>=0;Et--)this._namespaceList[Et].drainQueuedTransitions(e).forEach(Kt=>{const s1=Kt.player,Wt=Kt.element;if(Be.push(s1),this.collectedEnterElements.length){const so=Wt[Sc];if(so&&so.setForMove){if(so.previousTriggersValues&&so.previousTriggersValues.has(Kt.triggerName)){const S5=so.previousTriggersValues.get(Kt.triggerName),$c=this.statesByElement.get(Kt.element);if($c&&$c.has(Kt.triggerName)){const jP=$c.get(Kt.triggerName);jP.value=S5,$c.set(Kt.triggerName,jP)}}return void s1.destroy()}}const G4=!m||!this.driver.containsElement(m,Wt),ec=te.get(Wt),c8=I.get(Wt),ss=this._buildInstruction(Kt,r,c8,ec,G4);if(ss.errors&&ss.errors.length)return void Ye.push(ss);if(G4)return s1.onStart(()=>Tu(Wt,ss.fromStyles)),s1.onDestroy(()=>v4(Wt,ss.toStyles)),void s.push(s1);if(Kt.isFallbackTransition)return s1.onStart(()=>Tu(Wt,ss.fromStyles)),s1.onDestroy(()=>v4(Wt,ss.toStyles)),void s.push(s1);const r4e=[];ss.timelines.forEach(so=>{so.stretchStartingKeyframe=!0,this.disabledNodes.has(so.element)||r4e.push(so)}),ss.timelines=r4e,r.append(Wt,ss.timelines),o.push({instruction:ss,player:s1,element:Wt}),ss.queriedElements.forEach(so=>Ra(c,so,[]).push(s1)),ss.preStyleProps.forEach((so,S5)=>{if(so.size){let $c=u.get(S5);$c||u.set(S5,$c=new Set),so.forEach((jP,GH)=>$c.add(GH))}}),ss.postStyleProps.forEach((so,S5)=>{let $c=h.get(S5);$c||h.set(S5,$c=new Set),so.forEach((jP,GH)=>$c.add(GH))})});if(Ye.length){const Et=[];Ye.forEach(Gt=>{Et.push(function The(n,t){return new Ne(3505,!1)}())}),Be.forEach(Gt=>Gt.destroy()),this.reportError(Et)}const Vt=new Map,R1=new Map;o.forEach(Et=>{const Gt=Et.element;r.has(Gt)&&(R1.set(Gt,Gt),this._beforeAnimationBuild(Et.player.namespaceId,Et.instruction,Vt))}),s.forEach(Et=>{const Gt=Et.element;this._getPreviousPlayers(Gt,!1,Et.namespaceId,Et.triggerName,null).forEach(s1=>{Ra(Vt,Gt,[]).push(s1),s1.destroy()})});const b1=Y.filter(Et=>Qj(Et,u,h)),rs=new Map;Yj(rs,this.driver,ve,h,xl).forEach(Et=>{Qj(Et,u,h)&&b1.push(Et)});const Fo=new Map;w.forEach((Et,Gt)=>{Yj(Fo,this.driver,new Set(Et),u,"!")}),b1.forEach(Et=>{const Gt=rs.get(Et),Kt=Fo.get(Et);rs.set(Et,new Map([...Array.from(Gt?.entries()??[]),...Array.from(Kt?.entries()??[])]))});const D2=[],Zn=[],g6={};o.forEach(Et=>{const{element:Gt,player:Kt,instruction:s1}=Et;if(r.has(Gt)){if(p.has(Gt))return Kt.onDestroy(()=>v4(Gt,s1.toStyles)),Kt.disabled=!0,Kt.overrideTotalTime(s1.totalTime),void s.push(Kt);let Wt=g6;if(R1.size>1){let ec=Gt;const c8=[];for(;ec=ec.parentNode;){const ss=R1.get(ec);if(ss){Wt=ss;break}c8.push(ec)}c8.forEach(ss=>R1.set(ss,Wt))}const G4=this._buildAnimation(Kt.namespaceId,s1,Vt,i,Fo,rs);if(Kt.setRealPlayer(G4),Wt===g6)D2.push(Kt);else{const ec=this.playersByElement.get(Wt);ec&&ec.length&&(Kt.parentPlayer=E0(ec)),s.push(Kt)}}else Tu(Gt,s1.fromStyles),Kt.onDestroy(()=>v4(Gt,s1.toStyles)),Zn.push(Kt),p.has(Gt)&&s.push(Kt)}),Zn.forEach(Et=>{const Gt=i.get(Et.element);if(Gt&&Gt.length){const Kt=E0(Gt);Et.setRealPlayer(Kt)}}),s.forEach(Et=>{Et.parentPlayer?Et.syncPlayerEvents(Et.parentPlayer):Et.destroy()});for(let Et=0;Et<Y.length;Et++){const Gt=Y[Et],Kt=Gt[Sc];if(df(Gt,iE),Kt&&Kt.hasAnimation)continue;let s1=[];if(c.size){let G4=c.get(Gt);G4&&G4.length&&s1.push(...G4);let ec=this.driver.query(Gt,lA,!0);for(let c8=0;c8<ec.length;c8++){let ss=c.get(ec[c8]);ss&&ss.length&&s1.push(...ss)}}const Wt=s1.filter(G4=>!G4.destroyed);Wt.length?Ode(this,Gt,Wt):this.processLeaveNode(Gt)}return Y.length=0,D2.forEach(Et=>{this.players.push(Et),Et.onDone(()=>{Et.destroy();const Gt=this.players.indexOf(Et);this.players.splice(Gt,1)}),Et.play()}),D2}elementContainsData(t,e){let r=!1;const s=e[Sc];return s&&s.setForRemoval&&(r=!0),this.playersByElement.has(e)&&(r=!0),this.playersByQueriedElement.has(e)&&(r=!0),this.statesByElement.has(e)&&(r=!0),this._fetchNamespace(t).elementContainsData(e)||r}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,r,s,i){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const u=!i||i==Bp;c.forEach(h=>{h.queued||!u&&h.triggerName!=s||o.push(h)})}}return(r||s)&&(o=o.filter(c=>!(r&&r!=c.namespaceId||s&&s!=c.triggerName))),o}_beforeAnimationBuild(t,e,r){const i=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const u of e.timelines){const h=u.element,p=h!==i,m=Ra(r,h,[]);this._getPreviousPlayers(h,p,o,c,e.toState).forEach(w=>{const I=w.getRealPlayer();I.beforeDestroy&&I.beforeDestroy(),w.destroy(),m.push(w)})}Tu(i,e.fromStyles)}_buildAnimation(t,e,r,s,i,o){const c=e.triggerName,u=e.element,h=[],p=new Set,m=new Set,C=e.timelines.map(I=>{const H=I.element;p.add(H);const Y=H[Sc];if(Y&&Y.removedBeforeQueried)return new zp(I.duration,I.delay);const ee=H!==u,ve=function Nde(n){const t=[];return Xj(n,t),t}((r.get(H)||Ede).map(Vt=>Vt.getRealPlayer())).filter(Vt=>!!Vt.element&&Vt.element===H),te=i.get(H),Ie=o.get(H),Be=Sj(0,this._normalizer,0,I.keyframes,te,Ie),Ye=this._buildPlayer(I,Be,ve);if(I.subTimeline&&s&&m.add(H),ee){const Vt=new SA(t,c,H);Vt.setRealPlayer(Ye),h.push(Vt)}return Ye});h.forEach(I=>{Ra(this.playersByQueriedElement,I.element,[]).push(I),I.onDone(()=>function Tde(n,t,e){let r=n.get(t);if(r){if(r.length){const s=r.indexOf(e);r.splice(s,1)}0==r.length&&n.delete(t)}return r}(this.playersByQueriedElement,I.element,I))}),p.forEach(I=>Pc(I,xj));const w=E0(C);return w.onDestroy(()=>{p.forEach(I=>df(I,xj)),v4(u,e.toStyles)}),m.forEach(I=>{Ra(s,I,[]).push(w)}),w}_buildPlayer(t,e,r){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,r):new zp(t.duration,t.delay)}}class SA{constructor(t,e,r){this.namespaceId=t,this.triggerName=e,this.element=r,this._player=new zp,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,r)=>{e.forEach(s=>nA(t,r,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Ra(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function vE(n){return n&&1===n.nodeType}function Zj(n,t){const e=n.style.display;return n.style.display=t??"none",e}function Yj(n,t,e,r,s){const i=[];e.forEach(u=>i.push(Zj(u)));const o=[];r.forEach((u,h)=>{const p=new Map;u.forEach(m=>{const C=t.computeStyle(h,m,s);p.set(m,C),(!C||0==C.length)&&(h[Sc]=Mde,o.push(h))}),n.set(h,p)});let c=0;return e.forEach(u=>Zj(u,i[c++])),o}function Kj(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const s=new Set(t),i=new Map;function o(c){if(!c)return 1;let u=i.get(c);if(u)return u;const h=c.parentNode;return u=e.has(h)?h:s.has(h)?1:o(h),i.set(c,u),u}return t.forEach(c=>{const u=o(c);1!==u&&e.get(u).push(c)}),e}function Pc(n,t){n.classList?.add(t)}function df(n,t){n.classList?.remove(t)}function Ode(n,t,e){E0(e).onDone(()=>n.processLeaveNode(t))}function Xj(n,t){for(let e=0;e<n.length;e++){const r=n[e];r instanceof Ej?Xj(r.players,t):t.push(r)}}function Qj(n,t,e){const r=e.get(n);if(!r)return!1;let s=t.get(n);return s?r.forEach(i=>s.add(i)):t.set(n,r),e.delete(n),!0}class CE{constructor(t,e,r){this.bodyNode=t,this._driver=e,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(s,i)=>{},this._transitionEngine=new Pde(t,e,r),this._timelineEngine=new mde(t,e,r),this._transitionEngine.onRemovalComplete=(s,i)=>this.onRemovalComplete(s,i)}registerTrigger(t,e,r,s,i){const o=t+"-"+s;let c=this._triggerCache[o];if(!c){const u=[],p=dA(this._driver,i,u,[]);if(u.length)throw function phe(n,t){return new Ne(3404,!1)}();c=function hde(n,t,e){return new dde(n,t,e)}(s,p,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,s,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,r,s){this._transitionEngine.insertNode(t,e,r,s)}onRemove(t,e,r,s){this._transitionEngine.removeNode(t,e,s||!1,r)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,r,s){if("@"==r.charAt(0)){const[i,o]=Pj(r);this._timelineEngine.command(i,e,o,s)}else this._transitionEngine.trigger(t,e,r,s)}listen(t,e,r,s,i){if("@"==r.charAt(0)){const[o,c]=Pj(r);return this._timelineEngine.listen(o,e,c,i)}return this._transitionEngine.listen(t,e,r,s,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let xde=(()=>{class n{constructor(e,r,s){this._element=e,this._startStyles=r,this._endStyles=s,this._state=0;let i=n.initialStylesByElement.get(e);i||n.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&v4(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(v4(this._element,this._initialStyles),this._endStyles&&(v4(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Tu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Tu(this._element,this._endStyles),this._endStyles=null),v4(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function PA(n){let t=null;return n.forEach((e,r)=>{(function kde(n){return"display"===n||"position"===n})(r)&&(t=t||new Map,t.set(r,e))}),t}class Jj{constructor(t,e,r,s){this.element=t,this.keyframes=e,this.options=r,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(r=>{e.push(Object.fromEntries(r))}),e}_triggerWebAnimation(t,e,r){return t.animate(this._convertKeyframesToObject(e),r)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,s)=>{"offset"!==s&&t.set(s,this._finished?r:Vj(this.element,s))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(r=>r()),e.length=0}}class Lde{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return Oj(t,e)}getParentElement(t){return oA(t)}query(t,e,r){return Nj(t,e,r)}computeStyle(t,e,r){return window.getComputedStyle(t)[e]}animate(t,e,r,s,i,o=[]){const u={duration:r,delay:s,fill:0==s?"both":"forwards"};i&&(u.easing=i);const h=new Map,p=o.filter(w=>w instanceof Jj);(function Vhe(n,t){return 0===n||0===t})(r,s)&&p.forEach(w=>{w.currentSnapshot.forEach((I,H)=>h.set(H,I))});let m=function Lhe(n){return n.length?n[0]instanceof Map?n:n.map(t=>kj(t)):[]}(e).map(w=>M0(w));m=function Hhe(n,t,e){if(e.size&&t.length){let r=t[0],s=[];if(e.forEach((i,o)=>{r.has(o)||s.push(o),r.set(o,i)}),s.length)for(let i=1;i<t.length;i++){let o=t[i];s.forEach(c=>o.set(c,Vj(n,c)))}}return t}(t,m,h);const C=function Ide(n,t){let e=null,r=null;return Array.isArray(t)&&t.length?(e=PA(t[0]),t.length>1&&(r=PA(t[t.length-1]))):t instanceof Map&&(e=PA(t)),e||r?new xde(n,e,r):null}(t,m);return new Jj(t,m,u,C)}}let Rde=(()=>{class n extends _j{constructor(e,r){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(r.body,{id:"0",encapsulation:D1.None,styles:[],data:{animation:[]}})}build(e){const r=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(e)?vj(e):e;return eZ(this._renderer,null,r,"register",[s]),new Dde(r,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(Re(X6),Re(Bs))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class Dde extends class q9e{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new zde(this._id,t,e||{},this._renderer)}}class zde{constructor(t,e,r,s){this.id=t,this.element=e,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return eZ(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function eZ(n,t,e,r,s){return n.setProperty(t,`@@${e}:${r}`,s)}const tZ="@.disabled";let Vde=(()=>{class n{constructor(e,r,s){this.delegate=e,this.engine=r,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(i,o)=>{const c=o?.parentNode(i);c&&o.removeChild(c,i)}}createRenderer(e,r){const i=this.delegate.createRenderer(e,r);if(!(e&&r&&r.data&&r.data.animation)){let p=this._rendererCache.get(i);return p||(p=new nZ("",i,this.engine,()=>this._rendererCache.delete(i)),this._rendererCache.set(i,p)),p}const o=r.id,c=r.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const u=p=>{Array.isArray(p)?p.forEach(u):this.engine.registerTrigger(o,c,e,p.name,p)};return r.data.animation.forEach(u),new Hde(this,c,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,r,s){e>=0&&e<this._microtaskId?this._zone.run(()=>r(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(i=>{const[o,c]=i;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(Re(X6),Re(CE),Re(Pr))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();class nZ{constructor(t,e,r,s){this.namespaceId=t,this.delegate=e,this.engine=r,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?i=>e.destroyNode(i):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,r,s=!0){this.delegate.insertBefore(t,e,r),this.engine.onInsert(this.namespaceId,e,t,s)}removeChild(t,e,r){this.engine.onRemove(this.namespaceId,e,this.delegate,r)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,r,s){this.delegate.setAttribute(t,e,r,s)}removeAttribute(t,e,r){this.delegate.removeAttribute(t,e,r)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,r,s){this.delegate.setStyle(t,e,r,s)}removeStyle(t,e,r){this.delegate.removeStyle(t,e,r)}setProperty(t,e,r){"@"==e.charAt(0)&&e==tZ?this.disableAnimations(t,!!r):this.delegate.setProperty(t,e,r)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,r){return this.delegate.listen(t,e,r)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class Hde extends nZ{constructor(t,e,r,s,i){super(e,r,s,i),this.factory=t,this.namespaceId=e}setProperty(t,e,r){"@"==e.charAt(0)?"."==e.charAt(1)&&e==tZ?this.disableAnimations(t,r=void 0===r||!!r):this.engine.process(this.namespaceId,t,e.slice(1),r):this.delegate.setProperty(t,e,r)}listen(t,e,r){if("@"==e.charAt(0)){const s=function Fde(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let i=e.slice(1),o="";return"@"!=i.charAt(0)&&([i,o]=function Bde(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(i)),this.engine.listen(this.namespaceId,s,i,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,r,c)})}return this.delegate.listen(t,e,r)}}let $de=(()=>{class n extends CE{constructor(e,r,s,i){super(e.body,r,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs),Re(aA),Re(vA),Re(sp))},n.\u0275prov=et({token:n,factory:n.\u0275fac}),n})();const rZ=[{provide:_j,useClass:Rde},{provide:vA,useFactory:function Ude(){return new cde}},{provide:CE,useClass:$de},{provide:X6,useFactory:function Gde(n,t,e){return new Vde(n,t,e)},deps:[My,CE,Pr]}],TA=[{provide:aA,useFactory:()=>new Lde},{provide:vU,useValue:"BrowserAnimations"},...rZ],sZ=[{provide:aA,useClass:Aj},{provide:vU,useValue:"NoopAnimations"},...rZ];let Wde=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?sZ:TA}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({providers:TA,imports:[DG]}),n})();const Ss=void 0,jde=["fr",[["AM","PM"],Ss,Ss],Ss,[["D","L","M","M","J","V","S"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],["di","lu","ma","me","je","ve","sa"]],Ss,[["J","F","M","A","M","J","J","A","S","O","N","D"],["janv.","f\xe9vr.","mars","avr.","mai","juin","juil.","ao\xfbt","sept.","oct.","nov.","d\xe9c."],["janvier","f\xe9vrier","mars","avril","mai","juin","juillet","ao\xfbt","septembre","octobre","novembre","d\xe9cembre"]],Ss,[["av. J.-C.","ap. J.-C."],Ss,["avant J\xe9sus-Christ","apr\xe8s J\xe9sus-Christ"]],1,[6,0],["dd/MM/y","d MMM y","d MMMM y","EEEE d MMMM y"],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1} {0}","{1}, {0}","{1} '\xe0' {0}",Ss],[",","\u202f",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0\xa0%","#,##0.00\xa0\xa4","#E0"],"EUR","\u20ac","euro",{ARS:["$AR","$"],AUD:["$AU","$"],BEF:["FB"],BMD:["$BM","$"],BND:["$BN","$"],BYN:[Ss,"\u0440."],BZD:["$BZ","$"],CAD:["$CA","$"],CLP:["$CL","$"],CNY:[Ss,"\xa5"],COP:["$CO","$"],CYP:["\xa3CY"],EGP:[Ss,"\xa3E"],FJD:["$FJ","$"],FKP:["\xa3FK","\xa3"],FRF:["F"],GBP:["\xa3GB","\xa3"],GIP:["\xa3GI","\xa3"],HKD:[Ss,"$"],IEP:["\xa3IE"],ILP:["\xa3IL"],ITL:["\u20a4IT"],JPY:[Ss,"\xa5"],KMF:[Ss,"FC"],LBP:["\xa3LB","\xa3L"],MTP:["\xa3MT"],MXN:["$MX","$"],NAD:["$NA","$"],NIO:[Ss,"$C"],NZD:["$NZ","$"],PHP:[Ss,"\u20b1"],RHD:["$RH"],RON:[Ss,"L"],RWF:[Ss,"FR"],SBD:["$SB","$"],SGD:["$SG","$"],SRD:["$SR","$"],TOP:[Ss,"$T"],TTD:["$TT","$"],TWD:[Ss,"NT$"],USD:["$US","$"],UYU:["$UY","$"],WST:["$WS"],XCD:[Ss,"$"],XPF:["FCFP"],ZMW:[Ss,"Kw"]},"ltr",function qde(n){const e=Math.floor(Math.abs(n)),r=n.toString().replace(/^[^.]*\.?/,"").length,s=parseInt(n.toString().replace(/^[^e]*(e([-+]?\d+))?/,"$2"))||0;return 0===e||1===e?1:0===s&&0!==e&&e%1e6==0&&0===r||!(s>=0&&s<=5)?4:5}];function iZ(n,t,e,r,s,i,o){try{var c=n[i](o),u=c.value}catch(h){return void e(h)}c.done?t(u):Promise.resolve(u).then(r,s)}function A(n){return function(){var t=this,e=arguments;return new Promise(function(r,s){var i=n.apply(t,e);function o(u){iZ(i,r,s,o,c,"next",u)}function c(u){iZ(i,r,s,o,c,"throw",u)}o(void 0)})}}const oZ=function(n){const t=[];let e=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=63&s|128):55296==(64512&s)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&n.charCodeAt(++r)),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=63&s|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=63&s|128)}return t},bA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,c=o?n[s+1]:0,u=s+2<n.length,h=u?n[s+2]:0;let C=(15&c)<<2|h>>6,w=63&h;u||(w=64,o||(C=64)),r.push(e[i>>2],e[(3&i)<<4|c>>4],e[C],e[w])}return r.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(oZ(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):function(n){const t=[];let e=0,r=0;for(;e<n.length;){const s=n[e++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[e++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const u=((7&s)<<18|(63&n[e++])<<12|(63&n[e++])<<6|63&n[e++])-65536;t[r++]=String.fromCharCode(55296+(u>>10)),t[r++]=String.fromCharCode(56320+(1023&u))}else{const i=n[e++],o=n[e++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const h=s<n.length?e[n.charAt(s)]:64;++s;const m=s<n.length?e[n.charAt(s)]:64;if(++s,null==i||null==c||null==h||null==m)throw Error();r.push(i<<2|c>>4),64!==h&&(r.push(c<<4&240|h>>2),64!==m&&r.push(h<<6&192|m))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},EE=function(n){return function(n){const t=oZ(n);return bA.encodeByteArray(t,!0)}(n).replace(/\./g,"")},ME=function(n){try{return bA.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function Ri(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function OA(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function bu(){return"object"==typeof indexedDB}function $p(){return new Promise((n,t)=>{try{let e=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var i;t((null===(i=s.error)||void 0===i?void 0:i.message)||"")}}catch(e){t(e)}})}function NA(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const AA=()=>{try{return function rpe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&ME(n[1]);return t&&JSON.parse(t)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},cZ=n=>{var t,e;return null===(e=null===(t=AA())||void 0===t?void 0:t.emulatorHosts)||void 0===e?void 0:e[n]},lZ=n=>{var t;return null===(t=AA())||void 0===t?void 0:t[`_${n}`]};class SE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}class Tc extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Tc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C4.prototype.create)}}class C4{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},s=`${this.service}/${t}`,i=this.errors[t],o=i?function fpe(n,t){return n.replace(hpe,(e,r)=>{const s=t[r];return null!=s?String(s):`<${r}?>`})}(i,r):"Error";return new Tc(s,`${this.serviceName}: ${o} (${s}).`,r)}}const hpe=/\{\$([^}]+)}/g;function TE(n,t){if(n===t)return!0;const e=Object.keys(n),r=Object.keys(t);for(const s of e){if(!r.includes(s))return!1;const i=n[s],o=t[s];if(fZ(i)&&fZ(o)){if(!TE(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!e.includes(s))return!1;return!0}function fZ(n){return null!==n&&"object"==typeof n}function Up(n){const t=[];for(const[e,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Gp(n){const t={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");t[decodeURIComponent(s)]=decodeURIComponent(i)}}),t}function Wp(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class gpe{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(r=>{this.error(r)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let s;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");s=function mpe(n,t){if("object"!=typeof n||null===n)return!1;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:r},void 0===s.next&&(s.next=IA),void 0===s.error&&(s.error=IA),void 0===s.complete&&(s.complete=IA);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(t){void 0===this.observers||void 0===this.observers[t]||(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function IA(){}function kA(n,t=1e3,e=2){const r=t*Math.pow(e,n),s=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+s)}function Xr(n){return n&&n._delegate?n._delegate:n}class Z2{constructor(t,e,r){this.name=t,this.instanceFactory=e,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Ou="[DEFAULT]";class Mpe{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const r=new SE;if(this.instancesDeferred.set(e,r),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const r=this.normalizeInstanceIdentifier(t?.identifier),s=null!==(e=t?.optional)&&void 0!==e&&e;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(s)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function Ppe(n){return"EAGER"===n.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:Ou})}catch{}for(const[e,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(t=Ou){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}delete(){var t=this;return A(function*(){const e=Array.from(t.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(t=Ou){return this.instances.has(t)}getOptions(t=Ou){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,r=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:e});for(const[i,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(i)&&o.resolve(s);return s}onInit(t,e){var r;const s=this.normalizeInstanceIdentifier(e),i=null!==(r=this.onInitCallbacks.get(s))&&void 0!==r?r:new Set;i.add(t),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&t(o,s),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const r=this.onInitCallbacks.get(e);if(r)for(const s of r)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===Ou?void 0:n),options:e}),this.instances.set(t,r),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(t=Ou){return this.component?this.component.multipleInstances?t:Ou:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Tpe{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Mpe(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const LA=[];var p1=(()=>{return(n=p1||(p1={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",p1;var n})();const hZ={debug:p1.DEBUG,verbose:p1.VERBOSE,info:p1.INFO,warn:p1.WARN,error:p1.ERROR,silent:p1.SILENT},wpe=p1.INFO,bpe={[p1.DEBUG]:"log",[p1.VERBOSE]:"log",[p1.INFO]:"info",[p1.WARN]:"warn",[p1.ERROR]:"error"},Ope=(n,t,...e)=>{if(t<n.logLevel)return;const r=(new Date).toISOString(),s=bpe[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${r}]  ${n.name}:`,...e)};class pf{constructor(t){this.name=t,this._logLevel=wpe,this._logHandler=Ope,this._userLogHandler=null,LA.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in p1))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?hZ[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,p1.DEBUG,...t),this._logHandler(this,p1.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,p1.VERBOSE,...t),this._logHandler(this,p1.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,p1.INFO,...t),this._logHandler(this,p1.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,p1.WARN,...t),this._logHandler(this,p1.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,p1.ERROR,...t),this._logHandler(this,p1.ERROR,...t)}}let dZ,pZ;const gZ=new WeakMap,RA=new WeakMap,mZ=new WeakMap,DA=new WeakMap,zA=new WeakMap;let VA={get(n,t,e){if(n instanceof IDBTransaction){if("done"===t)return RA.get(n);if("objectStoreNames"===t)return n.objectStoreNames||mZ.get(n);if("store"===t)return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Ll(n[t])},set:(n,t,e)=>(n[t]=e,!0),has:(n,t)=>n instanceof IDBTransaction&&("done"===t||"store"===t)||t in n};function Dpe(n){return"function"==typeof n?function Rpe(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ipe(){return pZ||(pZ=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...t){return n.apply(HA(this),t),Ll(gZ.get(this))}:function(...t){return Ll(n.apply(HA(this),t))}:function(t,...e){const r=n.call(HA(this),t,...e);return mZ.set(r,t.sort?t.sort():[t]),Ll(r)}}(n):(n instanceof IDBTransaction&&function kpe(n){if(RA.has(n))return;const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{e(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});RA.set(n,t)}(n),((n,t)=>t.some(e=>n instanceof e))(n,function Ape(){return dZ||(dZ=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,VA):n)}function Ll(n){if(n instanceof IDBRequest)return function xpe(n){const t=new Promise((e,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{e(Ll(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&gZ.set(e,n)}).catch(()=>{}),zA.set(t,n),t}(n);if(DA.has(n))return DA.get(n);const t=Dpe(n);return t!==n&&(DA.set(n,t),zA.set(t,n)),t}const HA=n=>zA.get(n);function wE(n,t,{blocked:e,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,t),c=Ll(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Ll(o.result),u.oldVersion,u.newVersion,Ll(o.transaction))}),e&&o.addEventListener("blocked",()=>e()),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",()=>s())}).catch(()=>{}),c}function FA(n,{blocked:t}={}){const e=indexedDB.deleteDatabase(n);return t&&e.addEventListener("blocked",()=>t()),Ll(e).then(()=>{})}const zpe=["get","getKey","getAll","getAllKeys","count"],Vpe=["put","add","delete","clear"],BA=new Map;function _Z(n,t){if(!(n instanceof IDBDatabase)||t in n||"string"!=typeof t)return;if(BA.get(t))return BA.get(t);const e=t.replace(/FromIndex$/,""),r=t!==e,s=Vpe.includes(e);if(!(e in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!zpe.includes(e))return;const i=function(){var o=A(function*(c,...u){const h=this.transaction(c,s?"readwrite":"readonly");let p=h.store;return r&&(p=p.index(u.shift())),(yield Promise.all([p[e](...u),s&&h.done]))[0]});return function(u){return o.apply(this,arguments)}}();return BA.set(t,i),i}!function Lpe(n){VA=n(VA)}(n=>({...n,get:(t,e,r)=>_Z(t,e)||n.get(t,e,r),has:(t,e)=>!!_Z(t,e)||n.has(t,e)}));class Hpe{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function Fpe(n){return"VERSION"===n.getComponent()?.type}(e)){const r=e.getImmediate();return`${r.library}/${r.version}`}return null}).filter(e=>e).join(" ")}}const $A="@firebase/app",Nu=new pf("@firebase/app"),bE="[DEFAULT]",hge={[$A]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Au=new Map,OE=new Map;function dge(n,t){try{n.container.addComponent(t)}catch(e){Nu.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Po(n){const t=n.name;if(OE.has(t))return Nu.debug(`There were multiple attempts to register component ${t}.`),!1;OE.set(t,n);for(const e of Au.values())dge(e,n);return!0}function gf(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}const Rl=new C4("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class gge{constructor(t,e,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Z2("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Rl.create("app-deleted",{appName:this._name})}}const mf="9.14.0";function CZ(n,t={}){let e=n;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:bE,automaticDataCollectionEnabled:!1},t),s=r.name;if("string"!=typeof s||!s)throw Rl.create("bad-app-name",{appName:String(s)});if(e||(e=(()=>{var n;return null===(n=AA())||void 0===n?void 0:n.config})()),!e)throw Rl.create("no-options");const i=Au.get(s);if(i){if(TE(e,i.options)&&TE(r,i.config))return i;throw Rl.create("duplicate-app",{appName:s})}const o=new Tpe(s);for(const u of OE.values())o.addComponent(u);const c=new gge(e,r,o);return Au.set(s,c),c}function UA(n=bE){const t=Au.get(n);if(!t&&n===bE)return CZ();if(!t)throw Rl.create("no-app",{appName:n});return t}function yZ(){return Array.from(Au.values())}function ls(n,t,e){var r;let s=null!==(r=hge[n])&&void 0!==r?r:n;e&&(s+=`-${e}`);const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${t}":`];return i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Nu.warn(c.join(" "))}Po(new Z2(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const qp="firebase-heartbeat-store";let WA=null;function EZ(){return WA||(WA=wE("firebase-heartbeat-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(qp)}}).catch(n=>{throw Rl.create("idb-open",{originalErrorMessage:n.message})})),WA}function qA(){return(qA=A(function*(n){var t;try{return(yield EZ()).transaction(qp).objectStore(qp).get(SZ(n))}catch(e){if(e instanceof Tc)Nu.warn(e.message);else{const r=Rl.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});Nu.warn(r.message)}}})).apply(this,arguments)}function MZ(n,t){return jA.apply(this,arguments)}function jA(){return(jA=A(function*(n,t){var e;try{const s=(yield EZ()).transaction(qp,"readwrite");return yield s.objectStore(qp).put(t,SZ(n)),s.done}catch(r){if(r instanceof Tc)Nu.warn(r.message);else{const s=Rl.create("idb-set",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message});Nu.warn(s.message)}}})).apply(this,arguments)}function SZ(n){return`${n.name}!${n.options.appId}`}class Ege{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Sge(e),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var t=this;return A(function*(){const r=t.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=PZ();if(null===t._heartbeatsCache&&(t._heartbeatsCache=yield t._heartbeatsCachePromise),t._heartbeatsCache.lastSentHeartbeatDate!==s&&!t._heartbeatsCache.heartbeats.some(i=>i.date===s))return t._heartbeatsCache.heartbeats.push({date:s,agent:r}),t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter(i=>{const o=new Date(i.date).valueOf();return Date.now()-o<=2592e6}),t._storage.overwrite(t._heartbeatsCache)})()}getHeartbeatsHeader(){var t=this;return A(function*(){if(null===t._heartbeatsCache&&(yield t._heartbeatsCachePromise),null===t._heartbeatsCache||0===t._heartbeatsCache.heartbeats.length)return"";const e=PZ(),{heartbeatsToSend:r,unsentEntries:s}=function Mge(n,t=1024){const e=[];let r=n.slice();for(const s of n){const i=e.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),TZ(e)>t){i.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),TZ(e)>t){e.pop();break}r=r.slice(1)}return{heartbeatsToSend:e,unsentEntries:r}}(t._heartbeatsCache.heartbeats),i=EE(JSON.stringify({version:2,heartbeats:r}));return t._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(t._heartbeatsCache.heartbeats=s,yield t._storage.overwrite(t._heartbeatsCache)):(t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache)),i})()}}function PZ(){return(new Date).toISOString().substring(0,10)}class Sge{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return A(function*(){return!!bu()&&$p().then(()=>!0).catch(()=>!1)})()}read(){var t=this;return A(function*(){return(yield t._canUseIndexedDBPromise)&&(yield function vge(n){return qA.apply(this,arguments)}(t.app))||{heartbeats:[]}})()}overwrite(t){var e=this;return A(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return MZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}})()}add(t){var e=this;return A(function*(){var r;if(yield e._canUseIndexedDBPromise){const i=yield e.read();return MZ(e.app,{lastSentHeartbeatDate:null!==(r=t.lastSentHeartbeatDate)&&void 0!==r?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}})()}}function TZ(n){return EE(JSON.stringify({version:2,heartbeats:n})).length}!function Pge(n){Po(new Z2("platform-logger",t=>new Hpe(t),"PRIVATE")),Po(new Z2("heartbeat",t=>new Ege(t),"PRIVATE")),ls($A,"0.8.4",n),ls($A,"0.8.4","esm2017"),ls("fire-js","")}("");var Ot,Tge=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dl={},ZA=ZA||{},_n=Tge||self;function NE(){}function AE(n){var t=typeof n;return"array"==(t="object"!=t?t:n?Array.isArray(n)?"array":t:"null")||"object"==t&&"number"==typeof n.length}function jp(n){var t=typeof n;return"object"==t&&null!=n||"function"==t}var YA="closure_uid_"+(1e9*Math.random()>>>0),bge=0;function Oge(n,t,e){return n.call.apply(n.bind,arguments)}function Nge(n,t,e){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),n.apply(t,s)}}return function(){return n.apply(t,arguments)}}function Y2(n,t,e){return(Y2=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Oge:Nge).apply(null,arguments)}function IE(n,t){var e=Array.prototype.slice.call(arguments,1);return function(){var r=e.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function _2(n,t){function e(){}e.prototype=t.prototype,n.X=t.prototype,n.prototype=new e,n.prototype.constructor=n,n.Wb=function(r,s,i){for(var o=Array(arguments.length-2),c=2;c<arguments.length;c++)o[c-2]=arguments[c];return t.prototype[s].apply(r,o)}}function S0(){this.s=this.s,this.o=this.o}S0.prototype.s=!1,S0.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function wge(n){Object.prototype.hasOwnProperty.call(n,YA)&&n[YA]||(n[YA]=++bge)}(this)},S0.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const wZ=Array.prototype.indexOf?function(n,t){return Array.prototype.indexOf.call(n,t,void 0)}:function(n,t){if("string"==typeof n)return"string"!=typeof t||1!=t.length?-1:n.indexOf(t,0);for(let e=0;e<n.length;e++)if(e in n&&n[e]===t)return e;return-1};function KA(n){const t=n.length;if(0<t){const e=Array(t);for(let r=0;r<t;r++)e[r]=n[r];return e}return[]}function bZ(n,t){for(let e=1;e<arguments.length;e++){const r=arguments[e];if(AE(r)){const s=n.length||0,i=r.length||0;n.length=s+i;for(let o=0;o<i;o++)n[s+o]=r[o]}else n.push(r)}}function K2(n,t){this.type=n,this.g=this.target=t,this.defaultPrevented=!1}K2.prototype.h=function(){this.defaultPrevented=!0};var Ige=function(){if(!_n.addEventListener||!Object.defineProperty)return!1;var n=!1,t=Object.defineProperty({},"passive",{get:function(){n=!0}});try{_n.addEventListener("test",NE,t),_n.removeEventListener("test",NE,t)}catch{}return n}();function xE(n){return/^[\s\xa0]*$/.test(n)}var OZ=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function XA(n,t){return n<t?-1:n>t?1:0}function kE(){var n=_n.navigator;return n&&(n=n.userAgent)?n:""}function y4(n){return-1!=kE().indexOf(n)}function QA(n){return QA[" "](n),n}QA[" "]=NE;var LE,n,kge=y4("Opera"),_f=y4("Trident")||y4("MSIE"),NZ=y4("Edge"),JA=NZ||_f,AZ=y4("Gecko")&&!(-1!=kE().toLowerCase().indexOf("webkit")&&!y4("Edge"))&&!(y4("Trident")||y4("MSIE"))&&!y4("Edge"),Lge=-1!=kE().toLowerCase().indexOf("webkit")&&!y4("Edge");function IZ(){var n=_n.document;return n?n.documentMode:void 0}e:{var eI="",tI=(n=kE(),AZ?/rv:([^\);]+)(\)|;)/.exec(n):NZ?/Edge\/([\d\.]+)/.exec(n):_f?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):Lge?/WebKit\/(\S+)/.exec(n):kge?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(tI&&(eI=tI?tI[1]:""),_f){var nI=IZ();if(null!=nI&&nI>parseFloat(eI)){LE=String(nI);break e}}LE=eI}var Rge={};var zge=_n.document&&_f&&(IZ()||parseInt(LE,10))||void 0;function Zp(n,t){if(K2.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var e=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=t,t=n.relatedTarget){if(AZ){e:{try{QA(t.nodeName);var s=!0;break e}catch{}s=!1}s||(t=null)}}else"mouseover"==e?t=n.fromElement:"mouseout"==e&&(t=n.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Vge[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Zp.X.h.call(this)}}_2(Zp,K2);var Vge={2:"touch",3:"pen",4:"mouse"};Zp.prototype.h=function(){Zp.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Yp="closure_listenable_"+(1e6*Math.random()|0),Hge=0;function Fge(n,t,e,r,s){this.listener=n,this.proxy=null,this.src=t,this.type=e,this.capture=!!r,this.ha=s,this.key=++Hge,this.ba=this.ea=!1}function RE(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function sI(n,t,e){for(const r in n)t.call(e,n[r],r,n)}function kZ(n){const t={};for(const e in n)t[e]=n[e];return t}const LZ="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function RZ(n,t){let e,r;for(let s=1;s<arguments.length;s++){for(e in r=arguments[s],r)n[e]=r[e];for(let i=0;i<LZ.length;i++)e=LZ[i],Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}}function DE(n){this.src=n,this.g={},this.h=0}function iI(n,t){var e=t.type;if(e in n.g){var i,r=n.g[e],s=wZ(r,t);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(RE(t),0==n.g[e].length&&(delete n.g[e],n.h--))}}function oI(n,t,e,r){for(var s=0;s<n.length;++s){var i=n[s];if(!i.ba&&i.listener==t&&i.capture==!!e&&i.ha==r)return s}return-1}DE.prototype.add=function(n,t,e,r,s){var i=n.toString();(n=this.g[i])||(n=this.g[i]=[],this.h++);var o=oI(n,t,r,s);return-1<o?(t=n[o],e||(t.ea=!1)):((t=new Fge(t,this.src,i,!!r,s)).ea=e,n.push(t)),t};var aI="closure_lm_"+(1e6*Math.random()|0),cI={};function DZ(n,t,e,r,s){if(r&&r.once)return VZ(n,t,e,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)DZ(n,t[i],e,r,s);return null}return e=hI(e),n&&n[Yp]?n.N(t,e,jp(r)?!!r.capture:!!r,s):zZ(n,t,e,!1,r,s)}function zZ(n,t,e,r,s,i){if(!t)throw Error("Invalid event type");var o=jp(s)?!!s.capture:!!s,c=uI(n);if(c||(n[aI]=c=new DE(n)),(e=c.add(t,e,r,o,i)).proxy)return e;if(r=function Bge(){const t=$ge;return function n(e){return t.call(n.src,n.listener,e)}}(),e.proxy=r,r.src=n,r.listener=e,n.addEventListener)Ige||(s=o),void 0===s&&(s=!1),n.addEventListener(t.toString(),r,s);else if(n.attachEvent)n.attachEvent(FZ(t.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return e}function VZ(n,t,e,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)VZ(n,t[i],e,r,s);return null}return e=hI(e),n&&n[Yp]?n.O(t,e,jp(r)?!!r.capture:!!r,s):zZ(n,t,e,!0,r,s)}function HZ(n,t,e,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)HZ(n,t[i],e,r,s);else r=jp(r)?!!r.capture:!!r,e=hI(e),n&&n[Yp]?(n=n.i,(t=String(t).toString())in n.g&&-1<(e=oI(i=n.g[t],e,r,s))&&(RE(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete n.g[t],n.h--))):n&&(n=uI(n))&&(t=n.g[t.toString()],n=-1,t&&(n=oI(t,e,r,s)),(e=-1<n?t[n]:null)&&lI(e))}function lI(n){if("number"!=typeof n&&n&&!n.ba){var t=n.src;if(t&&t[Yp])iI(t.i,n);else{var e=n.type,r=n.proxy;t.removeEventListener?t.removeEventListener(e,r,n.capture):t.detachEvent?t.detachEvent(FZ(e),r):t.addListener&&t.removeListener&&t.removeListener(r),(e=uI(t))?(iI(e,n),0==e.h&&(e.src=null,t[aI]=null)):RE(n)}}}function FZ(n){return n in cI?cI[n]:cI[n]="on"+n}function $ge(n,t){if(n.ba)n=!0;else{t=new Zp(t,this);var e=n.listener,r=n.ha||n.src;n.ea&&lI(n),n=e.call(r,t)}return n}function uI(n){return(n=n[aI])instanceof DE?n:null}var fI="__closure_events_fn_"+(1e9*Math.random()>>>0);function hI(n){return"function"==typeof n?n:(n[fI]||(n[fI]=function(t){return n.handleEvent(t)}),n[fI])}function Di(){S0.call(this),this.i=new DE(this),this.P=this,this.I=null}function v2(n,t){var e,r=n.I;if(r)for(e=[];r;r=r.I)e.push(r);if(n=n.P,r=t.type||t,"string"==typeof t)t=new K2(t,n);else if(t instanceof K2)t.target=t.target||n;else{var s=t;RZ(t=new K2(r,n),s)}if(s=!0,e)for(var i=e.length-1;0<=i;i--){var o=t.g=e[i];s=zE(o,r,!0,t)&&s}if(s=zE(o=t.g=n,r,!0,t)&&s,s=zE(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zE(o=t.g=e[i],r,!1,t)&&s}function zE(n,t,e,r){if(!(t=n.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ba&&o.capture==e){var c=o.listener,u=o.ha||o.src;o.ea&&iI(n.i,o),s=!1!==c.call(u,r)&&s}}return s&&!r.defaultPrevented}_2(Di,S0),Di.prototype[Yp]=!0,Di.prototype.removeEventListener=function(n,t,e,r){HZ(this,n,t,e,r)},Di.prototype.M=function(){if(Di.X.M.call(this),this.i){var t,n=this.i;for(t in n.g){for(var e=n.g[t],r=0;r<e.length;r++)RE(e[r]);delete n.g[t],n.h--}}this.I=null},Di.prototype.N=function(n,t,e,r){return this.i.add(String(n),t,!1,e,r)},Di.prototype.O=function(n,t,e,r){return this.i.add(String(n),t,!0,e,r)};var dI=_n.JSON.stringify;function Uge(){var n=UZ;let t=null;return n.g&&(t=n.g,n.g=n.g.next,n.g||(n.h=null),t.next=null),t}var pI,BZ=new class{constructor(n,t){this.i=n,this.j=t,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new Wge,n=>n.reset());class Wge{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function qge(n){_n.setTimeout(()=>{throw n},0)}function $Z(n,t){pI||function jge(){var n=_n.Promise.resolve(void 0);pI=function(){n.then(Zge)}}(),gI||(pI(),gI=!0),UZ.add(n,t)}var gI=!1,UZ=new class Gge{constructor(){this.h=this.g=null}add(t,e){const r=BZ.get();r.set(t,e),this.h?this.h.next=r:this.g=r,this.h=r}};function Zge(){for(var n;n=Uge();){try{n.h.call(n.g)}catch(e){qge(e)}var t=BZ;t.j(n),100>t.h&&(t.h++,n.next=t.g,t.g=n)}gI=!1}function VE(n,t){Di.call(this),this.h=n||1,this.g=t||_n,this.j=Y2(this.lb,this),this.l=Date.now()}function mI(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function _I(n,t,e){if("function"==typeof n)e&&(n=Y2(n,e));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Y2(n.handleEvent,n)}return 2147483647<Number(t)?-1:_n.setTimeout(n,t||0)}function GZ(n){n.g=_I(()=>{n.g=null,n.i&&(n.i=!1,GZ(n))},n.j);const t=n.h;n.h=null,n.m.apply(null,t)}_2(VE,Di),(Ot=VE.prototype).ca=!1,Ot.R=null,Ot.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),v2(this,"tick"),this.ca&&(mI(this),this.start()))}},Ot.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ot.M=function(){VE.X.M.call(this),mI(this),delete this.g};class Yge extends S0{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:GZ(this)}M(){super.M(),this.g&&(_n.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Kp(n){S0.call(this),this.h=n,this.g={}}_2(Kp,S0);var WZ=[];function qZ(n,t,e,r){Array.isArray(e)||(e&&(WZ[0]=e.toString()),e=WZ);for(var s=0;s<e.length;s++){var i=DZ(t,e[s],r||n.handleEvent,!1,n.h||n);if(!i)break;n.g[i.key]=i}}function jZ(n){sI(n.g,function(t,e){this.g.hasOwnProperty(e)&&lI(t)},n),n.g={}}function HE(){this.g=!0}function vf(n,t,e,r){n.info(function(){return"XMLHTTP TEXT ("+t+"): "+function Jge(n,t){if(!n.g)return t;if(!t)return null;try{var e=JSON.parse(t);if(e)for(n=0;n<e.length;n++)if(Array.isArray(e[n])){var r=e[n];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return dI(e)}catch{return t}}(n,e)+(r?" "+r:"")})}Kp.prototype.M=function(){Kp.X.M.call(this),jZ(this)},Kp.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},HE.prototype.Aa=function(){this.g=!1},HE.prototype.info=function(){};var Iu={},ZZ=null;function FE(){return ZZ=ZZ||new Di}function YZ(n){K2.call(this,Iu.Pa,n)}function Xp(n){const t=FE();v2(t,new YZ(t))}function KZ(n,t){K2.call(this,Iu.STAT_EVENT,n),this.stat=t}function To(n){const t=FE();v2(t,new KZ(t,n))}function XZ(n,t){K2.call(this,Iu.Qa,n),this.size=t}function Qp(n,t){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return _n.setTimeout(function(){n()},t)}Iu.Pa="serverreachability",_2(YZ,K2),Iu.STAT_EVENT="statevent",_2(KZ,K2),Iu.Qa="timingevent",_2(XZ,K2);var BE={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},QZ={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function vI(){}function eY(){}vI.prototype.h=null;var EI,Jp={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function CI(){K2.call(this,"d")}function yI(){K2.call(this,"c")}function $E(){}function eg(n,t,e,r){this.l=n,this.j=t,this.m=e,this.U=r||1,this.S=new Kp(this),this.O=eme,this.T=new VE(n=JA?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new tY}function tY(){this.i=null,this.g="",this.h=!1}_2(CI,K2),_2(yI,K2),_2($E,vI),$E.prototype.g=function(){return new XMLHttpRequest},$E.prototype.i=function(){return{}},EI=new $E;var eme=45e3,MI={},UE={};function SI(n,t,e){n.K=1,n.v=jE(zl(t)),n.s=e,n.P=!0,nY(n,null)}function nY(n,t){n.F=Date.now(),tg(n),n.A=zl(n.v);var e=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),hY(e.i,"t",r),n.C=0,e=n.l.H,n.h=new tY,n.g=DY(n.l,e?t:null,!n.s),0<n.N&&(n.L=new Yge(Y2(n.La,n,n.g),n.N)),qZ(n.S,n.g,"readystatechange",n.ib),t=n.H?kZ(n.H):{},n.s?(n.u||(n.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,t)):(n.u="GET",n.g.da(n.A,n.u,null,t)),Xp(),function Kge(n,t,e,r,s,i){n.info(function(){if(n.g)if(i)for(var o="",c=i.split("&"),u=0;u<c.length;u++){var h=c[u].split("=");if(1<h.length){var p=h[0];h=h[1];var m=p.split("_");o=2<=m.length&&"type"==m[1]?o+(p+"=")+h+"&":o+(p+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+e+"\n"+o})}(n.j,n.u,n.A,n.m,n.U,n.s)}function rY(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function sY(n,t,e){let s,r=!0;for(;!n.I&&n.C<e.length;){if(s=tme(n,e),s==UE){4==t&&(n.o=4,To(14),r=!1),vf(n.j,n.m,null,"[Incomplete Response]");break}if(s==MI){n.o=4,To(15),vf(n.j,n.m,e,"[Invalid Chunk]"),r=!1;break}vf(n.j,n.m,s,null),PI(n,s)}rY(n)&&s!=UE&&s!=MI&&(n.h.g="",n.C=0),4!=t||0!=e.length||n.h.h||(n.o=1,To(16),r=!1),n.i=n.i&&r,r?0<e.length&&!n.$&&(n.$=!0,(t=n.l).g==n&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+e.length),xI(t),t.K=!0,To(11))):(vf(n.j,n.m,e,"[Invalid Chunked Response]"),xu(n),ng(n))}function tme(n,t){var e=n.C,r=t.indexOf("\n",e);return-1==r?UE:(e=Number(t.substring(e,r)),isNaN(e)?MI:(r+=1)+e>t.length?UE:(t=t.substr(r,e),n.C=r+e,t))}function tg(n){n.V=Date.now()+n.O,iY(n,n.O)}function iY(n,t){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Qp(Y2(n.gb,n),t)}function GE(n){n.B&&(_n.clearTimeout(n.B),n.B=null)}function ng(n){0==n.l.G||n.I||xY(n.l,n)}function xu(n){GE(n);var t=n.L;t&&"function"==typeof t.na&&t.na(),n.L=null,mI(n.T),jZ(n.S),n.g&&(t=n.g,n.g=null,t.abort(),t.na())}function PI(n,t){try{var e=n.l;if(0!=e.G&&(e.g==n||TI(e.h,n)))if(!n.J&&TI(e.h,n)&&3==e.G){try{var r=e.Fa.g.parse(t)}catch{r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!e.u){if(e.g){if(!(e.g.F+3e3<n.F))break e;JE(e),XE(e)}II(e),To(18)}}else e.Ba=s[1],0<e.Ba-e.T&&37500>s[2]&&e.L&&0==e.A&&!e.v&&(e.v=Qp(Y2(e.cb,e),6e3));if(1>=gY(e.h)&&e.ja){try{e.ja()}catch{}e.ja=void 0}}else Lu(e,11)}else if((n.J||e.g==n)&&JE(e),!xE(t))for(s=e.Fa.g.parse(t),t=0;t<s.length;t++){let h=s[t];if(e.T=h[0],h=h[1],2==e.G)if("c"==h[0]){e.I=h[1],e.ka=h[2];const p=h[3];null!=p&&(e.ma=p,e.j.info("VER="+e.ma));const m=h[4];null!=m&&(e.Ca=m,e.j.info("SVER="+e.Ca));const C=h[5];null!=C&&"number"==typeof C&&0<C&&(e.J=r=1.5*C,e.j.info("backChannelRequestTimeoutMs_="+r)),r=e;const w=n.g;if(w){const I=w.g?w.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(I){var i=r.h;i.g||-1==I.indexOf("spdy")&&-1==I.indexOf("quic")&&-1==I.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(wI(i,i.h),i.h=null))}if(r.D){const H=w.g?w.g.getResponseHeader("X-HTTP-Session-Id"):null;H&&(r.za=H,Hr(r.F,r.D,H))}}e.G=3,e.l&&e.l.xa(),e.$&&(e.P=Date.now()-n.F,e.j.info("Handshake RTT: "+e.P+"ms"));var o=n;if((r=e).sa=RY(r,r.H?r.ka:null,r.V),o.J){mY(r.h,o);var c=o,u=r.J;u&&c.setTimeout(u),c.B&&(GE(c),tg(c)),r.g=o}else AY(r);0<e.i.length&&QE(e)}else"stop"!=h[0]&&"close"!=h[0]||Lu(e,7);else 3==e.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?Lu(e,7):AI(e):"noop"!=h[0]&&e.l&&e.l.wa(h),e.A=0)}Xp()}catch{}}function oY(n,t){if(n.forEach&&"function"==typeof n.forEach)n.forEach(t,void 0);else if(AE(n)||"string"==typeof n)Array.prototype.forEach.call(n,t,void 0);else for(var e=function rme(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(AE(n)||"string"==typeof n){var t=[];n=n.length;for(var e=0;e<n;e++)t.push(e);return t}t=[],e=0;for(const r in n)t[e++]=r;return t}}}(n),r=function nme(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(AE(n)){for(var t=[],e=n.length,r=0;r<e;r++)t.push(n[r]);return t}for(r in t=[],e=0,n)t[e++]=n[r];return t}(n),s=r.length,i=0;i<s;i++)t.call(void 0,r[i],e&&e[i],n)}(Ot=eg.prototype).setTimeout=function(n){this.O=n},Ot.ib=function(n){n=n.target;const t=this.L;t&&3==Vl(n)?t.l():this.La(n)},Ot.La=function(n){try{if(n==this.g)e:{const p=Vl(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>p)&&(3!=p||JA||this.g&&(this.h.h||this.g.fa()||PY(this.g)))){this.I||4!=p||7==t||Xp(),GE(this);var e=this.g.aa();this.Y=e;t:if(rY(this)){var r=PY(this.g);n="";var s=r.length,i=4==Vl(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){xu(this),ng(this);var o="";break t}this.h.i=new _n.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,n+=this.h.i.decode(r[t],{stream:i&&t==s-1});r.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==e,function Xge(n,t,e,r,s,i,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+e+"\n"+i+" "+o})}(this.j,this.u,this.A,this.m,this.U,p,e),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,u=this.g;if((c=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!xE(c)){var h=c;break t}}h=null}if(!(e=h)){this.i=!1,this.o=3,To(12),xu(this),ng(this);break e}vf(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,PI(this,e)}this.P?(sY(this,p,o),JA&&this.i&&3==p&&(qZ(this.S,this.T,"tick",this.hb),this.T.start())):(vf(this.j,this.m,o,null),PI(this,o)),4==p&&xu(this),this.i&&!this.I&&(4==p?xY(this.l,this):(this.i=!1,tg(this)))}else 400==e&&0<o.indexOf("Unknown SID")?(this.o=3,To(12)):(this.o=0,To(13)),xu(this),ng(this)}}}catch{}},Ot.hb=function(){if(this.g){var n=Vl(this.g),t=this.g.fa();this.C<t.length&&(GE(this),sY(this,n,t),this.i&&4!=n&&tg(this))}},Ot.cancel=function(){this.I=!0,xu(this)},Ot.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function Qge(n,t){n.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(Xp(),To(17)),xu(this),this.o=2,ng(this)):iY(this,this.V-n)};var aY=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ku(n,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof ku){this.h=void 0!==t?t:n.h,WE(this,n.j),this.s=n.s,this.g=n.g,qE(this,n.m),this.l=n.l,t=n.i;var e=new ig;e.i=t.i,t.g&&(e.g=new Map(t.g),e.h=t.h),cY(this,e),this.o=n.o}else n&&(e=String(n).match(aY))?(this.h=!!t,WE(this,e[1]||"",!0),this.s=rg(e[2]||""),this.g=rg(e[3]||"",!0),qE(this,e[4]),this.l=rg(e[5]||"",!0),cY(this,e[6]||"",!0),this.o=rg(e[7]||"")):(this.h=!!t,this.i=new ig(null,this.h))}function zl(n){return new ku(n)}function WE(n,t,e){n.j=e?rg(t,!0):t,n.j&&(n.j=n.j.replace(/:$/,""))}function qE(n,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);n.m=t}else n.m=null}function cY(n,t,e){t instanceof ig?(n.i=t,function ume(n,t){t&&!n.j&&(P0(n),n.i=null,n.g.forEach(function(e,r){var s=r.toLowerCase();r!=s&&(uY(this,r),hY(this,s,e))},n)),n.j=t}(n.i,n.h)):(e||(t=sg(t,cme)),n.i=new ig(t,n.h))}function Hr(n,t,e){n.i.set(t,e)}function jE(n){return Hr(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function rg(n,t){return n?t?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function sg(n,t,e){return"string"==typeof n?(n=encodeURI(n).replace(t,ime),e&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function ime(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}ku.prototype.toString=function(){var n=[],t=this.j;t&&n.push(sg(t,lY,!0),":");var e=this.g;return(e||"file"==t)&&(n.push("//"),(t=this.s)&&n.push(sg(t,lY,!0),"@"),n.push(encodeURIComponent(String(e)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(e=this.m)&&n.push(":",String(e))),(e=this.l)&&(this.g&&"/"!=e.charAt(0)&&n.push("/"),n.push(sg(e,"/"==e.charAt(0)?ame:ome,!0))),(e=this.i.toString())&&n.push("?",e),(e=this.o)&&n.push("#",sg(e,lme)),n.join("")};var lY=/[#\/\?@]/g,ome=/[#\?:]/g,ame=/[#\?]/g,cme=/[#\?@]/g,lme=/#/g;function ig(n,t){this.h=this.g=null,this.i=n||null,this.j=!!t}function P0(n){n.g||(n.g=new Map,n.h=0,n.i&&function sme(n,t){if(n){n=n.split("&");for(var e=0;e<n.length;e++){var r=n[e].indexOf("="),s=null;if(0<=r){var i=n[e].substring(0,r);s=n[e].substring(r+1)}else i=n[e];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function uY(n,t){P0(n),t=Cf(n,t),n.g.has(t)&&(n.i=null,n.h-=n.g.get(t).length,n.g.delete(t))}function fY(n,t){return P0(n),t=Cf(n,t),n.g.has(t)}function hY(n,t,e){uY(n,t),0<e.length&&(n.i=null,n.g.set(Cf(n,t),KA(e)),n.h+=e.length)}function Cf(n,t){return t=String(t),n.j&&(t=t.toLowerCase()),t}function dY(n){this.l=n||hme,n=_n.PerformanceNavigationTiming?0<(n=_n.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(_n.g&&_n.g.Ga&&_n.g.Ga()&&_n.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Ot=ig.prototype).add=function(n,t){P0(this),this.i=null,n=Cf(this,n);var e=this.g.get(n);return e||this.g.set(n,e=[]),e.push(t),this.h+=1,this},Ot.forEach=function(n,t){P0(this),this.g.forEach(function(e,r){e.forEach(function(s){n.call(t,s,r,this)},this)},this)},Ot.oa=function(){P0(this);const n=Array.from(this.g.values()),t=Array.from(this.g.keys()),e=[];for(let r=0;r<t.length;r++){const s=n[r];for(let i=0;i<s.length;i++)e.push(t[r])}return e},Ot.W=function(n){P0(this);let t=[];if("string"==typeof n)fY(this,n)&&(t=t.concat(this.g.get(Cf(this,n))));else{n=Array.from(this.g.values());for(let e=0;e<n.length;e++)t=t.concat(n[e])}return t},Ot.set=function(n,t){return P0(this),this.i=null,fY(this,n=Cf(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[t]),this.h+=1,this},Ot.get=function(n,t){return n&&0<(n=this.W(n)).length?String(n[0]):t},Ot.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],t=Array.from(this.g.keys());for(var e=0;e<t.length;e++){var r=t[e];const i=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var s=i;""!==o[r]&&(s+="="+encodeURIComponent(String(o[r]))),n.push(s)}}return this.i=n.join("&")};var hme=10;function pY(n){return!!n.h||!!n.g&&n.g.size>=n.j}function gY(n){return n.h?1:n.g?n.g.size:0}function TI(n,t){return n.h?n.h==t:!!n.g&&n.g.has(t)}function wI(n,t){n.g?n.g.add(t):n.h=t}function mY(n,t){n.h&&n.h==t?n.h=null:n.g&&n.g.has(t)&&n.g.delete(t)}function _Y(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let t=n.i;for(const e of n.g.values())t=t.concat(e.D);return t}return KA(n.i)}function bI(){}function dme(){this.g=new bI}function pme(n,t,e){const r=e||"";try{oY(n,function(s,i){let o=s;jp(s)&&(o=dI(s)),t.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function ZE(n,t,e,r,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(r)}catch{}}function og(n){this.l=n.ac||null,this.j=n.jb||!1}function YE(n,t){Di.call(this),this.D=n,this.u=t,this.m=void 0,this.readyState=OI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}dY.prototype.cancel=function(){if(this.i=_Y(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},bI.prototype.stringify=function(n){return _n.JSON.stringify(n,void 0)},bI.prototype.parse=function(n){return _n.JSON.parse(n,void 0)},_2(og,vI),og.prototype.g=function(){return new YE(this.l,this.j)},og.prototype.i=function(n){return function(){return n}}({}),_2(YE,Di);var OI=0;function vY(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function ag(n){n.readyState=4,n.l=null,n.j=null,n.A=null,cg(n)}function cg(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(Ot=YE.prototype).open=function(n,t){if(this.readyState!=OI)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=t,this.readyState=1,cg(this)},Ot.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(t.body=n),(this.D||_n).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},Ot.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ag(this)),this.readyState=OI},Ot.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,cg(this)),this.g&&(this.readyState=3,cg(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof _n.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vY(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},Ot.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var t=n.value?n.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!n.done}))&&(this.response=this.responseText+=t)}n.done?ag(this):cg(this),3==this.readyState&&vY(this)}},Ot.Va=function(n){this.g&&(this.response=this.responseText=n,ag(this))},Ot.Ua=function(n){this.g&&(this.response=n,ag(this))},Ot.ga=function(){this.g&&ag(this)},Ot.setRequestHeader=function(n,t){this.v.append(n,t)},Ot.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},Ot.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],t=this.h.entries();for(var e=t.next();!e.done;)n.push((e=e.value)[0]+": "+e[1]),e=t.next();return n.join("\r\n")},Object.defineProperty(YE.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var mme=_n.JSON.parse;function us(n){Di.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=CY,this.K=this.L=!1}_2(us,Di);var CY="",_me=/^https?$/i,vme=["POST","PUT"];function yY(n,t){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=t,n.m=5,EY(n),KE(n)}function EY(n){n.D||(n.D=!0,v2(n,"complete"),v2(n,"error"))}function MY(n){if(n.h&&typeof ZA<"u"&&(!n.C[1]||4!=Vl(n)||2!=n.aa()))if(n.v&&4==Vl(n))_I(n.Ha,0,n);else if(v2(n,"readystatechange"),4==Vl(n)){n.h=!1;try{const c=n.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var e;if(!(e=t)){var r;if(r=0===c){var s=String(n.H).match(aY)[1]||null;if(!s&&_n.self&&_n.self.location){var i=_n.self.location.protocol;s=i.substr(0,i.length-1)}r=!_me.test(s?s.toLowerCase():"")}e=r}if(e)v2(n,"complete"),v2(n,"success");else{n.m=6;try{var o=2<Vl(n)?n.g.statusText:""}catch{o=""}n.j=o+" ["+n.aa()+"]",EY(n)}}finally{KE(n)}}}function KE(n,t){if(n.g){SY(n);const e=n.g,r=n.C[0]?NE:null;n.g=null,n.C=null,t||v2(n,"ready");try{e.onreadystatechange=r}catch{}}}function SY(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(_n.clearTimeout(n.A),n.A=null)}function Vl(n){return n.g?n.g.readyState:0}function PY(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case CY:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function TY(n){let t="";return sI(n,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function NI(n,t,e){e:{for(r in e){var r=!1;break e}r=!0}r||(e=TY(e),"string"==typeof n?null!=e&&encodeURIComponent(String(e)):Hr(n,t,e))}function lg(n,t,e){return e&&e.internalChannelParams&&e.internalChannelParams[n]||t}function wY(n){this.Ca=0,this.i=[],this.j=new HE,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=lg("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=lg("baseRetryDelayMs",5e3,n),this.bb=lg("retryDelaySeedMs",1e4,n),this.$a=lg("forwardChannelMaxRetries",2,n),this.ta=lg("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new dY(n&&n.concurrentRequestLimit),this.Fa=new dme,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function AI(n){if(bY(n),3==n.G){var t=n.U++,e=zl(n.F);Hr(e,"SID",n.I),Hr(e,"RID",t),Hr(e,"TYPE","terminate"),ug(n,e),(t=new eg(n,n.j,t,void 0)).K=2,t.v=jE(zl(e)),e=!1,_n.navigator&&_n.navigator.sendBeacon&&(e=_n.navigator.sendBeacon(t.v.toString(),"")),!e&&_n.Image&&((new Image).src=t.v,e=!0),e||(t.g=DY(t.l,null),t.g.da(t.v)),t.F=Date.now(),tg(t)}LY(n)}function XE(n){n.g&&(xI(n),n.g.cancel(),n.g=null)}function bY(n){XE(n),n.u&&(_n.clearTimeout(n.u),n.u=null),JE(n),n.h.cancel(),n.m&&("number"==typeof n.m&&_n.clearTimeout(n.m),n.m=null)}function QE(n){pY(n.h)||n.m||(n.m=!0,$Z(n.Ja,n),n.C=0)}function OY(n,t){var e;e=t?t.m:n.U++;const r=zl(n.F);Hr(r,"SID",n.I),Hr(r,"RID",e),Hr(r,"AID",n.T),ug(n,r),n.o&&n.s&&NI(r,n.o,n.s),e=new eg(n,n.j,e,n.C+1),null===n.o&&(e.H=n.s),t&&(n.i=t.D.concat(n.i)),t=NY(n,e,1e3),e.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),wI(n.h,e),SI(e,r,t)}function ug(n,t){n.ia&&sI(n.ia,function(e,r){Hr(t,r,e)}),n.l&&oY({},function(e,r){Hr(t,r,e)})}function NY(n,t,e){e=Math.min(n.i.length,e);var r=n.l?Y2(n.l.Ra,n.l,n):null;e:{var s=n.i;let i=-1;for(;;){const o=["count="+e];-1==i?0<e?(i=s[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let c=!0;for(let u=0;u<e;u++){let h=s[u].h;const p=s[u].g;if(h-=i,0>h)i=Math.max(0,s[u].h-100),c=!1;else try{pme(p,o,"req"+h+"_")}catch{r&&r(p)}}if(c){r=o.join("&");break e}}}return n=n.i.splice(0,e),t.D=n,r}function AY(n){n.g||n.u||(n.Z=1,$Z(n.Ia,n),n.A=0)}function II(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Qp(Y2(n.Ia,n),kY(n,n.A)),n.A++,0))}function xI(n){null!=n.B&&(_n.clearTimeout(n.B),n.B=null)}function IY(n){n.g=new eg(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var t=zl(n.sa);Hr(t,"RID","rpc"),Hr(t,"SID",n.I),Hr(t,"CI",n.L?"0":"1"),Hr(t,"AID",n.T),Hr(t,"TYPE","xmlhttp"),ug(n,t),n.o&&n.s&&NI(t,n.o,n.s),n.J&&n.g.setTimeout(n.J);var e=n.g;n=n.ka,e.K=1,e.v=jE(zl(t)),e.s=null,e.P=!0,nY(e,n)}function JE(n){null!=n.v&&(_n.clearTimeout(n.v),n.v=null)}function xY(n,t){var e=null;if(n.g==t){JE(n),xI(n),n.g=null;var r=2}else{if(!TI(n.h,t))return;e=t.D,mY(n.h,t),r=1}if(0!=n.G)if(n.pa=t.Y,t.i)if(1==r){e=t.s?t.s.length:0,t=Date.now()-t.F;var s=n.C;v2(r=FE(),new XZ(r,e)),QE(n)}else AY(n);else if(3==(s=t.o)||0==s&&0<n.pa||!(1==r&&function yme(n,t){return!(gY(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=t.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Qp(Y2(n.Ja,n,t),kY(n,n.C)),n.C++,0)))}(n,t)||2==r&&II(n)))switch(e&&0<e.length&&(t=n.h,t.i=t.i.concat(e)),s){case 1:Lu(n,5);break;case 4:Lu(n,10);break;case 3:Lu(n,6);break;default:Lu(n,2)}}function kY(n,t){let e=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(e*=2),e*t}function Lu(n,t){if(n.j.info("Error code "+t),2==t){var e=null;n.l&&(e=null);var r=Y2(n.kb,n);e||(e=new ku("//www.google.com/images/cleardot.gif"),_n.location&&"http"==_n.location.protocol||WE(e,"https"),jE(e)),function gme(n,t){const e=new HE;if(_n.Image){const r=new Image;r.onload=IE(ZE,e,r,"TestLoadImage: loaded",!0,t),r.onerror=IE(ZE,e,r,"TestLoadImage: error",!1,t),r.onabort=IE(ZE,e,r,"TestLoadImage: abort",!1,t),r.ontimeout=IE(ZE,e,r,"TestLoadImage: timeout",!1,t),_n.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else t(!1)}(e.toString(),r)}else To(2);n.G=0,n.l&&n.l.va(t),LY(n),bY(n)}function LY(n){if(n.G=0,n.la=[],n.l){const t=_Y(n.h);(0!=t.length||0!=n.i.length)&&(bZ(n.la,t),bZ(n.la,n.i),n.h.i.length=0,KA(n.i),n.i.length=0),n.l.ua()}}function RY(n,t,e){var r=e instanceof ku?zl(e):new ku(e,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),qE(r,r.m);else{var s=_n.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new ku(null,void 0);r&&WE(i,r),t&&(i.g=t),s&&qE(i,s),e&&(i.l=e),r=i}return t=n.za,(e=n.D)&&t&&Hr(r,e,t),Hr(r,"VER",n.ma),ug(n,r),r}function DY(n,t,e){if(t&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new us(e&&n.Da&&!n.ra?new og({jb:!0}):n.ra)).Ka(n.H),t}function zY(){}function eM(){if(_f&&!(10<=Number(zge)))throw Error("Environmental error: no available transport.")}function za(n,t){Di.call(this),this.g=new wY(t),this.l=n,this.h=t&&t.messageUrlParams||null,n=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(n?n["X-WebChannel-Content-Type"]=t.messageContentType:n={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(n?n["X-WebChannel-Client-Profile"]=t.ya:n={"X-WebChannel-Client-Profile":t.ya}),this.g.S=n,(n=t&&t.Yb)&&!xE(n)&&(this.g.o=n),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!xE(t)&&(this.g.D=t,null!==(n=this.h)&&t in n&&t in(n=this.h)&&delete n[t]),this.j=new yf(this)}function VY(n){CI.call(this);var t=n.__sm__;if(t){e:{for(const e in t){n=e;break e}n=void 0}(this.i=n)&&(n=this.i,t=null!==t&&n in t?t[n]:void 0),this.data=t}else this.data=n}function HY(){yI.call(this),this.status=1}function yf(n){this.g=n}(Ot=us.prototype).Ka=function(n){this.L=n},Ot.da=function(n,t,e,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);t=t?t.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():EI.g(),this.C=function JZ(n){return n.h||(n.h=n.i())}(this.u?this.u:EI),this.g.onreadystatechange=Y2(this.Ha,this);try{this.F=!0,this.g.open(t,String(n),!0),this.F=!1}catch(i){return void yY(this,i)}if(n=e||"",e=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)e.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const i of r.keys())e.set(i,r.get(i))}r=Array.from(e.keys()).find(i=>"content-type"==i.toLowerCase()),s=_n.FormData&&n instanceof _n.FormData,!(0<=wZ(vme,t))||r||s||e.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of e)this.g.setRequestHeader(i,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{SY(this),0<this.B&&((this.K=function Cme(n){return _f&&function Dge(){return function xge(n){var t=Rge;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=n(9)}(function(){let n=0;const t=OZ(String(LE)).split("."),e=OZ("9").split("."),r=Math.max(t.length,e.length);for(let o=0;0==n&&o<r;o++){var s=t[o]||"",i=e[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],0==s[0].length&&0==i[0].length)break;n=XA(0==s[1].length?0:parseInt(s[1],10),0==i[1].length?0:parseInt(i[1],10))||XA(0==s[2].length,0==i[2].length)||XA(s[2],i[2]),s=s[3],i=i[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Y2(this.qa,this)):this.A=_I(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(i){yY(this,i)}},Ot.qa=function(){typeof ZA<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,v2(this,"timeout"),this.abort(8))},Ot.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,v2(this,"complete"),v2(this,"abort"),KE(this))},Ot.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),KE(this,!0)),us.X.M.call(this)},Ot.Ha=function(){this.s||(this.F||this.v||this.l?MY(this):this.fb())},Ot.fb=function(){MY(this)},Ot.aa=function(){try{return 2<Vl(this)?this.g.status:-1}catch{return-1}},Ot.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},Ot.Sa=function(n){if(this.g){var t=this.g.responseText;return n&&0==t.indexOf(n)&&(t=t.substring(n.length)),mme(t)}},Ot.Ea=function(){return this.m},Ot.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ot=wY.prototype).ma=8,Ot.G=1,Ot.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const s=new eg(this,this.j,n,void 0);let i=this.s;if(this.S&&(i?(i=kZ(i),RZ(i,this.S)):i=this.S),null!==this.o||this.N||(s.H=i,i=null),this.O)e:{for(var t=0,e=0;e<this.i.length;e++){var r=this.i[e];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=e;break e}if(4096===t||e===this.i.length-1){t=e+1;break e}}t=1e3}else t=1e3;t=NY(this,s,t),Hr(e=zl(this.F),"RID",n),Hr(e,"CVER",22),this.D&&Hr(e,"X-HTTP-Session-Id",this.D),ug(this,e),i&&(this.N?t="headers="+encodeURIComponent(String(TY(i)))+"&"+t:this.o&&NI(e,this.o,i)),wI(this.h,s),this.Ya&&Hr(e,"TYPE","init"),this.O?(Hr(e,"$req",t),Hr(e,"SID","null"),s.Z=!0,SI(s,e,null)):SI(s,e,t),this.G=2}}else 3==this.G&&(n?OY(this,n):0==this.i.length||pY(this.h)||OY(this))},Ot.Ia=function(){if(this.u=null,IY(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Qp(Y2(this.eb,this),n)}},Ot.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,To(10),XE(this),IY(this))},Ot.cb=function(){null!=this.v&&(this.v=null,XE(this),II(this),To(19))},Ot.kb=function(n){n?(this.j.info("Successfully pinged google.com"),To(2)):(this.j.info("Failed to ping google.com"),To(1))},(Ot=zY.prototype).xa=function(){},Ot.wa=function(){},Ot.va=function(){},Ot.ua=function(){},Ot.Ra=function(){},eM.prototype.g=function(n,t){return new za(n,t)},_2(za,Di),za.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,t=this.l,e=this.h||void 0;To(0),n.V=t,n.ia=e||{},n.L=n.Y,n.F=RY(n,null,n.V),QE(n)},za.prototype.close=function(){AI(this.g)},za.prototype.u=function(n){var t=this.g;if("string"==typeof n){var e={};e.__data__=n,n=e}else this.v&&((e={}).__data__=dI(n),n=e);t.i.push(new class{constructor(n,t){this.h=n,this.g=t}}(t.ab++,n)),3==t.G&&QE(t)},za.prototype.M=function(){this.g.l=null,delete this.j,AI(this.g),delete this.g,za.X.M.call(this)},_2(VY,CI),_2(HY,yI),_2(yf,zY),yf.prototype.xa=function(){v2(this.g,"a")},yf.prototype.wa=function(n){v2(this.g,new VY(n))},yf.prototype.va=function(n){v2(this.g,new HY)},yf.prototype.ua=function(){v2(this.g,"b")},eM.prototype.createWebChannel=eM.prototype.g,za.prototype.send=za.prototype.u,za.prototype.open=za.prototype.m,za.prototype.close=za.prototype.close,BE.NO_ERROR=0,BE.TIMEOUT=8,BE.HTTP_ERROR=6,QZ.COMPLETE="complete",eY.EventType=Jp,Jp.OPEN="a",Jp.CLOSE="b",Jp.ERROR="c",Jp.MESSAGE="d",Di.prototype.listen=Di.prototype.N,us.prototype.listenOnce=us.prototype.O,us.prototype.getLastError=us.prototype.Oa,us.prototype.getLastErrorCode=us.prototype.Ea,us.prototype.getStatus=us.prototype.aa,us.prototype.getResponseJson=us.prototype.Sa,us.prototype.getResponseText=us.prototype.fa,us.prototype.send=us.prototype.da,us.prototype.setWithCredentials=us.prototype.Ka;var Eme=Dl.createWebChannelTransport=function(){return new eM},Mme=Dl.getStatEventTarget=function(){return FE()},kI=Dl.ErrorCode=BE,Sme=Dl.EventType=QZ,Pme=Dl.Event=Iu,FY=Dl.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},Tme=Dl.FetchXmlHttpFactory=og,tM=Dl.WebChannel=eY,wme=Dl.XhrIo=us;const BY="@firebase/firestore";class zi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}zi.UNAUTHENTICATED=new zi(null),zi.GOOGLE_CREDENTIALS=new zi("google-credentials-uid"),zi.FIRST_PARTY=new zi("first-party-uid"),zi.MOCK_USER=new zi("mock-user");let Ef="9.14.0";const T0=new pf("@firebase/firestore");function LI(){return T0.logLevel}function Ue(n,...t){if(T0.logLevel<=p1.DEBUG){const e=t.map(RI);T0.debug(`Firestore (${Ef}): ${n}`,...e)}}function Ps(n,...t){if(T0.logLevel<=p1.ERROR){const e=t.map(RI);T0.error(`Firestore (${Ef}): ${n}`,...e)}}function Mf(n,...t){if(T0.logLevel<=p1.WARN){const e=t.map(RI);T0.warn(`Firestore (${Ef}): ${n}`,...e)}}function RI(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Tt(n="Unexpected state"){const t=`FIRESTORE (${Ef}) INTERNAL ASSERTION FAILED: `+n;throw Ps(t),new Error(t)}function rn(n,t){n||Tt()}function ct(n,t){return n}const Te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends Tc{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class di{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class $Y{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class bme{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(zi.UNAUTHENTICATED))}shutdown(){}}class Ome{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class Nme{constructor(t){this.t=t,this.currentUser=zi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){var r=this;let s=this.i;const i=h=>this.i!==s?(s=this.i,e(h)):Promise.resolve();let o=new di;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new di,t.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;t.enqueueRetryable(A(function*(){yield h.promise,yield i(r.currentUser)}))},u=h=>{Ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(Ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new di)}},0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(r=>this.i!==t?(Ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(rn("string"==typeof r.accessToken),new $Y(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return rn(null===t||"string"==typeof t),new zi(t)}}class Ame{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s,this.type="FirstParty",this.user=zi.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(rn(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const t=this.I();return t&&this.p.set("Authorization",t),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Ime{constructor(t,e,r,s){this.h=t,this.l=e,this.m=r,this.g=s}getToken(){return Promise.resolve(new Ame(this.h,this.l,this.m,this.g))}start(t,e){t.enqueueRetryable(()=>e(zi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class UY{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class xme{constructor(t){this.T=t,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(t,e){const r=i=>{null!=i.error&&Ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.A;return this.A=i.token,Ue("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(i.token):Promise.resolve()};this.o=i=>{t.enqueueRetryable(()=>r(i))};const s=i=>{Ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.T.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.T.getImmediate({optional:!0});i?s(i):Ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(rn("string"==typeof e.token),this.A=e.token,new UY(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function kme(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(let r=0;r<n;r++)e[r]=Math.floor(256*Math.random());return e}class GY{static R(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let r="";for(;r.length<20;){const s=kme(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<e&&(r+=t.charAt(s[i]%t.length))}return r}}function vn(n,t){return n<t?-1:n>t?1:0}function Sf(n,t,e){return n.length===t.length&&n.every((r,s)=>e(r,t[s]))}class Qr{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Fe(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Fe(Te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Fe(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Fe(Te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Qr.fromMillis(Date.now())}static fromDate(t){return Qr.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),r=Math.floor(1e6*(t-1e3*e));return new Qr(e,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?vn(this.nanoseconds,t.nanoseconds):vn(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class sn{constructor(t){this.timestamp=t}static fromTimestamp(t){return new sn(t)}static min(){return new sn(new Qr(0,0))}static max(){return new sn(new Qr(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class fg{constructor(t,e,r){void 0===e?e=0:e>t.length&&Tt(),void 0===r?r=t.length-e:r>t.length-e&&Tt(),this.segments=t,this.offset=e,this.len=r}get length(){return this.len}isEqual(t){return 0===fg.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof fg?t.forEach(r=>{e.push(r)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return this.construct(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,r=this.limit();e<r;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const r=Math.min(t.length,e.length);for(let s=0;s<r;s++){const i=t.get(s),o=e.get(s);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class g1 extends fg{construct(t,e,r){return new g1(t,e,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const r of t){if(r.indexOf("//")>=0)throw new Fe(Te.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);e.push(...r.split("/").filter(s=>s.length>0))}return new g1(e)}static emptyPath(){return new g1([])}}const Lme=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ts extends fg{construct(t,e,r){return new Ts(t,e,r)}static isValidIdentifier(t){return Lme.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ts.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ts(["__name__"])}static fromServerFormat(t){const e=[];let r="",s=0;const i=()=>{if(0===r.length)throw new Fe(Te.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(r),r=""};let o=!1;for(;s<t.length;){const c=t[s];if("\\"===c){if(s+1===t.length)throw new Fe(Te.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const u=t[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Fe(Te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,s+=2}else"`"===c?(o=!o,s++):"."!==c||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new Fe(Te.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Ts(e)}static emptyPath(){return new Ts([])}}class it{constructor(t){this.path=t}static fromPath(t){return new it(g1.fromString(t))}static fromName(t){return new it(g1.fromString(t).popFirst(5))}static empty(){return new it(g1.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===g1.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return g1.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new it(new g1(t.slice()))}}function jY(n){return new Va(n.readTime,n.key,-1)}class Va{constructor(t,e,r){this.readTime=t,this.documentKey=e,this.largestBatchId=r}static min(){return new Va(sn.min(),it.empty(),-1)}static max(){return new Va(sn.max(),it.empty(),-1)}}function zI(n,t){let e=n.readTime.compareTo(t.readTime);return 0!==e?e:(e=it.comparator(n.documentKey,t.documentKey),0!==e?e:vn(n.largestBatchId,t.largestBatchId))}const ZY="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";function w0(n){return VI.apply(this,arguments)}function VI(){return VI=A(function*(n){if(n.code!==Te.FAILED_PRECONDITION||n.message!==ZY)throw n;Ue("LocalStore","Unexpectedly lost primary lease")}),VI.apply(this,arguments)}class Ee{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Tt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Ee((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(t,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(e,i).next(r,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof Ee?e:Ee.resolve(e)}catch(e){return Ee.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):Ee.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):Ee.reject(e)}static resolve(t){return new Ee((e,r)=>{e(t)})}static reject(t){return new Ee((e,r)=>{r(t)})}static waitFor(t){return new Ee((e,r)=>{let s=0,i=0,o=!1;t.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&e()},u=>r(u))}),o=!0,i===s&&e()})}static or(t){let e=Ee.resolve(!1);for(const r of t)e=e.next(s=>s?Ee.resolve(s):r());return e}static forEach(t,e){const r=[];return t.forEach((s,i)=>{r.push(e.call(this,s,i))}),this.waitFor(r)}static mapArray(t,e){return new Ee((r,s)=>{const i=t.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const h=u;e(t[h]).next(p=>{o[h]=p,++c,c===i&&r(o)},p=>s(p))}})}static doWhile(t,e){return new Ee((r,s)=>{const i=()=>{!0===t()?e().next(()=>{i()},s):r()};i()})}}function b0(n){return"IndexedDbTransactionError"===n.name}class ia{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>e.writeSequenceNumber(r))}ut(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ct&&this.ct(t),t}}function KY(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function zu(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function XY(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}ia.at=-1;class fs{constructor(t,e){this.comparator=t,this.root=e||C2.EMPTY}insert(t,e){return new fs(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,C2.BLACK,null,null))}remove(t){return new fs(this.comparator,this.root.remove(t,this.comparator).copy(null,null,C2.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const r=this.comparator(t,e.key);if(0===r)return e.value;r<0?e=e.left:r>0&&(e=e.right)}return null}indexOf(t){let e=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(t,r.key);if(0===s)return e+r.left.size;s<0?r=r.left:(e+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,r)=>(t(e,r),!1))}toString(){const t=[];return this.inorderTraversal((e,r)=>(t.push(`${e}:${r}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new iM(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new iM(this.root,t,this.comparator,!1)}getReverseIterator(){return new iM(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new iM(this.root,t,this.comparator,!0)}}class iM{constructor(t,e,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?r(t.key,e):1,e&&s&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class C2{constructor(t,e,r,s,i){this.key=t,this.value=e,this.color=r??C2.RED,this.left=s??C2.EMPTY,this.right=i??C2.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,r,s,i){return new C2(t??this.key,e??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,r){let s=this;const i=r(t,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(t,e,r),null):0===i?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return C2.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let r,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===e(t,s.key)){if(s.right.isEmpty())return C2.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,C2.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,C2.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Tt();const t=this.left.check();if(t!==this.right.check())throw Tt();return t+(this.isRed()?0:1)}}C2.EMPTY=null,C2.RED=!0,C2.BLACK=!1,C2.EMPTY=new class{constructor(){this.size=0}get key(){throw Tt()}get value(){throw Tt()}get color(){throw Tt()}get left(){throw Tt()}get right(){throw Tt()}copy(n,t,e,r,s){return this}insert(n,t,e){return new C2(n,t)}remove(n,t){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class nr{constructor(t){this.comparator=t,this.data=new fs(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,r)=>(t(e),!1))}forEachInRange(t,e){const r=this.data.getIteratorFrom(t[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let r;for(r=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();r.hasNext();)if(!t(r.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new QY(this.data.getIterator())}getIteratorFrom(t){return new QY(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(r=>{e=e.add(r)}),e}isEqual(t){if(!(t instanceof nr)||this.size!==t.size)return!1;const e=this.data.getIterator(),r=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(0!==this.comparator(s,i))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new nr(this.comparator);return e.data=t,e}}class QY{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ha{constructor(t){this.fields=t,t.sort(Ts.comparator)}static empty(){return new Ha([])}unionWith(t){let e=new nr(Ts.comparator);for(const r of this.fields)e=e.add(r);for(const r of t)e=e.add(r);return new Ha(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Sf(this.fields,t.fields,(e,r)=>e.isEqual(r))}}class pi{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new pi(e)}static fromUint8Array(t){const e=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(t);return new pi(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return vn(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}pi.EMPTY_BYTE_STRING=new pi("");const $me=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function O0(n){if(rn(!!n),"string"==typeof n){let t=0;const e=$me.exec(n);if(rn(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:hs(n.seconds),nanos:hs(n.nanos)}}function hs(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Vu(n){return"string"==typeof n?pi.fromBase64String(n):pi.fromUint8Array(n)}function FI(n){var t,e;return"server_timestamp"===(null===(e=((null===(t=n?.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===e?void 0:e.stringValue)}function JY(n){const t=n.mapValue.fields.__previous_value__;return FI(t)?JY(t):t}function pg(n){const t=O0(n.mapValue.fields.__local_write_time__.timestampValue);return new Qr(t.seconds,t.nanos)}class Ume{constructor(t,e,r,s,i,o,c,u){this.databaseId=t,this.appId=e,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.useFetchStreams=u}}class Hu{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Hu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Hu&&t.projectId===this.projectId&&t.database===this.database}}function gg(n){return null==n}function mg(n){return 0===n&&1/n==-1/0}const N0_mapValue={fields:{__type__:{stringValue:"__max__"}}};function Fu(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?FI(n)?4:sK(n)?9007199254740991:10:Tt()}function E4(n,t){if(n===t)return!0;const e=Fu(n);if(e!==Fu(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return pg(n).isEqual(pg(t));case 3:return function(r,s){if("string"==typeof r.timestampValue&&"string"==typeof s.timestampValue&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=O0(r.timestampValue),o=O0(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return s=t,Vu(n.bytesValue).isEqual(Vu(s.bytesValue));case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return hs(r.geoPointValue.latitude)===hs(s.geoPointValue.latitude)&&hs(r.geoPointValue.longitude)===hs(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return hs(r.integerValue)===hs(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=hs(r.doubleValue),o=hs(s.doubleValue);return i===o?mg(i)===mg(o):isNaN(i)&&isNaN(o)}return!1}(n,t);case 9:return Sf(n.arrayValue.values||[],t.arrayValue.values||[],E4);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(KY(i)!==KY(o))return!1;for(const c in i)if(i.hasOwnProperty(c)&&(void 0===o[c]||!E4(i[c],o[c])))return!1;return!0}(n,t);default:return Tt()}var s}function _g(n,t){return void 0!==(n.values||[]).find(e=>E4(e,t))}function A0(n,t){if(n===t)return 0;const e=Fu(n),r=Fu(t);if(e!==r)return vn(e,r);switch(e){case 0:case 9007199254740991:return 0;case 1:return vn(n.booleanValue,t.booleanValue);case 2:return function(s,i){const o=hs(s.integerValue||s.doubleValue),c=hs(i.integerValue||i.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(n,t);case 3:return tK(n.timestampValue,t.timestampValue);case 4:return tK(pg(n),pg(t));case 5:return vn(n.stringValue,t.stringValue);case 6:return function(s,i){const o=Vu(s),c=Vu(i);return o.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,i){const o=s.split("/"),c=i.split("/");for(let u=0;u<o.length&&u<c.length;u++){const h=vn(o[u],c[u]);if(0!==h)return h}return vn(o.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,i){const o=vn(hs(s.latitude),hs(i.latitude));return 0!==o?o:vn(hs(s.longitude),hs(i.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(s,i){const o=s.values||[],c=i.values||[];for(let u=0;u<o.length&&u<c.length;++u){const h=A0(o[u],c[u]);if(h)return h}return vn(o.length,c.length)}(n.arrayValue,t.arrayValue);case 10:return function(s,i){if(s===N0_mapValue&&i===N0_mapValue)return 0;if(s===N0_mapValue)return 1;if(i===N0_mapValue)return-1;const o=s.fields||{},c=Object.keys(o),u=i.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const m=vn(c[p],h[p]);if(0!==m)return m;const C=A0(o[c[p]],u[h[p]]);if(0!==C)return C}return vn(c.length,h.length)}(n.mapValue,t.mapValue);default:throw Tt()}}function tK(n,t){if("string"==typeof n&&"string"==typeof t&&n.length===t.length)return vn(n,t);const e=O0(n),r=O0(t),s=vn(e.seconds,r.seconds);return 0!==s?s:vn(e.nanos,r.nanos)}function Tf(n){return BI(n)}function BI(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const s=O0(r);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Vu(n.bytesValue).toBase64():"referenceValue"in n?it.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(t=n.geoPointValue).latitude},${t.longitude})`:"arrayValue"in n?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=BI(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of s)o?o=!1:i+=",",i+=`${c}:${BI(r.fields[c])}`;return i+"}"}(n.mapValue):Tt();var t}function Bu(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function $I(n){return!!n&&"integerValue"in n}function vg(n){return!!n&&"arrayValue"in n}function nK(n){return!!n&&"nullValue"in n}function rK(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function aM(n){return!!n&&"mapValue"in n}function Cg(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return zu(n.mapValue.fields,(e,r)=>t.mapValue.fields[e]=Cg(r)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Cg(n.arrayValue.values[e]);return t}return Object.assign({},n)}function sK(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}class y2{constructor(t){this.value=t}static empty(){return new y2({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let r=0;r<t.length-1;++r)if(e=(e.mapValue.fields||{})[t.get(r)],!aM(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Cg(e)}setAll(t){let e=Ts.emptyPath(),r={},s=[];t.forEach((o,c)=>{if(!e.isImmediateParentOf(c)){const u=this.getFieldsMap(e);this.applyChanges(u,r,s),r={},s=[],e=c.popLast()}o?r[c.lastSegment()]=Cg(o):s.push(c.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,r,s)}delete(t){const e=this.field(t.popLast());aM(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return E4(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let r=0;r<t.length;++r){let s=e.mapValue.fields[t.get(r)];aM(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(r)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,r){zu(e,(s,i)=>t[s]=i);for(const s of r)delete t[s]}clone(){return new y2(Cg(this.value))}}function aK(n){const t=[];return zu(n.fields,(e,r)=>{const s=new Ts([e]);if(aM(r)){const i=aK(r.mapValue).fields;if(0===i.length)t.push(s);else for(const o of i)t.push(s.child(o))}else t.push(s)}),new Ha(t)}class _r{constructor(t,e,r,s,i,o){this.key=t,this.documentType=e,this.version=r,this.readTime=s,this.data=i,this.documentState=o}static newInvalidDocument(t){return new _r(t,0,sn.min(),sn.min(),y2.empty(),0)}static newFoundDocument(t,e,r){return new _r(t,1,e,sn.min(),r,0)}static newNoDocument(t,e){return new _r(t,2,e,sn.min(),y2.empty(),0)}static newUnknownDocument(t,e){return new _r(t,3,e,sn.min(),y2.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=y2.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=y2.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=sn.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof _r&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new _r(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qme{constructor(t,e=null,r=[],s=[],i=null,o=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ht=null}}function cK(n,t=null,e=[],r=[],s=null,i=null,o=null){return new qme(n,t,e,r,s,i,o)}function $u(n){const t=ct(n);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(r=>{return(s=r).field.canonicalString()+s.op.toString()+Tf(s.value);var s}).join(","),e+="|ob:",e+=t.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),gg(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(r=>Tf(r)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(r=>Tf(r)).join(",")),t.ht=e}return t.ht}function yg(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!t_e(n.orderBy[s],t.orderBy[s]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((e=n.filters[s]).op!==(r=t.filters[s]).op||!e.field.isEqual(r.field)||!E4(e.value,r.value))return!1;var e,r;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!dK(n.startAt,t.startAt)&&dK(n.endAt,t.endAt)}function cM(n){return it.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class E2 extends class{}{constructor(t,e,r){super(),this.field=t,this.op=e,this.value=r}static create(t,e,r){return t.isKeyField()?"in"===e||"not-in"===e?this.lt(t,e,r):new Zme(t,e,r):"array-contains"===e?new Xme(t,r):"in"===e?new Qme(t,r):"not-in"===e?new Jme(t,r):"array-contains-any"===e?new e_e(t,r):new E2(t,e,r)}static lt(t,e,r){return"in"===e?new Yme(t,r):new Kme(t,r)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.ft(A0(e,this.value)):null!==e&&Fu(this.value)===Fu(e)&&this.ft(A0(e,this.value))}ft(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Tt()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Zme extends E2{constructor(t,e,r){super(t,e,r),this.key=it.fromName(r.referenceValue)}matches(t){const e=it.comparator(t.key,this.key);return this.ft(e)}}class Yme extends E2{constructor(t,e){super(t,"in",e),this.keys=fK(0,e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Kme extends E2{constructor(t,e){super(t,"not-in",e),this.keys=fK(0,e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function fK(n,t){var e;return((null===(e=t.arrayValue)||void 0===e?void 0:e.values)||[]).map(r=>it.fromName(r.referenceValue))}class Xme extends E2{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return vg(e)&&_g(e.arrayValue,this.value)}}class Qme extends E2{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&_g(this.value.arrayValue,e)}}class Jme extends E2{constructor(t,e){super(t,"not-in",e)}matches(t){if(_g(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!_g(this.value.arrayValue,e)}}class e_e extends E2{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!vg(e)||!e.arrayValue.values)&&e.arrayValue.values.some(r=>_g(this.value.arrayValue,r))}}class I0{constructor(t,e){this.position=t,this.inclusive=e}}class wf{constructor(t,e="asc"){this.field=t,this.dir=e}}function t_e(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}function hK(n,t,e){let r=0;for(let s=0;s<n.position.length;s++){const i=t[s],o=n.position[s];if(r=i.field.isKeyField()?it.comparator(it.fromName(o.referenceValue),e.key):A0(o,e.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function dK(n,t){if(null===n)return null===t;if(null===t||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!E4(n.position[e],t.position[e]))return!1;return!0}class Hl{constructor(t,e=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this._t=null,this.wt=null}}function bf(n){return new Hl(n)}function gK(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function UI(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function GI(n){for(const t of n.filters)if(t.dt())return t.field;return null}function WI(n){return null!==n.collectionGroup}function Of(n){const t=ct(n);if(null===t._t){t._t=[];const e=GI(t),r=UI(t);if(null!==e&&null===r)e.isKeyField()||t._t.push(new wf(e)),t._t.push(new wf(Ts.keyField(),"asc"));else{let s=!1;for(const i of t.explicitOrderBy)t._t.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new wf(Ts.keyField(),i))}}}return t._t}function wo(n){const t=ct(n);if(!t.wt)if("F"===t.limitType)t.wt=cK(t.path,t.collectionGroup,Of(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of Of(t))e.push(new wf(i.field,"desc"===i.dir?"asc":"desc"));const r=t.endAt?new I0(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new I0(t.startAt.position,t.startAt.inclusive):null;t.wt=cK(t.path,t.collectionGroup,e,t.filters,t.limit,r,s)}return t.wt}function uM(n,t,e){return new Hl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Eg(n,t){return yg(wo(n),wo(t))&&n.limitType===t.limitType}function mK(n){return`${$u(wo(n))}|lt:${n.limitType}`}function qI(n){return`Query(target=${function jme(n){let t=n.path.canonicalString();return null!==n.collectionGroup&&(t+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(t+=`, filters: [${n.filters.map(e=>{return`${(r=e).field.canonicalString()} ${r.op} ${Tf(r.value)}`;var r}).join(", ")}]`),gg(n.limit)||(t+=", limit: "+n.limit),n.orderBy.length>0&&(t+=`, orderBy: [${n.orderBy.map(e=>{return`${(r=e).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(t+=", startAt: ",t+=n.startAt.inclusive?"b:":"a:",t+=n.startAt.position.map(e=>Tf(e)).join(",")),n.endAt&&(t+=", endAt: ",t+=n.endAt.inclusive?"a:":"b:",t+=n.endAt.position.map(e=>Tf(e)).join(",")),`Target(${t})`}(wo(n))}; limitType=${n.limitType})`}function jI(n,t){return t.isFoundDocument()&&function(e,r){const s=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(s):it.isDocumentKey(e.path)?e.path.isEqual(s):e.path.isImmediateParentOf(s)}(n,t)&&function(e,r){for(const s of e.explicitOrderBy)if(!s.field.isKeyField()&&null===r.data.field(s.field))return!1;return!0}(n,t)&&function(e,r){for(const s of e.filters)if(!s.matches(r))return!1;return!0}(n,t)&&(r=t,!((e=n).startAt&&!function(s,i,o){const c=hK(s,i,o);return s.inclusive?c<=0:c<0}(e.startAt,Of(e),r)||e.endAt&&!function(s,i,o){const c=hK(s,i,o);return s.inclusive?c>=0:c>0}(e.endAt,Of(e),r)));var e,r}function vK(n){return(t,e)=>{let r=!1;for(const s of Of(n)){const i=n_e(s,t,e);if(0!==i)return i;r=r||s.field.isKeyField()}return 0}}function n_e(n,t,e){const r=n.field.isKeyField()?it.comparator(t.key,e.key):function(s,i,o){const c=i.data.field(s),u=o.data.field(s);return null!==c&&null!==u?A0(c,u):Tt()}(n.field,t,e);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Tt()}}function CK(n,t){if(n.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mg(t)?"-0":t}}function yK(n){return{integerValue:""+n}}function EK(n,t){return function eK(n){return"number"==typeof n&&Number.isInteger(n)&&!mg(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}(t)?yK(t):CK(n,t)}class fM{constructor(){this._=void 0}}function r_e(n,t,e){return n instanceof Nf?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(i.fields.__previous_value__=s),{mapValue:i}}(e,t):n instanceof Uu?SK(n,t):n instanceof Gu?PK(n,t):function(r,s){const i=MK(r,s),o=TK(i)+TK(r.yt);return $I(i)&&$I(r.yt)?yK(o):CK(r.It,o)}(n,t)}function s_e(n,t,e){return n instanceof Uu?SK(n,t):n instanceof Gu?PK(n,t):e}function MK(n,t){return n instanceof Af?$I(e=t)||(r=e)&&"doubleValue"in r?t:{integerValue:0}:null;var r,e}class Nf extends fM{}class Uu extends fM{constructor(t){super(),this.elements=t}}function SK(n,t){const e=wK(t);for(const r of n.elements)e.some(s=>E4(s,r))||e.push(r);return{arrayValue:{values:e}}}class Gu extends fM{constructor(t){super(),this.elements=t}}function PK(n,t){let e=wK(t);for(const r of n.elements)e=e.filter(s=>!E4(s,r));return{arrayValue:{values:e}}}class Af extends fM{constructor(t,e){super(),this.It=t,this.yt=e}}function TK(n){return hs(n.integerValue||n.doubleValue)}function wK(n){return vg(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Mg{constructor(t,e){this.field=t,this.transform=e}}class o_e{constructor(t,e){this.version=t,this.transformResults=e}}class Fr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Fr}static exists(t){return new Fr(void 0,t)}static updateTime(t){return new Fr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function hM(n,t){return void 0!==n.updateTime?t.isFoundDocument()&&t.version.isEqual(n.updateTime):void 0===n.exists||n.exists===t.isFoundDocument()}class dM{}function bK(n,t){if(!n.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return n.isNoDocument()?new xf(n.key,Fr.none()):new If(n.key,n.data,Fr.none());{const e=n.data,r=y2.empty();let s=new nr(Ts.comparator);for(let i of t.fields)if(!s.has(i)){let o=e.field(i);null===o&&i.length>1&&(i=i.popLast(),o=e.field(i)),null===o?r.delete(i):r.set(i,o),s=s.add(i)}return new Fl(n.key,r,new Ha(s.toArray()),Fr.none())}}function a_e(n,t,e){n instanceof If?function(r,s,i){const o=r.value.clone(),c=AK(r.fieldTransforms,s,i.transformResults);o.setAll(c),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(n,t,e):n instanceof Fl?function(r,s,i){if(!hM(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=AK(r.fieldTransforms,s,i.transformResults),c=s.data;c.setAll(NK(r)),c.setAll(o),s.convertToFoundDocument(i.version,c).setHasCommittedMutations()}(n,t,e):t.convertToNoDocument(e.version).setHasCommittedMutations()}function Sg(n,t,e,r){return n instanceof If?function(s,i,o,c){if(!hM(s.precondition,i))return o;const u=s.value.clone(),h=IK(s.fieldTransforms,c,i);return u.setAll(h),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),null}(n,t,e,r):n instanceof Fl?function(s,i,o,c){if(!hM(s.precondition,i))return o;const u=IK(s.fieldTransforms,c,i),h=i.data;return h.setAll(NK(s)),h.setAll(u),i.convertToFoundDocument(i.version,h).setHasLocalMutations(),null===o?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,t,e,r):(o=e,hM(n.precondition,i=t)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o);var i,o}function c_e(n,t){let e=null;for(const r of n.fieldTransforms){const s=t.data.field(r.field),i=MK(r.transform,s||null);null!=i&&(null===e&&(e=y2.empty()),e.set(r.field,i))}return e||null}function OK(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&(r=t.fieldTransforms,!!(void 0===(e=n.fieldTransforms)&&void 0===r||e&&r&&Sf(e,r,(s,i)=>function i_e(n,t){return n.field.isEqual(t.field)&&(r=t.transform,(e=n.transform)instanceof Uu&&r instanceof Uu||e instanceof Gu&&r instanceof Gu?Sf(e.elements,r.elements,E4):e instanceof Af&&r instanceof Af?E4(e.yt,r.yt):e instanceof Nf&&r instanceof Nf);var e,r}(s,i))))&&(0===n.type?n.value.isEqual(t.value):1!==n.type||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask));var e,r}class If extends dM{constructor(t,e,r,s=[]){super(),this.key=t,this.value=e,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Fl extends dM{constructor(t,e,r,s,i=[]){super(),this.key=t,this.data=e,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function NK(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const r=n.data.field(e);t.set(e,r)}}),t}function AK(n,t,e){const r=new Map;rn(n.length===e.length);for(let s=0;s<e.length;s++){const i=n[s],o=i.transform,c=t.data.field(i.field);r.set(i.field,s_e(o,c,e[s]))}return r}function IK(n,t,e){const r=new Map;for(const s of n){const i=s.transform,o=e.data.field(s.field);r.set(s.field,r_e(i,o,t))}return r}class xf extends dM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZI extends dM{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class l_e{constructor(t){this.count=t}}var Ws,m1;function xK(n){switch(n){default:return Tt();case Te.CANCELLED:case Te.UNKNOWN:case Te.DEADLINE_EXCEEDED:case Te.RESOURCE_EXHAUSTED:case Te.INTERNAL:case Te.UNAVAILABLE:case Te.UNAUTHENTICATED:return!1;case Te.INVALID_ARGUMENT:case Te.NOT_FOUND:case Te.ALREADY_EXISTS:case Te.PERMISSION_DENIED:case Te.FAILED_PRECONDITION:case Te.ABORTED:case Te.OUT_OF_RANGE:case Te.UNIMPLEMENTED:case Te.DATA_LOSS:return!0}}function kK(n){if(void 0===n)return Ps("GRPC error has no .code"),Te.UNKNOWN;switch(n){case Ws.OK:return Te.OK;case Ws.CANCELLED:return Te.CANCELLED;case Ws.UNKNOWN:return Te.UNKNOWN;case Ws.DEADLINE_EXCEEDED:return Te.DEADLINE_EXCEEDED;case Ws.RESOURCE_EXHAUSTED:return Te.RESOURCE_EXHAUSTED;case Ws.INTERNAL:return Te.INTERNAL;case Ws.UNAVAILABLE:return Te.UNAVAILABLE;case Ws.UNAUTHENTICATED:return Te.UNAUTHENTICATED;case Ws.INVALID_ARGUMENT:return Te.INVALID_ARGUMENT;case Ws.NOT_FOUND:return Te.NOT_FOUND;case Ws.ALREADY_EXISTS:return Te.ALREADY_EXISTS;case Ws.PERMISSION_DENIED:return Te.PERMISSION_DENIED;case Ws.FAILED_PRECONDITION:return Te.FAILED_PRECONDITION;case Ws.ABORTED:return Te.ABORTED;case Ws.OUT_OF_RANGE:return Te.OUT_OF_RANGE;case Ws.UNIMPLEMENTED:return Te.UNIMPLEMENTED;case Ws.DATA_LOSS:return Te.DATA_LOSS;default:return Tt()}}(m1=Ws||(Ws={}))[m1.OK=0]="OK",m1[m1.CANCELLED=1]="CANCELLED",m1[m1.UNKNOWN=2]="UNKNOWN",m1[m1.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",m1[m1.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",m1[m1.NOT_FOUND=5]="NOT_FOUND",m1[m1.ALREADY_EXISTS=6]="ALREADY_EXISTS",m1[m1.PERMISSION_DENIED=7]="PERMISSION_DENIED",m1[m1.UNAUTHENTICATED=16]="UNAUTHENTICATED",m1[m1.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",m1[m1.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",m1[m1.ABORTED=10]="ABORTED",m1[m1.OUT_OF_RANGE=11]="OUT_OF_RANGE",m1[m1.UNIMPLEMENTED=12]="UNIMPLEMENTED",m1[m1.INTERNAL=13]="INTERNAL",m1[m1.UNAVAILABLE=14]="UNAVAILABLE",m1[m1.DATA_LOSS=15]="DATA_LOSS";class x0{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0!==r)for(const[s,i]of r)if(this.equalsFn(s,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const r=this.mapKeyFn(t),s=this.inner[r];if(void 0===s)return this.inner[r]=[[t,e]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],t))return void(s[i]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),r=this.inner[e];if(void 0===r)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return 1===r.length?delete this.inner[e]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(t){zu(this.inner,(e,r)=>{for(const[s,i]of r)t(s,i)})}isEmpty(){return XY(this.inner)}size(){return this.innerSize}}const u_e=new fs(it.comparator);function oa(){return u_e}const LK=new fs(it.comparator);function Pg(...n){let t=LK;for(const e of n)t=t.insert(e.key,e);return t}function RK(n){let t=LK;return n.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function M4(){return Tg()}function DK(){return Tg()}function Tg(){return new x0(n=>n.toString(),(n,t)=>n.isEqual(t))}const f_e=new fs(it.comparator),h_e=new nr(it.comparator);function Nn(...n){let t=h_e;for(const e of n)t=t.add(e);return t}const d_e=new nr(vn);function pM(){return d_e}class wg{constructor(t,e,r,s,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,r){const s=new Map;return s.set(t,bg.createSynthesizedTargetChangeForCurrentChange(t,e,r)),new wg(sn.min(),s,pM(),oa(),Nn())}}class bg{constructor(t,e,r,s,i){this.resumeToken=t,this.current=e,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,r){return new bg(r,e,Nn(),Nn(),Nn())}}class gM{constructor(t,e,r,s){this.Tt=t,this.removedTargetIds=e,this.key=r,this.Et=s}}class zK{constructor(t,e){this.targetId=t,this.At=e}}class VK{constructor(t,e,r=pi.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=r,this.cause=s}}class HK{constructor(){this.Rt=0,this.bt=BK(),this.Pt=pi.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(t){t.approximateByteSize()>0&&(this.Vt=!0,this.Pt=t)}xt(){let t=Nn(),e=Nn(),r=Nn();return this.bt.forEach((s,i)=>{switch(i){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:r=r.add(s);break;default:Tt()}}),new bg(this.Pt,this.vt,t,e,r)}Nt(){this.Vt=!1,this.bt=BK()}kt(t,e){this.Vt=!0,this.bt=this.bt.insert(t,e)}Ot(t){this.Vt=!0,this.bt=this.bt.remove(t)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class p_e{constructor(t){this.Bt=t,this.Lt=new Map,this.Ut=oa(),this.qt=FK(),this.Kt=new nr(vn)}Gt(t){for(const e of t.Tt)t.Et&&t.Et.isFoundDocument()?this.Qt(e,t.Et):this.jt(e,t.key,t.Et);for(const e of t.removedTargetIds)this.jt(e,t.key,t.Et)}Wt(t){this.forEachTarget(t,e=>{const r=this.zt(e);switch(t.state){case 0:this.Ht(e)&&r.Ct(t.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(t.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(e);break;case 3:this.Ht(e)&&(r.$t(),r.Ct(t.resumeToken));break;case 4:this.Ht(e)&&(this.Jt(e),r.Ct(t.resumeToken));break;default:Tt()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Lt.forEach((r,s)=>{this.Ht(s)&&e(s)})}Yt(t){const e=t.targetId,r=t.At.count,s=this.Xt(e);if(s){const i=s.target;if(cM(i))if(0===r){const o=new it(i.path);this.jt(e,o,_r.newNoDocument(o,sn.min()))}else rn(1===r);else this.Zt(e)!==r&&(this.Jt(e),this.Kt=this.Kt.add(e))}}te(t){const e=new Map;this.Lt.forEach((i,o)=>{const c=this.Xt(o);if(c){if(i.current&&cM(c.target)){const u=new it(c.target.path);null!==this.Ut.get(u)||this.ee(o,u)||this.jt(o,u,_r.newNoDocument(u,t))}i.Dt&&(e.set(o,i.xt()),i.Nt())}});let r=Nn();this.qt.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.Xt(u);return!h||2===h.purpose||(c=!1,!1)}),c&&(r=r.add(i))}),this.Ut.forEach((i,o)=>o.setReadTime(t));const s=new wg(t,e,this.Kt,this.Ut,r);return this.Ut=oa(),this.qt=FK(),this.Kt=new nr(vn),s}Qt(t,e){if(!this.Ht(t))return;const r=this.ee(t,e.key)?2:0;this.zt(t).kt(e.key,r),this.Ut=this.Ut.insert(e.key,e),this.qt=this.qt.insert(e.key,this.ne(e.key).add(t))}jt(t,e,r){if(!this.Ht(t))return;const s=this.zt(t);this.ee(t,e)?s.kt(e,1):s.Ot(e),this.qt=this.qt.insert(e,this.ne(e).delete(t)),r&&(this.Ut=this.Ut.insert(e,r))}removeTarget(t){this.Lt.delete(t)}Zt(t){const e=this.zt(t).xt();return this.Bt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Mt(t){this.zt(t).Mt()}zt(t){let e=this.Lt.get(t);return e||(e=new HK,this.Lt.set(t,e)),e}ne(t){let e=this.qt.get(t);return e||(e=new nr(vn),this.qt=this.qt.insert(t,e)),e}Ht(t){const e=null!==this.Xt(t);return e||Ue("WatchChangeAggregator","Detected inactive target",t),e}Xt(t){const e=this.Lt.get(t);return e&&e.St?null:this.Bt.se(t)}Jt(t){this.Lt.set(t,new HK),this.Bt.getRemoteKeysForTarget(t).forEach(e=>{this.jt(t,e,null)})}ee(t,e){return this.Bt.getRemoteKeysForTarget(t).has(e)}}function FK(){return new fs(it.comparator)}function BK(){return new fs(it.comparator)}const g_e={asc:"ASCENDING",desc:"DESCENDING"},m_e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class __e{constructor(t,e){this.databaseId=t,this.gt=e}}function Og(n,t){return n.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function $K(n,t){return n.gt?t.toBase64():t.toUint8Array()}function v_e(n,t){return Og(n,t.toTimestamp())}function Vi(n){return rn(!!n),sn.fromTimestamp(function(t){const e=O0(t);return new Qr(e.seconds,e.nanos)}(n))}function YI(n,t){return(e=n,new g1(["projects",e.projectId,"databases",e.database])).child("documents").child(t).canonicalString();var e}function UK(n){const t=g1.fromString(n);return rn(XK(t)),t}function Ng(n,t){return YI(n.databaseId,t.path)}function S4(n,t){const e=UK(t);if(e.get(1)!==n.databaseId.projectId)throw new Fe(Te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Fe(Te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new it(WK(e))}function KI(n,t){return YI(n.databaseId,t)}function Ag(n){return new g1(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function WK(n){return rn(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function qK(n,t,e){return{name:Ng(n,t),fields:e.value.mapValue.fields}}function ZK(n,t){return{documents:[KI(n,t.path)]}}function QI(n,t){const e={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(e.parent=KI(n,r),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=KI(n,r.popLast()),e.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(u){if(0===u.length)return;const h=u.map(p=>function(m){if("=="===m.op){if(rK(m.value))return{unaryFilter:{field:kf(m.field),op:"IS_NAN"}};if(nK(m.value))return{unaryFilter:{field:kf(m.field),op:"IS_NULL"}}}else if("!="===m.op){if(rK(m.value))return{unaryFilter:{field:kf(m.field),op:"IS_NOT_NAN"}};if(nK(m.value))return{unaryFilter:{field:kf(m.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:kf(m.field),op:P_e(m.op),value:m.value}}}(p));return 1===h.length?h[0]:{compositeFilter:{op:"AND",filters:h}}}(t.filters);s&&(e.structuredQuery.where=s);const i=function(u){if(0!==u.length)return u.map(h=>{return{field:kf((p=h).field),direction:S_e(p.dir)};var p})}(t.orderBy);i&&(e.structuredQuery.orderBy=i);const o=(h=t.limit,n.gt||gg(h)?h:{value:h});var h,c,u;return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(e.structuredQuery.endAt={before:!(u=t.endAt).inclusive,values:u.position}),e}function YK(n){let t=function GK(n){const t=UK(n);return 4===t.length?g1.emptyPath():WK(t)}(n.parent);const e=n.structuredQuery,r=e.from?e.from.length:0;let s=null;if(r>0){rn(1===r);const p=e.from[0];p.allDescendants?s=p.collectionId:t=t.child(p.collectionId)}let i=[];e.where&&(i=KK(e.where));let o=[];e.orderBy&&(o=e.orderBy.map(p=>{return new wf(Lf((m=p).field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction));var m}));let c=null;e.limit&&(c=function(p){let m;return m="object"==typeof p?p.value:p,gg(m)?null:m}(e.limit));let u=null;var p;e.startAt&&(u=new I0((p=e.startAt).values||[],!!p.before));let h=null;return e.endAt&&(h=function(p){return new I0(p.values||[],!p.before)}(e.endAt)),function pK(n,t,e,r,s,i,o,c){return new Hl(n,t,e,r,s,i,o,c)}(t,s,o,i,c,"F",u,h)}function KK(n){return n?void 0!==n.unaryFilter?[w_e(n)]:void 0!==n.fieldFilter?[T_e(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(t=>KK(t)).reduce((t,e)=>t.concat(e)):Tt():[]}function S_e(n){return g_e[n]}function P_e(n){return m_e[n]}function kf(n){return{fieldPath:n.canonicalString()}}function Lf(n){return Ts.fromServerFormat(n.fieldPath)}function T_e(n){return E2.create(Lf(n.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Tt()}}(n.fieldFilter.op),n.fieldFilter.value)}function w_e(n){switch(n.unaryFilter.op){case"IS_NAN":const t=Lf(n.unaryFilter.field);return E2.create(t,"==",{doubleValue:NaN});case"IS_NULL":const e=Lf(n.unaryFilter.field);return E2.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Lf(n.unaryFilter.field);return E2.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Lf(n.unaryFilter.field);return E2.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Tt()}}function b_e(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function XK(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class ex{constructor(t,e,r,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(t,e){const r=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(t.key)&&a_e(i,t,r[s])}}applyToLocalView(t,e){for(const r of this.baseMutations)r.key.isEqual(t.key)&&(e=Sg(r,t,e,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(t.key)&&(e=Sg(r,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const r=DK();return this.mutations.forEach(s=>{const i=t.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=e.has(s.key)?null:c;const u=bK(o,c);null!==u&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(sn.min())}),r}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Nn())}isEqual(t){return this.batchId===t.batchId&&Sf(this.mutations,t.mutations,(e,r)=>OK(e,r))&&Sf(this.baseMutations,t.baseMutations,(e,r)=>OK(e,r))}}class tx{constructor(t,e,r,s){this.batch=t,this.commitVersion=e,this.mutationResults=r,this.docVersions=s}static from(t,e,r){rn(t.mutations.length===r.length);let s=f_e;const i=t.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new tx(t,e,r,s)}}class nx{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class k0{constructor(t,e,r,s,i=sn.min(),o=sn.min(),c=pi.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c}withSequenceNumber(t){return new k0(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new k0(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new k0(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class sX{constructor(t){this.re=t}}function rx(n){const t=YK({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?uM(t,t.limit,"L"):t}class Zu{constructor(){}ce(t,e){this.ae(t,e),e.he()}ae(t,e){if("nullValue"in t)this.le(e,5);else if("booleanValue"in t)this.le(e,10),e.fe(t.booleanValue?1:0);else if("integerValue"in t)this.le(e,15),e.fe(hs(t.integerValue));else if("doubleValue"in t){const r=hs(t.doubleValue);isNaN(r)?this.le(e,13):(this.le(e,15),mg(r)?e.fe(0):e.fe(r))}else if("timestampValue"in t){const r=t.timestampValue;this.le(e,20),"string"==typeof r?e.de(r):(e.de(`${r.seconds||""}`),e.fe(r.nanos||0))}else if("stringValue"in t)this._e(t.stringValue,e),this.we(e);else if("bytesValue"in t)this.le(e,30),e.me(Vu(t.bytesValue)),this.we(e);else if("referenceValue"in t)this.ge(t.referenceValue,e);else if("geoPointValue"in t){const r=t.geoPointValue;this.le(e,45),e.fe(r.latitude||0),e.fe(r.longitude||0)}else"mapValue"in t?sK(t)?this.le(e,Number.MAX_SAFE_INTEGER):(this.ye(t.mapValue,e),this.we(e)):"arrayValue"in t?(this.pe(t.arrayValue,e),this.we(e)):Tt()}_e(t,e){this.le(e,25),this.Ie(t,e)}Ie(t,e){e.de(t)}ye(t,e){const r=t.fields||{};this.le(e,55);for(const s of Object.keys(r))this._e(s,e),this.ae(r[s],e)}pe(t,e){const r=t.values||[];this.le(e,50);for(const s of r)this.ae(s,e)}ge(t,e){this.le(e,37),it.fromName(t).path.forEach(r=>{this.le(e,60),this.Ie(r,e)})}le(t,e){t.fe(e)}we(t){t.fe(2)}}Zu.Te=new Zu;class J_e{constructor(){this.Ye=new ix}addToCollectionParentIndex(t,e){return this.Ye.add(e),Ee.resolve()}getCollectionParents(t,e){return Ee.resolve(this.Ye.getEntries(e))}addFieldIndex(t,e){return Ee.resolve()}deleteFieldIndex(t,e){return Ee.resolve()}getDocumentsMatchingTarget(t,e){return Ee.resolve(null)}getIndexType(t,e){return Ee.resolve(0)}getFieldIndexes(t,e){return Ee.resolve([])}getNextCollectionGroupToUpdate(t){return Ee.resolve(null)}getMinOffset(t,e){return Ee.resolve(Va.min())}getMinOffsetFromCollectionGroup(t,e){return Ee.resolve(Va.min())}updateCollectionGroup(t,e,r){return Ee.resolve()}updateIndexEntries(t,e){return Ee.resolve()}}class ix{constructor(){this.index={}}add(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e]||new nr(g1.comparator),i=!s.has(r);return this.index[e]=s.add(r),i}has(t){const e=t.lastSegment(),r=t.popLast(),s=this.index[e];return s&&s.has(r)}getEntries(t){return(this.index[t]||new nr(g1.comparator)).toArray()}}new Uint8Array(0);class aa{constructor(t,e,r){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=r}static withCacheSize(t){return new aa(t,aa.DEFAULT_COLLECTION_PERCENTILE,aa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}aa.DEFAULT_COLLECTION_PERCENTILE=10,aa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,aa.DEFAULT=new aa(41943040,aa.DEFAULT_COLLECTION_PERCENTILE,aa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),aa.DISABLED=new aa(-1,0,0);class Xu{constructor(t){this.bn=t}next(){return this.bn+=2,this.bn}static Pn(){return new Xu(0)}static vn(){return new Xu(-1)}}class lve{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class TX{constructor(t,e,r,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=r,this.indexManager=s}getDocument(t,e){let r=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(r=s,this.getBaseDocument(t,e,r))).next(s=>(null!==r&&Sg(r.mutation,s,Ha.empty(),Qr.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.getLocalViewOfDocuments(t,r,Nn()).next(()=>r))}getLocalViewOfDocuments(t,e,r=Nn()){const s=M4();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,r).next(i=>{let o=Pg();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){const r=M4();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,Nn()))}populateOverlays(t,e,r){const s=[];return r.forEach(i=>{e.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(t,s).next(i=>{i.forEach((o,c)=>{e.set(o,c)})})}computeViews(t,e,r,s){let i=oa();const o=Tg(),c=Tg();return e.forEach((u,h)=>{const p=r.get(h.key);s.has(h.key)&&(void 0===p||p.mutation instanceof Fl)?i=i.insert(h.key,h):void 0!==p&&(o.set(h.key,p.mutation.getFieldMask()),Sg(p.mutation,h,p.mutation.getFieldMask(),Qr.now()))}),this.recalculateAndSaveOverlays(t,i).next(u=>(u.forEach((h,p)=>o.set(h,p)),e.forEach((h,p)=>{var m;return c.set(h,new lve(p,null!==(m=o.get(h))&&void 0!==m?m:null))}),c))}recalculateAndSaveOverlays(t,e){const r=Tg();let s=new fs((o,c)=>o-c),i=Nn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=e.get(u);if(null===h)return;let p=r.get(u)||Ha.empty();p=c.applyToLocalView(h,p),r.set(u,p);const m=(s.get(c.batchId)||Nn()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,p=u.value,m=DK();p.forEach(C=>{if(!i.has(C)){const w=bK(e.get(C),r.get(C));null!==w&&m.set(C,w),i=i.add(C)}}),o.push(this.documentOverlayCache.saveOverlays(t,h,m))}return Ee.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(r=>this.recalculateAndSaveOverlays(t,r))}getDocumentsMatchingQuery(t,e,r){return it.isDocumentKey((s=e).path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(t,e.path):WI(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,r):this.getDocumentsMatchingCollectionQuery(t,e,r);var s}getNextDocuments(t,e,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,r.largestBatchId,s-i.size):Ee.resolve(M4());let c=-1,u=i;return o.next(h=>Ee.forEach(h,(p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(p)?Ee.resolve():this.getBaseDocument(t,p,m).next(C=>{u=u.insert(p,C)}))).next(()=>this.populateOverlays(t,h,i)).next(()=>this.computeViews(t,u,h,Nn())).next(p=>({batchId:c,changes:RK(p)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new it(e)).next(r=>{let s=Pg();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,r){const s=e.collectionGroup;let i=Pg();return this.indexManager.getCollectionParents(t,s).next(o=>Ee.forEach(o,c=>{const u=(h=e,p=c.child(s),new Hl(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt));var h,p;return this.getDocumentsMatchingCollectionQuery(t,u,r).next(h=>{h.forEach((p,m)=>{i=i.insert(p,m)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(t,e,r){let s;return this.remoteDocumentCache.getAllFromCollection(t,e.path,r).next(i=>(s=i,this.documentOverlayCache.getOverlaysForCollection(t,e.path,r.largestBatchId))).next(i=>{i.forEach((c,u)=>{const h=u.getKey();null===s.get(h)&&(s=s.insert(h,_r.newInvalidDocument(h)))});let o=Pg();return s.forEach((c,u)=>{const h=i.get(c);void 0!==h&&Sg(h.mutation,u,Ha.empty(),Qr.now()),jI(e,u)&&(o=o.insert(c,u))}),o})}getBaseDocument(t,e,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(t,e):Ee.resolve(_r.newInvalidDocument(e))}}class uve{constructor(t){this.It=t,this.Zn=new Map,this.ts=new Map}getBundleMetadata(t,e){return Ee.resolve(this.Zn.get(e))}saveBundleMetadata(t,e){var r;return this.Zn.set(e.id,{id:(r=e).id,version:r.version,createTime:Vi(r.createTime)}),Ee.resolve()}getNamedQuery(t,e){return Ee.resolve(this.ts.get(e))}saveNamedQuery(t,e){return this.ts.set(e.name,{name:(r=e).name,query:rx(r.bundledQuery),readTime:Vi(r.readTime)}),Ee.resolve();var r}}class fve{constructor(){this.overlays=new fs(it.comparator),this.es=new Map}getOverlay(t,e){return Ee.resolve(this.overlays.get(e))}getOverlays(t,e){const r=M4();return Ee.forEach(e,s=>this.getOverlay(t,s).next(i=>{null!==i&&r.set(s,i)})).next(()=>r)}saveOverlays(t,e,r){return r.forEach((s,i)=>{this.ue(t,e,i)}),Ee.resolve()}removeOverlaysForBatchId(t,e,r){const s=this.es.get(r);return void 0!==s&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.es.delete(r)),Ee.resolve()}getOverlaysForCollection(t,e,r){const s=M4(),i=e.length+1,o=new it(e.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return Ee.resolve(s)}getOverlaysForCollectionGroup(t,e,r,s){let i=new fs((h,p)=>h-p);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>r){let p=i.get(h.largestBatchId);null===p&&(p=M4(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const c=M4(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,p)=>c.set(h,p)),!(c.size()>=s)););return Ee.resolve(c)}ue(t,e,r){const s=this.overlays.get(r.key);if(null!==s){const o=this.es.get(s.largestBatchId).delete(r.key);this.es.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new nx(e,r));let i=this.es.get(e);void 0===i&&(i=Nn(),this.es.set(e,i)),this.es.set(e,i.add(r.key))}}class ox{constructor(){this.ns=new nr(Fi.ss),this.rs=new nr(Fi.os)}isEmpty(){return this.ns.isEmpty()}addReference(t,e){const r=new Fi(t,e);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(t,e){t.forEach(r=>this.addReference(r,e))}removeReference(t,e){this.cs(new Fi(t,e))}hs(t,e){t.forEach(r=>this.removeReference(r,e))}ls(t){const e=new it(new g1([])),r=new Fi(e,t),s=new Fi(e,t+1),i=[];return this.rs.forEachInRange([r,s],o=>{this.cs(o),i.push(o.key)}),i}fs(){this.ns.forEach(t=>this.cs(t))}cs(t){this.ns=this.ns.delete(t),this.rs=this.rs.delete(t)}ds(t){const e=new it(new g1([])),r=new Fi(e,t),s=new Fi(e,t+1);let i=Nn();return this.rs.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(t){const e=new Fi(t,0),r=this.ns.firstAfterOrEqual(e);return null!==r&&t.isEqual(r.key)}}class Fi{constructor(t,e){this.key=t,this._s=e}static ss(t,e){return it.comparator(t.key,e.key)||vn(t._s,e._s)}static os(t,e){return vn(t._s,e._s)||it.comparator(t.key,e.key)}}class hve{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.ws=1,this.gs=new nr(Fi.ss)}checkEmpty(t){return Ee.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,r,s){const i=this.ws;this.ws++;const o=new ex(i,e,r,s);this.mutationQueue.push(o);for(const c of s)this.gs=this.gs.add(new Fi(c.key,i)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return Ee.resolve(o)}lookupMutationBatch(t,e){return Ee.resolve(this.ys(e))}getNextMutationBatchAfterBatchId(t,e){const s=this.ps(e+1),i=s<0?0:s;return Ee.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ee.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(t){return Ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const r=new Fi(e,0),s=new Fi(e,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([r,s],o=>{const c=this.ys(o._s);i.push(c)}),Ee.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let r=new nr(vn);return e.forEach(s=>{const i=new Fi(s,0),o=new Fi(s,Number.POSITIVE_INFINITY);this.gs.forEachInRange([i,o],c=>{r=r.add(c._s)})}),Ee.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(t,e){const r=e.path,s=r.length+1;let i=r;it.isDocumentKey(i)||(i=i.child(""));const o=new Fi(new it(i),0);let c=new nr(vn);return this.gs.forEachWhile(u=>{const h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(u._s)),!0)},o),Ee.resolve(this.Is(c))}Is(t){const e=[];return t.forEach(r=>{const s=this.ys(r);null!==s&&e.push(s)}),e}removeMutationBatch(t,e){rn(0===this.Ts(e.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return Ee.forEach(e.mutations,s=>{const i=new Fi(s.key,e.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.gs=r})}An(t){}containsKey(t,e){const r=new Fi(e,0),s=this.gs.firstAfterOrEqual(r);return Ee.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return Ee.resolve()}Ts(t,e){return this.ps(t)}ps(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}ys(t){const e=this.ps(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class dve{constructor(t){this.Es=t,this.docs=new fs(it.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const r=e.key,s=this.docs.get(r),i=s?s.size:0,o=this.Es(e);return this.docs=this.docs.insert(r,{document:e.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(t,r.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const r=this.docs.get(e);return Ee.resolve(r?r.document.mutableCopy():_r.newInvalidDocument(e))}getEntries(t,e){let r=oa();return e.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():_r.newInvalidDocument(s))}),Ee.resolve(r)}getAllFromCollection(t,e,r){let s=oa();const i=new it(e.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:c,value:{document:u}}=o.getNext();if(!e.isPrefixOf(c.path))break;c.path.length>e.length+1||zI(jY(u),r)<=0||(s=s.insert(u.key,u.mutableCopy()))}return Ee.resolve(s)}getAllFromCollectionGroup(t,e,r,s){Tt()}As(t,e){return Ee.forEach(this.docs,r=>e(r))}newChangeBuffer(t){return new pve(this)}getSize(t){return Ee.resolve(this.size)}}class pve extends class ove{constructor(){this.changes=new x0(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,_r.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const r=this.changes.get(e);return void 0!==r?Ee.resolve(r):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}{constructor(t){super(),this.Yn=t}applyChanges(t){const e=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?e.push(this.Yn.addEntry(t,s)):this.Yn.removeEntry(r)}),Ee.waitFor(e)}getFromCache(t,e){return this.Yn.getEntry(t,e)}getAllFromCache(t,e){return this.Yn.getEntries(t,e)}}class gve{constructor(t){this.persistence=t,this.Rs=new x0(e=>$u(e),yg),this.lastRemoteSnapshotVersion=sn.min(),this.highestTargetId=0,this.bs=0,this.Ps=new ox,this.targetCount=0,this.vs=Xu.Pn()}forEachTarget(t,e){return this.Rs.forEach((r,s)=>e(s)),Ee.resolve()}getLastRemoteSnapshotVersion(t){return Ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Ee.resolve(this.bs)}allocateTargetId(t){return this.highestTargetId=this.vs.next(),Ee.resolve(this.highestTargetId)}setTargetsMetadata(t,e,r){return r&&(this.lastRemoteSnapshotVersion=r),e>this.bs&&(this.bs=e),Ee.resolve()}Dn(t){this.Rs.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.vs=new Xu(e),this.highestTargetId=e),t.sequenceNumber>this.bs&&(this.bs=t.sequenceNumber)}addTargetData(t,e){return this.Dn(e),this.targetCount+=1,Ee.resolve()}updateTargetData(t,e){return this.Dn(e),Ee.resolve()}removeTargetData(t,e){return this.Rs.delete(e.target),this.Ps.ls(e.targetId),this.targetCount-=1,Ee.resolve()}removeTargets(t,e,r){let s=0;const i=[];return this.Rs.forEach((o,c)=>{c.sequenceNumber<=e&&null===r.get(c.targetId)&&(this.Rs.delete(o),i.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),Ee.waitFor(i).next(()=>s)}getTargetCount(t){return Ee.resolve(this.targetCount)}getTargetData(t,e){const r=this.Rs.get(e)||null;return Ee.resolve(r)}addMatchingKeys(t,e,r){return this.Ps.us(e,r),Ee.resolve()}removeMatchingKeys(t,e,r){this.Ps.hs(e,r);const s=this.persistence.referenceDelegate,i=[];return s&&e.forEach(o=>{i.push(s.markPotentiallyOrphaned(t,o))}),Ee.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Ps.ls(e),Ee.resolve()}getMatchingKeysForTargetId(t,e){const r=this.Ps.ds(e);return Ee.resolve(r)}containsKey(t,e){return Ee.resolve(this.Ps.containsKey(e))}}class wX{constructor(t,e){this.Vs={},this.overlays={},this.Ss=new ia(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=t(this),this.Cs=new gve(this),this.indexManager=new J_e,this.remoteDocumentCache=new dve(r=>this.referenceDelegate.xs(r)),this.It=new sX(e),this.Ns=new uve(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new fve,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let r=this.Vs[t.toKey()];return r||(r=new hve(e,this.referenceDelegate),this.Vs[t.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(t,e,r){Ue("MemoryPersistence","Starting transaction:",t);const s=new mve(this.Ss.next());return this.referenceDelegate.ks(),r(s).next(i=>this.referenceDelegate.Os(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ms(t,e){return Ee.or(Object.values(this.Vs).map(r=>()=>r.containsKey(t,e)))}}class mve extends class zme{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}{constructor(t){super(),this.currentSequenceNumber=t}}class PM{constructor(t){this.persistence=t,this.Fs=new ox,this.$s=null}static Bs(t){return new PM(t)}get Ls(){if(this.$s)return this.$s;throw Tt()}addReference(t,e,r){return this.Fs.addReference(r,e),this.Ls.delete(r.toString()),Ee.resolve()}removeReference(t,e,r){return this.Fs.removeReference(r,e),this.Ls.add(r.toString()),Ee.resolve()}markPotentiallyOrphaned(t,e){return this.Ls.add(e.toString()),Ee.resolve()}removeTarget(t,e){this.Fs.ls(e.targetId).forEach(s=>this.Ls.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(i=>this.Ls.add(i.toString()))}).next(()=>r.removeTargetData(t,e))}ks(){this.$s=new Set}Os(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ee.forEach(this.Ls,r=>{const s=it.fromPath(r);return this.Us(t,s).next(i=>{i||e.removeEntry(s,sn.min())})}).next(()=>(this.$s=null,e.apply(t)))}updateLimboDocument(t,e){return this.Us(t,e).next(r=>{r?this.Ls.delete(e.toString()):this.Ls.add(e.toString())})}xs(t){return 0}Us(t,e){return Ee.or([()=>Ee.resolve(this.Fs.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ms(t,e)])}}class ux{constructor(t,e,r,s){this.targetId=t,this.fromCache=e,this.Si=r,this.Di=s}static Ci(t,e){let r=Nn(),s=Nn();for(const i of e.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ux(t,e.fromCache,r,s)}}class OX{constructor(){this.xi=!1}initialize(t,e){this.Ni=t,this.indexManager=e,this.xi=!0}getDocumentsMatchingQuery(t,e,r,s){return this.ki(t,e).next(i=>i||this.Oi(t,e,s,r)).next(i=>i||this.Mi(t,e))}ki(t,e){if(gK(e))return Ee.resolve(null);let r=wo(e);return this.indexManager.getIndexType(t,r).next(s=>0===s?null:(null!==e.limit&&1===s&&(e=uM(e,null,"F"),r=wo(e)),this.indexManager.getDocumentsMatchingTarget(t,r).next(i=>{const o=Nn(...i);return this.Ni.getDocuments(t,o).next(c=>this.indexManager.getMinOffset(t,r).next(u=>{const h=this.Fi(e,c);return this.$i(e,h,o,u.readTime)?this.ki(t,uM(e,null,"F")):this.Bi(t,h,e,u)}))})))}Oi(t,e,r,s){return gK(e)||s.isEqual(sn.min())?this.Mi(t,e):this.Ni.getDocuments(t,r).next(i=>{const o=this.Fi(e,i);return this.$i(e,o,r,s)?this.Mi(t,e):(LI()<=p1.DEBUG&&Ue("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),qI(e)),this.Bi(t,o,e,function qY(n,t){const e=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=sn.fromTimestamp(1e9===r?new Qr(e+1,0):new Qr(e,r));return new Va(s,it.empty(),t)}(s,-1)))})}Fi(t,e){let r=new nr(vK(t));return e.forEach((s,i)=>{jI(t,i)&&(r=r.add(i))}),r}$i(t,e,r,s){if(null===t.limit)return!1;if(r.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Mi(t,e){return LI()<=p1.DEBUG&&Ue("QueryEngine","Using full collection scan to execute query:",qI(e)),this.Ni.getDocumentsMatchingQuery(t,e,Va.min())}Bi(t,e,r,s){return this.Ni.getDocumentsMatchingQuery(t,r,s).next(i=>(e.forEach(o=>{i=i.insert(o.key,o)}),i))}}class vve{constructor(t,e,r,s){this.persistence=t,this.Li=e,this.It=s,this.Ui=new fs(vn),this.qi=new x0(i=>$u(i),yg),this.Ki=new Map,this.Gi=t.getRemoteDocumentCache(),this.Cs=t.getTargetCache(),this.Ns=t.getBundleCache(),this.Qi(r)}Qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new TX(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Ui))}}function AX(n,t){return fx.apply(this,arguments)}function fx(){return fx=A(function*(n,t){const e=ct(n);return yield e.persistence.runTransaction("Handle user change","readonly",r=>{let s;return e.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,e.Qi(t),e.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=Nn();for(const h of s){o.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}for(const h of i){c.push(h.batchId);for(const p of h.mutations)u=u.add(p.key)}return e.localDocuments.getDocuments(r,u).next(h=>({ji:h,removedBatchIds:o,addedBatchIds:c}))})})}),fx.apply(this,arguments)}function Cve(n,t){const e=ct(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=t.batch.keys(),i=e.Gi.newChangeBuffer({trackRemovals:!0});return function(o,c,u,h){const p=u.batch,m=p.keys();let C=Ee.resolve();return m.forEach(w=>{C=C.next(()=>h.getEntry(c,w)).next(I=>{const H=u.docVersions.get(w);rn(null!==H),I.version.compareTo(H)<0&&(p.applyToRemoteDocument(I,u),I.isValidDocument()&&(I.setReadTime(u.commitVersion),h.addEntry(I)))})}),C.next(()=>o.mutationQueue.removeMutationBatch(c,p))}(e,r,t,i).next(()=>i.apply(r)).next(()=>e.mutationQueue.performConsistencyCheck(r)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(r,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let c=Nn();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(c=c.add(o.batch.mutations[u].key));return c}(t))).next(()=>e.localDocuments.getDocuments(r,s))})}function IX(n){const t=ct(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function yve(n,t){const e=ct(n),r=t.snapshotVersion;let s=e.Ui;return e.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=e.Gi.newChangeBuffer({trackRemovals:!0});s=e.Ui;const c=[];t.targetChanges.forEach((p,m)=>{const C=s.get(m);if(!C)return;c.push(e.Cs.removeMatchingKeys(i,p.removedDocuments,m).next(()=>e.Cs.addMatchingKeys(i,p.addedDocuments,m)));let w=C.withSequenceNumber(i.currentSequenceNumber);var I,H,Y;t.targetMismatches.has(m)?w=w.withResumeToken(pi.EMPTY_BYTE_STRING,sn.min()).withLastLimboFreeSnapshotVersion(sn.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,r)),s=s.insert(m,w),H=w,Y=p,(0===(I=C).resumeToken.approximateByteSize()||H.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=3e8||Y.addedDocuments.size+Y.modifiedDocuments.size+Y.removedDocuments.size>0)&&c.push(e.Cs.updateTargetData(i,w))});let u=oa(),h=Nn();if(t.documentUpdates.forEach(p=>{t.resolvedLimboDocuments.has(p)&&c.push(e.persistence.referenceDelegate.updateLimboDocument(i,p))}),c.push(function xX(n,t,e){let r=Nn(),s=Nn();return e.forEach(i=>r=r.add(i)),t.getEntries(n,r).next(i=>{let o=oa();return e.forEach((c,u)=>{const h=i.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(sn.min())?(t.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||0===u.version.compareTo(h.version)&&h.hasPendingWrites?(t.addEntry(u),o=o.insert(c,u)):Ue("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Wi:o,zi:s}})}(i,o,t.documentUpdates).next(p=>{u=p.Wi,h=p.zi})),!r.isEqual(sn.min())){const p=e.Cs.getLastRemoteSnapshotVersion(i).next(m=>e.Cs.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(p)}return Ee.waitFor(c).next(()=>o.apply(i)).next(()=>e.localDocuments.getLocalViewOfDocuments(i,u,h)).next(()=>u)}).then(i=>(e.Ui=s,i))}function Eve(n,t){const e=ct(n);return e.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(r,t)))}function zf(n,t){const e=ct(n);return e.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return e.Cs.getTargetData(r,t).next(i=>i?(s=i,Ee.resolve(s)):e.Cs.allocateTargetId(r).next(o=>(s=new k0(t,o,0,r.currentSequenceNumber),e.Cs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=e.Ui.get(r.targetId);return(null===s||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ui=e.Ui.insert(r.targetId,r),e.qi.set(t,r.targetId)),r})}function Vf(n,t,e){return hx.apply(this,arguments)}function hx(){return hx=A(function*(n,t,e){const r=ct(n),s=r.Ui.get(t),i=e?"readwrite":"readwrite-primary";try{e||(yield r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!b0(o))throw o;Ue("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ui=r.Ui.remove(t),r.qi.delete(s.target)}),hx.apply(this,arguments)}function wM(n,t,e){const r=ct(n);let s=sn.min(),i=Nn();return r.persistence.runTransaction("Execute query","readonly",o=>function(c,u,h){const p=ct(c),m=p.qi.get(h);return void 0!==m?Ee.resolve(p.Ui.get(m)):p.Cs.getTargetData(u,h)}(r,o,wo(t)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Li.getDocumentsMatchingQuery(o,t,e?s:sn.min(),e?i:Nn())).next(c=>(function RX(n,t,e){let r=n.Ki.get(t)||sn.min();e.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.Ki.set(t,r)}(r,function _K(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}(t),c),{documents:c,Hi:i})))}class _x{constructor(){this.activeTargetIds=pM()}er(t){this.activeTargetIds=this.activeTargetIds.add(t)}nr(t){this.activeTargetIds=this.activeTargetIds.delete(t)}tr(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class VX{constructor(){this.Lr=new _x,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,r){}addLocalQueryTarget(t){return this.Lr.er(t),this.Ur[t]||"not-current"}updateQueryState(t,e,r){this.Ur[t]=e}removeLocalQueryTarget(t){this.Lr.nr(t)}isLocalQueryTarget(t){return this.Lr.activeTargetIds.has(t)}clearQueryState(t){delete this.Ur[t]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(t){return this.Lr.activeTargetIds.has(t)}start(){return this.Lr=new _x,Promise.resolve()}handleUserChange(t,e,r){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Pve{qr(t){}shutdown(){}}class HX{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(t){this.Wr.push(t)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){Ue("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Wr)t(0)}jr(){Ue("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Wr)t(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Tve={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class wve{constructor(t){this.Hr=t.Hr,this.Jr=t.Jr}Yr(t){this.Xr=t}Zr(t){this.eo=t}onMessage(t){this.no=t}close(){this.Jr()}send(t){this.Hr(t)}so(){this.Xr()}io(t){this.eo(t)}ro(t){this.no(t)}}class bve extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId,this.oo=(t.ssl?"https":"http")+"://"+t.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(t,e,r,s,i){const o=this.ho(t,e);Ue("RestConnection","Sending: ",o,r);const c={};return this.lo(c,s,i),this.fo(t,o,c,r).then(u=>(Ue("RestConnection","Received: ",u),u),u=>{throw Mf("RestConnection",`${t} failed with error: `,u,"url: ",o,"request:",r),u})}_o(t,e,r,s,i,o){return this.ao(t,e,r,s,i)}lo(t,e,r){t["X-Goog-Api-Client"]="gl-js/ fire/"+Ef,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((s,i)=>t[i]=s),r&&r.headers.forEach((s,i)=>t[i]=s)}ho(t,e){return`${this.oo}/v1/${e}:${Tve[t]}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}fo(t,e,r,s){return new Promise((i,o)=>{const c=new wme;c.setWithCredentials(!0),c.listenOnce(Sme.COMPLETE,()=>{var h;try{switch(c.getLastErrorCode()){case kI.NO_ERROR:const p=c.getResponseJson();Ue("Connection","XHR received:",JSON.stringify(p)),i(p);break;case kI.TIMEOUT:Ue("Connection",'RPC "'+t+'" timed out'),o(new Fe(Te.DEADLINE_EXCEEDED,"Request time out"));break;case kI.HTTP_ERROR:const m=c.getStatus();if(Ue("Connection",'RPC "'+t+'" failed with status:',m,"response text:",c.getResponseText()),m>0){let C=c.getResponseJson();Array.isArray(C)&&(C=C[0]);const w=null===(h=C)||void 0===h?void 0:h.error;if(w&&w.status&&w.message){const I=function(H){const Y=H.toLowerCase().replace(/_/g,"-");return Object.values(Te).indexOf(Y)>=0?Y:Te.UNKNOWN}(w.status);o(new Fe(I,w.message))}else o(new Fe(Te.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Fe(Te.UNAVAILABLE,"Connection failed."));break;default:Tt()}}finally{Ue("Connection",'RPC "'+t+'" completed.')}});const u=JSON.stringify(s);c.send(e,"POST",u,r,15)})}wo(t,e,r){const s=[this.oo,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=Eme(),o=Mme(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new Tme({})),this.lo(c.initMessageHeaders,e,r),c.encodeInitMessageHeaders=!0;const u=s.join("");Ue("Connection","Creating WebChannel: "+u,c);const h=i.createWebChannel(u,c);let p=!1,m=!1;const C=new wve({Hr:I=>{m?Ue("Connection","Not sending because WebChannel is closed:",I):(p||(Ue("Connection","Opening WebChannel transport."),h.open(),p=!0),Ue("Connection","WebChannel sending:",I),h.send(I))},Jr:()=>h.close()}),w=(I,H,Y)=>{I.listen(H,ee=>{try{Y(ee)}catch(ve){setTimeout(()=>{throw ve},0)}})};return w(h,tM.EventType.OPEN,()=>{m||Ue("Connection","WebChannel transport opened.")}),w(h,tM.EventType.CLOSE,()=>{m||(m=!0,Ue("Connection","WebChannel transport closed"),C.io())}),w(h,tM.EventType.ERROR,I=>{m||(m=!0,Mf("Connection","WebChannel transport errored:",I),C.io(new Fe(Te.UNAVAILABLE,"The operation could not be completed")))}),w(h,tM.EventType.MESSAGE,I=>{var H;if(!m){const Y=I.data[0];rn(!!Y);const ee=Y,ve=ee.error||(null===(H=ee[0])||void 0===H?void 0:H.error);if(ve){Ue("Connection","WebChannel received error:",ve);const te=ve.status;let Ie=function(Ye){const Vt=Ws[Ye];if(void 0!==Vt)return kK(Vt)}(te),Be=ve.message;void 0===Ie&&(Ie=Te.INTERNAL,Be="Unknown error status: "+te+" with message "+ve.message),m=!0,C.io(new Fe(Ie,Be)),h.close()}else Ue("Connection","WebChannel received:",Y),C.ro(Y)}}),w(o,Pme.STAT_EVENT,I=>{I.stat===FY.PROXY?Ue("Connection","Detected buffering proxy"):I.stat===FY.NOPROXY&&Ue("Connection","Detected no buffering proxy")}),setTimeout(()=>{C.so()},0),C}}function NM(){return typeof document<"u"?document:null}function Fg(n){return new __e(n,!0)}class Cx{constructor(t,e,r=1e3,s=1.5,i=6e4){this.Hs=t,this.timerId=e,this.mo=r,this.yo=s,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(t){this.cancel();const e=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),s=Math.max(0,e-r);s>0&&Ue("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Io} ms, delay with jitter: ${e} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,s,()=>(this.Eo=Date.now(),t())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class BX{constructor(t,e,r,s,i,o,c,u){this.Hs=t,this.vo=r,this.Vo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new Cx(t,e)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var t=this;return A(function*(){t.No()&&(yield t.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(t){this.Lo(),this.stream.send(t)}$o(){var t=this;return A(function*(){if(t.ko())return t.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(t,e){var r=this;return A(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():e&&e.code===Te.RESOURCE_EXHAUSTED?(Ps(e.toString()),Ps("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):e&&e.code===Te.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,yield r.listener.Zr(e)})()}qo(){}auth(){this.state=1;const t=this.Ko(this.So),e=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.So===e&&this.Go(r,s)},r=>{t(()=>{const s=new Fe(Te.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(s)})})}Go(t,e){const r=this.Ko(this.So);this.stream=this.jo(t,e),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(s=>{r(()=>this.Qo(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Oo(){var t=this;this.state=5,this.xo.Ro(A(function*(){t.state=0,t.start()}))}Qo(t){return Ue("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Ko(t){return e=>{this.Hs.enqueueAndForget(()=>this.So===t?e():(Ue("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ove extends BX{constructor(t,e,r,s,i,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,r,s,o),this.It=i}jo(t,e){return this.connection.wo("Listen",t,e)}onMessage(t){this.xo.reset();const e=function y_e(n,t){let e;if("targetChange"in t){const r="NO_CHANGE"===(u=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Tt(),s=t.targetChange.targetIds||[],i=function(u,h){return u.gt?(rn(void 0===h||"string"==typeof h),pi.fromBase64String(h||"")):(rn(void 0===h||h instanceof Uint8Array),pi.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,c=o&&function(u){const h=void 0===u.code?Te.UNKNOWN:kK(u.code);return new Fe(h,u.message||"")}(o);e=new VK(r,s,i,c||null)}else if("documentChange"in t){const r=t.documentChange,s=S4(n,r.document.name),i=Vi(r.document.updateTime),o=new y2({mapValue:{fields:r.document.fields}}),c=_r.newFoundDocument(s,i,o);e=new gM(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,s=S4(n,r.document),i=r.readTime?Vi(r.readTime):sn.min(),o=_r.newNoDocument(s,i);e=new gM([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,s=S4(n,r.document);e=new gM([],r.removedTargetIds||[],s,null)}else{if(!("filter"in t))return Tt();{const r=t.filter,i=new l_e(r.count||0);e=new zK(r.targetId,i)}}var u;return e}(this.It,t),r=function(s){if(!("targetChange"in s))return sn.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?sn.min():i.readTime?Vi(i.readTime):sn.min()}(t);return this.listener.Wo(e,r)}zo(t){const e={};e.database=Ag(this.It),e.addTarget=function(s,i){let o;const c=i.target;return o=cM(c)?{documents:ZK(s,c)}:{query:QI(s,c)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=$K(s,i.resumeToken):i.snapshotVersion.compareTo(sn.min())>0&&(o.readTime=Og(s,i.snapshotVersion.toTimestamp())),o}(this.It,t);const r=function M_e(n,t){const e=function(r,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Tt()}}(0,t.purpose);return null==e?null:{"goog-listen-tags":e}}(0,t);r&&(e.labels=r),this.Bo(e)}Ho(t){const e={};e.database=Ag(this.It),e.removeTarget=t,this.Bo(e)}}class Nve extends BX{constructor(t,e,r,s,i,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,r,s,o),this.It=i,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(t,e){return this.connection.wo("Write",t,e)}onMessage(t){if(rn(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Jo){this.xo.reset();const e=function E_e(n,t){return n&&n.length>0?(rn(void 0!==t),n.map(e=>function(r,s){let i=Vi(r.updateTime?r.updateTime:s);return i.isEqual(sn.min())&&(i=Vi(s)),new o_e(i,r.transformResults||[])}(e,t))):[]}(t.writeResults,t.commitTime),r=Vi(t.commitTime);return this.listener.Zo(r,e)}return rn(!t.writeResults||0===t.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const t={};t.database=Ag(this.It),this.Bo(t)}Xo(t){const e={streamToken:this.lastStreamToken,writes:t.map(r=>function Ig(n,t){let e;if(t instanceof If)e={update:qK(n,t.key,t.value)};else if(t instanceof xf)e={delete:Ng(n,t.key)};else if(t instanceof Fl)e={update:qK(n,t.key,t.data),updateMask:b_e(t.fieldMask)};else{if(!(t instanceof ZI))return Tt();e={verify:Ng(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof Nf)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Uu)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Gu)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Af)return{fieldPath:i.field.canonicalString(),increment:o.yt};throw Tt()}(0,r))),t.precondition.isNone||(e.currentDocument=void 0!==(s=t.precondition).updateTime?{updateTime:v_e(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Tt()),e;var s}(this.It,r))};this.Bo(e)}}class Ave extends class{}{constructor(t,e,r,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=r,this.It=s,this.nu=!1}su(){if(this.nu)throw new Fe(Te.FAILED_PRECONDITION,"The client has already been terminated.")}ao(t,e,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.ao(t,e,r,s,i)).catch(s=>{throw"FirebaseError"===s.name?(s.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Fe(Te.UNKNOWN,s.toString())})}_o(t,e,r,s){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection._o(t,e,r,i,o,s)).catch(i=>{throw"FirebaseError"===i.name?(i.code===Te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Fe(Te.UNKNOWN,i.toString())})}terminate(){this.nu=!0}}class xve{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(t){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.cu("Offline")))}set(t){this.lu(),this.iu=0,"Online"===t&&(this.ou=!1),this.cu(t)}cu(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}au(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(Ps(e),this.ou=!1):Ue("OnlineStateTracker",e)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class kve{constructor(t,e,r,s,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr(c=>{r.enqueueAndForget(A(function*(){var u;Bl(o)&&(Ue("RemoteStore","Restarting streams for network reachability change."),yield(u=A(function*(h){const p=ct(h);p._u.add(4),yield Hf(p),p.gu.set("Unknown"),p._u.delete(4),yield Bg(p)}),function(h){return u.apply(this,arguments)})(o))}))}),this.gu=new xve(r,s)}}function Bg(n){return Ex.apply(this,arguments)}function Ex(){return Ex=A(function*(n){if(Bl(n))for(const t of n.wu)yield t(!0)}),Ex.apply(this,arguments)}function Hf(n){return Mx.apply(this,arguments)}function Mx(){return Mx=A(function*(n){for(const t of n.wu)yield t(!1)}),Mx.apply(this,arguments)}function AM(n,t){const e=ct(n);e.du.has(t.targetId)||(e.du.set(t.targetId,t),Tx(e)?Px(e):Bf(e).ko()&&Sx(e,t))}function $g(n,t){const e=ct(n),r=Bf(e);e.du.delete(t),r.ko()&&$X(e,t),0===e.du.size&&(r.ko()?r.Fo():Bl(e)&&e.gu.set("Unknown"))}function Sx(n,t){n.yu.Mt(t.targetId),Bf(n).zo(t)}function $X(n,t){n.yu.Mt(t),Bf(n).Ho(t)}function Px(n){n.yu=new p_e({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),se:t=>n.du.get(t)||null}),Bf(n).start(),n.gu.uu()}function Tx(n){return Bl(n)&&!Bf(n).No()&&n.du.size>0}function Bl(n){return 0===ct(n)._u.size}function UX(n){n.yu=void 0}function Lve(n){return wx.apply(this,arguments)}function wx(){return wx=A(function*(n){n.du.forEach((t,e)=>{Sx(n,t)})}),wx.apply(this,arguments)}function Rve(n,t){return bx.apply(this,arguments)}function bx(){return bx=A(function*(n,t){UX(n),Tx(n)?(n.gu.hu(t),Px(n)):n.gu.set("Unknown")}),bx.apply(this,arguments)}function Dve(n,t,e){return Ox.apply(this,arguments)}function Ox(){return Ox=A(function*(n,t,e){if(n.gu.set("Online"),t instanceof VK&&2===t.state&&t.cause)try{yield(r=A(function*(s,i){const o=i.cause;for(const c of i.targetIds)s.du.has(c)&&(yield s.remoteSyncer.rejectListen(c,o),s.du.delete(c),s.yu.removeTarget(c))}),function(s,i){return r.apply(this,arguments)})(n,t)}catch(r){Ue("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),yield IM(n,r)}else if(t instanceof gM?n.yu.Gt(t):t instanceof zK?n.yu.Yt(t):n.yu.Wt(t),!e.isEqual(sn.min()))try{const r=yield IX(n.localStore);e.compareTo(r)>=0&&(yield function(s,i){const o=s.yu.te(i);return o.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=s.du.get(u);h&&s.du.set(u,h.withResumeToken(c.resumeToken,i))}}),o.targetMismatches.forEach(c=>{const u=s.du.get(c);if(!u)return;s.du.set(c,u.withResumeToken(pi.EMPTY_BYTE_STRING,u.snapshotVersion)),$X(s,c);const h=new k0(u.target,c,1,u.sequenceNumber);Sx(s,h)}),s.remoteSyncer.applyRemoteEvent(o)}(n,e))}catch(r){Ue("RemoteStore","Failed to raise snapshot:",r),yield IM(n,r)}var r}),Ox.apply(this,arguments)}function IM(n,t,e){return Nx.apply(this,arguments)}function Nx(){return Nx=A(function*(n,t,e){if(!b0(t))throw t;n._u.add(1),yield Hf(n),n.gu.set("Offline"),e||(e=()=>IX(n.localStore)),n.asyncQueue.enqueueRetryable(A(function*(){Ue("RemoteStore","Retrying IndexedDB access"),yield e(),n._u.delete(1),yield Bg(n)}))}),Nx.apply(this,arguments)}function GX(n,t){return t().catch(e=>IM(n,e,t))}function Ff(n){return Ax.apply(this,arguments)}function Ax(){return Ax=A(function*(n){const t=ct(n),e=D0(t);let r=t.fu.length>0?t.fu[t.fu.length-1].batchId:-1;for(;zve(t);)try{const s=yield Eve(t.localStore,r);if(null===s){0===t.fu.length&&e.Fo();break}r=s.batchId,Vve(t,s)}catch(s){yield IM(t,s)}WX(t)&&qX(t)}),Ax.apply(this,arguments)}function zve(n){return Bl(n)&&n.fu.length<10}function Vve(n,t){n.fu.push(t);const e=D0(n);e.ko()&&e.Yo&&e.Xo(t.mutations)}function WX(n){return Bl(n)&&!D0(n).No()&&n.fu.length>0}function qX(n){D0(n).start()}function Hve(n){return Ix.apply(this,arguments)}function Ix(){return Ix=A(function*(n){D0(n).eu()}),Ix.apply(this,arguments)}function Fve(n){return xx.apply(this,arguments)}function xx(){return xx=A(function*(n){const t=D0(n);for(const e of n.fu)t.Xo(e.mutations)}),xx.apply(this,arguments)}function Bve(n,t,e){return kx.apply(this,arguments)}function kx(){return kx=A(function*(n,t,e){const r=n.fu.shift(),s=tx.from(r,t,e);yield GX(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield Ff(n)}),kx.apply(this,arguments)}function $ve(n,t){return Lx.apply(this,arguments)}function Lx(){return Lx=A(function*(n,t){var e;t&&D0(n).Yo&&(yield(e=A(function*(r,s){if(xK(i=s.code)&&i!==Te.ABORTED){const o=r.fu.shift();D0(r).Mo(),yield GX(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield Ff(r)}var i}),function(r,s){return e.apply(this,arguments)})(n,t)),WX(n)&&qX(n)}),Lx.apply(this,arguments)}function jX(n,t){return Rx.apply(this,arguments)}function Rx(){return Rx=A(function*(n,t){const e=ct(n);e.asyncQueue.verifyOperationInProgress(),Ue("RemoteStore","RemoteStore received new credentials");const r=Bl(e);e._u.add(3),yield Hf(e),r&&e.gu.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e._u.delete(3),yield Bg(e)}),Rx.apply(this,arguments)}function zx(){return zx=A(function*(n,t){const e=ct(n);t?(e._u.delete(2),yield Bg(e)):t||(e._u.add(2),yield Hf(e),e.gu.set("Unknown"))}),zx.apply(this,arguments)}function Bf(n){return n.pu||(n.pu=function(t,e,r){const s=ct(t);return s.su(),new Ove(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:Lve.bind(null,n),Zr:Rve.bind(null,n),Wo:Dve.bind(null,n)}),n.wu.push(function(){var t=A(function*(e){e?(n.pu.Mo(),Tx(n)?Px(n):n.gu.set("Unknown")):(yield n.pu.stop(),UX(n))});return function(e){return t.apply(this,arguments)}}())),n.pu}function D0(n){return n.Iu||(n.Iu=function(t,e,r){const s=ct(t);return s.su(),new Nve(e,s.connection,s.authCredentials,s.appCheckCredentials,s.It,r)}(n.datastore,n.asyncQueue,{Yr:Hve.bind(null,n),Zr:$ve.bind(null,n),tu:Fve.bind(null,n),Zo:Bve.bind(null,n)}),n.wu.push(function(){var t=A(function*(e){e?(n.Iu.Mo(),yield Ff(n)):(yield n.Iu.stop(),n.fu.length>0&&(Ue("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(e){return t.apply(this,arguments)}}())),n.Iu}class Vx{constructor(t,e,r,s,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(t,e,r,s,i){const o=Date.now()+r,c=new Vx(t,e,o,s,i);return c.start(r),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Fe(Te.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $f(n,t){if(Ps("AsyncQueue",`${t}: ${n}`),b0(n))return new Fe(Te.UNAVAILABLE,`${t}: ${n}`);throw n}class Uf{constructor(t){this.comparator=t?(e,r)=>t(e,r)||it.comparator(e.key,r.key):(e,r)=>it.comparator(e.key,r.key),this.keyedMap=Pg(),this.sortedSet=new fs(this.comparator)}static emptySet(t){return new Uf(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,r)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof Uf)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const r=new Uf;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=e,r}}class ZX{constructor(){this.Tu=new fs(it.comparator)}track(t){const e=t.doc.key,r=this.Tu.get(e);r?0!==t.type&&3===r.type?this.Tu=this.Tu.insert(e,t):3===t.type&&1!==r.type?this.Tu=this.Tu.insert(e,{type:r.type,doc:t.doc}):2===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===r.type?this.Tu=this.Tu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===r.type?this.Tu=this.Tu.remove(e):1===t.type&&2===r.type?this.Tu=this.Tu.insert(e,{type:1,doc:r.doc}):0===t.type&&1===r.type?this.Tu=this.Tu.insert(e,{type:2,doc:t.doc}):Tt():this.Tu=this.Tu.insert(e,t)}Eu(){const t=[];return this.Tu.inorderTraversal((e,r)=>{t.push(r)}),t}}class Gf{constructor(t,e,r,s,i,o,c,u,h){this.query=t,this.docs=e,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(t,e,r,s,i){const o=[];return e.forEach(c=>{o.push({type:0,doc:c})}),new Gf(t,e,Uf.emptySet(e),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Eg(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,r=t.docChanges;if(e.length!==r.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==r[s].type||!e[s].doc.isEqual(r[s].doc))return!1;return!0}}class Uve{constructor(){this.Au=void 0,this.listeners=[]}}class Gve{constructor(){this.queries=new x0(t=>mK(t),Eg),this.onlineState="Unknown",this.Ru=new Set}}function Hx(n,t){return Fx.apply(this,arguments)}function Fx(){return Fx=A(function*(n,t){const e=ct(n),r=t.query;let s=!1,i=e.queries.get(r);if(i||(s=!0,i=new Uve),s)try{i.Au=yield e.onListen(r)}catch(o){const c=$f(o,`Initialization of query '${qI(t.query)}' failed`);return void t.onError(c)}e.queries.set(r,i),i.listeners.push(t),t.bu(e.onlineState),i.Au&&t.Pu(i.Au)&&Ux(e)}),Fx.apply(this,arguments)}function Bx(n,t){return $x.apply(this,arguments)}function $x(){return $x=A(function*(n,t){const e=ct(n),r=t.query;let s=!1;const i=e.queries.get(r);if(i){const o=i.listeners.indexOf(t);o>=0&&(i.listeners.splice(o,1),s=0===i.listeners.length)}if(s)return e.queries.delete(r),e.onUnlisten(r)}),$x.apply(this,arguments)}function Wve(n,t){const e=ct(n);let r=!1;for(const s of t){const o=e.queries.get(s.query);if(o){for(const c of o.listeners)c.Pu(s)&&(r=!0);o.Au=s}}r&&Ux(e)}function qve(n,t,e){const r=ct(n),s=r.queries.get(t);if(s)for(const i of s.listeners)i.onError(e);r.queries.delete(t)}function Ux(n){n.Ru.forEach(t=>{t.next()})}class Gx{constructor(t,e,r){this.query=t,this.vu=e,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(t){if(!this.options.includeMetadataChanges){const r=[];for(const s of t.docChanges)3!==s.type&&r.push(s);t=new Gf(t.query,t.docs,t.oldDocs,r,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Vu?this.Du(t)&&(this.vu.next(t),e=!0):this.Cu(t,this.onlineState)&&(this.xu(t),e=!0),this.Su=t,e}onError(t){this.vu.error(t)}bu(t){this.onlineState=t;let e=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,t)&&(this.xu(this.Su),e=!0),e}Cu(t,e){return!t.fromCache||(!this.options.Nu||!("Offline"!==e))&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Du(t){return t.docChanges.length>0||!!(t.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(t){t=Gf.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Vu=!0,this.vu.next(t)}}class XX{constructor(t){this.key=t}}class QX{constructor(t){this.key=t}}class JX{constructor(t,e){this.query=t,this.Uu=e,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Nn(),this.mutatedKeys=Nn(),this.Gu=vK(t),this.Qu=new Uf(this.Gu)}get ju(){return this.Uu}Wu(t,e){const r=e?e.zu:new ZX,s=e?e.Qu:this.Qu;let i=e?e.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u="F"===this.query.limitType&&s.size===this.query.limit?s.last():null,h="L"===this.query.limitType&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal((p,m)=>{const C=s.get(p),w=jI(this.query,m)?m:null,I=!!C&&this.mutatedKeys.has(C.key),H=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let Y=!1;C&&w?C.data.isEqual(w.data)?I!==H&&(r.track({type:3,doc:w}),Y=!0):this.Hu(C,w)||(r.track({type:2,doc:w}),Y=!0,(u&&this.Gu(w,u)>0||h&&this.Gu(w,h)<0)&&(c=!0)):!C&&w?(r.track({type:0,doc:w}),Y=!0):C&&!w&&(r.track({type:1,doc:C}),Y=!0,(u||h)&&(c=!0)),Y&&(w?(o=o.add(w),i=H?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const p="F"===this.query.limitType?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),r.track({type:1,doc:p})}return{Qu:o,zu:r,$i:c,mutatedKeys:i}}Hu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,r){const s=this.Qu;this.Qu=t.Qu,this.mutatedKeys=t.mutatedKeys;const i=t.zu.Eu();i.sort((h,p)=>function(m,C){const w=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Tt()}};return w(m)-w(C)}(h.type,p.type)||this.Gu(h.doc,p.doc)),this.Ju(r);const o=e?this.Yu():[],c=0===this.Ku.size&&this.current?1:0,u=c!==this.qu;return this.qu=c,0!==i.length||u?{snapshot:new Gf(this.query,t.Qu,s,i,t.mutatedKeys,0===c,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:o}:{Xu:o}}bu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new ZX,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(t){return!this.Uu.has(t)&&!!this.Qu.has(t)&&!this.Qu.get(t).hasLocalMutations}Ju(t){t&&(t.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=t.current)}Yu(){if(!this.current)return[];const t=this.Ku;this.Ku=Nn(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const e=[];return t.forEach(r=>{this.Ku.has(r)||e.push(new QX(r))}),this.Ku.forEach(r=>{t.has(r)||e.push(new XX(r))}),e}tc(t){this.Uu=t.Hi,this.Ku=Nn();const e=this.Wu(t.documents);return this.applyChanges(e,!0)}ec(){return Gf.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class Yve{constructor(t,e,r){this.query=t,this.targetId=e,this.view=r}}class Kve{constructor(t){this.key=t,this.nc=!1}}class Xve{constructor(t,e,r,s,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new x0(c=>mK(c),Eg),this.rc=new Map,this.oc=new Set,this.uc=new fs(it.comparator),this.cc=new Map,this.ac=new ox,this.hc={},this.lc=new Map,this.fc=Xu.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function Qve(n,t){return Wx.apply(this,arguments)}function Wx(){return Wx=A(function*(n,t){const e=pk(n);let r,s;const i=e.ic.get(t);if(i)r=i.targetId,e.sharedClientState.addLocalQueryTarget(r),s=i.view.ec();else{const o=yield zf(e.localStore,wo(t));e.isPrimaryClient&&AM(e.remoteStore,o);const c=e.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=yield qx(e,t,r,"current"===c,o.resumeToken)}return s}),Wx.apply(this,arguments)}function qx(n,t,e,r,s){return jx.apply(this,arguments)}function jx(){return jx=A(function*(n,t,e,r,s){n._c=(m,C,w)=>{return(I=A(function*(H,Y,ee,ve){let te=Y.view.Wu(ee);te.$i&&(te=yield wM(H.localStore,Y.query,!1).then(({documents:Ye})=>Y.view.Wu(Ye,te)));const Ie=ve&&ve.targetChanges.get(Y.targetId),Be=Y.view.applyChanges(te,H.isPrimaryClient,Ie);return rk(H,Y.targetId,Be.Xu),Be.snapshot}),function(H,Y,ee,ve){return I.apply(this,arguments)})(n,m,C,w);var I};const i=yield wM(n.localStore,t,!0),o=new JX(t,i.Hi),c=o.Wu(i.documents),u=bg.createSynthesizedTargetChangeForCurrentChange(e,r&&"Offline"!==n.onlineState,s),h=o.applyChanges(c,n.isPrimaryClient,u);rk(n,e,h.Xu);const p=new Yve(t,e,o);return n.ic.set(t,p),n.rc.has(e)?n.rc.get(e).push(t):n.rc.set(e,[t]),h.snapshot}),jx.apply(this,arguments)}function Jve(n,t){return Zx.apply(this,arguments)}function Zx(){return Zx=A(function*(n,t){const e=ct(n),r=e.ic.get(t),s=e.rc.get(r.targetId);if(s.length>1)return e.rc.set(r.targetId,s.filter(i=>!Eg(i,t))),void e.ic.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(r.targetId),e.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Vf(e.localStore,r.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(r.targetId),$g(e.remoteStore,r.targetId),Wf(e,r.targetId)}).catch(w0))):(Wf(e,r.targetId),yield Vf(e.localStore,r.targetId,!0))}),Zx.apply(this,arguments)}function Yx(){return Yx=A(function*(n,t,e){const r=gk(n);try{const s=yield function(i,o){const c=ct(i),u=Qr.now(),h=o.reduce((C,w)=>C.add(w.key),Nn());let p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",C=>{let w=oa(),I=Nn();return c.Gi.getEntries(C,h).next(H=>{w=H,w.forEach((Y,ee)=>{ee.isValidDocument()||(I=I.add(Y))})}).next(()=>c.localDocuments.getOverlayedDocuments(C,w)).next(H=>{p=H;const Y=[];for(const ee of o){const ve=c_e(ee,p.get(ee.key).overlayedDocument);null!=ve&&Y.push(new Fl(ee.key,ve,aK(ve.value.mapValue),Fr.exists(!0)))}return c.mutationQueue.addMutationBatch(C,u,Y,o)}).next(H=>{m=H;const Y=H.applyToLocalDocumentSet(p,I);return c.documentOverlayCache.saveOverlays(C,H.batchId,Y)})}).then(()=>({batchId:m.batchId,changes:RK(p)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,c){let u=i.hc[i.currentUser.toKey()];u||(u=new fs(vn)),u=u.insert(o,c),i.hc[i.currentUser.toKey()]=u}(r,s.batchId,e),yield $l(r,s.changes),yield Ff(r.remoteStore)}catch(s){const i=$f(s,"Failed to persist write");e.reject(i)}}),Yx.apply(this,arguments)}function eQ(n,t){return Kx.apply(this,arguments)}function Kx(){return Kx=A(function*(n,t){const e=ct(n);try{const r=yield yve(e.localStore,t);t.targetChanges.forEach((s,i)=>{const o=e.cc.get(i);o&&(rn(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.nc=!0:s.modifiedDocuments.size>0?rn(o.nc):s.removedDocuments.size>0&&(rn(o.nc),o.nc=!1))}),yield $l(e,r,t)}catch(r){yield w0(r)}}),Kx.apply(this,arguments)}function tQ(n,t,e){const r=ct(n);if(r.isPrimaryClient&&0===e||!r.isPrimaryClient&&1===e){const s=[];r.ic.forEach((i,o)=>{const c=o.view.bu(t);c.snapshot&&s.push(c.snapshot)}),function(i,o){const c=ct(i);c.onlineState=o;let u=!1;c.queries.forEach((h,p)=>{for(const m of p.listeners)m.bu(o)&&(u=!0)}),u&&Ux(c)}(r.eventManager,t),s.length&&r.sc.Wo(s),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function tCe(n,t,e){return Xx.apply(this,arguments)}function Xx(){return Xx=A(function*(n,t,e){const r=ct(n);r.sharedClientState.updateQueryState(t,"rejected",e);const s=r.cc.get(t),i=s&&s.key;if(i){let o=new fs(it.comparator);o=o.insert(i,_r.newNoDocument(i,sn.min()));const c=Nn().add(i),u=new wg(sn.min(),new Map,new nr(vn),o,c);yield eQ(r,u),r.uc=r.uc.remove(i),r.cc.delete(t),sk(r)}else yield Vf(r.localStore,t,!1).then(()=>Wf(r,t,e)).catch(w0)}),Xx.apply(this,arguments)}function nCe(n,t){return Qx.apply(this,arguments)}function Qx(){return Qx=A(function*(n,t){const e=ct(n),r=t.batch.batchId;try{const s=yield Cve(e.localStore,t);nk(e,r,null),tk(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),yield $l(e,s)}catch(s){yield w0(s)}}),Qx.apply(this,arguments)}function rCe(n,t,e){return Jx.apply(this,arguments)}function Jx(){return Jx=A(function*(n,t,e){const r=ct(n);try{const s=yield function(i,o){const c=ct(i);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,o).next(p=>(rn(null!==p),h=p.keys(),c.mutationQueue.removeMutationBatch(u,p))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(r.localStore,t);nk(r,t,e),tk(r,t),r.sharedClientState.updateMutationState(t,"rejected",e),yield $l(r,s)}catch(s){yield w0(s)}}),Jx.apply(this,arguments)}function tk(n,t){(n.lc.get(t)||[]).forEach(e=>{e.resolve()}),n.lc.delete(t)}function nk(n,t,e){const r=ct(n);let s=r.hc[r.currentUser.toKey()];if(s){const i=s.get(t);i&&(e?i.reject(e):i.resolve(),s=s.remove(t)),r.hc[r.currentUser.toKey()]=s}}function Wf(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const r of n.rc.get(t))n.ic.delete(r),e&&n.sc.wc(r,e);n.rc.delete(t),n.isPrimaryClient&&n.ac.ls(t).forEach(r=>{n.ac.containsKey(r)||nQ(n,r)})}function nQ(n,t){n.oc.delete(t.path.canonicalString());const e=n.uc.get(t);null!==e&&($g(n.remoteStore,e),n.uc=n.uc.remove(t),n.cc.delete(e),sk(n))}function rk(n,t,e){for(const r of e)r instanceof XX?(n.ac.addReference(r.key,t),iCe(n,r)):r instanceof QX?(Ue("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,t),n.ac.containsKey(r.key)||nQ(n,r.key)):Tt()}function iCe(n,t){const e=t.key,r=e.path.canonicalString();n.uc.get(e)||n.oc.has(r)||(Ue("SyncEngine","New document in limbo: "+e),n.oc.add(r),sk(n))}function sk(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const t=n.oc.values().next().value;n.oc.delete(t);const e=new it(g1.fromString(t)),r=n.fc.next();n.cc.set(r,new Kve(e)),n.uc=n.uc.insert(e,r),AM(n.remoteStore,new k0(wo(bf(e.path)),r,2,ia.at))}}function $l(n,t,e){return ik.apply(this,arguments)}function ik(){return ik=A(function*(n,t,e){const r=ct(n),s=[],i=[],o=[];var c;r.ic.isEmpty()||(r.ic.forEach((c,u)=>{o.push(r._c(u,t,e).then(h=>{if((h||e)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,h?.fromCache?"not-current":"current"),h){s.push(h);const p=ux.Ci(u.targetId,h);i.push(p)}}))}),yield Promise.all(o),r.sc.Wo(s),yield(c=A(function*(u,h){const p=ct(u);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>Ee.forEach(h,C=>Ee.forEach(C.Si,w=>p.persistence.referenceDelegate.addReference(m,C.targetId,w)).next(()=>Ee.forEach(C.Di,w=>p.persistence.referenceDelegate.removeReference(m,C.targetId,w)))))}catch(m){if(!b0(m))throw m;Ue("LocalStore","Failed to update sequence numbers: "+m)}for(const m of h){const C=m.targetId;if(!m.fromCache){const w=p.Ui.get(C),H=w.withLastLimboFreeSnapshotVersion(w.snapshotVersion);p.Ui=p.Ui.insert(C,H)}}}),function(u,h){return c.apply(this,arguments)})(r.localStore,i))}),ik.apply(this,arguments)}function oCe(n,t){return ok.apply(this,arguments)}function ok(){return ok=A(function*(n,t){const e=ct(n);if(!e.currentUser.isEqual(t)){Ue("SyncEngine","User change. New user:",t.toKey());const r=yield AX(e.localStore,t);e.currentUser=t,(s=e).lc.forEach(o=>{o.forEach(c=>{c.reject(new Fe(Te.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.lc.clear(),e.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),yield $l(e,r.ji)}var s}),ok.apply(this,arguments)}function aCe(n,t){const e=ct(n),r=e.cc.get(t);if(r&&r.nc)return Nn().add(r.key);{let s=Nn();const i=e.rc.get(t);if(!i)return s;for(const o of i){const c=e.ic.get(o);s=s.unionWith(c.view.ju)}return s}}function pk(n){const t=ct(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=eQ.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=aCe.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=tCe.bind(null,t),t.sc.Wo=Wve.bind(null,t.eventManager),t.sc.wc=qve.bind(null,t.eventManager),t}function gk(n){const t=ct(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=nCe.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=rCe.bind(null,t),t}class mCe{constructor(){this.synchronizeTabs=!1}initialize(t){var e=this;return A(function*(){e.It=Fg(t.databaseInfo.databaseId),e.sharedClientState=e.gc(t),e.persistence=e.yc(t),yield e.persistence.start(),e.localStore=e.Ic(t),e.gcScheduler=e.Tc(t,e.localStore),e.indexBackfillerScheduler=e.Ec(t,e.localStore)})()}Tc(t,e){return null}Ec(t,e){return null}Ic(t){return function NX(n,t,e,r){return new vve(n,t,e,r)}(this.persistence,new OX,t.initialUser,this.It)}yc(t){return new wX(PM.Bs,this.It)}gc(t){return new VX}terminate(){var t=this;return A(function*(){t.gcScheduler&&t.gcScheduler.stop(),yield t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}class mk{initialize(t,e){var r=this;return A(function*(){r.localStore||(r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(e),r.remoteStore=r.createRemoteStore(e),r.eventManager=r.createEventManager(e),r.syncEngine=r.createSyncEngine(e,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=s=>tQ(r.syncEngine,s,1),r.remoteStore.remoteSyncer.handleCredentialChange=oCe.bind(null,r.syncEngine),yield function Dx(n,t){return zx.apply(this,arguments)}(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(t){return new Gve}createDatastore(t){const e=Fg(t.databaseInfo.databaseId),r=new bve(t.databaseInfo);return new Ave(t.authCredentials,t.appCheckCredentials,r,e)}createRemoteStore(t){return e=this.localStore,r=this.datastore,s=t.asyncQueue,i=c=>tQ(this.syncEngine,c,0),o=HX.C()?new HX:new Pve,new kve(e,r,s,i,o);var e,r,s,i,o}createSyncEngine(t,e){return function(r,s,i,o,c,u,h){const p=new Xve(r,s,i,o,c,u);return h&&(p.dc=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return(t=A(function*(e){const r=ct(e);Ue("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield Hf(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}function _k(n,t,e){if(!e)throw new Fe(Te.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function iQ(n){if(!it.isDocumentKey(n))throw new Fe(Te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function oQ(n){if(it.isDocumentKey(n))throw new Fe(Te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function xM(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const t=(e=n).constructor?e.constructor.name:null;return t?`a custom ${t} object`:"an object"}}var e;return"function"==typeof n?"a function":Tt()}function l1(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Fe(Te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=xM(n);throw new Fe(Te.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}const cQ=new Map;class lQ{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Fe(Te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Fe(Te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function CCe(n,t,e,r){if(!0===t&&!0===r)throw new Fe(Te.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Ug{constructor(t,e,r,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lQ({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Fe(Te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Fe(Te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lQ(t),void 0!==t.credentials&&(this._authCredentials=function(e){if(!e)return new bme;switch(e.type){case"gapi":return new Ime(e.client,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Fe(Te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=cQ.get(t);e&&(Ue("ComponentProvider","Removing Datastore"),cQ.delete(t),e.terminate())}(this),Promise.resolve()}}function uQ(n,t,e,r={}){var s;const i=(n=l1(n,Ug))._getSettings();if("firestore.googleapis.com"!==i.host&&i.host!==t&&Mf("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},i),{host:`${t}:${e}`,ssl:!1})),r.mockUserToken){let o,c;if("string"==typeof r.mockUserToken)o=r.mockUserToken,c=zi.MOCK_USER;else{o=function lpe(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[EE(JSON.stringify({alg:"none",type:"JWT"})),EE(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Fe(Te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new zi(u)}n._authCredentials=new Ome(new $Y(o,c))}}class ws{constructor(t,e,r){this.converter=e,this._key=r,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new T4(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ws(this.firestore,t,this._key)}}class X2{constructor(t,e,r){this.converter=e,this._query=r,this.type="query",this.firestore=t}withConverter(t){return new X2(this.firestore,t,this._query)}}class T4 extends X2{constructor(t,e,r){super(t,e,bf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ws(this.firestore,null,new it(t))}withConverter(t){return new T4(this.firestore,t,this._path)}}function yCe(n,t,...e){if(n=Xr(n),_k("collection","path",t),n instanceof Ug){const r=g1.fromString(t,...e);return oQ(r),new T4(n,null,r)}{if(!(n instanceof ws||n instanceof T4))throw new Fe(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(g1.fromString(t,...e));return oQ(r),new T4(n.firestore,null,r)}}function fQ(n,t,...e){if(n=Xr(n),1===arguments.length&&(t=GY.R()),_k("doc","path",t),n instanceof Ug){const r=g1.fromString(t,...e);return iQ(r),new ws(n,null,new it(r))}{if(!(n instanceof ws||n instanceof T4))throw new Fe(Te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(g1.fromString(t,...e));return iQ(r),new ws(n.firestore,n instanceof T4?n.converter:null,new it(r))}}class kM{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Rc(this.observer.next,t)}error(t){this.observer.error?this.Rc(this.observer.error,t):Ps("Uncaught Error in snapshot listener:",t.toString())}bc(){this.muted=!0}Rc(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}}class wCe{constructor(t,e,r,s){var i=this;this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=r,this.databaseInfo=s,this.user=zi.UNAUTHENTICATED,this.clientId=GY.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var o=A(function*(c){Ue("FirestoreClient","Received user=",c.uid),yield i.authCredentialListener(c),i.user=c});return function(c){return o.apply(this,arguments)}}()),this.appCheckCredentials.start(r,o=>(Ue("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}getConfiguration(){var t=this;return A(function*(){return{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Fe(Te.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var t=this;this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(A(function*(){try{t.onlineComponents&&(yield t.onlineComponents.terminate()),t.offlineComponents&&(yield t.offlineComponents.terminate()),t.authCredentials.shutdown(),t.appCheckCredentials.shutdown(),e.resolve()}catch(r){const s=$f(r,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}function pQ(n,t){return vk.apply(this,arguments)}function vk(){return vk=A(function*(n,t){n.asyncQueue.verifyOperationInProgress(),Ue("FirestoreClient","Initializing OfflineComponentProvider");const e=yield n.getConfiguration();yield t.initialize(e);let r=e.initialUser;n.setCredentialChangeListener(function(){var s=A(function*(i){r.isEqual(i)||(yield AX(t.localStore,i),r=i)});return function(i){return s.apply(this,arguments)}}()),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=t}),vk.apply(this,arguments)}function gQ(n,t){return Ck.apply(this,arguments)}function Ck(){return Ck=A(function*(n,t){n.asyncQueue.verifyOperationInProgress();const e=yield yk(n);Ue("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield t.initialize(e,r),n.setCredentialChangeListener(s=>jX(t.remoteStore,s)),n.setAppCheckTokenChangeListener((s,i)=>jX(t.remoteStore,i)),n.onlineComponents=t}),Ck.apply(this,arguments)}function yk(n){return Ek.apply(this,arguments)}function Ek(){return Ek=A(function*(n){return n.offlineComponents||(Ue("FirestoreClient","Using default OfflineComponentProvider"),yield pQ(n,new mCe)),n.offlineComponents}),Ek.apply(this,arguments)}function LM(n){return Mk.apply(this,arguments)}function Mk(){return Mk=A(function*(n){return n.onlineComponents||(Ue("FirestoreClient","Using default OnlineComponentProvider"),yield gQ(n,new mk)),n.onlineComponents}),Mk.apply(this,arguments)}function qf(n){return Tk.apply(this,arguments)}function Tk(){return Tk=A(function*(n){const t=yield LM(n),e=t.eventManager;return e.onListen=Qve.bind(null,t.syncEngine),e.onUnlisten=Jve.bind(null,t.syncEngine),e}),Tk.apply(this,arguments)}class LCe{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new Cx(this,"async_queue_retry"),this.Wc=()=>{const e=NM();e&&Ue("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const t=NM();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.zc(),this.Hc(t)}enterRestrictedMode(t){if(!this.Uc){this.Uc=!0,this.Qc=t||!1;const e=NM();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Wc)}}enqueue(t){if(this.zc(),this.Uc)return new Promise(()=>{});const e=new di;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Lc.push(t),this.Jc()))}Jc(){var t=this;return A(function*(){if(0!==t.Lc.length){try{yield t.Lc[0](),t.Lc.shift(),t.xo.reset()}catch(e){if(!b0(e))throw e;Ue("AsyncQueue","Operation failed with retryable error: "+e)}t.Lc.length>0&&t.xo.Ro(()=>t.Jc())}})()}Hc(t){const e=this.Bc.then(()=>(this.Gc=!0,t().catch(r=>{throw this.Kc=r,this.Gc=!1,Ps("INTERNAL UNHANDLED ERROR: ",function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+"\n"+i.stack),o}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=e,e}enqueueAfterDelay(t,e,r){this.zc(),this.jc.indexOf(t)>-1&&(e=0);const s=Vx.createAndSchedule(this,t,e,r,i=>this.Yc(i));return this.qc.push(s),s}zc(){this.Kc&&Tt()}verifyOperationInProgress(){}Xc(){var t=this;return A(function*(){let e;do{e=t.Bc,yield e}while(e!==t.Bc)})()}Zc(t){for(const e of this.qc)if(e.timerId===t)return!0;return!1}ta(t){return this.Xc().then(()=>{this.qc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs);for(const e of this.qc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Xc()})}ea(t){this.jc.push(t)}Yc(t){const e=this.qc.indexOf(t);this.qc.splice(e,1)}}function wk(n){return function(t,e){if("object"!=typeof t||null===t)return!1;const r=t;for(const s of["next","error","complete"])if(s in r&&"function"==typeof r[s])return!0;return!1}(n)}class Tr extends Ug{constructor(t,e,r,s){super(t,e,r,s),this.type="firestore",this._queue=new LCe,this._persistenceKey=s?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||yQ(this),this._firestoreClient.terminate()}}function DCe(n,t){const r="string"==typeof n?n:t||"(default)",s=gf("object"==typeof n?n:UA(),"firestore").getImmediate({identifier:r});if(!s._initialized){const i=(n=>{const t=cZ("firestore");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),r]:[t.substring(0,e),r]})();i&&uQ(s,...i)}return s}function qs(n){return n._firestoreClient||yQ(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function yQ(n){var t;const e=n._freezeSettings(),r=(i=(null===(t=n._app)||void 0===t?void 0:t.options.appId)||"",new Ume(n._databaseId,i,n._persistenceKey,(c=e).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var i,c;n._firestoreClient=new wCe(n._authCredentials,n._appCheckCredentials,n._queue,r)}class Ju{constructor(t){this._byteString=t}static fromBase64String(t){try{return new Ju(pi.fromBase64String(t))}catch(e){throw new Fe(Te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new Ju(pi.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class jf{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Fe(Te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ts(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class DM{constructor(t){this._methodName=t}}class bk{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Fe(Te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Fe(Te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return vn(this._lat,t._lat)||vn(this._long,t._long)}}const zCe=/^__.*__$/;class VCe{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return null!==this.fieldMask?new Fl(t,this.data,this.fieldMask,e,this.fieldTransforms):new If(t,this.data,e,this.fieldTransforms)}}class SQ{constructor(t,e,r){this.data=t,this.fieldMask=e,this.fieldTransforms=r}toMutation(t,e){return new Fl(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function PQ(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Tt()}}class zM{constructor(t,e,r,s,i,o){this.settings=t,this.databaseId=e,this.It=r,this.ignoreUndefinedProperties=s,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(t){return new zM(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.ua(t),s}ca(t){var e;const r=null===(e=this.path)||void 0===e?void 0:e.child(t),s=this.ia({path:r,oa:!1});return s.na(),s}aa(t){return this.ia({path:void 0,oa:!0})}ha(t){return HM(t,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(t){return void 0!==this.fieldMask.find(e=>t.isPrefixOf(e))||void 0!==this.fieldTransforms.find(e=>t.isPrefixOf(e.field))}na(){if(this.path)for(let t=0;t<this.path.length;t++)this.ua(this.path.get(t))}ua(t){if(0===t.length)throw this.ha("Document fields must not be empty");if(PQ(this.sa)&&zCe.test(t))throw this.ha('Document fields cannot begin and end with "__"')}}class HCe{constructor(t,e,r){this.databaseId=t,this.ignoreUndefinedProperties=e,this.It=r||Fg(t)}da(t,e,r,s=!1){return new zM({sa:t,methodName:e,fa:r,path:Ts.emptyPath(),oa:!1,la:s},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Zf(n){const t=n._freezeSettings(),e=Fg(n._databaseId);return new HCe(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Ok(n,t,e,r,s,i={}){const o=n.da(i.merge||i.mergeFields?2:0,t,e,s);Ak("Data must be an object, but it was:",o,r);const c=NQ(r,o);let u,h;if(i.merge)u=new Ha(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const m of i.mergeFields){const C=Ik(t,m,e);if(!o.contains(C))throw new Fe(Te.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);IQ(p,C)||p.push(C)}u=new Ha(p),h=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,h=o.fieldTransforms;return new VCe(new y2(c),u,h)}class Gg extends DM{_toFieldTransform(t){if(2!==t.sa)throw t.ha(1===t.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Gg}}class Nk extends DM{_toFieldTransform(t){return new Mg(t.path,new Nf)}isEqual(t){return t instanceof Nk}}function e5(n,t){if(AQ(n=Xr(n)))return Ak("Unsupported field value:",t,n),NQ(n,t);if(n instanceof DM)return function(e,r){if(!PQ(r.sa))throw r.ha(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${e._methodName}() is not currently supported inside arrays`);const s=e._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(void 0===n&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,r){const s=[];let i=0;for(const o of e){let c=e5(o,r.aa(i));null==c&&(c={nullValue:"NULL_VALUE"}),s.push(c),i++}return{arrayValue:{values:s}}}(n,t)}return function(e,r){if(null===(e=Xr(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return EK(r.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const s=Qr.fromDate(e);return{timestampValue:Og(r.It,s)}}if(e instanceof Qr){const s=new Qr(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Og(r.It,s)}}if(e instanceof bk)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ju)return{bytesValue:$K(r.It,e._byteString)};if(e instanceof ws){const s=r.databaseId,i=e.firestore._databaseId;if(!i.isEqual(s))throw r.ha(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:YI(e.firestore._databaseId||r.databaseId,e._key.path)}}throw r.ha(`Unsupported field value: ${xM(e)}`)}(n,t)}function NQ(n,t){const e={};return XY(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):zu(n,(r,s)=>{const i=e5(s,t.ra(r));null!=i&&(e[r]=i)}),{mapValue:{fields:e}}}function AQ(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Qr||n instanceof bk||n instanceof Ju||n instanceof ws||n instanceof DM)}function Ak(n,t,e){if(!AQ(e)||"object"!=typeof(r=e)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=xM(e);throw t.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Ik(n,t,e){if((t=Xr(t))instanceof jf)return t._internalPath;if("string"==typeof t)return VM(n,t);throw HM("Field path arguments must be of type string or ",n,!1,void 0,e)}const UCe=new RegExp("[~\\*/\\[\\]]");function VM(n,t,e){if(t.search(UCe)>=0)throw HM(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new jf(...t.split("."))._internalPath}catch{throw HM(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function HM(n,t,e,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new Fe(Te.INVALID_ARGUMENT,c+n+u)}function IQ(n,t){return n.some(e=>e.isEqual(t))}class xk{constructor(t,e,r,s,i){this._firestore=t,this._userDataWriter=e,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ws(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new GCe(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(FM("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class GCe extends xk{data(){return super.data()}}function FM(n,t){return"string"==typeof t?VM(n,t):t instanceof jf?t._internalPath:t._delegate._internalPath}function xQ(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Fe(Te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kk{}function WCe(n,...t){for(const e of t)n=e._apply(n);return n}class qCe extends kk{constructor(t,e,r){super(),this.ma=t,this.ga=e,this.ya=r,this.type="where"}_apply(t){const e=Zf(t.firestore),r=function(s,i,o,c,u,h,p){let m;if(u.isKeyField()){if("array-contains"===h||"array-contains-any"===h)throw new Fe(Te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if("in"===h||"not-in"===h){VQ(p,h);const w=[];for(const I of p)w.push(zQ(c,s,I));m={arrayValue:{values:w}}}else m=zQ(c,s,p)}else"in"!==h&&"not-in"!==h&&"array-contains-any"!==h||VQ(p,h),m=function OQ(n,t,e,r=!1){return e5(e,n.da(r?4:3,t))}(o,"where",p,"in"===h||"not-in"===h);const C=E2.create(u,h,m);return function(w,I){if(I.dt()){const Y=GI(w);if(null!==Y&&!Y.isEqual(I.field))throw new Fe(Te.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Y.toString()}' and '${I.field.toString()}'`);const ee=UI(w);null!==ee&&HQ(0,I.field,ee)}const H=function(Y,ee){for(const ve of Y.filters)if(ee.indexOf(ve.op)>=0)return ve.op;return null}(w,function(Y){switch(Y){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(I.op));if(null!==H)throw new Fe(Te.INVALID_ARGUMENT,H===I.op?`Invalid query. You cannot use more than one '${I.op.toString()}' filter.`:`Invalid query. You cannot use '${I.op.toString()}' filters with '${H.toString()}' filters.`)}(s,C),C}(t._query,0,e,t.firestore._databaseId,this.ma,this.ga,this.ya);return new X2(t.firestore,t.converter,function(s,i){const o=s.filters.concat([i]);return new Hl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(t._query,r))}}function jCe(n,t,e){const r=t,s=FM("where",n);return new qCe(s,r,e)}class ZCe extends kk{constructor(t,e){super(),this.ma=t,this.pa=e,this.type="orderBy"}_apply(t){const e=function(r,s,i){if(null!==r.startAt)throw new Fe(Te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Fe(Te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new wf(s,i);return function(c,u){if(null===UI(c)){const h=GI(c);null!==h&&HQ(0,h,u.field)}}(r,o),o}(t._query,this.ma,this.pa);return new X2(t.firestore,t.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new Hl(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}}function YCe(n,t="asc"){const e=t,r=FM("orderBy",n);return new ZCe(r,e)}class kQ extends kk{constructor(t,e,r){super(),this.type=t,this.Ia=e,this.Ta=r}_apply(t){return new X2(t.firestore,t.converter,uM(t._query,this.Ia,this.Ta))}}function KCe(n){return function aQ(n,t){if(t<=0)throw new Fe(Te.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}("limit",n),new kQ("limit",n,"F")}function zQ(n,t,e){if("string"==typeof(e=Xr(e))){if(""===e)throw new Fe(Te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!WI(t)&&-1!==e.indexOf("/"))throw new Fe(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const r=t.path.child(g1.fromString(e));if(!it.isDocumentKey(r))throw new Fe(Te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bu(n,new it(r))}if(e instanceof ws)return Bu(n,e._key);throw new Fe(Te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xM(e)}.`)}function VQ(n,t){if(!Array.isArray(n)||0===n.length)throw new Fe(Te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(n.length>10)throw new Fe(Te.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function HQ(n,t,e){if(!e.isEqual(t))throw new Fe(Te.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${e.toString()}' instead.`)}function Lk(n,t,e){let r;return r=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,r}class t5{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Yf extends xk{constructor(t,e,r,s,i,o){super(t,e,r,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new BM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const r=this._document.data.field(FM("DocumentSnapshot.get",t));if(null!==r)return this._userDataWriter.convertValue(r,e.serverTimestamps)}}}class BM extends Yf{data(t={}){return super.data(t)}}class Kf{constructor(t,e,r,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new t5(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(r=>{t.call(e,new BM(this._firestore,this._userDataWriter,r.key,r,new t5(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Fe(Te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new BM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new t5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:i++}))}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const c=new BM(r._firestore,r._userDataWriter,o.doc.key,o.doc,new t5(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return 0!==o.type&&(u=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),1!==o.type&&(i=i.add(o.doc),h=i.indexOf(o.doc.key)),{type:QCe(o.type),doc:c,oldIndex:u,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function QCe(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Tt()}}function JCe(n){n=l1(n,ws);const t=l1(n.firestore,Tr);return function vQ(n,t,e={}){const r=new di;return n.asyncQueue.enqueueAndForget(A(function*(){return function(s,i,o,c,u){const h=new kM({next:m=>{i.enqueueAndForget(()=>Bx(s,p));const C=m.docs.has(o);!C&&m.fromCache?u.reject(new Fe(Te.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&m.fromCache&&c&&"server"===c.source?u.reject(new Fe(Te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new Gx(bf(o.path),h,{includeMetadataChanges:!0,Nu:!0});return Hx(s,p)}(yield qf(n),n.asyncQueue,t,e,r)})),r.promise}(qs(t),n._key).then(e=>Rk(t,n,e))}class z0 extends class XCe{convertValue(t,e="none"){switch(Fu(t)){case 0:return null;case 1:return t.booleanValue;case 2:return hs(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Vu(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Tt()}}convertObject(t,e){const r={};return zu(t.fields,(s,i)=>{r[s]=this.convertValue(i,e)}),r}convertGeoPoint(t){return new bk(hs(t.latitude),hs(t.longitude))}convertArray(t,e){return(t.values||[]).map(r=>this.convertValue(r,e))}convertServerTimestamp(t,e){switch(e){case"previous":const r=JY(t);return null==r?null:this.convertValue(r,e);case"estimate":return this.convertTimestamp(pg(t));default:return null}}convertTimestamp(t){const e=O0(t);return new Qr(e.seconds,e.nanos)}convertDocumentKey(t,e){const r=g1.fromString(t);rn(XK(r));const s=new Hu(r.get(1),r.get(3)),i=new it(r.popFirst(5));return s.isEqual(e)||Ps(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),i}}{constructor(t){super(),this.firestore=t}convertBytes(t){return new Ju(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ws(this.firestore,null,e)}}function eye(n){n=l1(n,X2);const t=l1(n.firestore,Tr),e=qs(t),r=new z0(t);return xQ(n._query),function CQ(n,t,e={}){const r=new di;return n.asyncQueue.enqueueAndForget(A(function*(){return function(s,i,o,c,u){const h=new kM({next:m=>{i.enqueueAndForget(()=>Bx(s,p)),m.fromCache&&"server"===c.source?u.reject(new Fe(Te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),p=new Gx(o,h,{includeMetadataChanges:!0,Nu:!0});return Hx(s,p)}(yield qf(n),n.asyncQueue,t,e,r)})),r.promise}(e,n._query).then(s=>new Kf(t,r,n,s))}function tye(n,t,e){n=l1(n,ws);const r=l1(n.firestore,Tr),s=Lk(n.converter,t,e);return Wg(r,[Ok(Zf(r),"setDoc",n._key,s,null!==n.converter,e).toMutation(n._key,Fr.none())])}function nye(n,t,e,...r){n=l1(n,ws);const s=l1(n.firestore,Tr),i=Zf(s);let o;return o="string"==typeof(t=Xr(t))||t instanceof jf?function bQ(n,t,e,r,s,i){const o=n.da(1,t,e),c=[Ik(t,r,e)],u=[s];if(i.length%2!=0)throw new Fe(Te.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<i.length;C+=2)c.push(Ik(t,i[C])),u.push(i[C+1]);const h=[],p=y2.empty();for(let C=c.length-1;C>=0;--C)if(!IQ(h,c[C])){const w=c[C];let I=u[C];I=Xr(I);const H=o.ca(w);if(I instanceof Gg)h.push(w);else{const Y=e5(I,H);null!=Y&&(h.push(w),p.set(w,Y))}}const m=new Ha(h);return new SQ(p,m,o.fieldTransforms)}(i,"updateDoc",n._key,t,e,r):function wQ(n,t,e,r){const s=n.da(1,t,e);Ak("Data must be an object, but it was:",s,r);const i=[],o=y2.empty();zu(r,(u,h)=>{const p=VM(t,u,e);h=Xr(h);const m=s.ca(p);if(h instanceof Gg)i.push(p);else{const C=e5(h,m);null!=C&&(i.push(p),o.set(p,C))}});const c=new Ha(i);return new SQ(o,c,s.fieldTransforms)}(i,"updateDoc",n._key,t),Wg(s,[o.toMutation(n._key,Fr.exists(!0))])}function rye(n){return Wg(l1(n.firestore,Tr),[new xf(n._key,Fr.none())])}function sye(n,t){const e=l1(n.firestore,Tr),r=fQ(n),s=Lk(n.converter,t);return Wg(e,[Ok(Zf(n.firestore),"addDoc",r._key,s,null!==n.converter,{}).toMutation(r._key,Fr.exists(!1))]).then(()=>r)}function iye(n,...t){var e,r,s;n=Xr(n);let i={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||wk(t[o])||(i=t[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges};if(wk(t[o])){const m=t[o];t[o]=null===(e=m.next)||void 0===e?void 0:e.bind(m),t[o+1]=null===(r=m.error)||void 0===r?void 0:r.bind(m),t[o+2]=null===(s=m.complete)||void 0===s?void 0:s.bind(m)}let u,h,p;if(n instanceof ws)h=l1(n.firestore,Tr),p=bf(n._key.path),u={next:m=>{t[o]&&t[o](Rk(h,n,m))},error:t[o+1],complete:t[o+2]};else{const m=l1(n,X2);h=l1(m.firestore,Tr),p=m._query;const C=new z0(h);u={next:w=>{t[o]&&t[o](new Kf(h,C,m,w))},error:t[o+1],complete:t[o+2]},xQ(n._query)}return function(m,C,w,I){const H=new kM(I),Y=new Gx(C,H,w);return m.asyncQueue.enqueueAndForget(A(function*(){return Hx(yield qf(m),Y)})),()=>{H.bc(),m.asyncQueue.enqueueAndForget(A(function*(){return Bx(yield qf(m),Y)}))}}(qs(h),p,c,u)}function Wg(n,t){return function(e,r){const s=new di;return e.asyncQueue.enqueueAndForget(A(function*(){return function eCe(n,t,e){return Yx.apply(this,arguments)}(yield function Pk(n){return LM(n).then(t=>t.syncEngine)}(e),r,s)})),s.promise}(qs(n),t)}function Rk(n,t,e){const r=e.docs.get(t._key),s=new z0(n);return new Yf(n,s,t._key,r,new t5(e.hasPendingWrites,e.fromCache),t.converter)}function V0(){return new Nk("serverTimestamp")}function BQ(n,t){if(null!=n&&null!=t&&"object"==typeof n){if(null!=n.equals)return n.equals(t);{const e=n,r=t;for(const s of Object.keys(e)){if(!(s in r))return!1;if(!1===BQ(e[s],r[s]))return!1}return!0}}return n===t}function Dk(n){return null==n||function lye(n){return"object"==typeof n&&null!=n&&null!=n.equals}(n)||function ybe(n){return"string"==typeof n||"number"==typeof n||"boolean"==typeof n||null===n}(n)||function uye(n){if("object"==typeof n){for(const t in n)if(null!=n[t]&&!1===Dk(n[t]))return!1;return null!=n&&n.constructor.prototype===Object.prototype}return!1}(n)}function Fa(n,t){if(Dk(n)&&Dk(t))return BQ(n,t);throw new Error(`Comparing non comparable objects: ${n.constructor.name} and ${t.constructor.name}`)}function ye(n,t,e){if(!1===n)throw void 0!==e&&console.log(e),bs.logError("Assertion failure",t),new Error(`Assertion failure: ${t}`)}!function(n,t=!0){Ef="9.14.0",Po(new Z2("firestore",(e,{instanceIdentifier:r,options:s})=>{const i=e.getProvider("app").getImmediate(),o=new Tr(new Nme(e.getProvider("auth-internal")),new xme(e.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new Fe(Te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hu(c.options.projectId,u)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ls(BY,"3.7.3",n),ls(BY,"3.7.3","esm2017")}();class w4{}class M2 extends w4{static tuple(t,e,r){return new class extends M2{encodeMove(s){const i=e(s),o={};return Object.keys(i).forEach(c=>{o[c]=t[c].encode(i[c])}),o}decodeMove(s){const i={};return Object.keys(t).reverse().forEach(o=>{ye(null!=s[o],"Invalid encoded value"),i[o]=t[o].decode(s[o])}),r(Object.values(i))}}}static disjunction3(t,e,r,s,i){return new class extends M2{encodeMove(o){return s(o)?{type:"T",encoded:t.encode(o)}:i(o)?{type:"U",encoded:e.encode(o)}:{type:"V",encoded:r.encode(o)}}decodeMove(o){const c=we.getNonNullable(o).type,u=we.getNonNullable(o).encoded;return"T"===c?t.decode(u):"U"===c?e.decode(u):r.decode(u)}}}encode(t){return this.encodeMove(t)}decode(t){return ye(!1===Array.isArray(t),"MoveEncoder.decode called with an array"),this.decodeMove(t)}}class Cn extends M2{static ofN(t,e,r){return new class extends Cn{maxValue(){return t}encodeNumber(s){return e(s)}decodeNumber(s){return r(s)}}}static tuple(t,e,r){return new class extends Cn{maxValue(){let s=0;return Object.keys(t).forEach(i=>{s=s*t[i].shift()+t[i].maxValue()}),s}encodeNumber(s){const i=e(s);let o=0;return Object.keys(i).forEach(c=>{o=o*t[c].shift()+t[c].encode(i[c])}),o}decodeNumber(s){const i={};let o=s;return Object.keys(t).reverse().forEach(c=>{const u=o%t[c].shift();o=(o-u)/t[c].shift(),i[c]=t[c].decode(u)}),r(Object.values(i))}}}static disjunction(t,e,r){return new class extends Cn{maxValue(){return Math.max(2*t.maxValue(),2*e.maxValue()+1)}encodeNumber(s){return r(s)?2*t.encodeNumber(s):2*e.encodeNumber(s)+1}decodeNumber(s){return s%2==0?t.decodeNumber(s/2):e.decodeNumber((s-1)/2)}}}static numberEncoder(t){return new class extends Cn{maxValue(){return t}encodeNumber(e){if(e>t)throw new Error("Cannot encode number bigger than the max with numberEncoder");return e}decodeNumber(e){if(e>t)throw new Error("Cannot decode number bigger than the max with numberEncoder");return e}}}shift(){return this.maxValue()+1}encodeMove(t){return this.encodeNumber(t)}decodeMove(t){return ye("number"==typeof t,"Invalid encoded number"),this.decodeNumber(t)}}Cn.booleanEncoder=new class extends Cn{maxValue(){return 1}encodeNumber(n){return n?1:0}decodeNumber(n){if(0===n)return!1;if(1===n)return!0;throw new Error("Invalid encoded boolean")}};class P{constructor(t){this.value=t}static of(t){return new P(t)}static ofNullable(t){return null==t?P.empty():P.of(t)}static empty(){return new P(null)}static getEncoder(t){return new class extends w4{encode(e){return e.isPresent()?t.encode(e.get()):null}decode(e){return null===e?P.empty():P.of(t.decode(e))}}}static getNumberEncoder(t){return new class extends Cn{maxValue(){return t.maxValue()+1}encodeNumber(e){return e.isPresent()?t.encodeNumber(e.get()):t.maxValue()+1}decodeNumber(e){return e===this.maxValue()?P.empty():P.of(t.decodeNumber(e))}}}isPresent(){return null!=this.value}isAbsent(){return null==this.value}get(){if(this.isPresent())return this.value;throw new Error("Value is absent")}getOrElse(t){return this.isPresent()?this.value:t}equals(t){return this.isAbsent()?t.isAbsent():!t.isAbsent()&&Fa(this.value,t.value)}equalsValue(t){return this.equals(P.of(t))}toString(){return this.isAbsent()?"MGPOptional.empty()":`MGPOptional.of(${this.value})`}map(t){return this.isPresent()?P.of(t(this.get())):P.empty()}}class ${static success(t){return new fye(t)}static failure(t){return new hye(t)}constructor(){}equals(t){return this.isFailure()?t.isFailure()&&this.getReason()===t.getReason():!t.isFailure()&&Fa(this.get(),t.get())}}class fye extends ${constructor(t){super(),this.value=t}isSuccess(){return!0}isFailure(){return!1}get(){return this.value}getReason(){throw new Error("Cannot get failure reason from a success")}getReasonOr(t){return t}toOptional(){return P.of(this.value)}toString(){return`MGPFallible.success(${this.value})`}}class hye extends ${constructor(t){super(),this.reason=t}isSuccess(){return!1}isFailure(){return!0}get(){throw new Error("Value is absent from failure, with the following reason: "+this.reason)}getReason(){return this.reason}getReasonOr(t){return this.getReason()}toOptional(){return P.empty()}toString(){return`MGPFallible.failure(${this.reason})`}}class U{constructor(t){this.reason=t}static ofFallible(t){return t.isSuccess()?U.SUCCESS:U.failure(t.getReason())}static failure(t){return new U(t)}isFailure(){return!1===this.isSuccess()}isSuccess(){return null==this.reason}getReason(){if(this.isSuccess())throw new Error("MGPValidation: Cannot extract failure reason from success.");return this.reason}toFallible(t){return this.isSuccess()?$.success(t):$.failure(this.getReason())}toFailedFallible(){if(this.isSuccess())throw new Error("MGPValidation: cannot convert into failed fallible.");return $.failure(this.getReason())}}U.SUCCESS=new U(null),ls("firebase","9.14.0","app");const $Q="@firebase/installations",zk="0.5.16",GQ=`w:${zk}`,WQ="FIS_v2",Ul=new C4("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function qQ(n){return n instanceof Tc&&n.code.includes("request-failed")}function Vk({projectId:n}){return`https://firebaseinstallations.googleapis.com/v1/projects/${n}/installations`}function jQ(n){return{token:n.token,requestStatus:2,expiresIn:yye(n.expiresIn),creationTime:Date.now()}}function Hk(n,t){return Fk.apply(this,arguments)}function Fk(){return Fk=A(function*(n,t){const r=(yield t.json()).error;return Ul.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}),Fk.apply(this,arguments)}function ZQ({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function YQ(n,{refreshToken:t}){const e=ZQ(n);return e.append("Authorization",function Eye(n){return`${WQ} ${n}`}(t)),e}function Bk(n){return $k.apply(this,arguments)}function $k(){return $k=A(function*(n){const t=yield n();return t.status>=500&&t.status<600?n():t}),$k.apply(this,arguments)}function yye(n){return Number(n.replace("s","000"))}function Mye(n,t){return Uk.apply(this,arguments)}function Uk(){return Uk=A(function*({appConfig:n,heartbeatServiceProvider:t},{fid:e}){const r=Vk(n),s=ZQ(n),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({fid:e,authVersion:WQ,appId:n.appId,sdkVersion:GQ})},u=yield Bk(()=>fetch(r,c));if(u.ok){const h=yield u.json();return{fid:h.fid||e,registrationStatus:2,refreshToken:h.refreshToken,authToken:jQ(h.authToken)}}throw yield Hk("Create Installation",u)}),Uk.apply(this,arguments)}function KQ(n){return new Promise(t=>{setTimeout(t,n)})}const Pye=/^[cdef][\w-]{21}$/;function Tye(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const e=function wye(n){return function Sye(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return Pye.test(e)?e:""}catch{return""}}function Xf(n){return`${n.appName}!${n.appId}`}const Qf=new Map;function XQ(n,t){const e=Xf(n);QQ(e,t),function Nye(n,t){const e=function JQ(){return!n5&&"BroadcastChannel"in self&&(n5=new BroadcastChannel("[Firebase] FID Change"),n5.onmessage=n=>{QQ(n.data.key,n.data.fid)}),n5}();e&&e.postMessage({key:n,fid:t}),function eJ(){0===Qf.size&&n5&&(n5.close(),n5=null)}()}(e,t)}function QQ(n,t){const e=Qf.get(n);if(e)for(const r of e)r(t)}let n5=null;const r5="firebase-installations-store";let Wk=null;function qk(){return Wk||(Wk=wE("firebase-installations-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(r5)}})),Wk}function UM(n,t){return jk.apply(this,arguments)}function jk(){return jk=A(function*(n,t){const e=Xf(n),s=(yield qk()).transaction(r5,"readwrite"),i=s.objectStore(r5),o=yield i.get(e);return yield i.put(t,e),yield s.done,(!o||o.fid!==t.fid)&&XQ(n,t.fid),t}),jk.apply(this,arguments)}function Zk(n){return Yk.apply(this,arguments)}function Yk(){return Yk=A(function*(n){const t=Xf(n),r=(yield qk()).transaction(r5,"readwrite");yield r.objectStore(r5).delete(t),yield r.done}),Yk.apply(this,arguments)}function qg(n,t){return Kk.apply(this,arguments)}function Kk(){return Kk=A(function*(n,t){const e=Xf(n),s=(yield qk()).transaction(r5,"readwrite"),i=s.objectStore(r5),o=yield i.get(e),c=t(o);return void 0===c?yield i.delete(e):yield i.put(c,e),yield s.done,c&&(!o||o.fid!==c.fid)&&XQ(n,c.fid),c}),Kk.apply(this,arguments)}function Xk(n){return Qk.apply(this,arguments)}function Qk(){return Qk=A(function*(n){let t;const e=yield qg(n.appConfig,r=>{const s=xye(r),i=kye(n,s);return t=i.registrationPromise,i.installationEntry});return""===e.fid?{installationEntry:yield t}:{installationEntry:e,registrationPromise:t}}),Qk.apply(this,arguments)}function xye(n){return nJ(n||{fid:Tye(),registrationStatus:0})}function kye(n,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Ul.create("app-offline"))};const e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=function Lye(n,t){return Jk.apply(this,arguments)}(n,e);return{installationEntry:e,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Rye(n)}:{installationEntry:t}}function Jk(){return Jk=A(function*(n,t){try{const e=yield Mye(n,t);return UM(n.appConfig,e)}catch(e){throw qQ(e)&&409===e.customData.serverCode?yield Zk(n.appConfig):yield UM(n.appConfig,{fid:t.fid,registrationStatus:0}),e}}),Jk.apply(this,arguments)}function Rye(n){return eL.apply(this,arguments)}function eL(){return eL=A(function*(n){let t=yield tJ(n.appConfig);for(;1===t.registrationStatus;)yield KQ(100),t=yield tJ(n.appConfig);if(0===t.registrationStatus){const{installationEntry:e,registrationPromise:r}=yield Xk(n);return r||e}return t}),eL.apply(this,arguments)}function tJ(n){return qg(n,t=>{if(!t)throw Ul.create("installation-not-found");return nJ(t)})}function nJ(n){return function Dye(n){return 1===n.registrationStatus&&n.registrationTime+1e4<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function zye(n,t){return tL.apply(this,arguments)}function tL(){return tL=A(function*({appConfig:n,heartbeatServiceProvider:t},e){const r=Vye(n,e),s=YQ(n,e),i=t.getImmediate({optional:!0});if(i){const h=yield i.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}const c={method:"POST",headers:s,body:JSON.stringify({installation:{sdkVersion:GQ,appId:n.appId}})},u=yield Bk(()=>fetch(r,c));if(u.ok)return jQ(yield u.json());throw yield Hk("Generate Auth Token",u)}),tL.apply(this,arguments)}function Vye(n,{fid:t}){return`${Vk(n)}/${t}/authTokens:generate`}function nL(n){return rL.apply(this,arguments)}function rL(){return rL=A(function*(n,t=!1){let e;const r=yield qg(n.appConfig,i=>{if(!sJ(i))throw Ul.create("not-registered");const o=i.authToken;if(!t&&Bye(o))return i;if(1===o.requestStatus)return e=Hye(n,t),i;{if(!navigator.onLine)throw Ul.create("app-offline");const c=Uye(i);return e=Fye(n,c),c}});return e?yield e:r.authToken}),rL.apply(this,arguments)}function Hye(n,t){return sL.apply(this,arguments)}function sL(){return sL=A(function*(n,t){let e=yield rJ(n.appConfig);for(;1===e.authToken.requestStatus;)yield KQ(100),e=yield rJ(n.appConfig);const r=e.authToken;return 0===r.requestStatus?nL(n,t):r}),sL.apply(this,arguments)}function rJ(n){return qg(n,t=>{if(!sJ(t))throw Ul.create("not-registered");return function Gye(n){return 1===n.requestStatus&&n.requestTime+1e4<Date.now()}(t.authToken)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function Fye(n,t){return iL.apply(this,arguments)}function iL(){return iL=A(function*(n,t){try{const e=yield zye(n,t),r=Object.assign(Object.assign({},t),{authToken:e});return yield UM(n.appConfig,r),e}catch(e){if(!qQ(e)||401!==e.customData.serverCode&&404!==e.customData.serverCode){const r=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});yield UM(n.appConfig,r)}else yield Zk(n.appConfig);throw e}}),iL.apply(this,arguments)}function sJ(n){return void 0!==n&&2===n.registrationStatus}function Bye(n){return 2===n.requestStatus&&!function $ye(n){const t=Date.now();return t<n.creationTime||n.creationTime+n.expiresIn<t+36e5}(n)}function Uye(n){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:t})}function oL(){return oL=A(function*(n){const t=n,{installationEntry:e,registrationPromise:r}=yield Xk(t);return r?r.catch(console.error):nL(t).catch(console.error),e.fid}),oL.apply(this,arguments)}function aL(){return aL=A(function*(n,t=!1){const e=n;return yield jye(e),(yield nL(e,t)).token}),aL.apply(this,arguments)}function jye(n){return cL.apply(this,arguments)}function cL(){return cL=A(function*(n){const{registrationPromise:t}=yield Xk(n);t&&(yield t)}),cL.apply(this,arguments)}function fL(n){return Ul.create("missing-app-config-values",{valueName:n})}const iJ="installations",Qye=n=>{const t=n.getProvider("app").getImmediate(),e=function Kye(n){if(!n||!n.options)throw fL("App Configuration");if(!n.name)throw fL("App Name");const t=["projectId","apiKey","appId"];for(const e of t)if(!n.options[e])throw fL(e);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(t);return{app:t,appConfig:e,heartbeatServiceProvider:gf(t,"heartbeat"),_delete:()=>Promise.resolve()}},Jye=n=>{const e=gf(n.getProvider("app").getImmediate(),iJ).getImmediate();return{getId:()=>function Wye(n){return oL.apply(this,arguments)}(e),getToken:s=>function qye(n){return aL.apply(this,arguments)}(e,s)}};(function eEe(){Po(new Z2(iJ,Qye,"PUBLIC")),Po(new Z2("installations-internal",Jye,"PRIVATE"))})(),ls($Q,zk),ls($Q,zk,"esm2017");const hL="@firebase/remote-config",ca=new C4("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class fEe{constructor(t,e,r,s){this.client=t,this.storage=e,this.storageCache=r,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const r=Date.now()-e,s=r<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${r}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}fetch(t){var e=this;return A(function*(){const[r,s]=yield Promise.all([e.storage.getLastSuccessfulFetchTimestampMillis(),e.storage.getLastSuccessfulFetchResponse()]);if(s&&e.isCachedDataFresh(t.cacheMaxAgeMillis,r))return s;t.eTag=s&&s.eTag;const i=yield e.client.fetch(t),o=[e.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===i.status&&o.push(e.storage.setLastSuccessfulFetchResponse(i)),yield Promise.all(o),i})()}}function hEe(n=navigator){return n.languages&&n.languages[0]||n.language}class dEe{constructor(t,e,r,s,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=r,this.projectId=s,this.apiKey=i,this.appId=o}fetch(t){var e=this;return A(function*(){var r,s,i;const[o,c]=yield Promise.all([e.firebaseInstallations.getId(),e.firebaseInstallations.getToken()]),h=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${e.projectId}/namespaces/${e.namespace}:fetch?key=${e.apiKey}`,p={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},m={sdk_version:e.sdkVersion,app_instance_id:o,app_instance_id_token:c,app_id:e.appId,language_code:hEe()},C={method:"POST",headers:p,body:JSON.stringify(m)},w=fetch(h,C),I=new Promise((Ie,Be)=>{t.signal.addEventListener(()=>{const Ye=new Error("The operation was aborted.");Ye.name="AbortError",Be(Ye)})});let H;try{yield Promise.race([w,I]),H=yield w}catch(Ie){let Be="fetch-client-network";throw"AbortError"===(null===(r=Ie)||void 0===r?void 0:r.name)&&(Be="fetch-timeout"),ca.create(Be,{originalErrorMessage:null===(s=Ie)||void 0===s?void 0:s.message})}let Y=H.status;const ee=H.headers.get("ETag")||void 0;let ve,te;if(200===H.status){let Ie;try{Ie=yield H.json()}catch(Be){throw ca.create("fetch-client-parse",{originalErrorMessage:null===(i=Be)||void 0===i?void 0:i.message})}ve=Ie.entries,te=Ie.state}if("INSTANCE_STATE_UNSPECIFIED"===te?Y=500:"NO_CHANGE"===te?Y=304:("NO_TEMPLATE"===te||"EMPTY_CONFIG"===te)&&(ve={}),304!==Y&&200!==Y)throw ca.create("fetch-status",{httpStatus:Y});return{status:Y,eTag:ee,config:ve}})()}}class mEe{constructor(t,e){this.client=t,this.storage=e}fetch(t){var e=this;return A(function*(){const r=(yield e.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return e.attemptFetch(t,r)})()}attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:r}){var s=this;return A(function*(){yield function pEe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(ca.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(t.signal,e);try{const i=yield s.client.fetch(t);return yield s.storage.deleteThrottleMetadata(),i}catch(i){if(!function gEe(n){if(!(n instanceof Tc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i))throw i;const o={throttleEndTimeMillis:Date.now()+kA(r),backoffCount:r+1};return yield s.storage.setThrottleMetadata(o),s.attemptFetch(t,o)}})()}}class CEe{constructor(t,e,r,s,i){this.app=t,this._client=e,this._storageCache=r,this._storage=s,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function WM(n,t){var e;const r=n.target.error||void 0;return ca.create(t,{originalErrorMessage:r&&(null===(e=r)||void 0===e?void 0:e.message)})}const s5="app_namespace_store";class SEe{constructor(t,e,r,s=function MEe(){return new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase_remote_config",1);r.onerror=s=>{t(WM(s,"storage-open"))},r.onsuccess=s=>{n(s.target.result)},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(s5,{keyPath:"compositeKey"})}}catch(r){t(ca.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}})}()){this.appId=t,this.appName=e,this.namespace=r,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(t){var e=this;return A(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([s5],"readonly").objectStore(s5),h=e.createCompositeKey(t);try{const p=u.get(h);p.onerror=m=>{i(WM(m,"storage-get"))},p.onsuccess=m=>{const C=m.target.result;s(C?C.value:void 0)}}catch(p){i(ca.create("storage-get",{originalErrorMessage:null===(o=p)||void 0===o?void 0:o.message}))}})})()}set(t,e){var r=this;return A(function*(){const s=yield r.openDbPromise;return new Promise((i,o)=>{var c;const h=s.transaction([s5],"readwrite").objectStore(s5),p=r.createCompositeKey(t);try{const m=h.put({compositeKey:p,value:e});m.onerror=C=>{o(WM(C,"storage-set"))},m.onsuccess=()=>{i()}}catch(m){o(ca.create("storage-set",{originalErrorMessage:null===(c=m)||void 0===c?void 0:c.message}))}})})()}delete(t){var e=this;return A(function*(){const r=yield e.openDbPromise;return new Promise((s,i)=>{var o;const u=r.transaction([s5],"readwrite").objectStore(s5),h=e.createCompositeKey(t);try{const p=u.delete(h);p.onerror=m=>{i(WM(m,"storage-delete"))},p.onsuccess=()=>{s()}}catch(p){i(ca.create("storage-delete",{originalErrorMessage:null===(o=p)||void 0===o?void 0:o.message}))}})})()}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}}class PEe{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var t=this;return A(function*(){const e=t.storage.getLastFetchStatus(),r=t.storage.getLastSuccessfulFetchTimestampMillis(),s=t.storage.getActiveConfig(),i=yield e;i&&(t.lastFetchStatus=i);const o=yield r;o&&(t.lastSuccessfulFetchTimestampMillis=o);const c=yield s;c&&(t.activeConfig=c)})()}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}}function wEe(){return _L.apply(this,arguments)}function _L(){return(_L=A(function*(){if(!bu())return!1;try{return yield $p()}catch{return!1}})).apply(this,arguments)}!function TEe(){Po(new Z2("remote-config",function n(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw ca.create("registration-window");if(!bu())throw ca.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:c}=r.options;if(!i)throw ca.create("registration-project-id");if(!o)throw ca.create("registration-api-key");if(!c)throw ca.create("registration-app-id");const u=new SEe(c,r.name,e=e||"firebase"),h=new PEe(u),p=new pf(hL);p.logLevel=p1.ERROR;const m=new dEe(s,mf,e,i,o,c),C=new mEe(m,u),w=new fEe(C,u,h,p),I=new CEe(r,w,h,u,p);return function cEe(n){const t=Xr(n);t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0}))}(I),I},"PUBLIC").setMultipleInstances(!0)),ls(hL,"0.3.15"),ls(hL,"0.3.15","esm2017")}();const bEe="/firebase-messaging-sw.js",OEe="/firebase-cloud-messaging-push-scope",lJ="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",uJ="google.c.a.c_id",AEe="google.c.a.c_l",IEe="google.c.a.ts",xEe="google.c.a.e";var Jf=(()=>(function(n){n.PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked"}(Jf||(Jf={})),Jf))();function Gl(n){const t=new Uint8Array(n);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function kEe(n){const e=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(e),s=new Uint8Array(r.length);for(let i=0;i<r.length;++i)s[i]=r.charCodeAt(i);return s}const vL="fcm_token_details_db",fJ="fcm_token_object_Store";function REe(n){return CL.apply(this,arguments)}function CL(){return CL=A(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(i=>i.name).includes(vL))return null;let t=null;return(yield wE(vL,5,{upgrade:(r=A(function*(s,i,o,c){var u;if(i<2||!s.objectStoreNames.contains(fJ))return;const h=c.objectStore(fJ),p=yield h.index("fcmSenderId").get(n);if(yield h.clear(),p)if(2===i){const m=p;if(!m.auth||!m.p256dh||!m.endpoint)return;t={token:m.fcmToken,createTime:null!==(u=m.createTime)&&void 0!==u?u:Date.now(),subscriptionOptions:{auth:m.auth,p256dh:m.p256dh,endpoint:m.endpoint,swScope:m.swScope,vapidKey:"string"==typeof m.vapidKey?m.vapidKey:Gl(m.vapidKey)}}}else if(3===i){const m=p;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Gl(m.auth),p256dh:Gl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Gl(m.vapidKey)}}}else if(4===i){const m=p;t={token:m.fcmToken,createTime:m.createTime,subscriptionOptions:{auth:Gl(m.auth),p256dh:Gl(m.p256dh),endpoint:m.endpoint,swScope:m.swScope,vapidKey:Gl(m.vapidKey)}}}}),function(i,o,c,u){return r.apply(this,arguments)})})).close(),yield FA(vL),yield FA("fcm_vapid_details_db"),yield FA("undefined"),DEe(t)?t:null;var r}),CL.apply(this,arguments)}function DEe(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:t}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}const i5="firebase-messaging-store";let yL=null;function EL(){return yL||(yL=wE("firebase-messaging-database",1,{upgrade:(n,t)=>{0===t&&n.createObjectStore(i5)}})),yL}function hJ(n){return ML.apply(this,arguments)}function ML(){return ML=A(function*(n){const t=wL(n),r=yield(yield EL()).transaction(i5).objectStore(i5).get(t);if(r)return r;{const s=yield REe(n.appConfig.senderId);if(s)return yield SL(n,s),s}}),ML.apply(this,arguments)}function SL(n,t){return PL.apply(this,arguments)}function PL(){return PL=A(function*(n,t){const e=wL(n),s=(yield EL()).transaction(i5,"readwrite");return yield s.objectStore(i5).put(t,e),yield s.done,t}),PL.apply(this,arguments)}function HEe(n){return TL.apply(this,arguments)}function TL(){return TL=A(function*(n){const t=wL(n),r=(yield EL()).transaction(i5,"readwrite");yield r.objectStore(i5).delete(t),yield r.done}),TL.apply(this,arguments)}function wL({appConfig:n}){return n.appId}const S2=new C4("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function BEe(n,t){return bL.apply(this,arguments)}function bL(){return bL=A(function*(n,t){var e;const r=yield IL(n),s=pJ(t),i={method:"POST",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(AL(n.appConfig),i)).json()}catch(c){throw S2.create("token-subscribe-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw S2.create("token-subscribe-failed",{errorInfo:o.error.message});if(!o.token)throw S2.create("token-subscribe-no-token");return o.token}),bL.apply(this,arguments)}function $Ee(n,t){return OL.apply(this,arguments)}function OL(){return OL=A(function*(n,t){var e;const r=yield IL(n),s=pJ(t.subscriptionOptions),i={method:"PATCH",headers:r,body:JSON.stringify(s)};let o;try{o=yield(yield fetch(`${AL(n.appConfig)}/${t.token}`,i)).json()}catch(c){throw S2.create("token-update-failed",{errorInfo:null===(e=c)||void 0===e?void 0:e.toString()})}if(o.error)throw S2.create("token-update-failed",{errorInfo:o.error.message});if(!o.token)throw S2.create("token-update-no-token");return o.token}),OL.apply(this,arguments)}function dJ(n,t){return NL.apply(this,arguments)}function NL(){return NL=A(function*(n,t){var e;const s={method:"DELETE",headers:yield IL(n)};try{const o=yield(yield fetch(`${AL(n.appConfig)}/${t}`,s)).json();if(o.error)throw S2.create("token-unsubscribe-failed",{errorInfo:o.error.message})}catch(i){throw S2.create("token-unsubscribe-failed",{errorInfo:null===(e=i)||void 0===e?void 0:e.toString()})}}),NL.apply(this,arguments)}function AL({projectId:n}){return`https://fcmregistrations.googleapis.com/v1/projects/${n}/registrations`}function IL(n){return xL.apply(this,arguments)}function xL(){return xL=A(function*({appConfig:n,installations:t}){const e=yield t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${e}`})}),xL.apply(this,arguments)}function pJ({p256dh:n,auth:t,endpoint:e,vapidKey:r}){const s={web:{endpoint:e,auth:t,p256dh:n}};return r!==lJ&&(s.web.applicationPubKey=r),s}function GEe(n){return kL.apply(this,arguments)}function kL(){return kL=A(function*(n){const t=yield qEe(n.swRegistration,n.vapidKey),e={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:t.endpoint,auth:Gl(t.getKey("auth")),p256dh:Gl(t.getKey("p256dh"))},r=yield hJ(n.firebaseDependencies);if(r){if(jEe(r.subscriptionOptions,e))return Date.now()>=r.createTime+6048e5?WEe(n,{token:r.token,createTime:Date.now(),subscriptionOptions:e}):r.token;try{yield dJ(n.firebaseDependencies,r.token)}catch(s){console.warn(s)}return mJ(n.firebaseDependencies,e)}return mJ(n.firebaseDependencies,e)}),kL.apply(this,arguments)}function gJ(n){return LL.apply(this,arguments)}function LL(){return LL=A(function*(n){const t=yield hJ(n.firebaseDependencies);t&&(yield dJ(n.firebaseDependencies,t.token),yield HEe(n.firebaseDependencies));const e=yield n.swRegistration.pushManager.getSubscription();return!e||e.unsubscribe()}),LL.apply(this,arguments)}function WEe(n,t){return RL.apply(this,arguments)}function RL(){return RL=A(function*(n,t){try{const e=yield $Ee(n.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:e,createTime:Date.now()});return yield SL(n.firebaseDependencies,r),e}catch(e){throw yield gJ(n),e}}),RL.apply(this,arguments)}function mJ(n,t){return DL.apply(this,arguments)}function DL(){return DL=A(function*(n,t){const r={token:yield BEe(n,t),createTime:Date.now(),subscriptionOptions:t};return yield SL(n,r),r.token}),DL.apply(this,arguments)}function qEe(n,t){return zL.apply(this,arguments)}function zL(){return zL=A(function*(n,t){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:kEe(t)})}),zL.apply(this,arguments)}function jEe(n,t){return t.vapidKey===n.vapidKey&&t.endpoint===n.endpoint&&t.auth===n.auth&&t.p256dh===n.p256dh}function _J(n){const t={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function ZEe(n,t){if(!t.notification)return;n.notification={};const e=t.notification.title;e&&(n.notification.title=e);const r=t.notification.body;r&&(n.notification.body=r);const s=t.notification.image;s&&(n.notification.image=s);const i=t.notification.icon;i&&(n.notification.icon=i)}(t,n),function YEe(n,t){!t.data||(n.data=t.data)}(t,n),function KEe(n,t){var e,r,s,i,o;if(!(t.fcmOptions||null!==(e=t.notification)&&void 0!==e&&e.click_action))return;n.fcmOptions={};const c=null!==(s=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==s?s:null===(i=t.notification)||void 0===i?void 0:i.click_action;c&&(n.fcmOptions.link=c);const u=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;u&&(n.fcmOptions.analyticsLabel=u)}(t,n),t}function XEe(n){return"object"==typeof n&&!!n&&uJ in n}function vJ(n,t){const e=[];for(let r=0;r<n.length;r++)e.push(n.charAt(r)),r<t.length&&e.push(t.charAt(r));return e.join("")}function VL(n){return S2.create("missing-app-config-values",{valueName:n})}vJ("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),vJ("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class JEe{constructor(t,e,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const s=function QEe(n){if(!n||!n.options)throw VL("App Configuration Object");if(!n.name)throw VL("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:e}=n;for(const r of t)if(!e[r])throw VL(r);return{appName:n.name,projectId:e.projectId,apiKey:e.apiKey,appId:e.appId,senderId:e.messagingSenderId}}(t);this.firebaseDependencies={app:t,appConfig:s,installations:e,analyticsProvider:r}}_delete(){return Promise.resolve()}}function CJ(n){return HL.apply(this,arguments)}function HL(){return HL=A(function*(n){var t;try{n.swRegistration=yield navigator.serviceWorker.register(bEe,{scope:OEe}),n.swRegistration.update().catch(()=>{})}catch(e){throw S2.create("failed-service-worker-registration",{browserErrorMessage:null===(t=e)||void 0===t?void 0:t.message})}}),HL.apply(this,arguments)}function eMe(n,t){return FL.apply(this,arguments)}function FL(){return FL=A(function*(n,t){if(!t&&!n.swRegistration&&(yield CJ(n)),t||!n.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw S2.create("invalid-sw-registration");n.swRegistration=t}}),FL.apply(this,arguments)}function tMe(n,t){return BL.apply(this,arguments)}function BL(){return BL=A(function*(n,t){t?n.vapidKey=t:n.vapidKey||(n.vapidKey=lJ)}),BL.apply(this,arguments)}function $L(){return $L=A(function*(n,t){if(!navigator)throw S2.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw S2.create("permission-blocked");return yield tMe(n,t?.vapidKey),yield eMe(n,t?.serviceWorkerRegistration),GEe(n)}),$L.apply(this,arguments)}function nMe(n,t,e){return UL.apply(this,arguments)}function UL(){return UL=A(function*(n,t,e){const r=rMe(t);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:e[uJ],message_name:e[AEe],message_time:e[IEe],message_device_time:Math.floor(Date.now()/1e3)})}),UL.apply(this,arguments)}function rMe(n){switch(n){case Jf.NOTIFICATION_CLICKED:return"notification_open";case Jf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function GL(){return GL=A(function*(n,t){const e=t.data;if(!e.isFirebaseMessaging)return;n.onMessageHandler&&e.messageType===Jf.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(_J(e)):n.onMessageHandler.next(_J(e)));const r=e.data;XEe(r)&&"1"===r[xEe]&&(yield nMe(n,e.messageType,r))}),GL.apply(this,arguments)}const EJ="@firebase/messaging",iMe=n=>{const t=new JEe(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>function sMe(n,t){return GL.apply(this,arguments)}(t,e)),t},oMe=n=>{const t=n.getProvider("messaging").getImmediate();return{getToken:r=>function yJ(n,t){return $L.apply(this,arguments)}(t,r)}};function SJ(){return WL.apply(this,arguments)}function WL(){return(WL=A(function*(){try{yield $p()}catch{return!1}return typeof window<"u"&&bu()&&NA()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function aMe(){Po(new Z2("messaging",iMe,"PUBLIC")),Po(new Z2("messaging-internal",oMe,"PRIVATE")),ls(EJ,"0.11.0"),ls(EJ,"0.11.0","esm2017")}();const qM="analytics",uMe="firebase_id",dMe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",PJ="https://www.googletagmanager.com/gtag/js",P2=new pf("@firebase/analytics");function TJ(n){return Promise.all(n.map(t=>t.catch(e=>e)))}function pMe(n,t){const e=document.createElement("script");e.src=`${PJ}?l=${n}&id=${t}`,e.async=!0,document.head.appendChild(e)}function mMe(n,t,e,r,s,i){return ZL.apply(this,arguments)}function ZL(){return ZL=A(function*(n,t,e,r,s,i){const o=r[s];try{if(o)yield t[o];else{const u=(yield TJ(e)).find(h=>h.measurementId===s);u&&(yield t[u.appId])}}catch(c){P2.error(c)}n("config",s,i)}),ZL.apply(this,arguments)}function _Me(n,t,e,r,s){return YL.apply(this,arguments)}function YL(){return YL=A(function*(n,t,e,r,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const c=yield TJ(e);for(const u of o){const h=c.find(m=>m.measurementId===u),p=h&&t[h.appId];if(!p){i=[];break}i.push(p)}}0===i.length&&(i=Object.values(t)),yield Promise.all(i),n("event",r,s||{})}catch(i){P2.error(i)}}),YL.apply(this,arguments)}function yMe(n){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(PJ)&&e.src.includes(n))return e;return null}const Ba=new C4("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),wJ=new class PMe{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function TMe(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function wMe(n){return KL.apply(this,arguments)}function KL(){return KL=A(function*(n){var t;const{appId:e,apiKey:r}=n,s={method:"GET",headers:TMe(r)},i=dMe.replace("{app-id}",e),o=yield fetch(i,s);if(200!==o.status&&304!==o.status){let c="";try{const u=yield o.json();null!==(t=u.error)&&void 0!==t&&t.message&&(c=u.error.message)}catch{}throw Ba.create("config-fetch-failed",{httpStatus:o.status,responseMessage:c})}return o.json()}),KL.apply(this,arguments)}function bMe(n){return XL.apply(this,arguments)}function XL(){return XL=A(function*(n,t=wJ,e){const{appId:r,apiKey:s,measurementId:i}=n.options;if(!r)throw Ba.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:r};throw Ba.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new AMe;return setTimeout(A(function*(){c.abort()}),void 0!==e?e:6e4),bJ({appId:r,apiKey:s,measurementId:i},o,c,t)}),XL.apply(this,arguments)}function bJ(n,t,e){return QL.apply(this,arguments)}function QL(){return QL=A(function*(n,{throttleEndTimeMillis:t,backoffCount:e},r,s=wJ){var i,o;const{appId:c,measurementId:u}=n;try{yield OMe(r,t)}catch(h){if(u)return P2.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${null===(i=h)||void 0===i?void 0:i.message}]`),{appId:c,measurementId:u};throw h}try{const h=yield wMe(n);return s.deleteThrottleMetadata(c),h}catch(h){const p=h;if(!NMe(p)){if(s.deleteThrottleMetadata(c),u)return P2.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:c,measurementId:u};throw h}const m=503===Number(null===(o=p?.customData)||void 0===o?void 0:o.httpStatus)?kA(e,s.intervalMillis,30):kA(e,s.intervalMillis),C={throttleEndTimeMillis:Date.now()+m,backoffCount:e+1};return s.setThrottleMetadata(c,C),P2.debug(`Calling attemptFetch again in ${m} millis`),bJ(n,C,r,s)}}),QL.apply(this,arguments)}function OMe(n,t){return new Promise((e,r)=>{const s=Math.max(t-Date.now(),0),i=setTimeout(e,s);n.addEventListener(()=>{clearTimeout(i),r(Ba.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function NMe(n){if(!(n instanceof Tc&&n.customData))return!1;const t=Number(n.customData.httpStatus);return 429===t||500===t||503===t||504===t}class AMe{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let JL,iR;function eR(){return eR=A(function*(n,t,e,r,s){if(s&&s.global)n("event",e,r);else{const i=yield t;n("event",e,Object.assign(Object.assign({},r),{send_to:i}))}}),eR.apply(this,arguments)}function OJ(n){iR=n}function NJ(n){JL=n}function DMe(){return oR.apply(this,arguments)}function oR(){return oR=A(function*(){var n;if(!bu())return P2.warn(Ba.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield $p()}catch(t){return P2.warn(Ba.create("indexeddb-unavailable",{errorInfo:null===(n=t)||void 0===n?void 0:n.toString()}).message),!1}return!0}),oR.apply(this,arguments)}function aR(){return aR=A(function*(n,t,e,r,s,i,o){var c;const u=bMe(n);u.then(w=>{e[w.measurementId]=w.appId,n.options.measurementId&&w.measurementId!==n.options.measurementId&&P2.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${w.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(w=>P2.error(w)),t.push(u);const h=DMe().then(w=>{if(w)return r.getId()}),[p,m]=yield Promise.all([u,h]);yMe(i)||pMe(i,p.measurementId),iR&&(s("consent","default",iR),OJ(void 0)),s("js",new Date);const C=null!==(c=o?.config)&&void 0!==c?c:{};return C.origin="firebase",C.update=!0,null!=m&&(C[uMe]=m),s("config",p.measurementId,C),JL&&(s("set",JL),NJ(void 0)),p.measurementId}),aR.apply(this,arguments)}class VMe{constructor(t){this.app=t}_delete(){return delete Wl[this.app.options.appId],Promise.resolve()}}let Wl={},AJ=[];const IJ={};let kJ,ql,jM="dataLayer",cR=!1;function FMe(n,t,e){!function HMe(){const n=[];if(OA()&&n.push("This is a browser extension environment."),NA()||n.push("Cookies are not available."),n.length>0){const t=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),e=Ba.create("invalid-analytics-context",{errorInfo:t});P2.warn(e.message)}}();const r=n.options.appId;if(!r)throw Ba.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw Ba.create("no-api-key");P2.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Wl[r])throw Ba.create("already-exists",{id:r});if(!cR){!function gMe(n){let t=[];Array.isArray(window[n])?t=window[n]:window[n]=t}(jM);const{wrappedGtag:i,gtagCore:o}=function CMe(n,t,e,r,s){let i=function(...o){window[r].push(arguments)};return window[s]&&"function"==typeof window[s]&&(i=window[s]),window[s]=function vMe(n,t,e,r){function i(){return(i=A(function*(o,c,u){try{"event"===o?yield _Me(n,t,e,c,u):"config"===o?yield mMe(n,t,e,r,c,u):"consent"===o?n("consent","update",u):n("set",c)}catch(h){P2.error(h)}})).apply(this,arguments)}return function s(o,c,u){return i.apply(this,arguments)}}(i,n,t,e),{gtagCore:i,wrappedGtag:window[s]}}(Wl,AJ,IJ,jM,"gtag");ql=i,kJ=o,cR=!0}return Wl[r]=function zMe(n,t,e,r,s,i,o){return aR.apply(this,arguments)}(n,AJ,IJ,t,kJ,jM,e),new VMe(n)}function $Me(){return lR.apply(this,arguments)}function lR(){return(lR=A(function*(){if(OA()||!NA()||!bu())return!1;try{return yield $p()}catch{return!1}})).apply(this,arguments)}const LJ="@firebase/analytics";!function GMe(){Po(new Z2(qM,(t,{options:e})=>FMe(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e),"PUBLIC")),Po(new Z2("analytics-internal",function n(t){try{const e=t.getProvider(qM).getImmediate();return{logEvent:(r,s,i)=>function UMe(n,t,e,r){n=Xr(n),function IMe(n,t,e,r,s){return eR.apply(this,arguments)}(ql,Wl[n.app.options.appId],t,e,r).catch(s=>P2.error(s))}(e,r,s,i)}}catch(e){throw Ba.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),ls(LJ,"0.8.4"),ls(LJ,"0.8.4","esm2017")}();class WMe extends q1{constructor(t,e){super()}schedule(t,e=0){return this}}const ZM={setInterval(n,t,...e){const{delegate:r}=ZM;return r?.setInterval?r.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=ZM;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class DJ extends WMe{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var r;if(this.closed)return this;this.state=t;const s=this.id,i=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(i,s,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,r=0){return ZM.setInterval(t.flush.bind(t,this),r)}recycleAsyncId(t,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&ZM.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let s,r=!1;try{this.work(t)}catch(i){r=!0,s=i||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Uc(r,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const uR={now:()=>(uR.delegate||Date).now(),delegate:void 0};class jg{constructor(t,e=jg.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,r){return new this.schedulerActionCtor(this,t).schedule(r,e)}}jg.now=uR.now;class zJ extends jg{constructor(t,e=jg.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let r;this._active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}}const ZMe=new class jMe extends zJ{}(class qMe extends DJ{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(t,e,r):(t.flush(this),0)}}),YMe=new zJ(DJ),YM=new Q6("7.4.1"),fR="__angularfire_symbol__analyticsIsSupportedValue",hR="__angularfire_symbol__analyticsIsSupported",dR="__angularfire_symbol__remoteConfigIsSupportedValue",pR="__angularfire_symbol__remoteConfigIsSupported",gR="__angularfire_symbol__messagingIsSupportedValue",mR="__angularfire_symbol__messagingIsSupported";function vR(n,t,e){if(t){if(1===t.length)return t[0];const i=t.filter(o=>o.app===e);if(1===i.length)return i[0]}return e.container.getProvider(n).getImmediate({optional:!0})}globalThis[hR]||(globalThis[hR]=$Me().then(n=>globalThis[fR]=n).catch(()=>globalThis[fR]=!1)),globalThis[mR]||(globalThis[mR]=SJ().then(n=>globalThis[gR]=n).catch(()=>globalThis[gR]=!1)),globalThis[pR]||(globalThis[pR]=wEe().then(n=>globalThis[dR]=n).catch(()=>globalThis[dR]=!1));const CR=(n,t)=>{const e=t?[t]:yZ(),r=[];return e.forEach(s=>{s.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};function e9(){}class VJ{constructor(t,e=ZMe){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,r){const s=this.zone;return this.delegate.schedule(function(o){s.runGuarded(()=>{t.apply(this,[o])})},e,r)}}class KMe{constructor(t){this.zone=t,this.task=null}call(t,e){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",e9,{},e9,e9)),e.pipe(g2({next:r,complete:r,error:r})).subscribe(t).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let yR=(()=>{class n{constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new VJ(Zone.current)),this.insideAngular=e.run(()=>new VJ(Zone.current,YMe)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(e){return new(e||n)(Re(Pr))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function o5(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function XMe(n){return o5().ngZone.runOutsideAngular(()=>n())}function a5(n){return o5().ngZone.run(()=>n())}function QMe(n){return o5(),function JMe(n){return function(e){return(e=e.lift(new KMe(n.ngZone))).pipe(oc(n.outsideAngular),X4(n.insideAngular))}}(o5())(n)}const eSe=(n,t)=>function(){const r=arguments;return t&&setTimeout(()=>{"scheduled"===t.state&&t.invoke()},10),a5(()=>n.apply(void 0,r))},wr=(n,t)=>function(){let e;const r=arguments;for(let i=0;i<arguments.length;i++)"function"==typeof r[i]&&(t&&(e||(e=a5(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",e9,{},e9,e9)))),r[i]=eSe(r[i],e));const s=XMe(()=>n.apply(this,r));if(!t){if(s instanceof Er){const i=o5();return s.pipe(oc(i.outsideAngular),X4(i.insideAngular))}return a5(()=>s)}return s instanceof Er?s.pipe(QMe):s instanceof Promise?a5(()=>new Promise((i,o)=>s.then(c=>a5(()=>i(c)),c=>a5(()=>o(c))))):"function"==typeof s&&e?function(){return setTimeout(()=>{e&&"scheduled"===e.state&&e.invoke()},10),s.apply(this,arguments)}:a5(()=>s)};class t9{constructor(t){return t}}class ER{constructor(){return yZ()}}const MR=new xt("angularfire2._apps"),nSe={provide:t9,useFactory:function tSe(n){return n&&1===n.length?n[0]:new t9(UA())},deps:[[new li,MR]]},rSe={provide:ER,deps:[[new li,MR]]};function sSe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new t9(r)}}let iSe=(()=>{class n{constructor(e){ls("angularfire",YM.full,"core"),ls("angularfire",YM.full,"app"),ls("angular",Pv.full,e.toString())}}return n.\u0275fac=function(e){return new(e||n)(Re(rp))},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({providers:[nSe,rSe]}),n})();const aSe=wr(CZ,!0),SR=new Map,HJ={activated:!1,tokenObservers:[]},cSe={initialized:!1,enabled:!1};function T2(n){return SR.get(n)||Object.assign({},HJ)}function KM(){return cSe}class pSe{constructor(t,e,r,s,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=r,this.lowerBound=s,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=s,s>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){var e=this;return A(function*(){e.stop();try{e.pending=new SE,yield function gSe(n){return new Promise(t=>{setTimeout(t,n)})}(e.getNextRun(t)),e.pending.resolve(),yield e.pending.promise,e.pending=new SE,yield e.operation(),e.pending.resolve(),yield e.pending.promise,e.process(!0).catch(()=>{})}catch(r){e.retryPolicy(r)?e.process(!1).catch(()=>{}):e.stop()}})()}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const Oo=new C4("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function BJ(n){if(!T2(n).activated)throw Oo.create("use-before-activation",{appName:n.name})}function wR(n,t){return bR.apply(this,arguments)}function bR(){return bR=A(function*({url:n,body:t},e){var r,s;const i={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){const w=yield o.getHeartbeatsHeader();w&&(i["X-Firebase-Client"]=w)}const c={method:"POST",body:JSON.stringify(t),headers:i};let u,h;try{u=yield fetch(n,c)}catch(w){throw Oo.create("fetch-network-error",{originalErrorMessage:null===(r=w)||void 0===r?void 0:r.message})}if(200!==u.status)throw Oo.create("fetch-status-error",{httpStatus:u.status});try{h=yield u.json()}catch(w){throw Oo.create("fetch-parse-error",{originalErrorMessage:null===(s=w)||void 0===s?void 0:s.message})}const p=h.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw Oo.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${h.ttl}`});const m=1e3*Number(p[1]),C=Date.now();return{token:h.token,expireTimeMillis:C+m,issuedAtTimeMillis:C}}),bR.apply(this,arguments)}function CSe(n,t){const{projectId:e,appId:r,apiKey:s}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${e}/apps/${r}:exchangeDebugToken?key=${s}`,body:{debug_token:t}}}const Zg="firebase-app-check-store";let JM=null;function UJ(){return JM||(JM=new Promise((n,t)=>{var e;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=s=>{n(s.target.result)},r.onerror=s=>{var i;t(Oo.create("storage-open",{originalErrorMessage:null===(i=s.target.error)||void 0===i?void 0:i.message}))},r.onupgradeneeded=s=>{0===s.oldVersion&&s.target.result.createObjectStore(Zg,{keyPath:"compositeKey"})}}catch(r){t(Oo.create("storage-open",{originalErrorMessage:null===(e=r)||void 0===e?void 0:e.message}))}}),JM)}function OR(){return OR=A(function*(n,t){const r=(yield UJ()).transaction(Zg,"readwrite"),i=r.objectStore(Zg).put({compositeKey:n,value:t});return new Promise((o,c)=>{i.onsuccess=u=>{o()},r.onerror=u=>{var h;c(Oo.create("storage-set",{originalErrorMessage:null===(h=u.target.error)||void 0===h?void 0:h.message}))}})}),OR.apply(this,arguments)}const Yg=new pf("@firebase/app-check");function IR(n,t){return bu()?function SSe(n,t){return function GJ(n,t){return OR.apply(this,arguments)}(function qJ(n){return`${n.options.appId}-${n.name}`}(n),t)}(n,t).catch(e=>{Yg.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function jJ(){return KM().enabled}function ZJ(){return kR.apply(this,arguments)}function kR(){return kR=A(function*(){const n=KM();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),kR.apply(this,arguments)}const NSe={error:"UNKNOWN_ERROR"};function ASe(n){return bA.encodeString(JSON.stringify(n),!1)}function eS(n){return LR.apply(this,arguments)}function LR(){return LR=A(function*(n,t=!1){const e=n.app;BJ(e);const r=T2(e);let i,s=r.token;if(s&&!n9(s)&&(r.token=void 0,s=void 0),!s){const u=yield r.cachedTokenPromise;u&&(n9(u)?s=u:yield IR(e,void 0))}if(!t&&s&&n9(s))return{token:s.token};let c,o=!1;if(jJ()){r.exchangeTokenPromise||(r.exchangeTokenPromise=wR(CSe(e,yield ZJ()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const u=yield r.exchangeTokenPromise;return yield IR(e,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),s=yield T2(e).exchangeTokenPromise}catch(u){"appCheck/throttled"===u.code?Yg.warn(u.message):Yg.error(u),i=u}return s?i?c=n9(s)?{token:s.token,internalError:i}:XJ(i):(c={token:s.token},r.token=s,yield IR(e,s)):c=XJ(i),o&&KJ(e,c),c}),LR.apply(this,arguments)}function DR(n,t){const e=T2(n),r=e.tokenObservers.filter(s=>s.next!==t);0===r.length&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=r}function YJ(n){const{app:t}=n,e=T2(t);let r=e.tokenRefresher;r||(r=function ISe(n){const{app:t}=n;return new pSe(A(function*(){let r;if(r=T2(t).token?yield eS(n,!0):yield eS(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const e=T2(t);if(e.token){let r=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,e.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),e.tokenRefresher=r),!r.isRunning()&&e.isTokenAutoRefreshEnabled&&r.start()}function KJ(n,t){const e=T2(n).tokenObservers;for(const r of e)try{"EXTERNAL"===r.type&&null!=t.error?r.error(t.error):r.next(t)}catch{}}function n9(n){return n.expireTimeMillis-Date.now()>0}function XJ(n){return{token:ASe(NSe),error:n}}class xSe{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=T2(this.app);for(const e of t)DR(this.app,e.next);return Promise.resolve()}}const iee="app-check-internal";!function qSe(){Po(new Z2("app-check",n=>function kSe(n,t){return new xSe(n,t)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(iee).initialize()})),Po(new Z2(iee,n=>function LSe(n){return{getToken:t=>eS(n,t),addTokenListener:t=>function RR(n,t,e,r){const{app:s}=n,i=T2(s);if(i.tokenObservers=[...i.tokenObservers,{next:e,error:r,type:t}],i.token&&n9(i.token)){const c=i.token;Promise.resolve().then(()=>{e({token:c.token}),YJ(n)}).catch(()=>{})}i.cachedTokenPromise.then(()=>YJ(n))}(n,"INTERNAL",t),removeTokenListener:t=>DR(n.app,t)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),ls("@firebase/app-check","0.5.17")}();class FR{constructor(){return CR("app-check")}}typeof window<"u"&&window;const XSe=function aee(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},cee=new C4("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),lee=new pf("@firebase/auth");function nS(n,...t){lee.logLevel<=p1.ERROR&&lee.error(`Auth (${mf}): ${n}`,...t)}function la(n,...t){throw $R(n,...t)}function $a(n,...t){return $R(n,...t)}function uee(n,t,e){const r=Object.assign(Object.assign({},XSe()),{[t]:e});return new C4("auth","Firebase",r).create(t,{appName:n.name})}function r9(n,t,e){if(!(t instanceof e))throw e.name!==t.constructor.name&&la(n,"argument-error"),uee(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $R(n,...t){if("string"!=typeof n){const e=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(e,...r)}return cee.create(n,...t)}function Je(n,t,...e){if(!n)throw $R(t,...e)}function b4(n){const t="INTERNAL ASSERTION FAILED: "+n;throw nS(t),new Error(t)}function jl(n,t){n||b4(t)}const fee=new Map;function Zl(n){jl(n instanceof Function,"Expected a class definition");let t=fee.get(n);return t?(jl(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,fee.set(n,t),t)}function Kg(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function hee(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class Xg{constructor(t,e){this.shortDelay=t,this.longDelay=e,jl(e>t,"Short delay should be less than long delay!"),this.isMobile=function Jde(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ri())}()||function tpe(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()}get(){return function ePe(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(function UR(){return"http:"===hee()||"https:"===hee()}()||OA()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function GR(n,t){jl(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class dee{static initialize(t,e,r){this.fetchImpl=t,e&&(this.headersImpl=e),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void b4("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void b4("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void b4("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const nPe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},rPe=new Xg(3e4,6e4);function gi(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}function Bi(n,t,e,r){return WR.apply(this,arguments)}function WR(){return WR=A(function*(n,t,e,r,s={}){return pee(n,s,A(function*(){let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const c=Up(Object.assign({key:n.config.apiKey},o)).slice(1),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode),dee.fetch()(gee(n,n.config.apiHost,e,c),Object.assign({method:t,headers:u,referrerPolicy:"no-referrer"},i))}))}),WR.apply(this,arguments)}function pee(n,t,e){return qR.apply(this,arguments)}function qR(){return qR=A(function*(n,t,e){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},nPe),t);try{const s=new sPe(n),i=yield Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=yield i.json();if("needConfirmation"in o)throw Qg(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===u)throw Qg(n,"credential-already-in-use",o);if("EMAIL_EXISTS"===u)throw Qg(n,"email-already-in-use",o);if("USER_DISABLED"===u)throw Qg(n,"user-disabled",o);const p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw uee(n,p,h);la(n,p)}}catch(s){if(s instanceof Tc)throw s;la(n,"network-request-failed")}}),qR.apply(this,arguments)}function Yl(n,t,e,r){return jR.apply(this,arguments)}function jR(){return jR=A(function*(n,t,e,r,s={}){const i=yield Bi(n,t,e,r,s);return"mfaPendingCredential"in i&&la(n,"multi-factor-auth-required",{_serverResponse:i}),i}),jR.apply(this,arguments)}function gee(n,t,e,r){const s=`${t}${e}?${r}`;return n.config.emulator?GR(n.config,s):`${n.config.apiScheme}://${s}`}class sPe{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r($a(this.auth,"network-request-failed")),rPe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Qg(n,t,e){const r={appName:n.name};e.email&&(r.email=e.email),e.phoneNumber&&(r.phoneNumber=e.phoneNumber);const s=$a(n,t,r);return s.customData._tokenResponse=e,s}function ZR(){return ZR=A(function*(n,t){return Bi(n,"POST","/v1/accounts:delete",t)}),ZR.apply(this,arguments)}function aPe(n,t){return KR.apply(this,arguments)}function KR(){return KR=A(function*(n,t){return Bi(n,"POST","/v1/accounts:lookup",t)}),KR.apply(this,arguments)}function Jg(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}function XR(){return XR=A(function*(n,t=!1){const e=Xr(n),r=yield e.getIdToken(t),s=rS(r);Je(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:Jg(QR(s.auth_time)),issuedAtTime:Jg(QR(s.iat)),expirationTime:Jg(QR(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}),XR.apply(this,arguments)}function QR(n){return 1e3*Number(n)}function rS(n){var t;const[e,r,s]=n.split(".");if(void 0===e||void 0===r||void 0===s)return nS("JWT malformed, contained fewer than 3 sections"),null;try{const i=ME(r);return i?JSON.parse(i):(nS("Failed to decode base64 JWT payload"),null)}catch(i){return nS("Caught error parsing JWT payload as JSON",null===(t=i)||void 0===t?void 0:t.toString()),null}}function Kl(n,t){return JR.apply(this,arguments)}function JR(){return JR=A(function*(n,t,e=!1){if(e)return t;try{return yield t}catch(r){throw r instanceof Tc&&uPe(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}}),JR.apply(this,arguments)}function uPe({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}class fPe{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const r=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),r}{this.errorBackoff=3e4;const s=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){var e=this;if(!this.isRunning)return;const r=this.getInterval(t);this.timerId=setTimeout(A(function*(){yield e.iteration()}),r)}iteration(){var t=this;return A(function*(){var e;try{yield t.user.getIdToken(!0)}catch(r){return void("auth/network-request-failed"===(null===(e=r)||void 0===e?void 0:e.code)&&t.schedule(!0))}t.schedule()})()}}class mee{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jg(this.lastLoginAt),this.creationTime=Jg(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function em(n){return eD.apply(this,arguments)}function eD(){return eD=A(function*(n){var t;const e=n.auth,r=yield n.getIdToken(),s=yield Kl(n,aPe(e,{idToken:r}));Je(s?.users.length,e,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=null!==(t=i.providerUserInfo)&&void 0!==t&&t.length?pPe(i.providerUserInfo):[],c=dPe(n.providerData,o),p=!!n.isAnonymous&&!(n.email&&i.passwordHash||c?.length),m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new mee(i.createdAt,i.lastLoginAt),isAnonymous:p};Object.assign(n,m)}),eD.apply(this,arguments)}function tD(){return tD=A(function*(n){const t=Xr(n);yield em(t),yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}),tD.apply(this,arguments)}function dPe(n,t){return[...n.filter(r=>!t.some(s=>s.providerId===r.providerId)),...t]}function pPe(n){return n.map(t=>{var{providerId:e}=t,r=N5(t,["providerId"]);return{providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function nD(){return nD=A(function*(n,t){const e=yield pee(n,{},A(function*(){const r=Up({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=gee(n,s,"/v1/token",`key=${i}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",dee.fetch()(o,{method:"POST",headers:c,body:r})}));return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}),nD.apply(this,arguments)}class tm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Je(t.idToken,"internal-error"),Je(typeof t.idToken<"u","internal-error"),Je(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):function lPe(n){const t=rS(n);return Je(t,"internal-error"),Je(typeof t.exp<"u","internal-error"),Je(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}getToken(t,e=!1){var r=this;return A(function*(){return Je(!r.accessToken||r.refreshToken,t,"user-token-expired"),e||!r.accessToken||r.isExpired?r.refreshToken?(yield r.refresh(t,r.refreshToken),r.accessToken):null:r.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(t,e){var r=this;return A(function*(){const{accessToken:s,refreshToken:i,expiresIn:o}=yield function gPe(n,t){return nD.apply(this,arguments)}(t,e);r.updateTokensAndExpiration(s,i,Number(o))})()}updateTokensAndExpiration(t,e,r){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(t,e){const{refreshToken:r,accessToken:s,expirationTime:i}=e,o=new tm;return r&&(Je("string"==typeof r,"internal-error",{appName:t}),o.refreshToken=r),s&&(Je("string"==typeof s,"internal-error",{appName:t}),o.accessToken=s),i&&(Je("number"==typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new tm,this.toJSON())}_performRefresh(){return b4("not implemented")}}function H0(n,t){Je("string"==typeof n||typeof n>"u","internal-error",{appName:t})}class c5{constructor(t){var{uid:e,auth:r,stsTokenManager:s}=t,i=N5(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fPe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new mee(i.createdAt||void 0,i.lastLoginAt||void 0)}getIdToken(t){var e=this;return A(function*(){const r=yield Kl(e,e.stsTokenManager.getToken(e.auth,t));return Je(r,e.auth,"internal-error"),e.accessToken!==r&&(e.accessToken=r,yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)),r})()}getIdTokenResult(t){return function cPe(n){return XR.apply(this,arguments)}(this,t)}reload(){return function hPe(n){return tD.apply(this,arguments)}(this)}_assign(t){this!==t&&(Je(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){return new c5(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(t){Je(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(t,e=!1){var r=this;return A(function*(){let s=!1;t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),s=!0),e&&(yield em(r)),yield r.auth._persistUserIfCurrent(r),s&&r.auth._notifyListenersIfCurrent(r)})()}delete(){var t=this;return A(function*(){const e=yield t.getIdToken();return yield Kl(t,function iPe(n,t){return ZR.apply(this,arguments)}(t.auth,{idToken:e})),t.stsTokenManager.clearRefreshToken(),t.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var r,s,i,o,c,u,h,p;const m=null!==(r=e.displayName)&&void 0!==r?r:void 0,C=null!==(s=e.email)&&void 0!==s?s:void 0,w=null!==(i=e.phoneNumber)&&void 0!==i?i:void 0,I=null!==(o=e.photoURL)&&void 0!==o?o:void 0,H=null!==(c=e.tenantId)&&void 0!==c?c:void 0,Y=null!==(u=e._redirectEventId)&&void 0!==u?u:void 0,ee=null!==(h=e.createdAt)&&void 0!==h?h:void 0,ve=null!==(p=e.lastLoginAt)&&void 0!==p?p:void 0,{uid:te,emailVerified:Ie,isAnonymous:Be,providerData:Ye,stsTokenManager:Vt}=e;Je(te&&Vt,t,"internal-error");const R1=tm.fromJSON(this.name,Vt);Je("string"==typeof te,t,"internal-error"),H0(m,t.name),H0(C,t.name),Je("boolean"==typeof Ie,t,"internal-error"),Je("boolean"==typeof Be,t,"internal-error"),H0(w,t.name),H0(I,t.name),H0(H,t.name),H0(Y,t.name),H0(ee,t.name),H0(ve,t.name);const b1=new c5({uid:te,auth:t,email:C,emailVerified:Ie,displayName:m,isAnonymous:Be,photoURL:I,phoneNumber:w,tenantId:H,stsTokenManager:R1,createdAt:ee,lastLoginAt:ve});return Ye&&Array.isArray(Ye)&&(b1.providerData=Ye.map(rs=>Object.assign({},rs))),Y&&(b1._redirectEventId=Y),b1}static _fromIdTokenResponse(t,e,r=!1){return A(function*(){const s=new tm;s.updateFromServerResponse(e);const i=new c5({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:r});return yield em(i),i})()}}const _ee=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return A(function*(){return!0})()}_set(e,r){var s=this;return A(function*(){s.storage[e]=r})()}_get(e){var r=this;return A(function*(){const s=r.storage[e];return void 0===s?null:s})()}_remove(e){var r=this;return A(function*(){delete r.storage[e]})()}_addListener(e,r){}_removeListener(e,r){}}return n.type="NONE",n})();function sS(n,t,e){return`firebase:${n}:${t}:${e}`}class s9{constructor(t,e,r){this.persistence=t,this.auth=e,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=sS(this.userKey,s.apiKey,i),this.fullPersistenceKey=sS("persistence",s.apiKey,i),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}getCurrentUser(){var t=this;return A(function*(){const e=yield t.persistence._get(t.fullUserKey);return e?c5._fromJSON(t.auth,e):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(t){var e=this;return A(function*(){if(e.persistence===t)return;const r=yield e.getCurrentUser();return yield e.removeCurrentUser(),e.persistence=t,r?e.setCurrentUser(r):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(t,e,r="authUser"){return A(function*(){if(!e.length)return new s9(Zl(_ee),t,r);const s=(yield Promise.all(e.map(function(){var h=A(function*(p){if(yield p._isAvailable())return p});return function(p){return h.apply(this,arguments)}}()))).filter(h=>h);let i=s[0]||Zl(_ee);const o=sS(r,t.config.apiKey,t.name);let c=null;for(const h of e)try{const p=yield h._get(o);if(p){const m=c5._fromJSON(t,p);h!==i&&(c=m),i=h;break}}catch{}const u=s.filter(h=>h._shouldAllowMigration);return i._shouldAllowMigration&&u.length?(i=u[0],c&&(yield i._set(o,c.toJSON())),yield Promise.all(e.map(function(){var h=A(function*(p){if(p!==i)try{yield p._remove(o)}catch{}});return function(p){return h.apply(this,arguments)}}())),new s9(i,t,r)):new s9(i,t,r)})()}}function vee(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Eee(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Cee(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(See(t))return"Blackberry";if(Pee(t))return"Webos";if(rD(t))return"Safari";if((t.includes("chrome/")||yee(t))&&!t.includes("edge/"))return"Chrome";if(Mee(t))return"Android";{const r=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===r?.length)return r[1]}return"Other"}function Cee(n=Ri()){return/firefox\//i.test(n)}function rD(n=Ri()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function yee(n=Ri()){return/crios\//i.test(n)}function Eee(n=Ri()){return/iemobile/i.test(n)}function Mee(n=Ri()){return/android/i.test(n)}function See(n=Ri()){return/blackberry/i.test(n)}function Pee(n=Ri()){return/webos/i.test(n)}function iS(n=Ri()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Tee(n=Ri()){return iS(n)||Mee(n)||Pee(n)||See(n)||/windows phone/i.test(n)||Eee(n)}function wee(n,t=[]){let e;switch(n){case"Browser":e=vee(Ri());break;case"Worker":e=`${vee(Ri())}-${n}`;break;default:e=n}const r=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${mf}/${r}`}class CPe{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const r=i=>new Promise((o,c)=>{try{o(t(i))}catch(u){c(u)}});r.onAbort=e,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}runMiddleware(t){var e=this;return A(function*(){var r;if(e.auth.currentUser===t)return;const s=[];try{for(const i of e.queue)yield i(t),i.onAbort&&s.push(i.onAbort)}catch(i){s.reverse();for(const o of s)try{o()}catch{}throw e.auth._errorFactory.create("login-blocked",{originalMessage:null===(r=i)||void 0===r?void 0:r.message})}})()}}class yPe{constructor(t,e,r){this.app=t,this.heartbeatServiceProvider=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new bee(this),this.idTokenSubscription=new bee(this),this.beforeStateQueue=new CPe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cee,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(t,e){var r=this;return e&&(this._popupRedirectResolver=Zl(e)),this._initializationPromise=this.queue(A(function*(){var s,i;if(!r._deleted&&(r.persistenceManager=yield s9.create(r,t),!r._deleted)){if(null!==(s=r._popupRedirectResolver)&&void 0!==s&&s._shouldInitProactively)try{yield r._popupRedirectResolver._initialize(r)}catch{}yield r.initializeCurrentUser(e),r.lastNotifiedUid=(null===(i=r.currentUser)||void 0===i?void 0:i.uid)||null,!r._deleted&&(r._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var t=this;return A(function*(){if(t._deleted)return;const e=yield t.assertedPersistence.getCurrentUser();if(t.currentUser||e){if(t.currentUser&&e&&t.currentUser.uid===e.uid)return t._currentUser._assign(e),void(yield t.currentUser.getIdToken());yield t._updateCurrentUser(e,!0)}})()}initializeCurrentUser(t){var e=this;return A(function*(){var r;const s=yield e.assertedPersistence.getCurrentUser();let i=s,o=!1;if(t&&e.config.authDomain){yield e.getOrInitRedirectPersistenceManager();const c=null===(r=e.redirectUser)||void 0===r?void 0:r._redirectEventId,u=i?._redirectEventId,h=yield e.tryRedirectSignIn(t);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return e.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield e.beforeStateQueue.runMiddleware(i)}catch(c){i=s,e._popupRedirectResolver._overrideRedirectResult(e,()=>Promise.reject(c))}return i?e.reloadAndSetCurrentUserOrClear(i):e.directlySetCurrentUser(null)}return Je(e._popupRedirectResolver,e,"argument-error"),yield e.getOrInitRedirectPersistenceManager(),e.redirectUser&&e.redirectUser._redirectEventId===i._redirectEventId?e.directlySetCurrentUser(i):e.reloadAndSetCurrentUserOrClear(i)})()}tryRedirectSignIn(t){var e=this;return A(function*(){let r=null;try{r=yield e._popupRedirectResolver._completeRedirectFn(e,t,!0)}catch{yield e._setRedirectUser(null)}return r})()}reloadAndSetCurrentUserOrClear(t){var e=this;return A(function*(){var r;try{yield em(t)}catch(s){if("auth/network-request-failed"!==(null===(r=s)||void 0===r?void 0:r.code))return e.directlySetCurrentUser(null)}return e.directlySetCurrentUser(t)})()}useDeviceLanguage(){this.languageCode=function tPe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var t=this;return A(function*(){t._deleted=!0})()}updateCurrentUser(t){var e=this;return A(function*(){const r=t?Xr(t):null;return r&&Je(r.auth.config.apiKey===e.config.apiKey,e,"invalid-user-token"),e._updateCurrentUser(r&&r._clone(e))})()}_updateCurrentUser(t,e=!1){var r=this;return A(function*(){if(!r._deleted)return t&&Je(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),e||(yield r.beforeStateQueue.runMiddleware(t)),r.queue(A(function*(){yield r.directlySetCurrentUser(t),r.notifyAuthListeners()}))})()}signOut(){var t=this;return A(function*(){return yield t.beforeStateQueue.runMiddleware(null),(t.redirectPersistenceManager||t._popupRedirectResolver)&&(yield t._setRedirectUser(null)),t._updateCurrentUser(null,!0)})()}setPersistence(t){var e=this;return this.queue(A(function*(){yield e.assertedPersistence.setPersistence(Zl(t))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new C4("auth","Firebase",t())}onAuthStateChanged(t,e,r){return this.registerStateListener(this.authStateSubscription,t,e,r)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,r){return this.registerStateListener(this.idTokenSubscription,t,e,r)}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}_setRedirectUser(t,e){var r=this;return A(function*(){const s=yield r.getOrInitRedirectPersistenceManager(e);return null===t?s.removeCurrentUser():s.setCurrentUser(t)})()}getOrInitRedirectPersistenceManager(t){var e=this;return A(function*(){if(!e.redirectPersistenceManager){const r=t&&Zl(t)||e._popupRedirectResolver;Je(r,e,"argument-error"),e.redirectPersistenceManager=yield s9.create(e,[Zl(r._redirectPersistence)],"redirectUser"),e.redirectUser=yield e.redirectPersistenceManager.getCurrentUser()}return e.redirectPersistenceManager})()}_redirectUserForId(t){var e=this;return A(function*(){var r,s;return e._isInitialized&&(yield e.queue(A(function*(){}))),(null===(r=e._currentUser)||void 0===r?void 0:r._redirectEventId)===t?e._currentUser:(null===(s=e.redirectUser)||void 0===s?void 0:s._redirectEventId)===t?e.redirectUser:null})()}_persistUserIfCurrent(t){var e=this;return A(function*(){if(t===e.currentUser)return e.queue(A(function*(){return e.directlySetCurrentUser(t)}))})()}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,r,s){if(this._deleted)return()=>{};const i="function"==typeof e?e:e.next.bind(e),o=this._isInitialized?Promise.resolve():this._initializationPromise;return Je(o,this,"internal-error"),o.then(()=>i(this.currentUser)),"function"==typeof e?t.addObserver(e,r,s):t.addObserver(e)}directlySetCurrentUser(t){var e=this;return A(function*(){e.currentUser&&e.currentUser!==t&&e._currentUser._stopProactiveRefresh(),t&&e.isProactiveRefreshEnabled&&t._startProactiveRefresh(),e.currentUser=t,t?yield e.assertedPersistence.setCurrentUser(t):yield e.assertedPersistence.removeCurrentUser()})()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Je(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=wee(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var t=this;return A(function*(){var e;const r={"X-Client-Version":t.clientVersion};t.app.options.appId&&(r["X-Firebase-gmpid"]=t.app.options.appId);const s=yield null===(e=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader();return s&&(r["X-Firebase-Client"]=s),r})()}}function ua(n){return Xr(n)}class bee{constructor(t){this.auth=t,this.observer=null,this.addObserver=function ppe(n,t){const e=new gpe(n,t);return e.subscribe.bind(e)}(e=>this.observer=e)}get next(){return Je(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Oee(n,t,e){const r=ua(n);Je(r._canInitEmulator,r,"emulator-config-failed"),Je(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!e?.disableWarnings,i=Nee(t),{host:o,port:c}=function EPe(n){const t=Nee(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const r=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Aee(r.substr(i.length+1))}}{const[i,o]=r.split(":");return{host:i,port:Aee(o)}}}(t);r.config.emulator={url:`${i}//${o}${null===c?"":`:${c}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function MPe(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}function Nee(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function Aee(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}class sD{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return b4("not implemented")}_getIdTokenResponse(t){return b4("not implemented")}_linkToIdToken(t,e){return b4("not implemented")}_getReauthenticationResolver(t){return b4("not implemented")}}function oD(){return oD=A(function*(n,t){return Bi(n,"POST","/v1/accounts:update",t)}),oD.apply(this,arguments)}function cD(){return cD=A(function*(n,t){return Yl(n,"POST","/v1/accounts:signInWithPassword",gi(n,t))}),cD.apply(this,arguments)}function oS(n,t){return lD.apply(this,arguments)}function lD(){return lD=A(function*(n,t){return Bi(n,"POST","/v1/accounts:sendOobCode",gi(n,t))}),lD.apply(this,arguments)}function TPe(n,t){return uD.apply(this,arguments)}function uD(){return uD=A(function*(n,t){return oS(n,t)}),uD.apply(this,arguments)}function wPe(n,t){return fD.apply(this,arguments)}function fD(){return fD=A(function*(n,t){return oS(n,t)}),fD.apply(this,arguments)}function pD(){return pD=A(function*(n,t){return Yl(n,"POST","/v1/accounts:signInWithEmailLink",gi(n,t))}),pD.apply(this,arguments)}function gD(){return gD=A(function*(n,t){return Yl(n,"POST","/v1/accounts:signInWithEmailLink",gi(n,t))}),gD.apply(this,arguments)}class nm extends sD{constructor(t,e,r,s=null){super("password",r),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new nm(t,e,"password")}static _fromEmailAndCode(t,e,r=null){return new nm(t,e,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if(e?.email&&e?.password){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}_getIdTokenResponse(t){var e=this;return A(function*(){switch(e.signInMethod){case"password":return function PPe(n,t){return cD.apply(this,arguments)}(t,{returnSecureToken:!0,email:e._email,password:e._password});case"emailLink":return function NPe(n,t){return pD.apply(this,arguments)}(t,{email:e._email,oobCode:e._password});default:la(t,"internal-error")}})()}_linkToIdToken(t,e){var r=this;return A(function*(){switch(r.signInMethod){case"password":return function xee(n,t){return oD.apply(this,arguments)}(t,{idToken:e,returnSecureToken:!0,email:r._email,password:r._password});case"emailLink":return function APe(n,t){return gD.apply(this,arguments)}(t,{idToken:e,email:r._email,oobCode:r._password});default:la(t,"internal-error")}})()}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}function Xl(n,t){return mD.apply(this,arguments)}function mD(){return mD=A(function*(n,t){return Yl(n,"POST","/v1/accounts:signInWithIdp",gi(n,t))}),mD.apply(this,arguments)}class i9 extends sD{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new i9(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):la("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:r,signInMethod:s}=e,i=N5(e,["providerId","signInMethod"]);if(!r||!s)return null;const o=new i9(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(t){return Xl(t,this.buildRequest())}_linkToIdToken(t,e){const r=this.buildRequest();return r.idToken=e,Xl(t,r)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,Xl(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=Up(e)}return t}}class sm{constructor(t){var e,r,s,i,o,c;const u=Gp(Wp(t)),h=null!==(e=u.apiKey)&&void 0!==e?e:null,p=null!==(r=u.oobCode)&&void 0!==r?r:null,m=function zPe(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(s=u.mode)&&void 0!==s?s:null);Je(h&&p&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=p,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(c=u.tenantId)&&void 0!==c?c:null}static parseLink(t){const e=function VPe(n){const t=Gp(Wp(n)).link,e=t?Gp(Wp(t)).deep_link_id:null,r=Gp(Wp(n)).deep_link_id;return(r?Gp(Wp(r)).link:null)||r||e||t||n}(t);try{return new sm(e)}catch{return null}}}let kee=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,r){return nm._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const s=sm.parseLink(r);return Je(s,"argument-error"),nm._fromEmailAndCode(e,s.code,s.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class F0{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Lee extends F0{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}let HPe=(()=>{class n extends Lee{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return i9._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:s}=e;if(!r&&!s)return null;try{return n.credential(r,s)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function Ree(n,t){return MD.apply(this,arguments)}function MD(){return MD=A(function*(n,t){return Yl(n,"POST","/v1/accounts:signUp",gi(n,t))}),MD.apply(this,arguments)}class wc{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static _fromIdTokenResponse(t,e,r,s=!1){return A(function*(){const i=yield c5._fromIdTokenResponse(t,r,s),o=Dee(r);return new wc({user:i,providerId:o,_tokenResponse:r,operationType:e})})()}static _forOperation(t,e,r){return A(function*(){yield t._updateTokensIfNecessary(r,!0);const s=Dee(r);return new wc({user:t,providerId:s,_tokenResponse:r,operationType:e})})()}}function Dee(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class cS extends Tc{constructor(t,e,r,s){var i;super(e.code,e.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,cS.prototype),this.customData={appName:t.name,tenantId:null!==(i=t.tenantId)&&void 0!==i?i:void 0,_serverResponse:e.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,e,r,s){return new cS(t,e,r,s)}}function zee(n,t,e,r){return("reauthenticate"===t?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(i=>{throw"auth/multi-factor-auth-required"===i.code?cS._fromErrorAndOperation(n,i,t,r):i})}function TD(n,t){return wD.apply(this,arguments)}function wD(){return wD=A(function*(n,t,e=!1){const r=yield Kl(n,t._linkToIdToken(n.auth,yield n.getIdToken()),e);return wc._forOperation(n,"link",r)}),wD.apply(this,arguments)}function OD(){return OD=A(function*(n,t,e=!1){var r;const{auth:s}=n,i="reauthenticate";try{const o=yield Kl(n,zee(s,i,t,n),e);Je(o.idToken,s,"internal-error");const c=rS(o.idToken);Je(c,s,"internal-error");const{sub:u}=c;return Je(n.uid===u,s,"user-mismatch"),wc._forOperation(n,i,o)}catch(o){throw"auth/user-not-found"===(null===(r=o)||void 0===r?void 0:r.code)&&la(s,"user-mismatch"),o}}),OD.apply(this,arguments)}function Fee(n,t){return ND.apply(this,arguments)}function ND(){return ND=A(function*(n,t,e=!1){const r="signIn",s=yield zee(n,r,t),i=yield wc._fromIdTokenResponse(n,r,s);return e||(yield n._updateCurrentUser(i.user)),i}),ND.apply(this,arguments)}function ID(){return ID=A(function*(n,t){return Fee(ua(n),t)}),ID.apply(this,arguments)}function uS(n,t,e){var r;Je((null===(r=e.url)||void 0===r?void 0:r.length)>0,n,"invalid-continue-uri"),Je(typeof e.dynamicLinkDomain>"u"||e.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),t.continueUrl=e.url,t.dynamicLinkDomain=e.dynamicLinkDomain,t.canHandleCodeInApp=e.handleCodeInApp,e.iOS&&(Je(e.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),t.iOSBundleId=e.iOS.bundleId),e.android&&(Je(e.android.packageName.length>0,n,"missing-android-pkg-name"),t.androidInstallApp=e.android.installApp,t.androidMinimumVersionCode=e.android.minimumVersion,t.androidPackageName=e.android.packageName)}function WPe(n,t,e){return VD.apply(this,arguments)}function VD(){return VD=A(function*(n,t,e){const r=Xr(n),s={requestType:"PASSWORD_RESET",email:t};e&&uS(r,s,e),yield wPe(r,s)}),VD.apply(this,arguments)}function jPe(n,t,e){return UD.apply(this,arguments)}function UD(){return UD=A(function*(n,t,e){const r=ua(n),s=yield Ree(r,{returnSecureToken:!0,email:t,password:e}),i=yield wc._fromIdTokenResponse(r,"signIn",s);return yield r._updateCurrentUser(i.user),i}),UD.apply(this,arguments)}function ZPe(n,t,e){return function AD(n,t){return ID.apply(this,arguments)}(Xr(n),kee.credential(t,e))}function KPe(n,t){return ZD.apply(this,arguments)}function ZD(){return ZD=A(function*(n,t){const e=Xr(n),s={requestType:"VERIFY_EMAIL",idToken:yield n.getIdToken()};t&&uS(e.auth,s,t);const{email:i}=yield TPe(e.auth,s);i!==n.email&&(yield n.reload())}),ZD.apply(this,arguments)}function XPe(n,t){return KD.apply(this,arguments)}function KD(){return KD=A(function*(n,t){return Bi(n,"POST","/v1/accounts:update",t)}),KD.apply(this,arguments)}function QPe(n,t){return XD.apply(this,arguments)}function XD(){return XD=A(function*(n,{displayName:t,photoURL:e}){if(void 0===t&&void 0===e)return;const r=Xr(n),i={idToken:yield r.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},o=yield Kl(r,XPe(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const c=r.providerData.find(({providerId:u})=>"password"===u);c&&(c.displayName=r.displayName,c.photoURL=r.photoURL),yield r._updateTokensIfNecessary(o)}),XD.apply(this,arguments)}function oTe(n,t,e,r){return Xr(n).onAuthStateChanged(t,e,r)}const fS="__sak";class $ee{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(fS,"1"),this.storage.removeItem(fS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const dTe=(()=>{class n extends $ee{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function uTe(){const n=Ri();return rD(n)||iS(n)}()&&function vPe(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=Tee(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const s=this.storage.getItem(r),i=this.localCache[r];s!==i&&e(r,i,s)}}onStorageEvent(e,r=!1){if(!e.key)return void this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});const s=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const c=this.storage.getItem(s);if(e.newValue!==c)null!==e.newValue?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!r)return}const i=()=>{const c=this.storage.getItem(s);!r&&this.localCache[s]===c||this.notifyListeners(s,c)},o=this.storage.getItem(s);!function _Pe(){return function npe(){const n=Ri();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||o===e.newValue||e.newValue===e.oldValue?i():setTimeout(i,10)}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:s}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(e,r){var s=()=>super._set,i=this;return A(function*(){yield s().call(i,e,r),i.localCache[e]=JSON.stringify(r)})()}_get(e){var r=()=>super._get,s=this;return A(function*(){const i=yield r().call(s,e);return s.localCache[e]=JSON.stringify(i),i})()}_remove(e){var r=()=>super._remove,s=this;return A(function*(){yield r().call(s,e),delete s.localCache[e]})()}}return n.type="LOCAL",n})(),Uee=(()=>{class n extends $ee{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}return n.type="SESSION",n})();let gTe=(()=>{class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const s=new n(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}handleEvent(e){var r=this;return A(function*(){const s=e,{eventId:i,eventType:o,data:c}=s.data,u=r.handlersMap[o];if(!u?.size)return;s.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const h=Array.from(u).map(function(){var m=A(function*(C){return C(s.origin,c)});return function(C){return m.apply(this,arguments)}}()),p=yield function pTe(n){return Promise.all(n.map(function(){var t=A(function*(e){try{return{fulfilled:!0,value:yield e}}catch(r){return{fulfilled:!1,reason:r}}});return function(e){return t.apply(this,arguments)}}()))}(h);s.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:p})})()}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||0===this.handlersMap[e].size)&&delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function hS(n="",t=10){let e="";for(let r=0;r<t;r++)e+=Math.floor(10*Math.random());return n+e}class mTe{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}_send(t,e,r=50){var s=this;return A(function*(){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const p=hS("",20);i.port1.start();const m=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:i,onMessage(C){const w=C;if(w.data.eventId===p)switch(w.data.status){case"ack":clearTimeout(m),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(w.data.response);break;default:clearTimeout(m),clearTimeout(o),h(new Error("invalid_response"))}}},s.handlers.add(c),i.port1.addEventListener("message",c.onMessage),s.target.postMessage({eventType:t,eventId:p,data:e},[i.port2])}).finally(()=>{c&&s.removeMessageHandler(c)})})()}}function mi(){return window}function sz(){return typeof mi().WorkerGlobalScope<"u"&&"function"==typeof mi().importScripts}function iz(){return(iz=A(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Gee="firebaseLocalStorageDb",dS="firebaseLocalStorage",Wee="fbase_key";class om{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function pS(n,t){return n.transaction([dS],t?"readwrite":"readonly").objectStore(dS)}function oz(){const n=indexedDB.open(Gee,1);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(dS,{keyPath:Wee})}catch(s){e(s)}}),n.addEventListener("success",A(function*(){const r=n.result;r.objectStoreNames.contains(dS)?t(r):(r.close(),yield function MTe(){const n=indexedDB.deleteDatabase(Gee);return new om(n).toPromise()}(),t(yield oz()))}))})}function qee(n,t,e){return az.apply(this,arguments)}function az(){return az=A(function*(n,t,e){const r=pS(n,!0).put({[Wee]:t,value:e});return new om(r).toPromise()}),az.apply(this,arguments)}function cz(){return cz=A(function*(n,t){const e=pS(n,!1).get(t),r=yield new om(e).toPromise();return void 0===r?null:r.value}),cz.apply(this,arguments)}function jee(n,t){const e=pS(n,!0).delete(t);return new om(e).toPromise()}const wTe=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var e=this;return A(function*(){return e.db||(e.db=yield oz()),e.db})()}_withRetries(e){var r=this;return A(function*(){let s=0;for(;;)try{const i=yield r._openDb();return yield e(i)}catch(i){if(s++>3)throw i;r.db&&(r.db.close(),r.db=void 0)}})()}initializeServiceWorkerMessaging(){var e=this;return A(function*(){return sz()?e.initializeReceiver():e.initializeSender()})()}initializeReceiver(){var e=this;return A(function*(){e.receiver=gTe._getInstance(function yTe(){return sz()?self:null}()),e.receiver._subscribe("keyChanged",function(){var r=A(function*(s,i){return{keyProcessed:(yield e._poll()).includes(i.key)}});return function(s,i){return r.apply(this,arguments)}}()),e.receiver._subscribe("ping",function(){var r=A(function*(s,i){return["keyChanged"]});return function(s,i){return r.apply(this,arguments)}}())})()}initializeSender(){var e=this;return A(function*(){var r,s;if(e.activeServiceWorker=yield function vTe(){return iz.apply(this,arguments)}(),!e.activeServiceWorker)return;e.sender=new mTe(e.activeServiceWorker);const i=yield e.sender._send("ping",{},800);!i||(null===(r=i[0])||void 0===r?void 0:r.fulfilled)&&(null===(s=i[0])||void 0===s?void 0:s.value.includes("keyChanged"))&&(e.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(e){var r=this;return A(function*(){if(r.sender&&r.activeServiceWorker&&function CTe(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===r.activeServiceWorker)try{yield r.sender._send("keyChanged",{key:e},r.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return A(function*(){try{if(!indexedDB)return!1;const e=yield oz();return yield qee(e,fS,"1"),yield jee(e,fS),!0}catch{}return!1})()}_withPendingWrite(e){var r=this;return A(function*(){r.pendingWrites++;try{yield e()}finally{r.pendingWrites--}})()}_set(e,r){var s=this;return A(function*(){return s._withPendingWrite(A(function*(){return yield s._withRetries(i=>qee(i,e,r)),s.localCache[e]=r,s.notifyServiceWorker(e)}))})()}_get(e){var r=this;return A(function*(){const s=yield r._withRetries(i=>function STe(n,t){return cz.apply(this,arguments)}(i,e));return r.localCache[e]=s,s})()}_remove(e){var r=this;return A(function*(){return r._withPendingWrite(A(function*(){return yield r._withRetries(s=>jee(s,e)),delete r.localCache[e],r.notifyServiceWorker(e)}))})()}_poll(){var e=this;return A(function*(){const r=yield e._withRetries(o=>{const c=pS(o,!1).getAll();return new om(c).toPromise()});if(!r)return[];if(0!==e.pendingWrites)return[];const s=[],i=new Set;for(const{fbase_key:o,value:c}of r)i.add(o),JSON.stringify(e.localCache[o])!==JSON.stringify(c)&&(e.notifyListeners(o,c),s.push(o));for(const o of Object.keys(e.localCache))e.localCache[o]&&!i.has(o)&&(e.notifyListeners(o,null),s.push(o));return s})()}notifyListeners(e,r){this.localCache[e]=r;const s=this.listeners[e];if(s)for(const i of Array.from(s))i(r)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval(A(function*(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})();function Yee(n){return`__${n}${Math.floor(1e6*Math.random())}`}function u5(n,t){return t?Zl(t):(Je(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}Yee("rcb"),new Xg(3e4,6e4);class vz extends sD{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return Xl(t,this._buildIdpRequest())}_linkToIdToken(t,e){return Xl(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return Xl(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function UTe(n){return Fee(n.auth,new vz(n),n.bypassAuthState)}function GTe(n){const{auth:t,user:e}=n;return Je(e,t,"internal-error"),function Hee(n,t){return OD.apply(this,arguments)}(e,new vz(n),n.bypassAuthState)}function WTe(n){return Cz.apply(this,arguments)}function Cz(){return Cz=A(function*(n){const{auth:t,user:e}=n;return Je(e,t,"internal-error"),TD(e,new vz(n),n.bypassAuthState)}),Cz.apply(this,arguments)}class Xee{constructor(t,e,r,s,i=!1){this.auth=t,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){var t=this;return new Promise(function(){var e=A(function*(r,s){t.pendingPromise={resolve:r,reject:s};try{t.eventManager=yield t.resolver._initialize(t.auth),yield t.onExecution(),t.eventManager.registerConsumer(t)}catch(i){t.reject(i)}});return function(r,s){return e.apply(this,arguments)}}())}onAuthEvent(t){var e=this;return A(function*(){const{urlResponse:r,sessionId:s,postBody:i,tenantId:o,error:c,type:u}=t;if(c)return void e.reject(c);const h={auth:e.auth,requestUri:r,sessionId:s,tenantId:o||void 0,postBody:i||void 0,user:e.user,bypassAuthState:e.bypassAuthState};try{e.resolve(yield e.getIdpTask(u)(h))}catch(p){e.reject(p)}})()}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return UTe;case"linkViaPopup":case"linkViaRedirect":return WTe;case"reauthViaPopup":case"reauthViaRedirect":return GTe;default:la(this.auth,"internal-error")}}resolve(t){jl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){jl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const qTe=new Xg(2e3,1e4);function jTe(n,t,e){return yz.apply(this,arguments)}function yz(){return yz=A(function*(n,t,e){const r=ua(n);r9(n,t,F0);const s=u5(r,e);return new Sz(r,"signInViaPopup",t,s).executeNotNull()}),yz.apply(this,arguments)}let Sz=(()=>{class n extends Xee{constructor(e,r,s,i,o){super(e,r,i,o),this.provider=s,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var e=this;return A(function*(){const r=yield e.execute();return Je(r,e.auth,"internal-error"),r})()}onExecution(){var e=this;return A(function*(){jl(1===e.filter.length,"Popup operations only handle one event");const r=hS();e.authWindow=yield e.resolver._openPopup(e.auth,e.provider,e.filter[0],r),e.authWindow.associatedEvent=r,e.resolver._originValidation(e.auth).catch(s=>{e.reject(s)}),e.resolver._isIframeWebStorageSupported(e.auth,s=>{s||e.reject($a(e.auth,"web-storage-unsupported"))}),e.pollUserCancellation()})()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject($a(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,s;this.pollId=null!==(s=null===(r=this.authWindow)||void 0===r?void 0:r.window)&&void 0!==s&&s.closed?window.setTimeout(()=>{this.pollId=null,this.reject($a(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(e,qTe.get())};e()}}return n.currentPopupAction=null,n})();const am=new Map;class YTe extends Xee{constructor(t,e,r=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,r),this.eventId=null}execute(){var t=()=>super.execute,e=this;return A(function*(){let r=am.get(e.auth._key());if(!r){try{const i=(yield function KTe(n,t){return Pz.apply(this,arguments)}(e.resolver,e.auth))?yield t().call(e):null;r=()=>Promise.resolve(i)}catch(s){r=()=>Promise.reject(s)}am.set(e.auth._key(),r)}return e.bypassAuthState||am.set(e.auth._key(),()=>Promise.resolve(null)),r()})()}onAuthEvent(t){var e=()=>super.onAuthEvent,r=this;return A(function*(){if("signInViaRedirect"===t.type)return e().call(r,t);if("unknown"!==t.type){if(t.eventId){const s=yield r.auth._redirectUserForId(t.eventId);if(s)return r.user=s,e().call(r,t);r.resolve(null)}}else r.resolve(null)})()}onExecution(){return A(function*(){})()}cleanUp(){}}function Pz(){return Pz=A(function*(n,t){const e=Jee(t),r=Qee(n);if(!(yield r._isAvailable()))return!1;const s="true"===(yield r._get(e));return yield r._remove(e),s}),Pz.apply(this,arguments)}function XTe(n,t){am.set(n._key(),t)}function Qee(n){return Zl(n._redirectPersistence)}function Jee(n){return sS("pendingRedirect",n.config.apiKey,n.name)}function ete(n,t){return Iz.apply(this,arguments)}function Iz(){return Iz=A(function*(n,t,e=!1){const r=ua(n),s=u5(r,t),o=yield new YTe(r,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,yield r._persistUserIfCurrent(o.user),yield r._setRedirectUser(null,t)),o}),Iz.apply(this,arguments)}class nwe{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(t,r)&&(e=!0,this.sendToConsumer(t,r),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!function rwe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return rte(n);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var r;if(t.error&&!rte(t)){const s=(null===(r=t.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";e.onError($a(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const r=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&r}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(nte(t))}saveEventToCache(t){this.cachedEventUids.add(nte(t)),this.lastProcessedEventTime=Date.now()}}function nte(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function rte({type:n,error:t}){return"unknown"===n&&"auth/no-auth-event"===t?.code}function swe(n){return kz.apply(this,arguments)}function kz(){return kz=A(function*(n,t={}){return Bi(n,"GET","/v1/projects",t)}),kz.apply(this,arguments)}const iwe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,owe=/^https?/;function Lz(){return Lz=A(function*(n){if(n.config.emulator)return;const{authorizedDomains:t}=yield swe(n);for(const e of t)try{if(cwe(e))return}catch{}la(n,"unauthorized-domain")}),Lz.apply(this,arguments)}function cwe(n){const t=Kg(),{protocol:e,hostname:r}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return""===o.hostname&&""===r?"chrome-extension:"===e&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===e&&o.hostname===r}if(!owe.test(e))return!1;if(iwe.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const lwe=new Xg(3e4,6e4);function ste(){const n=mi().___jsl;if(n?.H)for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}let mS=null;function fwe(n){return mS=mS||function uwe(n){return new Promise((t,e)=>{var r,s,i;function o(){ste(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ste(),e($a(n,"network-request-failed"))},timeout:lwe.get()})}if(null!==(s=null===(r=mi().gapi)||void 0===r?void 0:r.iframes)&&void 0!==s&&s.Iframe)t(gapi.iframes.getContext());else{if(null===(i=mi().gapi)||void 0===i||!i.load){const c=Yee("iframefcb");return mi()[c]=()=>{gapi.load?o():e($a(n,"network-request-failed"))},function Zee(n){return new Promise((t,e)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=t,r.onerror=s=>{const i=$a("internal-error");i.customData=s,e(i)},r.type="text/javascript",r.charset="UTF-8",function ATe(){var n,t;return null!==(t=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==t?t:document}().appendChild(r)})}(`https://apis.google.com/js/api.js?onload=${c}`).catch(u=>e(u))}o()}}).catch(t=>{throw mS=null,t})}(n),mS}const hwe=new Xg(5e3,15e3),gwe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mwe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _we(n){const t=n.config;Je(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?GR(t,"emulator/auth/iframe"):`https://${n.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:n.name,v:mf},s=mwe.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${e}?${Up(r).slice(1)}`}function Rz(){return Rz=A(function*(n){const t=yield fwe(n),e=mi().gapi;return Je(e,n,"internal-error"),t.open({where:document.body,url:_we(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gwe,dontclear:!0},r=>new Promise(function(){var s=A(function*(i,o){yield r.restyle({setHideOnLeave:!1});const c=$a(n,"network-request-failed"),u=mi().setTimeout(()=>{o(c)},hwe.get());function h(){mi().clearTimeout(u),i(r)}r.ping(h).then(h,()=>{o(c)})});return function(i,o){return s.apply(this,arguments)}}()))}),Rz.apply(this,arguments)}const Cwe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ite{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ote(n,t,e,r,s,i){Je(n.config.authDomain,n,"auth-domain-config-required"),Je(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:r,v:mf,eventId:s};if(t instanceof F0){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",function dpe(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,h]of Object.entries(i||{}))o[u]=h}if(t instanceof Lee){const u=t.getScopes().filter(h=>""!==h);u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const c=o;for(const u of Object.keys(c))void 0===c[u]&&delete c[u];return`${function Owe({config:n}){return n.emulator?GR(n,"emulator/auth/handler"):`https://${n.authDomain}/__/auth/handler`}(n)}?${Up(c).slice(1)}`}const Dz="webStorageSupport",Awe=class Nwe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Uee,this._completeRedirectFn=ete,this._overrideRedirectResult=XTe}_openPopup(t,e,r,s){var i=this;return A(function*(){var o;jl(null===(o=i.eventManagers[t._key()])||void 0===o?void 0:o.manager,"_initialize() not called before _openPopup()");const c=ote(t,e,r,Kg(),s);return function Pwe(n,t,e,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Cwe),{width:r.toString(),height:s.toString(),top:i,left:o}),h=Ri().toLowerCase();e&&(c=yee(h)?"_blank":e),Cee(h)&&(t=t||"http://localhost",u.scrollbars="yes");const p=Object.entries(u).reduce((C,[w,I])=>`${C}${w}=${I},`,"");if(function mPe(n=Ri()){var t;return iS(n)&&!(null===(t=window.navigator)||void 0===t||!t.standalone)}(h)&&"_self"!==c)return function Twe(n,t){const e=document.createElement("a");e.href=n,e.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(r)}(t||"",c),new ite(null);const m=window.open(t||"",c,p);Je(m,n,"popup-blocked");try{m.focus()}catch{}return new ite(m)}(t,c,hS())})()}_openRedirect(t,e,r,s){var i=this;return A(function*(){return yield i._originValidation(t),function _Te(n){mi().location.href=n}(ote(t,e,r,Kg(),s)),new Promise(()=>{})})()}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:i}=this.eventManagers[e];return s?Promise.resolve(s):(jl(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(t);return this.eventManagers[e]={promise:r},r.catch(()=>{delete this.eventManagers[e]}),r}initAndGetManager(t){var e=this;return A(function*(){const r=yield function vwe(n){return Rz.apply(this,arguments)}(t),s=new nwe(t);return r.register("authEvent",i=>(Je(i?.authEvent,t,"invalid-auth-event"),{status:s.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),e.eventManagers[t._key()]={manager:s},e.iframes[t._key()]=r,s})()}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Dz,{type:Dz},s=>{var i;const o=null===(i=s?.[0])||void 0===i?void 0:i[Dz];void 0!==o&&e(!!o),la(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=function awe(n){return Lz.apply(this,arguments)}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Tee()||rD()||iS()}};var cte="@firebase/auth";class Iwe{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}getToken(t){var e=this;return A(function*(){return e.assertAuthConfigured(),yield e.auth._initializationPromise,e.auth.currentUser?{accessToken:yield e.auth.currentUser.getIdToken(t)}:null})()}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(r=>{var s;t((null===(s=r)||void 0===s?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);!e||(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Je(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Rwe=lZ("authIdTokenMaxAge")||300;let ute=null;const Dwe=n=>function(){var t=A(function*(e){const r=e&&(yield e.getIdTokenResult()),s=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(s&&s>Rwe)return;const i=r?.token;ute!==i&&(ute=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});return function(e){return t.apply(this,arguments)}}();function zwe(n=UA()){const t=gf(n,"auth");if(t.isInitialized())return t.getImmediate();const e=function QSe(n,t){const e=gf(n,"auth");if(e.isInitialized()){const s=e.getImmediate();if(TE(e.getOptions(),t??{}))return s;la(s,"already-initialized")}return e.initialize({options:t})}(n,{popupRedirectResolver:Awe,persistence:[wTe,dTe,Uee]}),r=lZ("authTokenSyncURL");if(r){const i=Dwe(r);(function iTe(n,t,e){Xr(n).beforeAuthStateChanged(t,e)})(e,i,()=>i(e.currentUser)),function sTe(n,t,e,r){Xr(n).onIdTokenChanged(t,e,r)}(e,o=>i(o))}const s=cZ("auth");return s&&Oee(e,`http://${s}`),e}!function kwe(n){Po(new Z2("auth",(t,{options:e})=>{const r=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),{apiKey:i,authDomain:o}=r.options;return((c,u)=>{Je(i&&!i.includes(":"),"invalid-api-key",{appName:c.name}),Je(!o?.includes(":"),"argument-error",{appName:c.name});const h={apiKey:i,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wee(n)},p=new yPe(c,u,h);return function JSe(n,t){const e=t?.persistence||[],r=(Array.isArray(e)?e:[e]).map(Zl);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(r,t?.popupRedirectResolver)}(p,e),p})(r,s)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,r)=>{t.getProvider("auth-internal").initialize()})),Po(new Z2("auth-internal",t=>{const e=ua(t.getProvider("auth").getImmediate());return new Iwe(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),ls(cte,"0.20.11",function xwe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),ls(cte,"0.20.11","esm2017")}("Browser");class _S{constructor(t){return t}}class hte{constructor(){return CR("auth")}}const zz=new xt("angularfire2.auth-instances");function Hwe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new _S(r)}}const Fwe={provide:hte,deps:[[new li,zz]]},Bwe={provide:_S,useFactory:function Vwe(n,t){const e=vR("auth",n,t);return e&&new _S(e)},deps:[[new li,zz],t9]};let $we=(()=>{class n{constructor(){ls("angularfire",YM.full,"auth")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({providers:[Bwe,Fwe]}),n})();const Wwe=wr(jPe,!0),qwe=wr(zwe,!0),jwe=wr(oTe,!0),Zwe=wr(KPe,!0),Ywe=wr(WPe,!0),Kwe=wr(ZPe,!0),Xwe=wr(jTe,!0),Qwe=wr(QPe,!0);class B0{constructor(t){return t}}const Vz=new xt("angularfire2.firestore-instances");function tbe(n){return(t,e)=>{const r=t.runOutsideAngular(()=>n(e));return new B0(r)}}const nbe={provide:class Jwe{constructor(){return CR("firestore")}},deps:[[new li,Vz]]},rbe={provide:B0,useFactory:function ebe(n,t){const e=vR("firestore",n,t);return e&&new B0(e)},deps:[[new li,Vz],t9]};let sbe=(()=>{class n{constructor(){ls("angularfire",YM.full,"fst")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({providers:[rbe,nbe]}),n})();const obe=wr(sye,!0),abe=wr(yCe,!0),lbe=wr(rye,!0),cm=wr(fQ,!0),ube=wr(JCe,!0),fbe=wr(eye,!0),hbe=wr(DCe,!0),dbe=wr(KCe,!0),pte=wr(iye,!0),pbe=wr(YCe,!0),vS=wr(WCe,!0),gbe=wr(tye,!0),mbe=wr(nye,!0),_be=wr(jCe,!0);let lm=(()=>{class n{constructor(e,r){this.collectionName=e,this.firestore=r,this.subDAOs={};this.collection=abe(r,this.collectionName).withConverter({fromFirestore:i=>i.data(),toFirestore:i=>i})}create(e){var r=this;return A(function*(){return K(n.VERBOSE,{called:r.collectionName+".create",newElement:e}),(yield obe(r.collection,e)).id})()}read(e){var r=this;return A(function*(){K(n.VERBOSE,{called:r.collectionName+".read",id:e});const s=yield ube(cm(r.collection,e));return s.exists()?P.of(we.getNonNullable(s.data())):P.empty()})()}exists(e){var r=this;return A(function*(){return K(n.VERBOSE,{called:r.collectionName+".exists",id:e}),(yield r.read(e)).isPresent()})()}update(e,r){var s=this;return A(function*(){return K(n.VERBOSE,{called:s.collectionName+".update",id:e,update:r}),mbe(cm(s.collection,e),r)})()}delete(e){return K(n.VERBOSE,{called:this.collectionName+".delete",id:e}),lbe(cm(this.collection,e))}set(e,r){return K(n.VERBOSE,{called:this.collectionName+".set",id:e,element:r}),gbe(cm(this.collection,e),r)}subscribeToChanges(e,r){return new q1(pte(cm(this.collection,e),s=>{r(P.ofNullable(s.data()))}))}findWhere(e,r,s){var i=this;return A(function*(){const o=i.constructQuery(e,r,s);return(yield fbe(o)).docs.map(u=>({id:u.id,data:u.data()}))})()}observingWhere(e,r,s){K(n.VERBOSE,{called:this.collectionName+".observingWhere"});const i=this.constructQuery(e,s);return new q1(pte(i,o=>{const c=[],u=[],h=[];o.docChanges().forEach(p=>{const m={id:p.doc.id,data:p.doc.data()};switch(p.type){case"added":c.push(m);break;case"modified":u.push(m);break;case"removed":h.push(m)}}),c.length>0&&(K(n.VERBOSE,"firebase gave us "+c.length+" NEW "+this.collectionName),r.onDocumentCreated(c)),u.length>0&&(K(n.VERBOSE,"firebase gave us "+u.length+" MODIFIED "+this.collectionName),r.onDocumentModified(u)),h.length>0&&(K(n.VERBOSE,"firebase gave us "+h.length+" DELETED "+this.collectionName),r.onDocumentDeleted(h))}))}constructQuery(e,r,s){let i=vS(this.collection);null!=r&&(i=vS(i,pbe(r))),null!=s&&(i=vS(i,dbe(s)));for(const o of e)i=vS(i,_be(o[0],o[1],o[2]));return i}subCollectionDAO(e,r){const s=`${this.collection.path}/${e}/${r}`;if(s in this.subDAOs)return this.subDAOs[s];{const i=new class extends n{constructor(o){super(s,o)}}(this.firestore);return this.subDAOs[s]=i,i}}}return n.VERBOSE=!1,n})(),vbe=(()=>{class n extends lm{constructor(e){super("errors",e)}}return n.\u0275fac=function(e){return new(e||n)(Re(B0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Cbe=tc(2486);let Tn=(()=>{class n{infoMessage(e){this.message(e,"is-info")}gameMessage(e){this.message(e,"is-warning")}criticalMessage(e){this.message(e,"is-danger")}message(e,r){(0,Cbe.toast)({message:e,duration:3e3,position:"top-center",closeOnClick:!0,type:r,dismissible:!0})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class bs{constructor(t,e,r){this.errorDAO=t,this.router=e,this.messageDisplayer=r,bs.setSingletonInstance(this)}static setSingletonInstance(t){bs.singleton=P.of(t)}static logErrorAndFail(t,e,r){throw bs.logError(t,e,r),new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`)}static logError(t,e,r){if(this.singleton.isAbsent())throw new Error(`${t}: ${e} (extra data: ${JSON.stringify(r)})`);return this.singleton.get().logError(t,e,r),U.failure(t+": "+e)}findErrors(t,e,r,s){return this.errorDAO.findWhere(void 0===s?[["component","==",t],["route","==",e],["message","==",r]]:[["component","==",t],["route","==",e],["message","==",r],["data","==",s]])}logError(t,e,r){var s=this;return A(function*(){s.messageDisplayer.criticalMessage($localize`An unexpected error was encountered. We have logged it and will try to fix its cause as soon as possible.`);const i=s.router.url,o=yield s.findErrors(t,i,e,r);if(0===o.length){const c={component:t,route:i,message:e,firstEncounter:V0(),lastEncounter:V0(),occurences:1};null!=r&&(c.data=r),yield s.errorDAO.create(c)}else{const c=o[0].id,u=o[0].data;yield s.errorDAO.update(c,{lastEncounter:V0(),occurences:u.occurences+1})}})()}}bs.singleton=P.empty(),bs.\u0275fac=function(t){return new(t||bs)(Re(vbe),Re(jn),Re(Tn))},bs.\u0275prov=et({token:bs,factory:bs.\u0275fac,providedIn:"root"});class we{static expectToBe(t,e,r){if(t!==e)throw void 0!==r?new Error(r):new Error(`A default switch case did not observe the correct value, expected ${e}, but got ${t} instead.`)}static expectToBeMultiple(t,e){let r=!1;for(const s of e)if(t===s){r=!0;break}if(!1===r)throw new Error(`A default switch case did not observe the correct value, expected a value among ${e}, but got ${t} instead.`)}static getNonNullable(t){if(null==t)throw new Error("Expected value not to be null or undefined, but it was.");return t}static assert(t,e){if(!1===t)throw bs.logError("Assertion failure",e),new Error(`Assertion failure: ${e}`)}}function K(n,t){n&&console.log(t)}let Ebe=(()=>{class n extends lm{constructor(e){super("chats",e),K(n.VERBOSE,"ChatDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Re(B0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gte=(()=>{class n{}return n.CANNOT_SEND_MESSAGE=()=>$localize`You're not allowed to send a message here.`,n.FORBIDDEN_MESSAGE=()=>$localize`This message is forbidden.`,n})(),CS=(()=>{class n{constructor(e){this.chatDAO=e,K(n.VERBOSE,"ChatService.constructor")}addMessage(e,r){var s=this;return A(function*(){return s.chatDAO.subCollectionDAO(e,"messages").create(r)})()}getLastMessages(e,r){var s=this;return A(function*(){return s.chatDAO.subCollectionDAO(e,"messages").findWhere([],"postedTime",r)})()}subscribeToMessages(e,r){return this.chatDAO.subCollectionDAO(e,"messages").observingWhere([],r,"postedTime")}deleteChat(e){var r=this;return A(function*(){return K(n.VERBOSE,"ChatService.deleteChat "+e),r.chatDAO.delete(e)})()}createNewChat(e){var r=this;return A(function*(){return r.chatDAO.set(e,{})})()}sendMessage(e,r,s,i){var o=this;return A(function*(){if(!1===o.userCanSendMessage(r.name,e))return U.failure(gte.CANNOT_SEND_MESSAGE());if(o.isForbiddenMessage(s))return U.failure(gte.FORBIDDEN_MESSAGE());const c={content:s,sender:r,postedTime:V0(),currentTurn:i};return yield o.addMessage(e,c),U.SUCCESS})()}userCanSendMessage(e,r){return""!==e}isForbiddenMessage(e){return""===e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Re(Ebe))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),yS=(()=>{class n extends lm{constructor(e){super(n.COLLECTION_NAME,e),K(n.VERBOSE,"UserDAO.constructor")}}return n.VERBOSE=!1,n.COLLECTION_NAME="users",n.\u0275fac=function(e){return new(e||n)(Re(B0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),um=(()=>{class n{constructor(e){this.userDAO=e}usernameIsAvailable(e){var r=this;return A(function*(){return 0===(yield r.userDAO.findWhere([["username","==",e]])).length})()}setUsername(e,r){var s=this;return A(function*(){yield s.userDAO.update(e,{username:r})})()}markAsVerified(e){var r=this;return A(function*(){yield r.userDAO.update(e,{verified:!0})})()}observeUser(e,r){return this.userDAO.subscribeToChanges(e,r)}getUserLastUpdateTime(e){var r=this;return A(function*(){const s=yield r.userDAO.read(e);if(s.isAbsent())return P.empty();{const i=s.get().lastUpdateTime;return ye(null!=i,"should not receive a lastUpdateTime equal to null"),P.of(i)}})()}updatePresenceToken(e){return this.userDAO.update(e,{lastUpdateTime:V0()})}}return n.\u0275fac=function(e){return new(e||n)(Re(yS))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class mte extends z2{constructor(t=1/0,e=1/0,r=uR){super(),this._bufferSize=t,this._windowTime=e,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=e===1/0,this._bufferSize=Math.max(1,t),this._windowTime=Math.max(1,e)}next(t){const{isStopped:e,_buffer:r,_infiniteTimeWindow:s,_timestampProvider:i,_windowTime:o}=this;e||(r.push(t),!s&&r.push(i.now()+o)),this._trimBuffer(),super.next(t)}_subscribe(t){this._throwIfClosed(),this._trimBuffer();const e=this._innerSubscribe(t),{_infiniteTimeWindow:r,_buffer:s}=this,i=s.slice();for(let o=0;o<i.length&&!t.closed;o+=r?1:2)t.next(i[o]);return this._checkFinalizedStatuses(t),e}_trimBuffer(){const{_bufferSize:t,_timestampProvider:e,_buffer:r,_infiniteTimeWindow:s}=this,i=(s?1:2)*t;if(t<1/0&&i<r.length&&r.splice(0,r.length-i),!s){const o=e.now();let c=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)c=u;c&&r.splice(0,c+1)}}}let fm=(()=>{class n{}return n.YOU_ARE_ALREADY_PLAYING=()=>$localize`You are already playing in another game.`,n.YOU_ARE_ALREADY_CREATING=()=>$localize`You are already the creator of another game.`,n.YOU_ARE_ALREADY_CHOSEN_OPPONENT=()=>$localize`You are already the chosen opponent in another game.`,n.YOU_ARE_ALREADY_CANDIDATE=()=>$localize`You are already candidate in another game.`,n.YOU_ARE_ALREADY_OBSERVING=()=>$localize`You are already observing another game.`,n})();class $0{static createUserWithEmailAndPassword(t,e,r){return Wwe(t,e,r)}static sendEmailVerification(t){return Zwe(t)}static sendPasswordResetEmail(t,e){return Ywe(t,e)}static signInWithEmailAndPassword(t,e,r){return A(function*(){return(yield Kwe(t,e,r)).user})()}static signInWithPopup(t,e){return A(function*(){return(yield Xwe(t,e)).user})()}static updateProfile(t,e){return Qwe(t,e)}}class f5{constructor(t,e,r,s){this.id=t,this.email=e,this.username=r,this.verified=s}isConnected(){return this.email.isPresent()}toMinimalUser(){return{id:this.id,name:this.username.get()}}equals(t){return this.id===t.id&&this.email.equals(t.email)&&this.username.equals(t.username)&&this.verified===t.verified}}f5.NOT_CONNECTED=new f5("",P.empty(),P.empty(),!1);let Os=(()=>{class n{constructor(e,r,s){var i=this;this.userDAO=e,this.userService=r,this.auth=s,this.user=P.empty(),this.userSubscription=new q1,K(n.VERBOSE,"ConnectedUserService constructor"),this.userRS=new mte(1),this.userObs=this.userRS.asObservable(),this.authSubscription=new q1(jwe(this.auth,function(){var o=A(function*(c){null==c?(K(n.VERBOSE,"User is not connected"),i.userSubscription.unsubscribe(),i.userRS.next(f5.NOT_CONNECTED),i.user=P.empty()):(ye(i.user.isAbsent(),"ConnectedUserService received a double update for an user, this is unexpected"),i.userSubscription=i.userDAO.subscribeToChanges(c.uid,u=>{if(u.isPresent()){const h=u.get(),p=h.username;K(n.VERBOSE,`User ${p} is connected, and the verified status is ${i.emailVerified(c)}`);const m=!0===i.emailVerified(c)&&null!=p;if(!0===m&&!1===h.verified)return i.userService.markAsVerified(c.uid);const C=new f5(c.uid,P.ofNullable(c.email),P.ofNullable(p),m);!1===i.user.equalsValue(C)&&(i.user=P.of(C),i.userRS.next(C))}}))});return function(c){return o.apply(this,arguments)}}()))}emailVerified(e){return e.emailVerified}sendPasswordResetEmail(e){var r=this;return A(function*(){try{return yield $0.sendPasswordResetEmail(r.auth,e),U.SUCCESS}catch(s){return U.failure(r.mapFirebaseError(s))}})()}doRegister(e,r,s){var i=this;return A(function*(){return K(n.VERBOSE,"ConnectedUserService.doRegister("+r+")"),(yield i.userService.usernameIsAvailable(e))?i.registerAfterUsernameCheck(e,r,s):$.failure($localize`This username is already in use.`)})()}registerAfterUsernameCheck(e,r,s){var i=this;return A(function*(){try{const o=yield $0.createUserWithEmailAndPassword(i.auth,r,s);yield $0.signInWithEmailAndPassword(i.auth,r,s);const c=we.getNonNullable(o.user);return yield i.createUser(c.uid,e),$.success(c)}catch(o){return $.failure(i.mapFirebaseError(o))}})()}mapFirebaseError(e){switch(e.code){case"auth/email-already-in-use":return $localize`This email address is already in use.`;case"auth/invalid-email":return $localize`This email address is invalid.`;case"auth/user-not-found":case"auth/wrong-password":return $localize`You have entered invalid credentials.`;case"auth/invalid-credential":return $localize`The credential is invalid or has expired, please try again.`;case"auth/weak-password":return $localize`Your password is too weak, please use a stronger password.`;case"auth/too-many-requests":return $localize`There has been too many requests from your device. You are temporarily blocked due to unusual activity. Try again later.`;case"auth/popup-closed-by-user":return $localize`You closed the authentication popup without finalizing your log in.`;case"auth/popup-blocked":return $localize`The authentication popup was blocked. Try again after disabling popup blocking.`;default:return bs.logError("ConnectedUserService","Unsupported firebase error",{errorCode:e.code,errorMessage:e.message}),e.message}}sendEmailVerification(){var e=this;return A(function*(){K(n.VERBOSE,"ConnectedUserService.sendEmailVerification()");const r=P.ofNullable(e.auth.currentUser);if(!r.isPresent())return bs.logError("ConnectedUserService","Unlogged users cannot request for email verification");if(e.emailVerified(r.get()))return bs.logError("ConnectedUserService","Verified users should not ask email verification after being verified");try{return yield $0.sendEmailVerification(r.get()),U.SUCCESS}catch(s){return U.failure(e.mapFirebaseError(s))}})()}doEmailLogin(e,r){var s=this;return A(function*(){K(n.VERBOSE,"ConnectedUserService.doEmailLogin("+e+")");try{return yield $0.signInWithEmailAndPassword(s.auth,e,r),U.SUCCESS}catch(i){return U.failure(s.mapFirebaseError(i))}})()}createUser(e,r){var s=this;return A(function*(){null==r?yield s.userDAO.set(e,{verified:!1}):yield s.userDAO.set(e,{username:r,verified:!1})})()}doGoogleLogin(){var e=this;return A(function*(){return U.ofFallible(yield e.registerOrLoginWithGoogle())})()}registerOrLoginWithGoogle(){var e=this;return A(function*(){try{const r=new HPe;r.addScope("profile"),r.addScope("email");const s=yield $0.signInWithPopup(e.auth,r);return!1===(yield e.userDAO.exists(s.uid))&&(yield e.createUser(s.uid)),$.success(s)}catch(r){return $.failure(e.mapFirebaseError(r))}})()}disconnect(){var e=this;return A(function*(){return P.ofNullable(e.auth.currentUser).isPresent()?(yield e.auth.signOut(),U.SUCCESS):U.failure("Cannot disconnect a non-connected user")})()}subscribeToUser(e){return this.userObs.subscribe(e)}setUsername(e){var r=this;return A(function*(){if(""===e)return U.failure($localize`Your username may not be empty.`);try{if(!1===(yield r.userService.usernameIsAvailable(e)))return U.failure($localize`This username is already in use, please select a different one.`);const i=we.getNonNullable(r.auth.currentUser);return yield $0.updateProfile(i,{displayName:e}),yield r.userService.setUsername(i.uid,e),yield r.userService.markAsVerified(i.uid),yield r.reloadUser(),U.SUCCESS}catch(s){return U.failure(r.mapFirebaseError(s))}})()}setPicture(e){var r=this;return A(function*(){try{const s=we.getNonNullable(r.auth.currentUser);return yield $0.updateProfile(s,{photoURL:e}),U.SUCCESS}catch(s){return U.failure(r.mapFirebaseError(s))}})()}reloadUser(){var e=this;return A(function*(){const r=we.getNonNullable(e.auth.currentUser);yield r.getIdToken(!0),yield r.reload()})()}sendPresenceToken(){return ye(this.user.isPresent(),"Should not call sendPresenceToken when not connected"),this.userService.updatePresenceToken(this.user.get().id)}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Re(yS),Re(um),Re(_S))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Rn{constructor(t){this.value=t}}Rn.HARD_DRAW=new Rn(0),Rn.RESIGN=new Rn(1),Rn.ESCAPE=new Rn(2),Rn.VICTORY=new Rn(3),Rn.TIMEOUT=new Rn(4),Rn.UNACHIEVED=new Rn(5),Rn.AGREED_DRAW_BY_ZERO=new Rn(6),Rn.AGREED_DRAW_BY_ONE=new Rn(7);class ES{constructor(t,e){this.id=t,this.data=e}getTurn(){return this.data.turn}isHardDraw(){return this.data.result===Rn.HARD_DRAW.value}isAgreedDraw(){return this.data.result===Rn.AGREED_DRAW_BY_ZERO.value||this.data.result===Rn.AGREED_DRAW_BY_ONE.value}getDrawAccepter(){return this.data.result===Rn.AGREED_DRAW_BY_ZERO.value?this.data.playerZero:(ye(this.data.result===Rn.AGREED_DRAW_BY_ONE.value,"should not access getDrawAccepter when no draw accepted!"),we.getNonNullable(this.data.playerOne))}isWin(){return this.data.result===Rn.VICTORY.value}isTimeout(){return this.data.result===Rn.TIMEOUT.value}isResign(){return this.data.result===Rn.RESIGN.value}getWinner(){return P.ofNullable(this.data.winner)}getLoser(){return P.ofNullable(this.data.loser)}setWinnerAndLoser(t,e){return new ES(this.id,{...this.data,winner:t,loser:e})}}class js{constructor(t){this.value=t}static of(t){switch(t){case"CREATOR":return js.CREATOR;case"RANDOM":return js.RANDOM;default:return ye("CHOSEN_PLAYER"===t,"Invalid value for FirstPlayer: "+t+"."),js.CHOSEN_PLAYER}}}js.CREATOR=new js("CREATOR"),js.RANDOM=new js("RANDOM"),js.CHOSEN_PLAYER=new js("CHOSEN_PLAYER");class br{constructor(t){this.value=t}static of(t){switch(t){case"STANDARD":return br.STANDARD;case"BLITZ":return br.BLITZ;case"CUSTOM":return br.CUSTOM;default:throw new Error("Invalid part type: "+t+".")}}}br.STANDARD=new br("STANDARD"),br.BLITZ=new br("BLITZ"),br.CUSTOM=new br("CUSTOM"),br.NORMAL_MOVE_DURATION=120,br.NORMAL_PART_DURATION=1800,br.BLITZ_MOVE_DURATION=30,br.BLITZ_PART_DURATION=900;class Zs{constructor(t){this.value=t}}Zs.PART_CREATED=new Zs(0),Zs.CONFIG_PROPOSED=new Zs(2),Zs.PART_STARTED=new Zs(3),Zs.PART_FINISHED=new Zs(4);class Hz{constructor(){this.value=2}isPlayer(){return!1}toString(){return"PLAYER_NONE"}equals(t){return this===t}}Hz.NONE=new Hz;class z{constructor(t){this.value=t}static of(t){return 0===t?z.ZERO:(we.expectToBe(t,1),z.ONE)}static fromTurn(t){return t%2==0?z.ZERO:z.ONE}isPlayer(){return!0}toString(){return this===z.ZERO?"PLAYER_ZERO":(we.expectToBe(this,z.ONE,"Player should not be something else than Player.ZERO and Player.ONE"),"PLAYER_ONE")}equals(t){return this===t}getScoreModifier(){return 0===this.value?-1:1}getPreVictory(){return this.getVictoryValue()-this.getScoreModifier()}getDefeatValue(){return this===z.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER}getVictoryValue(){return this===z.ZERO?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER}getOpponent(){return this===z.ZERO?z.ONE:(we.expectToBe(this,z.ONE),z.ZERO)}}var pe;z.numberEncoder=Cn.ofN(2,n=>n.value,n=>2===n?pe.NONE:z.of(n)),z.ZERO=new z(0),z.ONE=new z(1),z.PLAYERS=[z.ZERO,z.ONE],function(n){n.ZERO=z.ZERO,n.ONE=z.ONE,n.NONE=Hz.NONE}(pe||(pe={}));class Br{static rematchAccepted(t,e){return _te("RematchAccepted",{typeGame:t,partId:e})}static getPlayer(t){return z.of(we.getNonNullable(t.data).player)}static getTypeGame(t){return we.getNonNullable(t.data).typeGame}static getPartId(t){return we.getNonNullable(t.data).partId}}function _te(n,t){return{code:n,data:t}}function U0(n){return t=>_te(n,{player:t.value})}Br.drawProposed=U0("DrawProposed"),Br.drawRefused=U0("DrawRefused"),Br.takeBackAsked=U0("TakeBackAsked"),Br.takeBackRefused=U0("TakeBackRefused"),Br.takeBackAccepted=U0("TakeBackAccepted"),Br.rematchProposed=U0("RematchProposed"),Br.addTurnTime=U0("AddTurnTime"),Br.addGlobalTime=U0("AddGlobalTime");class vte{static toComparableObjectSet(t){const e=[];return t.forEach(r=>{e.some(s=>s.equals(r))||e.push(r)}),e}static toComparableSet(t){const e=[];return t.forEach(r=>{e.some(s=>Fa(s,r))||e.push(r)}),e}}class Ht{constructor(t){this.values=void 0===t?[]:vte.toComparableSet(t)}equals(t){if(t.size()!==this.size())return!1;for(const e of this)if(!1===t.contains(e))return!1;return!0}toString(){let t="";for(const e of this)t+=null==e?"null, ":e.toString()+", ";return"["+t.slice(0,-2)+"]"}add(t){return!this.contains(t)&&(this.values.push(t),!0)}remove(t){for(let e=0;e<this.values.length;e++)if(Fa(this.values[e],t))return this.values.splice(e,1),!0;return!1}addAll(t){for(const e of t)this.add(e)}union(t){const e=new Ht(this.toList());return e.addAll(t),e}contains(t){for(const e of this.values)if(Fa(e,t))return!0;return!1}size(){return this.values.length}toList(){const t=[];for(const e of this)t.push(e);return t}getAnyElement(){return this.size()>0?P.of(this.values[0]):P.empty()}isEmpty(){return 0===this.values.length}hasElements(){return!1===this.isEmpty()}map(t){const e=[];for(const r of this.values)e.push(t(r));return new Ht(e)}flatMap(t){const e=new Ht;for(const r of this)e.addAll(t(r));return e}filter(t){const e=new Ht;for(const r of this)t(r)&&e.add(r);return e}findAnyCommonElement(t){for(const e of t)if(this.contains(e))return P.of(e);return P.empty()}intersection(t){const e=new Ht;for(const r of t)this.contains(r)&&e.add(r);return e}[Symbol.iterator](){return this.values.values()}}class zn{constructor(t=[],e=!1){this.map=t,this.isImmutable=e}static from(t){const e=Object.keys(t),r=new zn;for(const s of e)r.set(s,t[s]);return r}makeImmutable(){this.isImmutable=!0}get(t){for(const e of this.map)if(Fa(e.key,t))return P.of(e.value);return P.empty()}forEach(t){for(let e=0;e<this.map.length;e++)t(this.getByIndex(e))}getByIndex(t){return this.map[t]}putAll(t){this.checkImmutability("putAll");for(const e of t.map)this.put(e.key,e.value)}checkImmutability(t){if(this.isImmutable)throw new Error("Cannot call "+t+" on immutable map!")}put(t,e){this.checkImmutability("put");for(const r of this.map)if(Fa(r.key,t)){const s=r.value;return r.value=e,P.of(s)}return this.map.push({key:t,value:e}),P.empty()}containsKey(t){return this.map.some(e=>Fa(e.key,t))}size(){return this.map.length}listKeys(){return this.map.map(t=>t.key)}getKeySet(){return new Ht(this.listKeys())}filter(t){const e=new zn;for(const r of this.map)t(r.key,r.value)&&e.set(r.key,r.value);return e}replace(t,e){if(this.checkImmutability("replace"),this.get(t).isAbsent())throw new Error("No Value to replace for key "+t.toString()+"!");return this.put(t,e),e}set(t,e){if(this.checkImmutability("set"),this.containsKey(t))throw new Error("Key "+t.toString()+" already exist in Map!");this.map.push({key:t,value:e})}delete(t){this.checkImmutability("delete");for(let e=0;e<this.map.length;e++)if(Fa(this.map[e].key,t)){const s=this.map[e].value,i=this.map.slice(0,e),o=this.map.slice(e+1);return this.map=i.concat(o),s}throw new Error('No Value to delete for key "'+t.toString()+'"!')}getCopy(){const t=new this.constructor;for(const e of this.listKeys())t.set(e,this.get(e).get());return t}equals(t){const e=this.getKeySet(),r=t.getKeySet();if(!1===e.equals(r))return!1;for(const s of e){const i=this.get(s).get(),o=t.get(s);if(ye(o.isPresent(),"value is absent in a map even though its key is present!"),!1===Fa(i,o.get()))return!1}return!0}}class o9 extends zn{reverse(){const t=new o9;for(const e of this.listKeys()){const r=this.get(e).get();if(t.containsKey(r))t.get(r).get().add(e);else{const s=new Ht;s.add(e),t.set(r,s)}}return t}}class Ke{static mapBiArray(t,e){const r=[];let s=0;for(;s<t.length;){r[s]=[];let i=0;for(;i<t[s].length;)r[s][i]=e(t[s][i]),i++;s++}return r}static create3DTable(t,e,r,s){const i=[];for(let o=0;o<t;o++)i.push(Ke.createTable(e,r,s));return i}static createTable(t,e,r){const s=[];for(let i=0;i<e;i++)s.push(Ke.createArray(t,r));return s}static createArray(t,e){const r=[];for(let s=0;s<t;s++)r.push(e);return r}static copyBiArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=Ke.copyImmutableArray(t[r]),r++;return e}static copyImmutableArray(t){const e=[];let r=0;for(;r<t.length;)e[r]=t[r],r++;return e}static sortByDescending(t,e){t.sort((r,s)=>{const i=e(r),o=e(s);return i<o?1:i>o?-1:0})}static compareArray(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Fa(t[r],e[r]))return!1;return!0}static compareTable(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!1===Ke.compareArray(t[r],e[r]))return!1;return!0}static isPrefix(t,e){return!(t.length>e.length)&&Ke.compareArray(t,e.slice(0,t.length))}static range(t){const e=[];for(let r=0;r<t;r++)e.push(r);return e}static smallerFirst(t,e){return t-e}}class Cte{constructor(){this.content=new zn}get(t){const e=this.content.get(t.y);return e.isAbsent()?P.empty():e.get().get(t.x)}set(t,e){const r=this.content.get(t.y);let s;r.isPresent()?s=r.get():(s=new zn,this.content.set(t.y,s)),s.set(t.x,e)}[Symbol.iterator](){const t=[],e=this.content.getKeySet().toList();e.sort(Ke.smallerFirst);for(const r of e){const s=this.content.get(r).get(),i=s.getKeySet().toList();i.sort(Ke.smallerFirst);for(const o of i){const c=s.get(o).get();t.push({x:o,y:r,content:c})}}return t.values()}}let yte=(()=>{class n extends lm{constructor(e){super("parts",e),K(n.VERBOSE,"PartDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Re(B0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class MS{constructor(t,e,r){this.onDocumentCreated=t,this.onDocumentModified=e,this.onDocumentDeleted=r}}let Mbe=(()=>{class n extends lm{constructor(e){super("config-room",e),K(n.VERBOSE,"ConfigRoomDAO.constructor")}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Re(B0))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Fz=(()=>{class n{constructor(e,r){this.configRoomDAO=e,this.connectedUserService=r,K(n.VERBOSE,"ConfigRoomService.constructor")}addCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").set(r.id,r)}removeCandidate(e,r){return this.configRoomDAO.subCollectionDAO(e,"candidates").delete(r.id)}subscribeToChanges(e,r){return this.configRoomDAO.subscribeToChanges(e,r)}subscribeToCandidates(e,r){let s=[];const i=new MS(c=>{for(const u of c)s.push(u.data);r(s)},c=>{for(const u of c)s=s.map(h=>h.id===u.data.id?u.data:h);r(s)},c=>{for(const u of c)s=s.filter(h=>h.id!==u.data.id);r(s)});return this.configRoomDAO.subCollectionDAO(e,"candidates").observingWhere([],i)}createInitialConfigRoom(e){var r=this;return A(function*(){K(n.VERBOSE,"ConfigRoomService.createInitialConfigRoom("+e+")");const s=r.connectedUserService.user.get().toMinimalUser();return r.configRoomDAO.set(e,{chosenOpponent:null,firstPlayer:js.RANDOM.value,partType:br.STANDARD.value,partStatus:Zs.PART_CREATED.value,maximalMoveDuration:br.NORMAL_MOVE_DURATION,totalPartDuration:br.NORMAL_PART_DURATION,creator:s})})()}joinGame(e){var r=this;return A(function*(){K(n.VERBOSE,"ConfigRoomService.joinGame("+e+")");const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);return i.isAbsent()?U.failure(n.GAME_DOES_NOT_EXIST()):(i.get().creator.id!==s.id&&(yield r.addCandidate(e,s)),U.SUCCESS)})()}cancelJoining(e){var r=this;return A(function*(){K(n.VERBOSE,`ConfigRoomService.cancelJoining(${e})`);const s=r.connectedUserService.user.get().toMinimalUser(),i=yield r.configRoomDAO.read(e);if(!i.isAbsent()){const o=i.get(),c=[r.removeCandidate(e,s)];o.chosenOpponent?.id===s.id&&c.push(r.configRoomDAO.update(e,{chosenOpponent:null,partStatus:Zs.PART_CREATED.value})),yield Promise.all(c)}})()}deleteConfigRoom(e,r){var s=this;return A(function*(){K(n.VERBOSE,`ConfigRoomService.deleteConfigRoom(${e}`),yield Promise.all(r.map(i=>s.removeCandidate(e,i))),yield s.configRoomDAO.delete(e)})()}proposeConfig(e,r,s,i,o,c){var u=this;return A(function*(){return K(n.VERBOSE,{configRoomService_proposeConfig:{configRoomId:e,maximalMoveDuration:i,firstPlayer:o,totalPartDuration:c}}),u.configRoomDAO.update(e,{partStatus:Zs.CONFIG_PROPOSED.value,chosenOpponent:r,partType:s.value,maximalMoveDuration:i,totalPartDuration:c,firstPlayer:o.value})})()}setChosenOpponent(e,r){return K(n.VERBOSE,`ConfigRoomService.setChosenOpponent(${e}, ${r.name})`),this.configRoomDAO.update(e,{chosenOpponent:r})}reviewConfig(e){var r=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.reviewConfig(${e})`),r.configRoomDAO.update(e,{partStatus:Zs.PART_CREATED.value})})()}reviewConfigAndRemoveChosenOpponent(e){var r=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.reviewConfigAndRemoveChosenOpponent(${e})`),r.configRoomDAO.update(e,{partStatus:Zs.PART_CREATED.value,chosenOpponent:null})})()}acceptConfig(e){return K(n.VERBOSE,`ConfigRoomService.acceptConfig(${e}`),this.configRoomDAO.update(e,{partStatus:Zs.PART_STARTED.value})}createConfigRoom(e,r){var s=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.create(${e}`+JSON.stringify(r)+")"),s.configRoomDAO.set(e,r)})()}readConfigRoomById(e){var r=this;return A(function*(){return K(n.VERBOSE,`ConfigRoomService.readConfigRoomById(${e})`),(yield r.configRoomDAO.read(e)).get()})()}}return n.VERBOSE=!1,n.GAME_DOES_NOT_EXIST=()=>$localize`Game does not exist`,n.\u0275fac=function(e){return new(e||n)(Re(Mbe),Re(Os))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),SS=(()=>{class n{constructor(e,r,s,i){this.partDAO=e,this.connectedUserService=r,this.configRoomService=s,this.chatService=i,K(n.VERBOSE,"GameService.constructor")}updateAndBumpIndex(e,r,s,i){var o=this;return A(function*(){return i={...i,lastUpdate:{index:s+1,player:r.value}},o.partDAO.update(e,i)})()}getPartValidity(e,r){var s=this;return A(function*(){const i=yield s.partDAO.read(e);return i.isAbsent()?U.failure("NONEXISTENT_PART"):i.get().typeGame===r?U.SUCCESS:U.failure("WRONG_GAME_TYPE")})()}createUnstartedPart(e){K(n.VERBOSE,"GameService.createPart("+e+")");const r=this.connectedUserService.user.get().toMinimalUser();return this.partDAO.create({lastUpdate:{index:0,player:0},typeGame:e,playerZero:r,turn:-1,result:Rn.UNACHIEVED.value,listMoves:[]})}createChat(e){return K(n.VERBOSE,"GameService.createChat("+e+")"),this.chatService.createNewChat(e)}createPartConfigRoomAndChat(e){var r=this;return A(function*(){K(n.VERBOSE,`GameService.createGame(${e})`);const s=yield r.createUnstartedPart(e);return yield r.configRoomService.createInitialConfigRoom(s),yield r.createChat(s),s})()}startGameWithConfig(e,r,s,i){K(n.VERBOSE,"GameService.startGameWithConfig("+e+", "+JSON.stringify(i));const o=this.getStartingConfig(i);return this.updateAndBumpIndex(e,r,s,o)}getStartingConfig(e){let s,i,r=js.of(e.firstPlayer);return r===js.RANDOM&&(r=Math.random()<.5?js.CREATOR:js.CHOSEN_PLAYER),r===js.CREATOR?(s=e.creator,i=we.getNonNullable(e.chosenOpponent)):(s=we.getNonNullable(e.chosenOpponent),i=e.creator),{playerZero:s,playerOne:i,turn:0,beginning:V0(),remainingMsForZero:1e3*e.totalPartDuration,remainingMsForOne:1e3*e.totalPartDuration}}deletePart(e){return K(n.VERBOSE,"GameService.deletePart("+e+")"),this.partDAO.delete(e)}acceptConfig(e,r){var s=this;return A(function*(){return K(n.VERBOSE,{gameService_acceptConfig:{partId:e,configRoom:r}}),yield s.configRoomService.acceptConfig(e),s.startGameWithConfig(e,z.ONE,0,r)})()}subscribeToChanges(e,r){return this.partDAO.subscribeToChanges(e,r)}resign(e,r,s,i,o){return this.updateAndBumpIndex(e,s,r,{winner:i,loser:o,result:Rn.RESIGN.value,request:null})}notifyTimeout(e,r,s,i,o){return this.updateAndBumpIndex(e,r,s,{winner:i,loser:o,result:Rn.TIMEOUT.value,request:null})}sendRequest(e,r,s,i){return this.updateAndBumpIndex(e,r,s,{request:i})}proposeDraw(e,r,s){return this.sendRequest(e,s,r,Br.drawProposed(s))}acceptDraw(e,r,s){return this.updateAndBumpIndex(e,s,r,{result:(s===z.ZERO?Rn.AGREED_DRAW_BY_ZERO:Rn.AGREED_DRAW_BY_ONE).value,request:null})}refuseDraw(e,r,s){return this.sendRequest(e,s,r,Br.drawRefused(s))}proposeRematch(e,r,s){return this.sendRequest(e,s,r,Br.rematchProposed(s))}acceptRematch(e,r,s){var i=this;return A(function*(){K(n.VERBOSE,{called:"GameService.acceptRematch(",partDocument:e});const o=we.getNonNullable(e.data),c=yield i.configRoomService.readConfigRoomById(e.id);let u;const h=i.connectedUserService.user.get().toMinimalUser();let p;o.playerZero.id===h.id?(p=we.getNonNullable(o.playerOne),u=js.CHOSEN_PLAYER):(p=o.playerZero,u=js.CREATOR);const m={...c,firstPlayer:u.value,creator:h,chosenOpponent:p,partStatus:Zs.PART_STARTED.value},C=i.getStartingConfig(m),w={lastUpdate:{index:0,player:s.value},typeGame:o.typeGame,result:Rn.UNACHIEVED.value,listMoves:[],...C},I=yield i.partDAO.create(w);return yield i.configRoomService.createConfigRoom(I,m),yield i.createChat(I),i.sendRequest(e.id,s,r,Br.rematchAccepted(o.typeGame,I))})()}askTakeBack(e,r,s){return this.sendRequest(e,s,r,Br.takeBackAsked(s))}acceptTakeBack(e,r,s,i){var o=this;return A(function*(){ye(Br.getPlayer(we.getNonNullable(r.data.request))!==s,"Illegal to accept your own request");const u=Br.takeBackAccepted(s);let h=r.data.listMoves.slice(0,r.data.listMoves.length-1);h.length%2===s.value&&(h=h.slice(0,h.length-1));const p={request:u,listMoves:h,turn:h.length,lastUpdateTime:V0(),remainingMsForZero:we.getNonNullable(r.data.remainingMsForZero)-i[0],remainingMsForOne:we.getNonNullable(r.data.remainingMsForOne)-i[1]},m=r.data.lastUpdate.index;return yield o.updateAndBumpIndex(e,s,m,p)})()}refuseTakeBack(e,r,s){const i=Br.takeBackRefused(s);return this.updateAndBumpIndex(e,s,r,{request:i})}addGlobalTime(e,r,s,i){var o=this;return A(function*(){let c={request:Br.addGlobalTime(i.getOpponent())};return c=i===z.ZERO?{...c,remainingMsForOne:we.getNonNullable(s.remainingMsForOne)+3e5}:{...c,remainingMsForZero:we.getNonNullable(s.remainingMsForZero)+3e5},yield o.updateAndBumpIndex(e,i,r,c)})()}addTurnTime(e,r,s){var i=this;return A(function*(){const o={request:Br.addTurnTime(e.getOpponent())};return yield i.updateAndBumpIndex(s,e,r,o)})()}updateDBBoard(e,r,s,i,o,c,u,h){var p=this;return A(function*(){K(n.VERBOSE,{gameService_updateDBBoard:{partId:e,encodedMove:s,scores:o,msToSubstract:i,notifyDraw:c,winner:u,loser:h}});const m=(yield p.partDAO.read(e)).get(),C=m.lastUpdate.index,w=m.turn+1,I=Ke.copyImmutableArray(m.listMoves);I[I.length]=s;let H={listMoves:I,turn:w,request:null,lastUpdateTime:V0()};return H=p.updateScore(H,o),H=p.substractMs(H,m,i),null!=u?H={...H,winner:u,loser:h,result:Rn.VICTORY.value}:!0===c&&(H={...H,result:Rn.HARD_DRAW.value}),yield p.updateAndBumpIndex(e,r,C,H)})()}updateScore(e,r){return void 0!==r?{...e,scorePlayerZero:r[0],scorePlayerOne:r[1]}:e}substractMs(e,r,s){return s[0]>0?{...e,remainingMsForZero:we.getNonNullable(r.remainingMsForZero)-s[0]}:s[1]>0?{...e,remainingMsForOne:we.getNonNullable(r.remainingMsForOne)-s[1]}:e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Re(yte),Re(Os),Re(Fz),Re(CS))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Gte={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},Kte={prefix:"fab",iconName:"github",icon:[496,512,[],"f09b","M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"]},Xte={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"]};class hm{static getNavigatorLanguage(){return navigator.language}static getLocale(){const r=(localStorage.getItem("locale")??hm.getNavigatorLanguage()??"fr").slice(0,2).toLowerCase();return["en","fr"].some(s=>s===r)?r:"fr"}}let nne=(()=>{class n{changeTheme(e){localStorage.setItem("theme",e)}getTheme(){return P.ofNullable(localStorage.getItem("theme"))}changeLanguage(e){localStorage.setItem("locale",e.toLowerCase())}getLanguage(){return hm.getLocale()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),PS=(()=>{class n{constructor(e,r){this.document=e,this.userSettingsService=r,this.availableThemes=["dark","light"];const s=this.getStoredTheme();s.isPresent()?this.loadTheme(s.get()):window.matchMedia("(prefers-color-scheme: dark)").matches?this.loadTheme("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?this.loadTheme("light"):this.loadTheme("dark")}getStoredTheme(){const e=this.userSettingsService.getTheme();if(e.isPresent()){const r=e.get();if(this.availableThemes.some(s=>s===r))return P.of(r)}return P.empty()}loadTheme(e){this.loadStyle(e+".css"),this.theme=e}loadStyle(e){const r=this.document.getElementsByTagName("head")[0],s=this.document.getElementById("theme");if(null!=s)s.href=e;else{const i=this.document.createElement("link");i.id="theme",i.rel="stylesheet",i.href=`${e}`,r.appendChild(i)}}getTheme(){return this.theme}}return n.\u0275fac=function(e){return new(e||n)(Re(Bs),Re(nne))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function rne(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),e.push.apply(e,r)}return e}function Mt(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?rne(Object(e),!0).forEach(function(r){_i(n,r,e[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):rne(Object(e)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(e,r))})}return n}function TS(n){return(TS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function sne(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}function _i(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function $z(n,t){return function sDe(n){if(Array.isArray(n))return n}(n)||function oDe(n,t){var e=null==n?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(null!=e){var o,c,r=[],s=!0,i=!1;try{for(e=e.call(n);!(s=(o=e.next()).done)&&(r.push(o.value),!t||r.length!==t);s=!0);}catch(u){i=!0,c=u}finally{try{!s&&null!=e.return&&e.return()}finally{if(i)throw c}}return r}}(n,t)||ine(n,t)||function cDe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pm(n){return function rDe(n){if(Array.isArray(n))return Uz(n)}(n)||function iDe(n){if(typeof Symbol<"u"&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||ine(n)||function aDe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ine(n,t){if(n){if("string"==typeof n)return Uz(n,t);var e=Object.prototype.toString.call(n).slice(8,-1);if("Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e)return Array.from(n);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Uz(n,t)}}function Uz(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=n[e];return r}var one=function(){},Gz={},ane={},cne=null,lne={mark:one,measure:one};try{typeof window<"u"&&(Gz=window),typeof document<"u"&&(ane=document),typeof MutationObserver<"u"&&(cne=MutationObserver),typeof performance<"u"&&(lne=performance)}catch{}var OS,NS,AS,IS,xS,une=(Gz.navigator||{}).userAgent,fne=void 0===une?"":une,G0=Gz,Or=ane,hne=cne,bS=lne,Ql=!!Or.documentElement&&!!Or.head&&"function"==typeof Or.addEventListener&&"function"==typeof Or.createElement,dne=~fne.indexOf("MSIE")||~fne.indexOf("Trident/"),Jl="___FONT_AWESOME___",gne="svg-inline--fa",h5="data-fa-i2svg",qz="data-fa-pseudo-element",jz="data-prefix",Zz="data-icon",mne="fontawesome-i2svg",hDe=["HTML","HEAD","STYLE","SCRIPT"],_ne=function(){try{return!0}catch{return!1}}(),Nr="classic",ds="sharp",Yz=[Nr,ds];function gm(n){return new Proxy(n,{get:function(e,r){return r in e?e[r]:e[Nr]}})}var mm=gm((_i(OS={},Nr,{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit"}),_i(OS,ds,{fa:"solid",fass:"solid","fa-solid":"solid"}),OS)),_m=gm((_i(NS={},Nr,{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"}),_i(NS,ds,{solid:"fass"}),NS)),vm=gm((_i(AS={},Nr,{fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"}),_i(AS,ds,{fass:"fa-solid"}),AS)),dDe=gm((_i(IS={},Nr,{"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"}),_i(IS,ds,{"fa-solid":"fass"}),IS)),pDe=/fa(s|r|l|t|d|b|k|ss)?[\-\ ]/,vne="fa-layers-text",gDe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp|Kit)?.*/i,mDe=gm((_i(xS={},Nr,{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"}),_i(xS,ds,{900:"fass"}),xS)),Cne=[1,2,3,4,5,6,7,8,9,10],_De=Cne.concat([11,12,13,14,15,16,17,18,19,20]),vDe=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Cm=new Set;Object.keys(_m[Nr]).map(Cm.add.bind(Cm)),Object.keys(_m[ds]).map(Cm.add.bind(Cm));var CDe=[].concat(Yz,pm(Cm),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul","duotone-group","swap-opacity","primary","secondary"]).concat(Cne.map(function(n){return"".concat(n,"x")})).concat(_De.map(function(n){return"w-".concat(n)})),ym=G0.FontAwesomeConfig||{};Or&&"function"==typeof Or.querySelector&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(function(n){var t=$z(n,2),r=t[1],s=function EDe(n){return""===n||"false"!==n&&("true"===n||n)}(function yDe(n){var t=Or.querySelector("script["+n+"]");if(t)return t.getAttribute(n)}(t[0]));null!=s&&(ym[r]=s)});var yne={styleDefault:"solid",familyDefault:"classic",cssPrefix:"fa",replacementClass:gne,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};ym.familyPrefix&&(ym.cssPrefix=ym.familyPrefix);var a9=Mt(Mt({},yne),ym);a9.autoReplaceSvg||(a9.observeMutations=!1);var Nt={};Object.keys(yne).forEach(function(n){Object.defineProperty(Nt,n,{enumerable:!0,set:function(e){a9[n]=e,Em.forEach(function(r){return r(Nt)})},get:function(){return a9[n]}})}),Object.defineProperty(Nt,"familyPrefix",{enumerable:!0,set:function(t){a9.cssPrefix=t,Em.forEach(function(e){return e(Nt)})},get:function(){return a9.cssPrefix}}),G0.FontAwesomeConfig=Nt;var Em=[],O4={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function Mm(){for(var n=12,t="";n-- >0;)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return t}function c9(n){for(var t=[],e=(n||[]).length>>>0;e--;)t[e]=n[e];return t}function Kz(n){return n.classList?c9(n.classList):(n.getAttribute("class")||"").split(" ").filter(function(t){return t})}function Ene(n){return"".concat(n).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function kS(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,": ").concat(n[e].trim(),";")},"")}function Xz(n){return n.size!==O4.size||n.x!==O4.x||n.y!==O4.y||n.rotate!==O4.rotate||n.flipX||n.flipY}function Mne(){var n="fa",t=gne,e=Nt.cssPrefix,r=Nt.replacementClass,s=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-counter-scale, 0.25));\n          transform: scale(var(--fa-counter-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  -webkit-transform: scale(var(--fa-layers-scale, 0.25));\n          transform: scale(var(--fa-layers-scale, 0.25));\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(var(--fa-li-width, 2em) * -1);\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  -webkit-animation-name: fa-beat;\n          animation-name: fa-beat;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  -webkit-animation-name: fa-bounce;\n          animation-name: fa-bounce;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  -webkit-animation-name: fa-fade;\n          animation-name: fa-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  -webkit-animation-name: fa-beat-fade;\n          animation-name: fa-beat-fade;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  -webkit-animation-name: fa-flip;\n          animation-name: fa-flip;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);\n          animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  -webkit-animation-name: fa-shake;\n          animation-name: fa-shake;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-delay: var(--fa-animation-delay, 0s);\n          animation-delay: var(--fa-animation-delay, 0s);\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 2s);\n          animation-duration: var(--fa-animation-duration, 2s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, linear);\n          animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  -webkit-animation-name: fa-spin;\n          animation-name: fa-spin;\n  -webkit-animation-direction: var(--fa-animation-direction, normal);\n          animation-direction: var(--fa-animation-direction, normal);\n  -webkit-animation-duration: var(--fa-animation-duration, 1s);\n          animation-duration: var(--fa-animation-duration, 1s);\n  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n          animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));\n          animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    -webkit-animation-delay: -1ms;\n            animation-delay: -1ms;\n    -webkit-animation-duration: 1ms;\n            animation-duration: 1ms;\n    -webkit-animation-iteration-count: 1;\n            animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@-webkit-keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  45% {\n    -webkit-transform: scale(var(--fa-beat-scale, 1.25));\n            transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@-webkit-keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    -webkit-transform: scale(1, 1) translateY(0);\n            transform: scale(1, 1) translateY(0);\n  }\n}\n@-webkit-keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@-webkit-keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    -webkit-transform: scale(1);\n            transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));\n            transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@-webkit-keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@-webkit-keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@keyframes fa-shake {\n  0% {\n    -webkit-transform: rotate(-15deg);\n            transform: rotate(-15deg);\n  }\n  4% {\n    -webkit-transform: rotate(15deg);\n            transform: rotate(15deg);\n  }\n  8%, 24% {\n    -webkit-transform: rotate(-18deg);\n            transform: rotate(-18deg);\n  }\n  12%, 28% {\n    -webkit-transform: rotate(18deg);\n            transform: rotate(18deg);\n  }\n  16% {\n    -webkit-transform: rotate(-22deg);\n            transform: rotate(-22deg);\n  }\n  20% {\n    -webkit-transform: rotate(22deg);\n            transform: rotate(22deg);\n  }\n  32% {\n    -webkit-transform: rotate(-12deg);\n            transform: rotate(-12deg);\n  }\n  36% {\n    -webkit-transform: rotate(12deg);\n            transform: rotate(12deg);\n  }\n  40%, 100% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n}\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  -webkit-transform: rotate(var(--fa-rotate-angle, none));\n          transform: rotate(var(--fa-rotate-angle, none));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';if(e!==n||r!==t){var i=new RegExp("\\.".concat(n,"\\-"),"g"),o=new RegExp("\\--".concat(n,"\\-"),"g"),c=new RegExp("\\.".concat(t),"g");s=s.replace(i,".".concat(e,"-")).replace(o,"--".concat(e,"-")).replace(c,".".concat(r))}return s}var Sne=!1;function Qz(){Nt.autoAddCss&&!Sne&&(function PDe(n){if(n&&Ql){var t=Or.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n;for(var e=Or.head.childNodes,r=null,s=e.length-1;s>-1;s--){var i=e[s],o=(i.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=i)}Or.head.insertBefore(t,r)}}(Mne()),Sne=!0)}var ADe={mixout:function(){return{dom:{css:Mne,insertCss:Qz}}},hooks:function(){return{beforeDOMElementCreation:function(){Qz()},beforeI2svg:function(){Qz()}}}},e6=G0||{};e6[Jl]||(e6[Jl]={}),e6[Jl].styles||(e6[Jl].styles={}),e6[Jl].hooks||(e6[Jl].hooks={}),e6[Jl].shims||(e6[Jl].shims=[]);var M3=e6[Jl],Pne=[],LS=!1;function xDe(n){!Ql||(LS?setTimeout(n,0):Pne.push(n))}function Sm(n){var t=n.tag,e=n.attributes,r=void 0===e?{}:e,s=n.children,i=void 0===s?[]:s;return"string"==typeof n?Ene(n):"<".concat(t," ").concat(function wDe(n){return Object.keys(n||{}).reduce(function(t,e){return t+"".concat(e,'="').concat(Ene(n[e]),'" ')},"").trim()}(r),">").concat(i.map(Sm).join(""),"</").concat(t,">")}function Tne(n,t,e){if(n&&n[t]&&n[t][e])return{prefix:t,iconName:e,icon:n[t][e]}}Ql&&((LS=(Or.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Or.readyState))||Or.addEventListener("DOMContentLoaded",function n(){Or.removeEventListener("DOMContentLoaded",n),LS=1,Pne.map(function(t){return t()})}));var Jz=function(t,e,r,s){var u,h,p,i=Object.keys(t),o=i.length,c=void 0!==s?function(t,e){return function(r,s,i,o){return t.call(e,r,s,i,o)}}(e,s):e;for(void 0===r?(u=1,p=t[i[0]]):(u=0,p=r);u<o;u++)p=c(p,t[h=i[u]],h,t);return p};function eV(n){var t=function LDe(n){for(var t=[],e=0,r=n.length;e<r;){var s=n.charCodeAt(e++);if(s>=55296&&s<=56319&&e<r){var i=n.charCodeAt(e++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),e--)}else t.push(s)}return t}(n);return 1===t.length?t[0].toString(16):null}function wne(n){return Object.keys(n).reduce(function(t,e){var r=n[e];return r.icon?t[r.iconName]=r.icon:t[e]=r,t},{})}function tV(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.skipHooks,s=void 0!==r&&r,i=wne(t);"function"!=typeof M3.hooks.addPack||s?M3.styles[n]=Mt(Mt({},M3.styles[n]||{}),i):M3.hooks.addPack(n,wne(t)),"fas"===n&&tV("fa",t)}var RS,DS,zS,l9=M3.styles,DDe=M3.shims,zDe=(_i(RS={},Nr,Object.values(vm[Nr])),_i(RS,ds,Object.values(vm[ds])),RS),nV=null,bne={},One={},Nne={},Ane={},Ine={},VDe=(_i(DS={},Nr,Object.keys(mm[Nr])),_i(DS,ds,Object.keys(mm[ds])),DS);function FDe(n,t){var e=t.split("-"),r=e[0],s=e.slice(1).join("-");return r!==n||""===s||function HDe(n){return~CDe.indexOf(n)}(s)?null:s}var xne=function(){var t=function(i){return Jz(l9,function(o,c,u){return o[u]=Jz(c,i,{}),o},{})};bne=t(function(s,i,o){return i[3]&&(s[i[3]]=o),i[2]&&i[2].filter(function(u){return"number"==typeof u}).forEach(function(u){s[u.toString(16)]=o}),s}),One=t(function(s,i,o){return s[o]=o,i[2]&&i[2].filter(function(u){return"string"==typeof u}).forEach(function(u){s[u]=o}),s}),Ine=t(function(s,i,o){var c=i[2];return s[o]=o,c.forEach(function(u){s[u]=o}),s});var e="far"in l9||Nt.autoFetchSvg,r=Jz(DDe,function(s,i){var o=i[0],c=i[1],u=i[2];return"far"===c&&!e&&(c="fas"),"string"==typeof o&&(s.names[o]={prefix:c,iconName:u}),"number"==typeof o&&(s.unicodes[o.toString(16)]={prefix:c,iconName:u}),s},{names:{},unicodes:{}});Nne=r.names,Ane=r.unicodes,nV=VS(Nt.styleDefault,{family:Nt.familyDefault})};function rV(n,t){return(bne[n]||{})[t]}function p5(n,t){return(Ine[n]||{})[t]}function kne(n){return Nne[n]||{prefix:null,iconName:null}}function q0(){return nV}function VS(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.family,r=void 0===e?Nr:e,s=mm[r][n],i=_m[r][n]||_m[r][s],o=n in M3.styles?n:null;return i||o||null}(function SDe(n){Em.push(n)})(function(n){nV=VS(n.styleDefault,{family:Nt.familyDefault})}),xne();var Lne=(_i(zS={},Nr,Object.keys(vm[Nr])),_i(zS,ds,Object.keys(vm[ds])),zS);function HS(n){var t,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.skipLookups,s=void 0!==r&&r,i=(_i(t={},Nr,"".concat(Nt.cssPrefix,"-").concat(Nr)),_i(t,ds,"".concat(Nt.cssPrefix,"-").concat(ds)),t),o=null,c=Nr;(n.includes(i[Nr])||n.some(function(h){return Lne[Nr].includes(h)}))&&(c=Nr),(n.includes(i[ds])||n.some(function(h){return Lne[ds].includes(h)}))&&(c=ds);var u=n.reduce(function(h,p){var m=FDe(Nt.cssPrefix,p);if(l9[p]?(p=zDe[c].includes(p)?dDe[c][p]:p,o=p,h.prefix=p):VDe[c].indexOf(p)>-1?(o=p,h.prefix=VS(p,{family:c})):m?h.iconName=m:p!==Nt.replacementClass&&p!==i[Nr]&&p!==i[ds]&&h.rest.push(p),!s&&h.prefix&&h.iconName){var C="fa"===o?kne(h.iconName):{},w=p5(h.prefix,h.iconName);C.prefix&&(o=null),h.iconName=C.iconName||w||h.iconName,h.prefix=C.prefix||h.prefix,"far"===h.prefix&&!l9.far&&l9.fas&&!Nt.autoFetchSvg&&(h.prefix="fas")}return h},{prefix:null,iconName:null,rest:[]});return(n.includes("fa-brands")||n.includes("fab"))&&(u.prefix="fab"),(n.includes("fa-duotone")||n.includes("fad"))&&(u.prefix="fad"),!u.prefix&&c===ds&&(l9.fass||Nt.autoFetchSvg)&&(u.prefix="fass",u.iconName=p5(u.prefix,u.iconName)||u.iconName),("fa"===u.prefix||"fa"===o)&&(u.prefix=q0()||"fas"),u}var UDe=function(){function n(){(function eDe(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),this.definitions={}}return function tDe(n,t,e){t&&sne(n.prototype,t),e&&sne(n,e),Object.defineProperty(n,"prototype",{writable:!1})}(n,[{key:"add",value:function(){for(var e=this,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.reduce(this._pullDefinitions,{});Object.keys(o).forEach(function(c){e.definitions[c]=Mt(Mt({},e.definitions[c]||{}),o[c]),tV(c,o[c]);var u=vm[Nr][c];u&&tV(u,o[c]),xne()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(e,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(i){var o=s[i],c=o.prefix,u=o.iconName,h=o.icon,p=h[2];e[c]||(e[c]={}),p.length>0&&p.forEach(function(m){"string"==typeof m&&(e[c][m]=h)}),e[c][u]=h}),e}}]),n}(),Rne=[],u9={},f9={},GDe=Object.keys(f9);function iV(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),s=2;s<e;s++)r[s-2]=arguments[s];var i=u9[n]||[];return i.forEach(function(o){t=o.apply(null,[t].concat(r))}),t}function g5(n){for(var t=arguments.length,e=new Array(t>1?t-1:0),r=1;r<t;r++)e[r-1]=arguments[r];var s=u9[n]||[];s.forEach(function(i){i.apply(null,e)})}function t6(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);return f9[n]?f9[n].apply(null,t):void 0}function oV(n){"fa"===n.prefix&&(n.prefix="fas");var t=n.iconName,e=n.prefix||q0();if(t)return t=p5(e,t)||t,Tne(Dne.definitions,e,t)||Tne(M3.styles,e,t)}var Dne=new UDe,jDe={i2svg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ql?(g5("beforeI2svg",t),t6("pseudoElements2svg",t),t6("i2svg",t)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot;!1===Nt.autoReplaceSvg&&(Nt.autoReplaceSvg=!0),Nt.observeMutations=!0,xDe(function(){YDe({autoReplaceSvgRoot:e}),g5("watch",t)})}},Ua={noAuto:function(){Nt.autoReplaceSvg=!1,Nt.observeMutations=!1,g5("noAuto")},config:Nt,dom:jDe,parse:{icon:function(t){if(null===t)return null;if("object"===TS(t)&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:p5(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&2===t.length){var e=0===t[1].indexOf("fa-")?t[1].slice(3):t[1],r=VS(t[0]);return{prefix:r,iconName:p5(r,e)||e}}if("string"==typeof t&&(t.indexOf("".concat(Nt.cssPrefix,"-"))>-1||t.match(pDe))){var s=HS(t.split(" "),{skipLookups:!0});return{prefix:s.prefix||q0(),iconName:p5(s.prefix,s.iconName)||s.iconName}}if("string"==typeof t){var i=q0();return{prefix:i,iconName:p5(i,t)||t}}}},library:Dne,findIconDefinition:oV,toHtml:Sm},YDe=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.autoReplaceSvgRoot,r=void 0===e?Or:e;(Object.keys(M3.styles).length>0||Nt.autoFetchSvg)&&Ql&&Nt.autoReplaceSvg&&Ua.dom.i2svg({node:r})};function FS(n,t){return Object.defineProperty(n,"abstract",{get:t}),Object.defineProperty(n,"html",{get:function(){return n.abstract.map(function(r){return Sm(r)})}}),Object.defineProperty(n,"node",{get:function(){if(Ql){var r=Or.createElement("div");return r.innerHTML=n.html,r.children}}}),n}function aV(n){var t=n.icons,e=t.main,r=t.mask,s=n.prefix,i=n.iconName,o=n.transform,c=n.symbol,u=n.title,h=n.maskId,p=n.titleId,m=n.extra,C=n.watchable,w=void 0!==C&&C,I=r.found?r:e,H=I.width,Y=I.height,ee="fak"===s,ve=[Nt.replacementClass,i?"".concat(Nt.cssPrefix,"-").concat(i):""].filter(function(b1){return-1===m.classes.indexOf(b1)}).filter(function(b1){return""!==b1||!!b1}).concat(m.classes).join(" "),te={children:[],attributes:Mt(Mt({},m.attributes),{},{"data-prefix":s,"data-icon":i,class:ve,role:m.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(H," ").concat(Y)})},Ie=ee&&!~m.classes.indexOf("fa-fw")?{width:"".concat(H/Y*16*.0625,"em")}:{};w&&(te.attributes[h5]=""),u&&(te.children.push({tag:"title",attributes:{id:te.attributes["aria-labelledby"]||"title-".concat(p||Mm())},children:[u]}),delete te.attributes.title);var Be=Mt(Mt({},te),{},{prefix:s,iconName:i,main:e,mask:r,maskId:h,transform:o,symbol:c,styles:Mt(Mt({},Ie),m.styles)}),Ye=r.found&&e.found?t6("generateAbstractMask",Be)||{children:[],attributes:{}}:t6("generateAbstractIcon",Be)||{children:[],attributes:{}},R1=Ye.attributes;return Be.children=Ye.children,Be.attributes=R1,c?function XDe(n){var e=n.iconName,r=n.children,s=n.attributes,i=n.symbol,o=!0===i?"".concat(n.prefix,"-").concat(Nt.cssPrefix,"-").concat(e):i;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Mt(Mt({},s),{},{id:o}),children:r}]}]}(Be):function KDe(n){var t=n.children,e=n.main,r=n.mask,s=n.attributes,i=n.styles,o=n.transform;if(Xz(o)&&e.found&&!r.found){var h={x:e.width/e.height/2,y:.5};s.style=kS(Mt(Mt({},i),{},{"transform-origin":"".concat(h.x+o.x/16,"em ").concat(h.y+o.y/16,"em")}))}return[{tag:"svg",attributes:s,children:t}]}(Be)}function zne(n){var t=n.content,e=n.width,r=n.height,s=n.transform,i=n.title,o=n.extra,c=n.watchable,u=void 0!==c&&c,h=Mt(Mt(Mt({},o.attributes),i?{title:i}:{}),{},{class:o.classes.join(" ")});u&&(h[h5]="");var p=Mt({},o.styles);Xz(s)&&(p.transform=function ODe(n){var t=n.transform,e=n.width,s=n.height,i=void 0===s?16:s,o=n.startCentered,c=void 0!==o&&o,u="";return u+=c&&dne?"translate(".concat(t.x/16-(void 0===e?16:e)/2,"em, ").concat(t.y/16-i/2,"em) "):c?"translate(calc(-50% + ".concat(t.x/16,"em), calc(-50% + ").concat(t.y/16,"em)) "):"translate(".concat(t.x/16,"em, ").concat(t.y/16,"em) "),(u+="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "))+"rotate(".concat(t.rotate,"deg) ")}({transform:s,startCentered:!0,width:e,height:r}),p["-webkit-transform"]=p.transform);var m=kS(p);m.length>0&&(h.style=m);var C=[];return C.push({tag:"span",attributes:h,children:[t]}),i&&C.push({tag:"span",attributes:{class:"sr-only"},children:[i]}),C}function QDe(n){var t=n.content,e=n.title,r=n.extra,s=Mt(Mt(Mt({},r.attributes),e?{title:e}:{}),{},{class:r.classes.join(" ")}),i=kS(r.styles);i.length>0&&(s.style=i);var o=[];return o.push({tag:"span",attributes:s,children:[t]}),e&&o.push({tag:"span",attributes:{class:"sr-only"},children:[e]}),o}var cV=M3.styles;function lV(n){var t=n[0],e=n[1],i=$z(n.slice(4),1)[0];return{found:!0,width:t,height:e,icon:Array.isArray(i)?{tag:"g",attributes:{class:"".concat(Nt.cssPrefix,"-").concat("duotone-group")},children:[{tag:"path",attributes:{class:"".concat(Nt.cssPrefix,"-").concat("secondary"),fill:"currentColor",d:i[0]}},{tag:"path",attributes:{class:"".concat(Nt.cssPrefix,"-").concat("primary"),fill:"currentColor",d:i[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:i}}}}var JDe={found:!1,width:512,height:512};function uV(n,t){var e=t;return"fa"===t&&null!==Nt.styleDefault&&(t=q0()),new Promise(function(r,s){if(t6("missingIconAbstract"),"fa"===e){var o=kne(n)||{};n=o.iconName||n,t=o.prefix||t}if(n&&t&&cV[t]&&cV[t][n])return r(lV(cV[t][n]));(function eze(n,t){!_ne&&!Nt.showMissingIcons&&n&&console.error('Icon with name "'.concat(n,'" and prefix "').concat(t,'" is missing.'))})(n,t),r(Mt(Mt({},JDe),{},{icon:Nt.showMissingIcons&&n&&t6("missingIconAbstract")||{}}))})}var Vne=function(){},fV=Nt.measurePerformance&&bS&&bS.mark&&bS.measure?bS:{mark:Vne,measure:Vne},Pm='FA "6.2.1"',hV_begin=function(t){return fV.mark("".concat(Pm," ").concat(t," begins")),function(){return function(t){fV.mark("".concat(Pm," ").concat(t," ends")),fV.measure("".concat(Pm," ").concat(t),"".concat(Pm," ").concat(t," begins"),"".concat(Pm," ").concat(t," ends"))}(t)}},BS=function(){};function Fne(n){return"string"==typeof(n.getAttribute?n.getAttribute(h5):null)}function ize(n){return Or.createElementNS("http://www.w3.org/2000/svg",n)}function oze(n){return Or.createElement(n)}function Bne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=t.ceFn,r=void 0===e?"svg"===n.tag?ize:oze:e;if("string"==typeof n)return Or.createTextNode(n);var s=r(n.tag);Object.keys(n.attributes||[]).forEach(function(o){s.setAttribute(o,n.attributes[o])});var i=n.children||[];return i.forEach(function(o){s.appendChild(Bne(o,{ceFn:r}))}),s}var $S={replace:function(t){var e=t[0];if(e.parentNode)if(t[1].forEach(function(s){e.parentNode.insertBefore(Bne(s),e)}),null===e.getAttribute(h5)&&Nt.keepOriginalSource){var r=Or.createComment(function aze(n){var t=" ".concat(n.outerHTML," ");return"".concat(t,"Font Awesome fontawesome.com ")}(e));e.parentNode.replaceChild(r,e)}else e.remove()},nest:function(t){var e=t[0],r=t[1];if(~Kz(e).indexOf(Nt.replacementClass))return $S.replace(t);var s=new RegExp("".concat(Nt.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){var i=r[0].attributes.class.split(" ").reduce(function(c,u){return u===Nt.replacementClass||u.match(s)?c.toSvg.push(u):c.toNode.push(u),c},{toNode:[],toSvg:[]});r[0].attributes.class=i.toSvg.join(" "),0===i.toNode.length?e.removeAttribute("class"):e.setAttribute("class",i.toNode.join(" "))}var o=r.map(function(c){return Sm(c)}).join("\n");e.setAttribute(h5,""),e.innerHTML=o}};function $ne(n){n()}function Une(n,t){var e="function"==typeof t?t:BS;if(0===n.length)e();else{var r=$ne;"async"===Nt.mutateApproach&&(r=G0.requestAnimationFrame||$ne),r(function(){var s=function sze(){return!0===Nt.autoReplaceSvg?$S.replace:$S[Nt.autoReplaceSvg]||$S.replace}(),i=hV_begin("mutate");n.map(s),i(),e()})}}var dV=!1;function Gne(){dV=!0}function pV(){dV=!1}var US=null;function Wne(n){if(hne&&Nt.observeMutations){var t=n.treeCallback,e=void 0===t?BS:t,r=n.nodeCallback,s=void 0===r?BS:r,i=n.pseudoElementsCallback,o=void 0===i?BS:i,c=n.observeMutationsRoot,u=void 0===c?Or:c;US=new hne(function(h){if(!dV){var p=q0();c9(h).forEach(function(m){if("childList"===m.type&&m.addedNodes.length>0&&!Fne(m.addedNodes[0])&&(Nt.searchPseudoElements&&o(m.target),e(m.target)),"attributes"===m.type&&m.target.parentNode&&Nt.searchPseudoElements&&o(m.target.parentNode),"attributes"===m.type&&Fne(m.target)&&~vDe.indexOf(m.attributeName))if("class"===m.attributeName&&function nze(n){var t=n.getAttribute?n.getAttribute(jz):null,e=n.getAttribute?n.getAttribute(Zz):null;return t&&e}(m.target)){var C=HS(Kz(m.target)),I=C.iconName;m.target.setAttribute(jz,C.prefix||p),I&&m.target.setAttribute(Zz,I)}else(function rze(n){return n&&n.classList&&n.classList.contains&&n.classList.contains(Nt.replacementClass)})(m.target)&&s(m.target)})}}),Ql&&US.observe(u,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function lze(n){var t=n.getAttribute("style"),e=[];return t&&(e=t.split(";").reduce(function(r,s){var i=s.split(":"),o=i[0],c=i.slice(1);return o&&c.length>0&&(r[o]=c.join(":").trim()),r},{})),e}function uze(n){var t=n.getAttribute("data-prefix"),e=n.getAttribute("data-icon"),r=void 0!==n.innerText?n.innerText.trim():"",s=HS(Kz(n));return s.prefix||(s.prefix=q0()),t&&e&&(s.prefix=t,s.iconName=e),s.iconName&&s.prefix||(s.prefix&&r.length>0&&(s.iconName=function BDe(n,t){return(One[n]||{})[t]}(s.prefix,n.innerText)||rV(s.prefix,eV(n.innerText))),!s.iconName&&Nt.autoFetchSvg&&n.firstChild&&n.firstChild.nodeType===Node.TEXT_NODE&&(s.iconName=n.firstChild.data)),s}function fze(n){var t=c9(n.attributes).reduce(function(s,i){return"class"!==s.name&&"style"!==s.name&&(s[i.name]=i.value),s},{}),e=n.getAttribute("title"),r=n.getAttribute("data-fa-title-id");return Nt.autoA11y&&(e?t["aria-labelledby"]="".concat(Nt.replacementClass,"-title-").concat(r||Mm()):(t["aria-hidden"]="true",t.focusable="false")),t}function qne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0},e=uze(n),r=e.iconName,s=e.prefix,i=e.rest,o=fze(n),c=iV("parseNodeAttributes",{},n),u=t.styleParser?lze(n):[];return Mt({iconName:r,title:n.getAttribute("title"),titleId:n.getAttribute("data-fa-title-id"),prefix:s,transform:O4,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:u,attributes:o}},c)}var dze=M3.styles;function jne(n){var t="nest"===Nt.autoReplaceSvg?qne(n,{styleParser:!1}):qne(n);return~t.extra.classes.indexOf(vne)?t6("generateLayersText",n,t):t6("generateSvgReplacementMutation",n,t)}var j0=new Set;function Zne(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Ql)return Promise.resolve();var e=Or.documentElement.classList,r=function(m){return e.add("".concat(mne,"-").concat(m))},s=function(m){return e.remove("".concat(mne,"-").concat(m))},i=Nt.autoFetchSvg?j0:Yz.map(function(p){return"fa-".concat(p)}).concat(Object.keys(dze));i.includes("fa")||i.push("fa");var o=[".".concat(vne,":not([").concat(h5,"])")].concat(i.map(function(p){return".".concat(p,":not([").concat(h5,"])")})).join(", ");if(0===o.length)return Promise.resolve();var c=[];try{c=c9(n.querySelectorAll(o))}catch{}if(!(c.length>0))return Promise.resolve();r("pending"),s("complete");var u=hV_begin("onTree"),h=c.reduce(function(p,m){try{var C=jne(m);C&&p.push(C)}catch(w){_ne||"MissingIcon"===w.name&&console.error(w)}return p},[]);return new Promise(function(p,m){Promise.all(h).then(function(C){Une(C,function(){r("active"),r("complete"),s("pending"),"function"==typeof t&&t(),u(),p()})}).catch(function(C){u(),m(C)})})}function pze(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;jne(n).then(function(e){e&&Une([e],t)})}function gze(n){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(t||{}).icon?t:oV(t||{}),s=e.mask;return s&&(s=(s||{}).icon?s:oV(s||{})),n(r,Mt(Mt({},e),{},{mask:s}))}}Yz.map(function(n){j0.add("fa-".concat(n))}),Object.keys(mm[Nr]).map(j0.add.bind(j0)),Object.keys(mm[ds]).map(j0.add.bind(j0)),j0=pm(j0);var mze=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.transform,s=void 0===r?O4:r,i=e.symbol,o=void 0!==i&&i,c=e.mask,u=void 0===c?null:c,h=e.maskId,p=void 0===h?null:h,m=e.title,C=void 0===m?null:m,w=e.titleId,I=void 0===w?null:w,H=e.classes,Y=void 0===H?[]:H,ee=e.attributes,ve=void 0===ee?{}:ee,te=e.styles,Ie=void 0===te?{}:te;if(t){var Be=t.prefix,Ye=t.iconName,Vt=t.icon;return FS(Mt({type:"icon"},t),function(){return g5("beforeDOMElementCreation",{iconDefinition:t,params:e}),Nt.autoA11y&&(C?ve["aria-labelledby"]="".concat(Nt.replacementClass,"-title-").concat(I||Mm()):(ve["aria-hidden"]="true",ve.focusable="false")),aV({icons:{main:lV(Vt),mask:u?lV(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:Be,iconName:Ye,transform:Mt(Mt({},O4),s),symbol:o,title:C,maskId:p,titleId:I,extra:{attributes:ve,styles:Ie,classes:Y}})})}},_ze={mixout:function(){return{icon:gze(mze)}},hooks:function(){return{mutationObserverCallbacks:function(e){return e.treeCallback=Zne,e.nodeCallback=pze,e}}},provides:function(t){t.i2svg=function(e){var r=e.node,i=e.callback;return Zne(void 0===r?Or:r,void 0===i?function(){}:i)},t.generateSvgReplacementMutation=function(e,r){var s=r.iconName,i=r.title,o=r.titleId,c=r.prefix,u=r.transform,h=r.symbol,p=r.mask,m=r.maskId,C=r.extra;return new Promise(function(w,I){Promise.all([uV(s,c),p.iconName?uV(p.iconName,p.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(H){var Y=$z(H,2);w([e,aV({icons:{main:Y[0],mask:Y[1]},prefix:c,iconName:s,transform:u,symbol:h,maskId:m,title:i,titleId:o,extra:C,watchable:!0})])}).catch(I)})},t.generateAbstractIcon=function(e){var h,r=e.children,s=e.attributes,i=e.main,o=e.transform,u=kS(e.styles);return u.length>0&&(s.style=u),Xz(o)&&(h=t6("generateAbstractTransformGrouping",{main:i,transform:o,containerWidth:i.width,iconWidth:i.width})),r.push(h||i.icon),{children:r,attributes:s}}}},vze={mixout:function(){return{layer:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.classes,i=void 0===s?[]:s;return FS({type:"layer"},function(){g5("beforeDOMElementCreation",{assembler:e,params:r});var o=[];return e(function(c){Array.isArray(c)?c.map(function(u){o=o.concat(u.abstract)}):o=o.concat(c.abstract)}),[{tag:"span",attributes:{class:["".concat(Nt.cssPrefix,"-layers")].concat(pm(i)).join(" ")},children:o}]})}}}},Cze={mixout:function(){return{counter:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.title,i=void 0===s?null:s,o=r.classes,c=void 0===o?[]:o,u=r.attributes,h=void 0===u?{}:u,p=r.styles,m=void 0===p?{}:p;return FS({type:"counter",content:e},function(){return g5("beforeDOMElementCreation",{content:e,params:r}),QDe({content:e.toString(),title:i,extra:{attributes:h,styles:m,classes:["".concat(Nt.cssPrefix,"-layers-counter")].concat(pm(c))}})})}}}},yze={mixout:function(){return{text:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r.transform,i=void 0===s?O4:s,o=r.title,c=void 0===o?null:o,u=r.classes,h=void 0===u?[]:u,p=r.attributes,m=void 0===p?{}:p,C=r.styles,w=void 0===C?{}:C;return FS({type:"text",content:e},function(){return g5("beforeDOMElementCreation",{content:e,params:r}),zne({content:e,transform:Mt(Mt({},O4),i),title:c,extra:{attributes:m,styles:w,classes:["".concat(Nt.cssPrefix,"-layers-text")].concat(pm(h))}})})}}},provides:function(t){t.generateLayersText=function(e,r){var s=r.title,i=r.transform,o=r.extra,c=null,u=null;if(dne){var h=parseInt(getComputedStyle(e).fontSize,10),p=e.getBoundingClientRect();c=p.width/h,u=p.height/h}return Nt.autoA11y&&!s&&(o.attributes["aria-hidden"]="true"),Promise.resolve([e,zne({content:e.innerHTML,width:c,height:u,transform:i,title:s,extra:o,watchable:!0})])}}},Eze=new RegExp('"',"ug"),Yne=[1105920,1112319];function Kne(n,t){var e="".concat("data-fa-pseudo-element-pending").concat(t.replace(":","-"));return new Promise(function(r,s){if(null!==n.getAttribute(e))return r();var o=c9(n.children).filter(function(Vt){return Vt.getAttribute(qz)===t})[0],c=G0.getComputedStyle(n,t),u=c.getPropertyValue("font-family").match(gDe),h=c.getPropertyValue("font-weight"),p=c.getPropertyValue("content");if(o&&!u)return n.removeChild(o),r();if(u&&"none"!==p&&""!==p){var m=c.getPropertyValue("content"),C=~["Sharp"].indexOf(u[2])?ds:Nr,w=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(u[2])?_m[C][u[2].toLowerCase()]:mDe[C][h],I=function Mze(n){var t=n.replace(Eze,""),e=function RDe(n,t){var s,e=n.length,r=n.charCodeAt(t);return r>=55296&&r<=56319&&e>t+1&&(s=n.charCodeAt(t+1))>=56320&&s<=57343?1024*(r-55296)+s-56320+65536:r}(t,0),r=e>=Yne[0]&&e<=Yne[1],s=2===t.length&&t[0]===t[1];return{value:eV(s?t[0]:t),isSecondary:r||s}}(m),H=I.value,Y=I.isSecondary,ee=u[0].startsWith("FontAwesome"),ve=rV(w,H),te=ve;if(ee){var Ie=function $De(n){var t=Ane[n],e=rV("fas",n);return t||(e?{prefix:"fas",iconName:e}:null)||{prefix:null,iconName:null}}(H);Ie.iconName&&Ie.prefix&&(ve=Ie.iconName,w=Ie.prefix)}if(!ve||Y||o&&o.getAttribute(jz)===w&&o.getAttribute(Zz)===te)r();else{n.setAttribute(e,te),o&&n.removeChild(o);var Be=function hze(){return{iconName:null,title:null,titleId:null,prefix:null,transform:O4,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}(),Ye=Be.extra;Ye.attributes[qz]=t,uV(ve,w).then(function(Vt){var R1=aV(Mt(Mt({},Be),{},{icons:{main:Vt,mask:{prefix:null,iconName:null,rest:[]}},prefix:w,iconName:te,extra:Ye,watchable:!0})),b1=Or.createElement("svg");"::before"===t?n.insertBefore(b1,n.firstChild):n.appendChild(b1),b1.outerHTML=R1.map(function(rs){return Sm(rs)}).join("\n"),n.removeAttribute(e),r()}).catch(s)}}else r()})}function Sze(n){return Promise.all([Kne(n,"::before"),Kne(n,"::after")])}function Pze(n){return!(n.parentNode===document.head||~hDe.indexOf(n.tagName.toUpperCase())||n.getAttribute(qz)||n.parentNode&&"svg"===n.parentNode.tagName)}function Xne(n){if(Ql)return new Promise(function(t,e){var r=c9(n.querySelectorAll("*")).filter(Pze).map(Sze),s=hV_begin("searchPseudoElements");Gne(),Promise.all(r).then(function(){s(),pV(),t()}).catch(function(){s(),pV(),e()})})}var Qne=!1,Jne=function(t){return t.toLowerCase().split(" ").reduce(function(r,s){var i=s.toLowerCase().split("-"),o=i[0],c=i.slice(1).join("-");if(o&&"h"===c)return r.flipX=!0,r;if(o&&"v"===c)return r.flipY=!0,r;if(c=parseFloat(c),isNaN(c))return r;switch(o){case"grow":r.size=r.size+c;break;case"shrink":r.size=r.size-c;break;case"left":r.x=r.x-c;break;case"right":r.x=r.x+c;break;case"up":r.y=r.y-c;break;case"down":r.y=r.y+c;break;case"rotate":r.rotate=r.rotate+c}return r},{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0})},gV={x:0,y:0,width:"100%",height:"100%"};function e1e(n){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n.attributes&&(n.attributes.fill||t)&&(n.attributes.fill="black"),n}function Oze(n){return"g"===n.tag?n.children:[n]}var Nze={hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-mask"),i=s?HS(s.split(" ").map(function(o){return o.trim()})):{prefix:null,iconName:null,rest:[]};return i.prefix||(i.prefix=q0()),e.mask=i,e.maskId=r.getAttribute("data-fa-mask-id"),e}}},provides:function(t){t.generateAbstractMask=function(e){var r=e.children,s=e.attributes,i=e.main,o=e.mask,c=e.maskId,p=i.icon,C=o.icon,w=function bDe(n){var t=n.transform,r=n.iconWidth,s={transform:"translate(".concat(n.containerWidth/2," 256)")},i="translate(".concat(32*t.x,", ").concat(32*t.y,") "),o="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),c="rotate(".concat(t.rotate," 0 0)");return{outer:s,inner:{transform:"".concat(i," ").concat(o," ").concat(c)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}({transform:e.transform,containerWidth:o.width,iconWidth:i.width}),I={tag:"rect",attributes:Mt(Mt({},gV),{},{fill:"white"})},H=p.children?{children:p.children.map(e1e)}:{},Y={tag:"g",attributes:Mt({},w.inner),children:[e1e(Mt({tag:p.tag,attributes:Mt(Mt({},p.attributes),w.path)},H))]},ee={tag:"g",attributes:Mt({},w.outer),children:[Y]},ve="mask-".concat(c||Mm()),te="clip-".concat(c||Mm()),Ie={tag:"mask",attributes:Mt(Mt({},gV),{},{id:ve,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[I,ee]},Be={tag:"defs",children:[{tag:"clipPath",attributes:{id:te},children:Oze(C)},Ie]};return r.push(Be,{tag:"rect",attributes:Mt({fill:"currentColor","clip-path":"url(#".concat(te,")"),mask:"url(#".concat(ve,")")},gV)}),{children:r,attributes:s}}}};!function WDe(n,t){var e=t.mixoutsTo;Rne=n,u9={},Object.keys(f9).forEach(function(r){-1===GDe.indexOf(r)&&delete f9[r]}),Rne.forEach(function(r){var s=r.mixout?r.mixout():{};if(Object.keys(s).forEach(function(o){"function"==typeof s[o]&&(e[o]=s[o]),"object"===TS(s[o])&&Object.keys(s[o]).forEach(function(c){e[o]||(e[o]={}),e[o][c]=s[o][c]})}),r.hooks){var i=r.hooks();Object.keys(i).forEach(function(o){u9[o]||(u9[o]=[]),u9[o].push(i[o])})}r.provides&&r.provides(f9)})}([ADe,_ze,vze,Cze,yze,{hooks:function(){return{mutationObserverCallbacks:function(e){return e.pseudoElementsCallback=Xne,e}}},provides:function(t){t.pseudoElements2svg=function(e){var r=e.node;Nt.searchPseudoElements&&Xne(void 0===r?Or:r)}}},{mixout:function(){return{dom:{unwatch:function(){Gne(),Qne=!0}}}},hooks:function(){return{bootstrap:function(){Wne(iV("mutationObserverCallbacks",{}))},noAuto:function(){!function cze(){!US||US.disconnect()}()},watch:function(e){var r=e.observeMutationsRoot;Qne?pV():Wne(iV("mutationObserverCallbacks",{observeMutationsRoot:r}))}}}},{mixout:function(){return{parse:{transform:function(e){return Jne(e)}}}},hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-transform");return s&&(e.transform=Jne(s)),e}}},provides:function(t){t.generateAbstractTransformGrouping=function(e){var r=e.main,s=e.transform,o=e.iconWidth,c={transform:"translate(".concat(e.containerWidth/2," 256)")},u="translate(".concat(32*s.x,", ").concat(32*s.y,") "),h="scale(".concat(s.size/16*(s.flipX?-1:1),", ").concat(s.size/16*(s.flipY?-1:1),") "),p="rotate(".concat(s.rotate," 0 0)"),w={outer:c,inner:{transform:"".concat(u," ").concat(h," ").concat(p)},path:{transform:"translate(".concat(o/2*-1," -256)")}};return{tag:"g",attributes:Mt({},w.outer),children:[{tag:"g",attributes:Mt({},w.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:Mt(Mt({},r.icon.attributes),w.path)}]}]}}}},Nze,{provides:function(t){var e=!1;G0.matchMedia&&(e=G0.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){var r=[],s={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};r.push({tag:"path",attributes:Mt(Mt({},s),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var o=Mt(Mt({},i),{},{attributeName:"opacity"}),c={tag:"circle",attributes:Mt(Mt({},s),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||c.children.push({tag:"animate",attributes:Mt(Mt({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:Mt(Mt({},o),{},{values:"1;0;1;1;0;1;"})}),r.push(c),r.push({tag:"path",attributes:Mt(Mt({},s),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:Mt(Mt({},o),{},{values:"1;0;0;0;0;1;"})}]}),e||r.push({tag:"path",attributes:Mt(Mt({},s),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:Mt(Mt({},o),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:r}}}},{hooks:function(){return{parseNodeAttributes:function(e,r){var s=r.getAttribute("data-fa-symbol");return e.symbol=null!==s&&(""===s||s),e}}}}],{mixoutsTo:Ua});var kze=Ua.parse,Lze=Ua.icon;const Rze=["*"],Vze=n=>{const t={"fa-spin":n.spin,"fa-pulse":n.pulse,"fa-fw":n.fixedWidth,"fa-border":n.border,"fa-inverse":n.inverse,"fa-layers-counter":n.counter,"fa-flip-horizontal":"horizontal"===n.flip||"both"===n.flip,"fa-flip-vertical":"vertical"===n.flip||"both"===n.flip,[`fa-${n.size}`]:null!==n.size,[`fa-rotate-${n.rotate}`]:null!==n.rotate,[`fa-pull-${n.pull}`]:null!==n.pull,[`fa-stack-${n.stackItemSize}`]:null!=n.stackItemSize};return Object.keys(t).map(e=>t[e]?e:null).filter(e=>e)};let Bze=(()=>{class n{constructor(){this.defaultPrefix="fas",this.fallbackIcon=null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$ze=(()=>{class n{constructor(){this.definitions={}}addIcons(...e){for(const r of e){r.prefix in this.definitions||(this.definitions[r.prefix]={}),this.definitions[r.prefix][r.iconName]=r;for(const s of r.icon[2])"string"==typeof s&&(this.definitions[r.prefix][s]=r)}}addIconPacks(...e){for(const r of e){const s=Object.keys(r).map(i=>r[i]);this.addIcons(...s)}}getIconDefinition(e,r){return e in this.definitions&&r in this.definitions[e]?this.definitions[e][r]:null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Uze=(()=>{class n{constructor(){this.stackItemSize="1x"}ngOnChanges(e){if("size"in e)throw new Error('fa-icon is not allowed to customize size when used inside fa-stack. Set size on the enclosing fa-stack instead: <fa-stack size="4x">...</fa-stack>.')}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=$t({type:n,selectors:[["fa-icon","stackItemSize",""],["fa-duotone-icon","stackItemSize",""]],inputs:{stackItemSize:"stackItemSize",size:"size"},features:[e2]}),n})(),Gze=(()=>{class n{constructor(e,r){this.renderer=e,this.elementRef=r}ngOnInit(){this.renderer.addClass(this.elementRef.nativeElement,"fa-stack")}ngOnChanges(e){"size"in e&&(null!=e.size.currentValue&&this.renderer.addClass(this.elementRef.nativeElement,`fa-${e.size.currentValue}`),null!=e.size.previousValue&&this.renderer.removeClass(this.elementRef.nativeElement,`fa-${e.size.previousValue}`))}}return n.\u0275fac=function(e){return new(e||n)(Q(mo),Q(l2))},n.\u0275cmp=gt({type:n,selectors:[["fa-stack"]],inputs:{size:"size"},features:[e2],ngContentSelectors:Rze,decls:1,vars:0,template:function(e,r){1&e&&(function CB(n){const t=Le()[16][6];if(!t.projection){const r=t.projection=ul(n?n.length:1,null),s=r.slice();let i=t.child;for(;null!==i;){const o=n?_4e(i,n):0;null!==o&&(s[o]?s[o].projectionNext=i:r[o]=i,s[o]=i),i=i.next}}}(),function yB(n,t=0,e){const r=Le(),s=Kn(),i=s0(s,22+n,16,null,e||null);null===i.projection&&(i.projection=t),dh(),64!=(64&i.flags)&&function jw(n,t,e){Kv(t[11],0,t,e,$v(n,e,t),qv(e.parent||t[6],e,t))}(s,r,i)}(0))},encapsulation:2}),n})(),h9=(()=>{class n{constructor(e,r,s,i,o){this.sanitizer=e,this.config=r,this.iconLibrary=s,this.stackItem=i,this.classes=[],null!=o&&null==i&&console.error('FontAwesome: fa-icon and fa-duotone-icon elements must specify stackItemSize attribute when wrapped into fa-stack. Example: <fa-icon stackItemSize="2x"></fa-icon>.')}ngOnChanges(e){if(null==this.icon&&null==this.config.fallbackIcon)return(()=>{throw new Error("Property `icon` is required for `fa-icon`/`fa-duotone-icon` components.")})();let r=null;if(r=this.icon??this.config.fallbackIcon,e){const s=this.findIconDefinition(r);if(null!=s){const i=this.buildParams();this.renderIcon(s,i)}}}render(){this.ngOnChanges({})}findIconDefinition(e){const r=((n,t)=>(n=>void 0!==n.prefix&&void 0!==n.iconName)(n)?n:Array.isArray(n)&&2===n.length?{prefix:n[0],iconName:n[1]}:"string"==typeof n?{prefix:t,iconName:n}:void 0)(e,this.config.defaultPrefix);return"icon"in r?r:this.iconLibrary.getIconDefinition(r.prefix,r.iconName)??((n=>{throw new Error(`Could not find icon with iconName=${n.iconName} and prefix=${n.prefix} in the icon library.`)})(r),null)}buildParams(){const e={flip:this.flip,spin:this.spin,pulse:this.pulse,border:this.border,inverse:this.inverse,size:this.size||null,pull:this.pull||null,rotate:this.rotate||null,fixedWidth:"boolean"==typeof this.fixedWidth?this.fixedWidth:this.config.fixedWidth,stackItemSize:null!=this.stackItem?this.stackItem.stackItemSize:null},r="string"==typeof this.transform?kze.transform(this.transform):this.transform;return{title:this.title,transform:r,classes:[...Vze(e),...this.classes],mask:null!=this.mask?this.findIconDefinition(this.mask):null,styles:null!=this.styles?this.styles:{},symbol:this.symbol,attributes:{role:this.a11yRole}}}renderIcon(e,r){const s=Lze(e,r);this.renderedIconHTML=this.sanitizer.bypassSecurityTrustHtml(s.html.join("\n"))}}return n.\u0275fac=function(e){return new(e||n)(Q(FG),Q(Bze),Q($ze),Q(Uze,8),Q(Gze,8))},n.\u0275cmp=gt({type:n,selectors:[["fa-icon"]],hostAttrs:[1,"ng-fa-icon"],hostVars:2,hostBindings:function(e,r){2&e&&(jb("innerHTML",r.renderedIconHTML,W8),D("title",r.title))},inputs:{icon:"icon",title:"title",spin:"spin",pulse:"pulse",mask:"mask",styles:"styles",flip:"flip",size:"size",pull:"pull",border:"border",inverse:"inverse",symbol:"symbol",rotate:"rotate",fixedWidth:"fixedWidth",classes:"classes",transform:"transform",a11yRole:"a11yRole"},features:[e2],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),Wze=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qr({}),n})();var CV={prefix:"fas",iconName:"reply",icon:[512,512,[61714,"mail-reply"],"f3e5","M205 34.8c11.5 5.1 19 16.6 19 29.2v64H336c97.2 0 176 78.8 176 176c0 113.3-81.5 163.9-100.2 174.1c-2.5 1.4-5.3 1.9-8.1 1.9c-10.9 0-19.7-8.9-19.7-19.7c0-7.5 4.3-14.4 9.8-19.5c9.4-8.8 22.2-26.4 22.2-56.7c0-53-43-96-96-96H224v64c0 12.6-7.4 24.1-19 29.2s-25 3-34.4-5.4l-160-144C3.9 225.7 0 217.1 0 208s3.9-17.7 10.6-23.8l160-144c9.4-8.5 22.9-10.6 34.4-5.4z"]},LV={prefix:"fas",iconName:"eye",icon:[576,512,[128065],"f06e","M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"]},$2e={prefix:"fas",iconName:"gear",icon:[512,512,[9881,"cog"],"f013","M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336c44.2 0 80-35.8 80-80s-35.8-80-80-80s-80 35.8-80 80s35.8 80 80 80z"]},J2e={prefix:"fas",iconName:"network-wired",icon:[640,512,[],"f6ff","M256 64H384v64H256V64zM240 0c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48h48v32H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96v32H80c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H240c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H192V288H448v32H400c-26.5 0-48 21.5-48 48v96c0 26.5 21.5 48 48 48H560c26.5 0 48-21.5 48-48V368c0-26.5-21.5-48-48-48H512V288h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V192h48c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H240zM96 448V384H224v64H96zm320-64H544v64H416V384z"]},Cae={prefix:"fas",iconName:"spinner",icon:[512,512,[],"f110","M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"]},rH={prefix:"fas",iconName:"desktop",icon:[576,512,[128421,61704,"desktop-alt"],"f390","M64 0C28.7 0 0 28.7 0 64V352c0 35.3 28.7 64 64 64H240l-10.7 32H160c-17.7 0-32 14.3-32 32s14.3 32 32 32H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H346.7L336 416H512c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64H64zM512 64V288H64V64H512z"]},tce={prefix:"fas",iconName:"book-open",icon:[576,512,[128214,128366],"f518","M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C87.5 32 35.1 48.6 9 59.9c-5.6 2.4-9 8-9 14V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V73.9c0-6.1-3.4-11.6-9-14C540.9 48.6 488.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"]};class w2{constructor(t,e){this.userDAO=t,this.connectedUserService=e,this.userSubscription=new q1,this.observedPartLoading=!0,this.observedPart=P.empty(),this.observedPartRS=new mte(1),this.observedPartObs=this.observedPartRS.asObservable(),this.authSubscription=this.connectedUserService.subscribeToUser(r=>{this.onUserUpdate(r)})}onUserUpdate(t){t===f5.NOT_CONNECTED?(this.authSubscription.unsubscribe(),this.observedPartRS.next(P.empty())):this.userSubscription=this.userDAO.subscribeToChanges(t.id,e=>{ye(e.isPresent(),"When observing part service, user was expected to already have a document!");const r=e.get();this.updateObservedPartWithDoc(r.observedPart)})}updateObservedPartWithDoc(t){const e=this.observedPart,r=null==t&&e.isAbsent(),s=null!=t&&e.equalsValue(t);(!1===r&&!1===s||this.observedPartLoading)&&(this.observedPartLoading=!1,this.observedPart=P.ofNullable(t),this.observedPartRS.next(this.observedPart))}updateObservedPart(t){if(ye(this.connectedUserService.user.isPresent(),"Should not call updateObservedPart when not connected"),this.observedPart.isPresent()){const r={...this.observedPart.get(),...t};return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:r})}{const r=Object.keys({id:"id",role:"Candidate",typeGame:"P4"});for(const s of r)ye(null!=t[s],"field "+s+" should be set before updating observedPart");return this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:t})}}removeObservedPart(){return ye(this.connectedUserService.user.isPresent(),"Should not call removeObservedPart when not connected"),this.userDAO.update(this.connectedUserService.user.get().id,{observedPart:null})}subscribeToObservedPart(t){return this.observedPartObs.subscribe(t)}canUserCreate(){if(this.observedPart.isAbsent())return U.SUCCESS;{const t=w2.roleToMessage.get(this.observedPart.get().role).get()();return U.failure(t)}}canUserJoin(t,e){if(this.observedPart.isAbsent()||this.observedPart.get().id===t)return U.SUCCESS;if(e&&"Observer"===this.observedPart.get().role)return U.SUCCESS;{const r=w2.roleToMessage.get(this.observedPart.get().role).get()();return U.failure(r)}}ngOnDestroy(){this.userSubscription.unsubscribe(),this.authSubscription.unsubscribe()}}function p3t(n,t){if(1&n&&(ln(0),me(1,31),un()),2&n){const e=v(2);S(1),I1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),H1(1)}}function g3t(n,t){if(1&n&&(ln(0),me(1,33),un()),2&n){const e=v(3);S(1),I1(e.observedPart.get().typeGame)(null==e.observedPart.get().opponent?null:e.observedPart.get().opponent.name),H1(1)}}function m3t(n,t){if(1&n&&(ln(0),me(1,34),un()),2&n){const e=v(3);S(1),I1(e.observedPart.get().typeGame),H1(1)}}function _3t(n,t){if(1&n&&(x(0,g3t,2,2,"ng-container",27),x(1,m3t,2,1,"ng-template",null,32,c1)),2&n){const e=t1(2);T("ngIf",v(2).observedPart.get().opponent)("ngIfElse",e)}}function v3t(n,t){if(1&n){const e=Oe();b(0,"a",29),J("click",function(){return fe(e),ae(v().navigateToPart())}),x(1,p3t,2,2,"ng-container",27),x(2,_3t,3,2,"ng-template",null,30,c1),O()}if(2&n){const e=t1(3),r=v();S(1),T("ngIf","Observer"===r.observedPart.get().role||"Candidate"===r.observedPart.get().role)("ngIfElse",e)}}function C3t(n,t){if(1&n&&(ln(0),X(1,"fa-icon",35),un()),2&n){const e=v();S(1),T("icon",e.faSpinner)}}function y3t(n,t){if(1&n){const e=Oe();ln(0),b(1,"div",10)(2,"a",37),Pt(3),O(),b(4,"div",13)(5,"a",38),J("click",function(){return fe(e),ae(v(2).logout())}),me(6,39),O()()(),un()}if(2&n){const e=v(2);S(3),a1(e.username.get())}}w2.roleToMessage=new zn([{key:"Candidate",value:fm.YOU_ARE_ALREADY_CANDIDATE},{key:"ChosenOpponent",value:fm.YOU_ARE_ALREADY_CHOSEN_OPPONENT},{key:"Creator",value:fm.YOU_ARE_ALREADY_CREATING},{key:"Player",value:fm.YOU_ARE_ALREADY_PLAYING},{key:"Observer",value:fm.YOU_ARE_ALREADY_OBSERVING}]),w2.\u0275fac=function(t){return new(t||w2)(Re(yS),Re(Os))},w2.\u0275prov=et({token:w2,factory:w2.\u0275fac,providedIn:"root"});const E3t=function(){return["/register"]},M3t=function(){return["/login"]};function S3t(n,t){1&n&&(b(0,"div",40)(1,"a",41)(2,"strong"),me(3,42),O()(),b(4,"a",43),me(5,44),O()()),2&n&&(S(1),T("routerLink",tr(2,E3t)),S(3),T("routerLink",tr(3,M3t)))}function P3t(n,t){if(1&n&&(x(0,y3t,7,1,"ng-container",27),x(1,S3t,6,4,"ng-template",null,36,c1)),2&n){const e=t1(2);T("ngIf",v().username.isPresent())("ngIfElse",e)}}const Nce=function(){return["/"]},T3t=function(){return["/play"]},w3t=function(){return["/lobby"]},b3t=function(){return["/local"]},O3t=function(){return["/tutorial"]},N3t=function(){return["/settings"]};let A3t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.connectedUserService=r,this.observedPartService=s,this.userService=i,this.loading=!0,this.username=P.empty(),this.faCog=$2e,this.faSpinner=Cae,this.showMenu=!1,this.observedPart=P.empty()}ngOnInit(){this.userSubscription=this.connectedUserService.subscribeToUser(e=>{this.loading=!1,this.username=e.username.isPresent()?e.username:e.email}),this.observedPartSubscription=this.observedPartService.subscribeToObservedPart(e=>{this.observedPart=e})}logout(){var e=this;return A(function*(){yield e.connectedUserService.disconnect(),yield e.router.navigate(["/"])})()}navigateToPart(){var e=this;return A(function*(){return e.router.navigate(["/play",e.observedPart.get().typeGame,e.observedPart.get().id])})()}ngOnDestroy(){this.userSubscription.unsubscribe(),this.observedPartSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Os),Q(w2),Q(um))},n.\u0275cmp=gt({type:n,selectors:[["app-header"]],decls:36,vars:20,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I;return t=$localize`Home`,e=$localize`Play online`,r=$localize`Create a game`,s=$localize`Join a game`,i=$localize`Play offline`,o=$localize`Create a game`,c=$localize`Learn the rules`,u=$localize`Settings`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: by ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,p=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: against ${"\ufffd1\ufffd"}:INTERPOLATION_1:`,m=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: (waiting for opponent)`,C=$localize`Log out`,w=$localize`Register`,I=$localize`Log in`,[["role","navigation","aria-label","main navigation",1,"navbar","is-primary"],[1,"navbar-brand"],[1,"navbar-item",3,"routerLink"],["id","logo","src","assets/images/logo.png","width","28","height","28"],["role","button","aria-label","menu","aria-expanded","false","data-target","menu",1,"navbar-burger",3,"ngClass","click"],["aria-hidden","true"],["id","menu",1,"navbar-menu",3,"ngClass","click"],[1,"navbar-start"],["id","home",1,"navbar-item",3,"routerLink"],t,[1,"navbar-item","has-dropdown","is-hoverable"],[1,"navbar-link"],e,[1,"navbar-dropdown"],r,s,["id","playOffline",1,"navbar-link"],i,["id","playLocally",1,"navbar-item",3,"routerLink"],o,["id","tutorial",1,"navbar-item",3,"routerLink"],c,[1,"navbar-end"],["id","observedPartLink","class","navbar-item",3,"click",4,"ngIf"],["data-tooltip",u,1,"navbar-item",3,"routerLink"],[3,"icon"],[1,"navbar-item"],[4,"ngIf","ngIfElse"],["showUsernameOrLogin",""],["id","observedPartLink",1,"navbar-item",3,"click"],["activeUser",""],h,["waitingForOpponent",""],p,m,[1,"navbar-item","fa-spin",3,"icon"],["connect",""],["id","connectedUserName",1,"navbar-link"],["id","logout",1,"navbar-item",3,"click"],C,[1,"buttons"],["id","register",1,"button","is-primary",3,"routerLink"],w,["id","login",1,"button","is-light",3,"routerLink"],I]},template:function(e,r){if(1&e&&(b(0,"nav",0)(1,"div",1)(2,"a",2),X(3,"img",3),O(),b(4,"a",4),J("click",function(){return r.showMenu=!r.showMenu}),X(5,"span",5)(6,"span",5)(7,"span",5),O()(),b(8,"div",6),J("click",function(){return r.showMenu=!r.showMenu}),b(9,"div",7)(10,"a",8),me(11,9),O(),b(12,"div",10)(13,"a",11),me(14,12),O(),b(15,"div",13)(16,"a",2),me(17,14),O(),b(18,"a",2),me(19,15),O()()(),b(20,"div",10)(21,"a",16),me(22,17),O(),b(23,"div",13)(24,"a",18),me(25,19),O(),b(26,"a",20),me(27,21),O()()()(),b(28,"div",22),x(29,v3t,4,2,"a",23),b(30,"a",24),X(31,"fa-icon",25),O(),b(32,"div",26),x(33,C3t,2,1,"ng-container",27),x(34,P3t,3,2,"ng-template",null,28,c1),O()()()()),2&e){const s=t1(35);S(2),T("routerLink",tr(13,Nce)),S(2),T("ngClass",r.showMenu?"is-active":""),S(4),T("ngClass",r.showMenu?"is-active":""),S(2),T("routerLink",tr(14,Nce)),S(6),T("routerLink",tr(15,T3t)),S(2),T("routerLink",tr(16,w3t)),S(6),T("routerLink",tr(17,b3t)),S(2),T("routerLink",tr(18,O3t)),S(3),T("ngIf",r.observedPart.isPresent()),S(1),T("routerLink",tr(19,N3t)),S(1),T("icon",r.faCog),S(2),T("ngIf",r.loading)("ngIfElse",s)}},dependencies:[mn,nn,Su,h9],encapsulation:2}),n})(),I3t=(()=>{class n{constructor(e,r){this._themeService=e,this._errorLoggerService=r,this.faTwitter=Xte,this.faFacebook=Gte,this.faGithub=Kte}}return n.\u0275fac=function(e){return new(e||n)(Q(PS),Q(bs))},n.\u0275cmp=gt({type:n,selectors:[["app-root"]],decls:18,vars:3,consts:function(){let t;return t=$localize`If you like ${"\ufffd#8\ufffd"}:START_TAG_STRONG:EveryBoard${"\ufffd/#8\ufffd"}:CLOSE_TAG_STRONG:, follow us!`,[[1,"container","mt-2"],[1,"footer"],[1,"content","has-text-centered"],t,["href","https://github.com/EveryBoard/EveryBoard"],[3,"icon"],["href","https://twitter.com/EveryBoardGames"],["href","https://facebook.com/EveryBoard"]]},template:function(e,r){1&e&&(X(0,"app-header"),b(1,"main",0),X(2,"router-outlet"),O(),b(3,"footer",1)(4,"div",2)(5,"p")(6,"span"),gc(7,3),X(8,"strong"),mc(),O(),Pt(9," \xa0 "),b(10,"a",4),X(11,"fa-icon",5),O(),Pt(12,"\xa0 "),b(13,"a",6),X(14,"fa-icon",5),O(),Pt(15,"\xa0 "),b(16,"a",7),X(17,"fa-icon",5),O()()()()),2&e&&(S(11),T("icon",r.faGithub),S(3),T("icon",r.faTwitter),S(3),T("icon",r.faFacebook))},dependencies:[BN,h9,A3t],encapsulation:2}),n})();class $i{}class wn{constructor(t){this.x=t}static from(t){switch(t){case 0:return wn.ZERO;case 1:return wn.ONE;case 2:return wn.TWO;default:return ye(3===t,"Invalid Apagos Coord "+t),wn.THREE}}equals(t){return this.x===t.x}}wn.ZERO=new wn(0),wn.ONE=new wn(1),wn.TWO=new wn(2),wn.THREE=new wn(3);let d9=(()=>{class n{}return n.PIECE_SHOULD_MOVE_DOWNWARD=()=>$localize`Pieces should only move downward!`,n.CANNOT_LAND_ON_A_FULL_SQUARE=()=>$localize`That square is already full, you cannot put a piece in it!`,n.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE=()=>$localize`You have no pieces in that square, select one that contains at least one of your pieces!`,n.NO_PIECE_REMAINING_TO_DROP=()=>$localize`There are no remaining pieces of that color to drop!`,n.NO_POSSIBLE_TRANSFER_REMAINS=()=>$localize`There is no possible transfer from that square!`,n})();class F1 extends $i{constructor(t,e,r){super(),this.landing=t,this.piece=e,this.starting=r}static drop(t,e){return we.getNonNullable(F1.ALL_MOVES.find(s=>s.landing.equals(t)&&s.piece.equalsValue(e)&&s.starting.equals(P.empty())))}static transfer(t,e){if(t.x<=e.x)return $.failure(d9.PIECE_SHOULD_MOVE_DOWNWARD());const r=we.getNonNullable(F1.ALL_MOVES.find(s=>s.landing.equals(e)&&s.piece.equals(P.empty())&&s.starting.equals(P.of(t))));return $.success(r)}isDrop(){return this.piece.isPresent()}toString(){return this.isDrop()?"ApagosMove.drop("+this.piece.get().toString()+" on "+this.landing.x+")":"ApagosMove.slideDown("+this.starting.get().x+" > "+this.landing.x+")"}equals(t){return!1!==this.starting.equals(t.starting)&&!1!==this.landing.equals(t.landing)&&this.piece.equals(t.piece)}}F1.ALL_MOVES=[new F1(wn.ZERO,P.of(z.ZERO),P.empty()),new F1(wn.ONE,P.of(z.ZERO),P.empty()),new F1(wn.TWO,P.of(z.ZERO),P.empty()),new F1(wn.THREE,P.of(z.ZERO),P.empty()),new F1(wn.ZERO,P.of(z.ONE),P.empty()),new F1(wn.ONE,P.of(z.ONE),P.empty()),new F1(wn.TWO,P.of(z.ONE),P.empty()),new F1(wn.THREE,P.of(z.ONE),P.empty()),new F1(wn.TWO,P.empty(),P.of(wn.THREE)),new F1(wn.ONE,P.empty(),P.of(wn.THREE)),new F1(wn.ZERO,P.empty(),P.of(wn.THREE)),new F1(wn.ONE,P.empty(),P.of(wn.TWO)),new F1(wn.ZERO,P.empty(),P.of(wn.TWO)),new F1(wn.ZERO,P.empty(),P.of(wn.ONE))],F1.encoder=new class extends Cn{maxValue(){return F1.ALL_MOVES.length}encodeNumber(n){const t=F1.ALL_MOVES.findIndex(e=>e.equals(n));return ye(t>=0,n.toString()+" is not part of possibles moves of Apagos!"),t}decodeNumber(n){return ye(n<F1.ALL_MOVES.length,n+" is not a valid encoded number for ApagosMove decoder"),F1.ALL_MOVES[n]}};class oP{constructor(t){this.turn=t}getCurrentPlayer(){return z.fromTurn(this.turn)}getCurrentOpponent(){return this.turn%2==1?z.ZERO:z.ONE}}class Am{constructor(t){this.containing=t}static from(t,e,r){if(t+e>r)return $.failure("invalid starting space");const s=new zn([{key:z.ZERO,value:t},{key:z.ONE,value:e},{key:pe.NONE,value:r}]);s.makeImmutable();const i=new Am(s);return $.success(i)}isFull(){return this.count(z.ZERO)+this.count(z.ONE)>=this.count(pe.NONE)}count(t){return this.containing.get(t).get()}addPiece(t){let e=this.count(z.ZERO),r=this.count(z.ONE);const s=this.count(pe.NONE);return t===z.ZERO?e++:r++,Am.from(e,r,s).get()}substractPiece(t){let e=this.count(z.ZERO),r=this.count(z.ONE);const s=this.count(pe.NONE);return t===z.ZERO?e--:r--,Am.from(e,r,s).get()}getDominatingPlayer(){const t=this.count(z.ZERO),e=this.count(z.ONE);return t>e?z.ZERO:e>t?z.ONE:pe.NONE}equals(t){return this.containing.equals(t.containing)}}let Z0=(()=>{class n extends oP{constructor(e,r,s){super(e),this.board=r,this.remaining=s,this.remaining.makeImmutable()}static getInitialState(){return n.fromRepresentation(0,[[0,0,0,0],[0,0,0,0],[7,5,3,1]],this.PIECES_PER_PLAYER,this.PIECES_PER_PLAYER)}static fromRepresentation(e,r,s,i){const o=[];for(let u=0;u<4;u++){const C=Am.from(r[0][u],r[1][u],r[2][u]).get();o.push(C)}const c=new zn;return c.set(z.ZERO,s),c.set(z.ONE,i),new n(e,o,c)}getPieceAt(e){return this.board[e.x]}updateAt(e,r){const s=[];for(let o=0;o<4;o++)s.push(e.x===o?r:this.board[o]);const i=this.getRemainingCopy();return new n(this.turn,s,i)}getRemainingCopy(){return this.remaining.getCopy()}getRemaining(e){return this.remaining.get(e).get()}equals(e){return this.turn===e.turn&&Ke.compareArray(e.board,this.board)&&this.remaining.equals(e.remaining)}}return n.PIECES_PER_PLAYER=10,n})();class ce{constructor(t,e,r){this.title=t,this.instruction=e,this.state=r,this.previousMove=P.empty(),this.previousState=P.empty()}static fromMove(t,e,r,s,i,o){return new x3t(t,e,r,s,i,o)}static forClick(t,e,r,s,i,o){return new L3t(t,e,r,s,i,o)}static anyMove(t,e,r,s,i){return new k3t(t,e,r,s,i)}static fromPredicate(t,e,r,s,i,o){return new R3t(t,e,r,s,i,o)}static informational(t,e,r){return new D3t(t,e,r)}isMove(){return!1}isAnyMove(){return!1}isClick(){return!1}isPredicate(){return!1}isInformation(){return!1}hasSolution(){return!1}withPreviousMove(t){return this.previousMove=P.of(t),this}withPreviousState(t){return this.previousState=P.of(t),this}}class aP extends ce{constructor(t,e,r,s){super(t,e,r),this.successMessage=s}hasSolution(){return!0}getSuccessMessage(){return this.successMessage}}class x3t extends aP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedMoves=s,this.failureMessage=o,ye(s.length>0,"TutorialStepMove: At least one accepted move should be provided, otherwise use TutorialStepInformational")}isMove(){return!0}getSolution(){return this.acceptedMoves[0]}getFailureMessage(){return this.failureMessage}}class k3t extends aP{constructor(t,e,r,s,i){super(t,e,r,i),this.solutionMove=s}getSolution(){return this.solutionMove}isAnyMove(){return!0}}class L3t extends aP{constructor(t,e,r,s,i,o){super(t,e,r,i),this.acceptedClicks=s,this.failureMessage=o}isClick(){return!0}getSolution(){return this.acceptedClicks[0]}getFailureMessage(){return this.failureMessage}}class R3t extends aP{constructor(t,e,r,s,i,o){super(t,e,r,o),this.solutionMove=s,this.predicate=i}getSolution(){return this.solutionMove}isPredicate(){return!0}}class D3t extends ce{isInformation(){return!0}}class rr{}class Ace extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board and goal of the game`,$localize`At Apagos, there are 4 squares, each of them has a fixed number of holes for pieces. Each player starts with 10 pieces. Dark pieces belong to the first player, light pieces belong to the second one. The game ends when no one can play. The player owning the most pieces in the rightmost square wins!`,Z0.getInitialState()),ce.anyMove($localize`Drop`,$localize`There are two kinds of moves. One is the drop. To do one, you must click on a visible arrow, being of your color or the opponent's. If the chosen square is one of the 3 leftmost ones, it will exchange position with the square on its right.<br/><br/>You're playing Light. Drop a piece on one of those three squares.`,Z0.fromRepresentation(1,[[0,0,0,1],[0,0,0,0],[7,5,3,1]],9,10),F1.drop(wn.ZERO,z.ZERO),$localize`Congratulations!`),ce.fromPredicate($localize`Transfer`,$localize`The other kind of move is the transfer.<ol><li>Choose one of your pieces on the board by clicking on the square in which it is.</li><li>Choose its landing square by clicking on one of the arrow to finish the transfer.</li></ol>It can only be done with your pieces, from a higher square to a lower one.<br/><br/>You're playing Dark, do a transfer!`,Z0.fromRepresentation(2,[[0,0,1,0],[0,1,0,0],[7,5,3,1]],9,9),F1.transfer(wn.TWO,wn.ZERO).get(),(t,e,r)=>t.isDrop()?U.failure($localize`This move is a drop, please do a transfer!`):U.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Victory`,$localize`When you put a last piece into a square, the games end. In this configuration you can win.<br/><br/>You're playing Light, do the winning move!`,Z0.fromRepresentation(3,[[1,0,3,4],[2,1,3,1],[3,1,7,5]],2,3),F1.drop(wn.TWO,z.ONE),(t,e,r)=>t.isDrop()?t.piece.equalsValue(z.ONE)?U.SUCCESS:U.failure($localize`You actively made your opponent win!`):U.failure($localize`Wrong choice, your opponent will win in the next turn no matter which piece is dropped!`),$localize`Congratulations!`)]}}var yn=(()=>(function(n){n.VICTORY="VICTORY",n.PRE_VICTORY="PRE_VICTORY",n.DEFAULT="DEFAULT"}(yn||(yn={})),yn))();let cP=(()=>{class n{}return n.createdNodes=0,n.minimaxTime=0,n})();class B1{constructor(t,e=P.empty(),r=P.empty(),s){if(this.gameState=t,this.mother=e,this.move=r,this.minimaxCreator=s,this.childs=P.empty(),this.hopedValue=new zn,this.ownValue=new zn,this.possibleMoves=new zn,this.ownValue=new zn,null!=s){const o=s.getBoardValue(this);this.ownValue.set(s.name,o),this.hopedValue.set(s.name,o.value)}cP.createdNodes++,K(B1.VERBOSE||!1,"creating "+this.myToString())}static getScoreStatus(t){return t===Number.MAX_SAFE_INTEGER||t===Number.MIN_SAFE_INTEGER?(K(B1.VERBOSE||!1,"VICTORY"),yn.VICTORY):t===Number.MIN_SAFE_INTEGER+1?(K(B1.VERBOSE||!1,"PRE_VICTORY_MIN"),yn.PRE_VICTORY):t===Number.MAX_SAFE_INTEGER-1?(K(B1.VERBOSE||!1,"PRE_VICTORY_MAX"),yn.PRE_VICTORY):(K(B1.VERBOSE||!1,"DEFAULT"),yn.DEFAULT)}findBestMove(t,e,r=!1,s=!0){const i=(new Date).getTime();let o=this.alphaBeta(t,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,e,r,s);for(;o.gameState.turn>this.gameState.turn+1;)o=o.mother.get(),t--;return cP.minimaxTime+=(new Date).getTime()-i,o.move.get()}alphaBeta(t,e,r,s,i,o){if(t<1)return K(B1.VERBOSE||!1,"isLeaf-Calculation : "+this.myToString()+" at depth "+t),this;if(s.ruler.getGameStatus(this).isEndGame)return K(B1.VERBOSE||!1,"isLeaf-EndGame("+B1.ruler.getGameStatus(this).winner.toString()+") : "+this.myToString()+" at depth "+t),this;const u=this.getPossibleMoves(s);ye(u.size()>0,"Minimax "+s.name+" should give move, received none!"),this.childs.isAbsent()&&(this.childs=P.of([]));const h=this.getBestChilds(u,t,e,r,s,i,o),p=this.getBestChildAmongst(h,i),m=p.hopedValue.get(s.toString()).get();return this.hopedValue.put(s.toString(),m),p}getPossibleMoves(t){const e=this.possibleMoves.get(t.name);if(e.isAbsent()){const r=t.getListMoves(this);return this.possibleMoves.set(t.name,new Ht(r)),new Ht(r)}return e.get()}getBestChilds(t,e,r,s,i,o,c){let u=[];const h=this.gameState.getCurrentPlayer();let p=h===z.ZERO?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER;const m=h===z.ZERO?(C,w)=>C<w:(C,w)=>w<C;for(const C of t){const I=this.getOrCreateChild(C,i).alphaBeta(e-1,r,s,i,o,c),H=I.getHopedValue(i);if(m(H,p)||0===u.length?(p=H,u=[I]):H===p&&u.push(I),c&&m(p,h===z.ZERO?r:s))break;h===z.ZERO?s=Math.min(p,s):r=Math.max(p,r)}return u}getBestChildAmongst(t,e){return e?t[Math.floor(Math.random()*t.length)]:t[0]}getOrCreateChild(t,e){let r=this.getSonByMove(t);if(r.isAbsent()){const s=e.ruler.isLegal(t,this.gameState),i=t.toString();ye(s.isSuccess(),'The minimax "'+e.name+'" has proposed an illegal move ('+i+"), this should not happen.");const o=e.ruler.applyLegalMove(t,this.gameState,s.get());r=P.of(new B1(o,P.of(this),P.of(t),e)),this.childs.get().push(r.get())}return r.get()}getSonByMove(t){ye(this.childs.isPresent(),"Cannot get son of uncalculated node");for(const e of this.childs.get())if(e.move.isPresent()&&e.move.equalsValue(t))return P.of(e);return P.empty()}getHopedValue(t){return this.hopedValue.get(t.name).get()}getOwnValue(t){const e=this.ownValue.get(t.name);if(e.isAbsent()){const r=t.getBoardValue(this);return this.ownValue.set(t.name,r),r}return e.get()}myToString(){let t="",e=this;if(e.mother.isAbsent())return"NodeInitial: "+e.gameState.turn;for(;e.mother.isPresent();)t=(e.move.isAbsent()?" ":" > "+e.move.get().toString()+"> ")+e.gameState.turn+" "+t,e=e.mother.get();return"Node: "+t}hasMoves(){return this.childs.isPresent()}countDescendants(){if(this.childs.isAbsent())return 0;let t=this.childs.get().length;for(const e of this.childs.get())t+=e.countDescendants();return t}}B1.VERBOSE=!1,B1.minimaxes=new zn;class Ct{constructor(t){this.value=t}static fromWinner(t){return t.isPlayer()?new Ct(t.getVictoryValue()):new Ct(0)}static from(t,e){return t*=z.ZERO.getScoreModifier(),e*=z.ONE.getScoreModifier(),new Ct(t+e)}toString(){return""+this.value}}class xe{constructor(t,e){this.isEndGame=t,this.winner=e}static getVictory(t){return t===z.ZERO?xe.ZERO_WON:xe.ONE_WON}static getDefeat(t){return t===z.ZERO?xe.ONE_WON:xe.ZERO_WON}toBoardValue(){return this.winner.isPlayer()?new Ct(this.winner.getVictoryValue()):new Ct(0)}}xe.ZERO_WON=new xe(!0,z.ZERO),xe.ONE_WON=new xe(!0,z.ONE),xe.DRAW=new xe(!0,pe.NONE),xe.ONGOING=new xe(!1,pe.NONE);class Z1{constructor(t){this.stateType=t,this.setInitialBoard()}choose(t){K(!1,"Rules.choose: "+t.toString()+" was proposed");const r=this.isLegal(t,this.node.gameState);if(this.node.hasMoves()){K(!1,"Rules.choose: current node has moves");const o=this.node.getSonByMove(t);if(o.isPresent())return ye(r.isSuccess(),"Rules.choose: Move is illegal: "+r.getReasonOr("")),K(!1,"Rules.choose: and this proposed move is found in the list, so it is legal"),this.node=o.get(),!0}if(K(!1,"Rules.choose: current node has no moves or is pruned, let's verify ourselves"),r.isFailure())return K(!1,"Rules.choose: Move is illegal: "+r.getReason()),!1;K(!1,"Rules.choose: Move is legal, let's apply it");const s=this.applyLegalMove(t,this.node.gameState,r.get()),i=new B1(s,P.of(this.node),P.of(t));return this.node=i,!0}setInitialBoard(){const t=this.stateType.getInitialState();B1.ruler=this,this.node=new B1(t)}applyMoves(t,e,r){let s=0;for(const i of t){const o=r(i),c=this.isLegal(o,e);ye(c.isSuccess(),"Can't create state from invalid moves ("+s+"): "+c.toString()+"."),e=this.applyLegalMove(o,e,c.get()),s++}return e}}class N4 extends Z1{constructor(){super(Z0)}static get(){return N4.singleton.isAbsent()&&(N4.singleton=P.of(new N4)),N4.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalTransfer(t,e)}applyLegalDrop(t,e){const r=e.getRemainingCopy(),s=r.get(t.piece.get()).get();r.put(t.piece.get(),s-1);const i=new Z0(e.turn+1,e.board,r),o=t.piece.get(),c=i.getPieceAt(t.landing).addPiece(o);if(t.landing===wn.THREE)return i.updateAt(t.landing,c);{const u=wn.from(t.landing.x+1),h=i.getPieceAt(u);return i.updateAt(t.landing,h).updateAt(u,c)}}applyLegalTransfer(t,e){const r=e.getCurrentPlayer(),s=t.starting.get(),i=e.getPieceAt(s).substractPiece(r),o=e.getPieceAt(t.landing).addPiece(r);let c=e.updateAt(s,i);return c=c.updateAt(t.landing,o),new Z0(c.turn+1,c.board,c.remaining)}isLegal(t,e){return e.getPieceAt(t.landing).isFull()?$.failure(d9.CANNOT_LAND_ON_A_FULL_SQUARE()):t.isDrop()?this.isLegalDrop(t,e):this.isLegalSlideDown(t,e)}isLegalDrop(t,e){return e.getRemaining(t.piece.get())<=0?$.failure(d9.NO_PIECE_REMAINING_TO_DROP()):$.success(void 0)}isLegalSlideDown(t,e){const r=e.getCurrentPlayer();return 0===e.getPieceAt(t.starting.get()).count(r)?$.failure(d9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):$.success(void 0)}getGameStatus(t){const e=t.gameState;for(let s=0;s<4;s++)if(!1===e.getPieceAt(wn.from(s)).isFull())return xe.ONGOING;const r=e.getPieceAt(wn.THREE).getDominatingPlayer();return ye(r.isPlayer(),"winner can only be a player if the game is finished"),xe.getVictory(r)}}N4.singleton=P.empty();class Ut{constructor(t,e){this.x=t,this.y=e}equals(t){return this.x===t.x&&this.y===t.y}isDiagonalOfLength(t){return Math.abs(this.x)===t&&Math.abs(this.y)===t}toMinimalVector(){const t=Math.abs(this.x),e=Math.abs(this.y),r=Math.max(t,e);let s=1,i=2;for(;i<=r;)this.x%i==0&&this.y%i==0&&(s=i),i++;return new Ut(this.x/s,this.y/s)}}class fH extends Ut{isDown(){return 1===this.y}isUp(){return-1===this.y}isLeft(){return-1===this.x}isRight(){return 1===this.x}toInt(){return 0===this.x&&-1===this.y?0:1===this.x&&0===this.y?1:0===this.x&&1===this.y?2:-1===this.x&&0===this.y?3:-1===this.x&&-1===this.y?4:1===this.x&&-1===this.y?5:-1===this.x&&1===this.y?6:7}toString(){return 0===this.x&&-1===this.y?"UP":1===this.x&&0===this.y?"RIGHT":0===this.x&&1===this.y?"DOWN":-1===this.x&&0===this.y?"LEFT":-1===this.x&&-1===this.y?"UP_LEFT":1===this.x&&-1===this.y?"UP_RIGHT":-1===this.x&&1===this.y?"DOWN_LEFT":"DOWN_RIGHT"}}class hH{of(t,e){for(const r of this.all)if(r.x===t&&r.y===e)return $.success(r);return $.failure("Invalid x and y in direction construction")}fromDelta(t,e){return 0===t&&0===e?$.failure("Empty delta for direction"):Math.abs(t)===Math.abs(e)||0===t||0===e?this.of(Math.sign(t),Math.sign(e)):$.failure(H3t.DIRECTION_MUST_BE_LINEAR())}fromMove(t,e){return this.fromDelta(e.x-t.x,e.y-t.y)}fromString(t){switch(t){case"UP":return this.of(0,-1);case"RIGHT":return this.of(1,0);case"DOWN":return this.of(0,1);case"LEFT":return this.of(-1,0);case"UP_LEFT":return this.of(-1,-1);case"UP_RIGHT":return this.of(1,-1);case"DOWN_LEFT":return this.of(-1,1);case"DOWN_RIGHT":return this.of(1,1);default:return $.failure(`Invalid direction string ${t}`)}}fromInt(t){switch(t){case 0:return this.of(0,-1);case 1:return this.of(1,0);case 2:return this.of(0,1);case 3:return this.of(-1,0);case 4:return this.of(-1,-1);case 5:return this.of(1,-1);case 6:return this.of(-1,1);case 7:return this.of(1,1);default:return $.failure(`Invalid int direction: ${t}`)}}}class be extends fH{constructor(t,e){super(t,e)}isDiagonal(){return 0!==this.x&&0!==this.y}getOpposite(){return be.factory.of(-this.x,-this.y).get()}}be.UP=new be(0,-1),be.UP_RIGHT=new be(1,-1),be.RIGHT=new be(1,0),be.DOWN_RIGHT=new be(1,1),be.DOWN=new be(0,1),be.DOWN_LEFT=new be(-1,1),be.LEFT=new be(-1,0),be.UP_LEFT=new be(-1,-1),be.factory=new class extends hH{constructor(){super(...arguments),this.all=[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT,be.DOWN,be.DOWN_LEFT,be.LEFT,be.UP_LEFT]}},be.DIRECTIONS=be.factory.all,be.DIAGONALS=[be.UP_RIGHT,be.DOWN_RIGHT,be.DOWN_LEFT,be.UP_LEFT],be.ORTHOGONALS=[be.UP,be.RIGHT,be.DOWN,be.LEFT],be.encoder=new class z3t extends w4{encode(t){return t.toString()}decode(t){return ye("string"==typeof t,"Invalid encoded direction"),be.factory.fromString(t).get()}};class He extends fH{constructor(t,e){super(t,e)}getOpposite(){return He.factory.of(-this.x,-this.y).get()}rotateClockwise(){return He.factory.of(-this.y,this.x).get()}}He.UP=new He(0,-1),He.RIGHT=new He(1,0),He.DOWN=new He(0,1),He.LEFT=new He(-1,0),He.factory=new class extends hH{constructor(){super(...arguments),this.all=[He.UP,He.RIGHT,He.DOWN,He.LEFT]}of(n,t){return 0===n&&-1===t?$.success(He.UP):1===n&&0===t?$.success(He.RIGHT):0===n&&1===t?$.success(He.DOWN):-1===n&&0===t?$.success(He.LEFT):$.failure("Invalid orthogonal from x and y")}},He.ORTHOGONALS=He.factory.all,He.encoder=new class V3t extends w4{encode(t){return t.toString()}decode(t){return ye("string"==typeof t,"Invalid encoded orthogonal"),He.factory.fromString(t).get()}};class Ice extends Cn{maxValue(){return 3}encodeNumber(t){return t===He.UP?0:t===He.RIGHT?1:t===He.DOWN?2:3}decodeNumber(t){switch(t){case 0:return He.UP;case 1:return He.RIGHT;case 2:return He.DOWN;default:return we.expectToBe(t,3,`Encoded orthogonal should be 3 for LEFT but got ${t} instead`),He.LEFT}}}let H3t=(()=>{class n{}return n.DIRECTION_MUST_BE_LINEAR=()=>$localize`You must move in a straight line! You can only move orthogonally or diagonally!`,n})(),dH=(()=>{class n{}return n.OUT_OF_RANGE=t=>`The coordinate ${t.toString()} is not on the board`,n})();class M extends Ut{constructor(t,e){super(t,e),this.x=t,this.y=e}static numberEncoder(t,e){return Cn.tuple([Cn.numberEncoder(t),Cn.numberEncoder(e)],r=>[r.x,r.y],r=>new M(r[0],r[1]))}getNext(t,e){return new M(this.x+(e=e??1)*t.x,this.y+e*t.y)}getPrevious(t,e){return this.getNext(t,-(e=e??1))}getLeft(t){return new M(this.x+t.y,this.y+-t.x)}getRight(t){return new M(this.x+-t.y,this.y+t.x)}isInRange(t,e){return!(this.x<0||this.y<0||this.x>=t||this.y>=e)}isNotInRange(t,e){return this.x<0||this.y<0||this.x>=t||this.y>=e}getDirectionToward(t){return be.factory.fromMove(this,t)}getOrthogonalDistance(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}getDistance(t){if(!t.isAlignedWith(this))throw new Error("Cannot calculate distance with non aligned coords.");const e=Math.abs(t.x-this.x),r=Math.abs(t.y-this.y);return Math.max(e,r)}isHexagonallyAlignedWith(t){const e=this.x-t.x,r=this.y-t.y;return e!==r&&(e===-r||e*r==0)}isAlignedWith(t){const e=Math.abs(this.x-t.x),r=Math.abs(this.y-t.y);return e===r||e*r==0}getVectorToward(t){return new Ut(t.x-this.x,t.y-this.y)}toVector(){return new Ut(this.x,this.y)}getCoordsToward(t){if(t.equals(this))return[];if(!t.isAlignedWith(this))return[];const e=this.getDirectionToward(t).get();let r=this.getNext(e,1);const s=[];for(;!1===r.equals(t);)s.push(r),r=r.getNext(e,1);return s}getUntil(t){const e=[],r=this.getDirectionToward(t).get();let s=this.getNext(r);for(;!1===s.equals(t);)e.push(s),s=s.getNext(r);return e}equals(t){return this===t||t.x===this.x&&t.y===this.y}compareTo(t){return t.y===this.y?t.x===this.x?0:this.x<t.x?-1:1:this.y<t.y?-1:1}toString(){return"("+this.x+", "+this.y+")"}toSVGPoint(){return this.x+","+this.y}}M.encoder=new class extends w4{encode(n){return{x:n.x,y:n.y}}decode(n){const t=n;return ye(null!=t.x&&"number"==typeof t.x&&null!=t.y&&"number"==typeof t.y,"Invalid encoded coord"),new M(t.x,t.y)}};class xce{constructor(){this.ArrayUtils=Ke}getPlayerClass(t){switch(t){case z.ZERO:return"player0-fill";case z.ONE:return"player1-fill";default:return we.expectToBe(t,pe.NONE),""}}}let Y0=(()=>{class n extends xce{constructor(e){super(),this.messageDisplayer=e,this.Player=z,this.SPACE_SIZE=100,this.STROKE_WIDTH=8,this.SMALL_STROKE_WIDTH=2,this.scores=P.empty(),this.imagesLocation="assets/images/",this.hasAsymetricBoard=!1,this.rotation=""}message(e){this.messageDisplayer.gameMessage(e)}cancelMove(e){return this.cancelMoveAttempt(),this.cancelMoveOnWrapper(e),null==e?U.SUCCESS:(this.messageDisplayer.gameMessage(e),U.failure(e))}cancelMoveAttempt(){}pass(){var e=this;return A(function*(){return bs.logError("GameComponent","pass() called on a game that does not redefine it",{gameName:e.constructor.name})})()}getTurn(){return this.rules.node.gameState.turn}getCurrentPlayer(){return this.rules.node.gameState.getCurrentPlayer()}getState(){return this.rules.node.gameState}getPreviousState(){return this.rules.node.mother.get().gameState}showLastMove(){}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),p9=(()=>{class n extends Y0{getHexaPointsAtXY(e,r){const s=new M(e,r);return this.getHexaPointsAt(s)}getHexaPointsAt(e){return this.hexaLayout.getHexaPointsAt(e)}getCenterAtXY(e,r){const s=new M(e,r);return this.getCenterAt(s)}getCenterAt(e){return this.hexaLayout.getCenterAt(e)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Ae{constructor(t){this.value=t}static from(t){switch(t){case Ae.ZERO.value:return Ae.ZERO;case Ae.ONE.value:return Ae.ONE;case Ae.EMPTY.value:return Ae.EMPTY;case Ae.UNREACHABLE.value:return Ae.UNREACHABLE;default:throw new Error("FourStatePiece has no value matching "+t)}}static ofPlayer(t){return t===z.ZERO?Ae.ZERO:(we.expectToBe(t,z.ONE),Ae.ONE)}equals(t){return this===t}is(t){return this.value===t.value}isPlayer(){return this===Ae.ZERO||this===Ae.ONE}}Ae.ZERO=new Ae(z.ZERO.value),Ae.ONE=new Ae(z.ONE.value),Ae.EMPTY=new Ae(pe.NONE.value),Ae.UNREACHABLE=new Ae(3);class ke extends fH{constructor(t,e){super(t,e)}static getAngle(t){switch(t){case ke.UP:return 0;case ke.UP_RIGHT:return 60;case ke.RIGHT:return 120;case ke.DOWN:return 180;case ke.DOWN_LEFT:return 240;default:return we.expectToBe(t,ke.LEFT),300}}getOpposite(){return ke.factory.of(-this.x,-this.y).get()}}ke.UP=new ke(0,-1),ke.LEFT=new ke(-1,0),ke.UP_RIGHT=new ke(1,-1),ke.DOWN_LEFT=new ke(-1,1),ke.RIGHT=new ke(1,0),ke.DOWN=new ke(0,1),ke.factory=new class extends hH{constructor(){super(...arguments),this.all=[ke.UP,ke.UP_RIGHT,ke.RIGHT,ke.DOWN,ke.DOWN_LEFT,ke.LEFT]}},ke.encoder=new class F3t extends Cn{maxValue(){return 5}encodeNumber(t){switch(t){case ke.UP:return 0;case ke.UP_RIGHT:return 1;case ke.RIGHT:return 2;case ke.DOWN:return 3;case ke.DOWN_LEFT:return 4;default:return 5}}decodeNumber(t){return ye(0<=t&&t<=5,"Invalid encoded number for HexaDirection "+t),ke.factory.all[t]}};class kce{}class lP extends kce{constructor(){super(),this.startAngle=.5,this.conversionMatrix=[Math.sqrt(3),Math.sqrt(3)/2,0,1.5],this.inverseConversionMatrix=[Math.sqrt(3)/3,-1/3,0,2/3]}}lP.INSTANCE=new lP;class Ns extends kce{constructor(){super(),this.startAngle=0,this.conversionMatrix=[1.5,0,Math.sqrt(3)/2,Math.sqrt(3)],this.inverseConversionMatrix=[2/3,0,-1/3,Math.sqrt(3)/3]}isOnBorder(t,e){return this.isOnTopRightBorder(t,e)||this.isOnRightBorder(t,e)||this.isOnBottomRightBorder(t,e)||this.isOnBottomLeftBorder(t,e)||this.isOnLeftBorder(t,e)||this.isOnTopLeftBorder(t,e)}isOnTopRightBorder(t,e){return 0===e.y}isOnRightBorder(t,e){return e.x===t.width-1}isOnLeftBorder(t,e){return 0===e.x}isOnBottomLeftBorder(t,e){return e.y===t.height-1}isOnTopLeftBorder(t,e){return null!=t.excludedSpaces[e.y]?e.x===t.excludedSpaces[e.y]:e.y===t.excludedSpaces.length&&0===e.x}isOnBottomRightBorder(t,e){return null!=t.excludedSpaces[t.height-1-e.y]?t.width-1-e.x===t.excludedSpaces[t.height-1-e.y]:t.height-1-e.y===t.excludedSpaces.length&&e.x===t.width-1}getAllBorders(t){const e=[];return t.forEachCoord((r,s)=>{this.isOnBorder(t,r)&&e.push(r)}),e}isTopCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnTopRightBorder(t,e)}isTopLeftCorner(t,e){return this.isOnTopLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isTopRightCorner(t,e){return this.isOnTopRightBorder(t,e)&&this.isOnRightBorder(t,e)}isBottomCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnBottomRightBorder(t,e)}isBottomLeftCorner(t,e){return this.isOnBottomLeftBorder(t,e)&&this.isOnLeftBorder(t,e)}isBottomRightCorner(t,e){return this.isOnBottomRightBorder(t,e)&&this.isOnRightBorder(t,e)}}Ns.INSTANCE=new Ns;class g9{constructor(t,e,r){this.size=t,this.origin=e,this.orientation=r}getCenterAt(t){const e=this.orientation.conversionMatrix;return new M(this.size*(e[0]*t.x+e[1]*t.y)+this.origin.x,this.size*(e[2]*t.x+e[3]*t.y)+this.origin.y)}getCornerOffset(t){const e=2*Math.PI*(this.orientation.startAngle+t)/6;return new M(this.size*Math.cos(e),this.size*Math.sin(e))}getHexaPointsListAt(t){const e=this.getCenterAt(t),r=[];for(let s=0;s<6;s+=1){const i=this.getCornerOffset(s);r.push(new M(e.x+i.x,e.y+i.y))}return r}getHexaPointsAt(t){return this.getHexaPointsListAt(t).map(r=>r.toSVGPoint()).join(" ")}getIsoPoints(t,e){we.assert(this.orientation===Ns.INSTANCE,"HexaLayout.getIsoPoints can only be used with flat orientation");const r=this.getCenterAt(t),s=this.getCornerOffset(0),i=this.getCornerOffset(1),o=this.getCornerOffset(2),c=this.getCornerOffset(3);return[[new M(r.x+c.x,r.y+c.y),new M(r.x+c.x,r.y+c.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+o.x,r.y+o.y)],[new M(r.x+s.x,r.y+s.y),new M(r.x+s.x,r.y+s.y+e),new M(r.x+i.x,r.y+i.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+o.x,r.y+o.y),new M(r.x+i.x,r.y+i.y)],[new M(r.x+c.x,r.y+c.y),new M(r.x+c.x,r.y+c.y+e),new M(r.x+o.x,r.y+o.y+e),new M(r.x+i.x,r.y+i.y+e),new M(r.x+s.x,r.y+s.y+e),new M(r.x+s.x,r.y+s.y),new M(r.x+i.x,r.y+i.y),new M(r.x+o.x,r.y+o.y)]]}}let rt=(()=>{class n{}return n.CANNOT_CHOOSE_OPPONENT_PIECE=()=>$localize`You cannot pick a piece of the opponent.`,n.MUST_CLICK_ON_EMPTY_SPACE=()=>$localize`You must click on an empty space.`,n.MUST_CLICK_ON_EMPTY_SQUARE=()=>$localize`You must click on an empty square.`,n.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE=()=>$localize`Your landing space should be empty or contain a piece of the opponent.`,n.CANNOT_SELF_CAPTURE=()=>$localize`You cannot capture your own pieces.`,n.MUST_CHOOSE_PLAYER_PIECE=()=>$localize`You must pick one of your pieces.`,n.CANNOT_PASS=()=>$localize`You cannot pass your turn.`,n.MUST_LAND_ON_EMPTY_SPACE=()=>$localize`You must drop your piece on an empty space.`,n.MUST_PASS=()=>$localize`You must pass your turn.`,n.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY=()=>$localize`You have selected an empty space, you must select one of your own pieces.`,n.MOVE_CANNOT_BE_STATIC=()=>$localize`You must choose different starting and ending coordinates.`,n.SOMETHING_IN_THE_WAY=()=>$localize`There is a piece between the piece you chose and its landing space.`,n})();class $1{constructor(t,e){this.ruler=t,this.name=e}toString(){return this.name}}class ps extends oP{constructor(t,e){super(e),this.board=t}getPieceAt(t){if(this.isOnBoard(t))return this.board[t.y][t.x];throw new Error("Accessing coord not on board "+t+".")}tryToGetPieceAt(t){return this.isOnBoard(t)?P.of(this.board[t.y][t.x]):P.empty()}isOnBoard(t){return t.isInRange(this.board[0].length,this.board.length)}getPieceAtXY(t,e){return this.getPieceAt(new M(t,e))}forEachCoord(t){for(const[e,r]of this.getCoordsAndContents())t(e,r)}getCoordsAndContents(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new M(r,e);this.isOnBoard(s)&&t.push([s,this.getPieceAt(s)])}return t}getCopiedBoard(){return Ke.copyBiArray(this.board)}toMap(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[0].length;r++){const s=new M(r,e);t.push({key:s,value:this.getPieceAt(s)})}return t}[Symbol.iterator](){const t=[];for(const e of this.board)t.push(...e);return t.values()}}class n6 extends ps{static getInitialState(){const t=Ae.EMPTY,e=Ae.UNREACHABLE,r=Ae.ZERO,s=Ae.ONE;return new n6([[e,e,e,e,s,s,s,s,s],[e,e,e,s,s,s,s,s,s],[e,e,t,t,s,s,s,t,t],[e,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,e],[t,t,r,r,r,t,t,e,e],[r,r,r,r,r,r,e,e,e],[r,r,r,r,r,e,e,e,e]],0)}isInBoard(t){return t.isInRange(9,9)&&this.getPieceAt(t)!==Ae.UNREACHABLE}isPiece(t){return this.getPieceAt(t).isPlayer()}getScores(){const t=[14,14];for(let e=0;e<9;e++)for(let r=0;r<9;r++)this.getPieceAtXY(r,e)===Ae.ZERO&&(t[1]=t[1]-1),this.getPieceAtXY(r,e)===Ae.ONE&&(t[0]=t[0]-1);return t}}class S3 extends $i{constructor(t,e){super(),this.coord=new M(t,e)}}class vi extends S3{constructor(t,e,r){if(super(t.x,t.y),this.dir=e,this.lastPiece=r,t.isNotInRange(9,9))throw new Error("Coord "+t.toString()+" out of range, invalid move!")}static fromSingleCoord(t,e){try{return $.success(new vi(t,e,P.empty()))}catch(r){return $.failure(r.message)}}static fromDoubleCoord(t,e,r){const s=[t,e];Ke.sortByDescending(s,vi.sortCoord);const i=s[1].getDirectionToward(s[0]).get(),o=ke.factory.fromDelta(i.x,i.y);if(o.isFailure())return $.failure("Invalid direction");const c=o.get();return s[1].getDistance(s[0])>2?$.failure("Distance between first coord and last coord is too great"):c.equals(r)?vi.fromSingleCoord(s[1],r):c.getOpposite().equals(r)?vi.fromSingleCoord(s[0],r):$.success(new vi(s[1],r,P.of(s[0])))}static sortCoord(t){return 9*t.y+t.x}toString(){return this.isSingleCoord()?"AbaloneMove("+this.coord.x+", "+this.coord.y+", "+this.dir.toString()+")":"AbaloneMove("+this.coord.toString()+" > "+this.lastPiece.get().toString()+", "+this.dir.toString()+")"}isSingleCoord(){return this.lastPiece.isAbsent()}equals(t){return t.coord.equals(this.coord)&&t.dir.equals(this.dir)&&t.lastPiece.equals(this.lastPiece)}}vi.encoder=new class extends Cn{maxValue(){return 104831}encodeNumber(n){const t=9*n.coord.x*8+8*n.coord.y+n.dir.toInt();if(n.isSingleCoord())return t;{const e=n.lastPiece.get();return 9*e.x*2*9*9*8+2*e.y*9*9*8+648+t}}decodeNumber(n){const t=n%8;n=(n-t)/8;const r=ke.factory.fromInt(t).get(),s=n%9,i=(n=(n-s)/9)%9;n=(n-i)/9;const o=new M(i,s);if(0===n)return vi.fromSingleCoord(o,r).get();{const c=(n=(n-1)/2)%9,u=(n=(n-c)/9)%9;n=(n-u)/9;const h=new M(u,c);return vi.fromDoubleCoord(o,h,r).get()}}};let K0=(()=>{class n{}return n.CANNOT_MOVE_MORE_THAN_THREE_PIECES=()=>$localize`You cannot move more than 3 of your pieces!`,n.NOT_ENOUGH_PIECE_TO_PUSH=()=>$localize`You don't have enough pieces to push that group!`,n.CANNOT_PUSH_YOUR_OWN_PIECES=()=>$localize`You cannot push this piece because it is blocked by one of yours!`,n.MUST_ONLY_TRANSLATE_YOUR_PIECES=()=>$localize`This line contains pieces of your opponent or empty spaces, which is forbidden.`,n.TRANSLATION_IMPOSSIBLE=()=>$localize`This move is impossible, some landing spaces are occupied.`,n.LINE_AND_COORD_NOT_ALIGNED=()=>$localize`This space is not aligned with the current line.`,n})();class P3 extends Z1{static isLegal(t,e){const r=this.getFirstPieceValidity(t,e);return r.isFailure()?r.toFailedFallible():t.isSingleCoord()?P3.isLegalPush(t,e):P3.isLegalSideStep(t,e)}static getFirstPieceValidity(t,e){const r=e.getPieceAt(t.coord);return!1===e.isPiece(t.coord)?U.failure(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r===Ae.ofPlayer(e.getCurrentOpponent())?U.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):U.SUCCESS}static isLegalPush(t,e){let r=1,s=t.coord.getNext(t.dir);const i=Ae.ofPlayer(e.getCurrentPlayer()),o=Ae.EMPTY,c=e.getCopiedBoard();for(c[t.coord.y][t.coord.x]=o;r<=3&&e.isOnBoard(s)&&e.getPieceAt(s)===i;)r++,s=s.getNext(t.dir);return r>3?$.failure(K0.CANNOT_MOVE_MORE_THAN_THREE_PIECES()):!1===e.isInBoard(s)||(c[s.y][s.x]=i,e.getPieceAt(s)===o)?$.success(c):P3.isLegalRealPush(s,t,e,r,c)}static isLegalRealPush(t,e,r,s,i){let o=0;const c=Ae.ofPlayer(r.getCurrentOpponent()),u=Ae.ofPlayer(r.getCurrentPlayer());for(;o<s&&r.isOnBoard(t)&&r.getPieceAt(t)===c;)o++,t=t.getNext(e.dir);return o>=s?$.failure(K0.NOT_ENOUGH_PIECE_TO_PUSH()):t.isInRange(9,9)&&(r.getPieceAt(t)===Ae.EMPTY&&(i[t.y][t.x]=c),r.getPieceAt(t)===u)?$.failure(K0.CANNOT_PUSH_YOUR_OWN_PIECES()):$.success(i)}static isLegalSideStep(t,e){let r=t.lastPiece.get();const s=t.coord.getDirectionToward(r).get();r=r.getNext(s);let i=t.coord;const o=Ae.ofPlayer(e.getCurrentPlayer()),c=e.getCopiedBoard();for(;!1===i.equals(r)&&i.isInRange(9,9);){if(e.getPieceAt(i)!==o)return $.failure(K0.MUST_ONLY_TRANSLATE_YOUR_PIECES());const u=i.getNext(t.dir);if(c[i.y][i.x]=Ae.EMPTY,u.isInRange(9,9)){if(e.isPiece(u))return $.failure(K0.TRANSLATION_IMPOSSIBLE());e.getPieceAt(u)===Ae.EMPTY&&(c[u.y][u.x]=o)}i=i.getNext(s)}return $.success(c)}static getGameStatus(t){const e=t.gameState.getScores();return e[0]>5?xe.ZERO_WON:e[1]>5?xe.ONE_WON:xe.ONGOING}applyLegalMove(t,e,r){return new n6(r,e.turn+1)}isLegal(t,e){return P3.isLegal(t,e)}getGameStatus(t){return P3.getGameStatus(t)}}class $3t extends $1{getListMoves(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<9;i++)for(let o=0;o<9;o++){const c=new M(o,i);if(!1!==r.getPieceAt(c).is(s))for(const u of ke.factory.all){const h=vi.fromSingleCoord(c,u).get();if(this.isAcceptablePush(h,r)){e.push(h);for(const p of ke.factory.all)for(let m=1;m<=2&&!p.equals(u);m++){const C=c.getNext(p,m);if(!C.isInRange(9,9))break;{const w=vi.fromDoubleCoord(c,C,u).get();P3.isLegal(w,r).isSuccess()&&e.push(w)}}}}}return new Ht(e).toList()}isAcceptablePush(t,e){const r=e.getScores(),s=P3.isLegal(t,e);if(s.isSuccess()){const i=e.getCurrentOpponent().value;return!(new n6(s.get(),e.turn+1).getScores()[i]>r[i])}return!1}getBoardValue(t){const e=P3.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState.getScores();return new Ct(r[1]-r[0])}}const bn=Ae.EMPTY,Ys=Ae.UNREACHABLE,bc=Ae.ZERO,m9=Ae.ONE;class Lce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board and goal of the game`,$localize`At Abalone, the goal of the game is to be the first player to push 6 opponent's pieces out of the board. Let us see how!`,n6.getInitialState()),ce.anyMove($localize`Moving a piece`,$localize`At each turn, move one, two, or three pieces either along their line, or on their side.
        For your moves you can therefore choose between up to 6 directions.
        The pieces you move must be aligned and consecutive, and the move should land on an empty space (except to push, we will see that later).
        To make a move, click on one of your pieces, then click on an arrow to choose the move direction.<br/><br/>
        You're playing Dark, make any move!`,n6.getInitialState(),vi.fromSingleCoord(new M(2,6),ke.UP).get(),$localize`Congratulations!`),ce.fromMove($localize`Pushing`,$localize`To push one opponent piece, you must move at least two of your pieces.
        To push two opponent pieces, you must move three of your pieces.
        If one of your pieces is in the way, it will be impossible to push.
        You cannot move more than three pieces.<br/><br/>
        Only one push towards the right is possible here, find it. (You're playing Dark).`,new n6([[Ys,Ys,Ys,Ys,bn,bc,bc,m9,m9],[Ys,Ys,Ys,bn,bn,bn,bn,bn,bn],[Ys,Ys,bn,bc,bc,bc,m9,bc,bn],[Ys,bn,bn,bn,bn,bn,bn,bn,bn],[bn,bn,bn,bn,bc,bc,bc,m9,m9],[bn,bn,bn,bn,bn,bn,bn,bn,Ys],[bn,bn,bn,bn,bc,m9,bn,Ys,Ys],[bn,bn,bn,bc,bn,bn,Ys,Ys,Ys],[bn,bn,bc,bn,bn,Ys,Ys,Ys,Ys]],0),[vi.fromSingleCoord(new M(4,4),ke.RIGHT).get()],$localize`Congratulations! You know everything you need to start a game!`,$localize`Failed. Try again.`)]}}function U3t(n,t){if(1&n){const e=Oe();B(),b(0,"circle",6),J("click",function(){fe(e);const s=v(2).index,i=v().index;return ae(v().onPieceClick(s,i))}),O()}if(2&n){const e=v(2).index,r=v().index,s=v();We("id","piece_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("cx",s.getCenterAtXY(e,r).x)("cy",s.getCenterAtXY(e,r).y)("r",.5*s.SPACE_SIZE)}}function G3t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"polygon",4),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onSpaceClick(s,i))}),O(),x(2,U3t,1,6,"circle",5),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();S(1),We("id","space_",r,"_",i,""),T("ngClass",o.getSquareClasses(r,i)),D("points",o.getHexaPointsAtXY(r,i)),S(1),T("ngIf",o.isPiece(s))}}function W3t(n,t){if(1&n&&(B(),b(0,"g"),x(1,G3t,3,5,"g",3),O()),2&n){const e=t.$implicit,r=v(2);S(1),T("ngIf",r.isBoard(e))}}function q3t(n,t){if(1&n&&(B(),b(0,"g"),x(1,W3t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function j3t(n,t){1&n&&(B(),b(0,"marker",7),X(1,"polygon",8),O()),2&n&&C1("id","arrowhead_",t.$implicit.dir.toString(),"")}function Z3t(n,t){if(1&n){const e=Oe();B(),b(0,"g"),X(1,"line",9),b(2,"line",10),J("click",function(){const i=fe(e).$implicit;return ae(v().chooseDirection(i.dir))}),O(),b(3,"polygon",11),J("click",function(){const i=fe(e).$implicit;return ae(v().chooseDirection(i.dir))}),O()()}if(2&n){const e=t.$implicit;S(1),C1("id","line_start_",e.dir.toString(),""),D("x1",e.startCenter.x)("y1",e.startCenter.y)("x2",e.middle.x)("y2",e.middle.y),S(1),C1("id","line_end_",e.dir.toString(),""),D("x1",e.middle.x)("y1",e.middle.y)("x2",e.landingCenter.x)("y2",e.landingCenter.y),S(1),C1("id","direction_",e.dir.toString(),""),D("transform",e.transformation)}}class Y3t{constructor(t,e,r,s,i,o){this.startCenter=t,this.middle=e,this.landingCenter=r,this.landing=s,this.dir=i,this.transformation=o}}let K3t=(()=>{class n extends p9{constructor(e){super(e),this.moveds=[],this.directions=[],this.selecteds=[],this.rules=new P3(n6),this.availableMinimaxes=[new $3t(this.rules,"Dummy")],this.encoder=vi.encoder,this.tutorial=(new Lce).tutorial,this.scores=P.of([0,0]),this.SPACE_SIZE=30,this.hexaLayout=new g9(this.SPACE_SIZE,new M(-8*this.SPACE_SIZE,2*this.SPACE_SIZE),lP.INSTANCE),this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.hexaBoard=this.getState().getCopiedBoard(),this.scores=P.of(this.getState().getScores())}hidePreviousMove(){this.moveds=[]}cancelMoveAttempt(){this.directions=[],this.selecteds=[]}showPreviousMove(){const e=this.rules.node.move.get();e.isSingleCoord()?this.showPushingMove(e):this.showSideStepMove(e)}showPushingMove(e){const r=this.rules.node.mother.get().gameState;let s=e.coord;for(this.moveds=[s],s=s.getNext(e.dir);s.isInRange(9,9)&&r.isPiece(s);)this.moveds.push(s),s=s.getNext(e.dir);s.isInRange(9,9)&&this.moveds.push(s)}showSideStepMove(e){let r=e.lastPiece.get();const s=e.coord.getDirectionToward(r).get();r=r.getNext(s);let i=e.coord;for(;!1===i.equals(r);)this.moveds.push(i),this.moveds.push(i.getNext(e.dir)),i=i.getNext(s)}onPieceClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#piece_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentOpponent();return s.hexaBoard[r][e].is(o)?s.opponentClick(e,r):0===s.selecteds.length?s.firstClick(e,r):1===s.selecteds.length?s.secondClick(e,r):s.thirdClick(e,r)})()}opponentClick(e,r){var s=this;return A(function*(){return(yield s.tryChoosingDirection(e,r)).isSuccess()?U.SUCCESS:s.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE())})()}firstClick(e,r){var s=this;return A(function*(){return s.selecteds=[new M(e,r)],s.showPossibleDirections(),U.SUCCESS})()}showPossibleDirections(){this.directions=[],this.showDirection(1===this.selecteds.length)}showDirection(e){const r=this.getState(),s=Ae.ofPlayer(r.getCurrentPlayer()),i=this.selecteds[0],o=this.selecteds[this.selecteds.length-1];for(const c of ke.factory.all){let h,u=i.getNext(c,1);if(r.isOnBoard(u)&&r.getPieceAt(u)===s){if(e)continue;if(u=o.getNext(c,1),r.isOnBoard(u)&&r.getPieceAt(u)===s)continue}if(h=e?vi.fromSingleCoord(i,c).get():vi.fromDoubleCoord(i,o,c).get(),this.rules.isLegal(h,r).isSuccess()){const m=this.getCenterAt(i),C=this.getCenterAt(u),w=this.getMiddleOfArrow(c,u,C),I=C.x+" "+C.y,H=ke.getAngle(c)+150,te=new Y3t(m,w,C,u,c,"rotate("+H+" "+I+") translate("+I+")");this.directions.push(te)}}}getMiddleOfArrow(e,r,s){const i=r.getPrevious(e),o=this.getCenterAt(i);return new M(o.x+(s.x-o.x)/2,o.y+(s.y-o.y)/2)}isBoard(e){return e!==Ae.UNREACHABLE}isPiece(e){return e!==Ae.EMPTY}secondClick(e,r){var s=this;return A(function*(){const i=s.selecteds[0],o=new M(e,r);if(o.equals(i))return s.cancelMoveAttempt(),U.SUCCESS;if(!1===o.isHexagonallyAlignedWith(i))return s.cancelMoveAttempt(),s.firstClick(e,r);const c=o.getDistance(i);if(c>2)return s.cancelMove(K0.CANNOT_MOVE_MORE_THAN_THREE_PIECES());const u=i.getDirectionToward(o).get();s.selecteds=[i];for(let h=0;h<c;h++)s.selecteds.push(i.getNext(u,h+1));if(3===s.selecteds.length){const h=s.selecteds[1],p=s.getState().getCurrentPlayer();if(!1===s.hexaBoard[h.y][h.x].is(p))return s.cancelMoveAttempt(),s.firstClick(e,r)}return s.showPossibleDirections(),U.SUCCESS})()}thirdClick(e,r){var s=this;return A(function*(){const i=new M(e,r),o=s.selecteds[0];if(i.equals(o))return s.deselectExtremity(!0);const c=s.selecteds[s.selecteds.length-1];return i.equals(c)?s.deselectExtremity(!1):3===s.selecteds.length&&i.equals(s.selecteds[1])?(s.cancelMoveAttempt(),U.SUCCESS):s.tryExtension(i,o,c)})()}tryExtension(e,r,s){var i=this;return A(function*(){const o=be.factory.fromMove(r,e);if(o.isSuccess()){const u=be.factory.fromMove(s,e);if(o.equals(u)){const h=r.getDistance(e),p=s.getDistance(e);return 2===Math.max(h,p)?(i.selecteds.push(e),Ke.sortByDescending(i.selecteds,vi.sortCoord),i.showPossibleDirections(),U.SUCCESS):i.cancelMove(K0.CANNOT_MOVE_MORE_THAN_THREE_PIECES())}}const c=i.cancelMove(K0.LINE_AND_COORD_NOT_ALIGNED());return yield i.firstClick(e.x,e.y),c})()}deselectExtremity(e){var r=this;return A(function*(){return r.selecteds=r.selecteds.slice(e?1:0,e?void 0:-1),r.showPossibleDirections(),U.SUCCESS})()}chooseDirection(e){var r=this;return A(function*(){const s=r.canUserPlay("#direction_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):r._chooseDirection(e)})()}_chooseDirection(e){var r=this;return A(function*(){const s=r.getState();let i;const o=r.selecteds[0];return i=1===r.selecteds.length?vi.fromSingleCoord(o,e).get():vi.fromDoubleCoord(o,r.selecteds[r.selecteds.length-1],e).get(),r.chooseMove(i,s,r.scores.get())})()}onSpaceClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#space_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.tryChoosingDirection(e,r)})()}tryChoosingDirection(e,r){var s=this;return A(function*(){const i=new M(e,r);for(const o of s.directions)if(o.landing.equals(i))return s._chooseDirection(o.dir);return U.failure("not a direction")})()}getSquareClasses(e,r){const s=new M(e,r),i=[];return this.moveds.some(o=>o.equals(s))&&i.push("moved-fill"),i}getPieceClasses(e,r){const s=new M(e,r),i=z.of(this.hexaBoard[r][e].value),o=[this.getPlayerClass(i)];return this.selecteds.some(c=>c.equals(s))&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-abalone"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-165 0 470 500","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id",4,"ngFor","ngForOf"],[4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass","click"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base",3,"id","ngClass","click"],["markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto",3,"id"],["points","0 0, 10 3.5, 0 7"],[1,"arrow",3,"id"],[1,"arrow",3,"id","click"],["points","-10 -5, 10 -5, 0 15, -10 -5",1,"arrow",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,q3t,2,1,"g",1),b(2,"defs"),x(3,j3t,2,1,"marker",2),O(),x(4,Z3t,4,12,"g",1),O()),2&e&&(S(1),T("ngForOf",r.hexaBoard),S(2),T("ngForOf",r.directions),S(1),T("ngForOf",r.directions))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class X3t extends $1{getListMoves(t){const e=t.gameState;return F1.ALL_MOVES.filter(function r(s){return N4.get().isLegal(s,e).isSuccess()})}getBoardValue(t){const e=N4.get().getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const r=t.gameState.board[3].getDominatingPlayer();return r.isPlayer()?new Ct(r.getScoreModifier()):new Ct(0)}}function Q3t(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=t.$implicit,r=v();D("cx",r.getRemainingPieceCx(e))("cy",r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function J3t(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=t.$implicit,r=v();D("cx",r.BOARD_WIDTH-r.getRemainingPieceCx(e))("cy",r.BOARD_HEIGHT-r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function e4t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",9),J("click",function(){fe(e);const s=v().index,i=v();return ae(i.onArrowClick(s,i.PlayerOrNone.ZERO))}),O()}if(2&n){const e=v().index,r=v();C1("id","dropArrow_zero_",e,""),T("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ZERO)),D("points",r.ARROW_COORD)("transform","translate("+r.SPACE_SIZE/2+" "+-r.SPACE_SIZE/2+")")}}function t4t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",9),J("click",function(){fe(e);const s=v().index,i=v();return ae(i.onArrowClick(s,i.PlayerOrNone.ONE))}),O()}if(2&n){const e=v().index,r=v();C1("id","dropArrow_one_",e,""),T("ngClass",r.getArrowClasses(e,r.PlayerOrNone.ONE)),D("points",r.ARROW_COORD)("transform","translate(0 "+-r.SPACE_SIZE/2+")")}}function n4t(n,t){if(1&n){const e=Oe();B(),ln(0),b(1,"circle",10),J("click",function(){fe(e);const s=v().index;return ae(v().onSquareClick(s))}),O(),un()}if(2&n){const e=t.$implicit,r=v(),s=r.index,i=r.$implicit,o=v();S(1),G2("id","square_",s,"_piece_",e,"_out_of_",i.count(o.PlayerOrNone.NONE),""),T("ngClass",o.getPieceClasses(s,e,i)),D("cx",o.getCircleCenter(s,e,i).x)("cy",o.getCircleCenter(s,e,i).y)}}function r4t(n,t){if(1&n){const e=Oe();B(),b(0,"g"),x(1,e4t,1,4,"polygon",7),x(2,t4t,1,4,"polygon",7),b(3,"rect",8),J("click",function(){const i=fe(e).index;return ae(v().onSquareClick(i))}),O(),x(4,n4t,2,6,"ng-container",4),O()}if(2&n){const e=t.$implicit,r=t.index,s=v();D("transform",s.getBlockTransform(r)),S(1),T("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ZERO)),S(1),T("ngIf",s.canDisplayArrow(r,s.PlayerOrNone.ONE)),S(1),C1("id","square_",r,""),T("ngClass",s.getSquareClasses(r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngForOf",s.ArrayUtils.range(e.count(s.PlayerOrNone.NONE)))}}let s4t=(()=>{class n extends Y0{constructor(e){super(e),this.PlayerOrNone=pe,this.BOARD_WIDTH=4*this.SPACE_SIZE,this.BOARD_HEIGHT=4.5*this.SPACE_SIZE,this.ARROW_COORD=n.getArrowCoord(),this.PIECES_PER_PLAYER=Z0.PIECES_PER_PLAYER,this.selectedPiece=P.empty(),this.leftPiece=P.empty(),this.droppedPiece=P.empty(),this.displayableArrow=[],this.rules=N4.get(),this.hasAsymetricBoard=!0,this.availableMinimaxes=[new X3t(this.rules,"ApagosDummyMinimax")],this.encoder=F1.encoder,this.tutorial=(new Ace).tutorial,this.PIECE_RADIUS=2*this.SPACE_SIZE/(this.PIECES_PER_PLAYER+.5),this.updateBoard()}static getArrowCoord(){return"12.5,0 37.5,0 37.5,25 50,25 25,50 0,25 12.5,25"}cancelMoveAttempt(){this.selectedPiece=P.empty(),this.showPossibleDrops()}updateBoard(){const e=this.getState();this.board=e.board,this.remainingZero=e.remaining.get(z.ZERO).get(),this.remainingOne=e.remaining.get(z.ONE).get(),this.hideLastMove(),this.rules.node.move.isPresent()&&this.showLastMove(),this.showPossibleDrops()}hideLastMove(){this.movedSquare=[],this.droppedPiece=P.empty(),this.leftPiece=P.empty(),this.selectedPiece=P.empty()}showLastMove(){const e=this.rules.node.move.get();e.isDrop()?this.showLastDrop(e):this.showLastTransfer(e)}showLastDrop(e){const r=e.piece.get();let s=e.landing.x;this.movedSquare=[s],3!==e.landing.x&&(s+=1,this.movedSquare.push(s));const o=this.getLowestPlayerPiece(this.board[s],r);this.droppedPiece=P.of({square:s,piece:o})}getLowestPlayerPiece(e,r){const s=e.count(r);return r===z.ZERO?s-1:e.count(pe.NONE)-s}showLastTransfer(e){const r=this.rules.node.mother.get().gameState,s=r.getCurrentPlayer(),i=e.starting.get().x,c=this.getLowestPlayerPiece(r.board[i],s);this.leftPiece=P.of({square:i,piece:c});const u=e.landing.x,p=this.getLowestPlayerPiece(this.board[u],s);this.droppedPiece=P.of({square:u,piece:p})}showPossibleDrops(){this.displayableArrow=[];const e=this.getState();for(let r=0;r<4;r++)!1===e.board[r].isFull()&&(e.remaining.get(z.ZERO).get()>0&&this.displayableArrow.push({x:r,player:z.ZERO}),e.remaining.get(z.ONE).get()>0&&this.displayableArrow.push({x:r,player:z.ONE}))}getCircleCenter(e,r,s){const i=this.SPACE_SIZE/2,o=this.SPACE_SIZE/2;if(1===s.count(pe.NONE))return new M(i,o);const c=s.count(pe.NONE),u=2*r*Math.PI/c-Math.PI/2,h=.3*this.SPACE_SIZE,p=h*Math.cos(u),m=h*Math.sin(u);return new M(i+p,o+m)}canDisplayArrow(e,r){return this.displayableArrow.some(s=>s.x===e&&s.player.equals(r))}getArrowClasses(e,r){return[this.getPlayerClass(r)]}getBlockTransform(e){return"translate("+e*this.SPACE_SIZE+", "+((3-e)*this.SPACE_SIZE+.5*this.SPACE_SIZE)+")"}getSquareClasses(e){const r=["base"];return this.selectedPiece.isPresent()&&this.selectedPiece.get().square===e?r.push("selected-stroke"):this.movedSquare.includes(e)&&r.push("last-move-stroke"),r}onArrowClick(e,r){var s=this;return A(function*(){const o=s.canUserPlay("#dropArrow_"+(r===z.ZERO?"zero":"one")+"_"+e);if(o.isFailure())return s.cancelMove(o.getReason());const c=wn.from(e);let u;if(s.selectedPiece.isPresent()){const p=s.selectedPiece.get().square;u=F1.transfer(wn.from(p),c).get()}else u=F1.drop(c,r);const h=s.getState();return s.chooseMove(u,h)})()}getPieceClasses(e,r,s){const i={square:e,piece:r},o=[];let c=s.count(z.ZERO),u=s.count(z.ONE);if(this.selectedPiece.equalsValue(i))o.push("selected-stroke");else if(this.droppedPiece.equalsValue(i))o.push("last-move-stroke");else if(this.leftPiece.isPresent()&&this.leftPiece.get().square===e){if(this.leftPiece.get().piece===r)return o.push("captured-stroke"),o;this.getState().getCurrentOpponent()===z.ZERO?c++:u++}const h=s.count(pe.NONE)-(u+c),p=this.getPieceColor(r,c,h);return""!==p&&o.push(p),o}getPieceColor(e,r,s){return e<r?"player0-fill":e>=r+s?"player1-fill":""}onSquareClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#square_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.selectedPiece.isPresent()&&r.selectedPiece.get().square===e)return r.cancelMoveAttempt(),U.SUCCESS;const i=r.getState().getCurrentPlayer(),o=r.board[e];return o.count(i)<=0?r.cancelMove(d9.NO_PIECE_OF_YOU_IN_CHOSEN_SQUARE()):(r.selectedPiece=P.of({square:e,piece:r.getLowestPlayerPiece(o,i)}),0===r.showAndGetPossibleTranfers().length?r.cancelMove(d9.NO_POSSIBLE_TRANSFER_REMAINS()):U.SUCCESS)})()}showAndGetPossibleTranfers(){this.displayableArrow=[];let e=this.selectedPiece.get().square-1;const r=this.getState().getCurrentPlayer();for(;0<=e;)!1===this.board[e].isFull()&&this.displayableArrow.push({x:e,player:r}),e--;return this.displayableArrow}getRemainingPieceCx(e){return(e+.5)*this.PIECE_RADIUS*1.5}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-apagos"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base mid-stroke player1-fill",4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",4,"ngFor","ngForOf"],["id","board"],[4,"ngFor","ngForOf"],[1,"base","mid-stroke","player1-fill"],[1,"base","mid-stroke","player0-fill"],["class","base mid-stroke",3,"id","ngClass","click",4,"ngIf"],["x","0","y","0",1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke",3,"id","ngClass","click"],["r","10",1,"base","mid-stroke",3,"id","ngClass","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g"),x(2,Q3t,1,3,"circle",1),x(3,J3t,1,3,"circle",2),O(),b(4,"g",3),x(5,r4t,5,8,"g",4),O()()),2&e&&(D("viewBox",-r.STROKE_WIDTH/2+" "+-r.STROKE_WIDTH/2+" "+(r.BOARD_WIDTH+r.STROKE_WIDTH)+" "+(r.BOARD_HEIGHT+r.STROKE_WIDTH)),S(1),D("transform","rotate("+180*r.role.value+" "+r.BOARD_WIDTH/2+" "+r.BOARD_HEIGHT/2+")"),S(1),T("ngForOf",r.ArrayUtils.range(r.remainingOne)),S(1),T("ngForOf",r.ArrayUtils.range(r.remainingZero)),S(2),T("ngForOf",r.board))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),No=(()=>{class n extends Y0{getViewBox(){return-.5*this.STROKE_WIDTH+" "+-.5*this.STROKE_WIDTH+" "+(this.board.length*this.SPACE_SIZE+this.STROKE_WIDTH)+" "+(this.board[0].length*this.SPACE_SIZE+this.STROKE_WIDTH)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();class Q2 extends ps{constructor(t,e,r){super(t,e),this.captured=r}static getInitialState(){const t=Ke.createTable(6,2,4);return new Q2(t,0,[0,0])}getCapturedCopy(){return[this.captured[0],this.captured[1]]}}let pH=(()=>{class n{}return n.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME=()=>$localize`You cannot distribute from the opponent's home.`,n.MUST_CHOOSE_NON_EMPTY_HOUSE=()=>$localize`You should choose a non-empty house to distribute.`,n.SHOULD_DISTRIBUTE=()=>$localize`You should distribute but you do not.`,n})(),A4=(()=>{class n extends Z1{applyLegalMove(e,r,s){K(n.VERBOSE,{called:"AwaleRules.applyLegalMove",move:e,state:r});const i=e.x,o=r.getCurrentPlayer(),u=r.getCurrentOpponent().value,h=r.getCopiedBoard(),p=n.distribute(i,u,h),m=p[p.length-1];return m.y===u?new Q2(h,r.turn+1,r.captured):this.applyPotentialCapture(o,m,h,r)}applyPotentialCapture(e,r,s,i){const o=i.getCurrentOpponent(),c=[i.captured[0],i.captured[1]],u=n.captureIfLegal(r.x,r.y,e,s);c[e.value]+=u.capturedSum;const h=u.resultingBoard;if(n.mustMansoon(e,h)){const p=n.mansoon(o,h);return c[o.value]+=p.capturedSum,new Q2(p.resultingBoard,i.turn+1,c)}return new Q2(h,i.turn+1,c)}static mustMansoon(e,r){return n.isStarving(e,r)&&!1===n.canDistribute(e.getOpponent(),r)}static mansoon(e,r){const s=Ke.copyBiArray(r);let i=0;const o=[[0,0,0,0,0,0],[0,0,0,0,0,0]];let c=0;const u=e.getOpponent().value;do{i+=s[u][c],o[u][c]=s[u][c],s[u][c]=0,c++}while(c<6);return{capturedSum:i,captureMap:o,resultingBoard:s}}static isLegal(e,r){const s=r.getCurrentOpponent(),i=s.value,o=e.x;if(0===r.getPieceAtXY(o,i))return $.failure(pH.MUST_CHOOSE_NON_EMPTY_HOUSE());const c=n.isStarving(s,r.board),u=!1===n.doesDistribute(o,i,r.board);return c&&u?$.failure(pH.SHOULD_DISTRIBUTE()):$.success(void 0)}isLegal(e,r){return n.isLegal(e,r)}static doesDistribute(e,r,s){return 0===r?s[r][e]>5-e:s[r][e]>e}static canDistribute(e,r){for(let s=0;s<6;s++)if(n.doesDistribute(s,e.getOpponent().value,r))return!0;return!1}static isStarving(e,r){let s=0;const i=e.getOpponent().value;do{if(r[i][s++]>0)return!1}while(s<6);return!0}static distribute(e,r,s){const i=e,o=r;let c=s[r][e];const u=[];for(s[r][e]=0;c>0;)0===r?5===e?r=1:e++:0===e?r=0:e--,(e!==i||r!==o)&&(s[r][e]+=1,u.push(new M(e,r)),c--);return u}static capture(e,r,s,i){const o=Ke.copyBiArray(i);ye(r!==s.getOpponent().value,"AwaleRules.capture cannot capture the players house");let u=o[r][e],h=0;const p=[[0,0,0,0,0,0],[0,0,0,0,0,0]];if(u<2||u>3)return{capturedSum:0,captureMap:p,resultingBoard:o};let m=-1,C=-1;s===z.ONE&&(m=1,C=6);do{p[r][e]=u,h+=u,o[r][e]=0,u=o[r][e+=m]}while(e!==C&&(2===u||3===u));return{capturedSum:h,captureMap:p,resultingBoard:o}}static captureIfLegal(e,r,s,i){const o=Ke.copyBiArray(i),c=n.capture(e,r,s,i),u=n.isStarving(s.getOpponent(),c.resultingBoard);return c.capturedSum>0&&u?{capturedSum:0,resultingBoard:o,captureMap:[[0,0,0,0,0,0],[0,0,0,0,0,0]]}:c}static getGameStatus(e){const r=e.gameState;return r.captured[0]>24?xe.ZERO_WON:r.captured[1]>24?xe.ONE_WON:24===r.captured[0]&&24===r.captured[1]?xe.DRAW:xe.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class _1 extends $i{constructor(t){super(),this.x=t}static from(t){switch(t){case 0:return _1.ZERO;case 1:return _1.ONE;case 2:return _1.TWO;case 3:return _1.THREE;case 4:return _1.FOUR;default:return ye(5===t,"Invalid x for AwaleMove: "+t),_1.FIVE}}equals(t){return t===this||t.x===this.x}toString(){return"AwaleMove("+this.x+")"}}_1.ZERO=new _1(0),_1.ONE=new _1(1),_1.TWO=new _1(2),_1.THREE=new _1(3),_1.FOUR=new _1(4),_1.FIVE=new _1(5),_1.encoder=new class extends Cn{maxValue(){return 5}encodeNumber(n){return n.x}decodeNumber(n){return _1.from(n)}};class i4t extends $1{getListMoves(t){const e=[],r=t.gameState,i=(r.turn+1)%2;let o,c=0;do{0!==r.getPieceAtXY(c,i)&&(o=_1.from(c),A4.isLegal(o,r).isSuccess()&&(o=_1.from(c),e.push(o))),c++}while(c<6);return this.orderMoves(t,e)}orderMoves(t,e){const r=t.gameState.getCurrentPlayer(),s=t.gameState.getCurrentOpponent().value,i=r.value;return Ke.sortByDescending(e,o=>{const c=t.gameState.getCopiedBoard(),u=c[s][o.x],h=A4.distribute(o.x,s,c),p=h[h.length-1];let m,C=0;return p.y===s?(m=0,u<=6&&(C=10)):m=A4.captureIfLegal(p.x,i,r,c).capturedSum,100*m+C-u}),e}getBoardValue(t){const e=A4.getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const s=t.gameState.getCapturedCopy();return new Ct(s[1]-s[0])}}class Rce extends rr{constructor(){super(...arguments),this.tutorial=[ce.anyMove($localize`Sowing`,$localize`Awalé is a game of distribution (sowing) and capture. Its goal is to capture the most seeds.
         Let's see how seeds are sown. The spaces in Awalé are called the houses.
         As you're playing Dark, the 6 houses on the bottom are yours.<br/><br>
         Click on any of the bottom houses to sow the seeds it contains: they will be sown clockwise, one seed per house.`,Q2.getInitialState(),_1.ZERO,$localize`Look at the 4 houses that follow clockwise the one you picked, they now contain 5 seeds.
        This is how seeds are sown:
        one by one from the house next to the one they come from, clockwise.`),ce.anyMove($localize`Big sowing`,$localize`When there are enough seeds to make a full turn, something else happens.<br/><br/>
        You're playing Dark.
        Sow the house that contains 12 seeds.`,new Q2([[0,0,0,0,0,0],[0,12,0,0,0,0]],0,[0,0]),_1.ONE,$localize`See, the house that you sowed has not been refilled, and the sowing immediately continued to the next house (which therefore contains two seeds).`),ce.fromMove($localize`Simple capture`,$localize`After sowing, if the last seed falls in an opponent's house and if there is now two or three seeds in this house, the player captures these two or three seeds.<br/><br/>You're playing Dark, do a capture!`,new Q2([[0,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Well done! This was a simple capture, now let us see how to make multiple captures.`,$localize`Failed. Try again and sow from the leftmost house.`),ce.fromMove($localize`Multiple captures`,$localize`By sowing from your leftmost house, you will end in the opponent's second leftmost house, which contains now 3, so this will be a capture. But now, the house right before it contains 2, which is also capturable, so, that house will get captured as well!<br/><br/>You're playing Dark, do a capture!`,new Q2([[2,1,0,0,1,0],[2,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Nice, you win 3 points from the first house, and 2 from the second!`,$localize`Failed. Try again.`),ce.fromMove($localize`Interrupted capture`,$localize`By clicking on your leftmost house, you end up on the 3rd house, which is capturable.<br/><br/>You're playing Dark, do a capture!`,new Q2([[1,0,1,0,0,1],[3,0,0,0,1,0]],0,[0,0]),[_1.ZERO],$localize`Notice that because the second house was not capturable, the capture was interrupted and you have not captured the first house.`,$localize`Failed. Try again.`),ce.fromMove($localize`Capture on the other side only`,$localize`You're playing Dark. Try to capture the two leftmost houses of the opponent.`,new Q2([[2,2,0,0,1,0],[1,3,0,0,0,0]],0,[0,0]),[_1.ONE],$localize`Congratulations! Notice that the capture was interrupted when entering your territory: you cannot capture your own houses!`,$localize`You have only captured one house, try again!`),ce.fromMove($localize`Do not starve`,$localize`You have a very nice capture that seems possible: it seems that you can capture all the opponent's seeds!<br/><br/>
        You're playing Dark. Try it.`,new Q2([[1,1,1,1,1,0],[5,0,0,1,0,0]],0,[0,0]),[_1.ZERO],$localize`Sadly, you cannot capture here, otherwise the opponent could not play after you.
        When this happens, the move can be made, but no capture takes place!`,$localize`Failed. Try again.`),ce.anyMove($localize`Feeding is mandatory`,$localize`You cannot let another player starve, meaning that if your opponent has no seeds anymore and if you can give them at least one, you have to do it.<br/><br/>You're playing Dark. Give a seed to your opponent!`,new Q2([[0,0,0,0,0,0],[0,1,2,4,4,5]],0,[0,0]),_1.THREE,$localize`Congratulations! Note that you can choose to give your opponent the least number of seeds if it is better for you.
        It is often a good way to have easy captures!`),ce.anyMove($localize`End of the game`,$localize`A game is won as soon as one player has captured 25 seeds, as that player has more than half of all the seeds.<br/><br/>You're playing Dark, sow the leftmost house.`,new Q2([[4,4,3,2,1,0],[1,0,0,0,0,0]],0,[0,0]),_1.ZERO,$localize`Also, as soon as on player cannot play, the other player captures all the seeds in its own side.
         Here, it was the first player's turn, and the second player has taken all the remaining seeds.`)]}}function o4t(n,t){if(1&n){const e=Oe();B(),b(0,"text",7),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onClick(s,i))}),Pt(1),O()}if(2&n){const e=v().index,r=v().index,s=v();We("id","captured_",e,"_",r,""),D("x",65+100*e)("y",81+120*r)("transform",s.getPieceRotation(e,r)),S(1),W2(" ",-s.captured[r][e]," ")}}function a4t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"circle",4),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),O(),b(2,"text",5),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),Pt(3),O(),x(4,o4t,2,6,"text",6),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",i.getSpaceClasses(r,s)),D("cx",i.getPieceCx(r))("cy",i.getPieceCy(s)),S(1),We("id","number_",r,"__",s,""),D("x",50+100*r)("y",66+120*s)("transform",i.getPieceRotation(r,s)),S(1),W2(" ",e," "),S(1),T("ngIf",i.captured[s][r]>0)}}function c4t(n,t){if(1&n&&(B(),b(0,"g"),x(1,a4t,5,12,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let l4t=(()=>{class n extends No{constructor(e){super(e),this.last=P.empty(),this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[],this.hasAsymetricBoard=!0,this.scores=P.of([0,0]),this.rules=new A4(Q2),this.availableMinimaxes=[new i4t(this.rules,"AwaleMinimax")],this.encoder=_1.encoder,this.tutorial=(new Rce).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.scores=P.of(e.getCapturedCopy()),this.hidePreviousMove();const r=this.rules.node.move;if(this.board=e.getCopiedBoard(),r.isPresent()){const s=e.getCurrentPlayer().value;this.last=P.of(new M(r.get().x,s)),this.showPreviousMove()}else this.last=P.empty()}hidePreviousMove(){this.captured=[[0,0,0,0,0,0],[0,0,0,0,0,0]],this.filledCoords=[]}showPreviousMove(){const e=this.rules.node.move.get(),r=this.rules.node.mother.get().gameState,s=Ke.copyBiArray(r.board),i=r.getCurrentOpponent().value;this.filledCoords=A4.distribute(e.x,i,s);const o=this.filledCoords[this.filledCoords.length-1];if(o.y!==i){const c=A4.captureIfLegal(o.x,o.y,r.getCurrentPlayer(),s);this.captured=c.captureMap;const u=this.getState().getCurrentPlayer();A4.mustMansoon(u.getOpponent(),c.resultingBoard)&&(this.captured=A4.mansoon(u,c.resultingBoard).captureMap)}}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(r===s.getState().getCurrentPlayer().value)return s.cancelMove(pH.CANNOT_DISTRIBUTE_FROM_OPPONENT_HOME());s.last=P.empty();const o=_1.from(e);return s.chooseMove(o,s.getState())})()}getSpaceClasses(e,r){const s=new M(e,r),i="player"+(r+1)%2+"-fill";return this.captured[r][e]>0?["captured-fill","moved-stroke"]:this.last.equalsValue(s)?["moved-stroke","last-move-stroke",i]:this.filledCoords.some(o=>o.equals(s))?["moved-stroke",i]:[i]}getPieceCx(e){return 50+100*e}getPieceCy(e){return 50+120*e}getPieceRotation(e,r){return"rotate("+180*this.role.value+" "+this.getPieceCx(e)+" "+this.getPieceCy(r)+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-awale-component"]],features:[l],decls:4,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-45 -20 700 260","preserveAspectRatio","xMidYMid meet"],["x","-40","y","-15","ry","115","rx","115","width","680","height","250","fill","blue",1,"base"],[4,"ngFor","ngForOf"],["x1","-40","y1","110","x2","640","y2","110",1,"base"],["r","46",1,"base",3,"id","ngClass","click"],[1,"text-big","text-center",3,"id","click"],["class","text-20 text-center",3,"id","click",4,"ngIf"],[1,"text-20","text-center",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),X(1,"rect",1),x(2,c4t,2,1,"g",2),X(3,"line",3),O()),2&e&&(D("transform",r.rotation),S(2),T("ngForOf",r.board))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class I4 extends $i{constructor(t,e){super(),this.first=t,this.second=e}static getEncoder(t){return new class extends M2{encodeMove(e){return{first:M.encoder.encode(e.first),second:M.encoder.encode(e.second)}}decodeMove(e){ye(null!=we.getNonNullable(e).first,"Encoded MoveWithTwoCoords should contain a first coord"),ye(null!=we.getNonNullable(e).second,"Encoded MoveWithTwoCoords should contain a second coord");const r=M.encoder.decode(we.getNonNullable(e).first),s=M.encoder.decode(we.getNonNullable(e).second);return t(r,s).get()}}}getFirst(){return this.first}getSecond(){return this.second}}class X0 extends I4{constructor(t,e){if(super(t,e),t.equals(e))throw new Error(rt.MOVE_CANNOT_BE_STATIC())}length(){return this.getStart().getDistance(this.getEnd())}getDirection(){return be.factory.fromMove(this.getStart(),this.getEnd())}getStart(){return this.getFirst()}getEnd(){return this.getSecond()}}let uP=(()=>{class n{}return n.LANDING_ON_OCCUPIED_SQUARE=()=>$localize`You cannot land on an occupied square.`,n.THRONE_IS_LEFT_FOR_GOOD=()=>$localize`Once you left the central throne, you cannot return to it.`,n.SOLDIERS_CANNOT_SIT_ON_THRONE=()=>$localize`Soldiers cannot sit on the throne.`,n.MOVE_MUST_BE_ORTHOGONAL=()=>$localize`Tafl moves must be orthogonal.`,n})();class gH extends X0{constructor(t,e){if(super(t,e),t.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Starting coord of TaflMove must be on the board, not at "+t.toString()+".");if(e.isNotInRange(this.getMaximalDistance(),this.getMaximalDistance()))throw new Error("Landing coord of TaflMove must be on the board, not at "+e.toString()+".");const r=t.getDirectionToward(e);if(r.isFailure()||r.get().isDiagonal())throw new Error(uP.MOVE_MUST_BE_ORTHOGONAL())}equals(t){return t===this||!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"TaflMove("+this.getStart()+"->"+this.getEnd()+")"}}class Ao extends gH{static of(t,e){return new Ao(t,e)}static from(t,e){try{const r=new Ao(t,e);return $.success(r)}catch(r){return $.failure(r.message)}}getMaximalDistance(){return 7}}Ao.encoder=I4.getEncoder(Ao.from);const u4t={CASTLE_IS_LEFT_FOR_GOOD:!0,BORDER_CAN_SURROUND_KING:!1,CENTRAL_THRONE_CAN_SURROUND_KING:!0,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!0,WIDTH:7,INVADER:z.ZERO};class hn{constructor(t,e){this.owner=t,this.king=e}isKing(){return this.king}getOwner(){return this.owner}}hn.UNOCCUPIED=new hn(pe.NONE,!1),hn.PLAYER_ONE_KING=new hn(pe.ONE,!0),hn.INVADERS=new hn(pe.ZERO,!1),hn.DEFENDERS=new hn(pe.ONE,!1);class Y1{constructor(t){this.value=t}}Y1.NONE=new Y1("NONE"),Y1.OPPONENT=new Y1("OPPONENT"),Y1.PLAYER=new Y1("PLAYER");class mH extends ps{isCentralThrone(t){return t.equals(this.getCentralThrone())}getCentralThrone(){const t=(this.board.length-1)/2;return new M(t,t)}getRelativeOwner(t,e){const r=this.getAbsoluteOwner(e);let s;return s=r===pe.NONE?Y1.NONE:t===r?Y1.PLAYER:Y1.OPPONENT,s}getAbsoluteOwner(t){return this.getPieceAt(t).getOwner()}}class T3 extends mH{static getInitialState(){const t=hn.UNOCCUPIED,e=hn.INVADERS,r=hn.DEFENDERS;return new T3([[t,t,t,e,t,t,t],[t,t,t,e,t,t,t],[t,t,t,r,t,t,t],[e,e,r,hn.PLAYER_ONE_KING,r,e,e],[t,t,t,r,t,t,t],[t,t,t,e,t,t,t],[t,t,t,e,t,t,t]],0)}from(t,e){return new T3(t,e)}}let _H=(()=>{class n extends Z1{constructor(e,r,s){super(e),this.config=r,this.generateMove=s}isLegal(e,r){K(n.VERBOSE,{tablutRules_isLegal:{move:e,state:r}});const s=r.getCurrentPlayer(),i=this.getMoveValidity(s,e,r);return i.isFailure()?$.failure(i.getReason()):$.success(void 0)}getMoveValidity(e,r,s){const i=s.getRelativeOwner(e,r.getStart());if(i===Y1.NONE)return U.failure(rt.MUST_CHOOSE_PLAYER_PIECE());if(i===Y1.OPPONENT)return U.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE());if(s.getRelativeOwner(e,r.getEnd())!==Y1.NONE)return U.failure(uP.LANDING_ON_OCCUPIED_SQUARE());if(this.isThrone(s,r.getEnd())){if(!s.getPieceAt(r.getStart()).isKing())return U.failure(uP.SOLDIERS_CANNOT_SIT_ON_THRONE());if(s.isCentralThrone(r.getEnd())&&this.config.CASTLE_IS_LEFT_FOR_GOOD)return U.failure(uP.THRONE_IS_LEFT_FOR_GOOD())}const c=r.getStart().getDirectionToward(r.getEnd()).get(),u=r.getStart().getOrthogonalDistance(r.getEnd());let h=r.getStart().getNext(c);for(let p=1;p<u;p++){if(s.getPieceAt(h)!==hn.UNOCCUPIED)return U.failure(rt.SOMETHING_IN_THE_WAY());h=h.getNext(c)}return U.SUCCESS}isThrone(e,r){return!!this.isExternalThrone(r)||e.isCentralThrone(r)}isExternalThrone(e){const r=this.config.WIDTH-1;return!(0!==e.x&&e.x!==r||0!==e.y&&e.y!==r)}tryCapture(e,r,s,i){const o=r.getNext(s);return o.isInRange(this.config.WIDTH,this.config.WIDTH)&&i.getRelativeOwner(e,o)===Y1.OPPONENT?i.getPieceAt(o).isKing()?this.captureKing(e,r,s,i):this.capturePawn(e,r,s,i):P.empty()}captureKing(e,r,s,i){const o=r.getNext(s),{backCoord:c,back:u,backInRange:h,left:p,leftCoord:m,right:C,rightCoord:w}=this.getSurroundings(o,s,e,i);return!1===h?this.captureKingAgainstTheWall(p,C,o):u===Y1.NONE&&this.isThrone(i,c)?this.captureKingAgainstThrone(c,o,p,C):u===Y1.PLAYER?this.captureKingWithAtLeastASandwich(i,o,p,m,C,w):P.empty()}getSurroundings(e,r,s,i){const o=e.getNext(r),c=o.isInRange(this.config.WIDTH,this.config.WIDTH),u=c?i.getRelativeOwner(s,o):Y1.NONE,h=e.getLeft(r),m=h.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,h):Y1.NONE,C=e.getRight(r),I=C.isInRange(this.config.WIDTH,this.config.WIDTH)?i.getRelativeOwner(s,C):Y1.NONE;return{backCoord:o,back:u,backInRange:c,leftCoord:h,left:m,rightCoord:C,right:I}}captureKingAgainstTheWall(e,r,s){let o=e===Y1.PLAYER?1:0;return o+=r===Y1.PLAYER?1:0,2===o&&this.config.BORDER_CAN_SURROUND_KING?(K(n.VERBOSE||!1,"king captured by 3 invaders against 1 border"),P.of(s)):P.empty()}captureKingAgainstThrone(e,r,s,i){if(this.isExternalThrone(e)){if(this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return P.of(r)}else{const c=i===Y1.PLAYER,u=s===Y1.PLAYER||c;if(this.config.CENTRAL_THRONE_CAN_SURROUND_KING&&u)return P.of(r)}return P.empty()}capturePawn(e,r,s,i){const c=r.getNext(s),u=c.getNext(s);let h=Y1.NONE;return u.isInRange(this.config.WIDTH,this.config.WIDTH)&&(h=i.getRelativeOwner(e,u)),h===Y1.NONE?!1===this.isThrone(i,u)?(K(n.VERBOSE||!1,"cannot capture a pawn without an ally; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")cannot capture a pawn without an ally behind"),P.empty()):(K(n.VERBOSE||!1,"pawn captured by 1 opponent and 1 throne; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.of(c)):h===Y1.PLAYER?(K(n.VERBOSE||!1,"pawn captured by 2 opponents; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.of(c)):(K(n.VERBOSE||!1,"no captures; "+c+"threatened by "+e+"'s pawn in "+r+" coming from this direction ("+s.x+", "+s.y+")"),P.empty())}captureKingWithAtLeastASandwich(e,r,s,i,o,c){if(!1===this.kingTouchCentralThrone(e,r)&&this.config.KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED)return P.of(r);const h=this.config.CENTRAL_THRONE_CAN_SURROUND_KING,p=this.isThrone(e,i),m=s===Y1.PLAYER||p&&h,C=this.isThrone(e,c);return m&&(o===Y1.PLAYER||C&&h)?(K(n.VERBOSE||!1,"king captured by 4 invaders"),P.of(r)):P.empty()}kingTouchCentralThrone(e,r){const s=e.getCentralThrone();return r.getOrthogonalDistance(s)<=1}applyLegalMove(e,r){K(n.VERBOSE,{TablutRules_applyLegalMove:{move:e,state:r}});const s=r.turn,i=r.getCopiedBoard(),o=r.getCurrentPlayer(),c=e.getStart(),u=e.getEnd();i[u.y][u.x]=i[c.y][c.x],i[c.y][c.x]=hn.UNOCCUPIED;for(const h of He.ORTHOGONALS){const p=this.tryCapture(o,e.getEnd(),h,r);p.isPresent()&&(i[p.get().y][p.get().x]=hn.UNOCCUPIED)}return r.from(i,s+1)}getGameStatus(e){const s=this.getWinner(e.gameState);return s.isPresent()?xe.getVictory(s.get()):xe.ONGOING}getWinner(e){const s=this.getKingCoord(e);if(s.isAbsent())return K(!1,"The king is dead, victory to invader"),P.of(this.getInvader());const i=s.get();return this.isExternalThrone(i)?(K(!1,"The king escape, victory to defender"),P.of(this.getDefender())):this.isPlayerImmobilized(z.ZERO,e)?(K(!1,"Zero has no move, victory to one"),P.of(z.ONE)):this.isPlayerImmobilized(z.ONE,e)?(K(!1,"One has no move, victory to zero"),P.of(z.ZERO)):(K(!1,"no victory"),P.empty())}getKingCoord(e){K(n.VERBOSE,{TablutRules_getKingCoord:{state:e,con:this.config}});for(let r=0;r<this.config.WIDTH;r++)for(let s=0;s<this.config.WIDTH;s++)if(e.getPieceAtXY(s,r).isKing())return P.of(new M(s,r));return P.empty()}getInvader(){return this.config.INVADER}getDefender(){return this.config.INVADER.getOpponent()}isPlayerImmobilized(e,r){return 0===this.getPlayerListMoves(e,r).length}getPlayerListMoves(e,r){const i=[],o=this.getPlayerListPawns(e,r);K(n.VERBOSE||!1,{TablutRules_getPlayerListMoves:{player:e,state:r}});for(const c of o){const u=this.getPossibleDestinations(c,r);for(const h of u){const p=this.generateMove(c,h);i.push(p)}}return i}getPlayerListPawns(e,r){const s=[];for(let i=0;i<this.config.WIDTH;i++)for(let o=0;o<this.config.WIDTH;o++){const c=new M(o,i);r.getAbsoluteOwner(c)===e&&s.push(c)}return s}getPossibleDestinations(e,r){const s=[];let i;for(const o of He.ORTHOGONALS){i=e.getNext(o,1);let c=!1;for(;i.isInRange(this.config.WIDTH,this.config.WIDTH)&&!1===c;)r.getAbsoluteOwner(i)===pe.NONE?this.isExternalThrone(i)?r.getPieceAt(e).isKing()&&s.push(i):r.isCentralThrone(i)?r.getPieceAt(e).isKing()&&!1===this.config.CASTLE_IS_LEFT_FOR_GOOD&&s.push(i):s.push(i):c=!0,i=i.getNext(o,1)}return s}}return n.VERBOSE=!1,n})();class m5 extends _H{constructor(){super(T3,u4t,Ao.of)}static get(){return null==m5.singleton&&(m5.singleton=new m5),B1.ruler=this.singleton,m5.singleton}}class vH extends No{constructor(t,e,r){super(t),this.VERBOSE=e,this.generateMove=r,this.viewInfo={pieceClasses:[]},this.EMPTY=hn.UNOCCUPIED,this.capturedCoords=[],this.chosen=P.empty(),this.lastMove=P.empty()}getViewBox(){const t=-this.STROKE_WIDTH,e=this.rules.config.WIDTH*this.SPACE_SIZE+2*this.STROKE_WIDTH;return t+" "+t+" "+e+" "+e}updateBoard(){K(this.VERBOSE,"taflComponent.updateBoard"),this.lastMove=this.rules.node.move,this.board=this.getState().getCopiedBoard(),this.capturedCoords=[],this.lastMove.isPresent()&&this.showPreviousMove(),this.updateViewInfo()}showPreviousMove(){const t=this.rules.node.mother.get().gameState,e=this.getState().getCurrentOpponent();for(const r of He.ORTHOGONALS){const s=this.lastMove.get().getEnd().getNext(r,1);if(s.isInRange(this.rules.config.WIDTH,this.rules.config.WIDTH)){const o=t.getRelativeOwner(e,s)===Y1.OPPONENT,u=this.getState().getPieceAt(s)===hn.UNOCCUPIED;o&&u&&this.capturedCoords.push(s)}}}updateViewInfo(){const t=[];for(let e=0;e<this.board.length;e++){const r=[];for(let s=0;s<this.board[0].length;s++){let i=[];i=this.board[e][s].getOwner()===pe.NONE?[""]:this.getPieceClasses(s,e),r.push(i)}t.push(r)}this.viewInfo={pieceClasses:t}}onClick(t,e){var r=this;return A(function*(){K(r.VERBOSE,"TaflComponent.onClick("+t+", "+e+")");const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);return r.chosen.equalsValue(i)?(r.cancelMoveAttempt(),U.SUCCESS):r.chosen.isAbsent()||r.pieceBelongToCurrentPlayer(i)?r.choosePiece(i):r.chooseDestination(t,e)})()}chooseDestination(t,e){var r=this;return A(function*(){K(r.VERBOSE,"TaflComponent.chooseDestination");const s=r.chosen.get(),i=new M(t,e),o=r.generateMove(s,i);return o.isSuccess()?yield r.chooseMove(o.get(),r.getState()):r.cancelMove(o.getReason())})()}choosePiece(t){return K(this.VERBOSE,"TaflComponent.choosePiece"),this.board[t.y][t.x]===hn.UNOCCUPIED?this.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE()):this.pieceBelongToCurrentPlayer(t)?(this.chosen=P.of(t),this.updateViewInfo(),K(this.VERBOSE,"selected piece = ("+t.x+", "+t.y+")"),U.SUCCESS):this.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE())}pieceBelongToCurrentPlayer(t){const e=this.getState(),r=e.getCurrentPlayer();return e.getRelativeOwner(r,t)===Y1.PLAYER}cancelMoveAttempt(){this.chosen=P.empty(),this.updateViewInfo()}isThrone(t,e){const r=this.getState();return this.rules.isThrone(r,new M(t,e))}isCentralThrone(t,e){return this.getState().isCentralThrone(new M(t,e))}getPieceClasses(t,e){const r=[],s=new M(t,e),i=this.getState().getAbsoluteOwner(s);return r.push(this.getPlayerClass(i)),this.chosen.equalsValue(s)&&r.push("selected-stroke"),r}getRectClasses(t,e){const r=[],s=new M(t,e);if(this.capturedCoords.some(i=>i.equals(s)))r.push("captured-fill");else if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();(s.equals(i)||s.equals(o))&&r.push("moved-fill")}return r}getClickables(){const t=[];for(let e=0;e<this.board.length;e++)for(let r=0;r<this.board[e].length;r++){const s=new M(r,e);this.isClickable(s)&&t.push(s)}return t}isClickable(t){return this.pieceBelongToCurrentPlayer(t)}isInvader(t,e){return this.board[e][t]===hn.INVADERS}isKing(t,e){return this.board[e][t].isKing()}}class fP extends $1{getListMoves(t){K(!1,{TaflMinimax_getListMoves:{node:t}});const r=t.gameState,s=r.getCurrentPlayer(),i=this.ruler.getPlayerListMoves(s,r);return this.orderMoves(r,i)}orderMoves(t,e){const r=this.ruler.getKingCoord(t).get();return t.getCurrentPlayer()===this.ruler.config.INVADER?Ke.sortByDescending(e,s=>-s.getEnd().getOrthogonalDistance(r)):Ke.sortByDescending(e,s=>s.getStart().equals(r)?this.ruler.isExternalThrone(s.getEnd())?2:1:0),e}getBoardValue(t){const e=t.gameState,r=this.ruler.getWinner(e);if(r.isPresent())return new Ct(r.get().getVictoryValue());const s=this.ruler.getPlayerListPawns(z.ZERO,e).length,i=this.ruler.getPlayerListPawns(z.ONE,e).length;return Ct.from(s*[1,2][this.ruler.config.INVADER.value],i*[2,1][this.ruler.config.INVADER.value])}}class hP{constructor(t,e){this.directThreats=t,this.mover=e}equals(t){return t.directThreats.equals(this.directThreats)&&t.mover.equals(this.mover)}}class Dce extends hP{constructor(t,e){super(new Ht([t]),e),this.directThreat=t,this.mover=e}}class f4t extends Ht{constructor(t){if(super(),this.valueMap=[],this.values=[],void 0!==t)for(const e of t)this.add(e)}add(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0])void 0===r[i]&&(r[i]=[]),r=r[i];const s=e[1];return void 0===r[s]&&(r[s]=!0,this.values.push(t),!0)}contains(t){const e=this.toFields(t);let r=this.valueMap;for(const i of e[0]){if(void 0===r[i])return!1;r=r[i]}return void 0!==r[e[1]]}[Symbol.iterator](){return this.values.values()}}class vr extends f4t{toFields(t){return[[t.y],t.x]}}class dP extends fP{constructor(t,e){super(t,e),this.width=this.ruler.config.WIDTH,this.maxInfluence=16*(2*this.width-2),this.scoreByThreatenedPiece=16*this.maxInfluence+1,this.scoreBySafePiece=16*this.scoreByThreatenedPiece+1}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=hn.UNOCCUPIED;let i=0;const o=this.getPiecesMap(r),c=this.getThreatMap(r,o),u=this.filterThreatMap(c,r);for(const h of z.PLAYERS)for(const p of o.get(h).get())if(u.get(p).isPresent())i+=h.getScoreModifier()*this.scoreByThreatenedPiece;else{i+=h.getScoreModifier()*this.scoreBySafePiece;let m=0;for(const C of He.ORTHOGONALS){let w=p.getNext(C,1);for(;w.isInRange(this.width,this.width)&&r.getPieceAt(w)===s;)m++,w=w.getNext(C,1)}i+=m*h.getScoreModifier()}return new Ct(i)}getPiecesMap(t){const e=hn.UNOCCUPIED,r=[],s=[];for(let o=0;o<this.width;o++)for(let c=0;c<this.width;c++){const u=new M(c,o);t.getPieceAt(u)!==e&&(t.getAbsoluteOwner(u)===z.ZERO?r.push(u):s.push(u))}return new zn([{key:z.ZERO,value:new vr(r)},{key:z.ONE,value:new vr(s)}])}getThreatMap(t,e){const r=new zn;for(const s of z.PLAYERS)for(const i of e.get(s).get()){const o=this.getThreats(i,t);this.isThreatReal(i,t,o)&&r.set(i,new Ht(o))}return r}getThreats(t,e){const r=e.getAbsoluteOwner(t);ye(r.isPlayer(),"TaflPieceAndInfluenceMinimax.getThreats should be called with an occupied coordinate");const s=r.getOpponent(),i=[];for(const o of He.ORTHOGONALS){const c=t.getPrevious(o,1);if(this.isAThreat(c,e,s)){const u=[];for(const h of He.ORTHOGONALS){if(h===o.getOpposite())continue;let p=t.getNext(o,1);for(;p.isInRange(this.width,this.width)&&e.getPieceAt(p)===hn.UNOCCUPIED;)p=p.getNext(h);p.isInRange(this.width,this.width)&&e.getAbsoluteOwner(p)===s&&!1===t.getNext(o,1).equals(p)&&u.push(p)}i.push(new Dce(c,new vr(u)))}}return i}isAThreat(t,e,r){return!(t.isNotInRange(this.width,this.width)||e.getAbsoluteOwner(t)!==r&&(!this.ruler.isThrone(e,t)||r!==z.ONE&&e.getPieceAt(t)!==hn.UNOCCUPIED))}isThreatReal(t,e,r){if(0===r.length)return!1;if(e.getPieceAt(t).isKing())return 3===r.length;for(const s of r)if(s.mover.size()>0)return!0;return!1}filterThreatMap(t,e){const r=new zn,s=t.listKeys(),i=s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentPlayer()),o=new vr(s.filter(c=>e.getAbsoluteOwner(c)===e.getCurrentOpponent()));for(const c of i){const u=t.get(c).get(),h=[];for(const p of u)if(!1===o.contains(p.directThreat)){const m=[];for(const C of p.mover)!1===o.contains(C)&&m.push(C);m.length>0&&h.push(new Dce(p.directThreat,new vr(m)))}h.length>0&&r.set(c,new Ht(h))}for(const c of o){const u=t.get(c).get();r.set(c,u)}return r}}class w3 extends dP{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=this.ruler.config.WIDTH,i=hn.UNOCCUPIED;let o=0;const c=this.getPiecesMap(r),u=this.getThreatMap(r,c),h=this.filterThreatMap(u,r);for(const p of z.PLAYERS){const m=new vr;for(const C of c.get(p).get())if(h.get(C).isPresent())o+=p.getScoreModifier()*w3.SCORE_BY_THREATENED_PIECE;else{o+=p.getScoreModifier()*w3.SCORE_BY_SAFE_PIECE;for(const w of He.ORTHOGONALS){let I=C.getNext(w,1);for(;I.isInRange(s,s)&&r.getPieceAt(I)===i;)m.add(I),I=I.getNext(w,1)}}for(const C of m){const w=this.getControlledPieceValue(C.x,C.y,s);o+=p.getScoreModifier()*w}}return new Ct(o)}getControlledPieceValue(t,e,r){let s=1;return(0===t||t===r-1)&&(s*=r),(0===e||e===r-1)&&(s*=r),s}}w3.SCORE_BY_THREATENED_PIECE=530,w3.SCORE_BY_SAFE_PIECE=16*w3.SCORE_BY_THREATENED_PIECE+1;class _9 extends w3{getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=this.ruler.config.WIDTH,i=hn.UNOCCUPIED;let o=0,c=0,u=0;const h=this.getPiecesMap(r),p=this.getThreatMap(r,h),m=this.filterThreatMap(p,r);for(const w of z.PLAYERS){const I=new vr;for(const H of h.get(w).get())if(m.get(H).isPresent())c+=w.getScoreModifier();else{o+=w.getScoreModifier();for(const Y of He.ORTHOGONALS){let ee=H.getNext(Y,1);for(;ee.isInRange(s,s)&&r.getPieceAt(ee)===i;)I.add(ee),ee=ee.getNext(Y,1)}}for(const H of I){const Y=this.getControlledPieceValue(H.x,H.y,s);u+=w.getScoreModifier()*Y}}const C=this.getStepForEscape(r);return new Ct(531*C*17*17+531*o*17+531*c+u)}getStepForEscape(t){const e=this.ruler.getKingCoord(t).get();return this._getStepForEscape(t,1,[e],[]).getOrElse(Number.MAX_SAFE_INTEGER)}_getStepForEscape(t,e,r,s){const i=this.getNextGen(t,r,s);return 0===i.length?P.empty():i.some(o=>this.ruler.isExternalThrone(o))?P.of(e):(e++,s.push(...i),this._getStepForEscape(t,e,i,s))}getNextGen(t,e,r){const s=[];for(const i of e)for(const o of He.ORTHOGONALS){let c=i.getNext(o,1);for(;c.isInRange(this.ruler.config.WIDTH,this.ruler.config.WIDTH)&&t.getPieceAt(c)===hn.UNOCCUPIED;)r.every(u=>!1===u.equals(c))&&s.push(c),c=c.getNext(o,1)}return s}}_9.SCORE_BY_THREATENED_PIECE=530,_9.SCORE_BY_SAFE_PIECE=16*w3.SCORE_BY_THREATENED_PIECE+1,_9.CONTROL_VALUE=[[64,8,8,8,8,8,8,8,64],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[8,1,1,1,1,1,1,1,8],[64,8,8,8,8,8,8,8,64]];const ne=hn.UNOCCUPIED,K1=hn.INVADERS,fa=hn.DEFENDERS,Im=hn.PLAYER_ONE_KING;class zce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Brandhub is the Irish version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,T3.getInitialState()),ce.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move: <ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a corner throne.</li><li>Once the king left his central throne, no piece can land on it, but all can pass over it.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,T3.getInitialState(),Ao.of(new M(3,1),new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new T3([[ne,ne,ne,K1,ne,ne,ne],[ne,ne,ne,K1,ne,ne,ne],[K1,ne,ne,fa,ne,ne,ne],[ne,ne,fa,Im,fa,K1,K1],[ne,ne,K1,ne,ne,ne,ne],[ne,ne,ne,fa,ne,K1,ne],[ne,ne,ne,K1,ne,ne,ne]],1),[Ao.of(new M(3,5),new M(2,5))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ce.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new T3([[ne,ne,ne,K1,ne,ne,ne],[ne,ne,K1,ne,ne,ne,ne],[ne,ne,ne,fa,ne,ne,ne],[K1,fa,ne,ne,fa,K1,K1],[ne,fa,ne,ne,ne,ne,ne],[ne,K1,ne,Im,ne,K1,ne],[ne,ne,ne,K1,ne,ne,ne]],12),[Ao.of(new M(2,1),new M(3,1)),Ao.of(new M(3,0),new M(3,1))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ce.fromMove($localize`Capturing the king on his throne`,$localize`To capture the king when he sits on his throne, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers.<br/><br/>You're playing Dark. Capture the king.`,new T3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,fa,ne,ne,ne],[ne,ne,ne,K1,ne,ne,ne],[ne,K1,ne,Im,K1,ne,ne],[ne,ne,ne,K1,ne,ne,ne],[ne,fa,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Ao.of(new M(1,3),new M(2,3))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ce.fromMove($localize`Capturing the king next to his throne`,$localize`Another way to capture the king is to use three soldier plus the central throne to surround the king on four sides.<br/><br/>You're playing Dark. Capture the king.`,new T3([[ne,ne,K1,ne,ne,ne,ne],[ne,ne,ne,K1,ne,ne,ne],[ne,ne,ne,Im,K1,ne,ne],[ne,K1,fa,ne,fa,ne,ne],[ne,ne,ne,K1,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne]],72),[Ao.of(new M(2,0),new M(2,2))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`),ce.fromMove($localize`Capturing the king far from his throne`,$localize`When the king is not on his central throne nor next to it, he can be captured like a soldier.<br/><br/>You're playing Dark. Capture the king.`,new T3([[ne,ne,ne,ne,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,K1,ne,K1,ne,ne,ne],[K1,ne,ne,ne,fa,ne,ne],[ne,ne,ne,fa,ne,ne,ne],[ne,ne,ne,ne,ne,ne,ne],[ne,Im,ne,K1,ne,ne,ne]],72),[Ao.of(new M(3,6),new M(2,6))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function h4t(n,t){1&n&&(B(),X(0,"polygon",8))}function d4t(n,t){1&n&&(B(),X(0,"rect",9))}function p4t(n,t){if(1&n&&(B(),b(0,"g"),x(1,h4t,1,0,"polygon",6),x(2,d4t,1,0,"ng-template",null,7,c1),O()),2&n){const e=t1(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function g4t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function m4t(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function _4t(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function v4t(n,t){if(1&n&&(B(),x(0,m4t,1,1,"polyline",14),x(1,_4t,4,20,"ng-template",null,15,c1)),2&n){const e=t1(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function C4t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",10),x(2,g4t,6,25,"g",11),x(3,v4t,3,2,"ng-template",null,12,c1),O()),2&n){const e=t1(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function y4t(n,t){if(1&n){const e=Oe();B(),b(0,"g",3),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),X(1,"rect",4),x(2,p4t,4,2,"g",5),x(3,C4t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function E4t(n,t){if(1&n&&(B(),b(0,"g"),x(1,y4t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function M4t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",17),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let S4t=(()=>{class n extends vH{constructor(e){super(e,!1,Ao.from),this.rules=m5.get(),this.availableMinimaxes=[new fP(this.rules,"DummyBot"),new dP(this.rules,"Piece > Influence"),new w3(this.rules,"Piece > Control"),new _9(this.rules,"Escape > Piece > Control")],this.encoder=Ao.encoder,this.tutorial=(new zce).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-brandhub"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,E4t,2,1,"g",1),x(2,M4t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),r6=(()=>{class n{}return n.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP=()=>$localize`Your piece should land on a neighboring square.`,n.CANNOT_DROP_AFTER_TURN_40=()=>$localize`You cannot drop a piece during the moving phase.`,n.CANNOT_MOVE_BEFORE_TURN_40=()=>$localize`You cannot move a piece before both players have dropped all of their pieces.`,n.MUST_JUMP_OVER_PIECES=()=>$localize`A jump must be made over a piece, not over an empty square.`,n.MUST_DROP_IN_CENTRAL_ZONE=()=>$localize`A drop must occur in the central zone of the board.`,n.INVALID_JUMP=()=>$localize`A jump must land two squares from its original position, and be done in a straight line in any direction.`,n.SAME_LOCATION_VISITED_IN_JUMP=()=>$localize`You are visiting the same location twice in a move, you are not allowed to do so.`,n})();class Rt extends ps{static getInitialState(){const t=Ke.createTable(Rt.WIDTH,Rt.HEIGHT,pe.NONE);return new Rt(t,0)}isShelter(t){return 0===t.x||t.x===Rt.WIDTH-1?Rt.SHELTERS_INDICES.some(e=>t.y===e):(0===t.y||t.y===Rt.HEIGHT-1)&&Rt.SHELTERS_INDICES.some(e=>t.x===e)}isCentralZone(t){return t.x>=Rt.CENTRAL_ZONE_TOP_LEFT.x&&t.x<=Rt.CENTRAL_ZONE_BOTTOM_RIGHT.x&&t.y>=Rt.CENTRAL_ZONE_TOP_LEFT.y&&t.y<=Rt.CENTRAL_ZONE_BOTTOM_RIGHT.y}isDropPhase(){return this.turn<40}getSidePieces(){return this.turn%2==0?[20-this.turn/2,20-this.turn/2]:[20-(this.turn-1)/2-1,20-(this.turn-1)/2]}}Rt.WIDTH=17,Rt.HEIGHT=17,Rt.CENTRAL_ZONE_TOP_LEFT=new M(4,6),Rt.CENTRAL_ZONE_BOTTOM_RIGHT=new M(12,10),Rt.SHELTERS_INDICES=[0,1,3,5,7,8,9,11,13,15,16],Rt.ALL_SHELTERS=new Ht(Rt.SHELTERS_INDICES.flatMap(n=>[new M(n,0),new M(n,Rt.HEIGHT-1),new M(0,n),new M(Rt.WIDTH-1,n)])).toList();class Q0 extends S3{constructor(t){super(t.x,t.y)}static of(t){return t.isInRange(Rt.WIDTH,Rt.HEIGHT)?$.success(new Q0(t)):$.failure("Move out of board")}toString(){return`ConspirateursMoveDrop(${this.coord.toString()})`}equals(t){return!!t.isDrop()&&this.coord.equals(t.coord)}isDrop(){return!0}isSimple(){return!1}isJump(){return!1}}Q0.encoder=class B3t{static getEncoder(t,e,r){return new class extends Cn{constructor(){super(...arguments),this.shiftX=e}maxValue(){return(t-1)*this.shiftX+(e-1)}encodeNumber(s){return s.coord.x*this.shiftX+s.coord.y}decodeNumber(s){const i=s%e;s/=e;const c=new M((s-=s%1)%t,i);return r(c)}}}}.getEncoder(Rt.WIDTH,Rt.HEIGHT,n=>Q0.of(n).get());class J0 extends X0{constructor(t,e){super(t,e)}static from(t,e){return t.isInRange(Rt.WIDTH,Rt.HEIGHT)&&e.isInRange(Rt.WIDTH,Rt.HEIGHT)?t.isAlignedWith(e)&&1===t.getDistance(e)?$.success(new J0(t,e)):$.failure(r6.SIMPLE_MOVE_SHOULD_BE_OF_ONE_STEP()):$.failure("Move out of board")}toString(){return`ConspirateursMoveSimple(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(!t.isSimple()||t!==this&&(!1===t.getStart().equals(this.getStart())||!1===t.getEnd().equals(this.getEnd())))}isDrop(){return!1}isSimple(){return!0}isJump(){return!1}}J0.encoder=I4.getEncoder(J0.from);class b3 extends $i{constructor(t){super(),this.coords=t}static of(t){if(t.length<2)return $.failure("ConspirateursMoveJump requires at least one jump, so two coords");for(const r of t)if(r.isNotInRange(Rt.WIDTH,Rt.HEIGHT))return $.failure("Move out of board");for(let r=1;r<t.length;r++)if(t[r-1].getDirectionToward(t[r]).isFailure()||2!==t[r-1].getDistance(t[r]))return $.failure(r6.INVALID_JUMP());return new vr(t).size()===t.length?$.success(new b3(t)):$.failure(r6.SAME_LOCATION_VISITED_IN_JUMP())}addJump(t){const e=Ke.copyImmutableArray(this.coords);return e.push(t),b3.of(e)}getStartingCoord(){return this.coords[0]}getEndingCoord(){return this.coords[this.coords.length-1]}getLandingCoords(){return this.coords.slice(1)}getJumpedOverCoords(){const t=[];for(let e=1;e<this.coords.length;e++){const r=this.coords[e-1].getDirectionToward(this.coords[e]).get();t.push(this.coords[e-1].getNext(r,1))}return t}toString(){return`ConspirateursMoveJump(${this.coords.map(e=>e.toString()).reduce((e,r)=>e+" -> "+r)})`}equals(t){return!(t.isSimple()||t.isDrop()||t!==this&&(!1===this.getStartingCoord().equals(t.getStartingCoord())||!1===this.getEndingCoord().equals(t.getEndingCoord())))}isDrop(){return!1}isSimple(){return!1}isJump(){return!0}}b3.encoder=new class extends M2{constructor(){super(...arguments),this.coordEncoder=M.numberEncoder(Rt.WIDTH,Rt.HEIGHT)}encodeMove(n){return{coords:n.coords.map(this.coordEncoder.encodeNumber)}}decodeMove(n){ye(null!=we.getNonNullable(n).coords,"Encoded ConspirateursMoveJump should contain coords");const e=we.getNonNullable(n).coords.map(this.coordEncoder.decodeNumber);return b3.of(e).get()}};const P4t=M2.disjunction3(Q0.encoder,J0.encoder,b3.encoder,n=>n.isDrop(),n=>n.isSimple()),E=pe.NONE,At=pe.ZERO,bt=pe.ONE;class Vce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Board and aim of the game`,$localize`Conspirateurs is played on a 17x17 board. The goal of the game is to place all of your pieces in shelters, which are the special squares on the edge of the board. Note the central zone in the middle of the board, where each player will put their pieces initially.`,Rt.getInitialState()),ce.anyMove($localize`Initial phase`,$localize`In the initial phase of the game, each player drop their 20 pieces, one per turn consecutively, in the central zone of the board. This phase does not allow any other kind of move.<br/><br/>You're playing Dark, drop one of your piece in the central zone.`,Rt.getInitialState(),Q0.of(new M(7,7)).get(),$localize`Congratulations!`),ce.fromPredicate($localize`Simple move`,$localize`Once all pieces have been placed, there are two kind of moves that can be performed. The first is a simple move in any direction, orthogonally or diagonally, of a single step.<br/><br/>You're playing Dark. Click on one of your piece and perform such a move.`,new Rt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,At,At,bt,bt,At,At,bt,At,bt,E,E,E,E],[E,E,E,E,At,bt,At,bt,At,At,At,At,bt,E,E,E,E],[E,E,E,E,At,bt,E,E,E,E,E,bt,At,E,E,E,E],[E,E,E,E,bt,At,At,bt,bt,bt,At,At,At,E,E,E,E],[E,E,E,E,bt,At,bt,bt,bt,bt,bt,bt,At,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),J0.from(new M(4,6),new M(3,5)).get(),(t,e,r)=>t.isSimple()?U.SUCCESS:U.failure($localize`You have made a jump, not a simple move. Try again!`),$localize`Congratulations!`),ce.fromPredicate($localize`Jumps`,$localize`The other type of move is a jump. A piece can jump over a neighboring piece in any direction, as long as it lands directly on the square after that piece, along the same direction.<br/><br/>You're playing Dark. Perform a jump by clicking on one of your piece that can perform a jump, and then on the target square. You may need to click a second time on the target square to confirm your jump, in case your piece is still highlighted (we will see shortly why this is useful).`,new Rt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,At,At,bt,bt,At,At,bt,At,bt,E,E,E,E],[E,E,E,E,At,bt,At,bt,At,At,At,At,bt,E,E,E,E],[E,E,E,E,At,bt,E,E,E,E,E,bt,At,E,E,E,E],[E,E,E,E,bt,At,At,bt,bt,bt,At,At,At,E,E,E,E],[E,E,E,E,bt,At,bt,bt,bt,bt,bt,bt,At,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),b3.of([new M(6,7),new M(6,5)]).get(),(t,e,r)=>t.isJump()?U.SUCCESS:U.failure($localize`You have not performed a jump. Try again!`),$localize`Congratulations!`),ce.fromMove($localize`Chaining jumps in a single move`,$localize`Jumps can be chained when possible. You can decide whether to continue a jump or to stop it at any time. To finish your jump, click a second time on your current location. Otherwise, simply keep clicking on your next location. Once no more destination is possible, your move will end without you needing to click the piece a second time.<br/><br/>You're playing Dark and you can perform a triple jump! Do it.`,new Rt([[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,bt,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,bt,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,bt,E,E,E,E,E,E,E,E,E],[E,E,E,E,At,At,E,bt,At,At,bt,At,bt,E,E,E,E],[E,E,E,E,At,E,At,bt,At,At,At,At,bt,E,E,E,E],[E,E,E,E,At,bt,E,E,E,E,E,bt,At,E,E,E,E],[E,E,E,E,bt,At,At,bt,bt,bt,At,At,At,E,E,E,E],[E,E,E,E,bt,At,bt,bt,bt,bt,bt,bt,At,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]],40),[b3.of([new M(8,6),new M(6,4),new M(6,2),new M(6,0)]).get()],$localize`Congratulations! You now know everything to play the game. Remember: to win, you have to place all of your pieces in shelters before your opponent does.`,$localize`You have not performed a triple jump. Try again!`)]}}class Ga extends Z1{constructor(){super(Rt)}static get(){return Ga.singleton.isAbsent()&&(Ga.singleton=P.of(new Ga)),Ga.singleton.get()}applyLegalMove(t,e,r){const s=e.getCopiedBoard();if(t.isDrop())s[t.coord.y][t.coord.x]=e.getCurrentPlayer();else if(t.isSimple())s[t.getStart().y][t.getStart().x]=pe.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer();else{const i=t.getStartingCoord(),o=t.getEndingCoord();s[i.y][i.x]=pe.NONE,s[o.y][o.x]=e.getCurrentPlayer()}return new Rt(s,e.turn+1)}isLegal(t,e){return t.isDrop()?this.dropLegality(t,e):t.isSimple()?this.simpleMoveLegality(t,e):this.jumpLegality(t,e)}dropLegality(t,e){return e.turn>=40?$.failure(r6.CANNOT_DROP_AFTER_TURN_40()):e.getPieceAt(t.coord).isPlayer()?$.failure(rt.MUST_LAND_ON_EMPTY_SPACE()):!1===e.isCentralZone(t.coord)?$.failure(r6.MUST_DROP_IN_CENTRAL_ZONE()):$.success(void 0)}simpleMoveLegality(t,e){return e.turn<40?$.failure(r6.CANNOT_MOVE_BEFORE_TURN_40()):e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?$.failure(rt.MUST_CHOOSE_PLAYER_PIECE()):e.getPieceAt(t.getEnd()).isPlayer()?$.failure(rt.MUST_LAND_ON_EMPTY_SPACE()):$.success(void 0)}jumpLegality(t,e){if(e.turn<40)return $.failure(r6.CANNOT_MOVE_BEFORE_TURN_40());if(e.getPieceAt(t.getStartingCoord())!==e.getCurrentPlayer())return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE());for(const r of t.getJumpedOverCoords())if(e.getPieceAt(r)===pe.NONE)return $.failure(r6.MUST_JUMP_OVER_PIECES());for(const r of t.getLandingCoords())if(e.getPieceAt(r).isPlayer())return $.failure(rt.MUST_LAND_ON_EMPTY_SPACE());return $.success(void 0)}jumpTargetsFrom(t){const e=[new M(t.x+2,t.y),new M(t.x-2,t.y),new M(t.x,t.y+2),new M(t.x,t.y-2),new M(t.x+2,t.y+2),new M(t.x+2,t.y-2),new M(t.x-2,t.y+2),new M(t.x-2,t.y-2)],r=[];for(const s of e)b3.of([t,s]).isSuccess()&&r.push(s);return r}nextJumps(t,e){const r=t.getEndingCoord(),s=[];for(const i of this.jumpTargetsFrom(r)){const o=t.addJump(i);o.isSuccess()&&this.jumpLegality(o.get(),e).isSuccess()&&s.push(o.get())}return s}jumpHasPossibleNextTargets(t,e){return this.nextJumps(t,e).length>0}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of Rt.ALL_SHELTERS){const i=e.getPieceAt(s);if(i.isPlayer()&&(r[i.value]+=1,20===r[i.value]))return xe.getVictory(i)}return xe.ONGOING}}Ga.singleton=P.empty();let xm=(()=>{class n{}return n.NO_MORE_PIECES_OF_THIS_TYPE=()=>$localize`You do not have any pieces of this type anymore.`,n.SPACE_IS_FULL=()=>$localize`You cannot play here: this space is already full.`,n.TARGET_STACK_TOO_HIGH=()=>$localize`You cannot add more pieces to the target stack, as it will contain more than 4 pieces.`,n.MUST_SHIFT_TO_NEIGHBOR=()=>$localize`To perform a shift, you must move the pieces to a neighboring space.`,n.MUST_SELECT_PIECE_FIRST=()=>$localize`You must first select either a piece from the side, or a stack of pieces to shift on the board.`,n})();class En{constructor(t,e){this.owner=t,this.otherPieceType=e}static of(t,e){return t===z.ZERO?e?En.ZERO_SECOND:En.ZERO_FIRST:t===z.ONE?e?En.ONE_SECOND:En.ONE_FIRST:En.EMPTY}toString(){return`DiamPiece(${this.owner}, ${this.otherPieceType})`}}En.encoder=Cn.tuple([z.numberEncoder,Cn.booleanEncoder],n=>[n.owner,n.otherPieceType],n=>En.of(n[0],n[1])),En.EMPTY=new En(pe.NONE,!1),En.ZERO_FIRST=new En(z.ZERO,!1),En.ZERO_SECOND=new En(z.ZERO,!0),En.ONE_FIRST=new En(z.ONE,!1),En.ONE_SECOND=new En(z.ONE,!0),En.PLAYER_PIECES=[En.ZERO_FIRST,En.ZERO_SECOND,En.ONE_FIRST,En.ONE_SECOND];class e8 extends $i{constructor(t,e){if(super(),this.target=t,this.piece=e,e===En.EMPTY)throw new Error("Cannot drop an empty piece")}isDrop(){return!0}getTarget(){return this.target}equals(t){return t instanceof e8&&!(this.target!==t.target||this.piece!==t.piece)}toString(){return`DiamMoveDrop(${this.target}, ${this.piece})`}}e8.encoder=Cn.tuple([Cn.numberEncoder(7),En.encoder],n=>[n.target,n.piece],n=>new e8(n[0],n[1]));class b2 extends $i{constructor(t,e){super(),this.start=t,this.moveDirection=e}static fromRepresentation(t,e){return new b2(new M(t.x,3-t.y),e)}isDrop(){return!1}getTarget(){return"clockwise"===this.moveDirection?(this.start.x+1)%8:(this.start.x+7)%8}equals(t){return t instanceof b2&&!(!1===this.start.equals(t.start)||this.moveDirection!==t.moveDirection)}toString(){return`DiamMoveShift(${this.start}, ${this.moveDirection})`}}b2.encoder=Cn.tuple([M.numberEncoder(8,4),Cn.booleanEncoder],n=>[n.start,"clockwise"===n.moveDirection],n=>new b2(n[0],n[1]?"clockwise":"counterclockwise"));const T4t=Cn.disjunction(e8.encoder,b2.encoder,n=>n.isDrop());let $r=(()=>{class n extends ps{constructor(e,r,s){super(e,s),this.remainingPieces=r}static getInitialState(){const e=En.EMPTY;return new n([[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]],[4,4,4,4],0)}static fromRepresentation(e,r){const s=e.reverse(),i=[4,4,4,4];for(let o=0;o<n.HEIGHT;o++)for(let c=0;c<n.WIDTH;c++){const u=s[o][c];s[o][c]!==En.EMPTY&&i[n.pieceIndex(u)]--}return ye(i.every(o=>o>=0),"Invalid DiamState representation uses too many pieces"),new n(s,i,r)}static pieceIndex(e){switch(e){case En.ZERO_FIRST:return 0;case En.ZERO_SECOND:return 1;case En.ONE_FIRST:return 2;default:return we.expectToBe(e,En.ONE_SECOND),3}}getRemainingPiecesOf(e){return this.remainingPieces[n.pieceIndex(e)]}getStackHeight(e){let r=0;for(let s=0;s<n.HEIGHT&&this.getPieceAtXY(e,s)!==En.EMPTY;s++)r++;return r}}return n.WIDTH=8,n.HEIGHT=4,n})();class O3 extends Z1{constructor(){super($r)}static get(){return O3.singleton.isAbsent()&&(O3.singleton=P.of(new O3)),O3.singleton.get()}applyLegalMove(t,e,r){return t.isDrop()?this.applyLegalDrop(t,e):this.applyLegalShift(t,e)}applyLegalDrop(t,e){const r=Ke.copyBiArray(e.board);r[e.getStackHeight(t.target)][t.target]=t.piece;const s=Ke.copyImmutableArray(e.remainingPieces);return s[$r.pieceIndex(t.piece)]-=1,new $r(r,s,e.turn+1)}applyLegalShift(t,e){const r=Ke.copyBiArray(e.board),s=t.getTarget();let i=e.getStackHeight(s),o=t.start.y;for(;o<$r.HEIGHT&&e.getPieceAtXY(t.start.x,o)!==En.EMPTY;)r[i][s]=e.getPieceAtXY(t.start.x,o),r[o][t.start.x]=En.EMPTY,i++,o++;return new $r(r,e.remainingPieces,e.turn+1)}isLegal(t,e){return t.isDrop()?this.isDropLegal(t,e):this.isShiftLegal(t,e)}isDropLegal(t,e){return t.piece.owner!==e.getCurrentPlayer()?$.failure(rt.MUST_CHOOSE_PLAYER_PIECE()):0===e.getRemainingPiecesOf(t.piece)?$.failure(xm.NO_MORE_PIECES_OF_THIS_TYPE()):this.dropHeightValidity(t,e)}dropHeightValidity(t,e){return e.getStackHeight(t.target)===$r.HEIGHT?$.failure(xm.SPACE_IS_FULL()):$.success(void 0)}isShiftLegal(t,e){return e.getPieceAt(t.start).owner!==e.getCurrentPlayer()?$.failure(rt.MUST_CHOOSE_PLAYER_PIECE()):this.shiftHeightValidity(t,e)}shiftHeightValidity(t,e){const r=e.getStackHeight(t.start.x)-t.start.y;return e.getStackHeight(t.getTarget())+r>$r.HEIGHT?$.failure(xm.TARGET_STACK_TOO_HIGH()):$.success(void 0)}getGameStatus(t){const e=this.findHighestAlignment(t.gameState);if(e.isPresent()){const r=t.gameState.getPieceAt(e.get());return ye(r.owner.isPlayer(),"highest alignment is owned by a player"),xe.getVictory(r.owner)}return xe.ONGOING}findHighestAlignment(t){for(let e=0;e<$r.WIDTH/2;e++)for(let r=$r.HEIGHT-1;r>0;r--){const s=t.getPieceAtXY(e,r),i=t.getPieceAtXY(e+$r.WIDTH/2,r);if(s!==En.EMPTY&&s===i)return P.of(new M(e,r))}return P.empty()}pieceCanMove(t,e){return!!this.isShiftLegal(new b2(e,"clockwise"),t).isSuccess()||!!this.isShiftLegal(new b2(e,"counterclockwise"),t).isSuccess()}}O3.singleton=P.empty();const tt=En.EMPTY,v9=En.ZERO_FIRST,Hce=En.ZERO_SECOND,pP=En.ONE_FIRST,CH=En.ONE_SECOND;class Fce{constructor(){this.tutorial=[ce.informational($localize`Initial board and player pieces`,$localize`Diam's board is a circular board made of 8 spaces. Each player has 8 pieces: 4 of one color, and 4 of another color. Initially, the board is empty. All the remaining pieces are displayed next to the board: Dark's pieces are on the left, Light's pieces are on the right.`,$r.getInitialState()),ce.fromMove($localize`Goal of the game`,$localize`At Diam, the goal is to align two of your pieces, having exactly the same color, on diametrically opposed spaces, on top of at least another piece. Note here that Dark does not win because the dark pieces are not on top of any other piece. You're playing Light. Here, you can win by dropping one of your pieces on the leftmost space. You can do it by clicking on the corresponding piece next to the board, and then on the space in which you want to drop your piece.<br/><br/>You're playing Light, win the game!`,$r.fromRepresentation([[tt,tt,tt,tt,tt,tt,tt,tt],[tt,tt,tt,tt,tt,tt,tt,tt],[tt,tt,tt,tt,pP,tt,tt,tt],[v9,tt,tt,tt,v9,tt,tt,tt]],3),[new e8(0,En.ONE_FIRST)],$localize`Congratulations, you won!`,$localize`Failed, you should drop your piece on the leftmost space, using the piece of the same color of the other piece you already have on the board.`),ce.fromMove($localize`Types of move`,$localize`You can perform two types of move: either dropping one of your piece like you did in the previous step, or you can shift one of your pieces on the board to a neighboring space. You can pick any of your piece on the board, even if there are pieces on top of it. Only one condition applies: there can never be more than 4 pieces in a space. When you pick a piece with other pieces on top of it, all the other pieces move with yours.<br/><br/>You're playing Dark, try to move one of your piece that is already on the board.`,$r.fromRepresentation([[tt,tt,tt,tt,tt,tt,tt,tt],[tt,tt,tt,tt,CH,tt,tt,tt],[tt,tt,tt,tt,v9,tt,tt,tt],[pP,tt,tt,tt,Hce,tt,tt,tt]],4),[b2.fromRepresentation(new M(4,3),"counterclockwise"),b2.fromRepresentation(new M(4,3),"clockwise"),b2.fromRepresentation(new M(4,2),"counterclockwise"),b2.fromRepresentation(new M(4,2),"clockwise")],$localize`Congratulations!`,$localize`Failed, try to move one of your piece that is already on the board.`),ce.fromMove($localize`Special case`,$localize`It can happen that, in a single turn, both players reach an alignment. If it is the case, only the player with the highest alignment wins.<br/><br/>Here, playing Dark, you can win by performing such a move, do it!`,$r.fromRepresentation([[tt,tt,tt,tt,v9,tt,tt,tt],[tt,tt,tt,tt,CH,tt,tt,v9],[tt,tt,tt,tt,v9,tt,tt,CH],[tt,pP,tt,tt,Hce,tt,tt,pP]],8),[b2.fromRepresentation(new M(4,2),"counterclockwise")],$localize`Congratulations!`,$localize`Failed, try to shift a stack of pieces to the left.`)]}}let Bce=(()=>{class n extends Y0{constructor(){super(...arguments),this.SPACE_SIZE=50}getTriangleCornerCoords(e,r){return(e+r)%2==1?this.getDownwardCoordinate(e,r):this.getUpwardCoordinate(e,r)}getTriangleCoordinate(e,r){return this.getTriangleCornerCoords(e,r).map(o=>o.x+","+o.y).reduce((o,c)=>o+","+c)}getDownwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new M(.5*this.SPACE_SIZE*e,c);return[h,new M(i,u),new M(o,c),h]}getUpwardCoordinate(e,r){const i=.5*this.SPACE_SIZE*(e+1),o=.5*this.SPACE_SIZE*(e+2),c=this.SPACE_SIZE*r,u=this.SPACE_SIZE*(r+1),h=new M(.5*this.SPACE_SIZE*e,u);return[h,new M(i,c),new M(o,u),h]}getPyramidCoordinate(e,r){return(e+r)%2==1?this.getDownwardPyramidCoordinate(e,r):this.getUpwardPyramidCoordinate(e,r)}getDownwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=this.SPACE_SIZE*r,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i+this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}getUpwardPyramidCoordinate(e,r){const s=this.SPACE_SIZE*e/2,i=(r+1)*this.SPACE_SIZE,o=s+", "+i,c=s+this.SPACE_SIZE+", "+i,u=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE),h=s+this.SPACE_SIZE/2+", "+(i-this.SPACE_SIZE/2);return o+","+u+","+h+","+o+","+h+","+c+","+o+","+c+","+u+","+h+","+c}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),km=(()=>{class n{}return n.INVALID_DISTANCE=()=>$localize`Your piece must land on one of the closest six triangles with the same color as the triangle on which the piece is.`,n.NOT_ENOUGH_TILES_TO_EXCHANGE=()=>$localize`You do not have enough tiles to exchange in order to capture this piece. Pick one of your piece and move it.`,n.FIRST_CLICK_SHOULD_NOT_BE_NULL=()=>$localize`Your first click must be on the piece that you want to move, or on a piece of your opponent that you want to exchange against two tiles.`,n.CANNOT_CAPTURE_FROM_EMPTY=()=>$localize`You cannot capture from an empty space.`,n})();class sr{constructor(t,e){this.direction=t,this.str=e}static fromCoords(t,e){const r=t.getVectorToward(e),s=sr.STEPS.findIndex(i=>i.direction.equals(r));if(-1===s)throw new Error(km.INVALID_DISTANCE());return sr.STEPS[s]}toInt(){return sr.STEPS.findIndex(t=>t.direction.equals(this.direction))}equals(t){return this===t}toString(){return this.str}}sr.LEFT=new sr(new Ut(-2,0),"LEFT"),sr.UP_LEFT=new sr(be.UP_LEFT,"UP_LEFT"),sr.UP_RIGHT=new sr(be.UP_RIGHT,"UP_RIGHT"),sr.RIGHT=new sr(new Ut(2,0),"RIGHT"),sr.DOWN_LEFT=new sr(be.DOWN_LEFT,"DOWN_LEFT"),sr.DOWN_RIGHT=new sr(be.DOWN_RIGHT,"DOWN_RIGHT"),sr.STEPS=[sr.LEFT,sr.UP_LEFT,sr.UP_RIGHT,sr.RIGHT,sr.DOWN_LEFT,sr.DOWN_RIGHT];class As extends $i{constructor(t,e,r,s){super(),this.start=t,this.step=e,this.landingCoord=r,this.capture=s}static fromMovement(t,e){if(t.isNotInRange(15,10))throw new Error("Starting coord cannot be out of range (width: 15, height: 10).");const r=new M(t.x+e.direction.x,t.y+e.direction.y);if(r.isNotInRange(15,10))throw new Error("Landing coord cannot be out of range (width: 15, height: 10).");return new As(P.of(t),P.of(e),P.of(r),P.empty())}static fromTilesExchange(t){if(t.isNotInRange(15,10))throw new Error("Captured coord cannot be out of range (width: 15, height: 10).");return new As(P.empty(),P.empty(),P.empty(),P.of(t))}static fromCoordToCoord(t,e){const r=sr.fromCoords(t,e);return As.fromMovement(t,r)}isTileExchange(){return this.capture.isPresent()}toString(){return this.isTileExchange()?"CoerceoMove("+this.capture.get().toString()+")":"CoerceoMove("+this.start.get().toString()+" > "+this.step.get().toString()+" > "+this.landingCoord.get().toString()+")"}equals(t){return!(!this.capture.equals(t.capture)||!this.start.equals(t.start)||!this.step.equals(t.step))}}As.encoder=new class extends Cn{maxValue(){return 1035}encodeNumber(n){if(n.isTileExchange()){const t=n.capture.get().y;return 10*n.capture.get().x+t}{const t=n.start.get().y,e=n.start.get().x;return 150*(n.step.get().toInt()+1)+10*e+t}}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%10,e=(n=(n-t)/10)%15;return 0==(n=(n-e)/15)?As.fromTilesExchange(new M(e,t)):As.fromMovement(new M(e,t),sr.STEPS[n-1])}};class Oc{static getNeighbors(t){let e;const r=new M(t.x-1,t.y),s=new M(t.x+1,t.y);return e=(t.x+t.y)%2==1?[r,s,new M(t.x,t.y-1)]:[r,s,new M(t.x,t.y+1)],e}static getFakeNeighbors(t){return new M(t.x,(t.x+t.y)%2==1?t.y+1:t.y-1)}static getCommonNeighbor(t,e){const r=Oc.getNeighbors(t),s=Oc.getNeighbors(e);let i=0;for(;i<r.length;){const o=r[i];let c=0;for(;c<s.length;){if(o.equals(s[c]))return P.of(o);c++}i++}return P.empty()}static isSpaceDark(t){return(t.x+t.y)%2==0}}class _5 extends ps{static getEmptyNeighbors(t,e,r){const s=[];for(const i of Oc.getNeighbors(e))i.isInRange(t[0].length,t.length)&&t[i.y][i.x]===r&&s.push(i);return s}getEmptyNeighbors(t,e){return _5.getEmptyNeighbors(this.board,t,e)}}class T1 extends _5{constructor(t,e,r,s){super(t,e),this.tiles=r,this.captures=s}static getTilesUpperLeftCoord(t){const e=t.x-t.x%3;let r=t.y;return r-=e%2==0?t.y%2:(t.y+1)%2,new M(e,r)}static getPresentNeighborEntrances(t){return[new M(t.x+1,t.y-1),new M(t.x+3,t.y+0),new M(t.x+3,t.y+1),new M(t.x+1,t.y+2),new M(t.x-1,t.y+1),new M(t.x-1,t.y+0)].filter(T1.isInRange)}static getInitialState(){const t=Ae.EMPTY,e=Ae.UNREACHABLE,r=Ae.ZERO,s=Ae.ONE;return new T1([[e,e,e,e,e,e,r,t,r,e,e,e,e,e,e],[e,e,e,t,t,r,t,t,t,r,t,t,e,e,e],[t,s,t,s,t,t,r,t,r,t,t,s,t,s,t],[s,t,t,t,s,t,t,t,t,t,s,t,t,t,s],[t,s,t,s,t,t,t,t,t,t,t,s,t,s,t],[t,r,t,r,t,t,t,t,t,t,t,r,t,r,t],[r,t,t,t,r,t,t,t,t,t,r,t,t,t,r],[t,r,t,r,t,t,s,t,s,t,t,r,t,r,t],[e,e,e,t,t,s,t,t,t,s,t,t,e,e,e],[e,e,e,e,e,e,s,t,s,e,e,e,e,e,e]],0,[0,0],[0,0])}applyLegalMovement(t){K(T1.VERBOSE,{coerceoState_applyLegalMovement:{object:this,move:t}});const e=t.start.get(),r=t.landingCoord.get(),s=this.getCopiedBoard();return s[r.y][r.x]=Ae.ofPlayer(this.getCurrentPlayer()),s[e.y][e.x]=Ae.EMPTY,new T1(s,this.turn,this.tiles,this.captures)}doMovementCaptures(t){K(T1.VERBOSE,{coerceoState_doMovementCaptures:{object:this,move:t}});const e=this.getCapturedNeighbors(t.landingCoord.get());let r=this;for(const s of e)r=r.capture(s);return r}getCapturedNeighbors(t){const e=this.getCurrentOpponent();return Oc.getNeighbors(t).filter(s=>!s.isNotInRange(15,10)&&!!this.getPieceAt(s).is(e)&&this.isSurrounded(s))}isSurrounded(t){return 0===this.getEmptyNeighbors(t,Ae.EMPTY).length}capture(t){K(T1.VERBOSE,{coerceoState_captureIfNeeded:{object:this,coord:t}});const e=this.getCopiedBoard(),r=[this.captures[0],this.captures[1]];return K(T1.VERBOSE,t.toString()+" has been captured"),e[t.y][t.x]=Ae.EMPTY,r[this.getCurrentPlayer().value]+=1,new T1(e,this.turn,this.tiles,r)}removeTilesIfNeeded(t,e){K(T1.VERBOSE,{coerceoState_removeTilesIfNeeded:{object:this,piece:t,countTiles:e}});let r=this;const s=T1.getTilesUpperLeftCoord(t);if(this.isTileEmpty(s)&&this.isDeconnectable(s)){r=this.deconnectTile(s,e);const i=T1.getPresentNeighborEntrances(s);for(const o of i){const c=r.getPieceAt(o);c===Ae.EMPTY?r=r.removeTilesIfNeeded(o,e):c.is(this.getCurrentOpponent())&&r.isSurrounded(o)&&(r=r.capture(o))}}return r}isTileEmpty(t){ye(this.getPieceAt(t)!==Ae.UNREACHABLE,"Should not call isTileEmpty on removed tile");for(let e=0;e<2;e++)for(let r=0;r<3;r++){const s=t.getNext(new Ut(r,e),1);if(this.getPieceAt(s)!==Ae.EMPTY)return!1}return!0}isDeconnectable(t){const e=this.getPresentNeighborTilesRelativeIndexes(t);if(e.length>3)return!1;let r=0;for(let s=1;s<e.length;s++)!1===this.areNeighbor(e[s-1],e[s])&&(r+=1);return!1===this.areNeighbor(e[0],e[e.length-1])&&(r+=1),r<=1}areNeighbor(t,e){return t+1===e||0===t&&5===e}getPresentNeighborTilesRelativeIndexes(t){const e=[];let r=P.empty();for(let s=0;s<6;s++){const o=t.getNext(T1.NEIGHBORS_TILES_DIRECTIONS[s],1);o.isInRange(15,10)&&this.getPieceAt(o)!==Ae.UNREACHABLE&&(r.isAbsent()&&(r=P.of(s)),e.push(s-r.get()))}return e}deconnectTile(t,e){K(T1.VERBOSE,{coerceoState_deconnectTile:{object:this,tileUpperLeft:t,countTiles:e}});const r=this.getCopiedBoard(),s=t.x,i=t.y;for(let c=0;c<2;c++)for(let u=0;u<3;u++)r[i+c][s+u]=Ae.UNREACHABLE;const o=[this.tiles[0],this.tiles[1]];return e&&(o[this.getCurrentPlayer().value]+=1),new T1(r,this.turn,o,this.captures)}getLegalLandings(t){const e=[];for(const r of sr.STEPS){const s=t.getNext(r.direction,1);this.isOnBoard(s)&&this.getPieceAt(s)===Ae.EMPTY&&e.push(s)}return e}getPiecesByFreedom(){const t=[[0,0,0,0],[0,0,0,0]];for(let e=0;e<10;e++)for(let r=0;r<15;r++){const s=this.board[e][r];if(s.isPlayer()){const i=this.getEmptyNeighbors(new M(r,e),Ae.EMPTY).length;t[s.value][i]=t[s.value][i]+1}}return t}}T1.VERBOSE=!1,T1.NEIGHBORS_TILES_DIRECTIONS=[new Ut(0,-2),new Ut(3,-1),new Ut(3,1),new Ut(0,2),new Ut(-3,1),new Ut(-3,-1)],T1.isInRange=n=>n.isInRange(15,10);let gP=(()=>{class n extends Z1{applyLegalMove(e,r,s){return e.isTileExchange()?this.applyLegalTileExchange(e,r):this.applyLegalMovement(e,r)}applyLegalTileExchange(e,r){const s=r.getCopiedBoard(),i=e.capture.get();s[i.y][i.x]=Ae.EMPTY;const o=[r.captures[0],r.captures[1]];o[r.getCurrentPlayer().value]+=1;const c=[r.tiles[0],r.tiles[1]];c[r.getCurrentPlayer().value]-=2;const u=new T1(s,r.turn,c,o),h=u.removeTilesIfNeeded(i,!1),p=new T1(h.getCopiedBoard(),h.turn+1,h.tiles,h.captures);return K(n.VERBOSE,{coerceoRules_applyLegalTileExchange:{a_initialState:r,afterCapture:u,afterTileRemoval:h,resultingState:p}}),p}applyLegalMovement(e,r){const s=r.applyLegalMovement(e),i=s.removeTilesIfNeeded(e.start.get(),!0),o=i.doMovementCaptures(e),c=new T1(o.board,r.turn+1,o.tiles,o.captures);return K(n.VERBOSE,{ab_state:r,afterMovement:s,afterTilesRemoved:i,afterCaptures:o,resultingState:c}),c}isLegal(e,r){return e.isTileExchange()?this.isLegalTileExchange(e,r):this.isLegalMovement(e,r)}isLegalTileExchange(e,r){if(r.tiles[r.getCurrentPlayer().value]<2)return $.failure(km.NOT_ENOUGH_TILES_TO_EXCHANGE());const s=r.getPieceAt(e.capture.get());return s===Ae.UNREACHABLE||s===Ae.EMPTY?$.failure(km.CANNOT_CAPTURE_FROM_EMPTY()):s.is(r.getCurrentPlayer())?$.failure(rt.CANNOT_SELF_CAPTURE()):$.success(void 0)}isLegalMovement(e,r){if(r.getPieceAt(e.start.get())===Ae.UNREACHABLE){const o="Cannot start with a coord outside the board "+e.start.get().toString()+".";return $.failure(o)}if(r.getPieceAt(e.landingCoord.get())===Ae.UNREACHABLE){const o="Cannot end with a coord outside the board "+e.landingCoord.get().toString()+".";return $.failure(o)}const s=r.getPieceAt(e.start.get());return s===Ae.EMPTY?$.failure(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):s.is(r.getCurrentOpponent())?$.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):r.getPieceAt(e.landingCoord.get()).is(r.getCurrentPlayer())?$.failure(rt.MUST_LAND_ON_EMPTY_SPACE()):$.success(void 0)}static getGameStatus(e){const r=e.gameState;return r.captures[0]>=18?xe.ZERO_WON:r.captures[1]>=18?xe.ONE_WON:xe.ONGOING}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class $ce extends $1{getListMoves(t){let e=this.getListExchanges(t);return e=e.concat(this.getListMovement(t)),this.putCaptureFirst(t,e)}getListExchanges(t){const e=[],r=t.gameState,s=r.getCurrentPlayer().value,i=Ae.ofPlayer(r.getCurrentOpponent());if(r.tiles[s]<2)return e;for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new M(c,o);if(r.getPieceAt(u)===i){const h=As.fromTilesExchange(u);e.push(h)}}return e}getListMovement(t){const e=[],r=t.gameState,s=r.getCurrentPlayer();for(let i=0;i<10;i++)for(let o=0;o<15;o++){const c=new M(o,i);if(r.getPieceAt(c).is(s)){const u=r.getLegalLandings(c);for(const h of u){const p=As.fromCoordToCoord(c,h);e.push(p)}}}return e}getBoardValue(t){const e=gP.getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const r=t.gameState,s=r.getPiecesByFreedom(),i=this.getPiecesScore(s);return new Ct(2*r.captures[1]+i[1]-(2*r.captures[0]+i[0]))}getPiecesScore(t){return[this.getPlayerPiecesScore(t[0]),this.getPlayerPiecesScore(t[1])]}getPlayerPiecesScore(t){return 3*t[0]+1*t[1]+3*t[2]+3*t[3]}putCaptureFirst(t,e){return Ke.sortByDescending(e,r=>this.moveCapturesList(t,r).length),e}moveCapturesList(t,e){return e.isTileExchange()?[e.capture.get()]:t.gameState.applyLegalMovement(e).removeTilesIfNeeded(e.start.get(),!0).getCapturedNeighbors(e.landingCoord.get())}}let w4t=(()=>{class n extends $ce{getBoardValue(e){const r=gP.getGameStatus(e);if(r.isEndGame)return Ct.fromWinner(r.winner);const s=e.gameState,i=this.getPiecesMap(s),o=this.getThreatMap(s,i),c=this.filterThreatMap(o,s);let u=0;for(const h of z.PLAYERS)for(const p of i.get(h).get())c.get(p).isPresent()?u+=h.getScoreModifier()*n.SCORE_BY_THREATENED_PIECE:u+=h.getScoreModifier()*n.SCORE_BY_SAFE_PIECE;return u+=s.tiles[1]-s.tiles[0],new Ct(u)}getPiecesMap(e){const r=new zn,s=[],i=[];for(let o=0;o<10;o++)for(let c=0;c<15;c++){const u=new M(c,o),h=e.getPieceAt(u);h===Ae.ZERO?s.push(u):h===Ae.ONE&&i.push(u)}return r.set(z.ZERO,new vr(s)),r.set(z.ONE,new vr(i)),r}getThreatMap(e,r){const s=new zn;for(const i of z.PLAYERS)for(const o of r.get(i).get()){const c=this.getThreat(o,e);c.isPresent()&&s.set(o,c.get())}return s}getThreat(e,r){const i=z.of(r.getPieceAt(e).value).getOpponent();let o=P.empty(),c=P.empty(),u=[];const h=Oc.getNeighbors(e).filter(p=>p.isInRange(15,10));for(const p of h){const m=r.getPieceAt(p);if(m.is(i))u.push(p),this.tileCouldBeRemovedThisTurn(p,r,i)&&(c=P.of(p));else if(m===Ae.EMPTY){if(o.isPresent())return P.empty();o=P.of(p)}}if(o.isPresent()){const p=[];for(const m of sr.STEPS){const C=o.get().getNext(m.direction,1);C.isInRange(15,10)&&r.getPieceAt(C).is(i)&&!1===u.some(w=>w.equals(C))&&p.push(C)}if(p.length>0)return P.of(new hP(new vr(u),new vr(p)))}if(c.isPresent()){u=u.filter(m=>m.equals(c.get()));const p=new vr(u);return P.of(new hP(p,new vr([c.get()])))}return P.empty()}tileCouldBeRemovedThisTurn(e,r,s){const i=s.getOpponent();if(!1===r.isDeconnectable(e))return!1;let c=P.empty();const u=T1.getTilesUpperLeftCoord(e);for(let h=0;h<2;h++)for(let p=0;p<3;p++){const m=u.getNext(new Ut(p,h),1);if(r.getPieceAt(m).is(s)){if(!this.pieceCouldLeaveTheTile(m,r))return!1;c=P.of(m)}else if(r.getPieceAt(m).is(i))return!1}return c.isPresent()}pieceCouldLeaveTheTile(e,r){const s=T1.getTilesUpperLeftCoord(e);for(const i of sr.STEPS){const o=e.getNext(i.direction,1),c=T1.getTilesUpperLeftCoord(o);if(!1===s.equals(c)&&r.getPieceAt(o)===Ae.EMPTY)return!0}return!1}filterThreatMap(e,r){const s=new zn,i=e.listKeys(),o=i.filter(u=>r.getPieceAt(u).is(r.getCurrentPlayer())),c=new vr(i.filter(u=>r.getPieceAt(u).is(r.getCurrentOpponent())));for(const u of o){const h=e.get(u).get();let p=P.empty();for(const m of h.directThreats)if(!1===c.contains(m)){const C=[];for(const w of h.mover)!1===c.contains(w)&&C.push(w);C.length>0&&(p=P.of(new hP(h.directThreats,new vr(C))))}p.isPresent()&&s.set(u,p.get())}for(const u of c){const h=e.get(u).get();s.set(u,h)}return s}}return n.SCORE_BY_THREATENED_PIECE=1e3,n.SCORE_BY_SAFE_PIECE=1e6,n})();const he=Ae.EMPTY,F=Ae.UNREACHABLE,U1=Ae.ZERO,Qn=Ae.ONE;class Uce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Board and goal of the game`,$localize`Coerceo is played on a board like this, composed of hexagonal tiles, each comprising 6 triangles.
         The triangles are the spaces on which pieces move during the game.
         The tiles can be removed from the board (you will see how later).
         The dark pieces belong to the first player and can only move on the dark spaces,
         while the light pieces belong to the second player and can only move on the light spaces.
         The goal of the game is to capture all of the opponent's pieces.`,T1.getInitialState()),ce.anyMove($localize`Move`,$localize`To move a piece, you need to:
        <ol>
          <li>Click on one of your pieces.</li>
          <li>Click on one of the triangular space highlighted in yellow.</li>
        </ol>
        You can pass through the opponent's pieces.<br/><br/>
        You're playing first, hence you're playing Dark.
        Perform any move.`,T1.getInitialState(),As.fromCoordToCoord(new M(3,5),new M(5,5)),$localize`Congratulations! Let's see captures now.`),ce.fromMove($localize`Capture`,$localize`Every piece has three neighboring triangular spaces (2 on the sides).
        When all neighboring spaces except one are occupied, and one opponent moves to that last free space, your piece is captured!
        However, it is possible to place a piece between 3 of the opponent's pieces (or 2 on the side) without being captured.<br/><br/>
        You're playing Light, make a capture.`,new T1([[F,F,F,F,F,F,U1,he,U1,F,F,F,F,F,F],[F,F,F,U1,he,he,he,he,he,U1,he,he,F,F,F],[he,Qn,he,Qn,U1,Qn,he,he,U1,he,he,Qn,he,Qn,he],[Qn,he,he,he,he,he,he,he,he,he,Qn,he,he,he,Qn],[he,Qn,he,Qn,he,he,he,he,he,he,he,Qn,he,Qn,he],[he,U1,he,U1,he,he,he,he,he,he,he,U1,he,U1,he],[U1,he,he,he,U1,he,he,he,he,he,U1,he,he,he,U1],[he,U1,he,U1,he,he,Qn,he,Qn,he,he,U1,he,U1,he],[F,F,F,he,he,Qn,he,he,he,Qn,he,he,F,F,F],[F,F,F,F,F,F,Qn,he,Qn,F,F,F,F,F,F]],3,[0,0],[0,0]),[As.fromCoordToCoord(new M(5,2),new M(4,1)),As.fromCoordToCoord(new M(3,4),new M(4,3))],$localize`Congratulations!`,$localize`Failed, you have not captured any piece.`),ce.fromMove($localize`Gain a tile`,$localize`When a tile is empty, it can become removable from the board.
        For it to be removable, at least three of its sides must be free, and these should be neighboring sides.
        Note that if one empty tile, neighboring a tile that was just removed, also becomes removable, it will be removed too.
        For example, here, the topmost dark piece will not disconnect its tile when leaving it.
        But, by leaving the bottom left tile, two tiles will be removed.<br/><br/>
        You're playing Dark, perform a move that lets you gain two tiles.`,new T1([[F,F,F,F,F,F,he,he,he,F,F,F,F,F,F],[F,F,F,F,F,F,Qn,he,he,F,F,F,F,F,F],[he,he,he,F,F,F,he,he,he,F,F,F,F,F,F],[he,he,Qn,he,he,he,he,U1,he,F,F,F,F,F,F],[he,he,he,Qn,he,he,he,he,he,F,F,F,F,F,F],[he,he,he,he,he,he,he,he,he,he,he,U1,F,F,F],[he,he,U1,he,he,Qn,he,he,he,he,U1,he,he,he,U1],[he,he,he,he,he,he,Qn,he,Qn,he,he,U1,he,U1,he],[F,F,F,he,he,Qn,he,he,he,Qn,he,he,F,F,F],[F,F,F,F,F,F,Qn,he,Qn,F,F,F,F,F,F]],2,[0,0],[0,0]),[As.fromCoordToCoord(new M(2,6),new M(4,6)),As.fromCoordToCoord(new M(2,6),new M(3,5)),As.fromCoordToCoord(new M(2,6),new M(3,7))],$localize`Congratulations!`,$localize`Failed, you have not gained the two tiles that you could, try again!`),ce.fromMove($localize`Exchanging a tile`,$localize`When you have a tile, you can see it on the left of the board.
        As soon as you have two, you can click on an opponent's piece to capture it immediately instead of moving one of your pieces.
        This will cost you two tiles.
        If any tiles are removed during that turn, nobody will get them.<br/><br/>
        You're playing Light, gain some time and capture the last piece to win directly!`,new T1([[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,he,he,U1,F,F,F,F,F,F,F,F,F],[F,F,F,he,he,he,he,he,he,F,F,F,F,F,F],[F,F,F,he,he,he,Qn,he,Qn,F,F,F,F,F,F],[F,F,F,he,he,Qn,he,he,he,F,F,F,F,F,F],[F,F,F,F,F,F,Qn,he,Qn,F,F,F,F,F,F]],1,[0,2],[0,0]),[As.fromTilesExchange(new M(5,5))],$localize`Congratulations!`,$localize`It's nice to move a piece, but you could have had the opponent's piece immediately by clicking on it!`),ce.fromMove($localize`Special capture`,$localize`When a tile is removed from the board during your turn, some of the opponent's pieces may have lost their last free neighboring space, they will therefore be captured!
        If this happens to one of your piece during your turn, it will however stay on the board.<br/><br/>
        A move that demonstrates both of these things can be done on this board by Light. Try it!`,new T1([[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,he,he,U1,F,F,F,F,F,F],[F,F,F,he,he,U1,he,he,he,F,F,F,F,F,F],[F,F,F,he,U1,Qn,he,Qn,he,F,F,F,F,F,F],[F,F,F,he,Qn,U1,he,he,he,F,F,F,F,F,F],[F,F,F,he,he,Qn,F,F,F,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,F]],1,[0,0],[0,0]),[As.fromCoordToCoord(new M(7,6),new M(6,5)),As.fromCoordToCoord(new M(7,6),new M(8,5))],$localize`Congratulations! See, your piece no longer had any empty neighboring space after you have gained the tile, but it stayed on the board as it was your turn.
        However, the opponent's piece has disappeared because the tile's capture has removed its last empty neighboring space.`,$localize`Failed. Try again.`)]}}function b4t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPyramidClass(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function O4t(n,t){if(1&n&&(B(),X(0,"polygon",13)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getEmptyClass(e,r)),D("points",s.getTriangleCoordinate(e,r))}}function N4t(n,t){if(1&n&&(B(),x(0,O4t,1,2,"polygon",12)),2&n){const e=v().index,r=v().index;T("ngIf",v().isEmptySpace(e,r))}}function A4t(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=v().index,r=v().index,s=v();We("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function I4t(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=v().index,r=v().index,s=v();We("id","dark_line_",e,"_",r,""),D("points",s.getLineCoordinate(e,r))}}function x4t(n,t){if(1&n){const e=Oe();B(),b(0,"g",6),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),x(1,b4t,1,2,"polygon",7),x(2,N4t,1,1,"ng-template",null,8,c1),x(4,A4t,1,3,"polygon",9),x(5,I4t,1,3,"polygon",10),O()}if(2&n){const e=t.$implicit,r=t.index,s=t1(3),i=v().index,o=v();We("id","click_",r,"_",i,""),S(1),T("ngIf",o.isPyramid(r,i))("ngIfElse",s),S(3),T("ngIf",e!==o.NONE),S(1),T("ngIf",e!==o.NONE)}}function k4t(n,t){if(1&n&&(B(),b(0,"g"),x(1,x4t,6,6,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function L4t(n,t){if(1&n&&(B(),X(0,"polygon",16)),2&n){const e=t.$implicit;D("points",v().getTriangleCoordinate(e.x,e.y))}}function R4t(n,t){if(1&n&&(B(),X(0,"polygon",17)),2&n){const e=v();D("points",e.getTriangleCoordinate(e.lastStart.get().x,e.lastStart.get().y))}}function D4t(n,t){if(1&n&&(B(),X(0,"polygon",17)),2&n){const e=v();D("points",e.getTriangleCoordinate(e.lastEnd.get().x,e.lastEnd.get().y))}}function z4t(n,t){if(1&n&&(B(),X(0,"polygon",18)),2&n){const e=v();We("id","selected_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}const V4t=function(n){return["base",n]};function H4t(n,t){if(1&n&&(B(),b(0,"g",20),X(1,"polygon",21),b(2,"text",22),Pt(3),O()()),2&n){const e=v().$implicit,r=v();T("id","tilesCount"+e),S(1),T("ngClass",g3(8,V4t,"player"+e+"-fill")),D("points",r.getTilesCountCoordinate(0===e?0:4.5,0===e?0:6))("stroke",r.lastTurnWasTilesExchange(e)?"yellow":"black"),S(1),D("x",r.SPACE_SIZE/2+r.SPACE_SIZE*(0==e?0:6.4))("y",16+r.SPACE_SIZE/2+r.SPACE_SIZE*(0===e?0:8.5))("font-size",r.SPACE_SIZE/2),S(1),a1(r.tiles[e])}}function F4t(n,t){if(1&n&&(B(),b(0,"g"),x(1,H4t,4,10,"g",19),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngIf",r.mustShowTilesOf(e))}}const B4t=function(){return[0,1]};let $4t=(()=>{class n extends Bce{constructor(e){super(e),this.tiles=[0,0],this.NONE=Ae.UNREACHABLE,this.chosenCoord=P.empty(),this.lastStart=P.empty(),this.lastEnd=P.empty(),this.possibleLandings=[],this.scores=P.of([0,0]),this.rules=new gP(T1),this.availableMinimaxes=[new $ce(this.rules,"Normal"),new w4t(this.rules,"Piece > Threat > Tiles")],this.encoder=As.encoder,this.tutorial=(new Uce).tutorial,this.SPACE_SIZE=70,this.updateBoard()}updateBoard(){this.chosenCoord=P.empty(),this.state=this.getState(),this.scores=P.of(this.state.captures),this.tiles=this.state.tiles;const e=this.rules.node.move;e.isPresent()?(this.lastStart=e.get().start,this.lastEnd=e.get().landingCoord):(this.lastStart=P.empty(),this.lastEnd=P.empty()),this.board=this.getState().board}showHighlight(){this.possibleLandings=this.state.getLegalLandings(this.chosenCoord.get())}cancelMoveAttempt(){this.chosenCoord=P.empty(),this.possibleLandings=[]}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.state.getCurrentPlayer();return s.chosenCoord.equalsValue(o)?(s.cancelMoveAttempt(),U.SUCCESS):s.chosenCoord.isAbsent()||s.state.getPieceAt(o).is(c)?s.firstClick(o):s.secondClick(o)})()}firstClick(e){var r=this;return A(function*(){const s=r.state.getPieceAt(e);if(s.is(r.state.getCurrentOpponent())){const i=As.fromTilesExchange(e);return r.chooseMove(i,r.state,r.state.captures)}return s.is(r.state.getCurrentPlayer())?(r.chosenCoord=P.of(e),r.showHighlight(),U.SUCCESS):r.cancelMove(km.FIRST_CLICK_SHOULD_NOT_BE_NULL())})()}secondClick(e){var r=this;return A(function*(){if(r.possibleLandings.some(s=>s.equals(e))){const s=As.fromCoordToCoord(r.chosenCoord.get(),e);return r.chooseMove(s,r.state,r.state.captures)}return r.cancelMove(km.INVALID_DISTANCE())})()}isPyramid(e,r){return this.board[r][e].isPlayer()||this.wasOpponent(e,r)}wasOpponent(e,r){const s=this.rules.node.mother;return s.isPresent()&&s.get().gameState.getPieceAtXY(e,r).is(s.get().gameState.getCurrentOpponent())}getPyramidClass(e,r){const s=this.board[r][e];return s===Ae.ZERO?this.getPlayerClass(z.ZERO):s===Ae.ONE?this.getPlayerClass(z.ONE):"captured-fill"}isEmptySpace(e,r){return this.board[r][e]===Ae.EMPTY||this.wasRemoved(e,r)}wasRemoved(e,r){const i=this.rules.node.mother;if(this.board[r][e]===Ae.UNREACHABLE&&i.isPresent()){const o=i.get().gameState.getPieceAtXY(e,r);return o===Ae.EMPTY||o.is(i.get().gameState.getCurrentPlayer())}return!1}getEmptyClass(e,r){return this.board[r][e]===Ae.EMPTY?(e+r)%2==1?"background":"background2":"captured-alternate-fill"}getTilesCountCoordinate(e,r){const s=100*e,i=100*r,o=s+25;return o+", "+i+", "+(s+75)+", "+i+", "+(s+100)+", "+(i+50)+", "+(s+75)+", "+(i+100)+", "+(s+25)+", "+(i+100)+", "+(s+0)+", "+(i+50)+", "+o+", "+i}getLineCoordinate(e,r){const s=this.getTriangleCornerCoords(e,r);return e%3==0?s[0].x+","+s[0].y+","+s[1].x+","+s[1].y:e%3==1?s[0].x+","+s[0].y+","+s[2].x+","+s[2].y:s[1].x+","+s[1].y+","+s[2].x+","+s[2].y}mustShowTilesOf(e){return this.tiles[e]>0||this.lastTurnWasTilesExchange(e)}lastTurnWasTilesExchange(e){return!this.rules.node.mother.isAbsent()&&this.rules.node.mother.get().gameState.tiles[e]>this.tiles[e]}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-coerceo"]],features:[l],decls:7,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke",4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke",4,"ngIf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["class","base mid-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf","ngIfElse"],["emptySpace",""],["class","base",3,"id",4,"ngIf"],["class","white-stroke",3,"id",4,"ngIf"],["stroke-linecap","round",1,"base","mid-stroke",3,"ngClass"],["class","base small-stroke","stroke-linecap","round",3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base","small-stroke",3,"ngClass"],[1,"base",3,"id"],[1,"white-stroke",3,"id"],[1,"base","no-fill","selectable-stroke"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke",3,"id"],[3,"id",4,"ngIf"],[3,"id"],["stroke-linecap","round",3,"ngClass"],["id","playerZeroTilesCount",1,"text-giant"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,k4t,2,1,"g",1),x(2,L4t,1,1,"polygon",2),x(3,R4t,1,1,"polygon",3),x(4,D4t,1,1,"polygon",3),x(5,z4t,1,3,"polygon",4),x(6,F4t,2,1,"g",1),O()),2&e&&(D("viewBox","-5 -5 "+(10+8*r.SPACE_SIZE)+" "+(10+10*r.SPACE_SIZE)),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.possibleLandings),S(1),T("ngIf",r.lastStart.isPresent()),S(1),T("ngIf",r.lastEnd.isPresent()),S(1),T("ngIf",r.chosenCoord.isPresent()),S(1),T("ngForOf",tr(7,B4t)))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class U4t extends $1{getListMoves(t){return this.sortByNumberOfJump(t.gameState.turn<40?this.getListMovesDrop(t.gameState):this.getListMovesAfterDrop(t.gameState))}sortByNumberOfJump(t){return t.sort((e,r)=>{const s=e.isDrop()?1:e.isSimple()?2:e.coords.length;return(r.isDrop()?1:r.isSimple()?2:r.coords.length)-s})}getListMovesDrop(t){const e=[],r=Rt.CENTRAL_ZONE_TOP_LEFT,s=Rt.CENTRAL_ZONE_BOTTOM_RIGHT;for(let i=r.y;i<=s.y;i++)for(let o=r.x;o<=s.x;o++)t.getPieceAtXY(o,i)===pe.NONE&&e.push(Q0.of(new M(o,i)).get());return e}getListMovesAfterDrop(t){let e=[];const r=t.getCurrentPlayer();for(let s=0;s<Rt.HEIGHT;s++)for(let i=0;i<Rt.WIDTH;i++){const o=new M(i,s);t.getPieceAt(o)===r&&(e=e.concat(this.getListSimpleMoves(t,o)),e=e.concat(this.getListJumps(t,o)))}return e}getListSimpleMoves(t,e){const r=[],s=[new M(e.x+1,e.y),new M(e.x-1,e.y),new M(e.x,e.y+1),new M(e.x,e.y-1),new M(e.x+1,e.y+1),new M(e.x+1,e.y-1),new M(e.x-1,e.y+1),new M(e.x-1,e.y-1)];for(const i of s){const o=J0.from(e,i);o.isSuccess()&&Ga.get().simpleMoveLegality(o.get(),t).isSuccess()&&r.push(o.get())}return r}getListJumps(t,e){const r=new Ht;for(const s of Ga.get().jumpTargetsFrom(e)){const i=b3.of([e,s]).get();Ga.get().jumpLegality(i,t).isSuccess()&&(r.add(i),r.addAll(this.getListJumpStartingFrom(t,i)))}return r.toList()}getListJumpStartingFrom(t,e){const r=Ga.get().nextJumps(e,t),s=new Ht(r);for(const i of r)s.addAll(this.getListJumpStartingFrom(t,i));return s}getBoardValue(t){const e=t.gameState;let r=0;const s=new zn([{key:z.ZERO,value:0},{key:z.ONE,value:0}]);for(let i=0;i<Rt.HEIGHT;i++)for(let o=0;o<Rt.WIDTH;o++){const c=new M(o,i),u=e.getPieceAt(c);if(u.isPlayer())if(e.isShelter(c)){if(r+=20*u.getScoreModifier(),s.replace(u,s.get(u).get()+1),20===s.get(u).get())return new Ct(u.getVictoryValue())}else{let h=100;for(const p of Rt.ALL_SHELTERS)if(e.getPieceAt(p)===pe.NONE){const m=c.getOrthogonalDistance(p);h=Math.min(h,m)}r-=u.getScoreModifier()*h}}return new Ct(r)}}function G4t(n,t){if(1&n){const e=Oe();B(),b(0,"rect",9),J("click",function(){fe(e);const s=v().$implicit;return ae(v(2).onClick(s.coord))}),O()}if(2&n){const e=v().$implicit,r=v(2);D("x",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.x+r.STROKE_WIDTH)("y",1.5*r.STROKE_WIDTH+r.SPACE_SIZE*e.coord.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE-3*r.STROKE_WIDTH)("height",r.SPACE_SIZE-3*r.STROKE_WIDTH)}}function W4t(n,t){if(1&n){const e=Oe();B(),b(0,"circle",6),J("click",function(){fe(e);const s=v().$implicit;return ae(v(2).onClick(s.coord))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function q4t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",6),J("click",function(){const i=fe(e).$implicit;return ae(v(2).onClick(i.coord))}),O(),x(2,G4t,1,4,"rect",7),x(3,W4t,1,6,"circle",8),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.isShelter),S(1),T("ngIf",e.hasPiece)}}function j4t(n,t){if(1&n&&(B(),b(0,"g"),x(1,q4t,4,9,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Z4t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",10),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),T("ngClass",r.viewInfo.boardInfo[e.y][e.x].shelterClasses),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Y4t(n,t){if(1&n&&(B(),X(0,"circle",11)),2&n){const e=t.$implicit,r=v();C1("id","sidePiece_0_",e,""),D("cx",-r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function K4t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=t.$implicit,r=v();C1("id","sidePiece_1_",e,""),D("cx",1715+r.PIECE_RADIUS)("cy",1670-e*r.PIECE_RADIUS)("r",r.PIECE_RADIUS-5)}}function X4t(n,t){if(1&n&&(B(),X(0,"rect",13)),2&n){const e=v();D("x",e.SPACE_SIZE*e.CENTRAL_ZONE_START.x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.CENTRAL_ZONE_START.y+e.STROKE_WIDTH)("width",e.CENTRAL_ZONE_SIZE.x*e.SPACE_SIZE)("height",e.CENTRAL_ZONE_SIZE.y*e.SPACE_SIZE)}}let Q4t=(()=>{class n extends Y0{constructor(e){super(e),this.ALL_SHELTERS=Rt.ALL_SHELTERS,this.CENTRAL_ZONE_START=Rt.CENTRAL_ZONE_TOP_LEFT,this.CENTRAL_ZONE_SIZE=new Ut(Rt.CENTRAL_ZONE_BOTTOM_RIGHT.x-Rt.CENTRAL_ZONE_TOP_LEFT.x+1,Rt.CENTRAL_ZONE_BOTTOM_RIGHT.y-Rt.CENTRAL_ZONE_TOP_LEFT.y+1),this.viewInfo={dropPhase:!0,boardInfo:[],victory:[],lastMoveArrow:"",sidePieces:[20,20]},this.selected=P.empty(),this.jumpInConstruction=P.empty(),this.PIECE_RADIUS=this.SPACE_SIZE/2-this.STROKE_WIDTH,this.rules=Ga.get(),this.availableMinimaxes=[new U4t(this.rules,"ConspirateursMinimax")],this.encoder=P4t,this.tutorial=(new Vce).tutorial}ngOnInit(){this.updateBoard()}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}updateViewInfo(){const e=this.getState();this.viewInfo.dropPhase=e.isDropPhase(),this.viewInfo.boardInfo=[],this.viewInfo.lastMoveArrow="";for(let r=0;r<Rt.HEIGHT;r++){this.viewInfo.boardInfo.push([]);for(let s=0;s<Rt.WIDTH;s++){const i=new M(s,r),o=e.getPieceAt(i),c={coord:i,squareClasses:[],shelterClasses:[],pieceClasses:[this.getPlayerClass(o)],hasPiece:o.isPlayer(),isShelter:!1,isOccupiedShelter:!1};this.viewInfo.boardInfo[r].push(c)}}this.viewInfo.sidePieces=e.getSidePieces(),this.updateOccupiedShelters(),this.updateSelected(),this.updateVictory()}updateOccupiedShelters(){for(const e of Rt.ALL_SHELTERS){const r=this.viewInfo.boardInfo[e.y][e.x];r.isShelter=!0,r.hasPiece&&r.shelterClasses.push("selectable-stroke")}}updateSelected(){if(this.selected.isPresent())if(this.jumpInConstruction.isPresent()){const e=this.jumpInConstruction.get(),r=e.getStartingCoord(),s=e.getEndingCoord();this.viewInfo.boardInfo[r.y][r.x].hasPiece=!1,this.viewInfo.boardInfo[s.y][s.x].pieceClasses=[this.getPlayerClass(this.getCurrentPlayer()),"selected-stroke"],this.viewInfo.boardInfo[s.y][s.x].hasPiece=!0;for(const i of e.coords)this.viewInfo.boardInfo[i.y][i.x].squareClasses.push("moved-fill")}else{const e=this.selected.get();this.viewInfo.boardInfo[e.y][e.x].pieceClasses.push("selected-stroke")}}updateVictory(){const e=this.getState(),r=Ga.get().getGameStatus(this.rules.node);if(!0===r.isEndGame)for(const s of Rt.ALL_SHELTERS)e.getPieceAt(s)===r.winner&&this.viewInfo.boardInfo[s.y][s.x].squareClasses.push("victory-fill")}showLastMove(){const e=this.rules.node.move.get();if(e.isDrop())this.viewInfo.boardInfo[e.coord.y][e.coord.x].squareClasses.push("moved-fill");else if(e.isSimple())this.viewInfo.boardInfo[e.getStart().y][e.getStart().x].squareClasses.push("moved-fill"),this.viewInfo.boardInfo[e.getEnd().y][e.getEnd().x].squareClasses.push("moved-fill");else{this.viewInfo.lastMoveArrow="";for(const r of e.coords)this.viewInfo.boardInfo[r.y][r.x].squareClasses.push("moved-fill"),this.viewInfo.lastMoveArrow+=r.x*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" ",this.viewInfo.lastMoveArrow+=r.y*this.SPACE_SIZE+this.SPACE_SIZE/2+this.STROKE_WIDTH,this.viewInfo.lastMoveArrow+=" "}}cancelMoveAttempt(){this.jumpInConstruction=P.empty(),this.selected=P.empty(),this.updateBoard()}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());const i=r.getState();if(i.getPieceAt(e)===r.getCurrentPlayer())return r.selected.equalsValue(e)?r.cancelMoveAttempt():(r.selected=P.of(e),r.jumpInConstruction=P.empty()),r.updateViewInfo(),U.SUCCESS;if(r.jumpInConstruction.isPresent())return r.constructJump(e);if(r.selected.isPresent())return r.selectNextCoord(e);if(i.isDropPhase()){const o=Q0.of(e);return ye(o.isSuccess(),"ConspirateursMove should be valid by construction"),r.chooseMove(o.get(),i)}return r.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE())})()}constructJump(e){var r=this;return A(function*(){const s=r.jumpInConstruction.get(),i=r.getState();if(e.equals(s.getEndingCoord()))return r.chooseMove(s,i);{const o=s.addJump(e);if(o.isFailure())return r.cancelMove(o.getReason());const c=r.rules.jumpLegality(o.get(),i);return c.isFailure()?r.cancelMove(c.getReason()):r.updateJump(o.get())}})()}updateJump(e){var r=this;return A(function*(){const s=r.getState();return r.rules.jumpHasPossibleNextTargets(e,s)?(r.jumpInConstruction=P.of(e),r.updateViewInfo(),U.SUCCESS):r.chooseMove(e,s)})()}selectNextCoord(e){var r=this;return A(function*(){const s=r.selected.get(),i=J0.from(s,e);if(i.isSuccess())return r.chooseMove(i.get(),r.getState());{const o=b3.of([s,e]);return o.isFailure()?r.cancelMove(o.getReason()):r.updateJump(o.get())}})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-conspirateurs"]],features:[l],decls:7,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 0 1915 1715","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base mid-stroke player0-fill",3,"id",4,"ngFor","ngForOf"],["class","base mid-stroke player1-fill",3,"id",4,"ngFor","ngForOf"],["class","base no-fill selectable-stroke mid-stroke",4,"ngIf"],["id","lastJump",1,"base","no-fill"],[1,"base",3,"id","ngClass","click"],["class","base no-fill mid-stroke",3,"click",4,"ngIf"],["class","base",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","mid-stroke",3,"click"],[1,"base","no-fill","mid-stroke",3,"ngClass","click"],[1,"base","mid-stroke","player0-fill",3,"id"],[1,"base","mid-stroke","player1-fill",3,"id"],[1,"base","no-fill","selectable-stroke","mid-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,j4t,2,1,"g",1),x(2,Z4t,2,5,"g",1),x(3,Y4t,1,4,"circle",2),x(4,K4t,1,4,"circle",3),x(5,X4t,1,4,"rect",4),X(6,"polyline",5),O()),2&e&&(S(1),T("ngForOf",r.viewInfo.boardInfo),S(1),T("ngForOf",r.ALL_SHELTERS),S(1),T("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[0])),S(1),T("ngForOf",r.ArrayUtils.range(r.viewInfo.sidePieces[1])),S(1),T("ngIf",r.viewInfo.dropPhase),S(1),D("points",r.viewInfo.lastMoveArrow))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class J4t extends $1{getListMoves(t){const e=t.gameState,r=this.getListDrops(e),s=this.getListShifts(e);return r.concat(s)}getListShifts(t){const e=[],r=this.getShiftSources(t);for(const s of r)for(const i of[new b2(s,"clockwise"),new b2(s,"counterclockwise")])O3.get().shiftHeightValidity(i,t).isSuccess()&&e.push(i);return e}getListDrops(t){const e=this.getRemainingPiecesForCurrentPlayer(t),r=[];for(let s=0;s<$r.WIDTH;s++)for(const i of e){const o=new e8(s,i);O3.get().dropHeightValidity(o,t).isSuccess()&&r.push(o)}return r}getRemainingPiecesForCurrentPlayer(t){const e=[];for(const r of En.PLAYER_PIECES)this.currentPlayerCanDropPiece(t,r)&&e.push(r);return e}currentPlayerCanDropPiece(t,e){return t.getCurrentPlayer()===e.owner&&t.getRemainingPiecesOf(e)>0}getShiftSources(t){const e=[],r=t.getCurrentPlayer();for(let s=0;s<$r.HEIGHT;s++)for(let i=0;i<$r.WIDTH;i++)t.getPieceAtXY(i,s).owner===r&&e.push(new M(i,s));return e}getBoardValue(t){const e=O3.get().getGameStatus(t);return e.isEndGame?e.toBoardValue():new Ct(0)}}function elt(n,t){if(1&n){const e=Oe();B(),b(0,"g",6)(1,"path",7),J("click",function(){const i=fe(e).$implicit;return ae(v().onSpaceClick(i))}),O(),b(2,"path",8),J("click",function(){const i=fe(e).$implicit;return ae(v().onSpaceClick(i))}),O()()}if(2&n){const e=t.$implicit,r=v();C1("id","board_space_",e,""),S(1),C1("id","click_",e,""),T("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.BOARD_PATHS[e]),S(1),T("ngClass",r.viewInfo.boardInfo[e].spaceClasses),D("d",r.DECORATION_PATHS[e])}}function tlt(n,t){if(1&n){const e=Oe();B(),b(0,"g",10),J("click",function(){const i=fe(e).$implicit,o=v().$implicit;return ae(v().onPieceInGameClick(o,i.y))}),X(1,"use",11)(2,"use",12),O()}if(2&n){const e=t.$implicit;We("id","click_",v().$implicit,"_",e.y,""),T("ngClass",e.foregroundClasses),S(1),T("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),S(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function nlt(n,t){if(1&n&&(B(),b(0,"g"),x(1,tlt,3,8,"g",9),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.viewInfo.boardInfo[e].pieces)}}function rlt(n,t){if(1&n){const e=Oe();B(),b(0,"g",14),J("click",function(){const s=fe(e),i=s.$implicit,o=s.index;return ae(v(2).onRemainingPieceClick(i.actualPiece,o))}),X(1,"use",11)(2,"use",12),O()}if(2&n){const e=t.$implicit,r=t.index;G2("id","piece_",e.actualPiece.owner.toString(),"_",e.actualPiece.otherPieceType?1:0,"_",r,""),T("ngClass",e.foregroundClasses),S(1),T("ngClass",e.backgroundClasses),D("x",e.drawPosition.x)("y",e.drawPosition.y),S(1),D("x",e.drawPosition.x)("y",e.drawPosition.y)}}function slt(n,t){if(1&n&&(B(),b(0,"g"),x(1,rlt,3,9,"g",13),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.viewInfo.remainingPieces.get(e).get())}}const ilt=function(){return[0,1,2,3,4,5,6,7]},olt=function(){return[2,1,3,0,4,7,5,6]};class N3 extends Y0{constructor(t){super(t),this.BOARD_PATHS=["M 2.8324855,277.57643 164.46619,228.81694 170.57257,148.42756 32.571357,104.19835 Z","M 170.57257,148.42237 246.4213,96.276913 195.13813,2.0233391 32.571357,104.19315 Z","m 195.14159,2.0268021 205.0898,0.010821 -52.1686,94.2453509 -101.64149,-0.0057 z","M 348.06279,96.281239 400.23529,2.0330788 564.39307,104.19207 424.66384,148.41891 Z","m 424.66384,148.42237 7.27882,80.37683 164.9712,48.72701 -32.52079,-173.33068 z","m 431.94266,228.80481 -75.73854,62.15055 79.06197,135.86929 161.64688,-149.29953 z","m 356.20412,290.9506 79.06197,135.86929 -268.2864,0.0433 74.14082,-135.90175 z","M 241.12051,290.96379 166.97969,426.86556 2.8324855,277.57708 164.46619,228.81759 Z"],this.DECORATION_PATHS=["m 170.57257,148.42302 v 40.08918 l -6.11049,80.38634 v -40.09025 z","m 170.57646,188.51696 v -40.08918 l 75.8509,-52.140047 v 40.086147 z","m 246.42323,96.285785 v 40.086155 l 101.63847,-0.003 0.001,-40.082256 z","m 424.66037,148.42345 v 40.08377 l -76.60213,-52.14178 10e-4,-40.082033 z","m 424.66037,148.42193 v 40.08377 l 7.27884,80.37445 v -40.08377 z","m 435.26609,466.90582 v -40.08615 l 161.64688,-149.2995 8.9e-4,40.08701 z","m 166.97969,426.86815 v 40.08638 l 268.28379,-0.0433 v -40.08031 z","m 2.8324855,277.57297 v 40.08636 L 166.97969,466.94782 v -40.08636 z"],this.selected=P.empty(),this.viewInfo={boardInfo:[],remainingPieces:new zn([{key:z.ZERO,value:[]},{key:z.ONE,value:[]}])},this.rules=O3.get(),this.availableMinimaxes=[new J4t(this.rules,"DiamDummyMinimax")],this.encoder=T4t,this.tutorial=(new Fce).tutorial}ngOnInit(){this.updateBoard()}onSpaceClick(t){var e=this;return A(function*(){const r=e.canUserPlay("#click_"+t);return r.isFailure()?e.cancelMove(r.getReason()):e.onSpaceClickAfterCheck(t)})()}onSpaceClickAfterCheck(t){var e=this;return A(function*(){if(e.selected.isPresent()){const r=e.selected.get();let s;if("pieceFromReserve"===r.type)s=new e8(t,r.piece);else if((r.position.x+1)%$r.WIDTH===t)s=new b2(r.position,"clockwise");else{if((r.position.x+($r.WIDTH-1))%$r.WIDTH!==t)return e.cancelMove(xm.MUST_SHIFT_TO_NEIGHBOR());s=new b2(r.position,"counterclockwise")}return e.chooseMove(s,e.getState())}return e.cancelMove(xm.MUST_SELECT_PIECE_FIRST())})()}onPieceInGameClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);return r.getState().getPieceAt(i).owner===r.getCurrentPlayer()?(r.isSelected(null,i)?r.cancelMoveAttempt():r.selected=P.of({type:"pieceFromBoard",position:i}),r.updateViewInfo(),U.SUCCESS):r.selected.isPresent()?r.onSpaceClickAfterCheck(t):r.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE())})()}onRemainingPieceClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay(r.getPieceId(t,e));return s.isFailure()?r.cancelMove(s.getReason()):t.owner===r.getCurrentPlayer()?(r.selected=r.isSelected(t)?P.empty():P.of({type:"pieceFromReserve",piece:t}),r.updateViewInfo(),U.SUCCESS):r.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE())})()}getPieceId(t,e){return"#piece_"+t.owner.toString()+"_"+(t.otherPieceType?1:0)+"_"+e}isSelected(t,e){return!this.selected.isAbsent()&&(null==t&&"pieceFromBoard"===this.selected.get().type?this.selected.get().position.equals(e):this.selected.get().piece===t)}updateBoard(){this.updateViewInfo(),this.rules.node.move.isPresent()&&this.showLastMove()}getLastMovedFromDrop(t,e){const r=this.getDrawPositionRemainingPiece(t.piece,e.getRemainingPiecesOf(t.piece)-1),s=t.getTarget(),i=e.getStackHeight(t.getTarget()),o=this.getDrawPositionOnBoard(s,i),c=new M(s,i);return[{start:P.empty(),end:c,startDrawPosition:r,endDrawPosition:o}]}getLastMovedFromShift(t,e){const r=t.start.x,s=t.getTarget();let i=e.getStackHeight(s);const o=[];for(let c=t.start.y;c<$r.HEIGHT&&e.getPieceAtXY(r,c)!==En.EMPTY;c++,i++)o.push({start:P.of(new M(r,c)),end:new M(s,i),startDrawPosition:this.getDrawPositionOnBoard(r,c),endDrawPosition:this.getDrawPositionOnBoard(s,i)});return o}updateViewInfo(){this.updateBoardInfo(),this.updateRemainingPiecesInfo()}updateBoardInfo(){for(let t=0;t<$r.WIDTH;t++)this.viewInfo.boardInfo[t]={x:t,spaceClasses:[],pieces:this.getPieces(t)}}showLastMove(){this.showLastMoveOnSpaces(),this.showLastMoveOnPieces()}showLastMoveOnSpaces(){const t=this.rules.node.move;ye(t.isPresent(),"showLastMoveOnSpaces called without a last move");const e=t.get();for(let r=0;r<$r.WIDTH;r++){const s=[];e.isDrop()?e.getTarget()===r&&s.push("moved-fill"):(e.getTarget()===r||e.start.x===r)&&s.push("moved-fill"),this.viewInfo.boardInfo[r].spaceClasses=s}}showLastMoveOnPieces(){const t=this.rules.node.move;ye(t.isPresent(),"showLastMoveOnPieces called without a last move");const e=t.get(),r=this.getPreviousState();let s=[];s=e.isDrop()?this.getLastMovedFromDrop(e,r):this.getLastMovedFromShift(e,r);for(const i of s)this.viewInfo.boardInfo[i.end.x].pieces[i.end.y].foregroundClasses.push("last-move-stroke")}updateRemainingPiecesInfo(){const t=this.getCurrentPlayer();this.viewInfo.remainingPieces=new zn([{key:z.ZERO,value:[]},{key:z.ONE,value:[]}]);const e=this.isPlayerTurn();for(const r of En.PLAYER_PIECES){const s=this.getState().getRemainingPiecesOf(r);for(let i=0;i<s;i++){const o=[];this.isTopPieceOfReserveAndSelected(i,s,r)&&o.push("selected-stroke"),e&&i===s-1&&r.owner===t&&o.push("clickable-stroke-hover");const c=this.viewInfo.remainingPieces.get(r.owner).get(),u=[];u.push(r.otherPieceType?"player"+r.owner.value+"-alternate-fill":"player"+r.owner.value+"-fill"),c.push({backgroundClasses:u,foregroundClasses:o,y:i,drawPosition:this.getDrawPositionRemainingPiece(r,i),actualPiece:r}),this.viewInfo.remainingPieces.put(r.owner,c)}}}isTopPieceOfReserveAndSelected(t,e,r){if(this.selected.isPresent()){const s=this.selected.get();return"pieceFromReserve"===s.type&&s.piece===r&&t===e-1}return!1}getDrawPositionRemainingPiece(t,e){let r,s;return r=t.owner===z.ZERO?-100:600,s=t.otherPieceType?100:450,new M(r,s).getNext(new Ut(0,-e*N3.PIECE_HEIGHT))}getPieces(t){const e=this.rules.findHighestAlignment(this.getState()),r=this.isPlayerTurn(),s=[];for(let i=0;i<$r.HEIGHT;i++){const o=this.getState().getPieceAtXY(t,i),c=new M(t,i);if(o!==En.EMPTY){const u=[];this.pieceFromBoardIsSelected(t,i)&&u.push("selected-stroke"),this.isVictory(t,i,e)&&u.push("victory-stroke"),r&&this.rules.pieceCanMove(this.getState(),c)&&u.push("clickable-stroke-hover"),s.push({backgroundClasses:["player"+o.owner.value+(o.otherPieceType?"-alternate-fill":"-fill")],foregroundClasses:u,y:i,drawPosition:this.getDrawPositionOnBoard(t,i),actualPiece:o})}}return s}pieceFromBoardIsSelected(t,e){if(this.selected.isPresent()){const r=this.selected.get();return"pieceFromBoard"===r.type&&r.position.x===t&&r.position.y===e}return!1}isVictory(t,e,r){if(r.isPresent()){const s=r.get();return s.x%4==t%4&&s.y===e}return!1}getDrawPositionOnBoard(t,e){return N3.CENTER[t].getNext(new Ut(0,-e*N3.PIECE_HEIGHT))}cancelMoveAttempt(){this.selected=P.empty(),this.updateBoard()}}N3.CENTER=[new M(40,160),new M(100,50),new M(255,2),new M(400,50),new M(460,160),new M(400,270),new M(255,320),new M(100,270)],N3.PIECE_HEIGHT=36,N3.\u0275fac=function(t){return new(t||N3)(Q(Tn))},N3.\u0275cmp=gt({type:N3,selectors:[["app-diam"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-110 -120 800 710","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 15 v 35 A 40 15, 0, 0, 0, 80 50 v -35 A 40 15, 0, 0, 0, 0 15 Z"],["cx","40","cy","15","rx","40","ry","15"],[3,"id",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"id"],[1,"base","mid-stroke",3,"id","ngClass","click"],[1,"base","mid-stroke","high-brightness",3,"ngClass","click"],["pointer-events","fill","class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"ngClass"],[0,"xlink","href","#piece"],["class","base-no-fill no-fill mid-small-stroke",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base-no-fill","no-fill","mid-small-stroke",3,"id","ngClass","click"]],template:function(t,e){1&t&&(B(),b(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),O()(),x(5,elt,3,6,"g",4),x(6,nlt,2,1,"g",5),x(7,slt,2,1,"g",5),O()),2&t&&(S(5),T("ngForOf",tr(3,ilt)),S(1),T("ngForOf",tr(4,olt)),S(1),T("ngForOf",e.Player.PLAYERS))},dependencies:[mn,Ln],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Wa{constructor(t,e){this.offset=t,this.constant=e}static fromTwoCoords(t,e){const r=t.x,s=e.x,i=t.y,o=e.y,c=r+i,u=s+o;return r===s&&i!==o&&c!==u?P.of(Wa.constantQ(r)):r!==s&&i===o&&c!==u?P.of(Wa.constantR(i)):r!==s&&i!==o&&c===u?P.of(Wa.constantS(c)):P.empty()}static constantQ(t){return new Wa(t,"q")}static constantR(t){return new Wa(t,"r")}static constantS(t){return new Wa(t,"s")}static areOnSameLine(t){if(t.length<2)return!0;const e=Wa.fromTwoCoords(t[0],t[1]);if(e.isAbsent())return!1;const r=e.get();for(const s of t.slice(2))if(!1===r.contains(s))return!1;return!0}toString(){return`Line(${this.constant}, ${this.offset})`}equals(t){return this===t||!(this.offset!==t.offset||this.constant!==t.constant)}contains(t){switch(this.constant){case"q":return t.x===this.offset;case"r":return t.y===this.offset;case"s":return t.x+t.y===this.offset}}getDirection(){switch(this.constant){case"q":return ke.DOWN;case"r":return ke.RIGHT;case"s":return ke.DOWN_LEFT}}}class yH extends ps{constructor(t,e,r,s,i,o){super(e,t),this.board=e,this.width=r,this.height=s,this.excludedSpaces=i,this.empty=o,ye(this.excludedSpaces.length<this.height/2+1,"Invalid excluded spaces specification for HexagonalGameState.")}setAt(t,e){if(this.isOnBoard(t))return this.setAtUnsafe(t,e);throw new Error("Setting coord not on board: "+t+".")}equalsT(t,e){if(this===t)return!0;if(this.width!==t.width||this.height!==t.height||!1===e(this.empty,t.empty)||this.excludedSpaces.length!==t.excludedSpaces.length)return!1;for(let r=0;r<this.excludedSpaces.length;r++)if(this.excludedSpaces[r]!==t.excludedSpaces[r])return!1;for(const r of this.allCoords())if(!1===e(this.getPieceAt(r),t.getPieceAt(r)))return!1;return!0}allCoords(){const t=[];return this.forEachCoord(e=>{t.push(e)}),t}allLines(){const t=[];for(let e=0;e<this.width;e++)t.push(Wa.constantQ(e));for(let e=0;e<this.height;e++)t.push(Wa.constantR(e));for(let e=this.excludedSpaces.length;e<this.height+this.excludedSpaces.length;e++)t.push(Wa.constantS(e));return t}getEntranceOnLine(t){let e,r;switch(t.constant){case"q":return r=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new M(t.offset,r));case"r":return e=null!=this.excludedSpaces[t.offset]?this.excludedSpaces[t.offset]:0,this.findEntranceFrom(t,new M(e,t.offset));case"s":return this.findEntranceFrom(t,t.offset<this.width?new M(t.offset,0):new M(this.width-1,t.offset-this.width+1))}}findEntranceFrom(t,e){const r=t.getDirection();let s=e;for(let o=0;o<Math.max(this.width,this.height);o++){if(this.isOnBoard(s))return s;s=s.getNext(r)}const i=bs.logError("HexagonalGameState.findEntranceFrom","could not find a board entrance, board must be invalid",{start:e.toString(),line:t.toString()});throw new Error(i.getReason())}}class O2{static getNeighbors(t,e=1){const r=[];for(const s of ke.factory.all)r.push(t.getNext(s,e));return r}static areNeighbors(t,e){for(const r of ke.factory.all)if(t.getNext(r).equals(e))return!0;return!1}}class Jn{constructor(t,e,r){this.owner=t,this.size=e,this.source=r}static append(t,e){return new Jn(t.owner,t.size+e.size,t.source||e.source)}getValue(){return Jn.encoder.encodeNumber(this)}getOwner(){return this.owner}belongsTo(t){return this.owner===t}containsSource(){return this.source}isEmpty(){return 0===this.size}hasPieces(){return!1===this.isEmpty()}getSize(){return this.size}toString(){return"DvonnPieceStack("+this.owner.toString()+", "+this.size+", "+this.source+")"}}Jn.sizeEncoder=Cn.numberEncoder(49),Jn.encoder=Cn.tuple([Cn.booleanEncoder,z.numberEncoder,Jn.sizeEncoder],n=>[n.source,n.owner,n.size],n=>new Jn(n[1],n[2],n[0])),Jn.MAX_SIZE=49,Jn.EMPTY=new Jn(pe.NONE,0,!1),Jn.UNREACHABLE=new Jn(pe.NONE,-1,!1),Jn.PLAYER_ZERO=new Jn(z.ZERO,1,!1),Jn.PLAYER_ONE=new Jn(z.ONE,1,!1),Jn.SOURCE=new Jn(pe.NONE,1,!0);let qa=(()=>{class n extends yH{constructor(e,r,s){super(r,e,n.WIDTH,n.HEIGHT,n.EXCLUDED_SPACES,Jn.EMPTY),this.alreadyPassed=s}static balancedBoard(){const e=Jn.UNREACHABLE,r=Jn.PLAYER_ZERO,s=Jn.PLAYER_ONE,i=Jn.SOURCE;return[[e,e,r,s,s,s,r,r,s,i,s],[e,s,s,r,r,r,s,s,r,s,s],[s,s,s,s,r,i,s,r,r,r,r],[r,r,s,r,r,s,s,s,r,r,e],[r,i,r,s,s,r,r,r,s,e,e]]}static isOnBoard(e){return!e.isNotInRange(n.WIDTH,n.HEIGHT)&&n.balancedBoard()[e.y][e.x]!==Jn.UNREACHABLE}static getInitialState(){return new n(n.balancedBoard(),0,!1)}getAllPieces(){const e=[];for(let r=0;r<n.HEIGHT;r++)for(let s=0;s<n.WIDTH;s++){const i=new M(s,r);this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()&&e.push(i)}return e}numberOfNeighbors(e){return O2.getNeighbors(e,1).filter(i=>this.isOnBoard(i)&&this.getPieceAt(i).hasPieces()).length}setAtUnsafe(e,r){const s=Ke.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.turn,this.alreadyPassed)}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==Jn.UNREACHABLE}}return n.WIDTH=11,n.HEIGHT=5,n.EXCLUDED_SPACES=[2,1],n})();class Ar extends X0{constructor(t,e){super(t,e)}static from(t,e){return-1===t.x&&-1===t.y&&-2===e.x&&-2===e.y?$.success(Ar.PASS):qa.isOnBoard(t)?qa.isOnBoard(e)?t.y===e.y||t.x===e.x||t.x+t.y===e.x+e.y?$.success(new Ar(t,e)):$.failure("Invalid move"):$.failure("End coord of DvonnMove must be on the board, not at "+t.toString()):$.failure("Starting coord of DvonnMove must be on the board, not at "+t.toString())}static of(t,e){const r=Ar.from(t,e);if(r.isSuccess())return r.get();throw new Error(r.getReason())}toString(){return this===Ar.PASS?"DvonnMove.PASS":"DvonnMove("+this.getStart()+"->"+this.getEnd()+")"}length(){return this.getStart().y===this.getEnd().y?Math.abs(this.getStart().x-this.getEnd().x):(this.getStart(),this.getEnd(),Math.abs(this.getStart().y-this.getEnd().y))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}}Ar.PASS=new Ar(new M(-1,-1),new M(-2,-2)),Ar.encoder=I4.getEncoder(Ar.from);const ge=Jn.EMPTY,Ur=Jn.UNREACHABLE,t8=Jn.SOURCE,C9=Jn.PLAYER_ZERO,y9=Jn.PLAYER_ONE,alt=new Jn(z.ZERO,2,!1),EH=new Jn(z.ONE,2,!1),Gce=new Jn(z.ZERO,4,!1),clt=new Jn(z.ONE,4,!1);class Wce extends rr{constructor(){super(...arguments),this.tutorial=[ce.anyMove($localize`Moving`,$localize`At Dvonn, each hexagonal space contains a stack of pieces.
        If no number is indicated on a stack, it means that it only contains one piece.
        The number written on a stack indicates the number of pieces within that stack, hence the number of points its owner gets.
        The owner of a stack is the one that has a piece at the top of the stack.
        Only the owner of a stack can move it.
        A stack cannot be moved if it is surrounded by 6 other stacks.
        A stack is moved by as many spaces as there are pieces within, in a straight line, and it should land on an occupied space.
        This line cannot move along the vertex of two neighboring spaces, as would a vertical move.
        Therefore, there are six possible directions.
        The player with dark pieces starts.<br/><br/>
        You're playing Dark, click on a stack and move it by one space.`,qa.getInitialState(),Ar.of(new M(2,0),new M(3,0)),$localize`Congratulations!`),ce.fromPredicate($localize`Disconnection`,$localize`Pieces with a lightning strike are called "sources".
        When a stack is not directly nor indirectly connected to a source, it is removed from the board.<br/><br/>
        You're playing Dark, try to disconnect the stack of 4 pieces from your opponent. There are two ways of doing that, one is better than the other: try to find that one!`,new qa([[Ur,Ur,y9,t8,ge,ge,ge,ge,ge,ge,ge],[Ur,ge,C9,ge,ge,ge,ge,ge,ge,ge,ge],[ge,ge,clt,ge,ge,ge,ge,y9,t8,ge,ge],[ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,Ur],[ge,ge,ge,ge,ge,ge,ge,ge,ge,Ur,Ur]],0,!1),Ar.of(new M(2,1),new M(2,0)),(t,e,r)=>t.getEnd().equals(new M(3,0))?U.failure($localize`You have successfully disconnected the stack of 4 pieces of your opponent, but on the next move your opponent will be able to move on your new stack, and to win the game! There exists a better outcome of this situation, try to find it.`):(ye(t.getEnd().equals(new M(2,0)),"player made an impossible move"),U.SUCCESS),$localize`Nice, you have disconnected 4 pieces of your opponent, and your new stack cannot be reached by your opponent!
        Your opponent therefore lost 5 points: 4 from the disconnected stack, and one from the stack on which you moved.
        Disconnected stacks will not be visible at the next turn.`),ce.fromPredicate($localize`Moving on a source`,$localize`You are allowed to move your stacks on any other stack.
        This means that you can take control of a source by moving one of your stack on top of it.
        This way, you know that this stack may never be disconnected, as it contains a source.<br/><br/>
        You're playing Dark and you can take control of a source, do it!`,new qa([[Ur,Ur,t8,y9,ge,ge,ge,ge,ge,ge,ge],[Ur,C9,C9,ge,ge,ge,ge,ge,ge,ge,ge],[ge,y9,C9,y9,ge,ge,C9,EH,t8,ge,ge],[ge,ge,y9,ge,ge,ge,ge,ge,ge,ge,Ur],[ge,ge,ge,ge,ge,ge,ge,ge,ge,Ur,Ur]],0,!1),Ar.of(new M(2,1),new M(2,0)),(t,e,r)=>t.getEnd().equals(new M(2,0))?U.SUCCESS:U.failure($localize`You have not taken possession of a source, try again.`),$localize`Congratulations! However, note that your opponent could later take possession of one of your stack that contains a source, so watch out when you take control of sources!`),ce.informational($localize`Passing`,$localize`It can happen that you have no possible move to make.
        If this is the case, and if your opponent can still move, you must pass your turn.<br/><br/>
        This is a situation that occurs here for Dark.`,new qa([[Ur,Ur,t8,ge,ge,ge,ge,ge,ge,ge,ge],[Ur,ge,alt,ge,ge,ge,ge,ge,ge,ge,ge],[ge,ge,EH,ge,ge,ge,ge,EH,t8,Gce,ge],[ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,Ur],[ge,ge,ge,ge,ge,ge,ge,ge,ge,Ur,Ur]],0,!1)),ce.fromMove($localize`End of the game`,$localize`When no more move is possible for both players, the game ends and the player with the most points wins.<br/><br/>You're playing Dark, make your last move.`,new qa([[Ur,Ur,t8,ge,ge,ge,ge,ge,ge,ge,ge],[Ur,ge,C9,ge,ge,ge,ge,ge,ge,ge,ge],[ge,ge,ge,ge,ge,ge,ge,ge,t8,Gce,ge],[ge,ge,ge,ge,ge,ge,ge,ge,ge,ge,Ur],[ge,ge,ge,ge,ge,ge,ge,ge,ge,Ur,Ur]],0,!1),[Ar.of(new M(2,1),new M(2,0))],$localize`Congratulations, you won 6 - 0!`,$localize`Bad idea, by moving on the source you would have won a point.`)]}}let E9=(()=>{class n{}return n.NOT_PLAYER_PIECE=()=>$localize`You must select a piece or a stack of your color.`,n.EMPTY_STACK=()=>$localize`You must select a stack.`,n.TOO_MANY_NEIGHBORS=()=>$localize`This stack cannot be moved because all 6 of its neighbors are occupied. You must select a stack with strictly less than 6 neighbors.`,n.CANT_REACH_TARGET=()=>$localize`This stack cannot move because it could never land on another piece.`,n.INVALID_MOVE_LENGTH=()=>$localize`A stack must always be moved by as many spaces as there are pieces in the stack.`,n.EMPTY_TARGET_STACK=()=>$localize`The stack must land on an occupied space.`,n})();class Ci extends Z1{static getGameStatus(t){const e=t.gameState,r=Ci.getScores(e);return 0===Ci.getMovablePieces(e).length?r[0]>r[1]?xe.ZERO_WON:r[0]<r[1]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static getMovablePieces(t){return Ci.getFreePieces(t).filter(e=>Ci.pieceHasTarget(t,e))}static getFreePieces(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).belongsTo(t.getCurrentPlayer())&&t.numberOfNeighbors(e)<6)}static pieceHasTarget(t,e){const r=t.getPieceAt(e).getSize();return void 0!==O2.getNeighbors(e,r).find(i=>t.isOnBoard(i)&&!t.getPieceAt(i).isEmpty())}static pieceTargets(t,e){const r=t.getPieceAt(e).getSize();return O2.getNeighbors(e,r).filter(i=>t.isOnBoard(i)&&t.getPieceAt(i).hasPieces())}static getScores(t){let e=0,r=0;return t.getAllPieces().map(s=>{const i=t.getPieceAt(s);i.belongsTo(z.ZERO)?e+=i.getSize():i.belongsTo(z.ONE)&&(r+=i.getSize())}),[e,r]}isMovablePiece(t,e){ye(t.isOnBoard(e),"piece is not on the board");const r=t.getPieceAt(e);return r.getSize()<1?U.failure(E9.EMPTY_STACK()):r.belongsTo(t.getCurrentPlayer())?t.numberOfNeighbors(e)>=6?U.failure(E9.TOO_MANY_NEIGHBORS()):Ci.pieceHasTarget(t,e)?U.SUCCESS:U.failure(E9.CANT_REACH_TARGET()):U.failure(E9.NOT_PLAYER_PIECE())}canOnlyPass(t){return 0===Ci.getMovablePieces(t).length}sourceCoords(t){return t.getAllPieces().filter(e=>t.getPieceAt(e).containsSource())}markPiecesConnectedTo(t,e,r){O2.getNeighbors(e,1).forEach(s=>{t.isOnBoard(s)&&!r[s.y][s.x]&&!t.getPieceAt(s).isEmpty()&&(r[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,r))})}removeDisconnectedPieces(t){const e=Ke.createTable(qa.WIDTH,qa.HEIGHT,!1);this.sourceCoords(t).forEach(s=>{e[s.y][s.x]=!0,this.markPiecesConnectedTo(t,s,e)});let r=t;return r.getAllPieces().forEach(s=>{e[s.y][s.x]||(r=r.setAt(s,Jn.EMPTY))}),r}applyLegalMove(t,e,r){if(t===Ar.PASS)return new qa(e.board,e.turn+1,!0);{const s=e.getPieceAt(t.getStart()),i=e.getPieceAt(t.getEnd()),o=e.setAt(t.getStart(),Jn.EMPTY).setAt(t.getEnd(),Jn.append(s,i));return this.removeDisconnectedPieces(new qa(o.board,e.turn+1,!1))}}isLegal(t,e){if(0===Ci.getMovablePieces(e).length)return t!==Ar.PASS||e.alreadyPassed?$.failure(rt.MUST_PASS()):$.success(void 0);if(t===Ar.PASS)return $.failure(rt.CANNOT_PASS());const r=this.isMovablePiece(e,t.getStart());if(r.isFailure())return r.toFailedFallible();const s=e.getPieceAt(t.getStart());return t.length()!==s.getSize()?$.failure(E9.INVALID_MOVE_LENGTH()):e.getPieceAt(t.getEnd()).isEmpty()?$.failure(E9.EMPTY_TARGET_STACK()):$.success(void 0)}getGameStatus(t){return Ci.getGameStatus(t)}}class qce extends $1{getListMoves(t){const e=t.move,r=t.gameState,s=[];return Ci.getMovablePieces(r).forEach(i=>Ci.pieceTargets(r,i).forEach(o=>{const c=Ar.of(i,o);s.push(c)})),0===s.length&&!1===e.equalsValue(Ar.PASS)&&s.push(Ar.PASS),s}getBoardValue(t){const e=t.gameState,r=Ci.getScores(e);return 0===Ci.getMovablePieces(e).length?new Ct(r[0]>r[1]?Number.MIN_SAFE_INTEGER:r[0]<r[1]?Number.MAX_SAFE_INTEGER:0):new Ct(r[0]-r[1])}}class llt extends qce{getListMoves(t){const e=t.gameState,r=super.getListMoves(t),s=e.getCurrentPlayer().getOpponent();return Ke.sortByDescending(r,i=>{ye(i!==Ar.PASS,"Cannot sort with DvonnMove.PASS");const o=e.getPieceAt(i.getEnd());return o.belongsTo(s)?o.getSize():0}),r}getBoardValue(t){const e=Ci.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=Ci.getScores(r),i=r.getAllPieces(),o=i.length,c=i.filter(m=>r.getPieceAt(m).belongsTo(z.ZERO)).length,u=i.filter(m=>r.getPieceAt(m).belongsTo(z.ONE)).length;return new Ct((u*s[1]-c*s[0])/o)}}function ult(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v().$implicit,r=v().$implicit,s=v();T("ngClass",s.getPieceClasses(e)),D("cx",s.getCenterAt(r).x)("cy",s.getCenterAt(r).y)("r",s.SPACE_SIZE)}}function flt(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v().$implicit,r=v().$implicit,s=v();D("transform",1===e.getSize()?"translate("+(s.getCenterAt(r).x-18)+" "+(s.getCenterAt(r).y-16)+") scale(0.10)":"translate("+(s.getCenterAt(r).x-3)+" "+(s.getCenterAt(r).y-12)+") scale(0.07)")}}function hlt(n,t){if(1&n){const e=Oe();B(),b(0,"text",12),J("click",function(){fe(e);const s=v(2).$implicit;return ae(v().onClick(s.x,s.y))}),Pt(1),O()}if(2&n){const e=v().$implicit,r=v().$implicit,s=v();D("x",e.containsSource()?s.getCenterAt(r).x-7:s.getCenterAt(r).x)("y",s.getCenterAt(r).y),S(1),a1(e.getSize())}}function dlt(n,t){if(1&n){const e=Oe();B(),b(0,"g",5),J("click",function(){fe(e);const s=v().$implicit;return ae(v().onClick(s.x,s.y))}),X(1,"polygon",6),x(2,ult,1,4,"circle",7),x(3,flt,1,1,"polygon",8),x(4,hlt,2,3,"text",9),O()}if(2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","click_",r.x,"_",r.y,""),S(1),D("points",s.getHexaPointsAt(r)),S(1),T("ngIf",e.getSize()>0),S(1),T("ngIf",e.containsSource()),S(1),T("ngIf",e.getSize()>1)}}const plt=function(n){return[n]};function glt(n,t){if(1&n&&(B(),b(0,"g"),x(1,dlt,5,6,"g",4),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",g3(1,plt,r.state.getPieceAt(e)))}}function mlt(n,t){if(1&n&&(B(),b(0,"text",16),Pt(1),O()),2&n){const e=v().$implicit,r=v();D("x",r.getCenterAt(e.coord).x)("y",r.getCenterAt(e.coord).y),S(1),a1(e.spaceContent.getSize())}}function _lt(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polygon",13)(2,"circle",14),x(3,mlt,2,3,"text",15),O()),2&n){const e=t.$implicit,r=v();S(1),D("points",r.getHexaPointsAt(e.coord)),S(1),We("id","captured_",e.coord.x,"_",e.coord.y,""),T("ngClass",r.getPieceClasses(e.spaceContent)),D("cx",r.getCenterAt(e.coord).x)("cy",r.getCenterAt(e.coord).y)("r",r.SPACE_SIZE),S(1),T("ngIf",e.spaceContent.getSize()>1)}}function vlt(n,t){if(1&n&&(B(),ln(0),X(1,"polygon",17)(2,"polygon",17),un()),2&n){const e=v();S(1),D("points",e.getHexaPointsAt(e.lastMove.get().getStart())),S(1),D("points",e.getHexaPointsAt(e.lastMove.get().getEnd()))}}function Clt(n,t){if(1&n&&(B(),X(0,"polygon",18)),2&n){const e=v();D("points",e.getHexaPointsAt(e.chosen.get()))}}let ylt=(()=>{class n extends p9{constructor(e){super(e),this.lastMove=P.empty(),this.chosen=P.empty(),this.disconnecteds=[],this.rules=new Ci(qa),this.availableMinimaxes=[new qce(this.rules,"DvonnMinimax"),new llt(this.rules,"DvonnMinimaxMaximizeStacks")],this.encoder=Ar.encoder,this.tutorial=(new Wce).tutorial,this.SPACE_SIZE=30,this.canPass=!1,this.scores=P.of(Ci.getScores(this.getState())),this.hexaLayout=new g9(1.5*this.SPACE_SIZE,new M(-this.SPACE_SIZE,2*this.SPACE_SIZE),lP.INSTANCE),this.state=this.getState(),this.hexaBoard=this.getState().board}hideLastMove(){this.lastMove=P.empty()}updateBoard(){this.cancelMoveAttempt(),this.state=this.getState(),this.lastMove=this.rules.node.move,this.disconnecteds=[],this.lastMove.isPresent()?this.calculateDisconnecteds():this.hideLastMove(),this.canPass=this.rules.canOnlyPass(this.state),this.scores=P.of(Ci.getScores(this.state))}calculateDisconnecteds(){const e=this.rules.node.mother.get().gameState,r=this.getState();for(let s=0;s<r.board.length;s++)for(let i=0;i<r.board[s].length;i++){const o=new M(i,s);if(!0===r.isOnBoard(o)&&!1===o.equals(this.lastMove.get().getStart())){const c=r.getPieceAt(o),u=e.getPieceAt(o);if(c.isEmpty()&&!u.isEmpty()){const p={coord:new M(i,s),spaceContent:u};this.disconnecteds.push(p)}}}}cancelMoveAttempt(){this.chosen=P.empty()}pass(){var e=this;return A(function*(){return ye(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Ar.PASS,e.getState())})()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.chosen.isAbsent()?s.choosePiece(e,r):s.chosen.equalsValue(new M(e,r))?(s.cancelMoveAttempt(),U.SUCCESS):yield s.chooseDestination(e,r)})()}choosePiece(e,r){const s=new M(e,r),i=this.rules.isMovablePiece(this.getState(),s);return i.isSuccess()?(this.chosen=P.of(s),U.SUCCESS):this.cancelMove(i.getReason())}chooseDestination(e,r){var s=this;return A(function*(){const i=s.chosen.get(),o=new M(e,r),c=Ar.of(i,o);return s.chooseMove(c,s.getState())})()}getPieceClasses(e){if(e.containsSource()&&1===e.getSize())return["nonplayer-fill","dashed-stroke"];const r=this.getPlayerClass(e.getOwner());return e.containsSource()?[r,"nonplayer-stroke","dashed-stroke"]:[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-dvonn"]],features:[l],decls:5,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 875 380","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","base no-fill selected-stroke",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base","mid-stroke"],["class","base mid-stroke",3,"ngClass",4,"ngIf"],["class","nonplayer-light-fill","points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",4,"ngIf"],["class","text-center text-medium","dy","13",3,"click",4,"ngIf"],[1,"base","mid-stroke",3,"ngClass"],["points","157.055,0 90.798,196.319 164.417,196.319 88.344,400 289.571,159.509 218.405,159.509 311.656,0",1,"nonplayer-light-fill"],["dy","13",1,"text-center","text-medium",3,"click"],[1,"base","mid-stroke","captured-fill"],[1,"base","mid-stroke","semi-transparent",3,"id","ngClass"],["class","text-center text-big","dy","17",4,"ngIf"],["dy","17",1,"text-center","text-big"],[1,"base","no-fill","last-move-stroke"],[1,"base","no-fill","selected-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,glt,2,3,"g",1),x(2,_lt,4,8,"g",1),x(3,vlt,3,2,"ng-container",2),x(4,Clt,1,1,"polygon",3),O()),2&e&&(S(1),T("ngForOf",r.state.allCoords()),S(1),T("ngForOf",r.disconnecteds),S(1),T("ngIf",r.lastMove.isPresent()),S(1),T("ngIf",r.chosen.isPresent()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();var ir=(()=>(function(n){n[n.NONE=0]="NONE",n[n.SMALL=1]="SMALL",n[n.MEDIUM=2]="MEDIUM",n[n.BIG=3]="BIG"}(ir||(ir={})),ir))();class Xe{constructor(t){this.value=t}static of(t){switch(t){case 0:return this.SMALL_DARK;case 1:return this.SMALL_LIGHT;case 2:return this.MEDIUM_DARK;case 3:return this.MEDIUM_LIGHT;case 4:return this.BIG_DARK;case 5:return this.BIG_LIGHT;case 6:return this.NONE;default:throw new Error("Invalid value "+t+" for EncapsulePiece")}}static ofSizeAndPlayer(t,e){return e===z.ZERO&&t===ir.BIG?Xe.BIG_DARK:e===z.ZERO&&t===ir.MEDIUM?Xe.MEDIUM_DARK:e===z.ZERO&&t===ir.SMALL?Xe.SMALL_DARK:e===z.ONE&&t===ir.BIG?Xe.BIG_LIGHT:e===z.ONE&&t===ir.MEDIUM?Xe.MEDIUM_LIGHT:e===z.ONE&&t===ir.SMALL?Xe.SMALL_LIGHT:Xe.NONE}getPlayer(){switch(this){case Xe.SMALL_DARK:case Xe.MEDIUM_DARK:case Xe.BIG_DARK:return z.ZERO;case Xe.SMALL_LIGHT:case Xe.MEDIUM_LIGHT:case Xe.BIG_LIGHT:return z.ONE;default:return pe.NONE}}getSize(){switch(this){case Xe.BIG_DARK:case Xe.BIG_LIGHT:return ir.BIG;case Xe.MEDIUM_DARK:case Xe.MEDIUM_LIGHT:return ir.MEDIUM;case Xe.SMALL_DARK:case Xe.SMALL_LIGHT:return ir.SMALL;default:return we.expectToBe(this,Xe.NONE),ir.NONE}}belongsTo(t){return this.getPlayer()===t}equals(t){return this===t}toString(){switch(this){case Xe.BIG_DARK:return"BIG_DARK";case Xe.BIG_LIGHT:return"BIG_LIGHT";case Xe.MEDIUM_DARK:return"MEDIUM_DARK";case Xe.MEDIUM_LIGHT:return"MEDIUM_LIGHT";case Xe.SMALL_DARK:return"SMALL_DARK";case Xe.SMALL_LIGHT:return"SMALL_LIGHT";default:return we.expectToBe(this,Xe.NONE),"EMPTY"}}}Xe.SMALL_DARK=new Xe(0),Xe.SMALL_LIGHT=new Xe(1),Xe.MEDIUM_DARK=new Xe(2),Xe.MEDIUM_LIGHT=new Xe(3),Xe.BIG_DARK=new Xe(4),Xe.BIG_LIGHT=new Xe(5),Xe.NONE=new Xe(6);class s6 extends ps{constructor(t,e,r){super(t,e),this.remainingPieces=r}static getInitialState(){const e=new Jr(pe.NONE,pe.NONE,pe.NONE).encode(),r=Ke.createTable(3,3,e),s=Ke.mapBiArray(r,Jr.decode);return new s6(s,0,[Xe.BIG_DARK,Xe.BIG_DARK,Xe.BIG_LIGHT,Xe.BIG_LIGHT,Xe.MEDIUM_DARK,Xe.MEDIUM_DARK,Xe.MEDIUM_LIGHT,Xe.MEDIUM_LIGHT,Xe.SMALL_DARK,Xe.SMALL_DARK,Xe.SMALL_LIGHT,Xe.SMALL_LIGHT])}getRemainingPieces(){return Ke.copyImmutableArray(this.remainingPieces)}getRemainingPiecesOfPlayer(t){return this.getRemainingPieces().filter(e=>e.getPlayer()===t)}pieceBelongsToCurrentPlayer(t){return t.belongsTo(this.getCurrentPlayer())}isDroppable(t){return this.pieceBelongsToCurrentPlayer(t)&&this.isInRemainingPieces(t)}isInRemainingPieces(t){return this.remainingPieces.some(e=>e===t)}getPlayerRemainingPieces(){return this.remainingPieces.filter(t=>this.pieceBelongsToCurrentPlayer(t))}}class Jr{constructor(t,e,r){this.small=t,this.medium=e,this.big=r}static decode(t){ye(t%1==0,"EncapsuleSpace must be encoded as integer: "+t),ye(t>=0,"To small representation for EncapsuleSpace: "+t),ye(t<=26,"To big representation for EncapsuleSpace: "+t);const e=z.numberEncoder.decodeNumber(t%3);t-=e.value;const r=z.numberEncoder.decodeNumber((t/=3)%3);t-=r.value;const s=z.numberEncoder.decodeNumber(t/=3);return new Jr(e,r,s)}isEmpty(){return this.small===pe.NONE&&this.medium===pe.NONE&&this.big===pe.NONE}toList(){const t=[];return this.small.isPlayer()&&t.push(Xe.ofSizeAndPlayer(ir.SMALL,this.small)),this.medium.isPlayer()&&t.push(Xe.ofSizeAndPlayer(ir.MEDIUM,this.medium)),this.big.isPlayer()&&t.push(Xe.ofSizeAndPlayer(ir.BIG,this.big)),t}toOrderedPieceNames(){const t=Xe.ofSizeAndPlayer(ir.SMALL,this.small),e=Xe.ofSizeAndPlayer(ir.MEDIUM,this.medium),r=Xe.ofSizeAndPlayer(ir.BIG,this.big);return[t.toString(),e.toString(),r.toString()]}getBiggest(){return this.big===z.ZERO?Xe.BIG_DARK:this.big===z.ONE?Xe.BIG_LIGHT:this.medium===z.ZERO?Xe.MEDIUM_DARK:this.medium===z.ONE?Xe.MEDIUM_LIGHT:this.small===z.ZERO?Xe.SMALL_DARK:this.small===z.ONE?Xe.SMALL_LIGHT:Xe.NONE}tryToSuperposePiece(t){const e=this.getBiggest().getSize();if(t===Xe.NONE)throw new Error("Cannot move EMPTY on a space");return t.getSize()>e?P.of(this.put(t)):P.empty()}removeBiggest(){const t=this.getBiggest();if(t===Xe.NONE)throw new Error("Cannot removed piece from empty space");let e;const r=t.getSize();switch(r){case ir.BIG:e=new Jr(this.small,this.medium,pe.NONE);break;case ir.MEDIUM:e=new Jr(this.small,pe.NONE,pe.NONE);break;default:we.expectToBe(r,ir.SMALL),e=new Jr(pe.NONE,pe.NONE,pe.NONE)}return{removedSpace:e,removedPiece:t}}put(t){if(t===Xe.NONE)throw new Error("Cannot put NONE on space");const e=t.getPlayer(),r=t.getSize();switch(r){case ir.BIG:return new Jr(this.small,this.medium,e);case ir.MEDIUM:return ye(this.big===pe.NONE,"Cannot put a piece on top of a bigger one"),new Jr(this.small,e,this.big);default:return we.expectToBe(r,ir.SMALL),ye(this.big===pe.NONE,"Cannot put a piece on top of a bigger one"),ye(this.medium===pe.NONE,"Cannot put a piece on top of a bigger one"),new Jr(e,this.medium,this.big)}}encode(){return this.small.value+3*this.medium.value+9*this.big.value}belongsTo(t){return this.getBiggest().getPlayer()===t}toString(){const t=this.toOrderedPieceNames();return"("+t[0]+", "+t[1]+", "+t[2]+")"}}Jr.EMPTY=new Jr(pe.NONE,pe.NONE,pe.NONE);let Lm=(()=>{class n{}return n.PIECE_OUT_OF_STOCK=()=>$localize`You do not have pieces of this type anymore.`,n.INVALID_PLACEMENT=()=>$localize`You must put your piece on an empty square or on a smaller piece.`,n.NOT_DROPPABLE=()=>$localize`You must pick your piece among the remaining ones.`,n.INVALID_PIECE_SELECTED=()=>$localize`You must pick one of your remaining pieces or one piece on the board that is the biggest of its square.`,n.END_YOUR_MOVE=()=>$localize`You are performing a move, you must select a landing square.`,n})();class Nc extends Z1{static isVictory(t){const e=t.getCopiedBoard();for(const r of Nc.LINES){const i=Nc.isVictoriousLine([e[r[0].y][r[0].x],e[r[1].y][r[1].x],e[r[2].y][r[2].x]]);if(i.isPresent())return i}return P.empty()}static isVictoriousLine(t){const r=t.map(s=>s.getBiggest()).map(s=>s.getPlayer());return r[0]===pe.NONE?P.empty():r[0]===r[1]&&r[1]===r[2]?P.of(r[0]):P.empty()}static isLegal(t,e){let s;if(K(!1,t.toString()),t.isDropping()){if(s=t.piece.get(),!1===e.pieceBelongsToCurrentPlayer(s))return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.isInRemainingPieces(s))return $.failure(Lm.PIECE_OUT_OF_STOCK())}else{const c=t.startingCoord.get();if(s=e.getPieceAt(c).getBiggest(),!1===e.pieceBelongsToCurrentPlayer(s))return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE())}const o=e.getPieceAt(t.landingCoord).tryToSuperposePiece(s);return o.isPresent()?$.success(o.get()):$.failure(Lm.INVALID_PLACEMENT())}isLegal(t,e){return Nc.isLegal(t,e)}applyLegalMove(t,e,r){const s=e.getCopiedBoard();let i=e.getRemainingPieces();const o=e.turn+1;let c;if(s[t.landingCoord.y][t.landingCoord.x]=Jr.decode(r.encode()),t.isDropping()){c=t.piece.get();const h=i.indexOf(c);i=i.slice(0,h).concat(i.slice(h+1))}else{const h=t.startingCoord.get(),p=s[h.y][h.x].encode(),C=Jr.decode(p).removeBiggest();s[h.y][h.x]=Jr.decode(C.removedSpace.encode()),c=C.removedPiece}return new s6(s,o,i)}static getGameStatus(t){const r=Nc.isVictory(t.gameState);return r.isPresent()?xe.getVictory(r.get()):xe.ONGOING}getGameStatus(t){return Nc.getGameStatus(t)}}Nc.LINES=[[new M(0,0),new M(0,1),new M(0,2)],[new M(1,0),new M(1,1),new M(1,2)],[new M(2,0),new M(2,1),new M(2,2)],[new M(0,0),new M(1,0),new M(2,0)],[new M(0,1),new M(1,1),new M(2,1)],[new M(0,2),new M(1,2),new M(2,2)],[new M(0,0),new M(1,1),new M(2,2)],[new M(0,2),new M(1,1),new M(2,0)]];class Ks extends $i{constructor(t,e,r){super(),this.startingCoord=t,this.landingCoord=e,this.piece=r}static fromMove(t,e){if(t.equals(e))throw new Error("Starting coord and landing coord must be separate coords");return new Ks(P.of(t),e,P.empty())}static fromDrop(t,e){return new Ks(P.empty(),e,P.of(t))}isDropping(){return this.startingCoord.isAbsent()}equals(t){return this===t||!1!==t.landingCoord.equals(this.landingCoord)&&!1!==this.startingCoord.equals(t.startingCoord)&&this.piece.equals(t.piece)}toString(){return this.isDropping()?"EncapsuleMove("+this.piece.get().toString()+" -> "+this.landingCoord+")":"EncapsuleMove("+this.startingCoord.get()+"->"+this.landingCoord+")"}}Ks.encoder=new class extends Cn{maxValue(){return 161}encodeNumber(n){const t=n.landingCoord.x,e=n.landingCoord.y;if(n.isDropping())return 18*n.piece.get().value+6*t+2*e+0;{const s=n.startingCoord.get().y;return 54*n.startingCoord.get().x+18*s+6*t+2*e+1}}decodeNumber(n){const t=n%2;n-=t;const e=(n/=2)%3;n-=e;const r=(n/=3)%3;n-=r,n/=3;const s=new M(r,e);if(0===t){const i=Xe.of(n);return Ks.fromDrop(i,s)}{const i=n%3;n-=i;const c=new M((n/=3)%3,i);return Ks.fromMove(c,s)}}};class Elt extends $1{getBoardValue(t){return Nc.getGameStatus(t).toBoardValue()}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getCurrentPlayer(),o=vte.toComparableObjectSet(r.getPlayerRemainingPieces());for(let c=0;c<3;c++)for(let u=0;u<3;u++){const h=new M(u,c);for(const p of o){const m=Ks.fromDrop(p,h);Nc.isLegal(m,r).isSuccess()&&e.push(m)}if(s[c][u].belongsTo(i))for(let p=0;p<3;p++)for(let m=0;m<3;m++){const C=new M(m,p);if(!C.equals(h)){const w=Ks.fromMove(h,C);Nc.isLegal(w,r).isSuccess()&&e.push(w)}}}return e}}const Io=new Jr(pe.NONE,pe.NONE,pe.NONE),jce=new Jr(z.ZERO,pe.NONE,pe.NONE),Mlt=new Jr(pe.NONE,z.ZERO,pe.NONE),Slt=new Jr(pe.NONE,pe.NONE,z.ZERO),Zce=new Jr(z.ONE,pe.NONE,pe.NONE),mP=new Jr(pe.NONE,pe.NONE,z.ONE),Plt=new Jr(z.ONE,z.ZERO,pe.NONE),Tlt=new Jr(z.ZERO,z.ZERO,pe.NONE);class Yce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal of Encapsule is to align three of your pieces.
        Here, we have a victory of the dark player.`,new s6([[jce,Zce,mP],[Io,Mlt,Io],[Io,Io,Slt]],0,[Xe.SMALL_DARK,Xe.MEDIUM_DARK,Xe.BIG_DARK,Xe.SMALL_LIGHT,Xe.MEDIUM_LIGHT,Xe.MEDIUM_LIGHT,Xe.BIG_LIGHT])),ce.anyMove($localize`Putting a piece`,$localize`This is the initial board.<br/><br/>
        You're playing Dark. Pick one of your piece on the side of the board and put it on the board.`,s6.getInitialState(),Ks.fromDrop(Xe.SMALL_DARK,new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Moving`,$localize`Another possible action is to move one of your pieces that is already on the board.<br/><br/>
        You're playing Dark, click on your piece already on the board and then on any empty square of the board.`,new s6([[jce,mP,Io],[Io,Io,Io],[Io,Io,Io]],0,[]),[Ks.fromMove(new M(0,0),new M(2,0)),Ks.fromMove(new M(0,0),new M(0,1)),Ks.fromMove(new M(0,0),new M(1,1)),Ks.fromMove(new M(0,0),new M(2,1)),Ks.fromMove(new M(0,0),new M(0,2)),Ks.fromMove(new M(0,0),new M(1,2)),Ks.fromMove(new M(0,0),new M(2,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Particularity`,$localize`At Encapsule, pieces encapsulate each other.
        It is therefore possible to have up to three pieces per square!
        However, only the biggest piece of each square counts:
        you cannot win with a piece that is "hidden" by a bigger piece.
        Similarly, you cannot move a piece if it is encapsulated by a bigger piece.
        Finally, you cannot encapsulate a piece with a smaller piece.
        Here, Dark can win now in various ways.<br/><br/>
        You're playing Dark, try to win by making a move, and not by putting a new piece on the board.`,new s6([[Plt,Io,Zce],[Tlt,mP,mP],[Io,Io,Io]],0,[Xe.MEDIUM_DARK,Xe.BIG_DARK,Xe.MEDIUM_LIGHT,Xe.MEDIUM_LIGHT]),Ks.fromMove(new M(0,1),new M(0,2)),(t,e,r)=>{if(t.landingCoord.equals(new M(0,2))){if(t.isDropping())return U.failure($localize`You won, but the exercise is to win while moving a piece!`);if(t.startingCoord.equalsValue(new M(0,1)))return U.SUCCESS}return U.failure($localize`Failed. Try again.`)},$localize`Congratulations!`)]}}function wlt(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"circle",5),J("click",function(){const s=fe(e),i=s.$implicit,o=s.index,c=v().$implicit;return ae(v().onPieceClick(c.value,i,o))}),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().$implicit,i=v();S(1),G2("id","piece_",s.value,"_",e.toString(),"_",r,""),T("ngClass",i.getSidePieceClasses(e,r)),D("transform","rotate("+180*(i.role.value+s.value)+" "+i.CENTER+" "+i.CENTER+")")("r",i.getPieceRadius(e))("cx",i.getRemainingPieceCenterCoord(s,r).x)("cy",i.getRemainingPieceCenterCoord(s,r).y)}}function blt(n,t){if(1&n&&(B(),b(0,"g",null,4),x(2,wlt,2,8,"g",1),O()),2&n){const e=t.$implicit,r=v();S(2),T("ngForOf",r.getRemainingPieces(e))}}function Olt(n,t){if(1&n){const e=Oe();B(),b(0,"circle",8),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onBoardClick(s,i))}),O()}if(2&n){const e=t.$implicit,r=v().index,s=v().index,i=v();T("ngClass",i.getPieceClasses(e)),D("r",i.getPieceRadius(e))("cx",i.getPieceCenter(r))("cy",i.getPieceCenter(s))}}function Nlt(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",6),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onBoardClick(i,o))}),O(),x(2,Olt,1,4,"circle",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),T("ngClass",i.getRectClasses(r,s)),D("x",i.SPACE_SIZE*r+i.STROKE_WIDTH)("y",i.SPACE_SIZE*s+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngForOf",i.getListPieces(e))}}function Alt(n,t){if(1&n&&(B(),b(0,"g"),x(1,Nlt,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Ilt(n,t){if(1&n){const e=Oe();B(),b(0,"rect",9),J("click",function(){fe(e);const s=v();return ae(s.onBoardClick(s.chosenCoord.get().x,s.chosenCoord.get().y))}),O()}if(2&n){const e=v();We("id","chosenCoord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("x",e.SPACE_SIZE*e.chosenCoord.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.chosenCoord.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}let xlt=(()=>{class n extends No{constructor(e){super(e),this.CENTER=this.getPieceCenter(1),this.UPLEFT=-(this.SPACE_SIZE+.5*this.STROKE_WIDTH),this.WIDTH=5*this.SPACE_SIZE+3*this.STROKE_WIDTH,this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty(),this.chosenCoord=P.empty(),this.chosenPiece=P.empty(),this.remainingPieceCenterCoords=new zn,this.rules=new Nc(s6),this.availableMinimaxes=[new Elt(this.rules,"EncapsuleMinimax")],this.encoder=Ks.encoder,this.tutorial=(new Yce).tutorial,this.updateBoard()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard();const r=this.rules.node.move;this.calculateLeftPieceCoords(),r.isPresent()?(this.lastLandingCoord=P.of(r.get().landingCoord),this.lastStartingCoord=r.get().startingCoord):(this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty())}getListPieces(e){return e.toList()}getRemainingPieces(e){return this.getState().getRemainingPiecesOfPlayer(e)}onBoardClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.getState();if(s.chosenCoord.isAbsent()){if(s.chosenCoord=P.of(o),s.chosenPiece.isPresent()){const u=Ks.fromDrop(s.chosenPiece.get(),o);return s.chooseMove(u,s.getState())}return!1===c.getPieceAt(o).belongsTo(c.getCurrentPlayer())?s.cancelMove(Lm.INVALID_PIECE_SELECTED()):U.SUCCESS}if(s.chosenCoord.equalsValue(o))return s.cancelMoveAttempt(),U.SUCCESS;{const u=Ks.fromMove(s.chosenCoord.get(),o);return s.chooseMove(u,s.getState())}})()}cancelMoveAttempt(){this.chosenCoord=P.empty(),this.chosenPiece=P.empty(),this.chosenPieceIndex=P.empty()}onPieceClick(e,r,s){var i=this;return A(function*(){const o="#piece_"+e+"_"+r.toString()+"_"+s,c=i.canUserPlay(o);return c.isFailure()?i.cancelMove(c.getReason()):!1===i.getState().isDroppable(r)?i.cancelMove(Lm.NOT_DROPPABLE()):i.chosenCoord.isAbsent()?(i.chosenPiece.equalsValue(r)&&i.chosenPieceIndex.equalsValue(s)?(i.chosenPiece=P.empty(),i.chosenPieceIndex=P.empty()):(i.chosenPiece=P.of(r),i.chosenPieceIndex=P.of(s)),U.SUCCESS):i.cancelMove(Lm.END_YOUR_MOVE())})()}getRectClasses(e,r){return this.isSelected(e,r)?"moved-fill":""}isSelected(e,r){const s=new M(e,r);return!(!this.lastStartingCoord.equalsValue(s)&&!this.lastLandingCoord.equalsValue(s))}getPieceClasses(e){return[this.getPieceStrokeClass(e)]}getPieceCenter(e){return this.SPACE_SIZE*e+this.STROKE_WIDTH+this.SPACE_SIZE/2}getPieceStrokeClass(e){const r=e.getPlayer();return ye(r.isPlayer(),"EncapsuleComponent.getPieceStrokeClass should only be called with actual pieces!"),"player"+r.value+"-stroke"}getPieceRadius(e){switch(e.getSize()){case ir.BIG:return this.SPACE_SIZE/2-1*this.STROKE_WIDTH;case ir.MEDIUM:return this.SPACE_SIZE/2-2*this.STROKE_WIDTH-3;default:return we.expectToBe(e.getSize(),ir.SMALL),this.SPACE_SIZE/2-3*this.STROKE_WIDTH-6}}getSidePieceClasses(e,r){const s=this.getPieceClasses(e);return this.isSelectedPiece(e)&&this.chosenPieceIndex.equalsValue(r)&&s.push("selected-stroke"),s}isSelectedPiece(e){return this.chosenPiece.equalsValue(e)}calculateLeftPieceCoords(){this.remainingPieceCenterCoords=new zn;for(const e of z.PLAYERS){const r=[],s=this.getRemainingPieces(e);for(let i=0;i<s.length;i++){let o,c=0,u=0;i<=2?(o=new M(2-i,3),u=this.STROKE_WIDTH):(o=new M(-1,5-i),c=-this.STROKE_WIDTH);const h=this.getPieceCenter(o.x),p=this.getPieceCenter(o.y);r.push(new M(h+c,p+u))}this.remainingPieceCenterCoords.set(e,r)}}getRemainingPieceCenterCoord(e,r){return this.remainingPieceCenterCoords.get(e).get()[r]}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-encapsule"]],features:[l],decls:6,vars:4,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardDiv",""],["class","base no-fill selected-stroke","pointer-events","fill",3,"id","click",4,"ngIf"],["remainingPieces",""],["pointer-events","fill",1,"base","no-fill",3,"id","ngClass","click"],[1,"base",3,"id","ngClass","click"],["class","base no-fill",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"base","no-fill",3,"ngClass","click"],["pointer-events","fill",1,"base","no-fill","selected-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,blt,3,1,"g",1),b(2,"g",null,2),x(4,Alt,2,1,"g",1),x(5,Ilt,1,6,"rect",3),O()()),2&e&&(D("viewBox",r.UPLEFT+" "+r.UPLEFT+" "+r.WIDTH+" "+r.WIDTH),S(1),T("ngForOf",r.Player.PLAYERS),S(3),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Ac extends S3{constructor(t,e,r,s,i){if(super(t,e),this.movedPieces=r,this.stepSize=s,this.direction=i,this.coord.isNotInRange(14,12))throw new Error("Illegal coord outside of board "+this.coord.toString()+".");if(r<1)throw new Error("Must select minimum one piece (got "+r+").");if(s<1)throw new Error("Step size must be minimum one (got "+s+").");if(s>r)throw new Error("Cannot move a phalanx further than its size (got step size "+s+" for "+r+" pieces).")}toString(){return"EpaminondasMove("+this.coord.toString()+", m:"+this.movedPieces+", s:"+this.stepSize+", "+this.direction.toString()+")"}equals(t){return this===t||!(!this.coord.equals(t.coord)||this.movedPieces!==t.movedPieces||this.stepSize!==t.stepSize)&&this.direction.equals(t.direction)}}Ac.encoder=new class extends Cn{maxValue(){return 122303}encodeNumber(n){const t=n.direction.toInt();return 8*n.coord.x*7*13*12+8*n.coord.y*7*13+8*(n.movedPieces-1)*7+8*(n.stepSize-1)+t}decodeNumber(n){if(n%1!=0)throw new Error("EncodedMove must be an integer.");const t=n%8;n-=t;const e=(n/=8)%7;n-=e;const r=(n/=7)%13;n-=r;const s=(n/=13)%12;n-=s;const i=n/=12,o=be.factory.fromInt(t);return new Ac(i,s,r+1,e+1,o.get())}};class A3 extends ps{static getInitialState(){const t=pe.NONE,e=pe.ZERO,r=pe.ONE;return new A3([[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t,t,t,t],[e,e,e,e,e,e,e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e,e,e,e,e,e,e]],0)}count(t,e){let r=0;for(let s=0;s<14;s++)this.board[e][s]===t&&r++;return r}doesOwnPiece(t){for(let e=0;e<12;e++)for(let r=0;r<14;r++)if(this.board[e][r]===t)return!0;return!1}}let Ic=(()=>{class n{}return n.PHALANX_IS_LEAVING_BOARD=()=>$localize`The move distance of your phalanx puts it out of the board.`,n.SOMETHING_IN_PHALANX_WAY=()=>$localize`There is something in the way of your phalanx.`,n.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE=()=>$localize`Your phalanx must be bigger than the one you are capturing.`,n.SQUARE_NOT_ALIGNED_WITH_SELECTED=()=>$localize`This square is not aligned with the selected piece.`,n.SINGLE_PIECE_MUST_MOVE_BY_ONE=()=>$localize`A single piece can only move by one square.`,n.SINGLE_PIECE_CANNOT_CAPTURE=()=>$localize`A single piece cannot make a capture.`,n.SQUARE_NOT_ALIGNED_WITH_PHALANX=()=>$localize`This square is not aligned with the direction of the phalanx.`,n.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD=()=>$localize`A phalanx can't contain pieces outside of the board.`,n.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE=()=>$localize`A phalanx cannot contain an empty square.`,n.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE=()=>$localize`A phalanx cannot contain a piece of the opponent.`,n})();class n8 extends Z1{static isLegal(t,e){const r=this.getPhalanxValidity(e,t);if(r.isFailure())return $.failure(r.getReason());const s=this.getLandingStatus(e,t);if(s.isFailure())return s;const i=Ke.copyBiArray(s.get()),o=e.getCurrentOpponent(),c=n8.getCaptureValidity(e,i,t,o);return c.isFailure()?c:$.success(c.get())}static getPhalanxValidity(t,e){let r=e.coord,s=0;const i=t.getCurrentOpponent();for(;s<e.movedPieces;){if(r.isNotInRange(14,12))return U.failure(Ic.PHALANX_CANNOT_CONTAIN_PIECES_OUTSIDE_BOARD());const o=t.getPieceAt(r);if(o===pe.NONE)return U.failure(Ic.PHALANX_CANNOT_CONTAIN_EMPTY_SQUARE());if(o===i)return U.failure(Ic.PHALANX_CANNOT_CONTAIN_OPPONENT_PIECE());r=r.getNext(e.direction,1),s++}return U.SUCCESS}static getLandingStatus(t,e){const r=t.getCopiedBoard(),s=t.getCurrentPlayer();let i=e.coord,o=e.coord.getNext(e.direction,e.movedPieces),c=0;for(;c+1<e.stepSize;){if(r[i.y][i.x]=pe.NONE,r[o.y][o.x]=s,o.isNotInRange(14,12))return $.failure(Ic.PHALANX_IS_LEAVING_BOARD());if(t.getPieceAt(o).isPlayer())return $.failure(Ic.SOMETHING_IN_PHALANX_WAY());c++,o=o.getNext(e.direction,1),i=i.getNext(e.direction,1)}return o.isNotInRange(14,12)?$.failure(Ic.PHALANX_IS_LEAVING_BOARD()):t.getPieceAt(o)===s?$.failure(rt.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):(r[i.y][i.x]=pe.NONE,r[o.y][o.x]=s,$.success(r))}static getCaptureValidity(t,e,r,s){let i=r.coord.getNext(r.direction,r.movedPieces+r.stepSize-1),o=0;for(;i.isInRange(14,12)&&t.getPieceAt(i)===s;){if(o>0&&(e[i.y][i.x]=pe.NONE),o++,o>=r.movedPieces)return $.failure(Ic.PHALANX_SHOULD_BE_GREATER_TO_CAPTURE());i=i.getNext(r.direction,1)}return $.success(e)}isLegal(t,e){return n8.isLegal(t,e)}applyLegalMove(t,e,r){return new A3(r,e.turn+1)}getGameStatus(t){const e=t.gameState,r=e.count(z.ZERO,0),s=e.count(z.ONE,11);if(e.turn%2==0){if(r>s)return xe.ZERO_WON}else if(s>r)return xe.ONE_WON;return!1===e.doesOwnPiece(z.ZERO)?xe.ONE_WON:!1===e.doesOwnPiece(z.ONE)?xe.ZERO_WON:xe.ONGOING}}class Rm extends $1{static getListMoves(t){const e=t.gameState.getCurrentPlayer(),r=t.gameState.getCurrentOpponent(),s=pe.NONE;let i=[];const o=t.gameState;let c;for(let u=0;u<12;u++)for(let h=0;h<14;h++){const p=new M(h,u);if(o.getPieceAt(p)===e)for(const m of be.DIRECTIONS){let C=1,w=p.getNext(m,1);for(;w.isInRange(14,12)&&o.getPieceAt(w)===e;)C+=1,w=w.getNext(m,1);let I=1;for(;w.isInRange(14,12)&&I<=C&&o.getPieceAt(w)===s;)c=new Ac(h,u,C,I,m),i=this.addMove(i,c,o),I++,w=w.getNext(m,1);w.isInRange(14,12)&&I<=C&&o.getPieceAt(w)===r&&(c=new Ac(h,u,C,I,m),i=this.addMove(i,c,o))}}return i}static addMove(t,e,r){return n8.isLegal(e,r).isSuccess()&&t.push(e),t}getListMoves(t){const e=Rm.getListMoves(t);return Ke.sortByDescending(e,r=>r.stepSize),e}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new Ct(this.getPieceCountPlusRowDomination(t.gameState))}getPieceCountPlusRowDomination(t){let o=0;for(let c=0;c<12;c++){let u=0;const h=[0,0];for(let p=0;p<14;p++){const m=new M(p,c),C=t.getPieceAt(m);if(C.isPlayer()){const w=C.getScoreModifier();o+=2002*w,h[C.value]=w,u+=w;for(const I of[be.UP_LEFT,be.UP,be.UP_RIGHT]){let H=m.getNext(I,1);for(;H.isInRange(14,12)&&t.getPieceAt(H)===C;)o+=1*w,H=H.getNext(I,1)}}}0!==u&&(o+=Math.abs(u)/u*2),o+=1*h.reduce((p,m)=>p+m)}return o}}class klt extends $1{getListMoves(t){const e=Rm.getListMoves(t);return this.orderMovesByPhalanxSizeAndFilter(e,t.gameState)}orderMovesByPhalanxSizeAndFilter(t,e){return Ke.sortByDescending(t,r=>r.movedPieces),t.length>40?t.filter(s=>!!this.moveIsCapture(s,e)||s.movedPieces*Math.random()>1):t}moveIsCapture(t,e){const r=t.coord.getNext(t.direction,t.movedPieces+t.stepSize-1);return e.board[r.y][r.x]===e.getCurrentOpponent()}getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?e.toBoardValue():new Ct(this.getPieceCountThenSupportThenAdvancement(t.gameState))}getPieceCountThenSupportThenAdvancement(t){let o=0;for(let c=0;c<12;c++)for(let u=0;u<14;u++){const h=new M(u,c),p=t.getPieceAt(h);if(p.isPlayer()){let m,C;p===z.ZERO?(m=12-c,C=[be.UP_LEFT,be.UP,be.UP_RIGHT]):(m=c+1,C=[be.DOWN_LEFT,be.DOWN,be.DOWN_RIGHT]);const w=p.getScoreModifier();o+=m*w,o+=149629*w;for(const I of C){let H=h.getNext(I,1);for(;H.isInRange(14,12)&&t.getPieceAt(H)===p;)o+=337*w,H=H.getNext(I,1)}}}return o}}class Llt extends Rm{constructor(){super(...arguments),this.DOMINANCE_FACTOR=20,this.DEFENSE_FACTOR=5,this.TERRITORY_FACTOR=2,this.OFFENSE_FACTOR=10,this.CENTER_FACTOR=5,this.MOBILITY_FACTOR=.12}getDominance(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));i.isPlayer()&&(e+=i.getScoreModifier())}return e*this.DOMINANCE_FACTOR}getDefense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new M(r,11))===z.ZERO&&(e+=z.ZERO.getScoreModifier()),t.getPieceAt(new M(r,0))===z.ONE&&(e+=z.ONE.getScoreModifier());return e*this.DEFENSE_FACTOR}getTerritory(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));if(i.isPlayer()){for(let o=-1;o<=1;o++)for(let c=-1;c<=1;c++){const u=new M(s+o,r+c);if(u.isInRange(14,12)){const h=t.getPieceAt(u);(h===i||h===pe.NONE)&&(e+=1*i.getScoreModifier())}}e-=i.getScoreModifier()}}return e*this.TERRITORY_FACTOR}getOffense(t){let e=0;for(let r=0;r<14;r++)t.getPieceAt(new M(r,0))===z.ZERO&&(e+=z.ZERO.getScoreModifier()),t.getPieceAt(new M(r,11))===z.ONE&&(e+=z.ONE.getScoreModifier());return e*this.OFFENSE_FACTOR}getCenter(t){let e=0;for(let r=0;r<12;r++)for(let s=0;s<14;s++){const i=t.getPieceAt(new M(s,r));i.isPlayer()&&(e+=i.getScoreModifier()*Math.sqrt((s-6.5)*(s-6.5)))}return e*this.CENTER_FACTOR}getMobility(t){let e=0,r=0,s=0;for(let i=0;i<12;i++)for(let o=0;o<14;o++){const c=new M(o,i),u=t.getPieceAt(c);if(u.isPlayer())for(const h of be.DIRECTIONS){let p=1,m=c.getNext(h,1);for(;m.isInRange(14,12)&&t.getPieceAt(m)===u;)p+=1,m=m.getNext(h,1);let C=1;for(;m.isInRange(14,12)&&C<=p&&t.getPieceAt(m)===pe.NONE;)C++,m=m.getNext(h,1);e+=C*C*u.getScoreModifier(),u===z.ZERO?r=Math.max(r,C):u===z.ONE&&(s=Math.max(s,C))}}return(e+r*z.ZERO.getScoreModifier()+s*z.ONE.getScoreModifier())*this.MOBILITY_FACTOR}getBoardValue(t){const e=t.gameState,r=this.ruler.getGameStatus(t);if(r.isEndGame)return r.toBoardValue();const s=this.getDominance(e),i=this.getDefense(e),o=this.getTerritory(e),c=this.getCenter(e),u=this.getOffense(e),h=this.getMobility(e);return new Ct(s+i+o+c+u+h)}}const k=pe.NONE,Ir=pe.ZERO,G1=pe.ONE;class Kce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board`,$localize`This is the initial board of Epaminondas.
        The top line is the starting line of Light.
        The bottom line is the starting line of Dark.`,A3.getInitialState()),ce.informational($localize`Goal of the game (1/2)`,$localize`After multiple moves, if at the beginning of its turn, a player has more pieces on the opponent's starting line
        than the number of pieces the opponent has on the player's starting line, the player wins.
        Here, it's Dark's turn to play: Dark has therefore won.`,new A3([[k,k,k,k,k,Ir,k,k,G1,G1,G1,G1,G1,G1],[k,k,k,k,k,Ir,k,k,k,k,k,k,G1,G1],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,G1,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,Ir,Ir,Ir,Ir,k,k,k]],0)),ce.informational($localize`Goal of the game (2/2)`,$localize`Here, it is Light's turn.
        Light wins because they have two pieces on Dark's starting line, and Dark only has one on Light's starting line.`,new A3([[k,k,k,k,k,Ir,k,k,k,k,G1,G1,G1,G1],[k,k,k,k,k,Ir,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,G1,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,G1,G1,k,k,k,Ir,Ir,k,Ir,Ir,Ir,Ir]],1)),ce.fromPredicate($localize`Moving a piece`,$localize`Here is the starting board. Dark plays first.
        Let's start with moving a single piece:
        <ol>
            <li>Click on a piece.</li>
            <li>Click on a empty neighboring square.</li>
        </ol><br/>You're playing Dark, move a piece.`,A3.getInitialState(),new Ac(0,10,1,1,be.UP),(t,e,r)=>1===t.movedPieces?U.SUCCESS:U.failure($localize`Congratulations, you are in advance. But this is not the exercise here, try again.`),$localize`This is how you move a single piece.`),ce.fromPredicate($localize`Moving a phalanx`,$localize`Let us now see how to move multiple pieces along a line, which is called a phalanx:
        <ol>
            <li>Click on the first piece of the phalanx.</li>
            <li>Click on the last piece of the phalanx.</li>
            <li>Click on one of the squares highlighted in yellow; you can move your phalanx up to a distance equal to its length.</li>
        </ol><br/>
        You're playing Dark, Move a phalanx!`,A3.getInitialState(),new Ac(0,11,2,1,be.UP),(t,e,r)=>t.movedPieces>1?U.SUCCESS:U.failure($localize`Failed! You moved only one piece.`),$localize`Congratulations!
        The moved pieces can be horizontally, vertically, or diagonally aligned.
        The move should be made along this axis, forward or backwards.
        There can be no opponent nor holes in the phalanx.`),ce.fromMove($localize`Capture`,$localize`In order to capture pieces of the opponent:
        <ol>
            <li>It must be aligned with the phalanx you are moving.</li>
            <li>It must be strictly shorter than your phalanx.</li>
            <li>The first piece of your phalanx should land on the first piece of the opponent's phalanx that you want to capture.</li>
        </ol><br/>
        You're playing Dark, capture a phalanx.`,new A3([[k,k,k,k,k,k,k,k,G1,G1,G1,G1,G1,G1],[k,k,k,k,k,k,G1,k,k,k,k,k,k,k],[k,k,k,k,k,G1,k,k,k,k,k,k,k,k],[k,k,G1,k,G1,k,k,k,k,k,k,k,k,k],[k,k,G1,G1,k,k,k,k,k,k,k,k,k,k],[k,k,G1,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,Ir,k,k,k,k,k,k,k,k,k,k,k],[k,k,Ir,k,k,k,k,G1,k,k,k,k,k,k],[k,k,Ir,k,k,k,k,k,k,k,k,k,k,k],[k,k,Ir,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,Ir,Ir,Ir,Ir,Ir,Ir,Ir]],0),[new Ac(2,10,4,2,be.UP)],$localize`Congratulations, you made it!
        Note that the diagonal phalanx was not aligned with your phalanx, hence even if it is longer, this does not prevent you from capturing some of its pieces on another alignment.`,$localize`Failed, you have not captured the phalanx.`)]}}function Rlt(n,t){if(1&n){const e=Oe();B(),b(0,"circle",4),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onClick(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE*e+s.STROKE_WIDTH+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.STROKE_WIDTH+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function Dlt(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",2),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),O(),x(2,Rlt,1,4,"circle",3),O()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e+s.STROKE_WIDTH)("y",s.SPACE_SIZE*r+s.STROKE_WIDTH)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]!==s.NONE)}}function zlt(n,t){if(1&n&&(B(),b(0,"g"),x(1,Dlt,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Vlt(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",5),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),D("x",r.SPACE_SIZE*e.x+r.STROKE_WIDTH)("y",r.SPACE_SIZE*e.y+r.STROKE_WIDTH)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let Hlt=(()=>{class n extends No{constructor(e){super(e),this.NONE=pe.NONE,this.firstPiece=P.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=P.empty(),this.phalanxDirection=P.empty(),this.phalanxMiddles=[],this.moveds=[],this.capturedCoords=[],this.hasAsymetricBoard=!0,this.rules=new n8(A3),this.availableMinimaxes=[new Rm(this.rules,"Normal"),new klt(this.rules,"Positional"),new Llt(this.rules,"Attack")],this.encoder=Ac.encoder,this.tutorial=(new Kce).tutorial,this.updateBoard()}updateBoard(){this.firstPiece=P.empty(),this.lastPiece=P.empty(),this.hidePreviousMove(),this.rules.node.move.isPresent()&&this.showPreviousMove(),this.board=this.getState().getCopiedBoard()}showPreviousMove(){const e=this.rules.node.move.get();let r=e.coord;this.moveds=[r];for(let o=1;o<e.stepSize+e.movedPieces;o++)r=r.getNext(e.direction,1),this.moveds.push(r);const s=this.rules.node.mother.get(),i=s.gameState.getCurrentOpponent();for(;r.isInRange(14,12)&&s.gameState.getPieceAt(r)===i;)this.capturedCoords.push(r),r=r.getNext(e.direction,1)}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);return i.isFailure()?s.cancelMove(i.getReason()):s.firstPiece.isAbsent()?s.firstClick(e,r):s.lastPiece.isAbsent()?s.secondClick(e,r):s.thirdClick(e,r)})()}firstClick(e,r){var s=this;return A(function*(){const i=s.getState().getCurrentOpponent(),o=s.getState().getCurrentPlayer();switch(s.board[r][e]){case o:return s.firstPiece=P.of(new M(e,r)),s.validExtensions=s.getValidExtensions(o),s.phalanxValidLandings=s.getPhalanxValidLandings(),U.SUCCESS;case i:return s.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE());default:return we.expectToBe(s.board[r][e],pe.NONE),s.cancelMove(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY())}})()}hidePreviousMove(){this.capturedCoords=[],this.moveds=[]}getValidExtensions(e){return this.lastPiece.isPresent()?this.getPhalanxValidExtensions(e):this.getFirstPieceExtensions(e)}getFirstPieceExtensions(e){const r=[];for(const s of be.DIRECTIONS){let i=this.firstPiece.get().getNext(s,1);for(;i.isInRange(14,12)&&this.board[i.y][i.x]===e;)r.push(i),i=i.getNext(s,1)}return r}getPhalanxValidExtensions(e){let r=be.factory.fromMove(this.firstPiece.get(),this.lastPiece.get()).get();const s=this.lastPiece.get().getNext(r,1),i=this.getExtensionsToward(s,r,e);r=r.getOpposite();const o=this.firstPiece.get().getNext(r,1),c=this.getExtensionsToward(o,r,e);return i.concat(c)}getExtensionsToward(e,r,s){const i=[];for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i.push(e),e=e.getNext(r,1);return i}getPhalanxValidLandings(){if(this.lastPiece.isPresent()){const e=this.firstPiece.get(),r=this.lastPiece.get(),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),o=Math.max(s,i)+1;let c=be.factory.fromMove(e,r).get();const u=r.getNext(c,1),h=this.getLandingsToward(u,c,o);c=c.getOpposite();const p=e.getNext(c,1);return this.getLandingsToward(p,c,o).concat(h)}return this.getNeighboringEmptySpaces()}getNeighboringEmptySpaces(){const e=[];for(const r of be.DIRECTIONS){const s=this.firstPiece.get().getNext(r,1);s.isInRange(14,12)&&this.board[s.y][s.x]===pe.NONE&&e.push(s)}return e}getLandingsToward(e,r,s){const i=this.getState().getCurrentPlayer(),o=this.getState().getCurrentOpponent(),c=[];for(;e.isInRange(14,12)&&c.length<s&&this.board[e.y][e.x]!==i;){if(this.board[e.y][e.x]===o)return this.getPhalanxLength(e,r,o)<s&&c.push(e),c;c.push(e),e=e.getNext(r,1)}return c}getPhalanxLength(e,r,s){let i=0;for(;e.isInRange(14,12)&&this.board[e.y][e.x]===s;)i++,e=e.getNext(r,1);return i}cancelMoveAttempt(){this.firstPiece=P.empty(),this.validExtensions=[],this.phalanxValidLandings=[],this.lastPiece=P.empty(),this.phalanxMiddles=[],this.hidePreviousMove()}secondClick(e,r){var s=this;return A(function*(){const i=new M(e,r),o=s.firstPiece.get();if(i.equals(o))return s.cancelMoveAttempt(),U.SUCCESS;const c=s.getState().getCurrentOpponent(),u=s.getState().getCurrentPlayer();if(!i.isAlignedWith(o))return s.cancelMove(Ic.SQUARE_NOT_ALIGNED_WITH_SELECTED());const h=i.getDistance(o),p=o.getDirectionToward(i).get();switch(s.board[r][e]){case pe.NONE:return 1===h?s.tryMove(new Ac(o.x,o.y,1,1,p)):s.cancelMove(Ic.SINGLE_PIECE_MUST_MOVE_BY_ONE());case c:return s.cancelMove(Ic.SINGLE_PIECE_CANNOT_CAPTURE());default:we.expectToBe(s.board[r][e],u);const m=new Ac(o.x,o.y,h,1,p),C=s.getState(),w=n8.getPhalanxValidity(C,m);return w.isFailure()?s.cancelMove(w.getReason()):(s.lastPiece=P.of(i),s.validExtensions=s.getValidExtensions(u),s.phalanxValidLandings=s.getPhalanxValidLandings(),s.phalanxMiddles=o.getCoordsToward(i),s.phalanxDirection=P.of(p),U.SUCCESS)}})()}thirdClick(e,r){var s=this;return A(function*(){const i=s.getState().getCurrentPlayer(),o=new M(e,r);if(s.firstPiece.equalsValue(o))return s.moveFirstPiece(i);if(s.lastPiece.equalsValue(o))return s.moveLastPiece(i);const c=s.firstPiece.get(),u=s.lastPiece.get();if(!o.isAlignedWith(c))return s.cancelMove(Ic.SQUARE_NOT_ALIGNED_WITH_PHALANX());let h=be.factory.fromMove(c,u).get();const p=be.factory.fromMove(c,o).get();if(h===p.getOpposite()&&(s.firstPiece=P.of(u),s.lastPiece=P.of(c),h=p),h!==p)return s.cancelMove(Ic.SQUARE_NOT_ALIGNED_WITH_PHALANX());if(s.board[r][e]===i)return s.thirdClickOnPlayerPiece(o,h,i);{const m=s.firstPiece.get().getDistance(s.lastPiece.get())+1,C=s.lastPiece.get().getDistance(o),w=new Ac(s.firstPiece.get().x,s.firstPiece.get().y,m,C,h);return s.tryMove(w)}})()}thirdClickOnPlayerPiece(e,r,s){var i=this;return A(function*(){i.lastPiece=P.of(e);const o=i.firstPiece.get().getDistance(e)+1,c=new Ac(i.firstPiece.get().x,i.firstPiece.get().y,o,1,r),u=n8.getPhalanxValidity(i.rules.node.gameState,c);return u.isFailure()?i.cancelMove(u.getReason()):(i.phalanxMiddles=i.firstPiece.get().getCoordsToward(i.lastPiece.get()),i.validExtensions=i.getValidExtensions(s),i.phalanxValidLandings=i.getPhalanxValidLandings(),U.SUCCESS)})()}moveFirstPiece(e){var r=this;return A(function*(){return r.firstPiece=P.of(r.firstPiece.get().getNext(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?yield r.moveOnlyPiece(e):(r.phalanxMiddles=r.phalanxMiddles.slice(1),r.validExtensions=r.getPhalanxValidExtensions(e)),r.phalanxValidLandings=r.getPhalanxValidLandings(),U.SUCCESS})()}moveLastPiece(e){var r=this;return A(function*(){return r.lastPiece=P.of(r.lastPiece.get().getPrevious(r.phalanxDirection.get(),1)),r.firstPiece.equals(r.lastPiece)?r.moveOnlyPiece(e):(r.phalanxMiddles=r.firstPiece.get().getCoordsToward(r.lastPiece.get()),r.validExtensions=r.getPhalanxValidExtensions(e),r.phalanxValidLandings=r.getPhalanxValidLandings(),U.SUCCESS)})()}moveOnlyPiece(e){var r=this;return A(function*(){return r.lastPiece=P.empty(),r.validExtensions=r.getFirstPieceExtensions(e),r.phalanxDirection=P.empty(),r.phalanxMiddles=[],r.phalanxValidLandings=r.getPhalanxValidLandings(),U.SUCCESS})()}tryMove(e){const r=this.getState();return this.cancelMove(),this.chooseMove(e,r)}getPieceClasses(e,r){const s=this.getPlayerClass(this.board[r][e]);return this.getPieceStrokeClasses(e,r).concat([s])}getPieceStrokeClasses(e,r){const s=new M(e,r);return this.firstPiece.isAbsent()?[]:this.firstPiece.equalsValue(s)||this.lastPiece.equalsValue(s)||this.phalanxMiddles.some(i=>i.equals(s))?["selected-stroke"]:[]}getRectClasses(e,r){const s=new M(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:this.moveds.some(i=>i.equals(s))?["moved-fill"]:[]}getHighlightedCoords(){return this.firstPiece.isPresent()?this.phalanxValidLandings.concat(this.validExtensions):this.getCurrentPlayerPieces()}getCurrentPlayerPieces(){const e=[],s=this.getState().getCurrentPlayer();for(let i=0;i<this.board.length;i++)for(let o=0;o<this.board[i].length;o++)this.board[i][o]===s&&e.push(new M(o,i));return e}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-epaminondas"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 0 1410 1210","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass","click",4,"ngIf"],[1,"base",3,"ngClass","click"],[1,"no-fill","mid-stroke","clickable-stroke",3,"click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,zlt,2,1,"g",1),x(2,Vlt,2,4,"g",1),O()),2&e&&(D("transform",r.rotation),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getHighlightedCoords()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class yi{constructor(t){if(t.length<4)throw new Error("Cannot create a GipfCapture with less than 4 captured pieces");if(!1===Wa.areOnSameLine(t))throw new Error("Cannot create a GipfCapture with pieces that are not on the same line");this.capturedSpaces=Ke.copyImmutableArray(t).sort((r,s)=>{if(r.x===s.x){if(r.y===s.y)throw new Error("Cannot create a GipfCapture with duplicate coords");return r.y>s.y?1:-1}return r.x>s.x?1:-1});let e=P.empty();for(const r of this.capturedSpaces){if(e.isPresent()&&1!==e.get().getDistance(r))throw new Error("Cannot create a GipfCapture with non-consecutive coords");e=P.of(r)}}toString(){let t="";for(const e of this.capturedSpaces)""!==t&&(t+=","),t+=e.toString();return t}size(){return this.capturedSpaces.length}forEach(t){this.capturedSpaces.forEach(t)}contains(t){for(let e=0;e<this.capturedSpaces.length;e++)if(this.capturedSpaces[e].equals(t))return!0;return!1}intersectsWith(t){return this.capturedSpaces.some(e=>t.contains(e))}getLine(){return Wa.fromTwoCoords(this.capturedSpaces[0],this.capturedSpaces[1]).get()}equals(t){if(this===t)return!0;if(this.capturedSpaces.length!==t.capturedSpaces.length)return!1;for(let e=0;e<this.capturedSpaces.length;e++)if(!this.capturedSpaces[e].equals(t.capturedSpaces[e]))return!1;return!0}}yi.encoder=new class extends w4{encode(n){return n.capturedSpaces.map(t=>M.encoder.encode(t))}decode(n){return new yi(n.map(M.encoder.decode))}};class ja{constructor(t,e){this.coord=t,this.direction=e}toString(){return this.direction.isPresent()?this.coord.toString()+"@"+this.direction.get().toString():this.coord.toString()}equals(t){return!!this.coord.equals(t.coord)&&this.direction.equals(t.direction)}}ja.encoder=new class extends w4{constructor(){super(...arguments),this.optionalDirectionEncoder=P.getEncoder(ke.encoder)}encode(n){return{coord:M.encoder.encode(n.coord),direction:this.optionalDirectionEncoder.encode(n.direction)}}decode(n){const t=n;return ye(null!=t.coord,"Invalid encoded GipfPlacement"),new ja(M.encoder.decode(t.coord),this.optionalDirectionEncoder.decode(t.direction))}};class ha extends $i{constructor(t,e,r){super(),this.placement=t,this.initialCaptures=e,this.finalCaptures=r}toString(){return"GipfMove(["+this.capturesToString(this.initialCaptures)+"], "+this.placement.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}equals(t){return this===t||!(!1===this.placement.equals(t.placement)||!1===Ke.compareArray(this.initialCaptures,t.initialCaptures)||!1===Ke.compareArray(this.finalCaptures,t.finalCaptures))}encode(){return ha.encoder.encode(this)}decode(t){return ha.encoder.decode(t)}}ha.encoder=new class extends M2{encodeMove(n){const t={placement:ja.encoder.encode(n.placement)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=yi.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=yi.encoder.encode(e)}),t}decodeMove(n){const t=n;return ye(null!=t.placement,"Invalid encoded GipfMove"),new ha(ja.encoder.decode(t.placement),this.decodeArray(t,"initialCapture",yi.encoder.decode),this.decodeArray(t,"finalCapture",yi.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class Za extends yH{constructor(t,e,r,s){super(e,t,7,7,[3,2,1],Ae.EMPTY),this.sidePieces=r,this.capturedPieces=s}static getInitialState(){const t=Ae.EMPTY,e=Ae.UNREACHABLE,r=Ae.ZERO,s=Ae.ONE;return new Za([[e,e,e,s,t,t,r],[e,e,t,t,t,t,t],[e,t,t,t,t,t,t],[r,t,t,t,t,t,s],[t,t,t,t,t,t,e],[t,t,t,t,t,e,e],[s,t,t,r,e,e,e]],0,[12,12],[0,0])}equals(t){return this.turn===t.turn&&this.sidePieces[0]===t.sidePieces[0]&&this.sidePieces[1]===t.sidePieces[1]&&this.capturedPieces[0]===t.capturedPieces[0]&&this.capturedPieces[1]===t.capturedPieces[1]&&Ke.compareTable(this.board,t.board)}getNumberOfPiecesToPlace(t){return this.sidePieces[t.value]}getNumberOfPiecesCaptured(t){return this.capturedPieces[t.value]}setAtUnsafe(t,e){const r=Ke.copyBiArray(this.board);return r[t.y][t.x]=e,new Za(r,this.turn,this.sidePieces,this.capturedPieces)}isOnBoard(t){return!t.isNotInRange(this.width,this.height)&&this.board[t.y][t.x]!==Ae.UNREACHABLE}}let xc=(()=>{class n{}return n.CAPTURE_MUST_BE_ALIGNED=()=>$localize`You can only capture when 4 or more of your pieces are aligned, and it is not the case.`,n.INVALID_CAPTURED_PIECES=()=>$localize`You must select a valid capture that contains 4 pieces or more.`,n.MISSING_CAPTURES=()=>$localize`There are still possible captures to be done.`,n.PLACEMENT_NOT_ON_BORDER=()=>$localize`Pieces must be inserted in spaces on the edge of the board.`,n.INVALID_PLACEMENT_DIRECTION=()=>$localize`You must select a valid placement direction.`,n.PLACEMENT_WITHOUT_DIRECTION=()=>$localize`You must select a placement with a direction alongside the insertion space.`,n.PLACEMENT_ON_COMPLETE_LINE=()=>$localize`You cannot place a piece on a complete line.`,n.AMBIGUOUS_CAPTURE_COORD=()=>$localize`This piece belongs to two captures. Please select another piece in the capture you'd like to make.`,n.NO_DIRECTIONS_AVAILABLE=()=>$localize`You cannot insert a piece here, as all lines are full. Select another space.`,n})();class $n extends Z1{applyLegalMove(t,e,r){return new Za(r.board,r.turn+1,r.sidePieces,r.capturedPieces)}static applyCaptures(t,e){let r=e;return t.forEach(s=>{r=$n.applyCapture(s,r)}),r}static applyCapture(t,e){const r=e.getCurrentPlayer();let s=e;const i=[e.sidePieces[0],e.sidePieces[1]],o=[e.capturedPieces[0],e.capturedPieces[1]];return t.forEach(c=>{const u=e.getPieceAt(c);s=s.setAt(c,Ae.EMPTY),u.is(r)?i[r.value]+=1:o[r.value]+=1}),new Za(s.board,e.turn,i,o)}static getPlacements(t){const e=[];return Ns.INSTANCE.getAllBorders(t).forEach(r=>{t.getPieceAt(r)===Ae.EMPTY?e.push(new ja(r,P.empty())):$n.getAllDirectionsForEntrance(t,r).forEach(s=>{!1===$n.isLineComplete(t,r,s)&&e.push(new ja(r,P.of(s)))})}),e}static isLineComplete(t,e,r){return $n.nextGapInLine(t,e,r).isAbsent()}static nextGapInLine(t,e,r){for(let s=e;t.isOnBoard(s);s=s.getNext(r))if(t.getPieceAt(s)===Ae.EMPTY)return P.of(s);return P.empty()}static applyPlacement(t,e){const r=e.getCurrentPlayer();let s=e,i=Ae.ofPlayer(e.getCurrentPlayer());if(t.direction.isAbsent()){const c=t.coord;if(e.getPieceAt(c)!==Ae.EMPTY)throw new Error("Apply placement called without direction while the coord is occupied");s=s.setAt(c,i)}else for(let c=t.coord;s.isOnBoard(c)&&i!==Ae.EMPTY;c=c.getNext(t.direction.get())){const u=e.getPieceAt(c);s=s.setAt(c,i),i=u}const o=[e.sidePieces[0],e.sidePieces[1]];return o[r.value]-=1,new Za(s.board,e.turn,o,e.capturedPieces)}getPiecesMoved(t,e,r){const s=$n.applyCaptures(e,t);if(r.direction.isAbsent())return[r.coord];{const i=r.direction.get(),o=[];o.push(r.coord);let c=r.coord.getNext(i);for(;s.isOnBoard(c)&&s.getPieceAt(c)!==Ae.EMPTY;)o.push(c),c=c.getNext(i);return ye(s.isOnBoard(c)&&s.getPieceAt(c)===Ae.EMPTY,"getPiecesMoved called with an invalid placement performed on a full line"),o.push(c),o}}static getAllDirectionsForEntrance(t,e){if(Ns.INSTANCE.isTopLeftCorner(t,e))return[ke.RIGHT,ke.DOWN,ke.UP_RIGHT];if(Ns.INSTANCE.isTopCorner(t,e))return[ke.DOWN,ke.DOWN_LEFT,ke.RIGHT];if(Ns.INSTANCE.isTopRightCorner(t,e))return[ke.DOWN_LEFT,ke.DOWN,ke.LEFT];if(Ns.INSTANCE.isBottomLeftCorner(t,e))return[ke.UP_RIGHT,ke.UP,ke.RIGHT];if(Ns.INSTANCE.isBottomCorner(t,e))return[ke.UP,ke.LEFT,ke.UP_RIGHT];if(Ns.INSTANCE.isBottomRightCorner(t,e))return[ke.LEFT,ke.UP,ke.DOWN_LEFT];if(Ns.INSTANCE.isOnTopLeftBorder(t,e))return[ke.RIGHT,ke.DOWN];if(Ns.INSTANCE.isOnLeftBorder(t,e))return[ke.UP_RIGHT,ke.RIGHT];if(Ns.INSTANCE.isOnBottomLeftBorder(t,e))return[ke.UP,ke.UP_RIGHT];if(Ns.INSTANCE.isOnBottomRightBorder(t,e))return[ke.LEFT,ke.UP];if(Ns.INSTANCE.isOnRightBorder(t,e))return[ke.LEFT,ke.DOWN_LEFT];if(Ns.INSTANCE.isOnTopRightBorder(t,e))return[ke.DOWN_LEFT,ke.DOWN];throw new Error("not a border")}isLegal(t,e){const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=$n.applyCaptures(t.initialCaptures,e),i=this.noMoreCapturesValidity(s);if(i.isFailure())return i.toFailedFallible();const o=this.placementValidity(s,t.placement);if(o.isFailure())return o.toFailedFallible();const c=$n.applyPlacement(t.placement,s),u=this.capturesValidity(c,t.finalCaptures);if(u.isFailure())return u.toFailedFallible();const h=$n.applyCaptures(t.finalCaptures,c),p=this.noMoreCapturesValidity(h);return p.isFailure()?p.toFailedFallible():$.success(h)}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=$n.applyCapture(s,r)}return U.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer(),s=$n.getLinePortionWithFourPiecesOfPlayer(t,r,e.getLine());if(s.isAbsent())return U.failure(xc.CAPTURE_MUST_BE_ALIGNED());const i=s.get();return $n.getCapturable(t,i).equals(e)?U.SUCCESS:U.failure(xc.INVALID_CAPTURED_PIECES())}static getLinePortionsWithFourPiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=$n.getLinePortionWithFourPiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}static getLinePortionWithFourPiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let c=i;for(let u=i;t.isOnBoard(u);u=u.getNext(o))if(t.getPieceAt(u).is(e)?(0===s&&(c=u),s+=1):s=0,4===s)return P.of({0:c,1:u,2:o});return P.empty()}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===$n.getLinePortionsWithFourPiecesOfPlayer(t,e).length?U.SUCCESS:U.failure(xc.MISSING_CAPTURES())}placementValidity(t,e){const r=this.placementCoordValidity(t,e.coord);if(r.isFailure())return r;if(t.getPieceAt(e.coord)!==Ae.EMPTY){if(e.direction.isAbsent())return U.failure(xc.PLACEMENT_WITHOUT_DIRECTION());if($n.isLineComplete(t,e.coord,e.direction.get()))return U.failure(xc.PLACEMENT_ON_COMPLETE_LINE());for(const s of $n.getAllDirectionsForEntrance(t,e.coord))if(s===e.direction.get())return U.SUCCESS;return U.failure(xc.INVALID_PLACEMENT_DIRECTION())}return U.SUCCESS}placementCoordValidity(t,e){return Ns.INSTANCE.isOnBorder(t,e)?U.SUCCESS:U.failure(xc.PLACEMENT_NOT_ON_BORDER())}static getCapturable(t,e){const r=[],s=e[0],i=e[1],o=e[2],c=o.getOpposite();let u=s.getNext(c);for(;t.isOnBoard(u)&&t.getPieceAt(u)!==Ae.EMPTY;)r.push(u),u=u.getNext(c);for(let h=s;!h.equals(i);h=h.getNext(o))r.push(h);for(let h=i;t.isOnBoard(h)&&t.getPieceAt(h)!==Ae.EMPTY;h=h.getNext(o))r.push(h);return new yi(r)}static getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return $n.getLinePortionsWithFourPiecesOfPlayer(t,e).forEach(s=>{r.push($n.getCapturable(t,s))}),r}static getPlayerScore(t,e){const r=t.getNumberOfPiecesToPlace(e);if(0===r&&0===$n.getPossibleCaptures(t).length)return P.empty();const s=t.getNumberOfPiecesCaptured(e);return P.of(r+3*s)}static isGameOver(t){const e=$n.getPlayerScore(t,z.ZERO),r=$n.getPlayerScore(t,z.ONE);return e.isAbsent()||r.isAbsent()}getGameStatus(t){const e=t.gameState,r=$n.getPlayerScore(e,z.ZERO),s=$n.getPlayerScore(e,z.ONE);return r.isAbsent()?xe.ONE_WON:s.isAbsent()?xe.ZERO_WON:xe.ONGOING}}class Dm extends $1{static getPossibleCaptureCombinationsFromPossibleCaptures(t){const e=Dm.computeIntersections(t);let r=[[]];return t.forEach((s,i)=>{if(0===e[i].length)r.forEach(o=>{o.push(i)});else{const o=[],c=e[i].some(u=>u>i);for(const u of r)!0===u.some(p=>e[i].some(m=>p===m))?o.push(Ke.copyImmutableArray(u)):c?(o.push(Ke.copyImmutableArray(u)),u.push(i),o.push(Ke.copyImmutableArray(u))):(u.push(i),o.push(Ke.copyImmutableArray(u)));r=o}}),r.map(s=>s.map(i=>t[i]))}static computeIntersections(t){const e=[];return t.forEach((r,s)=>{e.push([]),t.forEach((i,o)=>{s!==o&&r.intersectsWith(i)&&e[s].push(o)})}),e}getBoardValue(t){const e=t.gameState,r=$n.getPlayerScore(e,z.ZERO),s=$n.getPlayerScore(e,z.ONE);return r.isAbsent()?new Ct(z.ONE.getVictoryValue()):s.isAbsent()?new Ct(z.ZERO.getVictoryValue()):new Ct(r.get()-s.get())}getListMoves(t){return this.getListMoveFromState(t.gameState)}getListMoveFromState(t){const e=[];return $n.isGameOver(t)||this.getPossibleCaptureCombinations(t).forEach(r=>{const s=$n.applyCaptures(r,t);$n.getPlacements(s).forEach(i=>{const o=$n.applyPlacement(i,s);this.getPossibleCaptureCombinations(o).forEach(c=>{const u=new ha(i,r,c);e.push(u)})})}),e}getPossibleCaptureCombinations(t){const e=$n.getPossibleCaptures(t);return Dm.getPossibleCaptureCombinationsFromPossibleCaptures(e)}}class Xce{constructor(t,e,r,s,i,o){this.source=t,this.destination=e,this.x1=r,this.y1=s,this.x2=i,this.y2=o}}const n1=Ae.UNREACHABLE,ft=Ae.EMPTY,xr=Ae.ZERO,x4=Ae.ONE;class Qce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal of Gipf is to capture the opponent's piece so that the opponent can no longer play.
        This is the initial board.
        Each player has 12 pieces on the side and 3 pieces on the board.
        When, at its turn, a player has no more pieces on the side, that player cannot play anymore and loses the game.
        The first player plays with the dark pieces, the second player plays with the light pieces.`,Za.getInitialState()),ce.anyMove($localize`Pushing`,$localize`Pieces can only enter the board through the edges. To insert a new piece:
        <ol>
            <li>Click on a space on the edge of the board.</li>
            <li>If that space was already occupied, click on the arrow that indicates the direction in which you want to push the piece(s) already on the corresponding line.</li>
        </ol>
        You cannot push when a line is full.<br/><br/>
        You're playing Dark, insert a piece.`,Za.getInitialState(),new ha(new ja(new M(3,0),P.of(ke.DOWN)),[],[]),$localize`Congratulations!`),ce.fromMove($localize`Capture (1/3)`,$localize`To capture, you must align 4 of your own pieces, which will be the first 4 captured pieces.
        There are multiple important aspects of a capture:
        <ol>
            <li>When 4 pieces are captured, all pieces that are directly aligned with these 4 pieces are also captured.</li>
            <li>As soon as there is an empty space on the line, the capture stops.</li>
            <li>Your own pieces that are captured go back to your stock.
                Your opponent's pieces however are really captured and do not go back to your opponent's stock.</li>
            <li>If you create a line of 4 of your opponent's pieces, it will be at the beginning of your opponent's turn that your opponent can capture them.
                This means that a turn happens in three phases:
                <ol type="A">
                    <li>Pick the capture(s) resulting from the last move of your opponent (by clicking on it).</li>
                    <li>Make your insertion.</li>
                    <li>Pick the capture(s) resulting from your move (by clicking on it).</li>
                </ol>
            </li>
        </ol><br/>
        You're playing Dark, you can make a capture, do it.`,new Za([[n1,n1,n1,xr,x4,ft,ft],[n1,n1,ft,ft,ft,ft,ft],[n1,ft,ft,ft,ft,ft,ft],[xr,xr,xr,ft,ft,ft,ft],[x4,ft,ft,ft,ft,ft,n1],[ft,ft,ft,x4,ft,n1,n1],[ft,ft,ft,x4,n1,n1,n1]],42,[8,8],[0,0]),[new ha(new ja(new M(0,3),P.of(ke.RIGHT)),[],[new yi([new M(0,3),new M(1,3),new M(2,3),new M(3,3)])])],$localize`Congratulations, you have gotten 4 of your pieces back. This is not the most useful capture.
        Let's now see how captures can really be useful.`,$localize`Failed. Try again.`),ce.fromMove($localize`Capture (2/3)`,$localize`Here, there are three different ways for Dark to capture.
        <ol>
          <li>One way does not capture any of your opponent's pieces.</li>
          <li>Another way captures one of your opponent's pieces.</li>
          <li>The last way captures two of your opponent's pieces.</li>
        </ol>
        <br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Za([[n1,n1,n1,ft,ft,ft,ft],[n1,n1,ft,x4,ft,ft,ft],[n1,ft,ft,xr,ft,ft,ft],[xr,xr,xr,x4,ft,ft,ft],[ft,ft,ft,xr,ft,ft,n1],[ft,ft,ft,xr,ft,n1,n1],[ft,ft,ft,x4,n1,n1,n1]],42,[8,4],[2,3]),[new ha(new ja(new M(0,3),P.of(ke.RIGHT)),[],[new yi([new M(3,1),new M(3,2),new M(3,3),new M(3,4),new M(3,5),new M(3,6)])])],$localize`Congratulations, you have gotten back 4 of your pieces and captured 2 of the opponent's.
        The most you can get is 3 per capture.`,$localize`Failed, the best capture was taking 2 of your opponent's pieces`),ce.fromMove($localize`Capture (3/3)`,$localize`Here, you must capture at the beginning of your turn.
        This is due to a move of your opponent at the previous turn
        (even though this is a fictitious board for pedagogical purpose).
        After your capture, by performing the right move you can even capture two more of your opponent's pieces!
        Keep it mind that the most useful in a capture is to take your opponent's pieces.<br/><br/>
        You're playing Dark, capture the most pieces from your opponent.`,new Za([[n1,n1,n1,xr,ft,ft,xr],[n1,n1,ft,xr,ft,ft,xr],[n1,xr,xr,ft,xr,x4,xr],[ft,ft,ft,xr,ft,ft,xr],[ft,ft,ft,xr,ft,ft,n1],[xr,xr,xr,x4,x4,n1,n1],[ft,ft,ft,xr,n1,n1,n1]],42,[3,4],[2,3]),[new ha(new ja(new M(3,6),P.of(ke.UP)),[new yi([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new yi([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)]),new yi([new M(1,2),new M(2,2),new M(3,2),new M(4,2),new M(5,2)])]),new ha(new ja(new M(4,6),P.of(ke.UP)),[new yi([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new yi([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)]),new yi([new M(3,0),new M(3,1),new M(3,2),new M(3,3),new M(3,4)])]),new ha(new ja(new M(3,6),P.of(ke.UP)),[new yi([new M(6,0),new M(6,1),new M(6,2),new M(6,3)])],[new yi([new M(1,2),new M(2,2),new M(3,2),new M(4,2),new M(5,2)]),new yi([new M(0,5),new M(1,5),new M(2,5),new M(3,5),new M(4,5)])])],$localize`Congratulations, you have gotten 12 of your pieces back and captured 2 of your opponent's pieces.`,$localize`Failed, the best capture takes 2 of your opponent's pieces.`)]}}function Flt(n,t){if(1&n&&(B(),X(0,"circle",13)),2&n){const e=v().$implicit,r=v();T("ngClass",r.getPieceClass(e)),D("cx",r.getCenterAt(e).x)("cy",r.getCenterAt(e).y)("r",r.SPACE_SIZE)}}function Blt(n,t){if(1&n){const e=Oe();B(),b(0,"g",10),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i))}),X(1,"polygon",11),x(2,Flt,1,4,"circle",12),O()}if(2&n){const e=t.$implicit,r=v();We("id","click_",e.x,"_",e.y,""),S(1),We("id","space_",e.x,"_",e.y,""),T("ngClass",r.getSpaceClass(e)),D("points",r.getHexaPointsAt(e)),S(1),T("ngIf",r.isPiece(e))}}function $lt(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",16),J("click",function(){const i=fe(e).$implicit;return ae(v(2).onClick(i))}),O()}if(2&n){const e=t.$implicit;D("points",v(2).getHexaPointsAt(e))}}function Ult(n,t){if(1&n&&(B(),b(0,"g",14),x(1,$lt,1,1,"polygon",15),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e.capturedSpaces)}}function Glt(n,t){if(1&n){const e=Oe();B(),b(0,"line",17),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i.destination))}),O()}if(2&n){const e=t.$implicit;D("x1",e.x1)("y1",e.y1)("x2",e.x2)("y2",e.y2)}}function Wlt(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",18),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v();S(1),We("id","piece_",r.value,"_",e,""),T("ngClass",s.getPlayerClass(r)),D("cx",s.getRemainingPieceCx(r,e))("cy",s.getRemainingPieceCy(r))("r",.5*s.SPACE_SIZE)}}function qlt(n,t){if(1&n&&(B(),b(0,"g"),x(1,Wlt,2,6,"g",8),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getPlayerSidePieces(e))}}function jlt(n,t){if(1&n&&(B(),X(0,"line",19)),2&n){const e=v();D("x1",e.inserted.get().x1)("y1",e.inserted.get().y1)("x2",e.inserted.get().x2)("y2",e.inserted.get().y2)}}let Zlt=(()=>{class n extends p9{constructor(e){super(e),this.inserted=P.empty(),this.arrows=[],this.captured=[],this.moved=[],this.hexagonWidth=this.SPACE_SIZE,this.sharedHexagonX=Math.cos(30)*this.hexagonWidth*.5,this.boardWidth=this.hexagonWidth+6*(this.hexagonWidth-this.sharedHexagonX)+3*this.STROKE_WIDTH/2,this.boardHeight=7*this.hexagonWidth+4.5*this.STROKE_WIDTH,this.movePhase=n.PHASE_PLACEMENT_COORD,this.possibleCaptures=[],this.initialCaptures=[],this.placement=P.empty(),this.placementEntrance=P.empty(),this.finalCaptures=[],this.hasAsymetricBoard=!0,this.scores=P.of([0,0]),this.rules=new $n(Za),this.availableMinimaxes=[new Dm(this.rules,"GipfMinimax")],this.encoder=ha.encoder,this.tutorial=(new Qce).tutorial,this.SPACE_SIZE=40,this.constructedState=this.getState(),this.hexaLayout=new g9(1.5*this.SPACE_SIZE,new M(this.hexagonWidth/2+3*this.STROKE_WIDTH/4,-this.hexagonWidth),Ns.INSTANCE)}updateBoard(){this.showLastMove(),this.cancelMoveAttempt()}showLastMove(){this.inserted=P.empty();const e=this.rules.node.move;if(e.isPresent()&&e.get().placement.direction.isPresent()){const r=e.get().placement;this.inserted=P.of(this.arrowTowards(r.coord,r.direction.get()))}this.cancelMoveAttempt()}arrowTowards(e,r){const s=e.getNext(r.getOpposite()),i=this.getCenterAt(e),o=this.getCenterAt(s);return new Xce(s,e,o.x,o.y,i.x,i.y)}markCapture(e){e.forEach(r=>{this.captured.push(r)})}getAllCoords(){return this.constructedState.allCoords()}getPlayerSidePieces(e){const r=this.constructedState.getNumberOfPiecesToPlace(e),s=[];for(let i=0;i<r;i+=1)s.push(i);return s}isPiece(e){return this.getPiece(e)!==Ae.EMPTY}getPiece(e){return this.constructedState.getPieceAt(e)}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());switch(r.movePhase){case n.PHASE_INITIAL_CAPTURE:case n.PHASE_FINAL_CAPTURE:return r.selectCapture(e);case n.PHASE_PLACEMENT_COORD:return r.selectPlacementCoord(e);default:return we.expectToBe(r.movePhase,n.PHASE_PLACEMENT_DIRECTION),r.selectPlacementDirectionOrPlacementCoord(e)}})()}selectCapture(e){var r=this;return A(function*(){const s=[];if(r.possibleCaptures.forEach(o=>{o.contains(e)&&s.push(o)}),s.length>1)return r.cancelMove(xc.AMBIGUOUS_CAPTURE_COORD());if(0===s.length)return r.cancelMove(xc.MISSING_CAPTURES());const i=s[0];return r.constructedState=$n.applyCapture(i,r.constructedState),r.markCapture(i),r.possibleCaptures=$n.getPossibleCaptures(r.constructedState),r.movePhase===n.PHASE_INITIAL_CAPTURE?(r.initialCaptures.push(i),0===r.possibleCaptures.length?r.moveToPlacementPhase():U.SUCCESS):(we.expectToBe(r.movePhase,n.PHASE_FINAL_CAPTURE),r.finalCaptures.push(i),0===r.possibleCaptures.length?r.tryMove(r.initialCaptures,r.placement.get(),r.finalCaptures):U.SUCCESS)})()}moveToPlacementPhase(){return this.movePhase=n.PHASE_PLACEMENT_COORD,U.SUCCESS}moveToInitialCaptureOrPlacementPhase(){return this.possibleCaptures=$n.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?n.PHASE_PLACEMENT_COORD:n.PHASE_INITIAL_CAPTURE,U.SUCCESS}moveToFinalCapturePhaseOrTryMove(){var e=this;return A(function*(){return e.possibleCaptures=$n.getPossibleCaptures(e.constructedState),0===e.possibleCaptures.length?e.tryMove(e.initialCaptures,e.placement.get(),e.finalCaptures):(e.movePhase=n.PHASE_FINAL_CAPTURE,U.SUCCESS)})()}computeArrows(e){this.arrows=[];for(const r of $n.getAllDirectionsForEntrance(this.constructedState,e))if(!1===$n.isLineComplete(this.constructedState,e,r)){const s=e.getNext(r),i=this.getCenterAt(e),o=this.getCenterAt(s);this.arrows.push(new Xce(e,s,i.x,i.y,o.x,o.y))}}selectPlacementCoord(e){var r=this;return A(function*(){const s=r.rules.placementCoordValidity(r.constructedState,e);return s.isFailure()?r.cancelMove(s.getReason()):r.placementEntrance.equalsValue(e)?(r.cancelMoveAttempt(),U.SUCCESS):(r.placementEntrance=P.of(e),r.constructedState.getPieceAt(e)===Ae.EMPTY?r.selectPlacementDirection(P.empty()):(r.movePhase=n.PHASE_PLACEMENT_DIRECTION,r.computeArrows(e),0===r.arrows.length&&r.cancelMove(xc.NO_DIRECTIONS_AVAILABLE()),U.SUCCESS))})()}selectPlacementDirection(e){var r=this;return A(function*(){r.placement=P.of(new ja(r.placementEntrance.get(),e));const s=r.rules.placementValidity(r.constructedState,r.placement.get());return s.isFailure()?r.cancelMove(s.getReason()):(r.arrows=[],r.constructedState=$n.applyPlacement(r.placement.get(),r.constructedState),r.moveToFinalCapturePhaseOrTryMove())})()}selectPlacementDirectionOrPlacementCoord(e){var r=this;return A(function*(){const s=r.placementEntrance.get();if(!1===s.isAlignedWith(e)||1!==s.getDistance(e))return r.selectPlacementCoord(e);const i=ke.factory.fromMove(s,e);return r.selectPlacementDirection(i.toOptional())})()}tryMove(e,r,s){var i=this;return A(function*(){const o=new ha(r,e,s);return yield i.chooseMove(o,i.getState(),i.scores.get())})()}cancelMoveAttempt(){this.constructedState=this.getState(),this.captured=[],this.moved=[];const e=this.rules.node.move;if(e.isPresent()){const r=e.get(),s=this.rules.node.mother.get().gameState;r.initialCaptures.forEach(i=>this.markCapture(i)),r.finalCaptures.forEach(i=>this.markCapture(i)),this.moved=this.rules.getPiecesMoved(s,r.initialCaptures,r.placement)}this.initialCaptures=[],this.finalCaptures=[],this.placementEntrance=P.empty(),this.placement=P.empty(),this.arrows=[],this.moveToInitialCaptureOrPlacementPhase()}getSpaceClass(e){return this.captured.some(r=>r.equals(e))?"captured-fill":this.moved.some(r=>r.equals(e))?"moved-fill":""}getPieceClass(e){const r=this.getPiece(e);return this.getPlayerClass(z.of(r.value))}getRemainingPieceCy(e){return e===z.ONE?25:this.boardHeight-25}getRemainingPieceCx(e,r){const s=20+r*this.SPACE_SIZE*.5;return e===z.ONE?s:this.boardWidth-(15+s)}}return n.PHASE_INITIAL_CAPTURE=0,n.PHASE_PLACEMENT_COORD=1,n.PHASE_PLACEMENT_DIRECTION=2,n.PHASE_FINAL_CAPTURE=3,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-gipf"]],features:[l],decls:11,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","arrowhead","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7"],["id","arrowhead-moved","markerWidth","10","markerHeight","7","refX","5","refY","3.5","orient","auto"],["points","0 0, 10 3.5, 0 7",1,"moved-fill","moved-stroke"],[3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],["class","arrow","marker-end","url(#arrowhead)",3,"click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["class","arrow moved-stroke","marker-end","url(#arrowhead-moved)",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"click"],["marker-end","url(#arrowhead)",1,"arrow",3,"click"],[1,"base","small-stroke",3,"id","ngClass"],["marker-end","url(#arrowhead-moved)",1,"arrow","moved-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),O(),b(4,"marker",3),X(5,"polygon",4),O()(),x(6,Blt,3,7,"g",5),x(7,Ult,2,1,"g",6),x(8,Glt,1,4,"line",7),x(9,qlt,2,1,"g",8),x(10,jlt,1,4,"line",9),O()),2&e&&(D("viewBox",-r.STROKE_WIDTH+" 0 "+r.boardWidth+" "+r.boardHeight)("transform",r.rotation),S(6),T("ngForOf",r.getAllCoords()),S(1),T("ngForOf",r.possibleCaptures),S(1),T("ngForOf",r.arrows),S(1),T("ngForOf",r.Player.PLAYERS),S(1),T("ngIf",r.inserted.isPresent()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class X1 extends S3{equals(t){return this===t||this.coord.equals(t.coord)}toString(){return this===X1.PASS?"GoMove.PASS":this===X1.ACCEPT?"GoMove.ACCEPT":"GoMove("+this.coord.x+", "+this.coord.y+")"}}X1.PASS=new X1(-1,0),X1.ACCEPT=new X1(-2,0),X1.PASS_NUMBER=-1,X1.ACCEPT_NUMBER=-2,X1.encoder=new class extends Cn{maxValue(){return 360}encodeNumber(n){return 19*n.coord.y+n.coord.x}decodeNumber(n){if(n===X1.PASS_NUMBER)return X1.PASS;const t=n%19;return new X1(t,(n-t)/19)}};class $e{constructor(t,e){this.player=t,this.type=e}equals(t){return t===this}toString(){switch(this){case $e.DARK:return"GoPiece.DARK";case $e.LIGHT:return"GoPiece.LIGHT";case $e.EMPTY:return"GoPiece.EMPTY";case $e.DEAD_DARK:return"GoPiece.DEAD_DARK";case $e.DEAD_LIGHT:return"GoPiece.DEAD_LIGHT";case $e.DARK_TERRITORY:return"GoPiece.DARK_TERRITORY";default:return ye(this===$e.LIGHT_TERRITORY,"Unexisting GoPiece"),"GoPiece.LIGHT_TERRITORY"}}static pieceBelongTo(t,e){return e===t.player&&"territory"!==t.type}static ofPlayer(t){return t===z.ZERO?$e.DARK:$e.LIGHT}isOccupied(){return[$e.DARK,$e.LIGHT,$e.DEAD_DARK,$e.DEAD_LIGHT].includes(this)}isEmpty(){return[$e.DARK_TERRITORY,$e.LIGHT_TERRITORY,$e.EMPTY].includes(this)}isDead(){return[$e.DEAD_DARK,$e.DEAD_LIGHT].includes(this)}isTerritory(){return[$e.DARK_TERRITORY,$e.LIGHT_TERRITORY].includes(this)}getOwner(){return this.player}nonTerritory(){return ye(this.isEmpty(),'Usually not false, if false, cover by test and return "this"'),$e.EMPTY}}$e.DARK=new $e(z.ZERO,"alive"),$e.LIGHT=new $e(z.ONE,"alive"),$e.EMPTY=new $e(pe.NONE,"empty"),$e.DEAD_DARK=new $e(z.ZERO,"dead"),$e.DEAD_LIGHT=new $e(z.ONE,"dead"),$e.DARK_TERRITORY=new $e(pe.NONE,"territory"),$e.LIGHT_TERRITORY=new $e(pe.NONE,"territory");var Vn=(()=>(function(n){n.PLAYING="PLAYING",n.PASSED="PASSED",n.COUNTING="COUNTING",n.ACCEPT="ACCEPT",n.FINISHED="FINISHED"}(Vn||(Vn={})),Vn))();let Is=(()=>{class n extends ps{constructor(e,r,s,i,o){super(e,s),this.captured=r,this.koCoord=i,this.phase=o}static getInitialState(){const e=n.getStartingBoard();return new n(e,[0,0],0,P.empty(),Vn.PLAYING)}getCapturedCopy(){return[this.captured[0],this.captured[1]]}static getStartingBoard(){return Ke.createTable(n.WIDTH,n.HEIGHT,$e.EMPTY)}copy(){return new n(this.getCopiedBoard(),this.getCapturedCopy(),this.turn,this.koCoord,this.phase)}isDead(e){return this.getPieceAt(e).isDead()}isTerritory(e){return this.getPieceAt(e).isTerritory()}}return n.WIDTH=13,n.HEIGHT=13,n})();const ot=$e.LIGHT,Qe=$e.DARK,MH=$e.DEAD_LIGHT,M9=$e.LIGHT_TERRITORY,kc=$e.DARK_TERRITORY,_e=$e.EMPTY;class Jce extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Preliminary information`,$localize`The game of Go is played on a board called a Goban, and the stones are placed on the intersections.
        The traditional board is made of 19x19 intersections, but on this website we have the 13x13 board.
        (For shorter parts, 9x9 and 5x5 boards exist, but are not yet available here).
        For this tutorial, we will use a smaller board for pedagogical purposes.`,Is.getInitialState()),ce.informational($localize`Goal of the game`,$localize`The goal of the game is to have the most points at the end of the game.
        We call "territories" the intersections that are empty and isolated from the rest of the Goban by the stones of a single player.
        Here, Dark has 9 territories on the left, and Light has 8 on the right.
        The top part belongs to no one.
        Each player's score at the end of the game is the sum of that player's territories and captures.`,new Is([[_e,Qe,_e,_e,ot,ot],[_e,Qe,_e,_e,ot,_e],[_e,Qe,Qe,ot,ot,_e],[_e,_e,Qe,ot,_e,_e],[_e,_e,Qe,ot,_e,_e],[_e,_e,Qe,ot,_e,_e]],[0,0],0,P.empty(),Vn.PLAYING)),ce.fromMove($localize`Simple capture`,$localize`An isolated stone, like the one in the middle here, has 4 neighboring intersections (not 8, because we do not count diagonals).
        It is said of a group which has exactly 2 free neighboring squares, that this group has two liberties.
        If Dark plays on the last liberty of the light stone, this stone is removed from the Goban (captured) and Dark earns one point.<br/><br/>
        You're playing Dark. The light piece on the board only has one liberty left, play there.`,new Is([[_e,_e,_e,_e,_e],[_e,_e,Qe,_e,_e],[_e,Qe,ot,_e,_e],[_e,_e,Qe,_e,_e],[_e,_e,_e,_e,_e]],[0,0],0,P.empty(),Vn.PLAYING),[new X1(3,2)],$localize`Congratulations, you have earned one point.`,$localize`Failed, try again by playing on one of the intersections directly next to the light stone.`),ce.fromMove($localize`Capturing multiple stones`,$localize`Stones that are connected horizontally or vertically must be captured at the same time, and are not capturable in isolation.<br/><br/>
        You're playing Dark. The light group here only has one liberty left, capture it.`,new Is([[_e,Qe,_e,_e,_e],[Qe,ot,_e,_e,_e],[Qe,ot,ot,Qe,_e],[_e,Qe,Qe,_e,_e],[_e,_e,_e,_e,_e]],[0,0],0,P.empty(),Vn.PLAYING),[new X1(2,1)],$localize`Congratulations, you have earned three points and formed a territory.`,$localize`Failed, you have not captured the group. Play on the last liberty of that group.`),ce.informational($localize`Suicide`,$localize`In Go, suicide is forbidden.
        If putting a piece on an intersection removes the last liberty of your group and does not capture any stone, playing on that intersection would be a suicide and is therefore forbidden.
        Here, the top left intersection is a suicide for Light.
        On the bottom right, it would be a suicide for Dark, and on the bottom left it is not a suicide for any player.`,new Is([[_e,Qe,_e,_e,_e],[Qe,_e,_e,_e,_e],[Qe,_e,_e,_e,ot],[ot,Qe,_e,ot,_e],[_e,ot,_e,ot,Qe]],[0,0],0,P.empty(),Vn.PLAYING)),ce.informational($localize`Life and death (death)`,$localize`From the capture rule follows the life and death notion:
        dead stones are stones that are definitely capturable (without losing anything else).
        Alive stones are stones that can never be captured.
        From the capture rule, Dark can play inside Light's territory and make a capture.
        In this case, we say that Light has only one eye (its last liberty) and that Light is dead (even if not yet captured).
        At the end of the game, the dead stones will count as captures, and the intersections they occupy as territories.`,new Is([[_e,_e,_e,_e,_e],[Qe,Qe,Qe,_e,_e],[ot,ot,Qe,_e,_e],[_e,ot,Qe,_e,_e],[ot,ot,Qe,_e,_e]],[0,0],0,P.empty(),Vn.PLAYING)),ce.informational($localize`Life and death (eyes)`,$localize`Here, Light cannot play on the top left, nor on the bottom left.
        Light will never be able to capture Dark.
        We say that Dark has two eyes (the eye on the top left, and the one on the bottom left) and that Dark is alive.`,new Is([[_e,Qe,ot,_e,_e],[ot,Qe,ot,_e,_e],[Qe,Qe,ot,_e,_e],[ot,Qe,ot,_e,_e],[_e,Qe,ot,_e,_e]],[0,0],0,P.empty(),Vn.PLAYING)),ce.informational($localize`Seki`,$localize`If Dark plays on the middle line, Light will play on the opposite intersection and capture Dark.
        Similarly, if Light plays on the middle line, Dark will capture Light.
        In other words, there is no point in playing on the middle line.
        In that case, we say that stones in the middle are alive by Seki, and that both intersections in the middle are neutral.`,new Is([[_e,ot,Qe,_e,ot,Qe,_e],[_e,ot,Qe,Qe,ot,Qe,_e],[_e,ot,Qe,Qe,ot,Qe,_e],[_e,ot,Qe,Qe,ot,Qe,_e],[_e,ot,Qe,ot,ot,Qe,_e],[_e,ot,Qe,ot,ot,Qe,_e],[_e,ot,Qe,_e,ot,Qe,_e]],[0,0],0,P.empty(),Vn.PLAYING)),ce.fromMove($localize`Ko`,$localize`A player, by putting a stone, cannot go back to an identical state of the Goban as before, in order to avoid an endless game.<br/><br/>
        You're playing Dark, capture the light stone.`,new Is([[_e,_e,_e,_e,_e,_e,_e],[_e,_e,_e,_e,_e,_e,_e],[_e,_e,_e,Qe,ot,_e,_e],[_e,_e,Qe,ot,_e,ot,_e],[_e,_e,_e,Qe,ot,_e,_e],[_e,_e,_e,_e,_e,_e,_e],[_e,_e,_e,_e,_e,_e,_e]],[0,0],0,P.empty(),Vn.PLAYING),[new X1(4,3)],$localize`Now, if Light tries to recapture the stone that Dark has just put on the Goban, this one would go back to its previous state, opening the door for an endless game.
        This intersection is therefore marked with a red square, to remind the players that this intersection is forbidden.
        This rule is called the Ko.
        The trick for Light is to try to create a big enough threat so that Dark must answer immediately, and does not have the time to protect its last stone, so that Light can capture it right after.`,$localize`Failed. Try again.`),ce.fromMove($localize`End of the game`,$localize`When a player feels that there is no advantage to putting a new stone, that player can pass a turn.
        The game phase stops when both players pass consecutively, and we move on to the counting phase.
        The dead groups are then marked by clicking on them.
        Every intersection in a player's territory earns that player a point.
        The winner is the one with most points.<br/><br/>
        You're playing Dark. A last stone is dead, mark it.`,new Is([[ot,Qe,Qe,Qe,Qe,Qe,kc,kc,kc],[ot,ot,ot,ot,Qe,Qe,Qe,kc,kc],[ot,M9,ot,ot,Qe,MH,MH,Qe,kc],[Qe,ot,ot,ot,ot,Qe,kc,kc,kc],[_e,ot,M9,ot,Qe,Qe,MH,Qe,kc],[ot,M9,ot,ot,Qe,Qe,Qe,Qe,Qe],[ot,ot,Qe,Qe,Qe,ot,ot,Qe,ot],[Qe,Qe,Qe,ot,ot,ot,M9,ot,ot],[kc,kc,Qe,Qe,Qe,ot,ot,M9,M9]],[0,0],0,P.empty(),Vn.COUNTING),[new X1(0,3)],$localize`Congratulations, Dark has 15 territories and 3 light stones still present, called prisoners at the end of the game.
        The intersections where the prisoners are count as Dark's territory
        Light has 8 territories and 1 prisoner.
        The end result is therefore 18 - 9 for Dark.`,$localize`Failed, try again.`)]}}let r8=(()=>{class n{constructor(e){this.color=e}selfContains(e){return this.getCoords().some(s=>s.equals(e))}static insertAsEntryPoint(e,r){return 0===e.length?[r]:r.compareTo(e[0])<0?[r].concat(e):e.concat([r])}}return n.VERBOSE=!1,n})();class Xlt extends r8{constructor(t,e,r,s,i,o){super(t),this.emptyCoords=e,this.darkCoords=r,this.lightCoords=s,this.deadDarkCoords=i,this.deadLightCoords=o}getCoords(){return this.color===$e.DARK?this.darkCoords:this.color===$e.LIGHT?this.lightCoords:this.color===$e.DEAD_DARK?this.deadDarkCoords:this.color===$e.DEAD_LIGHT?this.deadLightCoords:this.emptyCoords}contains(t){return this.darkCoords.concat(this.lightCoords.concat(this.emptyCoords.concat(this.deadDarkCoords.concat(this.deadLightCoords)))).some(r=>r.equals(t))}addPawn(t,e){switch(ye(!1===this.contains(t),"This group already contains "+t.toString()),e){case $e.DARK:this.darkCoords=r8.insertAsEntryPoint(this.darkCoords,t);break;case $e.LIGHT:this.lightCoords=r8.insertAsEntryPoint(this.lightCoords,t);break;case $e.DEAD_DARK:this.deadDarkCoords=r8.insertAsEntryPoint(this.deadDarkCoords,t);break;case $e.DEAD_LIGHT:this.deadLightCoords=r8.insertAsEntryPoint(this.deadLightCoords,t);break;default:we.expectToBeMultiple(e,[$e.EMPTY,$e.DARK_TERRITORY,$e.LIGHT_TERRITORY]),this.emptyCoords=r8.insertAsEntryPoint(this.emptyCoords,t)}}isMonoWrapped(){return(this.darkCoords.length+this.deadLightCoords.length===0?0:1)+(this.lightCoords.length+this.deadDarkCoords.length===0?0:1)==1}getWrapper(){const t=new zn;t.set($e.EMPTY,this.emptyCoords.length),t.set($e.DARK,this.darkCoords.length+this.deadLightCoords.length),t.set($e.LIGHT,this.lightCoords.length+this.deadDarkCoords.length),t.put(this.color.nonTerritory(),0);const e=t.filter((r,s)=>s>0);if(1===e.size())return e.getByIndex(0).key;throw new Error("Can't call getWrapper on non-mono-wrapped group")}getNeighborsEntryPoints(){const t=[];return this.color!==$e.EMPTY&&this.emptyCoords.length>0&&t.push(this.emptyCoords[0]),this.color!==$e.DARK&&this.darkCoords.length>0&&t.push(this.darkCoords[0]),this.color!==$e.LIGHT&&this.lightCoords.length>0&&t.push(this.lightCoords[0]),this.color!==$e.DEAD_DARK&&this.deadDarkCoords.length>0&&t.push(this.deadDarkCoords[0]),this.color!==$e.DEAD_LIGHT&&this.deadLightCoords.length>0&&t.push(this.deadLightCoords[0]),t}}class zm extends class Klt{getGroupDatas(t,e){K(r8.VERBOSE,"GroupDatas.getGroupDatas("+t+", "+e+")");const s=this.getNewInstance(e[t.y][t.x]);return this._getGroupDatas(t,e,s)}_getGroupDatas(t,e,r){K(r8.VERBOSE,{GroupDatas_getGroupDatas:{groupDatas:r,coord:t}});const s=e[t.y][t.x];if(r.addPawn(t,s),s===r.color)for(const i of this.getDirections()){const o=t.getNext(i);o.isInRange(e[0].length,e.length)&&(r.contains(o)||(r=this._getGroupDatas(o,e,r)))}return r}}{getNewInstance(t){return new Xlt(t,[],[],[],[],[])}getDirections(){return He.ORTHOGONALS}}let Vm=(()=>{class n{}return n.ILLEGAL_KO=()=>$localize`This move is a ko, you must play somewhere else before you can play in this intersection again.`,n.CANNOT_PASS_AFTER_PASSED_PHASE=()=>$localize`We are in the counting phase, you must mark stones as dead or alive or accept the current board by passing your turn.`,n.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE=()=>$localize`You cannot accept before the counting phase.`,n.OCCUPIED_INTERSECTION=()=>$localize`This intersection is already occupied.`,n.CANNOT_COMMIT_SUICIDE=()=>$localize`You cannot commit suicide.`,n})(),I3=(()=>{class n extends Z1{static isLegal(e,r){if(K(n.VERBOSE||!1,{isLegal:{move:e,state:r}}),n.isPass(e)){const i=r.phase===Vn.PLAYING,o=r.phase===Vn.PASSED;return K(n.VERBOSE||!1,"GoRules.isLegal at "+r.phase+(i||o?" forbid":" allowed")+" passing on "+r.getCopiedBoard()),i||o?$.success([]):$.failure(Vm.CANNOT_PASS_AFTER_PASSED_PHASE())}if(n.isAccept(e)){const o=r.phase===Vn.ACCEPT;return r.phase===Vn.COUNTING||o?$.success([]):$.failure(Vm.CANNOT_ACCEPT_BEFORE_COUNTING_PHASE())}return n.isOccupied(e.coord,r.getCopiedBoard())?(K(n.VERBOSE||!1,"GoRules.isLegal: move is marking"),n.isLegalDeadMarking(e,r)?$.success([]):$.failure(Vm.OCCUPIED_INTERSECTION())):(K(n.VERBOSE||!1,"GoRules.isLegal: move is normal stuff: "+e.toString()),n.isLegalNormalMove(e,r))}static getNewKo(e,r,s){if(1===s.length){const i=s[0],o=e.coord,c=r[o.y][o.x],h=(new zm).getGroupDatas(o,r),p=h.emptyCoords,m=$e.pieceBelongTo(c,z.ZERO)?h.darkCoords:h.lightCoords;if(1===p.length&&p[0].equals(i)&&1===m.length)return P.of(i)}return P.empty()}static markTerritoryAndCount(e){K(n.VERBOSE,{markTerritoryAndCount:{state:e}});const r=e.getCopiedBoard(),s=n.getTerritoryLikeGroup(e),i=e.getCapturedCopy();for(const o of s){const c=o.getWrapper();if(c===$e.LIGHT){i[1]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=$e.LIGHT_TERRITORY}else{ye(c===$e.DARK,"territory should be wrapped by dark or light, not by "+c.toString()),i[0]+=o.emptyCoords.length;for(const u of o.getCoords())r[u.y][u.x]=$e.DARK_TERRITORY}}return new Is(r,i,e.turn,e.koCoord,e.phase)}static removeAndSubstractTerritory(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy();let i;for(let o=0;o<e.board.length;o++)for(let c=0;c<e.board[0].length;c++)i=r[o][c],i===$e.DARK_TERRITORY?(r[o][c]=$e.EMPTY,s[0]=s[0]-1):i===$e.LIGHT_TERRITORY&&(r[o][c]=$e.EMPTY,s[1]=s[1]-1);return new Is(r,s,e.turn,e.koCoord,e.phase)}static getEmptyZones(e){return n.getGroupsDatasWhere(e.getCopiedBoard(),r=>r.isEmpty())}static getGroupsDatasWhere(e,r){const s=[];let i,o,c;const u=new zm;for(let h=0;h<e.length;h++)for(let p=0;p<e[0].length;p++)i=new M(p,h),c=e[h][p],r(c)&&(s.some(m=>m.selfContains(i))||(o=u.getGroupDatas(i,e),s.push(o)));return s}static addDeadToScore(e){const r=e.getCapturedCopy();let o,s=r[1],i=r[0];for(let c=0;c<e.board.length;c++)for(let u=0;u<e.board[0].length;u++)o=e.getPieceAtXY(u,c),o===$e.DEAD_DARK?s++:o===$e.DEAD_LIGHT&&i++;return[i,s]}static switchAliveness(e,r){const s=r.getCopiedBoard();ye(s[e.y][e.x].isOccupied(),"Can't switch emptyness aliveness");const c=(new zm).getGroupDatas(e,s),u=r.getCapturedCopy();switch(c.color){case $e.DEAD_DARK:u[1]-=2*c.deadDarkCoords.length;for(const h of c.deadDarkCoords)s[h.y][h.x]=$e.DARK;break;case $e.DEAD_LIGHT:u[0]-=2*c.deadLightCoords.length;for(const h of c.deadLightCoords)s[h.y][h.x]=$e.LIGHT;break;case $e.LIGHT:u[0]+=2*c.lightCoords.length;for(const h of c.lightCoords)s[h.y][h.x]=$e.DEAD_LIGHT;break;default:we.expectToBe(c.color,$e.DARK),u[1]+=2*c.darkCoords.length;for(const h of c.darkCoords)s[h.y][h.x]=$e.DEAD_DARK}return new Is(s,u,r.turn,r.koCoord,r.phase)}static getGameStatus(e){const r=e.gameState;return r.phase===Vn.FINISHED?r.captured[0]>r.captured[1]?xe.ZERO_WON:r.captured[1]>r.captured[0]?xe.ONE_WON:xe.DRAW:xe.ONGOING}static isPass(e){return e.equals(X1.PASS)}static isAccept(e){return e.equals(X1.ACCEPT)}static isLegalDeadMarking(e,r){return n.isOccupied(e.coord,r.getCopiedBoard())&&(r.phase===Vn.COUNTING||r.phase===Vn.ACCEPT)}static isLegalNormalMove(e,r){const s=r.getCopiedBoard();if(n.isKo(e,r))return $.failure(Vm.ILLEGAL_KO());[Vn.COUNTING,Vn.ACCEPT].includes(r.phase)&&(r=n.resurrectStones(r));const i=n.getCaptureState(e,r);if(t3e.isCapturing(i))return $.success(i.capturedCoords);{s[e.coord.y][e.coord.x]=r.turn%2==0?$e.DARK:$e.LIGHT;const u=0===(new zm).getGroupDatas(e.coord,s).emptyCoords.length;return s[e.coord.y][e.coord.x]=$e.EMPTY,u?$.failure(Vm.CANNOT_COMMIT_SUICIDE()):$.success([])}}static isOccupied(e,r){return r[e.y][e.x].isOccupied()}static isKo(e,r){return!!r.koCoord.isPresent()&&e.coord.equals(r.koCoord.get())}static getCaptureState(e,r){K(n.VERBOSE||!1,{getCaptureState:{move:e,state:r}});const i=new t3e;let o;for(const c of He.ORTHOGONALS)o=n.getCapturedInDirection(e.coord,c,r),o.length>0&&i.capturedCoords.every(u=>!o[0].equals(u))&&(i.capturedCoords=i.capturedCoords.concat(o));return i}static getCapturedInDirection(e,r,s){const o=s.getCopiedBoard(),c=e.getNext(r);if(c.isInRange(s.board[0].length,s.board.length)&&o[c.y][c.x]===(s.turn%2==0?$e.LIGHT:$e.DARK)){K(n.VERBOSE||!1,"a group could be captured");const p=(new zm).getGroupDatas(c,o);if(n.isCapturableGroup(p,s.koCoord))return K(n.VERBOSE||!1,{neightbooringGroupCoord:p.getCoords(),message:"is capturable"}),p.getCoords()}return[]}static isCapturableGroup(e,r){return!(!e.color.isOccupied()||1!==e.emptyCoords.length)&&!1===r.equalsValue(e.emptyCoords[0])}static getTerritoryLikeGroup(e){return n.getEmptyZones(e).filter(s=>s.isMonoWrapped())}static applyPass(e){const r=e.getCopiedBoard(),s=e.getCapturedCopy(),i=e.turn;let o,c;return e.phase===Vn.PASSED?(o=Vn.COUNTING,c=new Is(r,s,i+1,P.empty(),o),c=n.markTerritoryAndCount(c)):(ye(e.phase===Vn.PLAYING,"Cannot pass in counting phase!"),o=Vn.PASSED,c=new Is(r,s,i+1,P.empty(),o)),c}static applyLegalAccept(e){const r=e.getCopiedBoard();let s;return s=e.phase===Vn.COUNTING?Vn.ACCEPT:Vn.FINISHED,new Is(r,e.getCapturedCopy(),e.turn+1,P.empty(),s)}static applyNormalLegalMove(e,r,s){let i;K(n.VERBOSE,{applyNormalLegal:{currentState:r,legalMove:e,status}}),i=[Vn.COUNTING,Vn.ACCEPT].includes(r.phase)?n.resurrectStones(r):r.copy();const o=e.coord.x,c=e.coord.y,u=i.getCopiedBoard(),h=i.turn,p=$e.ofPlayer(i.getCurrentPlayer()),m=h+1;u[c][o]=p;for(const I of s)u[I.y][I.x]=$e.EMPTY;const C=n.getNewKo(e,u,s),w=i.getCapturedCopy();return w[p.player.value]+=s.length,new Is(u,w,m,C,Vn.PLAYING)}static resurrectStones(e){for(let r=0;r<e.board.length;r++)for(let s=0;s<e.board[0].length;s++)e.getPieceAtXY(s,r).isDead()&&(e=n.switchAliveness(new M(s,r),e));return n.removeAndSubstractTerritory(e)}static applyDeadMarkingMove(e,r){K(n.VERBOSE,{applyDeadMarkingMove:{legalMove:e,state:r}});const s=n.removeAndSubstractTerritory(r),i=n.switchAliveness(e.coord,s),o=new Is(i.getCopiedBoard(),i.getCapturedCopy(),i.turn+1,P.empty(),Vn.COUNTING);return n.markTerritoryAndCount(o)}isLegal(e,r){return n.isLegal(e,r)}applyLegalMove(e,r,s){return K(n.VERBOSE,{applyLegalMove:{legalMove:e,state:r,status:s}}),n.isPass(e)?(K(n.VERBOSE,"GoRules.applyLegalMove: isPass"),n.applyPass(r)):n.isAccept(e)?(K(n.VERBOSE,"GoRules.applyLegalMove: isAccept"),n.applyLegalAccept(r)):n.isLegalDeadMarking(e,r)?(K(n.VERBOSE,"GoRules.applyLegalMove: isDeadMarking"),n.applyDeadMarkingMove(e,r)):(K(n.VERBOSE,"GoRules.applyLegalMove: else it is normal move"),n.applyNormalLegalMove(e,r,s))}getGameStatus(e){return n.getGameStatus(e)}}return n.VERBOSE=!1,n})();class t3e{constructor(){this.capturedCoords=[]}static isCapturing(t){return t.capturedCoords.length>0}}class Qlt extends $1{getListMoves(t){K(I3.VERBOSE||!1,"GoRules.getListMoves");const r=t.gameState,s=this.getPlayingMovesList(r);if(r.phase===Vn.PLAYING||r.phase===Vn.PASSED)return s.push(X1.PASS),s;{K(I3.VERBOSE||!1,"GoRules.getListMoves in counting phase");const i=this.getCountingMovesList(r);return 0===i.length?[X1.ACCEPT]:i}}getPlayingMovesList(t){const e=[];let r;for(let s=0;s<t.board.length;s++)for(let i=0;i<t.board[0].length;i++)r=new X1(i,s),t.getPieceAt(r.coord)===$e.EMPTY&&I3.isLegal(r,t).isSuccess()&&e.push(r);return e}getCountingMovesList(t){const e=[],r=this.getCorrectBoard(t).getCopiedBoard(),s=I3.getGroupsDatasWhere(r,i=>i!==$e.EMPTY);for(const i of s){const o=i.getCoords()[0],c=r[o.y][o.x];if(t.getPieceAt(o)!==c){const h=new X1(o.x,o.y);return e.push(h),e}}return e}getCorrectBoard(t){const r=this.mapBoard(t.getCopiedBoard(),o=>o===$e.DARK?$e.DEAD_DARK:o===$e.LIGHT?$e.DEAD_LIGHT:o.isTerritory()?$e.EMPTY:o),s=new Is(r,t.getCapturedCopy(),t.turn,t.koCoord,t.phase),i=I3.getTerritoryLikeGroup(s);return this.setAliveUniqueWrapper(s,i)}mapBoard(t,e){const r=[];for(let s=0;s<t.length;s++){r[s]=[];for(let i=0;i<t[0].length;i++)r[s][i]=e(t[s][i])}return r}setAliveUniqueWrapper(t,e){let s,r=t.copy();for(const i of e){s=i.deadDarkCoords.concat(i.deadLightCoords);for(const o of s)r.isDead(o)&&(r=I3.switchAliveness(o,r))}return r}getBoardValue(t){const e=t.gameState,r=I3.getGameStatus(t);if(r.isEndGame)return r.toBoardValue();K(I3.VERBOSE||!1,"GoRules.getBoardValue");const i=I3.markTerritoryAndCount(e),o=i.getCapturedCopy(),c=this.getDeadStones(i);return new Ct(o[1]+2*c[0]-(o[0]+2*c[1]))}getDeadStones(t){const e=[0,0];for(let r=0;r<t.board.length;r++)for(let s=0;s<t.board[0].length;s++){const i=t.getPieceAtXY(s,r);"dead"===i.type&&(e[i.player.value]=e[i.player.value]+1)}return e}}function Jlt(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v(2).index,r=v().index;D("cx",25+50*e)("cy",25+50*r)("r",22)}}function e6t(n,t){if(1&n){const e=Oe();B(),b(0,"line",11),J("click",function(){fe(e);const s=v(2).index,i=v().index;return ae(v().onClick(s,i))}),O()}if(2&n){const e=v(2).index,r=v().index;D("x1",50*e)("y1",50*r)("x2",50+50*e)("y2",50+50*r)}}function t6t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"circle",7),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onClick(s,i))}),O(),x(2,Jlt,1,3,"circle",8),x(3,e6t,1,4,"line",9),O()}if(2&n){const e=v().index,r=v().index,s=v();S(1),T("ngClass",s.getSpaceClass(e,r)),D("cx",25+50*e)("cy",25+50*r)("r",22),S(1),T("ngIf",s.isLastSpace(e,r)),S(1),T("ngIf",s.isDead(e,r))}}function n6t(n,t){if(1&n){const e=Oe();B(),b(0,"circle",15),J("click",function(){fe(e);const s=v(2).index,i=v().index;return ae(v().onClick(s,i))}),O()}if(2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();D("cx",25+50*r)("cy",25+50*i)("r",10)("class",s===o.GoPiece.LIGHT_TERRITORY?"player1-fill":"player0-fill")}}function r6t(n,t){if(1&n){const e=Oe();B(),b(0,"rect",12),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onClick(s,i))}),O(),b(1,"line",13),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onClick(s,i))}),O(),b(2,"line",13),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().onClick(s,i))}),O(),x(3,n6t,1,4,"circle",14)}if(2&n){const e=v().index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("x",50*e)("y",50*r),S(1),D("x1",50*e)("y1",25+50*r)("x2",50+50*e)("y2",25+50*r),S(1),D("x1",25+50*e)("y1",50*r)("x2",25+50*e)("y2",50+50*r),S(1),T("ngIf",s.isTerritory(e,r))}}function s6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,t6t,4,6,"g",5),x(2,r6t,4,13,"ng-template",null,6,c1),O()),2&n){const e=t.index,r=t1(3),s=v().index,i=v();S(1),T("ngIf",i.spaceIsFull(e,s))("ngIfElse",r)}}function i6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,s6t,4,2,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function o6t(n,t){if(1&n&&(B(),X(0,"rect",16)),2&n){const e=v();D("x",12.5+50*e.ko.get().x)("y",12.5+50*e.ko.get().y)}}function a6t(n,t){if(1&n){const e=Oe();B(),b(0,"circle",17),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i.x,i.y))}),O()}if(2&n){const e=t.$implicit;D("cx",25+50*e.x)("cy",25+50*e.y)("r",7)}}let c6t=(()=>{class n extends No{constructor(e){super(e),this.ko=P.empty(),this.last=P.empty(),this.captures=[],this.GoPiece=$e,this.scores=P.of([0,0]),this.rules=new I3(Is),this.availableMinimaxes=[new Qlt(this.rules,"GoMinimax")],this.encoder=X1.encoder,this.tutorial=(new Jce).tutorial,this.canPass=!0,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());s.last=P.empty();const o=new X1(e,r);return s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){K(n.VERBOSE,"updateBoard");const e=this.getState(),r=this.rules.node.move,s=e.phase;this.board=e.getCopiedBoard(),this.scores=P.of(e.getCapturedCopy()),this.ko=e.koCoord,r.isPresent()?this.showCaptures():this.captures=[],this.last=r.map(i=>i.coord),this.canPass=s!==Vn.FINISHED}showCaptures(){const e=this.rules.node.mother.get().gameState;this.captures=[];for(let r=0;r<this.board.length;r++)for(let s=0;s<this.board[0].length;s++){const i=new M(s,r),o=e.getPieceAt(i).isOccupied(),c=this.board[r][s]===$e.EMPTY,u=!1===this.ko.equalsValue(i);o&&c&&u&&this.captures.push(i)}}pass(){var e=this;return A(function*(){const r=e.getState().phase;return r===Vn.PLAYING||r===Vn.PASSED?e.onClick(X1.PASS.coord.x,X1.PASS.coord.y):(ye(r===Vn.COUNTING||r===Vn.ACCEPT,"GoComponent: pass() must be called only in playing, passed, counting, or accept phases"),e.onClick(X1.ACCEPT.coord.x,X1.ACCEPT.coord.y))})()}getSpaceClass(e,r){const s=this.getState().getPieceAtXY(e,r);return this.getPlayerClass(s.getOwner())}spaceIsFull(e,r){return this.getState().getPieceAtXY(e,r)!==$e.EMPTY&&!this.isTerritory(e,r)}isLastSpace(e,r){if(this.last.isPresent()){const s=this.last.get();return e===s.x&&r===s.y}return!1}isDead(e,r){return this.getState().isDead(new M(e,r))}isTerritory(e,r){return this.getState().isTerritory(new M(e,r))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-go"]],features:[l],decls:5,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["x","0","y","0",1,"base","mid-small-stroke"],[4,"ngFor","ngForOf"],["width","25","height","25","class","captured-stroke mid-stroke no-fill",4,"ngIf"],["class","captured-fill",3,"click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["empty",""],[1,"base","mid-stroke",3,"ngClass","click"],["class","base no-fill mid-stroke last-move-stroke",4,"ngIf"],["class","base no-fill captured-stroke",3,"click",4,"ngIf"],[1,"base","no-fill","mid-stroke","last-move-stroke"],[1,"base","no-fill","captured-stroke",3,"click"],["width","50","height","50","fill-opacity","0",1,"base","no-stroke",3,"id","click"],[1,"base","mid-stroke",3,"click"],[3,"click",4,"ngIf"],[3,"click"],["width","25","height","25",1,"captured-stroke","mid-stroke","no-fill"],[1,"captured-fill",3,"click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),X(1,"rect",1),x(2,i6t,2,1,"g",2),x(3,o6t,1,2,"rect",3),x(4,a6t,1,3,"circle",4),O()),2&e&&(D("viewBox","0 -3 "+50*r.board.length+" "+(6+50*r.board.length)),S(1),D("width",50*r.board.length)("height",50*r.board.length),S(1),T("ngForOf",r.board),S(1),T("ngIf",r.ko.isPresent()),S(1),T("ngForOf",r.captures))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class i6{constructor(t,e,r,s){this.left=t,this.up=e,this.width=r,this.height=s}static fromLimits(t,e,r,s){return new i6(t,r,e-t,s-r)}static fromHexa(t,e,r){const s=t.flatMap(p=>e.getHexaPointsListAt(p)),i=i6.getLimits(s);return new i6(i.minX-r/2,i.minY-r/2,r+i.maxX-i.minX,r+i.maxY-i.minY)}static getLimits(t){let e=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;for(const o of t)s=Math.min(s,o.x),i=Math.min(i,o.y),e=Math.max(e,o.x),r=Math.max(r,o.y);return{minX:s,minY:i,maxX:e,maxY:r}}center(){return new M(this.left+this.width/2,this.up+this.height/2)}bottom(){return this.up+this.height}right(){return this.left+this.width}expand(t,e,r,s){return new i6(this.left-t,this.up-r,this.width+t+e,this.height+r+s)}containingAtLeast(t){const e=Math.min(this.left,t.left),r=Math.max(this.right(),t.right()),s=Math.min(this.up,t.up),i=Math.max(this.bottom(),t.bottom());return i6.fromLimits(e,r,s,i)}toSVGString(){return`${this.left} ${this.up} ${this.width} ${this.height}`}}let es=(()=>{class n{}return n.CANNOT_DROP_PIECE_YOU_DONT_HAVE=()=>"You cannot drop a piece that you do not have in your reserve.",n.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The queen bee can only move to one of its direct neighbors.`,n.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS=()=>$localize`The beetle can only move to one of its direct neighbors.`,n.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE=()=>$localize`The grasshopper must move in a straight line.`,n.GRASSHOPPER_MUST_JUMP_OVER_PIECES=()=>$localize`The grasshopper must jump over other pieces, without any empty spaces.`,n.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES=()=>$localize`The spider must move on neighboring spaces.`,n.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT=()=>$localize`The spider can only move around pieces that are in direct contact with it.`,n.SPIDER_CANNOT_BACKTRACK=()=>$localize`The spider cannot go twice through the same space in the same move.`,n.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE=()=>$localize`The queen bee must be placed on the board before moving a piece.`,n.THIS_PIECE_CANNOT_CLIMB=()=>$localize`Only the beetle is allowed to climb over other pieces.`,n.CANNOT_DISCONNECT_HIVE=()=>$localize`You are not allowed to split the hive.`,n.MUST_BE_ABLE_TO_SLIDE=()=>$localize`This piece must be able to slide to its destination.`,n.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN=()=>$localize`You must place your queen bee at this turn!`,n.CANNOT_DROP_NEXT_TO_OPPONENT=()=>$localize`You cannot drop a piece next to one of your opponent's stack.`,n.MUST_DROP_ON_EMPTY_SPACE=()=>$localize`You must always drop your piece on an empty space.`,n.MUST_BE_CONNECTED_TO_HIVE=()=>$localize`The piece you are dropping must be connected to the hive.`,n})();class Xs{constructor(t,e){this.owner=t,this.kind=e}toString(){return`${this.kind}_${this.owner.toString()}`}equals(t){return this.owner===t.owner&&this.kind===t.kind}}Xs.encoder=new class extends w4{encode(n){return{owner:n.owner.value,kind:n.kind}}decode(n){ye(null!==we.getNonNullable(n).kind,"invalid encoded HivePiece"),ye(null!==we.getNonNullable(n).owner,"invalid encoded HivePiece");const t=we.getNonNullable(n).kind,e=z.of(we.getNonNullable(n).owner);return new Xs(e,t)}};class k4{constructor(t){this.pieces=t}equals(t){return this.size()===t.size()&&Ke.compareArray(this.pieces,t.pieces)}isEmpty(){return 0===this.pieces.length}hasPieces(){return!1===this.isEmpty()}add(t){return new k4([t,...this.pieces])}topPiece(){return we.assert(this.hasPieces(),"HivePieceStack: cannot get top piece of an empty stack"),this.pieces[0]}removeTopPiece(){const t=[...this.pieces];return t.shift(),new k4(t)}size(){return this.pieces.length}}k4.EMPTY=new k4([]);class Ya extends S3{constructor(t,e,r){super(e,r),this.piece=t}static from(t,e){return new Ya(t,e.x,e.y)}toString(){return`HiveDrop(${this.piece.toString()}, ${this.coord.toString()})`}equals(t){return t instanceof Ya&&this.piece.equals(t.piece)&&this.coord.equals(t.coord)}}Ya.encoder=M2.tuple([Xs.encoder,M.encoder],n=>[n.piece,n.coord],n=>new Ya(n[0],n[1].x,n[1].y));class N2 extends X0{constructor(t,e){super(t,e)}static from(t,e){return t.equals(e)?$.failure(rt.MOVE_CANNOT_BE_STATIC()):$.success(new N2(t,e))}toString(){return`HiveMoveCoordToCoord(${this.getStart().toString()} -> ${this.getEnd().toString()})`}equals(t){return!(t instanceof Lc)&&t instanceof N2&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}N2.encoder=I4.getEncoder(N2.from);class Lc extends N2{constructor(t){super(t[0],t[3]),this.coords=t}static fromCoords(t){return new Lc(t)}toString(){return`HiveMoveSpider(${this.coords.map(e=>e.toString()).join(", ")})`}equals(t){return t instanceof Lc&&this.getStart().equals(t.getStart())&&this.getEnd().equals(t.getEnd())}}Lc.encoder=M2.tuple([M.encoder,M.encoder,M.encoder,M.encoder],n=>n.coords,n=>new Lc(n));class SH extends $i{toString(){return"HiveMovePass"}equals(t){return t instanceof SH}}var Ei;!function(n){n.PASS=new SH,n.drop=function t(s,i){return Ya.from(s,i)},n.move=function e(s,i){return N2.from(s,i)},n.spiderMove=function r(s){return Lc.fromCoords(s)},n.encoder=new class extends M2{encodeMove(s){return s instanceof Ya?{moveType:"Drop",encoded:Ya.encoder.encode(s)}:s instanceof Lc?{moveType:"Spider",encoded:Lc.encoder.encode(s)}:s instanceof N2?{moveType:"CoordToCoord",encoded:N2.encoder.encode(s)}:{moveType:"Pass"}}decodeMove(s){const i=we.getNonNullable(s).moveType,o=we.getNonNullable(s).encoded;return"Drop"===i?Ya.encoder.decode(o):"Spider"===i?Lc.encoder.decode(o):"CoordToCoord"===i?N2.encoder.decode(o):n.PASS}}}(Ei||(Ei={}));class Rc{static from(t){return Rc.INSTANCES.isAbsent()&&(Rc.INSTANCES=P.of({QueenBee:_P.get(),Beetle:vP.get(),Grasshopper:CP.get(),Spider:Hm.get(),SoldierAnt:yP.get()})),Rc.INSTANCES.get()[t.kind]}checkEmptyDestination(t,e){return e.getAt(t.getEnd()).hasPieces()?$.failure(es.THIS_PIECE_CANNOT_CLIMB()):$.success(void 0)}canSlideBetweenNeighbors(t,e,r){const s=new Ht(O2.getNeighbors(e)),i=new Ht(O2.getNeighbors(r)),o=s.intersection(i);for(const c of o)if(t.getAt(c).isEmpty())return!0;return!1}}Rc.INSTANCES=P.empty();class _P extends Rc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new _P)),this.INSTANCE.get()}moveValidity(t,e){return!1===O2.areNeighbors(t.getStart(),t.getEnd())?$.failure(es.QUEEN_BEE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):!1===this.canSlideBetweenNeighbors(e,t.getStart(),t.getEnd())?$.failure(es.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of O2.getNeighbors(t))e.getAt(s).isEmpty()&&r.push(N2.from(t,s).get());return r}}_P.INSTANCE=P.empty();class vP extends Rc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new vP)),this.INSTANCE.get()}moveValidity(t,e){return!1===O2.areNeighbors(t.getStart(),t.getEnd())?$.failure(es.BEETLE_CAN_ONLY_MOVE_TO_DIRECT_NEIGHBORS()):$.success(void 0)}getPotentialMoves(t,e){const r=[];for(const s of O2.getNeighbors(t))r.push(N2.from(t,s).get());return r}}vP.INSTANCE=P.empty();class CP extends Rc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new CP)),this.INSTANCE.get()}moveValidity(t,e){if(ke.factory.fromMove(t.getStart(),t.getEnd()).isFailure())return $.failure(es.GRASSHOPPER_MUST_MOVE_IN_STRAIGHT_LINE());const s=t.getStart().getCoordsToward(t.getEnd());if(0===s.length)return $.failure(es.GRASSHOPPER_MUST_JUMP_OVER_PIECES());for(const i of s)if(e.getAt(i).isEmpty())return $.failure(es.GRASSHOPPER_MUST_JUMP_OVER_PIECES());return this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=[];for(const s of ke.factory.all){const i=t.getNext(s);if(e.getAt(i).hasPieces()){let o=i;for(;e.getAt(o).hasPieces();)o=o.getNext(s);r.push(N2.from(t,o).get())}}return r}}CP.INSTANCE=P.empty();class Hm extends Rc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new Hm)),this.INSTANCE.get()}prefixLegality(t,e){const r=new Ht,s=e.update().setAt(t[0],k4.EMPTY).increaseTurnAndFinalizeUpdate();t=t.map(i=>i.getNext(s.offset));for(let i=1;i<t.length;i++){if(s.getAt(t[i]).hasPieces())return $.failure(es.THIS_PIECE_CANNOT_CLIMB());if(!1===O2.areNeighbors(t[i-1],t[i]))return $.failure(es.SPIDER_MUST_MOVE_ON_NEIGHBORING_SPACES());if(!1===s.haveCommonNeighbor(t[i],t[i-1]))return $.failure(es.SPIDER_CAN_ONLY_MOVE_WITH_DIRECT_CONTACT());if(!1===this.canSlideBetweenNeighbors(s,t[i-1],t[i]))return $.failure(es.MUST_BE_ABLE_TO_SLIDE());if(r.contains(t[i]))return $.failure(es.SPIDER_CANNOT_BACKTRACK());r.add(t[i])}return $.success(void 0)}moveValidity(t,e){we.assert(t instanceof Lc,"HiveSpiderRules: move should be a spider move");const s=this.prefixLegality(t.coords,e);return s.isFailure()?s:this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=e.update().setAt(t,k4.EMPTY).increaseTurnAndFinalizeUpdate();let s=[[t=t.getNext(r.offset)]];for(let c=0;c<3;c++)s=s.flatMap(u=>this.nextMoveStep(r,u));return new Ht(s.map(function i(c){return c=c.map(u=>u.getPrevious(r.offset)),Lc.fromCoords(c)})).toList()}nextMoveStep(t,e){const r=e[e.length-1];return new Ht(O2.getNeighbors(r)).filter(function s(o){return!t.getAt(o).hasPieces()&&void 0===e.find(c=>o.equals(c))&&t.haveCommonNeighbor(o,r)}).toList().map(o=>[...e,o])}}Hm.INSTANCE=P.empty();class yP extends Rc{static get(){return this.INSTANCE.isAbsent()&&(this.INSTANCE=P.of(new yP)),this.INSTANCE.get()}pathExists(t,e,r){const s=new Ht,i=[e];for(;i.length>0;){const o=i.pop();if(!s.contains(o)){if(s.add(o),o.equals(r))return!0;for(const c of O2.getNeighbors(o)){const u=t.getAt(c).isEmpty(),h=t.getOccupiedNeighbors(c).size()>0,p=this.canSlideBetweenNeighbors(t,o,c);u&&h&&p&&i.push(c)}}}return!1}moveValidity(t,e){return!1===this.pathExists(e,t.getStart(),t.getEnd())?$.failure(es.MUST_BE_ABLE_TO_SLIDE()):this.checkEmptyDestination(t,e)}getPotentialMoves(t,e){const r=new Ht;for(const s of e.occupiedSpaces())if(!s.equals(t))for(const i of e.emptyNeighbors(s))r.add(N2.from(t,i).get());return r.toList()}}yP.INSTANCE=P.empty();class n3e extends oP{constructor(t,e,r){super(e),this.pieces=t;const s=this.computeScale();this.pieces=s.pieces,this.width=s.width,this.height=s.height,this.offset=r??s.offset,this.pieces.makeImmutable()}getPieces(){return this.pieces}getPieceCoords(){return this.pieces.listKeys()}computeScale(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;for(const c of this.pieces.listKeys())t=Math.min(c.x,t),e=Math.max(c.x,e),r=Math.min(c.y,r),s=Math.max(c.y,s);let i=new o9;const o=new Ut(-t,-r);if(0===t&&0===r)i=this.pieces;else for(const c of this.pieces.listKeys()){const u=this.pieces.delete(c),h=c.getNext(o);i.set(h,u)}return{width:e+1-t,height:s+1-r,pieces:i,offset:o}}isOnBoard(t){return this.pieces.containsKey(t)}getOccupiedNeighbors(t){return new Ht(O2.getNeighbors(t)).filter(r=>this.pieces.get(r).isPresent())}getGroups(){const t=new Ht,e=new Ht;return this.pieces.forEach(r=>{if(!1===t.contains(r.key)){const s=new Ht,i=new Ht([r.key]);for(;i.hasElements();){const o=i.getAnyElement().get();i.remove(o),t.add(o),s.add(o),i.addAll(this.getOccupiedNeighbors(o).filter(c=>!1===t.contains(c)))}e.add(s)}}),e}}class EP{constructor(t){this.pieces=t}static getInitial(){const t=new zn;for(const e of z.PLAYERS)t.set(new Xs(e,"QueenBee"),1),t.set(new Xs(e,"Beetle"),2),t.set(new Xs(e,"Spider"),2),t.set(new Xs(e,"Grasshopper"),3),t.set(new Xs(e,"SoldierAnt"),3);return t.makeImmutable(),new EP(t)}equals(t){return this.pieces.equals(t.pieces)}getQuantity(t){return this.pieces.get(t).get()}hasRemaining(t){return this.getQuantity(t)>0}getAny(t){for(const e of this.pieces.listKeys())if(e.owner===t&&this.hasRemaining(e))return P.of(e);return P.empty()}remove(t){const e=this.pieces.get(t).get();we.assert(e>0,"HiveRemainingPieces cannot remove a non-remainingPiece");const r=this.pieces.getCopy();return r.replace(t,e-1),new EP(r)}toListOfStacks(){const t=[];return this.pieces.forEach(e=>{const r=[];for(let s=0;s<e.value;s++)r.push(e.key);t.push(new k4(r))}),t}getPlayerPieces(t){const e=[];return this.pieces.forEach(r=>{r.key.owner===t&&r.value>0&&e.push(r.key)}),e}}class Fm{constructor(t,e,r,s){this.pieces=t,this.remainingPieces=e,this.queenBees=r,this.turn=s}static of(t){return new Fm(t.pieces,t.remainingPieces,t.queenBees,t.turn)}setAt(t,e){const r=this.queenBees.getCopy();for(const i of z.PLAYERS)r.get(i).equalsValue(t)&&r.delete(i);for(const i of e.pieces)"QueenBee"===i.kind&&r.put(i.owner,t);const s=this.pieces.getCopy();return e.isEmpty()?s.delete(t):s.put(t,e),new Fm(s,this.remainingPieces,r,this.turn)}removeRemainingPiece(t){return new Fm(this.pieces,this.remainingPieces.remove(t),this.queenBees,this.turn)}increaseTurnAndFinalizeUpdate(){return new A2(this.pieces,this.remainingPieces,this.queenBees,this.turn+1)}}class A2 extends n3e{constructor(t,e,r,s,i){super(t,s,i),this.remainingPieces=e,this.queenBees=r,this.queenBees=r.getCopy();for(const o of r.listKeys()){const u=r.get(o).get().getNext(this.offset);this.queenBees.replace(o,u)}this.queenBees.makeImmutable()}static getInitialState(){return A2.fromRepresentation([],0)}static fromRepresentation(t,e){const r=new o9;let s=EP.getInitial();const i=new zn;for(let o=0;o<t.length;o++)for(let c=0;c<t[0].length;c++)if(t[o][c].length>0){r.set(new M(c,o),new k4(t[o][c]));const u=P.ofNullable(t[o][c].find(h=>"QueenBee"===h.kind));u.isPresent()&&i.set(u.get().owner,new M(c,o));for(const h of t[o][c])s=s.remove(h)}return new A2(r,s,i,e)}update(){return Fm.of(this)}equals(t){return this.pieces.equals(t.pieces)&&this.remainingPieces.equals(t.remainingPieces)&&this.queenBees.equals(t.queenBees)&&this.turn===t.turn}getAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():k4.EMPTY}queenBeeLocation(t){return this.queenBees.get(t)}hasQueenBeeOnBoard(t){return this.queenBeeLocation(t).isPresent()}numberOfNeighbors(t){let e=0;for(const r of ke.factory.all){const s=t.getNext(r);this.getAt(s).hasPieces()&&(e+=1)}return e}isDisconnected(){return this.getGroups().size()>1}occupiedSpaces(){return this.pieces.listKeys()}emptyNeighbors(t){const e=[];for(const r of O2.getNeighbors(t))this.getAt(r).isEmpty()&&e.push(r);return e}haveCommonNeighbor(t,e){const r=this.getOccupiedNeighbors(t),s=this.getOccupiedNeighbors(e);return r.findAnyCommonElement(s).isPresent()}}class Mi extends Z1{constructor(){super(A2)}static get(){return Mi.singleton.isAbsent()&&(Mi.singleton=P.of(new Mi)),Mi.singleton.get()}applyLegalMove(t,e,r){return t instanceof Ya?this.applyLegalDrop(t,e):t instanceof N2?this.applyLegalMoveCoordToCoord(t,e):e.update().increaseTurnAndFinalizeUpdate()}applyLegalDrop(t,e){const r=e.getAt(t.coord);return e.update().setAt(t.coord,r.add(t.piece)).removeRemainingPiece(t.piece).increaseTurnAndFinalizeUpdate()}applyLegalMoveCoordToCoord(t,e){const r=e.getAt(t.getStart()),s=e.getAt(t.getEnd());return e.update().setAt(t.getStart(),r.removeTopPiece()).setAt(t.getEnd(),s.add(r.topPiece())).increaseTurnAndFinalizeUpdate()}isLegal(t,e){return t instanceof Ya?this.isLegalDrop(t,e):t instanceof N2?this.isLegalMoveCoordToCoord(t,e):this.shouldPass(e)?$.success(void 0):$.failure(rt.CANNOT_PASS())}isLegalMoveCoordToCoord(t,e){if(!1===e.queenBeeLocation(e.getCurrentPlayer()).isPresent())return $.failure(es.QUEEN_BEE_MUST_BE_ON_BOARD_BEFORE_MOVE());const r=e.getAt(t.getStart());if(r.isEmpty())return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE());const s=r.topPiece();if(s.owner===e.getCurrentOpponent())return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE());const i=Rc.from(s).moveValidity(t,e);if(i.isFailure())return i;const o=e.update().setAt(t.getStart(),r.removeTopPiece()).increaseTurnAndFinalizeUpdate();if(o.isDisconnected())return $.failure(es.CANNOT_DISCONNECT_HIVE());const c=t.getEnd().getNext(o.offset);return 0===o.numberOfNeighbors(c)?$.failure(es.CANNOT_DISCONNECT_HIVE()):$.success(void 0)}mustPlaceQueenBee(t){return t.turn>=6&&!1===t.hasQueenBeeOnBoard(t.getCurrentPlayer())}isLegalDrop(t,e){const r=e.getCurrentPlayer();if(t.piece.owner===r.getOpponent())return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE());if(!1===e.remainingPieces.hasRemaining(t.piece))return $.failure(es.CANNOT_DROP_PIECE_YOU_DONT_HAVE());if("QueenBee"!==t.piece.kind&&this.mustPlaceQueenBee(e))return $.failure(es.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());const s=this.checkNeighborValidity(t,e);return s.isFailure()?s:e.getAt(t.coord).hasPieces()?$.failure(es.MUST_DROP_ON_EMPTY_SPACE()):$.success(void 0)}checkNeighborValidity(t,e){const r=e.getCurrentPlayer();let s=!1;for(const i of O2.getNeighbors(t.coord)){const o=e.getAt(i);if(o.hasPieces()&&(s=!0,1!==e.turn&&o.topPiece().owner===r.getOpponent()))return $.failure(es.CANNOT_DROP_NEXT_TO_OPPONENT())}return 0!==e.turn&&!1===s?$.failure(es.MUST_BE_CONNECTED_TO_HIVE()):$.success(void 0)}getPossibleDropLocations(t){const e=t.getCurrentPlayer();if(0===t.turn)return new Ht([new M(0,0)]);if(1===t.turn)return new Ht(O2.getNeighbors(new M(0,0)));const r=t.remainingPieces.getAny(e);if(r.isAbsent())return new Ht;const s=r.get(),i=new Ht;for(const o of t.occupiedSpaces())if(t.getAt(o).topPiece().owner===e)for(const c of t.emptyNeighbors(o)){const u=Ya.from(s,c);this.isLegalDrop(u,t).isSuccess()&&i.add(c)}return i}getPossibleMovesFrom(t,e){const r=t.getCurrentPlayer(),s=new Ht,i=t.getAt(e).topPiece();if(i.owner===r)for(const o of Rc.from(i).getPotentialMoves(e,t))this.isLegalMoveCoordToCoord(o,t).isSuccess()&&s.add(o);return s}getPossibleMovesOnBoard(t){const e=new Ht;for(const r of t.occupiedSpaces())e.addAll(this.getPossibleMovesFrom(t,r));return e}shouldPass(t){return 0===this.getPossibleDropLocations(t).size()&&0===this.getPossibleMovesOnBoard(t).size()}getGameStatus(t){const e=t.gameState,r=[0,0];for(const s of z.PLAYERS){const i=e.queenBeeLocation(s);i.isPresent()&&(r[s.value]=e.numberOfNeighbors(i.get()))}return 6===r[0]&&6===r[1]?xe.DRAW:6===r[0]?xe.getVictory(z.ONE):6===r[1]?xe.getVictory(z.ZERO):xe.ONGOING}}Mi.singleton=P.empty();class u6t extends $1{getListMoves(t){const e=this.getListDrops(t.gameState),r=this.getListOfOnBoardMoves(t.gameState),s=e.concat(r);return 0===s.length?[Ei.PASS]:s}getListOfOnBoardMoves(t){return Mi.get().getPossibleMovesOnBoard(t).toList()}getListDrops(t){const e=[],r=t.getCurrentPlayer(),s=new Xs(r,"QueenBee");for(const i of Mi.get().getPossibleDropLocations(t))if(Mi.get().mustPlaceQueenBee(t))e.push(Ei.drop(s,i));else for(const o of t.remainingPieces.getPlayerPieces(t.getCurrentPlayer()))e.push(Ei.drop(o,i));return e}getBoardValue(t){const e=Mi.get().getGameStatus(t);if(e!==xe.ONGOING)return e.toBoardValue();const r=this.queenBeeMobility(t.gameState,z.ZERO),s=this.queenBeeMobility(t.gameState,z.ONE);return Ct.from(r,s)}queenBeeMobility(t,e){const r=t.queenBeeLocation(e);return r.isPresent()?Mi.get().getPossibleMovesFrom(t,r.get()).size():0}}const L4=new Xs(z.ZERO,"QueenBee"),v5=new Xs(z.ZERO,"Beetle"),S9=new Xs(z.ZERO,"Grasshopper"),MP=new Xs(z.ZERO,"Spider"),SP=new Xs(z.ZERO,"SoldierAnt"),C5=new Xs(z.ONE,"QueenBee"),Ka=new Xs(z.ONE,"Beetle"),PH=new Xs(z.ONE,"Grasshopper"),TH=new Xs(z.ONE,"Spider"),Bm=new Xs(z.ONE,"SoldierAnt");class r3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Hive`,$localize`Hive is a game without a board, where pieces are placed on the side of each other, in a contiguous block called the hive. Each player has 11 pieces, representing various insects.`,A2.fromRepresentation([[[C5],[Ka],[TH],[S9]],[[S9],[],[SP],[]],[[SP],[],[],[]]],8)),ce.informational($localize`Object of the game`,$localize`The object of the game at Hive is to surround the opponent's queen. Once the queen is surrounded by 6 pieces, no matter the owner of these pieces, the game ends. The player with a queen that is not surrounded wins. In case both queens are fully surrounded at the same turn, it is a draw. Here, Dark won.`,A2.fromRepresentation([[[],[Ka],[MP]],[[Bm],[C5],[L4]],[[S9],[v5],[]]],7)),ce.anyMove($localize`Placing the first and second piece`,$localize`There are two types of actions: drops and moves. Initially, the board is empty, so we will have to put (drop) pieces on the board. For the first piece dropped on the board, there is no placement restriction: you can choose any piece and put in on the board. The second piece, put by Light, will need to be put in a neighboring space of the first piece. To drop a piece on the board, select the piece of your choice in your remaining pieces (below the board), and then click on the space you want to drop it on.<br/><br/>You're playing Dark and starting the game, put any piece on the board.`,A2.getInitialState(),Ei.drop(v5,new M(0,0)),$localize`Congratulations!`),ce.anyMove($localize`Placing pieces after the second turn`,$localize`After the second turn, you are still allowed to place pieces any time you want, as long as you respect two conditions: <ol><li>your piece must be connected to the hive, and</li><li>the space on which you drop your piece must not touch a stack of the opponent.</li></ol><br/><br/>You're playing Dark, drop a piece on the board.`,A2.fromRepresentation([[[Ka],[S9]]],2),Ei.drop(L4,new M(2,0)),$localize`Congratulations!`),ce.fromMove($localize`Moving pieces: the queen bee`,$localize`Once you have placed you queen bee on the board, you can move your pieces. You must place your queen bee on the board as your fourth piece at the latest. Each creature moves in a different way, and moves should respect two restrictions:<ol><li>the hive must always remain fully connected, and</li><li>pieces should be able to physically slide to their destination (except for the beetle and grasshopper as we will see later).</li></ol>The queen bee can move to any of its empty neighbors. To move a piece, click on it and then click on its destination. The possible destinations are highlighted.<br/><br/>You are playing Dark, move your queen bee.`,A2.fromRepresentation([[[],[MP],[PH],[C5],[Ka]],[[Ka],[L4],[v5],[],[]]],4),[Ei.move(new M(1,1),new M(0,2)).get(),Ei.move(new M(1,1),new M(1,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Moving the beetle`,$localize`The beetle moves like the queen bee, but it is allowed to climb on top of other pieces! Therefore, it need not adhere to the sliding restriction. Note that you are not allowed to drop the beetle on top of another piece in the drop phase, this can only be achieved when moving a beetle already on the board. A piece with a beetle on top is not allowed to move. A stack is considered to be of the player who has the beetle of the top.<br/><br/>You're playing Dark, block your opponent's queen by moving on top of it!`,A2.fromRepresentation([[[L4],[C5],[v5]],[[Ka],[],[]]],6),[Ei.move(new M(2,0),new M(1,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.forClick($localize`Inspecting stacks`,$localize`When pieces are stacked together, you are allowed to inspect the stack to see which pieces are under the beetle. This works with opponent-controlled stacks too. To do so, you can simply click on any stack to see their composition.<br/><br/>You're playing Dark and your opponent has a beetle on top of one of your piece, click on it.`,A2.fromRepresentation([[[Ka,L4],[C5],[v5]]],2),["#piece_0_0"],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Moving the grasshopper`,$localize`The grasshopper jumps over one or more pieces in a straight line, and stops at the first empty space encountered. It cannot jump over empty spaces, and can only move through jumps. Because it jumps, it does not adhere to the sliding restriction.<br/><br/>You're playing Dark. Jump over three pieces with your grasshopper!`,A2.fromRepresentation([[[S9],[L4],[Ka],[Bm]],[[PH],[],[],[]]],6),[Ei.move(new M(0,0),new M(4,0)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Moving the soldier ant`,$localize`The soldier ant is a powerful piece: it can move anywhere in the hive as long as it respects the sliding and the one hive restrictions!<br/><br/>You're playing Dark. Your queen bee is stuck, move your soldier ant to free up your queen!`,A2.fromRepresentation([[[],[SP],[C5]],[[],[L4],[Ka]],[[Bm],[TH],[]]],6),Ei.move(new M(1,0),new M(3,1)).get(),(t,e,r)=>t.equals(Ei.move(new M(1,0),new M(0,1)).get())?U.failure($localize`You have not freed your queen, try again!`):U.SUCCESS,$localize`Congratulations!`),ce.anyMove($localize`Moving the spider`,$localize`Finally, the spider can move exactly 3 spaces at a time. It is not allowed to go twice through the same space in a move. As the spider crawls around other pieces, it can only move around pieces that are in direct contact with it. This means that the spider is not allowed to temporarily split the hive. For example, here, Dark's spider cannot go on the left as its first move. To do a spider move, select a spider and click on the three spaces that compose the move.<br/><br/>You're playing Dark, move your spider!`,A2.fromRepresentation([[[],[MP],[TH],[Ka]],[[],[],[],[v5]],[[Ka],[],[],[Bm]],[[SP],[],[S9],[]],[[L4],[PH],[],[]]],6),Ei.spiderMove([new M(1,0),new M(1,1),new M(2,1),new M(2,2)]),$localize`Congratulations!`),ce.informational($localize`Restrictions`,$localize`Let us clarify the two restrictions during moves.<ol><li>All pieces of the hive should always be connected in a way that there is a single hive. It can be the case that your piece disconnects from the hive when you slide it, but after the move there should be only one hive.</li><li>Except grasshoppers and beetles, all moves should be done by sliding the piece without disturbing the rest of the hive.</li></ol>Observe here how the queen bee is stuck, as it is not possible to slide it without moving one of the other pieces. Moreover, moving it would split the hive in two.`,A2.fromRepresentation([[[],[MP],[]],[[],[L4],[Ka]],[[Bm],[],[]]],6)),ce.informational($localize`Passing your turn`,$localize`Finally, it is possible that you are not able to do any move: when it is the case, you must pass your turn. Here, Dark must pass: the queen bee cannot move without disconnecting the hive, the beetle is stuck beneath another beetle, and a dropped piece would be in contact with an opponent's piece.`,A2.fromRepresentation([[[Ka,v5],[L4],[C5]]],4))]}}const f6t=["app-hive-piece",""];function h6t(n,t){1&n&&(B(),X(0,"path",9))}function d6t(n,t){1&n&&(B(),X(0,"path",10))}function p6t(n,t){1&n&&(B(),X(0,"path",11))}function g6t(n,t){1&n&&(B(),X(0,"path",12))}function m6t(n,t){1&n&&(B(),X(0,"path",13))}let _6t=(()=>{class n extends xce{constructor(){super(...arguments),this.hexaPoints="",this.pieceClass="",this.isoPointsLight="",this.isoPointsDark="",this.isoPointsStroke="",this.layerTransform="",this.hexaCenter=new M(0,0)}ngAfterContentChecked(){const e=new M(this.x,this.y);this.pieceClass=this.getPlayerClass(this.piece.owner),this.hexaPoints=this.hexaLayout.getHexaPointsAt(e),this.hexaCenter=this.hexaLayout.getCenterAt(e);const s=this.hexaLayout.getIsoPoints(e,this.pieceHeight).map(i=>i.map(o=>o.toSVGPoint()).join(" "));this.isoPointsLight=s[0],this.isoPointsDark=s[1],this.isoPointsStroke=s[2],this.layerTransform=`translate(0 -${(this.layer+1)*this.pieceHeight})`}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["","app-hive-piece",""]],inputs:{piece:"piece",x:"x",y:"y",hexaLayout:"hexaLayout",layer:"layer",pieceHeight:"pieceHeight"},features:[l],attrs:f6t,decls:11,vars:14,consts:[[1,"base","no-stroke","lighter",3,"ngClass"],[1,"base","no-stroke","darker",3,"ngClass"],[1,"base","no-fill","small-stroke"],[1,"base","small-stroke",3,"ngClass"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z",4,"ngIf"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z",4,"ngIf"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z",4,"ngIf"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z",4,"ngIf"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z",4,"ngIf"],["d","M 15.3841 1.25408 C 22.8728 -1.82428 29.9895 -8.66692 29.9895 -11.9438 C 29.9895 -12.8799 29.4656 -13.6136 28.5873 -13.906 C 27.8046 -14.1664 24.6195 -14.3188 14.4763 -7.04548 C 14.3844 -7.97908 13.9844 -8.82172 13.3836 -9.47812 C 13.4167 -9.58096 13.4394 -9.6886 13.4394 -9.80284 C 13.4394 -13.1571 9.49688 -15.9237 3.91664 -16.864 C 3.97556 -18.4007 4.88768 -22.8456 12.8845 -26.8437 C 13.4073 -27.1052 13.6191 -27.7406 13.3578 -28.2634 C 13.0953 -28.7862 12.4609 -28.9971 11.938 -28.7367 C 3.34424 -24.4397 1.97336 -19.361 1.81856 -17.1244 C 1.12448 -17.1802 0.41168 -17.2094 -0.31564 -17.2094 C -1.40548 -17.2094 -2.46052 -17.1422 -3.47128 -17.0189 C -3.59032 -19.1981 -4.86616 -24.371 -13.5975 -28.7366 C -14.1203 -28.997 -14.7548 -28.7861 -15.0172 -28.2633 C -15.2787 -27.7404 -15.0668 -27.1049 -14.5439 -26.8436 C -6.16912 -22.6568 -5.56468 -17.9801 -5.57296 -16.6665 C -10.6046 -15.5753 -14.0706 -12.9474 -14.0706 -9.8026 C -14.0706 -9.68836 -14.048 -9.58072 -14.0146 -9.47788 C -14.6715 -8.76052 -15.0833 -7.81948 -15.121 -6.78208 C -25.5504 -14.3201 -28.8038 -14.17 -29.5978 -13.9058 C -30.4761 -13.6134 -31 -12.8799 -31 -11.9438 C -31 -8.63464 -23.7414 -1.68868 -16.1718 1.3442 C -23.7414 4.3772 -31 11.3233 -31 14.6323 C -31 15.5684 -30.4761 16.3021 -29.5968 16.5955 C -29.4222 16.6533 -29.1701 16.7371 -28.7516 16.7371 C -27.2727 16.7371 -23.7153 15.6854 -14.1678 8.74748 C -13.8431 9.143 -13.5125 9.47624 -13.0664 9.73316 C -12.821 16.1545 -7.58992 21.3656 -1.50604 21.892 L -1.50604 27.23 C -1.50604 27.8149 -1.03276 28.288 -0.448 28.288 C 0.13688 28.288 0.61004 27.8148 0.61004 27.23 L 0.61004 21.892 C 6.95852 21.3656 12.0572 16.1545 12.3026 9.73316 C 12.7614 9.46892 13.1995 9.12296 13.5294 8.71304 C 23.1112 15.6825 26.6942 16.738 28.1769 16.738 C 28.5964 16.738 28.8579 16.6533 29.0335 16.5944 C 29.9118 16.302 30.4398 15.5684 30.4398 14.6322 C 30.44 11.2893 23.0366 4.23644 15.3841 1.25408 Z M -28.8921 -11.9096 C -27.3192 -12.3306 -20.102 -7.90708 -13.9077 -3.24676 C -14.6109 -2.53432 -15.059 -1.57444 -15.1169 -0.51196 C -23.053 -3.54004 -29.0001 -10.3224 -28.8921 -11.9096 Z M -15.1288 6.06848 C -15.1288 6.31232 -15.1035 6.55004 -15.0636 6.78248 C -22.932 12.527 -27.6682 14.8687 -28.8932 14.593 C -28.9924 12.9306 -22.5395 5.64788 -14.1152 2.8394 C -14.0278 2.81048 -13.9496 2.76812 -13.8756 2.72 C -13.8144 2.78096 -13.7488 2.837 -13.6838 2.89412 C -14.5674 3.67016 -15.1288 4.80368 -15.1288 6.06848 Z M 27.8827 -11.9055 C 27.9772 -10.3347 22.2198 -3.74764 14.4784 -0.65668 C 14.3818 -1.74316 13.8714 -2.71012 13.1071 -3.40516 C 19.2103 -7.978 26.2028 -12.271 27.8827 -11.9055 Z M -0.31564 -15.0932 C 5.65928 -15.0932 10.0551 -12.9976 11.0895 -10.7981 C 10.8201 -10.8519 10.5422 -10.9012 10.257 -10.9012 L -10.8881 -10.9012 C -11.1731 -10.9012 -11.4513 -10.8519 -11.7207 -10.7981 C -10.6866 -12.9976 -6.29056 -15.0932 -0.31564 -15.0932 Z M -0.31564 19.7833 C -5.79256 19.7833 -10.3106 15.551 -10.8432 10.2606 L 10.2122 10.2606 C 9.67952 15.5509 5.16128 19.7833 -0.31564 19.7833 Z M 10.257 8.14436 L -10.8881 8.14436 C -12.0599 8.14436 -13.0126 7.1948 -13.0126 6.02816 C -13.0126 4.86152 -12.0599 3.91196 -10.8881 3.91196 L 10.257 3.91196 C 11.4286 3.91196 12.3813 4.86152 12.3813 6.02816 C 12.3813 7.1948 11.4286 8.14436 10.257 8.14436 Z M 10.257 1.79588 L -10.8881 1.79588 C -12.0599 1.79588 -13.0126 0.84632 -13.0126 -0.32032 C -13.0126 -1.48696 -12.0599 -2.43652 -10.8881 -2.43652 L 10.257 -2.43652 C 11.4286 -2.43652 12.3813 -1.48696 12.3813 -0.32032 C 12.3813 0.84632 11.4286 1.79588 10.257 1.79588 Z M 10.257 -4.5526 L -10.8881 -4.5526 C -12.0599 -4.5526 -13.0126 -5.50216 -13.0126 -6.6688 C -13.0126 -7.83544 -12.0599 -8.785 -10.8881 -8.785 L 10.257 -8.785 C 11.4286 -8.785 12.3813 -7.83544 12.3813 -6.6688 C 12.3813 -5.50216 11.4286 -4.5526 10.257 -4.5526 Z M 28.3363 14.5982 C 27.2038 14.8942 22.4127 12.5611 14.4402 6.73292 C 14.4745 6.51596 14.4975 6.29504 14.4975 6.06848 C 14.4975 4.8038 13.9364 3.67028 13.0527 2.89424 C 13.1287 2.82764 13.2044 2.7602 13.2751 2.68832 C 13.3609 2.75036 13.4539 2.80436 13.5592 2.8394 C 21.9908 5.651 28.4488 12.945 28.3363 14.5982 Z"],["d","M 27.079 1.30667 L 15.7412 -4.79822 L 15.7412 -7.89145 C 15.7412 -8.39311 15.335 -8.80033 14.8324 -8.80033 L 12.1056 -8.80033 L 12.1056 -9.70918 C 12.1056 -10.4088 12.0442 -11.0941 11.927 -11.7605 L 17.9173 -14.3278 C 18.2517 -14.4705 18.4681 -14.7995 18.4681 -15.1622 L 18.4681 -25.1602 L 23.9215 -25.1602 C 24.4242 -25.1602 24.8304 -25.5674 24.8304 -26.0691 C 24.8304 -26.5718 24.4242 -26.978 23.9215 -26.978 L 17.5592 -26.978 C 17.0566 -26.978 16.6503 -26.5718 16.6503 -26.0691 L 16.6503 -15.7621 L 11.4679 -13.5404 C 10.6322 -15.9716 9.02444 -18.0467 6.93872 -19.4717 C 7.86471 -20.1312 8.47025 -21.2128 8.47025 -22.4339 C 8.47025 -24.439 6.83966 -26.0695 4.83465 -26.0695 C 4.33202 -26.0695 3.92577 -25.6623 3.92577 -25.1607 C 3.92577 -24.659 4.33202 -24.2518 4.83465 -24.2518 C 5.83716 -24.2518 6.65252 -23.4366 6.65252 -22.4339 C 6.65252 -21.4314 5.83726 -20.6161 4.83465 -20.6161 L 4.83336 -20.616 C 3.43401 -21.2012 1.89916 -21.525 0.290076 -21.525 C -1.31901 -21.525 -2.85386 -21.2012 -4.25324 -20.616 L -4.2545 -20.6161 C -5.257 -20.6161 -6.07236 -21.4313 -6.07236 -22.4339 C -6.07236 -23.4365 -5.25711 -24.2518 -4.2545 -24.2518 C -3.75186 -24.2518 -3.34563 -24.659 -3.34563 -25.1607 C -3.34563 -25.6623 -3.75186 -26.0695 -4.2545 -26.0695 C -6.25961 -26.0695 -7.89009 -24.4389 -7.89009 -22.4339 C -7.89009 -21.2127 -7.28459 -20.1312 -6.35856 -19.4717 C -8.44428 -18.0467 -10.0521 -15.9716 -10.8877 -13.5404 L -16.0702 -15.7621 L -16.0702 -26.0691 C -16.0702 -26.5718 -16.4764 -26.978 -16.979 -26.978 L -23.3419 -26.978 C -23.8445 -26.978 -24.2508 -26.5718 -24.2508 -26.0691 C -24.2508 -25.5674 -23.8445 -25.1602 -23.3419 -25.1602 L -17.8884 -25.1602 L -17.8884 -15.1622 C -17.8884 -14.7995 -17.6721 -14.4705 -17.3377 -14.3278 L -11.3474 -11.7605 C -11.4646 -11.0941 -11.526 -10.4086 -11.526 -9.70917 L -11.526 -8.80033 L -14.2527 -8.80033 C -14.7554 -8.80033 -15.1616 -8.3931 -15.1616 -7.89145 L -15.1616 -4.79822 L -26.4994 1.30667 C -26.9411 1.54388 -27.1074 2.09561 -26.8693 2.53732 C -26.7047 2.84269 -26.3912 3.01546 -26.0677 3.01546 C -25.9223 3.01546 -25.775 2.98095 -25.6378 2.90639 L -15.1617 -2.73463 L -15.1617 5.31601 L -20.2889 9.58867 C -20.6025 9.85047 -20.7034 10.2904 -20.5334 10.663 L -16.1815 20.2374 L -19.5862 26.1962 C -19.8362 26.6316 -19.6845 27.1869 -19.2482 27.4359 C -19.1064 27.5177 -18.951 27.5559 -18.7983 27.5559 C -18.4819 27.5559 -18.1757 27.3913 -18.0085 27.0978 L -14.3729 20.7354 C -14.2283 20.4818 -14.2138 20.1747 -14.3347 19.9084 L -18.5921 10.5411 L -15.1618 7.68295 L -15.1618 8.46881 C -15.1618 16.989 -8.23053 23.9203 0.28965 23.9203 C 8.80982 23.9203 15.7411 16.989 15.7411 8.46881 L 15.7411 7.68295 L 19.1714 10.5411 L 14.9141 19.9084 C 14.7932 20.1747 14.8078 20.4819 14.9522 20.7354 L 18.5878 27.0978 C 18.755 27.3913 19.0614 27.5559 19.3776 27.5559 C 19.5303 27.5559 19.6857 27.5177 19.8275 27.4359 C 20.2638 27.1869 20.4155 26.6316 20.1656 26.1962 L 16.7608 20.2374 L 21.1127 10.663 C 21.2827 10.2903 21.1817 9.85037 20.8681 9.58867 L 15.741 5.31601 L 15.741 -2.73463 L 26.2171 2.90639 C 26.3544 2.98095 26.5016 3.01546 26.647 3.01546 C 26.9705 3.01546 27.2841 2.8428 27.4486 2.53732 C 27.687 2.09561 27.5207 1.54398 27.079 1.30667 Z M -9.70827 -9.70928 C -9.70827 -15.2218 -5.22281 -19.7073 0.289757 -19.7073 C 5.80234 -19.7073 10.2878 -15.2219 10.2878 -9.70928 L 10.2878 -8.80044 L -9.70827 -8.80044 Z M -10.6171 -6.98257 L 11.1966 -6.98257 L 13.9234 -6.98257 L 13.9234 -4.26531 C 13.9233 -4.25796 13.9233 -4.25065 13.9234 -4.24316 L 13.9234 -3.87835 L 0.289757 3.79022 L -13.3439 -3.87835 L -13.3439 -4.24316 C -13.3438 -4.25051 -13.3438 -4.25786 -13.3439 -4.26531 L -13.3439 -6.98257 Z M -13.3439 8.46892 L -13.3439 5.74091 L -13.3439 5.73461 L -13.3439 -1.79295 L -0.619115 5.36501 L -0.619115 22.0715 C -7.71446 21.6021 -13.3439 15.681 -13.3439 8.46892 Z M 1.19863 22.0715 L 1.19863 5.36501 L 13.9234 -1.79295 L 13.9234 5.73471 L 13.9234 5.7408 L 13.9234 8.46902 C 13.9234 15.681 8.29409 21.6021 1.19863 22.0715 Z"],["d","M 23.1993 15.5733 C 21.3366 14.109 18.3446 11.7414 17.7296 11.2169 C 12.9652 2.64827 6.39655 -0.814228 5.07856 -1.44294 C 5.33756 -1.88486 5.4918 -2.35409 5.4918 -2.83719 C 5.4918 -3.30048 5.3294 -3.93486 5.04265 -5.01624 C 4.8512 -5.73792 4.63024 -6.57068 4.49294 -7.31486 C 4.59374 -7.31187 4.69419 -7.30891 4.79464 -7.30891 C 8.94543 -7.30891 12.7535 -9.75455 12.9341 -9.87229 C 13.1714 -10.0271 13.3373 -10.2703 13.3943 -10.5478 C 13.451 -10.8255 13.3949 -11.1144 13.2379 -11.3502 L 11.5052 -13.9494 C 13.7039 -15.6498 16.0931 -16.5487 16.1187 -16.5583 C 16.6686 -16.7613 16.9498 -17.3717 16.7467 -17.9216 C 16.5433 -18.4713 15.9332 -18.7522 15.3835 -18.5494 C 15.2491 -18.4996 12.0538 -17.304 9.38881 -14.9538 C 8.99075 -14.6026 8.91323 -14.0109 9.20786 -13.5691 L 10.8409 -11.1198 C 9.64329 -10.4953 7.44869 -9.53254 5.16354 -9.43858 C 5.21814 -9.64602 5.24334 -9.83818 5.25069 -10.0066 C 5.28989 -10.9199 4.88588 -11.8072 4.04914 -12.6442 C 3.74954 -12.9441 3.51227 -13.3816 3.26136 -13.8449 C 2.98206 -14.3609 2.65176 -14.9693 2.15511 -15.4578 C 2.8653 -18.087 7.91209 -26.8789 12.9465 -30.2572 C 13.4331 -30.5838 13.5628 -31.2431 13.2359 -31.7297 C 12.909 -32.2165 12.2501 -32.3464 11.7633 -32.0197 C 6.51594 -28.4984 1.39127 -19.8963 0.213976 -16.338 C 0.113176 -16.3457 0.00992607 -16.351 -0.0975239 -16.351 C -0.204974 -16.351 -0.308574 -16.3457 -0.409374 -16.338 C -1.58669 -19.8963 -6.71146 -28.4984 -11.9586 -32.0197 C -12.4453 -32.3465 -13.1048 -32.2168 -13.4313 -31.7297 C -13.7575 -31.2431 -13.6283 -30.5836 -13.1415 -30.2572 C -8.10712 -26.8789 -3.0603 -18.087 -2.35008 -15.4578 C -2.8469 -14.9693 -3.17709 -14.3609 -3.45639 -13.8449 C -3.70734 -13.3816 -3.94429 -12.9441 -4.24417 -12.6442 C -5.08116 -11.8072 -5.48531 -10.9199 -5.44569 -10.0066 C -5.43869 -9.83861 -5.41034 -9.64675 -5.35889 -9.43985 C -7.63784 -9.53621 -9.83525 -10.4982 -11.0349 -11.1215 L -9.4031 -13.5691 C -9.1084 -14.0109 -9.18575 -14.6025 -9.58405 -14.9538 C -12.249 -17.304 -15.4439 -18.4998 -15.5787 -18.5494 C -16.1283 -18.7529 -16.7389 -18.4714 -16.9419 -17.9216 C -17.1453 -17.3717 -16.8639 -16.7614 -16.3139 -16.5583 C -16.2894 -16.5485 -13.9065 -15.6578 -11.7003 -13.9495 L -13.4331 -11.3502 C -13.5903 -11.1144 -13.6466 -10.8255 -13.5896 -10.5478 C -13.5325 -10.2702 -13.3666 -10.027 -13.1294 -9.87229 C -12.9485 -9.75455 -9.14095 -7.30891 -4.98985 -7.30891 C -4.8894 -7.30891 -4.7886 -7.31201 -4.68815 -7.31486 C -4.82535 -6.57068 -5.04669 -5.73792 -5.23789 -5.01624 C -5.52454 -3.93472 -5.68701 -3.30048 -5.68701 -2.8372 C -5.68701 -2.35409 -5.53301 -1.885 -5.27377 -1.44294 C -6.59176 -0.814515 -13.1606 2.64715 -17.9248 11.2169 C -18.5398 11.7414 -21.5318 14.109 -23.3946 15.5733 C -23.8553 15.9355 -23.9353 16.6027 -23.5731 17.0635 C -23.3638 17.3299 -23.0524 17.4689 -22.7381 17.4689 C -22.5085 17.4689 -22.2773 17.3949 -22.0829 17.2419 C -16.329 12.7187 -16.2836 12.636 -16.1484 12.3905 C -12.7212 6.15479 -8.19525 2.75469 -5.81882 1.2894 L -6.09532 2.62182 C -6.25842 3.40845 -6.37112 4.19975 -6.43447 4.99303 C -6.63957 5.8207 -7.95109 11.2654 -7.95109 15.2755 L -7.95109 28.8035 C -7.95109 30.0442 -6.94176 31.0534 -5.6958 31.0534 C -4.54097 31.0534 -3.57917 30.1874 -3.45818 29.0391 L -3.23488 26.9188 L -2.46904 31.3227 C -2.26779 32.4787 -1.27065 33.3177 -0.0974189 33.3177 C 1.07582 33.3177 2.07325 32.4787 2.27422 31.3229 L 3.04019 26.9189 L 3.26349 29.0391 C 3.38389 30.1876 4.34632 31.0536 5.50647 31.0536 C 6.74711 31.0536 7.75644 30.0442 7.75644 28.8036 L 7.75644 15.2757 C 7.75644 11.2658 6.4452 5.82155 6.23979 4.99331 C 6.17609 4.20003 6.06374 3.40873 5.90029 2.62196 L 5.62274 1.2836 C 7.99413 2.73998 12.5115 6.12819 15.9537 12.391 C 16.0888 12.6363 16.1339 12.719 21.888 17.2422 C 22.0826 17.395 22.3137 17.4692 22.5432 17.4692 C 22.8578 17.4692 23.1687 17.3302 23.3782 17.0637 C 23.7406 16.6029 23.6603 15.9355 23.1997 15.5733 Z M -0.0974189 -0.50221 C -1.23145 -0.50221 -3.5643 -2.07335 -3.5643 -2.83621 C -3.5608 -3.05937 -3.34415 -3.87585 -3.18616 -4.47201 C -2.94361 -5.38656 -2.65811 -6.46286 -2.51829 -7.43599 L 2.32336 -7.43599 C 2.46301 -6.46286 2.74857 -5.38656 2.99126 -4.47201 C 3.14946 -3.87585 3.36587 -3.0595 3.3694 -2.83706 C 3.36958 -2.07335 1.03665 -0.50221 -0.0973489 -0.50221 Z M -2.74316 -11.143 C -2.22485 -11.6614 -1.88748 -12.2843 -1.58991 -12.834 C -1.01925 -13.8877 -0.777679 -14.2284 -0.0976289 -14.2284 C 0.582456 -14.2284 0.824166 -13.8878 1.39474 -12.834 C 1.69259 -12.2843 2.02964 -11.6614 2.54799 -11.143 C 2.93554 -10.7554 3.14232 -10.3845 3.1299 -10.0984 C 3.1229 -9.90554 3.00985 -9.71847 2.8709 -9.55872 L -3.06667 -9.55872 C -3.20527 -9.71849 -3.31727 -9.90557 -3.32532 -10.0984 C -3.33582 -10.3844 -3.13072 -10.7553 -2.74341 -11.143 Z M -5.5692 28.8171 C -5.5762 28.882 -5.63045 28.931 -5.7015 28.931 C -5.7715 28.931 -5.8289 28.8738 -5.8289 28.8036 L -5.8289 15.2757 C -5.8289 14.5074 -5.7743 13.6716 -5.6868 12.8224 L -4.56484 19.2736 Z M 0.182861 30.9593 C 0.158361 31.0959 0.0411111 31.1951 -0.0974889 31.1951 C -0.236439 31.1951 -0.354039 31.0959 -0.377839 30.9592 L -4.12024 9.4401 C -4.36139 8.05221 -4.42929 6.65441 -4.32604 5.26327 C -4.32334 5.23737 -4.32254 5.21161 -4.32254 5.18602 C -4.26619 4.47255 -4.16574 3.76092 -4.01909 3.05339 L -3.46252 0.371859 C -2.71761 0.872219 -1.89235 1.25047 -1.1611 1.45324 L -1.1611 19.804 C -1.1611 20.3903 -0.685909 20.8653 -0.0997989 20.8653 C 0.486346 20.8653 0.961506 20.3903 0.961506 19.804 L 0.961506 1.4531 C 1.6928 1.25045 2.51806 0.872079 3.26293 0.371716 L 3.8195 3.05325 C 3.96615 3.76078 4.06695 4.47241 4.12295 5.18588 C 4.12407 5.21178 4.12617 5.2374 4.12645 5.26313 C 4.2297 6.65413 4.1618 8.05193 3.92065 9.43996 Z M 5.63355 28.8035 C 5.63355 28.8737 5.57615 28.9309 5.50055 28.9309 C 5.4351 28.9309 5.38085 28.8819 5.3742 28.8168 L 4.36967 19.2735 L 5.49166 12.8221 C 5.57951 13.6713 5.63376 14.5072 5.63376 15.2754 Z"],["d","M 26.2796 -9.91591 C 26.0694 -10.4424 25.4717 -10.6985 24.9452 -10.488 L 13.9952 -6.10798 C 13.8372 -6.04429 13.6972 -5.94331 13.588 -5.8123 L 8.42091 0.388326 L 4.52341 0.388326 L 8.59528 -4.49777 C 8.68702 -4.60766 8.75434 -4.73537 8.79361 -4.87289 L 13.1189 -20.0116 L 20.6616 -29.7097 C 21.0095 -30.1573 20.9295 -30.8021 20.4821 -31.1502 C 20.0347 -31.498 19.3896 -31.4175 19.0416 -30.9702 L 11.3767 -21.1152 C 11.2958 -21.0115 11.2364 -20.8935 11.1998 -20.7668 L 6.87935 -5.64532 L 3.30485 -1.35594 C 3.18605 -2.00651 2.8709 -2.58958 2.42256 -3.04056 L 3.25011 -4.69564 C 3.50388 -5.20275 3.29829 -5.81939 2.79124 -6.07303 C 2.28436 -6.3268 1.66762 -6.12088 1.41399 -5.6137 L 0.587006 -3.95974 C 0.441806 -3.97954 0.292976 -3.99472 0.142034 -3.99472 C -0.00910632 -3.99472 -0.157276 -3.98812 -0.302971 -3.95974 L -1.12991 -5.6137 C -1.38335 -6.12068 -2.00005 -6.32611 -2.50716 -6.07303 C -3.01427 -5.81926 -3.21983 -5.20292 -2.96599 -4.69564 L -2.13845 -3.04056 C -2.58676 -2.58938 -2.90151 -2.00667 -3.02074 -1.35594 L -6.5952 -5.64532 L -10.9158 -20.7666 C -10.9547 -20.8928 -11.0118 -21.0109 -11.0926 -21.1151 L -18.7576 -30.97 C -19.1055 -31.4177 -19.7506 -31.4983 -20.198 -31.15 C -20.6454 -30.802 -20.7262 -30.157 -20.3785 -29.7096 L -12.8358 -20.0115 L -8.51046 -4.87279 C -8.47152 -4.73518 -8.40354 -4.6078 -8.31213 -4.49768 L -4.24022 0.388425 L -8.13769 0.388425 L -13.3048 -5.81223 C -13.4137 -5.94324 -13.554 -6.04521 -13.7121 -6.10791 L -24.6622 -10.4879 C -25.1888 -10.6981 -25.7861 -10.4401 -25.9966 -9.91598 C -26.2072 -9.38953 -25.9488 -8.7922 -25.4248 -8.58156 L -14.7158 -4.29806 L -9.4072 2.07245 C -9.21217 2.30642 -8.92325 2.44211 -8.61853 2.44211 L -4.49492 2.44211 L -10.118 4.85187 C -10.2909 4.92612 -10.4398 5.04591 -10.5486 5.199 L -16.0236 12.8639 C -16.0985 12.9686 -16.153 13.0867 -16.1843 13.2114 L -17.2793 17.5914 C -17.4169 18.1415 -17.0823 18.6989 -16.5324 18.8364 C -16.4489 18.8562 -16.365 18.8714 -16.2825 18.8714 C -15.8228 18.8714 -15.4041 18.5596 -15.2875 18.0936 L -14.2397 13.9027 L -9.04496 6.63014 L -3.91861 4.43304 C -4.18822 4.70496 -4.4401 4.99859 -4.67127 5.31067 L -10.4723 11.6784 C -10.5927 11.811 -10.6762 11.9724 -10.7155 12.1472 L -12.9055 22.0021 C -12.9286 22.117 -12.9404 22.2354 -12.9253 22.3524 L -11.8303 31.1123 C -11.7653 31.6316 -11.3231 32.0116 -10.8129 32.0116 C -10.7697 32.0116 -10.7275 32.009 -10.6842 32.005 C -10.1217 31.9347 -9.72255 31.4215 -9.79287 30.8589 L -10.8659 22.2755 L -8.77373 12.8608 L -6.36268 10.2144 C -6.34288 13.6592 -3.66998 19.968 0.138371 19.968 C 3.94677 19.968 6.62264 13.6592 6.6395 10.2144 L 9.05055 12.8608 L 11.1426 22.2755 L 10.0697 30.8589 C 9.99943 31.4215 10.3981 31.9346 10.961 32.005 C 11.0042 32.0083 11.0468 32.0116 11.0897 32.0116 C 11.6 32.0116 12.0421 31.6318 12.1071 31.1123 L 13.2021 22.3524 C 13.2186 22.2352 13.2087 22.1171 13.1856 22.0021 L 10.9956 12.1472 C 10.9566 11.9726 10.8728 11.8106 10.7524 11.6784 L 4.95135 5.31067 C 4.72002 4.99849 4.46804 4.70499 4.19869 4.43304 L 9.32498 6.63014 L 14.5198 13.9027 L 15.5676 18.0936 C 15.6841 18.5601 16.1027 18.8714 16.5626 18.8714 C 16.6451 18.8714 16.729 18.8648 16.8124 18.8364 C 17.3625 18.6988 17.6969 18.1415 17.5594 17.5914 L 16.4644 13.2114 C 16.4294 13.0867 16.3789 12.9686 16.3037 12.8639 L 10.8287 5.199 C 10.7198 5.04621 10.5707 4.92609 10.3981 4.85187 L 4.77501 2.44211 L 8.89863 2.44211 C 9.20289 2.44211 9.49223 2.30681 9.68729 2.07245 L 14.9959 -4.29806 L 25.7048 -8.58156 C 26.2309 -8.7921 26.4871 -9.38969 26.2765 -9.91604 Z M 3.32851 6.55639 C 3.33511 6.56299 3.34831 6.57949 3.35491 6.59533 C 3.44038 6.71413 3.52189 6.83623 3.6001 6.9615 L -3.31728 6.9615 C -3.2394 6.83643 -3.15723 6.71433 -3.07209 6.59533 C -3.06549 6.58873 -3.05229 6.57223 -3.04569 6.55639 C -2.22788 5.4365 -1.08892 4.63183 0.141308 4.63183 C 1.37151 4.63183 2.51044 5.43634 3.32825 6.55639 Z M -4.30682 10.1751 C -4.30682 9.7961 -4.25897 9.40383 -4.16987 9.01166 L 4.45319 9.01166 C 4.54229 9.4036 4.59014 9.79583 4.59014 10.1751 C 4.59014 10.5284 4.5512 10.9222 4.47728 11.3385 L -4.19435 11.3385 C -4.26695 10.9222 -4.30655 10.5285 -4.30655 10.1751 Z M 1.30499 -0.774814 L 1.30499 2.50003 L 1.30499 2.50663 L 1.30499 2.71651 C 0.928325 2.62543 0.540278 2.57461 0.141572 2.57461 C -0.257068 2.57461 -0.645313 2.62543 -1.02187 2.71651 L -1.02187 2.50663 L -1.02187 2.50003 L -1.02187 -0.774814 C -1.02187 -1.4163 -0.499981 -1.93823 0.141572 -1.93823 C 0.783092 -1.93823 1.30499 -1.41623 1.30499 -0.774814 Z M 0.141572 17.9085 C -1.29768 17.9085 -2.79123 15.6796 -3.62943 13.3916 L 3.91268 13.3916 C 3.07435 15.6796 1.58077 17.9085 0.141572 17.9085 Z"],["d","M 21.8842 2.21077 L 18.0181 2.21077 L 13.0729 -0.756106 C 12.911 -0.853707 12.7271 -0.904573 12.5381 -0.904573 L 6.18206 -0.904573 C 6.26409 -1.2402 6.30742 -1.58751 6.30742 -1.94298 C 6.30742 -2.35345 6.24815 -2.75236 6.13972 -3.13557 L 10.6647 -4.04062 C 10.9348 -4.09355 11.1726 -4.25344 11.3252 -4.48199 L 15.2411 -10.3555 L 20.0108 -11.3098 C 20.2808 -11.3628 20.5186 -11.5227 20.6712 -11.7512 L 22.7482 -14.8665 C 23.067 -15.3442 22.9382 -15.9892 22.4605 -16.3069 C 21.9817 -16.6267 21.3378 -16.4959 21.0201 -16.0192 L 19.181 -13.2611 L 14.4113 -12.3067 C 14.1413 -12.2538 13.9035 -12.0939 13.7509 -11.8653 L 9.83492 -5.99184 L 5.07504 -5.03946 C 4.8146 -5.33056 4.51767 -5.59756 4.1913 -5.83727 C 6.07121 -6.88908 7.3457 -8.89921 7.3457 -11.2028 L 7.3457 -13.4521 C 7.3457 -13.6801 7.33217 -13.9049 7.30798 -14.1266 C 7.3256 -14.1905 7.33742 -14.257 7.34266 -14.3255 C 7.34788 -14.3889 7.864 -20.6352 11.4996 -20.6352 C 17.0843 -20.6352 17.7053 -29.5377 17.7282 -29.9168 C 17.7635 -30.489 17.3284 -30.9813 16.7572 -31.0175 C 16.1861 -31.057 15.6907 -30.6188 15.6554 -30.0456 C 15.6502 -29.9729 15.0967 -22.7121 11.4996 -22.7121 C 8.14265 -22.7121 6.5767 -19.8132 5.85813 -17.4544 C 5.37949 -18.0105 4.80424 -18.4808 4.15721 -18.8374 C 4.84539 -19.5678 5.26657 -20.5387 5.26462 -21.5875 C 5.28337 -21.8035 5.40896 -23.7278 4.30508 -24.9262 C 3.76306 -25.516 3.01841 -25.8275 2.15341 -25.8275 C 1.57915 -25.8275 1.11501 -25.3623 1.11501 -24.7892 C 1.11501 -24.216 1.57915 -23.7508 2.15341 -23.7508 C 2.51691 -23.7508 2.67681 -23.6282 2.77551 -23.5223 C 3.19194 -23.0727 3.21786 -22.0716 3.19194 -21.6739 C 3.19194 -20.5286 2.2605 -19.597 1.11501 -19.597 L -0.96193 -19.597 C -2.1073 -19.597 -3.03886 -20.5284 -3.043 -21.7601 C -3.07306 -22.135 -3.01185 -23.0986 -2.6245 -23.5203 C -2.52581 -23.6272 -2.3659 -23.7508 -2.00034 -23.7508 C -1.42607 -23.7508 -0.96193 -24.216 -0.96193 -24.7892 C -0.96193 -25.3623 -1.42607 -25.8275 -2.00034 -25.8275 C -2.86533 -25.8275 -3.60997 -25.516 -4.15199 -24.9262 C -5.25588 -23.7279 -5.13015 -21.8035 -5.11569 -21.6738 C -5.11569 -20.5799 -4.69026 -19.5842 -3.99683 -18.8416 C -4.6468 -18.4846 -5.22446 -18.0128 -5.70491 -17.4546 C -6.42352 -19.8137 -7.98933 -22.7127 -11.3464 -22.7127 C -14.9311 -22.7127 -15.4971 -29.9735 -15.5022 -30.0462 C -15.5386 -30.6193 -16.0442 -31.0587 -16.605 -31.0172 C -17.1761 -30.9808 -17.6102 -30.4887 -17.5749 -29.9164 C -17.552 -29.5374 -16.931 -20.6359 -11.3463 -20.6359 C -7.72626 -20.6359 -7.19456 -14.3876 -7.18935 -14.3253 C -7.18397 -14.257 -7.17219 -14.1909 -7.15466 -14.1274 C -7.17899 -13.9057 -7.19248 -13.6806 -7.19248 -13.4525 L -7.19248 -11.2032 C -7.19248 -8.8997 -5.91799 -6.88944 -4.03808 -5.83763 C -4.36448 -5.59792 -4.66142 -5.33105 -4.92182 -5.03983 L -9.68174 -5.99221 L -13.5977 -11.8657 C -13.7503 -12.0941 -13.9881 -12.254 -14.2581 -12.3071 L -19.0278 -13.2614 L -20.8669 -16.0196 C -21.1846 -16.4963 -21.8295 -16.6271 -22.3073 -16.3073 C -22.7849 -15.9895 -22.9138 -15.3447 -22.5949 -14.8669 L -20.518 -11.7516 C -20.3654 -11.5231 -20.1275 -11.3633 -19.8576 -11.3102 L -15.0879 -10.3559 L -11.172 -4.48236 C -11.0194 -4.25393 -10.7816 -4.09401 -10.5116 -4.04098 L -5.98653 -3.13594 C -6.09507 -2.75272 -6.1542 -2.35382 -6.1542 -1.94335 C -6.1542 -1.58776 -6.11087 -1.24057 -6.02887 -0.904939 L -12.3849 -0.904939 C -12.5739 -0.904939 -12.7576 -0.85407 -12.9197 -0.756472 L -17.8648 2.21041 L -21.7311 2.21041 C -22.3053 2.21041 -22.7695 2.67564 -22.7695 3.24881 C -22.7695 3.82199 -22.3053 4.28723 -21.7311 4.28723 L -17.5773 4.28723 C -17.3883 4.28723 -17.2045 4.23634 -17.0425 4.13876 L -12.0973 1.17188 L -5.11579 1.17188 C -5.04949 1.17188 -4.98475 1.16506 -4.92182 1.15314 C -4.41144 1.72375 -3.76306 2.20335 -3.01939 2.55979 C -3.67679 3.29481 -4.07738 4.26409 -4.07738 5.32574 L -4.07738 5.72187 L -13.8876 10.627 C -14.1752 10.7713 -14.3787 11.0381 -14.441 11.3529 L -17.495 26.6212 L -20.3882 29.5143 C -20.7943 29.9204 -20.7943 30.5767 -20.3882 30.9827 C -20.1857 31.1852 -19.9198 31.2869 -19.654 31.2869 C -19.3881 31.2869 -19.1223 31.1852 -18.9198 30.9827 L -15.8045 27.8673 C -15.6591 27.7219 -15.5614 27.5381 -15.5209 27.3366 L -12.5043 12.2584 L -4.07728 8.04487 L -4.07728 8.44097 C -4.07728 9.47136 -3.69953 10.4145 -3.07635 11.1411 C -6.09774 12.3855 -8.23116 15.3606 -8.23116 18.8254 L -8.23116 22.9792 C -8.23116 27.5598 -4.50417 31.2868 0.0764775 31.2868 C 4.65712 31.2868 8.38411 27.5598 8.38411 22.9792 L 8.38411 18.8254 C 8.38411 15.3604 6.25083 12.3854 3.2293 11.1411 C 3.85249 10.4145 4.23024 9.47136 4.23024 8.44097 L 4.23024 8.04487 L 12.6572 12.2584 L 15.6739 27.3366 C 15.7144 27.538 15.812 27.7219 15.9574 27.8673 L 19.0728 30.9827 C 19.2753 31.1852 19.5412 31.2869 19.807 31.2869 C 20.0728 31.2869 20.3386 31.1852 20.5411 30.9827 C 20.9471 30.5767 20.9471 29.9203 20.5411 29.5143 L 17.648 26.6212 L 14.5939 11.3529 C 14.5315 11.0381 14.328 10.7713 14.0404 10.627 L 4.23024 5.72187 L 4.23024 5.32574 C 4.23024 4.26409 3.82962 3.29481 3.17223 2.55979 C 3.91601 2.20335 4.56426 1.72388 5.07464 1.15314 C 5.13757 1.16506 5.20219 1.17188 5.26865 1.17188 L 12.2502 1.17188 L 17.1953 4.13876 C 17.3573 4.23634 17.5411 4.28723 17.7301 4.28723 L 21.8839 4.28723 C 22.4581 4.28723 22.9223 3.82199 22.9223 3.24881 C 22.9223 2.67564 22.4585 2.21077 21.8842 2.21077 Z M -1.04894 -7.13526 C -3.29089 -7.13526 -5.11556 -8.9598 -5.11556 -11.2028 L -5.11556 -13.4521 C -5.11556 -15.6952 -3.29101 -17.5197 -1.04894 -17.5197 L 1.20238 -17.5197 C 3.44434 -17.5197 5.26901 -15.6952 5.26901 -13.4521 L 5.26901 -11.2028 C 5.26901 -8.9598 3.44444 -7.13526 1.20238 -7.13526 Z M 6.30752 18.8259 L 6.30752 22.9796 C 6.30752 26.4159 3.51308 29.2103 0.0768428 29.2103 C -3.3594 29.2103 -6.15384 26.4159 -6.15384 22.9796 L -6.15384 18.8259 C -6.15384 15.3896 -3.3594 12.5952 0.0768428 12.5952 C 3.51308 12.5952 6.30752 15.3896 6.30752 18.8259 Z M 2.15366 5.3261 L 2.15366 6.39593 L 2.15366 6.39956 L 2.15366 8.44147 C 2.15366 9.58683 1.22222 10.5184 0.076721 10.5184 C -1.06878 10.5184 -2.00022 9.58696 -2.00022 8.44147 L -2.00022 6.39956 L -2.00022 6.39593 L -2.00022 5.3261 C -2.00022 4.18074 -1.06878 3.24918 0.076721 3.24918 C 1.22222 3.24918 2.15366 4.18074 2.15366 5.3261 Z M 0.0768428 1.17236 C -2.21403 1.17236 -4.07692 -0.225404 -4.07692 -1.94298 C -4.07692 -3.66056 -2.21391 -5.05834 0.0768428 -5.05834 C 2.36759 -5.05834 4.2306 -3.66056 4.2306 -1.94298 C 4.2306 -0.225404 2.36759 1.17236 0.0768428 1.17236 Z"]],template:function(e,r){1&e&&(B(),b(0,"g"),X(1,"polygon",0)(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),b(5,"g"),x(6,h6t,1,0,"path",4),x(7,d6t,1,0,"path",5),x(8,p6t,1,0,"path",6),x(9,g6t,1,0,"path",7),x(10,m6t,1,0,"path",8),O()()),2&e&&(D("transform",r.layerTransform),S(1),T("ngClass",r.pieceClass),D("points",r.isoPointsLight),S(1),T("ngClass",r.pieceClass),D("points",r.isoPointsDark),S(1),D("points",r.isoPointsStroke),S(1),T("ngClass",r.pieceClass),D("points",r.hexaPoints),S(1),D("transform","translate("+r.hexaCenter.x+" "+r.hexaCenter.y+")"),S(1),T("ngIf","QueenBee"===r.piece.kind),S(1),T("ngIf","Beetle"===r.piece.kind),S(1),T("ngIf","Grasshopper"===r.piece.kind),S(1),T("ngIf","Spider"===r.piece.kind),S(1),T("ngIf","SoldierAnt"===r.piece.kind))},dependencies:[mn,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();function v6t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"polygon",4),J("click",function(){const i=fe(e).$implicit;return ae(v().selectSpace(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","space_",e.x,"_",e.y,""),T("ngClass",e.content.spaceClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function C6t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",6),J("click",function(){fe(e);const s=v().$implicit;return ae(v().selectSpace(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","stroke_",e.x,"_",e.y,""),T("ngClass",e.content.strokeClasses),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function y6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,C6t,1,4,"polygon",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.strokeClasses.length>0)}}function E6t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",8),J("click",function(){fe(e);const s=v().$implicit;return ae(v().selectSpace(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","stroke_",e.x,"_",e.y,""),D("points",r.getHexaPointsAtXY(e.x,e.y))}}function M6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,E6t,1,3,"polygon",7),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.selected)}}function S6t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"g",9),J("click",function(){const i=fe(e).$implicit;return ae(v(2).selectStack(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v().index,s=v();S(1),We("id","piece_",e.x,"_",e.y,""),T("piece",e.content.piece)("x",e.x)("y",e.y)("pieceHeight",s.PIECE_HEIGHT)("hexaLayout",s.hexaLayout)("layer",r)}}function P6t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",6),J("click",function(){fe(e);const s=v().$implicit;return ae(v(2).selectStack(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v().index,s=v();We("id","stroke_",e.x,"_",e.y,""),T("ngClass",e.content.strokeClasses),D("transform","translate(0 "+-(r+1)*s.PIECE_HEIGHT+")")("points",s.getHexaPointsAtXY(e.x,e.y))}}function T6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,P6t,1,5,"polygon",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.content.strokeClasses.length>0)}}function w6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,S6t,2,8,"g",1),x(2,T6t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e),S(1),T("ngForOf",e)}}function b6t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"g",10),J("click",function(){const i=fe(e).$implicit;return ae(v(2).selectRemaining(i))}),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v(2);S(1),C1("id","remainingPiece_",e.toString(),""),T("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("layer",r)("hexaLayout",s.hexaLayout),D("transform",s.getRemainingPieceTransform(e))}}function O6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,b6t,2,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e.pieces)}}function N6t(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v();D("transform",e.getRemainingPieceHighlightTransform(e.selectedRemaining.get()))("points",e.getHexaPointsAt(e.ORIGIN))}}function A6t(n,t){if(1&n&&(B(),X(0,"g",13)),2&n){const e=t.$implicit,r=t.index,s=v(2);C1("id","inspectedStack_",r,""),T("piece",e)("pieceHeight",s.PIECE_HEIGHT)("x",0)("y",0)("hexaLayout",s.hexaLayout)("layer",6*r),D("transform",s.inspectedStackTransform)}}function I6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,A6t,1,8,"g",12),O()),2&n){const e=v();S(1),T("ngForOf",e.inspectedStack.get().pieces.slice().reverse())}}class s3e extends Cte{constructor(){super(...arguments),this.highlighted=[]}initialize(t){this.set(t,{spaceClasses:[],strokeClasses:[],selected:!1})}highlightFill(t,e){this.highlighted.push(t),this.get(t).map(r=>r.spaceClasses.push(e))}highlightStroke(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}select(t){this.highlighted.push(t),this.get(t).map(e=>e.selected=!0)}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[],e.spaceClasses=[],e.selected=!1});this.highlighted=[]}}class x6t extends Cte{constructor(){super(...arguments),this.highlighted=[]}initialize(t,e){this.set(t,{piece:e,strokeClasses:[]})}highlight(t,e){this.highlighted.push(t),this.get(t).map(r=>r.strokeClasses.push(e))}clearHighlights(){for(const t of this.highlighted)this.get(t).map(e=>{e.strokeClasses=[]});this.highlighted=[]}}let k6t=(()=>{class n extends p9{constructor(e){super(e),this.ORIGIN=new M(0,0),this.remainingStacks=[],this.layers=[],this.ground=new s3e,this.inspectedStack=P.empty(),this.inspectedStackCoord=P.empty(),this.selectedRemaining=P.empty(),this.selectedStart=P.empty(),this.selectedSpiderCoords=[],this.rules=Mi.get(),this.availableMinimaxes=[new u6t(this.rules,"HiveMinimax")],this.encoder=Ei.encoder,this.tutorial=(new r3e).tutorial,this.SPACE_SIZE=30,this.PIECE_HEIGHT=this.SPACE_SIZE/3,this.hexaLayout=new g9(1.5*this.SPACE_SIZE,new M(2*this.SPACE_SIZE,0),Ns.INSTANCE),this.canPass=!1,this.updateBoard()}updateBoard(){this.cancelMoveAttempt(),this.layers=[];for(const r of this.getState().occupiedSpaces()){const s=this.getState().getAt(r),i=r.x,o=r.y;for(let c=0;c<s.size();c++){c in this.layers||(this.layers[c]=new x6t);const u=s.pieces[s.size()-1-c];this.layers[c].initialize(new M(i,o),u)}}this.ground=this.getGround(),this.computeViewBox(),this.remainingStacks=this.getState().remainingPieces.toListOfStacks(),this.canPass=Mi.get().shouldPass(this.getState());const e=Mi.get().getGameStatus(this.rules.node);switch(e){case xe.ONGOING:break;case xe.DRAW:this.highlight(this.getState().queenBeeLocation(z.ZERO).get(),"victory-stroke"),this.highlight(this.getState().queenBeeLocation(z.ONE).get(),"victory-stroke");break;default:const s=e.winner.getOpponent();this.highlight(this.getState().queenBeeLocation(s).get(),"victory-stroke")}this.rules.node.move.isPresent()&&this.showLastMove()}highlight(e,r){const s=this.getState().getAt(e).size();s-1 in this.layers&&this.layers[s-1].highlight(e,r)}pass(){var e=this;return A(function*(){return we.assert(e.canPass,"DvonnComponent: pass() can only be called if canPass is true"),yield e.chooseMove(Ei.PASS,e.getState())})()}computeViewBox(){const e=this.getPieceCoords().union(this.getAllNeighbors()).toList();e.push(new M(0,0)),this.boardViewBox=i6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH);const r=new i6(this.getRemainingPieceTransformAsCoord(new Xs(z.ZERO,"QueenBee")).x,0,4*this.SPACE_SIZE*5,0),s=5*this.SPACE_SIZE;let i=0;this.getState().remainingPieces.getAny(z.ZERO).isPresent()&&(i=s);let o=0;this.getState().remainingPieces.getAny(z.ONE).isPresent()&&(o=s);const c=this.boardViewBox.containingAtLeast(r).expand(0,0,i,o);if(this.inspectedStack.isPresent()){const u=new M(c.right()+this.SPACE_SIZE,c.center().y),h=this.inspectedStack.get().size();this.inspectedStackTransform=`translate(${u.x} ${u.y+3*(h-1)*this.PIECE_HEIGHT})`,this.viewBox=c.expand(0,5*this.SPACE_SIZE,0,0).toSVGString()}else this.viewBox=c.toSVGString()}getPieceCoords(){return this.getState().pieces.getKeySet()}getGround(){const e=new s3e;for(const r of this.getAllNeighbors())e.initialize(r);return e}getAllNeighbors(){const e=new Ht;for(const r of this.getPieceCoords())e.addAll(new Ht(this.getState().emptyNeighbors(r)));return e.isEmpty()&&e.add(new M(0,0)),e}clearHighlights(){for(const e of this.layers)e.clearHighlights();this.ground.clearHighlights()}cancelMoveAttempt(){this.clearHighlights(),this.selectedStart=P.empty(),this.selectedRemaining=P.empty(),this.selectedSpiderCoords=[],this.inspectedStack=P.empty(),this.rules.node.move.isPresent()&&this.showLastMove(),this.computeViewBox()}showLastMove(){for(const e of this.getLastMoveCoords())this.highlight(e,"last-move-stroke"),this.ground.highlightStroke(e,"last-move-stroke"),this.ground.highlightFill(e,"moved-fill")}getLastMoveCoords(){const e=this.rules.node.move.get();let r=[];e instanceof Ya?r=[e.coord]:e instanceof N2&&(r=[e.getStart(),e.getEnd()]);const s=this.getState().offset;return r.map(i=>i.getNext(s))}getRemainingPieceTransformAsCoord(e){const r=this.getRemainingPieceShift(e),s=this.boardViewBox.center().x+r*this.SPACE_SIZE*4;let i;return i=e.owner===this.role?this.boardViewBox.bottom()+3*this.SPACE_SIZE:this.boardViewBox.up-2*this.SPACE_SIZE,new M(s,i)}getRemainingPieceTransform(e){const r=this.getRemainingPieceTransformAsCoord(e);return`translate(${r.x} ${r.y})`}getRemainingPieceHighlightTransform(e){const r=this.getRemainingPieceTransformAsCoord(e),s=this.getState().remainingPieces.getQuantity(e);return`translate(${r.x} ${r.y-this.PIECE_HEIGHT*s})`}getRemainingPieceShift(e){switch(e.kind){case"QueenBee":return-2.5;case"Beetle":return-1.5;case"Grasshopper":return-.5;case"Spider":return.5;default:return we.expectToBe(e.kind,"SoldierAnt"),1.5}}selectRemaining(e){var r=this;return A(function*(){const s=r.canUserPlay(`#remainingPiece_${e.toString()}`);if(s.isFailure())return r.cancelMove(s.getReason());if(e.owner===r.getCurrentPlayer().getOpponent())return r.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE());if("QueenBee"!==e.kind&&Mi.get().mustPlaceQueenBee(r.getState()))return r.cancelMove(es.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN());if(r.selectedRemaining.equalsValue(e))r.cancelMoveAttempt();else{r.cancelMoveAttempt(),r.selectedRemaining=P.of(e),r.clearHighlights();const i=Mi.get().getPossibleDropLocations(r.getState()).toList();for(const o of i)r.ground.highlightStroke(o,"clickable-stroke")}return U.SUCCESS})()}selectStack(e,r){return this.select(new M(e,r),"piece")}selectSpace(e,r){return this.select(new M(e,r),"space")}select(e,r){var s=this;return A(function*(){const i=s.canUserPlay(`#${r}_${e.x}_${e.y}`);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState(),c=o.getAt(e);if(s.selectedRemaining.isPresent()){const u=Ei.drop(s.selectedRemaining.get(),e);return s.chooseMove(u,o)}if(s.selectedStart.isPresent()){const u=o.getAt(s.selectedStart.get()).topPiece();return s.selectedStart.equalsValue(e)?s.cancelMove():s.selectTarget(e,u)}return 0===c.size()?s.cancelMove():s.selectStart(e,c)})()}selectTarget(e,r){var s=this;return A(function*(){if("Spider"===r.kind)return s.selectNextSpiderSpace(e);{const i=Ei.move(s.selectedStart.get(),e);return ye(i.isSuccess(),"Hive: the only forbidden moves are static moves"),s.chooseMove(i.get(),s.getState())}})()}selectStart(e,r){var s=this;return A(function*(){const i=s.getState(),o=r.topPiece();return o.owner===i.getCurrentPlayer().getOpponent()?1===r.size()?s.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE()):s.inspectedStack.isPresent()?(s.cancelMoveAttempt(),s.clearHighlights(),U.SUCCESS):(s.highlight(e,"selected-stroke"),s.inspectedStack=P.of(r),s.inspectedStackCoord=P.of(e),s.computeViewBox(),U.SUCCESS):(s.cancelMoveAttempt(),s.clearHighlights(),"QueenBee"!==o.kind&&Mi.get().mustPlaceQueenBee(i)?s.cancelMove(es.MUST_PLACE_QUEEN_BEE_LATEST_AT_FOURTH_TURN()):(s.selectedStart=P.of(e),s.highlight(e,"selected-stroke"),"Spider"===o.kind&&s.selectedSpiderCoords.push(s.selectedStart.get()),r.size()>1&&(s.inspectedStack=P.of(r),s.inspectedStackCoord=P.of(e),s.computeViewBox()),s.highlightNextPossibleCoords(e),U.SUCCESS))})()}highlightNextPossibleCoords(e){for(const r of this.getNextPossibleCoords(e))this.highlight(r,"clickable-stroke"),this.ground.highlightStroke(r,"clickable-stroke")}getNextPossibleCoords(e){const r=this.getState(),s=r.getAt(e).topPiece(),i=Mi.get().getPossibleMovesFrom(r,e);return"Spider"===s.kind?i.filter(c=>Ke.isPrefix(this.selectedSpiderCoords,c.coords)).map(c=>c.coords[this.selectedSpiderCoords.length]).toList():i.map(o=>o.getEnd()).toList()}selectNextSpiderSpace(e){var r=this;return A(function*(){if(r.selectedSpiderCoords.push(e),4===r.selectedSpiderCoords.length){const i=Ei.spiderMove(r.selectedSpiderCoords);return r.chooseMove(i,r.getState())}const s=Hm.get().prefixLegality(r.selectedSpiderCoords,r.getState());if(s.isFailure())return r.cancelMove(s.getReason());r.clearHighlights(),r.highlight(r.selectedStart.get(),"selected-stroke");for(const i of r.selectedSpiderCoords)r.ground.select(i);return r.highlightNextPossibleCoords(r.selectedStart.get()),U.SUCCESS})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-hive"]],features:[l],decls:8,vars:8,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","remaining_highlight","class","base no-fill small-stroke selected-stroke",4,"ngIf"],[4,"ngIf"],[1,"base","mid-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke",3,"id","ngClass","click"],["class","base no-fill small-stroke","ngClass","selected-stroke",3,"id","click",4,"ngIf"],["ngClass","selected-stroke",1,"base","no-fill","small-stroke",3,"id","click"],["app-hive-piece","",3,"id","piece","x","y","pieceHeight","hexaLayout","layer","click"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","layer","hexaLayout","click"],["id","remaining_highlight",1,"base","no-fill","small-stroke","selected-stroke"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer",4,"ngFor","ngForOf"],["app-hive-piece","",3,"id","piece","pieceHeight","x","y","hexaLayout","layer"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,v6t,2,4,"g",1),x(2,y6t,2,1,"g",1),x(3,M6t,2,1,"g",1),x(4,w6t,3,2,"g",1),x(5,O6t,2,1,"g",1),x(6,N6t,1,2,"polygon",2),x(7,I6t,2,1,"g",3),O()),2&e&&(D("viewBox",r.viewBox),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.ground),S(1),T("ngForOf",r.layers),S(1),T("ngForOf",r.remainingStacks),S(1),T("ngIf",r.selectedRemaining.isPresent()),S(1),T("ngIf",r.inspectedStack.isPresent()))},dependencies:[mn,Ln,nn,_6t],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();const L6t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:11,INVADER:z.ZERO};class x3 extends mH{static getInitialState(){const t=hn.UNOCCUPIED,e=hn.INVADERS,r=hn.DEFENDERS;return new x3([[t,t,t,e,e,e,e,e,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,t,t,t,t,t,t,t,t],[e,t,t,t,t,r,t,t,t,t,e],[e,t,t,t,r,r,r,t,t,t,e],[e,e,t,r,r,hn.PLAYER_ONE_KING,r,r,t,e,e],[e,t,t,t,r,r,r,t,t,t,e],[e,t,t,t,t,r,t,t,t,t,e],[t,t,t,t,t,t,t,t,t,t,t],[t,t,t,t,t,e,t,t,t,t,t],[t,t,t,e,e,e,e,e,t,t,t]],0)}from(t,e){return new x3(t,e)}}class xo extends gH{static of(t,e){return new xo(t,e)}static from(t,e){try{const r=new xo(t,e);return $.success(r)}catch(r){return $.failure(r.message)}}getMaximalDistance(){return 11}}xo.encoder=I4.getEncoder(xo.from);class y5 extends _H{constructor(){super(x3,L6t,xo.of)}static get(){return null==y5.singleton&&(y5.singleton=new y5),B1.ruler=this.singleton,y5.singleton}}const R=hn.UNOCCUPIED,Zt=hn.INVADERS,ts=hn.DEFENDERS,PP=hn.PLAYER_ONE_KING;class i3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Hnefatafl is a strategy game that was played by the vikings, it's part of a larger family of games called Tafl. The goal of the game is different for each player. The attacker plays first. Their pieces (dark) are close to the edges. Their goal is to capture the king, which is in the center of the board. The defender plays second. Their pieces (light) are in the middle. Their goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,x3.getInitialState()),ce.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,x3.getInitialState(),xo.of(new M(5,1),new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new x3([[R,R,R,R,Zt,Zt,Zt,Zt,R,R,R],[R,R,R,R,R,Zt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[Zt,R,R,R,R,ts,R,R,R,R,Zt],[Zt,R,R,Zt,ts,ts,ts,R,R,R,Zt],[Zt,Zt,R,ts,ts,PP,ts,ts,R,Zt,Zt],[Zt,R,R,R,ts,ts,ts,R,R,R,Zt],[Zt,R,R,R,R,ts,R,R,R,R,Zt],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,Zt,R,R,R,R,R],[R,R,R,Zt,Zt,Zt,Zt,Zt,R,R,R]],1),[xo.of(new M(5,3),new M(3,3))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`).withPreviousMove(xo.of(new M(3,0),new M(3,4))).withPreviousState(x3.getInitialState()),ce.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new x3([[R,R,R,Zt,Zt,Zt,Zt,Zt,R,R,R],[R,ts,R,R,R,Zt,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,ts,R,R,R,R,Zt],[Zt,R,R,R,R,ts,ts,R,R,R,Zt],[Zt,Zt,PP,R,ts,R,ts,ts,R,R,Zt],[R,R,Zt,R,R,ts,ts,R,R,R,Zt],[Zt,R,R,R,R,ts,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,Zt,R,R,R,R,R,R,R,R,R],[R,R,R,Zt,Zt,Zt,Zt,R,Zt,R,R]],12),[xo.of(new M(3,0),new M(3,5)),xo.of(new M(3,10),new M(3,5))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ce.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new x3([[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,Zt,R,R,R,R,R,R,R,R,R],[Zt,PP,R,Zt,R,R,R,R,R,R,R],[R,Zt,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[xo.of(new M(3,4),new M(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ce.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new x3([[R,R,Zt,PP,Zt,R,R,R,R,R,R],[R,R,R,R,R,R,ts,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,Zt,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R],[R,R,R,R,R,R,R,R,R,R,R]],72),[xo.of(new M(3,3),new M(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function R6t(n,t){1&n&&(B(),X(0,"polygon",8))}function D6t(n,t){1&n&&(B(),X(0,"rect",9))}function z6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,R6t,1,0,"polygon",6),x(2,D6t,1,0,"ng-template",null,7,c1),O()),2&n){const e=t1(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function V6t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function H6t(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function F6t(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function B6t(n,t){if(1&n&&(B(),x(0,H6t,1,1,"polyline",14),x(1,F6t,4,20,"ng-template",null,15,c1)),2&n){const e=t1(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function $6t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",10),x(2,V6t,6,25,"g",11),x(3,B6t,3,2,"ng-template",null,12,c1),O()),2&n){const e=t1(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function U6t(n,t){if(1&n){const e=Oe();B(),b(0,"g",3),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),X(1,"rect",4),x(2,z6t,4,2,"g",5),x(3,$6t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function G6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,U6t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function W6t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",17),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let q6t=(()=>{class n extends vH{constructor(e){super(e,!1,xo.from),this.rules=y5.get(),this.availableMinimaxes=[new fP(this.rules,"DummyBot"),new dP(this.rules,"Piece > Influence"),new w3(this.rules,"Piece > Control"),new _9(this.rules,"Escape > Piece > Control")],this.encoder=xo.encoder,this.tutorial=(new i3e).tutorial}ngOnInit(){this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-hnefatafl"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,G6t,2,1,"g",1),x(2,W6t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Mn{constructor(t,e,r){this.value=t,this.name=e,this.rgb=r}static of(t){switch(t){case 0:return Mn.ANY;case 1:return Mn.ORANGE;case 2:return Mn.BLUE;case 3:return Mn.PURPLE;case 4:return Mn.PINK;case 5:return Mn.YELLOW;case 6:return Mn.RED;case 7:return Mn.GREEN;default:return we.expectToBe(t,8,"Invalid value "+t+" for KamisadoColor"),Mn.BROWN}}}Mn.ANY=new Mn(0,"any","#000"),Mn.ORANGE=new Mn(1,"orange","#d67421"),Mn.BLUE=new Mn(2,"blue","#006bac"),Mn.PURPLE=new Mn(3,"purple","#6f3787"),Mn.PINK=new Mn(4,"pink","#d2719e"),Mn.YELLOW=new Mn(5,"yellow","#e2c200"),Mn.RED=new Mn(6,"red","#d23339"),Mn.GREEN=new Mn(7,"green","#009157"),Mn.BROWN=new Mn(8,"brown","#562500");class Hn{constructor(t,e){this.player=t,this.color=e}static of(t,e){return new Hn(t,Mn.of(e))}static createPlayerColors(t){return{ORANGE:new Hn(t,Mn.ORANGE),BLUE:new Hn(t,Mn.BLUE),PURPLE:new Hn(t,Mn.PURPLE),PINK:new Hn(t,Mn.PINK),YELLOW:new Hn(t,Mn.YELLOW),RED:new Hn(t,Mn.RED),GREEN:new Hn(t,Mn.GREEN),BROWN:new Hn(t,Mn.BROWN)}}equals(t){return t.player===this.player&&t.color===this.color}isEmpty(){return this.player.equals(pe.NONE)}belongsTo(t){return this.player===t}}Hn.EMPTY=new Hn(pe.NONE,Mn.ANY),Hn.ZERO=Hn.createPlayerColors(z.ZERO),Hn.ONE=Hn.createPlayerColors(z.ONE);class Si{static getColorAt(t,e){return Si.COLORS[e][t]}static getInitialBoard(){const t=Hn.EMPTY;return[[1,2,3,4,5,6,7,8].map(e=>Hn.of(z.ONE,e)),[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[t,t,t,t,t,t,t,t],[8,7,6,5,4,3,2,1].map(e=>Hn.of(z.ZERO,e))]}static isEmptyAt(t,e){return t[e.y][e.x].equals(Hn.EMPTY)}static allPieceCoords(t){const e=[];for(let r=0;r<t.length;r++)for(let s=0;s<t[r].length;s++){const i=new M(s,r);Si.isEmptyAt(t,i)||e.push(i)}return e}}Si.INITIAL=Si.getInitialBoard(),Si.SIZE=8,Si.COLORS=Ke.mapBiArray([[1,2,3,4,5,6,7,8],[6,1,4,7,2,5,8,3],[7,4,1,6,3,8,5,2],[4,3,2,1,8,7,6,5],[5,6,7,8,1,2,3,4],[2,5,8,3,6,1,4,7],[3,8,5,2,7,4,1,6],[8,7,6,5,4,3,2,1]],Mn.of);class wH extends $i{constructor(){super()}isPieceMove(){return!1}length(){return 0}equals(t){return this===t}toString(){return"KamisadoMove(PASS)"}}wH.PASS=new wH;class bH extends X0{constructor(t,e){super(t,e)}static of(t,e){if(t.isNotInRange(Si.SIZE,Si.SIZE))throw new Error("Starting coord of KamisadoMove must be on the board, not at "+t.toString());if(e.isNotInRange(Si.SIZE,Si.SIZE))throw new Error("End coord of KamisadoMove must be on the board, not at "+e.toString());return new bH(t,e)}isPieceMove(){return!0}equals(t){return t===this||!!t.isPieceMove()&&!1!==t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"KamisadoMove("+this.getStart()+"->"+this.getEnd()+")"}}var ko;!function(n){n.PASS=wH.PASS,n.of=function t(e,r){return bH.of(e,r)},n.encoder=new class extends Cn{maxValue(){return 34952}encodeNumber(e){return e.isPieceMove()?4096*e.getStart().x+256*e.getStart().y+16*e.getEnd().x+e.getEnd().y:0}decodeNumber(e){if(0===e)return n.PASS;const r=e%16,s=(e=e/16|0)%16,i=(e=e/16|0)%16;return n.of(new M((e=e/16|0)%16,i),new M(s,r))}}}(ko||(ko={}));class k3 extends ps{constructor(t,e,r,s,i){super(Ke.copyBiArray(i),t),this.colorToPlay=e,this.coordToPlay=r,this.alreadyPassed=s}static getInitialState(){return new k3(0,Mn.ANY,P.empty(),!1,Si.INITIAL)}}let $m=(()=>{class n{}return n.NOT_RIGHT_COLOR=()=>$localize`This piece is not of the color you have to play.`,n.DIRECTION_NOT_ALLOWED=()=>$localize`You can only move forward, orthogonally or diagonally.`,n.MOVE_BLOCKED=()=>$localize`This move is blocked by another piece.`,n.PLAY_WITH_SELECTED_PIECE=()=>$localize`You must play with the selected piece.`,n})();class Lo extends Z1{static getColorMatchingPiece(t){return t.coordToPlay.isPresent()?[t.coordToPlay.get()]:[new M(0,7),new M(1,7),new M(2,7),new M(3,7),new M(4,7),new M(5,7),new M(6,7),new M(7,7)]}static getMovablePieces(t){return Lo.getColorMatchingPiece(t).filter(e=>{for(const r of this.playerDirections(t.getCurrentPlayer())){const s=e.getNext(r);if(t.isOnBoard(s)&&Si.isEmptyAt(t.board,s))return!0}return!1})}static playerDirections(t){return t===z.ONE?[be.DOWN,be.DOWN_LEFT,be.DOWN_RIGHT]:[be.UP,be.UP_LEFT,be.UP_RIGHT]}static directionAllowedForPlayer(t,e){return e===z.ZERO?t.y<0:t.y>0}static getListMovesFromState(t){const e=Lo.getMovablePieces(t);return 0===e.length?(ye(!1===t.alreadyPassed,"getListMovesFromState should not be called once game is ended."),[ko.PASS]):Lo.getListMovesFromNonBlockedState(t,e)}static getListMovesFromNonBlockedState(t,e){const r=[],s=t.getCurrentPlayer();for(const i of e)for(const o of Lo.playerDirections(s))for(let c=1;c<Si.SIZE;c++){const u=i.getNext(o,c);if(!t.isOnBoard(u)||!Si.isEmptyAt(t.board,u))break;{const h=ko.of(i,u);r.push(h)}}return r}static mustPass(t){return 0===this.getMovablePieces(t).length}static getFurthestPiecePositions(t){let e=7,r=0;return Si.allPieceCoords(t.board).forEach(s=>{const i=t.getPieceAt(s);ye(i!==Hn.EMPTY,"allPieceCoords failed to filter KamisadoPiece.EMPTY"),i.player===z.ONE?r=Math.max(r,s.y):e=Math.min(e,s.y)}),[e,r]}static isLegal(t,e){if(t.isPieceMove()){const r=t.getStart(),s=t.getEnd(),i=e.colorToPlay,o=e.getPieceAt(r);if(!o.belongsTo(e.getCurrentPlayer()))return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE());if(i!==Mn.ANY&&o.color!==i)return $.failure($m.NOT_RIGHT_COLOR());if(!e.getPieceAt(s).isEmpty())return $.failure(rt.MUST_CLICK_ON_EMPTY_SPACE());const u=be.factory.fromMove(r,s);if(u.isFailure())return $.failure($m.DIRECTION_NOT_ALLOWED());const h=u.get();if(!Lo.directionAllowedForPlayer(h,e.getCurrentPlayer()))return $.failure($m.DIRECTION_NOT_ALLOWED());let p=r;for(;!p.equals(s);)if(p=p.getNext(h),!e.getPieceAt(p).isEmpty())return $.failure($m.MOVE_BLOCKED());return $.success(void 0)}return this.isLegalPass(e)}static isLegalPass(t){return this.mustPass(t)&&!t.alreadyPassed?$.success(void 0):$.failure(rt.CANNOT_PASS())}nextCoordToPlay(t,e){return P.ofNullable(Si.allPieceCoords(t.board).find(r=>{const s=t.getPieceAt(r);return s.player===t.getCurrentOpponent()&&s.color===e}))}applyLegalMove(t,e,r){if(t.isPieceMove()){const s=t.getStart(),i=t.getEnd(),o=e.getCopiedBoard();o[i.y][i.x]=o[s.y][s.x],o[s.y][s.x]=Hn.EMPTY;const c=Si.getColorAt(i.x,i.y),u=this.nextCoordToPlay(e,c);return new k3(e.turn+1,c,u,!1,o)}{const s=this.nextCoordToPlay(e,e.colorToPlay);return new k3(e.turn+1,e.colorToPlay,s,!0,e.board)}}isLegal(t,e){return Lo.isLegal(t,e)}getGameStatus(t){const e=t.gameState,r=e.getCurrentPlayer();if(Lo.mustPass(e)&&e.alreadyPassed)return xe.getDefeat(r);const[s,i]=Lo.getFurthestPiecePositions(e);return 7===i?xe.ONE_WON:0===s?xe.ZERO_WON:xe.ONGOING}}class j6t extends $1{getListMoves(t){const e=Lo.getListMovesFromState(t.gameState);return Ke.sortByDescending(e,r=>r.length()),e}getBoardValue(t){const e=t.gameState,r=e.getCurrentPlayer();if(Lo.mustPass(e)&&e.alreadyPassed)return new Ct(r.getDefeatValue());const[s,i]=Lo.getFurthestPiecePositions(e);return new Ct(7===i?z.ONE.getVictoryValue():0===s?z.ZERO.getVictoryValue():i-(7-s))}}const ie=Hn.EMPTY,TP=Hn.ZERO.ORANGE,wP=Hn.ONE.ORANGE,bP=Hn.ZERO.BLUE,OP=Hn.ONE.BLUE,OH=Hn.ZERO.PURPLE,Um=Hn.ONE.PURPLE,NP=Hn.ZERO.PINK,AP=Hn.ONE.PINK,IP=Hn.ZERO.YELLOW,xP=Hn.ONE.YELLOW,kP=Hn.ZERO.RED,LP=Hn.ONE.RED,RP=Hn.ZERO.GREEN,DP=Hn.ONE.GREEN,zP=Hn.ZERO.BROWN,VP=Hn.ONE.BROWN;class o3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Kamisado, there are two ways to win the game:
        either by moving one of your pieces on the opponent's starting line,
        or by forcing the opponent to make a move that blocks the entire game.
        Here, Dark wins because its brown piece is on Light's starting line, on the top left.`,new k3(5,Mn.ORANGE,P.empty(),!1,[[zP,OP,Um,AP,xP,LP,DP,VP],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,wP,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,RP,kP,IP,NP,OH,bP,TP]])).withPreviousMove(ko.of(new M(0,7),new M(0,0))),ce.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
        At Kamisado, pieces can only move forward, vertically or diagonally.
        You're playing first, with dark pieces, you can make your first move.<br/><br/>
        You're playing Dark, click on the piece of your choice and click on a landing square.`,k3.getInitialState(),ko.of(new M(7,7),new M(3,3)),$localize`Perfect! Note that each of your piece has a different color.`),ce.fromMove($localize`Moving`,$localize`Let us now consider the move of Light, after the blue piece has been moved by Dark.
        All moves after the initial move must be made from the piece that corresponds to the color
        of the square upon which the last move ended.
        Here, the last move ended on the pink square, hence the pink piece must move.
        It is already selected, you do not have to click on it.<br/><br/>
        You're playing Light, move your piece on a blue square.`,new k3(1,Mn.PINK,P.of(new M(3,0)),!1,[[wP,OP,Um,AP,xP,LP,DP,VP],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,bP,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[zP,RP,kP,IP,NP,OH,ie,TP]]),[ko.of(new M(3,0),new M(3,6)),ko.of(new M(3,0),new M(4,1))],$localize`Congratulations!`,$localize`You have not moved your pink piece on a blue square!`).withPreviousMove(ko.of(new M(6,7),new M(6,5))),ce.informational($localize`Stuck situation`,$localize`Dark moved to another pink square, hence you have to move your pink piece again.
        However, your pink piece is stuck! In this case, you must pass your turn.
        Dark will now have to play by moving its pink piece.`,new k3(1,Mn.PINK,P.of(new M(3,6)),!1,[[wP,OP,Um,ie,xP,LP,DP,VP],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,ie,bP],[ie,ie,ie,ie,ie,ie,ie,ie],[ie,ie,ie,AP,ie,ie,ie,ie],[zP,RP,kP,IP,NP,OH,ie,TP]])).withPreviousMove(ko.of(new M(6,5),new M(7,4))),ce.fromMove($localize`Victory by blocking`,$localize`At any time, if a player blocks the entire game, that player loses.
        In other words, if a player forces its opponent to move a piece that the opponent cannot move,
        and the player cannot move its own piece of the same color, then that player loses.
        Here, you're playing Dark and you can force your opponent to create such a situation, hence you can force your opponent to lose!<br/><br/>
        You're playing Dark, analyze the board and make the winning move.`,new k3(2,Mn.RED,P.of(new M(2,4)),!1,[[ie,OP,Um,ie,ie,LP,ie,ie],[ie,ie,ie,xP,ie,ie,ie,ie],[ie,ie,ie,AP,ie,Um,ie,ie],[ie,ie,ie,IP,ie,ie,ie,ie],[ie,ie,kP,ie,ie,ie,ie,ie],[ie,ie,ie,ie,ie,ie,DP,ie],[wP,ie,ie,ie,ie,NP,ie,VP],[zP,RP,ie,ie,ie,ie,bP,TP]]),[ko.of(new M(2,4),new M(0,2))],$localize`Perfect!
         Your opponent must move its green piece on the orange square, forcing you to play with your orange piece.
         Your orange piece will be stuck and you will have to pass your turn.
         Your opponent will have to pass its turn too because its orange piece is also stuck: the game is completely stuck.
         In this case, the last player to have moved a piece loses.
         Here, your opponent will have moved its green piece last, you therefore win!`,$localize`Failed. Try again.`).withPreviousMove(ko.of(new M(4,0),new M(3,1)))]}}function Z6t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=v(),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.piecePlayerClass(r)),D("cx",o.SPACE_SIZE/2+s*o.SPACE_SIZE)("cy",o.SPACE_SIZE/2+i*o.SPACE_SIZE)("r",o.SPACE_SIZE/2-o.STROKE_WIDTH)}}function Y6t(n,t){if(1&n&&(B(),X(0,"rect",9)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();D("x",o.SPACE_SIZE/2+r*o.SPACE_SIZE-o.SPACE_SIZE/8)("y",o.SPACE_SIZE/2+i*o.SPACE_SIZE-o.SPACE_SIZE/8)("rx",o.isPlayerZero(s)?o.SPACE_SIZE:0)("ry",o.isPlayerZero(s)?o.SPACE_SIZE:0)("width",o.SPACE_SIZE/4)("height",o.SPACE_SIZE/4)("fill",o.pieceColor(s))}}function K6t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"g",4),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),X(2,"rect",5),x(3,Z6t,1,4,"circle",6),x(4,Y6t,1,7,"rect",7),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),S(1),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE)("fill",i.backgroundColor(r,s)),S(1),T("ngIf",e!==i.UNOCCUPIED),S(1),T("ngIf",e!==i.UNOCCUPIED)}}function X6t(n,t){if(1&n&&(B(),b(0,"g"),x(1,K6t,5,9,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Q6t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"rect",10)(2,"rect",10),O()),2&n){const e=v();S(1),D("x",e.lastPieceMove.get().getStart().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getStart().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE),S(1),D("x",e.lastPieceMove.get().getEnd().x*e.SPACE_SIZE)("y",e.lastPieceMove.get().getEnd().y*e.SPACE_SIZE)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function J6t(n,t){if(1&n&&(B(),X(0,"circle",11)),2&n){const e=v();D("cx",e.SPACE_SIZE/2+e.chosen.get().x*e.SPACE_SIZE)("cy",e.SPACE_SIZE/2+e.chosen.get().y*e.SPACE_SIZE)("r",e.SPACE_SIZE/2-e.STROKE_WIDTH)}}let e0t=(()=>{class n extends No{constructor(e){super(e),this.UNOCCUPIED=Hn.EMPTY,this.lastMove=P.empty(),this.lastPieceMove=P.empty(),this.chosen=P.empty(),this.chosenAutomatically=!1,this.hasAsymetricBoard=!0,this.rules=new Lo(k3),this.availableMinimaxes=[new j6t(this.rules,"KamisadoMinimax")],this.encoder=ko.encoder,this.tutorial=(new o3e).tutorial,this.canPass=!1,this.updateBoard()}backgroundColor(e,r){return Si.getColorAt(e,r).rgb}isPlayerZero(e){return e.player===z.ZERO}pieceColor(e){return e.color.rgb}piecePlayerClass(e){return this.getPlayerClass(e.player)}updateBoard(){const e=this.getState();if(this.board=e.getCopiedBoard(),this.lastMove=this.rules.node.move,this.lastPieceMove=P.empty(),this.lastMove.isPresent()){const s=this.lastMove.get();s.isPieceMove()&&(this.lastPieceMove=P.of(s))}this.canPass=Lo.mustPass(e);const r=this.rules.getGameStatus(this.rules.node)!==xe.ONGOING;this.canPass||e.coordToPlay.isAbsent()||r?(this.chosenAutomatically=!1,this.chosen=P.empty()):(this.chosenAutomatically=!0,this.chosen=e.coordToPlay)}pass(){var e=this;return A(function*(){return ye(e.canPass,"KamisadoComponent: pass() must be called only if canPass is true"),e.chooseMove(ko.PASS,e.getState())})()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);if(s.canPass)return s.cancelMove(rt.MUST_PASS());if(s.chosen.isAbsent())return s.choosePiece(e,r);if(!1===s.chosenAutomatically&&s.chosen.equalsValue(o))return s.cancelMoveAttempt(),U.SUCCESS;{const c=s.getState().getPieceAtXY(e,r),u=s.getState().getCurrentPlayer();return c.belongsTo(u)?s.chosenAutomatically?s.cancelMove($m.PLAY_WITH_SELECTED_PIECE()):(s.chosen=P.of(o),U.SUCCESS):yield s.chooseDestination(e,r)}})()}choosePiece(e,r){const s=this.getState().getPieceAtXY(e,r),i=this.getState().getCurrentOpponent();return s.belongsTo(i)?this.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosen=P.of(new M(e,r)),U.SUCCESS)}chooseDestination(e,r){var s=this;return A(function*(){const i=s.chosen.get(),o=new M(e,r),c=ko.of(i,o);return s.chooseMove(c,s.getState())})()}cancelMoveAttempt(){this.chosenAutomatically||(this.chosen=P.empty())}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-kamisado"]],features:[l],decls:4,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf"],["id","selectedPiece","class","base mid-stroke no-fill selected-stroke",4,"ngIf"],[3,"id","click"],["fill-opacity","0.7",1,"base-no-fill"],["class","base-no-fill",3,"ngClass",4,"ngIf"],["class","no-stroke",4,"ngIf"],[1,"base-no-fill",3,"ngClass"],[1,"no-stroke"],[1,"base","no-fill","mid-stroke","last-move-stroke"],["id","selectedPiece",1,"base","mid-stroke","no-fill","selected-stroke"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,X6t,2,1,"g",1),x(2,Q6t,3,8,"g",2),x(3,J6t,1,3,"circle",3),O()),2&e&&(D("viewBox",r.getViewBox())("transform",r.rotation),S(1),T("ngForOf",r.board),S(1),T("ngIf",r.lastPieceMove.isPresent()),S(1),T("ngIf",r.chosen.isPresent()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),a3e=(()=>{class n extends No{getParallelogramCoords(e){const r=e.parallelogramHeight,s=r*e.horizontalWidthRatio,i=r*e.offsetRatio,o=s,u=s-i,h=r,p=-i,m=r;return[new M(0,0),new M(o,0),new M(u,h),new M(p,m)]}getCoordTranslate(e,r,s,i){const o=i.parallelogramHeight;return new M(e*(o*i.horizontalWidthRatio)+i.offsetRatio*o*(i.abstractBoardSize-r),r*o-i.pieceHeightRatio*o*s)}}return n.\u0275fac=function(){let t;return function(r){return(t||(t=Dr(n)))(r||n)}}(),n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],features:[l],decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})(),o6=(()=>{class n{}return n.CANNOT_GO_BACKWARD=()=>$localize`You cannot go backward with normal pieces!`,n.CANNOT_CAPTURE_EMPTY_SPACE=()=>$localize`You cannot capture an empty square, nor jump over it!`,n.CANNOT_SKIP_CAPTURE=()=>$localize`You must capture when it is possible!`,n.MUST_FINISH_CAPTURING=()=>$localize`You must finish this capture!`,n.THIS_PIECE_CANNOT_MOVE=()=>$localize`This piece cannot move!`,n.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL=()=>$localize`A capture should be a double diagonal step. Look at the green indicators to help you!`,n.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL=()=>$localize`You must move in a single diagonal step!`,n.CANNOT_CAPTURE_TWICE_THE_SAME_COORD=()=>$localize`You cannot jump over the same square several times!`,n})();class xs{constructor(t,e){this.player=t,this.isOfficer=e}static getPlayerOfficer(t){return t===z.ZERO?xs.ZERO_OFFICER:xs.ONE_OFFICER}toString(){switch(this){case xs.ZERO:return"u";case xs.ONE:return"v";case xs.ZERO_OFFICER:return"O";default:return we.expectToBe(this,xs.ONE_OFFICER),"X"}}equals(t){return this===t}}xs.ZERO=new xs(z.ZERO,!1),xs.ONE=new xs(z.ONE,!1),xs.ZERO_OFFICER=new xs(z.ZERO,!0),xs.ONE_OFFICER=new xs(z.ONE,!0);class Ro{constructor(t){this.pieces=t}isEmpty(){return 0===this.pieces.length}isCommandedBy(t){return!this.isEmpty()&&this.getCommander().player===t}getCommander(){return this.pieces[0]}getPiecesUnderCommander(){return new Ro(this.pieces.slice(1))}capturePiece(t){return new Ro(this.pieces.concat(t))}addStackBelow(t){let e=this;for(const r of t.pieces)e=e.capturePiece(r);return e}getStackSize(){return this.pieces.length}promoteCommander(){let t=this.getCommander();if(t.isOfficer)return this;{t=xs.getPlayerOfficer(t.player);const e=this.getPiecesUnderCommander();return new Ro([t]).addStackBelow(e)}}get(t){return this.pieces[t]}toString(t){let e=t-this.getStackSize(),r="";for(;e>0;)r+="_",e--;for(const s of this.pieces)r+=s.toString();return r}}Ro.EMPTY=new Ro([]);let or=(()=>{class n extends ps{static getInitialState(){const e=new Ro([xs.ZERO]),r=new Ro([xs.ONE]),s=Ro.EMPTY;return new n([[r,s,r,s,r,s,r],[s,r,s,r,s,r,s],[r,s,r,s,r,s,r],[s,s,s,s,s,s,s],[e,s,e,s,e,s,e],[s,e,s,e,s,e,s],[e,s,e,s,e,s,e]],0)}static from(e,r){return new n(e,r)}static isNotOnBoard(e){return e.isNotInRange(n.SIZE,n.SIZE)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}getStacksOf(e){const r=[];for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++)this.getPieceAtXY(i,s).isCommandedBy(e)&&r.push(new M(i,s));return r}set(e,r){const s=this.getCopiedBoard();return s[e.y][e.x]=r,new n(s,this.turn)}remove(e){return this.set(e,Ro.EMPTY)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}getFinishLineOf(e){return e===z.ZERO?0:n.SIZE-1}toString(){let e=1;for(let s=0;s<n.SIZE;s++)for(let i=0;i<n.SIZE;i++){const o=this.getPieceAtXY(i,s).getStackSize();e=Math.max(e,o)}const r=[];for(let s=0;s<n.SIZE;s++){const i=[];for(let o=0;o<n.SIZE;o++)i.push(this.getPieceAtXY(o,s).toString(e));r.push(i.join(" "))}return r.join("\n")}}return n.SIZE=7,n})();class t0t extends Ht{equals(t){if(t.size()!==this.size())return!1;for(let e=0;e<this.size();e++)if(!1===Fa(t.get(e),this.get(e)))return!1;return!0}get(t){return we.assert(t<this.values.length,"MGPUniqueList: index out of bounds: "+t),this.values[t]}getFromEnd(t){return we.assert(t<this.values.length,"MGPUniqueList: index (from end) out of bounds: "+t),this.get(this.values.length-1-t)}}class Qs extends $i{constructor(t,e){super(),this.isStep=e,this.coords=new t0t(t)}static fromCapture(t){const e=Qs.getSteppedOverCoords(t);return e.isSuccess()?$.success(new Qs(t,!1)):$.failure(e.getReason())}static getSteppedOverCoords(t){let e=P.empty();const r=new Ht;for(const s of t){if(or.isNotOnBoard(s))return $.failure(dH.OUT_OF_RANGE(s));if(e.isPresent()){const i=e.get();if(!1===i.getVectorToward(s).isDiagonalOfLength(2))return $.failure(o6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL());const c=i.getCoordsToward(s)[0];if(r.contains(c))return $.failure(o6.CANNOT_CAPTURE_TWICE_THE_SAME_COORD());r.add(c)}e=P.of(s)}return $.success(r)}static fromStep(t,e){return or.isNotOnBoard(t)?$.failure(dH.OUT_OF_RANGE(t)):or.isNotOnBoard(e)?$.failure(dH.OUT_OF_RANGE(e)):!1===t.getVectorToward(e).isDiagonalOfLength(1)?$.failure(o6.MOVE_STEPS_MUST_BE_SINGLE_DIAGONAL()):$.success(new Qs([t,e],!0))}toString(){return"LascaMove("+this.coords.toList().map(r=>r.toString()).join(", ")+")"}getRelation(t){const e=this.coords.size(),r=t.coords.size(),s=Math.min(e,r);for(let i=0;i<s;i++)if(!1===this.coords.toList()[i].equals(t.coords.toList()[i]))return"INEQUALITY";return e===r?"EQUALITY":"PREFIX"}equals(t){return"EQUALITY"===this.getRelation(t)}isPrefix(t){return"PREFIX"===this.getRelation(t)}getStartingCoord(){return this.coords.get(0)}getEndingCoord(){return this.coords.getFromEnd(0)}getCapturedCoords(){return Qs.getSteppedOverCoords(this.coords.toList())}concatenate(t){const e=this.getEndingCoord(),r=t.coords.toList()[0];ye(e.equals(r),"should not concatenate non-touching move");const s=this.coords.toList(),i=Ke.copyImmutableArray(s),o=t.coords.toList(),c=Ke.copyImmutableArray(o).slice(1);return Qs.fromCapture(i.concat(c)).get()}}Qs.encoder=new class extends M2{encodeMove(n){return{coords:n.coords.toList().map(t=>M.encoder.encode(t)),isStep:n.isStep}}decodeMove(n){const t=n;ye(null!=t.coords,"Encoded LascaMove should have a coords field"),ye(null!=t.isStep,"Encoded LascaMove should have a isStep field");const r=we.getNonNullable(t.coords).map(s=>M.encoder.decode(s));return new Qs(r,t.isStep)}};class R4 extends Z1{static get(){return this.singleton.isAbsent()&&(this.singleton=P.of(new R4(or))),this.singleton.get()}getCaptures(t){const e=t.getCurrentPlayer();return this.getCapturesOf(t,e)}getCapturesOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceCaptures(t,i));return r}getPieceCaptures(t,e){let r=[];const o=t.getPieceAt(e).getCommander().player.getOpponent(),c=this.getPieceDirections(t,e),u=t.getPieceAt(e);for(const h of c){const p=e.getNext(h,1);if(or.isOnBoard(p)&&t.getPieceAt(p).isCommandedBy(o)){const m=p.getNext(h,1);if(or.isOnBoard(m)&&t.getPieceAt(m).isEmpty()){const C=t.remove(e).remove(p).set(m,u),w=Qs.fromCapture([e,m]).get(),I=this.getPieceCaptures(C,m);if(0===I.length)r=r.concat(w);else{const H=I.map(Y=>w.concatenate(Y));r=r.concat(H)}}}}return r}getPieceDirections(t,e){const i=t.getPieceAt(e).getCommander().player.getScoreModifier(),o=[be.factory.fromDelta(-1,i).get(),be.factory.fromDelta(1,i).get()];return t.getPieceAt(e).getCommander().isOfficer&&o.push(be.factory.fromDelta(-1,-i).get(),be.factory.fromDelta(1,-i).get()),o}getSteps(t){const e=t.getCurrentPlayer();return this.getStepsOf(t,e)}getStepsOf(t,e){const r=[],s=t.getStacksOf(e);for(const i of s)r.push(...this.getPieceSteps(t,i));return r}getPieceSteps(t,e){const r=[],s=this.getPieceDirections(t,e);for(const i of s){const o=e.getNext(i,1);if(or.isOnBoard(o)&&t.getPieceAt(o).isEmpty()){const c=Qs.fromStep(e,o).get();r.push(c)}}return r}applyLegalMove(t,e){const r=t.getStartingCoord(),s=t.getEndingCoord();let i=e.getPieceAt(r),o=e.remove(r);if(!1===t.isStep)for(const c of t.getCapturedCoords().get()){const u=e.getPieceAt(c),h=u.getCommander();i=i.capturePiece(h);const p=u.getPiecesUnderCommander();o=o.set(c,p)}if(o=o.set(s,i),s.y===e.getFinishLineOf(e.getCurrentPlayer())){const c=i.promoteCommander();o=o.set(s,c)}return o.incrementTurn()}isLegal(t,e){const r=t.getStartingCoord();if(e.getPieceAt(r).isEmpty())return $.failure(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());const s=e.getPieceAt(r),i=e.getCurrentOpponent();if(s.isCommandedBy(i))return $.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE());const o=t.coords.get(1);if(!1===s.getCommander().isOfficer&&r.getDirectionToward(o).get().y===i.getScoreModifier())return $.failure(o6.CANNOT_GO_BACKWARD());if(!1===e.getPieceAt(o).isEmpty())return $.failure(rt.MUST_LAND_ON_EMPTY_SPACE());const c=this.getCaptures(e);return t.isStep?c.length>0?$.failure(o6.CANNOT_SKIP_CAPTURE()):$.success(void 0):this.isLegalCapture(t,e,c)}isLegalCapture(t,e,r){const s=e.getCurrentPlayer(),i=t.getCapturedCoords().get();for(const o of i){const c=e.getPieceAt(o);if(c.isCommandedBy(s))return $.failure(rt.CANNOT_SELF_CAPTURE());if(c.isEmpty())return $.failure(o6.CANNOT_CAPTURE_EMPTY_SPACE())}return r.some(o=>o.equals(t))?$.success(void 0):$.failure(o6.MUST_FINISH_CAPTURING())}getGameStatus(t){const e=t.gameState;return this.getCaptures(e).length>0||this.getSteps(e).length>0?xe.ONGOING:xe.getVictory(e.getCurrentOpponent())}}R4.singleton=P.empty();class Gm extends $1{constructor(t){super(R4.get(),t)}static getListMoves(t){const e=R4.get().getCaptures(t.gameState);return e.length>0?e:R4.get().getSteps(t.gameState)}getListMoves(t){return Gm.getListMoves(t)}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=t.gameState,s=this.getNumberOfMobileCoords(r,z.ZERO),i=this.getNumberOfMobileCoords(r,z.ONE);return Ct.from(s,i)}getNumberOfMobileCoords(t,e){const s=this.getCapturesAndSteps(t,e).map(o=>o.getStartingCoord());return new Ht(s).size()}getCapturesAndSteps(t,e){const r=R4.get().getCapturesOf(t,e),s=R4.get().getStepsOf(t,e);return r.concat(s)}}class n0t extends Gm{constructor(){super("Lasca Control And Domination Minimax")}getBoardValue(t){const e=this.ruler.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();const r=12*super.getBoardValue(t).value;let s=0;for(let i=0;i<or.SIZE;i++)for(let o=0;o<or.SIZE;o++){const c=t.gameState.getPieceAtXY(o,i);if(c.getStackSize()>0){const u=c.getStackSize();let h=0;const p=c.getCommander().player;for(;h<u&&c.get(h).player===p;)h++;s+=h*p.getScoreModifier()}}return new Ct(r+s)}}const c3e=xs.ZERO,NH=xs.ONE,ks=new Ro([c3e]),Cr=new Ro([NH]),r0t=new Ro([c3e,NH]),s0t=new Ro([xs.ZERO_OFFICER,NH]),re=Ro.EMPTY;class l3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Lasca: origins`,$localize`Lasca is a game based on draughts created in 1911 by Emanuel Lasker, chess world champion. It's played on a 7x7 board, each player has 11 pieces.`,or.getInitialState()),ce.informational($localize`Goal of the game`,$localize`The goal of Lasca is, like for draughts, to render the opponent unable to move, either by capturing all his pieces, either by blocking them.`,or.getInitialState()),ce.anyMove($localize`Steps`,$localize`A simple step is made by one diagonal move forward, left or right. Click on the chosen piece, then on its landing square.<br/><br/>You are playing Dark, do the first move.`,or.getInitialState(),Qs.fromStep(new M(4,4),new M(3,3)).get(),$localize`Congratulations!`),ce.anyMove($localize`Capture`,$localize`A capture happens when you jump diagonally over an opponent piece to land right behind it. You have to capture when you can. It is the case here, so click on the piece that must capture, and then on its landing square.<br/><br/>You're playing Dark, go ahead.`,or.from([[Cr,re,re,re,Cr,re,Cr],[re,re,re,Cr,re,Cr,re],[re,re,Cr,re,Cr,re,Cr],[re,Cr,re,re,re,re,re],[ks,re,ks,re,ks,re,ks],[re,ks,re,ks,re,ks,re],[ks,re,ks,re,ks,re,ks]],2),Qs.fromCapture([new M(2,4),new M(0,2)]).get(),$localize`Congratulations, notice that the captured piece was not removed from the board, but put below the capturing pieces.`),ce.anyMove($localize`Multiple captures`,$localize`If, after the beginning of your capture, the piece that you just moved can capture another piece, it has to capture until it can no longer capture. To do so, you must then click again on the next landing square. Note that, you cannot jump twice over the same stack.<br/><br/>You are playing Dark, a double capture is possible, go ahead.`,or.from([[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[Cr,re,re,re,Cr,re,Cr],[re,Cr,re,Cr,re,Cr,re],[re,re,Cr,re,Cr,re,Cr],[re,Cr,re,re,re,re,re],[re,re,ks,re,ks,re,ks]],2),Qs.fromCapture([new M(2,6),new M(0,4),new M(2,2)]).get(),$localize`Congratulations!`),ce.informational($localize`Minority capture is allowed`,$localize`If you have several capture choices, you are allowed to choose any of them. For example if one choice is to capture one piece, and the other choice is to capture two pieces, you can choose either.`,or.from([[re,re,re,re,re,re,re],[re,re,re,re,re,Cr,re],[re,re,re,re,re,re,re],[re,Cr,re,Cr,re,re,re],[re,re,ks,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re]],2)),ce.fromMove($localize`Promotion`,$localize`When a stack reaches the last line, its commander becomes an officer, and gains the ability to go backward, which is illegal for the other pieces! One of your piece could be promoted now.<br/><br/>You're playing Dark. Do it.`,or.from([[re,re,re,re,re,re,Cr],[re,re,re,r0t,re,Cr,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,ks,re,ks,re,ks]],2),[Qs.fromStep(new M(3,1),new M(2,0)).get(),Qs.fromStep(new M(3,1),new M(4,0)).get()],$localize`Congratulations!`,$localize`You did not choose the correct stack, and got no promotion.`),ce.fromMove($localize`Officer move`,$localize`Officers can move and capture backward as well as forward.<br/><br/>You're playing Dark, move your officier!`,or.from([[re,re,re,re,s0t,re,Cr],[re,re,re,re,re,re,re],[re,re,re,re,Cr,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,re,re,re,re,re],[re,re,ks,re,ks,re,ks]],2),[Qs.fromStep(new M(4,0),new M(3,1)).get(),Qs.fromStep(new M(4,0),new M(5,1)).get()],$localize`Congratulations!`,$localize`You did not move your officer.`)]}}function i0t(n,t){if(1&n&&(B(),X(0,"circle",13)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v().index,c=v();G2("id","square_",i,"_",o,"_piece_",r,"_officer_symbol"),T("ngClass",s.classes),D("cx",.4*c.SPACE_SIZE)("cy",.575*c.SPACE_SIZE)("r",.045*c.SPACE_SIZE)}}function o0t(n,t){if(1&n&&(B(),b(0,"g",10),X(1,"use",11),x(2,i0t,1,7,"circle",12),O()),2&n){const e=t.$implicit,r=t.index,s=v().index,i=v().index;D("transform",v().getPieceTranslate(r)),S(1),G2("id","square_",s,"_",i,"_piece_",r,""),T("ngClass",e.classes),S(1),T("ngIf",e.isOfficer)}}function a0t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"g",7),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),X(2,"polygon",8),x(3,o0t,3,6,"g",9),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","coord_",r,"_",s,""),D("transform",i.getTranslate(r,s,0)),S(1),We("id","square_",r,"_",s,""),T("ngClass",e.squareClasses),D("points",i.getParallelogramPoints()),S(1),T("ngForOf",e.pieceInfos)}}function c0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,a0t,4,8,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let l0t=(()=>{class n extends a3e{constructor(e){super(e),this.THICKNESS=40,this.mode={horizontalWidthRatio:1.2,offsetRatio:.4,pieceHeightRatio:1,parallelogramHeight:100,abstractBoardSize:or.SIZE},this.LEFT=0,this.UP=-this.SPACE_SIZE,this.basicWidth=this.mode.abstractBoardSize*this.mode.parallelogramHeight,this.WIDTH=this.basicWidth*(this.mode.horizontalWidthRatio+this.mode.offsetRatio),this.HEIGHT=this.basicWidth+this.THICKNESS+this.STROKE_WIDTH-this.UP,this.CX=this.WIDTH/2,this.CY=(this.HEIGHT+this.UP)/2,this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]},this.lastMove=P.empty(),this.currentMoveClicks=[],this.capturedCoords=[],this.legalMoves=[],this.hasAsymetricBoard=!0,this.rules=R4.get(),this.availableMinimaxes=[new Gm("Lasca Control Minimax"),new n0t],this.encoder=Qs.encoder,this.tutorial=(new l3e).tutorial,this.canPass=!1,this.updateBoard()}updateBoard(){this.lastMove=this.rules.node.move;const e=this.getState();this.board=e.getCopiedBoard(),this.legalMoves=Gm.getListMoves(this.rules.node),this.createAdaptedBoardFrom(e),this.showLastMove(),this.rotateAdaptedBoardIfNeeded()}createAdaptedBoardFrom(e){this.adaptedBoard={isAlreadySwitched:!1,spaceInfo:[]};for(let i=0;i<or.SIZE;i++){const o=[];for(let c=0;c<or.SIZE;c++){const u=this.getSpaceInfo(e,c,i);o.push(u)}this.adaptedBoard.spaceInfo.push(o)}const s=P.ofNullable(this.currentMoveClicks[this.currentMoveClicks.length-1]);if(s.isPresent()){const i=s.get();for(const o of this.adaptedBoard.spaceInfo[i.y][i.x].pieceInfos)o.classes.push("selected-stroke");this.showPossibleLandings(i,e)}for(const i of this.capturedCoords)this.getSpaceInfoAt(i).squareClasses.push("captured-fill");for(const i of this.currentMoveClicks)this.getSpaceInfoAt(i).squareClasses.push("moved-fill")}getSpaceInfo(e,r,s){const i=e.getPieceAtXY(r,s),o=[];for(let c=i.getStackSize()-1;c>=0;c--){const u=i.get(c);o.push({classes:[this.getPlayerClass(u.player)],isOfficer:u.isOfficer})}return{pieceInfos:o,squareClasses:[]}}showLastMove(){this.lastMove.isPresent()&&(this.showLastCapture(),this.showSteppedOnCoord()),this.showPossibleMoves()}showLastCapture(){if(!1===this.lastMove.get().isStep){const e=this.lastMove.get().getCapturedCoords();we.assert(e.isSuccess(),"Last move is a capture yet has illegal jumps !?");for(const r of e.get())this.adaptedBoard.spaceInfo[r.y][r.x].squareClasses.push("captured-fill")}}showSteppedOnCoord(){const e=this.lastMove.get();for(const r of e.coords)this.getSpaceInfoAt(r).squareClasses.push("moved-fill")}showPossibleMoves(){for(const e of this.legalMoves){const r=e.getStartingCoord();this.getSpaceInfoAt(r).squareClasses.push("selectable-fill")}}getSpaceInfoAt(e){if(this.role===z.ONE&&this.adaptedBoard.isAlreadySwitched){const r=or.SIZE-1,s=new M(r-e.x,r-e.y);return this.adaptedBoard.spaceInfo[s.y][s.x]}return this.adaptedBoard.spaceInfo[e.y][e.x]}rotateAdaptedBoardIfNeeded(){if(this.role===z.ONE){const e=[];for(let r=0;r<or.SIZE;r++){e[or.SIZE-1-r]=[];for(let s=0;s<or.SIZE;s++)e[or.SIZE-1-r][or.SIZE-1-s]=this.adaptedBoard.spaceInfo[r][s]}this.adaptedBoard={isAlreadySwitched:!0,spaceInfo:e}}}hideLastMove(){this.createAdaptedBoardFrom(this.getState()),this.rotateAdaptedBoardIfNeeded()}onClick(e,r){var s=this;return A(function*(){s.role===z.ONE&&(e=or.SIZE-1-e,r=or.SIZE-1-r);const i=s.canUserPlay("#coord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r),c=s.getState().getPieceAt(o),u=s.getState().getCurrentOpponent();return c.isCommandedBy(u)?s.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):0===s.currentMoveClicks.length?s.trySelectingPiece(o):s.moveClick(o)})()}cancelMoveAttempt(){this.currentMoveClicks=[],this.capturedCoords=[],this.createAdaptedBoardFrom(this.getState()),this.showLastMove(),this.rotateAdaptedBoardIfNeeded()}moveClick(e){var r=this;return A(function*(){if(e.equals(r.currentMoveClicks[0]))return r.cancelMoveAttempt(),U.SUCCESS;const s=r.getState().getPieceAt(e),i=r.getState().getCurrentPlayer();if(s.isCommandedBy(i))return r.cancelMoveAttempt(),r.trySelectingPiece(e);if(1===r.currentMoveClicks.length&&r.currentMoveClicks[0].getVectorToward(e).isDiagonalOfLength(1)){const c=Qs.fromStep(r.currentMoveClicks[0],e).get();return r.chooseMove(c,r.getState())}return r.capture(e)})()}capture(e){var r=this;return A(function*(){const i=r.currentMoveClicks[r.currentMoveClicks.length-1],o=i.getVectorToward(e);if(o.isDiagonalOfLength(2)){const c=new M(i.x+o.x/2,i.y+o.y/2);r.capturedCoords.push(c),r.currentMoveClicks.push(e);const u=Qs.fromCapture(r.currentMoveClicks).get();return r.legalMoves.some(h=>h.isPrefix(u))?r.applyPartialCapture():r.chooseMove(u,r.getState())}return r.cancelMove(o6.CAPTURE_STEPS_MUST_BE_DOUBLE_DIAGONAL())})()}applyPartialCapture(){let e=this.getState().remove(this.currentMoveClicks[0]),r=this.getState().getPieceAt(this.currentMoveClicks[0]);for(const i of this.capturedCoords){const o=this.getState().getPieceAt(i),c=o.getCommander(),u=o.getPiecesUnderCommander();e=e.set(i,u),r=r.capturePiece(c)}return e=e.set(this.currentMoveClicks[this.currentMoveClicks.length-1],r),this.createAdaptedBoardFrom(e),this.rotateAdaptedBoardIfNeeded(),U.SUCCESS}trySelectingPiece(e){var r=this;return A(function*(){return r.getState().getPieceAt(e).isEmpty()?r.cancelMove(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY()):r.selectPiece(e)})()}selectPiece(e){return this.capturedCoords=[],this.legalMoves.some(r=>r.getStartingCoord().equals(e))?(this.currentMoveClicks=[e],this.hideLastMove(),U.SUCCESS):this.cancelMove(o6.THIS_PIECE_CANNOT_MOVE())}showPossibleLandings(e,r){const s=this.rules.getPieceCaptures(r,e);if(0===s.length){const i=this.rules.getPieceSteps(r,e);for(const o of i){const c=o.getEndingCoord().y,u=o.getEndingCoord().x;this.adaptedBoard.spaceInfo[c][u].squareClasses.push("selectable-fill")}}else{const i=s.map(o=>o.coords.get(1));for(const o of i)this.adaptedBoard.spaceInfo[o.y][o.x].squareClasses.push("capturable-fill")}}getTranslate(e,r,s){const i=this.getCoordTranslate(e,r,s,this.mode);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForLasca().map(r=>r.x+", "+r.y).join(" ")}getParallelogramCoordsForLasca(){return this.getParallelogramCoords(this.mode)}getParallelogramCenter(){const e=this.getParallelogramCoordsForLasca();return this.getParallelogramCenterOf(e[0],e[1],e[2],e[3])}getParallelogramCenterOf(e,r,s,i){const o=Math.max(e.x,r.x,s.x,i.x),c=Math.max(e.y,r.y,s.y,i.y),u=Math.min(e.x,r.x,s.x,i.x),h=Math.min(e.y,r.y,s.y,i.y);return new M((o-u)/2,(c-h)/2)}getRightEdge(){const e=this.basicWidth*this.mode.horizontalWidthRatio,r=this.basicWidth*this.mode.offsetRatio;return[r+e,0,r+e,this.THICKNESS,e,this.basicWidth+this.THICKNESS,e,this.basicWidth].join(" ")}getPieceTranslate(e){return"translate(0 "+(this.getParallelogramCenter().y-32.5-e*(.15*this.SPACE_SIZE))+")"}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-lasca"]],features:[l],decls:8,vars:6,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","piece"],["d","M 0 25 v 15 a 40 25, 0, 0, 0, 80 0 v -15 a 40 25, 0, 0, 0, -80 0 Z"],["cx","40","cy","25","rx","40","ry","25"],[4,"ngFor","ngForOf"],["x","0",1,"base"],[1,"base"],[3,"id","click"],[1,"base",3,"id","ngClass"],["pointer-events","fill","class","base mid-small-stroke",4,"ngFor","ngForOf"],["pointer-events","fill",1,"base","mid-small-stroke"],[0,"xlink","href","#piece",1,"base","mid-stroke",3,"id","ngClass"],[3,"id","ngClass",4,"ngIf"],[3,"id","ngClass"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs")(2,"g",1),X(3,"path",2)(4,"ellipse",3),O()(),x(5,c0t,2,1,"g",4),X(6,"rect",5)(7,"polygon",6),O()),2&e&&(D("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),S(5),T("ngForOf",r.adaptedBoard.spaceInfo),S(1),D("y",r.basicWidth)("width",r.basicWidth*r.mode.horizontalWidthRatio)("height",r.THICKNESS),S(1),D("points",r.getRightEdge()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Js=(()=>{class n extends ps{static getInitialState(){const e=pe.NONE,r=pe.ZERO,s=pe.ONE;return new n([[e,r,r,r,r,r,r,e],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[s,e,e,e,e,e,e,s],[e,r,r,r,r,r,r,e]],0)}static isOnBoard(e){return e.isInRange(n.SIZE,n.SIZE)}}return n.SIZE=8,n})();class Ui extends X0{constructor(t,e,r){super(t,e),this.direction=r,this.direction=be.factory.fromMove(t,e).get()}static from(t,e){const r=be.factory.fromMove(t,e);return r.isFailure()?$.failure(r.getReason()):t.isNotInRange(Js.SIZE,Js.SIZE)?$.failure("start coord is not in range"):e.isNotInRange(Js.SIZE,Js.SIZE)?$.failure("end coord is not in range"):$.success(new Ui(t,e,r.get()))}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"LinesOfActionMove("+this.getStart()+"->"+this.getEnd()+")"}encode(){return Ui.encoder.encode(this)}decode(t){return Ui.encoder.decode(t)}}Ui.encoder=I4.getEncoder(Ui.from);let AH=(()=>{class n{}return n.INVALID_MOVE_LENGTH=()=>$localize`Your move should have a length equal to the number of pieces that exist on the same line.`,n.CANNOT_JUMP_OVER_OPPONENT=()=>$localize`You cannot jump over the opponent's pieces.`,n.PIECE_CANNOT_MOVE=()=>$localize`This piece has no possible move, select another one.`,n})();class J2 extends Z1{static getListMovesFromState(t){const e=[];if(J2.getVictory(t).isPresent())return e;for(let r=0;r<Js.SIZE;r++)for(let s=0;s<Js.SIZE;s++){const i=new M(s,r);if(t.getPieceAt(i).isPlayer())for(const c of J2.possibleTargets(t,i)){const u=Ui.from(i,c).get();e.push(u)}}return e}static getNumberOfGroups(t){const e=Ke.createTable(Js.SIZE,Js.SIZE,-1),r=[0,0];let s=0;for(let i=0;i<Js.SIZE;i++)for(let o=0;o<Js.SIZE;o++)if(-1===e[i][o]){const c=t.getPieceAt(new M(o,i));c.isPlayer()&&(s+=1,J2.markGroupStartingAt(t,e,new M(o,i),s),r[c.value]+=1)}return r}static markGroupStartingAt(t,e,r,s){const i=[r],o=t.getPieceAt(r);for(;i.length>0;){const c=we.getNonNullable(i.pop());if(-1===e[c.y][c.x]){const u=t.getPieceAt(c);if(u===o){e[c.y][c.x]=s;for(const h of be.DIRECTIONS){const p=c.getNext(h);t.isOnBoard(p)&&i.push(p)}}else u===pe.NONE&&(e[c.y][c.x]=0)}}}applyLegalMove(t,e,r){const s=e.getCopiedBoard();return s[t.getStart().y][t.getStart().x]=pe.NONE,s[t.getEnd().y][t.getEnd().x]=e.getCurrentPlayer(),new Js(s,e.turn+1)}static isLegal(t,e){return e.getPieceAt(t.getStart())!==e.getCurrentPlayer()?$.failure(rt.MUST_CHOOSE_PLAYER_PIECE()):t.length()!==this.numberOfPiecesOnLine(e,t.getStart(),t.direction)?$.failure(AH.INVALID_MOVE_LENGTH()):t.getStart().getCoordsToward(t.getEnd()).some(r=>e.getPieceAt(r)===e.getCurrentOpponent())?$.failure(AH.CANNOT_JUMP_OVER_OPPONENT()):e.getPieceAt(t.getEnd())===e.getCurrentPlayer()?$.failure(rt.SHOULD_LAND_ON_EMPTY_OR_OPPONENT_SPACE()):$.success(void 0)}isLegal(t,e){return J2.isLegal(t,e)}static numberOfPiecesOnLine(t,e,r){let s=0;for(const i of J2.getLineCoords(e,r))t.getPieceAt(i).isPlayer()&&(s+=1);return s}static getLineCoords(t,e){const r=J2.getEntranceAndForwardDirection(t,e);let s=r[0];const i=r[1],o=[];for(;Js.isOnBoard(s);)o.push(s),s=s.getNext(i);return o}static getEntranceAndForwardDirection(t,e){switch(e){case be.UP:case be.DOWN:return[new M(t.x,0),be.DOWN];case be.LEFT:case be.RIGHT:return[new M(0,t.y),be.RIGHT];case be.UP_RIGHT:case be.DOWN_LEFT:return[new M(Math.max(0,t.x+t.y-7),Math.min(7,t.x+t.y)),be.UP_RIGHT];default:return we.expectToBeMultiple(e,[be.UP_LEFT,be.DOWN_RIGHT]),[new M(t.x-Math.min(t.x,t.y),t.y-Math.min(t.x,t.y)),be.DOWN_RIGHT]}}static getVictory(t){const[e,r]=J2.getNumberOfGroups(t);return 1===e&&1===r?P.of(pe.NONE):1===e?P.of(z.ZERO):1===r?P.of(z.ONE):P.empty()}static possibleTargets(t,e){const r=[];for(const s of be.DIRECTIONS){const i=J2.numberOfPiecesOnLine(t,e,s),o=e.getNext(s,i);if(t.isOnBoard(o)){const c=Ui.from(e,o).get();J2.isLegal(c,t).isSuccess()&&r.push(o)}}return r}getGameStatus(t){const e=t.gameState,[r,s]=J2.getNumberOfGroups(e);return 1===r&&s>1?xe.ZERO_WON:r>1&&1===s?xe.ONE_WON:xe.ONGOING}}class u0t extends $1{getListMoves(t){return J2.getListMovesFromState(t.gameState)}getBoardValue(t){const e=t.gameState,[r,s]=J2.getNumberOfGroups(e);return 1===r&&s>1?new Ct(z.ZERO.getVictoryValue()):r>1&&1===s?new Ct(z.ONE.getVictoryValue()):Ct.from(100/r,100/s)}}const j=pe.NONE,hr=pe.ZERO,ar=pe.ONE;class u3e{constructor(){this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Lines of Actions, the goal is to group your pieces contiguously, orthogonally and/or diagonally.
        Here, Dark wins the game:
        Dark's pieces are forming a single group, while Light's pieces form three groups.`,new Js([[j,j,j,j,j,j,j,j],[ar,j,j,j,hr,j,j,ar],[j,j,hr,hr,ar,j,j,j],[j,j,j,hr,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j]],0)),ce.anyMove($localize`Initial board and initial move`,$localize`Here is the initial board.
         Moves can be made orthogonally or diagonally.
         The length of a move is equal to the number of pieces that are on the line of the move.
         Note that there is a helping indicator to let you know where a piece can land when you select it.<br/><br/>
         You're playing Dark, make the first move!`,Js.getInitialState(),Ui.from(new M(1,7),new M(1,5)).get(),$localize`Congratulations!`),ce.fromMove($localize`Jumping`,$localize`During a move, it is possible to jump above your own pieces.
        But it is forbidden to jump over the opponent's pieces.<br/><br/>
        You're playing Dark, make a jump over one of your pieces on the following board.`,new Js([[j,j,j,j,j,j,j,j],[j,j,ar,hr,hr,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,ar],[j,j,j,j,j,j,j,hr]],0),[Ui.from(new M(3,1),new M(6,1)).get()],$localize`Congratulations!`,$localize`Failed. You did not jump over one of your pieces.`),ce.fromMove($localize`Moving`,$localize`Here is a different board. Pick the dark piece in the middle (line 4, column 4)
        and observe its possible moves.
        <ul>
            <li>Horizontally, this piece can move only of one square because it is the only piece on this line.</li>
            <li>Vertically, this piece can move of three squares because there are in total three pieces on that vertical line.
                But it can only go up, as below it the landing square is occupied by one of your pieces.</li>
            <li>Diagonally, only one move is possible: on the diagonal that contains three pieces,
                only in the direction where it does not jump over one of the opponent's pieces.
                On the other diagonal, there are too many pieces to end the move on the board.</li>
        </ul><br/>
        You're playing Dark, make one of these moves.`,new Js([[j,j,j,j,j,j,ar,j],[j,j,j,j,j,hr,j,j],[j,j,j,j,ar,j,j,j],[j,j,j,hr,j,j,j,j],[j,j,j,j,j,j,j,ar],[j,j,j,j,j,ar,j,ar],[j,j,j,hr,j,j,ar,ar],[j,j,j,hr,j,j,j,j]],0),[Ui.from(new M(3,3),new M(3,0)).get(),Ui.from(new M(3,3),new M(0,0)).get(),Ui.from(new M(3,3),new M(2,3)).get(),Ui.from(new M(3,3),new M(4,3)).get()],$localize`Congratulations!`,$localize`Failed. This was not one of the expected moves.`),ce.fromPredicate($localize`Capturing`,$localize`If a move ends on an opponent's piece, it is captured and removed from the board.
        However, a move cannot end on one of the player's pieces.
        Watch out, having less pieces at Lines of Action makes a victory easier, as there are less pieces to regroup!
        If a player has only one piece, that player wins the game.<br/><br/>
        On the following board, try to capture one piece with Dark.`,new Js([[j,hr,j,hr,hr,hr,hr,j],[ar,j,j,j,j,j,j,ar],[j,j,hr,j,ar,j,j,j],[ar,j,j,j,j,j,j,ar],[ar,j,j,j,j,j,j,ar],[ar,j,j,j,j,j,j,ar],[ar,j,j,j,j,j,j,ar],[j,hr,hr,hr,hr,hr,hr,j]],0),Ui.from(new M(2,2),new M(4,2)).get(),(t,e,r)=>e.getPieceAt(t.getEnd())===pe.ONE?U.SUCCESS:U.failure($localize`Failed. Try again.`),$localize`Congratulations!`),ce.fromMove($localize`Tie`,$localize`In the special case where a move ends up connecting all pieces of both player, simultaneously,
        then the game ends up with a tie.<br/><br/>
        You're playing Dark, force the tie in one move.`,new Js([[j,j,j,j,j,j,j,j],[j,j,j,j,j,j,j,j],[hr,j,j,hr,ar,hr,j,j],[j,j,j,hr,j,j,j,ar],[j,j,j,j,j,j,j,ar],[j,j,j,j,j,j,j,ar],[j,j,j,j,j,j,j,ar],[j,j,j,j,j,j,j,j]],0),[Ui.from(new M(0,2),new M(4,2)).get()],$localize`Congratulations!`,$localize`Failed. Try again.`)]}}function f0t(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=v().index,r=v().index,s=v();We("id","piece_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("cx",s.SPACE_SIZE/2+e*s.SPACE_SIZE)("cy",s.SPACE_SIZE/2+r*s.SPACE_SIZE)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function h0t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"g",3),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),X(2,"rect",4),x(3,f0t,1,6,"circle",5),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","click_",r,"_",s,""),S(1),T("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function d0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,h0t,4,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function p0t(n,t){if(1&n){const e=Oe();B(),b(0,"rect",7),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i.x,i.y))}),O()}if(2&n){const e=t.$implicit,r=v();D("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}let g0t=(()=>{class n extends No{constructor(e){super(e),this.INDICATOR_SIZE=20,this.EMPTY=pe.NONE,this.targets=[],this.selected=P.empty(),this.lastMove=P.empty(),this.captured=P.empty(),this.rules=new J2(Js),this.availableMinimaxes=[new u0t(this.rules,"LinesOfActionMinimax")],this.encoder=Ui.encoder,this.tutorial=(new u3e).tutorial,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);if(s.selected.equalsValue(o))return s.cancelMoveAttempt(),U.SUCCESS;const c=s.getState().getCurrentPlayer();return s.selected.isAbsent()||s.getState().getPieceAt(o)===c?s.select(o):s.concludeMove(o)})()}concludeMove(e){var r=this;return A(function*(){const s=Ui.from(r.selected.get(),e);return s.isSuccess()?r.chooseMove(s.get(),r.rules.node.gameState):r.cancelMove(s.getReason())})()}select(e){var r=this;return A(function*(){return r.getState().getPieceAt(e)!==r.getState().getCurrentPlayer()?r.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE()):(r.selected=P.of(e),r.targets=J2.possibleTargets(r.getState(),r.selected.get()),0===r.targets.length?r.cancelMove(AH.PIECE_CANNOT_MOVE()):U.SUCCESS)})()}updateBoard(){if(this.cancelMoveAttempt(),this.board=this.getState().board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const e=this.lastMove.get();this.captured=this.getPreviousState().getPieceAt(e.getEnd()).isPlayer()?P.of(e.getEnd()):P.empty()}}cancelMoveAttempt(){this.selected=P.empty(),this.targets=[]}getSquareClasses(e,r){const s=new M(e,r);if(this.lastMove.isPresent()){const i=this.lastMove.get().getStart(),o=this.lastMove.get().getEnd();if(this.captured.isPresent()&&s.equals(this.captured.get()))return["captured-fill"];if(s.equals(i)||s.equals(o))return["moved-fill"]}return[]}getPieceClasses(e,r){const s=this.board[r][e],i=new M(e,r),o=[this.getPlayerClass(s)];return this.selected.isPresent()&&this.selected.get().equals(i)&&o.push("selected-stroke"),o}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-linesofaction"]],features:[l],decls:3,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -4 800 808","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","indicator",3,"click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"indicator",3,"click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,d0t,2,1,"g",1),x(2,p0t,1,4,"rect",2),O()),2&e&&(S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.targets))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class D4 extends S3{constructor(t,e,r,s={top:0,bottom:0,left:0,right:0}){super(t.x,t.y),this.direction=e,this.orientation=r,this.captures=s}toString(){return`LodestoneMove(${this.coord.toString()}, ${this.direction}, ${this.orientation}, { top: ${this.captures.top}, bottom: ${this.captures.bottom}, left: ${this.captures.left}, right: ${this.captures.right} })`}equals(t){return this===t||!(!1===this.coord.equals(t.coord)||this.orientation!==t.orientation||this.direction!==t.direction||this.captures.top!==t.captures.top||this.captures.bottom!==t.captures.bottom||this.captures.left!==t.captures.left||this.captures.right!==t.captures.right)}}D4.encoder=new class extends M2{encodeMove(n){return{coord:M.encoder.encode(n.coord),direction:n.direction,orientation:n.orientation,captures:n.captures}}decodeMove(n){const t=n;return ye(null!=t.coord,"Invalid encoded LodestoneMove"),ye(null!=t.direction,"Invalid encoded LodestoneMove"),ye(null!=t.orientation,"Invalid encoded LodestoneMove"),ye(null!=t.captures,"Invalid encoded LodestoneMove"),new D4(M.encoder.decode(t.coord),t.direction,t.orientation,t.captures)}};class eo{constructor(t){this.unreachable=t}isLodestone(){return!1}isPlayerPiece(){return!1}isEmpty(){return!0}isUnreachable(){return this.unreachable}equals(t){return this===t}}eo.UNREACHABLE=new eo(!0),eo.EMPTY=new eo(!1);class Dc{constructor(t){this.owner=t}static of(t){return t===z.ZERO?Dc.ZERO:Dc.ONE}isLodestone(){return!1}isPlayerPiece(){return!0}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Dc.ZERO=new Dc(z.ZERO),Dc.ONE=new Dc(z.ONE);class Do{constructor(t,e,r){this.owner=t,this.direction=e,this.orientation=r}static of(t,e){return Do.LODESTONES[t.value][e.direction][e.orientation]}isLodestone(){return!0}isPlayerPiece(){return!1}isEmpty(){return!1}isUnreachable(){return!1}equals(t){return this===t}}Do.LODESTONES={0:{push:{diagonal:new Do(z.ZERO,"push","diagonal"),orthogonal:new Do(z.ZERO,"push","orthogonal")},pull:{diagonal:new Do(z.ZERO,"pull","diagonal"),orthogonal:new Do(z.ZERO,"pull","orthogonal")}},1:{push:{diagonal:new Do(z.ONE,"push","diagonal"),orthogonal:new Do(z.ONE,"push","orthogonal")},pull:{diagonal:new Do(z.ONE,"pull","diagonal"),orthogonal:new Do(z.ONE,"pull","orthogonal")}}};class yr{constructor(t,e){this.width=t,this.pieces=e}remainingSpaces(){return 5===this.width?8-this.pieces.length:3-this.pieces.length}addCaptured(t,e){if(this.pieces.length+e>=this.width)return 5===this.width?yr.EMPTY_3.addCaptured(t,e+this.pieces.length-5):(ye(this.pieces.length+e===3,"should never put more pieces than the plate can support"),P.empty());{const r=Ke.copyImmutableArray(this.pieces);for(let s=0;s<e;s++)r.push(Dc.of(t));return P.of(new yr(this.width,r))}}getPieceAt(t){return t<this.pieces.length?this.pieces[t]:eo.EMPTY}}yr.POSITIONS=["top","bottom","left","right"],yr.EMPTY_5=new yr(5,[]),yr.EMPTY_3=new yr(3,[]);let cr=(()=>{class n extends ps{constructor(e,r,s,i){super(e,r),this.lodestones=s,this.pressurePlates=i}static getInitialState(){const e=eo.EMPTY,r=Dc.ZERO,s=Dc.ONE;return new n([[e,e,r,s,r,s,e,e],[e,r,s,r,s,r,s,e],[r,s,r,s,r,s,r,s],[s,r,s,e,e,r,s,r],[r,s,r,e,e,s,r,s],[s,r,s,r,s,r,s,r],[e,s,r,s,r,s,r,e],[e,e,s,r,s,r,e,e]],0,new zn,{top:P.of(yr.EMPTY_5),bottom:P.of(yr.EMPTY_5),left:P.of(yr.EMPTY_5),right:P.of(yr.EMPTY_5)})}withBoard(e){return new n(e,this.turn,this.lodestones,this.pressurePlates)}remainingSpaces(){const e=this.remainingSpacesDetails();return e.top+e.bottom+e.left+e.right}remainingSpacesDetails(){const e={top:0,bottom:0,left:0,right:0};for(const r of yr.POSITIONS){const s=this.pressurePlates[r];s.isPresent()&&(e[r]=s.get().remainingSpaces())}return e}numberOfPieces(){const e=[0,0];for(let r=0;r<n.SIZE;r++)for(let s=0;s<n.SIZE;s++){const i=this.getPieceAtXY(s,r);i.isPlayerPiece()&&(e[i.owner.value]+=1)}return e}getScores(){const e=this.numberOfPieces();return[24-e[1],24-e[0]]}nextLodestoneDirection(){const e=this.getCurrentPlayer(),r=this.lodestones.get(e);if(!r.isPresent())return P.empty();{const s=this.getPieceAt(r.get());switch(ye(s.isLodestone(),"Piece must be lodestone (invariant from LodestoneState)"+r.get()),s.direction){case"push":return P.of("pull");case"pull":return P.of("push")}}}}return n.SIZE=8,n})();const Ge=eo.UNREACHABLE,ue=eo.EMPTY,gs=Dc.ZERO,to=Dc.ONE,Wm=Do.of(z.ONE,{direction:"push",orientation:"orthogonal"}),IH={top:P.of(yr.EMPTY_5),bottom:P.of(yr.EMPTY_5),left:P.of(yr.EMPTY_5),right:P.of(yr.EMPTY_5)};class f3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Board and aim of the game`,$localize`Lodestone is played on a 8x8 board, which contains so-called <i>pressure plates</i> along the board, that will contain captured pieces. The initial board is shown here. The aim of the game is to be the only player with pieces remaining on the board. To do so, you will have to either push your opponent's pieces off the board, or to crush them with your pieces. You will do it by using a lodestone.`,cr.getInitialState()),ce.forClick($localize`Selecting a lodestone`,$localize`To perform a move, you have to place your lodestone on the board. Your lodestone has two sides: <ul><li>its <i>repelling</i> side with which it will repel the opponent's pieces (indicated by the outward triangles of your opponent's color on the lodestone), and</li><li>its <i>attracting</i> side with which it will attract your pieces (indicated by the inward triangles of your color on the lodestone).</li></ul>Your lodestone can be placed to move pieces orthogonally or diagonally. All available lodestone sides and orientation are shown below the board.<br/><br/>You're playing Dark. Select the lodestone that repels your opponent's pieces diagonally.`,cr.getInitialState(),["#lodestone_push_diagonal"],$localize`Congratulations!`,$localize`This is not the right lodestone, try again.`),ce.informational($localize`The repelling lodestone`,$localize`Upon placing a lodestone on the board, it will move all pieces it acts upon (according to its direction and orientation) simultaneously. Let us first see how the repelling lodestone acts on the pieces. All the opponent's pieces aligned with the lodestone, as indicated by the triangles' orientations, will be pushed one square away from the lodestone. An opponent's piece will be blocked in case it encounters on its way either one of your piece, a lodestone, or another blocked piece. Finally, if an opponent's piece falls out of the board, it is captured.`,cr.getInitialState()),ce.informational($localize`The attracting lodestone`,$localize`When the lodestone is on its attracting side it will pull your pieces one square towards it. In case one of your pieces encounters a lodestone on its way or another blocked piece, it is blocked. However, if it encounter an opponent's piece, it will capture it.`,cr.getInitialState()),ce.informational($localize`Flipping the lodestone`,$localize`Note that, after every move, you must flip your lodestone: if it was on its repelling side, you must use it on its attracting side, and vice versa. Also, you are allowed to place your lodestone on the same location as it was on your previous turn.`,cr.getInitialState()),ce.fromPredicate($localize`Capturing`,$localize`To summarize, it is possible to capture the opponent's pieces in two ways:<ul><li>with a repelling lodestone, by pushing your opponent's pieces out of the board, or</li><li>with an attracting lodestone, by moving your pieces on your opponent's pieces.</li></ul>Once a lodestone is placed and the pieces have been moved and/or captured, in case any of the opponent's pieces have been captured, you have to place them on the <i>pressure plates</i> that lie around the board. To do so, click on an empty space of the pressure plate of your choice for each capture. You can cancel this by clicking again on a piece you just put on a pressure plate.<br/><br/>You're playing Dark. Try to perform a move that captures at least one of your opponent's piece, and place your capture(s) on pressure plates.`,cr.getInitialState(),new D4(new M(0,6),"pull","orthogonal",{top:2,bottom:1,left:1,right:1}),(t,e,r)=>32===r.remainingSpaces()?U.failure($localize`You have not captured any of the opponent's pieces, try again!`):U.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Crumbling a first pressure plate`,$localize`When a pressure plate is full, it will crumble and take a full row or column of the board with it! All pieces that are on the crumbled squares are considered lost, but will not have to be placed on pressure plates. You have here a board with a pressure plate that only requires one more piece to crumble.<br/><br/>You're playing Dark. Perform a move that captures at least one piece, and fill that pressure plate to make it crumble.`,new cr([[ue,ue,ue,ue,to,ue,ue,ue],[ue,ue,gs,ue,ue,to,ue,ue],[ue,ue,Wm,ue,ue,ue,ue,gs],[ue,ue,ue,ue,to,ue,ue,gs],[ue,ue,ue,ue,ue,gs,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue]],0,new zn([{key:z.ONE,value:new M(2,2)}]),{...IH,top:yr.EMPTY_5.addCaptured(z.ONE,4)}),new D4(new M(6,2),"push","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>5===r.pressurePlates.top.get().width?U.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble!`):U.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Crumbling a second pressure plate`,$localize`Once a pressure plate has crumbled, a shorter pressure plate takes it place. It is the case here, where only 3 spots are available on the top pressure plate.<br/><br/>You're playing Dark. Perform a move that captures enough pieces to fill the top pressure plate, and make it crumble.`,new cr([[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge],[ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,gs],[ue,ue,ue,ue,ue,gs,ue,gs],[ue,Wm,ue,ue,to,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,to,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue]],0,new zn([{key:z.ONE,value:new M(1,4)}]),{...IH,top:yr.EMPTY_3.addCaptured(z.ONE,2)}),new D4(new M(3,5),"pull","diagonal",{top:1,bottom:0,left:0,right:0}),(t,e,r)=>r.pressurePlates.top.isPresent()?U.failure($localize`You must capture and place your capture on the top pressure plate to make it crumble a second time!`):U.SUCCESS,$localize`Congratulations!`),ce.informational($localize`Minimal board`,$localize`After a pressure plate has crumbled for a second time, there is no more pressure plate available on that side. In case all pressure plates have crumbled, the board is reduced to a 4x4 board.`,new cr([[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge],[Ge,Ge,gs,to,ue,ue,Ge,Ge],[Ge,Ge,Wm,to,ue,ue,Ge,Ge],[Ge,Ge,ue,gs,gs,ue,Ge,Ge],[Ge,Ge,gs,ue,ue,ue,Ge,Ge],[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge]],0,new zn([{key:z.ONE,value:new M(2,3)}]),{top:P.empty(),bottom:P.empty(),left:P.empty(),right:P.empty()})),ce.fromMove($localize`Making the lodestone fall`,$localize`If, at any point during the game, your lodestone is situated on a square that crumbles with a pressure plate, you will be allowed to select any lodestone side on your next turn.<br/><br/>In this board, playing Dark, you can place your lodestone and make a pressure plate crumble so that your lodestone falls too, allowing to choose more freely its side on your next turn. Do it!`,new cr([[ue,ue,ue,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,to,ue,ue],[ue,ue,ue,Wm,ue,ue,gs,ue],[ue,ue,gs,gs,to,ue,ue,gs],[ue,ue,ue,ue,ue,gs,ue,ue],[ue,ue,gs,ue,ue,ue,ue,ue],[ue,ue,to,ue,ue,ue,ue,ue],[ue,ue,ue,ue,ue,ue,ue,ue]],0,new zn([{key:z.ONE,value:new M(3,2)}]),{...IH,top:yr.EMPTY_5.addCaptured(z.ONE,4)}),[new D4(new M(4,0),"pull","diagonal",{top:1,bottom:0,left:0,right:0})],$localize`Congratulations! At your next turn, you will be allowed to place your lodestone on any side.`,$localize`Failed, try again.`),ce.fromMove($localize`End of the game`,$localize`In order to win, you must take out all of your opponent's pieces.<br/><br/>Here, you can win in a single move, do it!`,new cr([[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge],[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge],[Ge,to,gs,to,ue,ue,Ge,Ge],[Ge,to,Wm,ue,to,ue,Ge,Ge],[Ge,ue,ue,gs,gs,ue,Ge,Ge],[Ge,to,gs,ue,to,ue,Ge,Ge],[Ge,ue,ue,ue,gs,ue,Ge,Ge],[Ge,Ge,Ge,Ge,Ge,Ge,Ge,Ge]],0,new zn([{key:z.ONE,value:new M(2,3)}]),{top:P.empty(),bottom:yr.EMPTY_3.addCaptured(z.ZERO,2),left:P.of(yr.EMPTY_3),right:P.empty()}),[new D4(new M(4,2),"pull","orthogonal",{top:0,bottom:0,left:3,right:0})],$localize`Congratulations, you won!`,$localize`This is not the winning move. Try again.`)]}}let P9=(()=>{class n{}return n.MUST_FLIP_LODESTONE=()=>$localize`You must flip your lodestone before putting it back on the board.`,n.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES=()=>$localize`As long as there are pressure plates, you must place all the pieces that you have captured on them.`,n.TARGET_IS_CRUMBLED=()=>$localize`You must place your lodestone on a non-crumbled square!`,n.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE=()=>$localize`You placed too many captures on the same pressure plate, which has not enough space left.`,n.MUST_PLACE_CAPTURES=()=>$localize`You must place your captures on the pressure plates, on the side of the board.`,n.NO_CAPTURES_TO_PLACE_YET=()=>$localize`You cannot place any capture now, you must first place your lodestone on the board!`,n})();class I2 extends Z1{constructor(){super(cr)}static get(){return I2.singleton.isAbsent()&&(I2.singleton=P.of(new I2)),I2.singleton.get()}applyLegalMove(t,e,r){const s=e.getCurrentPlayer(),i=s.getOpponent(),o=Ke.copyBiArray(r.board),c=e.lodestones.getCopy();c.put(s,t.coord);const u={...e.pressurePlates};return this.updatePressurePlates(o,u,c,i,t.captures),new cr(o,e.turn+1,c,u)}updatePressurePlates(t,e,r,s,i){for(const o of yr.POSITIONS)e[o]=this.updatePressurePlate(t,o,e[o],r,s,i[o])}updatePressurePlate(t,e,r,s,i,o){if(r.isPresent()){const c=r.get().addCaptured(i,o),u=I2.THREATENED_COORD_RANGE.get(e).get();return c.isAbsent()?(this.removePressurePlate(t,u.startForBigPlate,u.direction,s),this.removePressurePlate(t,u.startForSmallPlate,u.direction,s)):c.get().width<r.get().width&&this.removePressurePlate(t,u.startForBigPlate,u.direction,s),c}return r}removePressurePlate(t,e,r,s){for(let i=e;i.isInRange(cr.SIZE,cr.SIZE);i=i.getNext(r)){for(const o of z.PLAYERS)s.get(o).equalsValue(i)&&s.delete(o);t[i.y][i.x]=eo.UNREACHABLE}}isLegal(t,e){const r=this.isLegalWithoutCaptures(e,t.coord,t.direction);if(r.isFailure())return $.failure(r.getReason());const s=this.applyMoveWithoutPlacingCaptures(e,t.coord,t);if(t.captures.top+t.captures.bottom+t.captures.left+t.captures.right!==Math.min(s.captures.length,e.remainingSpaces()))return $.failure(P9.MUST_PLACE_CAPTURES_ON_PRESSURE_PLATES());for(const c of yr.POSITIONS){const u=e.pressurePlates[c];if(u.isPresent()&&u.get().remainingSpaces()<t.captures[c])return $.failure(P9.TOO_MANY_CAPTURES_ON_SAME_PRESSURE_PLATE())}return $.success(s)}applyMoveWithoutPlacingCaptures(t,e,r){let s;const i=Ke.copyBiArray(t.board),o=t.lodestones.get(t.getCurrentPlayer());if(o.isPresent()){const c=o.get();i[c.y][c.x]=eo.EMPTY}return s="pull"===r.direction?this.applyPull(t,i,e,r.orientation):this.applyPush(t,i,e,r.orientation),s.board[e.y][e.x]=Do.of(t.getCurrentPlayer(),r),s.moved.push(e),s}applyPull(t,e,r,s){const i=t.getCurrentPlayer(),o=i.getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const p of h)for(let m=r.getNext(p);t.isOnBoard(m);m=m.getNext(p)){const C=e[m.y][m.x],w=m.getNext(p);if(t.isOnBoard(w)){const I=e[w.y][w.x];I.isPlayerPiece()&&I.owner===i&&(C.isEmpty()?(u.push(m),e[m.y][m.x]=I,u.push(w),e[w.y][w.x]=eo.EMPTY):C.isPlayerPiece()&&C.owner===o&&(c.push(m),e[m.y][m.x]=I,u.push(w),e[w.y][w.x]=eo.EMPTY))}}return{board:e,captures:c,moved:u}}applyPush(t,e,r,s){const o=t.getCurrentPlayer().getOpponent(),c=[],u=[],h="diagonal"===s?be.DIAGONALS:be.ORTHOGONALS;for(const p of h)for(let C=r.getNext(p,cr.SIZE);!1===C.equals(r);C=C.getPrevious(p))if(t.isOnBoard(C)){const w=e[C.y][C.x];if(w.isPlayerPiece()&&w.owner===o){const I=C.getNext(p);if(t.isOnBoard(I)){const H=e[I.y][I.x];H.isUnreachable()?(c.push(C),e[C.y][C.x]=eo.EMPTY):H.isEmpty()&&(u.push(I),e[I.y][I.x]=w,u.push(C),e[C.y][C.x]=eo.EMPTY)}else c.push(C),e[C.y][C.x]=eo.EMPTY}}return{board:e,captures:c,moved:u}}isLegalWithoutCaptures(t,e,r){const s=this.isTargetLegal(t,e);if(s.isFailure())return s;const i=t.nextLodestoneDirection();return!1===(i.isAbsent()||i.equalsValue(r))?U.failure(P9.MUST_FLIP_LODESTONE()):U.SUCCESS}isTargetLegal(t,e){const r=t.getPieceAt(e);if(r.isUnreachable())return U.failure(P9.TARGET_IS_CRUMBLED());if(r.isPlayerPiece())return U.failure(rt.MUST_CLICK_ON_EMPTY_SQUARE());const s=t.getCurrentPlayer();return r.isLodestone()&&r.owner!==s?U.failure(rt.MUST_CLICK_ON_EMPTY_SQUARE()):U.SUCCESS}getGameStatus(t){const r=t.gameState.numberOfPieces();return 0===r[0]&&0===r[1]?xe.DRAW:0===r[0]?xe.ONE_WON:0===r[1]?xe.ZERO_WON:xe.ONGOING}}I2.THREATENED_COORD_RANGE=zn.from({top:{startForBigPlate:new M(0,0),startForSmallPlate:new M(0,1),direction:be.RIGHT},bottom:{startForBigPlate:new M(0,cr.SIZE-1),startForSmallPlate:new M(0,cr.SIZE-2),direction:be.RIGHT},left:{startForBigPlate:new M(0,0),startForSmallPlate:new M(1,0),direction:be.DOWN},right:{startForBigPlate:new M(cr.SIZE-1,0),startForSmallPlate:new M(cr.SIZE-2,0),direction:be.DOWN}}),I2.singleton=P.empty();class m0t extends $1{getListMoves(t){const e=t.gameState;return this.flatMapEmptyCoords(e,r=>{const s=[];for(const i of this.nextDirection(e)){const o=["diagonal","orthogonal"];for(const c of o){const p=I2.get().applyMoveWithoutPlacingCaptures(e,r,{direction:i,orientation:c}).captures.length;for(const m of this.captureCombinations(e,p))s.push(new D4(r,i,c,m))}}return s})}captureCombinations(t,e){if(0===e)return new Ht([{top:0,bottom:0,left:0,right:0}]);{const r=new Ht,s=t.remainingSpacesDetails(),i=this.captureCombinations(t,e-1);for(const o of i)o.top+1<=s.top&&r.add({...o,top:o.top+1}),o.bottom+1<=s.bottom&&r.add({...o,bottom:o.bottom+1}),o.left+1<=s.left&&r.add({...o,left:o.left+1}),o.right+1<=s.right&&r.add({...o,right:o.right+1});return 0===r.size()?i:r}}flatMapEmptyCoords(t,e){let r=[];for(let s=0;s<cr.SIZE;s++)for(let i=0;i<cr.SIZE;i++){const o=new M(i,s),c=t.getPieceAt(o);(c.isEmpty()&&!1===c.isUnreachable()||c.isLodestone()&&c.owner===t.getCurrentPlayer())&&(r=r.concat(e(o)))}return r}nextDirection(t){const e=t.nextLodestoneDirection();return e.isPresent()?[e.get()]:["push","pull"]}getBoardValue(t){const e=t.gameState.getScores();let r;return r=24===e[0]&&24!==e[1]?z.ZERO.getVictoryValue():24!==e[0]&&24===e[1]?z.ONE.getVictoryValue():Ct.from(e[0],e[1]).value,new Ct(r)}}function _0t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*r+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function v0t(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=v().$implicit,r=v(3).$implicit,s=v(2);cu("transform","rotate(",90*e,")"),T("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_OUT)}}function C0t(n,t){if(1&n&&(B(),X(0,"polygon",15)),2&n){const e=v().$implicit,r=v(3).$implicit,s=v(2);cu("transform","rotate(",90*e,")"),T("ngClass",r.lodestone.movingClass),D("points",s.TRIANGLE_IN)}}function y0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,v0t,1,3,"polygon",14),x(2,C0t,1,3,"polygon",14),O()),2&n){const e=v(3).$implicit;S(1),T("ngIf","push"===e.lodestone.direction),S(1),T("ngIf","pull"===e.lodestone.direction)}}const h3e=function(){return[0,1,2,3]};function E0t(n,t){if(1&n&&(B(),b(0,"g",11),X(1,"circle",12)(2,"circle",13),b(3,"g"),x(4,y0t,3,2,"g",1),O()()),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();D("transform",o.getSquareTransform(r,i)),S(1),T("ngClass",s.lodestone.selectedClass),D("r",o.PIECE_RADIUS),S(1),T("ngClass",s.lodestone.pieceClasses),D("r",o.PIECE_RADIUS/4),S(1),cu("transform","rotate(","diagonal"===s.lodestone.orientation?45:0,")"),S(1),T("ngForOf",tr(7,h3e))}}function M0t(n,t){if(1&n){const e=Oe();B(),b(0,"g",6),J("click",function(){fe(e);const s=v().$implicit;return ae(v(2).selectCoord(s.coord))}),X(1,"rect",7),x(2,_0t,1,6,"circle",8),x(3,E0t,5,8,"g",9),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","square_",r,"_",i,""),S(1),T("ngClass",s.squareClasses),D("x",o.SPACE_SIZE*r+o.STROKE_WIDTH)("y",o.SPACE_SIZE*i+o.STROKE_WIDTH)("width",o.SPACE_SIZE)("height",o.SPACE_SIZE),S(1),T("ngIf",s.hasPiece),S(1),T("ngIf",s.lodestone)}}function S0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,M0t,4,9,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",!1===e.crumbled)}}function P0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,S0t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function T0t(n,t){if(1&n&&(B(),b(0,"g",16),X(1,"circle",17),O()),2&n){const e=t.$implicit,r=t.index,s=v();C1("id","capture_",r,""),D("transform",s.getCaptureTransform(r)),S(1),T("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS)}}function w0t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polygon",15),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v();S(1),cu("transform","rotate(",90*e,")"),T("ngClass",r.movingClass),D("points","push"===r.direction?s.TRIANGLE_OUT:s.TRIANGLE_IN)}}function b0t(n,t){if(1&n){const e=Oe();B(),b(0,"g",6),J("click",function(){const i=fe(e).$implicit;return ae(v().selectLodestone(i))}),X(1,"circle",12)(2,"circle",13),b(3,"g"),x(4,w0t,2,3,"g",1),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v();We("id","lodestone_",e.direction,"_",e.orientation,""),D("transform",s.getAvailableLodestoneTransform(r)),S(1),T("ngClass",e.selectedClass),D("r",s.PIECE_RADIUS),S(1),T("ngClass",e.pieceClasses),D("r",s.PIECE_RADIUS/4),S(1),cu("transform","rotate(","diagonal"===e.orientation?45:0,")"),S(1),T("ngForOf",tr(9,h3e))}}function O0t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().$implicit,o=v();We("id","platePiece_",i.position,"_",r,""),T("ngClass",s.pieceClasses),D("r",o.PIECE_RADIUS)("cx",o.SPACE_SIZE*s.coord.x+o.STROKE_WIDTH+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*s.coord.y+o.STROKE_WIDTH+o.SPACE_SIZE/2)}}function N0t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"g",6),J("click",function(){const s=fe(e),i=s.$implicit,o=s.index,c=v().$implicit;return ae(v().onPressurePlateClick(i.temporary,c.position,o))}),X(2,"rect",18),x(3,O0t,1,6,"circle",8),O()()}if(2&n){const e=t.$implicit,r=t.index,s=v().$implicit,i=v();D("transform",i.getPressurePlateTransform(s.position)),S(1),We("id","plate_",s.position,"_",r,""),S(1),We("id","plateSquare_",s.position,"_",r,""),T("ngClass",e.squareClasses),D("x",i.SPACE_SIZE*e.coord.x+i.STROKE_WIDTH)("y",i.SPACE_SIZE*e.coord.y+i.STROKE_WIDTH)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.hasPiece)}}function A0t(n,t){if(1&n&&(B(),b(0,"g",16),x(1,N0t,4,11,"g",1),O()),2&n){const e=t.$implicit;C1("id","pressurePlate_",e.position,""),S(1),T("ngForOf",e.coords)}}function I0t(n,t){if(1&n&&(B(),X(0,"rect",19)),2&n){const e=v();We("id","selection_",e.viewInfo.selected.get().x,"_",e.viewInfo.selected.get().y,""),D("x",e.SPACE_SIZE*e.viewInfo.selected.get().x+e.STROKE_WIDTH)("y",e.SPACE_SIZE*e.viewInfo.selected.get().y+e.STROKE_WIDTH)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}class x2 extends Y0{constructor(t){super(t),this.viewInfo={availableLodestones:[],capturesToPlace:[],boardInfo:[],currentPlayerClass:"",opponentClass:"",pressurePlates:[],selected:P.empty(),pressurePlateShift:{top:new Ut(0,0),left:new Ut(0,0),right:new Ut(0,0),bottom:new Ut(0,0)}},this.stateAfterPlacingLodestone=P.empty(),this.lastInfos=P.empty(),this.capturesToPlace=0,this.selectedCoord=P.empty(),this.selectedLodestone=P.empty(),this.captures={top:0,bottom:0,left:0,right:0},this.rules=I2.get(),this.tutorial=(new f3e).tutorial,this.availableMinimaxes=[new m0t(this.rules,"LodestoneDummyMinimax")],this.encoder=D4.encoder,this.PIECE_RADIUS=.5*(this.SPACE_SIZE-2*this.STROKE_WIDTH);const e=.8*this.PIECE_RADIUS,r=.3*this.PIECE_RADIUS,s=.2*this.PIECE_RADIUS;this.TRIANGLE_OUT=`${e},0 ${r},${s} ${r},-${s}`,this.TRIANGLE_IN=`${r},0 ${e},${r} ${e},-${r}`,this.displayedState=this.getState(),this.scores=P.of([0,0])}ngOnInit(){this.updateBoard()}selectCoord(t){var e=this;return A(function*(){const r=e.canUserPlay("#square_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());if(e.capturesToPlace>0)return e.cancelMove(P9.MUST_PLACE_CAPTURES());const s=I2.get().isTargetLegal(e.getState(),t);return s.isFailure()?e.cancelMove(s.getReason()):e.selectedCoord.equalsValue(t)?(e.cancelMoveAttempt(),U.SUCCESS):(e.selectedCoord=P.of(t),e.selectedLodestone.isPresent()?e.putLodestone():(e.updateViewInfo(),U.SUCCESS))})()}selectLodestone(t){var e=this;return A(function*(){const r=e.canUserPlay("#lodestone_"+t.direction+"_"+t.orientation);if(r.isFailure())return e.cancelMove(r.getReason());ye(0===e.capturesToPlace,"should not be able to click on a lodestone when captures need to be placed");const s=e.getCurrentPlayer(),i=Do.of(s,t);return e.selectedLodestone.equalsValue(i)?(e.cancelMoveAttempt(),U.SUCCESS):(e.selectedLodestone=P.of(i),e.selectedCoord.isPresent()?e.putLodestone():(e.updateViewInfo(),U.SUCCESS))})()}putLodestone(){var t=this;return A(function*(){ye(t.selectedCoord.isPresent(),"coord should have been selected"),ye(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=t.getState();ye(I2.get().isLegalWithoutCaptures(s,e,r.direction).isSuccess(),"Lodestone component should only allow creation of legal moves");const o=I2.get().applyMoveWithoutPlacingCaptures(s,e,r);return t.lastInfos=P.of(o),t.capturesToPlace=Math.min(o.captures.length,s.remainingSpaces()),0===t.capturesToPlace?t.applyMove():(t.displayedState=t.displayedState.withBoard(o.board),t.stateAfterPlacingLodestone=P.of(t.displayedState),t.updateViewInfo(),U.SUCCESS)})()}applyMove(){var t=this;return A(function*(){ye(t.selectedCoord.isPresent(),"coord should have been selected"),ye(t.selectedLodestone.isPresent(),"lodestone should have been selected");const e=t.selectedCoord.get(),r=t.selectedLodestone.get(),s=new D4(e,r.direction,r.orientation,t.captures);return t.chooseMove(s,t.getState())})()}onPressurePlateClick(t,e,r){return t?this.deselectPressurePlate(e,r):this.selectPressurePlate(e,r)}selectPressurePlate(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(0===r.capturesToPlace)return r.cancelMove(P9.NO_CAPTURES_TO_PLACE_YET());r.capturesToPlace--,r.captures[t]++;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Ke.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return I2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new cr(c,i.turn,h,u),0===r.capturesToPlace?r.applyMove():(r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),U.SUCCESS)})()}deselectPressurePlate(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#plate_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());r.capturesToPlace++,r.captures[t]--;const i=r.stateAfterPlacingLodestone.get(),o=r.getCurrentPlayer().getOpponent(),c=Ke.copyBiArray(i.board),u={...i.pressurePlates},h=i.lodestones.getCopy();return I2.get().updatePressurePlates(c,u,h,o,r.captures),r.displayedState=new cr(c,i.turn,h,u),r.updateViewInfo(),r.showPressurePlateDifferences(r.getState(),r.displayedState,!0),U.SUCCESS})()}updateBoard(){this.cancelMoveAttempt(),this.rules.node.move.isPresent()&&this.showLastMove(),this.scores=P.of(this.getState().getScores())}cancelMoveAttempt(){this.displayedState=this.getState(),this.stateAfterPlacingLodestone=P.empty(),this.lastInfos=P.empty();const t=this.displayedState.lodestones.get(this.getCurrentPlayer());if(t.isPresent()){const e=Ke.copyBiArray(this.displayedState.board);e[t.get().y][t.get().x]=eo.EMPTY,this.displayedState=this.displayedState.withBoard(e)}this.selectedCoord=P.empty(),this.selectedLodestone=P.empty(),this.capturesToPlace=0,this.captures={top:0,bottom:0,left:0,right:0},this.updateViewInfo()}updateViewInfo(){const e=this.getState().getCurrentPlayer();this.viewInfo.currentPlayerClass=this.getPlayerClass(e),this.viewInfo.opponentClass=this.getPlayerClass(e.getOpponent()),this.showBoard(),this.showAvailableLodestones(),this.showCapturesToPlace(),this.showPressurePlates(),this.computePressurePlateShift(),this.lastInfos.isPresent()&&this.showMovedAndCaptured(this.lastInfos.get())}showBoard(){this.viewInfo.boardInfo=[];for(let t=0;t<cr.SIZE;t++){this.viewInfo.boardInfo.push([]);for(let e=0;e<cr.SIZE;e++){const r=new M(e,t);this.viewInfo.boardInfo[t].push(this.getSquareInfo(r))}}this.viewInfo.selected=this.selectedCoord.isPresent()&&!1===this.displayedState.getPieceAt(this.selectedCoord.get()).isUnreachable()?this.selectedCoord:P.empty()}getSquareInfo(t){const e=this.displayedState.getPieceAt(t),r={coord:t,squareClasses:[],crumbled:e.isUnreachable(),hasPiece:e.isPlayerPiece(),pieceClasses:[]};return e.isPlayerPiece()&&(r.pieceClasses=[this.getPlayerClass(e.owner)]),e.isLodestone()&&(r.lodestone={direction:e.direction,pieceClasses:[this.getPlayerClass(e.owner)],selectedClass:"",movingClass:"",orientation:e.orientation},r.lodestone.movingClass=this.getPlayerClass("push"===e.direction?e.owner.getOpponent():e.owner)),r}showAvailableLodestones(){if(this.capturesToPlace>0)this.viewInfo.availableLodestones=[];else{const t=this.getState().getCurrentPlayer(),e=this.getState().nextLodestoneDirection();if(e.isPresent()){const r=e.get();this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:r,orientation:"orthogonal"}),this.nextLodestone(t,{direction:r,orientation:"diagonal"})]}else this.viewInfo.availableLodestones=[this.nextLodestone(t,{direction:"push",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"push",orientation:"diagonal"}),this.nextLodestone(t,{direction:"pull",orientation:"orthogonal"}),this.nextLodestone(t,{direction:"pull",orientation:"diagonal"})]}}showCapturesToPlace(){const t=this.getCurrentPlayer().getOpponent();this.viewInfo.capturesToPlace=[];for(let e=0;e<this.capturesToPlace;e++)this.viewInfo.capturesToPlace.push({pieceClasses:[this.getPlayerClass(t)]})}nextLodestone(t,e){const r=Do.of(t,e),s={direction:r.direction,orientation:r.orientation,pieceClasses:[this.getPlayerClass(r.owner)],movingClass:"",selectedClass:""};return s.movingClass=this.getPlayerClass("push"===r.direction?r.owner.getOpponent():r.owner),this.selectedLodestone.equalsValue(r)&&(s.selectedClass="selected-stroke"),s}showPressurePlates(){this.viewInfo.pressurePlates=[];for(const t of yr.POSITIONS){const e=[],r=this.displayedState.pressurePlates[t];if(r.isPresent()){const s=x2.PRESSURE_PLATES_POSITIONS.get(t).get(),i=r.get().width;let o=5===i?s.startForBigPlate:s.startForSmallPlate;for(let c=0;c<i;c++){o=o.getNext(s.direction);const u=r.get().getPieceAt(c);let h="";u.isPlayerPiece()&&(h=this.getPlayerClass(u.owner)),e.push({coord:o,hasPiece:u.isPlayerPiece(),pieceClasses:[h],squareClasses:[],temporary:!1})}}this.viewInfo.pressurePlates.push({position:t,coords:e})}}showLastMove(){const t=this.rules.node.mother.get().gameState,e=this.rules.node.move.get();this.lastInfos=P.of(I2.get().applyMoveWithoutPlacingCaptures(t,e.coord,e)),this.updateViewInfo();const r=this.getState();this.showPressurePlateDifferences(t,r,!1)}showPressurePlateDifferences(t,e,r){for(const s of yr.POSITIONS)this.showPressurePlateDifference(t.pressurePlates[s],e.pressurePlates[s],s,r)}showPressurePlateDifference(t,e,r,s){if(t.isPresent()&&e.isPresent()){const i=t.get(),o=e.get(),c=we.getNonNullable(this.viewInfo.pressurePlates.find(u=>u.position===r));if(i.width===o.width)for(let u=0;u<o.width;u++){const h=i.getPieceAt(u),p=o.getPieceAt(u);!1===h.equals(p)&&(c.coords[u].squareClasses.push("moved-fill"),c.coords[u].temporary=s,s&&c.coords[u].pieceClasses.push("semi-transparent"))}else for(const u of c.coords)u.squareClasses.push("moved-fill")}}showMovedAndCaptured(t){for(const e of t.moved)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("moved-fill");for(const e of t.captures)this.viewInfo.boardInfo[e.y][e.x].squareClasses.push("captured-fill")}computePressurePlateShift(){const t=this.displayedState,e=this.getPressurePlateShift(t.pressurePlates.left),r=this.getPressurePlateShift(t.pressurePlates.right),s=this.getPressurePlateShift(t.pressurePlates.top),i=this.getPressurePlateShift(t.pressurePlates.bottom);this.viewInfo.pressurePlateShift.top=new Ut(.5*(e-r),0),this.viewInfo.pressurePlateShift.bottom=new Ut(.5*(e-r),0),this.viewInfo.pressurePlateShift.left=new Ut(0,.5*(s-i)),this.viewInfo.pressurePlateShift.right=new Ut(0,.5*(s-i))}getPressurePlateShift(t){return t.isAbsent()?2:3===t.get().width?1:0}getSquareTransform(t,e){return`translate(${t*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2}, ${e*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getCaptureTransform(t){return`translate(${(t+(cr.SIZE/2-this.viewInfo.capturesToPlace.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${-2*this.SPACE_SIZE-30+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getAvailableLodestoneTransform(t){return`translate(${(t+(cr.SIZE/2-this.viewInfo.availableLodestones.length/2))*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2+this.viewInfo.pressurePlateShift.top.x*this.SPACE_SIZE}, ${30+9*this.SPACE_SIZE+this.STROKE_WIDTH+this.SPACE_SIZE/2})`}getPressurePlateTransform(t){return`translate(${this.viewInfo.pressurePlateShift[t].x*this.SPACE_SIZE}, ${this.viewInfo.pressurePlateShift[t].y*this.SPACE_SIZE})`}}x2.PRESSURE_PLATE_EXTRA_SHIFT=.2,x2.PRESSURE_PLATES_POSITIONS=zn.from({top:{startForBigPlate:new M(.5,-1-x2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new M(1.5,0-x2.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},bottom:{startForBigPlate:new M(.5,8+x2.PRESSURE_PLATE_EXTRA_SHIFT),startForSmallPlate:new M(1.5,7+x2.PRESSURE_PLATE_EXTRA_SHIFT),direction:be.RIGHT},left:{startForBigPlate:new M(-1-x2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new M(0-x2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN},right:{startForBigPlate:new M(8+x2.PRESSURE_PLATE_EXTRA_SHIFT,.5),startForSmallPlate:new M(7+x2.PRESSURE_PLATE_EXTRA_SHIFT,1.5),direction:be.DOWN}}),x2.\u0275fac=function(t){return new(t||x2)(Q(Tn))},x2.\u0275cmp=gt({type:x2,selectors:[["app-lodestone"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-100 -220 1016 1256","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base no-fill selected-stroke",3,"id",4,"ngIf"],[3,"id","click",4,"ngIf"],[3,"id","click"],[1,"base",3,"ngClass"],["class","base",3,"id","ngClass",4,"ngIf"],["class","lodestone",4,"ngIf"],[1,"base",3,"id","ngClass"],[1,"lodestone"],["cx","0","cy","0",1,"base","black-fill","outside",3,"ngClass"],["cx","0","cy","0",1,"base","no-stroke",3,"ngClass"],["class","base no-stroke",3,"ngClass",4,"ngIf"],[1,"base","no-stroke",3,"ngClass"],[3,"id"],["cx","0","cy","0",1,"base",3,"ngClass"],["rx","20","ry","20",1,"base",3,"id","ngClass"],[1,"base","no-fill","selected-stroke",3,"id"]],template:function(t,e){1&t&&(B(),b(0,"svg",0),x(1,P0t,2,1,"g",1),x(2,T0t,2,4,"g",2),x(3,b0t,5,10,"g",3),x(4,A0t,2,2,"g",2),x(5,I0t,1,6,"rect",4),O()),2&t&&(S(1),T("ngForOf",e.viewInfo.boardInfo),S(1),T("ngForOf",e.viewInfo.capturesToPlace),S(1),T("ngForOf",e.viewInfo.availableLodestones),S(1),T("ngForOf",e.viewInfo.pressurePlates),S(1),T("ngIf",e.viewInfo.selected.isPresent()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let HP=(()=>{class n{}return n.START_COORD_OUT_OF_RANGE=()=>$localize`Start coord cannot be out of range`,n.END_COORD_OUT_OF_RANGE=()=>$localize`End coord cannot be out of range`,n.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP=()=>$localize`Pawns must move one step diagonally.`,n.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS=()=>$localize`Drones must move one or two steps in any direction.`,n})();class ms extends X0{constructor(t,e,r){super(t,e),this.calledTheClock=r}static from(t,e,r=!1){if(t.isNotInRange(4,8))return $.failure(HP.START_COORD_OUT_OF_RANGE());if(e.isNotInRange(4,8))return $.failure(HP.END_COORD_OUT_OF_RANGE());if(e.equals(t))return $.failure(rt.MOVE_CANNOT_BE_STATIC());const s=be.factory.fromDelta(e.x-t.x,e.y-t.y);return s.isFailure()?$.failure(s.getReason()):$.success(new ms(t,e,r))}toString(){const t=this.calledTheClock?", CALL_THE_CLOCK":"";return"MartianChessMove(("+this.getStart().x+", "+this.getStart().y+") -> ("+this.getEnd().x+", "+this.getEnd().y+")"+t+")"}equals(t){return!1!==this.getStart().equals(t.getStart())&&!1!==this.getEnd().equals(t.getEnd())&&this.calledTheClock===t.calledTheClock}isValidForPawn(){return this.getStart().getVectorToward(this.getEnd()).isDiagonalOfLength(1)}isValidForDrone(){return this.getStart().getDistance(this.getEnd())<=2}isUndoneBy(t){if(t.isAbsent())return!1;const e=t.get();return e.getEnd().equals(this.getStart())&&e.getStart().equals(this.getEnd())}}ms.encoder=Cn.tuple([M.numberEncoder(4,8),M.numberEncoder(4,8),Cn.booleanEncoder],n=>[n.getStart(),n.getEnd(),n.calledTheClock],n=>ms.from(n[0],n[1],n[2]).get());class Dt{constructor(t){this.value=t}static tryMerge(t,e){ye(t!==Dt.EMPTY&&e!==Dt.EMPTY,"tryMerge cannot be called with empty pieces");const s=t.value+e.value;return 2===s||3===s?P.of(Dt.from(s)):P.empty()}static from(t){return t===Dt.DRONE.value?Dt.DRONE:(we.expectToBe(t,Dt.QUEEN.value),Dt.QUEEN)}getValue(){return this.value}equals(t){return this.getValue()===t.getValue()}}Dt.EMPTY=new Dt(0),Dt.PAWN=new Dt(1),Dt.DRONE=new Dt(2),Dt.QUEEN=new Dt(3);class E5{constructor(t){this.captures=t,t.makeImmutable()}static from(t){const e=new zn;for(const r of t)E5.addToMap(e,r);return new E5(e)}static addToMap(t,e){const r=t.get(e);r.isPresent()?t.replace(e,r.get()+1):t.set(e,1)}toValue(){let t=0;return this.captures.forEach(e=>{t+=e.key.getValue()*e.value}),t}add(t){const e=this.captures.getCopy();return E5.addToMap(e,t),new E5(e)}}class Ls extends ps{constructor(t,e,r=P.empty(),s=P.empty(),i){super(t,e),this.lastMove=r,this.countDown=s,null==i&&(i=new zn([{key:z.ZERO,value:E5.from([])},{key:z.ONE,value:E5.from([])}])),i.makeImmutable(),this.captured=i}static getInitialState(){const t=Dt.EMPTY,e=Dt.PAWN,r=Dt.DRONE,s=Dt.QUEEN;return new Ls([[s,s,r,t],[s,r,e,t],[r,e,e,t],[t,t,t,t],[t,t,t,t],[t,e,e,r],[t,e,r,s],[t,r,s,s]],0,P.empty())}getPlayerTerritory(t){return t===z.ZERO?Ls.PLAYER_ZERO_TERRITORY:Ls.PLAYER_ONE_TERRITORY}isTherePieceOnPlayerSide(t){const e=this.getCurrentPlayer(),r=this.getPlayerTerritory(e);for(const s of r)for(let i=0;i<4;i++)if(this.getPieceAtXY(i,s)===t)return!0;return!1}getScoreOf(t){return this.captured.get(t).get().toValue()}getEmptyTerritory(){return this.isTerritoryEmpty(z.ZERO)?P.of(z.ZERO):this.isTerritoryEmpty(z.ONE)?P.of(z.ONE):P.empty()}isTerritoryEmpty(t){const e=this.getPlayerTerritory(t);for(const r of e)for(let s=0;s<4;s++)if(this.getPieceAtXY(s,r)!==Dt.EMPTY)return!1;return!0}isInOpponentTerritory(t){const e=this.getCurrentOpponent();return this.getPlayerTerritory(e).contains(t.y)}isInPlayerTerritory(t){const e=this.getCurrentPlayer();return this.getPlayerTerritory(e).contains(t.y)}getCapturesOf(t){const e=this.captured.get(t).get();return[e.captures.get(Dt.PAWN).getOrElse(0),e.captures.get(Dt.DRONE).getOrElse(0),e.captures.get(Dt.QUEEN).getOrElse(0)]}}Ls.PLAYER_ZERO_TERRITORY=new Ht([4,5,6,7]),Ls.PLAYER_ONE_TERRITORY=new Ht([0,1,2,3]);let d3e=(()=>{class n{}return n.YOU_DID_NOT_CAPTURE_ANY_PIECE=()=>$localize`Failed, you did not capture any piece.`,n})();const oe=Dt.EMPTY,k2=Dt.PAWN,a6=Dt.DRONE,s8=Dt.QUEEN,p3e=()=>$localize`This is not a field promotion!`;class g3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Martian Chess, the goal is to have the most points at the end of the game. Each piece is assigned a value, you win this value when capturing the piece. The board is divided in two by a line called the canal. There is one side for each player. You do not own pieces, but you control the ones on your side of the canal. Pieces are colored to help you: they will change color when crossing the canal.`,Ls.getInitialState()),ce.informational($localize`The pieces`,$localize`The pieces are dark on the side of the first player, the light ones on the side of the second one. There are 3 kind of pieces: <ul><li>The Queens: represented as circles with 3 dots.</li><li>The Drones: represented as circles with 2 dots.</li><li>The Pawns: represented as circles with one dot.</li></ul>`,Ls.getInitialState()),ce.fromPredicate($localize`Moving pawns`,$localize`Pawns are worth one point. They can move one step diagonally.<br/><br/>You're playing Dark, move a pawn.`,Ls.getInitialState(),ms.from(new M(2,5),new M(1,4)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Dt.PAWN?U.SUCCESS:U.failure($localize`This is not a pawn!`),$localize`Congratulations!`),ce.fromPredicate($localize`Moving drones`,$localize`Drones are worth two points. They can move one or two steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a drone.`,Ls.getInitialState(),ms.from(new M(1,7),new M(0,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Dt.DRONE?U.SUCCESS:U.failure($localize`This is not a drone!`),$localize`Congratulations!`),ce.fromPredicate($localize`Moving queens`,$localize`Queens are worth three points. They can move any number of steps in any direction, in a straight line, without jumping over other pieces.<br/><br/>You're playing Dark, move a queen.`,new Ls([[a6,k2,oe,oe],[s8,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,s8,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[s8,a6,k2,oe]],1),ms.from(new M(2,3),new M(2,7)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Dt.QUEEN?U.SUCCESS:U.failure($localize`This is not a queen!`),$localize`Congratulations!`),ce.fromMove($localize`Capture`,$localize`When a piece crosses the canal and lands on another piece, you capture it and gain the value of that captured piece. However, you lose control of your piece as it crosses the canal!<br/><br/>A capture is possible for Dark, do it.`,new Ls([[a6,k2,k2,oe],[oe,oe,oe,oe],[s8,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,k2,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,a6,k2,oe]],1),[ms.from(new M(0,2),new M(2,4)).get()],$localize`Congratulations! By capturing that pawn, you won one point.`,d3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),ce.fromMove($localize`Field Promotion (1/2)`,$localize`It is sometimes possible to perform what is called a field promotion. If you are out of one type of piece, you can merge two pieces to add their value and get a new piece. For example, if you have no drones, you can merge two pawns into a drone. To merge two pawns, move one of your pawns on another.<br/><br/>Such a move is possible for Dark. Do it.`,new Ls([[oe,oe,oe,s8],[oe,k2,oe,oe],[oe,oe,k2,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,s8],[oe,oe,a6,oe],[oe,k2,oe,oe]],1),[ms.from(new M(1,1),new M(2,2)).get(),ms.from(new M(2,2),new M(1,1)).get()],$localize`Congratulations!`,p3e()),ce.fromPredicate($localize`Field Promotion (2/2)`,$localize`The other kind of field promotion is to merge a drone and a pawn to obtain a queen.<br/><br/>Such a move is possible for Light. Do it.`,new Ls([[k2,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,a6,oe],[oe,k2,oe,oe]],0),ms.from(new M(1,7),new M(2,6)).get(),(t,e,r)=>r.getPieceAt(t.getEnd())===Dt.QUEEN?U.SUCCESS:U.failure(p3e()),$localize`Congratulations!`),ce.fromPredicate($localize`Call the clock`,$localize`When the game seems to be going nowhere, you can "call the clock" during your turn. To do so, click on the clock symbol on the right, then perform your move. Once the clock is called, seven more turn will be played.<br/><br/>You're playing Dark. Call the clock and perform a move.`,Ls.getInitialState(),ms.from(new M(1,5),new M(0,4),!0).get(),(t,e,r)=>t.calledTheClock?U.SUCCESS:U.failure($localize`You did not call the clock!`),$localize`Congratulations!`),ce.fromMove($localize`Restarting the clock`,$localize`If the clock has been called, whenever a capture is done the countdown restarts.<br/><br/>You're playing Dark, do a capture to restart the countdown.`,new Ls([[oe,oe,oe,oe],[oe,k2,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,k2],[oe,oe,a6,oe],[oe,k2,oe,oe]],15,P.empty(),P.of(1)),[ms.from(new M(1,1),new M(2,2)).get()],$localize`Congratulations!`,$localize`This is not a capture, the game is now over, please retry!`),ce.anyMove($localize`End game (by clock)`,$localize`When seven turns have passed after the clock has been called, the player with the most points win. If both player have the same number of points, it is a tie.<br/><br/>You're playing Dark, do the last move.`,new Ls([[oe,oe,oe,s8],[oe,k2,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[a6,oe,oe,oe],[oe,oe,oe,oe],[oe,a6,oe,oe]],15,P.empty(),P.of(1)),ms.from(new M(1,1),new M(2,2)).get(),$localize`Congratulations!`),ce.fromPredicate($localize`End by emptyness`,$localize`When a player's last piece is moved into the opponent territory, the game ends. If both players have the same number of points, the last player win!<br/><br/>Light player can win this way, do it!`,new Ls([[oe,oe,oe,s8],[oe,k2,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,k2,oe],[oe,oe,oe,oe],[oe,oe,oe,oe],[oe,oe,oe,oe]],0),ms.from(new M(2,4),new M(1,3)).get(),(t,e,r)=>3===t.getEnd().y?U.SUCCESS:U.failure($localize`Your piece is still in you territory!`),$localize`Congratulations!`)]}}let FP=(()=>{class n{}return n.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY=()=>$localize`You must pick a piece from your side of the board in order to move it.`,n.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT=()=>$localize`This is not a valid promotion nor a valid capture.`,n.CANNOT_UNDO_LAST_MOVE=()=>$localize`You cannot perform a move that is the reverse of the previous one.`,n})();class T9 extends Z1{applyLegalMove(t,e,r){const s=e.getCopiedBoard();s[t.getStart().y][t.getStart().x]=Dt.EMPTY;const i=r.finalPiece;s[t.getEnd().y][t.getEnd().x]=i;const o=r.score;let c=e.countDown;if(c.isPresent())if(this.isCapture(t,e))c=T9.STARTING_COUNT_DOWN;else{const h=e.countDown.get();c=P.of(h-1)}return t.calledTheClock&&(c=T9.STARTING_COUNT_DOWN),new Ls(s,e.turn+1,P.of(t),c,o)}isLegal(t,e){this.assertNonDoubleClockCall(t,e);const r=this.isLegalMove(t,e);if(r.isFailure())return $.failure(r.getReason());if(t.isUndoneBy(e.lastMove))return $.failure(FP.CANNOT_UNDO_LAST_MOVE());if(this.isFieldPromotion(t,e))return this.isLegalFieldPromotion(t,e);const s=e.getPieceAt(t.getStart()),i=e.captured.getCopy();if(this.isCapture(t,e)){const c=e.getCurrentPlayer();let u=i.get(c).get();const h=e.getPieceAt(t.getEnd());u=u.add(h),i.replace(c,u),i.makeImmutable()}return $.success({finalPiece:s,score:i})}assertNonDoubleClockCall(t,e){ye(!1===(e.countDown.isPresent()&&t.calledTheClock),"Should not call the clock twice")}isCapture(t,e){const r=e.isInOpponentTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Dt.EMPTY;return r&&s}isFieldPromotion(t,e){const r=e.isInPlayerTerritory(t.getEnd()),s=e.getPieceAt(t.getEnd())!==Dt.EMPTY;return r&&s}isLegalFieldPromotion(t,e){const r=this.getPromotedPiece(t,e);if(r.isAbsent())return $.failure(FP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());const s=r.get();if(e.isTherePieceOnPlayerSide(s))return $.failure(FP.CANNOT_CAPTURE_YOUR_OWN_PIECE_NOR_PROMOTE_IT());{const i={finalPiece:s,score:e.captured.getCopy()};return $.success(i)}}isLegalMove(t,e){if(!1===e.isInPlayerTerritory(t.getStart()))return $.failure(FP.MUST_CHOOSE_PIECE_FROM_YOUR_TERRITORY());const s=e.getPieceAt(t.getStart());if(s===Dt.EMPTY)return $.failure(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(s===Dt.PAWN)return t.isValidForPawn()?$.success(void 0):$.failure(HP.PAWN_MUST_MOVE_ONE_DIAGONAL_STEP());if(s===Dt.DRONE&&!1===t.isValidForDrone())return $.failure(HP.DRONE_MUST_DO_TWO_ORTHOGONAL_STEPS());for(const i of t.getStart().getUntil(t.getEnd()))if(e.getPieceAt(i)!==Dt.EMPTY)return $.failure(rt.SOMETHING_IN_THE_WAY());return $.success(void 0)}getPromotedPiece(t,e){const r=e.getPieceAt(t.getStart()),s=e.getPieceAt(t.getEnd());return Dt.tryMerge(r,s)}getGameStatus(t){const e=t.gameState;if(e.countDown.equalsValue(0))return this.getGameStatusScoreVictoryOr(e,xe.DRAW);if(e.getEmptyTerritory().isPresent()){const s=e.getCurrentOpponent(),i=xe.getVictory(s);return this.getGameStatusScoreVictoryOr(e,i)}return xe.ONGOING}getGameStatusScoreVictoryOr(t,e){const r=t.getScoreOf(z.ZERO),s=t.getScoreOf(z.ONE);return r>s?xe.ZERO_WON:s>r?xe.ONE_WON:e}}T9.STARTING_COUNT_DOWN=P.of(7);class x0t extends $1{constructor(t,e){super(t,e),this.ruler=t}getListMoves(t){const e=t.gameState,r=e.getCurrentPlayer(),s=e.getPlayerTerritory(r);let i=[];for(const o of s)for(let c=0;c<4;c++)switch(e.getPieceAtXY(c,o)){case Dt.PAWN:i=i.concat(this.getMovesForPawnAt(e,c,o));break;case Dt.DRONE:i=i.concat(this.getMovesForDroneAt(e,c,o));break;case Dt.QUEEN:i=i.concat(this.getMovesForQueenAt(e,c,o))}return i}getMovesForPawnAt(t,e,r){const s=new M(e,r),i=[];for(const o of be.DIAGONALS){const c=s.getNext(o);c.isInRange(4,8)&&i.push(c)}return this.addLegalMoves(t,s,i)}addLegalMoves(t,e,r){const s=[],i=t.getPieceAt(e),o=!1===t.isTherePieceOnPlayerSide(Dt.DRONE),c=!1===t.isTherePieceOnPlayerSide(Dt.QUEEN),u=t.lastMove;for(const h of r){const p=t.getPieceAt(h);if(p===Dt.EMPTY)this.add(s,ms.from(e,h).get(),u);else if(t.isInPlayerTerritory(h)){const m=Dt.tryMerge(p,i);if(m.isPresent()){const C=m.get(),w=ms.from(e,h).get();(C===Dt.DRONE&&o||C===Dt.QUEEN&&c)&&this.add(s,w,u)}}else this.add(s,ms.from(e,h).get(),u)}return s}add(t,e,r){!1===e.isUndoneBy(r)&&t.push(e)}getMovesForDroneAt(t,e,r){const s=new M(e,r),i=this.getLandingCoordsForLinearMove(s,t,2);return this.addLegalMoves(t,s,i)}getLandingCoordsForLinearMove(t,e,r){const s=[];for(const i of be.DIRECTIONS){let o=1,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Dt.EMPTY);for(;h;)s.push(c),o++,c=t.getNext(i,o),u=e.tryToGetPieceAt(c),h=u.equalsValue(Dt.EMPTY)&&o<r;u.isPresent()&&s.push(c)}return s}getMovesForQueenAt(t,e,r){const s=new M(e,r),i=this.getLandingCoordsForQueen(s,t);return this.addLegalMoves(t,s,i)}getLandingCoordsForQueen(t,e){return this.getLandingCoordsForLinearMove(t,e,8)}getBoardValue(t){const e=this.ruler.getGameStatus(t);let r;if(e.isEndGame)r=e.toBoardValue().value;else{const s=t.gameState.getScoreOf(z.ZERO);r=t.gameState.getScoreOf(z.ONE)-s}return new Ct(r)}}function k0t(n,t){if(1&n&&(B(),X(0,"g",19)),2&n){const e=v(2).index,r=v().index,s=v();p2(s.style),We("mainShapeId","pawn_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function L0t(n,t){if(1&n&&(B(),X(0,"g",20)),2&n){const e=v(2).index,r=v().index,s=v();p2(s.style),We("mainShapeId","drone_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function R0t(n,t){if(1&n&&(B(),X(0,"g",21)),2&n){const e=v(2).index,r=v().index,s=v();p2(s.style),We("mainShapeId","queen_",e,"_",r,""),T("pieceClasses",s.getPieceClasses(e,r))}}function D0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,k0t,1,5,"g",16),x(2,L0t,1,5,"g",17),x(3,R0t,1,5,"g",18),O()),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();D("transform",o.getPieceLocation(r,i)),S(1),T("ngIf",s===o.pieces.PAWN),S(1),T("ngIf",s===o.pieces.DRONE),S(1),T("ngIf",s===o.pieces.QUEEN)}}function z0t(n,t){if(1&n){const e=Oe();B(),b(0,"g",14),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),X(1,"rect",15),x(2,D0t,4,4,"g",13),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();We("id","click_",r,"_",s,""),D("transform",i.getPieceTranslation(s)),S(1),We("id","square_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",r*i.SPACE_SIZE)("y",s*i.SPACE_SIZE)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.pieces.EMPTY)}}function V0t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",22),J("click",function(){const i=fe(e).$implicit;return ae(v(3).onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v(3);S(1),We("id","indicator_",e.x,"_",e.y,""),D("transform",r.getPieceTranslation(e.y))("x",e.x*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("y",e.y*r.SPACE_SIZE+(r.SPACE_SIZE/2-r.INDICATOR_SIZE/2))("width",r.INDICATOR_SIZE)("height",r.INDICATOR_SIZE)}}function H0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,V0t,2,7,"g",1),O()),2&n){const e=v(2);S(1),T("ngForOf",e.selectedPieceInfo.get().legalLandings)}}function F0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,z0t,3,11,"g",12),x(2,H0t,2,1,"g",13),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",e),S(1),T("ngIf",r.selectedPieceInfo.isPresent())}}function B0t(n,t){if(1&n&&(B(),b(0,"text",23),Pt(1),O()),2&n){const e=v();T("ngClass","player"+e.getCurrentPlayer().value)("ngClass",e.getClockCircleClasses()),D("x",.5*e.SPACE_SIZE)("y",.5*e.SPACE_SIZE),S(1),a1(e.countDown.get())}}function $0t(n,t){if(1&n&&(B(),X(0,"polyline",24)),2&n){const e=v();T("ngClass",e.getClockCircleClasses()),D("points",e.clockNeedlesPoints)}}const BP=function(n){return[n]};function U0t(n,t){if(1&n){const e=Oe();B(),ln(0),b(1,"g",27),J("click",function(){const i=fe(e).index;return ae(v(2).chooseStyle(i))}),O(),un()}if(2&n){const e=t.$implicit,r=t.index,s=v(2);S(1),p2(e.style),T("id",e.name)("pieceClasses",g3(5,BP,"player"+s.getCurrentPlayer().value+"-fill")),D("transform","translate(0, "+-(r+1)*s.SPACE_SIZE+")")}}function G0t(n,t){if(1&n&&(B(),b(0,"g",25),X(1,"rect",26),x(2,U0t,2,7,"ng-container",1),O()),2&n){const e=v();S(1),D("x",0)("y",-e.listOfStyles.length*e.SPACE_SIZE)("width",1*e.SPACE_SIZE)("height",e.listOfStyles.length*e.SPACE_SIZE),S(1),T("ngForOf",e.listOfStyles)}}function W0t(n,t){if(1&n&&(B(),b(0,"text",33),Pt(1),O()),2&n){const e=v(2).$implicit,r=v().$implicit,s=v();T("ngClass",s.getPlayerClass(r)),D("x",s.SPACE_SIZE/2)("y",s.SPACE_SIZE/2),S(1),a1(e+" x ")}}function q0t(n,t){if(1&n&&(B(),X(0,"g",34)),2&n){const e=v(3).$implicit,r=v();p2(r.style),T("pieceClasses",g3(3,BP,r.getPlayerClass(e)))}}function j0t(n,t){if(1&n&&(B(),X(0,"g",35)),2&n){const e=v(3).$implicit,r=v();p2(r.style),T("pieceClasses",g3(3,BP,r.getPlayerClass(e)))}}function Z0t(n,t){if(1&n&&(B(),X(0,"g",36)),2&n){const e=v(3).$implicit,r=v();p2(r.style),T("pieceClasses",g3(3,BP,r.getPlayerClass(e)))}}function Y0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,W0t,2,4,"text",29),b(2,"g",28),x(3,q0t,1,5,"g",30),x(4,j0t,1,5,"g",31),x(5,Z0t,1,5,"g",32),O()()),2&n){const e=v(),r=e.index,s=e.$implicit,i=v().$implicit,o=v();D("transform","translate(0, "+2*r*o.SPACE_SIZE+")"),S(1),T("ngIf",s>1),S(1),We("id","piece_",r,"_player_",i.value,""),D("transform","translate("+o.SPACE_SIZE+", 0)"),S(1),T("ngIf",0===r),S(1),T("ngIf",1===r),S(1),T("ngIf",2===r)}}function K0t(n,t){if(1&n&&(B(),b(0,"g"),x(1,Y0t,6,8,"g",13),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e>0)}}function X0t(n,t){if(1&n&&(B(),b(0,"g")(1,"g",28),x(2,K0t,2,1,"g",1),O()()),2&n){const e=t.$implicit,r=v();S(1),C1("id","capture_of_player_",e.value,""),D("transform",r.getCapturesTransformation(e)),S(1),T("ngForOf",r.state.getCapturesOf(e))}}let zo=(()=>{class n extends No{constructor(e){super(e),this.INDICATOR_SIZE=20,this.HORIZONTAL_CENTER=2*n.SPACE_SIZE,this.VERTICAL_CENTER=4*n.SPACE_SIZE+n.STROKE_WIDTH,this.LEFT=n.SPACE_SIZE/-4+n.STROKE_WIDTH/-2,this.UP=-n.STROKE_WIDTH/2,this.WIDTH=6.5*n.SPACE_SIZE+n.STROKE_WIDTH,this.HEIGHT=8*n.SPACE_SIZE+3*n.STROKE_WIDTH,this.MartianChessComponent=n,this.style={shape:"Circle",points:"Horizontal Points"},this.pieces=Dt,this.selectedPieceInfo=P.empty(),this.countDown=P.empty(),this.callTheClock=!1,this.displayModePanel=!1,this.listOfStyles=[{name:"Star",style:{shape:"Star",points:"Dots"}},{name:"Polygon",style:{shape:"Polygon",points:"Concentric Circles"}},{name:"Simple",style:{shape:"Circle",points:"Horizontal Points"}},{name:"Circely",style:{shape:"Circle",points:"Concentric Circles"}}],this.hasAsymetricBoard=!0,this.rules=new T9(Ls),this.availableMinimaxes=[new x0t(this.rules,"Martian Chess Dummy Minimax")],this.SPACE_SIZE=n.SPACE_SIZE,this.configCogTransformation=this.getConfigCogTransformation(),this.configViewTranslation=this.getConfigViewTranslation(),this.clockNeedlesPoints=this.getClockNeedlesPoints(),this.encoder=ms.encoder,this.tutorial=(new g3e).tutorial,this.scores=P.of([0,0]),this.updateBoard()}static getRegularPolygon(e,r=0){const s=n.getRegularPolygonCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStar(e,r){const s=this.getNPointedStarCoords(e,r);return n.mapCoordsToString(s)}static getNPointedStarCoords(e,r){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;e*=2;for(let c=0;c<e;c++){const h=(c*(360/e)+r)/180*Math.PI,p=c%2==0?n.SPACE_SIZE/2:n.SPACE_SIZE/6,m=i+.8*p*Math.cos(h),C=o+.8*p*Math.sin(h);s.push(new M(m,C))}return s}static getRegularPolygonCoords(e,r=0){const s=[],i=.5*n.SPACE_SIZE,o=.5*n.SPACE_SIZE;for(let c=0;c<e;c++){const h=(c*(360/e)-90)/180*Math.PI,p=.5*n.SPACE_SIZE,m=i+.8*p*Math.cos(h),C=o+.8*p*Math.sin(h)+r;s.push(new M(m,C))}return s}static mapCoordsToString(e){let r="";for(const s of e)r+=s.x+", "+s.y+" ";return r}static getRadius(e){return this.SPACE_SIZE*e/10}getConfigViewTranslation(){return"translate("+(5.25*this.SPACE_SIZE+0)+", "+(7*this.SPACE_SIZE+0+2*this.STROKE_WIDTH)+")"}getConfigCogTransformation(){const e=this.STROKE_WIDTH,s=(this.SPACE_SIZE-e)/40;return"translate("+1*e+", "+1*e+") scale("+s+" "+s+")"}getClockNeedlesPoints(){const e=.5*this.SPACE_SIZE;return e+" "+.1*this.SPACE_SIZE+", "+e+" "+e+", "+.75*this.SPACE_SIZE+" "+e}updateBoard(){this.state=this.getState(),this.board=this.state.board;const e=this.state.getScoreOf(z.ZERO),r=this.state.getScoreOf(z.ONE);this.countDown=this.state.countDown,this.scores=P.of([e,r])}getPieceLocation(e,r){return"translate("+this.SPACE_SIZE*e+", "+this.SPACE_SIZE*r+")"}getPieceClasses(e,r){const s=new M(e,r),i=[];return i.push(r>3?"player0-fill":"player1-fill"),this.selectedPieceInfo.isPresent()&&this.selectedPieceInfo.get().selectedPiece.equals(s)&&i.push("selected-stroke"),this.rules.node.move.isPresent()&&this.rules.node.move.get().getEnd().equals(s)&&this.rules.node.mother.get().gameState.getPieceAt(s)!==Dt.EMPTY&&this.getState().isInOpponentTerritory(new M(0,r))&&i.push("last-move-stroke"),i}onClick(e,r){var s=this;return A(function*(){s.displayModePanel=!1;const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new M(e,r);return s.selectedPieceInfo.isPresent()?s.secondClick(o):s.firstClick(o)})()}firstClick(e){var r=this;return A(function*(){return r.isOneOfUsersPieces(e)?r.selectAsFirstPiece(e):(r.cancelMoveAttempt(),U.SUCCESS)})()}selectAsFirstPiece(e){var r=this;return A(function*(){const s=r.getLegalLandings(e);return r.selectedPieceInfo=P.of({selectedPiece:e,legalLandings:s}),U.SUCCESS})()}getLegalLandings(e){const r=this.state.getPieceAt(e);let s;return s=r===Dt.PAWN?be.DIAGONALS.map(i=>e.getNext(i)):this.getValidLinearLandingSquareUntil(e,r===Dt.DRONE?2:8),s.filter(i=>{const o=ms.from(e,i);return!!o.isSuccess()&&this.rules.isLegal(o.get(),this.getState()).isSuccess()})}getValidLinearLandingSquareUntil(e,r){return be.DIRECTIONS.flatMap(s=>{const i=[];let o=e.getNext(s),c=1;for(;o.isInRange(4,8)&&c<=r&&(i.push(o),this.getState().getPieceAt(o)===Dt.EMPTY);)o=o.getNext(s),c++;return i})}secondClick(e){var r=this;return A(function*(){const s=r.selectedPieceInfo.get();if(s.selectedPiece.equals(e))return r.cancelMoveAttempt(),U.SUCCESS;if(s.legalLandings.some(i=>i.equals(e))){const i=ms.from(s.selectedPiece,e,r.callTheClock);ye(i.isSuccess(),"MartianChessComponent or Rules did a mistake thinking this would have been a legal move!");const o=r.getState();return r.chooseMove(i.get(),o)}if(r.isOneOfUsersPieces(e))return r.selectAsFirstPiece(e);{const i=ms.from(s.selectedPiece,e,r.callTheClock);return i.isSuccess()?r.chooseMove(i.get(),r.getState()):r.cancelMove(i.getReason())}})()}isOneOfUsersPieces(e){return this.state.getPieceAt(e)!==Dt.EMPTY&&this.state.isInPlayerTerritory(e)}cancelMoveAttempt(){this.selectedPieceInfo=P.empty(),this.callTheClock=!1}onClockClick(){var e=this;return A(function*(){const r=e.canUserPlay("#clockOrCountDownView");return r.isFailure()?e.cancelMove(r.getReason()):(e.getState().countDown.isAbsent()&&(e.callTheClock=!e.callTheClock),U.SUCCESS)})()}getClockCircleClasses(){const e=["base"];return this.callTheClock&&e.push("selected-stroke"),this.getCurrentPlayer()===z.ZERO?e.push("player0-stroke"):e.push("player1-stroke"),e}getSquareClasses(e,r){const s=new M(e,r),i=["base"];if(this.rules.node.move.isPresent()){const o=this.rules.node,c=o.move.get();c.getStart().equals(s)?i.push("moved-fill"):c.getEnd().equals(s)&&(o.mother.get().gameState.getPieceAt(s)===Dt.EMPTY||o.gameState.isInOpponentTerritory(new M(0,r))?i.push("moved-fill"):i.push("captured-fill"))}return i}onModeCogClick(){this.displayModePanel=!this.displayModePanel}chooseStyle(e){this.style=this.listOfStyles[e].style,this.displayModePanel=!1}getPieceTranslation(e){return"translate(0, "+(e<=3?0:2*this.STROKE_WIDTH)+")"}getBoardTransformation(){return"translate("+this.SPACE_SIZE+", 0) rotate("+180*this.role.value+" "+this.HORIZONTAL_CENTER+" "+this.VERTICAL_CENTER+")"}getCapturesTransformation(e){let i=this.SPACE_SIZE/2;return e===this.role&&(i+=10*this.SPACE_SIZE+4*this.STROKE_WIDTH),"scale(0.5, 0.5) translate("+-this.SPACE_SIZE/2+", "+i+")"}}return n.SPACE_SIZE=100,n.STROKE_WIDTH=8,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-martian-chess"]],features:[l],decls:15,vars:19,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["id","clockOrCountDownView",3,"click"],["x","0","y","0",1,"transparent"],["id","clockOrCountDownCircle",3,"ngClass"],["id","countDownText","class","text-giant text-center",3,"ngClass",4,"ngIf"],["class","base","stroke-linecap","round",3,"ngClass",4,"ngIf"],["id","modeCogView"],["id","modeCog",3,"click"],["d","M35.497,15.111h-1.656c-0.282-0.924-0.653-1.807-1.102-2.646l1.176-1.175c1.364-1.366,1.366-3.582,0-4.949l-1.258-1.258 c-0.656-0.656-1.548-1.025-2.476-1.025l0,0c-0.93,0-1.818,0.369-2.477,1.025l-1.176,1.175c-0.838-0.446-1.721-0.817-2.645-1.102 V3.501c0-1.934-1.566-3.5-3.5-3.5h-1.778c-1.934,0-3.5,1.566-3.5,3.5v1.655c-0.923,0.282-1.807,0.653-2.645,1.102l-1.174-1.175 c-1.367-1.367-3.584-1.367-4.951,0L5.081,6.34c-1.367,1.366-1.367,3.583,0,4.949l1.174,1.175c-0.446,0.84-0.818,1.723-1.102,2.646 H3.5c-1.934,0-3.5,1.566-3.5,3.5v1.778c0,1.932,1.566,3.5,3.5,3.5h1.654c0.283,0.922,0.654,1.807,1.102,2.645l-1.175,1.176 c-1.366,1.365-1.366,3.582-0.001,4.949l1.258,1.258c0.656,0.654,1.547,1.023,2.475,1.023h0.001c0.929,0,1.818-0.369,2.475-1.023 l1.176-1.176c0.837,0.447,1.722,0.818,2.644,1.102v1.656c0,1.932,1.566,3.5,3.5,3.5h1.778c1.934,0,3.5-1.568,3.5-3.5v-1.656 c0.924-0.283,1.807-0.654,2.645-1.102l1.177,1.176c0.655,0.656,1.547,1.023,2.476,1.023c0.93,0,1.817-0.369,2.477-1.023 l1.256-1.258c1.366-1.367,1.365-3.582,0-4.949l-1.176-1.174c0.447-0.84,0.818-1.725,1.102-2.646h1.656c1.934,0,3.5-1.568,3.5-3.5 v-1.777C38.997,16.679,37.43,15.111,35.497,15.111z M19.499,27.499c-4.41,0-8-3.588-8-8c0-4.411,3.59-8,8-8c4.412,0,8,3.589,8,8 C27.499,23.911,23.911,27.499,19.499,27.499z",3,"ngClass"],["id","modePanel",4,"ngIf"],["id","captures"],[3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"id","click"],[3,"id","ngClass"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId","style",4,"ngIf"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses","style",4,"ngIf"],["app-martian-chess-pawn","",3,"mainShapeId","pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses","mainShapeId"],["app-martian-chess-queen","",3,"mainShapeId","pieceClasses"],[1,"indicator",3,"id","click"],["id","countDownText",1,"text-giant","text-center",3,"ngClass"],["stroke-linecap","round",1,"base",3,"ngClass"],["id","modePanel"],["stroke-width","8",1,"base"],["app-martian-chess-queen","",3,"id","pieceClasses","click"],[3,"id"],["class","text-giant text-center",3,"ngClass",4,"ngIf"],["app-martian-chess-pawn","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-drone","",3,"pieceClasses","style",4,"ngIf"],["app-martian-chess-queen","",3,"pieceClasses","style",4,"ngIf"],[1,"text-giant","text-center",3,"ngClass"],["app-martian-chess-pawn","",3,"pieceClasses"],["app-martian-chess-drone","",3,"pieceClasses"],["app-martian-chess-queen","",3,"pieceClasses"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g"),x(2,F0t,3,2,"g",1),O(),b(3,"g",2),J("click",function(){return r.onClockClick()}),X(4,"rect",3)(5,"circle",4),x(6,B0t,2,5,"text",5),x(7,$0t,1,2,"polyline",6),O(),b(8,"g",7)(9,"g",8),J("click",function(){return r.onModeCogClick()}),X(10,"rect",3)(11,"path",9),O(),x(12,G0t,3,5,"g",10),O(),b(13,"g",11),x(14,X0t,3,3,"g",1),O()()),2&e&&(D("viewBox",r.LEFT+" "+r.UP+" "+r.WIDTH+" "+r.HEIGHT),S(1),D("transform",r.getBoardTransformation()),S(1),T("ngForOf",r.board),S(1),D("transform","translate("+5.25*r.SPACE_SIZE+", 0)"),S(1),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngClass",r.getClockCircleClasses()),D("cx",.5*r.SPACE_SIZE)("cy",.5*r.SPACE_SIZE)("r",.4*r.SPACE_SIZE),S(1),T("ngIf",r.countDown.isPresent()),S(1),T("ngIf",r.countDown.isAbsent()),S(1),D("transform",r.configViewTranslation),S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngClass",r.getPlayerClass(r.getCurrentPlayer())),D("transform",r.configCogTransformation),S(1),T("ngIf",r.displayModePanel),S(2),T("ngForOf",r.Player.PLAYERS))},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class c6 extends ps{static getInitialState(){const t=Ke.createTable(7,6,pe.NONE);return new c6(t,0)}}class x1 extends $i{constructor(t){super(),this.x=t}static of(t){switch(t){case 0:return x1.ZERO;case 1:return x1.ONE;case 2:return x1.TWO;case 3:return x1.THREE;case 4:return x1.FOUR;case 5:return x1.FIVE;case 6:return x1.SIX;default:throw new Error("Invalid P4Move")}}equals(t){return this===t}toString(){return"P4Move("+this.x+")"}}x1.ZERO=new x1(0),x1.ONE=new x1(1),x1.TWO=new x1(2),x1.THREE=new x1(3),x1.FOUR=new x1(4),x1.FIVE=new x1(5),x1.SIX=new x1(6),x1.encoder=new class extends Cn{maxValue(){return 6}encodeNumber(n){return n.x}decodeNumber(n){return x1.of(n)}};let Q0t=(()=>{class n{}return n.COLUMN_IS_FULL=()=>$localize`Please put your piece in an incomplete column.`,n})();class m3e{constructor(t,e,r){this.isInRange=t,this.getOwner=e,this.N=r}getSquareScore(t,e){const r=t.getPieceAt(e),s=this.getOwner(r);ye(s.isPlayer(),"getSquareScore should not be called with PlayerOrNone.NONE piece");const i=new zn,o=new zn;for(const u of be.DIRECTIONS){const h=this.getNumberOfFreeSpacesAndAllies(t,e,u,s);i.set(u,h[0]),o.set(u,h[1])}return this.getScoreFromDirectionAlliesAndFreeSpaces(o,i)*s.getScoreModifier()}getScoreFromDirectionAlliesAndFreeSpaces(t,e){let r=0;for(const s of[be.UP,be.UP_RIGHT,be.RIGHT,be.DOWN_RIGHT]){if(t.get(s).get()+t.get(s.getOpposite()).get()+1>=this.N)return Number.MAX_SAFE_INTEGER;const p=e.get(s).get()+e.get(s.getOpposite()).get();p+1>=this.N&&(r+=2+p-this.N)}return r}getNumberOfFreeSpacesAndAllies(t,e,r,s){let i=0,o=0,c=!0,u=new M(e.x+r.x,e.y+r.y),h=1;const p=s.getOpponent();for(;this.isInRange(u)&&h<this.N;){const m=t.getPieceAt(u);if(this.getOwner(m)===p)return[i,o];this.getOwner(m)===s&&c?o++:c=!1,m!==p&&m!==s&&i++,u=u.getNext(r),h++}return[i,o]}}class kr extends Z1{static getOwner(t){return t}static isInRange(t){return t.isInRange(7,6)}static getVictoriousCoords(t){const e=[];for(let r=0;r<7;r++)for(let s=5;-1!==s&&t.board[s][r].isPlayer();s--){const i=kr.getSquareScore(t,new M(r,s));(i===z.ZERO.getVictoryValue()||i===z.ONE.getVictoryValue())&&e.push(new M(r,s))}return e}static getBoardValueFromScratch(t){K(kr.VERBOSE,{P4Rules_getBoardValueFromScratch:{state:t}});let e=0;for(let r=0;r<7;r++)for(let s=5;-1!==s&&t.board[s][r].isPlayer();s--){const i=kr.getSquareScore(t,new M(r,s));if(B1.getScoreStatus(i)!==yn.DEFAULT)return K(kr.VERBOSE,{preVictoryOrVictory:{state:t,squareScore:i,coord:{x:r,y:s}}}),new Ct(i);e+=i}return new Ct(e)}static getLowestUnoccupiedSpace(t,e){let r=0;for(;r<6&&t[r][e]===pe.NONE;)r++;return r-1}static getSquareScore(t,e){return K(kr.VERBOSE,"getSquareScore(board, "+e.x+", "+e.y+") called"),K(kr.VERBOSE,t.board),kr.P4_HELPER.getSquareScore(t,e)}static getListMoves(t){K(kr.VERBOSE,{context:"P4Rules.getListMoves",node:t});const e=t.gameState,r=[];for(let s=0;s<7;s++)if(e.getPieceAtXY(s,0)===pe.NONE){const i=x1.of(s);r.push(i)}return r}static getBoardValue(t){return K(kr.VERBOSE,{text:"P4Rules.getBoardValue called",board:t.getCopiedBoard()}),kr.getBoardValueFromScratch(t)}applyLegalMove(t,e,r){const s=t.x,i=e.getCopiedBoard(),o=kr.getLowestUnoccupiedSpace(i,s),c=e.turn;return i[o][s]=e.getCurrentPlayer(),new c6(i,c+1)}isLegal(t,e){return K(kr.VERBOSE,{context:"P4Rules.isLegal",move:t.toString(),state:e}),e.getPieceAtXY(t.x,0).isPlayer()?$.failure(Q0t.COLUMN_IS_FULL()):$.success(void 0)}getGameStatus(t){const e=t.gameState;for(let r=0;r<7;r++)for(let s=5;s>=0&&e.board[s][r].isPlayer();s--){const i=kr.getSquareScore(e,new M(r,s));if(B1.getScoreStatus(i)===yn.VICTORY)return xe.getVictory(e.getCurrentOpponent())}return 42===e.turn?xe.DRAW:xe.ONGOING}}kr.VERBOSE=!1,kr.P4_HELPER=new m3e(kr.isInRange,kr.getOwner,4);class J0t extends $1{getListMoves(t){return kr.getListMoves(t).sort((e,r)=>Math.abs(e.x-3)-Math.abs(r.x-3))}getBoardValue(t){const e=t.gameState;return K(kr.VERBOSE,{text:"P4Rules instance methods getBoardValue called",board:e.getCopiedBoard()}),kr.getBoardValue(e)}}const yt=pe.NONE,l6=pe.ZERO,w9=pe.ONE;class _3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The board at Four in a Row is made of 7 columns and 6 rows, and it is initially empty.
        The first player plays Dark, the second plays Light.
        The goal is to be the first to align 4 of its pieces (horizontally, vertically, or diagonally).`,c6.getInitialState()),ce.anyMove($localize`Dropping a piece`,$localize`Click on any space in any column.`,c6.getInitialState(),x1.THREE,$localize`As you can see, the piece falls at the bottom of the column.`),ce.fromMove($localize`Victory`,$localize`You're playing Dark.
        Place your piece so that you create a horizontal alignment of 4 of your pieces.`,new c6([[yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,w9,yt,yt,yt],[yt,yt,yt,w9,yt,yt,yt],[yt,yt,l6,l6,l6,w9,yt]],0),[x1.of(1)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`),ce.fromMove($localize`Other victory`,$localize`You can also align 4 pieces diagonally or vertically.`,new c6([[yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,yt,yt,yt,yt],[yt,yt,yt,l6,w9,yt,yt],[yt,yt,l6,l6,w9,yt,yt],[yt,l6,w9,l6,l6,yt,yt]],0),[x1.of(3),x1.of(4)],$localize`You won!`,$localize`Failed, you have not aligned 4 pieces and missed an opportunity to win.`)]}}function e8t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getSquareFillClass(e,r)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)}}function t8t(n,t){if(1&n){const e=Oe();B(),b(0,"g",5),J("click",function(){const i=fe(e).index;return ae(v(2).onClick(i))}),X(1,"rect",6),x(2,e8t,1,4,"circle",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();C1("id","click_",r,""),S(1),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function n8t(n,t){if(1&n&&(B(),b(0,"g"),x(1,t8t,3,6,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function r8t(n,t){if(1&n&&(B(),X(0,"rect",9)),2&n){const e=v();D("x",e.SPACE_SIZE*e.last.get().x)("y",e.SPACE_SIZE*e.last.get().y)("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function s8t(n,t){if(1&n&&(B(),X(0,"rect",10)),2&n){const e=t.$implicit,r=v();We("id","victory_coord_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let i8t=(()=>{class n extends No{constructor(e){super(e),this.EMPTY=pe.NONE,this.victoryCoords=[],this.rules=new kr(c6),this.availableMinimaxes=[new J0t(this.rules,"P4Minimax")],this.encoder=x1.encoder,this.tutorial=(new _3e).tutorial,this.updateBoard()}onClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#click_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=x1.of(e);return yield r.chooseMove(i,r.getState())})()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.victoryCoords=kr.getVictoriousCoords(e),this.board=e.board,r.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.getState(),r=this.rules.node.move,s=kr.getLowestUnoccupiedSpace(e.board,r.get().x)+1;this.last=P.of(new M(r.get().x,s))}hideLastMove(){this.last=P.empty()}getSquareFillClass(e,r){return[this.getPlayerClass(this.board[r][e])]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-p4"]],features:[l],decls:4,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 708 608","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill last-move-stroke mid-stroke",4,"ngIf"],["class","base no-fill victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"base"],["class","base","pointer-events","fill",3,"ngClass",4,"ngIf"],["pointer-events","fill",1,"base",3,"ngClass"],[1,"base","no-fill","last-move-stroke","mid-stroke"],[1,"base","no-fill","victory-stroke","mid-stroke",3,"id"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,n8t,2,1,"g",1),x(2,r8t,1,4,"rect",2),x(3,s8t,1,6,"rect",3),O()),2&e&&(S(1),T("ngForOf",r.board),S(1),T("ngIf",r.last.isPresent()),S(1),T("ngForOf",r.victoryCoords))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class Rs extends S3{constructor(t,e,r,s=!1){if(super(t,e),this.blockTurned=r,this.turnedClockwise=s,this.coord.isNotInRange(6,6))throw new Error("The board is a 6 cas wide square, invalid coord: "+this.coord.toString())}static withRotation(t,e,r,s){if(r<0||3<r)throw new Error("This block do not exist: "+r);return new Rs(t,e,P.of(r),s)}static rotationless(t,e){return new Rs(t,e,P.empty())}toString(){return this.blockTurned.isPresent()?"PentagoMove("+this.coord.toString()+", "+this.blockTurned.get()+", "+(this.turnedClockwise?"CLOCKWISE":"ANTI-CLOCKWISE")+")":"PentagoMove"+this.coord.toString()}equals(t){return!1!==this.coord.equals(t.coord)&&!1!==this.blockTurned.equals(t.blockTurned)&&this.turnedClockwise===t.turnedClockwise}}Rs.encoder=new class extends M2{encodeMove(n){const t={coord:M.encoder.encode(n.coord)};return n.blockTurned.isPresent()&&(t.blockTurned=n.blockTurned.get(),t.turnedClockwise=n.turnedClockwise),t}decodeMove(n){const t=n,e=M.encoder.decode(t.coord),r=P.ofNullable(t.blockTurned);if(r.isPresent()){const s=t.turnedClockwise;return Rs.withRotation(e.x,e.y,r.get(),s)}return Rs.rotationless(e.x,e.y)}};let v3e=(()=>{class n{}return n.CANNOT_ROTATE_NEUTRAL_BLOCK=()=>$localize`If the quadrant to turn is neutral, please just use move without rotation.`,n.MUST_CHOOSE_BLOCK_TO_ROTATE=()=>$localize`No quadrant is neutral, you must pick a quadrant to rotate.`,n})();class L2 extends ps{constructor(t,e){super(t,e),this.neutralBlocks=this.getBlocksNeutralities()}static getInitialState(){const t=Ke.createTable(6,6,pe.NONE);return new L2(t,0)}getBlocksNeutralities(){const t=[];for(let e=0;e<4;e++)this.getBlockNeutrality(e)&&t.push(e);return t}getBlockNeutrality(t){const e=L2.getBlockCenter(t),r=this.getPieceAt(e.getNext(be.UP,1)),s=this.getPieceAt(e.getNext(be.UP_LEFT,1));return this.getPieceAt(e.getNext(be.RIGHT,1))===r&&this.getPieceAt(e.getNext(be.DOWN,1))===r&&this.getPieceAt(e.getNext(be.LEFT,1))===r&&this.getPieceAt(e.getNext(be.UP_RIGHT,1))===s&&this.getPieceAt(e.getNext(be.DOWN_RIGHT,1))===s&&this.getPieceAt(e.getNext(be.DOWN_LEFT,1))===s}static getBlockCenter(t){return new M(1+(t%2==0?0:3),1+(t<2?0:3))}applyLegalDrop(t){const e=this.getCopiedBoard();return e[t.coord.y][t.coord.x]=this.getCurrentPlayer(),new L2(e,this.turn)}applyLegalMove(t){const e=this.applyLegalDrop(t),r=e.getCopiedBoard();if(t.blockTurned.isPresent()){const i=L2.getBlockCenter(t.blockTurned.get()).toVector();if(t.turnedClockwise)for(const o of L2.ROTATION_MAP){const c=o[0].getNext(i),u=o[1].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}else for(const o of L2.ROTATION_MAP){const c=o[1].getNext(i),u=o[0].getNext(i),h=e.getPieceAt(c);r[u.y][u.x]=h}}return new L2(r,this.turn+1)}blockIsNeutral(t){return this.neutralBlocks.includes(t)}}L2.ROTATION_MAP=[[new M(-1,-1),new M(1,-1)],[new M(0,-1),new M(1,0)],[new M(1,-1),new M(1,1)],[new M(1,0),new M(0,1)],[new M(1,1),new M(-1,1)],[new M(0,1),new M(-1,0)],[new M(-1,1),new M(-1,-1)],[new M(-1,0),new M(0,-1)]];class L3 extends Z1{static get(){return L3.singleton.isAbsent()&&(L3.singleton=P.of(new L3(L2))),L3.singleton.get()}applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){if(e.getPieceAt(t.coord).isPlayer())return $.failure(rt.MUST_LAND_ON_EMPTY_SPACE());const r=e.applyLegalDrop(t);if(0===r.neutralBlocks.length){if(t.blockTurned.isAbsent())return $.failure(v3e.MUST_CHOOSE_BLOCK_TO_ROTATE())}else if(t.blockTurned.isPresent()){const s=t.blockTurned.get();if(r.neutralBlocks.includes(s))return $.failure(v3e.CANNOT_ROTATE_NEUTRAL_BLOCK())}return $.success(void 0)}getVictoryCoords(t){let e=[];for(const r of L3.VICTORY_SOURCE){const s=t.getPieceAt(r[0]),i=[r[0]];if(s.isPlayer()){let o=r[0].getNext(r[1]),c=!0;for(let u=0;u<3&&c;u++)t.getPieceAt(o)!==s?c=!1:(i.push(o),o=o.getNext(r[1]));if(c&&(t.getPieceAt(o)===s&&(i.push(o),e=e.concat(i)),r[2])){const u=r[0].getPrevious(r[1],1);t.getPieceAt(u)===s&&(i.push(u),e=e.concat(i))}}}return e}getGameStatus(t){const e=t.gameState,r=this.getVictoryCoords(e),s=[!1,!1];for(let i=0;i<r.length;i+=5)s[e.getPieceAt(r[i]).value]=!0;return!0===s[0]?!0===s[1]?xe.DRAW:xe.ZERO_WON:!0===s[1]?xe.ONE_WON:36===e.turn?xe.DRAW:xe.ONGOING}}L3.singleton=P.empty(),L3.VICTORY_SOURCE=[[new M(1,0),new Ut(1,1),!1],[new M(0,1),new Ut(1,1),!1],[new M(4,0),new Ut(-1,1),!1],[new M(5,1),new Ut(-1,1),!1],[new M(1,1),new Ut(1,1),!0],[new M(4,1),new Ut(-1,1),!0],[new M(0,1),new Ut(0,1),!0],[new M(1,1),new Ut(0,1),!0],[new M(2,1),new Ut(0,1),!0],[new M(3,1),new Ut(0,1),!0],[new M(4,1),new Ut(0,1),!0],[new M(5,1),new Ut(0,1),!0],[new M(1,0),new Ut(1,0),!0],[new M(1,1),new Ut(1,0),!0],[new M(1,2),new Ut(1,0),!0],[new M(1,3),new Ut(1,0),!0],[new M(1,4),new Ut(1,0),!0],[new M(1,5),new Ut(1,0),!0]];class $P extends $1{getListMoves(t){const e=[],r=t.gameState.neutralBlocks;if(0===t.gameState.turn)return $P.FIRST_TURN_MOVES;const s=this.getLegalDrops(t.gameState);for(const i of s){const o=Rs.rotationless(i.x,i.y),c=t.gameState.applyLegalDrop(o),u=this.getLegalRotations(c,r);for(const p of u)e.push(Rs.withRotation(i.x,i.y,p[0],p[1]));0===c.neutralBlocks.length==0&&e.push(o)}return e}getLegalDrops(t){const e=[];for(let r=0;r<6;r++)for(let s=0;s<6;s++){const i=new M(s,r);t.getPieceAt(i)===pe.NONE&&e.push(i)}return e}getLegalRotations(t,e){const r=0===t.neutralBlocks.length,s=[];for(let i=0;i<4;i++)!1===t.blockIsNeutral(i)&&(e.includes(i)?r&&s.push([i,!0]):s.push([i,!0],[i,!1]));return s}getBoardValue(t){return L3.get().getGameStatus(t).toBoardValue()}}$P.FIRST_TURN_MOVES=[Rs.rotationless(0,0),Rs.rotationless(1,0),Rs.rotationless(2,0),Rs.rotationless(0,1),Rs.rotationless(1,1),Rs.rotationless(0,2)];const Ze=pe.NONE,z4=pe.ZERO,u6=pe.ONE;class C3e{constructor(){this.tutorial=[ce.informational($localize`Initial board`,$localize`The initial Pentago board is made of 6x6 spaces, subdivided in 4 quadrants, which can each rotate.`,L2.getInitialState()),ce.informational($localize`Goal of the game`,$localize`The goal at Pentago is to align 5 of your pieces. In the following board, Dark wins.`,new L2([[z4,Ze,Ze,z4,u6,Ze],[z4,u6,Ze,Ze,Ze,Ze],[z4,Ze,u6,Ze,Ze,Ze],[z4,Ze,Ze,Ze,Ze,u6],[z4,Ze,Ze,Ze,u6,Ze],[Ze,Ze,Ze,Ze,Ze,Ze]],10)).withPreviousMove(Rs.withRotation(0,0,0,!1)),ce.fromPredicate($localize`Simple move`,$localize`At their turn, players put a piece on the board and possibly rotate one quadrant.
        As long as there are neutral quadrants, i.e., quadrants that would not change after being rotated, a player may skip rotating a quadrant.
        To do this, you have to click on the crossed circle that appears at the center of the board when it is possible.<br/><br/>
        You're playing dark, do a simple move.`,new L2([[Ze,Ze,Ze,Ze,Ze,Ze],[Ze,z4,Ze,Ze,u6,Ze],[Ze,Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze,Ze],[Ze,u6,Ze,Ze,z4,Ze],[Ze,Ze,Ze,Ze,Ze,Ze]],10),Rs.rotationless(2,2),(t,e,r)=>t.blockTurned.isPresent()?U.failure($localize`You have made a move with a rotation. This tutorial step is about moves without rotations!`):U.SUCCESS,$localize`Congratulations!`),ce.fromPredicate($localize`Move with rotation`,$localize`After putting a piece, arrows will appear on non-neutral quadrants.<br/><br/>
        You're playing Dark, place a piece on a quadrant and do a rotation!`,new L2([[Ze,Ze,Ze,Ze,Ze,Ze],[Ze,z4,Ze,Ze,u6,Ze],[Ze,Ze,Ze,Ze,Ze,Ze],[Ze,Ze,Ze,Ze,Ze,Ze],[Ze,u6,Ze,Ze,z4,Ze],[Ze,Ze,Ze,Ze,Ze,Ze]],10),Rs.withRotation(0,0,0,!0),(t,e,r)=>t.blockTurned.isPresent()?U.SUCCESS:U.failure($localize`You made a move without rotation, try again!`),$localize`Congratulations! Note that if all quadrants are neutral after you have put your piece, there will be no rotation.`)]}}function o8t(n,t){if(1&n){const e=Oe();B(),ln(0),b(1,"circle",9),J("click",function(){const i=fe(e).$implicit,o=v().$implicit,c=v().index,u=v().index;return ae(v().onClick(3*c+i,3*u+o))}),O(),un()}if(2&n){const e=t.$implicit,r=v().$implicit,s=v(),i=s.index,o=s.$implicit,c=v(),u=c.index,h=c.$implicit,p=v();S(1),We("id","click_",3*i+e,"_",3*u+r,""),T("ngClass",p.getSquareClasses(3*i+e,3*u+r)),D("cx",o+2*p.STROKE_WIDTH+(e+.5)*p.SPACE_SIZE)("cy",h+2*p.STROKE_WIDTH+(r+.5)*p.SPACE_SIZE)("r",(p.SPACE_SIZE-p.STROKE_WIDTH)/2)}}const y3e=function(){return[0,1,2]};function a8t(n,t){1&n&&(B(),ln(0),x(1,o8t,2,6,"ng-container",3),un()),2&n&&(S(1),T("ngForOf",tr(1,y3e)))}function c8t(n,t){if(1&n&&(B(),ln(0),X(1,"rect",8),x(2,a8t,2,2,"ng-container",3),un()),2&n){const e=t.$implicit,r=t.index,s=v(),i=s.index,o=s.$implicit,c=v();S(1),T("ngClass",c.getBlockClasses(r,i)),D("x",c.STROKE_WIDTH+e)("y",c.STROKE_WIDTH+o)("rx",3*c.STROKE_WIDTH)("ry",3*c.STROKE_WIDTH)("width",c.BLOCK_WIDTH)("height",c.BLOCK_WIDTH),S(1),T("ngForOf",tr(8,y3e))}}const E3e=function(n){return[0,n]};function l8t(n,t){if(1&n&&(B(),ln(0),x(1,c8t,3,9,"ng-container",3),un()),2&n){const e=v();S(1),T("ngForOf",g3(1,E3e,e.BLOCK_SEPARATION))}}function u8t(n,t){if(1&n&&(B(),X(0,"circle",10)),2&n){const e=v();We("id","currentDrop_",e.currentDrop.get().x,"_",e.currentDrop.get().y,""),T("ngClass",e.getPlayerClass(e.getCurrentPlayer())),D("cx",e.getCenter(e.currentDrop.get().x))("cy",e.getCenter(e.currentDrop.get().y))("r",(e.SPACE_SIZE-e.STROKE_WIDTH)/2)}}function f8t(n,t){if(1&n){const e=Oe();B(),b(0,"path",11),J("click",function(){const i=fe(e).$implicit;return ae(v().rotate(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","rotate_",e[1],"_",e[2]?"clockwise":"counterclockwise",""),D("d",e[0])("stroke-width",2*r.STROKE_WIDTH)}}function h8t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=t.$implicit,r=v();We("id","victoryCoord_",e.x,"_",e.y,""),T("ngClass",r.getSquareClasses(e.x,e.y)),D("cx",r.getCenter(e.x))("cy",r.getCenter(e.y))("r",(r.SPACE_SIZE-r.STROKE_WIDTH)/2)("stroke-width",r.STROKE_WIDTH)}}function d8t(n,t){if(1&n){const e=Oe();B(),b(0,"g",13),J("click",function(){return fe(e),ae(v().skipRotation())}),X(1,"circle",14)(2,"line",15),O()}if(2&n){const e=v();S(1),D("cx",e.BLOCK_SEPARATION)("cy",e.BLOCK_SEPARATION)("r",.75*e.SPACE_SIZE)("stroke-width",2*e.STROKE_WIDTH),S(1),D("x1",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("y1",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("x2",e.BLOCK_SEPARATION+e.DIAGONAL_BAR_OFFSET)("y2",e.BLOCK_SEPARATION-e.DIAGONAL_BAR_OFFSET)("stroke-width",2*e.STROKE_WIDTH)}}let p8t=(()=>{class n extends No{constructor(e){super(e),this.arrows=[],this.victoryCoords=[],this.rules=L3.get(),this.availableMinimaxes=[new $P(this.rules,"PentagoMinimax")],this.encoder=Rs.encoder,this.tutorial=(new C3e).tutorial,this.BLOCK_WIDTH=3*this.SPACE_SIZE+2*this.STROKE_WIDTH,this.BLOCK_SEPARATION=this.BLOCK_WIDTH+2*this.STROKE_WIDTH,this.DIAGONAL_BAR_OFFSET=.75*Math.cos(Math.PI/4)*this.SPACE_SIZE,this.ARROWS=this.generateArrowsCoord(),this.updateBoard()}updateBoard(){this.board=this.getState().getCopiedBoard(),this.victoryCoords=this.rules.getVictoryCoords(this.getState()),this.showLastMove()}showLastMove(){const e=this.rules.node.move;if(this.cancelMoveAttempt(),e.isAbsent())this.hidePreviousMove();else{const r=e.get();this.movedBlock=r.blockTurned;const s=new M(r.coord.x%3-1,r.coord.y%3-1);if(r.blockTurned.isPresent()&&!1===s.equals(new M(0,0))&&this.coordBelongToBlock(r)){let i;i=r.turnedClockwise?we.getNonNullable(L2.ROTATION_MAP.find(h=>h[0].equals(s)))[1]:we.getNonNullable(L2.ROTATION_MAP.find(h=>h[1].equals(s)))[0];const o=r.blockTurned.get();i=i.getNext(new Ut(o%2==0?1:4,o<2?1:4),1),this.lastDrop=P.of(i)}else this.lastDrop=P.of(r.coord)}}coordBelongToBlock(e){return e.blockTurned.equalsValue(2*(e.coord.y<3?0:1)+(e.coord.x<3?0:1))}hidePreviousMove(){this.lastDrop=P.empty(),this.movedBlock=P.empty(),this.victoryCoords=[]}generateArrowsCoord(){const e=2*this.BLOCK_SEPARATION,r=this.SPACE_SIZE,s=.5*this.SPACE_SIZE;return[["M "+s+" 0 q "+r+" -"+r+" "+2*r+" 0",0,!0],["M 0 "+s+" q -"+r+" "+r+" 0 "+2*r,0,!1],["M "+e+" "+s+" q "+r+" "+r+" 0 "+2*r,1,!0],["M "+(e-s)+" 0 q -"+r+" -"+r+" -"+2*r+" 0",1,!1],["M 0 "+(e-s)+" q -"+r+" -"+r+" 0 -"+2*r,2,!0],["M "+s+" "+e+" q "+r+" "+r+" "+2*r+" 0",2,!1],["M "+(e-s)+" "+e+" q -"+r+" "+r+" -"+2*r+" 0",3,!0],["M "+e+" "+(e-s)+" q "+r+" -"+r+" 0 -"+2*r,3,!1]]}cancelMoveAttempt(){this.arrows=[],this.currentDrop=P.empty(),this.canSkipRotation=!1}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.board[r][e].isPlayer())return s.cancelMove(rt.MUST_LAND_ON_EMPTY_SPACE());const o=Rs.rotationless(e,r),c=s.getState(),u=c.applyLegalDrop(o);if(4===u.neutralBlocks.length)return s.chooseMove(o,c);const h=s.rules.getGameStatus(s.rules.node);return s.canSkipRotation=u.neutralBlocks.length>0&&!1===h.isEndGame,s.currentDrop=P.of(new M(e,r)),s.displayArrows(u.neutralBlocks),U.SUCCESS})()}getCenter(e){return(e<3?0:this.BLOCK_SEPARATION)+2*this.STROKE_WIDTH+(e%3+.5)*this.SPACE_SIZE}displayArrows(e){this.arrows=[];for(let r=0;r<4;r++)if(!1===e.includes(r)){const s=this.ARROWS.filter(i=>i[1]===r);this.arrows=this.arrows.concat(s)}}getBlockClasses(e,r){return this.movedBlock.equalsValue(e+2*r)?["moved-fill"]:[]}getSquareClasses(e,r){const s=[],i=this.getPlayerClass(this.board[r][e]);return s.push(i),this.lastDrop.equalsValue(new M(e,r))&&s.push("last-move-stroke"),s}rotate(e){var r=this;return A(function*(){const i=r.canUserPlay("#rotate_"+e[1]+"_"+(e[2]?"clockwise":"counterclockwise"));if(i.isFailure())return r.cancelMove(i.getReason());const o=r.currentDrop.get(),c=Rs.withRotation(o.x,o.y,e[1],e[2]);return r.chooseMove(c,r.getState())})()}skipRotation(){var e=this;return A(function*(){const r=e.canUserPlay("#skipRotation");if(r.isFailure())return e.cancelMove(r.getReason());const s=e.currentDrop.get(),i=Rs.rotationless(s.x,s.y);return e.chooseMove(i,e.getState())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-pentago"]],features:[l],decls:9,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-60 -60 780 780"],["id","arrowhead","markerWidth","5","markerHeight","3.5","refX","2.5","refY","1.75","orient","auto","fill","blue"],["points","0 0, 5 1.75, 0 3.5"],[4,"ngFor","ngForOf"],["class","base","pointer-events","fill",3,"id","ngClass",4,"ngIf"],["class","no-fill","stroke","blue","marker-end","url(#arrowhead)",3,"id","click",4,"ngFor","ngForOf"],["class","base victory-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],["id","skipRotation",3,"click",4,"ngIf"],[1,"base","no-fill",3,"ngClass"],["pointer-events","fill",1,"base",3,"id","ngClass","click"],["pointer-events","fill",1,"base",3,"id","ngClass"],["stroke","blue","marker-end","url(#arrowhead)",1,"no-fill",3,"id","click"],[1,"base","victory-stroke",3,"id","ngClass"],["id","skipRotation",3,"click"],["stroke","red",1,"background"],["stroke","red"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs")(2,"marker",1),X(3,"polygon",2),O()(),x(4,l8t,2,3,"ng-container",3),x(5,u8t,1,6,"circle",4),x(6,f8t,1,4,"path",5),x(7,h8t,1,7,"circle",6),x(8,d8t,3,9,"g",7),O()),2&e&&(S(4),T("ngForOf",g3(5,E3e,r.BLOCK_SEPARATION)),S(1),T("ngIf",r.currentDrop.isPresent()),S(1),T("ngForOf",r.arrows),S(1),T("ngForOf",r.victoryCoords),S(1),T("ngIf",r.canSkipRotation))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class V4 extends M{constructor(t,e,r){super(t,e),this.z=r}static getEncoder(t){return new class extends w4{encode(e){return{x:e.x,y:e.y,z:e.z}}decode(e){const r=e;return ye(null!=r.x&&"number"==typeof r.x&&null!=r.y&&"number"==typeof r.y,"Invalid encoded Coord3D"),t(r.x,r.y,r.z)}}}static of(t,e,r){return new V4(t,e,r)}toString(){return"Coord3D"+this.toShortString()}toShortString(){return"("+this.x+", "+this.y+", "+this.z+")"}equals(t){return this===t||t.x===this.x&&t.y===this.y&&t.z===this.z}isHigherThan(t){return this.z>t.z}}V4.encoder=V4.getEncoder(V4.of),V4.optionalEncoder=P.getEncoder(V4.encoder);class Sn extends V4{constructor(t,e,r){if(super(t,e,r),t<0||t>3)throw new Error(`PylosCoord: Invalid X: ${t}.`);if(e<0||e>3)throw new Error(`PylosCoord: Invalid Y: ${e}.`);if(r<0||r>3)throw new Error(`PylosCoord: Invalid Z: ${r}.`);const s=4-r;if(this.isNotInRange(s,s))throw new Error(this.toString()+" is not in range.")}static from(t,e,r){return new Sn(t,e,r)}toString(){return"PylosCoord"+this.toShortString()}getLowerPieces(){if(0===this.z)throw new Error("PylosCoord: floor pieces don't have lower pieces.");const t=this.z-1;return[new Sn(this.x,this.y,t),new Sn(this.x+1,this.y,t),new Sn(this.x,this.y+1,t),new Sn(this.x+1,this.y+1,t)]}getHigherCoords(){if(3===this.z)throw new Error("Top piece don't have lower pieces.");const t=this.z+1,e=new M(this.x-1,this.y-1),r=new M(this.x,this.y-1),s=new M(this.x-1,this.y),i=new M(this.x,this.y),o=4-t;return[e,r,s,i].filter(c=>c.isInRange(o,o)).map(c=>new Sn(c.x,c.y,t))}getNextValid(t){const e=new M(this.x,this.y).getNext(t),r=4-this.z;return e.isNotInRange(r,r)?P.empty():P.of(new Sn(e.x,e.y,this.z))}}Sn.encoder=V4.getEncoder(Sn.from),Sn.optionalEncoder=P.getEncoder(Sn.encoder);let i8=(()=>{class n{}return n.MUST_MOVE_UPWARD=()=>$localize`You must move your pieces upward.`,n.SHOULD_HAVE_SUPPORTING_PIECES=()=>$localize`Your piece must land on the board or on 4 other pieces.`,n.CANNOT_MOVE_SUPPORTING_PIECE=()=>$localize`You cannot move a supporting piece.`,n.CANNOT_CAPTURE=()=>$localize`You cannot capture.`,n.INVALID_FIRST_CAPTURE=()=>$localize`Your first capture is invalid.`,n.INVALID_SECOND_CAPTURE=()=>$localize`Your second capture is invalid.`,n})(),M3e=(()=>{class n{}return n.MUST_CAPTURE_MAXIMUM_TWO_PIECES=()=>$localize`You must capture one or two pieces, not more.`,n})();class _s extends $i{constructor(t,e,r,s){super(),this.startingCoord=t,this.landingCoord=e,this.firstCapture=r,this.secondCapture=s}static fromClimb(t,e,r){const s=P.of(t),i=_s.checkCaptures(r),o=new _s(s,e,i.firstCapture,i.secondCapture);if(!1===e.isHigherThan(t))throw new Error(i8.MUST_MOVE_UPWARD());return o}static checkCaptures(t){let e=P.empty(),r=P.empty();if(t.length>0&&(e=P.of(t[0]),t.length>1)){if(t[1].equals(t[0]))throw new Error("PylosMove: should not capture twice same piece.");if(r=P.of(t[1]),t[1].isHigherThan(t[0])&&(e=P.of(t[1]),r=P.of(t[0])),t.length>2)throw new Error(M3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())}return{firstCapture:e,secondCapture:r}}static fromDrop(t,e){const r=P.empty(),s=_s.checkCaptures(e);return new _s(r,t,s.firstCapture,s.secondCapture)}static changeCapture(t,e){const r=_s.checkCaptures(e);return new _s(t.startingCoord,t.landingCoord,r.firstCapture,r.secondCapture)}isClimb(){return this.startingCoord.isPresent()}toString(){const t=this.startingCoord.isAbsent()?"-":this.startingCoord.get().toShortString(),e=this.firstCapture.isAbsent()?"-":this.firstCapture.get().toShortString(),r=this.secondCapture.isAbsent()?"-":this.secondCapture.get().toShortString();return"PylosMove("+t+", "+this.landingCoord.toShortString()+", "+e+", "+r+")"}equals(t){return t===this||!!(this.startingCoord.equals(t.startingCoord)&&this.landingCoord.equals(t.landingCoord)&&this.firstCapture.equals(t.firstCapture)&&this.secondCapture.equals(t.secondCapture))}}_s.encoder=new class extends M2{encodeMove(n){return{firstCapture:Sn.optionalEncoder.encode(n.firstCapture),landingCoord:Sn.encoder.encode(n.landingCoord),secondCapture:Sn.optionalEncoder.encode(n.secondCapture),startingCoord:Sn.optionalEncoder.encode(n.startingCoord)}}decodeMove(n){const e=n.firstCapture,r=n.landingCoord,s=n.secondCapture;return new _s(Sn.optionalEncoder.decode(n.startingCoord),Sn.encoder.decode(r),Sn.optionalEncoder.decode(e),Sn.optionalEncoder.decode(s))}};class zc extends oP{constructor(t,e){super(e),this.boards=t}static getInitialState(){const t=Ke.createTable(4,4,pe.NONE),e=Ke.createTable(3,3,pe.NONE),r=Ke.createTable(2,2,pe.NONE);return new zc([t,e,r,[[pe.NONE]]],0)}static getLevelRange(t){switch(t){case 0:return[0,1,2,3];case 1:return[0,1,2];default:return we.expectToBe(t,2),[0,1]}}getPieceAt(t){return this.boards[t.z][t.y][t.x]}applyLegalMove(t,e=!0){const r=[];let s;return r.push({coord:t.landingCoord,value:this.getCurrentPlayer()}),t.startingCoord.isPresent()&&r.push({coord:t.startingCoord.get(),value:pe.NONE}),t.firstCapture.isPresent()&&r.push({coord:t.firstCapture.get(),value:pe.NONE}),t.secondCapture.isPresent()&&r.push({coord:t.secondCapture.get(),value:pe.NONE}),s=e?this.turn+1:this.turn,this.setBoardAtCoords(r,s)}setBoardAtCoords(t,e){const r=[Ke.copyBiArray(this.boards[0]),Ke.copyBiArray(this.boards[1]),Ke.copyBiArray(this.boards[2]),Ke.copyBiArray(this.boards[3])];for(const s of t){const i=s.coord;r[i.z][i.y][i.x]=s.value}return new zc(r,e)}isLandable(t){if(this.getPieceAt(t).isPlayer())return!1;if(0===t.z)return!0;const e=t.getLowerPieces();for(const r of e)if(this.getPieceAt(r)===pe.NONE)return!1;return!0}isSupporting(t){if(3===t.z)return!1;const e=t.getHigherCoords();for(const r of e)if(this.getPieceAt(r).isPlayer())return!0;return!1}getPiecesRepartition(){const t={};t[pe.NONE.value]=0,t[z.ZERO.value]=0,t[z.ONE.value]=0;for(let e=0;e<3;e++)for(let r=0;r<4-e;r++)for(let s=0;s<4-e;s++){const i=new Sn(s,r,e),o=this.getPieceAt(i);t[o.value]=1+t[o.value]}return t}removePieceAt(t){return this.setBoardAtCoords([{coord:t,value:pe.NONE}],this.turn)}dropCurrentPlayersPieceAt(t){const e={coord:t,value:this.getCurrentPlayer()};return this.setBoardAtCoords([e],this.turn)}getFreeToMoves(){const t=[],e=this.getCurrentPlayer();for(let r=0;r<=2;r++){const s=zc.getLevelRange(r);for(const i of s)for(const o of s){const c=new Sn(o,i,r);this.getPieceAt(c).equals(e)&&!1===this.isSupporting(c)&&t.push(c)}}return t}}class Vo extends Z1{static getStateInfo(t){const e=[],r=[];for(let s=0;s<3;s++)for(let i=0;i<4-s;i++)for(let o=0;o<4-s;o++){const c=new Sn(o,i,s);t.getPieceAt(c)===t.getCurrentPlayer()&&!1===t.isSupporting(c)&&e.push(c),t.isLandable(c)&&r.push(c)}return{freeToMove:e,landable:r}}static getClimbingMoves(t){const e=[];for(const r of t.freeToMove)for(const s of t.landable)if(s.isHigherThan(r)&&!1===s.getLowerPieces().some(i=>r.equals(i))){const i=_s.fromClimb(r,s,[]);e.push(i)}return e}static getDropMoves(t){const e=[];for(const r of t.landable){const s=_s.fromDrop(r,[]);e.push(s)}return e}static canCapture(t,e){const r=t.getCurrentPlayer();for(const s of[He.UP,He.DOWN]){const i=e.getNextValid(s);if(i.isPresent()&&t.getPieceAt(i.get())===r)for(const o of[He.LEFT,He.RIGHT]){const c=i.get().getNextValid(o);if(c.isPresent()&&t.getPieceAt(c.get())===r){const u=s.getOpposite(),h=c.get().getNextValid(u).get();if(t.getPieceAt(h)===r)return!0}}}return!1}static getPossibleCaptures(t){const e=new Ht,r=t.getFreeToMoves();for(const s of r){e.add(new Ht([s]));const o=t.removePieceAt(s).getFreeToMoves();for(const c of o){const u=new Ht([s,c]);e.add(u)}}return e}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}static isValidCapture(t,e,r){const s=t.getCurrentPlayer();return!(!r.equals(e.landingCoord)&&t.getPieceAt(r)!==s)&&0===r.getHigherCoords().filter(o=>t.getPieceAt(o).isPlayer()&&!1===o.equals(e.firstCapture.get())).length}static getGameStatus(t){const r=t.gameState.getPiecesRepartition();return 15===r[z.ZERO.value]?xe.ONE_WON:15===r[z.ONE.value]?xe.ZERO_WON:xe.ONGOING}applyLegalMove(t,e,r){return Vo.applyLegalMove(t,e,r)}isLegal(t,e){const r=this.isLegalStartingCoord(t,e);if(r.isFailure())return $.failure(r.getReason());const s=r.get(),i=this.isLegalLandingCoord(t,s);if(i.isFailure())return $.failure(i.getReason());const o=i.get(),c=this.isLegalCaptures(t,o);return c.isFailure()?c:$.success(void 0)}isLegalStartingCoord(t,e){const r=e.getCurrentOpponent();if(t.startingCoord.isPresent()){const s=t.startingCoord.get(),i=e.getPieceAt(s);if(i===r)return $.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE());if(i===pe.NONE)return $.failure(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());if(0===s.getHigherCoords().filter(c=>e.getPieceAt(c).isPlayer()).length){const c=e.removePieceAt(t.startingCoord.get());return $.success(c)}return $.failure(i8.CANNOT_MOVE_SUPPORTING_PIECE())}return $.success(e)}isLegalLandingCoord(t,e){return e.getPieceAt(t.landingCoord).isPlayer()?$.failure(rt.MUST_LAND_ON_EMPTY_SPACE()):e.isLandable(t.landingCoord)?$.success(e.dropCurrentPlayersPieceAt(t.landingCoord)):$.failure(i8.SHOULD_HAVE_SUPPORTING_PIECES())}isLegalCaptures(t,e){if(t.firstCapture.isAbsent())return $.success(void 0);if(!1===Vo.canCapture(e,t.landingCoord))return $.failure(i8.CANNOT_CAPTURE());if(Vo.isValidCapture(e,t,t.firstCapture.get())){const r=e.removePieceAt(t.firstCapture.get());return t.secondCapture.isAbsent()||Vo.isValidCapture(r,t,t.secondCapture.get())?$.success(void 0):$.failure(i8.INVALID_SECOND_CAPTURE())}return $.failure(i8.INVALID_FIRST_CAPTURE())}getGameStatus(t){return Vo.getGameStatus(t)}}class qm extends $1{static getListMoves(t){const e=t.gameState,r=[],s=Vo.getStateInfo(e),i=Vo.getClimbingMoves(s),o=Vo.getDropMoves(s),c=i.concat(o);for(const u of c){const h=e.applyLegalMove(u,!1);let p=new Ht;Vo.canCapture(h,u.landingCoord)?p=Vo.getPossibleCaptures(h):r.push(u);for(const m of p){const C=_s.changeCapture(u,m.toList());r.push(C)}}return r}getListMoves(t){return qm.getListMoves(t)}getBoardValue(t){const e=Vo.getGameStatus(t);if(e.isEndGame)return e.toBoardValue();{const r=t.gameState.getPiecesRepartition();return new Ct(r[z.ZERO.value]-r[z.ONE.value])}}}class b9 extends qm{static countStoneUsed(t){let e=t.isClimb()?0:1;return t.firstCapture.isPresent()&&(e-=1,t.secondCapture.isPresent()&&(e-=1)),e}static sumMoveEmplacementByValue(t){let e=t.landingCoord.z;return t.startingCoord.isPresent()&&(e+=3-t.startingCoord.get().z),t.firstCapture.isPresent()&&(e+=3-t.firstCapture.get().z,t.secondCapture.isPresent()&&(e+=3-t.secondCapture.get().z)),e}getListMoves(t){const e=qm.getListMoves(t);return this.orderMoves(e)}orderMoves(t){return t.sort((e,r)=>{const s=12*b9.countStoneUsed(e),i=12*b9.countStoneUsed(r);return s+b9.sumMoveEmplacementByValue(e)-(i+b9.sumMoveEmplacementByValue(r))})}}const st=pe.NONE,f6=pe.ZERO,S3e=pe.ONE;class P3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Pylos, the goal is to be the last to play.
        To do this, you have to save up your pieces.
        As soon as a player puts its last piece, that player loses the game immediately.
        Here is what the initial board looks like, it is a board of 4 x 4 squares.
        This board will become a pyramid, little by little.
        It will be filled by the pieces of your stock. Each player has 15 pieces.`,zc.getInitialState()),ce.anyMove($localize`Dropping a piece`,$localize`When it is your turn, you can always drop one of your piece on an empty square.
        The gray squares are where you can drop your pieces.<br/><br/>
        Click on one of the squares to drop a piece there.`,zc.getInitialState(),_s.fromDrop(new Sn(1,1,0),[]),$localize`There you go, as simple as that.`),ce.fromMove($localize`Climbing`,$localize`When 4 pieces form a square, it is possible to put a fifth piece on top.
        However, when that happens, you can save a piece by climbing instead of dropping a piece.
        To climb:
        <ol>
            <li>Click on one of your free pieces, which should be lower than the landing square.</li>
            <li>Click on an empty landing square, higher than your selected piece.</li>
        </ol><br/>
        You're playing Dark, go ahead and climb!`,new zc([[[f6,S3e,st,st],[S3e,f6,st,st],[st,st,st,st],[st,st,st,f6]],[[st,st,st],[st,st,st],[st,st,st]],[[st,st],[st,st]],[[st]]],0),[_s.fromClimb(new Sn(3,3,0),new Sn(0,0,1),[])],$localize`Congratulations!<br/>
        Some important notes:
        <ol>
            <li>You cannot move a piece that is directly below another one.</li>
            <li>Of course, you cannot move the opponent's pieces.</li>
            <li>You can only climb when the landing square is higher than the starting square.</li>
        </ol>`,$localize`Failed. Try again.`),ce.fromMove($localize`Square (1/2)`,$localize`When the piece you just moved or dropped is the fourth one of a square of your color,
        you can choose anywhere on the board one or two of your pieces.
        These pieces will be removed from the board, allowing you to save up one or two pieces.
        A chosen piece must not be directly below another piece.
        A chosen piece can be the piece you just placed.<br/><br/>
        You're playing Dark. Form a square, click on one of the four pieces, then click on the V symbol on the bottom right to finalize your move.`,new zc([[[f6,f6,st,st],[st,f6,st,st],[st,st,st,st],[st,st,st,st]],[[st,st,st],[st,st,st],[st,st,st]],[[st,st],[st,st]],[[st]]],0),[_s.fromDrop(new Sn(0,1,0),[new Sn(0,0,0)]),_s.fromDrop(new Sn(0,1,0),[new Sn(0,1,0)]),_s.fromDrop(new Sn(0,1,0),[new Sn(1,0,0)]),_s.fromDrop(new Sn(0,1,0),[new Sn(1,1,0)])],$localize`Congratulations, you have saved up one piece. Note, you can cancel your selection by clicking again on the piece.`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Square (2/2)`,$localize`You're playing Dark.<br/><br/>
        Do like in the previous step, but this time click on two different pieces before validating.`,new zc([[[f6,f6,st,st],[st,f6,st,st],[st,st,st,st],[st,st,st,st]],[[st,st,st],[st,st,st],[st,st,st]],[[st,st],[st,st]],[[st]]],0),_s.fromDrop(new Sn(0,1,0),[new Sn(0,0,0),new Sn(1,0,0)]),(t,e,r)=>t.secondCapture.isPresent()?U.SUCCESS:t.firstCapture.isPresent()?U.failure($localize`Failed, you only captured one piece.`):U.failure(d3e.YOU_DID_NOT_CAPTURE_ANY_PIECE()),$localize`Congratulations, you have saved up two pieces.`)]}}function g8t(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","piece_",r.value,"_",e,""),T("ngClass",s.getPlayerClass(r)),D("cx",s.SPACE_SIZE/4+e/15*(s.boardWidth-s.SPACE_SIZE/4))("cy",s.getPiecesCyForPlayer(r))("r",s.SPACE_SIZE/4-s.STROKE_WIDTH)}}function m8t(n,t){if(1&n&&(B(),b(0,"g"),x(1,g8t,1,6,"circle",7),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getPlayerSidePieces(e))}}function _8t(n,t){if(1&n){const e=Oe();B(),b(0,"circle",12),J("click",function(){fe(e);const s=v(2).$implicit,i=v().$implicit,o=v().$implicit;return ae(v().onPieceClick(s,i,o))}),O()}if(2&n){const e=v(2).$implicit,r=v().$implicit,s=v().$implicit,i=v();G2("id","piece_",e,"_",r,"_",s,""),T("ngClass",i.getPieceClasses(e,r,s)),D("r",i.getPieceRadius(s)-i.STROKE_WIDTH)("cx",i.getPieceCx(e,r,s))("cy",i.getPieceCy(e,r,s))}}function v8t(n,t){if(1&n){const e=Oe();B(),b(0,"rect",12),J("click",function(){fe(e);const s=v(3).$implicit,i=v().$implicit,o=v().$implicit;return ae(v().onDrop(s,i,o))}),O()}if(2&n){const e=v(3).$implicit,r=v().$implicit,s=v().$implicit,i=v();G2("id","drop_",e,"_",r,"_",s,""),T("ngClass",i.getSquareClasses(e,r,s)),D("width",2*i.getPieceRadius(s))("height",2*i.getPieceRadius(s))("x",i.getPieceCx(e,r,s)-i.getPieceRadius(s))("y",i.getPieceCy(e,r,s)-i.getPieceRadius(s))}}function C8t(n,t){if(1&n&&(B(),x(0,v8t,1,8,"rect",13)),2&n){const e=v(2).$implicit,r=v().$implicit,s=v().$implicit;T("ngIf",v().mustDisplayLandingCoord(e,r,s))}}function y8t(n,t){if(1&n&&(B(),ln(0),x(1,_8t,1,7,"circle",10),x(2,C8t,1,1,"ng-template",null,11,c1),un()),2&n){const e=t1(3),r=v().$implicit,s=v().$implicit,i=v().$implicit,o=v();S(1),T("ngIf",o.isOccupied(r,s,i))("ngIfElse",e)}}function E8t(n,t){if(1&n&&(B(),b(0,"g"),x(1,y8t,4,2,"ng-container",9),O()),2&n){const e=t.$implicit,r=v().$implicit,s=v().$implicit,i=v();S(1),T("ngIf",i.mustDraw(e,r,s))}}function M8t(n,t){if(1&n&&(B(),b(0,"g"),x(1,E8t,2,1,"g",1),O()),2&n){const e=v().$implicit,r=v();S(1),T("ngForOf",r.getLevelRange(e))}}function S8t(n,t){if(1&n&&(B(),b(0,"g"),x(1,M8t,2,1,"g",1),O()),2&n){const e=t.$implicit,r=v();S(1),T("ngForOf",r.getLevelRange(e))}}function P8t(n,t){if(1&n&&(B(),X(0,"rect",14)),2&n){const e=v();G2("id","highCapture_",e.highCapture.get().x,"_",e.highCapture.get().y,"_",e.highCapture.get().z,""),D("width",2*e.getPieceRadius(e.highCapture.get().z))("height",2*e.getPieceRadius(e.highCapture.get().z))("x",e.getPieceCxByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))("y",e.getPieceCyByCoord(e.highCapture.get())-e.getPieceRadius(e.highCapture.get().z))}}function T8t(n,t){if(1&n){const e=Oe();B(),b(0,"g",15),J("click",function(){return fe(e),ae(v().validateCapture())}),X(1,"circle",16)(2,"polygon",17),O()}if(2&n){const e=v();D("transform","translate("+4*e.SPACE_SIZE+" "+4*e.SPACE_SIZE+")"),S(1),T("ngClass",e.getCaptureValidationButtonClasses()),D("cx",e.STROKE_WIDTH/2)("cy",e.STROKE_WIDTH/2)("r",e.SPACE_SIZE/2)}}function w8t(n,t){if(1&n){const e=Oe();B(),b(0,"g",18),J("click",function(){const i=fe(e).$implicit;return ae(v().onPieceClick(i.x,i.y,i.z))}),X(1,"line",19)(2,"line",19),O()}if(2&n){const e=t.$implicit,r=v();G2("id","capturable_",e.x,"_",e.y,"_",e.z,""),D("transform","translate("+r.getPieceCxByCoord(e)+" "+r.getPieceCyByCoord(e)+")"),S(1),D("x1",-.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z)),S(1),D("x1",.25*r.getPieceRadius(e.z))("y1",-.25*r.getPieceRadius(e.z))("x2",-.25*r.getPieceRadius(e.z))("y2",.25*r.getPieceRadius(e.z))}}const b8t=function(){return[0,1,2]};let O8t=(()=>{class n extends Y0{constructor(e){super(e),this.boardWidth=4*this.SPACE_SIZE+this.STROKE_WIDTH,this.pieceRowHeight=this.SPACE_SIZE/2,this.boardHeight=this.boardWidth+2*this.pieceRowHeight,this.lastLandingCoord=P.empty(),this.lastStartingCoord=P.empty(),this.lastFirstCapture=P.empty(),this.lastSecondCapture=P.empty(),this.highCapture=P.empty(),this.capturables=[],this.chosenStartingCoord=P.empty(),this.chosenLandingCoord=P.empty(),this.chosenFirstCapture=P.empty(),this.chosenSecondCapture=P.empty(),this.lastMove=P.empty(),this.remainingPieces={0:15,1:15},this.hasAsymetricBoard=!0,this.rules=new Vo(zc),this.availableMinimaxes=[new qm(this.rules,"PylosMinimax"),new b9(this.rules,"PylosOrderedMinimax")],this.encoder=_s.encoder,this.tutorial=(new P3e).tutorial,this.updateBoard()}getPiecesCyForPlayer(e){return e===z.ONE?this.pieceRowHeight/2:this.boardWidth+1.5*this.pieceRowHeight}getLevelRange(e){return zc.getLevelRange(e)}mustDraw(e,r,s){const i=new Sn(e,r,s);return!!(this.constructedState.getPieceAt(i).isPlayer()||this.justClimbed(i)||this.isCaptured(i))||this.chosenLandingCoord.isAbsent()&&this.constructedState.isLandable(i)}isCaptured(e){return this.chosenFirstCapture.equalsValue(e)||this.chosenSecondCapture.equalsValue(e)}onPieceClick(e,r,s){var i=this;return A(function*(){const o=i.canUserPlay("#piece_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Sn(e,r,s);return i.state.getPieceAt(c)===i.state.getCurrentOpponent()?i.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):i.chosenStartingCoord.equalsValue(c)?(i.cancelMoveAttempt(),U.SUCCESS):i.chosenLandingCoord.isPresent()?i.isSupporting(c,i.constructedState)?i.cancelMove(i8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onCaptureClick(c):i.isSupporting(c,i.getState())?i.cancelMove(i8.CANNOT_MOVE_SUPPORTING_PIECE()):i.onClimbClick(c)})()}isSupporting(e,r){return r.isSupporting(e)}onClimbClick(e){var r=this;return A(function*(){return r.chosenStartingCoord=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),U.SUCCESS})()}onCaptureClick(e){var r=this;return A(function*(){return r.chosenFirstCapture.equalsValue(e)?(r.chosenFirstCapture=P.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),U.SUCCESS):r.chosenSecondCapture.equalsValue(e)?(r.chosenSecondCapture=P.empty(),r.constructedState=r.constructedState.dropCurrentPlayersPieceAt(e),r.updateCapturableList(),U.SUCCESS):r.chosenFirstCapture.isAbsent()?(r.chosenFirstCapture=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),U.SUCCESS):r.chosenSecondCapture.isAbsent()?(r.chosenSecondCapture=P.of(e),r.constructedState=r.constructedState.removePieceAt(e),r.updateCapturableList(),U.SUCCESS):r.cancelMove(M3e.MUST_CAPTURE_MAXIMUM_TWO_PIECES())})()}updateCapturableList(){this.capturables=this.constructedState.getFreeToMoves()}getCaptureValidationButtonClasses(){return this.chosenFirstCapture.isPresent()||this.chosenSecondCapture.isPresent()?"":"semi-transparent"}validateCapture(){var e=this;return A(function*(){const r=e.canUserPlay("#capture_validation");return r.isFailure()?e.cancelMove(r.getReason()):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isAbsent()?U.SUCCESS:e.chosenFirstCapture.isPresent()&&e.chosenSecondCapture.isAbsent()?e.concludeMoveWithCapture([e.chosenFirstCapture.get()]):e.chosenFirstCapture.isAbsent()&&e.chosenSecondCapture.isPresent()?e.concludeMoveWithCapture([e.chosenSecondCapture.get()]):e.concludeMoveWithCapture([e.chosenFirstCapture.get(),e.chosenSecondCapture.get()])})()}concludeMoveWithCapture(e){var r=this;return A(function*(){let s;return s=r.chosenStartingCoord.isAbsent()?_s.fromDrop(r.chosenLandingCoord.get(),e):_s.fromClimb(r.chosenStartingCoord.get(),r.chosenLandingCoord.get(),e),r.tryMove(s,r.state)})()}tryMove(e,r){var s=this;return A(function*(){return s.cancelMove(),s.chooseMove(e,r)})()}cancelMoveAttempt(){this.constructedState=this.state,this.chosenStartingCoord=P.empty(),this.chosenLandingCoord=P.empty(),this.chosenFirstCapture=P.empty(),this.chosenSecondCapture=P.empty(),this.capturables=[]}onDrop(e,r,s){var i=this;return A(function*(){const o=i.canUserPlay("#drop_"+e+"_"+r+"_"+s);if(o.isFailure())return i.cancelMove(o.getReason());const c=new Sn(e,r,s);return Vo.canCapture(i.constructedState,c)?(i.chosenLandingCoord=P.of(c),i.constructedState=i.constructedState.dropCurrentPlayersPieceAt(c),i.updateCapturableList(),U.SUCCESS):(i.chosenLandingCoord=P.of(c),i.concludeMoveWithCapture([]))})()}getSquareClasses(e,r,s){const i=new Sn(e,r,s);if(this.lastMove.isPresent()){const o=this.lastMove.get();if(o.firstCapture.equalsValue(i)||o.secondCapture.equalsValue(i))return["captured-fill"];if(i.equals(o.landingCoord)||o.startingCoord.equalsValue(i))return["moved-fill"]}else if(this.justClimbed(i))return["moved-fill"];return[]}justClimbed(e){return this.chosenLandingCoord.isPresent()&&this.chosenStartingCoord.equalsValue(e)}getPieceRadius(e){return this.SPACE_SIZE*(.45+.025*e)}getPieceCx(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+e*this.SPACE_SIZE}getPieceCy(e,r,s){return this.SPACE_SIZE/2+.5*s*this.SPACE_SIZE+r*this.SPACE_SIZE}getPieceCxByCoord(e){return this.getPieceCx(e.x,e.y,e.z)}getPieceCyByCoord(e){return this.getPieceCy(e.x,e.y,e.z)}isOccupied(e,r,s){const i=new Sn(e,r,s);if(this.justClimbed(i))return!1;const o=this.getState().getPieceAt(i).isPlayer(),c=this.chosenLandingCoord.equalsValue(i);return o||c}getPieceClasses(e,r,s){const i=new Sn(e,r,s),o=[this.getPieceFillClass(i)];return(this.lastLandingCoord.equalsValue(i)||this.lastStartingCoord.equalsValue(i))&&o.push("last-move-stroke"),(this.chosenStartingCoord.equalsValue(i)||this.chosenLandingCoord.equalsValue(i))&&o.push("selected-stroke"),this.isCaptured(i)&&o.push("pre-captured-fill"),o}getPieceFillClass(e){return this.chosenLandingCoord.equalsValue(e)?this.getPlayerClass(this.state.getCurrentPlayer()):this.getPlayerClass(this.state.getPieceAt(e))}getPlayerSidePieces(e){const r=this.remainingPieces[e.value],s=[];for(let i=0;i<r;i++)s.push(i);return s}updateBoard(){this.state=this.getState(),this.constructedState=this.state,this.lastMove=this.rules.node.move;const e=this.state.getPiecesRepartition();this.remainingPieces={0:15-e[0],1:15-e[1]},this.highCapture=P.empty(),this.cancelMoveAttempt(),this.lastMove.isPresent()?this.showLastMove():this.hideLastMove()}showLastMove(){const e=this.lastMove.get();this.lastLandingCoord=P.of(e.landingCoord),this.lastStartingCoord=e.startingCoord,this.lastFirstCapture=e.firstCapture,this.lastSecondCapture=e.secondCapture,this.lastFirstCapture.isPresent()&&!1===this.mustDrawCoord(this.lastFirstCapture.get())&&(this.highCapture=this.lastFirstCapture)}hideLastMove(){this.lastStartingCoord=P.empty(),this.lastLandingCoord=P.empty(),this.lastFirstCapture=P.empty(),this.lastSecondCapture=P.empty()}mustDrawCoord(e){return this.mustDraw(e.x,e.y,e.z)}mustDisplayLandingCoord(e,r,s){return!this.chosenStartingCoord.isPresent()||!!this.chosenStartingCoord.get().equals(new Sn(e,r,s))||this.chosenStartingCoord.get().z<s}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-pylos"]],features:[l],decls:10,vars:11,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["boardInItself",""],["x","0","y","0",1,"base","small-stroke"],["class","base captured-fill small-stroke",3,"id",4,"ngIf"],["id","capture_validation",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base small-stroke",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"base","small-stroke",3,"id","ngClass"],[4,"ngIf"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf","ngIfElse"],["onlyRect",""],[1,"base","small-stroke",3,"id","ngClass","click"],["class","base small-stroke",3,"id","ngClass","click",4,"ngIf"],[1,"base","captured-fill","small-stroke",3,"id"],["id","capture_validation",3,"click"],["fill","red",1,"base-no-fill","small-stroke",3,"ngClass"],["points","-32.5,-2.5 -32.5,12.5 -10,35 -2.5,35 35,-21.25 25,-21.275 -5,25 -32.5,-2.5","fill","green",1,"base-no-fill","small-stroke"],[3,"id","click"],["stroke-width","8","stroke","red"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g"),x(2,m8t,2,1,"g",1),O(),b(3,"g",null,2),X(5,"rect",3),x(6,S8t,2,1,"g",1),x(7,P8t,1,7,"rect",4),x(8,T8t,3,5,"g",5),x(9,w8t,3,12,"g",6),O()()),2&e&&(D("viewBox","0 0 "+r.boardWidth+" "+r.boardHeight),S(1),D("transform","rotate("+180*r.role.value+" "+r.boardWidth/2+" "+r.boardHeight/2+")"),S(1),T("ngForOf",r.Player.PLAYERS),S(1),D("transform","translate("+r.STROKE_WIDTH/2+" "+(r.STROKE_WIDTH/2+r.pieceRowHeight)+")"),S(2),D("width",4*r.SPACE_SIZE)("height",4*r.SPACE_SIZE),S(1),T("ngForOf",tr(10,b8t)),S(1),T("ngIf",r.highCapture.isPresent()),S(1),T("ngIf",r.chosenLandingCoord.isPresent()),S(1),T("ngForOf",r.capturables))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class je{constructor(t){this.value=t}static fromInt(t){if(0<=t&&t<=15)return je.pieces[t];if(16===t)return je.EMPTY;throw new Error("Invalid piece ("+t+")")}equals(t){return this===t}toString(){return"QuartoPiece("+this.value+")"}isRectangle(){return this.value%4<2}}je.AAAA=new je(0),je.AAAB=new je(1),je.AABA=new je(2),je.AABB=new je(3),je.ABAA=new je(4),je.ABAB=new je(5),je.ABBA=new je(6),je.ABBB=new je(7),je.BAAA=new je(8),je.BAAB=new je(9),je.BABA=new je(10),je.BABB=new je(11),je.BBAA=new je(12),je.BBAB=new je(13),je.BBBA=new je(14),je.BBBB=new je(15),je.EMPTY=new je(16),je.pieces=[je.AAAA,je.AAAB,je.AABA,je.AABB,je.ABAA,je.ABAB,je.ABBA,je.ABBB,je.BAAA,je.BAAB,je.BABA,je.BABB,je.BBAA,je.BBAB,je.BBBA,je.BBBB];class H4 extends S3{constructor(t,e,r){super(t,e),this.piece=r}toString(){return"QuartoMove("+this.coord.x+", "+this.coord.y+", "+this.piece.value+")"}equals(t){return this===t||!!t.coord.equals(this.coord)&&this.piece===t.piece}}H4.encoder=new class extends Cn{maxValue(){return 496}encodeNumber(n){return 128*n.coord.x+32*n.coord.y+n.piece.value}decodeNumber(n){const t=n%32;n-=t;const e=(n/=32)%4;return n-=e,new H4(n/=4,e,je.fromInt(t))}};class Vc extends ps{constructor(t,e,r){super(t,e),this.pieceInHand=r}static getInitialState(){const t=Ke.createTable(4,4,je.EMPTY);return new Vc(t,0,je.AAAA)}static isGivable(t,e,r){return t!==r&&!1===Vc.isAlreadyOnBoard(t,e)}static isAlreadyOnBoard(t,e){for(let r=0;r<4;r++)for(let s=0;s<4;s++)if(e[r][s]===t)return!0;return!1}getRemainingPieces(){const t=je.pieces,e=[];for(const r of t)Vc.isGivable(r,this.board,this.pieceInHand)&&e.push(r);return e}}let xH=(()=>{class n{}return n.MUST_GIVE_A_PIECE=()=>$localize`You must give a piece.`,n.PIECE_ALREADY_ON_BOARD=()=>$localize`That piece is already on the board.`,n.CANNOT_GIVE_PIECE_IN_HAND=()=>$localize`You cannot give the piece that was in your hands.`,n})();class jm{constructor(t){this.subCriterion=[P.empty(),P.empty(),P.empty(),P.empty()],this.subCriterion[0]=P.of(8==(8&t.value)),this.subCriterion[1]=P.of(4==(4&t.value)),this.subCriterion[2]=P.of(2==(2&t.value)),this.subCriterion[3]=P.of(1==(1&t.value))}mergeWith(t){let e=4;for(let r=0;r<4;r++)!1===this.subCriterion[r].equals(t.subCriterion[r])&&(this.subCriterion[r]=P.empty()),this.subCriterion[r].isAbsent()&&e--;return e>0}mergeWithQuartoPiece(t){const e=new jm(t);return this.mergeWith(e)}areAllAbsent(){for(let t=0;t<4;t++)if(this.subCriterion[t].isPresent())return!1;return!0}match(t){for(let e=0;e<4;e++)if(this.subCriterion[e].equals(t.subCriterion[e]))return!0;return!1}matchPiece(t){return this.match(new jm(t))}toString(){return"Criterion{"+this.subCriterion.map(t=>t.isPresent()?t.get()?"1":"0":"x").join(" ")+"}"}}class F4{constructor(t,e){this.initialCoord=t,this.direction=e}allCoords(){const t=[];for(let e=0;e<4;e++)t.push(this.initialCoord.getNext(this.direction,e));return t}}class ei extends Z1{static isOccupied(t){return t!==je.EMPTY}static isLegal(t,e){const r=t.coord.x,s=t.coord.y,i=t.piece,o=e.getCopiedBoard(),c=e.pieceInHand;return ei.isOccupied(o[s][r])?U.failure(rt.MUST_LAND_ON_EMPTY_SPACE()):i===je.EMPTY?15===e.turn?U.SUCCESS:U.failure(xH.MUST_GIVE_A_PIECE()):Vc.isAlreadyOnBoard(i,o)?U.failure(xH.PIECE_ALREADY_ON_BOARD()):c===i?U.failure(xH.CANNOT_GIVE_PIECE_IN_HAND()):U.SUCCESS}isLegal(t,e){return ei.isLegal(t,e).toFallible(void 0)}applyLegalMove(t,e){const r=e.getCopiedBoard();return r[t.coord.y][t.coord.x]=e.pieceInHand,new Vc(r,e.turn+1,t.piece)}static updateBoardStatus(t,e,r){return r.score===yn.PRE_VICTORY?this.isThereAVictoriousLine(t,e)?{score:yn.VICTORY,sensitiveSquares:new vr}:r:this.searchForVictoryOrPreVictoryInLine(t,e,r)}static isThereAVictoriousLine(t,e){let r=t.initialCoord,s=e.getPieceAt(r);const i=new jm(s);for(let o=0;o<3&&!1!==ei.isOccupied(s)&&!i.areAllAbsent();o++)r=r.getNext(t.direction,1),s=e.getPieceAt(r),i.mergeWithQuartoPiece(s);return!(!ei.isOccupied(s)||i.areAllAbsent())}static searchForVictoryOrPreVictoryInLine(t,e,r){const s=ei.getLineInfos(t,e,r);if(s.boardStatus.isPresent())return s.boardStatus.get();const i=s.commonCriterion,o=s.sensitiveCoord;if(i.isPresent()&&!1===i.get().areAllAbsent()){if(o.isAbsent())return{score:yn.VICTORY,sensitiveSquares:new vr};{i.get().matchPiece(e.pieceInHand)&&(r.score=yn.PRE_VICTORY);const c=o.get();r.sensitiveSquares.add(c)}}return r}static getLineInfos(t,e,r){let s=P.empty(),i=P.empty(),o=t.initialCoord;for(let c=0;c<4;c++){const u=e.getPieceAt(o);if(u===je.EMPTY){if(!s.isAbsent())return{sensitiveCoord:P.of(o),commonCriterion:i,boardStatus:P.of(r)};s=P.of(o)}else i.isAbsent()?(i=P.of(new jm(u)),K(ei.VERBOSE,"set commonCrit to "+i.toString())):(i.get().mergeWithQuartoPiece(u),K(ei.VERBOSE,"update commonCrit: "+i.toString()));o=o.getNext(t.direction,1)}return{commonCriterion:i,sensitiveCoord:s,boardStatus:P.empty()}}static scoreToGameStatus(t,e){const r=z.of(e%2);return t===yn.VICTORY?xe.getDefeat(r):16===e?xe.DRAW:xe.ONGOING}getGameStatus(t){const e=t.gameState;let r={score:yn.DEFAULT,sensitiveSquares:new vr};for(const s of ei.lines)if(r=ei.updateBoardStatus(s,e,r),r.score===yn.VICTORY)return ei.scoreToGameStatus(r.score,e.turn);return ei.scoreToGameStatus(r.score,e.turn)}getVictoriousCoords(t){for(const e of ei.lines)if(ei.isThereAVictoriousLine(e,t))return e.allCoords();return[]}}ei.VERBOSE=!1,ei.lines=[new F4(new M(0,0),be.DOWN),new F4(new M(1,0),be.DOWN),new F4(new M(2,0),be.DOWN),new F4(new M(3,0),be.DOWN),new F4(new M(0,0),be.RIGHT),new F4(new M(0,1),be.RIGHT),new F4(new M(0,2),be.RIGHT),new F4(new M(0,3),be.RIGHT),new F4(new M(0,0),be.DOWN_RIGHT),new F4(new M(0,3),be.UP_RIGHT)];class kH extends $1{static scoreToBoardValue(t,e){if(t===yn.DEFAULT)return new Ct(0);{const r=z.of(e%2);return new Ct(t===yn.PRE_VICTORY?r.getPreVictory():r.getDefeatValue())}}getListMoves(t){const e=[],r=t.gameState,s=r.getCopiedBoard(),i=r.getRemainingPieces(),o=r.pieceInHand;let c;for(let u=0;u<4;u++)for(let h=0;h<4;h++)if(s[u][h]===je.EMPTY){if(c=r.getCopiedBoard(),c[u][h]=o,15===r.turn){const p=new H4(h,u,je.EMPTY);return e.push(p),e}for(const p of i){const m=new H4(h,u,p);e.push(m)}}return e}getBoardValue(t){const e=t.gameState;let r={score:yn.DEFAULT,sensitiveSquares:new vr};for(const s of ei.lines)if(r=ei.updateBoardStatus(s,e,r),r.score===yn.VICTORY)break;return kH.scoreToBoardValue(r.score,e.turn)}}const N8t=je.AABA,A8t=je.AABB,T3e=je.ABAA,I8t=je.ABAB,x8t=je.ABBA,w3e=je.BAAA,k8t=je.BAAB,L8t=je.BABB,b3e=je.BBAA,R8t=je.BBAB,LH=je.BBBA,D8t=je.BBBB,k1=je.EMPTY;class O3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Quarto is an alignment game.
        The goal is to align four pieces that have at least one common aspect:
        <ul>
          <li>their color (light or dark),</li>
          <li>their size (big or small),</li>
          <li>their pattern (empty or dotted),</li>
          <li>their shape (round or square).</li>
        </ul>
        Here, we have a board with a victory by an alignment of dark pieces.
        Note that the pieces are not owned by any player.`,new Vc([[LH,b3e,T3e,N8t],[k1,k1,k1,k1],[k1,k1,k1,k1],[k1,k1,k1,k1]],7,je.ABAB)),ce.anyMove($localize`Placement`,$localize`Every placement occurs in two steps: placing the piece you have in hand (in the small square) on a square of the board,
        and picking a piece that the opponent will have to place, by clicking on one of the pieces inside the dotted square.
        If you prefer, the order of these two steps can be reversed.
        Keep in mind that the second click confirms the move.<br/><br/>
        Make a move.`,new Vc([[LH,A8t,x8t,k1],[k1,k1,k1,k1],[k1,w3e,k1,k1],[k1,k1,k1,k1]],7,je.ABAA),new H4(2,2,je.BAAB),$localize`Perfect!`),ce.fromMove($localize`Situation`,$localize`We have here a tricky situation.<br/><br/>
        Analyze the board and play your move, carefully paying attention not to let the opponent win on the next move.`,new Vc([[D8t,LH,R8t,k1],[T3e,L8t,b3e,k1],[I8t,w3e,k8t,k1],[k1,k1,k1,k1]],7,je.AABA),[new H4(3,3,je.AABB)],$localize`Well done!`,$localize`Failed! Your opponent can either align:<ul><li>the squares horizontally on the third line or vertically on the third column,</li><li>small pieces horizontally on the first line or vertically on the second or third column,</li><li>empty pieces horizontally on the first line or vertically on the first column,</li><li>clear pieces diagonally.</li></ul>`)]}}function z8t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=v(2),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.getPieceClasses(r.value)),D("x",o.SPACE_SIZE*s+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("y",o.SPACE_SIZE*i+(o.SPACE_SIZE/2-o.getPieceSize(r.value)))("width",2*o.getPieceSize(r.value))("height",2*o.getPieceSize(r.value))}}function V8t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2),r=e.$implicit,s=e.index,i=v().index,o=v();T("ngClass",o.getPieceClasses(r.value)),D("cx",o.SPACE_SIZE*s+o.SPACE_SIZE/2)("cy",o.SPACE_SIZE*i+o.SPACE_SIZE/2)("r",o.getPieceSize(r.value))}}function H8t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=v(2).index,r=v().index,s=v();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function F8t(n,t){if(1&n&&(B(),b(0,"g"),x(1,z8t,1,5,"rect",10),x(2,V8t,1,4,"ng-template",null,11,c1),x(4,H8t,1,3,"circle",7),O()),2&n){const e=t1(3),r=v().$implicit,s=v(2);S(1),T("ngIf",r.isRectangle())("ngIfElse",e),S(3),T("ngIf",s.pieceHasDot(r.value))}}function B8t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",9),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().chooseCoord(i,o))}),O(),x(2,F8t,5,3,"g",7),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","chooseCoord_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*r)("y",i.SPACE_SIZE*s)("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e!==i.EMPTY)}}function $8t(n,t){if(1&n&&(B(),b(0,"g",null,8),x(2,B8t,3,8,"g",2),O()),2&n){const e=t.$implicit;S(2),T("ngForOf",e)}}function U8t(n,t){if(1&n&&(B(),X(0,"rect",17)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("y",e.SPACE_SIZE/2-e.getPieceSize(e.pieceInHand.value))("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function G8t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",e.getPieceSize(e.pieceInHand.value))}}function W8t(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=v(2);D("cx",e.SPACE_SIZE/2)("cy",e.SPACE_SIZE/2)("r",10)}}function q8t(n,t){if(1&n){const e=Oe();B(),b(0,"g",13,14),J("click",function(){return fe(e),ae(v().deselectDroppedPiece())}),X(2,"rect",15),x(3,U8t,1,5,"rect",16),x(4,G8t,1,4,"ng-template",null,11,c1),x(6,W8t,1,3,"circle",7),O()}if(2&n){const e=t1(5),r=v();We("id","droppedPiece_",r.chosen.get().x,"_",r.chosen.get().y,""),D("transform","translate("+r.chosen.get().x*r.SPACE_SIZE+" "+r.chosen.get().y*r.SPACE_SIZE+")"),S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE),S(1),T("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),S(3),T("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function j8t(n,t){if(1&n&&(B(),b(0,"g",null,18),X(2,"rect",19),O()),2&n){const e=t.$implicit,r=v();S(2),D("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)("transform","translate("+e.x*r.SPACE_SIZE+" "+e.y*r.SPACE_SIZE+")")}}function Z8t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("x",0)("y",.75*e.SPACE_SIZE)("transform","translate("+-e.getPieceSize(e.pieceInHand.value)+", "+-e.getPieceSize(e.pieceInHand.value)+")")("width",2*e.getPieceSize(e.pieceInHand.value))("height",2*e.getPieceSize(e.pieceInHand.value))}}function Y8t(n,t){if(1&n&&(B(),X(0,"circle",21)),2&n){const e=v(2);T("ngClass",e.getPieceClasses(e.pieceInHand.value)),D("cy",.75*e.SPACE_SIZE)("r",e.getPieceSize(e.pieceInHand.value))}}function K8t(n,t){1&n&&(B(),X(0,"circle",22)),2&n&&D("cy",.75*v(2).SPACE_SIZE)("r",10)}function X8t(n,t){if(1&n&&(B(),b(0,"g"),x(1,Z8t,1,6,"rect",10),x(2,Y8t,1,3,"ng-template",null,11,c1),x(4,K8t,1,2,"circle",20),O()),2&n){const e=t1(3),r=v();S(1),T("ngIf",r.pieceInHand.isRectangle())("ngIfElse",e),S(3),T("ngIf",r.pieceHasDot(r.pieceInHand.value))}}function Q8t(n,t){if(1&n&&(B(),X(0,"rect",27)),2&n){const e=v(2).index,r=v().index,s=v();C1("id","chosenPiece_",4*r+e,""),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE)}}function J8t(n,t){if(1&n&&(B(),X(0,"rect",12)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getPieceClasses(4*r+e)),D("x",s.SPACE_SIZE*e+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("y",s.SPACE_SIZE*r+s.SPACE_SIZE/2-s.getPieceSize(4*r+e))("width",2*s.getPieceSize(4*r+e))("height",2*s.getPieceSize(4*r+e))}}function eut(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2).index,r=v().index,s=v();T("ngClass",s.getPieceClasses(4*r+e)),D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",s.getPieceSize(4*r+e))}}function tut(n,t){if(1&n&&(B(),X(0,"circle")),2&n){const e=v(2).index,r=v().index,s=v();D("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)("r",10)}}function nut(n,t){if(1&n){const e=Oe();B(),b(0,"g",13),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().choosePiece(4*i+s))}),x(1,Q8t,1,5,"rect",26),x(2,J8t,1,5,"rect",10),x(3,eut,1,4,"ng-template",null,11,c1),x(5,tut,1,3,"circle",7),O()}if(2&n){const e=t1(4),r=v().index,s=v().index,i=v();C1("id","choosePiece_",4*s+r,""),S(1),T("ngIf",i.pieceToGive.equalsValue(i.QuartoPiece.fromInt(4*s+r))),S(1),T("ngIf",(4*s+r)%4<2)("ngIfElse",e),S(3),T("ngIf",i.pieceHasDot(4*s+r))}}function rut(n,t){if(1&n&&(B(),b(0,"g"),x(1,nut,6,5,"g",3),O()),2&n){const e=t.index,r=v().index,s=v();S(1),T("ngIf",s.isRemaining(4*r+e))}}function sut(n,t){if(1&n&&(B(),b(0,"g",null,23),X(2,"rect",24,25),x(4,rut,2,1,"g",2),O()),2&n){const e=t.$implicit,r=v();D("transform","translate(0 "+6.5*r.SPACE_SIZE+")"),S(2),D("x",-.125*r.SPACE_SIZE)("y",-.125*r.SPACE_SIZE)("width",4.25*r.SPACE_SIZE)("height",4.25*r.SPACE_SIZE),S(2),T("ngForOf",e)}}let iut=(()=>{class n extends No{constructor(e){super(e),this.EMPTY=je.EMPTY,this.QuartoPiece=je,this.chosen=P.empty(),this.lastMove=P.empty(),this.pieceInHand=je.EMPTY,this.pieceToGive=P.empty(),this.victoriousCoords=[],this.rules=new ei(Vc),this.availableMinimaxes=[new kH(this.rules,"QuartoMinimax")],this.encoder=H4.encoder,this.tutorial=(new O3e).tutorial,this.pieceInHand=this.getState().pieceInHand,this.updateBoard()}updateBoard(){const e=this.getState(),r=this.rules.node.move;this.board=e.getCopiedBoard(),this.chosen=P.empty(),this.pieceInHand=e.pieceInHand,this.victoriousCoords=this.rules.getVictoriousCoords(e),this.lastMove=r.map(s=>s.coord)}chooseCoord(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#chooseCoord_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());if(s.hideLastMove(),s.board[r][e]===je.EMPTY){if(s.showPieceInHandOnBoard(e,r),15===s.getState().turn){const o=new H4(e,r,je.EMPTY);return s.chooseMove(o,s.getState())}if(s.pieceToGive.isAbsent())return U.SUCCESS;{const o=new H4(e,r,s.pieceToGive.get());return s.chooseMove(o,s.getState())}}return s.cancelMove(rt.MUST_CLICK_ON_EMPTY_SPACE())})()}choosePiece(e){var r=this;return A(function*(){const s=r.canUserPlay("#choosePiece_"+e);if(s.isFailure())return r.cancelMove(s.getReason());if(r.hideLastMove(),r.pieceToGive.equalsValue(je.fromInt(e)))return r.cancelMoveAttempt(),U.SUCCESS;if(r.pieceToGive=P.of(je.fromInt(e)),r.chosen.isAbsent())return U.SUCCESS;{const i=r.chosen.get(),o=new H4(i.x,i.y,r.pieceToGive.get());return r.chooseMove(o,r.rules.node.gameState)}})()}hideLastMove(){this.lastMove=P.empty()}cancelMoveAttempt(){this.hideLastMove(),this.pieceToGive=P.empty(),this.chosen=P.empty()}deselectDroppedPiece(){const e=this.chosen.getOrElse(new M(404,404)),s=this.canUserPlay("#droppedPiece_"+e.x+"_"+e.y);return s.isFailure()?this.cancelMove(s.getReason()):(this.cancelMoveAttempt(),U.SUCCESS)}showPieceInHandOnBoard(e,r){this.chosen=P.of(new M(e,r))}isRemaining(e){return Vc.isGivable(je.fromInt(e),this.board,this.pieceInHand)}getSquareClasses(e,r){const s=new M(e,r);return this.lastMove.equalsValue(s)?["moved-fill"]:[]}getPieceClasses(e){const r=[];return r.push(e%2==0?"player0-fill":"player1-fill"),r}getPieceSize(e){return e<8?40:25}pieceHasDot(e){return e!==je.EMPTY.value&&e%8<4}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-quarto"]],features:[l],decls:11,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["transform","translate(5 5)"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],["pieceInHandDiv",""],["x","0","y","0",1,"base","no-fill"],["rectangleInWhichThePieceInHandIsWaiting",""],[4,"ngIf"],["boardDiv",""],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf","ngIfElse"],["circle",""],[1,"base",3,"ngClass"],[3,"id","click"],["droppedPiece",""],["id","selected","x","0","y","0",1,"base","selected","mid-stroke"],["x","0","y","0","class","base",3,"ngClass",4,"ngIf","ngIfElse"],["x","0","y","0",1,"base",3,"ngClass"],["victoriousCoordsDiv",""],["id","victory","x","0","y","0",1,"base","no-fill","victory-stroke"],["cx","0",4,"ngIf"],["cx","0",1,"base",3,"ngClass"],["cx","0"],["remainingPiece",""],["stroke-dasharray","10, 10",1,"base","no-fill"],["rectangleInWhichTheRemainingPiecesAre",""],["class","base selected-stroke",3,"id",4,"ngIf"],[1,"base","selected-stroke",3,"id"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"g",1),x(2,$8t,3,1,"g",2),x(3,q8t,7,8,"g",3),x(4,j8t,3,3,"g",2),b(5,"g",null,4),X(7,"rect",5,6),x(9,X8t,5,3,"g",7),O(),x(10,sut,5,6,"g",2),O()()),2&e&&(D("viewBox","0 0 "+4.25*r.SPACE_SIZE+" "+10.75*r.SPACE_SIZE),S(2),T("ngForOf",r.board),S(1),T("ngIf",r.chosen.isPresent()),S(1),T("ngForOf",r.victoriousCoords),S(1),D("transform","translate("+2*r.SPACE_SIZE+", "+4.5*r.SPACE_SIZE+")"),S(2),D("width",1.5*r.SPACE_SIZE)("height",1.5*r.SPACE_SIZE)("transform","translate("+-.75*r.SPACE_SIZE+", 0)"),S(2),T("ngIf",r.chosen.isAbsent()),S(1),T("ngForOf",r.board))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),out=(()=>{class n{}return n.NO_INSIDE_CLICK=()=>$localize`You must pick a space from the edge of the board.`,n})();class B4 extends S3{constructor(t,e,r){super(t,e),this.direction=r;const s=B4.isValidCoord(this.coord);if(s.isFailure())throw new Error(s.getReason());if(0===t&&r===He.LEFT)throw new Error("Invalid direction: pawn on the left side can't be moved to the left.");if(4===t&&r===He.RIGHT)throw new Error("Invalid direction: pawn on the right side can't be moved to the right.");if(0===e&&r===He.UP)throw new Error("Invalid direction: pawn on the top side can't be moved up.");if(4===e&&r===He.DOWN)throw new Error("Invalid direction: pawn on the bottom side can't be moved down.")}static isValidCoord(t){return t.isNotInRange(5,5)?U.failure("Invalid coord for QuixoMove: "+t.toString()+" is outside the board."):0!==t.x&&4!==t.x&&0!==t.y&&4!==t.y?U.failure(out.NO_INSIDE_CLICK()):U.SUCCESS}toString(){return"QuixoMove("+this.coord.x+", "+this.coord.y+", "+this.direction.toString()+")"}equals(t){return t===this||!!t.coord.equals(this.coord)&&t.direction===this.direction}}B4.encoder=new class extends Cn{maxValue(){return 128}encodeNumber(n){const t=n.direction.toInt();return 20*n.coord.x+4*n.coord.y+t}decodeNumber(n){const t=He.factory.fromInt(n%4).get();n-=n%4;const e=(n/=4)%5;return n-=n%5,new B4(n/=5,e,t)}};class o8 extends ps{static getInitialState(){const t=Ke.createTable(5,5,pe.NONE);return new o8(t,0)}applyLegalMove(t){const e=this.getCopiedBoard(),r=this.turn+1;let s=t.coord,i=t.coord.getNext(t.direction);for(;i.isInRange(5,5);)e[s.y][s.x]=e[i.y][i.x],s=s.getNext(t.direction),i=i.getNext(t.direction);return e[s.y][s.x]=this.getCurrentPlayer(),new o8(e,r)}}class Ho extends Z1{static getVerticalCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=0;s<5;s++)t.gameState.getPieceAtXY(0,s)!==e&&r.push(new M(0,s)),t.gameState.getPieceAtXY(4,s)!==e&&r.push(new M(4,s));return r}static getHorizontalCenterCoords(t){const e=t.gameState.getCurrentOpponent(),r=[];for(let s=1;s<4;s++)t.gameState.getPieceAtXY(s,0)!==e&&r.push(new M(s,0)),t.gameState.getPieceAtXY(s,4)!==e&&r.push(new M(s,4));return r}static getPossibleDirections(t){const e=[];return 0!==t.x&&e.push(He.LEFT),0!==t.y&&e.push(He.UP),4!==t.x&&e.push(He.RIGHT),4!==t.y&&e.push(He.DOWN),e}static getLinesSums(t){const e={};e[z.ZERO.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]},e[z.ONE.value]={columns:[0,0,0,0,0],rows:[0,0,0,0,0],diagonals:[0,0]};for(let r=0;r<5;r++)for(let s=0;s<5;s++){const i=t.getPieceAtXY(s,r);if(i.isPlayer()){const o=i.value;e[o].columns[s]=e[o].columns[s]+1,e[o].rows[r]=e[o].rows[r]+1,s===r&&(e[o].diagonals[0]=e[o].diagonals[0]+1),s+r===4&&(e[o].diagonals[1]=e[o].diagonals[1]+1)}}return e}static getVictoriousCoords(t){const e=Ho.getLinesSums(t),r=[];for(let s=0;s<2;s++){for(let i=0;i<5;i++){if(5===e[s].columns[i])for(let o=0;o<5;o++)r.push(new M(i,o));if(5===e[s].rows[i])for(let o=0;o<5;o++)r.push(new M(o,i))}if(5===e[s].diagonals[0])for(let i=0;i<5;i++)r.push(new M(i,i));if(5===e[s].diagonals[1])for(let i=0;i<5;i++)r.push(new M(i,4-i))}return r}static getFullestLine(t){const e=t.columns.concat(t.rows.concat(t.diagonals));return Math.max(...e)}applyLegalMove(t,e,r){return Ho.applyLegalMove(t,e,r)}static applyLegalMove(t,e,r){return e.applyLegalMove(t)}isLegal(t,e){return e.getPieceAt(t.coord)===e.getCurrentOpponent()?$.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):$.success(void 0)}getGameStatus(t){const e=t.gameState,r=Ho.getLinesSums(e),s=Ho.getFullestLine(r[z.ZERO.value]),i=Ho.getFullestLine(r[z.ONE.value]),o=e.getCurrentPlayer();return 5===s&&(o===z.ZERO||i<5)?xe.ZERO_WON:5===i?xe.ONE_WON:xe.ONGOING}}class aut extends $1{getListMoves(t){const e=[],r=Ho.getVerticalCoords(t),i=Ho.getHorizontalCenterCoords(t).concat(r);for(const o of i){const c=Ho.getPossibleDirections(o);for(const u of c){const h=new B4(o.x,o.y,u);e.push(h)}}return e}getBoardValue(t){const e=t.gameState,r=Ho.getLinesSums(e),s=Ho.getFullestLine(r[z.ZERO.value]),i=Ho.getFullestLine(r[z.ONE.value]),o=e.getCurrentPlayer();return new Ct(5===s&&(o===z.ZERO||i<5)?z.ZERO.getVictoryValue():5===i?z.ONE.getVictoryValue():i-s)}}const dr=pe.NONE,Hc=pe.ZERO,R3=pe.ONE;class N3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game.`,$localize`At Quixo, the goal is to align 5 of your pieces.
        The first player plays with dark pieces, the second with light pieces.
        The board is made of 25 spaces spread over a 5x5 square.
        Every piece has a neutral side, a light side, and a dark side.`,o8.getInitialState()),ce.fromMove($localize`What a move looks like (without animation)`,$localize`When it is your turn:
        <ol>
            <li>Click on one of your pieces or on a neutral one. You cannot choose a piece of the opponent.
                You can only choose a piece from the edge of the board.</li>
            <li>Pick a direction in which you want to send the piece (by clicking on the arrow).</li>
        </ol>
        You have to imagine that the piece you picked has been moved to the other side of the board, in the chosen direction.
        Once on the other side, all pieces will move by one space in the opposing direction.
        Afterwards, if the piece was neutral, it will become yours and takes your color.<br/><br/>
        For example, take the bottom right neutral piece, and move it to the left (you're playing Light).`,new o8([[dr,dr,dr,dr,dr],[dr,dr,dr,dr,dr],[dr,dr,dr,dr,dr],[dr,dr,dr,dr,dr],[Hc,Hc,Hc,Hc,dr]],1),[new B4(4,4,He.LEFT)],$localize`See how the four dark pieces have been moved one space to the right.
        The neutral piece has been move 4 pieces to the left and has become light.`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory`,$localize`You already know everything you need in order to play, but there is one last particularity.
        If you create a line of 5 of your pieces, you win.
        If you create a line of 5 of your opponent's pieces, you lose.
        If you create both, you lose too!<br/><br/>
        You can win with this board, try it.
        You're playing Light.`,new o8([[dr,R3,dr,R3,R3],[dr,Hc,Hc,dr,Hc],[R3,R3,R3,Hc,R3],[Hc,dr,Hc,R3,R3],[R3,Hc,dr,R3,Hc]],31),[new B4(3,0,He.DOWN)],$localize`Congratulations, you won!`,$localize`Failed. Try again.`)]}}function cut(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"circle",4),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onBoardClick(i,o))}),O()()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getPieceClasses(e,r)),D("r",.45*s.SPACE_SIZE)("cx",(e+.5)*s.SPACE_SIZE)("cy",(r+.5)*s.SPACE_SIZE)}}function lut(n,t){if(1&n&&(B(),b(0,"g"),x(1,cut,2,6,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function uut(n,t){if(1&n){const e=Oe();B(),b(0,"use",6),J("click",function(){const i=fe(e).$implicit;return ae(v(2).chooseDirection(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);C1("id","chooseDirection_",e,""),D("transform",r.getArrowTransform(e))}}function fut(n,t){if(1&n&&(B(),b(0,"g"),x(1,uut,1,2,"use",5),O()),2&n){const e=v();S(1),T("ngForOf",e.getPossiblesDirections())}}let hut=(()=>{class n extends No{constructor(e){super(e),this.lastMoveCoord=P.empty(),this.chosenCoord=P.empty(),this.victoriousCoords=[],this.rules=new Ho(o8),this.availableMinimaxes=[new aut(this.rules,"QuixoMinimax")],this.encoder=B4.encoder,this.tutorial=(new N3e).tutorial,this.updateBoard()}updateBoard(){this.state=this.getState(),this.board=this.state.board,this.lastMoveCoord=this.rules.node.move.map(e=>e.coord),this.victoriousCoords=Ho.getVictoriousCoords(this.state)}cancelMoveAttempt(){this.chosenCoord=P.empty()}getPieceClasses(e,r){const s=new M(e,r),o=[];return o.push(this.getPlayerClass(this.board[r][e])),this.chosenCoord.equalsValue(s)?o.push("selected-stroke"):this.lastMoveCoord.equalsValue(s)&&o.push("last-move-stroke"),this.victoriousCoords.some(c=>c.equals(s))&&o.push("victory-stroke"),o}onBoardClick(e,r){const s=this.canUserPlay("#click_"+e+"_"+r);if(s.isFailure())return this.cancelMove(s.getReason());const i=new M(e,r),o=B4.isValidCoord(i);return o.isFailure()?this.cancelMove(o.getReason()):this.board[r][e]===this.state.getCurrentOpponent()?this.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):(this.chosenCoord.equalsValue(i)?this.cancelMoveAttempt():this.chosenCoord=P.of(i),U.SUCCESS)}getPossiblesDirections(){const e=[],r=this.chosenCoord.get();return 4!==r.x&&e.push(He.RIGHT),0!==r.x&&e.push(He.LEFT),4!==r.y&&e.push(He.DOWN),0!==r.y&&e.push(He.UP),e}chooseDirection(e){var r=this;return A(function*(){const s=r.canUserPlay("#chooseDirection_"+e.toString());return s.isFailure()?r.cancelMove(s.getReason()):(r.chosenDirection=e,yield r.tryMove())})()}tryMove(){var e=this;return A(function*(){const r=e.chosenCoord.get(),s=new B4(r.x,r.y,e.chosenDirection);return e.cancelMove(),e.chooseMove(s,e.getState())})()}getArrowTransform(e){return class l6t{static getArrowTransform(t,e,r){let s,i,o;switch(r){case He.UP:s=1,i=0,o=-90;break;case He.DOWN:s=1,i=2,o=90;break;case He.LEFT:s=0,i=1,o=180;break;default:we.expectToBe(r,He.RIGHT),s=2,i=1,o=0}return["scale("+t/300+")",`translate(${100*s} ${100*i})`,"rotate("+o+" 50 50)"].join(" ")}}.getArrowTransform(5*this.SPACE_SIZE,new M(0,0),e)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-quixo"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 0, 100 50, 0 100"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"base",3,"id","ngClass","click"],[0,"xlink","href","#triangle","class","semi-transparent",3,"id","click",4,"ngFor","ngForOf"],[0,"xlink","href","#triangle",1,"semi-transparent",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs"),X(2,"polygon",1),O(),x(3,lut,2,1,"g",2),x(4,fut,2,1,"g",3),O()),2&e&&(D("viewBox","0 0 "+5*r.SPACE_SIZE+" "+5*r.SPACE_SIZE),S(3),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),W1=(()=>{class n extends ps{static getInitialState(){const e=Ke.createTable(n.BOARD_WIDTH,n.BOARD_HEIGHT,pe.NONE);return e[3][3]=z.ZERO,e[4][4]=z.ZERO,e[3][4]=z.ONE,e[4][3]=z.ONE,new n(e,0)}static getNeighboringPawnLike(e,r,s,i){let o;const c=[];for(let u=-1;u<2;u++)for(let h=-1;h<2;h++)o=new M(s+h,i+u),o.isInRange(this.BOARD_WIDTH,this.BOARD_HEIGHT)&&e[o.y][o.x]===r&&c.push(o);return c}countScore(){const e=[0,0];for(let r=0;r<n.BOARD_HEIGHT;r++)for(let s=0;s<n.BOARD_WIDTH;s++){const i=this.board[r][s];i.isPlayer()&&(e[i.value]+=1)}return e}}return n.BOARD_WIDTH=8,n.BOARD_HEIGHT=8,n})();class Gi extends S3{equals(t){return t===this||t.coord.equals(this.coord)}toString(){return"ReversiMove("+this.coord.x+", "+this.coord.y+")"}}Gi.encoder=new class extends Cn{maxValue(){return(W1.BOARD_HEIGHT-1)*W1.BOARD_WIDTH+(W1.BOARD_WIDTH-1)}encodeNumber(n){return n.coord.y*W1.BOARD_WIDTH+n.coord.x}decodeNumber(n){const t=n%W1.BOARD_WIDTH;return new Gi(t,(n-t)/W1.BOARD_WIDTH)}},Gi.PASS=new Gi(-1,-1),Gi.PASS_NUMBER=Gi.encoder.encodeNumber(Gi.PASS);let dut=(()=>{class n{}return n.NO_ELEMENT_SWITCHED=()=>$localize`Your move should switch at least one piece.`,n})();class A3e{constructor(t,e){this.move=t,this.switched=e}}let Zm=(()=>{class n extends Z1{static getGameStatus(e){const r=e.gameState;if(!1===n.isGameEnded(r))return xe.ONGOING;const i=r.countScore(),o=i[1]-i[0];return o<0?xe.ZERO_WON:o>0?xe.ONE_WON:xe.DRAW}applyLegalMove(e,r,s){const i=r.turn,o=r.getCurrentPlayer(),c=r.getCopiedBoard();if(e.equals(Gi.PASS))return new W1(c,i+1);for(const h of s)c[h.y][h.x]=o;return c[e.coord.y][e.coord.x]=o,new W1(c,i+1)}static getAllSwitcheds(e,r,s){const i=[],o=r.getOpponent();for(const c of be.DIRECTIONS){const u=e.coord.getNext(c);if(u.isInRange(W1.BOARD_WIDTH,W1.BOARD_HEIGHT)&&s[u.y][u.x]===o){const h=n.getSandwicheds(r,c,u,s);for(const p of h)i.push(p)}}return i}static getSandwicheds(e,r,s,i){const o=[s];let c=s.getNext(r);for(;c.isInRange(W1.BOARD_WIDTH,W1.BOARD_HEIGHT);){const u=i[c.y][c.x];if(u===e)return o;if(u===pe.NONE)return[];o.push(c),c=c.getNext(r)}return[]}static isGameEnded(e){return this.playerCanOnlyPass(e)&&this.nextPlayerCantOnlyPass(e)}getGameStatus(e){return n.getGameStatus(e)}static playerCanOnlyPass(e){const r=this.getListMoves(e);return 1===r.length&&r[0].move.equals(Gi.PASS)}static nextPlayerCantOnlyPass(e){const r=e.getCopiedBoard(),i=new W1(r,e.turn+1);return this.playerCanOnlyPass(i)}static getListMoves(e){const r=[];let s;const i=e.getCurrentPlayer(),o=e.getCurrentOpponent();for(let c=0;c<8;c++)for(let u=0;u<8;u++)if(e.getPieceAtXY(u,c)===pe.NONE&&(s=e.getCopiedBoard(),W1.getNeighboringPawnLike(s,o,u,c).length>0)){const p=new Gi(u,c),m=n.getAllSwitcheds(p,i,s);if(m.length>0){for(const C of m)ye(i!==e.getPieceAt(C),C+"was already switched!"),s[C.y][C.x]=i;s[c][u]=i,r.push(new A3e(p,m.length))}}return 0===r.length&&r.push(new A3e(Gi.PASS,0)),r}isLegal(e,r){if(e.equals(Gi.PASS))return n.playerCanOnlyPass(r)?$.success([]):$.failure(rt.MUST_PASS());if(r.getPieceAt(e.coord).isPlayer())return K(n.VERBOSE,"ReversiRules.isLegal: you cannot play on a busy space"),$.failure(rt.MUST_CLICK_ON_EMPTY_SPACE());const s=r.getCopiedBoard(),i=n.getAllSwitcheds(e,r.getCurrentPlayer(),s);return K(n.VERBOSE,"ReversiRules.isLegal: "+i.length+" element(s) switched"),0===i.length?$.failure(dut.NO_ELEMENT_SWITCHED()):$.success(i)}}return n.VERBOSE=!1,n})();class UP extends $1{getBoardValue(t){const e=Zm.getGameStatus(t);if(e.isEndGame)return Ct.fromWinner(e.winner);const s=t.gameState.getCopiedBoard();let i=0,o=0;for(let c=0;c<W1.BOARD_HEIGHT;c++)for(let u=0;u<W1.BOARD_WIDTH;u++){const m=(0===u||u===W1.BOARD_WIDTH-1?4:1)*(0===c||c===W1.BOARD_HEIGHT-1?4:1);s[c][u]===z.ZERO&&(i+=m),s[c][u]===z.ONE&&(o+=m)}return Ct.from(i,o)}getListMoves(t){const e=Zm.getListMoves(t.gameState);return Ke.sortByDescending(e,r=>UP.bestCoords.some(s=>r.move.coord.equals(s))?100:r.switched),e.map(r=>r.move)}}UP.bestCoords=[new M(0,0),new M(0,W1.BOARD_HEIGHT-1),new M(W1.BOARD_WIDTH-1,0),new M(W1.BOARD_WIDTH-1,W1.BOARD_HEIGHT-1)];const zt=pe.NONE,Ft=pe.ZERO,lt=pe.ONE;class I3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Reversi, the pieces are double sided: one dark side for the first player, one light side for the second player.
        When one piece is flipped, its owner changes.
        The player owning the most pieces at the end of the game wins.
        Here, Dark has 28 points and Light has 36, hence Light wins.`,new W1([[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft]],60)),ce.anyMove($localize`Capture (1/2)`,$localize`At the beginning of the game, pieces are placed as shown here.
        For a move to be legal, it must sandwich at least one piece of the opponent between the piece you're putting and another of your pieces.<br/><br/>
        Do any move by clicking to put your piece
        Dark plays first.`,W1.getInitialState(),new Gi(2,4),$localize`Congratulations!`),ce.fromMove($localize`Capture (2/2)`,$localize`A move can also capture a bigger line, and more than one line at a time<br/><br/>
        You're playing light here. Play on the bottom left to see a capture.`,new W1([[zt,zt,zt,zt,zt,zt,zt,zt],[zt,zt,zt,zt,zt,zt,zt,zt],[zt,zt,zt,zt,zt,zt,zt,zt],[zt,zt,zt,zt,lt,zt,zt,zt],[zt,zt,zt,Ft,zt,zt,zt,zt],[zt,zt,Ft,zt,zt,zt,zt,zt],[Ft,Ft,zt,zt,zt,zt,zt,zt],[zt,Ft,lt,Ft,lt,Ft,zt,zt]],1),[new Gi(0,7)],$localize`Congratulations!`,$localize`Lower and more to the left, please.`),ce.informational($localize`Passing a turn`,$localize`If, during its turn, a player has no move that would allow that player to flip a piece, that player must pass
        Moreover, if the next player could not play neither, the game ends before the board is full, and points are counted in the usual way.`,new W1([[lt,Ft,Ft,Ft,Ft,Ft,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[Ft,lt,lt,lt,lt,lt,lt,Ft],[lt,lt,lt,lt,lt,lt,zt,zt],[Ft,Ft,Ft,Ft,Ft,Ft,zt,zt]],60))]}}function put(n,t){if(1&n&&(B(),X(0,"circle",4)),2&n){const e=v().index,r=v().index,s=v();T("ngClass",s.getPieceClass(e,r)),D("r",s.SPACE_SIZE/2-s.STROKE_WIDTH)("cx",s.SPACE_SIZE*e+s.SPACE_SIZE/2)("cy",s.SPACE_SIZE*r+s.SPACE_SIZE/2)}}function gut(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",2),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),O(),x(2,put,1,4,"circle",3),O()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","click_",e,"_",r,""),T("ngClass",s.getRectClasses(e,r)),D("x",s.SPACE_SIZE*e)("y",s.SPACE_SIZE*r)("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function mut(n,t){if(1&n&&(B(),b(0,"g"),x(1,gut,3,8,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let _ut=(()=>{class n extends No{constructor(e){super(e),this.EMPTY=pe.NONE,this.lastMove=new M(-2,-2),this.capturedCoords=[],this.scores=P.of([2,2]),this.rules=new Zm(W1),this.availableMinimaxes=[new UP(this.rules,"ReversiMinimax")],this.encoder=Gi.encoder,this.tutorial=(new I3e).tutorial,this.canPass=!1,this.updateBoard()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=new Gi(e,r);return yield s.chooseMove(o,s.getState(),s.scores.get())})()}updateBoard(){const e=this.getState();this.board=e.getCopiedBoard(),this.capturedCoords=[],this.rules.node.move.isPresent()?this.showPreviousMove():this.lastMove=new M(-2,-2),this.scores=P.of(e.countScore()),this.canPass=Zm.playerCanOnlyPass(e)}showPreviousMove(){this.lastMove=this.rules.node.move.get().coord;const e=this.getState().getCurrentPlayer(),r=this.getState().getCurrentOpponent();for(const s of be.DIRECTIONS){let i=this.lastMove.getNext(s,1);for(;i.isInRange(W1.BOARD_WIDTH,W1.BOARD_HEIGHT)&&this.getState().getPieceAt(i)===r&&this.rules.node.mother.get().gameState.getPieceAt(i)===e;)this.capturedCoords.push(i),i=i.getNext(s,1)}}getRectClasses(e,r){const s=new M(e,r);return this.capturedCoords.some(i=>i.equals(s))?["captured-fill"]:s.equals(this.lastMove)?["moved-fill"]:[]}getPieceClass(e,r){return this.getPlayerClass(this.board[r][e])}pass(){var e=this;return A(function*(){return ye(e.canPass,"ReversiComponent: pass() can only be called if canPass is true"),e.onClick(Gi.PASS.coord.x,Gi.PASS.coord.y)})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-reversi"]],features:[l],decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base",3,"ngClass",4,"ngIf"],[1,"base",3,"ngClass"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,mut,2,1,"g",1),O()),2&e&&(D("viewBox","0 -4 "+8*r.SPACE_SIZE+" "+(10+8*r.SPACE_SIZE)),S(1),T("ngForOf",r.board))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),Pi=(()=>{class n extends _5{static getInitialState(){const e=Ae.UNREACHABLE,r=Ae.ZERO,s=Ae.ONE,i=Ae.EMPTY;return new n([[e,e,r,s,i,i,i,r,s,e,e],[e,i,i,i,i,i,i,i,i,i,e],[s,i,i,i,i,i,i,i,i,i,r],[r,i,i,i,i,i,i,i,i,i,s],[e,i,i,i,i,i,i,i,i,i,e],[e,e,s,r,i,i,i,s,r,e,e]],0)}}return n.HEIGHT=6,n.WIDTH=11,n})(),O9=(()=>{class n{}return n.CAN_ONLY_REBOUND_ON_BLACK=()=>$localize`You can only rebound on dark spaces.`,n.CAN_ONLY_REBOUND_ON_EMPTY_SPACE=()=>$localize`You can only rebound on empty spaces.`,n.MUST_CHOOSE_PYRAMID_FIRST=()=>$localize`You must pick one of your pyramids first.`,n.MUST_CHOOSE_OWN_PYRAMID=()=>$localize`You must pick one of your pyramids.`,n.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS=()=>$localize`Those two spaces are not neighbors.`,n.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR=()=>$localize`Those two spaces have no intermediary neighbor.`,n})();class D3 extends X0{constructor(t,e){super(t,e)}static checkDistanceAndLocation(t,e){const r=t.getOrthogonalDistance(e);if(0===r)return U.failure(rt.MOVE_CANNOT_BE_STATIC());if(1===r){const s=Oc.getFakeNeighbors(t);if(e.equals(s))return U.failure(O9.THOSE_TWO_SPACES_ARE_NOT_NEIGHBORS())}else{if(2!==r)return U.failure($localize`You can move one or two spaces, not ${r}.`);if(Oc.isSpaceDark(t))return U.failure(O9.CAN_ONLY_REBOUND_ON_BLACK());if(t.x===e.x)return U.failure(O9.THOSE_TWO_SPACES_HAVE_NO_COMMON_NEIGHBOR())}return U.SUCCESS}static from(t,e){if(!t.isInRange(Pi.WIDTH,Pi.HEIGHT))throw new Error("Move must start inside the board not at "+t.toString()+".");if(!e.isInRange(Pi.WIDTH,Pi.HEIGHT))throw new Error("Move must end inside the board not at "+e.toString()+".");const r=D3.checkDistanceAndLocation(t,e);return r.isFailure()?r.toFailedFallible():$.success(new D3(t,e))}isSimpleStep(){return Math.abs(this.getStart().x-this.getEnd().x)+Math.abs(this.getStart().y-this.getEnd().y)===1}equals(t){return t===this||!!t.getStart().equals(this.getStart())&&t.getEnd().equals(this.getEnd())}toString(){return"SaharaMove("+this.getStart()+"->"+this.getEnd()+")"}}D3.encoder=new class extends Cn{maxValue(){return 396*Pi.WIDTH+66*Pi.HEIGHT+6*Pi.WIDTH+Pi.HEIGHT}encodeNumber(n){const t=n.getEnd().y,e=n.getEnd().x,r=n.getStart().y;return 396*n.getStart().x+66*r+6*e+t}decodeNumber(n){const t=n%6;n-=t;const e=(n/=6)%11;n-=e;const r=(n/=11)%6;return n-=r,D3.from(new M(n/=6,r),new M(e,t)).get()}};let N9=(()=>{class n extends Z1{static getStartingCoords(e,r){const s=[];for(let i=0;i<Pi.HEIGHT;i++)for(let o=0;o<Pi.WIDTH;o++)e[i][o].is(r)&&s.push(new M(o,i));return s}static getBoardValuesFor(e,r){const s=n.getStartingCoords(e,r),i=[];for(const o of s){const c=_5.getEmptyNeighbors(e,o,Ae.EMPTY).length;if(0===c)return[0];i.push(c)}return i.sort((o,c)=>o-c)}applyLegalMove(e,r,s){K(n.VERBOSE,"Legal move "+e.toString()+" applied");const i=r.getCopiedBoard();return i[e.getEnd().y][e.getEnd().x]=i[e.getStart().y][e.getStart().x],i[e.getStart().y][e.getStart().x]=Ae.EMPTY,new Pi(i,r.turn+1)}isLegal(e,r){if(r.getPieceAt(e.getStart()).value!==r.getCurrentPlayer().value)return $.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE());if(r.getPieceAt(e.getEnd())!==Ae.EMPTY)return $.failure(rt.MUST_LAND_ON_EMPTY_SPACE());const o=Oc.getCommonNeighbor(e.getStart(),e.getEnd());return o.isPresent()?r.getPieceAt(o.get())===Ae.EMPTY?$.success(void 0):$.failure(O9.CAN_ONLY_REBOUND_ON_EMPTY_SPACE()):$.success(void 0)}getGameStatus(e){const r=e.gameState.getCopiedBoard(),s=n.getBoardValuesFor(r,z.ZERO),i=n.getBoardValuesFor(r,z.ONE);return n.getGameStatusFromFreedoms(s,i)}getLandingCoords(e,r){const s=o=>o.isInRange(Pi.WIDTH,Pi.HEIGHT)&&e[o.y][o.x]===Ae.EMPTY,i=new Ht(Oc.getNeighbors(r).filter(s));if(!0===Oc.isSpaceDark(r))return i.toList();{const o=new Ht(i.toList());for(const c of i){const u=Oc.getNeighbors(c).filter(s);for(const h of u)o.add(h)}return o.toList()}}static getGameStatusFromFreedoms(e,r){return 0===e[0]?xe.ONE_WON:0===r[0]?xe.ZERO_WON:xe.ONGOING}}return n.VERBOSE=!1,n})();class vut extends $1{getListMoves(t){const e=[],r=t.gameState.getCopiedBoard(),s=t.gameState.getCurrentPlayer(),i=N9.getStartingCoords(r,s);for(const o of i){const c=_5.getEmptyNeighbors(r,o,Ae.EMPTY);for(const u of c){const h=D3.from(o,u).get();if(r[u.y][u.x]=r[o.y][o.x],r[o.y][o.x]=Ae.EMPTY,e.push(h),(u.y+u.x)%2==0){const m=_5.getEmptyNeighbors(r,u,Ae.EMPTY);for(const C of m)if(!C.equals(o)){const w=D3.from(o,C).get();r[C.y][C.x]=r[u.y][u.x],r[u.y][u.x]=Ae.EMPTY,e.push(w),r[u.y][u.x]=r[C.y][C.x],r[C.y][C.x]=Ae.EMPTY}}r[o.y][o.x]=r[u.y][u.x],r[u.y][u.x]=Ae.EMPTY}}return e}getBoardValue(t){const r=t.gameState.getCopiedBoard(),s=N9.getBoardValuesFor(r,z.ZERO),i=N9.getBoardValuesFor(r,z.ONE),o=N9.getGameStatusFromFreedoms(s,i);if(o.isEndGame)return Ct.fromWinner(o.winner);let c=0;for(;c<6&&s[c]===i[c];)c++;return new Ct(i[c%6]-s[c%6])}}const Fc=Ae.UNREACHABLE,A9=Ae.ZERO,I9=Ae.ONE,An=Ae.EMPTY;class x3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Initial board`,$localize`Sâhârâ is played on a board where each space is a triangle.
        Each player has six pyramids.`,Pi.getInitialState()),ce.informational($localize`Goal of the game`,$localize`At Sâhârâ, the goal of the game is to immobilize one of the opponent's pyramids.
        To do so, you have to occupy all neighboring space of that pyramid.
        Here, Light has lost because its leftmost pyramid is immobilized.`,new Pi([[Fc,Fc,An,An,I9,An,An,A9,I9,Fc,Fc],[Fc,An,An,An,An,An,An,An,An,An,Fc],[I9,A9,An,An,An,An,An,An,An,An,A9],[A9,An,An,An,An,An,An,An,An,An,I9],[Fc,An,An,An,An,An,An,An,An,An,Fc],[Fc,Fc,I9,A9,An,An,An,I9,A9,Fc,Fc]],3)),ce.fromPredicate($localize`Simple step`,$localize`To immobilize your opponent, you have to move your pyramids.
        When a pyramid shares its vertices with light spaces, it can move on these spaces (we call this a simple step).
        To perform a move:
        <ol>
            <li>Click on one of your pyramids.</li>
            <li>Click on one of its two or three neighboring spaces in order to move your pyramid there.</li>
        </ol><br/>
        You're playing Dark, do any simple step.`,Pi.getInitialState(),D3.from(new M(2,0),new M(2,1)).get(),(t,e,r)=>t.isSimpleStep()?U.SUCCESS:U.failure($localize`You have made a double step, which is good but it is the next exercise!`),$localize`Congratulations!`),ce.fromPredicate($localize`Double step`,$localize`When a pyramid shares its vertices with dark spaces, it can move one or two steps.
        To do so:
        <ol>
            <li>Click on the pyramid to move.</li>
            <li>Click on one of the 6 destinations that you can reach in two steps:
                 the 6 neighboring light spaces of the 3 dark spaces that are neighbors of your pyramid.
        </ol><br/>
        You're playing Dark, do a double step.`,Pi.getInitialState(),D3.from(new M(7,0),new M(5,0)).get(),(t,e,r)=>t.isSimpleStep()?U.failure($localize`Failed! You have made a single step.`):U.SUCCESS,$localize`Congratulations!`)]}}function Cut(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polygon",7),O()),2&n){const e=v().index,r=v().index,s=v();S(1),T("ngClass",s.getPlayerClassFor(e,r)),D("points",s.getPyramidCoordinate(e,r))}}function yut(n,t){if(1&n&&(B(),X(0,"polygon",10)),2&n){const e=v(2).index,r=v().index;D("points",v().getTriangleCoordinate(e,r))}}function Eut(n,t){if(1&n&&(B(),X(0,"polygon",11)),2&n){const e=v(2).index,r=v().index;D("points",v().getTriangleCoordinate(e,r))}}function Mut(n,t){if(1&n&&(B(),b(0,"g"),x(1,yut,1,1,"polygon",8),x(2,Eut,1,1,"polygon",9),O()),2&n){const e=v().index,r=v().index;S(1),T("ngIf",(e+r)%2==1),S(1),T("ngIf",(e+r)%2==0)}}function Sut(n,t){if(1&n){const e=Oe();B(),b(0,"g",5),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),x(1,Cut,2,2,"g",6),x(2,Mut,3,2,"g",6),O()}if(2&n){const e=t.$implicit;We("id","click_",t.index,"_",v().index,""),S(1),T("ngIf",e.isPlayer()),S(1),T("ngIf",2===e.value)}}function Put(n,t){if(1&n&&(B(),b(0,"g"),x(1,Sut,3,4,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Tut(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=t.$implicit,r=v(2);We("id","possible_landing_",e.x,"_",e.y,""),D("points",r.getTriangleCoordinate(e.x,e.y))}}function wut(n,t){if(1&n&&(B(),X(0,"polygon",14)),2&n){const e=v(2);We("id","chosen_coord_",e.chosenCoord.get().x,"_",e.chosenCoord.get().y,""),D("points",e.getTriangleCoordinate(e.chosenCoord.get().x,e.chosenCoord.get().y))}}function but(n,t){if(1&n&&(B(),ln(0),x(1,Tut,1,3,"polygon",12),x(2,wut,1,3,"polygon",13),un()),2&n){const e=v();S(1),T("ngForOf",e.possibleLandings),S(1),T("ngIf",e.chosenCoord.isPresent())}}function Out(n,t){if(1&n&&(B(),ln(0),X(1,"polygon",15)(2,"polygon",15),un()),2&n){const e=v(2);S(1),D("points",e.getTriangleCoordinate(e.lastCoord.get().x,e.lastCoord.get().y)),S(1),D("points",e.getTriangleCoordinate(e.lastMoved.get().x,e.lastMoved.get().y))}}function Nut(n,t){1&n&&(B(),x(0,Out,3,2,"ng-container",6)),2&n&&T("ngIf",v().lastMoved.isPresent())}let Aut=(()=>{class n extends Bce{constructor(e){super(e),this.lastCoord=P.empty(),this.lastMoved=P.empty(),this.chosenCoord=P.empty(),this.possibleLandings=[],this.rules=new N9(Pi),this.availableMinimaxes=[new vut(this.rules,"SaharaMinimax")],this.encoder=D3.encoder,this.tutorial=(new x3e).tutorial,this.updateBoard()}cancelMoveAttempt(){this.possibleLandings=[],this.chosenCoord=P.empty()}onClick(e,r){var s=this;return A(function*(){const i=s.canUserPlay("#click_"+e+"_"+r);if(i.isFailure())return s.cancelMove(i.getReason());const o=s.getState().getCurrentPlayer(),c=Ae.ofPlayer(o);return s.chosenCoord.equalsValue(new M(e,r))?(s.cancelMoveAttempt(),U.SUCCESS):s.chosenCoord.isAbsent()||s.board[r][e]===c?s.choosePiece(e,r):s.chooseLandingCoord(e,r)})()}choosePiece(e,r){if(this.board[r][e]===Ae.EMPTY)return this.cancelMove(O9.MUST_CHOOSE_PYRAMID_FIRST());if(this.board[r][e].is(z.fromTurn(this.getTurn()))){const s=new M(e,r);return this.selectPiece(s),U.SUCCESS}return this.cancelMove(O9.MUST_CHOOSE_OWN_PYRAMID())}selectPiece(e){this.chosenCoord=P.of(e),this.possibleLandings=this.rules.getLandingCoords(this.board,e)}chooseLandingCoord(e,r){var s=this;return A(function*(){const i=new M(e,r),o=D3.from(s.chosenCoord.get(),i);return o.isFailure()?s.cancelMove(o.getReason()):yield s.chooseMove(o.get(),s.getState())})()}updateBoard(){const e=this.rules.node.move;this.lastCoord=e.map(r=>r.getStart()),this.lastMoved=e.map(r=>r.getEnd()),this.board=this.getState().board}getPlayerClassFor(e,r){return this.getPlayerClass(z.of(this.board[r][e].value))}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-sahara"]],features:[l],decls:5,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","-4 -4 300 308","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["lastMove",""],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[4,"ngIf"],[1,"base","small-stroke",3,"ngClass"],["class","base small-stroke",4,"ngIf"],["class","base small-stroke background2",4,"ngIf"],[1,"base","small-stroke"],[1,"base","small-stroke","background2"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"id",4,"ngIf"],[1,"base","no-fill","small-stroke","selected-stroke",3,"id"],[1,"base","no-fill","small-stroke","moved-stroke"]],template:function(e,r){if(1&e&&(B(),b(0,"svg",0),x(1,Put,2,1,"g",1),x(2,but,3,2,"ng-container",2),x(3,Nut,1,1,"ng-template",null,3,c1),O()),2&e){const s=t1(4);S(1),T("ngForOf",r.board),S(1),T("ngIf",r.chosenCoord.isPresent())("ngIfElse",s)}},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class da extends S3{constructor(t,e,r,s){super(t,e),this.x=t,this.y=e,this.direction=r,this.landingOrientation=s}static of(t,e,r,s){const i=new da(t,e,r,s),o=i.coord.isNotInRange(5,5);if(i.isRotation()){if(o)return $.failure("Cannot rotate piece outside the board: "+i.toString())}else if(i.coord.getNext(i.direction.get()).isNotInRange(5,5)){if(o)return $.failure("SiamMove should end or start on the board: "+i.toString());if(i.direction.get()!==i.landingOrientation)return $.failure("SiamMove should have moveDirection and landingOrientation matching when a piece goes out of the board: "+i.toString())}return $.success(i)}isRotation(){return this.direction.isAbsent()}equals(t){return this===t||!(!this.coord.equals(t.coord)||!1===this.direction.equals(t.direction))&&this.landingOrientation===t.landingOrientation}toString(){const t=this.direction.isAbsent()?"-":this.direction.get().toString();return"SiamMove("+this.coord.x+", "+this.coord.y+", "+t+", "+this.landingOrientation+")"}isInsertion(){return-1===this.coord.x||5===this.coord.x||-1===this.coord.y||5===this.coord.y}}da.encoder=Cn.tuple([Cn.numberEncoder(6),Cn.numberEncoder(6),P.getNumberEncoder(new Ice),new Ice],n=>[n.x+1,n.y+1,n.direction,n.landingOrientation],n=>da.of(n[0]-1,n[1]-1,n[2],n[3]).get());class pt{constructor(t){this.value=t}static decode(t){switch(t){case 0:return pt.EMPTY;case 1:return pt.LIGHT_UP;case 2:return pt.LIGHT_RIGHT;case 3:return pt.LIGHT_DOWN;case 4:return pt.LIGHT_LEFT;case 5:return pt.DARK_UP;case 6:return pt.DARK_RIGHT;case 7:return pt.DARK_DOWN;case 8:return pt.DARK_LEFT;case 9:return pt.MOUNTAIN}}belongTo(t){return t===z.ZERO?1<=this.value&&this.value<=4:5<=this.value&&this.value<=8}isEmptyOrMountain(){return 0===this.value||9===this.value}isPiece(){return!this.isEmptyOrMountain()}getOwner(){return 1<=this.value&&this.value<=4?z.ZERO:5<=this.value&&this.value<=8?z.ONE:pe.NONE}getOptionalDirection(){switch(this.value){case 0:return P.empty();case 1:case 5:return P.of(He.UP);case 2:case 6:return P.of(He.RIGHT);case 3:case 7:return P.of(He.DOWN);case 4:case 8:return P.of(He.LEFT);default:return we.expectToBe(this.value,9),P.empty()}}static of(t,e){return e===z.ZERO?t===He.UP?pt.LIGHT_UP:t===He.RIGHT?pt.LIGHT_RIGHT:t===He.DOWN?pt.LIGHT_DOWN:pt.LIGHT_LEFT:t===He.UP?pt.DARK_UP:t===He.RIGHT?pt.DARK_RIGHT:t===He.DOWN?pt.DARK_DOWN:pt.DARK_LEFT}getDirection(){return this.getOptionalDirection().get()}toString(){switch(this.value){case 0:return"EMPTY";case 1:return"LIGHT_UP";case 2:return"LIGHT_RIGHT";case 3:return"LIGHT_DOWN";case 4:return"LIGHT_LEFT";case 5:return"DARK_UP";case 6:return"DARK_RIGHT";case 7:return"DARK_DOWN";case 8:return"DARK_LEFT";default:return we.expectToBe(this.value,9),"MOUNTAIN"}}}pt.EMPTY=new pt(0),pt.LIGHT_UP=new pt(1),pt.LIGHT_RIGHT=new pt(2),pt.LIGHT_DOWN=new pt(3),pt.LIGHT_LEFT=new pt(4),pt.DARK_UP=new pt(5),pt.DARK_RIGHT=new pt(6),pt.DARK_DOWN=new pt(7),pt.DARK_LEFT=new pt(8),pt.MOUNTAIN=new pt(9);class z3 extends ps{static getInitialState(){const t=Ke.createTable(5,5,pt.EMPTY);return t[2][1]=pt.MOUNTAIN,t[2][2]=pt.MOUNTAIN,t[2][3]=pt.MOUNTAIN,new z3(t,0)}countCurrentPlayerPawn(){return this.countPlayersPawn()[this.getCurrentPlayer().value]}countPlayersPawn(){const t=[0,0];for(let e=0;e<5;e++)for(let r=0;r<5;r++)this.board[e][r]!==pt.EMPTY&&t[this.getPieceAtXY(r,e).getOwner().value]++;return t}}let x9=(()=>{class n{}return n.NO_REMAINING_PIECE_TO_INSERT=()=>$localize`You cannot insert a piece, all your pieces are already on the board.`,n.NOT_ENOUGH_FORCE_TO_PUSH=()=>$localize`You do not have enough strength to push.`,n.MUST_MOVE_OR_ROTATE=()=>$localize`You must move or rotate your piece.`,n.ILLEGAL_PUSH=()=>$localize`Your push is invalid: it is either not straight, is not pushing anything, or is leaving the board.`,n.MUST_SELECT_VALID_DESTINATION=()=>$localize`You must select a valid destination (highlighted on the board) for your piece`,n.MUST_SELECT_ORIENTATION=()=>$localize`You should select the orientation of your piece by clicking on one of the arrows.`,n})();class k3e{constructor(t,e){this.resultingBoard=t,this.moved=e}}class w1 extends Z1{constructor(){super(z3)}static get(){return w1.singleton.isAbsent()&&(w1.singleton=P.of(new w1)),w1.singleton.get()}isLegal(t,e){if(K(w1.VERBOSE,{SiamRules_isLegal:{move:t,state:e}}),!t.isInsertion()&&!e.getPieceAt(t.coord).belongTo(e.getCurrentPlayer()))return $.failure(rt.MUST_CHOOSE_PLAYER_PIECE());if(t.isRotation())return K(w1.VERBOSE,"Move is rotation"),this.isLegalRotation(t,e);{let r;if(t.isInsertion()){K(w1.VERBOSE,"Move is insertion");const s=this.isLegalInsertion(t.coord,e);if(s.legal.isFailure())return $.failure(s.legal.getReason());r=s.insertedPiece}else K(w1.VERBOSE,"Move is forward"),r=e.getPieceAt(t.coord);return this.isLegalForwarding(t,e,r)}}isLegalInsertion(t,e){const r=e.countCurrentPlayerPawn(),s=e.getCurrentPlayer(),i=r<5?U.SUCCESS:U.failure(x9.NO_REMAINING_PIECE_TO_INSERT());return{insertedPiece:this.getInsertedPiece(t,s),legal:i}}getInsertedPiece(t,e){return pt.of(-1===t.x?He.RIGHT:-1===t.y?He.DOWN:5===t.x?He.LEFT:He.UP,e)}isLegalForwarding(t,e,r){K(w1.VERBOSE,{isLegalForwarding:{move:t.toString(),state:e,firstPiece:r}}),ye(r!==pt.MOUNTAIN&&r!==pt.EMPTY,"forwarding must be done with player piece");const s=[];let i=pt.of(t.landingOrientation,e.getCurrentPlayer());const o=t.direction.get();let c=t.coord.getNext(o);if(c.isInRange(5,5)&&e.getPieceAt(c)!==pt.EMPTY&&!1===this.isStraight(r,t))return K(w1.VERBOSE,"Illegal push because not straight or not pushing anything or leaving the board"),$.failure(x9.ILLEGAL_PUSH());let u=P.of(o);const h=o.getOpposite();let p=0;const m=e.getCopiedBoard();t.coord.isInRange(5,5)&&(m[t.coord.y][t.coord.x]=pt.EMPTY,s.push(t.coord));let C=c.isInRange(5,5)&&i!==pt.EMPTY;for(;C;){u.equalsValue(o)?p++:u.equalsValue(h)&&p--,K(w1.VERBOSE,{totalForce:p,movingPiece:i,landingCoord:c});const w=m[c.y][c.x];w===pt.MOUNTAIN&&(p-=.9),m[c.y][c.x]=i,s.push(c),i=w,c=c.getNext(o),u=i.getOptionalDirection(),C=c.isInRange(5,5)&&i!==pt.EMPTY&&p>0}return c.isNotInRange(5,5)&&(K(w1.VERBOSE,"This movement would push "+i+" outside the board"),u.equalsValue(o)?p++:u.equalsValue(h)&&p--),p<=0?(K(w1.VERBOSE,"This move is an illegal push: "+m),$.failure(x9.NOT_ENOUGH_FORCE_TO_PUSH())):(K(w1.VERBOSE,"This move is a legal push: "+m),$.success(new k3e(m,s)))}isStraight(t,e){const r=t.getDirection();return e.direction.equalsValue(r)&&r===e.landingOrientation}isLegalRotation(t,e){K(w1.VERBOSE,{isLegalRotation:{rotation:t,state:e}});const r=t.coord,s=e.getPieceAt(r),i=e.getCurrentPlayer();if(s.getDirection()===t.landingOrientation)return $.failure(x9.MUST_MOVE_OR_ROTATE());const o=e.getCopiedBoard();return o[r.y][r.x]=pt.of(t.landingOrientation,i),$.success(new k3e(o,[r]))}applyLegalMove(t,e,r){const s=Ke.copyBiArray(r.resultingBoard);return new z3(s,e.turn+1)}getBoardValueInfo(t,e){const r=this.getMountainsRowsAndColumns(e),s=r.rows,i=r.columns,o=this.getWinner(e,t,r.nbMountain);if(o.isPlayer())return o===z.ZERO?{shortestZero:0,shortestOne:Number.POSITIVE_INFINITY,boardValue:Number.MIN_SAFE_INTEGER}:{shortestZero:Number.POSITIVE_INFINITY,shortestOne:0,boardValue:Number.MAX_SAFE_INTEGER};{const c=this.getPushers(e,i,s);let u=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER;const p=e.getCurrentPlayer();for(const C of c)C.coord.isInRange(5,5)?e.getPieceAt(C.coord).belongTo(z.ZERO)?u=Math.min(u,C.distance):h=Math.min(h,C.distance):p===z.ZERO?u=Math.min(u,C.distance):h=Math.min(h,C.distance);return{shortestZero:u,shortestOne:h,boardValue:this.getScoreFromShortestDistances(u,h,p)}}}getScoreFromShortestDistances(t,e,r){t===Number.MAX_SAFE_INTEGER&&(t=6),e===Number.MAX_SAFE_INTEGER&&(e=6);const s=6-t,i=6-e;return s===i?r.getScoreModifier():s>i?-10*(s+1)+(i+1):10*(i+1)-(s+1)}getMountainsRowsAndColumns(t){const e=[],r=[];let s=0;for(let i=0;i<5;i++)for(let o=0;o<5;o++)t.getPieceAtXY(o,i)===pt.MOUNTAIN&&(e.includes(i)||e.push(i),r.includes(o)||r.push(o),s++);return{rows:e,columns:r,nbMountain:s}}getWinner(t,e,r){return 2===r?this.getPusher(t,e.get()):pe.NONE}getPusher(t,e){const r=e.coord;let s;s=r.isInRange(5,5)?t.getPieceAt(r.getNext(e.landingOrientation)):this.getInsertedPiece(r,t.getCurrentOpponent());const i=s.getDirection(),o=this.getPusherCoord(t,i,r),c=t.getPieceAt(o).getOwner();return K(w1.VERBOSE,r.toString()+" belong to "+t.getCurrentOpponent().value+", "+o.toString()+" belong to "+c.value+", "+c.value+" win"),c}getPusherCoord(t,e,r){let s=r.getNext(e),i=r;for(;s.isInRange(5,5);){r=s,s=s.getNext(e);const o=t.getPieceAt(r);o!==pt.MOUNTAIN&&o.getDirection()===e&&(i=r)}return i}getPushers(t,e,r){K(w1.VERBOSE,{getPushers:{state:t,mountainsColumn:e,mountainsRow:r}});let s=[];const i=[];for(const o of e){let c=He.DOWN,u=new M(o,4);i.push({direction:c,fallingCoord:u}),c=He.UP,u=new M(o,0),i.push({direction:c,fallingCoord:u})}for(const o of r){let c=He.LEFT,u=new M(0,o);i.push({direction:c,fallingCoord:u}),c=He.RIGHT,u=new M(4,o),i.push({direction:c,fallingCoord:u})}for(const o of i)s=this.addPotentialDirectionPusher(t,o.fallingCoord,o.direction,s);return s}addPotentialDirectionPusher(t,e,r,s){const i=this.getLineClosestPusher(t,e,r);if(i.isAbsent())return s;const o=i.get(),c=o.distance;return K(w1.VERBOSE,"new closest challenger"),s.push({coord:o.coord,distance:c}),s}getLineClosestPusher(t,e,r){K(w1.VERBOSE,{getDirectionClosestPusher:{state:t,fallingCoord:e,direction:r.toString()}});const s=r.getOpposite();let i=1,o=t.getPieceAt(e),c=e,u=P.empty(),h=!1,p=!1,m=0;for(;c.isInRange(5,5)&&!1===h;){const C=t.getPieceAt(c);if(C.isEmptyOrMountain())C===pt.MOUNTAIN?(m+=.9,p=!0):i++;else{const w=C.getDirection();w===r?p&&(m-=1,m<=0&&(h=!0,c=c.getNext(r))):w===s?(m+=1,p||i++):p?(u=P.of(c),o!==pt.EMPTY&&i++):i++}o=C,c=c.getPrevious(r)}if(!1===h&&u.isPresent())for(i++,m-=1;!1===c.equals(u.get());)c=c.getNext(r),i--;return c.isNotInRange(5,5)&&(m-=1,5===t.countCurrentPlayerPawn())||m>0?P.empty():P.of({distance:i,coord:c})}getInsertions(t){let e=[];for(let r=1;r<4;r++)e=e.concat(this.getInsertionsAt(t,0,r)),e=e.concat(this.getInsertionsAt(t,4,r)),e=e.concat(this.getInsertionsAt(t,r,0)),e=e.concat(this.getInsertionsAt(t,r,4));return e=e.concat(this.getInsertionsAt(t,0,0)),e=e.concat(this.getInsertionsAt(t,0,4)),e=e.concat(this.getInsertionsAt(t,4,0)),e=e.concat(this.getInsertionsAt(t,4,4)),e}getInsertionsAt(t,e,r){const s=[];for(const i of He.ORTHOGONALS){const o=new M(e,r).getPrevious(i);if(o.isNotInRange(5,5))for(const c of He.ORTHOGONALS){const u=da.of(o.x,o.y,P.of(i),c);ye(u.isSuccess(),"SiamRules.getInsertionsAt should only construct valid insertions"),this.isLegal(u.get(),t).isSuccess()&&s.push(u.get())}}return s}getMovesFrom(t,e,r,s){const i=new M(r,s);let o=this.getRotationMovesAt(i,e);for(const c of He.ORTHOGONALS){const u=i.getNext(c);o=o.concat(this.getForwardMovesBetween(t,i,u))}return o}getMovesBetween(t,e,r,s){return r.equals(s)?this.getRotationMovesAt(r,e):He.factory.fromMove(r,s).isSuccess()&&1===r.getDistance(s)?this.getForwardMovesBetween(t,r,s):[]}getRotationMovesAt(t,e){const r=[],s=e.getDirection();for(const i of He.ORTHOGONALS)if(i!==s){const o=da.of(t.x,t.y,P.empty(),i).get();r.push(o)}return r}getForwardMovesBetween(t,e,r){const s=[];let i;const o=He.factory.fromMove(e,r).get(),c=t.getPieceAt(e);i=r.isInRange(5,5)?He.ORTHOGONALS:[o];for(const u of i){const h=da.of(e.x,e.y,P.of(o),u).get();this.isLegalForwarding(h,t,c).isSuccess()&&s.push(h)}return s}getGameStatus(t){const e=this.getMountainsRowsAndColumns(t.gameState),r=this.getWinner(t.gameState,t.move,e.nbMountain);return r.isPlayer()?xe.getVictory(r):xe.ONGOING}}w1.singleton=P.empty(),w1.VERBOSE=!1;class Iut extends $1{getBoardValue(t){return new Ct(w1.get().getBoardValueInfo(t.move,t.gameState).boardValue)}getListMoves(t){let e=[];const r=t.gameState.getCurrentPlayer();for(let s=0;s<5;s++)for(let i=0;i<5;i++){const o=t.gameState.getPieceAtXY(i,s);o.belongTo(r)&&(e=e.concat(w1.get().getMovesFrom(t.gameState,o,i,s)))}if(t.gameState.countCurrentPlayerPawn()<5)for(const s of w1.get().getInsertions(t.gameState))if(s.direction.get().getOpposite()!==s.landingOrientation){if(this.isOnBorder(s)&&s.direction.get()!==s.landingOrientation)continue;e.push(s)}return K(w1.VERBOSE,{getListMovesResult:e}),e}isOnBorder(t){return 0===t.coord.x||4===t.coord.x||0===t.coord.y||4===t.coord.y}}const qe=pt.EMPTY,Xa=pt.MOUNTAIN,RH=pt.LIGHT_UP,DH=pt.LIGHT_LEFT,k9=pt.LIGHT_RIGHT,xut=pt.LIGHT_DOWN,kut=pt.DARK_UP,L3e=pt.DARK_LEFT,R3e=pt.DARK_RIGHT,Lut=pt.DARK_DOWN;class D3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal at Siam is to be the first to push a mountain out of the board.
        The initial board contains three mountains, and no pieces are initially on the board.
        During its turn, a player can do one of the following actions:
        <ol>
            <li>Put a new piece on the board.</li>
            <li>Change the orientation of one of its piece</li>
            <li>Move one of its piece and optionally reorient it.</li>
            <li>Take one of its pieces out of the board.</li>
        </ol>`,z3.getInitialState()),ce.anyMove($localize`Inserting a piece`,$localize`Each player has 5 pieces in total.
        As long as you have remaining pieces next to the board, you can insert new pieces. To do so:
        <ol>
            <li>Click on one of your pieces from your reserve, next to board.</li>
            <li>Click on one of the highlighted squares to select a landing for your piece.</li>
            <li>Select an orientation for your piece by clicking on one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark, insert a piece on the board.`,z3.getInitialState(),da.of(2,-1,P.of(He.DOWN),He.DOWN).get(),$localize`Congratulations!`),ce.fromMove($localize`Moving a piece`,$localize`We will distinguish here "moving" and "pushing".
        A move is made from a piece's square to an empty neighboring square, horizontally or vertically.
        You can also move a piece out of the board.
        To move a piece:
        <ol>
            <li>Click on it.</li>
            <li>Click on the square on which you want the piece to move.
                You can also click a second time on your piece to change its orientation without moving it.</li>
            <li>Select the orientation of your piece by clicking one one of the arrows that appear on top of the board.</li>
        </ol><br/>
        You're playing Dark. Try to move your piece that is already on the board one square upwards and to orient it to the left.`,new z3([[qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe],[qe,Xa,Xa,Xa,qe],[qe,qe,qe,qe,qe],[qe,qe,RH,qe,qe]],0),[da.of(2,4,P.of(He.UP),He.LEFT).get()],$localize`Congratulations, you made a side-slip!`,$localize`Failed. Try again.`),ce.fromMove($localize`Moving a piece out of the board`,$localize`To move a piece out of the board, you do not have to pick an orientation after the move.<br/><br/>
        You're playing Dark, get that piece out of the board!`,new z3([[qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe],[qe,Xa,Xa,Xa,qe],[qe,qe,qe,qe,qe],[qe,qe,RH,qe,qe]],0),[da.of(2,4,P.of(He.DOWN),He.DOWN).get()],$localize`Congratulations, even if in this context it was not a useful move.`,$localize`Failed, the piece is still on the board.`),ce.fromMove($localize`Pushing (1/2)`,$localize`When the landing square of your move is occupied, we use the term "push".
        In order to push player pieces, the following conditions must hold:
        <ol>
            <li>Your piece must already be oriented in the direction of the push.</li>
            <li>Along the line that you are pushing, the number of pieces (yours or your opponent's) that are oriented in the same way as the push should be strictly greater than the number of pieces oriented in the opposite way.</li>
        </ol>
        Look closely at the board. On the first row, you cannot push as there is exactly one piece in the opposite direction.
        On the second row, you can push because there are two pieces against one.<br/><br/>
        You're playing Dark. Vertically, you can push using your piece in the center, as there is no resistance on that axis. Do it.`,new z3([[qe,k9,L3e,qe,qe],[k9,R3e,DH,qe,qe],[qe,qe,RH,qe,qe],[qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe]],0),[da.of(2,2,P.of(He.UP),He.UP).get()],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Pushing (2/2)`,$localize`To be able to push a mountain, you need at least one pusher per mountain. Each resistant (pieces in the opposite way) cancel the force of one pusher.
        In short, if there is no mountain, you need strictly more pushers than resistants. If there is a mountain, you need at least as much pushers than there are resistants and mountains.
        On the following board, as Dark, you can push the mountain on the first row.
        On the second and third row, because of the resisting forces, you cannot push.
        On the fourth row, you can push as there is one more pusher than resistant pieces.<br/><br/>
        You're playing Dark, push on the fourth row it.`,new z3([[qe,qe,k9,Xa,qe],[qe,qe,k9,Xa,DH],[qe,k9,Xa,Xa,qe],[qe,k9,R3e,L3e,Xa],[qe,qe,qe,qe,qe]],0),[da.of(1,3,P.of(He.RIGHT),He.RIGHT).get()],$localize`Congratulations! Note that this move made you lose the game, you will see why in the next step.`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory`,$localize`The game ends when a mountain is pushed out of the board.
        If you pushed it and nobody is in front of you, you're the winner.
        However, if you were pushing an opponent oriented in the same direction as you, your opponent will win because that piece is closer to the mountain.
        However, if that opponent is closer to the mountain but not oriented towards it, victory will be yours.<br/><br/>
        Here, playing Dark, you can push a mountain off the board and either win, or lose. Choose correctly!`,new z3([[qe,qe,qe,qe,qe],[qe,qe,qe,qe,qe],[Xa,kut,DH,qe,xut],[qe,qe,qe,qe,Lut],[qe,qe,qe,qe,Xa]],0),[da.of(2,2,P.of(He.LEFT),He.LEFT).get()],$localize`Congratulations, you won!`,$localize`Failed, you lost.`)]}}function Rut(n,t){if(1&n){const e=Oe();B(),b(0,"use",11),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().clickSquare(s,i))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","piece_",r,"_",i,""),T("ngClass",o.getPieceClasses(r,i,s)),D("transform",o.getPieceTransform(r,i))}}function Dut(n,t){if(1&n){const e=Oe();B(),b(0,"use",12),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v().clickSquare(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v();D("transform","translate("+(e+1)*s.SPACE_SIZE+" "+(r+1)*s.SPACE_SIZE+")")}}function zut(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",8),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().clickSquare(i,o))}),O(),x(2,Rut,1,4,"use",9),x(3,Dut,1,1,"use",10),O()}if(2&n){const e=t.$implicit,r=t.index,s=v().index,i=v();S(1),We("id","square_",r,"_",s,""),T("ngClass",i.getSquareClasses(r,s)),D("x",i.SPACE_SIZE*(r+1))("y",i.SPACE_SIZE*(s+1))("width",i.SPACE_SIZE)("height",i.SPACE_SIZE),S(1),T("ngIf",e.isPiece()),S(1),T("ngIf",i.isMountain(e))}}function Vut(n,t){if(1&n&&(B(),b(0,"g"),x(1,zut,4,9,"g",4),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function Hut(n,t){if(1&n){const e=Oe();B(),b(0,"rect",15),J("click",function(){fe(e);const s=v().$implicit;return ae(v().clickSquare(s.x,s.y))}),O()}if(2&n){const e=v().$implicit,r=v();We("id","square_",e.x,"_",e.y,""),T("ngClass",r.getSquareClasses(e.x,e.y)),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function Fut(n,t){if(1&n){const e=Oe();B(),b(0,"g"),x(1,Hut,1,7,"rect",13),b(2,"rect",14),J("click",function(){const i=fe(e).$implicit;return ae(v().clickSquare(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),T("ngIf",!1===e.isInRange(5,5)),S(1),D("x",r.SPACE_SIZE*(e.x+1))("y",r.SPACE_SIZE*(e.y+1))("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}function But(n,t){if(1&n){const e=Oe();B(),b(0,"rect",16),J("click",function(){fe(e);const s=v();return ae(s.clickSquare(s.selectedLanding.get().x,s.selectedLanding.get().y))}),O()}if(2&n){const e=v();D("x",e.SPACE_SIZE*(e.selectedLanding.get().x+1))("y",e.SPACE_SIZE*(e.selectedLanding.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function $ut(n,t){if(1&n){const e=Oe();B(),b(0,"rect",16),J("click",function(){fe(e);const s=v();return ae(s.clickSquare(s.selectedPiece.get().x,s.selectedPiece.get().y))}),O()}if(2&n){const e=v();D("x",e.SPACE_SIZE*(e.selectedPiece.get().x+1))("y",e.SPACE_SIZE*(e.selectedPiece.get().y+1))("width",e.SPACE_SIZE)("height",e.SPACE_SIZE)}}function Uut(n,t){if(1&n&&(B(),X(0,"use",19)),2&n){const e=t.$implicit,r=v().$implicit,s=v();We("id","remainingPieces_",r.value,"_",e,""),T("ngClass",s.getRemainingPieceClasses(r,e)),D("transform",s.getRemainingPieceTransform(e,r))}}function Gut(n,t){if(1&n){const e=Oe();B(),b(0,"g",17),J("click",function(){const i=fe(e).$implicit;return ae(v().selectPieceForInsertion(i))}),x(1,Uut,1,4,"use",18),O()}if(2&n){const e=t.$implicit,r=v();C1("id","remainingPieces_",e.value,""),S(1),T("ngForOf",r.ArrayUtils.range(r.playerPieces(e)))}}function Wut(n,t){if(1&n){const e=Oe();B(),b(0,"use",22),J("click",function(){fe(e);const s=v().$implicit;return ae(v().clickSquare(s.source.get().coord.x,s.source.get().coord.y))}),O()}if(2&n){const e=v().$implicit,r=v();T("ngClass",r.getPieceClasses(e.source.get().coord.x,e.source.get().coord.y,e.source.get().piece)),D("transform",r.getPieceTransform(e.source.get().coord.x,e.source.get().coord.y))}}function qut(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"use",20),J("click",function(){const i=fe(e).$implicit;return ae(v().clickArrow(i))}),O(),x(2,Wut,1,2,"use",21),O()}if(2&n){const e=t.$implicit,r=v();S(1),G2("id","indicator_",e.target.x,"_",e.target.y,"_",e.direction.toString(),""),D("transform",r.getIndicatorTransform(e)),S(1),T("ngIf",e.source.isPresent())}}function jut(n,t){if(1&n){const e=Oe();B(),b(0,"use",23),J("click",function(){const i=fe(e).$implicit;return ae(v().selectOrientation(i))}),O()}if(2&n){const e=t.$implicit,r=v();C1("id","orientation_",e.landingOrientation,""),T("ngClass",r.getCurrentPlayerClass()),D("transform",r.getOrientationTransform(e.landingOrientation))}}let Zut=(()=>{class n extends No{constructor(e){super(e),this.lastMove=P.empty(),this.movedPieces=[],this.selectedPiece=P.empty(),this.selectedLanding=P.empty(),this.orientations=[],this.clickableCoords=new Ht,this.indicatorArrows=[],this.insertingPiece=!1,this.rules=w1.get(),this.availableMinimaxes=[new Iut(this.rules,"SiamMinimax")],this.encoder=da.encoder,this.tutorial=(new D3e).tutorial,this.updateBoard()}updateBoard(){K(n.VERBOSE,"updateBoard");const e=this.getState();if(this.board=e.board,this.lastMove=this.rules.node.move,this.lastMove.isPresent()){const r=this.rules.node.mother.get().gameState;this.movedPieces=this.rules.isLegal(this.lastMove.get(),r).get().moved}else this.movedPieces=[]}cancelMoveAttempt(){this.insertingPiece=!1,this.selectedPiece=P.empty(),this.selectedLanding=P.empty(),this.orientations=[],this.clickableCoords=new Ht,this.indicatorArrows=[]}selectPieceForInsertion(e){var r=this;return A(function*(){const s=r.canUserPlay("#remainingPieces_"+e.value);if(s.isFailure())return r.cancelMove(s.getReason());if(e!==r.getCurrentPlayer())return r.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE());if(r.insertingPiece)return r.cancelMoveAttempt(),U.SUCCESS;r.cancelMoveAttempt();for(const i of w1.get().getInsertions(r.getState())){const o=i.coord.getNext(i.direction.get());if(r.board[o.y][o.x]!==pt.EMPTY){const c={source:P.empty(),target:o,direction:i.direction.get(),move:i};r.indicatorArrows.push(c)}r.clickableCoords.add(o)}return r.insertingPiece=!0,U.SUCCESS})()}selectOrientation(e){var r=this;return A(function*(){const s=r.canUserPlay("#orientation_"+e.landingOrientation.toString());return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e,r.getState())})()}clickSquare(e,r,s=!1){var i=this;return A(function*(){if(K(n.VERBOSE,"SiamComponent.clickSquare("+e+", "+r+")"),!1===s){const c=i.canUserPlay("#square_"+e+"_"+r);if(c.isFailure())return i.cancelMove(c.getReason())}const o=new M(e,r);if(i.insertingPiece)return i.insertPiece(o);if(i.selectedLanding.isPresent())return i.cancelMoveAttempt(),U.SUCCESS;if(i.selectedPiece.isPresent()){i.selectedLanding=P.of(o);const c=w1.get().getMovesBetween(i.getState(),i.getState().getPieceAt(i.selectedPiece.get()),i.selectedPiece.get(),o);return 0===c.length?i.changeMoveDestinationClick(o):i.performMoveOrShowOrientationArrows(c)}{ye(i.getState().isOnBoard(o),"SiamComponent: user clicked outside of board when it should not be possible");const c=i.board[r][e];return c.getOwner()!==i.getCurrentPlayer()?i.cancelMove(rt.MUST_CHOOSE_PLAYER_PIECE()):i.selectPiece(o,c)}})()}insertPiece(e){var r=this;return A(function*(){if(r.selectedLanding.isPresent())return r.cancelMove(x9.MUST_SELECT_ORIENTATION()),U.SUCCESS;r.selectedLanding=P.of(e);const s=w1.get().getInsertionsAt(r.getState(),e.x,e.y);return 0===s.length?r.changeMoveDestinationClick(e):r.performMoveOrShowOrientationArrows(s)})()}changeMoveDestinationClick(e){var r=this;return A(function*(){return r.cancelMoveAttempt(),r.getState().getPieceAt(e).getOwner()===r.getCurrentPlayer()?r.clickSquare(e.x,e.y,!0):r.cancelMove(x9.MUST_SELECT_VALID_DESTINATION())})()}performMoveOrShowOrientationArrows(e){var r=this;return A(function*(){return ye(e.length>0,"SiamComponent.performMoveOrShowOrientationArrows expects at least one move"),1===e.length?(r.cancelMove(),r.chooseMove(e[0],r.getState())):(r.clickableCoords=new Ht,r.indicatorArrows=[],r.orientations=e,U.SUCCESS)})()}selectPiece(e,r){this.cancelMoveAttempt();const s=this.getState();this.selectedPiece=P.of(e);const i=w1.get().getMovesFrom(s,r,e.x,e.y);for(const o of i)if(o.direction.isPresent()){const c=o.coord.getNext(o.direction.get());if(this.clickableCoords.add(c),s.isOnBoard(c)&&s.getPieceAt(c)!==pt.EMPTY){const u={source:P.of({coord:e,piece:r}),target:c,direction:o.direction.get(),move:o};this.indicatorArrows.push(u)}}else this.clickableCoords.add(o.coord);return U.SUCCESS}clickArrow(e){var r=this;return A(function*(){const s=r.canUserPlay("#indicator_"+e.target.x+"_"+e.target.y+"_"+e.move.landingOrientation);return s.isFailure()?r.cancelMove(s.getReason()):r.chooseMove(e.move,r.getState())})()}isMountain(e){return e===pt.MOUNTAIN}getArrowTransform(e,r,s){const o=`rotate(${90*(s.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return["translate("+e*this.SPACE_SIZE+", "+r*this.SPACE_SIZE+")",o].join(" ")}getPieceTransform(e,r){return this.getArrowTransform(e+1,r+1,this.board[r][e].getDirection())}getIndicatorTransform(e){const r=e.target.getPrevious(e.direction,.5);return this.getArrowTransform(r.x+1,r.y+1,e.direction)}getRemainingPieceTransform(e,r){const s=this.playerPieces(r);let u,h,c=2;return r===z.ONE?(c+=(s-e+(5-s)/2)/3,u=-1,h=He.RIGHT):(c+=(e+1+(5-s)/2)/3,u=7,h=He.LEFT),this.getArrowTransform(c,u,h)}getOrientationTransform(e){const r=`translate(0, ${this.SPACE_SIZE/1.6})`,i=`rotate(${90*(e.toInt()-2)} ${this.SPACE_SIZE/2} ${this.SPACE_SIZE/2})`;return[`translate(${2.27*this.SPACE_SIZE}, ${2.27*this.SPACE_SIZE})`,"scale(2.43)",i,r].join(" ")}getPieceClasses(e,r,s){const i=new M(e,r),o=[this.getPlayerClass(s.getOwner())];return this.selectedPiece.equalsValue(i)&&o.push("selected-stroke"),o}getSquareClasses(e,r){const s=new M(e,r);return this.movedPieces.some(i=>i.equals(s))?["moved-fill"]:[]}getRemainingPieceClasses(e,r){const s=[this.getPlayerClass(e)];return this.insertingPiece&&this.getCurrentPlayer()===e&&r===this.playerPieces(e)-1&&s.push("selected-stroke"),s}getCurrentPlayerClass(){return this.getPlayerClass(this.getCurrentPlayer())}playerPieces(e){return 5-this.getState().countPlayersPawn()[e.value]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-siam"]],features:[l],decls:12,vars:7,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 -100 700 900","preserveAspectRatio","xMidYMid meet"],["id","triangle","points","0 -6, 10 0, 0 6"],["id","arrow","points","30 7, 30 50, 10 50, 50 90, 90 50, 70 50, 70 7"],["id","mountain","points","5 95, 16 68, 24 76, 48 28, 64 60, 72 44, 95 95, 5 95"],[4,"ngFor","ngForOf"],["class","base no-fill small-stroke selected-stroke",3,"click",4,"ngIf"],[3,"id","click",4,"ngFor","ngForOf"],["class","base mid-stroke semi-transparent",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngFor","ngForOf"],[1,"base",3,"id","ngClass","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass","click",4,"ngIf"],[0,"xlink","href","#mountain","class","nonplayer-fill",3,"click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass","click"],[0,"xlink","href","#mountain",1,"nonplayer-fill",3,"click"],["class","base semi-transparent",3,"id","ngClass","click",4,"ngIf"],[1,"base","no-fill","small-stroke","clickable-stroke",3,"click"],[1,"base","semi-transparent",3,"id","ngClass","click"],[1,"base","no-fill","small-stroke","selected-stroke",3,"click"],[3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"id","ngClass",4,"ngFor","ngForOf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"id","ngClass"],[0,"xlink","href","#arrow",1,"base","mid-stroke","indicator-fill",3,"id","click"],["class","base mid-stroke",0,"xlink","href","#arrow",3,"ngClass","click",4,"ngIf"],[0,"xlink","href","#arrow",1,"base","mid-stroke",3,"ngClass","click"],[0,"xlink","href","#arrow",1,"base","mid-stroke","semi-transparent",3,"id","ngClass","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0)(1,"defs"),X(2,"polygon",1)(3,"polygon",2)(4,"polygon",3),O(),x(5,Vut,2,1,"g",4),x(6,Fut,3,5,"g",4),x(7,But,1,4,"rect",5),x(8,$ut,1,4,"rect",5),x(9,Gut,2,2,"g",6),x(10,qut,3,5,"g",4),x(11,jut,1,3,"use",7),O()),2&e&&(S(5),T("ngForOf",r.board),S(1),T("ngForOf",r.clickableCoords),S(1),T("ngIf",r.selectedLanding.isPresent()),S(1),T("ngIf",r.selectedPiece.isPresent()),S(1),T("ngForOf",r.Player.PLAYERS),S(1),T("ngForOf",r.indicatorArrows),S(1),T("ngForOf",r.orientations))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})(),V3=(()=>{class n{}return n.NO_MOVEMENT_BEFORE_TURN_40=()=>$localize`You cannot move yet. Pick a space where you will put a new piece.`,n.MUST_CUT=()=>$localize`Several groups are of the same size, you must pick the one to keep.`,n.CANNOT_CHOOSE_TO_KEEP=()=>$localize`You cannot choose which part to keep when one is smaller than the other.`,n.CAN_NO_LONGER_DROP=()=>$localize`You cannot put new pieces anymore. Pick a piece to move.`,n.MUST_CAPTURE_BIGGEST_GROUPS=()=>$localize`You must choose one of the biggest groups to keep it.`,n.CANNOT_KEEP_EMPTY_COORD=()=>$localize`You cannot pick an empty space. Pick one of the biggest groups.`,n.MUST_DROP_NEXT_TO_OTHER_PIECE=()=>$localize`You must put this piece next to another piece.`,n})();class Wi extends n3e{static getInitialState(){return Wi.fromRepresentation([[z.ZERO.value],[z.ONE.value]],0)}static fromRepresentation(t,e,r){const s=new o9;for(let i=0;i<t.length;i++)for(let o=0;o<t[0].length;o++)t[i][o]!==pe.NONE.value&&s.set(new M(o,i),z.of(t[i][o]));return new Wi(s,e,r)}movePiece(t){const e=this.pieces.getCopy();return e.delete(t.start.get()),e.set(t.landing,this.getCurrentPlayer()),new Wi(e,this.turn)}toRepresentation(){const t=Ke.createTable(this.width,this.height,pe.NONE.value);for(const e of this.pieces.listKeys()){const r=this.getPieceAt(e).value;t[e.y][e.x]=r}return t}isIllegalLandingZone(t,e){return this.pieces.containsKey(t)?U.failure(rt.MUST_LAND_ON_EMPTY_SPACE()):this.isCoordConnected(t,e)?U.SUCCESS:U.failure(V3.MUST_DROP_NEXT_TO_OTHER_PIECE())}isCoordConnected(t,e){for(const r of ke.factory.all){const s=t.getNext(r,1);if(this.pieces.containsKey(s)&&!1===e.equalsValue(s))return!0}return!1}getPieceAt(t){return this.isOnBoard(t)?this.pieces.get(t).get():pe.NONE}applyLegalDrop(t){const e=this.pieces.getCopy();return e.put(t,this.getCurrentPlayer()),new Wi(e,this.turn+1)}applyLegalDeplacement(t,e){const r=this.movePiece(t);if(e.size()>0){const s=new o9;for(const i of e)s.set(i,r.getPieceAt(i));return new Wi(s,this.turn+1)}return new Wi(r.pieces,this.turn+1,r.offset)}countPieces(){const t=this.pieces.reverse(),e=t.get(z.ZERO).getOrElse(new vr),r=t.get(z.ONE).getOrElse(new vr);return[e.size(),r.size()]}switchPiece(t){const e=this.pieces.getCopy(),r=this.getPieceAt(t);if(r.isPlayer())return e.replace(t,r.getOpponent()),new Wi(e,this.turn,this.offset);bs.logErrorAndFail("SixState","Cannot switch piece if there is no piece!",{coord:t.toString()})}equals(t){return this.turn===t.turn&&this.pieces.equals(t.pieces)}}class Gr extends $i{constructor(t,e,r){if(super(),this.start=t,this.landing=e,this.keep=r,t.equalsValue(e))throw new Error("Deplacement cannot be static!");if(t.isPresent()&&t.equals(r))throw new Error("Cannot keep starting coord, since it will always be empty after move!")}static fromDrop(t){return new Gr(P.empty(),t,P.empty())}static fromMovement(t,e){return new Gr(P.of(t),e,P.empty())}static fromCut(t,e,r){return new Gr(P.of(t),e,P.of(r))}isDrop(){return this.start.isAbsent()}isCut(){return this.keep.isPresent()}toString(){return this.isDrop()?"SixMove("+this.landing.toString()+")":this.isCut()?"SixMove("+this.start.get().toString()+" > "+this.landing+", keep: "+this.keep.get().toString()+")":"SixMove("+this.start.get().toString()+" > "+this.landing+")"}equals(t){return!1!==this.landing.equals(t.landing)&&!1!==this.start.equals(t.start)&&this.keep.equals(t.keep)}}Gr.encoder=new class extends M2{encodeMove(n){return{start:n.start.isPresent()?M.encoder.encode(n.start.get()):null,landing:M.encoder.encode(n.landing),keep:n.keep.isPresent()?M.encoder.encode(n.keep.get()):null}}decodeMove(n){const t=n;if("object"!=typeof n)throw new Error("Invalid encodedMove of type "+typeof n+"!");const e=M.encoder.decode(t.landing);if(null==t.start)return Gr.fromDrop(e);const r=M.encoder.decode(t.start);if(null==t.keep)return Gr.fromMovement(r,e);{const s=M.encoder.decode(t.keep);return Gr.fromCut(r,e,s)}}};class H3 extends Z1{constructor(){super(...arguments),this.VERBOSE=!1}applyLegalMove(t,e,r){return e.turn<40?e.applyLegalDrop(t.landing):e.applyLegalDeplacement(t,r)}isLegal(t,e){K(this.VERBOSE,{called:"SixRules.isLegal",move:t,state:e});const r=e.isIllegalLandingZone(t.landing,t.start);return r.isFailure()?r.toFailedFallible():e.turn<40?this.isLegalDrop(t,e):H3.isLegalPhaseTwoMove(t,e)}static getLegalLandings(t){const e=new vr;for(const r of t.getPieceCoords())for(const s of ke.factory.all){const i=r.getNext(s,1);t.getPieceAt(i)===pe.NONE&&e.add(i)}return e.toList()}isLegalDrop(t,e){return!1===t.isDrop()?$.failure(V3.NO_MOVEMENT_BEFORE_TURN_40()):$.success(new Ht(e.getPieceCoords()))}static isLegalPhaseTwoMove(t,e){if(t.isDrop())return $.failure(V3.CAN_NO_LONGER_DROP());switch(e.getPieceAt(t.start.get())){case pe.NONE:return $.failure(rt.MUST_CHOOSE_OWN_PIECE_NOT_EMPTY());case e.getCurrentOpponent():return $.failure(rt.CANNOT_CHOOSE_OPPONENT_PIECE())}const r=e.movePiece(t),s=r.getGroups();if(H3.isSplit(s)){const i=this.getBiggerGroups(s);if(1===i.size())return t.keep.isPresent()?$.failure(V3.CANNOT_CHOOSE_TO_KEEP()):$.success(i.getAnyElement().get());{const o=t.keep.map(c=>c.getNext(r.offset));return this.moveKeepBiggerGroup(o,i,r)}}return $.success(new vr)}static isSplit(t){return t.size()>1}static getBiggerGroups(t){let e=0,r=new Ht;for(const s of t){const i=s.size();i>e?(e=i,r=new Ht([s])):i===e&&r.add(s)}return r}static moveKeepBiggerGroup(t,e,r){if(t.isAbsent())return $.failure(V3.MUST_CUT());if(r.getPieces().get(t.get()).isAbsent())return $.failure(V3.CANNOT_KEEP_EMPTY_COORD());const s=t.get();for(const i of e)if(i.contains(s))return $.success(i);return $.failure(V3.MUST_CAPTURE_BIGGEST_GROUPS())}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=[];if(t.move.isPresent()&&(s=this.getShapeVictory(t.move.get(),e)),6===s.length)return xe.getVictory(r);if(e.turn>39){const i=e.countPieces(),o=i[0],c=i[1];return o<6&&c<6?o<c?xe.ONE_WON:c<o?xe.ZERO_WON:xe.DRAW:o<6?xe.getDefeat(z.ZERO):c<6?xe.getDefeat(z.ONE):xe.ONGOING}return xe.ONGOING}startSearchingVictorySources(){K(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}getShapeVictory(t,e){for(this.startSearchingVictorySources();this.hasNextVictorySource();){this.getNextVictorySource();const r=this.searchVictoryOnly(this.currentVictorySource,t,e);if(6===r.length)return r}return[]}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(K(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(ke.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];const h=(t+o.length)%6;o.push(c),c=c.getNext(ke.factory.all[h],1)}return o}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=ke.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return[];u=!0,i=i.getOpposite(),o=o.getNext(i,c.length)}o=o.getNext(i,1)}return c}searchVictoryOnlyForTriangleCorner(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ke.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.length%2==0&&(i=ke.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return o}searchVictoryOnlyForTriangleEdge(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ke.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return[];o.push(c),o.length%2==0&&(i=ke.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return o}}class Yut extends $1{calculateBoardValue(t,e){this.startSearchingVictorySources();let r={status:yn.DEFAULT,victory:P.empty(),preVictory:P.empty(),sum:0};for(;this.hasNextVictorySource();){const s=this.getNextVictorySource();let i;if(i=r.status===yn.PRE_VICTORY?this.searchVictoryOnly(s,t,e):this.getBoardInfo(s,t,e,r),i.status===yn.VICTORY)return i;r={status:i.status,victory:P.empty(),preVictory:i.preVictory,sum:r.sum+i.sum}}return r}}class h6 extends Ct{constructor(t,e){super(t),this.value=t,this.preVictory=e}}class a8 extends Yut{constructor(){super(...arguments),this.VERBOSE=!1}static get(){if(a8.singleton.isAbsent()){const t=new H3(Wi);a8.singleton=P.of(new a8(t,"SixMinimax"))}return a8.singleton.get()}getListMoves(t){const e=a8.get(),r=t.getOwnValue(e);if(r.preVictory.isPresent())return t.gameState.turn<40?this.createForcedDrop(r):this.createForcedDeplacement(t,r);const s=H3.getLegalLandings(t.gameState);return t.gameState.turn<40?this.getListDrop(s):this.getListDeplacement(t.gameState,s)}createForcedDrop(t){K(this.VERBOSE,{called:"SixMinimax.createForceDrop",unheritance:t});const e=[],r=Gr.fromDrop(t.preVictory.get());return e.push(r),e}createForcedDeplacement(t,e){K(this.VERBOSE,{called:"SixRules.createForcedDeplacement",node:t});const r=this.getSafelyMovablePieceOrFirstOne(t),s=[e.preVictory.get()];return this.getDeplacementFrom(t.gameState,r,s)}getDeplacementFrom(t,e,r){const s=[];for(const i of e)for(const o of r){const c=Gr.fromMovement(i,o);if(t.isCoordConnected(o,P.of(i))){const h=t.movePiece(c).getGroups();if(H3.isSplit(h))for(const p of h){const m=p.getAnyElement().get(),C=Gr.fromCut(i,o,m);s.push(C)}else s.push(c)}}return s}getSafelyMovablePieceOrFirstOne(t){const e=t.gameState,r=e.getPieces().reverse(),s=e.getCurrentPlayer(),i=r.get(s).get(),o=i.getAnyElement().get(),c=[];for(const u of i)!1===this.isPieceBlockingAVictory(e,u)&&c.push(u);return new vr(0===c.length?[o]:c)}isPieceBlockingAVictory(t,e){const r=t.switchPiece(e),s=Gr.fromDrop(e);for(this.startSearchingVictorySources();this.hasNextVictorySource();)if(this.currentVictorySource=this.getNextVictorySource(),this.searchVictoryOnly(this.currentVictorySource,s,r).status===yn.VICTORY)return!0;return!1}getListDrop(t){const e=[];for(const r of t){const s=Gr.fromDrop(r);e.push(s)}return e}getListDeplacement(t,e){const r=t.getCurrentPlayer(),s=t.getPieces().reverse().get(r).get();return this.getDeplacementFrom(t,s,e)}getBoardValue(t){const e=t.move,r=t.gameState,s=r.getCurrentOpponent(),i=s.getVictoryValue();let o={status:yn.DEFAULT,victory:P.empty(),preVictory:P.empty(),sum:0};e.isPresent()&&(o=this.calculateBoardValue(e.get(),r));let c=P.empty();if(o.status===yn.DEFAULT&&o.preVictory.isPresent()&&(c=P.of(o.preVictory.get())),o.status===yn.VICTORY)return new h6(i,P.empty());if(r.turn>39){const u=r.countPieces(),h=u[0],p=u[1];return h<6&&p<6?new h6(h<p?z.ONE.getVictoryValue():p<h?z.ZERO.getVictoryValue():0,P.empty()):h<6?new h6(z.ZERO.getDefeatValue(),P.empty()):p<6?new h6(z.ONE.getDefeatValue(),P.empty()):new h6(h-p,c)}return new h6(o.status===yn.PRE_VICTORY?s.getPreVictory():o.sum*s.getScoreModifier(),c)}startSearchingVictorySources(){K(this.VERBOSE,"SixRules.startSearchingVictorySources()"),this.currentVictorySource={typeSource:"LINE",index:-1}}hasNextVictorySource(){return"CIRCLE"!==this.currentVictorySource.typeSource||5!==this.currentVictorySource.index}getNextVictorySource(){if(5===this.currentVictorySource.index){let e;switch(this.currentVictorySource.typeSource){case"LINE":e="TRIANGLE_CORNER";break;case"TRIANGLE_CORNER":e="TRIANGLE_EDGE";break;default:e="CIRCLE"}this.currentVictorySource={typeSource:e,index:0}}else{let e=1;"LINE"===this.currentVictorySource.typeSource&&(e=2),this.currentVictorySource={typeSource:this.currentVictorySource.typeSource,index:this.currentVictorySource.index+e}}return this.currentVictorySource}searchVictoryOnly(t,e,r){const s=e.landing.getNext(r.offset,1);switch(K(this.VERBOSE,{called:"SixRules.searchVictoryOnly",victorySource:t,move:e,state:r}),t.typeSource){case"LINE":return this.searchVictoryOnlyForLine(t.index,s,r);case"CIRCLE":return this.searchVictoryOnlyForCircle(t.index,s,r);case"TRIANGLE_CORNER":return this.searchVictoryOnlyForTriangleCorner(t.index,s,r);default:return this.searchVictoryOnlyForTriangleEdge(t.index,s,r)}}searchVictoryOnlyForCircle(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryOnlyForCircle",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent(),o=[e];let c=e.getNext(ke.factory.all[t],1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};const h=(t+o.length)%6;o.push(c),c=c.getNext(ke.factory.all[h],1)}return{status:yn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}searchVictoryOnlyForLine(t,e,r){const s=r.getCurrentOpponent();let i=ke.factory.all[t],o=e.getNext(i,1);const c=[e];let u=!1;for(;c.length<6;){if(r.getPieceAt(o)===s)c.push(o);else{if(u)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};u=!0,i=i.getOpposite(),o=o.getNext(i,c.length-1)}o=o.getNext(i,1)}return{status:yn.VICTORY,victory:P.of(c),preVictory:P.empty(),sum:0}}searchVictoryOnlyForTriangleCorner(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleCornerOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ke.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};o.length%2==0&&(i=ke.factory.all[(t+o.length)%6]),o.push(c),c=c.getNext(i,1)}return{status:yn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}searchVictoryOnlyForTriangleEdge(t,e,r){K(this.VERBOSE,{called:"SixRules.searchVictoryTriangleEdgeOnly",index:t,lastDrop:e,state:r});const s=r.getCurrentOpponent();let i=ke.factory.all[t];const o=[e];let c=e.getNext(i,1);for(;o.length<6;){if(r.getPieceAt(c)!==s)return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};o.push(c),o.length%2==0&&(i=ke.factory.all[(t+o.length)%6]),c=c.getNext(i,1)}return{status:yn.VICTORY,victory:P.of(o),preVictory:P.empty(),sum:0}}getBoardInfo(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfo",victorySource:t,move:e,state:r,boardInfo:s});const i=e.landing.getNext(r.offset,1);switch(t.typeSource){case"CIRCLE":return this.getBoardInfoForCircle(t.index,i,r,s);case"LINE":return this.getBoardInfoForLine(t.index,i,r,s);case"TRIANGLE_CORNER":return this.getBoardInfoForTriangleCorner(t.index,i,r,s);default:return this.getBoardInfoForTriangleEdge(t.index,i,r,s)}}getBoardInfoForCircle(t,e,r,s){K(this.VERBOSE,{called:"SixMinimaw.getBoardInfoForCircle",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer(),c=[e];let u=e.getNext(ke.factory.all[t],1),h=0,p=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;const C=(t+c.length)%6;c.push(u);const w=ke.factory.all[C];m===pe.NONE?(h+=.16,p=P.of(u)):h++,u=u.getNext(w,1)}return this.getBoardInfoResult(h,p,c,s)}getBoardInfoResult(t,e,r,s){let i=s.preVictory;if(4.16===t){if(K(this.VERBOSE,"5+1 found!"),i.isPresent()&&!1===i.equals(e))return{status:yn.PRE_VICTORY,victory:P.empty(),preVictory:P.empty(),sum:0};i=e}else if(5===t)return{status:yn.VICTORY,victory:P.of(r),preVictory:P.empty(),sum:0};return{status:s.status,victory:P.empty(),preVictory:i,sum:s.sum+t}}getBoardInfoForLine(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfoForLine",index:t,lastDrop:e,state:r,boardInfo:s});const i=ke.factory.all[t];let o=e.getPrevious(i,5),c=[],u=[],h=P.empty();for(let H=0;H<6;H++){const Y=this.updateEncounterAndReturnLastEmpty(r,o,u);Y.isPresent()&&(h=Y),c.push(o),o=o.getNext(i,1)}let p=s.status,m=s.preVictory,C=0,w=0;for(;C<6;){const H=u.reduce((ee,ve)=>ee+ve);if(6===H)return{status:yn.VICTORY,victory:P.of(c),preVictory:P.empty(),sum:0};5.16===H&&p===yn.DEFAULT&&(m.isPresent()?(ye(!1===m.equals(h),"Impossible to have point aligned with differents line to a same point"),p=yn.PRE_VICTORY):m=h),w=Math.max(w,H),c=c.slice(1,6),c.push(o),u=u.slice(1,6);const Y=this.updateEncounterAndReturnLastEmpty(r,o,u);Y.isPresent()&&(h=Y),C++,o=o.getNext(i,1)}const I={status:p,victory:P.of(c),preVictory:m,sum:w};return this.getBoardInfoResult(w,h,c,I)}updateEncounterAndReturnLastEmpty(t,e,r){const s=t.getCurrentPlayer();switch(t.getPieceAt(e)){case s:return r.push(-7),P.empty();case pe.NONE:return r.push(.16),P.of(e);default:return r.push(1),P.empty()}}getBoardInfoForTriangleCorner(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleCorner",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=ke.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,p=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===pe.NONE?(h+=.16,p=P.of(u)):h++,c.length%2==0&&(o=ke.factory.all[(t+c.length)%6]),c.push(u),u=u.getNext(o,1)}return this.getBoardInfoResult(h,p,c,s)}getBoardInfoForTriangleEdge(t,e,r,s){K(this.VERBOSE,{called:"SixRules.getBoardInfoForTriangleEdge",index:t,lastDrop:e,state:r,boardInfo:s});const i=r.getCurrentPlayer();let o=ke.factory.all[t];const c=[e];let u=e.getNext(o,1),h=0,p=P.empty();for(;c.length<6;){const m=r.getPieceAt(u);if(m===i)return s;m===pe.NONE?(h+=.16,p=P.of(u)):h++,c.push(u),c.length%2==0&&(o=ke.factory.all[(t+c.length)%6]),u=u.getNext(o,1)}return this.getBoardInfoResult(h,p,c,s)}}a8.singleton=P.empty();const Me=pe.NONE.value,Bt=z.ZERO.value,Yt=z.ONE.value;let zH=(()=>{class n{}return n.MOVEMENT_NOT_DISCONNECTING=()=>$localize`This move does not disconnect your opponent's pieces. Try again with another piece.`,n.MOVEMENT_SELF_DISCONNECTING=()=>$localize`You lost one of your pieces during this move. There is a way to disconnect an opponent's piece without losing any of yours, try again!`,n})();class z3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Six`,$localize`Six is a game without board, where pieces are placed on the side of each other, in a contiguous block.
        Each player has 21 pieces, with one for each player already on the board.
        The goal of the game is to form one of the three winning shapes with your pieces.`,Wi.getInitialState()),ce.fromMove($localize`Victory (line)`,$localize`On this board, by putting your piece at the right place, you can align six of your pieces and win the game<br/><br/>
        Find the victory. You're playing Dark.`,Wi.fromRepresentation([[Bt,Yt,Yt,Yt,Yt,Bt],[Me,Bt,Yt,Me,Bt,Me],[Yt,Yt,Bt,Me,Me,Me],[Me,Me,Bt,Me,Me,Me],[Me,Bt,Me,Me,Me,Me],[Bt,Me,Me,Me,Me,Me]],0),[Gr.fromDrop(new M(3,2))],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory (circle)`,$localize`On this board, by putting your piece at the right place, you can form a circle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Wi.fromRepresentation([[Me,Me,Me,Yt,Me,Me],[Me,Me,Yt,Yt,Bt,Bt],[Me,Yt,Me,Bt,Yt,Me],[Yt,Bt,Bt,Bt,Bt,Yt]],0),[Gr.fromDrop(new M(5,2))],$localize`Congratulations! Note that if a piece is inside the circle, it does not change anything.`,$localize`Failed. Try again.`),ce.fromMove($localize`Victory (triangle)`,$localize`On this board, by putting your piece at the right place, you can form a triangle with six of your pieces and win the game.<br/><br/>
        Find the victory. You're playing Dark.`,Wi.fromRepresentation([[Me,Me,Me,Yt,Me,Me],[Me,Bt,Yt,Bt,Bt,Bt],[Me,Bt,Me,Bt,Bt,Me],[Yt,Yt,Yt,Me,Yt,Me]],0),[Gr.fromDrop(new M(3,3))],$localize`Congratulations!`,$localize`Failed. Try again.`),ce.fromPredicate($localize`Second phase`,$localize`After 40 turns, your pieces have all been placed and we move on to the second phase of the game.
        You now have to move your pieces, paying attention not to remove a piece that was preventing the opponent's victory.
        From now on, if after move, on or more pieces are disconnected from the largest group of pieces, these will be taken out of the game.<br/><br/>
        You're playing Dark. Make a move that disconnects one of your opponent's pieces.`,Wi.fromRepresentation([[Me,Me,Me,Me,Me,Me,Me,Yt,Me],[Me,Me,Me,Me,Me,Me,Bt,Me,Me],[Me,Me,Me,Me,Bt,Bt,Bt,Me,Me],[Me,Me,Me,Me,Yt,Yt,Me,Yt,Bt],[Me,Bt,Yt,Yt,Bt,Bt,Yt,Me,Me],[Bt,Bt,Bt,Bt,Yt,Yt,Yt,Bt,Me],[Yt,Yt,Bt,Me,Yt,Yt,Bt,Me,Me],[Me,Bt,Me,Bt,Bt,Me,Me,Me,Me],[Yt,Yt,Yt,Yt,Me,Me,Me,Me,Me],[Me,Bt,Me,Yt,Me,Me,Me,Me,Me]],40),Gr.fromMovement(new M(6,1),new M(5,1)),(t,e,r)=>{const s=r.countPieces();return 19===s[0]?18===s[1]?U.SUCCESS:U.failure(zH.MOVEMENT_NOT_DISCONNECTING()):U.failure(zH.MOVEMENT_SELF_DISCONNECTING())},$localize`Congratulations, your opponent now has one piece less and you're closer to victory!`),ce.fromPredicate($localize`Victory by disconnection`,$localize`During the second phase of the game, on top of normal victories (line, circle, triangle), you can win by disconnection.
        If at any time, at least one player does not have enough pieces to win (less than 6), the game ends.
        The one with the most pieces wins. In case they both have the same number of pieces, it's a draw.<br/><br/>
        Here, you're playing Dark and you can win. Do it!`,Wi.fromRepresentation([[Me,Me,Me,Me,Me,Yt],[Me,Me,Me,Me,Bt,Yt],[Me,Me,Me,Yt,Bt,Bt],[Me,Me,Bt,Me,Yt,Bt],[Yt,Yt,Me,Me,Me,Bt],[Bt,Yt,Me,Me,Me,Me],[Bt,Me,Me,Me,Me,Me]],40),Gr.fromMovement(new M(2,3),new M(3,3)),(t,e,r)=>t.start.equalsValue(new M(2,3))?U.SUCCESS:U.failure(zH.MOVEMENT_NOT_DISCONNECTING()),$localize`Congratulations, you won!`),ce.fromPredicate($localize`Special disconnection`,$localize`During a disconnection, two or more groups could have the same size,
        in which case you will have to click on the group you wish to keep.<br/><br/>
        You're playing Dark, play such a move!`,Wi.fromRepresentation([[Me,Me,Me,Me,Me,Yt],[Me,Me,Me,Me,Bt,Yt],[Me,Me,Me,Yt,Bt,Bt],[Bt,Me,Bt,Me,Me,Yt],[Yt,Yt,Me,Me,Me,Me],[Bt,Bt,Me,Me,Me,Me],[Bt,Me,Me,Me,Me,Me]],40),Gr.fromCut(new M(2,3),new M(2,5),new M(2,5)),(t,e,r)=>t.keep.isAbsent()?U.failure($localize`This move has not cut the board in two equal halves.`):r.getPieceAt(t.landing.getNext(r.offset))===pe.NONE?U.failure($localize`Failed. You did cut the board in two but you kept the half where you're in minority. Therefore, you lost! Try again.`):U.SUCCESS,$localize`Congratulations, you won!`)]}}function Kut(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",10),J("click",function(){const i=fe(e).$implicit;return ae(v().onPieceClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","piece_",e.x,"_",e.y,""),T("ngClass",r.getPieceClass(e)),D("points",r.getHexaPointsAt(e))}}function Xut(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",11),J("click",function(){const i=fe(e).$implicit;return ae(v().onNeighborClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","neighbor_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function Qut(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",10),J("click",function(){fe(e);const s=v();return ae(s.onPieceClick(s.chosenLanding.get()))}),O()}if(2&n){const e=v();We("id","chosenLanding_",e.chosenLanding.get().x,"_",e.chosenLanding.get().y,""),T("ngClass",e.getPlayerClass(e.state.getCurrentPlayer())),D("points",e.getHexaPointsAt(e.chosenLanding.get()))}}function Jut(n,t){if(1&n&&(B(),X(0,"polygon",12)),2&n){const e=t.$implicit,r=v();We("id","disconnected_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function e5t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",13),J("click",function(){fe(e);const s=v();return ae(s.onNeighborClick(s.leftCoord.get()))}),O()}if(2&n){const e=v();We("id","leftCoord_",e.leftCoord.get().x,"_",e.leftCoord.get().y,""),D("points",e.getHexaPointsAt(e.leftCoord.get()))}}function t5t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",14),J("click",function(){fe(e);const s=v();return ae(s.onPieceClick(s.lastDrop.get()))}),O()}if(2&n){const e=v();We("id","lastDrop_",e.lastDrop.get().x,"_",e.lastDrop.get().y,""),D("points",e.getHexaPointsAt(e.lastDrop.get()))}}function n5t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",15),J("click",function(){fe(e);const s=v();return ae(s.onPieceClick(s.selectedPiece.get()))}),O()}if(2&n){const e=v();We("id","selectedPiece_",e.selectedPiece.get().x,"_",e.selectedPiece.get().y,""),T("ngClass",e.getSelectedPieceClass()),D("points",e.getHexaPointsAt(e.selectedPiece.get()))}}function r5t(n,t){if(1&n&&(B(),X(0,"polygon",16)),2&n){const e=t.$implicit,r=v();We("id","victoryCoord_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function s5t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",19),J("click",function(){const i=fe(e).$implicit;return ae(v(2).onPieceClick(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);We("id","cuttable_",e.x,"_",e.y,""),D("points",r.getHexaPointsAt(e))}}function i5t(n,t){if(1&n&&(B(),b(0,"g",17),x(1,s5t,1,3,"polygon",18),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let o5t=(()=>{class n extends p9{constructor(e){super(e),this.disconnecteds=[],this.cuttableGroups=[],this.leftCoord=P.empty(),this.lastDrop=P.empty(),this.selectedPiece=P.empty(),this.chosenLanding=P.empty(),this.nextClickShouldSelectGroup=!1,this.rules=new H3(Wi),this.availableMinimaxes=[new a8(this.rules,"SixMinimax")],this.encoder=Gr.encoder,this.tutorial=(new z3e).tutorial,this.SPACE_SIZE=30,this.hexaLayout=new g9(1.5*this.SPACE_SIZE,new M(2*this.SPACE_SIZE,0),Ns.INSTANCE),this.updateBoard()}cancelMoveAttempt(){this.selectedPiece=P.empty(),this.chosenLanding=P.empty(),this.cuttableGroups=[],this.nextClickShouldSelectGroup=!1,this.updateBoard()}updateBoard(){this.state=this.rules.node.gameState,this.rules.node.move.isPresent()?this.showLastMove():(this.leftCoord=P.empty(),this.lastDrop=P.empty(),this.victoryCoords=[],this.disconnecteds=[]),this.pieces=this.state.getPieceCoords(),this.neighbors=this.getEmptyNeighbors(),this.viewBox=this.getViewBox()}getViewBox(){const e=this.pieces.concat(this.disconnecteds).concat(this.neighbors);return i6.fromHexa(e,this.hexaLayout,this.STROKE_WIDTH).toSVGString()}showLastMove(){const e=this.rules.node.move.get();this.lastDrop=P.of(e.landing.getNext(this.state.offset)),this.leftCoord=!1===e.isDrop()?P.of(e.start.get().getNext(this.state.offset,1)):P.empty();const r=this.getState();this.rules.getGameStatus(this.rules.node).isEndGame&&(this.victoryCoords=this.rules.getShapeVictory(e,r)),this.disconnecteds=this.getDisconnected()}getDisconnected(){const e=this.rules.node.mother.get().gameState.getPieceCoords(),r=this.getState().getPieceCoords(),s=[];for(const o of e)!1===this.rules.node.move.get().start.equalsValue(o)&&!1===r.some(u=>u.equals(o.getNext(this.state.offset,1)))&&s.push(o.getNext(this.state.offset,1));const i=this.lastDrop.get();return!1===this.pieces.some(o=>o.equals(i))&&!1===r.some(o=>o.equals(i))&&s.push(i),s}getEmptyNeighbors(){let e=H3.getLegalLandings(this.state);if(this.chosenLanding.isPresent()){const r=this.chosenLanding.get();e=e.filter(s=>!1===s.equals(r))}return e}getPieceClass(e){const r=this.getState().getPieceAt(e);return this.getPlayerClass(r)}onPieceClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#piece_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.state.turn<40)return r.cancelMove(V3.NO_MOVEMENT_BEFORE_TURN_40());if(r.chosenLanding.isAbsent())return r.state.getPieceAt(e)===r.state.getCurrentOpponent()?r.cancelMove(rt.CANNOT_CHOOSE_OPPONENT_PIECE()):(r.selectedPiece=r.selectedPiece.equalsValue(e)?P.empty():P.of(e),U.SUCCESS);{const i=Gr.fromCut(r.selectedPiece.get(),r.chosenLanding.get(),e);return r.chooseMove(i,r.state)}})()}onNeighborClick(e){var r=this;return A(function*(){const s=r.canUserPlay("#neighbor_"+e.x+"_"+e.y);if(s.isFailure())return r.cancelMove(s.getReason());if(r.nextClickShouldSelectGroup)return r.cancelMove(V3.MUST_CUT());if(r.state.turn<40)return r.chooseMove(Gr.fromDrop(e),r.state);if(r.selectedPiece.isAbsent())return r.cancelMove(V3.CAN_NO_LONGER_DROP());{const i=Gr.fromMovement(r.selectedPiece.get(),e),o=H3.isLegalPhaseTwoMove(i,r.state);return r.neededCutting(o)?(r.chosenLanding=P.of(e),r.moveVirtuallyPiece(),r.showCuttable(),r.nextClickShouldSelectGroup=!0,U.SUCCESS):r.chooseMove(i,r.state)}})()}neededCutting(e){return e.isFailure()&&e.getReason()===V3.MUST_CUT()}moveVirtuallyPiece(){const e=this.selectedPiece.get();this.pieces=this.pieces.filter(r=>!1===r.equals(e)),this.neighbors=this.getEmptyNeighbors()}showCuttable(){const e=Gr.fromMovement(this.selectedPiece.get(),this.chosenLanding.get()),s=this.state.movePiece(e).getGroups(),i=H3.getBiggerGroups(s);this.cuttableGroups=[];for(const o of i)this.cuttableGroups.push(o.toList())}getSelectedPieceClass(){return this.chosenLanding.isPresent()?"moved-fill":"selected-stroke"}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-six"]],features:[l],decls:10,vars:10,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["class","base round",3,"id","ngClass","click",4,"ngFor","ngForOf"],["class","base round",3,"id","click",4,"ngFor","ngForOf"],["class","base round",3,"id","ngClass","click",4,"ngIf"],["class","base round captured-fill",3,"id",4,"ngFor","ngForOf"],["class","base round moved-fill mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round last-move-stroke mid-stroke",3,"id","click",4,"ngIf"],["class","base no-fill round",3,"id","ngClass","click",4,"ngIf"],["class","base no-fill round victory-stroke mid-stroke",3,"id",4,"ngFor","ngForOf"],["pointer-events","fill","class","capturable-stroke",4,"ngFor","ngForOf"],[1,"base","round",3,"id","ngClass","click"],[1,"base","round",3,"id","click"],[1,"base","round","captured-fill",3,"id"],[1,"base","round","moved-fill","mid-stroke",3,"id","click"],[1,"base","no-fill","round","last-move-stroke","mid-stroke",3,"id","click"],[1,"base","no-fill","round",3,"id","ngClass","click"],[1,"base","no-fill","round","victory-stroke","mid-stroke",3,"id"],["pointer-events","fill",1,"capturable-stroke"],["class","no-fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["stroke-linecap","round",1,"no-fill",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,Kut,1,4,"polygon",1),x(2,Xut,1,3,"polygon",2),x(3,Qut,1,4,"polygon",3),x(4,Jut,1,3,"polygon",4),x(5,e5t,1,3,"polygon",5),x(6,t5t,1,3,"polygon",6),x(7,n5t,1,4,"polygon",7),x(8,r5t,1,3,"polygon",8),x(9,i5t,2,1,"g",9),O()),2&e&&(D("viewBox",r.viewBox),S(1),T("ngForOf",r.pieces),S(1),T("ngForOf",r.neighbors),S(1),T("ngIf",r.chosenLanding.isPresent()),S(1),T("ngForOf",r.disconnecteds),S(1),T("ngIf",r.leftCoord.isPresent()),S(1),T("ngIf",r.lastDrop.isPresent()),S(1),T("ngIf",r.selectedPiece.isPresent()),S(1),T("ngForOf",r.victoryCoords),S(1),T("ngForOf",r.cuttableGroups))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class pa extends gH{static of(t,e){return new pa(t,e)}static from(t,e){try{const r=new pa(t,e);return $.success(r)}catch(r){return $.failure(r.message)}}getMaximalDistance(){return 9}}pa.encoder=I4.getEncoder(pa.from);const a5t={CASTLE_IS_LEFT_FOR_GOOD:!1,BORDER_CAN_SURROUND_KING:!0,CENTRAL_THRONE_CAN_SURROUND_KING:!1,KING_FAR_FROM_CENTRAL_THRONE_CAN_BE_SANDWICHED:!1,WIDTH:9,INVADER:z.ZERO};class $4 extends mH{static getInitialState(){const t=hn.UNOCCUPIED,e=hn.INVADERS,r=hn.DEFENDERS;return new $4([[t,t,t,e,e,e,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,t,r,t,t,t,t],[e,t,t,t,r,t,t,t,e],[e,e,r,r,hn.PLAYER_ONE_KING,r,r,e,e],[e,t,t,t,r,t,t,t,e],[t,t,t,t,r,t,t,t,t],[t,t,t,t,e,t,t,t,t],[t,t,t,e,e,e,t,t,t]],0)}from(t,e){return new $4(t,e)}}class M5 extends _H{constructor(){super($4,a5t,pa.of)}static get(){return null==M5.singleton&&(M5.singleton=new M5),B1.ruler=this.singleton,M5.singleton}}const q=hn.UNOCCUPIED,r1=hn.INVADERS,no=hn.DEFENDERS,GP=hn.PLAYER_ONE_KING;class V3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`Tablut is the lapland version of the Tafl, Tafl being a family of viking strategy game. The goal of the game is different for each player. The attacker plays first. Its pieces (dark) are close to the edges. Its goal is to capture the king, which is in the center of the board. The defender plays second. Its pieces (light) are in the middle. Its goal is to move the king on one of the 4 thrones in the corners. Note that the square in which the king starts, in the center of the board, is also a throne.`,$4.getInitialState()),ce.anyMove($localize`Moving`,$localize`All pieces move the same way. Similarly to a rook in chess, a piece can move:<ol><li>By as many squares as you want.</li><li>Without going over another piece or stopping on another piece.</li><li>Horizontally or vertically.</li><li>Only the king can land on a throne.</li></ol>To move a piece, click on it and then on its landing square.<br/><br/>You're playing Dark, do the first move.`,$4.getInitialState(),pa.of(new M(4,1),new M(1,1)),$localize`Congratulations!`),ce.fromMove($localize`Capturing a soldier (1/2)`,$localize`All pieces, attackers and defenders, except the king, are soldiers. To capture them, they have to be sandwiched between two of your pieces. By getting too close, an attacker's soldier is in danger.<br/><br/>You're playing Light. Capture the soldier.`,new $4([[q,q,q,r1,r1,r1,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,q,no,q,q,q,q],[q,q,q,r1,no,q,q,q,r1],[r1,r1,no,no,GP,no,no,r1,r1],[q,q,q,q,no,q,q,q,r1],[q,q,q,q,no,q,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,r1,r1,r1,q,q,q]],1),[pa.of(new M(2,4),new M(2,3)),pa.of(new M(4,2),new M(3,2))],$localize`Congratulations, that will teach him a lesson!`,$localize`Failed, you missed an opportunity to capture a piece of the opponent.`),ce.fromMove($localize`Capturing a soldier (2/2)`,$localize`A second way to capture a soldier is to sandwich it against an empty throne. The king has moved and endangered one of its soldiers.<br/><br/>You're playing Dark. Capture the soldier.`,new $4([[q,q,q,r1,r1,r1,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,q,no,q,q,q,q],[q,q,no,q,GP,q,no,q,r1],[r1,r1,q,no,q,no,no,r1,r1],[q,q,q,q,no,q,q,q,r1],[q,q,q,q,no,q,q,q,q],[q,q,q,q,r1,q,q,q,q],[q,q,q,r1,r1,r1,q,q,q]],12),[pa.of(new M(1,4),new M(2,4))],$localize`Congratulations, one less defender. But keep an eye on the king, it is the most important.`,$localize`Failed, you did not do the expected move.`),ce.fromMove($localize`Capturing the king (1/2)`,$localize`To capture the king, two soldiers are not enough. For the first solution, the four squares neighbor to the king (horizontally and vertically) must be occupied by your soldiers. This also works if the king is on the throne.<br/><br/>You're playing Dark, capture the king.`,new $4([[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,r1,q,q,q,q,q,q,q],[r1,GP,q,r1,q,q,q,q,q],[q,r1,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q]],72),[pa.of(new M(3,4),new M(2,4))],$localize`Congratulations, you won!`,$localize`Failed, you let the king run away.`),ce.fromMove($localize`Capturing the king (2/2)`,$localize`Another way to capture the king is to immobilize it against an edge of the board. Note that the king cannot be captured next to a throne.<br/><br/>You're playing Dark, capture the king.`,new $4([[q,q,r1,GP,r1,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,r1,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q]],72),[pa.of(new M(3,3),new M(3,1))],$localize`The king is dead, long live the king. Congratulations, you won.`,$localize`Failed. Try again.`)]}}function c5t(n,t){1&n&&(B(),X(0,"polygon",8))}function l5t(n,t){1&n&&(B(),X(0,"rect",9))}function u5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,c5t,1,0,"polygon",6),x(2,l5t,1,0,"ng-template",null,7,c1),O()),2&n){const e=t1(3),r=v().index,s=v().index,i=v();S(1),T("ngIf",i.isCentralThrone(r,s))("ngIfElse",e)}}function f5t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"line",13)(2,"line",13)(3,"line",13)(4,"line",13)(5,"line",13),O()),2&n){const e=v(2).index,r=v().index,s=v();S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.1*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.9*s.SPACE_SIZE)("y2",.6*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.15*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.4*s.SPACE_SIZE)("x2",.85*s.SPACE_SIZE)("y2",.75*s.SPACE_SIZE)}}function h5t(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v(3).index,r=v().index;T("ngClass",v().viewInfo.pieceClasses[r][e])}}function d5t(n,t){if(1&n&&(B(),X(0,"line",13)(1,"line",13)(2,"line",13)(3,"line",13)),2&n){const e=v(3).index,r=v().index,s=v();T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.5*s.SPACE_SIZE)("y1",.04*s.SPACE_SIZE)("x2",.5*s.SPACE_SIZE)("y2",.96*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.04*s.SPACE_SIZE)("y1",.5*s.SPACE_SIZE)("x2",.96*s.SPACE_SIZE)("y2",.5*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.2*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.8*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE),S(1),T("ngClass",s.viewInfo.pieceClasses[r][e]),D("x1",.8*s.SPACE_SIZE)("y1",.2*s.SPACE_SIZE)("x2",.2*s.SPACE_SIZE)("y2",.8*s.SPACE_SIZE)}}function p5t(n,t){if(1&n&&(B(),x(0,h5t,1,1,"polyline",14),x(1,d5t,4,20,"ng-template",null,15,c1)),2&n){const e=t1(2),r=v(2).index,s=v().index;T("ngIf",v().isKing(r,s))("ngIfElse",e)}}function g5t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",10),x(2,f5t,6,25,"g",11),x(3,p5t,3,2,"ng-template",null,12,c1),O()),2&n){const e=t1(4),r=v().index,s=v().index,i=v();S(1),We("id","piece_",r,"_",s,""),T("ngClass",i.viewInfo.pieceClasses[s][r]),D("r",i.SPACE_SIZE/2-i.STROKE_WIDTH)("cx",.5*i.SPACE_SIZE)("cy",.5*i.SPACE_SIZE),S(1),T("ngIf",i.isInvader(r,s))("ngIfElse",e)}}function m5t(n,t){if(1&n){const e=Oe();B(),b(0,"g",3),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),X(1,"rect",4),x(2,u5t,4,2,"g",5),x(3,g5t,5,8,"g",5),O()}if(2&n){const e=t.index,r=v().index,s=v();We("id","click_",e,"_",r,""),D("transform","translate("+s.SPACE_SIZE*e+", "+s.SPACE_SIZE*r+")"),S(1),T("ngClass",s.getRectClasses(e,r)),D("width",s.SPACE_SIZE)("height",s.SPACE_SIZE),S(1),T("ngIf",s.board[r][e]===s.EMPTY&&s.isThrone(e,r)),S(1),T("ngIf",s.board[r][e]!==s.EMPTY)}}function _5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,m5t,4,8,"g",2),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function v5t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"rect",17),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i.x,i.y))}),O()()}if(2&n){const e=t.$implicit,r=v();S(1),We("id","click_",e.x,"_",e.y,""),D("x",r.SPACE_SIZE*e.x)("y",r.SPACE_SIZE*e.y)("width",r.SPACE_SIZE)("height",r.SPACE_SIZE)}}let C5t=(()=>{class n extends vH{constructor(e){super(e,!1,pa.from),this.rules=M5.get(),this.availableMinimaxes=[new fP(this.rules,"DummyBot"),new dP(this.rules,"Piece > Influence"),new w3(this.rules,"Piece > Control"),new _9(this.rules,"Escape > Piece > Control")],this.encoder=pa.encoder,this.tutorial=(new V3e).tutorial,this.updateBoard()}}return n.\u0275fac=function(e){return new(e||n)(Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-tablut"]],features:[l],decls:3,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],["x","0","y","0",1,"base",3,"ngClass"],[4,"ngIf"],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60","class","base",4,"ngIf","ngIfElse"],["cornerThrone",""],["points","10 20, 20 90, 80 90, 90 20, 65 60, 50 30, 35 60",1,"base"],["x","15","y","15","width","70","height","70",1,"base"],[1,"base",3,"id","ngClass"],[4,"ngIf","ngIfElse"],["defender",""],[1,"base",3,"ngClass"],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85","class","base no-fill",3,"ngClass",4,"ngIf","ngIfElse"],["soldierDefender",""],["points","80 85, 32.5 37.5, 50 20, 67.5 37.5, 20 85",1,"base","no-fill",3,"ngClass"],[1,"no-fill","mid-stroke","clickable-stroke",3,"id","click"]],template:function(e,r){1&e&&(B(),b(0,"svg",0),x(1,_5t,2,1,"g",1),x(2,v5t,2,6,"g",1),O()),2&e&&(D("viewBox",r.getViewBox()),S(1),T("ngForOf",r.board),S(1),T("ngForOf",r.getClickables()))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]}),n})();class R2{constructor(t,e){this.owner=t,this.tileId=e}toString(){return`TrexoPiece(${this.owner.toString()}, ${this.tileId})`}}class Ds{constructor(t){this.pieces=t}static from(t){let e=-1;for(const r of t)ye(e<r.tileId,"TrexoPieceStack: dropped turn should be ascending"),e=r.tileId;return new Ds(t)}getHeight(){return this.pieces.length}getOwner(){const t=this.pieces.length;return 0===t?pe.NONE:this.pieces[t-1].owner}getUpperTileId(){const t=this.pieces.length;return 0===t?-1:this.pieces[t-1].tileId}add(t){return Ds.from(this.pieces.concat(t))}getPieceAt(t){return ye(t<this.pieces.length,"no element "+t+"in piece!"),this.pieces[t]}isGround(){return-1===this.getUpperTileId()}toString(){return"["+this.pieces.map(t=>"("+t.toString()+")").join(" ")+"]"}}Ds.EMPTY=Ds.from([]);let ns=(()=>{class n extends ps{static getInitialState(){const e=Ke.createTable(n.SIZE,n.SIZE,Ds.EMPTY);return new n(e,0)}static from(e,r){ye(e.length===n.SIZE,"Invalid board dimensions");for(const s of e)ye(s.length===n.SIZE,"Invalid board dimensions");return $.success(new n(e,r))}drop(e,r){const s=this.getCopiedBoard(),i=new R2(r,this.turn);return s[e.y][e.x]=s[e.y][e.x].add(i),new n(s,this.turn)}incrementTurn(){return new n(this.getCopiedBoard(),this.turn+1)}toString(){return this.board.map(e=>"["+e.map(r=>"TrexoPieceStack.from("+r.toString()+")").join(", ")+"]").join("\n,")}getPieceAtXYZ(e,r,s){return this.getPieceAtXY(e,r).getPieceAt(s)}}return n.SIZE=10,n})(),WP=(()=>{class n{}return n.NON_NEIGHBORING_SPACES=()=>$localize`Those two spaces are not neighbors!`,n.NO_WAY_TO_DROP_IT_HERE=()=>$localize`There is no way to put a piece there!`,n.CANNOT_DROP_ON_ONLY_ONE_PIECE=()=>$localize`You cannot drop on only one piece!`,n.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS=()=>$localize`You cannot drop a piece on uneven grounds!`,n})();class ga extends I4{constructor(t,e){super(t,e)}static from(t,e){return ye(t.isInRange(ns.SIZE,ns.SIZE),`${t.toString()} is out of the TrexoBoard!`),ye(e.isInRange(ns.SIZE,ns.SIZE),`${e.toString()} is out of the TrexoBoard!`),1===t.getOrthogonalDistance(e)?$.success(new ga(t,e)):$.failure(WP.NON_NEIGHBORING_SPACES())}toString(){return this.getFirst().toString()+" && "+this.getSecond().toString()}equals(t){return this.getFirst().equals(t.getFirst())&&this.getSecond().equals(t.getSecond())}getZero(){return this.getFirst()}getOne(){return this.getSecond()}}ga.encoder=I4.getEncoder(ga.from);class qi extends Z1{constructor(){super(ns)}static getOwner(t){return t.getOwner()}static isInRange(t){return t.isInRange(ns.SIZE,ns.SIZE)}static get(){return qi.instance.isAbsent()&&(qi.instance=P.of(new qi)),qi.instance.get()}applyLegalMove(t,e){return e.drop(t.getZero(),z.ZERO).drop(t.getOne(),z.ONE).incrementTurn()}isLegal(t,e){return this.isUnevenGround(t,e)?$.failure(WP.CANNOT_DROP_PIECE_ON_UNEVEN_GROUNDS()):this.landsOnOnlyOnePiece(t,e)?$.failure(WP.CANNOT_DROP_ON_ONLY_ONE_PIECE()):$.success(void 0)}isUnevenGround(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return r.getHeight()!==s.getHeight()}landsOnOnlyOnePiece(t,e){const r=e.getPieceAt(t.getZero()),s=e.getPieceAt(t.getOne());return(-1!==r.getUpperTileId()||-1!==s.getUpperTileId())&&r.getUpperTileId()===s.getUpperTileId()}static getSquareScore(t,e){return qi.TREXO_HELPER.getSquareScore(t,e)}static getVictoriousCoords(t){const e=[],r=[],s=t.getCurrentOpponent();for(const i of t.toMap()){const o=i.key,c=t.getPieceAt(o).getOwner();if(c.isPlayer()){const u=qi.getSquareScore(t,o);B1.getScoreStatus(u)===yn.VICTORY&&(c===s?e.push(o):r.push(o))}}return r.length>0?r:e}getGameStatus(t){const e=t.gameState,r=e.getCurrentOpponent();let s=!1;for(const i of e.toMap()){const o=i.key,c=e.getPieceAt(o).getOwner();if(c.isPlayer()){const u=qi.getSquareScore(e,o);if(B1.getScoreStatus(u)===yn.VICTORY){if(c!==r)return xe.getDefeat(r);s=!0}}}return s?xe.getVictory(r):xe.ONGOING}getLegalMoves(t){const e=[];for(const r of t.toMap()){const s=r.key;if(s.x+1<ns.SIZE){const i=new M(s.x+1,s.y);e.push(...this.getPossiblesMoves(t,s,i))}if(s.y+1<ns.SIZE){const i=new M(s.x,s.y+1);e.push(...this.getPossiblesMoves(t,s,i))}}return e}getPossiblesMoves(t,e,r){const s=t.getPieceAt(e),i=t.getPieceAt(r);let o;o=!s.isGround()&&s.getUpperTileId()===i.getUpperTileId();const c=s.getHeight()!==i.getHeight();return o||c?[]:[ga.from(e,r).get(),ga.from(r,e).get()]}}qi.instance=P.empty(),qi.TREXO_HELPER=new m3e(qi.isInRange,qi.getOwner,5);class VH extends $1{static getBoardValue(t){let e=0;const r=t.gameState,s=r.getCurrentOpponent();let i=!1;for(const o of r.toMap()){const c=r.getPieceAt(o.key).getOwner();if(c.isPlayer()){const u=qi.getSquareScore(r,o.key);if(B1.getScoreStatus(u)===yn.VICTORY){if(c!==s)return new Ct(s.getDefeatValue());i=!0}else e+=u}}return new Ct(i?s.getVictoryValue():e)}getListMoves(t){return qi.get().getLegalMoves(t.gameState)}getBoardValue(t){return VH.getBoardValue(t)}}const le=Ds.EMPTY,H3e=Ds.from([new R2(z.ONE,0)]),y5t=Ds.from([new R2(z.ZERO,0)]),E5t=Ds.from([new R2(z.ONE,1)]),F3e=Ds.from([new R2(z.ZERO,1)]),M5t=Ds.from([new R2(z.ZERO,2)]),S5t=Ds.from([new R2(z.ONE,2)]),P5t=Ds.from([new R2(z.ZERO,0),new R2(z.ZERO,3)]),T5t=Ds.from([new R2(z.ONE,1),new R2(z.ONE,3)]),w5t=Ds.from([new R2(z.ZERO,4)]),b5t=Ds.from([new R2(z.ONE,4)]),O5t=Ds.from([new R2(z.ZERO,5)]),N5t=Ds.from([new R2(z.ONE,5)]),A5t=Ds.from([new R2(z.ONE,6)]),I5t=Ds.from([new R2(z.ZERO,6)]);class B3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`At Trexo, the goal of the game is to align 5 pieces of your color in a vertical, horizontal or diagonal line. However, the players play with tiles that are constituted of two pieces, one from each player!`,ns.getInitialState()),ce.anyMove($localize`Dropping a tile`,$localize`When you drop a tile, it needs to be on even ground, and it cannot be right on top of another tile. In others words, it needs to be either on the floor, or on two tiles at the same height. To drop a tile, just click on the square where you want to put the opponent side of the tile, then on the neighboring square where you want to put your piece.<br/><br/>You're playing Dark, put a tile on the board.`,ns.getInitialState(),ga.from(new M(4,4),new M(3,4)).get(),$localize`Congratulations!`),ce.fromMove($localize`Dropping a piece over other pieces`,$localize`You can put a tile on other tiles. For that you must respect two rules:<br/><ul><li>The two pieces must be at the same height.</li><li>You cannot drop your piece on only one other piece.</li></ul><br/>You're playing Dark, do such a move!`,new ns([[le,le,le,H3e,y5t,F3e,E5t,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le]],7),[ga.from(new M(4,0),new M(5,0)).get(),ga.from(new M(5,0),new M(4,0)).get()],$localize`Congratulations!`,$localize`Failed, you put that piece on the floor level, please put it on top of two pieces.`),ce.fromPredicate($localize`Victory`,$localize`To win at Trexo, you need to align 5 of your pieces. Only the piece on top counts, the hidden piece are no longer threats, and a victory can include pieces on differents heights. Since you have to put the piece of your opponent first, if you create a victory for them, you lose, even if you aligned 5 of your pieces too.<br/><br/>You're playing Light, win.`,new ns([[le,le,le,le,le,le,le,le,le,le],[le,le,le,O5t,le,le,le,le,le,le],[le,le,le,N5t,le,le,le,le,le,le],[le,le,le,le,H3e,le,le,w5t,b5t,le],[le,le,le,le,P5t,T5t,F3e,le,le,le],[le,le,le,le,le,M5t,A5t,I5t,le,le],[le,le,le,le,le,S5t,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le],[le,le,le,le,le,le,le,le,le,le]],7),ga.from(new M(2,0),new M(2,1)).get(),(t,e,r)=>qi.TREXO_HELPER.getSquareScore(r,t.getOne())===Number.MAX_SAFE_INTEGER?U.SUCCESS:U.failure($localize`Failed. Try again.`),$localize`Congratulations, you won!`)]}}function x5t(n,t){if(1&n){const e=Oe();B(),b(0,"g")(1,"polygon",5),J("click",function(){const i=fe(e).index,o=v().index;return ae(v().onClick(i,o))}),O()()}if(2&n){const e=t.index,r=v().index,s=v();S(1),We("id","space_",e,"_",r,""),T("ngClass",s.getSpaceClasses(e,r)),D("points",s.getParallelogramPoints())("transform",s.getTranslate(e,r,0))}}function k5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,x5t,2,5,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function L5t(n,t){if(1&n){const e=Oe();B(),b(0,"g",8),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v(2).onClick(s,i))}),O()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index,o=v().index,c=v();G2("id","half_tile_",r,"_",i,"_",o,""),T("mode",c.mode)("coord",c.Coord3D.of(r,i,o))("mustDisplayHeight","2D"===c.chosenMode)("move",s.move.get())("pieceClasses",c.getPieceClasses(r,i,o)),D("transform",c.getTranslate(r,i,o+1))}}const $3e=function(n){return[n]};function R5t(n,t){if(1&n){const e=Oe();B(),b(0,"g",9),J("click",function(){fe(e);const s=v().index,i=v().index;return ae(v(2).onClick(s,i))}),O()}if(2&n){const e=v().index,r=v().index,s=v().index,i=v();G2("id","dropped_piece_",e,"_",r,"_",s,""),T("mode",i.mode)("coord",i.Coord3D.of(e,r,s))("pieceClasses",g3(7,$3e,i.currentOpponentClass)),D("transform",i.getTranslate(e,r,s+1))}}function D5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,L5t,1,9,"g",6),x(2,R5t,1,9,"g",7),O()),2&n){const e=t.$implicit;S(1),T("ngIf",e.move.isPresent()),S(1),T("ngIf",e.isDroppedPiece)}}function z5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,D5t,3,2,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function V5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,z5t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}const H5t=function(){return["player0-fill"]};function F5t(n,t){if(1&n){const e=Oe();B(),b(0,"g",10),J("click",function(){return fe(e),ae(v().switchToMode("3D"))}),O()}if(2&n){const e=v();T("mode",e.TrexoComponent.modeMap["3D"])("coord",e.Coord3D.of(10.5,8.5,0))("pieceClasses",tr(4,H5t)),D("transform",e.get3DSwitcherTransform())}}function B5t(n,t){if(1&n){const e=Oe();B(),b(0,"g",11),J("click",function(){return fe(e),ae(v().switchToMode("2D"))}),O()}if(2&n){const e=v();T("mode",e.TrexoComponent.modeMap["2D"])("coord",e.Coord3D.of(12,9,0))("pieceClasses",g3(4,$3e,e.currentPlayerClass)),D("transform",e.getTranslate(12,9,0))}}class u1 extends a3e{constructor(t){super(t),this.TrexoComponent=u1,this.left=-this.STROKE_WIDTH/2,this.Coord3D=V4,this.up=0,this.chosenMode="3D",this.victoryCoords=[],this.droppedPiece=P.empty(),this.possibleNextClicks=[],this.possibleMoves=[],this.pieceOnBoard=[],this.currentOpponentClass="player1",this.currentPlayerClass="player0",this.rules=qi.get(),this.availableMinimaxes=[new VH(this.rules,"TrexoMinimax")],this.encoder=ga.encoder,this.tutorial=(new B3e).tutorial,u1.STROKE_WIDTH=this.STROKE_WIDTH,this.switchToMode("3D"),this.updateBoard()}switchToMode(t){this.chosenMode=t,this.width=this.getViewBoxWidth(),this.up=this.getViewBoxUp(),this.height=this.getViewBoxHeight(),this.mode=u1.modeMap[t]}getViewBoxWidth(){const t=u1.modeMap["3D"],e=ns.SIZE;return"2D"===this.chosenMode?(e+1)*this.SPACE_SIZE+2*this.STROKE_WIDTH:e*(this.SPACE_SIZE*(t.horizontalWidthRatio+t.offsetRatio))+this.STROKE_WIDTH}getViewBoxHeight(){const e=ns.SIZE*this.SPACE_SIZE;return"2D"===this.chosenMode?e:this.STROKE_WIDTH+e+this.getHigherStackHeight()}getViewBoxUp(){if("2D"===this.chosenMode)return 0;{const t=this.getHigherStackHeight();return-(this.STROKE_WIDTH/2+t)}}getHigherStackHeight(){return(this.pieceOnBoard.length+1)*u1.modeMap[this.chosenMode].pieceHeightRatio*this.SPACE_SIZE}updateBoard(){const t=this.getState();this.board=t.getCopiedBoard(),this.currentOpponentClass=this.getPlayerClass(t.getCurrentOpponent()),this.currentPlayerClass=this.getPlayerClass(t.getCurrentPlayer()),this.possibleMoves=this.rules.getLegalMoves(t),this.victoryCoords=qi.getVictoriousCoords(t),this.pieceOnBoard=this.get3DBoard(),this.height=this.getViewBoxHeight(),this.up=this.getViewBoxUp()}get3DBoard(){const t=Ke.create3DTable(1,ns.SIZE,ns.SIZE,u1.INITIAL_PIECE_ON_BOARD);let e=1;for(let r=0;r<=e;r++)for(const s of this.getState().toMap()){const i=s.key,o=s.value.getHeight();if(e=Math.max(e,o),r<o){const c=this.extractMoveFromState(i.x,i.y,r);this.addMoveToArray(r,c,t)}}return t}extractMoveFromState(t,e,r){const s=this.getState().getPieceAtXYZ(t,e,r),i=new M(t,e);let o=new M(-2,-2);for(const c of be.ORTHOGONALS){const u=i.getNext(c);if(u.isInRange(ns.SIZE,ns.SIZE)){const h=this.getState().getPieceAt(u);h.getHeight()>r&&h.getPieceAt(r).tileId===s.tileId&&(o=u)}}return s.owner===z.ZERO?ga.from(i,o).get():ga.from(o,i).get()}addMoveToArray(t,e,r){for(;r.length<=t;)r.push(Ke.createTable(ns.SIZE,ns.SIZE,u1.INITIAL_PIECE_ON_BOARD));r[t][e.getZero().y][e.getZero().x]={isDroppedPiece:!1,isPossibleClick:!1,move:P.of(e)},r[t][e.getOne().y][e.getOne().x]={isDroppedPiece:!1,isPossibleClick:!1,move:P.of(e)}}onClick(t,e){var r=this;return A(function*(){const s=r.canUserPlay("#space_"+t+"_"+e);if(s.isFailure())return r.cancelMove(s.getReason());const i=new M(t,e);if(r.droppedPiece.isPresent()){const o=r.droppedPiece.get();if(r.droppedPiece.equalsValue(i))return r.cancelMoveAttempt(),U.SUCCESS;if(r.possibleNextClicks.some(c=>c.equals(i))){const c=r.getState().getCurrentPlayer()===z.ZERO,p=ga.from(c?i:o,c?o:i).get();return r.chooseMove(p,r.getState())}r.deselectPiece()}return r.selectPiece(i)})()}deselectPiece(){const t=this.getState().getPieceAt(this.droppedPiece.get()).getHeight(),e=this.droppedPiece.get().y,r=this.droppedPiece.get().x;this.pieceOnBoard[t][e][r]=u1.INITIAL_PIECE_ON_BOARD;for(const s of this.possibleNextClicks)this.pieceOnBoard[t][s.y][s.x].isPossibleClick=!1}selectPiece(t){if(this.possibleMoves.some(e=>e.getZero().equals(t))){const e=this.getState().getPieceAt(t).getHeight();return e>=this.pieceOnBoard.length&&this.pieceOnBoard.push(Ke.createTable(ns.SIZE,ns.SIZE,u1.INITIAL_PIECE_ON_BOARD)),this.showDroppedPieceAndIndicators(t,e),U.SUCCESS}return this.cancelMove(WP.NO_WAY_TO_DROP_IT_HERE())}showDroppedPieceAndIndicators(t,e){this.droppedPiece=P.of(t),this.possibleNextClicks=this.getPossibleNextClicks(t);for(const r of this.possibleNextClicks)this.pieceOnBoard[e][r.y][r.x]={isDroppedPiece:!1,isPossibleClick:!0,move:P.empty()};this.pieceOnBoard[e][t.y][t.x]={isDroppedPiece:!0,isPossibleClick:!1,move:P.empty()}}getPossibleNextClicks(t){return this.possibleMoves.filter(r=>r.getZero().equals(t)).map(r=>r.getOne())}cancelMoveAttempt(){this.droppedPiece=P.empty(),this.possibleNextClicks=[],this.updateBoard()}getPieceClasses(t,e,r){const s=new M(t,e),i=this.getState().getPieceAtXYZ(t,e,r).owner;let o=[this.getPlayerClass(i)];o=o.concat(this.getSpaceClasses(t,e));for(const c of this.victoryCoords)if(c.equals(s)){o.push("victory-stroke");break}if(this.rules.node.move.isPresent()){const c=this.rules.node.move.get();(c.getZero().equals(s)||c.getOne().equals(s))&&o.push("last-move-stroke")}return o}getSpaceClasses(t,e){for(const r of this.pieceOnBoard)if(r[e][t].isPossibleClick)return["darker"];return[]}getTranslate(t,e,r){const i=this.getCoordTranslate(t,e,r,u1.modeMap[this.chosenMode]);return"translate("+i.x+" "+i.y+")"}getParallelogramPoints(){return this.getParallelogramCoordsForTrexo().map(e=>e.x+" "+e.y).join(" ")}getParallelogramCoordsForTrexo(){return this.getParallelogramCoords(u1.modeMap[this.chosenMode])}get3DSwitcherTransform(){const t=u1.modeMap["3D"],e=t.horizontalWidthRatio+t.offsetRatio;return"translate("+(10+t.offsetRatio)*t.parallelogramHeight+", "+(9+(1-1/e)/2)*t.parallelogramHeight+") scale("+1/e+")"}}u1.VERBOSE=!1,u1.INITIAL_PIECE_ON_BOARD={isDroppedPiece:!1,isPossibleClick:!1,move:P.empty()},u1.modeMap={"2D":{offsetRatio:0,horizontalWidthRatio:1,pieceHeightRatio:0,parallelogramHeight:100,abstractBoardSize:10},"3D":{offsetRatio:.4,horizontalWidthRatio:1.2,pieceHeightRatio:.2,parallelogramHeight:100,abstractBoardSize:10}},u1.\u0275fac=function(t){return new(t||u1)(Q(Tn))},u1.\u0275cmp=gt({type:u1,selectors:[["app-trexo"]],features:[l],decls:8,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%"],[4,"ngFor","ngForOf"],["switchModeIndicator",""],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click",4,"ngIf","ngIfElse"],["switchTo2D",""],[1,"base",3,"id","ngClass","click"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click",4,"ngIf"],["mgp-trexo-half-piece","",3,"id","mode","coord","mustDisplayHeight","move","pieceClasses","click"],["mgp-trexo-half-piece","",3,"mode","id","coord","pieceClasses","click"],["id","switchTo3D","mgp-trexo-half-piece","",3,"mode","coord","pieceClasses","click"],["mgp-trexo-half-piece","","id","switchTo2D",3,"mode","coord","pieceClasses","click"]],template:function(t,e){if(1&t&&(B(),b(0,"svg",0),x(1,k5t,2,1,"g",1),x(2,V5t,2,1,"g",1),b(3,"g",null,2),x(5,F5t,1,5,"g",3),x(6,B5t,1,6,"ng-template",null,4,c1),O()()),2&t){const r=t1(7);D("viewBox",e.left+" "+e.up+" "+e.width+" "+e.height),S(1),T("ngForOf",e.board),S(1),T("ngForOf",e.pieceOnBoard),S(3),T("ngIf","2D"===e.chosenMode)("ngIfElse",r)}},styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class Lr{}Lr.PLACEMENT_AFTER_INITIAL_PHASE=()=>$localize`You cannot put a new ring after the tenth turn.`,Lr.NO_MARKERS_IN_INITIAL_PHASE=()=>$localize`You cannot put a marker in a ring before placing all of your rings.`,Lr.MISSING_CAPTURES=xc.MISSING_CAPTURES,Lr.MOVE_DIRECTION_INVALID=()=>$localize`The direction of your move is invalid: a move is made along a straight line.`,Lr.CAN_ONLY_CAPTURE_YOUR_MARKERS=()=>$localize`You can only capture your own markers.`,Lr.SHOULD_SELECT_PLAYER_RING=()=>$localize`You must pick one of your own rings to move.`,Lr.SHOULD_END_MOVE_ON_EMPTY_SPACE=()=>$localize`Your ring must land on an empty space.`,Lr.MOVE_SHOULD_NOT_PASS_ABOVE_RING=()=>$localize`A ring can only jump over markers or empty spaces, not over another ring.`,Lr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS=()=>$localize`Your ring must land on the first empty space after a group of markers.`,Lr.AMBIGUOUS_CAPTURE_COORD=xc.AMBIGUOUS_CAPTURE_COORD,Lr.CAPTURE_SHOULD_TAKE_RING=()=>$localize`When you capture markers, you must take one of your ring as well by clicking on it.`;class wt{constructor(t,e){this.player=t,this.isRing=e}static of(t,e){return t===pe.NONE?wt.EMPTY:e?wt.RINGS[t.value]:wt.MARKERS[t.value]}equals(t){return this===t}flip(){return ye(!1===this.isRing,"cannot flip a ring (it should never happen)"),ye(this.player.isPlayer(),"cannot flip a non-player piece"),wt.of(this.player.getOpponent(),this.isRing)}toString(){switch(this){case wt.UNREACHABLE:return"NONE";case wt.EMPTY:return"EMPTY";case wt.MARKER_ZERO:return"MARKER_ZERO";case wt.MARKER_ONE:return"MARKER_ONE";case wt.RING_ZERO:return"RING_ZERO";default:return we.expectToBe(this,wt.RING_ONE),"RING_ONE"}}}wt.encoder=Cn.tuple([z.numberEncoder,Cn.booleanEncoder],n=>[n.player,n.isRing],n=>wt.of(n[0],n[1])),wt.UNREACHABLE=new wt(pe.NONE,!1),wt.EMPTY=new wt(pe.NONE,!1),wt.MARKER_ZERO=new wt(z.ZERO,!1),wt.MARKER_ONE=new wt(z.ONE,!1),wt.MARKERS=[wt.MARKER_ZERO,wt.MARKER_ONE],wt.RING_ZERO=new wt(z.ZERO,!0),wt.RING_ONE=new wt(z.ONE,!0),wt.RINGS=[wt.RING_ZERO,wt.RING_ONE];let Qa=(()=>{class n extends yH{constructor(e,r,s){super(s,e,n.SIZE,n.SIZE,[6,4,3,2,1],wt.EMPTY),this.sideRings=r}static getInitialState(){const e=wt.EMPTY,r=wt.UNREACHABLE;return new n([[r,r,r,r,r,r,e,e,e,e,r],[r,r,r,r,e,e,e,e,e,e,e],[r,r,r,e,e,e,e,e,e,e,e],[r,r,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,e],[r,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,e,r],[e,e,e,e,e,e,e,e,e,r,r],[e,e,e,e,e,e,e,e,r,r,r],[e,e,e,e,e,e,e,r,r,r,r],[r,e,e,e,e,r,r,r,r,r,r]],[5,5],0)}isInitialPlacementPhase(){return this.turn<10}countScores(){return this.turn<10?[0,0]:this.sideRings}equals(e){return this===e||this.turn===e.turn&&this.sideRings[0]===e.sideRings[0]&&this.sideRings[1]===e.sideRings[1]&&Ke.compareTable(this.board,e.board)}getRingCoords(e){const r=[];return this.forEachCoord((s,i)=>{i.isRing&&i.player===e&&r.push(s)}),r}isOnBoard(e){return!e.isNotInRange(this.width,this.height)&&this.board[e.y][e.x]!==wt.UNREACHABLE}setAtUnsafe(e,r){const s=Ke.copyBiArray(this.board);return s[e.y][e.x]=r,new n(s,this.sideRings,this.turn)}}return n.SIZE=11,n})();class ma extends yi{constructor(t,e){if(super(t),5!==t.length)throw new Error("YinshCapture must capture exactly 5 pieces");this.ringTaken=P.ofNullable(e)}static of(t,e,r){const s=[],i=ke.factory.fromMove(t,e).get();for(let o=t;!1===o.equals(e);o=o.getNext(i))s.push(o);return s.push(e),new ma(s,r)}setRingTaken(t){return new ma(this.capturedSpaces,t)}equals(t){return!(!1===super.equals(t)||!1===this.ringTaken.equals(t.ringTaken))}}ma.encoder=new class extends w4{encode(n){return{captured:n.capturedSpaces.map(t=>M.encoder.encode(t)),ringTaken:M.encoder.encode(n.ringTaken.get())}}decode(n){const t=n;return ye(null!=t.captured&&null!=t.ringTaken,"Invalid encoded YinshCapture"),new ma(t.captured.map(e=>M.encoder.decode(e)),M.encoder.decode(t.ringTaken))}};class Ja extends $i{constructor(t,e,r,s){super(),this.initialCaptures=t,this.start=e,this.end=r,this.finalCaptures=s}isInitialPlacement(){return this.end.isAbsent()}equals(t){return this===t||!(!1===this.start.equals(t.start)||!1===this.end.equals(t.end)||!1===Ke.compareArray(this.initialCaptures,t.initialCaptures)||!1===Ke.compareArray(this.finalCaptures,t.finalCaptures))}toString(){return"YinshMove(["+this.capturesToString(this.initialCaptures)+"], "+this.start.toString()+", "+this.end.toString()+", ["+this.capturesToString(this.finalCaptures)+"])"}capturesToString(t){let e="";for(const r of t)""!==e&&(e+=","),e+="["+r.toString()+"]";return e}}Ja.coordOptionalEncoder=P.getEncoder(M.encoder),Ja.encoder=new class extends M2{encodeMove(n){const t={moveStart:M.encoder.encode(n.start),moveEnd:Ja.coordOptionalEncoder.encode(n.end)};return n.initialCaptures.map((e,r)=>{t["initialCapture"+r]=ma.encoder.encode(e)}),n.finalCaptures.map((e,r)=>{t["finalCapture"+r]=ma.encoder.encode(e)}),t}decodeMove(n){const t=n;return ye(null!=t.moveStart,"Invalid encoded YinshMove"),new Ja(this.decodeArray(t,"initialCapture",ma.encoder.decode),M.encoder.decode(t.moveStart),Ja.coordOptionalEncoder.decode(t.moveEnd),this.decodeArray(t,"finalCapture",ma.encoder.decode))}decodeArray(n,t,e){const r=[];for(let s=0;null!=n[t+s];s++)r.push(e(n[t+s]));return r}};class U5t extends $1{getBoardValue(t){const e=this.ruler.getGameStatus(t);return e.isEndGame?Ct.fromWinner(e.winner):Ct.from(t.gameState.sideRings[0],t.gameState.sideRings[1])}getListMoves(t){const e=[],r=t.gameState;if(r.isInitialPlacementPhase())for(const[s,i]of r.getCoordsAndContents())i===wt.EMPTY&&e.push(new Ja([],s,P.empty(),[]));else{const s=this.ruler;this.getPossibleCaptureCombinations(r).forEach(i=>{const o=s.applyCaptures(i,r);this.getRingMoves(o).forEach(c=>{const u=s.applyRingMoveAndFlip(c.start,c.end,o);this.getPossibleCaptureCombinations(u).forEach(h=>{const p=new Ja(i,c.start,P.of(c.end),h);e.push(p)})})})}return e}getPossibleCaptureCombinations(t){const r=this.ruler.getPossibleCaptures(t),s=this.getRingCoords(t);return Dm.getPossibleCaptureCombinationsFromPossibleCaptures(r).map(i=>class $5t{static getCombinations(t,e){return ye(t.length>=e,"cannot compute combinations for less elements than needed"),this.getSubsetsOfSize(t,e).map(r=>this.getPermutations(r)).reduce((r,s)=>r.concat(s))}static getPermutations(t){const e=t.length,r=[t.slice()],s=new Array(e).fill(0);let i=1;for(;i<e;)if(s[i]<i){const o=i%2&&s[i],c=t[i];t[i]=t[o],t[o]=c,++s[i],i=1,r.push(t.slice())}else s[i]=0,++i;return r}static getSubsetsOfSize(t,e){return function r(s,i){if(i>=t.length||s<1)return[[]];{const o=[];for(;i<=t.length-s;){const c=t[i];for(const u of r(s-1,i+1))u.push(c),o.push(u);++i}return o}}(e,0)}}.getCombinations(s,i.length).map(o=>i.map((c,u)=>new ma(c.capturedSpaces,o[u])))).reduce((i,o)=>i.concat(o),[])}getRingMoves(t){const e=this.ruler,r=[];for(const s of this.getRingCoords(t))for(const i of e.getRingTargets(t,s))r.push({start:s,end:i});return r}getRingCoords(t){const e=t.getCurrentPlayer().value,r=[];return t.forEachCoord((s,i)=>{i===wt.RINGS[e]&&r.push(s)}),r}}class U3e extends Z1{applyLegalMove(t,e,r){return new Qa(r.board,r.sideRings,r.turn+1)}applyCaptures(t,e){let r=e;return t.forEach(s=>{r=this.applyCapture(s,r)}),r}applyCapture(t,e){const r=this.applyCaptureWithoutTakingRing(e,t);return this.takeRing(new Qa(r,e.sideRings,e.turn),t.ringTaken.get())}takeRing(t,e){const r=t.getCurrentPlayer().value,s=t.setAt(e,wt.EMPTY).board,i=[t.sideRings[0],t.sideRings[1]];return i[r]+=1,new Qa(s,i,t.turn)}applyCaptureWithoutTakingRing(t,e){return e.forEach(r=>{t=t.setAt(r,wt.EMPTY)}),t.board}ringSelectionValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)===wt.RINGS[r]?U.SUCCESS:U.failure(Lr.CAPTURE_SHOULD_TAKE_RING())}applyRingMoveAndFlip(t,e,r){const s=r.getCurrentPlayer().value;let i=r.setAt(t,wt.MARKERS[s]);i=i.setAt(e,wt.RINGS[s]);const o=ke.factory.fromMove(t,e).get();for(let c=t.getNext(o);!1===c.equals(e);c=c.getNext(o)){const u=i.getPieceAt(c);u!==wt.EMPTY&&(i=i.setAt(c,u.flip()))}return i}isLegal(t,e){if(t.isInitialPlacement())return this.initialPlacementValidity(e,t.start);if(e.isInitialPlacementPhase())return $.failure(Lr.NO_MARKERS_IN_INITIAL_PHASE());const r=this.capturesValidity(e,t.initialCaptures);if(r.isFailure())return r.toFailedFallible();const s=this.applyCaptures(t.initialCaptures,e),i=this.moveValidity(s,t.start,t.end.get());if(i.isFailure())return i.toFailedFallible();const o=this.applyRingMoveAndFlip(t.start,t.end.get(),s),c=this.capturesValidity(o,t.finalCaptures);if(c.isFailure())return c.toFailedFallible();const u=this.applyCaptures(t.finalCaptures,o),h=this.noMoreCapturesValidity(u);return h.isFailure()?h.toFailedFallible():$.success(u)}initialPlacementValidity(t,e){if(!0!==t.isInitialPlacementPhase())return $.failure(Lr.PLACEMENT_AFTER_INITIAL_PHASE());if(t.getPieceAt(e)!==wt.EMPTY)return $.failure(rt.MUST_CLICK_ON_EMPTY_SPACE());const r=t.getCurrentPlayer(),s=[t.sideRings[0],t.sideRings[1]];s[r.value]-=1;const i=t.setAt(e,wt.of(r,!0)).board,o=new Qa(i,s,t.turn);return $.success(o)}moveStartValidity(t,e){const r=t.getCurrentPlayer().value;return t.getPieceAt(e)!==wt.RINGS[r]?U.failure(Lr.SHOULD_SELECT_PLAYER_RING()):U.SUCCESS}moveValidity(t,e,r){const s=this.moveStartValidity(t,e);if(s.isFailure())return s;if(t.getPieceAt(r)!==wt.EMPTY)return U.failure(Lr.SHOULD_END_MOVE_ON_EMPTY_SPACE());const i=ke.factory.fromMove(e,r);if(i.isFailure())return U.failure(Lr.MOVE_DIRECTION_INVALID());const o=i.get();let c=!1;for(let u=e.getNext(o);!1===u.equals(r);u=u.getNext(o)){const h=t.getPieceAt(u);if(h===wt.EMPTY){if(c)return U.failure(Lr.MOVE_SHOULD_END_AT_FIRST_EMPTY_SPACE_AFTER_MARKERS())}else{if(h.isRing)return U.failure(Lr.MOVE_SHOULD_NOT_PASS_ABOVE_RING());c=!0}}return U.SUCCESS}capturesValidity(t,e){let r=t;for(const s of e){const i=this.captureValidity(r,s);if(i.isFailure())return i;r=this.applyCapture(s,r)}return U.SUCCESS}captureValidity(t,e){const r=t.getCurrentPlayer().value;for(const s of e.capturedSpaces)if(t.getPieceAt(s)!==wt.MARKERS[r])return U.failure(Lr.CAN_ONLY_CAPTURE_YOUR_MARKERS());return t.getPieceAt(e.ringTaken.get())!==wt.RINGS[r]?U.failure(Lr.CAPTURE_SHOULD_TAKE_RING()):U.SUCCESS}noMoreCapturesValidity(t){const e=t.getCurrentPlayer();return 0===this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).length?U.SUCCESS:U.failure(Lr.MISSING_CAPTURES())}getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e){const r=[];return t.allLines().forEach(s=>{const i=this.getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,s);i.isPresent()&&r.push(i.get())}),r}getLinePortionWithAtLeastFivePiecesOfPlayer(t,e,r){let s=0;const i=t.getEntranceOnLine(r),o=r.getDirection();let u,c=i;for(u=i;t.isOnBoard(u);u=u.getNext(o)){const h=t.getPieceAt(u);if(h.player===e&&!1===h.isRing)0===s&&(c=u),s+=1;else{if(s>=5)break;s=0}}return s>=5?P.of({start:c,end:u,dir:o}):P.empty()}getPossibleCaptures(t){const e=t.getCurrentPlayer(),r=[];return this.getLinePortionsWithAtLeastFivePiecesOfPlayer(t,e).forEach(s=>{for(let i=s.start;i.getDistance(s.end)>=5;i=i.getNext(s.dir))r.push(ma.of(i,i.getNext(s.dir,4)))}),r}getRingTargets(t,e){const r=[];for(const s of ke.factory.all){let i=!1;for(let o=e.getNext(s);t.isOnBoard(o);o=o.getNext(s)){const c=t.getPieceAt(o);if(c===wt.EMPTY){if(r.push(o),i)break}else{if(c.isRing)break;i=!0}}}return r}getGameStatus(t){return t.gameState.isInitialPlacementPhase()?xe.ONGOING:t.gameState.sideRings[0]>=3?xe.ZERO_WON:t.gameState.sideRings[1]>=3?xe.ONE_WON:xe.ONGOING}}const W=wt.EMPTY,Se=wt.UNREACHABLE,ji=wt.MARKER_ZERO,ro=wt.RING_ZERO,U4=wt.MARKER_ONE,Ti=wt.RING_ONE;let G3e=(()=>{class n{}return n.MUST_ALIGN_FIVE=()=>$localize`Failed! You need to align 5 markers of your color in order to get them, and to get a ring at the same time.`,n.MUST_CAPTURE_TWO=()=>$localize`Failed! You can capture two rings in total, by capturing two times 5 of your markers. Try again.`,n})();class W3e extends rr{constructor(){super(...arguments),this.tutorial=[ce.informational($localize`Goal of the game`,$localize`The goal at Yinsh is to capture three rings in total.
        The rings taken are shown on the top left for the dark player,
        and on the bottom right for the light player. Here, Dark won the game.
        Note that on the board you have two types of pieces for each player:
        rings (empty circles) and markers (full circles).`,new Qa([[Se,Se,Se,Se,Se,Se,W,W,W,W,Se],[Se,Se,Se,Se,W,W,W,W,W,W,W],[Se,Se,Se,ji,Ti,W,W,W,W,W,W],[Se,Se,W,ji,W,Ti,W,U4,W,W,W],[Se,W,ro,U4,W,W,Ti,ji,W,W,W],[Se,W,W,ji,U4,W,W,W,W,W,Se],[W,W,W,ji,W,W,W,Ti,W,W,Se],[W,W,W,U4,ji,ro,W,W,W,Se,Se],[W,W,W,W,W,W,W,W,Se,Se,Se],[W,W,W,W,W,W,W,Se,Se,Se,Se],[Se,W,W,W,W,Se,Se,Se,Se,Se,Se]],[3,1],20)),ce.anyMove($localize`Initial board and placement phase`,$localize`The initial board is empty.
        At the beginning of the game, each player puts one of its ring on the board at their turn.
        This phase stops when all rings have been placed on the board.<br/><br/>
        You're playing Dark, put one of your ring on the board by clicking the space where you want to place it.`,new Qa(Qa.getInitialState().board,[5,5],0),new Ja([],new M(5,5),P.empty(),[]),$localize`Congratulations!`),ce.anyMove($localize`Putting a marker`,$localize`Once the initial phase is done and all rings are on the board, you need to place markers on the board.
        To do so, put a marker in a ring by clicking on that ring.
        Then, the ring must be moved in a straight line, in any direction.
        A ring cannot pass through other rings during its move.
        If it goes over a group of markers, your move must stop at the first empty space after that group.
        All markers in the group are then flipped and their color change.<br/><br/>
        You're playing Dark, do a move.`,new Qa([[Se,Se,Se,Se,Se,Se,W,W,W,W,Se],[Se,Se,Se,Se,W,W,W,W,W,W,W],[Se,Se,Se,Ti,W,W,W,W,W,W,W],[Se,Se,Ti,W,W,Ti,W,W,W,W,W],[Se,W,ro,U4,W,W,Ti,W,W,W,W],[Se,W,W,U4,W,W,W,W,W,W,Se],[W,W,W,W,ro,W,W,Ti,W,W,Se],[W,W,W,W,W,ro,W,W,W,Se,Se],[W,W,W,ro,W,W,W,Se,Se,Se,Se],[W,W,W,W,W,W,W,Se,Se,Se,Se],[Se,W,W,W,W,Se,Se,Se,Se,Se,Se]],[0,0],20),new Ja([],new M(2,4),P.of(new M(4,4)),[]),$localize`Congratulations!`),ce.fromPredicate($localize`Getting a ring by aligning 5 markers`,$localize`Finally, the last mechanic you need is to be able to get a ring from the board in order to gain points.
        To do so, you need to align 5 markers of your color.
        You can then get these markers by clicking on them, and then get one of your ring by clicking on it.
        You will then have one more point.
        You must capture when you can.<br/><br/>
        You're playing Dark, perform a capture!`,new Qa([[Se,Se,Se,Se,Se,Se,W,W,W,W,Se],[Se,Se,Se,Se,W,W,W,W,W,W,W],[Se,Se,Se,Ti,W,W,W,W,W,W,W],[Se,Se,Ti,W,W,Ti,W,W,W,W,W],[Se,W,ji,ji,ro,U4,U4,W,W,W,W],[Se,W,W,Ti,W,W,W,W,W,W,Se],[W,W,W,W,ro,W,W,Ti,W,W,Se],[W,W,W,W,W,ro,W,W,W,Se,Se],[W,W,W,ro,W,W,W,ro,Se,Se,Se],[W,W,W,W,W,W,W,Se,Se,Se,Se],[Se,W,W,W,W,Se,Se,Se,Se,Se,Se]],[0,0],20),new Ja([],new M(4,4),P.of(new M(7,4)),[ma.of(new M(2,4),new M(6,4),new M(7,4))]),(t,e,r)=>1===r.sideRings[z.ZERO.value]?U.SUCCESS:U.failure(G3e.MUST_ALIGN_FIVE()),$localize`Congratulations!`),ce.fromPredicate($localize`Compound captures`,$localize`During a turn, you could have to choose between multiple captures,
        or you could even capture multiple times!
        During the capture selection, if you see that the marker you clicked belongs to two captures, you have to click on a second marker to avoid any ambiguity.<br/><br/>
        Here, playing Dark, you can capture two rings, do it!`,new Qa([[Se,Se,Se,Se,Se,Se,W,W,W,W,Se],[Se,Se,Se,Se,ro,W,W,Ti,Ti,ro,W],[Se,Se,Se,ro,W,W,U4,Ti,W,ro,W],[Se,Se,W,ro,W,W,W,W,W,Ti,W],[Se,W,W,W,W,ji,W,W,Ti,W,W],[Se,W,W,W,ji,ji,W,U4,W,W,Se],[W,W,W,ji,W,ji,W,W,W,W,Se],[W,W,ji,W,W,ji,W,W,W,Se,Se],[W,ji,W,W,W,ji,W,W,Se,Se,Se],[W,W,W,W,W,ji,W,Se,Se,Se,Se],[Se,W,W,W,W,Se,Se,Se,Se,Se,Se]],[0,0],10),new Ja([ma.of(new M(5,4),new M(1,8),new M(3,2)),ma.of(new M(5,9),new M(5,5),new M(3,3))],new M(4,1),P.of(new M(4,2)),[]),(t,e,r)=>2===r.sideRings[z.ZERO.value]?U.SUCCESS:U.failure(G3e.MUST_CAPTURE_TWO()),$localize`Congratulations!`)]}}function G5t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2).$implicit,r=v(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringOuterSize)}}function W5t(n,t){if(1&n&&(B(),X(0,"circle",13)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","ring_",r,"_",i,""),T("ngClass",s.ringClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.ringMidSize)}}function q5t(n,t){if(1&n&&(B(),X(0,"circle",12)),2&n){const e=v(2).$implicit,r=v(2);D("cx",e.center.x)("cy",e.center.y)("r",r.viewInfo.ringInnerSize)}}function j5t(n,t){if(1&n&&(B(),X(0,"circle",14)),2&n){const e=v(2),r=e.index,s=e.$implicit,i=v().index,o=v();We("id","marker_",r,"_",i,""),T("ngClass",s.markerClasses),D("cx",s.center.x)("cy",s.center.y)("r",o.viewInfo.markerSize)}}function Z5t(n,t){if(1&n){const e=Oe();B(),b(0,"g",6),J("click",function(){fe(e);const s=v().$implicit;return ae(v(2).onClick(s.coord))}),X(1,"polygon",7),b(2,"g",8),x(3,G5t,1,3,"circle",9),x(4,W5t,1,6,"circle",10),x(5,q5t,1,3,"circle",9),x(6,j5t,1,6,"circle",11),O()()}if(2&n){const e=v(),r=e.index,s=e.$implicit,i=v().index;We("id","click_",r,"_",i,""),S(1),We("id","space_",r,"_",i,""),T("ngClass",s.spaceClasses),D("points",s.coordinates),S(1),We("id","pieceGroup_",r,"_",i,""),T("ngClass",s.removedClass),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isRing),S(1),T("ngIf",s.isMarker)}}function Y5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,Z5t,7,13,"g",5),O()),2&n){const e=t.$implicit;S(1),T("ngIf",null!=e)}}function K5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,Y5t,2,1,"g",1),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}function X5t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",15),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","selected_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function Q5t(n,t){if(1&n){const e=Oe();B(),b(0,"polygon",17),J("click",function(){const i=fe(e).$implicit;return ae(v(2).onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v(2);We("id","selectable_",e.x,"_",e.y,""),D("points",r.viewInfo.spaceInfo[e.y][e.x].coordinates)}}function J5t(n,t){if(1&n&&(B(),b(0,"g"),x(1,Q5t,1,3,"polygon",16),O()),2&n){const e=v();S(1),T("ngForOf",e.viewInfo.selectableCoords)}}function e7t(n,t){if(1&n){const e=Oe();B(),b(0,"rect",18),J("click",function(){const i=fe(e).$implicit;return ae(v().onClick(i))}),O()}if(2&n){const e=t.$implicit,r=v();We("id","indicator_",e.x,"_",e.y,""),D("x",r.viewInfo.spaceInfo[e.y][e.x].center.x-r.viewInfo.indicatorSize/2)("y",r.viewInfo.spaceInfo[e.y][e.x].center.y-r.viewInfo.indicatorSize/2)("width",r.viewInfo.indicatorSize)("height",r.viewInfo.indicatorSize)}}function t7t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",19)(2,"circle",12)(3,"circle",20),O()),2&n){const e=t.index,r=v().$implicit,s=v();S(1),We("id","player_",r.value,"_sideRing_",e+1,""),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringOuterSize),S(1),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringInnerSize),S(1),T("ngClass",s.viewInfo.sideRingClass[r.value]),D("cx",(0===r.value?15:1050)+1.2*(0===r.value?1:-1)*s.viewInfo.ringOuterSize*(e+1))("cy",0===r.value?300:1260)("r",s.viewInfo.ringMidSize)}}const n7t=function(){return[]};function r7t(n,t){if(1&n&&(B(),b(0,"g"),x(1,t7t,4,12,"g",1),O()),2&n){const e=t.$implicit,r=v();D("transform","rotate("+180*(r.role.value+1)+" 532.5 780)"),S(1),T("ngForOf",tr(2,n7t).constructor(r.viewInfo.sideRings[e.value]))}}class wi extends p9{constructor(t){super(t),this.movePhase="MOVE_START",this.moveStart=P.empty(),this.moveEnd=P.empty(),this.currentlyMoved=[],this.currentCapture=P.empty(),this.initialCaptures=[],this.finalCaptures=[],this.possibleCaptures=[],this.viewInfo={spaceInfo:[],selectableCoords:[],selectedCoords:[],targets:[],markerSize:wi.MARKER_SIZE,ringOuterSize:wi.RING_OUTER_SIZE,ringMidSize:wi.RING_MID_SIZE,ringInnerSize:wi.RING_INNER_SIZE,indicatorSize:wi.INDICATOR_SIZE,sideRings:[5,5],sideRingClass:["player0-stroke","player1-stroke"]},this.scores=P.of([0,0]),this.rules=new U3e(Qa),this.availableMinimaxes=[new U5t(this.rules,"YinshMinimax")],this.encoder=Ja.encoder,this.tutorial=(new W3e).tutorial,this.hexaLayout=new g9(1.5*wi.RING_OUTER_SIZE,new M(2*wi.RING_OUTER_SIZE,0),Ns.INSTANCE),this.constructedState=this.getState(),this.constructedState.allCoords().forEach(e=>{null==this.viewInfo.spaceInfo[e.y]&&(this.viewInfo.spaceInfo[e.y]=[]),this.viewInfo.spaceInfo[e.y][e.x]={coord:e,coordinates:this.getHexaPointsAt(e),center:this.getCenterAt(e),spaceClasses:[],markerClasses:[],ringClasses:[],isMarker:!1,isRing:!1,removedClass:""}})}updateBoard(){this.cancelMoveAttempt();const t=this.getState();this.scores=P.of(t.countScores())}updateViewInfo(){this.constructedState.allCoords().forEach(t=>{this.viewInfo.spaceInfo[t.y][t.x].spaceClasses=this.getSpaceClasses(t);const e=this.constructedState.getPieceAt(t);this.viewInfo.spaceInfo[t.y][t.x].removedClass="",this.setRingInfo(t,e),this.setMarkerInfo(t,e)});for(const t of z.PLAYERS)this.viewInfo.sideRings[t.value]=this.constructedState.sideRings[t.value];switch(this.showCurrentMoveCaptures(),this.showLastMove(),this.viewInfo.targets=[],this.viewInfo.selectableCoords=[],this.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_LAST":this.viewInfo.selectableCoords=[];for(const t of this.possibleCaptures)for(const e of t.capturedSpaces)this.viewInfo.selectableCoords.push(e);break;case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer());break;case"MOVE_START":!1===this.getState().isInitialPlacementPhase()&&(this.viewInfo.selectableCoords=this.constructedState.getRingCoords(this.constructedState.getCurrentPlayer()));break;case"MOVE_END":this.viewInfo.targets=this.rules.getRingTargets(this.constructedState,this.moveStart.get())}}showCurrentMoveCaptures(){this.currentCapture.isPresent()&&this.markCurrentCapture(this.currentCapture.get());for(const t of this.initialCaptures)this.markCurrentCapture(t);for(const t of this.finalCaptures)this.markCurrentCapture(t)}getSpaceClasses(t){return this.currentlyMoved.some(e=>e.equals(t))?["moved-fill"]:[]}setRingInfo(t,e){e.isRing?(this.viewInfo.spaceInfo[t.y][t.x].isRing=!0,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=["player"+e.player.value+"-stroke"]):(this.viewInfo.spaceInfo[t.y][t.x].isRing=!1,this.viewInfo.spaceInfo[t.y][t.x].ringClasses=[])}setMarkerInfo(t,e){if(this.viewInfo.spaceInfo[t.y][t.x].isMarker=!1,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[],e!==wt.EMPTY&&(!e.isRing||this.moveStart.equalsValue(t))){const s=this.getPlayerClass(e.player);this.viewInfo.spaceInfo[t.y][t.x].isMarker=!0,this.viewInfo.spaceInfo[t.y][t.x].markerClasses=[s]}}cancelMoveAttempt(){this.constructedState=this.getState(),this.possibleCaptures=[],this.initialCaptures=[],this.finalCaptures=[],this.viewInfo.selectedCoords=[],this.currentCapture=P.empty(),this.moveStart=P.empty(),this.moveEnd=P.empty(),this.currentlyMoved=[],this.moveToInitialCaptureOrMovePhase()}showLastMove(){const t=this.rules.node.move;if(t.isPresent()){const e=t.get();if(e.isInitialPlacement())this.viewInfo.spaceInfo[e.start.y][e.start.x].spaceClasses=["moved-fill"];else{for(const s of this.coordsBetween(e.start,e.end.get()))this.viewInfo.spaceInfo[s.y][s.x].spaceClasses=["moved-fill"];const r=this.currentCapture.isAbsent()&&0===this.initialCaptures.length&&this.moveStart.isAbsent();e.initialCaptures.forEach(s=>this.showLastMoveCapture(s,r)),e.finalCaptures.forEach(s=>this.showLastMoveCapture(s,r))}}}coordsBetween(t,e){const r=[],s=ke.factory.fromMove(t,e).get();for(let i=t;!i.equals(e);i=i.getNext(s))this.constructedState.getPieceAt(i)!==wt.EMPTY&&r.push(i),r.push(e);return r}showLastMoveCapture(t,e){for(const r of t.capturedSpaces)this.viewInfo.spaceInfo[r.y][r.x].spaceClasses=["captured-fill"],e&&this.markRemovedMarker(r,this.getState().getCurrentPlayer().getOpponent());this.viewInfo.spaceInfo[t.ringTaken.get().y][t.ringTaken.get().x].spaceClasses=["captured-fill"],e&&this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer().getOpponent())}moveToInitialCaptureOrMovePhase(){return this.possibleCaptures=this.rules.getPossibleCaptures(this.constructedState),this.movePhase=0===this.possibleCaptures.length?"MOVE_START":"INITIAL_CAPTURE_SELECT_FIRST",this.updateViewInfo(),U.SUCCESS}onClick(t){var e=this;return A(function*(){const r=e.canUserPlay("#click_"+t.x+"_"+t.y);if(r.isFailure())return e.cancelMove(r.getReason());switch(e.movePhase){case"INITIAL_CAPTURE_SELECT_FIRST":case"FINAL_CAPTURE_SELECT_FIRST":return e.selectCaptureFirstCoord(t);case"INITIAL_CAPTURE_SELECT_LAST":case"FINAL_CAPTURE_SELECT_LAST":return e.selectCaptureLastCoord(t);case"INITIAL_CAPTURE_SELECT_RING":case"FINAL_CAPTURE_SELECT_RING":return e.selectRing(t);case"MOVE_START":return e.selectMoveStart(t);case"MOVE_END":return e.selectMoveEnd(t)}})()}selectCaptureFirstCoord(t){var e=this;return A(function*(){const r=[];if(e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1)e.viewInfo.selectedCoords.push(t),e.moveToCaptureSelectLast(r);else{if(0===r.length)return e.cancelMove(Lr.MISSING_CAPTURES());e.selectCapture(r[0])}return U.SUCCESS})()}moveToCaptureSelectLast(t){this.viewInfo.selectableCoords=[],this.possibleCaptures=t;for(const e of t)for(const r of e.capturedSpaces)this.viewInfo.selectableCoords.push(r);"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_LAST":(we.expectToBe(this.movePhase,"FINAL_CAPTURE_SELECT_FIRST","moveToCaptureSelectLast did not expect to be called in movePhase"+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_LAST")}selectCaptureLastCoord(t){var e=this;return A(function*(){const r=[];return e.possibleCaptures.forEach(s=>{s.contains(t)&&r.push(s)}),r.length>1?e.cancelMove(Lr.AMBIGUOUS_CAPTURE_COORD()):0===r.length?e.cancelMove(Lr.MISSING_CAPTURES()):e.selectCapture(r[0])})()}selectCapture(t){return this.currentCapture=P.of(t),this.constructedState=new Qa(this.rules.applyCaptureWithoutTakingRing(this.constructedState,t),this.constructedState.sideRings,this.constructedState.turn),"INITIAL_CAPTURE_SELECT_FIRST"===this.movePhase||"INITIAL_CAPTURE_SELECT_LAST"===this.movePhase?this.movePhase="INITIAL_CAPTURE_SELECT_RING":(ye("FINAL_CAPTURE_SELECT_FIRST"===this.movePhase||"FINAL_CAPTURE_SELECT_LAST"===this.movePhase,"selectCapture did not expect to be called in movePhase "+this.movePhase),this.movePhase="FINAL_CAPTURE_SELECT_RING"),this.updateViewInfo(),U.SUCCESS}markCurrentCapture(t){for(const e of t.capturedSpaces)this.viewInfo.selectedCoords.push(e),this.markRemovedMarker(e,this.getState().getCurrentPlayer());t.ringTaken.isPresent()&&(this.viewInfo.selectedCoords.push(t.ringTaken.get()),this.markRemovedRing(t.ringTaken.get(),this.getState().getCurrentPlayer()))}markRemovedMarker(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setMarkerInfo(t,wt.MARKERS[e.value])}markRemovedRing(t,e){this.viewInfo.spaceInfo[t.y][t.x].removedClass="semi-transparent",this.setRingInfo(t,wt.RINGS[e.value])}selectRing(t){var e=this;return A(function*(){const r=e.rules.ringSelectionValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.constructedState=e.rules.takeRing(e.constructedState,t);const s=e.currentCapture.get().setRingTaken(t);return"INITIAL_CAPTURE_SELECT_RING"===(e.currentCapture=P.empty(),e.possibleCaptures=e.rules.getPossibleCaptures(e.constructedState),e.movePhase)?(e.initialCaptures.push(s),0===e.possibleCaptures.length?e.moveToMovePhase():(e.movePhase="INITIAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),U.SUCCESS)):(we.expectToBe(e.movePhase,"FINAL_CAPTURE_SELECT_RING"),e.finalCaptures.push(s),0===e.possibleCaptures.length?e.tryMove():(e.movePhase="FINAL_CAPTURE_SELECT_FIRST",e.updateViewInfo(),U.SUCCESS))})()}moveToMovePhase(){return this.movePhase="MOVE_START",this.updateViewInfo(),U.SUCCESS}tryMove(){var t=this;return A(function*(){const e=new Ja(t.initialCaptures,t.moveStart.get(),t.moveEnd,t.finalCaptures);return yield t.chooseMove(e,t.getState(),t.scores.get())})()}selectMoveStart(t){var e=this;return A(function*(){if(e.constructedState.isInitialPlacementPhase()){const r=e.rules.initialPlacementValidity(e.constructedState,t);return r.isFailure()?e.cancelMove(r.getReason()):(e.moveStart=P.of(t),e.tryMove())}{const r=e.rules.moveStartValidity(e.constructedState,t);if(r.isFailure())return e.cancelMove(r.getReason());e.moveStart=P.of(t),e.movePhase="MOVE_END",e.updateViewInfo()}return U.SUCCESS})()}selectMoveEnd(t){var e=this;return A(function*(){if(e.moveStart.equalsValue(t))return e.cancelMoveAttempt(),U.SUCCESS;const r=wt.RINGS[e.getState().getCurrentPlayer().value];if(e.constructedState.getPieceAt(t)===r)return e.cancelMoveAttempt(),e.selectMoveStart(t);const s=e.rules.moveValidity(e.constructedState,e.moveStart.get(),t);return s.isFailure()?e.cancelMove(s.getReason()):(e.moveEnd=P.of(t),e.currentlyMoved=e.coordsBetween(e.moveStart.get(),t),e.constructedState=e.rules.applyRingMoveAndFlip(e.moveStart.get(),t,e.constructedState),e.updateViewInfo(),e.moveToFinalCapturePhaseOrTryMove())})()}moveToFinalCapturePhaseOrTryMove(){var t=this;return A(function*(){return t.possibleCaptures=t.rules.getPossibleCaptures(t.constructedState),0===t.possibleCaptures.length?t.tryMove():(t.movePhase="FINAL_CAPTURE_SELECT_FIRST",t.updateViewInfo(),U.SUCCESS)})()}}function s7t(n,t){if(1&n&&(b(0,"option",5),Pt(1),O()),2&n){const e=t.$implicit;T("value",e.urlName),S(1),a1(e.name)}}wi.RING_OUTER_SIZE=40,wi.RING_MID_SIZE=34,wi.RING_INNER_SIZE=28,wi.MARKER_SIZE=wi.RING_INNER_SIZE,wi.INDICATOR_SIZE=10,wi.\u0275fac=function(t){return new(t||wi)(Q(Tn))},wi.\u0275cmp=gt({type:wi,selectors:[["app-yinsh"]],features:[l],decls:6,vars:5,consts:[["xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","viewBox","0 250 1065 1060","preserveAspectRatio","xMidYMid meet"],[4,"ngFor","ngForOf"],["class","base no-fill selected-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","indicator",3,"id","click",4,"ngFor","ngForOf"],[3,"id","click",4,"ngIf"],[3,"id","click"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[3,"id","ngClass"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base no-fill",3,"id","ngClass",4,"ngIf"],["class","base mid-stroke",3,"id","ngClass",4,"ngIf"],[1,"base","no-fill","mid-stroke"],[1,"base","no-fill",3,"id","ngClass"],[1,"base","mid-stroke",3,"id","ngClass"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","selected-stroke",3,"id","click"],["class","base no-fill capturable-stroke","pointer-events","fill","stroke-linecap","round",3,"id","click",4,"ngFor","ngForOf"],["pointer-events","fill","stroke-linecap","round",1,"base","no-fill","capturable-stroke",3,"id","click"],[1,"indicator",3,"id","click"],[1,"base","no-fill","mid-stroke",3,"id"],[1,"base","no-fill",3,"ngClass"]],template:function(t,e){1&t&&(B(),b(0,"svg",0),x(1,K5t,2,1,"g",1),x(2,X5t,1,3,"polygon",2),x(3,J5t,2,1,"g",3),x(4,e7t,1,6,"rect",4),x(5,r7t,2,3,"g",1),O()),2&t&&(S(1),T("ngForOf",e.viewInfo.spaceInfo),S(1),T("ngForOf",e.viewInfo.selectedCoords),S(1),T("ngIf",e.isPlayerTurn()),S(1),T("ngForOf",e.viewInfo.targets),S(1),T("ngForOf",e.Player.PLAYERS))},dependencies:[mn,Ln,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});let L1=(()=>{class n{}return n.ABALONE=()=>$localize`Use simple mechanics to push 6 of the opponent's pieces out of the board!`,n.APAGOS=()=>$localize`Very simple game, but, will you be able to win everytime?`,n.AWALE=()=>$localize`The international version of the famous African strategy game!`,n.BRANDHUB=()=>$localize`The Irish version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.COERCEO=()=>$localize`Get rid of all of your opponent's pieces on a board that shrinks little by little!`,n.CONSPIRATEURS=()=>$localize`Hide all of your pieces before your opponent does, or risk to be discovered!`,n.DIAM=()=>$localize`Drop your pieces and move them around to align two pieces of the same color across the board to win!`,n.DVONN=()=>$localize`Stack your pieces and control as many stacks as you can to win!`,n.ENCAPSULE=()=>$localize`An enhanced tic-tac-toe where piece can encapsule other and prevent them to win.`,n.EPAMINONDAS=()=>$localize`An antiquity-war inspired game. Be the first to pierce your opponent's lines!`,n.GIPF=()=>$localize`A hexagonal game of alignment. Insert your pieces on the board to capture your opponent's pieces!`,n.GO=()=>$localize`The oldest strategy game still practiced widely. A territory control game.`,n.HIVE=()=>$localize`You are in charge of a hive full of insects. Use the abilities of your insects to block the opponent's queen in order to win!`,n.HNEFATAFL=()=>$localize`The Viking board game! Invaders must capture the king, defender must make him escape!`,n.KAMISADO=()=>$localize`Your goal is simple: reach the last line. But the piece you move depends on your opponent's last move!`,n.LASCA=()=>$localize`Similar to checkers, capture opponent's pieces, free your own, and immobilize your opponent to win the game!`,n.LINES_OF_ACTION=()=>$localize`Regroup your pieces to win. But your possible moves will often change!`,n.LODESTONE=()=>$localize`Push and crush your opponent's pieces using magnetic forces!`,n.MARTIAN_CHESS=()=>$localize`Win points by capturing pieces, but you only control pieces on your side of the board!`,n.P4=()=>$localize`The classical 4 in a row game!`,n.PENTAGO=()=>$localize`Drop a piece, then rotate a quadrant. The first player to align 5 pieces wins!`,n.PYLOS=()=>$localize`Overlay your pieces and use two game mechanics to conserve your pieces. First player to run out of pieces loses!`,n.QUARTO=()=>$localize`Create a winning alignment. The problem: you don't pick the piece that you're placing on the board!`,n.QUIXO=()=>$localize`Align 5 of your pieces on a board where pieces slide!`,n.REVERSI=()=>$localize`Sandwich your opponent's pieces to dominate the board!`,n.SAHARA=()=>$localize`Immobilize one of your opponent's pyramids before your opponent does!`,n.SIAM=()=>$localize`Be the first to push a mountain out of the board!`,n.SIX=()=>$localize`Put your hexagonal pieces next to another one, and create one of the 3 victorious shapes to win!`,n.TABLUT=()=>$localize`Lapland version of the Tafl game family! Invaders must capture the king, defender must make him escape!`,n.TREXO=()=>$localize`Align 5 pieces of your color in a row, but beware, the pieces can be put on top of other pieces!`,n.YINSH=()=>$localize`Align your pieces to score points, but beware, pieces can flip!`,n})(),L9=(()=>{class n{constructor(e,r,s,i,o,c,u,h=!0){this.name=e,this.urlName=r,this.component=s,this.tutorial=i,this.rules=o,this.creationDate=c,this.description=u,this.display=h}}return n.ALL_GAMES=()=>[new n($localize`Four in a Row`,"P4",i8t,new _3e,new kr(c6),new Date("2018-08-28"),L1.P4()),new n($localize`Awalé`,"Awale",l4t,new Rce,new A4(Q2),new Date("2018-11-29"),L1.AWALE()),new n($localize`Quarto`,"Quarto",iut,new O3e,new ei(Vc),new Date("2018-12-09"),L1.QUARTO()),new n($localize`Tablut`,"Tablut",C5t,new V3e,M5.get(),new Date("2018-12-27"),L1.TABLUT()),new n($localize`Reversi`,"Reversi",_ut,new I3e,new Zm(W1),new Date("2019-01-16"),L1.REVERSI()),new n($localize`Go`,"Go",c6t,new Jce,new I3(Is),new Date("2019-12-21"),L1.GO()),new n($localize`Encapsule`,"Encapsule",xlt,new Yce,new Nc(s6),new Date("2019-12-30"),L1.ENCAPSULE()),new n($localize`Siam`,"Siam",Zut,new D3e,w1.get(),new Date("2020-01-11"),L1.SIAM()),new n($localize`Sahara`,"Sahara",Aut,new x3e,new N9(Pi),new Date("2020-02-29"),L1.SAHARA()),new n($localize`Pylos`,"Pylos",O8t,new P3e,new Vo(zc),new Date("2020-10-02"),L1.PYLOS()),new n($localize`Kamisado`,"Kamisado",e0t,new o3e,new Lo(k3),new Date("2020-10-03"),L1.KAMISADO()),new n($localize`Quixo`,"Quixo",hut,new N3e,new Ho(o8),new Date("2020-10-15"),L1.QUIXO()),new n($localize`Dvonn`,"Dvonn",ylt,new Wce,new Ci(qa),new Date("2020-10-21"),L1.DVONN()),new n($localize`Epaminondas`,"Epaminondas",Hlt,new Kce,new n8(A3),new Date("2021-01-16"),L1.EPAMINONDAS()),new n($localize`Gipf`,"Gipf",Zlt,new Qce,new $n(Za),new Date("2021-02-22"),L1.GIPF()),new n($localize`Coerceo`,"Coerceo",$4t,new Uce,new gP(T1),new Date("2021-03-21"),L1.COERCEO()),new n($localize`Six`,"Six",o5t,new z3e,new H3(Wi),new Date("2021-04-08"),L1.SIX()),new n($localize`Lines of Action`,"LinesOfAction",g0t,new u3e,new J2(Js),new Date("2021-04-28"),L1.LINES_OF_ACTION()),new n($localize`Pentago`,"Pentago",p8t,new C3e,new L3(L2),new Date("2021-05-23"),L1.PENTAGO()),new n($localize`Abalone`,"Abalone",K3t,new Lce,new P3(n6),new Date("2021-07-13"),L1.ABALONE()),new n($localize`Yinsh`,"Yinsh",wi,new W3e,new U3e(Qa),new Date("2021-07-31"),L1.YINSH()),new n($localize`Apagos`,"Apagos",s4t,new Ace,N4.get(),new Date("2021-11-04"),L1.APAGOS()),new n($localize`Diam`,"Diam",N3,new Fce,O3.get(),new Date("2021-11-30"),L1.DIAM()),new n($localize`Brandhub`,"Brandhub",S4t,new zce,m5.get(),new Date("2021-12-07"),L1.BRANDHUB()),new n($localize`Conspirateurs`,"Conspirateurs",Q4t,new Vce,Ga.get(),new Date("2021-12-30"),L1.CONSPIRATEURS()),new n($localize`Lodestone`,"Lodestone",x2,new f3e,I2.get(),new Date("2022-06-24"),L1.LODESTONE()),new n($localize`Martian Chess`,"MartianChess",zo,new g3e,new T9(Ls),new Date("2022-07-01"),L1.MARTIAN_CHESS()),new n($localize`Hnefatafl`,"Hnefatafl",q6t,new i3e,y5.get(),new Date("2022-09-21"),L1.HNEFATAFL()),new n($localize`Hive`,"Hive",k6t,new r3e,Mi.get(),new Date("2023-04-02"),L1.HIVE()),new n($localize`Trexo`,"Trexo",u1,new B3e,qi.get(),new Date("2023-04-23"),L1.TREXO()),new n($localize`Lasca`,"Lasca",l0t,new l3e,R4.get(),new Date("2023-05-11"),L1.LASCA())].sort((t,e)=>t.name.localeCompare(e.name)),n})(),HH=(()=>{class n{constructor(){this.games=L9.ALL_GAMES(),this.pickGame=new gr}onChange(e){this.pickGame.emit(e.target.value)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-pick-game"]],outputs:{pickGame:"pickGame"},decls:5,vars:1,consts:function(){let t;return t=$localize`Pick a game`,[[1,"select","is-primary","is-fullwidth"],["id","gameType",3,"change"],["value","","selected",""],t,[3,"value",4,"ngFor","ngForOf"],[3,"value"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"select",1),J("change",function(i){return r.onChange(i)}),b(2,"option",2),me(3,3),O(),x(4,s7t,2,2,"option",4),O()()),2&e&&(S(4),T("ngForOf",r.games))},dependencies:[Ln,vp,Cp],encapsulation:2}),n})();function i7t(n,t){if(1&n){const e=Oe();b(0,"div",26)(1,"div",27),J("click",function(){return fe(e),ae(v().closeInfo())}),O(),b(2,"div",28)(3,"header",29)(4,"p",30),Pt(5),O(),b(6,"button",31),J("click",function(){return fe(e),ae(v().closeInfo())}),O()(),b(7,"section",32)(8,"div",6)(9,"div",33)(10,"p",34),X(11,"img",35),O()(),b(12,"div",7)(13,"div",13),Pt(14),O()()(),b(15,"div",6)(16,"div",33)(17,"a",36),J("click",function(){fe(e);const s=v();return ae(s.createGame(s.gameInfoDetails.get().urlName))}),X(18,"fa-icon",37),Pt(19,"\xa0"),b(20,"span"),me(21,38),O()()(),b(22,"div",33)(23,"a",36),J("click",function(){fe(e);const s=v();return ae(s.createLocalGame(s.gameInfoDetails.get().urlName))}),X(24,"fa-icon",37),Pt(25,"\xa0"),b(26,"span"),me(27,39),O()()(),b(28,"div",33)(29,"a",36),J("click",function(){fe(e);const s=v();return ae(s.createTutorial(s.gameInfoDetails.get().urlName))}),X(30,"fa-icon",37),Pt(31,"\xa0"),b(32,"span"),me(33,40),O()()()()()()()}if(2&n){const e=v();S(5),a1(e.gameInfoDetails.get().name),S(6),We("src","assets/images/",e.theme,"/",e.gameInfoDetails.get().urlName,".png",i3),S(3),W2(" ",e.gameInfoDetails.get().description," "),S(4),T("icon",e.iconOnlineGame),S(6),T("icon",e.iconLocalGame),S(6),T("icon",e.iconTutorial)}}function o7t(n,t){if(1&n){const e=Oe();b(0,"div",8)(1,"div",9)(2,"p",10),Pt(3),O()(),b(4,"div",42)(5,"figure",34)(6,"img",43),J("click",function(){const i=fe(e).$implicit;return ae(v(2).openInfo(i))}),O(),b(7,"figcaption",44),J("click",function(){const i=fe(e).$implicit;return ae(v(2).openInfo(i))}),b(8,"div",45),Pt(9,"?"),O()(),b(10,"figcaption",46)(11,"a",47),J("click",function(){const i=fe(e).$implicit;return ae(v(2).createGame(i.urlName))}),X(12,"fa-icon",37),O(),b(13,"a",48),J("click",function(){const i=fe(e).$implicit;return ae(v(2).createLocalGame(i.urlName))}),X(14,"fa-icon",37),O(),b(15,"a",49),J("click",function(){const i=fe(e).$implicit;return ae(v(2).createTutorial(i.urlName))}),X(16,"fa-icon",37),O()()()(),b(17,"div",50),Pt(18),O()()}if(2&n){const e=t.$implicit,r=v(2);S(3),a1(e.name),S(3),C1("id","image_",e.urlName,""),We("src","assets/images/",r.theme,"/",e.urlName,".png",i3),S(5),C1("id","playOnline_",e.urlName,""),S(1),T("icon",r.iconOnlineGame),S(1),C1("id","playLocally_",e.urlName,""),S(1),T("icon",r.iconLocalGame),S(1),C1("id","startTutorial_",e.urlName,""),S(1),T("icon",r.iconTutorial),S(2),W2(" ",e.description," ")}}function a7t(n,t){if(1&n&&(b(0,"div",7),x(1,o7t,19,11,"div",41),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let c7t=(()=>{class n{constructor(e,r,s,i){this.router=e,this.messageDisplayer=r,this.observedPartService=s,this.numberOfColumns=5,this.games=[],this.iconOnlineGame=J2e,this.iconLocalGame=rH,this.iconTutorial=tce,this.gameInfoDetails=P.empty(),this.theme=i.getTheme();const o=L9.ALL_GAMES();let c=0;for(let u=0;u<o.length;u++)u<this.numberOfColumns&&this.games.push([]),this.games[c].push(o[u]),c=(c+1)%this.numberOfColumns}createGame(e){var r=this;return A(function*(){const s=r.observedPartService.canUserCreate();return s.isSuccess()?r.router.navigate(null==e?["/play"]:["/play",e]):(r.messageDisplayer.criticalMessage(s.getReason()),!1)})()}createLocalGame(e){var r=this;return A(function*(){return r.router.navigate(["/local",e])})()}createTutorial(e){return this.router.navigate(["/tutorial",e])}openInfo(e){this.gameInfoDetails=P.of(e)}closeInfo(){this.gameInfoDetails=P.empty()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Tn),Q(w2),Q(PS))},n.\u0275cmp=gt({type:n,selectors:[["app-welcome"]],decls:33,vars:2,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I;return t=$localize`EveryBoard`,e=$localize`EveryBoard is a website to play and learn the rules of various abstract strategy games with perfect information.${"\ufffd#6\ufffd\ufffd/#6\ufffd"}:LINE_BREAK: Such games are games that do not include any randomness, agility, or hidden information. These games are played by two players, turn by turn.`,r=$localize`Play online`,s=$localize`Create an online game`,i=$localize`See the game list`,o=$localize`Play offline`,c=$localize`Play`,u=$localize`Learn`,h=$localize`Play online`,p=$localize`Play offline`,m=$localize`Learn the rules`,C=$localize`Play online`,w=$localize`Play offline`,I=$localize`Learn the rules`,[[1,"hero"],[1,"hero-body"],[1,"title"],t,[1,"subtitle"],e,[1,"columns"],[1,"column"],[1,"card"],[1,"card-header"],[1,"card-header-title"],r,[1,"card-content"],[1,"content"],["id","createOnlineGame",1,"button","is-medium","is-fullwidth","is-primary","mb-1",3,"click"],s,["id","seeGameList","routerLink","/lobby",1,"button","is-medium","is-fullwidth","is-primary"],i,o,[1,"content","has-text-centered"],["routerLink","/local",1,"button","is-medium","is-fullwidth","is-primary","mb-1"],c,["routerLink","/tutorial",1,"button","is-medium","is-fullwidth","is-primary"],u,["id","gameInfoModal","class","modal is-active",4,"ngIf"],["class","column",4,"ngFor","ngForOf"],["id","gameInfoModal",1,"modal","is-active"],["id","modalBackground",1,"modal-background",3,"click"],[1,"modal-card"],[1,"modal-card-head","is-primary"],[1,"modal-card-title"],["id","closeInfo","aria-label","close",1,"delete",3,"click"],[1,"modal-card-body"],[1,"column","is-one-third"],[1,"image"],[3,"src"],[1,"button","is-fullwidth",3,"click"],[3,"icon"],h,p,m,["class","card",4,"ngFor","ngForOf"],[1,"card-image","game-card"],[1,"is-clickable",3,"id","src","click"],[1,"has-text-centered","is-overlay","game-image-text","is-clickable",3,"click"],[1,"is-size-1","has-text-weight-bold"],[1,"has-text-centered","is-overlay","game-image-buttons"],["data-tooltip",C,1,"button",3,"id","click"],["data-tooltip",w,1,"button",3,"id","click"],["data-tooltip",I,1,"button",3,"id","click"],[1,"card-content","is-hidden"]]},template:function(e,r){1&e&&(b(0,"section",0)(1,"div",1)(2,"p",2),me(3,3),O(),b(4,"p",4),gc(5,5),X(6,"br"),mc(),O()(),b(7,"div",6)(8,"div",7)(9,"div",8)(10,"header",9)(11,"p",10),me(12,11),O()(),b(13,"div",12)(14,"div",13)(15,"button",14),J("click",function(){return r.createGame()}),me(16,15),O(),b(17,"button",16),me(18,17),O()()()()(),b(19,"div",7)(20,"div",8)(21,"header",9)(22,"p",10),me(23,18),O()(),b(24,"div",12)(25,"div",19)(26,"button",20),me(27,21),O(),b(28,"button",22),me(29,23),O()()()()()(),x(30,i7t,34,7,"div",24),b(31,"div",6),x(32,a7t,2,1,"div",25),O()()),2&e&&(S(30),T("ngIf",r.gameInfoDetails.isPresent()),S(2),T("ngForOf",r.games))},dependencies:[Ln,nn,Dp,h9],encapsulation:2}),n})();const l7t=["board"];let R9=(()=>{class n{static NO_MATCHING_GAME(e){return $localize`This game (${e}) does not exist.`}}return n.NOT_YOUR_TURN=()=>$localize`It is not your turn!`,n.NO_CLONING_FEATURE=()=>$localize`You cannot clone a game. This feature might be implemented later.`,n})(),qP=(()=>{class n{constructor(e,r,s,i,o){this.componentFactoryResolver=e,this.actRoute=r,this.connectedUserService=s,this.router=i,this.messageDisplayer=o,this.boardRef=null,this.players=[P.empty(),P.empty()],this.role=pe.NONE,this.endGame=!1,this.Player=z,K(n.VERBOSE,"GameWrapper.constructed: "+(null!=this.boardRef))}getMatchingComponent(e){return K(n.VERBOSE,"GameWrapper.getMatchingComponent"),P.ofNullable(L9.ALL_GAMES().find(s=>s.urlName===e)).map(s=>s.component)}afterViewInit(){var e=this;return A(function*(){K(n.VERBOSE,"GameWrapper.afterViewInit");const r=yield e.createGameComponent();return r&&(e.gameComponent.rules.setInitialBoard(),e.gameComponent.updateBoard()),r})()}getGameName(){return we.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}createGameComponent(){var e=this;return A(function*(){K(n.VERBOSE,{m:"GameWrapper.createGameComponent",that:e});const r=e.getGameName(),s=e.getMatchingComponent(r);if(s.isAbsent())return yield e.router.navigate(["/notFound",R9.NO_MATCHING_GAME(r)],{skipLocationChange:!0}),!1;ye(null!=e.boardRef,"Board element should be present");const i=e.componentFactoryResolver.resolveComponentFactory(s.get()),o=we.getNonNullable(e.boardRef).createComponent(i);return e.gameComponent=o.instance,e.gameComponent.chooseMove=(c,u,h)=>e.receiveValidMove(c,u,h),e.gameComponent.canUserPlay=c=>e.onUserClick(c),e.gameComponent.isPlayerTurn=()=>e.isPlayerTurn(),e.gameComponent.cancelMoveOnWrapper=c=>{e.onCancelMove(c)},e.setRole(e.role),e.canPass=e.gameComponent.canPass,!0})()}setRole(e){this.role=e,this.gameComponent.role=this.role,this.gameComponent.hasAsymetricBoard&&(this.gameComponent.rotation="rotate("+180*this.role.value+")"),this.gameComponent.updateBoard()}receiveValidMove(e,r,s){var i=this;return A(function*(){if(K(n.VERBOSE||!1,{gameWrapper_receiveValidMove_AKA_chooseMove:{move:e,state:r,scores:s}}),!i.isPlayerTurn())return U.failure(R9.NOT_YOUR_TURN());if(i.endGame)return U.failure($localize`The game has ended.`);const c=i.gameComponent.rules.isLegal(e,r);return c.isFailure()?(i.gameComponent.cancelMove(c.getReason()),U.ofFallible(c)):(i.gameComponent.cancelMoveAttempt(),yield i.onLegalUserMove(e,s),K(n.VERBOSE||!1,"GameWrapper.receiveValidMove says: valid move legal"),U.SUCCESS)})()}onUserClick(e){if(this.role===pe.NONE){const r=R9.NO_CLONING_FEATURE();return U.failure(r)}return this.isPlayerTurn()?U.SUCCESS:U.failure(R9.NOT_YOUR_TURN())}isPlayerTurn(){if(this.role===pe.NONE||null==this.gameComponent)return!1;const e=this.gameComponent.getTurn(),r=e%2,s=this.getPlayer();return K(n.VERBOSE,{isPlayerTurn:{turn:e,players:this.players,player:s,observer:this.role,areYouPlayer:this.players[r].isPresent()&&Fa(this.players[r].get(),s),isThereAPlayer:this.players[r]}}),!this.players[r].isPresent()||this.players[r].equalsValue(s)}getBoardHighlight(){return this.endGame?["endgame-bg"]:this.isPlayerTurn()?["player"+this.gameComponent.getTurn()%2+"-bg"]:[]}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ba),Q(So),Q(Os),Q(jn),Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["ng-component"]],viewQuery:function(e,r){if(1&e&&f4(l7t,5,ka),2&e){let s;vc(s=Cc())&&(r.boardRef=s.first)}},decls:0,vars:0,template:function(e,r){},encapsulation:2}),n})();const u7t=["board"];let f7t=(()=>{class n extends qP{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.boardRef=null}getGameName(){return this.demoNodeInfo.name}ngAfterViewInit(){var e=this;return A(function*(){setTimeout(A(function*(){yield e.afterViewInit(),e.gameComponent.rules.node=e.demoNodeInfo.node,e.setRole(e.gameComponent.getCurrentPlayer()),e.gameComponent.updateBoard(),e.cdr.detectChanges(),e.demoNodeInfo.click.isPresent()&&(we.getNonNullable(document.querySelector(e.demoNodeInfo.click.get())).dispatchEvent(new Event("click")),e.cdr.detectChanges())}),1)})()}onLegalUserMove(e,r){return A(function*(){})()}getPlayer(){return"no-player"}onCancelMove(e){}}return n.\u0275fac=function(e){return new(e||n)(Q(ba),Q(So),Q(Os),Q(jn),Q(Tn),Q(fu))},n.\u0275cmp=gt({type:n,selectors:[["app-demo-card"]],viewQuery:function(e,r){if(1&e&&f4(u7t,5,ka),2&e){let s;vc(s=Cc())&&(r.boardRef=s.first)}},inputs:{demoNodeInfo:"demoNodeInfo"},features:[l],decls:2,vars:0,consts:[["board",""]],template:function(e,r){1&e&&X(0,"div",null,0)},encapsulation:2}),n})();function h7t(n,t){if(1&n&&(b(0,"div",17)(1,"figure",18),X(2,"app-demo-card",19),O()()),2&n){const e=v().$implicit;S(2),T("demoNodeInfo",e)}}function d7t(n,t){if(1&n&&(b(0,"div",20)(1,"figure",21),X(2,"app-demo-card",19),O()()),2&n){const e=v().$implicit;S(2),T("demoNodeInfo",e)}}function p7t(n,t){if(1&n&&(b(0,"div",12)(1,"div",13)(2,"p",14),Pt(3),O()(),x(4,h7t,3,1,"div",15),x(5,d7t,3,1,"ng-template",null,16,c1),O()),2&n){const e=t.$implicit,r=t1(6),s=v(2);S(3),a1(e.name),S(1),T("ngIf",s.squared.value)("ngIfElse",r)}}function g7t(n,t){if(1&n&&(b(0,"div",10),x(1,p7t,7,3,"div",11),O()),2&n){const e=t.$implicit;S(1),T("ngForOf",e)}}let m7t=(()=>{class n{constructor(){this.numberOfColumns=new La(5),this.squared=new La(!0),this.columns=[],this.fillColumns(this.numberOfColumns.value),this.numberOfColumns.valueChanges.subscribe(e=>{this.fillColumns(e)})}fillColumns(e){const r=L9.ALL_GAMES();let s=0,i=0;this.columns=[];for(const o of r){const c=[],u=o.rules,h=o.tutorial.tutorial;for(const p of h){const m=this.getNodeFromStep(p,u);c.push(m)}for(const p of c)i<e&&this.columns.push([]),this.columns[s].push({name:o.urlName,node:p.node,click:p.click}),i++,s=(s+1)%e}}getNodeFromStep(e,r){if(e.hasSolution()){const s=e.getSolution();if("string"==typeof s)return{node:new B1(e.state),click:P.of(s)};{const i=s;return{node:new B1(r.applyLegalMove(i,e.state,r.isLegal(i,e.state).get()),P.of(new B1(e.state)),P.of(i)),click:P.empty()}}}return{node:new B1(e.state),click:P.empty()}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-demo-page"]],decls:17,vars:4,consts:function(){let t,e;return t=$localize`Number of columns: `,e=$localize`Squared`,[[1,"field"],["for","numberOfColumns",1,"label"],t,[1,"control"],["step","1","min","1","max","10","name","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary",3,"formControl"],[1,"checkbox"],["type","checkbox",3,"formControl"],e,[1,"columns"],["class","column",4,"ngFor","ngForOf"],[1,"column"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"card-header"],[1,"card-header-title"],["class","card-image game-card","style","height: 200px;",4,"ngIf","ngIfElse"],["nonSquared",""],[1,"card-image","game-card",2,"height","200px"],[1,"image",2,"height","100%"],[3,"demoNodeInfo"],[1,"card-image","game-card"],[1,"image"]]},template:function(e,r){1&e&&(b(0,"form")(1,"div",0)(2,"label",1),ln(3),me(4,2),un(),b(5,"output"),Pt(6),O()(),b(7,"div",3),X(8,"input",4),O()(),b(9,"div",0)(10,"label",5),X(11,"input",6),Pt(12," \xa0"),ln(13),me(14,7),un(),O()()(),b(15,"div",8),x(16,g7t,2,1,"div",9),O()),2&e&&(S(6),a1(r.numberOfColumns.value),S(2),T("formControl",r.numberOfColumns),S(3),T("formControl",r.squared),S(5),T("ngForOf",r.columns))},dependencies:[Ln,nn,mu,g4,ky,JO,bl,gu,hN,mp,f7t],encapsulation:2}),n})(),FH=(()=>{class n{constructor(e){this.element=e}ngAfterViewInit(){this.element.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(l2))},n.\u0275dir=$t({type:n,selectors:[["","autofocus",""]]}),n})(),q3e=(()=>{class n{constructor(e){this.shown=!1,this.input=e.nativeElement.parentNode.previousSibling,e.nativeElement.addEventListener("click",r=>{this.toggle()})}toggle(){this.shown=!this.shown,this.input.setAttribute("type",this.shown?"text":"password"),this.input.focus()}}return n.\u0275fac=function(e){return new(e||n)(Q(l2))},n.\u0275dir=$t({type:n,selectors:[["","toggleVisibility",""]]}),n})();function _7t(n,t){if(1&n&&(b(0,"div",29)(1,"div",30),me(2,31),O(),b(3,"div",32),Pt(4),O()()),2&n){const e=v();S(4),a1(e.errorMessage)}}const v7t=function(){return["/register"]},C7t=function(){return["/reset-password"]};let y7t=(()=>{class n{constructor(e,r){this.router=e,this.connectedUserService=r,this.faEye=LV,this.loginForm=new p0({email:new La,password:new La})}ngOnInit(){var e=this;this.userSubscription=this.connectedUserService.subscribeToUser(function(){var r=A(function*(s){s!==f5.NOT_CONNECTED&&(yield e.redirect())});return function(s){return r.apply(this,arguments)}}())}loginWithEmail(e){var r=this;return A(function*(){const s=yield r.connectedUserService.doEmailLogin(e.email,e.password);s.isFailure()&&(r.errorMessage=s.getReason())})()}loginWithGoogle(){var e=this;return A(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isFailure()&&(e.errorMessage=r.getReason())})()}redirect(){var e=this;return A(function*(){return e.router.navigate(["/lobby"])})()}canLogin(){return!(""===(this.loginForm.value.email??"")||""===(this.loginForm.value.password??""))}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Os))},n.\u0275cmp=gt({type:n,selectors:[["app-login"]],decls:49,vars:8,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C;return t=$localize`Log in`,e=$localize`Email`,r=$localize`Email`,s=$localize`Password`,i=$localize`Password`,o=$localize`Log in`,c=$localize`Log in with Google`,u=$localize`No account?`,h=$localize`Register`,p=$localize`Forgot your password?`,m=$localize`Reset your password`,C=$localize`Connection error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","type","text","placeholder",r,"formControlName","email","name","email","type","email","autofocus","","required","",1,"input"],["for","password",1,"label"],s,[1,"control","has-icons-right","is-expanded"],["id","password","type","password","placeholder",i,"formControlName","password","name","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","loginButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],o,["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],c,["class","message is-danger","role","alert",4,"ngIf"],[1,"help","level-right"],u,[3,"routerLink"],h,p,m,["role","alert",1,"message","is-danger"],[1,"message-header"],C,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),me(2,2),O(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),me(7,7),O()(),b(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),O()()()(),b(12,"div",4)(13,"div",5)(14,"label",12),me(15,13),O()(),b(16,"div",8)(17,"div",9)(18,"div",14),X(19,"input",15),b(20,"span",16),X(21,"fa-icon",17),O()()()()(),b(22,"div",4),X(23,"div",5),b(24,"div",8)(25,"div",9)(26,"div",10)(27,"button",18),J("click",function(){return r.loginWithEmail(r.loginForm.value)}),me(28,19),O()()()()(),b(29,"div",4),X(30,"div",5),b(31,"div",8)(32,"div",9)(33,"div",10)(34,"button",20),J("click",function(){return r.loginWithGoogle()}),me(35,21),O()()()()(),x(36,_7t,5,1,"div",22),b(37,"p",23),ln(38),me(39,24),un(),Pt(40,"\xa0 "),b(41,"a",25),me(42,26),O()(),b(43,"p",23),ln(44),me(45,27),un(),Pt(46,"\xa0 "),b(47,"a",25),me(48,28),O()()()()),2&e&&(S(3),T("formGroup",r.loginForm),S(18),T("icon",r.faEye),S(6),T("disabled",!r.canLogin()),S(9),T("ngIf",r.errorMessage),S(5),T("routerLink",tr(6,v7t)),S(6),T("routerLink",tr(7,C7t)))},dependencies:[nn,Su,mu,g4,bl,gu,Cu,_u,rf,h9,FH,q3e],encapsulation:2}),n})(),E7t=(()=>{class n{constructor(e){this.partDAO=e}subscribeToActiveParts(e){let r=[];const c=new MS(u=>{r=r.concat(...u),e(r)},u=>{const h=r;for(const p of u)h.forEach(m=>{m.id===p.id&&(m.data=p.data)});r=h,e(r)},u=>{const h=[];for(const p of r)u.some(m=>m.id===p.id)||h.push(p);r=h,e(r)});return this.partDAO.observingWhere([["result","==",Rn.UNACHIEVED.value]],c)}}return n.\u0275fac=function(e){return new(e||n)(Re(yte))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),M7t=(()=>{class n{constructor(e){this.userDAO=e}subscribeToActiveUsers(e){K(n.VERBOSE,"ActiveUsersService.subscribeToActiveUsers");let r=[];const c=new MS(u=>{K(n.VERBOSE,"our DAO gave us "+u.length+" new user(s)"),r=this.sort(r.concat(...u)),e(r)},u=>{let h=r;K(n.VERBOSE,"our DAO updated "+u.length+" user(s)");for(const p of u)h.forEach(m=>{m.id===p.id&&(m.data=p.data)}),h=this.sort(h);r=h,e(r)},u=>{r=r.filter(h=>!u.some(p=>p.id===h.id)),e(r)});return this.userDAO.observingWhere([["state","==","online"],["verified","==",!0]],c)}sort(e){return e.sort((r,s)=>{const i=we.getNonNullable(r.data).lastUpdateTime,o=we.getNonNullable(i).seconds,c=we.getNonNullable(s.data).lastUpdateTime;return o-we.getNonNullable(c).seconds})}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Re(yS))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),j3e=(()=>{class n{transform(e){return eG(1e3*e.seconds,"HH:mm:ss","en-US")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=oi({name:"firebaseDate",type:n,pure:!0}),n})();const S7t=["chatDiv"];function P7t(n,t){1&n&&(ln(0),me(1,5),un())}function T7t(n,t){1&n&&me(0,6),2&n&&(I1(v().unreadMessagesText),H1(0))}function w7t(n,t){if(1&n){const e=Oe();b(0,"button",11),J("click",function(){return fe(e),ae(v(2).scrollToBottom())}),Pt(1),O()}if(2&n){const e=v(2);S(1),W2("",e.unreadMessagesText," \u2193")}}function b7t(n,t){if(1&n&&(b(0,"p"),Pt(1),_c(2,"firebaseDate"),b(3,"b",12),Pt(4),O(),b(5,"span",13),Pt(6),O()()),2&n){const e=t.$implicit;S(1),W2(" [",m3(2,3,e.postedTime),"] "),S(3),W2("",e.sender.name," : "),S(2),a1(e.content)}}function O7t(n,t){if(1&n){const e=Oe();b(0,"div"),x(1,w7t,2,1,"button",7),b(2,"div",8,9),J("scroll",function(){return fe(e),ae(v().updateCurrentScrollPosition())}),x(4,b7t,7,5,"p",10),O()()}if(2&n){const e=v();S(1),T("ngIf",e.showUnreadMessagesButton),S(3),T("ngForOf",e.chat)}}const N7t=function(){return{standalone:!0}};function A7t(n,t){if(1&n){const e=Oe();b(0,"form",14),J("onSubmit",function(){return fe(e),ae(v().sendMessage())}),b(1,"div",15)(2,"div",16)(3,"input",17,18),J("ngModelChange",function(s){return fe(e),ae(v().userMessage=s)}),O(),b(5,"p",19),Pt(6),O()(),b(7,"div",20)(8,"button",21),J("click",function(){return fe(e),ae(v().sendMessage())}),X(9,"fa-icon",22),O()()(),b(10,"div",23)(11,"p")(12,"strong"),me(13,24),O()()()()}if(2&n){const e=t1(4),r=v();S(3),T("ngModel",r.userMessage)("ngModelOptions",tr(4,N7t)),S(3),W2("",e.value.length,"/128"),S(3),T("icon",r.faReply)}}let Z3e=(()=>{class n{constructor(e,r){this.chatService=e,this.connectedUserService=r,this.userMessage="",this.connected=!1,this.chat=[],this.readMessages=0,this.unreadMessagesText="",this.showUnreadMessagesButton=!1,this.visible=!0,this.faReply=CV,this.isNearBottom=!0,this.notYetScrolled=!0,K(n.VERBOSE,"ChatComponent constructor")}ngOnInit(){K(n.VERBOSE,`ChatComponent.ngOnInit for chat ${this.chatId}`),ye(null!=this.chatId&&""!==this.chatId,"No chat to join mentionned"),this.loadChatContent()}ngAfterViewChecked(){this.scrollToBottomIfNeeded()}loadChatContent(){const e=s=>{this.updateMessages(s.flatMap(i=>null==i.data.postedTime?[]:[i.data]))},r=new MS(e,e,()=>{});this.chatSubscription=this.chatService.subscribeToMessages(this.chatId,r)}updateMessages(e){this.chat=this.chat.concat(e);const r=this.chat.length;!0===this.visible&&!0===this.isNearBottom?(this.readMessages=r,this.updateUnreadMessagesText(0),this.scrollToBottom()):this.updateUnreadMessagesText(r-this.readMessages)}updateUnreadMessagesText(e){this.showUnreadMessagesButton=!(!this.visible||!1!==this.isNearBottom),0===e?(this.unreadMessagesText=$localize`no new message`,this.showUnreadMessagesButton=!1):this.unreadMessagesText=1===e?$localize`1 new message`:$localize`${e} new messages`}scrollToBottomIfNeeded(){this.visible&&(this.isNearBottom||this.notYetScrolled)&&this.scrollToBottom()}updateCurrentScrollPosition(){this.isNearBottom=this.chatDiv.nativeElement.scrollTop+this.chatDiv.nativeElement.offsetHeight>this.chatDiv.nativeElement.scrollHeight-10}scrollToBottom(){null!=this.chatDiv&&(this.updateUnreadMessagesText(0),this.scrollTo(this.chatDiv.nativeElement.scrollHeight),this.notYetScrolled=!1)}scrollTo(e){this.chatDiv.nativeElement.scroll({top:e,left:0,behavior:"smooth"})}sendMessage(){var e=this;return A(function*(){const r=e.userMessage;e.userMessage="";const s=e.connectedUserService.user.get().toMinimalUser();yield e.chatService.sendMessage(e.chatId,s,r,e.turn)})()}ngOnDestroy(){this.chatSubscription.unsubscribe()}switchChatVisibility(){!0===this.visible?this.visible=!1:(this.visible=!0,this.updateUnreadMessagesText(0),this.scrollToBottom(),this.readMessages=this.chat.length)}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(CS),Q(Os))},n.\u0275cmp=gt({type:n,selectors:[["app-chat"]],viewQuery:function(e,r){if(1&e&&f4(S7t,5),2&e){let s;vc(s=Cc())&&(r.chatDiv=s.first)}},inputs:{chatId:"chatId",turn:"turn"},decls:7,vars:4,consts:function(){let t,e,r,s;return t=$localize`Hide chat`,e=$localize`Show chat (${"\ufffd0\ufffd"}:INTERPOLATION:)`,r=$localize`Type your message here`,s=$localize`Be polite`,[["id","switchChatVisibilityButton",1,"button","is-primary","is-light","is-fullwidth",3,"click"],[4,"ngIf","ngIfElse"],["showChat",""],[4,"ngIf"],["id","chatForm",3,"onSubmit",4,"ngIf"],t,e,["id","scrollToBottomIndicator","class","notification button is-info is-light is-fullwidth",3,"click",4,"ngIf"],["id","chatDiv",1,"is-fullwidth","block",2,"overflow-y","scroll","max-height","50vh",3,"scroll"],["chatDiv",""],[4,"ngFor","ngForOf"],["id","scrollToBottomIndicator",1,"notification","button","is-info","is-light","is-fullwidth",3,"click"],[1,"chat-sender"],[1,"chat-message"],["id","chatForm",3,"onSubmit"],[1,"field","has-addons","is-fullwidth"],[1,"control","is-expanded"],["id","message","type","text","placeholder",r,"maxlength","128","value","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],["message",""],[1,"help"],[1,"control"],["type","submit","id","send",1,"button","is-primary",3,"click"],[1,"clickable-icon",3,"icon"],[1,"content","is-small"],s]},template:function(e,r){if(1&e&&(b(0,"div")(1,"button",0),J("click",function(){return r.switchChatVisibility()}),x(2,P7t,2,0,"ng-container",1),x(3,T7t,1,1,"ng-template",null,2,c1),O(),x(5,O7t,5,2,"div",3),x(6,A7t,14,5,"form",4),O()),2&e){const s=t1(4);S(2),T("ngIf",r.visible)("ngIfElse",s),S(3),T("ngIf",r.visible),S(1),T("ngIf",r.visible)}},dependencies:[Ln,nn,mu,g4,bl,gu,mN,_p,mp,h9,j3e],encapsulation:2}),n})(),Y3e=(()=>{class n{constructor(e,r,s){this.router=e,this.observedPartService=r,this.messageDisplayer=s}pickGame(e){this.selectedGame=e}navigateToOnlineGameCreation(){var e=this;return A(function*(){const r=e.observedPartService.canUserCreate();r.isSuccess()?yield e.router.navigate(["/play",e.selectedGame]):e.messageDisplayer.criticalMessage(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(w2),Q(Tn))},n.\u0275cmp=gt({type:n,selectors:[["app-online-game-selection"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Create an online game`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),J("click",function(){return r.navigateToOnlineGameCreation()}),me(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[HH],encapsulation:2}),n})();function I7t(n,t){if(1&n&&(ln(0),Pt(1),un()),2&n){const e=v().$implicit;S(1),a1(e.data.playerOne.name)}}function x7t(n,t){1&n&&(ln(0),me(1,26),un())}function k7t(n,t){if(1&n){const e=Oe();b(0,"tr",22),J("click",function(){const i=fe(e).$implicit;return ae(v(2).joinGame(i))}),b(1,"td",23),Pt(2),O(),b(3,"td",23),Pt(4),O(),b(5,"td",23),x(6,I7t,2,1,"ng-container",24),x(7,x7t,2,0,"ng-template",null,25,c1),O(),b(9,"td",23),Pt(10),O()()}if(2&n){const e=t.$implicit,r=t.index,s=t1(8);C1("id","part_",r,""),S(2),a1(e.data.typeGame),S(2),a1(e.data.playerZero.name),S(2),T("ngIf",e.data.playerOne)("ngIfElse",s),S(4),a1(e.data.turn)}}function L7t(n,t){if(1&n&&(b(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead")(4,"tr")(5,"th",16),me(6,17),O(),b(7,"th",16),me(8,18),O(),b(9,"th",16),me(10,19),O(),b(11,"th",16),me(12,20),O()()(),b(13,"tbody"),x(14,k7t,11,6,"tr",21),O()()()()),2&n){const e=v();S(14),T("ngForOf",e.activeParts)}}function R7t(n,t){1&n&&(b(0,"div",27),X(1,"app-online-game-selection",28),O())}function D7t(n,t){if(1&n&&(b(0,"li",39),Pt(1),_c(2,"firebaseDate"),O()),2&n){const e=v().$implicit;Gb("id",e.data.username),S(1),WC("",e.data.username,": ",m3(2,3,e.data.lastUpdateTime),"")}}function z7t(n,t){if(1&n&&(ln(0),x(1,D7t,3,5,"li",38),un()),2&n){const e=t.$implicit;S(1),T("ngIf",e.data.lastUpdateTime)}}function V7t(n,t){if(1&n&&(b(0,"div",29)(1,"div",30)(2,"div",31),X(3,"app-chat",32),O()(),b(4,"div",33)(5,"div",34)(6,"p"),me(7,35),O(),b(8,"ul",36),x(9,z7t,2,1,"ng-container",37),O()()()()),2&n){const e=v();S(3),T("turn",-1),S(6),T("ngForOf",e.activeUsers)}}let H7t=(()=>{class n{constructor(e,r,s,i,o){this.router=e,this.messageDisplayer=r,this.activePartsService=s,this.activeUsersService=i,this.observedPartService=o,this.activeUsers=[],this.activeParts=[],this.currentTab="games",this.createTabClasses=[]}ngOnInit(){K(n.VERBOSE,"lobbyComponent.ngOnInit"),this.activeUsersSubscription=this.activeUsersService.subscribeToActiveUsers(e=>{this.activeUsers=e}),this.activePartsSubscription=this.activePartsService.subscribeToActiveParts(e=>{this.activeParts=e}),this.observedPartService.subscribeToObservedPart(e=>{this.createTabClasses=[],e.isPresent()&&(this.createTabClasses=["disabled-tab"])})}ngOnDestroy(){K(n.VERBOSE,"lobbyComponent.ngOnDestroy"),this.activeUsersSubscription.unsubscribe(),this.activePartsSubscription.unsubscribe()}joinGame(e){var r=this;return A(function*(){const s=e.id,i=e.data.typeGame,c=r.observedPartService.canUserJoin(s,null!=e.data.beginning);c.isSuccess()?yield r.router.navigate(["/play",i,s]):r.messageDisplayer.criticalMessage(c.getReason())})()}selectTab(e){if("create"===e){const r=this.observedPartService.canUserCreate();r.isSuccess()?this.currentTab=e:this.messageDisplayer.criticalMessage(r.getReason())}else this.currentTab=e}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(jn),Q(Tn),Q(E7t),Q(M7t),Q(w2))},n.\u0275cmp=gt({type:n,selectors:[["app-lobby"]],decls:14,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Games`,e=$localize`Create`,r=$localize`Chat`,s=$localize`Game`,i=$localize`First player`,o=$localize`Second player`,c=$localize`Turn`,u=$localize`Waiting for opponent`,h=$localize`Connected users:`,[[1,"tabs","is-toggle","is-fullwidth"],["ngClass","if (currentTab === 'games') 'is-active'"],["id","tab-games",3,"click"],t,["ngClass","if (currentTab === 'create') 'is-active'"],["id","tab-create",3,"ngClass","click"],e,["ngClass","if (currentTab === 'chat') 'is-active'"],["id","tab-chat",3,"click"],r,["id","actualGames","class","box",4,"ngIf"],["id","gameCreator","class","box",4,"ngIf"],["id","chatTab","class","columns",4,"ngIf"],["id","actualGames",1,"box"],[1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],s,i,o,c,[3,"id","click",4,"ngFor","ngForOf"],[3,"id","click"],[1,"td"],[4,"ngIf","ngIfElse"],["waitingForOpponent",""],u,["id","gameCreator",1,"box"],["id","online-game-selection"],["id","chatTab",1,"columns"],["id","chatContainerDiv",1,"column","is-12"],["id","chat",1,"box"],["chatId","server",3,"turn"],[1,"column","is-3","is-hidden"],["id","onlineUsers",1,"box"],h,["id","activeUsersList"],[4,"ngFor","ngForOf"],[3,"id",4,"ngIf"],[3,"id"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"ul")(2,"li",1)(3,"a",2),J("click",function(){return r.selectTab("games")}),me(4,3),O()(),b(5,"li",4)(6,"a",5),J("click",function(){return r.selectTab("create")}),me(7,6),O()(),b(8,"li",7)(9,"a",8),J("click",function(){return r.selectTab("chat")}),me(10,9),O()()()(),x(11,L7t,15,1,"div",10),x(12,R7t,2,0,"div",11),x(13,V7t,10,2,"div",12)),2&e&&(S(6),T("ngClass",r.createTabClasses),S(5),T("ngIf","games"===r.currentTab),S(1),T("ngIf","create"===r.currentTab),S(1),T("ngIf","chat"===r.currentTab))},dependencies:[mn,Ln,nn,Z3e,Y3e,j3e],encapsulation:2}),n})(),K3e=(()=>{class n{constructor(e){this.route=e,this.message=e.snapshot.paramMap.get("message")??$localize`This page does not exist.`}}return n.\u0275fac=function(e){return new(e||n)(Q(So))},n.\u0275cmp=gt({type:n,selectors:[["app-not-found"]],decls:5,vars:1,consts:function(){let t;return t=$localize`Not found`,[[1,"message","is-danger"],[1,"message-header"],t,[1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),me(2,2),O(),b(3,"div",3),Pt(4),O()()),2&e&&(S(4),a1(r.message))},encapsulation:2}),n})();class D9{constructor(t,e,r){this.added=t,this.modified=e,this.removed=r}static from(t,e){const r=new D9({},{},{});if(null==t)return r.added={...e},r;if(null==e)return r.removed={...t},r;const s=Object.keys(t),i=Object.keys(e),o=s.filter(h=>!1===i.includes(h)),c=s.filter(h=>i.includes(h)),u=i.filter(h=>!1===s.includes(h));return r.addNewKeys(u,e),r.addCommonKeys(c,e,t),r.addRemovedKeys(o,t),r}static differs(t,e){return D9.from(t,e).countChanges()>0}addNewKeys(t,e){for(const r of t)null!=e[r]&&(this.added[r]=e[r])}addCommonKeys(t,e,r){for(const s of t)this.addCommonKey(s,r[s],e[s])}addCommonKey(t,e,r){if(null==r)null!=e&&(this.removed[t]=e);else if(null==e)this.added[t]=r;else if(["string","boolean","number"].includes(typeof e))e!==r&&(this.modified[t]=r);else if(Array.isArray(e)){if(!Array.isArray(r))throw new Error("Thing should not change type");e.length===r.length?this.addCommonKeyList(t,e,r):this.modified[t]=r}else{ye("object"==typeof e,`ObjectDifference: expected JSON, but got a ${typeof e} in ${t}`),ye("object"==typeof r,`ObjectDifference: expected JSON, but got a ${typeof r} in ${t}`);const o=D9.from(e,r);o.countChanges()>0&&(this.modified[t]=o)}}addCommonKeyList(t,e,r){let s=!0;for(let i=0;s&&i<e.length;i++)typeof e[i]==typeof r[i]&&"object"==typeof e[i]?D9.differs(e[i],r[i])&&(s=!1,this.modified[t]=r):e[i]!==r[i]&&(s=!1,this.modified[t]=r)}addRemovedKeys(t,e){for(const r of t)this.removed[r]=e[r]}countChanges(){const t=Object.keys(this.removed).length,e=Object.keys(this.modified).length;return Object.keys(this.added).length+e+t}isPresent(t){return null!=this.added[t]?{state:"added",present:!0}:null!=this.modified[t]?{state:"modified",present:!0}:null!=this.removed[t]?{state:"removed",present:!0}:{state:null,present:!1}}isFullyCreated(){return 0===Object.keys(this.modified).length&&0===Object.keys(this.removed).length}addedOrModified(t){const e=this.isPresent(t);return!0===e.present&&"removed"!==e.state}}function X3e(n){return 1e3*n.seconds+n.nanoseconds/1e6}function Q3e(n,t){return X3e(t)-X3e(n)}function Ym(n){return pr((t,e)=>{oo(n).subscribe(os(e,()=>e.complete(),io)),!e.closed&&t.subscribe(e)})}let F7t=(()=>{class n{transform(e){const r=e%60,s=(e-r)%3600/60,i=(e-60*s-r)/3600,o=[];if(i>1?o.push($localize`${i} hours`):1===i&&o.push($localize`1 hour`),s>1?o.push($localize`${s} minutes`):1===s&&o.push($localize`1 minute`),r>1?o.push($localize`${r} seconds`):1===r&&o.push($localize`1 second`),0===o.length)return $localize`0 seconds`;if(1===o.length)return o[0];{const c=o.slice(0,-1).join(", "),u=o.slice(-1)[0];return $localize`${c} and ${u}`}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=oi({name:"humanDuration",type:n,pure:!0}),n})();function B7t(n,t){if(1&n&&(ln(0),Pt(1),un()),2&n){const e=v(3);S(1),a1(e.viewInfo.chosenOpponent)}}function $7t(n,t){1&n&&me(0,44)}function U7t(n,t){if(1&n&&(b(0,"div",45)(1,"div",8)(2,"label",46),ln(3),me(4,47),un(),b(5,"output"),Pt(6),_c(7,"humanDuration"),O()(),b(8,"div",37),X(9,"input",48),O()(),b(10,"div",8)(11,"label",49),gc(12,50),X(13,"output"),_c(14,"humanDuration"),mc(),O(),b(15,"div",37),X(16,"input",51),O()()()),2&n){const e=v(3);S(6),a1(m3(7,2,e.viewInfo.maximalMoveDuration||0)),S(8),I1(m3(14,4,e.viewInfo.totalPartDuration||0)),H1(12)}}function G7t(n,t){1&n&&(b(0,"div"),gc(1,52),X(2,"br"),mc(),O())}function W7t(n,t){1&n&&(b(0,"button",64),me(1,65),O())}function q7t(n,t){if(1&n){const e=Oe();b(0,"tr",60),J("click",function(){const i=fe(e).$implicit;return ae(v(4).selectOpponent(i))}),b(1,"td",61),Pt(2),O(),b(3,"td",62),x(4,W7t,2,0,"button",63),O()()}if(2&n){const e=t.$implicit,r=v(4);C1("id","presenceOf_",e,""),T("ngClass",r.viewInfo.candidateClasses[e]),S(1),T("id",r.viewInfo.chosenOpponent===e?"selected_"+e:"candidate_"+e),S(1),a1(e),S(2),T("ngIf",r.viewInfo.chosenOpponent!==e)}}function j7t(n,t){if(1&n&&(ln(0),me(1,53),un(),b(2,"div",54)(3,"table",55)(4,"thead")(5,"tr")(6,"th",56),me(7,57),O(),b(8,"th",56),me(9,58),O()()(),b(10,"tbody"),x(11,q7t,5,5,"tr",59),O()()()),2&n){const e=v(3);S(11),T("ngForOf",e.viewInfo.candidates)}}function Z7t(n,t){if(1&n){const e=Oe();b(0,"button",66),J("click",function(){return fe(e),ae(v(3).changeConfig())}),me(1,67),O()}}function Y7t(n,t){if(1&n){const e=Oe();b(0,"div")(1,"h1",4),me(2,5),O(),b(3,"form",6)(4,"fieldset",7)(5,"div",8)(6,"label",9),me(7,10),O(),b(8,"div",11)(9,"button",12),J("click",function(){return fe(e),ae(v(2).selectFirstPlayer("RANDOM"))}),me(10,13),O(),b(11,"button",14),J("click",function(){return fe(e),ae(v(2).selectFirstPlayer("CREATOR"))}),me(12,15),O(),b(13,"button",16),J("click",function(){return fe(e),ae(v(2).selectFirstPlayer("CHOSEN_PLAYER"))}),x(14,B7t,2,1,"ng-container",17),x(15,$7t,1,0,"ng-template",null,18,c1),O()()(),b(17,"div",8)(18,"label",9),me(19,19),O(),b(20,"div",11)(21,"div",20),J("click",function(){return fe(e),ae(v(2).selectPartType("STANDARD"))}),b(22,"div",21)(23,"span"),me(24,22),O()(),b(25,"div",23)(26,"div",24)(27,"div",25)(28,"p"),ln(29),me(30,26),un(),b(31,"strong"),Pt(32),_c(33,"humanDuration"),O(),X(34,"br"),ln(35),gc(36,27),X(37,"strong"),_c(38,"humanDuration"),mc(),un(),O()()()()(),b(39,"div",28),J("click",function(){return fe(e),ae(v(2).selectPartType("BLITZ"))}),b(40,"div",21)(41,"span"),me(42,29),O()(),b(43,"div",23)(44,"div",24)(45,"div",25)(46,"p"),ln(47),me(48,30),un(),b(49,"strong"),Pt(50),_c(51,"humanDuration"),O(),X(52,"br"),ln(53),gc(54,31),X(55,"strong"),_c(56,"humanDuration"),mc(),un(),O()()()()(),b(57,"button",32),J("click",function(){return fe(e),ae(v(2).selectPartType("CUSTOM"))}),me(58,33),O()()(),x(59,U7t,17,6,"div",34),b(60,"div",8)(61,"label",35),me(62,36),O(),b(63,"div",37),x(64,G7t,3,0,"div",17),x(65,j7t,12,1,"ng-template",null,38,c1),O()()(),b(67,"div",8)(68,"div",11)(69,"button",39),J("click",function(){return fe(e),ae(v(2).proposeConfig())}),me(70,40),O(),x(71,Z7t,2,0,"button",41),b(72,"button",42),J("click",function(){return fe(e),ae(v(2).cancelGameCreation())}),me(73,43),O()()()()()}if(2&n){const e=t1(16),r=t1(66),s=v(2);S(3),T("formGroup",s.configFormGroup),S(1),T("disabled",!s.viewInfo.canEditConfig),S(5),T("ngClass",s.viewInfo.firstPlayerClasses.RANDOM),S(2),T("ngClass",s.viewInfo.firstPlayerClasses.CREATOR),S(2),T("ngClass",s.viewInfo.firstPlayerClasses.CHOSEN_PLAYER),S(1),T("ngIf",s.viewInfo.chosenOpponent)("ngIfElse",e),S(7),T("ngClass",s.viewInfo.partTypeClasses.STANDARD),S(11),a1(m3(33,19,s.partType.NORMAL_MOVE_DURATION)),S(6),I1(m3(38,21,s.partType.NORMAL_PART_DURATION)),H1(36),S(1),T("ngClass",s.viewInfo.partTypeClasses.BLITZ),S(11),a1(m3(51,23,s.partType.BLITZ_MOVE_DURATION)),S(6),I1(m3(56,25,s.partType.BLITZ_PART_DURATION)),H1(54),S(1),T("ngClass",s.viewInfo.partTypeClasses.CUSTOM),S(2),T("ngIf",s.viewInfo.showCustomTime),S(5),T("ngIf",0===s.viewInfo.candidates.length)("ngIfElse",r),S(5),T("disabled",!s.viewInfo.canProposeConfig),S(2),T("ngIf",s.viewInfo.canReviewConfig)}}function K7t(n,t){if(1&n&&(b(0,"div",74)(1,"p"),gc(2,75),X(3,"br"),mc(),O()()),2&n){const e=v(3);S(3),I1(e.viewInfo.creator),H1(2)}}function X7t(n,t){if(1&n&&(b(0,"span"),me(1,81),O()),2&n){const e=v(4);S(1),I1(e.viewInfo.creator),H1(1)}}function Q7t(n,t){1&n&&(b(0,"span"),me(1,82),O())}function J7t(n,t){1&n&&(b(0,"span"),me(1,83),O())}function eft(n,t){if(1&n){const e=Oe();b(0,"div",74)(1,"p"),me(2,76),O(),b(3,"ul")(4,"li"),x(5,X7t,2,1,"span",2),x(6,Q7t,2,0,"span",2),x(7,J7t,2,0,"span",2),O(),b(8,"li"),gc(9,77),X(10,"strong"),_c(11,"humanDuration"),mc(),O(),b(12,"li"),gc(13,78),X(14,"strong"),_c(15,"humanDuration"),mc(),O()(),b(16,"button",79),J("click",function(){return fe(e),ae(v(3).acceptConfig())}),me(17,80),O()()}if(2&n){const e=v(3);S(2),I1(e.viewInfo.creator)(e.viewInfo.partTypeName),H1(2),S(3),T("ngIf","CREATOR"===e.viewInfo.firstPlayer),S(1),T("ngIf","CHOSEN_PLAYER"===e.viewInfo.firstPlayer),S(1),T("ngIf","RANDOM"===e.viewInfo.firstPlayer),S(4),I1(m3(11,7,e.viewInfo.maximalMoveDuration||0)),H1(9),S(4),I1(m3(15,9,e.viewInfo.totalPartDuration||0)),H1(13)}}function tft(n,t){if(1&n&&(b(0,"div")(1,"div",68)(2,"div",69)(3,"p"),me(4,70),O()(),b(5,"div",71),x(6,K7t,4,1,"div",72),x(7,eft,18,11,"ng-template",null,73,c1),O()()()),2&n){const e=t1(8),r=v(2);S(6),T("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function nft(n,t){if(1&n&&(ln(0),me(1,86),un()),2&n){const e=v(3);S(1),I1(e.viewInfo.creator),H1(1)}}function rft(n,t){if(1&n&&me(0,87),2&n){const e=v(3);I1(e.viewInfo.creator)(e.viewInfo.chosenOpponent),H1(0)}}function sft(n,t){if(1&n&&(b(0,"div",68)(1,"div",69)(2,"p"),me(3,84),O()(),b(4,"div",71)(5,"p"),x(6,nft,2,1,"ng-container",17),x(7,rft,1,2,"ng-template",null,85,c1),O()()()),2&n){const e=t1(8),r=v(2);S(6),T("ngIf",r.viewInfo.creatorIsModifyingConfig)("ngIfElse",e)}}function ift(n,t){if(1&n&&(b(0,"div",1),x(1,Y7t,74,27,"div",2),x(2,tft,9,2,"div",2),x(3,sft,9,2,"div",3),O()),2&n){const e=v();S(1),T("ngIf",e.viewInfo.userIsCreator),S(1),T("ngIf",e.viewInfo.userIsChosenOpponent),S(1),T("ngIf",e.viewInfo.userIsObserver)}}class f1{constructor(t,e,r,s,i,o,c,u,h,p){this.router=t,this.actRoute=e,this.connectedUserService=r,this.observedPartService=s,this.gameService=i,this.configRoomService=o,this.chatService=c,this.userService=u,this.formBuilder=h,this.messageDisplayer=p,this.partType=br,this.gameStartNotification=new gr,this.gameStarted=!1,this.viewInfo={userIsCreator:!1,userIsChosenOpponent:!1,userIsObserver:!1,partType:"STANDARD",partTypeClasses:{STANDARD:["is-selected","is-primary"],BLITZ:[],CUSTOM:[]},firstPlayer:"RANDOM",firstPlayerClasses:{CREATOR:[],RANDOM:["is-selected","is-primary"],CHOSEN_PLAYER:[]},candidateClasses:{},candidates:[]},this.currentConfigRoom=null,this.candidates=[],this.ngUnsubscribe=new z2,this.allUserInterval=P.empty(),this.ownTokenInterval=P.empty(),this.selfSubscription=new q1,this.configRoomSubscription=new q1,this.candidatesSubscription=new q1,this.allDocDeleted=!1,K(f1.VERBOSE,"PartCreationComponent constructed")}ngOnInit(){var t=this;return A(function*(){K(f1.VERBOSE,"PartCreationComponent.ngOnInit"),t.checkInputs(),t.createForms();const e=yield t.configRoomService.joinGame(t.partId);if(e.isFailure()){const r=e.getReason();t.messageDisplayer.criticalMessage(r)}else yield t.startSendingPresenceTokens(),t.subscribeToConfigRoomDoc(),t.subscribeToFormElements(),K(f1.VERBOSE,"PartCreationComponent.ngOnInit asynchronouseries finisheds")})()}checkInputs(){const t=this.connectedUserService.user;ye(t.isPresent(),"PartCreationComponent should not be called without connected user"),ye(t.get()!==f5.NOT_CONNECTED,"PartCreationComponent should not be created with an empty userName"),ye(""!==this.partId,"PartCreationComponent should not be created with an empty partId")}createForms(){this.configFormGroup=this.formBuilder.group({firstPlayer:[js.RANDOM.value,fp.required],maximalMoveDuration:[br.NORMAL_MOVE_DURATION,fp.required],partType:["STANDARD",fp.required],totalPartDuration:[br.NORMAL_PART_DURATION,fp.required],chosenOpponent:["",fp.required]})}updateUserDocWithObservedPart(t){K(f1.VERBOSE,"updateUserDocWithObservedPart of '"+this.partId+"'");const e=this.getUserRoleInPart(t),r={id:this.partId,opponent:this.getOpponent(),typeGame:we.getNonNullable(this.actRoute.snapshot.paramMap.get("compo")),role:e};return this.observedPartService.updateObservedPart(r)}getUserRoleInPart(t){const e=this.connectedUserService.user.get().id;return e===t.creator.id?"Creator":e===t.chosenOpponent?.id?"ChosenOpponent":"Candidate"}getOpponent(){let t=null;return t=this.connectedUserService.user.get().id===this.currentConfigRoom?.creator.id?this.currentConfigRoom.chosenOpponent:we.getNonNullable(this.currentConfigRoom?.creator),t}subscribeToConfigRoomDoc(){var t=this;const e=function(){var s=A(function*(i){yield t.onCurrentConfigRoomUpdate(i)});return function(o){return s.apply(this,arguments)}}(),r=function(){var s=A(function*(i){yield t.onCandidatesUpdate(i)});return function(o){return s.apply(this,arguments)}}();this.configRoomSubscription=this.configRoomService.subscribeToChanges(this.partId,e),this.candidatesSubscription=this.configRoomService.subscribeToCandidates(this.partId,r)}getForm(t){return we.getNonNullable(this.configFormGroup.get(t))}subscribeToFormElements(){this.getForm("chosenOpponent").valueChanges.pipe(Ym(this.ngUnsubscribe)).subscribe(t=>{void 0!==this.viewInfo.chosenOpponent&&(this.viewInfo.candidateClasses[this.viewInfo.chosenOpponent]=[]),this.viewInfo.candidateClasses[t]=["is-selected"],this.viewInfo.chosenOpponent=t;const e=we.getNonNullable(this.currentConfigRoom).partStatus;this.viewInfo.canProposeConfig=e!==Zs.CONFIG_PROPOSED.value&&""!==t}),this.getForm("partType").valueChanges.pipe(Ym(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.partTypeClasses[this.viewInfo.partType]=[],this.viewInfo.partTypeClasses[t]=["is-primary","is-selected"],this.viewInfo.partType=t,this.viewInfo.showCustomTime="CUSTOM"===t}),this.getForm("maximalMoveDuration").valueChanges.pipe(Ym(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.maximalMoveDuration=t}),this.getForm("totalPartDuration").valueChanges.pipe(Ym(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.totalPartDuration=t}),this.getForm("firstPlayer").valueChanges.pipe(Ym(this.ngUnsubscribe)).subscribe(t=>{this.viewInfo.firstPlayerClasses[this.viewInfo.firstPlayer]=[],this.viewInfo.firstPlayerClasses[t]=["is-primary","is-selected"],this.viewInfo.firstPlayer=t})}updateViewInfo(){const t=we.getNonNullable(this.currentConfigRoom),e=this.connectedUserService.user.get();switch(this.viewInfo.canReviewConfig=t.partStatus===Zs.CONFIG_PROPOSED.value,this.viewInfo.canEditConfig=t.partStatus!==Zs.CONFIG_PROPOSED.value,this.viewInfo.userIsCreator=this.userIsCreator(t),this.viewInfo.userIsChosenOpponent=e.id===t.chosenOpponent?.id,this.viewInfo.userIsObserver=!1===this.viewInfo.userIsChosenOpponent&&!1===this.viewInfo.userIsCreator,this.viewInfo.creatorIsModifyingConfig=t.partStatus!==Zs.CONFIG_PROPOSED.value,this.viewInfo.showCustomTime="CUSTOM"===this.getForm("partType").value,this.viewInfo.creator=t.creator.name,this.viewInfo.candidates=this.candidates.map(r=>r.name),this.userIsCreator(t)?this.setDataForCreator(t):(this.viewInfo.maximalMoveDuration=t.maximalMoveDuration,this.viewInfo.totalPartDuration=t.totalPartDuration,this.viewInfo.partType=t.partType,this.viewInfo.chosenOpponent=t.chosenOpponent?.name,this.viewInfo.firstPlayer=t.firstPlayer),t.partType){case"CUSTOM":this.viewInfo.partTypeName=$localize`custom`;break;case"BLITZ":this.viewInfo.partTypeName=$localize`blitz`;break;case"STANDARD":this.viewInfo.partTypeName=$localize`standard`}}setDataForCreator(t){this.viewInfo.maximalMoveDuration=this.viewInfo.maximalMoveDuration??t.maximalMoveDuration,this.viewInfo.totalPartDuration=this.viewInfo.totalPartDuration??t.totalPartDuration;let e=this.viewInfo.chosenOpponent;null==e||""===e?e=t.chosenOpponent?.name??"":!1===this.candidates.some(s=>s.name===e)&&(e=""),this.getForm("chosenOpponent").setValue(e)}selectFirstPlayer(t){this.getForm("firstPlayer").setValue(t)}selectPartType(t){"STANDARD"===t?(this.getForm("maximalMoveDuration").setValue(br.NORMAL_MOVE_DURATION),this.getForm("totalPartDuration").setValue(br.NORMAL_PART_DURATION)):"BLITZ"===t&&(this.getForm("maximalMoveDuration").setValue(br.BLITZ_MOVE_DURATION),this.getForm("totalPartDuration").setValue(br.BLITZ_PART_DURATION)),this.getForm("partType").setValue(t)}selectOpponent(t){var e=this;return A(function*(){K(f1.VERBOSE,"PartCreationComponent.setChosenOpponent("+t+")");const r=e.getUserFromName(t);yield Promise.all([e.observedPartService.updateObservedPart({opponent:r}),e.configRoomService.setChosenOpponent(e.partId,r)])})()}getUserFromName(t){const e=this.candidates.find(r=>r.name===t);return we.getNonNullable(e)}changeConfig(){var t=this;return A(function*(){return t.configRoomService.reviewConfig(t.partId)})()}proposeConfig(){var t=this;return A(function*(){const e=t.getForm("chosenOpponent").value,r=t.getForm("partType").value,s=t.getForm("maximalMoveDuration").value,i=t.getForm("firstPlayer").value,o=t.getForm("totalPartDuration").value,c=t.getUserFromName(e);return t.configRoomService.proposeConfig(t.partId,c,br.of(r),s,js.of(i),o)})()}cancelGameCreation(){var t=this;return A(function*(){t.allDocDeleted=!0,yield t.observedPartService.removeObservedPart(),K(f1.VERBOSE,"PartCreationComponent.cancelGameCreation"),yield t.chatService.deleteChat(t.partId),K(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat deleted"),yield t.gameService.deletePart(t.partId),K(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat and part deleted"),yield t.configRoomService.deleteConfigRoom(t.partId,t.candidates),K(f1.VERBOSE,"PartCreationComponent.cancelGameCreation: chat, part, and configRoom deleted")})()}onCurrentConfigRoomUpdate(t){var e=this;return A(function*(){if(K(f1.VERBOSE,{PartCreationComponent_onCurrentConfigRoomUpdate:{before:JSON.stringify(e.currentConfigRoom),then:JSON.stringify(t)}}),t.isAbsent())return K(f1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: LAST UPDATE : the game is cancelled"),e.onGameCancelled();{const r=t.get();if(e.chosenOpponentJustLeft(r)&&e.userIsCreator(r)){const i=we.getNonNullable(e.currentConfigRoom),o=we.getNonNullable(i.chosenOpponent).name;e.messageDisplayer.infoMessage($localize`${o} left the game, please pick another opponent.`),yield e.observedPartService.updateObservedPart({opponent:null})}let s=!1;e.userJustChosenAsOpponent(r)&&(yield e.updateUserDocWithObservedPart(r),s=!0),e.currentConfigRoom=r,e.allUserInterval.isAbsent()&&(ye(!1===s,"Expected observedPartUpdate to be false at first call of onCurrentConfigRoomUpdate"),yield e.updateUserDocWithObservedPart(e.currentConfigRoom),yield e.observeNeededPlayers()),e.updateViewInfo(),e.isGameStarted(e.currentConfigRoom)&&(K(f1.VERBOSE,"PartCreationComponent.onCurrentConfigRoomUpdate: the game has started"),e.onGameStarted())}})()}onCandidatesUpdate(t){var e=this;return A(function*(){e.candidates=t,e.updateViewInfo()})()}userJustChosenAsOpponent(t){if(this.isGameStarted(t))return!1;const e=this.connectedUserService.user.get().id;return this.currentConfigRoom?.chosenOpponent?.id!==e&&t.chosenOpponent?.id===e}chosenOpponentJustLeft(t){return null!=this.currentConfigRoom&&(null!=this.currentConfigRoom.chosenOpponent&&null==t.chosenOpponent)}onGameCancelled(){var t=this;return A(function*(){K(f1.VERBOSE,"PartCreationComponent.onGameCancelled"),t.messageDisplayer.infoMessage($localize`The game has been canceled!`),yield t.router.navigate(["/lobby"])})()}isGameStarted(t){return ye(null!=t,"configRoom should not be null (isGameStarted)"),we.getNonNullable(t).partStatus===Zs.PART_STARTED.value}onGameStarted(){const t=we.getNonNullable(this.currentConfigRoom);K(f1.VERBOSE,{partCreationComponent_onGameStarted:{configRoom:t}}),this.gameStartNotification.emit(t),this.gameStarted=!0,K(f1.VERBOSE,"PartCreationComponent.onGameStarted finished")}observeNeededPlayers(){var t=this;return A(function*(){const e=we.getNonNullable(t.currentConfigRoom);K(f1.VERBOSE,{PartCreationComponent_observeNeededPlayers:{configRoom:e}}),ye(t.allUserInterval.isAbsent(),"Cannot observe players multiple times"),t.allUserInterval=P.of(window.setInterval(A(function*(){const r=t.lastToken;t.userIsCreator(e)?yield t.checkCandidatesTokensFreshness(r):yield t.checkCreatorTokenFreshness(r)}),f1.TOKEN_INTERVAL))})()}userIsCreator(t){return this.connectedUserService.user.get().id===t.creator.id}checkCreatorTokenFreshness(t){var e=this;return A(function*(){const r=we.getNonNullable(e.currentConfigRoom);(yield e.didUserTimeout(r.creator.id,t))&&(yield e.destroyDocIfPartDidNotStart())})()}destroyDocIfPartDidNotStart(){var t=this;return A(function*(){ye(!1===t.isGameStarted(t.currentConfigRoom),"Should not try to cancelGameCreation when part started!"),ye(!1===t.allDocDeleted,"Should not delete doc twice"),yield t.cancelGameCreation()})()}checkCandidatesTokensFreshness(t){var e=this;return A(function*(){for(const r of e.candidates)(yield e.didUserTimeout(r.id,t))&&(yield e.removeCandidateFromLobby(r))})()}didUserTimeout(t,e){var r=this;return A(function*(){const s=yield r.userService.getUserLastUpdateTime(t);return s.isAbsent()?(bs.logError("PartCreationComponent","found no user while observing "+t+" !"),!0):Q3e(s.get(),e)>f1.TOKEN_TIMEOUT})()}removeCandidateFromLobby(t){var e=this;return A(function*(){const r=we.getNonNullable(e.currentConfigRoom);return t.id===r.chosenOpponent?.id&&(yield e.configRoomService.reviewConfigAndRemoveChosenOpponent(e.partId)),e.configRoomService.removeCandidate(e.partId,t)})()}startSendingPresenceTokens(){var t=this;return A(function*(){yield t.connectedUserService.sendPresenceToken(),ye(t.ownTokenInterval.isAbsent(),"should not start sending presence tokens twice"),t.ownTokenInterval=P.of(window.setInterval(()=>{t.connectedUserService.sendPresenceToken()},f1.TOKEN_INTERVAL));const e=t.connectedUserService.user.get().id;t.selfSubscription=t.userService.observeUser(e,r=>{ye(r.isPresent(),"connected user should exist");const s=r.get();null!=s.lastUpdateTime&&(t.lastToken=s.lastUpdateTime)})})()}stopSendingPresenceTokensAndObservingUsersIfNeeded(){this.ownTokenInterval.isPresent()&&(window.clearInterval(this.ownTokenInterval.get()),this.ownTokenInterval=P.empty()),this.allUserInterval.isPresent()&&window.clearInterval(this.allUserInterval.get()),this.selfSubscription.unsubscribe()}acceptConfig(){return K(f1.VERBOSE,"PartCreationComponent.acceptConfig"),this.gameService.acceptConfig(this.partId,we.getNonNullable(this.currentConfigRoom))}ngOnDestroy(){var t=this;return A(function*(){K(f1.VERBOSE,"PartCreationComponent.ngOnDestroy"),t.ngUnsubscribe.next(),t.ngUnsubscribe.complete(),t.configRoomSubscription.unsubscribe(),t.candidatesSubscription.unsubscribe(),t.stopSendingPresenceTokensAndObservingUsersIfNeeded();const e=t.connectedUserService.user.get();!0!==t.gameStarted&&(null===t.currentConfigRoom?K(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: there is no part here"):!0===t.allDocDeleted?K(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: part has already been deleted"):e.id===t.currentConfigRoom.creator.id?(K(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: you(creator) about to cancel creation."),yield t.cancelGameCreation()):(K(f1.VERBOSE,"PartCreationComponent.ngOnDestroy: you are about to cancel game joining"),yield t.observedPartService.removeObservedPart(),yield t.configRoomService.cancelJoining(t.partId)))})()}}function oft(n,t){if(1&n){const e=Oe();b(0,"button",3),J("click",function(){return fe(e),ae(v().addTime())}),me(1,4),O()}if(2&n){const e=v();S(1),I1(e.timeToAdd),H1(1)}}f1.VERBOSE=!1,f1.TOKEN_INTERVAL=5e3,f1.TOKEN_TIMEOUT=2*f1.TOKEN_INTERVAL,f1.\u0275fac=function(t){return new(t||f1)(Q(jn),Q(So),Q(Os),Q(w2),Q(SS),Q(Fz),Q(CS),Q(um),Q(o7e),Q(Tn))},f1.\u0275cmp=gt({type:f1,selectors:[["app-part-creation"]],inputs:{partId:"partId"},outputs:{gameStartNotification:"gameStartNotification"},decls:1,vars:1,consts:function(){let n,t,e,r,s,i,o,c,u,h,p,m,C,w,I,H,Y,ee,ve,te,Ie,Be,Ye,Vt,R1,b1,rs,Bc,Fo,D2,Zn,g6,Et,Gt,Kt,s1;return n=$localize`Game creation`,t=$localize`First player`,e=$localize`Random`,r=$localize`You`,s=$localize`Game type`,i=$localize`Standard`,o=$localize`Maximal turn duration: `,c=$localize`Maximal game duration: ${"\ufffd#37\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#37\ufffd"}:CLOSE_TAG_STRONG:`,u=$localize`Blitz`,h=$localize`Maximal turn duration: `,p=$localize`Maximal game duration: ${"\ufffd#55\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#55\ufffd"}:CLOSE_TAG_STRONG:`,m=$localize`Custom`,C=$localize`Opponents`,w=$localize`Propose configuration`,I=$localize`Cancel game`,H=$localize`The opponent`,Y=$localize`Maximal turn duration: `,ee=$localize`Maximal game duration: ${"\ufffd#13\ufffd"}:START_TAG_OUTPUT:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#13\ufffd"}:CLOSE_TAG_OUTPUT:`,ve=$localize`Potential opponents that join the game will appear here.${"\ufffd#2\ufffd\ufffd/#2\ufffd"}:LINE_BREAK:Wait for an opponent to join, so that you can pick one.`,te=$localize`Click on the opponent against which you would like to play.`,Ie=$localize`Name`,Be=$localize`Actions`,Ye=$localize`Pick`,Vt=$localize`Change configuration`,R1=$localize`Configuration proposal`,b1=$localize`You have been selected as the opponent.${"\ufffd#3\ufffd\ufffd/#3\ufffd"}:LINE_BREAK: ${"\ufffd0\ufffd"}:INTERPOLATION: is modifying the configuration.`,rs=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: proposes to play a ${"\ufffd1\ufffd"}:INTERPOLATION_1: game`,Bc=$localize`a turn lasts at most ${"\ufffd#10\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: ${"\ufffd/#10\ufffd"}:CLOSE_TAG_STRONG:`,Fo=$localize`the game lasts at most ${"\ufffd#14\ufffd"}:START_TAG_STRONG:${"\ufffd0\ufffd"}:INTERPOLATION: per player${"\ufffd/#14\ufffd"}:CLOSE_TAG_STRONG:`,D2=$localize`Accept and start`,Zn=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: plays first`,g6=$localize`you play first`,Et=$localize`the first player is selected randomly`,Gt=$localize`One moment...`,Kt=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: is configuring the game.`,s1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has proposed a configuration to ${"\ufffd1\ufffd"}:INTERPOLATION_1:.`,[["class","box",4,"ngIf"],[1,"box"],[4,"ngIf"],["class","message is-primary",4,"ngIf"],[1,"title"],n,[3,"formGroup"],[3,"disabled"],[1,"field"],["for","firstPlayer",1,"label"],t,[1,"buttons","has-addons"],["id","firstPlayerRandom",1,"button",3,"ngClass","click"],e,["id","firstPlayerCreator",1,"button",3,"ngClass","click"],r,["id","firstPlayerOpponent",1,"button",3,"ngClass","click"],[4,"ngIf","ngIfElse"],["opponentWithoutName",""],s,["id","partTypeStandard",1,"button","dropdown","is-hoverable",3,"ngClass","click"],[1,"dropdown-trigger"],i,["role","menu",1,"dropdown-menu"],[1,"dropdown-content"],[1,"dropdown-item"],o,c,["id","partTypeBlitz",1,"button","dropdown","is-hoverable",3,"ngClass","click"],u,h,p,["id","partTypeCustom",1,"button",3,"ngClass","click"],m,["id","customTime",4,"ngIf"],[1,"label"],C,[1,"control"],["chooseOpponent",""],["id","proposeConfig",1,"button","is-primary",3,"disabled","click"],w,["class","button","id","reviewConfig",3,"click",4,"ngIf"],["id","cancel",1,"button",3,"click"],I,H,["id","customTime"],["for","maximalMoveDuration",1,"label"],Y,["step","10","min","10","max","300","name","maximalMoveDuration","formControlName","maximalMoveDuration","type","range",1,"slider","is-circle","is-primary"],["for","totalPartDuration",1,"label"],ee,["step","10","min","10","max","3600","name","totalPartDuration","formControlName","totalPartDuration","type","range",1,"slider","is-circle","is-primary"],ve,te,["id","chooseOpponent",1,"table-container"],[1,"table","is-fullwidth","is-hoverable","is-striped"],["scope","col",1,"th"],Ie,Be,[3,"id","ngClass","click",4,"ngFor","ngForOf"],[3,"id","ngClass","click"],[1,"td",3,"id"],[1,"td"],["class","button is-primary",4,"ngIf"],[1,"button","is-primary"],Ye,["id","reviewConfig",1,"button",3,"click"],Vt,[1,"message","is-primary"],[1,"message-header"],R1,[1,"message-body"],["class","content",4,"ngIf","ngIfElse"],["configProposal",""],[1,"content"],b1,rs,Bc,Fo,["id","acceptConfig",1,"button","is-primary",3,"click"],D2,Zn,g6,Et,Gt,["proposalSent",""],Kt,s1]},template:function(t,e){1&t&&x(0,ift,4,3,"div",0),2&t&&T("ngIf",e.viewInfo)},dependencies:[mn,Ln,nn,mu,g4,ky,bl,gu,_u,rf,F7t],encapsulation:2});let aft=(()=>{class n{constructor(){this.timeoutHandleGlobal=null,this.timeoutHandleSec=null,this.isPaused=!0,this.isSet=!1,this.started=!1,this.outOfTimeAction=new gr,this.addTimeToOpponent=new gr,this.cssClasses=n.SAFE_TIME}ngOnInit(){K(n.VERBOSE,"CountDownComponent.ngOnInit ("+this.debugName+")")}setDuration(e){K(n.VERBOSE,this.debugName+".set("+e+"ms)"),we.assert(!1===this.started,"Should not set a chrono that has already been started ("+this.debugName+")!"),this.isSet=!0,this.changeDuration(e)}changeDuration(e){let r=!1;!1===this.isPaused&&(this.pause(),r=!0),this.remainingMs=e,this.displayDuration(),r&&this.resume()}displayDuration(){this.displayedSec=this.remainingMs%6e4,this.displayedMinute=(this.remainingMs-this.displayedSec)/6e4,this.displayedSec=Math.floor(this.displayedSec/1e3)}start(){K(n.VERBOSE,this.debugName+".start("+this.remainingMs+"ms);"),we.assert(this.isSet,"Should not start a chrono that has not been set!"),we.assert(!1===this.started,"Should not start chrono that has already been started ("+this.debugName+")"),this.started=!0,this.resume()}resume(){K(n.VERBOSE,this.debugName+".resume("+this.remainingMs+"ms)"),we.assert(this.isPaused&&this.started,"Should only resume chrono that are started and paused!"),this.startTime=Date.now();const e=this.remainingMs;this.isPaused=!1,this.timeoutHandleGlobal=window.setTimeout(()=>{this.onEndReached()},e),this.countSeconds()}onEndReached(){K(n.VERBOSE,this.debugName+".onEndReached"),this.isPaused=!0,this.started=!1,this.clearTimeouts(),this.changeDuration(0),this.outOfTimeAction.emit()}countSeconds(){this.timeoutHandleSec=window.setTimeout(()=>{this.updateShownTime()},1e3)}isIdle(){return!1===this.started||this.isPaused}pause(){K(n.VERBOSE,this.debugName+".pause("+this.remainingMs+"ms)"),we.assert(this.started,"Should not pause not started chrono ("+this.debugName+")"),we.assert(!1===this.isPaused,"Should not pause already paused chrono ("+this.debugName+")"),this.clearTimeouts(),this.isPaused=!0,this.updateShownTime()}stop(){K(n.VERBOSE,this.debugName+".stop("+this.remainingMs+"ms)"),we.assert(this.started,"Should only stop chrono that are started!"),this.pause(),this.started=!1,this.isSet=!1}isStarted(){return this.started}getTimeClass(){return!1===this.active?n.PASSIVE_STYLE:this.remainingMs<this.dangerTimeLimit?this.remainingMs%2e3<1e3?n.DANGER_TIME_ODD:n.DANGER_TIME_EVEN:n.SAFE_TIME}updateShownTime(){const e=Date.now();this.remainingMs-=e-this.startTime,this.displayDuration(),this.cssClasses=this.getTimeClass(),this.startTime=e,!1===this.isPaused&&this.countSeconds()}clearTimeouts(){K(n.VERBOSE,this.debugName+".clearTimeouts"),null!=this.timeoutHandleSec&&(window.clearTimeout(this.timeoutHandleSec),this.timeoutHandleSec=null),null!=this.timeoutHandleGlobal&&(window.clearTimeout(this.timeoutHandleGlobal),this.timeoutHandleGlobal=null)}addTime(){this.addTimeToOpponent.emit()}ngOnDestroy(){this.clearTimeouts()}}return n.VERBOSE=!1,n.DANGER_TIME_EVEN="has-background-danger has-text-white",n.DANGER_TIME_ODD="has-background-warning has-text-white",n.PASSIVE_STYLE="has-text-passive is-italic",n.SAFE_TIME="",n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-count-down"]],inputs:{debugName:"debugName",timeToAdd:"timeToAdd",dangerTimeLimit:"dangerTimeLimit",active:"active",canAddTime:"canAddTime"},outputs:{outOfTimeAction:"outOfTimeAction",addTimeToOpponent:"addTimeToOpponent"},decls:5,vars:7,consts:function(){let t;return t=$localize`Add ${"\ufffd0\ufffd"}:INTERPOLATION:`,[[3,"ngClass"],["id","remainingTime"],["id","addTimeButton","class","button is-small is-fullwidth",3,"click",4,"ngIf"],["id","addTimeButton",1,"button","is-small","is-fullwidth",3,"click"],t]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),Pt(2),_c(3,"number"),O(),x(4,oft,2,1,"button",2),O()),2&e&&(T("ngClass",r.getTimeClass()),S(2),WC("",r.displayedMinute,":",$$(3,4,r.displayedSec,"2.0-0"),""),S(2),T("ngIf",r.canAddTime))},dependencies:[mn,nn,pG],encapsulation:2}),n})();const cft=["partCreation"],lft=["chatComponent"],uft=["chronoZeroGlobal"],fft=["chronoOneGlobal"],hft=["chronoZeroTurn"],dft=["chronoOneTurn"];function pft(n,t){if(1&n){const e=Oe();b(0,"app-part-creation",5,6),J("gameStartNotification",function(s){return fe(e),ae(v().startGame(s))}),O()}2&n&&T("partId",v().currentPartId)}function gft(n,t){1&n&&(ln(0),b(1,"span",41),me(2,42),O(),un())}function mft(n,t){if(1&n&&(b(0,"span",43),me(1,44),O()),2&n){const e=v(4);S(1),I1(null==e.currentPlayer?null:e.currentPlayer.name),H1(1)}}function _ft(n,t){if(1&n&&(b(0,"p",38),x(1,gft,3,0,"ng-container",39),x(2,mft,2,1,"ng-template",null,40,c1),O()),2&n){const e=t1(3),r=v(3);S(1),T("ngIf",(null==r.currentPlayer?null:r.currentPlayer.name)===r.getPlayer().name)("ngIfElse",e)}}function vft(n,t){if(1&n&&(b(0,"div",34)(1,"p",35),me(2,36),O(),x(3,_ft,4,2,"p",37),O()),2&n){const e=v(2);S(2),I1(e.currentPart.getTurn()+1),H1(2),S(1),T("ngIf",!1===e.endGame)}}function Cft(n,t){if(1&n&&(b(0,"p",45),Pt(1),O()),2&n){const e=v(2);T("ngClass",e.getPlayerNameClass(e.Player.ZERO)),S(1),a1(e.players[0].get().name)}}function yft(n,t){if(1&n&&(b(0,"p",46),me(1,47),O()),2&n){const e=v(2);S(1),I1(e.gameComponent.scores.get()[0]),H1(1)}}function Eft(n,t){if(1&n&&(b(0,"p",48),Pt(1),O()),2&n){const e=v(2);T("ngClass",e.getPlayerNameClass(e.Player.ONE)),S(1),a1(e.players[1].get().name)}}function Mft(n,t){if(1&n&&(b(0,"p",49),me(1,50),O()),2&n){const e=v(2);S(1),I1(e.gameComponent.scores.get()[1]),H1(1)}}function Sft(n,t){if(1&n){const e=Oe();b(0,"button",59),J("click",function(){return fe(e),ae(v(3).resign())}),me(1,60),O()}}function Pft(n,t){if(1&n){const e=Oe();b(0,"button",61),J("click",function(){return fe(e),ae(v(3).proposeDraw())}),me(1,62),O()}}function Tft(n,t){if(1&n){const e=Oe();b(0,"button",63),J("click",function(){return fe(e),ae(v(3).acceptDraw())}),me(1,64),O()}}function wft(n,t){if(1&n){const e=Oe();b(0,"button",65),J("click",function(){return fe(e),ae(v(3).refuseDraw())}),me(1,66),O()}}function bft(n,t){if(1&n){const e=Oe();b(0,"button",67),J("click",function(){return fe(e),ae(v(3).gameComponent.pass())}),me(1,68),O()}}function Oft(n,t){if(1&n){const e=Oe();b(0,"button",69),J("click",function(){return fe(e),ae(v(3).acceptTakeBack())}),me(1,70),O()}}function Nft(n,t){if(1&n){const e=Oe();b(0,"button",71),J("click",function(){return fe(e),ae(v(3).refuseTakeBack())}),me(1,72),O()}}function Aft(n,t){if(1&n){const e=Oe();b(0,"button",73),J("click",function(){return fe(e),ae(v(3).askTakeBack())}),me(1,74),O()}}function Ift(n,t){if(1&n&&(ln(0),x(1,Sft,2,0,"button",51),x(2,Pft,2,0,"button",52),x(3,Tft,2,0,"button",53),x(4,wft,2,0,"button",54),x(5,bft,2,0,"button",55),x(6,Oft,2,0,"button",56),x(7,Nft,2,0,"button",57),x(8,Aft,2,0,"button",58),un()),2&n){const e=v(2);S(1),T("ngIf",e.canResign()),S(1),T("ngIf",e.canProposeDraw()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForDrawResponse()),S(1),T("ngIf",!1===e.endGame&&e.isPlaying()&&e.gameComponent.canPass&&(null==e.currentPlayer?null:e.currentPlayer.name)===e.getPlayer().name),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),S(1),T("ngIf",!1===e.endGame&&e.isOpponentWaitingForTakeBackResponse()),S(1),T("ngIf",!1===e.endGame&&!1===e.isOpponentWaitingForTakeBackResponse()&&e.canAskTakeBack())}}function xft(n,t){1&n&&(b(0,"div")(1,"p",76),me(2,77),O()())}function kft(n,t){1&n&&(b(0,"p",81),me(1,82),O())}function Lft(n,t){1&n&&(b(0,"p",83),me(1,84),O())}function Rft(n,t){1&n&&(b(0,"p",85),me(1,86),O())}function Dft(n,t){if(1&n&&(b(0,"div"),x(1,kft,2,0,"p",78),x(2,Lft,2,0,"p",79),x(3,Rft,2,0,"p",80),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getDrawAccepter().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getDrawAccepter().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function zft(n,t){1&n&&(b(0,"p",90),me(1,91),O())}function Vft(n,t){1&n&&(b(0,"p",92),me(1,93),O())}function Hft(n,t){if(1&n&&(b(0,"p",94),me(1,95),O()),2&n){const e=v(4);S(1),I1(e.currentPart.getWinner().get().name),H1(1)}}function Fft(n,t){if(1&n&&(b(0,"div"),x(1,zft,2,0,"p",87),x(2,Vft,2,0,"p",88),x(3,Hft,2,1,"p",89),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function Bft(n,t){if(1&n&&(b(0,"p",90),me(1,96),O()),2&n){const e=v(4);S(1),I1(e.currentPart.getLoser().get().name),H1(1)}}function $ft(n,t){1&n&&(b(0,"p",94),me(1,97),O())}function Uft(n,t){if(1&n&&(b(0,"p",94),me(1,98),O()),2&n){const e=v(4);S(1),I1(e.currentPart.getLoser().get().name),H1(1)}}function Gft(n,t){if(1&n&&(b(0,"div"),x(1,Bft,2,1,"p",87),x(2,$ft,2,0,"p",89),x(3,Uft,2,1,"p",89),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name===e.getPlayer().name),S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying())}}function Wft(n,t){1&n&&(b(0,"p",100),me(1,101),O())}function qft(n,t){if(1&n&&(b(0,"p",100),me(1,102),O()),2&n){const e=v(4);S(1),I1(e.currentPart.getLoser().get().name),H1(1)}}function jft(n,t){if(1&n&&(b(0,"div"),x(1,Wft,2,0,"p",99),x(2,qft,2,1,"p",99),O()),2&n){const e=v(3);S(1),T("ngIf",e.currentPart.getWinner().get().name!==e.getPlayer().name&&e.isPlaying()),S(1),T("ngIf",!1===e.isPlaying()||e.currentPart.getWinner().get().name===e.getPlayer().name)}}function Zft(n,t){if(1&n&&(b(0,"div",75),X(1,"hr"),x(2,xft,3,0,"div",26),x(3,Dft,4,3,"div",26),x(4,Fft,4,3,"div",26),x(5,Gft,4,3,"div",26),x(6,jft,3,2,"div",26),O()),2&n){const e=v(2);S(2),T("ngIf",e.currentPart.isHardDraw()),S(1),T("ngIf",e.currentPart.isAgreedDraw()),S(1),T("ngIf",e.currentPart.isWin()),S(1),T("ngIf",e.currentPart.isTimeout()),S(1),T("ngIf",e.currentPart.isResign())}}function Yft(n,t){1&n&&(b(0,"button",103),me(1,104),O())}function Kft(n,t){if(1&n){const e=Oe();b(0,"button",105),J("click",function(){return fe(e),ae(v(2).proposeRematch())}),me(1,106),O()}}function Xft(n,t){if(1&n){const e=Oe();b(0,"button",107),J("click",function(){return fe(e),ae(v(2).acceptRematch())}),me(1,108),O()}}function Qft(n,t){if(1&n){const e=Oe();b(0,"div",7)(1,"div",8)(2,"div",9),x(3,vft,4,2,"div",10),b(4,"div",11),x(5,Cft,2,2,"p",12),x(6,yft,2,1,"p",13),b(7,"app-count-down",14,15),J("outOfTimeAction",function(){fe(e);const s=v();return ae(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return fe(e),ae(v().addGlobalTime())}),O(),b(9,"app-count-down",16,17),J("outOfTimeAction",function(){fe(e);const s=v();return ae(s.reachedOutOfTime(s.Player.ZERO))})("addTimeToOpponent",function(){return fe(e),ae(v().addTurnTime())}),O()(),b(11,"p",18),me(12,19),O(),b(13,"div",11),x(14,Eft,2,2,"p",20),x(15,Mft,2,1,"p",21),b(16,"app-count-down",22,23),J("outOfTimeAction",function(){fe(e);const s=v();return ae(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return fe(e),ae(v().addGlobalTime())}),O(),b(18,"app-count-down",24,25),J("outOfTimeAction",function(){fe(e);const s=v();return ae(s.reachedOutOfTime(s.Player.ONE))})("addTimeToOpponent",function(){return fe(e),ae(v().addTurnTime())}),O()(),X(20,"hr"),x(21,Ift,9,8,"ng-container",26),x(22,Zft,7,5,"div",27),x(23,Yft,2,0,"button",28),x(24,Kft,2,0,"button",29),x(25,Xft,2,0,"button",30),O()(),b(26,"div",31)(27,"div",32),X(28,"div",null,33),O()()()}if(2&n){const e=v();S(3),T("ngIf",null!==e.currentPart),S(2),T("ngIf",e.players[0].isPresent()),S(1),T("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),S(1),T("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),S(2),T("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==0)("canAddTime",e.role===e.Player.ONE&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),S(5),T("ngIf",e.players[1].isPresent()),S(1),T("ngIf",null!==e.currentPart&&e.gameComponent&&e.gameComponent.scores.isPresent()),S(1),T("dangerTimeLimit",6e4)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.globalTimeMessage),S(2),T("dangerTimeLimit",15e3)("active",null!==e.currentPart&&e.currentPart.getTurn()%2==1)("canAddTime",e.role===e.Player.ZERO&&!1===e.endGame)("timeToAdd",e.turnTimeMessage),S(3),T("ngIf",e.isPlaying()),S(1),T("ngIf",e.endGame&&null!==e.currentPart),S(1),T("ngIf",e.endGame),S(1),T("ngIf",e.endGame&&e.isPlaying()&&!1===e.rematchProposed),S(1),T("ngIf",e.endGame&&e.isPlaying()&&e.rematchProposed&&e.opponentProposedRematch),S(1),T("ngClass",e.getBoardHighlight())}}let Jft=(()=>{class n{}return n.NO_MATCHING_PART=()=>$localize`The game you tried to join does not exist.`,n})();class Un{constructor(t){this.value=t}}Un.PRE_START_DOC=new Un("PRE_START_DOC"),Un.STARTING_DOC=new Un("STARTING_DOC"),Un.DUPLICATE=new Un("DUPLICATE"),Un.MOVE_WITHOUT_TIME=new Un("MOVE_WITHOUT_TIME"),Un.MOVE=new Un("MOVE"),Un.REQUEST=new Un("REQUEST"),Un.END_GAME=new Un("END_GAME"),Un.END_GAME_WITHOUT_TIME=new Un("END_GAME_WITHOUT_TIME"),Un.ACCEPT_TAKE_BACK_WITHOUT_TIME=new Un("ACCEPT_TAKE_BACK_WITHOUT_TIME");let e9t=(()=>{class n extends qP{constructor(e,r,s,i,o,c,u,h){super(e,r,s,i,o),this.observedPartService=c,this.userService=u,this.gameService=h,this.currentPart=null,this.gameStarted=!1,this.opponent=null,this.currentPlayer=null,this.rematchProposed=!1,this.opponentProposedRematch=!1,this.userLinkedToThisPart=!0,this.observedPart=P.empty(),this.hasUserPlayed=[!1,!1],this.msToSubstract=[0,0],this.opponentSubscription=new q1,this.partSubscription=new q1,this.observedPartSubscription=new q1,this.OFFLINE_FONT_COLOR={color:"lightgrey"},this.globalTimeMessage=$localize`5 minutes`,this.turnTimeMessage=$localize`30 seconds`,this.onCurrentUpdateOngoing=!1,K(n.VERBOSE,"OnlineGameWrapperComponent constructed")}extractPartIdFromURL(){return we.getNonNullable(this.actRoute.snapshot.paramMap.get("id"))}extractGameNameFromURL(){return we.getNonNullable(this.actRoute.snapshot.paramMap.get("compo"))}isPlaying(){return this.role.isPlayer()}getPlayer(){return this.authUser.toMinimalUser()}isPlayer(e){return this.role===e}redirectIfPartOrGameIsInvalid(){var e=this;return A(function*(){const r=e.extractGameNameFromURL();if(L9.ALL_GAMES().some(i=>i.urlName===r)){if((yield e.gameService.getPartValidity(e.currentPartId,r)).isFailure()){e.routerEventsSubscription.unsubscribe();const o=Jft.NO_MATCHING_PART();yield e.router.navigate(["/notFound",o],{skipLocationChange:!0})}}else{e.routerEventsSubscription.unsubscribe();const i=R9.NO_MATCHING_GAME(r);yield e.router.navigate(["/notFound",i],{skipLocationChange:!0})}})()}setCurrentPartIdOrRedirect(){return this.currentPartId=this.extractPartIdFromURL(),this.redirectIfPartOrGameIsInvalid()}ngOnInit(){var e=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit"),e.routerEventsSubscription=e.router.events.subscribe(function(){var r=A(function*(s){s instanceof y0&&(yield e.setCurrentPartIdOrRedirect())});return function(s){return r.apply(this,arguments)}}()),e.userSubscription=e.connectedUserService.subscribeToUser(r=>{e.authUser=r}),yield e.setCurrentPartIdOrRedirect(),e.observedPartSubscription=e.observedPartService.subscribeToObservedPart(function(){var r=A(function*(s){yield e.onObservedPartUpdate(s)});return function(s){return r.apply(this,arguments)}}()),K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnInit done")})()}onObservedPartUpdate(e){var r=this;return A(function*(){if(K(n.VERBOSE,"OnlineGameWrapperComponent.onObservedPartUpdate called"),e.isPresent()){const s=e.get();"Observer"===s.role||s.id===r.currentPartId?r.observedPart=e:(r.userLinkedToThisPart=!1,yield r.router.navigate(["/lobby"]))}else r.observedPart=P.empty()})()}getObservedPart(){return this.observedPart}startGame(e){var r=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.startGame"),ye(!1===r.gameStarted,"Should not start already started game"),r.configRoom=e,r.gameStarted=!0,window.setTimeout(A(function*(){ye(yield r.afterViewInit(),"Game should be created successfully, otherwise part-creation would have redirected"),r.startPart()}),2)})()}startPart(){var e=this;K(n.VERBOSE,"OnlineGameWrapperComponent.startPart"),this.partSubscription=this.gameService.subscribeToChanges(this.currentPartId,function(){var r=A(function*(s){ye(s.isPresent(),"OnlineGameWrapper observed a part being deleted, this should not happen"),yield e.onCurrentPartUpdate(s.get())});return function(s){return r.apply(this,arguments)}}())}onCurrentPartUpdate(e,r=5){var s=this;return A(function*(){const i=new ES(s.currentPartId,e);if(K(n.VERBOSE,{OnlineGameWrapperComponent_onCurrentPartUpdate:{before:s.currentPart,then:e,before_part_turn:i.data.turn,before_state_turn:s.gameComponent.rules.node.gameState.turn,nbPlayedMoves:i.data.listMoves.length}}),s.onCurrentUpdateOngoing)return ye((r-=1)>0,"Update took more than 5sec to be handled by the component!"),void window.setTimeout(A(function*(){yield s.onCurrentPartUpdate(e,r)}),1e3);s.onCurrentUpdateOngoing=!0;const o=s.getUpdateTypes(i),c=e.turn;o.includes(Un.REQUEST)?K(n.VERBOSE,"UpdateType: Request("+we.getNonNullable(i.data.request).code+") ("+c+")"):K(n.VERBOSE,"UpdateType: "+o.map(h=>h.value)+"("+c+")");const u=s.currentPart;s.currentPart=i;for(const h of o)yield s.applyUpdate(h,i,u);s.onCurrentUpdateOngoing=!1})()}applyUpdate(e,r,s){var i=this;return A(function*(){switch(e){case Un.REQUEST:return yield i.onRequest(we.getNonNullable(r.data.request),s);case Un.ACCEPT_TAKE_BACK_WITHOUT_TIME:return void(i.currentPart=s);case Un.DUPLICATE:return;case Un.END_GAME_WITHOUT_TIME:return void(i.currentPart=s);case Un.END_GAME:return i.applyEndGame();case Un.MOVE_WITHOUT_TIME:const o=we.getNonNullable(i.currentPart),c=we.getNonNullable(s);return void(o.data={...o.data,turn:o.data.turn-1,lastUpdate:c.data.lastUpdate,lastUpdateTime:c.data.lastUpdateTime,listMoves:o.data.listMoves.slice(0,o.data.listMoves.length-1)});case Un.MOVE:return i.msToSubstract=i.getLastUpdateTime(s,r),i.doNewMoves(r);case Un.PRE_START_DOC:return;default:return ye(e===Un.STARTING_DOC,"Unexpected update type "+e),i.startCountDown(r)}})()}startCountDown(e){var r=this;return A(function*(){r.setChronos(),yield r.setPlayersDatas(e),r.startCountDownFor(0===e.data.listMoves.length?z.ZERO:z.fromTurn(e.data.turn-1))})()}getUpdateTypes(e){const r=null!=this.currentPart?this.currentPart.data:null,s=D9.from(r,e.data),i=[];if(K(n.VERBOSE,{currentPartDoc:r,update:e,diff:s}),0===s.countChanges()&&i.push(Un.DUPLICATE),s.isFullyCreated()&&s.isPresent("beginning").present&&i.push(Un.STARTING_DOC),e.data.request){const c=null!=s.removed.lastUpdateTime;i.push("TakeBackAccepted"===e.data.request.code&&c?Un.ACCEPT_TAKE_BACK_WITHOUT_TIME:Un.REQUEST)}if(null==r?"added"===s.isPresent("listMoves").state&&e.data.turn>0&&i.push(this.getMoveUpdateType(e,s)):this.turnHasIncreased(r.turn,e.data.turn,e.data.listMoves)&&i.push(this.getMoveUpdateType(e,s)),null==e.data.beginning&&i.push(Un.PRE_START_DOC),s.isPresent("result").present&&e.data.result!==Rn.UNACHIEVED.value){const c=null!=s.modified.turn,u=!1===s.addedOrModified("lastUpdateTime");i.push(c&&u?Un.END_GAME_WITHOUT_TIME:Un.END_GAME)}return i}getMoveUpdateType(e,r){return 1===e.data.turn?null==e.data.lastUpdateTime?Un.MOVE_WITHOUT_TIME:Un.MOVE:null==r.modified.lastUpdateTime&&null==r.added.lastUpdateTime?Un.MOVE_WITHOUT_TIME:Un.MOVE}turnHasIncreased(e,r,s){return ye(s.length===r,"ListMoves size and newTurn do not match, it is impossible!"),e<r}getLastUpdateTime(e,r){if(null==e)return[0,0];const s=this.getMoreRecentTime(e),i=this.getMoreRecentTime(r);ye(null!=s,"oldTime should not be null"),ye(null!=i,"updateTime should not be null");const o=z.fromTurn(e.data.turn);return this.getTimeUsedForLastTurn(we.getNonNullable(s),we.getNonNullable(i),o)}getMoreRecentTime(e){return e.data.lastUpdateTime??e.data.beginning}getTimeUsedForLastTurn(e,r,s){const i=Q3e(e,r),o=[0,0];return o[s.value]=i,o}setChronos(){K(n.VERBOSE,"onlineGameWrapperComponent.setChronos()"),this.chronoZeroGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoOneGlobal.setDuration(1e3*this.configRoom.totalPartDuration),this.chronoZeroTurn.setDuration(1e3*this.configRoom.maximalMoveDuration),this.chronoOneTurn.setDuration(1e3*this.configRoom.maximalMoveDuration)}didUserPlay(e){return this.hasUserPlayed[e.value]}doNewMoves(e){K(n.VERBOSE,"OnlineGameWrapperComponent.doNewMoves"+JSON.stringify(e)),this.switchPlayer();const r=Ke.copyImmutableArray(e.data.listMoves),s=this.gameComponent.rules;for(;this.gameComponent.getTurn()<r.length;){const i=this.gameComponent.getTurn(),o=this.gameComponent.encoder.decode(r[i]),c=s.isLegal(o,this.gameComponent.getState()),u=JSON.stringify(r),h="We received an incorrect db move: "+o.toString()+" in "+u+" at turn "+i+'because "'+c.getReasonOr("")+'"';ye(c.isSuccess(),h,r),s.choose(o)}this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get(),this.gameComponent.updateBoard()}switchPlayer(){K(n.VERBOSE,"OnlineGameWrapperComponent.switchPlayer");const e=we.getNonNullable(this.currentPart),r=z.fromTurn(e.data.turn);this.currentPlayer=this.players[this.gameComponent.getTurn()%2].get();const s=r.getOpponent();this.pauseCountDownsFor(s),this.didUserPlay(r)?(K(n.VERBOSE,"OnlineGameWrapperComponent.onCurrentPartUpdate: changing current player"),this.resumeCountDownFor(r)):this.startCountDownFor(r)}resetChronoFor(e){this.pauseCountDownsFor(e),this.resumeCountDownFor(e)}applyEndGame(){var e=this;return A(function*(){yield e.observedPartService.removeObservedPart();const r=we.getNonNullable(e.currentPart),s=z.fromTurn(r.data.turn);if(e.endGame=!0,!1===[Rn.VICTORY,Rn.HARD_DRAW].some(c=>c.value===r.data.result)){ye(!0===[Rn.RESIGN,Rn.TIMEOUT,Rn.HARD_DRAW,Rn.AGREED_DRAW_BY_ZERO,Rn.AGREED_DRAW_BY_ONE].some(p=>p.value===r.data.result),"Unknown type of end game ("+r.data.result+")");const h="endGame is true and winner is "+r.getWinner().getOrElse({id:"fake",name:"no one"}).name;K(n.VERBOSE,h)}e.stopCountdownsFor(s)})()}notifyDraw(e,r){return this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!0)}notifyTimeoutVictory(e,r,s,i){var o=this;return A(function*(){o.endGame=!0;const c=we.getNonNullable(o.currentPart).setWinnerAndLoser(e,i);o.currentPart=c,yield o.gameService.notifyTimeout(o.currentPartId,r,s,e,i)})()}notifyVictory(e,r){K(n.VERBOSE,"OnlineGameWrapperComponent.notifyVictory");const s=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node),i=we.getNonNullable(this.currentPart),o=this.players[0].get(),c=this.players[1].get();return s===xe.ONE_WON?this.currentPart=i.setWinnerAndLoser(c,o):(ye(s===xe.ZERO_WON,"impossible to get a victory without winner!"),this.currentPart=i.setWinnerAndLoser(o,c)),this.endGame=!0,this.gameService.updateDBBoard(this.currentPartId,this.role,e,[0,0],r,!1,this.currentPart.getWinner().get(),this.currentPart.getLoser().get())}canAskTakeBack(){ye(this.isPlaying(),"Non playing should not call canAskTakeBack"),ye(null!=this.currentPart,"should not call canAskTakeBack when currentPart is not defined yet");const e=we.getNonNullable(this.currentPart);return!(e.data.turn<=this.role.value||e.data.request&&"TakeBackRefused"===e.data.request.code&&this.role.isPlayer()&&e.data.request.data.player===this.role.getOpponent().value)&&this.getTakeBackRequester()===pe.NONE}isOpponentWaitingForTakeBackResponse(){const e=this.getTakeBackRequester();return!!e.isPlayer()&&e!==this.role}getTakeBackRequester(){const r=we.getNonNullable(this.currentPart).data.request;return r&&"TakeBackAsked"===r.code?Br.getPlayer(r):pe.NONE}canProposeDraw(){ye(this.isPlaying(),"Non playing should not call canProposeDraw");const e=we.getNonNullable(this.currentPart);return!(this.endGame||e.data.request&&"DrawRefused"===e.data.request.code&&this.role.isPlayer()&&Br.getPlayer(e.data.request)===this.role.getOpponent()||this.isOpponentWaitingForDrawResponse())&&this.getDrawRequester()===pe.NONE}isOpponentWaitingForDrawResponse(){const e=this.getDrawRequester();return e!==pe.NONE&&e!==this.role}getDrawRequester(){const r=we.getNonNullable(this.currentPart).data.request;return r&&"DrawProposed"===r.code?Br.getPlayer(r):pe.NONE}onRequest(e,r){var s=this;return A(function*(){switch(K(n.VERBOSE,{called:"OnlineGameWrapper.onRequest(",request:e,oldPart:r}),e.code){case"TakeBackAsked":case"TakeBackRefused":case"DrawProposed":case"DrawRefused":break;case"TakeBackAccepted":s.takeBackTo(we.getNonNullable(s.currentPart).data.turn);break;case"RematchProposed":s.rematchProposed=!0;const i=Br.getPlayer(e).getOpponent();s.isPlayer(i)&&(K(n.VERBOSE,"ton adversaire te propose une revanche"),s.opponentProposedRematch=!0);break;case"RematchAccepted":yield s.router.navigate(["/nextGameLoading"]),yield s.router.navigate(["/play",Br.getTypeGame(e),Br.getPartId(e)]);break;case"AddTurnTime":const o=3e4,c=z.of(e.data.player);s.addTurnTimeTo(c,o);break;default:we.expectToBe(e.code,"AddGlobalTime","Unknown RequestType : "+e.code+" for "+JSON.stringify(e));const u=3e5,h=z.of(e.data.player);s.addGlobalTimeTo(h,u)}})()}takeBackTo(e){if(K(n.VERBOSE,"OnlineGameWrapperComponent.takeBackTo"),this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.gameComponent.getTurn()===e)this.switchPlayer();else{this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get();const r=z.fromTurn(e);this.resetChronoFor(r)}this.gameComponent.updateBoard()}setPlayersDatas(e){var r=this;return A(function*(){K(n.VERBOSE,{OnlineGameWrapper_setPlayersDatas:e}),r.players=[P.of(e.data.playerZero),P.ofNullable(e.data.playerOne)],ye(null!=e.data.playerOne,"should not setPlayersDatas when players data is not received"),r.currentPlayer=r.players[e.data.turn%2].get();const s=yield r.setRealObserverRole();if(s.isPresent()){const i=o=>{ye(o.isPresent(),"opponent was deleted, what sorcery is this"),r.opponent=s.get()};r.opponentSubscription=r.userService.observeUser(s.get().id,i)}})()}setRealObserverRole(){var e=this;return A(function*(){let r=P.empty();return e.players[0].equalsValue(e.getPlayer())?(e.setRole(z.ZERO),r=e.players[1]):e.players[1].equalsValue(e.getPlayer())?(e.setRole(z.ONE),r=e.players[0]):e.setRole(pe.NONE),yield e.observedPartService.updateObservedPart({...e.observedPart.get(),role:e.role===pe.NONE?"Observer":"Player"}),r})()}onLegalUserMove(e,r){var s=this;return A(function*(){if(K(n.VERBOSE,"dans OnlineGameWrapperComponent.onLegalUserMove"),!s.isOpponentWaitingForTakeBackResponse())return s.updateDBBoard(e,s.msToSubstract,r);s.gameComponent.message("You must answer to take back request")})()}updateDBBoard(e,r,s){var i=this;return A(function*(){const o=i.gameComponent.encoder.encodeMove(e);K(n.VERBOSE,"OnlineGameWrapperComponent.updateDBBoard("+e.toString()+", "+s+")"),i.gameComponent.rules.choose(e);const c=i.gameComponent.rules.getGameStatus(i.gameComponent.rules.node);return c.isEndGame?c===xe.DRAW?i.notifyDraw(o,s):i.notifyVictory(o,s):i.gameService.updateDBBoard(i.currentPartId,i.role,o,r,s)})()}resign(){var e=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.resign");const r=e.getLastIndex(),s=e.role,i=e.getPlayer(),o=e.players[(e.role.value+1)%2].get();yield e.gameService.resign(e.currentPartId,r,s,o,i)})()}getLastIndex(){return we.getNonNullable(this.currentPart).data.lastUpdate.index}reachedOutOfTime(e){var r=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.reachedOutOfTime("+e+")");const s=r.getLastIndex(),i=r.role;if(r.stopCountdownsFor(e),!1===r.isPlaying())return;const o=we.getNonNullable(r.opponent);e===r.role?yield r.notifyTimeoutVictory(o,i,s,r.authUser.toMinimalUser()):(ye(!1===r.endGame,"time might be better handled in the future"),r.opponentIsOffline()&&(yield r.notifyTimeoutVictory(r.authUser.toMinimalUser(),i,e.value,o),r.endGame=!0))})()}acceptRematch(){var e=this;return A(function*(){ye(e.isPlaying(),"Non playing should not call acceptRematch");const r=new ES(e.currentPartId,we.getNonNullable(e.currentPart).data);return yield e.gameService.acceptRematch(r,e.getLastIndex(),e.role),!0})()}proposeRematch(){var e=this;return A(function*(){return ye(e.isPlaying(),"Non playing should not call proposeRematch"),yield e.gameService.proposeRematch(e.currentPartId,e.getLastIndex(),e.role),!0})()}proposeDraw(){return ye(this.isPlaying(),"Non playing should not call proposeDraw"),this.gameService.proposeDraw(this.currentPartId,this.getLastIndex(),this.role)}acceptDraw(){return ye(this.isPlaying(),"Non playing should not call acceptDraw"),this.gameService.acceptDraw(this.currentPartId,this.getLastIndex(),this.role)}refuseDraw(){return ye(this.isPlaying(),"Non playing should not call refuseDraw"),this.gameService.refuseDraw(this.currentPartId,this.getLastIndex(),this.role)}askTakeBack(){return ye(this.isPlaying(),"Non playing should not call askTakeBack"),this.gameService.askTakeBack(this.currentPartId,this.getLastIndex(),this.role)}acceptTakeBack(){var e=this;return A(function*(){ye(e.isPlaying(),"Non playing should not call acceptTakeBack");const r=e.role;yield e.gameService.acceptTakeBack(e.currentPartId,we.getNonNullable(e.currentPart),r,e.msToSubstract),e.msToSubstract=[0,0]})()}refuseTakeBack(){return ye(this.isPlaying(),"Non playing should not call refuseTakeBack"),this.gameService.refuseTakeBack(this.currentPartId,this.getLastIndex(),this.role)}startCountDownFor(e){K(n.VERBOSE,"dans OnlineGameWrapperComponent.startCountDownFor("+e.toString()+") (turn "+we.getNonNullable(this.currentPart).data.turn+")"),this.hasUserPlayed[e.value]=!0,e===z.ZERO?(this.chronoZeroGlobal.start(),this.chronoZeroTurn.start()):(this.chronoOneGlobal.start(),this.chronoOneTurn.start())}resumeCountDownFor(e,r=!0){let s;K(n.VERBOSE,"dans OnlineGameWrapperComponent.resumeCountDownFor("+e.toString()+") (turn "+we.getNonNullable(this.currentPart).data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.changeDuration(we.getNonNullable(this.currentPart?.data.remainingMsForZero)),this.chronoZeroGlobal.resume(),s=this.chronoZeroTurn):(this.chronoOneGlobal.changeDuration(we.getNonNullable(this.currentPart?.data.remainingMsForOne)),this.chronoOneGlobal.resume(),s=this.chronoOneTurn),r?(s.setDuration(1e3*this.configRoom.maximalMoveDuration),s.start()):s.resume()}pauseCountDownsFor(e,r=!0){let s;K(n.VERBOSE,"dans OnlineGameWrapperComponent.pauseCountDownFor("+e.value+") (turn "+this.currentPart?.data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.pause(),s=this.chronoZeroTurn):(this.chronoOneGlobal.pause(),s=this.chronoOneTurn),r?s.stop():s.pause()}stopCountdownsFor(e){K(n.VERBOSE,"cdc::stopCountDownsFor("+e.toString()+") (turn "+this.currentPart?.data.turn+")"),e===z.ZERO?(this.chronoZeroGlobal.isStarted()&&this.chronoZeroGlobal.stop(),this.chronoZeroTurn.isStarted()&&this.chronoZeroTurn.stop()):(this.chronoOneGlobal.isStarted()&&this.chronoOneGlobal.stop(),this.chronoOneTurn.isStarted()&&this.chronoOneTurn.stop())}getPlayerNameClass(e){return this.opponentIsOffline()?"has-text-grey-light":e===z.ZERO?"has-text-white":"has-text-black"}opponentIsOffline(){return!1}canResign(){return ye(this.isPlaying(),"Non playing should not call canResign"),!0!==this.endGame&&null!=this.opponent}addGlobalTime(){const e=this.role,r=this.getLastIndex();return this.gameService.addGlobalTime(this.currentPartId,r,we.getNonNullable(this.currentPart).data,e)}addTurnTime(){return this.gameService.addTurnTime(this.role,this.getLastIndex(),this.currentPartId)}addTurnTimeTo(e,r){const s=z.fromTurn(we.getNonNullable(this.currentPart).getTurn());this.pauseCountDownsFor(s,!1),e===z.ZERO?this.chronoZeroTurn.changeDuration(this.chronoZeroTurn.remainingMs+r):this.chronoOneTurn.changeDuration(this.chronoOneTurn.remainingMs+r),this.resumeCountDownFor(s,!1)}addGlobalTimeTo(e,r){e===z.ZERO?this.chronoZeroGlobal.changeDuration(this.chronoZeroGlobal.remainingMs+r):this.chronoOneGlobal.changeDuration(this.chronoOneGlobal.remainingMs+r)}onCancelMove(e){this.gameComponent.showLastMove()}ngOnDestroy(){var e=this;return A(function*(){K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy"),e.routerEventsSubscription.unsubscribe(),e.userSubscription.unsubscribe(),e.observedPartSubscription.unsubscribe(),!1===e.isPlaying()&&e.userLinkedToThisPart&&(yield e.observedPartService.removeObservedPart()),!0===e.gameStarted&&(e.opponentSubscription.unsubscribe(),e.partSubscription.unsubscribe()),K(n.VERBOSE,"OnlineGameWrapperComponent.ngOnDestroy finished")})()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ba),Q(So),Q(Os),Q(jn),Q(Tn),Q(w2),Q(um),Q(SS))},n.\u0275cmp=gt({type:n,selectors:[["app-online-game-wrapper"]],viewQuery:function(e,r){if(1&e&&(f4(cft,5),f4(lft,5),f4(uft,5),f4(fft,5),f4(hft,5),f4(dft,5)),2&e){let s;vc(s=Cc())&&(r.partCreation=s.first),vc(s=Cc())&&(r.chatComponent=s.first),vc(s=Cc())&&(r.chronoZeroGlobal=s.first),vc(s=Cc())&&(r.chronoOneGlobal=s.first),vc(s=Cc())&&(r.chronoZeroTurn=s.first),vc(s=Cc())&&(r.chronoOneTurn=s.first)}},features:[l],decls:5,vars:4,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I,H,Y,ee,ve,te,Ie,Be,Ye,Vt,R1,b1,rs,Bc,Fo,D2;return t=$localize`vs.`,e=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,r=$localize`It is your turn.`,s=$localize`It is ${"\ufffd0\ufffd"}:INTERPOLATION:'s turn.`,i=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Resign`,u=$localize`Propose a draw`,h=$localize`Accept draw`,p=$localize`Reject draw`,m=$localize`Pass a turn`,C=$localize`Accept take back`,w=$localize`Reject take back`,I=$localize`Ask to take back one move`,H=$localize`Draw`,Y=$localize`You agreed to draw.`,ee=$localize`Your draw proposal has been accepted.`,ve=$localize`Players agreed to draw.`,te=$localize`You won.`,Ie=$localize`You lost.`,Be=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: won.`,Ye=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit. You won.`,Vt=$localize`You reached your time limit.`,R1=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has reached their time limit.`,b1=$localize`You resigned.`,rs=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: has resigned.`,Bc=$localize`Go back to the game list`,Fo=$localize`Propose to play again`,D2=$localize`Accept to play again`,[["id","partCreation",3,"partId","gameStartNotification",4,"ngIf"],["id","game","class","tile is-ancestor",4,"ngIf"],[1,"block","mt-2"],["id","chat",1,"box"],[3,"chatId","turn"],["id","partCreation",3,"partId","gameStartNotification"],["partCreation",""],["id","game",1,"tile","is-ancestor"],[1,"tile","is-parent"],[1,"tile","is-child","box","has-text-centered"],["class","block","id","turnIndicator",4,"ngIf"],[1,"block"],["id","playerZeroIndicator","class","player0-bg",3,"ngClass",4,"ngIf"],["id","scoreZeroIndicator",4,"ngIf"],["debugName","ZERO Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroGlobal",""],["debugName","ZERO Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoZeroTurn",""],[1,"is-size-3"],t,["id","playerOneIndicator","class","player1-bg",3,"ngClass",4,"ngIf"],["id","scoreOneIndicator",4,"ngIf"],["debugName","ONE Global",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneGlobal",""],["debugName","ONE Turn",3,"dangerTimeLimit","active","canAddTime","timeToAdd","outOfTimeAction","addTimeToOpponent"],["chronoOneTurn",""],[4,"ngIf"],["class","block","id","winnerIndicator",4,"ngIf"],["class","button is-primary is-fullwidth mb-1","id","backToServerButton","routerLink","/lobby",4,"ngIf"],["id","proposeRematchButton","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["class","button is-fullwidth is-warning","id","acceptRematchButton",3,"click",4,"ngIf"],["id","board-tile",1,"tile","is-9","is-parent","rounded-div",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","turnIndicator",1,"block"],[1,"subtitle"],e,["class","subtitle","id","currentPlayerIndicator",4,"ngIf"],["id","currentPlayerIndicator",1,"subtitle"],[4,"ngIf","ngIfElse"],["opponentsTurn",""],["id","playerTurn"],r,["id","opponentTurn"],s,["id","playerZeroIndicator",1,"player0-bg",3,"ngClass"],["id","scoreZeroIndicator"],i,["id","playerOneIndicator",1,"player1-bg",3,"ngClass"],["id","scoreOneIndicator"],o,["class","button is-fullwidth mb-1","id","resignButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","proposeDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptDrawButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","refuseDrawButton",3,"click",4,"ngIf"],["class","button is-fullwidth mb-1","id","passButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","id","acceptTakeBackButton",3,"click",4,"ngIf"],["class","button is-warning is-fullwidth mb-1","color","warn","id","refuseTakeBackButton",3,"click",4,"ngIf"],["class","button is-fullwidth","id","askTakeBackButton",3,"click",4,"ngIf"],["id","resignButton",1,"button","is-fullwidth","mb-1",3,"click"],c,["id","proposeDrawButton",1,"button","is-fullwidth","mb-1",3,"click"],u,["id","acceptDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],h,["id","refuseDrawButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],p,["id","passButton",1,"button","is-fullwidth","mb-1",3,"click"],m,["id","acceptTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],C,["color","warn","id","refuseTakeBackButton",1,"button","is-warning","is-fullwidth","mb-1",3,"click"],w,["id","askTakeBackButton",1,"button","is-fullwidth",3,"click"],I,["id","winnerIndicator",1,"block"],["id","hardDrawIndicator",1,"title"],H,["class","title","id","youAgreedToDrawIndicator",4,"ngIf"],["class","title","id","yourOpponentAgreedToDrawIndicator",4,"ngIf"],["class","title","id","playersAgreedToDraw",4,"ngIf"],["id","youAgreedToDrawIndicator",1,"title"],Y,["id","yourOpponentAgreedToDrawIndicator",1,"title"],ee,["id","playersAgreedToDraw",1,"title"],ve,["class","title","id","youWonIndicator",4,"ngIf"],["class","title","id","youLostIndicator",4,"ngIf"],["class","title",4,"ngIf"],["id","youWonIndicator",1,"title"],te,["id","youLostIndicator",1,"title"],Ie,[1,"title"],Be,Ye,Vt,R1,["class","title","id","resignIndicator",4,"ngIf"],["id","resignIndicator",1,"title"],b1,rs,["id","backToServerButton","routerLink","/lobby",1,"button","is-primary","is-fullwidth","mb-1"],Bc,["id","proposeRematchButton",1,"button","is-fullwidth","mb-1",3,"click"],Fo,["id","acceptRematchButton",1,"button","is-fullwidth","is-warning",3,"click"],D2]},template:function(e,r){1&e&&(x(0,pft,2,1,"app-part-creation",0),x(1,Qft,30,27,"div",1),b(2,"div",2)(3,"div",3),X(4,"app-chat",4),O()()),2&e&&(T("ngIf",!1===r.gameStarted),S(1),T("ngIf",r.gameStarted),S(3),T("chatId",r.currentPartId)("turn",null==r.currentPart?null:r.currentPart.getTurn()))},dependencies:[mn,nn,Dp,Z3e,f1,aft],encapsulation:2}),n})();function t9t(n,t){if(1&n&&(b(0,"option",26),Pt(1),O()),2&n){const e=t.$implicit;T("value",e.name),S(1),a1(e.name)}}function n9t(n,t){if(1&n&&(b(0,"option",26),me(1,30),O()),2&n){const e=t.$implicit;T("value",e),S(1),I1(e),H1(1)}}const r9t=function(){return[1,2,3,4,5,6,7,8,9,10,11,12]};function s9t(n,t){if(1&n){const e=Oe();b(0,"select",27),J("ngModelChange",function(s){return fe(e),ae(v(2).aiDepths[0]=s)})("change",function(){fe(e);const s=v(2);return ae(s.updatePlayer(s.Player.ZERO))}),b(1,"option",28),me(2,29),O(),x(3,n9t,2,2,"option",17),O()}2&n&&(T("ngModel",v(2).aiDepths[0]),S(3),T("ngForOf",tr(2,r9t)))}function i9t(n,t){if(1&n&&(b(0,"p",31),me(1,32),O()),2&n){const e=v(2);S(1),I1(e.gameComponent.scores.get()[0]),H1(1)}}function o9t(n,t){if(1&n&&(b(0,"option",26),Pt(1),O()),2&n){const e=t.$implicit;T("value",e.name),S(1),a1(e.name)}}function a9t(n,t){if(1&n&&(b(0,"option",26),me(1,35),O()),2&n){const e=t.$implicit;T("value",e),S(1),I1(e),H1(1)}}const c9t=function(){return[1,2,3,4,5,6,7,8,9,10]};function l9t(n,t){if(1&n){const e=Oe();b(0,"select",33),J("ngModelChange",function(s){return fe(e),ae(v(2).aiDepths[1]=s)})("change",function(){fe(e);const s=v(2);return ae(s.updatePlayer(s.Player.ONE))}),b(1,"option",28),me(2,34),O(),x(3,a9t,2,2,"option",17),O()}2&n&&(T("ngModel",v(2).aiDepths[1]),S(3),T("ngForOf",tr(2,c9t)))}function u9t(n,t){if(1&n&&(b(0,"p",36),me(1,37),O()),2&n){const e=v(2);S(1),I1(e.gameComponent.scores.get()[1]),H1(1)}}function f9t(n,t){if(1&n&&(b(0,"h4",41),Pt(1),O()),2&n){const e=v(3);S(1),a1(e.winnerMessage.get())}}function h9t(n,t){1&n&&(b(0,"h4",42),me(1,43),O())}function d9t(n,t){if(1&n&&(b(0,"div",38),x(1,f9t,2,1,"h4",39),x(2,h9t,2,0,"h4",40),O()),2&n){const e=v(2);S(1),T("ngIf",e.winnerMessage.isPresent()),S(1),T("ngIf",e.winnerMessage.isAbsent())}}function p9t(n,t){if(1&n){const e=Oe();b(0,"div",7)(1,"div",8)(2,"p",9),me(3,10),O()(),b(4,"div",11)(5,"div",12)(6,"div",13)(7,"select",14),J("change",function(){fe(e);const s=v();return ae(s.updatePlayer(s.Player.ZERO))})("ngModelChange",function(s){return fe(e),ae(v().playerSelection[0]=s)}),b(8,"option",15),me(9,16),O(),x(10,t9t,2,2,"option",17),O()(),b(11,"div",13),x(12,s9t,4,3,"select",18),O(),x(13,i9t,2,1,"p",19),O(),b(14,"div",20)(15,"div",13)(16,"select",21),J("change",function(){fe(e);const s=v();return ae(s.updatePlayer(s.Player.ONE))})("ngModelChange",function(s){return fe(e),ae(v().playerSelection[1]=s)}),b(17,"option",15),me(18,22),O(),x(19,o9t,2,2,"option",17),O()(),b(20,"div",13),x(21,l9t,4,3,"select",23),O(),x(22,u9t,2,1,"p",24),O()(),x(23,d9t,3,2,"div",25),O()}if(2&n){const e=v();S(3),I1(e.gameComponent.getTurn()+1),H1(3),S(4),T("ngModel",e.playerSelection[0]),S(3),T("ngForOf",e.gameComponent.availableMinimaxes),S(2),T("ngIf",!1===e.players[0].equalsValue("human")),S(1),T("ngIf",e.gameComponent.scores.isPresent()),S(3),T("ngModel",e.playerSelection[1]),S(3),T("ngForOf",e.gameComponent.availableMinimaxes),S(2),T("ngIf",!1===e.players[1].equalsValue("human")),S(1),T("ngIf",e.gameComponent.scores.isPresent()),S(1),T("ngIf",e.endGame)}}function g9t(n,t){if(1&n&&(ln(0),Pt(1),X(2,"br"),un()),2&n){const e=t.$implicit,r=v(3);S(1),W2(" ",e.name+": "+e.getBoardValue(r.gameComponent.rules.node)," ")}}function m9t(n,t){if(1&n&&(ln(0),x(1,g9t,3,1,"ng-container",50),Pt(2),X(3,"br"),Pt(4),X(5,"br"),un()),2&n){const e=v(2);S(1),T("ngForOf",e.gameComponent.availableMinimaxes),S(1),W2(" Created ",e.getCreatedNodes()," nodes."),S(2),W2(" Minimax time: ",e.getMinimaxTime(),"ms.")}}function _9t(n,t){if(1&n){const e=Oe();b(0,"button",51),J("click",function(){return fe(e),ae(v(2).gameComponent.pass())}),me(1,52),O()}}function v9t(n,t){if(1&n){const e=Oe();b(0,"button",53),J("click",function(){return fe(e),ae(v(2).takeBack())}),me(1,54),O()}}function C9t(n,t){if(1&n){const e=Oe();b(0,"div",44),x(1,m9t,6,3,"ng-container",45),x(2,_9t,2,0,"button",46),x(3,v9t,2,0,"button",47),b(4,"button",48),J("click",function(){return fe(e),ae(v().restartGame())}),me(5,49),O()()}if(2&n){const e=v();S(1),T("ngIf",e.gameComponent.rules.node.move&&e.displayAIMetrics),S(1),T("ngIf",!1===e.endGame&&e.gameComponent.canPass),S(1),T("ngIf",e.canTakeBack())}}let y9t=(()=>{class n extends qP{constructor(e,r,s,i,o,c){super(e,r,s,i,o),this.cdr=c,this.displayAIMetrics=!0,this.aiDepths=["0","0"],this.playerSelection=["human","human"],this.winnerMessage=P.empty(),this.botTimeOut=1e3,this.players=[P.of(this.playerSelection[0]),P.of(this.playerSelection[1])],this.role=z.ZERO,K(n.VERBOSE,"LocalGameWrapper.constructor")}getCreatedNodes(){return cP.createdNodes}getMinimaxTime(){return cP.minimaxTime}ngAfterViewInit(){var e=this;setTimeout(A(function*(){(yield e.afterViewInit())&&(e.restartGame(),e.cdr.detectChanges())}),1)}updatePlayer(e){this.players[e.value]=P.of(this.playerSelection[e.value]),this.setRole("human"===this.playerSelection[1]&&"human"!==this.playerSelection[0]?z.ONE:z.ZERO),this.proposeAIToPlay()}onLegalUserMove(e){var r=this;return A(function*(){K(n.VERBOSE,"LocalGameWrapperComponent.onLegalUserMove"),r.gameComponent.rules.choose(e),r.updateBoard(),r.proposeAIToPlay()})()}updateBoard(){this.gameComponent.updateBoard();const e=this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node);if(!0===e.isEndGame&&(this.endGame=!0,e.winner.isPlayer())){const r=$localize`Player ${e.winner.value+1}`,i=e.winner.getOpponent().value;this.winnerMessage=this.players[e.winner.value].equalsValue("human")?this.players[i].equalsValue("human")?P.of($localize`${r} won`):P.of($localize`You won`):this.players[i].equalsValue("human")?P.of($localize`You lost`):P.of($localize`${this.players[e.winner.value].get()} (${r}) won`)}}proposeAIToPlay(){var e=this;const r=this.getPlayingAI();r.isPresent()&&window.setTimeout(A(function*(){yield e.doAIMove(r.get())}),this.botTimeOut)}getPlayingAI(){if(this.gameComponent.rules.getGameStatus(this.gameComponent.rules.node).isEndGame)return P.empty();const e=this.gameComponent.getTurn()%2;return"0"===this.aiDepths[e]?P.empty():P.ofNullable(this.gameComponent.availableMinimaxes.find(r=>this.players[e].equalsValue(r.name)))}doAIMove(e){var r=this;return A(function*(){const s=r.gameComponent.rules;ye(s.getGameStatus(s.node)===xe.ONGOING,"AI should not try to play when game is over!");const c=Number.parseInt(r.aiDepths[s.node.gameState.turn%2%2]),u=s.node.findBestMove(c,e,!0);return s.choose(u)?(r.updateBoard(),r.cdr.detectChanges(),r.proposeAIToPlay(),U.SUCCESS):(r.messageDisplayer.criticalMessage($localize`The AI chose an illegal move! This is an unexpected situation that we logged, we will try to solve this as soon as possible. In the meantime, consider that you won!`),bs.logError("LocalGameWrapper","AI chose illegal move",{name:e.name,move:u.toString()}))})()}canTakeBack(){return this.gameComponent.getTurn()>0}takeBack(){this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get(),this.isAITurn()&&(this.gameComponent.rules.node=this.gameComponent.rules.node.mother.get()),this.gameComponent.updateBoard()}isAITurn(){return this.getPlayingAI().isPresent()}restartGame(){this.gameComponent.rules.setInitialBoard(),this.gameComponent.updateBoard(),this.endGame=!1,this.winnerMessage=P.empty(),this.proposeAIToPlay()}getPlayer(){return"human"}onCancelMove(e){this.gameComponent.rules.node.move.isPresent()&&this.gameComponent.showLastMove()}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ba),Q(So),Q(Os),Q(jn),Q(Tn),Q(fu))},n.\u0275cmp=gt({type:n,selectors:[["app-local-game-wrapper"]],features:[l],decls:8,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w;return t=$localize`Turn n°${"\ufffd0\ufffd"}:INTERPOLATION:`,e=$localize`Human`,r=$localize`Human`,s=$localize`Pick the level`,i=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,o=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,c=$localize`Pick the level`,u=$localize`Level ${"\ufffd0\ufffd"}:INTERPOLATION:`,h=$localize`${"\ufffd0\ufffd"}:INTERPOLATION: points`,p=$localize`Draw`,m=$localize`Start a new game`,C=$localize`Pass a turn`,w=$localize`Take back move`,[[1,"tile","is-ancestor"],[1,"tile","is-3","is-vertical","is-parent"],["class","tile is-child box has-text-centered","id","info",4,"ngIf"],["class","tile is-child box is-vcentered",4,"ngIf"],[1,"tile","is-parent","is-9","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["id","info",1,"tile","is-child","box","has-text-centered"],["id","turnIndicator",1,"block"],[1,"subtitle"],t,["id","playerSelector",1,"columns"],[1,"column","is-6","is-vcentered"],[1,"select"],["id","playerZeroSelect",3,"ngModel","change","ngModelChange"],["selected","","value","human"],e,[3,"value",4,"ngFor","ngForOf"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreOne","class","block",4,"ngIf"],[1,"column","is-6"],["id","playerOneSelect",3,"ngModel","change","ngModelChange"],r,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change",4,"ngIf"],["id","scoreZero","class","block",4,"ngIf"],["id","gameResult","class","block",4,"ngIf"],[3,"value"],["id","aiZeroDepthSelect",3,"ngModel","ngModelChange","change"],["selected","","value","0"],s,i,["id","scoreOne",1,"block"],o,["id","aiOneDepthSelect",3,"ngModel","ngModelChange","change"],c,u,["id","scoreZero",1,"block"],h,["id","gameResult",1,"block"],["id","winner",4,"ngIf"],["id","draw",4,"ngIf"],["id","winner"],["id","draw"],p,[1,"tile","is-child","box","is-vcentered"],[4,"ngIf"],["id","passButton","class","button is-primary is-fullwidth mb-1",3,"click",4,"ngIf"],["id","takeBack","class","button is-fullwidth mb-1",3,"click",4,"ngIf"],["id","restartButton",1,"button","is-fullwidth",3,"click"],m,[4,"ngFor","ngForOf"],["id","passButton",1,"button","is-primary","is-fullwidth","mb-1",3,"click"],C,["id","takeBack",1,"button","is-fullwidth","mb-1",3,"click"],w]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1),x(2,p9t,24,10,"div",2),x(3,C9t,6,3,"div",3),O(),b(4,"div",4)(5,"div",5),X(6,"div",null,6),O()()()),2&e&&(S(2),T("ngIf",r.gameComponent),S(1),T("ngIf",r.gameComponent),S(1),T("ngClass",r.getBoardHighlight()))},dependencies:[mn,Ln,nn,vp,Cp,Ly,bl,_p],encapsulation:2,changeDetection:0}),n})(),J3e=(()=>{class n{}return n.STEP_FINISHED=()=>$localize`Step finished!`,n.INFORMATIONAL_STEP=()=>$localize`This step is not expecting any move from your part.`,n})();function E9t(n,t){if(1&n&&(b(0,"div",21)(1,"div",22),me(2,23),O(),X(3,"div",24),O()),2&n){const e=v();S(3),T("innerHTML",e.currentReason.get(),W8)}}function M9t(n,t){if(1&n){const e=Oe();b(0,"button",25),J("click",function(){return fe(e),ae(v().retry())}),me(1,26),O()}}function S9t(n,t){1&n&&(ln(0),me(1,31),un())}function P9t(n,t){1&n&&(ln(0),me(1,32),un())}function T9t(n,t){if(1&n&&x(0,P9t,2,0,"ng-container",28),2&n){v();const e=t1(5),r=v();T("ngIf",r.stepFinished&&r.stepFinished[r.stepIndex])("ngIfElse",e)}}function w9t(n,t){1&n&&(ln(0),me(1,33),un())}function b9t(n,t){if(1&n){const e=Oe();b(0,"button",27),J("click",function(){return fe(e),ae(v().next())}),x(1,S9t,2,0,"ng-container",28),x(2,T9t,1,2,"ng-template",null,29,c1),x(4,w9t,2,0,"ng-template",null,30,c1),O()}if(2&n){const e=t1(3),r=v();S(1),T("ngIf",r.steps[r.stepIndex]&&r.steps[r.stepIndex].isInformation())("ngIfElse",e)}}function O9t(n,t){if(1&n){const e=Oe();b(0,"button",34),J("click",function(){return fe(e),ae(v().start())}),me(1,35),O()}}function N9t(n,t){if(1&n){const e=Oe();b(0,"button",36),J("click",function(){return fe(e),ae(v().playLocally())}),me(1,37),O()}}function A9t(n,t){if(1&n){const e=Oe();b(0,"button",38),J("click",function(){return fe(e),ae(v().createGame())}),me(1,39),O()}}function I9t(n,t){if(1&n){const e=Oe();b(0,"button",40),J("click",function(){return fe(e),ae(v().showSolution())}),me(1,41),O()}}function x9t(n,t){if(1&n&&(ln(0),b(1,"option",43),Pt(2),O(),un()),2&n){const e=v(),r=e.index,s=e.$implicit;S(1),C1("id","step_",r,""),T("value",r),S(1),a1(s.title)}}function k9t(n,t){1&n&&(ln(0),Pt(1,"v "),un())}function L9t(n,t){1&n&&Pt(0,"x ")}function R9t(n,t){if(1&n&&(b(0,"option",44),x(1,k9t,2,0,"ng-container",28),x(2,L9t,1,0,"ng-template",null,45,c1),b(4,"span",46),Pt(5),O()()),2&n){const e=t1(3),r=v(),s=r.index,i=r.$implicit,o=v();T("value",s),S(1),T("ngIf",o.stepFinished[s])("ngIfElse",e),S(3),C1("id","step_",s,""),S(1),a1(i.title)}}function D9t(n,t){if(1&n&&(ln(0),x(1,x9t,3,3,"ng-container",28),x(2,R9t,6,5,"ng-template",null,42,c1),un()),2&n){const e=t.index,r=t1(3),s=v();S(1),T("ngIf",e===s.stepIndex)("ngIfElse",r)}}let z9t=(()=>{class n extends qP{constructor(e,r,s,i,o,c){super(e,r,c,s,i),this.cdr=o,this.connectedUserService=c,this.COMPLETED_TUTORIAL_MESSAGE=$localize`Congratulations, you completed the tutorial.`,this.steps=[],this.successfulSteps=0,this.stepIndex=-1,this.currentMessage="",this.currentReason=P.empty(),this.moveAttemptMade=!1,this.stepFinished=[],this.tutorialOver=!1,K(n.VERBOSE,"TutorialGameWrapperComponent.constructor"),this.role=z.ZERO}getNumberOfSteps(){return this.steps.length}getCurrentStepTitle(){return this.steps.length>0?this.steps[this.stepIndex].title:""}ngAfterViewInit(){var e=this;return A(function*(){K(n.VERBOSE,"TutorialGameWrapperComponent.ngAfterViewInit"),(yield e.afterViewInit())&&e.start()})()}start(){this.startTutorial(this.gameComponent.tutorial)}startTutorial(e){K(n.VERBOSE,{tutorialGameWrapperComponent_startTutorial:{tutorial:e}}),this.steps=e,this.tutorialOver=!1,this.stepFinished=this.getCompletionArray(),this.successfulSteps=0,this.showStep(0)}getCompletionArray(){return this.steps.map(()=>!1)}changeStep(e){this.showStep(Number.parseInt(e.target.value,10))}showStep(e){K(n.VERBOSE,"tutorialGameWrapperComponent.showStep("+e+")"),this.moveAttemptMade=!1,this.stepFinished[e]=!1,this.updateSuccessCount(),this.stepIndex=e;const r=this.steps[this.stepIndex];let s;if(this.currentMessage=r.instruction,this.currentReason=P.empty(),r.previousState.isPresent()){const i=new B1(r.previousState.get());s=P.of(i)}else s=P.empty();this.gameComponent.rules.node=new B1(r.state,s,r.previousMove),this.gameComponent.updateBoard(),this.setRole(this.gameComponent.getCurrentPlayer()),this.cdr.detectChanges()}onLegalUserMove(e){var r=this;return A(function*(){K(n.VERBOSE,{tutorialGameWrapper_onLegalUserMove:{move:e}});const s=r.steps[r.stepIndex];if(ye(r.gameComponent.rules.choose(e),"It should be impossible to call onLegalUserMove with an illegal move"),K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: legal move"),r.gameComponent.updateBoard(),r.moveAttemptMade=!0,s.isPredicate()){const o=r.gameComponent.getPreviousState(),c=r.gameComponent.getState(),u=we.getNonNullable(s.predicate)(e,o,c);u.isSuccess()?r.showStepSuccess(s.getSuccessMessage()):r.currentReason=P.of(u.getReason())}else if(s.isAnyMove())K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(s.getSuccessMessage());else{ye(s.isMove(),"cannot reach here with a click step");const o=s;o.acceptedMoves.some(c=>c.equals(e))?(K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: awaited move!"),r.showStepSuccess(o.getSuccessMessage())):(K(n.VERBOSE,"tutorialGameWrapper.onLegalUserMove: not the move that was awaited."),r.currentReason=P.of(o.getFailureMessage()))}r.cdr.detectChanges()})()}retry(){K(n.VERBOSE,"tutorialGameWrapper.retry"),this.moveAttemptMade=!1,this.showStep(this.stepIndex)}onUserClick(e){if(K(n.VERBOSE,"tutorialGameWrapper.onUserClick("+e+")"),this.currentReason=P.empty(),this.stepFinished[this.stepIndex]||this.moveAttemptMade)return U.failure(J3e.STEP_FINISHED());const r=this.steps[this.stepIndex];return r.isClick()?(this.gameComponent.updateBoard(),this.moveAttemptMade=!0,we.getNonNullable(r.acceptedClicks).some(s=>s===e)?this.showStepSuccess(r.getSuccessMessage()):this.currentMessage=r.getFailureMessage(),U.SUCCESS):r.isMove()||r.isPredicate()||r.isAnyMove()?(window.setTimeout(()=>{this.cdr.detectChanges()},10),U.SUCCESS):U.failure(J3e.INFORMATIONAL_STEP())}onCancelMove(e){K(n.VERBOSE,"tutorialGameWrapperComponent.onCancelMove("+e+")"),void 0!==e&&(this.currentReason=P.of(e)),this.cdr.detectChanges()}showStepSuccess(e){K(n.VERBOSE,"tutorialGameWrapperComponent.showStepSuccess()"),this.currentMessage=e,this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()}updateSuccessCount(){let e=0;for(const r of this.stepFinished)r&&e++;this.successfulSteps=e}next(){if(this.steps[this.stepIndex].isInformation()&&(this.stepFinished[this.stepIndex]=!0,this.updateSuccessCount()),this.stepFinished.length===this.successfulSteps)this.currentMessage=this.COMPLETED_TUTORIAL_MESSAGE,this.tutorialOver=!0;else{let e=(this.stepIndex+1)%this.steps.length;for(;!0===this.stepFinished[e];)e=(e+1)%this.steps.length;this.showStep(e)}}showSolution(){var e=this;return A(function*(){K(n.VERBOSE,"tutorialGameWrapper.showSolution()");const r=e.steps[e.stepIndex];ye(r.hasSolution(),"step must have solution");const s=r,i=s.getSolution();i instanceof $i?(e.showStep(e.stepIndex),e.gameComponent.rules.choose(i),e.gameComponent.updateBoard()):(e.showStep(e.stepIndex),window.document.querySelector(i).dispatchEvent(new Event("click"))),e.currentMessage=s.getSuccessMessage(),e.moveAttemptMade=!0,e.cdr.detectChanges()})()}playLocally(){var e=this;return A(function*(){const r=we.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/local",r])})()}createGame(){var e=this;return A(function*(){const r=we.getNonNullable(e.actRoute.snapshot.paramMap.get("compo"));yield e.router.navigate(["/play",r])})()}getPlayer(){return"tutorial-player"}}return n.VERBOSE=!1,n.\u0275fac=function(e){return new(e||n)(Q(ba),Q(So),Q(jn),Q(Tn),Q(fu),Q(Os))},n.\u0275cmp=gt({type:n,selectors:[["app-tutorial-game-wrapper"]],features:[l],decls:23,vars:15,consts:function(){let t,e,r,s,i,o,c,u,h;return t=$localize`Failure`,e=$localize`Try again`,r=$localize`Ok`,s=$localize`Continue`,i=$localize`Skip`,o=$localize`Try again`,c=$localize`Play locally`,u=$localize`Create an online game`,h=$localize`See solution`,[[1,"tile","is-ancestor"],[1,"tile","is-5","is-vertical","is-parent"],["id","infos",1,"tile","is-child","box"],[1,"progress","is-primary"],[1,"content","is-medium"],[1,"title"],["id","currentMessage",3,"innerHTML"],["class","message is-danger","role","alert",4,"ngIf"],[1,"block"],["id","retryButton","class","button mr-3",3,"click",4,"ngIf"],["id","nextButton","class","button is-primary mr-3 mb-1",3,"click",4,"ngIf"],["id","restartButton","class","button",3,"click",4,"ngIf"],["id","playLocallyButton","class","button",3,"click",4,"ngIf"],["id","playOnlineButton","class","button",3,"click",4,"ngIf"],["id","showSolutionButton","class","button",3,"click",4,"ngIf"],[1,"select"],["id","steps",3,"change"],[4,"ngFor","ngForOf"],[1,"tile","is-parent","is-7","is-vcentered",3,"ngClass"],["id","board",1,"tile","is-child","box"],["board",""],["role","alert",1,"message","is-danger"],[1,"message-header"],t,["id","currentReason",1,"message-body",3,"innerHTML"],["id","retryButton",1,"button","mr-3",3,"click"],e,["id","nextButton",1,"button","is-primary","mr-3","mb-1",3,"click"],[4,"ngIf","ngIfElse"],["notInfo",""],["notFinished",""],r,s,i,["id","restartButton",1,"button",3,"click"],o,["id","playLocallyButton",1,"button",3,"click"],c,["id","playOnlineButton",1,"button",3,"click"],u,["id","showSolutionButton",1,"button",3,"click"],h,["otherstep",""],["selected","",3,"id","value"],[3,"value"],["notdone",""],[3,"id"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),X(3,"progress",3),b(4,"div",4)(5,"p",5),Pt(6),O(),X(7,"p",6),O(),x(8,E9t,4,1,"div",7),b(9,"div",8),x(10,M9t,2,0,"button",9),x(11,b9t,6,2,"button",10),x(12,O9t,2,0,"button",11),x(13,N9t,2,0,"button",12),x(14,A9t,2,0,"button",13),x(15,I9t,2,0,"button",14),b(16,"div",15)(17,"select",16),J("change",function(i){return r.changeStep(i)}),x(18,D9t,4,2,"ng-container",17),O()()()()(),b(19,"div",18)(20,"div",19),X(21,"div",null,20),O()()()),2&e&&(S(3),D("value",r.successfulSteps)("max",r.getNumberOfSteps()),S(3),qb("",r.getCurrentStepTitle()," [",r.stepIndex+1,"/",r.getNumberOfSteps(),"]"),S(1),T("innerHTML",r.currentMessage,W8),S(1),T("ngIf",r.currentReason.isPresent()),S(2),T("ngIf",!1===r.tutorialOver&&(r.stepFinished&&!0===r.stepFinished[r.stepIndex]||r.moveAttemptMade)),S(1),T("ngIf",!1===r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.tutorialOver),S(1),T("ngIf",r.moveAttemptMade&&!1===r.stepFinished[r.stepIndex]),S(3),T("ngForOf",r.steps),S(1),T("ngClass",r.getBoardHighlight()))},dependencies:[mn,Ln,nn,vp,Cp],encapsulation:2,changeDetection:0}),n})();function V9t(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),me(2,37),O(),b(3,"div",38),Pt(4),O()()),2&n){const e=v();S(4),a1(e.errorMessage)}}const H9t=function(){return["/login"]};let F9t=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.faEye=LV,this.registrationForm=new p0({email:new La,username:new La,password:new La})}registerWithEmail(){var e=this;return A(function*(){const r=e.registrationForm.value.username,s=e.registrationForm.value.email,i=e.registrationForm.value.password;if(null==r||null==s||null==i)e.errorMessage=$localize`There are missing fields in the registration form, please check that you filled in all fields.`;else{const o=yield e.connectedUserService.doRegister(r,s,i);if(o.isSuccess()){const c=yield e.connectedUserService.sendEmailVerification();c.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=c.getReason()}else e.errorMessage=o.getReason()}})()}registerWithGoogle(){var e=this;return A(function*(){const r=yield e.connectedUserService.doGoogleLogin();r.isSuccess()?yield e.router.navigate(["/verify-account"]):e.errorMessage=r.getReason()})()}getPasswordHelpClass(){const e=this.registrationForm.value.password;return null==e||""===e?"":e.length<6?"is-danger":"is-success"}canRegister(){const e=this.registrationForm.value.password??"";return!(""===(this.registrationForm.value.email??"")||""===(this.registrationForm.value.username??"")||""===e||e.length<6)}}return n.\u0275fac=function(e){return new(e||n)(Q(Os),Q(jn))},n.\u0275cmp=gt({type:n,selectors:[["app-register"]],decls:56,vars:7,consts:function(){let t,e,r,s,i,o,c,u,h,p,m,C,w,I;return t=$localize`Registering`,e=$localize`Email`,r=$localize`Email`,s=$localize`A confirmation email will be sent to validate your account.`,i=$localize`Username`,o=$localize`Username`,c=$localize`Password`,u=$localize`Password`,h=$localize`The password should be at least 6 characters long`,p=$localize`Register`,m=$localize`Register with Google`,C=$localize`Have an account?`,w=$localize`Log in`,I=$localize`Registration error`,[[1,"box"],[1,"title"],t,[3,"formGroup"],[1,"field","is-horizontal"],[1,"field-label"],["for","email",1,"label"],e,[1,"field-body"],[1,"field"],[1,"control"],["id","email","formControlName","email","name","email","placeholder",r,"type","email","autofocus","","required","",1,"input"],[1,"help"],s,["for","username",1,"label"],i,["id","username","formControlName","username","name","username","placeholder",o,"type","text","required","",1,"input"],["for","password",1,"label"],c,[1,"control","has-icons-right","is-expanded"],["id","password","formControlName","password","name","password","placeholder",u,"type","password","required","",1,"input"],[1,"icon","is-small","is-right"],["toggleVisibility","",1,"clickable-icon",3,"icon"],["id","passwordHelp",1,"help",3,"ngClass"],h,["id","registerButton",1,"button","is-primary","is-fullwidth",3,"disabled","click"],p,[1,"field-body","is-fullwidth"],["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","googleButton","type","submit",1,"button","is-fullwidth",3,"click"],m,[1,"help","level-right"],C,[3,"routerLink"],w,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],I,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),me(2,2),O(),b(3,"form",3)(4,"div",4)(5,"div",5)(6,"label",6),me(7,7),O()(),b(8,"div",8)(9,"div",9)(10,"div",10),X(11,"input",11),b(12,"p",12),me(13,13),O()()()()(),b(14,"div",4)(15,"div",5)(16,"label",14),me(17,15),O()(),b(18,"div",8)(19,"div",9)(20,"div",10),X(21,"input",16),O()()()(),b(22,"div",4)(23,"div",5)(24,"label",17),me(25,18),O()(),b(26,"div",8)(27,"div",9)(28,"div",19),X(29,"input",20),b(30,"span",21),X(31,"fa-icon",22),O(),b(32,"p",23),me(33,24),O()()()()(),b(34,"div",4),X(35,"div",5),b(36,"div",8)(37,"div",9)(38,"div",10)(39,"button",25),J("click",function(){return r.registerWithEmail()}),me(40,26),O()()()()(),b(41,"div",4),X(42,"div",5),b(43,"div",27),x(44,V9t,5,1,"div",28),O()(),b(45,"div",4),X(46,"div",5),b(47,"div",8)(48,"button",29),J("click",function(){return r.registerWithGoogle()}),me(49,30),O()()(),b(50,"p",31),ln(51),me(52,32),un(),Pt(53,"\xa0 "),b(54,"a",33),me(55,34),O()()()()),2&e&&(S(3),T("formGroup",r.registrationForm),S(28),T("icon",r.faEye),S(1),T("ngClass",r.getPasswordHelpClass()),S(7),T("disabled",!r.canRegister()),S(5),T("ngIf",r.errorMessage),S(10),T("routerLink",tr(6,H9t)))},dependencies:[mn,nn,Su,mu,g4,bl,gu,Cu,_u,rf,h9,FH,q3e],encapsulation:2}),n})(),B9t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}playLocally(){var e=this;return A(function*(){yield e.router.navigate(["local/"+e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn))},n.\u0275cmp=gt({type:n,selectors:[["app-local-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Play offline`,[[3,"pickGame"],["id","launchGame",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),J("click",function(){return r.playLocally()}),me(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[HH],encapsulation:2}),n})(),$9t=(()=>{class n{constructor(e){this.router=e}pickGame(e){this.selectedGame=e}launchTutorial(){var e=this;return A(function*(){yield e.router.navigate(["/tutorial/",e.selectedGame])})()}}return n.\u0275fac=function(e){return new(e||n)(Q(jn))},n.\u0275cmp=gt({type:n,selectors:[["app-tutorial-game-creation"]],decls:3,vars:1,consts:function(){let t;return t=$localize`Learn the rules`,[[3,"pickGame"],["id","launchTutorial",1,"button","is-primary","is-fullwidth",3,"disabled","click"],t]},template:function(e,r){1&e&&(b(0,"app-pick-game",0),J("pickGame",function(i){return r.pickGame(i)}),O(),b(1,"button",1),J("click",function(){return r.launchTutorial()}),me(2,2),O()),2&e&&(S(1),T("disabled",!r.selectedGame))},dependencies:[HH],encapsulation:2}),n})(),U9t=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=gt({type:n,selectors:[["app-next-game-loading"]],decls:2,vars:0,consts:function(){let t;return t=$localize`The replay game is loading, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),me(1,0),O())},encapsulation:2}),n})();function W9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.HEPTAGON)}}function q9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessQueenComponent.EIGHT_POINTED_STAR)}}function j9t(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function Z9t(n,t){if(1&n&&(ln(0),B(),X(1,"circle",6)(2,"circle",6)(3,"circle",6),un()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(3)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function Y9t(n,t){if(1&n&&(B(),b(0,"g"),X(1,"circle",7)(2,"circle",7)(3,"circle",7),O()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.45*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.45*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.55*e.MartianChessComponent.SPACE_SIZE)("cy",.55*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function K9t(n,t){if(1&n&&(B(),b(0,"g",8),X(1,"circle",9)(2,"circle",9)(3,"circle",9),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+3*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}class d6{constructor(){this.MartianChessQueenComponent=d6,this.MartianChessComponent=zo,this.horizontalDotsRadius=zo.SPACE_SIZE/15}}function Q9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.PENTAGON)}}function J9t(n,t){if(1&n&&(B(),X(0,"polygon",4)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessDroneComponent.FOUR_POINTED_STAR_VERTICAL)}}function eht(n,t){if(1&n&&(B(),X(0,"circle",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function tht(n,t){if(1&n&&(ln(0),B(),X(1,"circle",6)(2,"circle",6),un()),2&n){const e=v();S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(2)),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",e.MartianChessComponent.getRadius(1))}}function nht(n,t){if(1&n&&(B(),b(0,"g",7),X(1,"circle",8)(2,"circle",8),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.4*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE),S(1),D("cx",.6*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function rht(n,t){if(1&n&&(B(),b(0,"g",7),X(1,"circle",9)(2,"circle",9),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE-2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE+2*e.horizontalDotsRadius)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}d6.HEPTAGON=zo.getRegularPolygon(7),d6.EIGHT_POINTED_STAR=zo.getNPointedStar(8,0),d6.\u0275fac=function(t){return new(t||d6)},d6.\u0275cmp=gt({type:d6,selectors:[["","app-martian-chess-queen",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-queen",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,W9t,1,3,"polygon",0),x(1,q9t,1,3,"polygon",0),x(2,j9t,1,5,"circle",1),x(3,Z9t,4,9,"ng-container",2),x(4,Y9t,4,9,"g",2),x(5,K9t,4,10,"g",3)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[mn,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class p6{constructor(){this.MartianChessComponent=zo,this.MartianChessDroneComponent=p6,this.horizontalDotsRadius=zo.SPACE_SIZE/15}}function iht(n,t){if(1&n&&(B(),X(0,"polygon",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.TRIANGLE)}}function oht(n,t){if(1&n&&(B(),X(0,"polygon",5)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("points",e.MartianChessPawnComponent.FOUR_POINTED_STAR_DIAGONAL)}}function aht(n,t){if(1&n&&(B(),X(0,"circle",6)),2&n){const e=v();T("id",e.mainShapeId)("ngClass",e.pieceClasses),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.5*e.MartianChessComponent.SPACE_SIZE-e.MartianChessComponent.STROKE_WIDTH)}}function cht(n,t){if(1&n&&(B(),X(0,"circle",7)),2&n){const e=v();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE+e.getConcreteTriangleYOffset())("r",e.MartianChessComponent.getRadius(1))}}function lht(n,t){if(1&n&&(B(),X(0,"circle",8)),2&n){const e=v();D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",.2/3*e.MartianChessComponent.SPACE_SIZE)}}function uht(n,t){if(1&n&&(B(),b(0,"g",9),X(1,"circle",10),O()),2&n){const e=v();T("ngClass",e.pieceClasses),S(1),D("cx",.5*e.MartianChessComponent.SPACE_SIZE)("cy",.5*e.MartianChessComponent.SPACE_SIZE)("r",1.5*e.horizontalDotsRadius)}}p6.FOUR_POINTED_STAR_VERTICAL=zo.getNPointedStar(4,0),p6.PENTAGON=zo.getRegularPolygon(5),p6.\u0275fac=function(t){return new(t||p6)},p6.\u0275cmp=gt({type:p6,selectors:[["","app-martian-chess-drone",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-drone",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[3,"ngClass"],[1,"base","mid-stroke"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,Q9t,1,3,"polygon",0),x(1,J9t,1,3,"polygon",0),x(2,eht,1,5,"circle",1),x(3,tht,3,6,"ng-container",2),x(4,nht,3,7,"g",3),x(5,rht,3,7,"g",3)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[mn,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class _a{constructor(){this.MartianChessComponent=zo,this.MartianChessPawnComponent=_a,this.horizontalDotsRadius=zo.SPACE_SIZE/15}static getTriangle(){return zo.getRegularPolygon(3,_a.TRIANGLE_Y_OFFSET)}static yOffsetForVerticalCentering(){const e=zo.getRegularPolygonCoords(3).map(u=>u.y);return(e.reduce((u,h)=>Math.min(u,h))+(100-e.reduce((u,h)=>Math.max(u,h))))/4}getConcreteTriangleYOffset(){return"Polygon"===this.style.shape?_a.TRIANGLE_Y_OFFSET:0}}function hht(n,t){if(1&n&&(B(),X(0,"text",8)),2&n){const e=v();G2("id","height_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),T("innerHTML",e.coord.z,W8)}}function dht(n,t){if(1&n&&(B(),X(0,"polyline",9)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getUpperHorizontalLine())}}function pht(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polyline",10)(2,"polyline",11),O()),2&n){const e=v();S(1),T("ngClass",e.pieceClasses),D("points",e.getMiddleHorizontalLine()),S(1),T("ngClass",e.pieceClasses),D("points",e.getLowerHorizontalLine())}}function ght(n,t){if(1&n&&(B(),X(0,"polyline",12)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getLeftDiagonalLine())}}function mht(n,t){if(1&n&&(B(),b(0,"g"),X(1,"polyline",13)(2,"polyline",14),O()),2&n){const e=v();S(1),T("ngClass",e.pieceClasses),D("points",e.getMiddleDiagonalLine()),S(1),T("ngClass",e.pieceClasses),D("points",e.getRighterDiagonalLine())}}function _ht(n,t){if(1&n&&(B(),X(0,"polyline",15)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getLeftVerticalLine())}}function vht(n,t){if(1&n&&(B(),X(0,"polyline",16)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getMiddleVerticalLine())}}function Cht(n,t){if(1&n&&(B(),X(0,"polyline",17)),2&n){const e=v();T("ngClass",e.pieceClasses),D("points",e.getRighterVerticalLine())}}_a.FOUR_POINTED_STAR_DIAGONAL=zo.getNPointedStar(4,45),_a.TRIANGLE_Y_OFFSET=_a.yOffsetForVerticalCentering(),_a.TRIANGLE=_a.getTriangle(),_a.\u0275fac=function(t){return new(t||_a)},_a.\u0275cmp=gt({type:_a,selectors:[["","app-martian-chess-pawn",""]],inputs:{mainShapeId:"mainShapeId",pieceClasses:"pieceClasses",style:"style"},attrs:["app-martian-chess-pawn",""],decls:6,vars:6,consts:[["class","base","stroke-linecap","round",3,"id","ngClass",4,"ngIf"],["class","base",3,"id","ngClass",4,"ngIf"],["class","base no-fill mid-stroke",4,"ngIf"],["class","base mid-stroke",4,"ngIf"],[3,"ngClass",4,"ngIf"],["stroke-linecap","round",1,"base",3,"id","ngClass"],[1,"base",3,"id","ngClass"],[1,"base","no-fill","mid-stroke"],[1,"base","mid-stroke"],[3,"ngClass"],[1,"base-no-stroke"]],template:function(t,e){1&t&&(x(0,iht,1,3,"polygon",0),x(1,oht,1,3,"polygon",0),x(2,aht,1,5,"circle",1),x(3,cht,1,3,"circle",2),x(4,lht,1,3,"circle",3),x(5,uht,2,4,"g",4)),2&t&&(T("ngIf","Polygon"===e.style.shape),S(1),T("ngIf","Star"===e.style.shape),S(1),T("ngIf","Circle"===e.style.shape),S(1),T("ngIf","Concentric Circles"===e.style.points),S(1),T("ngIf","Dots"===e.style.points),S(1),T("ngIf","Horizontal Points"===e.style.points))},dependencies:[mn,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});class z9{mustForceStrokeDisplay(){return void 0===this.move||this.pieceClasses.some(t=>"victory-stroke"===t)||this.pieceClasses.some(t=>"last-move-stroke"===t)}get3DIsoSquarePoints(){const t=this.getParallelogramPoints();return this.mapCoordToPoints([t[0],t[1],t[4],t[6],t[5],t[2],t[0]])}getParallelogramPoints(){const t=this.mode.parallelogramHeight*this.mode.horizontalWidthRatio,e=this.mode.parallelogramHeight,r=this.mode.offsetRatio*this.mode.parallelogramHeight,s=this.mode.parallelogramHeight*this.mode.pieceHeightRatio,i=t,c=t-r,u=e,h=-r,p=e;return[new M(0,0),new M(i,0),new M(h,p),new M(c,u),new M(i,0+s),new M(h,p+s),new M(c,u+s)]}mapCoordToPoints(t){return t.map(e=>e.x+" "+e.y).join(" ")}getUpperHorizontalLineCoords(){const t=this.getParallelogramPoints(),e=t[0],r=t[1],i=new Ut(-1*this.mode.offsetRatio*u1.STROKE_WIDTH,u1.STROKE_WIDTH),o=e.getNext(i),c=r.getNext(i);return[e,r,c,o]}getUpperHorizontalLine(){const t=this.getUpperHorizontalLineCoords();return this.mapCoordToPoints(t)}getMiddleHorizontalCoords(){const t=this.getParallelogramPoints(),e=t[2],r=t[3],i=new Ut(-1*this.mode.offsetRatio*u1.STROKE_WIDTH,u1.STROKE_WIDTH);return[e.getNext(i,-1),r.getNext(i,-1),r,e]}getMiddleHorizontalLine(){const t=this.getMiddleHorizontalCoords();return this.mapCoordToPoints(t)}getLowerHorizontalLine(){const t=this.getParallelogramPoints(),e=t[5],r=t[6],s=new Ut(0,u1.STROKE_WIDTH),i=e.getNext(s,-1),o=r.getNext(s,-1);return this.mapCoordToPoints([i,o,r,e])}getLeftDiagonalLine(){const t=this.getParallelogramPoints(),e=t[0],r=t[2],i=new Ut(u1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleDiagonalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[3],i=new Ut(u1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterDiagonalLine(){const t=this.getParallelogramPoints(),e=t[4],r=t[6],i=new Ut(0,u1.STROKE_WIDTH),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getLeftVerticalLine(){const t=this.getParallelogramPoints(),e=t[2],r=t[5],i=new Ut(u1.STROKE_WIDTH,0),o=e.getNext(i,1),c=r.getNext(i,1);return this.mapCoordToPoints([e,o,c,r])}getMiddleVerticalLine(){const t=this.getParallelogramPoints(),e=t[3],r=t[6],i=new Ut(u1.STROKE_WIDTH,0),o=e.getNext(i,-1),c=r.getNext(i,-1);return this.mapCoordToPoints([o,e,r,c])}getRighterVerticalLine(){const t=this.getParallelogramPoints(),e=t[1],r=t[4],o=new Ut(u1.STROKE_WIDTH,-u1.STROKE_WIDTH/this.mode.offsetRatio),c=e.getNext(o,-1),u=r.getNext(o,-1);return this.mapCoordToPoints([c,e,r,u])}getOtherCoord(){ye(null!=this.move,"Move should be set before calling getOtherCoord");const t=this.move;return t.getZero().equals(this.coord)?t.getOne():t.getZero()}isLeftHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x-1}}isRightHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.x===t.x+1}}isTopHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y-1}}isBottomHalf(){if(null==this.move)return!1;{const t=this.getOtherCoord();return this.coord.y===t.y+1}}}z9.STROKE_OFFSET=u1.STROKE_WIDTH/2,z9.\u0275fac=function(t){return new(t||z9)},z9.\u0275cmp=gt({type:z9,selectors:[["","mgp-trexo-half-piece",""]],inputs:{coord:"coord",move:"move",pieceClasses:"pieceClasses",mode:"mode",mustDisplayHeight:"mustDisplayHeight"},attrs:["mgp-trexo-half-piece",""],decls:9,vars:13,consts:[[3,"id","ngClass"],["x","50","y","66","class","text-big text-center",3,"id","innerHTML",4,"ngIf"],["id","line_0_to_1","class","base manual-stroke",3,"ngClass",4,"ngIf"],[4,"ngIf"],["id","line_0_to_2","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_2_to_5","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_3_to_6","class","base manual-stroke",3,"ngClass",4,"ngIf"],["id","line_1_to_4","class","base manual-stroke",3,"ngClass",4,"ngIf"],["x","50","y","66",1,"text-big","text-center",3,"id","innerHTML"],["id","line_0_to_1",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_5_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_0_to_2",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_3",1,"base","manual-stroke",3,"ngClass"],["id","line_4_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_2_to_5",1,"base","manual-stroke",3,"ngClass"],["id","line_3_to_6",1,"base","manual-stroke",3,"ngClass"],["id","line_1_to_4",1,"base","manual-stroke",3,"ngClass"]],template:function(t,e){1&t&&(B(),X(0,"polyline",0),x(1,hht,1,4,"text",1),x(2,dht,1,2,"polyline",2),x(3,pht,3,4,"g",3),x(4,ght,1,2,"polyline",4),x(5,mht,3,4,"g",3),x(6,_ht,1,2,"polyline",5),x(7,vht,1,2,"polyline",6),x(8,Cht,1,2,"polyline",7)),2&t&&(G2("id","tile_",e.coord.x,"_",e.coord.y,"_",e.coord.z,""),T("ngClass",e.pieceClasses),D("points",e.get3DIsoSquarePoints()),S(1),T("ngIf",e.mustDisplayHeight),S(1),T("ngIf",!1===e.isBottomHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isTopHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isRightHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",!1===e.isLeftHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isBottomHalf()||e.isLeftHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isBottomHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()),S(1),T("ngIf",e.isTopHalf()||e.isRightHalf()||e.mustForceStrokeDisplay()))},dependencies:[mn,nn],styles:[".base[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8;fill:var(--spaces-fill);stroke-linecap:butt;stroke-linejoin:round}.manual-stroke[_ngcontent-%COMP%]{stroke-width:0}.base.manual-stroke[_ngcontent-%COMP%]{fill:var(--base-stroke)}.base-no-stroke[_ngcontent-%COMP%]{stroke:none;stroke-width:0;fill:var(--base-stroke)}.base-no-fill[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:8}.arrow[_ngcontent-%COMP%]{stroke:var(--base-stroke);stroke-width:3}.text[_ngcontent-%COMP%]{fill:var(--base-stroke)}.white-background[_ngcontent-%COMP%]{fill:#fff}.white-stroke[_ngcontent-%COMP%]{stroke:#fff}.background[_ngcontent-%COMP%]{fill:var(--spaces-fill)}.transparent[_ngcontent-%COMP%]{opacity:0}.background2[_ngcontent-%COMP%]{fill:var(--alt-background-fill)}.background3[_ngcontent-%COMP%]{fill:var(--alt-alt-background-fill)}.player0-fill[_ngcontent-%COMP%]{fill:var(--player0)}.player0-alternate-fill[_ngcontent-%COMP%]{fill:var(--player0-alternate)}.player0-stroke[_ngcontent-%COMP%]{stroke:var(--player0)}.player1-fill[_ngcontent-%COMP%]{fill:var(--player1)}.player1-alternate-fill[_ngcontent-%COMP%]{fill:var(--player1-alternate)}.player1-stroke[_ngcontent-%COMP%]{stroke:var(--player1)}.nonplayer-fill[_ngcontent-%COMP%]{fill:var(--nonplayer)}.nonplayer-light-fill[_ngcontent-%COMP%]{fill:var(--nonplayer-light)}.nonplayer-stroke[_ngcontent-%COMP%]{stroke:var(--nonplayer)}.dashed-stroke[_ngcontent-%COMP%]{stroke-dasharray:2}.pre-captured-fill[_ngcontent-%COMP%]{fill:var(--pre-captured)}.captured-fill[_ngcontent-%COMP%]{fill:var(--captured)}.captured-alternate-fill[_ngcontent-%COMP%]{fill:var(--alt-captured)}.captured-stroke[_ngcontent-%COMP%]{stroke:var(--captured)}.moved-fill[_ngcontent-%COMP%]{fill:var(--moved)}.moved-stroke[_ngcontent-%COMP%]{stroke:var(--moved)}.indicator[_ngcontent-%COMP%]{fill:var(--indicator);stroke:none}.indicator-fill[_ngcontent-%COMP%]{fill:var(--indicator)}.selectable-fill[_ngcontent-%COMP%]{fill:var(--selectable)}.selectable-stroke[_ngcontent-%COMP%]{stroke:var(--selectable)}.selectable[_ngcontent-%COMP%] > .base-no-stroke[_ngcontent-%COMP%]{fill:var(--selectable)}.last-move-stroke[_ngcontent-%COMP%]{stroke:var(--last-move)}.last-move-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--last-move)}.victory-fill[_ngcontent-%COMP%]{fill:var(--victory)}.victory-stroke[_ngcontent-%COMP%]{stroke:var(--victory)}.victory-stroke.manual-stroke[_ngcontent-%COMP%]{fill:var(--victory)}.selected-fill[_ngcontent-%COMP%]{fill:var(--selected)}.selected-stroke[_ngcontent-%COMP%]{stroke:var(--selected)}.clickable-stroke[_ngcontent-%COMP%], .clickable-stroke-hover[_ngcontent-%COMP%]:hover{stroke:var(--clickable)}.capturable-stroke[_ngcontent-%COMP%]{stroke-width:2;stroke:var(--capturable)}.capturable-fill[_ngcontent-%COMP%]{fill:var(--capturable)}.capturable-stroke[_ngcontent-%COMP%]:hover{stroke-width:8}.no-fill[_ngcontent-%COMP%]{fill:none}.no-stroke[_ngcontent-%COMP%]{stroke:none}.small-stroke[_ngcontent-%COMP%]{stroke-width:2}.mid-small-stroke[_ngcontent-%COMP%]{stroke-width:3}.mid-stroke[_ngcontent-%COMP%]{stroke-width:5}.normal-stroke[_ngcontent-%COMP%]{stroke-width:8}.semi-transparent[_ngcontent-%COMP%]{fill-opacity:.5;stroke-opacity:.5}.round[_ngcontent-%COMP%]{stroke-linecap:round}.text-giant[_ngcontent-%COMP%]{fill:var(--base-stroke);font:3.7rem sans-serif;stroke-width:.37rem;dominant-baseline:central}.text-big[_ngcontent-%COMP%]{font:50px sans-serif}.text-medium[_ngcontent-%COMP%]{font:35px sans-serif}.text-20[_ngcontent-%COMP%]{font:20px sans-serif}.text-bold[_ngcontent-%COMP%]{font-weight:700}.text-center[_ngcontent-%COMP%]{text-anchor:middle}.black-fill[_ngcontent-%COMP%]{fill:#000}.darker[_ngcontent-%COMP%]{filter:brightness(80%)}.lighter[_ngcontent-%COMP%]{filter:brightness(110%)}svg[_ngcontent-%COMP%]{max-height:calc(100vh - 10rem)}"]});const Km_firebaseConfig={apiKey:"AIzaSyCgOzdBWz58aFnjCFGzH_KiLMtA8PXaQhc",authDomain:"everyboard-dev.firebaseapp.com",projectId:"everyboard-dev",storageBucket:"everyboard-dev.appspot.com",messagingSenderId:"579824736515"};let BH=(()=>{class n{constructor(e){this.connectedUserService=e}canActivate(){var e=this;return A(function*(){const r=yield new Promise(s=>{e.userSubscription=e.connectedUserService.subscribeToUser(function(){var i=A(function*(o){return s(yield e.evaluateUserPermission(o))});return function(o){return i.apply(this,arguments)}}())});return e.userSubscription.unsubscribe(),r})()}}return n.\u0275fac=function(e){return new(e||n)(Re(Os))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Xm=(()=>{class n extends BH{constructor(e,r){super(e),this.router=r}static evaluateUserPermission(e,r){return A(function*(){return!1===r.isConnected()?e.parseUrl("/login"):!1!==r.verified||e.parseUrl("/verify-account")})()}evaluateUserPermission(e){var r=this;return A(function*(){return n.evaluateUserPermission(r.router,e)})()}}return n.\u0275fac=function(e){return new(e||n)(Re(Os),Re(jn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),$H=(()=>{class n{constructor(e,r){this.observedPartService=e,this.router=r,this.observedPartSubscription=P.empty()}canActivate(e){var r=this;return A(function*(){const s=yield new Promise(i=>{const o=r.observedPartService.subscribeToObservedPart(c=>{if(c.isAbsent())return i(!0);const u=c.get();return i(e.params.id===u.id||r.router.parseUrl("/play/"+u.typeGame+"/"+u.id))});r.observedPartSubscription=P.of(o)});return r.observedPartSubscription.get().unsubscribe(),r.observedPartSubscription=P.empty(),s})()}}return n.\u0275fac=function(e){return new(e||n)(Re(w2),Re(jn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),yht=(()=>{class n extends BH{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return A(function*(){return!1===e.isConnected()?r.router.parseUrl("/login"):!e.verified||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Re(Os),Re(jn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),e4e=(()=>{class n extends BH{constructor(e,r){super(e),this.router=r}evaluateUserPermission(e){var r=this;return A(function*(){return!1===e.isConnected()||r.router.parseUrl("/")})()}}return n.\u0275fac=function(e){return new(e||n)(Re(Os),Re(jn))},n.\u0275prov=et({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Eht(n,t){1&n&&(b(0,"p",20),me(1,21),O())}function Mht(n,t){if(1&n){const e=Oe();b(0,"div",7)(1,"p",8),me(2,9),O(),b(3,"div",10)(4,"p",11),me(5,12),O(),b(6,"button",13),J("click",function(){return fe(e),ae(v().finalizeEmailVerification())}),me(7,14),O()(),b(8,"div",15)(9,"p",11),me(10,16),O(),b(11,"button",17),J("click",function(){return fe(e),ae(v().sendEmailVerification())}),me(12,18),O()(),x(13,Eht,2,0,"p",19),O()}if(2&n){const e=v();S(2),I1(e.emailAddress),H1(2),S(11),T("ngIf",e.success)}}function Sht(n,t){if(1&n){const e=Oe();b(0,"div",24)(1,"div",8),me(2,25),O(),b(3,"form",26)(4,"div",27)(5,"div",28),X(6,"input",29),O(),b(7,"div",28)(8,"button",30),J("click",function(){fe(e);const s=v(2);return ae(s.pickUsername(s.usernameForm.value))}),me(9,31),O()()()()()}if(2&n){const e=v(2);S(3),T("formGroup",e.usernameForm)}}const Pht=function(){return["/lobby"]};function Tht(n,t){1&n&&(b(0,"div",32),gc(1,33),X(2,"a",34),mc(),O()),2&n&&(S(2),T("routerLink",tr(1,Pht)))}function wht(n,t){if(1&n&&(ln(0),x(1,Sht,10,1,"div",22),x(2,Tht,3,2,"div",23),un()),2&n){const e=v();S(1),T("ngIf",!e.success),S(1),T("ngIf",e.success)}}function bht(n,t){if(1&n&&(b(0,"div",35)(1,"div",36),Pt(2),O()()),2&n){const e=v();S(2),a1(e.errorMessage)}}let Oht=(()=>{class n{constructor(e,r){this.connectedUserService=e,this.router=r,this.verificationType=null,this.success=!1,this.triedToFinalize=!1,this.usernameForm=new p0({username:new La})}ngOnInit(){var e=this;return A(function*(){e.userSubscription=e.connectedUserService.subscribeToUser(function(){var r=A(function*(s){e.emailAddress=s.email.get(),s.username.isAbsent()?e.verificationType="enter-username":(e.verificationType="send-email",!0===e.triedToFinalize&&!1===s.verified&&(e.errorMessage=$localize`You have not verified your email! Click on the link in the verification email.`),!0===s.verified&&(yield e.router.navigate(["/lobby"])))});return function(s){return r.apply(this,arguments)}}())})()}pickUsername(e){var r=this;return A(function*(){const s=yield r.connectedUserService.setUsername(e.username);s.isSuccess()?r.success=!0:r.errorMessage=s.getReason()})()}sendEmailVerification(){var e=this;return A(function*(){const r=yield e.connectedUserService.sendEmailVerification();r.isSuccess()?e.success=!0:e.errorMessage=r.getReason()})()}finalizeEmailVerification(){var e=this;return A(function*(){e.triedToFinalize=!0,yield e.connectedUserService.reloadUser(),window.open(window.location.href,"_self")})()}ngOnDestroy(){null!=this.userSubscription&&null!=this.userSubscription.unsubscribe&&this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(Q(Os),Q(jn))},n.\u0275cmp=gt({type:n,selectors:[["app-verify-account"]],decls:7,vars:3,consts:function(){let t,e,r,s,i,o,c,u,h,p,m;return t=$localize`Account verification`,e=$localize`In order to finalize your account, you must click on the link that you should have received on your email address (${"\ufffd0\ufffd"}:INTERPOLATION:). The email could be in your spam folder.`,r=$localize`Once you have verified your email, click on the following button:`,s=$localize`Finalize email verification`,i=$localize`If you have not received the verification email, click on the following button:`,o=$localize`Send verification email again`,c=$localize`The email has been sent`,u=$localize`In order to finalize your account, you must choose a username.`,h=$localize`Username`,p=$localize`Pick username`,m=$localize`Your account has now been finalized, you can go back to the ${"\ufffd#2\ufffd"}:START_LINK:list of games${"\ufffd/#2\ufffd"}:CLOSE_LINK:.`,[[1,"box"],[1,"message","is-info"],[1,"message-header"],t,["class","message-body","id","verificationEmail",4,"ngIf"],[4,"ngIf"],["class","message is-danger",4,"ngIf"],["id","verificationEmail",1,"message-body"],[1,"block"],e,[1,"block","level-left"],[1,"level-item"],r,["id","finalizeVerification",1,"button","is-primary","level-item","is-small",3,"click"],s,[1,"level-left"],i,["id","sendEmail",1,"button","is-warning","level-item","is-small",3,"click"],o,["id","success","class","help is-success",4,"ngIf"],["id","success",1,"help","is-success"],c,["id","askUsername","class","message-body",4,"ngIf"],["id","success","class","message-body",4,"ngIf"],["id","askUsername",1,"message-body"],u,[3,"formGroup"],[1,"field","has-addons"],[1,"control"],["id","username","type","text","placeholder",h,"name","username","required","","formControlName","username",1,"input"],["id","pickUsername",1,"button","is-info",3,"click"],p,["id","success",1,"message-body"],m,[3,"routerLink"],[1,"message","is-danger"],["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"div",1)(2,"div",2),me(3,3),O(),x(4,Mht,14,2,"div",4),x(5,wht,3,2,"ng-container",5),O(),x(6,bht,3,1,"div",6),O()),2&e&&(S(4),T("ngIf","send-email"===r.verificationType),S(1),T("ngIf","enter-username"===r.verificationType),S(1),T("ngIf",r.errorMessage))},dependencies:[nn,Su,mu,g4,bl,gu,Cu,_u,rf],encapsulation:2}),n})();function Nht(n,t){1&n&&(b(0,"p",12),me(1,13),O())}function Aht(n,t){if(1&n&&(b(0,"div",14)(1,"div",15),me(2,16),O(),b(3,"div",17),Pt(4),O()()),2&n){const e=v();S(4),a1(e.errorMessage.get())}}const Iht=function(){return{standalone:!0}};let xht=(()=>{class n{constructor(e){this.connectedUserService=e,this.success=!1,this.errorMessage=P.empty(),this.email=""}resetPassword(){var e=this;return A(function*(){ye(""!==e.email,"No email was entered, but it should not be possible to submit the form then!"),e.errorMessage=P.empty(),e.success=!1;const r=yield e.connectedUserService.sendPasswordResetEmail(e.email);r.isSuccess()?e.success=!0:e.errorMessage=P.of(r.getReason())})()}}return n.\u0275fac=function(e){return new(e||n)(Q(Os))},n.\u0275cmp=gt({type:n,selectors:[["app-reset-password"]],decls:12,vars:6,consts:function(){let t,e,r,s,i,o;return t=$localize`Password reset`,e=$localize`Email`,r=$localize`An email will be sent with instruction to reset your password.`,s=$localize`Reset password`,i=$localize`The email has been sent, please follow the instructions from that email.`,o=$localize`Error`,[[1,"box"],[1,"title"],t,[1,"field"],[1,"control"],["id","email","name","email","placeholder",e,"type","email","autofocus","","required","",1,"input",3,"ngModel","ngModelOptions","ngModelChange"],[1,"help"],r,["id","successMessage","class","help is-success",4,"ngIf"],["id","resetPasswordButton",1,"button","is-primary","is-fullwidth","block",3,"disabled","click"],s,["class","message is-danger is-fullwidth","role","alert",4,"ngIf"],["id","successMessage",1,"help","is-success"],i,["role","alert",1,"message","is-danger","is-fullwidth"],[1,"message-header"],o,["id","errorMessage",1,"message-body"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),me(2,2),O(),b(3,"div",3)(4,"div",4)(5,"input",5),J("ngModelChange",function(i){return r.email=i}),O(),b(6,"p",6),me(7,7),O(),x(8,Nht,2,0,"p",8),O()(),b(9,"button",9),J("click",function(){return r.resetPassword()}),me(10,10),O(),x(11,Aht,5,1,"div",11),O()),2&e&&(S(5),T("ngModel",r.email)("ngModelOptions",tr(5,Iht)),S(3),T("ngIf",r.success),S(1),T("disabled",""===r.email),S(2),T("ngIf",r.errorMessage.isPresent()))},dependencies:[nn,g4,bl,Cu,_p,FH],encapsulation:2}),n})();function kht(n,t){if(1&n&&(b(0,"option",13),Pt(1),O()),2&n){const e=t.$implicit,r=v();T("value",e.value)("selected",e.value===r.currentTheme),S(1),W2(" ",e.name," ")}}function Lht(n,t){if(1&n&&(b(0,"option",13),Pt(1),O()),2&n){const e=t.$implicit,r=v();T("value",e.value)("selected",e.value===r.currentLanguage),S(1),W2(" ",e.name," ")}}let Rht=(()=>{class n{constructor(e,r){this.userSettingsService=e,this.availableLanguages=[{value:"fr",name:"Fran\xe7ais"},{value:"en",name:"English"}],this.availableThemes=[{value:"light",name:$localize`Light`},{value:"dark",name:$localize`Dark`}],this.currentTheme=r.getTheme(),this.currentLanguage=this.userSettingsService.getLanguage()}changeLanguage(e){this.userSettingsService.changeLanguage(e.target.value),this.reload()}changeTheme(e){this.userSettingsService.changeTheme(e.target.value),this.reload()}reload(){window.open(window.location.href,"_self")}}return n.\u0275fac=function(e){return new(e||n)(Q(nne),Q(PS))},n.\u0275cmp=gt({type:n,selectors:[["app-settings"]],decls:17,vars:2,consts:function(){let t,e,r;return t=$localize`User settings`,e=$localize`Theme`,r=$localize`Language`,[[1,"box"],[1,"title"],t,[1,"field"],["for","theme",1,"label"],e,[1,"control"],[1,"select"],["id","theme",3,"change"],[3,"value","selected",4,"ngFor","ngForOf"],["for","language",1,"label"],r,["id","language",3,"change"],[3,"value","selected"]]},template:function(e,r){1&e&&(b(0,"div",0)(1,"p",1),me(2,2),O(),b(3,"div",3)(4,"label",4),me(5,5),O(),b(6,"div",6)(7,"div",7)(8,"select",8),J("change",function(i){return r.changeTheme(i)}),x(9,kht,2,3,"option",9),O()()()(),b(10,"div",3)(11,"label",10),me(12,11),O(),b(13,"div",6)(14,"div",7)(15,"select",12),J("change",function(i){return r.changeLanguage(i)}),x(16,Lht,2,3,"option",9),O()()()()()),2&e&&(S(9),T("ngForOf",r.availableThemes),S(7),T("ngForOf",r.availableLanguages))},dependencies:[Ln,vp,Cp],encapsulation:2}),n})(),Dht=(()=>{class n{constructor(e,r,s,i,o,c){this.route=e,this.router=r,this.connectedUserService=s,this.observedPartService=i,this.messageDisplayer=o,this.gameService=c}ngOnInit(){var e=this;return A(function*(){yield e.createGameAndRedirectOrShowError(e.extractGameFromURL())})()}extractGameFromURL(){return we.getNonNullable(this.route.snapshot.paramMap.get("compo"))}createGameAndRedirectOrShowError(e){var r=this;return A(function*(){if(ye(r.connectedUserService.user.get().isConnected(),"User must be connected and have a username to reach this page"),!1===r.gameExists(e))return yield r.router.navigate(["/notFound",R9.NO_MATCHING_GAME(e)],{skipLocationChange:!0}),!1;const i=r.observedPartService.canUserCreate();if(i.isSuccess()){const o=yield r.gameService.createPartConfigRoomAndChat(e);return yield r.router.navigate(["/play",e,o]),!0}return r.messageDisplayer.infoMessage(i.getReason()),yield r.router.navigate(["/lobby"]),!1})()}gameExists(e){return P.ofNullable(L9.ALL_GAMES().find(s=>s.urlName===e)).isPresent()}}return n.\u0275fac=function(e){return new(e||n)(Q(So),Q(jn),Q(Os),Q(w2),Q(Tn),Q(SS))},n.\u0275cmp=gt({type:n,selectors:[["app-online-game-creation"]],decls:2,vars:0,consts:function(){let t;return t=$localize`Creating online game, please wait, it should not take long.`,[t]},template:function(e,r){1&e&&(b(0,"p"),me(1,0),O())},encapsulation:2}),n})();!function O8e(n,t,e){(function nle(n,t,e){"string"!=typeof t&&(e=t,t=n[mt.LocaleId]),t=t.toLowerCase().replace(/_/g,"-"),Q7[t]=n,e&&(Q7[t][mt.ExtraData]=e)})(n,t,e)}(jde);const zht=[{path:"login",component:y7t},{path:"lobby",component:H7t,canActivate:[Xm]},{path:"settings",component:Rht},{path:"register",component:F9t,canActivate:[e4e]},{path:"reset-password",component:xht,canActivate:[e4e]},{path:"notFound/:message",component:K3e},{path:"nextGameLoading",component:U9t,canActivate:[Xm]},{path:"verify-account",component:Oht,canActivate:[yht]},{path:"play",component:Y3e,canActivate:[Xm,$H]},{path:"play/:compo",component:Dht,canActivate:[Xm,$H]},{path:"play/:compo/:id",component:e9t,canActivate:[Xm,$H]},{path:"local",component:B9t},{path:"local/:compo",component:y9t},{path:"tutorial",component:$9t},{path:"tutorial/:compo",component:z9t},{path:"",component:c7t},{path:"demo",component:m7t},{path:"**",component:K3e}];class UH{static app(){return function oSe(n,...t){return{ngModule:iSe,providers:[{provide:MR,useFactory:sSe(n),multi:!0,deps:[Pr,ui,yR,...t]}]}}(()=>aSe(Km_firebaseConfig))}static firestore(){return function ibe(n,...t){return{ngModule:sbe,providers:[{provide:Vz,useFactory:tbe(n),multi:!0,deps:[Pr,ui,yR,ER,[new li,hte],[new li,FR],...t]}]}}(()=>{const t=hbe();t.toJSON();return t})}static auth(){return function Uwe(n,...t){return{ngModule:$we,providers:[{provide:zz,useFactory:Hwe(n),multi:!0,deps:[Pr,ui,yR,ER,[new li,FR],...t]}]}}(()=>{const t=qwe();return t})}}let Vht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n,bootstrap:[I3t]}),n.\u0275inj=qr({providers:[Os,SS,Fz,um,CS,PS,{provide:h4,useValue:hm.getLocale()}],imports:[UH.app(),UH.firestore(),UH.auth(),DG,E7e,H9e.forRoot(zht,{useHash:!1}),WW,i7e,Wde,Wze]}),n})();v8(zo,function(){return[mn,Ln,nn,d6,p6,_a]},[]),v8(u1,function(){return[mn,Ln,nn,z9]},[]);var Hht=tc(7742);function t4e(){(function E0e(){RU=!1})(),Yue().bootstrapModule(Vht).catch(n=>console.error(n))}const n4e=hm.getLocale();"en"!==n4e?fetch("/assets/"+n4e+".json").then(n=>n.ok?n.json():{locale:"en",translations:{}}).then(n=>{(0,Hht.XJ)(n.translations),$localize.locale=n.locale,t4e()}).catch(function(n){console.log(n)}):t4e()},2486:function(V9,P5){!function(tc){"use strict";function on(ht,at){var Jt=Object.keys(ht);if(Object.getOwnPropertySymbols){var i1=Object.getOwnPropertySymbols(ht);at&&(i1=i1.filter(function(zs){return Object.getOwnPropertyDescriptor(ht,zs).enumerable})),Jt.push.apply(Jt,i1)}return Jt}function is(ht){for(var at,Jt=1;Jt<arguments.length;Jt++)at=arguments[Jt]??{},Jt%2?on(Object(at),!0).forEach(function(i1){l8(ht,i1,at[i1])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ht,Object.getOwnPropertyDescriptors(at)):on(Object(at)).forEach(function(i1){Object.defineProperty(ht,i1,Object.getOwnPropertyDescriptor(at,i1))});return ht}function F3(ht,at){if(!(ht instanceof at))throw new TypeError("Cannot call a class as a function")}function Uc(ht,at){for(var Jt,i1=0;i1<at.length;i1++)(Jt=at[i1]).enumerable=Jt.enumerable||!1,Jt.configurable=!0,"value"in Jt&&(Jt.writable=!0),Object.defineProperty(ht,Jt.key,Jt)}function q1(ht,at,Jt){return at&&Uc(ht.prototype,at),Jt&&Uc(ht,Jt),ht}function l8(ht,at,Jt){return at in ht?Object.defineProperty(ht,at,{value:Jt,enumerable:!0,configurable:!0,writable:!0}):ht[at]=Jt,ht}function Gc(){var ht;return null!==(ht=W4)&&void 0!==ht?ht:document}var B3={duration:2e3,position:"top-right",closeOnClick:!0,opacity:1,single:!1,offsetTop:0,offsetBottom:0,offsetLeft:0,offsetRight:0,extraClasses:""},io=is({},B3),ti={},W4=null,H9=function(ht,at,Jt,i1,zs){return"top-left"===ht?"left:".concat(i1,";top:").concat(at,";text-align:left;align-items:flex-start;"):"top-right"===ht?"right:".concat(zs,";top:").concat(at,";text-align:right;align-items:flex-end;"):"top-center"===ht?"top:".concat(at,";left:0;right:0;text-align:center;align-items:center;"):"bottom-left"===ht?"left:".concat(i1,";bottom:").concat(Jt,";text-align:left;align-items:flex-start;"):"bottom-right"===ht?"right:".concat(zs,";bottom:").concat(Jt,";text-align:right;align-items:flex-end;"):"bottom-center"===ht?"bottom:".concat(Jt,";left:0;right:0;text-align:center;align-items:center;"):"center"===ht?"top:0;left:0;right:0;bottom:0;flex-flow:column;justify-content:center;align-items:center;":void 0},u8=function(){function ht(at){var Jt=this;F3(this,ht),this.element=Gc().createElement("div"),this.opacity=at.opacity,this.type=at.type,this.animate=at.animate,this.dismissible=at.dismissible,this.closeOnClick=at.closeOnClick,this.message=at.message,this.duration=at.duration,this.pauseOnHover=at.pauseOnHover,this.offsetTop=at.offsetTop,this.offsetBottom=at.offsetBottom,this.offsetLeft=at.offsetLeft,this.offsetRight=at.offsetRight,this.extraClasses=at.extraClasses;var i1="width:auto;pointer-events:auto;display:inline-flex;white-space:pre-wrap;opacity:".concat(this.opacity,";"),zs=["notification",this.extraClasses];if(this.type&&zs.push(this.type),this.animate&&this.animate.in){var On="animate__".concat(this.animate.in),lr=this.animate.speed?"animate__".concat(this.animate.speed):"animate__faster";zs.push("animate__animated ".concat(On," ").concat(lr)),this.onAnimationEnd(function(){return Jt.element.classList.remove(On)})}if(this.element.className=zs.join(" "),this.dismissible){var $3=Gc().createElement("button");$3.className="delete",$3.addEventListener("click",function(){Jt.destroy()}),this.element.insertAdjacentElement("afterbegin",$3)}else i1+="padding: 1.25rem 1.5rem";this.closeOnClick&&this.element.addEventListener("click",function(){Jt.destroy()}),this.element.setAttribute("style",i1),"string"==typeof this.message?this.element.insertAdjacentHTML("beforeend",this.message):this.element.appendChild(this.message);var T5=new qc(function(){Jt.destroy()},this.duration);this.pauseOnHover&&(this.element.addEventListener("mouseover",function(){T5.pause()}),this.element.addEventListener("mouseout",function(){T5.resume()}))}return q1(ht,[{key:"destroy",value:function(){var at=this;this.animate&&this.animate.out?(this.element.classList.add("animate__".concat(this.animate.out)),this.onAnimationEnd(function(){at.removeParent(at.element.parentNode),at.element.remove(),delete ti.position})):(this.removeParent(this.element.parentNode),this.element.remove(),delete ti.position)}},{key:"removeParent",value:function(at){at&&1>=at.children.length&&at.remove()}},{key:"onAnimationEnd",value:function(){var at=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},Jt={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var i1 in Jt)if(void 0!==this.element.style[i1]){this.element.addEventListener(Jt[i1],function(){return at()});break}}}]),ht}(),qc=function(){function ht(at,Jt){F3(this,ht),this.remaining=Jt,this.callback=at,this.resume()}return q1(ht,[{key:"pause",value:function(){typeof document>"u"||(window.clearTimeout(this.timer),this.remaining-=new Date-this.start)}},{key:"resume",value:function(){typeof document>"u"||(this.start=new Date,window.clearTimeout(this.timer),this.timer=window.setTimeout(this.callback,this.remaining))}}]),ht}();tc.resetDefaults=function(){io=is({},B3)},tc.setDefaults=function(ht){io=is(is({},B3),ht)},tc.setDoc=function nc(ht){for(var at in ti)ti[at].remove();ti={},W4=ht},tc.toast=function Wc(ht){if(!ht.message)throw new Error("message is required");var at=is(is({},io),ht),Jt=new u8(at),i1=function dn(ht,at,Jt,i1,zs,On){if(ti.position)return ti.position;var lr=Gc().createElement("div");return lr.setAttribute("style","width:100%;z-index:99999;position:fixed;pointer-events:none;display:flex;flex-direction:column;padding:15px;"+H9(at,Jt,i1,zs,On)),ht.appendChild(lr),ti.position=lr,lr}(at.appendTo||Gc().body,at.position||io.position,at.offsetTop||io.offsetTop,at.offsetBottom||io.offsetBottom,at.offsetLeft||io.offsetLeft,at.offsetRight||io.offsetRight);if(at.single)for(var zs=i1.lastElementChild;zs;)i1.removeChild(zs),zs=i1.lastElementChild;i1.appendChild(Jt.element)},Object.defineProperty(tc,"__esModule",{value:!0})}(P5)},7742:(V9,P5,tc)=>{"use strict";tc.d(P5,{XJ:()=>au,pQ:()=>BC,Q:()=>Fb});class pn{constructor(a){this.digits=a}static zero(){return new pn([0])}static one(){return new pn([1])}clone(){return new pn(this.digits.slice())}add(a){const l=this.clone();return l.addToSelf(a),l}addToSelf(a){const l=Math.max(this.digits.length,a.digits.length);let f=0;for(let g=0;g<l;g++){let _=f;g<this.digits.length&&(_+=this.digits[g]),g<a.digits.length&&(_+=a.digits[g]),_>=10?(this.digits[g]=_-10,f=1):(this.digits[g]=_,f=0)}f>0&&(this.digits[l]=1)}toString(){let a="";for(let l=this.digits.length-1;l>=0;l--)a+=this.digits[l];return a}}class O5{constructor(a){this.powerOfTwos=[a]}getValue(){return this.powerOfTwos[0]}multiplyBy(a){const l=pn.zero();return this.multiplyByAndAddTo(a,l),l}multiplyByAndAddTo(a,l){for(let f=0;0!==a;a>>>=1,f++)if(1&a){const g=this.getMultipliedByPowerOfTwo(f);l.addToSelf(g)}}getMultipliedByPowerOfTwo(a){for(let l=this.powerOfTwos.length;l<=a;l++){const f=this.powerOfTwos[l-1];this.powerOfTwos[l]=f.add(f)}return this.powerOfTwos[a]}}class qH{constructor(a){this.base=a,this.exponents=[new O5(pn.one())]}toThePowerOf(a){for(let l=this.exponents.length;l<=a;l++){const f=this.exponents[l-1].multiplyBy(this.base);this.exponents[l]=new O5(f)}return this.exponents[a]}}function s_(d){const a=function z2(d){let a=[];for(let l=0;l<d.length;l++){let f=d.charCodeAt(l);if(f>=55296&&f<=56319&&d.length>l+1){const g=d.charCodeAt(l+1);g>=56320&&g<=57343&&(l++,f=(f-55296<<10)+g-56320+65536)}f<=127?a.push(f):f<=2047?a.push(f>>6&31|192,63&f|128):f<=65535?a.push(f>>12|224,f>>6&63|128,63&f|128):f<=2097151&&a.push(f>>18&7|240,f>>12&63|128,f>>6&63|128,63&f|128)}return a}(d);let l=eT(a,0),f=eT(a,102072);return 0==l&&(0==f||1==f)&&(l^=319790063,f^=-1801410264),[l,f]}function eT(d,a){let g,l=2654435769,f=2654435769;const _=d.length;for(g=0;g+12<=_;g+=12){l=Zi(l,m6(d,g,Wr.Little)),f=Zi(f,m6(d,g+4,Wr.Little));const y=tT(l,f,a=Zi(a,m6(d,g+8,Wr.Little)));l=y[0],f=y[1],a=y[2]}return l=Zi(l,m6(d,g,Wr.Little)),f=Zi(f,m6(d,g+4,Wr.Little)),a=Zi(a,_),tT(l,f,a=Zi(a,m6(d,g+8,Wr.Little)<<8))[2]}function tT(d,a,l){return d=ni(d,a),d=ni(d,l),d^=l>>>13,a=ni(a,l),a=ni(a,d),a^=d<<8,l=ni(l,d),l=ni(l,a),l^=a>>>13,d=ni(d,a),d=ni(d,l),d^=l>>>12,a=ni(a,l),a=ni(a,d),a^=d<<16,l=ni(l,d),l=ni(l,a),l^=a>>>5,d=ni(d,a),d=ni(d,l),d^=l>>>3,a=ni(a,l),a=ni(a,d),a^=d<<10,l=ni(l,d),l=ni(l,a),[d,a,l^=a>>>15]}var Wr=(()=>((Wr=Wr||{})[Wr.Little=0]="Little",Wr[Wr.Big=1]="Big",Wr))();function Zi(d,a){return nT(d,a)[1]}function nT(d,a){const l=(65535&d)+(65535&a),f=(d>>>16)+(a>>>16)+(l>>>16);return[f>>>16,f<<16|65535&l]}function ni(d,a){const l=(65535&d)-(65535&a);return(d>>16)-(a>>16)+(l>>16)<<16|65535&l}function o_(d,a){return a>=d.length?0:d[a]}function m6(d,a,l){let f=0;if(l===Wr.Big)for(let g=0;g<4;g++)f+=o_(d,a+g)<<24-8*g;else for(let g=0;g<4;g++)f+=o_(d,a+g)<<8*g;return f}const W9=new qH(256);function DC(d,a,l,f,g=[]){const _={},y={},N={},L=function zC(d,a){const{text:l,block:f}=Z7(d,a);if(void 0===f)return{text:l};{const[g,..._]=f.split("\u241f"),[y,N]=g.split("@@",2);let[L,V]=y.split("|",2);return void 0===V&&(V=L,L=void 0),""===V&&(V=void 0),{text:l,meaning:L,description:V,customId:N,legacyIds:_}}}(d[0],d.raw[0]),V=[L.text],G=[];let se=L.text;for(let ze=1;ze<d.length;ze++){const{messagePart:vt,placeholderName:nt=h3(ze),associatedMessageId:_t}=VC(d[ze],d.raw[ze]);se+=`{$${nt}}${vt}`,void 0!==a&&(_[nt]=a[ze-1],y[nt]=g[ze-1]),G.push(nt),void 0!==_t&&(N[nt]=_t),V.push(vt)}const Pe=L.customId||function i_(d,a=""){let l=s_(d);if(a){const _=s_(a);l=function rT(d,a){const l=d[0],g=a[0],y=nT(d[1],a[1]),N=y[0],L=y[1];return[Zi(Zi(l,g),N),L]}(function YH(d,a){const l=d[0],f=d[1];return[l<<a|f>>>32-a,f<<a|l>>>32-a]}(l,1),_)}return function l_(d,a){const l=W9.toThePowerOf(0).multiplyBy(a);return W9.toThePowerOf(4).multiplyByAndAddTo(d,l),l.toString()}(2147483647&l[0],l[1])}(se,L.meaning||""),Ve=L.legacyIds?L.legacyIds.filter(ze=>ze!==Pe):[];return{id:Pe,legacyIds:Ve,substitutions:_,substitutionLocations:y,text:se,customId:L.customId,meaning:L.meaning||"",description:L.description||"",messageParts:V,messagePartLocations:f,placeholderNames:G,associatedMessageIds:N,location:l}}function VC(d,a){const{text:l,block:f}=Z7(d,a);if(void 0===f)return{messagePart:l};{const[g,_]=f.split("@@");return{messagePart:l,placeholderName:g,associatedMessageId:_}}}function Z7(d,a){if(":"!==a.charAt(0))return{text:d};{const l=ou(d,a);return{block:d.substring(1,l),text:d.substring(l+1)}}}function h3(d){return 1===d?"PH":"PH_"+(d-1)}function ou(d,a){for(let l=1,f=1;l<d.length;l++,f++)if("\\"===a[f])f++;else if(":"===d[l])return l;throw new Error(`Unterminated $localize metadata block in "${a}".`)}class Y7 extends Error{constructor(a){super(`No translation found for ${FC(a)}.`),this.parsedMessage=a,this.type="MissingTranslationError"}}function HC(d,a){return Object.defineProperty(d,"raw",{value:a}),d}function FC(d){const a=d.meaning&&` - "${d.meaning}"`,l=d.legacyIds&&d.legacyIds.length>0?` [${d.legacyIds.map(f=>`"${f}"`).join(", ")}]`:"";return`"${d.id}"${l} ("${d.text}"${a})`}function au(d){$localize.translate||($localize.translate=sB),$localize.TRANSLATIONS||($localize.TRANSLATIONS={}),Object.keys(d).forEach(a=>{$localize.TRANSLATIONS[a]=function Wd(d){const a=d.split(/{\$([^}]*)}/),l=[a[0]],f=[];for(let _=1;_<a.length-1;_+=2)f.push(a[_]),l.push(`${a[_+1]}`);const g=l.map(_=>":"===_.charAt(0)?"\\"+_:_);return{text:d,messageParts:HC(l,g),placeholderNames:f}}(d[a])})}function sB(d,a){try{return function Vb(d,a,l){const f=DC(a,l);let g=d[f.id];if(void 0!==f.legacyIds)for(let _=0;_<f.legacyIds.length&&void 0===g;_++)g=d[f.legacyIds[_]];if(void 0===g)throw new Y7(f);return[g.messageParts,g.placeholderNames.map(_=>{if(f.substitutions.hasOwnProperty(_))return f.substitutions[_];throw new Error(`There is a placeholder name mismatch with the translation provided for the message ${FC(f)}.\nThe translation contains a placeholder with name ${_}, which does not exist in the message.`)})]}($localize.TRANSLATIONS,d,a)}catch(l){return console.warn(l.message),[d,a]}}const Fb=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),BC=function(d,...a){if(BC.translate){const f=BC.translate(d,a);d=f[0],a=f[1]}let l=$C(d[0],d.raw[0]);for(let f=1;f<d.length;f++)l+=a[f-1]+$C(d[f],d.raw[f]);return l};function $C(d,a){return":"===a.charAt(0)?d.substring(ou(d,a)+1):d}}},V9=>{V9(V9.s=6594)}]);